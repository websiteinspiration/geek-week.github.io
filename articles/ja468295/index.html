<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌘 💇🏽 🔳 50シェードのmatplotlib-マスタープロット（完全なPythonコード付き） 🐔 🤜🏼 👩🏽‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="データを扱う人々は、幸福はニューラルネットワークではなく、データを正しく処理する方法にあることをよく知っています。ただし、それらを処理するには、最初に相関関係を分析し、必要なデータを選択し、不要なものを捨てる必要があります。このような目的のために、matplotlibライブラリを使用した視覚化がよく...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>50シェードのmatplotlib-マスタープロット（完全なPythonコード付き）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468295/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データを扱う人々は、幸福はニューラルネットワークではなく、データを正しく処理する方法にあることをよく知っています。</font><font style="vertical-align: inherit;">ただし、それらを処理するには、最初に相関関係を分析し、必要なデータを選択し、不要なものを捨てる必要があります。</font><font style="vertical-align: inherit;">このような目的のために、matplotlibライブラリを使用した視覚化がよく使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uq/6w/kj/uq6wkjk-9grcby6hkw-ibdynrbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「中」に会ってください！</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタマイズ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコードを実行して構成します。</font><font style="vertical-align: inherit;">ただし、個々のグラフは設定自体をオーバーライドします。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># !pip install brewer2mpl</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib <span class="hljs-keyword">as</span> mpl
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> warnings; warnings.filterwarnings(action=<span class="hljs-string">'once'</span>)<font></font>
<font></font>
large = <span class="hljs-number">22</span>; med = <span class="hljs-number">16</span>; small = <span class="hljs-number">12</span>
params = {<span class="hljs-string">'axes.titlesize'</span>: large,
          <span class="hljs-string">'legend.fontsize'</span>: med,
          <span class="hljs-string">'figure.figsize'</span>: (<span class="hljs-number">16</span>, <span class="hljs-number">10</span>),
          <span class="hljs-string">'axes.labelsize'</span>: med,
          <span class="hljs-string">'axes.titlesize'</span>: med,
          <span class="hljs-string">'xtick.labelsize'</span>: med,
          <span class="hljs-string">'ytick.labelsize'</span>: med,
          <span class="hljs-string">'figure.titlesize'</span>: large}<font></font>
plt.rcParams.update(params)<font></font>
plt.style.use(<span class="hljs-string">'seaborn-whitegrid'</span>)<font></font>
sns.set_style(<span class="hljs-string">"white"</span>)<font></font>
%matplotlib inline<font></font>
<font></font>
<span class="hljs-comment"># Version</span>
print(mpl.__version__)  <span class="hljs-comment">#&gt; 3.0.0</span>
print(sns.__version__)  <span class="hljs-comment">#&gt; 0.9.0</span>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相関</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相関プロットは、2つ以上の変数間の関係を視覚化するために使用されます。</font><font style="vertical-align: inherit;">つまり、ある変数が別の変数に対してどのように変化するかです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.散布図</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Scatteplotは、2つの変数間の関係を調べるために使用される古典的で基本的なチャートビューです。</font><font style="vertical-align: inherit;">データに複数のグループがある場合、各グループを異なる色で視覚化できます。</font><font style="vertical-align: inherit;">matplotlibでは、plt.scatterplot（）を使用して簡単にこれを行うことができます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import dataset </span>
midwest = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/midwest_filter.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data </span>
<span class="hljs-comment"># Create as many colors as there are unique midwest['category']</span>
categories = np.unique(midwest[<span class="hljs-string">'category'</span>])<font></font>
colors = [plt.cm.tab10(i/float(len(categories)<span class="hljs-number">-1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(categories))]<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot for Each Category</span>
plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>, facecolor=<span class="hljs-string">'w'</span>, edgecolor=<span class="hljs-string">'k'</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i, category <span class="hljs-keyword">in</span> enumerate(categories):<font></font>
    plt.scatter(<span class="hljs-string">'area'</span>, <span class="hljs-string">'poptotal'</span>, <font></font>
                data=midwest.loc[midwest.category==category, :], <font></font>
                s=<span class="hljs-number">20</span>, c=colors[i], label=str(category))<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.gca().set(xlim=(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.1</span>), ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">90000</span>),<font></font>
              xlabel=<span class="hljs-string">'Area'</span>, ylabel=<span class="hljs-string">'Population'</span>)<font></font>
<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>); plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">"Scatterplot of Midwest Area vs Population"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend(fontsize=<span class="hljs-number">12</span>)    <font></font>
plt.show()  <font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/gp/qp/3a/gpqp3ahgwojnkxp1f8pa6dlnh0u.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.グループキャプチャ付きのバブルチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
境界の内側にポイントのグループを表示して、それらの重要性を強調したい場合があります。</font><font style="vertical-align: inherit;">この例では、割り当てられるデータフレームからレコードを取得し、それらを以下のコードで説明されているencircle（）に渡します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> patches
<span class="hljs-keyword">from</span> scipy.spatial <span class="hljs-keyword">import</span> ConvexHull
<span class="hljs-keyword">import</span> warnings; warnings.simplefilter(<span class="hljs-string">'ignore'</span>)<font></font>
sns.set_style(<span class="hljs-string">"white"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Step 1: Prepare Data</span>
midwest = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/midwest_filter.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># As many colors as there are unique midwest['category']</span>
categories = np.unique(midwest[<span class="hljs-string">'category'</span>])<font></font>
colors = [plt.cm.tab10(i/float(len(categories)<span class="hljs-number">-1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(categories))]<font></font>
<font></font>
<span class="hljs-comment"># Step 2: Draw Scatterplot with unique color for each category</span>
fig = plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>, facecolor=<span class="hljs-string">'w'</span>, edgecolor=<span class="hljs-string">'k'</span>)    <font></font>
<font></font>
<span class="hljs-keyword">for</span> i, category <span class="hljs-keyword">in</span> enumerate(categories):<font></font>
    plt.scatter(<span class="hljs-string">'area'</span>, <span class="hljs-string">'poptotal'</span>, data=midwest.loc[midwest.category==category, :], s=<span class="hljs-string">'dot_size'</span>, c=colors[i], label=str(category), edgecolors=<span class="hljs-string">'black'</span>, linewidths=<span class="hljs-number">.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Step 3: Encircling</span>
<span class="hljs-comment"># https://stackoverflow.com/questions/44575681/how-do-i-encircle-different-data-sets-in-scatter-plot</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encircle</span>(<span class="hljs-params">x,y, ax=None, **kw</span>):</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ax: ax=plt.gca()<font></font>
    p = np.c_[x,y]<font></font>
    hull = ConvexHull(p)<font></font>
    poly = plt.Polygon(p[hull.vertices,:], **kw)<font></font>
    ax.add_patch(poly)<font></font>
<font></font>
<span class="hljs-comment"># Select data to be encircled</span>
midwest_encircle_data = midwest.loc[midwest.state==<span class="hljs-string">'IN'</span>, :]                         <font></font>
<font></font>
<span class="hljs-comment"># Draw polygon surrounding vertices    </span>
encircle(midwest_encircle_data.area, midwest_encircle_data.poptotal, ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"gold"</span>, alpha=<span class="hljs-number">0.1</span>)<font></font>
encircle(midwest_encircle_data.area, midwest_encircle_data.poptotal, ec=<span class="hljs-string">"firebrick"</span>, fc=<span class="hljs-string">"none"</span>, linewidth=<span class="hljs-number">1.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Step 4: Decorations</span>
plt.gca().set(xlim=(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.1</span>), ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">90000</span>),<font></font>
              xlabel=<span class="hljs-string">'Area'</span>, ylabel=<span class="hljs-string">'Population'</span>)<font></font>
<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>); plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">"Bubble Plot with Encircling"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend(fontsize=<span class="hljs-number">12</span>)    <font></font>
plt.show()    <font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/n3/pz/42/n3pz42yqbct7ctw7c_g9cthlotw.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.最適な線形回帰グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの変数が相互にどのように変化するかを理解したい場合は、最適線が最適です。</font><font style="vertical-align: inherit;">以下のグラフは、さまざまなデータグループ間で最もよく一致する方法を示しています。</font><font style="vertical-align: inherit;">グループ化を無効にし、データセット全体に対して1つの最適な線を描くには、以下のsns.lmplot（）からhue = 'cyl'パラメータを削除します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
df_select = df.loc[df.cyl.isin([<span class="hljs-number">4</span>,<span class="hljs-number">8</span>]), :]<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
sns.set_style(<span class="hljs-string">"white"</span>)<font></font>
gridobj = sns.lmplot(x=<span class="hljs-string">"displ"</span>, y=<span class="hljs-string">"hwy"</span>, hue=<span class="hljs-string">"cyl"</span>, data=df_select, <font></font>
                     height=<span class="hljs-number">7</span>, aspect=<span class="hljs-number">1.6</span>, robust=<span class="hljs-literal">True</span>, palette=<span class="hljs-string">'tab10'</span>, <font></font>
                     scatter_kws=dict(s=<span class="hljs-number">60</span>, linewidths=<span class="hljs-number">.7</span>, edgecolors=<span class="hljs-string">'black'</span>))<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
gridobj.set(xlim=(<span class="hljs-number">0.5</span>, <span class="hljs-number">7.5</span>), ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>))<font></font>
plt.title(<span class="hljs-string">"Scatterplot with line of best fit grouped by number of cylinders"</span>, fontsize=<span class="hljs-number">20</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/0m/1t/rm/0m1trm1dh_xeddg4_mfij5vrscq.png"><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自の列の各回帰行</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、各グループの最適線を個別の列に表示できます。</font><font style="vertical-align: inherit;">これを行うには、sns.lmplot（）内でcol = groupingcolumnパラメータを設定します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
df_select = df.loc[df.cyl.isin([<span class="hljs-number">4</span>,<span class="hljs-number">8</span>]), :]<font></font>
<font></font>
<span class="hljs-comment"># Each line in its own column</span>
sns.set_style(<span class="hljs-string">"white"</span>)<font></font>
gridobj = sns.lmplot(x=<span class="hljs-string">"displ"</span>, y=<span class="hljs-string">"hwy"</span>, <font></font>
                     data=df_select, <font></font>
                     height=<span class="hljs-number">7</span>, <font></font>
                     robust=<span class="hljs-literal">True</span>, <font></font>
                     palette=<span class="hljs-string">'Set1'</span>, <font></font>
                     col=<span class="hljs-string">"cyl"</span>,<font></font>
                     scatter_kws=dict(s=<span class="hljs-number">60</span>, linewidths=<span class="hljs-number">.7</span>, edgecolors=<span class="hljs-string">'black'</span>))<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
gridobj.set(xlim=(<span class="hljs-number">0.5</span>, <span class="hljs-number">7.5</span>), ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>))<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
 <img src="https://habrastorage.org/webt/ec/2t/dw/ec2tdwdzzrj5xnyvakp6aixrxq0.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.ストリッププロット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、複数のデータポイントは同じX値とY値を持ち、その結果、複数のデータポイントが互いの上にプロットされて非表示になります。</font><font style="vertical-align: inherit;">これを回避するには、ドットを少し離して視覚的に見えるようにします。</font><font style="vertical-align: inherit;">これは、stripplot（）を使用して簡単に実行できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Stripplot</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)    <font></font>
sns.stripplot(df.cty, df.hwy, jitter=<span class="hljs-number">0.25</span>, size=<span class="hljs-number">8</span>, ax=ax, linewidth=<span class="hljs-number">.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.title(<span class="hljs-string">'Use jittered plots to avoid overlapping of points'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/x1/vs/8u/x1vs8u1mchmmdjo1dfwftrtuf_s.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.カウントプロット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポイントの重複の問題を回避する別のオプションは、この場所にあるポイントの数に応じて、ポイントのサイズを大きくすることです。</font><font style="vertical-align: inherit;">したがって、ポイントのサイズが大きいほど、ポイントの周囲にポイントが集中します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
df_counts = df.groupby([<span class="hljs-string">'hwy'</span>, <span class="hljs-string">'cty'</span>]).size().reset_index(name=<span class="hljs-string">'counts'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Stripplot</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)    <font></font>
sns.scatterplot(df_counts.cty, df_counts.hwy, size=df_counts.counts*<span class="hljs-number">2</span>, ax=ax)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.title(<span class="hljs-string">'Counts Plot - Size of circle is bigger as more points overlap'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/mo/ec/yc/moecyczknxw5dd-qwip1h293wp4.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.棒グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラインヒストグラムには、X軸とY軸の変数に沿ったヒストグラムがあり、これを使用して、XとYの関係を、XとYの1次元分布とともに個別に視覚化します。</font><font style="vertical-align: inherit;">このグラフは、データ分析（EDA）でよく使用されます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Create Fig and gridspec</span>
fig = plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
grid = plt.GridSpec(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, hspace=<span class="hljs-number">0.5</span>, wspace=<span class="hljs-number">0.2</span>)<font></font>
<font></font>
<span class="hljs-comment"># Define the axes</span>
ax_main = fig.add_subplot(grid[:<span class="hljs-number">-1</span>, :<span class="hljs-number">-1</span>])<font></font>
ax_right = fig.add_subplot(grid[:<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>], xticklabels=[], yticklabels=[])<font></font>
ax_bottom = fig.add_subplot(grid[<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>:<span class="hljs-number">-1</span>], xticklabels=[], yticklabels=[])<font></font>
<font></font>
<span class="hljs-comment"># Scatterplot on main ax</span>
ax_main.scatter(<span class="hljs-string">'displ'</span>, <span class="hljs-string">'hwy'</span>, s=df.cty*<span class="hljs-number">4</span>, c=df.manufacturer.astype(<span class="hljs-string">'category'</span>).cat.codes, alpha=<span class="hljs-number">.9</span>, data=df, cmap=<span class="hljs-string">"tab10"</span>, edgecolors=<span class="hljs-string">'gray'</span>, linewidths=<span class="hljs-number">.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># histogram on the right</span>
ax_bottom.hist(df.displ, <span class="hljs-number">40</span>, histtype=<span class="hljs-string">'stepfilled'</span>, orientation=<span class="hljs-string">'vertical'</span>, color=<span class="hljs-string">'deeppink'</span>)<font></font>
ax_bottom.invert_yaxis()<font></font>
<font></font>
<span class="hljs-comment"># histogram in the bottom</span>
ax_right.hist(df.hwy, <span class="hljs-number">40</span>, histtype=<span class="hljs-string">'stepfilled'</span>, orientation=<span class="hljs-string">'horizontal'</span>, color=<span class="hljs-string">'deeppink'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
ax_main.set(title=<span class="hljs-string">'Scatterplot with Histograms \n displ vs hwy'</span>, xlabel=<span class="hljs-string">'displ'</span>, ylabel=<span class="hljs-string">'hwy'</span>)<font></font>
ax_main.title.set_fontsize(<span class="hljs-number">20</span>)
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> ([ax_main.xaxis.label, ax_main.yaxis.label] + ax_main.get_xticklabels() + ax_main.get_yticklabels()):<font></font>
    item.set_fontsize(<span class="hljs-number">14</span>)<font></font>
<font></font>
xlabels = ax_main.get_xticks().tolist()<font></font>
ax_main.set_xticklabels(xlabels)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/bz/fm/eg/bzfmegptclftfqmt0uv8cxxzomq.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.ボックスプロット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Boxplotは、行ごとのヒストグラムと同じ目的を果たします。</font><font style="vertical-align: inherit;">ただし、このグラフは、XとYの中央値、25パーセンタイル、75パーセンタイルを正確に特定するのに役立ちます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Create Fig and gridspec</span>
fig = plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
grid = plt.GridSpec(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, hspace=<span class="hljs-number">0.5</span>, wspace=<span class="hljs-number">0.2</span>)<font></font>
<font></font>
<span class="hljs-comment"># Define the axes</span>
ax_main = fig.add_subplot(grid[:<span class="hljs-number">-1</span>, :<span class="hljs-number">-1</span>])<font></font>
ax_right = fig.add_subplot(grid[:<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>], xticklabels=[], yticklabels=[])<font></font>
ax_bottom = fig.add_subplot(grid[<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>:<span class="hljs-number">-1</span>], xticklabels=[], yticklabels=[])<font></font>
<font></font>
<span class="hljs-comment"># Scatterplot on main ax</span>
ax_main.scatter(<span class="hljs-string">'displ'</span>, <span class="hljs-string">'hwy'</span>, s=df.cty*<span class="hljs-number">5</span>, c=df.manufacturer.astype(<span class="hljs-string">'category'</span>).cat.codes, alpha=<span class="hljs-number">.9</span>, data=df, cmap=<span class="hljs-string">"Set1"</span>, edgecolors=<span class="hljs-string">'black'</span>, linewidths=<span class="hljs-number">.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Add a graph in each part</span>
sns.boxplot(df.hwy, ax=ax_right, orient=<span class="hljs-string">"v"</span>)<font></font>
sns.boxplot(df.displ, ax=ax_bottom, orient=<span class="hljs-string">"h"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations ------------------</span>
<span class="hljs-comment"># Remove x axis name for the boxplot</span>
ax_bottom.set(xlabel=<span class="hljs-string">''</span>)<font></font>
ax_right.set(ylabel=<span class="hljs-string">''</span>)<font></font>
<font></font>
<span class="hljs-comment"># Main Title, Xlabel and YLabel</span>
ax_main.set(title=<span class="hljs-string">'Scatterplot with Histograms \n displ vs hwy'</span>, xlabel=<span class="hljs-string">'displ'</span>, ylabel=<span class="hljs-string">'hwy'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Set font size of different components</span>
ax_main.title.set_fontsize(<span class="hljs-number">20</span>)
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> ([ax_main.xaxis.label, ax_main.yaxis.label] + ax_main.get_xticklabels() + ax_main.get_yticklabels()):<font></font>
    item.set_fontsize(<span class="hljs-number">14</span>)<font></font>
<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/3l/fq/wa/3lfqwa4qniqansvmy5eem7pjhcq.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.相関図</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相関図は、特定のデータセット（または2次元配列）内のすべての可能な数値変数のペア間の相関メトリックを視覚的に表示するために使用されます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Dataset</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.heatmap(df.corr(), xticklabels=df.corr().columns, yticklabels=df.corr().columns, cmap=<span class="hljs-string">'RdYlGn'</span>, center=<span class="hljs-number">0</span>, annot=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.title(<span class="hljs-string">'Correlogram of mtcars'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/bx/gr/8q/bxgr8qqv0r8ksv2xeebh9j2zirs.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.ペアスケジュール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
研究分析でよく使用され、数値変数のすべての可能なペア間の関係を理解し​​ます。</font><font style="vertical-align: inherit;">これは、2次元分析に必要なツールです。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Load Dataset</span>
df = sns.load_dataset(<span class="hljs-string">'iris'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">8</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.pairplot(df, kind=<span class="hljs-string">"scatter"</span>, hue=<span class="hljs-string">"species"</span>, plot_kws=dict(s=<span class="hljs-number">80</span>, edgecolor=<span class="hljs-string">"white"</span>, linewidth=<span class="hljs-number">2.5</span>))<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/l3/5n/rc/l35nrcu2srcuvvpdi6fiuwlxjsm.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Load Dataset</span>
df = sns.load_dataset(<span class="hljs-string">'iris'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">8</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.pairplot(df, kind=<span class="hljs-string">"reg"</span>, hue=<span class="hljs-string">"species"</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
 <img src="https://habrastorage.org/webt/b7/vc/bq/b7vcbqwg6gbebqeg8dlnutmpz5m.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">偏差</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.分岐する列</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要素が1つのメトリックに応じてどのように変化するかを確認し、この分散の次数と大きさを視覚化したい場合、分岐列は優れたツールです。</font><font style="vertical-align: inherit;">これは、データ内のグループのパフォーマンスをすばやく区別するのに役立ち、非常に直感的で、すぐに意味を伝えます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
x = df.loc[:, [<span class="hljs-string">'mpg'</span>]]<font></font>
df[<span class="hljs-string">'mpg_z'</span>] = (x - x.mean())/x.std()<font></font>
df[<span class="hljs-string">'colors'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'mpg_z'</span>]]<font></font>
df.sort_values(<span class="hljs-string">'mpg_z'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
plt.figure(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.hlines(y=df.index, xmin=<span class="hljs-number">0</span>, xmax=df.mpg_z, color=df.colors, alpha=<span class="hljs-number">0.4</span>, linewidth=<span class="hljs-number">5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.gca().set(ylabel=<span class="hljs-string">'$Model$'</span>, xlabel=<span class="hljs-string">'$Mileage$'</span>)<font></font>
plt.yticks(df.index, df.cars, fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">'Diverging Bars of Car Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">20</span>})<font></font>
plt.grid(linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/um/8o/na/um8onav0u5_esdezigrxhqm7hio.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11.テキストで列を分岐する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -分岐列に似ており、ダイアグラム内の各要素の重要性を適切で見やすい形で表示したい場合に適しています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
x = df.loc[:, [<span class="hljs-string">'mpg'</span>]]<font></font>
df[<span class="hljs-string">'mpg_z'</span>] = (x - x.mean())/x.std()<font></font>
df[<span class="hljs-string">'colors'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'mpg_z'</span>]]<font></font>
df.sort_values(<span class="hljs-string">'mpg_z'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
plt.figure(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">14</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.hlines(y=df.index, xmin=<span class="hljs-number">0</span>, xmax=df.mpg_z)
<span class="hljs-keyword">for</span> x, y, tex <span class="hljs-keyword">in</span> zip(df.mpg_z, df.index, df.mpg_z):<font></font>
    t = plt.text(x, y, round(tex, <span class="hljs-number">2</span>), horizontalalignment=<span class="hljs-string">'right'</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'left'</span>, <font></font>
                 verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'color'</span>:<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span>, <span class="hljs-string">'size'</span>:<span class="hljs-number">14</span>})<font></font>
<font></font>
<span class="hljs-comment"># Decorations    </span>
plt.yticks(df.index, df.cars, fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">'Diverging Text Bars of Car Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">20</span>})<font></font>
plt.grid(linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>)<font></font>
plt.xlim(<span class="hljs-number">-2.5</span>, <span class="hljs-number">2.5</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/mj/ew/m3/mjewm3kaqdsmr0xeibikn57fqsk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.分岐点</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分岐点のグラフも、分岐列と似ています。</font><font style="vertical-align: inherit;">ただし、発散する列と比較すると、列がないため、グループ間のコントラストと不一致の程度が小さくなります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
x = df.loc[:, [<span class="hljs-string">'mpg'</span>]]<font></font>
df[<span class="hljs-string">'mpg_z'</span>] = (x - x.mean())/x.std()<font></font>
df[<span class="hljs-string">'colors'</span>] = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'darkgreen'</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">'mpg_z'</span>]]<font></font>
df.sort_values(<span class="hljs-string">'mpg_z'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
plt.figure(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">16</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.scatter(df.mpg_z, df.index, s=<span class="hljs-number">450</span>, alpha=<span class="hljs-number">.6</span>, color=df.colors)
<span class="hljs-keyword">for</span> x, y, tex <span class="hljs-keyword">in</span> zip(df.mpg_z, df.index, df.mpg_z):<font></font>
    t = plt.text(x, y, round(tex, <span class="hljs-number">1</span>), horizontalalignment=<span class="hljs-string">'center'</span>, <font></font>
                 verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'color'</span>:<span class="hljs-string">'white'</span>})<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.yticks(df.index, df.cars)<font></font>
plt.title(<span class="hljs-string">'Diverging Dotplot of Car Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">20</span>})<font></font>
plt.xlabel(<span class="hljs-string">'$Mileage$'</span>)<font></font>
plt.grid(linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>)<font></font>
plt.xlim(<span class="hljs-number">-2.5</span>, <span class="hljs-number">2.5</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/1d/jo/zb/1djozbrk93362fhaqqiurq9n0bu.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13.マーカー付きの発散ロリポップチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lollipopは、注意を払いたい関連データポイントに焦点を合わせて、不一致を視覚化する柔軟な方法を提供します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
x = df.loc[:, [<span class="hljs-string">'mpg'</span>]]<font></font>
df[<span class="hljs-string">'mpg_z'</span>] = (x - x.mean())/x.std()<font></font>
df[<span class="hljs-string">'colors'</span>] = <span class="hljs-string">'black'</span><font></font>
<font></font>
<span class="hljs-comment"># color fiat differently</span>
df.loc[df.cars == <span class="hljs-string">'Fiat X1-9'</span>, <span class="hljs-string">'colors'</span>] = <span class="hljs-string">'darkorange'</span>
df.sort_values(<span class="hljs-string">'mpg_z'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
<span class="hljs-keyword">import</span> matplotlib.patches <span class="hljs-keyword">as</span> patches<font></font>
<font></font>
plt.figure(figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">16</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.hlines(y=df.index, xmin=<span class="hljs-number">0</span>, xmax=df.mpg_z, color=df.colors, alpha=<span class="hljs-number">0.4</span>, linewidth=<span class="hljs-number">1</span>)<font></font>
plt.scatter(df.mpg_z, df.index, color=df.colors, s=[<span class="hljs-number">600</span> <span class="hljs-keyword">if</span> x == <span class="hljs-string">'Fiat X1-9'</span> <span class="hljs-keyword">else</span> <span class="hljs-number">300</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df.cars], alpha=<span class="hljs-number">0.6</span>)<font></font>
plt.yticks(df.index, df.cars)<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate</span>
plt.annotate(<span class="hljs-string">'Mercedes Models'</span>, xy=(<span class="hljs-number">0.0</span>, <span class="hljs-number">11.0</span>), xytext=(<span class="hljs-number">1.0</span>, <span class="hljs-number">11</span>), xycoords=<span class="hljs-string">'data'</span>, <font></font>
            fontsize=<span class="hljs-number">15</span>, ha=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'center'</span>,<font></font>
            bbox=dict(boxstyle=<span class="hljs-string">'square'</span>, fc=<span class="hljs-string">'firebrick'</span>),<font></font>
            arrowprops=dict(arrowstyle=<span class="hljs-string">'-[, widthB=2.0, lengthB=1.5'</span>, lw=<span class="hljs-number">2.0</span>, color=<span class="hljs-string">'steelblue'</span>), color=<span class="hljs-string">'white'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Add Patches</span>
p1 = patches.Rectangle((<span class="hljs-number">-2.0</span>, <span class="hljs-number">-1</span>), width=<span class="hljs-number">.3</span>, height=<span class="hljs-number">3</span>, alpha=<span class="hljs-number">.2</span>, facecolor=<span class="hljs-string">'red'</span>)<font></font>
p2 = patches.Rectangle((<span class="hljs-number">1.5</span>, <span class="hljs-number">27</span>), width=<span class="hljs-number">.8</span>, height=<span class="hljs-number">5</span>, alpha=<span class="hljs-number">.2</span>, facecolor=<span class="hljs-string">'green'</span>)<font></font>
plt.gca().add_patch(p1)<font></font>
plt.gca().add_patch(p2)<font></font>
<font></font>
<span class="hljs-comment"># Decorate</span>
plt.title(<span class="hljs-string">'Diverging Bars of Car Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">20</span>})<font></font>
plt.grid(linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/y-/dz/ke/y-dzkeakaw6srdwg1ygg3v9f_ei.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.面グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
軸と線の間のエリアに色を付けると、エリアダイアグラムはピークと谷を強調しますが、高値と安値の期間も強調します。</font><font style="vertical-align: inherit;">ピークが長いほど、線の下の領域が広くなります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/economics.csv"</span>, parse_dates=[<span class="hljs-string">'date'</span>]).head(<span class="hljs-number">100</span>)<font></font>
x = np.arange(df.shape[<span class="hljs-number">0</span>])<font></font>
y_returns = (df.psavert.diff().fillna(<span class="hljs-number">0</span>)/df.psavert.shift(<span class="hljs-number">1</span>)).fillna(<span class="hljs-number">0</span>) * <span class="hljs-number">100</span><font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.fill_between(x[<span class="hljs-number">1</span>:], y_returns[<span class="hljs-number">1</span>:], <span class="hljs-number">0</span>, where=y_returns[<span class="hljs-number">1</span>:] &gt;= <span class="hljs-number">0</span>, facecolor=<span class="hljs-string">'green'</span>, interpolate=<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
plt.fill_between(x[<span class="hljs-number">1</span>:], y_returns[<span class="hljs-number">1</span>:], <span class="hljs-number">0</span>, where=y_returns[<span class="hljs-number">1</span>:] &lt;= <span class="hljs-number">0</span>, facecolor=<span class="hljs-string">'red'</span>, interpolate=<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate</span>
plt.annotate(<span class="hljs-string">'Peak \n1975'</span>, xy=(<span class="hljs-number">94.0</span>, <span class="hljs-number">21.0</span>), xytext=(<span class="hljs-number">88.0</span>, <span class="hljs-number">28</span>),<font></font>
             bbox=dict(boxstyle=<span class="hljs-string">'square'</span>, fc=<span class="hljs-string">'firebrick'</span>),<font></font>
             arrowprops=dict(facecolor=<span class="hljs-string">'steelblue'</span>, shrink=<span class="hljs-number">0.05</span>), fontsize=<span class="hljs-number">15</span>, color=<span class="hljs-string">'white'</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
xtickvals = [str(m)[:<span class="hljs-number">3</span>].upper()+<span class="hljs-string">"-"</span>+str(y) <span class="hljs-keyword">for</span> y,m <span class="hljs-keyword">in</span> zip(df.date.dt.year, df.date.dt.month_name())]<font></font>
plt.gca().set_xticks(x[::<span class="hljs-number">6</span>])<font></font>
plt.gca().set_xticklabels(xtickvals[::<span class="hljs-number">6</span>], rotation=<span class="hljs-number">90</span>, fontdict={<span class="hljs-string">'horizontalalignment'</span>: <span class="hljs-string">'center'</span>, <span class="hljs-string">'verticalalignment'</span>: <span class="hljs-string">'center_baseline'</span>})<font></font>
plt.ylim(<span class="hljs-number">-35</span>,<span class="hljs-number">35</span>)<font></font>
plt.xlim(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)<font></font>
plt.title(<span class="hljs-string">"Month Economics Return %"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Monthly returns %'</span>)<font></font>
plt.grid(alpha=<span class="hljs-number">0.5</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/az/tl/hz/aztlhzdib5bvleiksqjq8cdgc5e.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レンジング</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15.順序付けられたヒストグラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
順序付けられたヒストグラムは、要素のランキング順序を効果的に伝えます。</font><font style="vertical-align: inherit;">ただし、グラフの上にメトリック値を追加することにより、ユーザーはグラフ自体から正確な情報を受け取ります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
df = df_raw[[<span class="hljs-string">'cty'</span>, <span class="hljs-string">'manufacturer'</span>]].groupby(<span class="hljs-string">'manufacturer'</span>).apply(<span class="hljs-keyword">lambda</span> x: x.mean())<font></font>
df.sort_values(<span class="hljs-string">'cty'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
<span class="hljs-keyword">import</span> matplotlib.patches <span class="hljs-keyword">as</span> patches<font></font>
<font></font>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), facecolor=<span class="hljs-string">'white'</span>, dpi= <span class="hljs-number">80</span>)<font></font>
ax.vlines(x=df.index, ymin=<span class="hljs-number">0</span>, ymax=df.cty, color=<span class="hljs-string">'firebrick'</span>, alpha=<span class="hljs-number">0.7</span>, linewidth=<span class="hljs-number">20</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate Text</span>
<span class="hljs-keyword">for</span> i, cty <span class="hljs-keyword">in</span> enumerate(df.cty):<font></font>
    ax.text(i, cty+<span class="hljs-number">0.5</span>, round(cty, <span class="hljs-number">1</span>), horizontalalignment=<span class="hljs-string">'center'</span>)<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># Title, Label, Ticks and Ylim</span>
ax.set_title(<span class="hljs-string">'Bar Chart for Highway Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set(ylabel=<span class="hljs-string">'Miles Per Gallon'</span>, ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">30</span>))<font></font>
plt.xticks(df.index, df.manufacturer.str.upper(), rotation=<span class="hljs-number">60</span>, horizontalalignment=<span class="hljs-string">'right'</span>, fontsize=<span class="hljs-number">12</span>)<font></font>
<font></font>
<span class="hljs-comment"># Add patches to color the X axis labels</span>
p1 = patches.Rectangle((<span class="hljs-number">.57</span>, <span class="hljs-number">-0.005</span>), width=<span class="hljs-number">.33</span>, height=<span class="hljs-number">.13</span>, alpha=<span class="hljs-number">.1</span>, facecolor=<span class="hljs-string">'green'</span>, transform=fig.transFigure)<font></font>
p2 = patches.Rectangle((<span class="hljs-number">.124</span>, <span class="hljs-number">-0.005</span>), width=<span class="hljs-number">.446</span>, height=<span class="hljs-number">.13</span>, alpha=<span class="hljs-number">.1</span>, facecolor=<span class="hljs-string">'red'</span>, transform=fig.transFigure)<font></font>
fig.add_artist(p1)<font></font>
fig.add_artist(p2)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/py/m1/2k/pym12kmdmbv6gyn16pdhncin9oe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.ロリポップチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロリポップチャートは、視覚的に楽しい方法で順序付けられたヒストグラムと同じ目的を果たします。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
df = df_raw[[<span class="hljs-string">'cty'</span>, <span class="hljs-string">'manufacturer'</span>]].groupby(<span class="hljs-string">'manufacturer'</span>).apply(<span class="hljs-keyword">lambda</span> x: x.mean())<font></font>
df.sort_values(<span class="hljs-string">'cty'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
ax.vlines(x=df.index, ymin=<span class="hljs-number">0</span>, ymax=df.cty, color=<span class="hljs-string">'firebrick'</span>, alpha=<span class="hljs-number">0.7</span>, linewidth=<span class="hljs-number">2</span>)<font></font>
ax.scatter(x=df.index, y=df.cty, s=<span class="hljs-number">75</span>, color=<span class="hljs-string">'firebrick'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Title, Label, Ticks and Ylim</span>
ax.set_title(<span class="hljs-string">'Lollipop Chart for Highway Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set_ylabel(<span class="hljs-string">'Miles Per Gallon'</span>)<font></font>
ax.set_xticks(df.index)<font></font>
ax.set_xticklabels(df.manufacturer.str.upper(), rotation=<span class="hljs-number">60</span>, fontdict={<span class="hljs-string">'horizontalalignment'</span>: <span class="hljs-string">'right'</span>, <span class="hljs-string">'size'</span>:<span class="hljs-number">12</span>})<font></font>
ax.set_ylim(<span class="hljs-number">0</span>, <span class="hljs-number">30</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate</span>
<span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> df.itertuples():<font></font>
    ax.text(row.Index, row.cty+<span class="hljs-number">.5</span>, s=round(row.cty, <span class="hljs-number">2</span>), horizontalalignment= <span class="hljs-string">'center'</span>, verticalalignment=<span class="hljs-string">'bottom'</span>, fontsize=<span class="hljs-number">14</span>)<font></font>
<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/f3/yp/20/f3yp20u2l7y0wak5asj3epjdm78.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.署名付きの点線グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
散布図は、アイテムのランキングを示します。</font><font style="vertical-align: inherit;">また、水平軸に沿って配置されているため、ポイントが互いにどのくらい離れているかを視覚的に評価できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Prepare Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
df = df_raw[[<span class="hljs-string">'cty'</span>, <span class="hljs-string">'manufacturer'</span>]].groupby(<span class="hljs-string">'manufacturer'</span>).apply(<span class="hljs-keyword">lambda</span> x: x.mean())<font></font>
df.sort_values(<span class="hljs-string">'cty'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw plot</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
ax.hlines(y=df.index, xmin=<span class="hljs-number">11</span>, xmax=<span class="hljs-number">26</span>, color=<span class="hljs-string">'gray'</span>, alpha=<span class="hljs-number">0.7</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dashdot'</span>)<font></font>
ax.scatter(y=df.index, x=df.cty, s=<span class="hljs-number">75</span>, color=<span class="hljs-string">'firebrick'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Title, Label, Ticks and Ylim</span>
ax.set_title(<span class="hljs-string">'Dot Plot for Highway Mileage'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set_xlabel(<span class="hljs-string">'Miles Per Gallon'</span>)<font></font>
ax.set_yticks(df.index)<font></font>
ax.set_yticklabels(df.manufacturer.str.title(), fontdict={<span class="hljs-string">'horizontalalignment'</span>: <span class="hljs-string">'right'</span>})<font></font>
ax.set_xlim(<span class="hljs-number">10</span>, <span class="hljs-number">27</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/br/zl/gz/brzlgzmep-b4lwiasjknmo6ljia.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18.傾斜マップ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スロープチャートは、特定の人物/被験者の「前」と「後」の位置を比較するのに最適です。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.lines <span class="hljs-keyword">as</span> mlines
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/gdppercap.csv"</span>)<font></font>
<font></font>
left_label = [str(c) + <span class="hljs-string">', '</span>+ str(round(y)) <span class="hljs-keyword">for</span> c, y <span class="hljs-keyword">in</span> zip(df.continent, df[<span class="hljs-string">'1952'</span>])]<font></font>
right_label = [str(c) + <span class="hljs-string">', '</span>+ str(round(y)) <span class="hljs-keyword">for</span> c, y <span class="hljs-keyword">in</span> zip(df.continent, df[<span class="hljs-string">'1957'</span>])]<font></font>
klass = [<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> (y1-y2) &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span> <span class="hljs-keyword">for</span> y1, y2 <span class="hljs-keyword">in</span> zip(df[<span class="hljs-string">'1952'</span>], df[<span class="hljs-string">'1957'</span>])]<font></font>
<font></font>
<span class="hljs-comment"># draw line</span>
<span class="hljs-comment"># https://stackoverflow.com/questions/36470343/how-to-draw-a-line-with-matplotlib/36479941</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newline</span>(<span class="hljs-params">p1, p2, color=<span class="hljs-string">'black'</span></span>):</span><font></font>
    ax = plt.gca()<font></font>
    l = mlines.Line2D([p1[<span class="hljs-number">0</span>],p2[<span class="hljs-number">0</span>]], [p1[<span class="hljs-number">1</span>],p2[<span class="hljs-number">1</span>]], color=<span class="hljs-string">'red'</span> <span class="hljs-keyword">if</span> p1[<span class="hljs-number">1</span>]-p2[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'green'</span>, marker=<span class="hljs-string">'o'</span>, markersize=<span class="hljs-number">6</span>)<font></font>
    ax.add_line(l)<font></font>
    <span class="hljs-keyword">return</span> l<font></font>
<font></font>
fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">14</span>), dpi= <span class="hljs-number">80</span>)<font></font>
<font></font>
<span class="hljs-comment"># Vertical Lines</span>
ax.vlines(x=<span class="hljs-number">1</span>, ymin=<span class="hljs-number">500</span>, ymax=<span class="hljs-number">13000</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.7</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
ax.vlines(x=<span class="hljs-number">3</span>, ymin=<span class="hljs-number">500</span>, ymax=<span class="hljs-number">13000</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.7</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Points</span>
ax.scatter(y=df[<span class="hljs-string">'1952'</span>], x=np.repeat(<span class="hljs-number">1</span>, df.shape[<span class="hljs-number">0</span>]), s=<span class="hljs-number">10</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
ax.scatter(y=df[<span class="hljs-string">'1957'</span>], x=np.repeat(<span class="hljs-number">3</span>, df.shape[<span class="hljs-number">0</span>]), s=<span class="hljs-number">10</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Line Segmentsand Annotation</span>
<span class="hljs-keyword">for</span> p1, p2, c <span class="hljs-keyword">in</span> zip(df[<span class="hljs-string">'1952'</span>], df[<span class="hljs-string">'1957'</span>], df[<span class="hljs-string">'continent'</span>]):<font></font>
    newline([<span class="hljs-number">1</span>,p1], [<span class="hljs-number">3</span>,p2])<font></font>
    ax.text(<span class="hljs-number">1</span><span class="hljs-number">-0.05</span>, p1, c + <span class="hljs-string">', '</span> + str(round(p1)), horizontalalignment=<span class="hljs-string">'right'</span>, verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">14</span>})<font></font>
    ax.text(<span class="hljs-number">3</span>+<span class="hljs-number">0.05</span>, p2, c + <span class="hljs-string">', '</span> + str(round(p2)), horizontalalignment=<span class="hljs-string">'left'</span>, verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">14</span>})<font></font>
<font></font>
<span class="hljs-comment"># 'Before' and 'After' Annotations</span>
ax.text(<span class="hljs-number">1</span><span class="hljs-number">-0.05</span>, <span class="hljs-number">13000</span>, <span class="hljs-string">'BEFORE'</span>, horizontalalignment=<span class="hljs-string">'right'</span>, verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">18</span>, <span class="hljs-string">'weight'</span>:<span class="hljs-number">700</span>})<font></font>
ax.text(<span class="hljs-number">3</span>+<span class="hljs-number">0.05</span>, <span class="hljs-number">13000</span>, <span class="hljs-string">'AFTER'</span>, horizontalalignment=<span class="hljs-string">'left'</span>, verticalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">18</span>, <span class="hljs-string">'weight'</span>:<span class="hljs-number">700</span>})<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
ax.set_title(<span class="hljs-string">"Slopechart: Comparing GDP Per Capita between 1952 vs 1957"</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set(xlim=(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>), ylim=(<span class="hljs-number">0</span>,<span class="hljs-number">14000</span>), ylabel=<span class="hljs-string">'Mean GDP Per Capita'</span>)<font></font>
ax.set_xticks([<span class="hljs-number">1</span>,<span class="hljs-number">3</span>])<font></font>
ax.set_xticklabels([<span class="hljs-string">"1952"</span>, <span class="hljs-string">"1957"</span>])<font></font>
plt.yticks(np.arange(<span class="hljs-number">500</span>, <span class="hljs-number">13000</span>, <span class="hljs-number">2000</span>), fontsize=<span class="hljs-number">12</span>)<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/m2/m6/bg/m2m6bgm4jzsjlxet6lkqfmdl3ra.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.「ダンベル」</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ダンベル」グラフは、さまざまな影響の「前」と「後」の位置、およびアイテムのランキング順序を示します。</font><font style="vertical-align: inherit;">これは、さまざまなオブジェクトに対する何かの効果を視覚化する場合に非常に役立ちます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.lines <span class="hljs-keyword">as</span> mlines<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/health.csv"</span>)<font></font>
df.sort_values(<span class="hljs-string">'pct_2014'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Func to draw line segment</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newline</span>(<span class="hljs-params">p1, p2, color=<span class="hljs-string">'black'</span></span>):</span><font></font>
    ax = plt.gca()<font></font>
    l = mlines.Line2D([p1[<span class="hljs-number">0</span>],p2[<span class="hljs-number">0</span>]], [p1[<span class="hljs-number">1</span>],p2[<span class="hljs-number">1</span>]], color=<span class="hljs-string">'skyblue'</span>)<font></font>
    ax.add_line(l)<font></font>
    <span class="hljs-keyword">return</span> l<font></font>
<font></font>
<span class="hljs-comment"># Figure and Axes</span>
fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">14</span>), facecolor=<span class="hljs-string">'#f7f7f7'</span>, dpi= <span class="hljs-number">80</span>)<font></font>
<font></font>
<span class="hljs-comment"># Vertical Lines</span>
ax.vlines(x=<span class="hljs-number">.05</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">26</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">1</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
ax.vlines(x=<span class="hljs-number">.10</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">26</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">1</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
ax.vlines(x=<span class="hljs-number">.15</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">26</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">1</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
ax.vlines(x=<span class="hljs-number">.20</span>, ymin=<span class="hljs-number">0</span>, ymax=<span class="hljs-number">26</span>, color=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">1</span>, linewidth=<span class="hljs-number">1</span>, linestyles=<span class="hljs-string">'dotted'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Points</span>
ax.scatter(y=df[<span class="hljs-string">'index'</span>], x=df[<span class="hljs-string">'pct_2013'</span>], s=<span class="hljs-number">50</span>, color=<span class="hljs-string">'#0e668b'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
ax.scatter(y=df[<span class="hljs-string">'index'</span>], x=df[<span class="hljs-string">'pct_2014'</span>], s=<span class="hljs-number">50</span>, color=<span class="hljs-string">'#a3c4dc'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Line Segments</span>
<span class="hljs-keyword">for</span> i, p1, p2 <span class="hljs-keyword">in</span> zip(df[<span class="hljs-string">'index'</span>], df[<span class="hljs-string">'pct_2013'</span>], df[<span class="hljs-string">'pct_2014'</span>]):<font></font>
    newline([p1, i], [p2, i])<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
ax.set_facecolor(<span class="hljs-string">'#f7f7f7'</span>)<font></font>
ax.set_title(<span class="hljs-string">"Dumbell Chart: Pct Change - 2013 vs 2014"</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set(xlim=(<span class="hljs-number">0</span>,<span class="hljs-number">.25</span>), ylim=(<span class="hljs-number">-1</span>, <span class="hljs-number">27</span>), ylabel=<span class="hljs-string">'Mean GDP Per Capita'</span>)<font></font>
ax.set_xticks([<span class="hljs-number">.05</span>, <span class="hljs-number">.1</span>, <span class="hljs-number">.15</span>, <span class="hljs-number">.20</span>])<font></font>
ax.set_xticklabels([<span class="hljs-string">'5%'</span>, <span class="hljs-string">'15%'</span>, <span class="hljs-string">'20%'</span>, <span class="hljs-string">'25%'</span>])<font></font>
ax.set_xticklabels([<span class="hljs-string">'5%'</span>, <span class="hljs-string">'15%'</span>, <span class="hljs-string">'20%'</span>, <span class="hljs-string">'25%'</span>])    <font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/fg/fu/xe/fgfuxesxmltrzrsbd5m1jdv5asu.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分布</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20.連続変数のヒストグラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヒストグラムは、この変数の度数分布を示しています。</font><font style="vertical-align: inherit;">次のプレゼンテーションは、カテゴリ変数に基づいて周波数帯域をグループ化しています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare data</span>
x_var = <span class="hljs-string">'displ'</span>
groupby_var = <span class="hljs-string">'class'</span><font></font>
df_agg = df.loc[:, [x_var, groupby_var]].groupby(groupby_var)<font></font>
vals = [df[x_var].values.tolist() <span class="hljs-keyword">for</span> i, df <span class="hljs-keyword">in</span> df_agg]<font></font>
<font></font>
<span class="hljs-comment"># Draw</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
colors = [plt.cm.Spectral(i/float(len(vals)<span class="hljs-number">-1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))]<font></font>
n, bins, patches = plt.hist(vals, <span class="hljs-number">30</span>, stacked=<span class="hljs-literal">True</span>, density=<span class="hljs-literal">False</span>, color=colors[:len(vals)])<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.legend({group:col <span class="hljs-keyword">for</span> group, col <span class="hljs-keyword">in</span> zip(np.unique(df[groupby_var]).tolist(), colors[:len(vals)])})<font></font>
plt.title(<span class="hljs-string">f"Stacked Histogram of $<span class="hljs-subst">{x_var}</span>$ colored by $<span class="hljs-subst">{groupby_var}</span>$"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xlabel(x_var)<font></font>
plt.ylabel(<span class="hljs-string">"Frequency"</span>)<font></font>
plt.ylim(<span class="hljs-number">0</span>, <span class="hljs-number">25</span>)<font></font>
plt.xticks(ticks=bins[::<span class="hljs-number">3</span>], labels=[round(b,<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bins[::<span class="hljs-number">3</span>]])<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/8a/2k/ds/8a2kds04cklb8osl4vt4gijz5sa.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21.カテゴリー変数のヒストグラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カテゴリー変数のヒストグラムは、この変数の頻度分布を示します。</font><font style="vertical-align: inherit;">列に色を付けると、色を表す別のカテゴリ変数との関係で分布を視覚化できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare data</span>
x_var = <span class="hljs-string">'manufacturer'</span>
groupby_var = <span class="hljs-string">'class'</span><font></font>
df_agg = df.loc[:, [x_var, groupby_var]].groupby(groupby_var)<font></font>
vals = [df[x_var].values.tolist() <span class="hljs-keyword">for</span> i, df <span class="hljs-keyword">in</span> df_agg]<font></font>
<font></font>
<span class="hljs-comment"># Draw</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
colors = [plt.cm.Spectral(i/float(len(vals)<span class="hljs-number">-1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(vals))]<font></font>
n, bins, patches = plt.hist(vals, df[x_var].unique().__len__(), stacked=<span class="hljs-literal">True</span>, density=<span class="hljs-literal">False</span>, color=colors[:len(vals)])<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.legend({group:col <span class="hljs-keyword">for</span> group, col <span class="hljs-keyword">in</span> zip(np.unique(df[groupby_var]).tolist(), colors[:len(vals)])})<font></font>
plt.title(<span class="hljs-string">f"Stacked Histogram of $<span class="hljs-subst">{x_var}</span>$ colored by $<span class="hljs-subst">{groupby_var}</span>$"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xlabel(x_var)<font></font>
plt.ylabel(<span class="hljs-string">"Frequency"</span>)<font></font>
plt.ylim(<span class="hljs-number">0</span>, <span class="hljs-number">40</span>)<font></font>
plt.xticks(ticks=bins, labels=np.unique(df[x_var]).tolist(), rotation=<span class="hljs-number">90</span>, horizontalalignment=<span class="hljs-string">'left'</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/mr/c7/6y/mrc76yjwi_mq2vdcdcjrqhpd0pg.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22.密度グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
密度グラフは、連続変数の分布を視覚化するために広く使用されているツールです。</font><font style="vertical-align: inherit;">それらを変数「応答」でグループ化すると、XとYの関係を確認できます。以下は、明確にするために、シリンダーの数によって都市の走行距離の分布がどのように変化するかを説明する例です。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.kdeplot(df.loc[df[<span class="hljs-string">'cyl'</span>] == <span class="hljs-number">4</span>, <span class="hljs-string">"cty"</span>], shade=<span class="hljs-literal">True</span>, color=<span class="hljs-string">"g"</span>, label=<span class="hljs-string">"Cyl=4"</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
sns.kdeplot(df.loc[df[<span class="hljs-string">'cyl'</span>] == <span class="hljs-number">5</span>, <span class="hljs-string">"cty"</span>], shade=<span class="hljs-literal">True</span>, color=<span class="hljs-string">"deeppink"</span>, label=<span class="hljs-string">"Cyl=5"</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
sns.kdeplot(df.loc[df[<span class="hljs-string">'cyl'</span>] == <span class="hljs-number">6</span>, <span class="hljs-string">"cty"</span>], shade=<span class="hljs-literal">True</span>, color=<span class="hljs-string">"dodgerblue"</span>, label=<span class="hljs-string">"Cyl=6"</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
sns.kdeplot(df.loc[df[<span class="hljs-string">'cyl'</span>] == <span class="hljs-number">8</span>, <span class="hljs-string">"cty"</span>], shade=<span class="hljs-literal">True</span>, color=<span class="hljs-string">"orange"</span>, label=<span class="hljs-string">"Cyl=8"</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Density Plot of City Mileage by n_Cylinders'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend()<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/wb/ir/sx/wbirsxdpgtbuinkmarizydudkpe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23.ヒストグラム付きの密度曲線</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヒストグラム付きの密度曲線は、2つのグラフによって送信された要約情報を組み合わせているため、両方を1か所で確認できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">13</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.distplot(df.loc[df[<span class="hljs-string">'class'</span>] == <span class="hljs-string">'compact'</span>, <span class="hljs-string">"cty"</span>], color=<span class="hljs-string">"dodgerblue"</span>, label=<span class="hljs-string">"Compact"</span>, hist_kws={<span class="hljs-string">'alpha'</span>:<span class="hljs-number">.7</span>}, kde_kws={<span class="hljs-string">'linewidth'</span>:<span class="hljs-number">3</span>})<font></font>
sns.distplot(df.loc[df[<span class="hljs-string">'class'</span>] == <span class="hljs-string">'suv'</span>, <span class="hljs-string">"cty"</span>], color=<span class="hljs-string">"orange"</span>, label=<span class="hljs-string">"SUV"</span>, hist_kws={<span class="hljs-string">'alpha'</span>:<span class="hljs-number">.7</span>}, kde_kws={<span class="hljs-string">'linewidth'</span>:<span class="hljs-number">3</span>})<font></font>
sns.distplot(df.loc[df[<span class="hljs-string">'class'</span>] == <span class="hljs-string">'minivan'</span>, <span class="hljs-string">"cty"</span>], color=<span class="hljs-string">"g"</span>, label=<span class="hljs-string">"minivan"</span>, hist_kws={<span class="hljs-string">'alpha'</span>:<span class="hljs-number">.7</span>}, kde_kws={<span class="hljs-string">'linewidth'</span>:<span class="hljs-number">3</span>})<font></font>
plt.ylim(<span class="hljs-number">0</span>, <span class="hljs-number">0.35</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Density Plot of City Mileage by Vehicle Type'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend()<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ms/db/8_/msdb8_z8c4bo6ztihrk0c3n_3cs.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24.喜びのグラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジョイチャートを使用すると、さまざまなグループの密度曲線を重ねることができます。これは、多数のグループの分布を相互に関連させて視覚化するための優れた方法です。</font><font style="vertical-align: inherit;">見た目も楽しいし、正しい情報だけがはっきり伝わる。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># !pip install joypy</span>
<span class="hljs-comment"># Import Data</span>
mpg = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
fig, axes = joypy.joyplot(mpg, column=[<span class="hljs-string">'hwy'</span>, <span class="hljs-string">'cty'</span>], by=<span class="hljs-string">"class"</span>, ylim=<span class="hljs-string">'own'</span>, figsize=(<span class="hljs-number">14</span>,<span class="hljs-number">10</span>))<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Joy Plot of City and Highway Mileage by Class'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/6l/zd/5g/6lzd5gbesikmcrdlth3zcd8wgyw.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25.分散散布図</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分散散布図は、グループに分割された点の一次元分布を示しています。</font><font style="vertical-align: inherit;">ポイントが暗いほど、この領域のデータポイントの集中度が高くなります。</font><font style="vertical-align: inherit;">さまざまな方法で、中央値を色付けすると、グループの実際の配置がすぐに明らかになります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib.patches <span class="hljs-keyword">as</span> mpatches<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
cyl_colors = {<span class="hljs-number">4</span>:<span class="hljs-string">'tab:red'</span>, <span class="hljs-number">5</span>:<span class="hljs-string">'tab:green'</span>, <span class="hljs-number">6</span>:<span class="hljs-string">'tab:blue'</span>, <span class="hljs-number">8</span>:<span class="hljs-string">'tab:orange'</span>}<font></font>
df_raw[<span class="hljs-string">'cyl_color'</span>] = df_raw.cyl.map(cyl_colors)<font></font>
<font></font>
<span class="hljs-comment"># Mean and Median city mileage by make</span>
df = df_raw[[<span class="hljs-string">'cty'</span>, <span class="hljs-string">'manufacturer'</span>]].groupby(<span class="hljs-string">'manufacturer'</span>).apply(<span class="hljs-keyword">lambda</span> x: x.mean())<font></font>
df.sort_values(<span class="hljs-string">'cty'</span>, ascending=<span class="hljs-literal">False</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.reset_index(inplace=<span class="hljs-literal">True</span>)<font></font>
df_median = df_raw[[<span class="hljs-string">'cty'</span>, <span class="hljs-string">'manufacturer'</span>]].groupby(<span class="hljs-string">'manufacturer'</span>).apply(<span class="hljs-keyword">lambda</span> x: x.median())<font></font>
<font></font>
<span class="hljs-comment"># Draw horizontal lines</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
ax.hlines(y=df.index, xmin=<span class="hljs-number">0</span>, xmax=<span class="hljs-number">40</span>, color=<span class="hljs-string">'gray'</span>, alpha=<span class="hljs-number">0.5</span>, linewidth=<span class="hljs-number">.5</span>, linestyles=<span class="hljs-string">'dashdot'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw the Dots</span>
<span class="hljs-keyword">for</span> i, make <span class="hljs-keyword">in</span> enumerate(df.manufacturer):<font></font>
    df_make = df_raw.loc[df_raw.manufacturer==make, :]<font></font>
    ax.scatter(y=np.repeat(i, df_make.shape[<span class="hljs-number">0</span>]), x=<span class="hljs-string">'cty'</span>, data=df_make, s=<span class="hljs-number">75</span>, edgecolors=<span class="hljs-string">'gray'</span>, c=<span class="hljs-string">'w'</span>, alpha=<span class="hljs-number">0.5</span>)<font></font>
    ax.scatter(y=i, x=<span class="hljs-string">'cty'</span>, data=df_median.loc[df_median.index==make, :], s=<span class="hljs-number">75</span>, c=<span class="hljs-string">'firebrick'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate    </span>
ax.text(<span class="hljs-number">33</span>, <span class="hljs-number">13</span>, <span class="hljs-string">"$red \; dots \; are \; the \: median$"</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">12</span>}, color=<span class="hljs-string">'firebrick'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
red_patch = plt.plot([],[], marker=<span class="hljs-string">"o"</span>, ms=<span class="hljs-number">10</span>, ls=<span class="hljs-string">""</span>, mec=<span class="hljs-literal">None</span>, color=<span class="hljs-string">'firebrick'</span>, label=<span class="hljs-string">"Median"</span>)<font></font>
plt.legend(handles=red_patch)<font></font>
ax.set_title(<span class="hljs-string">'Distribution of City Mileage by Make'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">22</span>})<font></font>
ax.set_xlabel(<span class="hljs-string">'Miles Per Gallon (City)'</span>, alpha=<span class="hljs-number">0.7</span>)<font></font>
ax.set_yticks(df.index)<font></font>
ax.set_yticklabels(df.manufacturer.str.title(), fontdict={<span class="hljs-string">'horizontalalignment'</span>: <span class="hljs-string">'right'</span>}, alpha=<span class="hljs-number">0.7</span>)<font></font>
ax.set_xlim(<span class="hljs-number">1</span>, <span class="hljs-number">40</span>)<font></font>
plt.xticks(alpha=<span class="hljs-number">0.7</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_visible(<span class="hljs-literal">False</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_visible(<span class="hljs-literal">False</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_visible(<span class="hljs-literal">False</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_visible(<span class="hljs-literal">False</span>)   <font></font>
plt.grid(axis=<span class="hljs-string">'both'</span>, alpha=<span class="hljs-number">.4</span>, linewidth=<span class="hljs-number">.1</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/dx/_p/6t/dx_p6t-5fbud-dbwtlxla0ysgyc.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26.長方形のあるチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなグラフは、中央値、25、75の四分位数、および高値と安値を知って、分布を視覚化するための優れた方法です。</font><font style="vertical-align: inherit;">ただし、フィールドのサイズを解釈するときは注意が必要です。これにより、このグループに含まれるポイントの数が歪む可能性があります。</font><font style="vertical-align: inherit;">したがって、各セルの観測数を手動で表示すると、この欠点の克服に役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、左側の最初の2つの長方形は同じサイズですが、それぞれ5および47のデータ要素があります。</font><font style="vertical-align: inherit;">したがって、観測数に注意する必要があります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">13</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.boxplot(x=<span class="hljs-string">'class'</span>, y=<span class="hljs-string">'hwy'</span>, data=df, notch=<span class="hljs-literal">False</span>)<font></font>
<font></font>
<span class="hljs-comment"># Add N Obs inside boxplot (optional)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_n_obs</span>(<span class="hljs-params">df,group_col,y</span>):</span>
    medians_dict = {grp[<span class="hljs-number">0</span>]:grp[<span class="hljs-number">1</span>][y].median() <span class="hljs-keyword">for</span> grp <span class="hljs-keyword">in</span> df.groupby(group_col)}<font></font>
    xticklabels = [x.get_text() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> plt.gca().get_xticklabels()]<font></font>
    n_obs = df.groupby(group_col)[y].size().values<font></font>
    <span class="hljs-keyword">for</span> (x, xticklabel), n_ob <span class="hljs-keyword">in</span> zip(enumerate(xticklabels), n_obs):<font></font>
        plt.text(x, medians_dict[xticklabel]*<span class="hljs-number">1.01</span>, <span class="hljs-string">"#obs : "</span>+str(n_ob), horizontalalignment=<span class="hljs-string">'center'</span>, fontdict={<span class="hljs-string">'size'</span>:<span class="hljs-number">14</span>}, color=<span class="hljs-string">'white'</span>)<font></font>
<font></font>
add_n_obs(df,group_col=<span class="hljs-string">'class'</span>,y=<span class="hljs-string">'hwy'</span>)    <font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Box Plot of Highway Mileage by Vehicle Class'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.ylim(<span class="hljs-number">10</span>, <span class="hljs-number">40</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/gz/n_/hd/gzn_hdsn-2sugkdgnzotjtjpc4u.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.長方形とドットのあるチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドット+ボックスプロットは、ボックスプロットのようなグループに分割された同様の情報を送信します。</font><font style="vertical-align: inherit;">さらに、ドットは、各グループのデータ項目の数を示しています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">13</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.boxplot(x=<span class="hljs-string">'class'</span>, y=<span class="hljs-string">'hwy'</span>, data=df, hue=<span class="hljs-string">'cyl'</span>)<font></font>
sns.stripplot(x=<span class="hljs-string">'class'</span>, y=<span class="hljs-string">'hwy'</span>, data=df, color=<span class="hljs-string">'black'</span>, size=<span class="hljs-number">3</span>, jitter=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(df[<span class="hljs-string">'class'</span>].unique())<span class="hljs-number">-1</span>):<font></font>
    plt.vlines(i+<span class="hljs-number">.5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">45</span>, linestyles=<span class="hljs-string">'solid'</span>, colors=<span class="hljs-string">'gray'</span>, alpha=<span class="hljs-number">0.2</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Box Plot of Highway Mileage by Vehicle Class'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend(title=<span class="hljs-string">'Cylinders'</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/qn/0z/r7/qn0zr7pvqptrttthbqhnpjyu3iy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.「バイオリン」のスケジュール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのようなスケジュールは、箱ひげ図の視覚的に楽しい代替手段です。</font><font style="vertical-align: inherit;">「バイオリン」の形や面積は、このグループのデータ量によって異なります。</font><font style="vertical-align: inherit;">ただし、このようなグラフィックスは読みにくくなることがあり、通常、プロの設定では使用されません。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">13</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
sns.violinplot(x=<span class="hljs-string">'class'</span>, y=<span class="hljs-string">'hwy'</span>, data=df, scale=<span class="hljs-string">'width'</span>, inner=<span class="hljs-string">'quartile'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'Violin Plot of Highway Mileage by Vehicle Class'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ty/eg/cv/tyegcvu1g7pnl7z-jswcpzvh3ai.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">29.人口のピラミッド</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人口ピラミッドを使用して、ボリューム順に並べられたグループの分布を表示したり、以下に示すように人口の段階的なフィルタリングを表示したりして、マーケティング目標到達プロセスの各段階を通過する人数を視覚化できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Read data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/email_campaign_funnel.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">13</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
group_col = <span class="hljs-string">'Gender'</span>
order_of_bars = df.Stage.unique()[::<span class="hljs-number">-1</span>]<font></font>
colors = [plt.cm.Spectral(i/float(len(df[group_col].unique())<span class="hljs-number">-1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(df[group_col].unique()))]<font></font>
<font></font>
<span class="hljs-keyword">for</span> c, group <span class="hljs-keyword">in</span> zip(colors, df[group_col].unique()):<font></font>
    sns.barplot(x=<span class="hljs-string">'Users'</span>, y=<span class="hljs-string">'Stage'</span>, data=df.loc[df[group_col]==group, :], order=order_of_bars, color=c, label=group)<font></font>
<font></font>
<span class="hljs-comment"># Decorations    </span>
plt.xlabel(<span class="hljs-string">"$Users$"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Stage of Purchase"</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">"Population Pyramid of the Marketing Funnel"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.legend()<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/n3/sn/fp/n3snfpt0iu8p6mg6a8wooubx0ts.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30.カテゴリーチャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seabornライブラリによって提供されるカテゴリカルグラフを使用して、2つ以上のカテゴリ変数の数の相互の分布を視覚化できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Load Dataset</span>
titanic = sns.load_dataset(<span class="hljs-string">"titanic"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
g = sns.catplot(<span class="hljs-string">"alive"</span>, col=<span class="hljs-string">"deck"</span>, col_wrap=<span class="hljs-number">4</span>,<font></font>
                data=titanic[titanic.deck.notnull()],<font></font>
                kind=<span class="hljs-string">"count"</span>, height=<span class="hljs-number">3.5</span>, aspect=<span class="hljs-number">.8</span>, <font></font>
                palette=<span class="hljs-string">'tab20'</span>)<font></font>
<font></font>
fig.suptitle(<span class="hljs-string">'sf'</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/_e/np/le/_enplextsmojkrvejat_7bypbby.png"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Load Dataset</span>
titanic = sns.load_dataset(<span class="hljs-string">"titanic"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
sns.catplot(x=<span class="hljs-string">"age"</span>, y=<span class="hljs-string">"embark_town"</span>,<font></font>
            hue=<span class="hljs-string">"sex"</span>, col=<span class="hljs-string">"class"</span>,<font></font>
            data=titanic[titanic.embark_town.notnull()],<font></font>
            orient=<span class="hljs-string">"h"</span>, height=<span class="hljs-number">5</span>, aspect=<span class="hljs-number">1</span>, palette=<span class="hljs-string">"tab10"</span>,<font></font>
            kind=<span class="hljs-string">"violin"</span>, dodge=<span class="hljs-literal">True</span>, cut=<span class="hljs-number">0</span>, bw=<span class="hljs-number">.2</span>)
</code></pre><br>
</div></div><br>
 <img src="https://habrastorage.org/webt/ce/ri/kx/cerikxpqa4yphgi4qnhodpnjhqk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み立て、構成</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">31.ワッフル図</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ワッフルグラフはpywaffleパッケージを使用して作成でき、ほとんどの母集団のグループ構成を表示するために使用されます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#! pip install pywaffle</span>
<span class="hljs-comment"># Reference: https://stackoverflow.com/questions/41400136/how-to-do-waffle-charts-in-python-square-piechart</span>
<span class="hljs-keyword">from</span> pywaffle <span class="hljs-keyword">import</span> Waffle<font></font>
<font></font>
<span class="hljs-comment"># Import</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = df_raw.groupby(<span class="hljs-string">'class'</span>).size().reset_index(name=<span class="hljs-string">'counts'</span>)<font></font>
n_categories = df.shape[<span class="hljs-number">0</span>]<font></font>
colors = [plt.cm.inferno_r(i/float(n_categories)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_categories)]<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot and Decorate</span><font></font>
fig = plt.figure(<font></font>
    FigureClass=Waffle,<font></font>
    plots={<font></font>
        <span class="hljs-string">'111'</span>: {
            <span class="hljs-string">'values'</span>: df[<span class="hljs-string">'counts'</span>],
            <span class="hljs-string">'labels'</span>: [<span class="hljs-string">"{0} ({1})"</span>.format(n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df[[<span class="hljs-string">'class'</span>, <span class="hljs-string">'counts'</span>]].itertuples()],
            <span class="hljs-string">'legend'</span>: {<span class="hljs-string">'loc'</span>: <span class="hljs-string">'upper left'</span>, <span class="hljs-string">'bbox_to_anchor'</span>: (<span class="hljs-number">1.05</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'fontsize'</span>: <span class="hljs-number">12</span>},
            <span class="hljs-string">'title'</span>: {<span class="hljs-string">'label'</span>: <span class="hljs-string">'# Vehicles by Class'</span>, <span class="hljs-string">'loc'</span>: <span class="hljs-string">'center'</span>, <span class="hljs-string">'fontsize'</span>:<span class="hljs-number">18</span>}<font></font>
        },<font></font>
    },<font></font>
    rows=<span class="hljs-number">7</span>,<font></font>
    colors=colors,<font></font>
    figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">9</span>)<font></font>
)<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/pr/m6/w4/prm6w4zvev-bzkq5okvhkm6usjc.png"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#! pip install pywaffle</span>
<span class="hljs-keyword">from</span> pywaffle <span class="hljs-keyword">import</span> Waffle<font></font>
<font></font>
<span class="hljs-comment"># Import</span>
<span class="hljs-comment"># df_raw = pd.read_csv("https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv")</span><font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
<span class="hljs-comment"># By Class Data</span>
df_class = df_raw.groupby(<span class="hljs-string">'class'</span>).size().reset_index(name=<span class="hljs-string">'counts_class'</span>)<font></font>
n_categories = df_class.shape[<span class="hljs-number">0</span>]<font></font>
colors_class = [plt.cm.Set3(i/float(n_categories)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_categories)]<font></font>
<font></font>
<span class="hljs-comment"># By Cylinders Data</span>
df_cyl = df_raw.groupby(<span class="hljs-string">'cyl'</span>).size().reset_index(name=<span class="hljs-string">'counts_cyl'</span>)<font></font>
n_categories = df_cyl.shape[<span class="hljs-number">0</span>]<font></font>
colors_cyl = [plt.cm.Spectral(i/float(n_categories)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_categories)]<font></font>
<font></font>
<span class="hljs-comment"># By Make Data</span>
df_make = df_raw.groupby(<span class="hljs-string">'manufacturer'</span>).size().reset_index(name=<span class="hljs-string">'counts_make'</span>)<font></font>
n_categories = df_make.shape[<span class="hljs-number">0</span>]<font></font>
colors_make = [plt.cm.tab20b(i/float(n_categories)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n_categories)]<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot and Decorate</span><font></font>
fig = plt.figure(<font></font>
    FigureClass=Waffle,<font></font>
    plots={<font></font>
        <span class="hljs-string">'311'</span>: {
            <span class="hljs-string">'values'</span>: df_class[<span class="hljs-string">'counts_class'</span>],
            <span class="hljs-string">'labels'</span>: [<span class="hljs-string">"{1}"</span>.format(n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df_class[[<span class="hljs-string">'class'</span>, <span class="hljs-string">'counts_class'</span>]].itertuples()],
            <span class="hljs-string">'legend'</span>: {<span class="hljs-string">'loc'</span>: <span class="hljs-string">'upper left'</span>, <span class="hljs-string">'bbox_to_anchor'</span>: (<span class="hljs-number">1.05</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'fontsize'</span>: <span class="hljs-number">12</span>, <span class="hljs-string">'title'</span>:<span class="hljs-string">'Class'</span>},
            <span class="hljs-string">'title'</span>: {<span class="hljs-string">'label'</span>: <span class="hljs-string">'# Vehicles by Class'</span>, <span class="hljs-string">'loc'</span>: <span class="hljs-string">'center'</span>, <span class="hljs-string">'fontsize'</span>:<span class="hljs-number">18</span>},
            <span class="hljs-string">'colors'</span>: colors_class<font></font>
        },<font></font>
        <span class="hljs-string">'312'</span>: {
            <span class="hljs-string">'values'</span>: df_cyl[<span class="hljs-string">'counts_cyl'</span>],
            <span class="hljs-string">'labels'</span>: [<span class="hljs-string">"{1}"</span>.format(n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df_cyl[[<span class="hljs-string">'cyl'</span>, <span class="hljs-string">'counts_cyl'</span>]].itertuples()],
            <span class="hljs-string">'legend'</span>: {<span class="hljs-string">'loc'</span>: <span class="hljs-string">'upper left'</span>, <span class="hljs-string">'bbox_to_anchor'</span>: (<span class="hljs-number">1.05</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'fontsize'</span>: <span class="hljs-number">12</span>, <span class="hljs-string">'title'</span>:<span class="hljs-string">'Cyl'</span>},
            <span class="hljs-string">'title'</span>: {<span class="hljs-string">'label'</span>: <span class="hljs-string">'# Vehicles by Cyl'</span>, <span class="hljs-string">'loc'</span>: <span class="hljs-string">'center'</span>, <span class="hljs-string">'fontsize'</span>:<span class="hljs-number">18</span>},
            <span class="hljs-string">'colors'</span>: colors_cyl<font></font>
        },<font></font>
        <span class="hljs-string">'313'</span>: {
            <span class="hljs-string">'values'</span>: df_make[<span class="hljs-string">'counts_make'</span>],
            <span class="hljs-string">'labels'</span>: [<span class="hljs-string">"{1}"</span>.format(n[<span class="hljs-number">0</span>], n[<span class="hljs-number">1</span>]) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> df_make[[<span class="hljs-string">'manufacturer'</span>, <span class="hljs-string">'counts_make'</span>]].itertuples()],
            <span class="hljs-string">'legend'</span>: {<span class="hljs-string">'loc'</span>: <span class="hljs-string">'upper left'</span>, <span class="hljs-string">'bbox_to_anchor'</span>: (<span class="hljs-number">1.05</span>, <span class="hljs-number">1</span>), <span class="hljs-string">'fontsize'</span>: <span class="hljs-number">12</span>, <span class="hljs-string">'title'</span>:<span class="hljs-string">'Manufacturer'</span>},
            <span class="hljs-string">'title'</span>: {<span class="hljs-string">'label'</span>: <span class="hljs-string">'# Vehicles by Make'</span>, <span class="hljs-string">'loc'</span>: <span class="hljs-string">'center'</span>, <span class="hljs-string">'fontsize'</span>:<span class="hljs-number">18</span>},
            <span class="hljs-string">'colors'</span>: colors_make<font></font>
        }<font></font>
    },<font></font>
    rows=<span class="hljs-number">9</span>,<font></font>
    figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">14</span>)<font></font>
)<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/8q/hl/t0/8qhlt0kkwqxhblw7x-cfuzoy7rw.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32.円グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
円グラフは、グループの構成を示す古典的な方法です。</font><font style="vertical-align: inherit;">ただし、セグメントの面積が誤解を招く可能性があるため、現在このグラフを使用することは一般に推奨されていません。</font><font style="vertical-align: inherit;">したがって、円グラフを使用する場合は、円グラフの各部分の割合または数値を明示的に記録することを強くお勧めします。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = df_raw.groupby(<span class="hljs-string">'class'</span>).size()<font></font>
<font></font>
<span class="hljs-comment"># Make the plot with pandas</span>
df.plot(kind=<span class="hljs-string">'pie'</span>, subplots=<span class="hljs-literal">True</span>, figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.title(<span class="hljs-string">"Pie Chart of Vehicle Class - Bad"</span>)<font></font>
plt.ylabel(<span class="hljs-string">""</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/qn/ed/zp/qnedzpmdkuz-voxpbzcjdsnvshm.png"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = df_raw.groupby(<span class="hljs-string">'class'</span>).size().reset_index(name=<span class="hljs-string">'counts'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">7</span>), subplot_kw=dict(aspect=<span class="hljs-string">"equal"</span>), dpi= <span class="hljs-number">80</span>)<font></font>
<font></font>
data = df[<span class="hljs-string">'counts'</span>]<font></font>
categories = df[<span class="hljs-string">'class'</span>]<font></font>
explode = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0</span>]<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">pct, allvals</span>):</span>
    absolute = int(pct/<span class="hljs-number">100.</span>*np.sum(allvals))
    <span class="hljs-keyword">return</span> <span class="hljs-string">"{:.1f}% ({:d} )"</span>.format(pct, absolute)<font></font>
<font></font>
wedges, texts, autotexts = ax.pie(data, <font></font>
                                  autopct=<span class="hljs-keyword">lambda</span> pct: func(pct, data),<font></font>
                                  textprops=dict(color=<span class="hljs-string">"w"</span>), <font></font>
                                  colors=plt.cm.Dark2.colors,<font></font>
                                 startangle=<span class="hljs-number">140</span>,<font></font>
                                 explode=explode)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
ax.legend(wedges, categories, title=<span class="hljs-string">"Vehicle Class"</span>, loc=<span class="hljs-string">"center left"</span>, bbox_to_anchor=(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>))<font></font>
plt.setp(autotexts, size=<span class="hljs-number">10</span>, weight=<span class="hljs-number">700</span>)<font></font>
ax.set_title(<span class="hljs-string">"Class of Vehicles: Pie Chart"</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/gx/ex/wt/gxexwto-x00nzxtyklyb5jm6110.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">33.ツリーマップ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ツリーマップは円グラフに似ており、各グループのシェアを誤解させることなく機能します。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># pip install squarify</span>
<span class="hljs-keyword">import</span> squarify <font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = df_raw.groupby(<span class="hljs-string">'class'</span>).size().reset_index(name=<span class="hljs-string">'counts'</span>)<font></font>
labels = df.apply(<span class="hljs-keyword">lambda</span> x: str(x[<span class="hljs-number">0</span>]) + <span class="hljs-string">"\n ("</span> + str(x[<span class="hljs-number">1</span>]) + <span class="hljs-string">")"</span>, axis=<span class="hljs-number">1</span>)<font></font>
sizes = df[<span class="hljs-string">'counts'</span>].values.tolist()<font></font>
colors = [plt.cm.Spectral(i/float(len(labels))) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(labels))]<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">8</span>), dpi= <span class="hljs-number">80</span>)<font></font>
squarify.plot(sizes=sizes, label=labels, color=colors, alpha=<span class="hljs-number">.8</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorate</span>
plt.title(<span class="hljs-string">'Treemap of Vechile Class'</span>)<font></font>
plt.axis(<span class="hljs-string">'off'</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/nc/8i/cx/nc8icx6f__6fh6doibxqop1xxz0.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">34.ヒストグラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ヒストグラムは、数量または特定のメトリックに基づいて要素を視覚化する古典的な方法です。</font><font style="vertical-align: inherit;">下の図では、要素ごとに異なる色を使用していますが、グループで色付けしたくない場合は、すべての要素に1つの色を選択できます。</font><font style="vertical-align: inherit;">色名は、以下のコードのall_colors内に格納されています。</font><font style="vertical-align: inherit;">.plt.plot（）でcolorパラメータを設定することにより、ストライプの色を変更できます</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> random<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df_raw = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mpg_ggplot2.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
df = df_raw.groupby(<span class="hljs-string">'manufacturer'</span>).size().reset_index(name=<span class="hljs-string">'counts'</span>)<font></font>
n = df[<span class="hljs-string">'manufacturer'</span>].unique().__len__()+<span class="hljs-number">1</span><font></font>
all_colors = list(plt.cm.colors.cnames.keys())<font></font>
random.seed(<span class="hljs-number">100</span>)<font></font>
c = random.choices(all_colors, k=n)<font></font>
<font></font>
<span class="hljs-comment"># Plot Bars</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.bar(df[<span class="hljs-string">'manufacturer'</span>], df[<span class="hljs-string">'counts'</span>], color=c, width=<span class="hljs-number">.5</span>)
<span class="hljs-keyword">for</span> i, val <span class="hljs-keyword">in</span> enumerate(df[<span class="hljs-string">'counts'</span>].values):<font></font>
    plt.text(i, val, float(val), horizontalalignment=<span class="hljs-string">'center'</span>, verticalalignment=<span class="hljs-string">'bottom'</span>, fontdict={<span class="hljs-string">'fontweight'</span>:<span class="hljs-number">500</span>, <span class="hljs-string">'size'</span>:<span class="hljs-number">12</span>})<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.gca().set_xticklabels(df[<span class="hljs-string">'manufacturer'</span>], rotation=<span class="hljs-number">60</span>, horizontalalignment= <span class="hljs-string">'right'</span>)<font></font>
plt.title(<span class="hljs-string">"Number of Vehicles by Manaufacturers"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.ylabel(<span class="hljs-string">'# Vehicles'</span>)<font></font>
plt.ylim(<span class="hljs-number">0</span>, <span class="hljs-number">45</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/dx/ik/pb/dxikpbp2rckyrwsnncu5_ei7vws.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更の追跡</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35.時系列グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時系列グラフは、特定のインジケーターの経時変化を視覚化するために使用されます。</font><font style="vertical-align: inherit;">ここでは、旅客の流れが1949年から1969年にどのように変化したかを確認できます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/AirPassengers.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.plot(<span class="hljs-string">'date'</span>, <span class="hljs-string">'traffic'</span>, data=df, color=<span class="hljs-string">'tab:red'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.ylim(<span class="hljs-number">50</span>, <span class="hljs-number">750</span>)<font></font>
xtick_location = df.index.tolist()[::<span class="hljs-number">12</span>]<font></font>
xtick_labels = [x[<span class="hljs-number">-4</span>:] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df.date.tolist()[::<span class="hljs-number">12</span>]]<font></font>
plt.xticks(ticks=xtick_location, labels=xtick_labels, rotation=<span class="hljs-number">0</span>, fontsize=<span class="hljs-number">12</span>, horizontalalignment=<span class="hljs-string">'center'</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
plt.title(<span class="hljs-string">"Air Passengers Traffic (1949 - 1969)"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.grid(axis=<span class="hljs-string">'both'</span>, alpha=<span class="hljs-number">.3</span>)<font></font>
<font></font>
<span class="hljs-comment"># Remove borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0.0</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">0.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0.0</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">0.3</span>)   <font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ni/ze/jw/nizejwoyidtzi3jqkvdzmjwdcti.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">36.ピークと谷のある時系列 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の時系列は、すべてのピークと谷を示し、個々の特別なイベントの発生をマークします。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/AirPassengers.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Get the Peaks and Troughs</span>
data = df[<span class="hljs-string">'traffic'</span>].values<font></font>
doublediff = np.diff(np.sign(np.diff(data)))<font></font>
peak_locations = np.where(doublediff == <span class="hljs-number">-2</span>)[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span><font></font>
<font></font>
doublediff2 = np.diff(np.sign(np.diff(<span class="hljs-number">-1</span>*data)))<font></font>
trough_locations = np.where(doublediff2 == <span class="hljs-number">-2</span>)[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span><font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.plot(<span class="hljs-string">'date'</span>, <span class="hljs-string">'traffic'</span>, data=df, color=<span class="hljs-string">'tab:blue'</span>, label=<span class="hljs-string">'Air Traffic'</span>)<font></font>
plt.scatter(df.date[peak_locations], df.traffic[peak_locations], marker=mpl.markers.CARETUPBASE, color=<span class="hljs-string">'tab:green'</span>, s=<span class="hljs-number">100</span>, label=<span class="hljs-string">'Peaks'</span>)<font></font>
plt.scatter(df.date[trough_locations], df.traffic[trough_locations], marker=mpl.markers.CARETDOWNBASE, color=<span class="hljs-string">'tab:red'</span>, s=<span class="hljs-number">100</span>, label=<span class="hljs-string">'Troughs'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Annotate</span>
<span class="hljs-keyword">for</span> t, p <span class="hljs-keyword">in</span> zip(trough_locations[<span class="hljs-number">1</span>::<span class="hljs-number">5</span>], peak_locations[::<span class="hljs-number">3</span>]):<font></font>
    plt.text(df.date[p], df.traffic[p]+<span class="hljs-number">15</span>, df.date[p], horizontalalignment=<span class="hljs-string">'center'</span>, color=<span class="hljs-string">'darkgreen'</span>)<font></font>
    plt.text(df.date[t], df.traffic[t]<span class="hljs-number">-35</span>, df.date[t], horizontalalignment=<span class="hljs-string">'center'</span>, color=<span class="hljs-string">'darkred'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.ylim(<span class="hljs-number">50</span>,<span class="hljs-number">750</span>)<font></font>
xtick_location = df.index.tolist()[::<span class="hljs-number">6</span>]<font></font>
xtick_labels = df.date.tolist()[::<span class="hljs-number">6</span>]<font></font>
plt.xticks(ticks=xtick_location, labels=xtick_labels, rotation=<span class="hljs-number">90</span>, fontsize=<span class="hljs-number">12</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
plt.title(<span class="hljs-string">"Peak and Troughs of Air Passengers Traffic (1949 - 1969)"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.legend(loc=<span class="hljs-string">'upper left'</span>)<font></font>
plt.grid(axis=<span class="hljs-string">'y'</span>, alpha=<span class="hljs-number">.3</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ca/lg/3w/calg3wc3ufgsoqwllm9x9f1huby.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">37.自己相関（ACF）と部分自己相関（PACF）のグラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACFグラフは、時系列とそれ自体の時間の相関を示します。</font><font style="vertical-align: inherit;">（自己相関グラフ上の）各縦線は、系列とその時間の間の相関を表し、時間0から始まります。グラフ上の青色の網掛け部分は有意水準です。</font><font style="vertical-align: inherit;">青い線の上にある瞬間は重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、これをどのように解釈しますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AirPassengersの場合、x = 14で「ロリポップ」が青い線を横切っているため、非常に重要であることがわかります。</font><font style="vertical-align: inherit;">これは、最大14年前に観測された乗客のトラフィックが、今日観測されたトラフィックに影響を与えることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、PACFは、任意の時間（時系列）と現在の系列の自己相関を示しますが、それらの間の影響は除去されています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> statsmodels.graphics.tsaplots <span class="hljs-keyword">import</span> plot_acf, plot_pacf<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/AirPassengers.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>,figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">6</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plot_acf(df.traffic.tolist(), ax=ax1, lags=<span class="hljs-number">50</span>)<font></font>
plot_pacf(df.traffic.tolist(), ax=ax2, lags=<span class="hljs-number">20</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorate</span>
<span class="hljs-comment"># lighten the borders</span>
ax1.spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.3</span>); ax2.spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
ax1.spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>); ax2.spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
ax1.spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.3</span>); ax2.spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
ax1.spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>); ax2.spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
<span class="hljs-comment"># font size of tick labels</span>
ax1.tick_params(axis=<span class="hljs-string">'both'</span>, labelsize=<span class="hljs-number">12</span>)<font></font>
ax2.tick_params(axis=<span class="hljs-string">'both'</span>, labelsize=<span class="hljs-number">12</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/pu/bz/aj/pubzajmopagb_auzeanlhqhvxvm.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38.相互相関グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相互相関グラフは、2つの時系列の相互の遅延を示します。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> statsmodels.tsa.stattools <span class="hljs-keyword">as</span> stattools<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/mortality.csv'</span>)<font></font>
x = df[<span class="hljs-string">'mdeaths'</span>]<font></font>
y = df[<span class="hljs-string">'fdeaths'</span>]<font></font>
<font></font>
<span class="hljs-comment"># Compute Cross Correlations</span>
ccs = stattools.ccf(x, y)[:<span class="hljs-number">100</span>]<font></font>
nlags = len(ccs)<font></font>
<font></font>
<span class="hljs-comment"># Compute the Significance level</span>
<span class="hljs-comment"># ref: https://stats.stackexchange.com/questions/3115/cross-correlation-significance-in-r/3128#3128</span>
conf_level = <span class="hljs-number">2</span> / np.sqrt(nlags)<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">7</span>), dpi= <span class="hljs-number">80</span>)<font></font>
<font></font>
plt.hlines(<span class="hljs-number">0</span>, xmin=<span class="hljs-number">0</span>, xmax=<span class="hljs-number">100</span>, color=<span class="hljs-string">'gray'</span>)  <span class="hljs-comment"># 0 axis</span>
plt.hlines(conf_level, xmin=<span class="hljs-number">0</span>, xmax=<span class="hljs-number">100</span>, color=<span class="hljs-string">'gray'</span>)<font></font>
plt.hlines(-conf_level, xmin=<span class="hljs-number">0</span>, xmax=<span class="hljs-number">100</span>, color=<span class="hljs-string">'gray'</span>)<font></font>
<font></font>
plt.bar(x=np.arange(len(ccs)), height=ccs, width=<span class="hljs-number">.3</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.title(<span class="hljs-string">'$Cross\; Correlation\; Plot:\; mdeaths\; vs\; fdeaths$'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xlim(<span class="hljs-number">0</span>,len(ccs))<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/dh/pq/vl/dhpqvlyqrwwrnzziogfxcjmlouw.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39.時系列の拡張</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時系列展開チャートは、時系列を傾向、季節、および残差コンポーネントに分類したものを示しています。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> statsmodels.tsa.seasonal <span class="hljs-keyword">import</span> seasonal_decompose
<span class="hljs-keyword">from</span> dateutil.parser <span class="hljs-keyword">import</span> parse<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/AirPassengers.csv'</span>)<font></font>
dates = pd.DatetimeIndex([parse(d).strftime(<span class="hljs-string">'%Y-%m-01'</span>) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> df[<span class="hljs-string">'date'</span>]])<font></font>
df.set_index(dates, inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decompose </span>
result = seasonal_decompose(df[<span class="hljs-string">'traffic'</span>], model=<span class="hljs-string">'multiplicative'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.rcParams.update({<span class="hljs-string">'figure.figsize'</span>: (<span class="hljs-number">10</span>,<span class="hljs-number">10</span>)})<font></font>
result.plot().suptitle(<span class="hljs-string">'Time Series Decomposition of Air Passengers'</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/sw/_e/ob/sw_eobkfqcxkzq31ia54hpjauus.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40.いくつかの時系列 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下に示すように、1つのグラフで同じ値を測定する複数の時系列を作成できます。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/mortality.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Define the upper limit, lower limit, interval of Y axis and colors</span>
y_LL = <span class="hljs-number">100</span>
y_UL = int(df.iloc[:, <span class="hljs-number">1</span>:].max().max()*<span class="hljs-number">1.1</span>)<font></font>
y_interval = <span class="hljs-number">400</span>
mycolors = [<span class="hljs-string">'tab:red'</span>, <span class="hljs-string">'tab:blue'</span>, <span class="hljs-string">'tab:green'</span>, <span class="hljs-string">'tab:orange'</span>]    <font></font>
<font></font>
<span class="hljs-comment"># Draw Plot and Annotate</span>
fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)    <font></font>
<font></font>
columns = df.columns[<span class="hljs-number">1</span>:]  
<span class="hljs-keyword">for</span> i, column <span class="hljs-keyword">in</span> enumerate(columns):    <font></font>
    plt.plot(df.date.values, df<font></font>
.values, lw=<span class="hljs-number">1.5</span>, color=mycolors[i])    <font></font>
    plt.text(df.shape[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>, df<font></font>
.values[<span class="hljs-number">-1</span>], column, fontsize=<span class="hljs-number">14</span>, color=mycolors[i])<font></font>
<font></font>
<span class="hljs-comment"># Draw Tick lines  </span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(y_LL, y_UL, y_interval):    <font></font>
    plt.hlines(y, xmin=<span class="hljs-number">0</span>, xmax=<span class="hljs-number">71</span>, colors=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.3</span>, linestyles=<span class="hljs-string">"--"</span>, lw=<span class="hljs-number">0.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations    </span>
plt.tick_params(axis=<span class="hljs-string">"both"</span>, which=<span class="hljs-string">"both"</span>, bottom=<span class="hljs-literal">False</span>, top=<span class="hljs-literal">False</span>,    <font></font>
                labelbottom=<span class="hljs-literal">True</span>, left=<span class="hljs-literal">False</span>, right=<span class="hljs-literal">False</span>, labelleft=<span class="hljs-literal">True</span>)        <font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.title(<span class="hljs-string">'Number of Deaths from Lung Diseases in the UK (1974-1979)'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.yticks(range(y_LL, y_UL, y_interval), [str(y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(y_LL, y_UL, y_interval)], fontsize=<span class="hljs-number">12</span>)    <font></font>
plt.xticks(range(<span class="hljs-number">0</span>, df.shape[<span class="hljs-number">0</span>], <span class="hljs-number">12</span>), df.date.values[::<span class="hljs-number">12</span>], horizontalalignment=<span class="hljs-string">'left'</span>, fontsize=<span class="hljs-number">12</span>)    <font></font>
plt.ylim(y_LL, y_UL)    <font></font>
plt.xlim(<span class="hljs-number">-2</span>, <span class="hljs-number">80</span>)    <font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ci/wj/nc/ciwjncvytziol6v4e0kgpqgwxx0.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">41.第2 Y軸を使用して異なるスケールで構築する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に2つの異なる量を測定する2つの時系列を表示する場合は、右側の第2 Y軸で2番目の系列を再度構築できます。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/economics.csv"</span>)<font></font>
<font></font>
x = df[<span class="hljs-string">'date'</span>]<font></font>
y1 = df[<span class="hljs-string">'psavert'</span>]<font></font>
y2 = df[<span class="hljs-string">'unemploy'</span>]<font></font>
<font></font>
<span class="hljs-comment"># Plot Line1 (Left Y Axis)</span>
fig, ax1 = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
ax1.plot(x, y1, color=<span class="hljs-string">'tab:red'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot Line2 (Right Y Axis)</span>
ax2 = ax1.twinx()  <span class="hljs-comment"># instantiate a second axes that shares the same x-axis</span>
ax2.plot(x, y2, color=<span class="hljs-string">'tab:blue'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
<span class="hljs-comment"># ax1 (left Y axis)</span>
ax1.set_xlabel(<span class="hljs-string">'Year'</span>, fontsize=<span class="hljs-number">20</span>)<font></font>
ax1.tick_params(axis=<span class="hljs-string">'x'</span>, rotation=<span class="hljs-number">0</span>, labelsize=<span class="hljs-number">12</span>)<font></font>
ax1.set_ylabel(<span class="hljs-string">'Personal Savings Rate'</span>, color=<span class="hljs-string">'tab:red'</span>, fontsize=<span class="hljs-number">20</span>)<font></font>
ax1.tick_params(axis=<span class="hljs-string">'y'</span>, rotation=<span class="hljs-number">0</span>, labelcolor=<span class="hljs-string">'tab:red'</span> )<font></font>
ax1.grid(alpha=<span class="hljs-number">.4</span>)<font></font>
<font></font>
<span class="hljs-comment"># ax2 (right Y axis)</span>
ax2.set_ylabel(<span class="hljs-string">"# Unemployed (1000's)"</span>, color=<span class="hljs-string">'tab:blue'</span>, fontsize=<span class="hljs-number">20</span>)<font></font>
ax2.tick_params(axis=<span class="hljs-string">'y'</span>, labelcolor=<span class="hljs-string">'tab:blue'</span>)<font></font>
ax2.set_xticks(np.arange(<span class="hljs-number">0</span>, len(x), <span class="hljs-number">60</span>))<font></font>
ax2.set_xticklabels(x[::<span class="hljs-number">60</span>], rotation=<span class="hljs-number">90</span>, fontdict={<span class="hljs-string">'fontsize'</span>:<span class="hljs-number">10</span>})<font></font>
ax2.set_title(<span class="hljs-string">"Personal Savings Rate vs Unemployed: Plotting in Secondary Y Axis"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
fig.tight_layout()<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/li/rb/ob/lirbob4k8hdphq4ts6igp-pcfdy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42.エラーバーのある時系列</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーバー付きの時系列は、各時点（日付/タイムスタンプ）の複数の観測値を持つ時系列データセットがある場合に作成できます。</font><font style="vertical-align: inherit;">以下に、一日のさまざまな時間帯の注文の受け取りに基づくいくつかの例を示します。</font><font style="vertical-align: inherit;">また、45日以内の受注数の別の例。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチでは、注文の平均数が白い線で示されます。</font><font style="vertical-align: inherit;">そして、95％の間隔が計算され、平均の周りにプロットされます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> sem<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/user_orders_hourofday.csv"</span>)<font></font>
df_mean = df.groupby(<span class="hljs-string">'order_hour_of_day'</span>).quantity.mean()<font></font>
df_se = df.groupby(<span class="hljs-string">'order_hour_of_day'</span>).quantity.apply(sem).mul(<span class="hljs-number">1.96</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.ylabel(<span class="hljs-string">"# Orders"</span>, fontsize=<span class="hljs-number">16</span>)  <font></font>
x = df_mean.index<font></font>
plt.plot(x, df_mean, color=<span class="hljs-string">"white"</span>, lw=<span class="hljs-number">2</span>) <font></font>
plt.fill_between(x, df_mean - df_se, df_mean + df_se, color=<span class="hljs-string">"#3F5D7D"</span>)  <font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">1</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">1</span>)<font></font>
plt.xticks(x[::<span class="hljs-number">2</span>], [str(d) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> x[::<span class="hljs-number">2</span>]] , fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">"User Orders by Hour of Day (95% confidence)"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Hour of Day"</span>)<font></font>
<font></font>
s, e = plt.gca().get_xlim()<font></font>
plt.xlim(s, e)<font></font>
<font></font>
<span class="hljs-comment"># Draw Horizontal Tick lines  </span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>, <span class="hljs-number">20</span>, <span class="hljs-number">2</span>):    <font></font>
    plt.hlines(y, xmin=s, xmax=e, colors=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.5</span>, linestyles=<span class="hljs-string">"--"</span>, lw=<span class="hljs-number">0.5</span>)<font></font>
<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/yg/os/yt/ygosytkzsgv4z9w1qlij9xzco9m.png"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-string">"Data Source: https://www.kaggle.com/olistbr/brazilian-ecommerce#olist_orders_dataset.csv"</span>
<span class="hljs-keyword">from</span> dateutil.parser <span class="hljs-keyword">import</span> parse
<span class="hljs-keyword">from</span> scipy.stats <span class="hljs-keyword">import</span> sem<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df_raw = pd.read_csv(<span class="hljs-string">'https://raw.githubusercontent.com/selva86/datasets/master/orders_45d.csv'</span>, <font></font>
                     parse_dates=[<span class="hljs-string">'purchase_time'</span>, <span class="hljs-string">'purchase_date'</span>])<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data: Daily Mean and SE Bands</span>
df_mean = df_raw.groupby(<span class="hljs-string">'purchase_date'</span>).quantity.mean()<font></font>
df_se = df_raw.groupby(<span class="hljs-string">'purchase_date'</span>).quantity.apply(sem).mul(<span class="hljs-number">1.96</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
plt.ylabel(<span class="hljs-string">"# Daily Orders"</span>, fontsize=<span class="hljs-number">16</span>)  <font></font>
x = [d.date().strftime(<span class="hljs-string">'%Y-%m-%d'</span>) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> df_mean.index]<font></font>
plt.plot(x, df_mean, color=<span class="hljs-string">"white"</span>, lw=<span class="hljs-number">2</span>) <font></font>
plt.fill_between(x, df_mean - df_se, df_mean + df_se, color=<span class="hljs-string">"#3F5D7D"</span>)  <font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">1</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">1</span>)<font></font>
plt.xticks(x[::<span class="hljs-number">6</span>], [str(d) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> x[::<span class="hljs-number">6</span>]] , fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">"Daily Order Quantity of Brazilian Retail with Error Bands (95% confidence)"</span>, fontsize=<span class="hljs-number">20</span>)<font></font>
<font></font>
<span class="hljs-comment"># Axis limits</span><font></font>
s, e = plt.gca().get_xlim()<font></font>
plt.xlim(s, e<span class="hljs-number">-2</span>)<font></font>
plt.ylim(<span class="hljs-number">4</span>, <span class="hljs-number">10</span>)<font></font>
<font></font>
<span class="hljs-comment"># Draw Horizontal Tick lines  </span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>):    <font></font>
    plt.hlines(y, xmin=s, xmax=e, colors=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.5</span>, linestyles=<span class="hljs-string">"--"</span>, lw=<span class="hljs-number">0.5</span>)<font></font>
<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/g6/f8/c5/g6f8c5_-yqqrq11x8pzc8toyd3e.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">43.累積のあるグラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
積み上げ面グラフは、複数の時系列からの寄与度を視覚的に表しています。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://raw.githubusercontent.com/selva86/datasets/master/nightvisitors.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decide Colors </span>
mycolors = [<span class="hljs-string">'tab:red'</span>, <span class="hljs-string">'tab:blue'</span>, <span class="hljs-string">'tab:green'</span>, <span class="hljs-string">'tab:orange'</span>, <span class="hljs-string">'tab:brown'</span>, <span class="hljs-string">'tab:grey'</span>, <span class="hljs-string">'tab:pink'</span>, <span class="hljs-string">'tab:olive'</span>]      <font></font>
<font></font>
<span class="hljs-comment"># Draw Plot and Annotate</span>
fig, ax = plt.subplots(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
columns = df.columns[<span class="hljs-number">1</span>:]<font></font>
labs = columns.values.tolist()<font></font>
<font></font>
<span class="hljs-comment"># Prepare data</span>
x  = df[<span class="hljs-string">'yearmon'</span>].values.tolist()<font></font>
y0 = df[columns[<span class="hljs-number">0</span>]].values.tolist()<font></font>
y1 = df[columns[<span class="hljs-number">1</span>]].values.tolist()<font></font>
y2 = df[columns[<span class="hljs-number">2</span>]].values.tolist()<font></font>
y3 = df[columns[<span class="hljs-number">3</span>]].values.tolist()<font></font>
y4 = df[columns[<span class="hljs-number">4</span>]].values.tolist()<font></font>
y5 = df[columns[<span class="hljs-number">5</span>]].values.tolist()<font></font>
y6 = df[columns[<span class="hljs-number">6</span>]].values.tolist()<font></font>
y7 = df[columns[<span class="hljs-number">7</span>]].values.tolist()<font></font>
y = np.vstack([y0, y2, y4, y6, y7, y5, y1, y3])<font></font>
<font></font>
<span class="hljs-comment"># Plot for each column</span><font></font>
labs = columns.values.tolist()<font></font>
ax = plt.gca()<font></font>
ax.stackplot(x, y, labels=labs, colors=mycolors, alpha=<span class="hljs-number">0.8</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
ax.set_title(<span class="hljs-string">'Night Visitors in Australian Regions'</span>, fontsize=<span class="hljs-number">18</span>)<font></font>
ax.set(ylim=[<span class="hljs-number">0</span>, <span class="hljs-number">100000</span>])<font></font>
ax.legend(fontsize=<span class="hljs-number">10</span>, ncol=<span class="hljs-number">4</span>)<font></font>
plt.xticks(x[::<span class="hljs-number">5</span>], fontsize=<span class="hljs-number">10</span>, horizontalalignment=<span class="hljs-string">'center'</span>)<font></font>
plt.yticks(np.arange(<span class="hljs-number">10000</span>, <span class="hljs-number">100000</span>, <span class="hljs-number">20000</span>), fontsize=<span class="hljs-number">10</span>)<font></font>
plt.xlim(x[<span class="hljs-number">0</span>], x[<span class="hljs-number">-1</span>])<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/xx/rm/pe/xxrmpeu7rbzf0dxkl46ivx7bnn0.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">44.非積み上げ面グラフ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オープンエリアチャートは、2つ以上の行の進行状況（上下）を視覚化するために使用されます。</font><font style="vertical-align: inherit;">下の図では、平均失業期間の増加に伴って個人の貯蓄率がどのように減少するかを明確に見ることができます。</font><font style="vertical-align: inherit;">開いたセクションの図は、この現象をよく示しています。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/economics.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare Data</span>
x = df[<span class="hljs-string">'date'</span>].values.tolist()<font></font>
y1 = df[<span class="hljs-string">'psavert'</span>].values.tolist()<font></font>
y2 = df[<span class="hljs-string">'uempmed'</span>].values.tolist()<font></font>
mycolors = [<span class="hljs-string">'tab:red'</span>, <span class="hljs-string">'tab:blue'</span>, <span class="hljs-string">'tab:green'</span>, <span class="hljs-string">'tab:orange'</span>, <span class="hljs-string">'tab:brown'</span>, <span class="hljs-string">'tab:grey'</span>, <span class="hljs-string">'tab:pink'</span>, <span class="hljs-string">'tab:olive'</span>]      <font></font>
columns = [<span class="hljs-string">'psavert'</span>, <span class="hljs-string">'uempmed'</span>]<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot </span>
fig, ax = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
ax.fill_between(x, y1=y1, y2=<span class="hljs-number">0</span>, label=columns[<span class="hljs-number">1</span>], alpha=<span class="hljs-number">0.5</span>, color=mycolors[<span class="hljs-number">1</span>], linewidth=<span class="hljs-number">2</span>)<font></font>
ax.fill_between(x, y1=y2, y2=<span class="hljs-number">0</span>, label=columns[<span class="hljs-number">0</span>], alpha=<span class="hljs-number">0.5</span>, color=mycolors[<span class="hljs-number">0</span>], linewidth=<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
ax.set_title(<span class="hljs-string">'Personal Savings Rate vs Median Duration of Unemployment'</span>, fontsize=<span class="hljs-number">18</span>)<font></font>
ax.set(ylim=[<span class="hljs-number">0</span>, <span class="hljs-number">30</span>])<font></font>
ax.legend(loc=<span class="hljs-string">'best'</span>, fontsize=<span class="hljs-number">12</span>)<font></font>
plt.xticks(x[::<span class="hljs-number">50</span>], fontsize=<span class="hljs-number">10</span>, horizontalalignment=<span class="hljs-string">'center'</span>)<font></font>
plt.yticks(np.arange(<span class="hljs-number">2.5</span>, <span class="hljs-number">30.0</span>, <span class="hljs-number">2.5</span>), fontsize=<span class="hljs-number">10</span>)<font></font>
plt.xlim(<span class="hljs-number">-10</span>, x[<span class="hljs-number">-1</span>])<font></font>
<font></font>
<span class="hljs-comment"># Draw Tick lines  </span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> np.arange(<span class="hljs-number">2.5</span>, <span class="hljs-number">30.0</span>, <span class="hljs-number">2.5</span>):    <font></font>
    plt.hlines(y, xmin=<span class="hljs-number">0</span>, xmax=len(x), colors=<span class="hljs-string">'black'</span>, alpha=<span class="hljs-number">0.3</span>, linestyles=<span class="hljs-string">"--"</span>, lw=<span class="hljs-number">0.5</span>)<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/i6/di/_b/i6di_b692jdi6f1rjhacp6vc1gk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">45.カレンダーヒートマップ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カレンダーマップは、時系列と比較して時間に基づいてデータを視覚化するための代替であり、あまり好ましくないオプションです。</font><font style="vertical-align: inherit;">それらは視覚的に魅力的かもしれませんが、数値は完全に明白ではありません。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> matplotlib <span class="hljs-keyword">as</span> mpl
<span class="hljs-keyword">import</span> calmap<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/yahoo.csv"</span>, parse_dates=[<span class="hljs-string">'date'</span>])<font></font>
df.set_index(<span class="hljs-string">'date'</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
calmap.calendarplot(df[<span class="hljs-string">'2014'</span>][<span class="hljs-string">'VIX.Close'</span>], fig_kws={<span class="hljs-string">'figsize'</span>: (<span class="hljs-number">16</span>,<span class="hljs-number">10</span>)}, yearlabel_kws={<span class="hljs-string">'color'</span>:<span class="hljs-string">'black'</span>, <span class="hljs-string">'fontsize'</span>:<span class="hljs-number">14</span>}, subplot_kws={<span class="hljs-string">'title'</span>:<span class="hljs-string">'Yahoo Stock Prices'</span>})<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/0q/jk/xq/0qjkxqus8k3dh4iry43rwn5v8qe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">46.季節チャート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
季節のスケジュールを使用して、前のシーズンの同じ日に実行された時系列を比較できます（年/月/週など）。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> dateutil.parser <span class="hljs-keyword">import</span> parse <font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://github.com/selva86/datasets/raw/master/AirPassengers.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Prepare data</span>
df[<span class="hljs-string">'year'</span>] = [parse(d).year <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> df.date]<font></font>
df[<span class="hljs-string">'month'</span>] = [parse(d).strftime(<span class="hljs-string">'%b'</span>) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> df.date]<font></font>
years = df[<span class="hljs-string">'year'</span>].unique()<font></font>
<font></font>
<span class="hljs-comment"># Draw Plot</span>
mycolors = [<span class="hljs-string">'tab:red'</span>, <span class="hljs-string">'tab:blue'</span>, <span class="hljs-string">'tab:green'</span>, <span class="hljs-string">'tab:orange'</span>, <span class="hljs-string">'tab:brown'</span>, <span class="hljs-string">'tab:grey'</span>, <span class="hljs-string">'tab:pink'</span>, <span class="hljs-string">'tab:olive'</span>, <span class="hljs-string">'deeppink'</span>, <span class="hljs-string">'steelblue'</span>, <span class="hljs-string">'firebrick'</span>, <span class="hljs-string">'mediumseagreen'</span>]      <font></font>
plt.figure(figsize=(<span class="hljs-number">16</span>,<span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> i, y <span class="hljs-keyword">in</span> enumerate(years):<font></font>
    plt.plot(<span class="hljs-string">'month'</span>, <span class="hljs-string">'traffic'</span>, data=df.loc[df.year==y, :], color=mycolors[i], label=y)<font></font>
    plt.text(df.loc[df.year==y, :].shape[<span class="hljs-number">0</span>]<span class="hljs-number">-.9</span>, df.loc[df.year==y, <span class="hljs-string">'traffic'</span>][<span class="hljs-number">-1</span>:].values[<span class="hljs-number">0</span>], y, fontsize=<span class="hljs-number">12</span>, color=mycolors[i])<font></font>
<font></font>
<span class="hljs-comment"># Decoration</span>
plt.ylim(<span class="hljs-number">50</span>,<span class="hljs-number">750</span>)<font></font>
plt.xlim(<span class="hljs-number">-0.3</span>, <span class="hljs-number">11</span>)<font></font>
plt.ylabel(<span class="hljs-string">'$Air Traffic$'</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>, alpha=<span class="hljs-number">.7</span>)<font></font>
plt.title(<span class="hljs-string">"Monthly Seasonal Plot: Air Passengers Traffic (1949 - 1969)"</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.grid(axis=<span class="hljs-string">'y'</span>, alpha=<span class="hljs-number">.3</span>)<font></font>
<font></font>
<span class="hljs-comment"># Remove borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0.0</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">0.5</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0.0</span>)    <font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">0.5</span>)   
<span class="hljs-comment"># plt.legend(loc='upper right', ncol=2, fontsize=12)</span><font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ky/tm/av/kytmav8hzpjgjvi6pln5mqx-y8w.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">団体</font></font></h3><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">47.デンドログラム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
樹状図は、指定された距離メトリックに基づいて類似点をグループ化し、点の類似性に基づいてツリーリンクの形式でそれらを配置します。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> scipy.cluster.hierarchy <span class="hljs-keyword">as</span> shc<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://raw.githubusercontent.com/selva86/datasets/master/USArrests.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)  <font></font>
plt.title(<span class="hljs-string">"USArrests Dendograms"</span>, fontsize=<span class="hljs-number">22</span>)  <font></font>
dend = shc.dendrogram(shc.linkage(df[[<span class="hljs-string">'Murder'</span>, <span class="hljs-string">'Assault'</span>, <span class="hljs-string">'UrbanPop'</span>, <span class="hljs-string">'Rape'</span>]], method=<span class="hljs-string">'ward'</span>), labels=df.State.values, color_threshold=<span class="hljs-number">100</span>)  <font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/jh/a4/qm/jha4qmj6gjt0eky_s0ob2k3djfw.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48.クラスター図</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラスタグラフは、1つのクラスタに属するポイントを区別するために使用できます。</font><font style="vertical-align: inherit;">以下は、USArrestsデータセットに基づいて米国の州を5つのグループにグループ化する例です。</font><font style="vertical-align: inherit;">このクラスターグラフでは、「kill」列と「attack」列をX軸とY軸として使用していますが、最初のコンポーネントからメインコンポーネントをX軸とY軸として使用することもできます。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> AgglomerativeClustering
<span class="hljs-keyword">from</span> scipy.spatial <span class="hljs-keyword">import</span> ConvexHull<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df = pd.read_csv(<span class="hljs-string">'https://raw.githubusercontent.com/selva86/datasets/master/USArrests.csv'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Agglomerative Clustering</span>
cluster = AgglomerativeClustering(n_clusters=<span class="hljs-number">5</span>, affinity=<span class="hljs-string">'euclidean'</span>, linkage=<span class="hljs-string">'ward'</span>)  <font></font>
cluster.fit_predict(df[[<span class="hljs-string">'Murder'</span>, <span class="hljs-string">'Assault'</span>, <span class="hljs-string">'UrbanPop'</span>, <span class="hljs-string">'Rape'</span>]])  <font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">10</span>), dpi= <span class="hljs-number">80</span>)  <font></font>
plt.scatter(df.iloc[:,<span class="hljs-number">0</span>], df.iloc[:,<span class="hljs-number">1</span>], c=cluster.labels_, cmap=<span class="hljs-string">'tab10'</span>)  <font></font>
<font></font>
<span class="hljs-comment"># Encircle</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encircle</span>(<span class="hljs-params">x,y, ax=None, **kw</span>):</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ax: ax=plt.gca()<font></font>
    p = np.c_[x,y]<font></font>
    hull = ConvexHull(p)<font></font>
    poly = plt.Polygon(p[hull.vertices,:], **kw)<font></font>
    ax.add_patch(poly)<font></font>
<font></font>
<span class="hljs-comment"># Draw polygon surrounding vertices    </span>
encircle(df.loc[cluster.labels_ == <span class="hljs-number">0</span>, <span class="hljs-string">'Murder'</span>], df.loc[cluster.labels_ == <span class="hljs-number">0</span>, <span class="hljs-string">'Assault'</span>], ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"gold"</span>, alpha=<span class="hljs-number">0.2</span>, linewidth=<span class="hljs-number">0</span>)<font></font>
encircle(df.loc[cluster.labels_ == <span class="hljs-number">1</span>, <span class="hljs-string">'Murder'</span>], df.loc[cluster.labels_ == <span class="hljs-number">1</span>, <span class="hljs-string">'Assault'</span>], ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"tab:blue"</span>, alpha=<span class="hljs-number">0.2</span>, linewidth=<span class="hljs-number">0</span>)<font></font>
encircle(df.loc[cluster.labels_ == <span class="hljs-number">2</span>, <span class="hljs-string">'Murder'</span>], df.loc[cluster.labels_ == <span class="hljs-number">2</span>, <span class="hljs-string">'Assault'</span>], ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"tab:red"</span>, alpha=<span class="hljs-number">0.2</span>, linewidth=<span class="hljs-number">0</span>)<font></font>
encircle(df.loc[cluster.labels_ == <span class="hljs-number">3</span>, <span class="hljs-string">'Murder'</span>], df.loc[cluster.labels_ == <span class="hljs-number">3</span>, <span class="hljs-string">'Assault'</span>], ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"tab:green"</span>, alpha=<span class="hljs-number">0.2</span>, linewidth=<span class="hljs-number">0</span>)<font></font>
encircle(df.loc[cluster.labels_ == <span class="hljs-number">4</span>, <span class="hljs-string">'Murder'</span>], df.loc[cluster.labels_ == <span class="hljs-number">4</span>, <span class="hljs-string">'Assault'</span>], ec=<span class="hljs-string">"k"</span>, fc=<span class="hljs-string">"tab:orange"</span>, alpha=<span class="hljs-number">0.2</span>, linewidth=<span class="hljs-number">0</span>)<font></font>
<font></font>
<span class="hljs-comment"># Decorations</span>
plt.xlabel(<span class="hljs-string">'Murder'</span>); plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Assault'</span>); plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.title(<span class="hljs-string">'Agglomerative Clustering of USArrests (5 Groups)'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/ft/az/dk/ftazdkietrco4c6hgklzhwird8q.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">49.アンドリュースカーブ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アンドリュース曲線は、グループに基づくグループに固有の数値特性があるかどうかを視覚化するのに役立ちます。</font><font style="vertical-align: inherit;">オブジェクト（データセット内の列）がグループの識別に役立たない場合、以下に示すように、行は適切に分離されません。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> pandas.plotting <span class="hljs-keyword">import</span> andrews_curves<font></font>
<font></font>
<span class="hljs-comment"># Import</span>
df = pd.read_csv(<span class="hljs-string">"https://github.com/selva86/datasets/raw/master/mtcars.csv"</span>)<font></font>
df.drop([<span class="hljs-string">'cars'</span>, <span class="hljs-string">'carname'</span>], axis=<span class="hljs-number">1</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
andrews_curves(df, <span class="hljs-string">'cyl'</span>, colormap=<span class="hljs-string">'Set1'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.title(<span class="hljs-string">'Andrews Curves of mtcars'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.xlim(<span class="hljs-number">-3</span>,<span class="hljs-number">3</span>)<font></font>
plt.grid(alpha=<span class="hljs-number">0.3</span>)<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/1c/rh/-z/1crh-zrrc8urd4d1cf-iocfe5ji.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50.平行座標</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平行座標は、関数がグループを効果的に分離するのに役立つかどうかを視覚化するのに役立ちます。</font><font style="vertical-align: inherit;">分離が発生した場合、この機能はこのグループの予測に非常に役立つ可能性があります。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを表示</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> pandas.plotting <span class="hljs-keyword">import</span> parallel_coordinates<font></font>
<font></font>
<span class="hljs-comment"># Import Data</span>
df_final = pd.read_csv(<span class="hljs-string">"https://raw.githubusercontent.com/selva86/datasets/master/diamonds_filter.csv"</span>)<font></font>
<font></font>
<span class="hljs-comment"># Plot</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">9</span>), dpi= <span class="hljs-number">80</span>)<font></font>
parallel_coordinates(df_final, <span class="hljs-string">'cut'</span>, colormap=<span class="hljs-string">'Dark2'</span>)<font></font>
<font></font>
<span class="hljs-comment"># Lighten borders</span>
plt.gca().spines[<span class="hljs-string">"top"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"bottom"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"right"</span>].set_alpha(<span class="hljs-number">0</span>)<font></font>
plt.gca().spines[<span class="hljs-string">"left"</span>].set_alpha(<span class="hljs-number">.3</span>)<font></font>
<font></font>
plt.title(<span class="hljs-string">'Parallel Coordinated of Diamonds'</span>, fontsize=<span class="hljs-number">22</span>)<font></font>
plt.grid(alpha=<span class="hljs-number">0.3</span>)<font></font>
plt.xticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.yticks(fontsize=<span class="hljs-number">12</span>)<font></font>
plt.show()<font></font>
</code></pre><br>
</div></div><br>
<img src="https://habrastorage.org/webt/gt/mx/-7/gtmx-7rlwt_obq2rns8zrkdchio.png"><br>
<br><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ジュピターの</font></a><font style="vertical-align: inherit;"> 
ボーナス</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ガチョウ、あなたは雰囲気を約束しました！</font></font></b><div class="spoiler_text"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  ,     .       , ,      ,           .<br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468277/index.html">プログラマーの仕事は難しいですか-心理生理学の観点からの視点</a></li>
<li><a href="../ja468287/index.html">C＃属性：すべての側面について</a></li>
<li><a href="../ja468289/index.html">AM</a></li>
<li><a href="../ja468291/index.html">マークゴールストンの本「I Can You Hear You Through」の概要</a></li>
<li><a href="../ja468293/index.html">Vive Cosmos-HTCの新しいVRセットのレビュー</a></li>
<li><a href="../ja468299/index.html">2019年以降に開発者のためにOracleを開発するもの</a></li>
<li><a href="../ja468305/index.html">手続き型ムーンメイキング</a></li>
<li><a href="../ja468309/index.html">Cascadiaコードフォントの紹介</a></li>
<li><a href="../ja468311/index.html">Pythonプログラムを使用してダウンロードフォルダーをクリアする</a></li>
<li><a href="../ja468315/index.html">OK.RU APIで正しい署名（SIG）を生成する方法。エラー104で動作します</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>