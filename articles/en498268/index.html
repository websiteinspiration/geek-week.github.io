<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµ ‚öïÔ∏è üëû Free Mosbirge API in Microsoft Excel Formulas üê• üíÖüèæ üîï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Previously, I wrote about receiving data from the Moscow Exchange through the formulas of Google Sheets . However, the question remained: is it possib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Free Mosbirge API in Microsoft Excel Formulas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498268/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Previously, I wrote about receiving </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data from the Moscow Exchange through the formulas of Google Sheets</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">However, the question remained: is it possible to obtain the same data when using Microsoft Excel or its free analogue LibreOffice Calc locally? </font><font style="vertical-align: inherit;">Without using scripts or manual copying. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/493/2b3/769/4932b37697153fb1672d2e55509ecbbb.gif"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft Excel with formulas for obtaining data from Mosbirzha</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
And you can give a positive answer to this question. </font><font style="vertical-align: inherit;">This is even more convenient, since you do not have to expect the results of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IMPORTXML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function to </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">load</font></a><font style="vertical-align: inherit;"> in Google Tables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An analog of this function in Excel and Calc is a bunch of formulas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WEBSERVICE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FILTERXML (FILTER.XML)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When working with Microsoft Excel, there are some nuances:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These features are available only in Excel 2013 and later versions for Windows.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These features will not return results on a Mac.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LibreOffice Calc has fewer such restrictions:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requires LibreOffice 4.2 and higher.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are no restrictions on the OS used. </font><font style="vertical-align: inherit;">Works under: </font></font><br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/089/7cc/ccc0897ccad4ef7cc63b425223695d3f.png" width="18" alt="image"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows </font></font><br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/089/7cc/ccc0897ccad4ef7cc63b425223695d3f.png" width="18" alt="image"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux </font></font><br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/089/7cc/ccc0897ccad4ef7cc63b425223695d3f.png" width="18" alt="image"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mac OS</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Excel .xlsx file opens and is operational, but visually formatting may be broken.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I assembled a workable example " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with the functions that are described in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">program interface to the information and statistical server of the Moscow Exchange (ISS / ISS)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Plus, he added some functions that were found by readers of the first part of the article about Google tables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tested this file in Microsoft Excel 2019 under Windows 10 and in LibreOffice Calc 6.4 under Linux Mint 19.3. </font><font style="vertical-align: inherit;">Under Mac OS, I was not able to test.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moscow Exchange API in MS Excel formulas</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, all the requests that can be sent to the Mosbirzi API are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the directory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">But for me personally, this guide is still not very clear, although I contact the API quite often.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bid Mode Id</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the Moscow Exchange API, a lot depends on the parameter ‚ÄúTrading mode identifier‚Äù (primary_boardid), which can be viewed directly </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on their website through the search form</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f97/23c/77f/f9723c77f352463f3b678175ce7d46d3.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trading mode identifier for Tinkoff shares.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Also, this identifier can be viewed through a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regular HTTP request to the API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">https://iss.moex.com/iss/securities.xml?q=      &amp;iss.meta=off&amp;securities.columns=name,emitent_inn,isin,secid,primary_boardid
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/50b/771/5b7/50b7715b7befe411ce694a7c0779151d.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Search through the HTTP request to the Mosbirzi API for the word Perm </font></font></i><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic receipt of the name of stocks, bonds and ETFs</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It is very convenient that you can get the full or short name of the instrument. </font><font style="vertical-align: inherit;">For bonds, the full name is especially clear. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b77/315/377/b773153772469fe47c383a01b0da9fa8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with examples of automatically obtaining a name for different asset classes. </font><font style="vertical-align: inherit;">Works correctly in LibreOffice Calc</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic receipt of current prices</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This tab provides relevant examples for obtaining stock prices, bonds and ETFs from the Moscow Exchange. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The price of the previous day is taken through PREVADMITTEDQUOTE, and not LAST with a 15 minute delay, because for some low-liquid instruments through LAST there may simply not be prices. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b57/a57/1be/b57a571be498bcdaadc8f9fc2a0bb092.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with examples of automatically obtaining a name for different asset classes. </font><font style="vertical-align: inherit;">Works correctly in LibreOffice Calc</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic receipt of dividend payments for shares</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A very convenient function of the Moscow Exchange, which allows you to get not only the value of the current payment, but also the history of dividend payments along with dates and values. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/5f8/793/ab8/5f8793ab89eca9f4a6613bcf8e479af5.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with examples of automatically obtaining a name for different asset classes. </font><font style="vertical-align: inherit;">Works correctly in LibreOffice Calc</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic receipt of bond payments</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For bonds (not only corporate, but also OFZ and Eurobonds), you can automatically receive the date of payment of the next coupon and its value. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/09c/0f6/e5a/09c0f6e5a2ce2514c4ddf7f54144dd71.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with examples of automatically obtaining a name for different asset classes. </font><font style="vertical-align: inherit;">Works correctly in LibreOffice Calc</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatic receipt of offer dates</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is convenient to plan your own finances by receiving offer dates (the date on which the investor or issuer has the right to early repay the bond at par value) automatically. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/317/70c/191/31770c1911bbc663fe92020fe5c691f5.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>API   Microsoft Excel.xlsx</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" with examples of automatically obtaining a name for different asset classes. </font><font style="vertical-align: inherit;">Works correctly in LibreOffice Calc</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Moscow Exchange API provides broad capabilities that are much broader than those described in this article. </font><font style="vertical-align: inherit;">This article is a kind of cheat sheet for a long-term private investor who keeps records in a local file on his own computer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I also want to note that I have nothing to do with the Moscow Exchange and I use ISS Mosbirzhy only for my personal interests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posted by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Shardin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
April 21, 2020</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498252/index.html">Saving a 12-year forklift battery</a></li>
<li><a href="../en498256/index.html">A small international PHP mitap online</a></li>
<li><a href="../en498258/index.html">New in April. Intel Comet Lake-H</a></li>
<li><a href="../en498260/index.html">Does RuTracker die? We analyze distributions</a></li>
<li><a href="../en498262/index.html">How to localize profanity in films and computer games: three different approaches</a></li>
<li><a href="../en498270/index.html">What IT professionals are hired during the economic crisis and pandemic?</a></li>
<li><a href="../en498272/index.html">Save time and effort on implementing secure development standards with OWASP SAMM</a></li>
<li><a href="../en498276/index.html">RuCode Online Sports Programming Championship</a></li>
<li><a href="../en498278/index.html">Publisher Peter. Spring sale</a></li>
<li><a href="../en498280/index.html">The story of the Dodo bird from the genus Phoenix. The Great Fall of Dodo IS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>