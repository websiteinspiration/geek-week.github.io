<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✊🏿 🎒 🌸 Introduction to Redux & React-redux 📫 👅 🧛🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Table of contents
 Introduction 
 1. Installation and getting started 
 2. Redux
 .... 2.1 createStore
 .... 2.2 reducer ()
 .... 2.3 dispatch ()
 ......">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Introduction to Redux & React-redux</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498860/"><img src="https://habrastorage.org/getpro/habr/post_images/1d3/8bd/7bf/1d38bd7bfd244a573a3170a3f753c900.png" alt="image"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table of contents</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Installation and </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">getting </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">started </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Redux</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1 createStore</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2 reducer ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3 dispatch ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 actionCreator ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5 Actions</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6 getState ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.7 subscribe ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.8 combineReducers ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.9 initialState </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. React-redux</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 Provider</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 mapStateToProps ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3 mapDispatchToProps ()</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.... </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.4 connect ()</font></font></a><br>
<br>
<a name="00"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So you read </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">my article about React</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (if not, I strongly recommend that you do this) and you started developing applications on it. But what is it? You notice how with the extension of your application it becomes more difficult to monitor the current state, it is difficult to monitor when and which components are rendered, when they are not rendered and why they are not rendered, it is difficult to monitor the flow of changing data. For this, there is a Redux library. React itself, although lightweight, but for a comfortable development on it you need to learn a lot.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And today we will analyze 2 libraries: Redux and React-redux. To use Redux, you do not need to download additional libraries, but if you use it in conjunction with the React-redux library, development becomes even more convenient and easier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can find all the examples from this article in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repository on Github. There is a fully customized React application using Redux and React-redux. You can use it as a starting point for your project. Change the file names and add new ones to this repository to create your own application. Look at the releases tab to find different versions of the application. The first contains the application using only Redux, the second using Redux and React-redux. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Motivation to use Redux</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The local storage mechanism of the component that comes with the core library (React) is inconvenient in that such storage is isolated. For example, if you want different independent components to respond to an event, you will either have to pass the local state in the form of props to the child components, or raise it up to the nearest parent component. In both cases, this is not convenient. The code becomes more dirty, hard to read, and the components depend on their nesting. Redux removes this problem since the entire state is accessible by the entire component without much difficulty. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redux is a universal development tool and can be used in conjunction with various libraries and frameworks. The same article will discuss the use of Redux in React applications.</font></font><br>
<br>
<a name="01"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Install Redux and get started</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Whether you use Yarn or Npm, run one of these commands to install Redux:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># NPM</span><font></font>
npm install redux<font></font>
<font></font>
<span class="hljs-comment"># Yarn</span>
yarn add redux </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely you are using the src folder in which your code base is stored. </font><font style="vertical-align: inherit;">Files associated with redux are usually stored in a separate folder. </font><font style="vertical-align: inherit;">To do this, I use the / src / store folder, which stores everything related to Redux and the application storage. </font><font style="vertical-align: inherit;">You can name it differently or put it in another place. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create a basic structure for the repository. </font><font style="vertical-align: inherit;">It should look something like this: </font><font style="vertical-align: inherit;">
Of course, here I used primitive names for files, this is done for clarity. </font><font style="vertical-align: inherit;">In this project, files should not be called like that.</font></font><br>
<br>
<code>.store<br>
├── actionCreators<br>
│ ├── action_1.js<br>
│ └── action_2.js<br>
├── actions<br>
│ ├── action_1.js<br>
│ └── action_2.js<br>
├── reducers<br>
│ ├── reducer_1.js<br>
│ ├── reducer_2.js<br>
│ └── rootReducer.js<br>
├── initialState.js<br>
└── store.js<br>
</code><br><font style="vertical-align: inherit;"></font><br>
<br>
<a name="02"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Redux</font></font></h2><br>
<a name="021"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1 createStore</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When you created the basic structure for working with the Redux repository, it's time to understand how you can interact with it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The global application storage is created in a separate file, which is usually called store.js:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//   store.js</span>
<span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> store = createStore(reducer);<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;</code></pre><br>
<a name="022"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2 reducer ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
reducer is a pure function that will be responsible for updating the state. </font><font style="vertical-align: inherit;">Here the logic is implemented in accordance with which the store fields will be updated. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is what the basic reducer function looks like:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">state, action</span>) </span>{
    <span class="hljs-keyword">switch</span>(action.type) {
        <span class="hljs-keyword">case</span> ACTION_1: <span class="hljs-keyword">return</span> { <span class="hljs-attr">value</span>: action.value_1 };
        <span class="hljs-keyword">case</span> ACTION_2: <span class="hljs-keyword">return</span> { <span class="hljs-attr">value</span>: action.value_2 };<font></font>
        <font></font>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function takes the value of the current state and the event object (action). </font><font style="vertical-align: inherit;">An event object contains two properties: the type of the event (action.type) and the value of the event (action.value). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, if you need to process the onChange event for an input field, then the event object may look like this:</font></font><br>
<br>
<pre><code class="json hljs">{<font></font>
    type: <span class="hljs-string">"ACTION_1"</span>,<font></font>
    value: <span class="hljs-string">"   "</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some events may not need to convey any meaning. For example, when processing an onClick event, we can signal that an event has occurred, no more data is required, and how the logic embedded directly in the component itself should respond to it and partially in the reducer how it will respond. But in all cases it is necessary to determine the type of event. The reducer asks: what happened? actio.type is equal to "ACTION_1" yeah, then event number 1 happened. Next, you need to process it and update the state somehow. What the reducer will return and will be a new state. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ACTION_1 and ACTION_2 are event constants. Differently Actions. We will talk about them further </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5 Actions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you may have guessed, a store can store a complex data structure consisting of a set of independent properties. </font><font style="vertical-align: inherit;">Updating one property will leave other properties untouched. </font><font style="vertical-align: inherit;">So from the example above, when event number one (ACTION_1) occurs, field number one (value_1) in the store is updated while field number two (value_2) remains untouched. </font><font style="vertical-align: inherit;">In general, the mechanism is similar to the this.setState () method.</font></font><br>
<br>
<a name="023"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3 dispatch ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To update the store, you must call the dispatch () method. </font><font style="vertical-align: inherit;">It is called on the store object that you create in store.js. </font><font style="vertical-align: inherit;">This object is called store so the update of the state in my case looks like this:</font></font><br>
<br>
<pre><code class="javascript hljs">store.dispatch({ <span class="hljs-attr">type</span>: ACTION_1, <span class="hljs-attr">value_1</span>: <span class="hljs-string">"Some text"</span> });</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Onchange is an event constant which will be discussed later (see </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This function will call the reducer function, which will handle the event and update the corresponding storage fields.</font></font><br>
<br>
<a name="024"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 actionCreator ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually, passing an event object directly to dispatch () is a sign of bad tone. </font><font style="vertical-align: inherit;">To do this, use a function called actionCreator. </font><font style="vertical-align: inherit;">She does exactly what is expected. </font><font style="vertical-align: inherit;">Creates an event! </font><font style="vertical-align: inherit;">The call to this function must be passed as an argument to dispatch and passed to the actionCreator the necessary value (value). </font><font style="vertical-align: inherit;">The base actionCreator is as follows:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action_1</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">return</span> { 
        <span class="hljs-attr">type</span>: ACTION_1,
        <span class="hljs-attr">value_1</span>: value<font></font>
    };<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> action_1;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the dispatch call should look like this: </font></font><br>
<br>
<pre><code class="javascript hljs">store.dispatch(action_1(<span class="hljs-string">"Some value"</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using actionCreator, the code becomes cleaner.</font></font><br>
<br>
<a name="025"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5 Actions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
actions are constants describing the event. </font><font style="vertical-align: inherit;">Usually this is just a line with the name describing the event. </font><font style="vertical-align: inherit;">For example, the constant describing event number one will look like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> ACTION_1 = <span class="hljs-string">"ACTION_1"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ACTION_1;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Again, in the project, you should name the constants according to the event that it describes: onClick, createUserSesion, deleteItem, addItem, etc. </font><font style="vertical-align: inherit;">The main thing is to make it clear. </font><font style="vertical-align: inherit;">Note that I did not write import anywhere, so be sure to import your constants before using them. </font><font style="vertical-align: inherit;">Because it’s also customary to break constants into separate files by storing them in a special folder. </font><font style="vertical-align: inherit;">Although some store them in a single file called actionTypes.js. </font><font style="vertical-align: inherit;">Such a decision cannot be called not correct, but not ideal either.</font></font><br>
<br>
<a name="026"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6 getState ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using dispatch () they updated it, but now how to look at the new store value? </font><font style="vertical-align: inherit;">There is no need to invent anything; there is a getState () method. </font><font style="vertical-align: inherit;">It, like the dispatch method, is called on an instance of the store object. </font><font style="vertical-align: inherit;">Therefore, for my example, the call</font></font><br>
<br>
<pre><code class="javascript hljs">store.getState()</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
will return the value of the storage fields. </font><font style="vertical-align: inherit;">For example, to see the value of the value_1 field, you will need to call</font></font><br>
<br>
<pre><code class="javascript hljs">store.getState().value_1</code></pre><br>
<a name="027"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.7 subscribe ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But how do you know when the state is updated? </font><font style="vertical-align: inherit;">There is a subscribe () method for this. </font><font style="vertical-align: inherit;">It is also called on the store instance. </font><font style="vertical-align: inherit;">This method accepts a function that will be called each time the store is updated. </font><font style="vertical-align: inherit;">He, as it were, “signs” the function transferred to him for updating. </font><font style="vertical-align: inherit;">For example, the following code will display a new store value on the console with each update (each time dispatch () is called).</font></font><br>
<br>
<pre><code class="javascript hljs">store.subscribe(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.info(store.getState()))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This method returns the unsubscribe () function. </font><font style="vertical-align: inherit;">Which allows you to "unsubscribe from the update." </font><font style="vertical-align: inherit;">For example, if a component is removed from the DOM, you should unsubscribe its methods from updating in componentWillUnmount (). </font><font style="vertical-align: inherit;">This lifecycle method is called when the component is unmounted and this is exactly the place where you should unsubscribe from the update. </font><font style="vertical-align: inherit;">Simply put in a destructor.</font></font><br>
<br>
<a name="028"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.8 combineReducers ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
combineReducers () allows you to combine several reducers into one. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the logic for updating components is rather complicated and / or it is necessary to handle a large number of different types of events, then the root reducer may become too cumbersome. </font><font style="vertical-align: inherit;">The best solution would be to split it into several separate reducers, each of which is responsible for processing only one type of event and updating a specific field. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention!</font></font></b><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When you break the base reducer into several, the name of each of them should correspond to the field that it updates in the store.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For example, if a reducer updates field number one, then it might look like this: </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">value_1</span>(<span class="hljs-params">state, action</span>) </span>{
    <span class="hljs-keyword">switch</span>(action.type) {
        <span class="hljs-keyword">case</span> ACTION_1: <span class="hljs-keyword">return</span> action.value_1;<font></font>
        <font></font>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> value_1;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The name of the reducer (value_1) indicates which property it will update in the store. </font><font style="vertical-align: inherit;">If you rename it to value_2 then it will update value_2. </font><font style="vertical-align: inherit;">Therefore, keep this in mind! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When using a single reducer we show which field we want to update:</font></font><br>
<br>
<pre><code class="javascript hljs"> <span class="hljs-keyword">case</span> ACTION_1: <span class="hljs-keyword">return</span> { <span class="hljs-attr">value_1</span>: action.value_1 };</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But when you split your reducers you just need to return a new value: </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">case</span> ACTION_1: <span class="hljs-keyword">return</span> action.value_1;</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since it is not required to indicate which of the fields the reducer updates, because its name is the field that it updates.</font></font><br>
<br>
<a name="029"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.9 initialState</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
initialState is an object representing the initial state of the store. It is the second optional argument to the createStore () method. With the creation of the repository, you can immediately declare the initial state for its fields. This object is desirable to create, even in cases where the announcement of the initial state is not required. Because this object helps to look at the structure of the repository and the name of its fields. A typical initialState object looks like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> initialState = {
    <span class="hljs-attr">date_1</span>: <span class="hljs-string">"value..."</span>,
    <span class="hljs-attr">date_2</span>: <span class="hljs-string">"value..."</span><font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> initialState;</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In some cases (when the component immediately uses the value from the store), its declaration may become mandatory, otherwise you will get an error: TypeError: Cannot read property 'value_1' of undefined. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, reducers should always return the current state by default. </font><font style="vertical-align: inherit;">For example, if you use a single reducer, then the last value in switch should look like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> store;</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you divide reducers into independent functions, then it should return the value of the property for which it is responsible: </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> store.value_1;</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, if you do not pass the initialState object to createStore, you can return it from the reducer. </font><font style="vertical-align: inherit;">In both cases, the initial state for the store will be initialized.</font></font><br>
<br>
<a name="03"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. React-redux</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It would seem that we have everything to use Redux. </font><font style="vertical-align: inherit;">But in fact, using it without the React-redux package in React applications does not look very nice.</font></font><br>
<br>
<a name="031"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 Provider</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To use store in a component, you need to pass it to props: </font></font><br>
<br>
<pre><code class="javascript hljs">ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Main</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span> /&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>));</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And then use in the component: this.props.state. </font><font style="vertical-align: inherit;">To do this, react-redux provides the Provider method:</font></font><br>
<br>
<pre><code class="javascript hljs">ReactDOM.render(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Main</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>, 
<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>));</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the connect method will be able to use store. </font><font style="vertical-align: inherit;">Otherwise, you get an error: Error: Could not find "store" in the context of "Connect (Main)". </font><font style="vertical-align: inherit;">Either wrap the root component in a, or pass a custom React context provider to and the corresponding React context consumer to Connect (Main) in connect options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also pass store directly to a component without wrapping it in a Provider and this will work. </font><font style="vertical-align: inherit;">But better still use Provider.</font></font><br>
<br>
<a name="032"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 mapStateToProps ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This method is called whenever the store is updated and it is it that passes the necessary properties from store to the component. </font><font style="vertical-align: inherit;">For example, a component must respond and update the UI every time the field number one (value_1) is updated. </font><font style="vertical-align: inherit;">He does not need to react to updating other fields. </font><font style="vertical-align: inherit;">If you are not using React-redux, you would have to use the subscribe () method to find out about the update and then somehow check whether the field number one was updated or not. </font><font style="vertical-align: inherit;">In general, it is easy to understand that such code will look too dirty and redundant. </font><font style="vertical-align: inherit;">Using mapStateToProps (), you can clearly determine which fields interest the component. </font><font style="vertical-align: inherit;">And what fields should he react to.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Returning to the example above, if component one needs to get field number one (value_1) then mapStateToProps for it will look like this: </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state</span>) </span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">value_1</span>: state.value_1<font></font>
    };<font></font>
}</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After inside the component, we can access the value_1 field through this.props.value_1. </font><font style="vertical-align: inherit;">And every time this field is updated, the component will be rendered again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can create a separate folder in / src / store to store files, each of which will contain the mapStateToProps function for all your components. </font><font style="vertical-align: inherit;">Or (as I did) use a single function that returns the mapStateToProps function for each component. </font><font style="vertical-align: inherit;">Personally, I like this approach. </font><font style="vertical-align: inherit;">Such a function is as follows:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapStateToProps</span>(<span class="hljs-params">component</span>) </span>{
    <span class="hljs-keyword">switch</span>(component) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Component_1"</span>: {
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state</span>) </span>{
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-attr">value_1</span>: state.value_1<font></font>
                };<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Component_2"</span>: {
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">state</span>) </span>{
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-attr">value_2</span>: state.value_2<font></font>
                };<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-attr">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> mapStateToProps;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This function takes an argument string with the name of the component as an argument and returns a mapStateToProps function which returns an object with the property from store necessary for this component. </font><font style="vertical-align: inherit;">This function can be called mapStateToPropsGenerator ().</font></font><br>
<br>
<a name="033"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3 mapDispatchToProps ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This function passes methods to the component to update the required store field. In order not to call dispatch directly from the component, you will use this method in order to pass to the props method a call to which will result in a dispatch call and updating the corresponding field. Just now it will look more elegant, and the code more understandable and clean. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, component number one should be able to update field number one from store. Then mapDispatchToProps for it will look like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">dispatch</span>) </span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">changeValue_1</span>: bindActionCreators(action_1, dispatch)<font></font>
    };<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now to update the value_1 property, you will call changeValue_1 () through this.props.changeValue_1 (value). Without calling dispatch directly through this.props.store.dispatch (action_1 (value)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bindActionCreators should be imported from redux. It allows you to wrap the dispatch and actionCreator functions in a single object. You may not use bindActionCreators, but then the code will look redundant. You should be old to implement some kind of functionality so that the code looks simple and miniature. Therefore, nothing more should be written. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Only clean and understandable code. The bindActionCreators (actionCreator, dispatch) method accepts two required parameters: the actionCreator function, which we have already discussed and dispatch. Returning a method for changing store fields.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As with mapStateToProps, I use the generator function to return the mapDispatchToProps function for each component: </font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { bindActionCreators } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> action_1 <span class="hljs-keyword">from</span> <span class="hljs-string">'./actionCreators/action_1'</span>;
<span class="hljs-keyword">import</span> action_2 <span class="hljs-keyword">from</span> <span class="hljs-string">'./actionCreators/action_2'</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapDispatchToProps</span>(<span class="hljs-params">component</span>) </span>{ 
    <span class="hljs-keyword">switch</span>(component) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Component_1"</span>: <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dispatch</span>) </span>{
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">change_value_1</span>: bindActionCreators(action_1, dispatch)<font></font>
            };<font></font>
        };<font></font>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Component_2"</span>: <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">dispatch</span>) </span>{
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">change_value_2</span>: bindActionCreators(action_2, dispatch)<font></font>
            };<font></font>
        };<font></font>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> mapDispatchToProps;</code></pre><br>
<a name="034"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.4 connect ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well and now the climax! </font><font style="vertical-align: inherit;">That without which all this will not work. </font><font style="vertical-align: inherit;">This is the connect function. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is she who connects mapStateToProps and mapDispatchToProps with the component and passes the necessary fields and methods to it. </font><font style="vertical-align: inherit;">It returns a new wrapper component for your component. </font><font style="vertical-align: inherit;">I do not know how to properly name such a component, because the React-redux documentation itself does not describe it. </font><font style="vertical-align: inherit;">Personally, I add the _w ending for the wrapper components. </font><font style="vertical-align: inherit;">Like _w = wrap Component. </font><font style="vertical-align: inherit;">The component connection in this case looks like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> COMPONENT_1_W = connect(mapStateToProps(<span class="hljs-string">"Component_1"</span>), mapDispatchToProps(<span class="hljs-string">"Component_1"</span>))(Component_1);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 And now in ReactDOM.render () you do not pass your component, but the one that the connect function returns. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the component does not need to pass mapStateToProps or mapDispatchToProps to it, pass undefined or null to it.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498840/index.html">The bot monitors and controls the computer via telegrams</a></li>
<li><a href="../en498842/index.html">Moderation of comments: And yet, can we trust users?</a></li>
<li><a href="../en498844/index.html">Jokes and references in the "Family Guy" in English to be explained</a></li>
<li><a href="../en498854/index.html">How cybercriminals use the coronavirus pandemic for their own purposes</a></li>
<li><a href="../en498856/index.html">How to learn development in Python: a new video course of Yandex</a></li>
<li><a href="../en498870/index.html">Webinar: Analysis of the resume for the IT specialist</a></li>
<li><a href="../en498872/index.html">Minute of Self-Advertising: Slurm's Evening School by Kubernetes</a></li>
<li><a href="../en498878/index.html">Famous designers vs font readability research</a></li>
<li><a href="../en498884/index.html">We insert sticks into the wheels at the audits, or How to make IS audit as uncomfortable for the auditor as possible</a></li>
<li><a href="../en498892/index.html">The Last Renga API Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>