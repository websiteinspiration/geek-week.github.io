<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐บ ๐จ๐ฟโ๐คโ๐จ๐ฝ ๐จ๐ฝโ๐ง ุงูุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ ๐ญ ๐คฆ ๐ฉ๐ผโ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูููู ุฃู ูุคุฏู ูุถุน ุงูุชุดุบูู ุนู ุจุนุฏ ุนูู ุฎูููุฉ ุงูุนุฒู ุงูุฐุงุชู ุงูุนุงููู ุฅูู ุนูุงูุจ ุณูุฆุฉ ููุบุงูุฉ. ูุงูุฅุฑูุงู ุงูุนุงุทูู - ูุง ูุฒุงู ุฃูููุง ุฐูุจ: ููุงู ุ ุจุนุฏ ูู ุดูุก ุ ููุณ ุจุน...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุงูุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495884/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ูุคุฏู ูุถุน ุงูุชุดุบูู ุนู ุจุนุฏ ุนูู ุฎูููุฉ ุงูุนุฒู ุงูุฐุงุชู ุงูุนุงููู ุฅูู ุนูุงูุจ ุณูุฆุฉ ููุบุงูุฉ. ูุงูุฅุฑูุงู ุงูุนุงุทูู - ูุง ูุฒุงู ุฃูููุง ุฐูุจ: ููุงู ุ ุจุนุฏ ูู ุดูุก ุ ููุณ ุจุนูุฏูุง ุนู ุงูุณุทุญ. ูู ูุฐุง ุงูุตุฏุฏ ุ ูุซู ุงููุซูุฑูู ุ ุญุงูู "ุชูุฏุฆุฉ" ููุณู ุจุชุฎุตูุต ุงูููุช ููุตูู ุฃุฎุฑู - ูุจุฏุฃ ูู ุชุฑุฌูุฉ ุงูููุงูุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ุงูุฅูุฌููุฒูุฉ ุฅูู ุงูุฑูุณูุฉ: "ุฃูุช ุชุนุทู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุนูู ุงูุขูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฌูุงููุฑ!".) ูุฌุจ ุฃู ูุดูุฏ: ุฅูู ุฃูุฑ ูุดุชุช ููุงูุชุจุงู. ุฅุฐุง ูุงูุช ูุฏูู ุงูุชุฑุงุญุงุช ููู ูู ุงููุญุชูู ุงูุฏูุงูู ูุชุฑุฌูุฉ ูุฐุง ุงููุต ููุงุฑุฆ ูุชุญุฏุซ ุงูุฑูุณูุฉ ุ ุงูุถู ุฅูู ุงูููุงูุดุฉ.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3d7/fe4/946/3d7fe49466cad76814b37e73ec1bc49a.jpg" alt="ุตูุฑุฉ"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐู ุ ุฅููู ุชุฑุฌูุฉ ูุตูุญุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุณู tensorflow ุงููุฏูู: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑุงุจุท</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุชูุฏู ุงูุฅุถุงูุงุช ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฑุณูู ุงูุชูุถูุญูุฉ ููุชุฑุฌูุฉ ุฅูู ุงููุณุงุนุฏุฉ ุนูู ููู ุงูุฃููุงุฑ ุงูุฃุณุงุณูุฉ ูู ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงููุฌุงูุงุช ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ML ู ุงูุงูุชุตุงุฏ ุงูููุงุณู ุจุดูู ุนุงู - ุณูุณูุฉ ุฒูููุฉ ููุชูุจุค. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏูุฉ ุตุบูุฑุฉ ูุจู ุงูุชุฑุฌูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฏููู ูู ูุตู ููุชูุจุค ุจุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ุนูู ุฃุณุงุณ ุณูุณูุฉ ุฒูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูุณูุฉ </font><i><font style="vertical-align: inherit;">ุฒูููุฉ ุฃุญุงุฏูุฉ ุงููุชุบูุฑ)</font></i><font style="vertical-align: inherit;"> ูุณูุณูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฒูููุฉ ูุชุนุฏุฏุฉ ุงููุชุบูุฑุงุช (</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูุณูุฉ </font><i><font style="vertical-align: inherit;">ุฒูููุฉ ูุชุนุฏุฏุฉ ุงููุชุบูุฑุงุช)</font></i><font style="vertical-align: inherit;"> . ููู ุฌุฒุก ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฏุฎุงู ุงูุจูุงูุงุช</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฅุนุฏุงุฏูุง ููููุง ูุฐูู. ูุน ูุฑุงุนุงุฉ ูุฌููุนุฉ ุจูุงูุงุช ุงูุฃุฑุตุงุฏ ุงูุฌููุฉ ุงูุชู ุชู ุชูุงูููุง ูู ูุฐุง ุงูุฏููู ุ ูููู ุงููุตู ููุง ููู: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8fa/31a/a75/8fa31aa7531d8589dcee2ae93454a430.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุณุจุฉ ููุฃุณุฆูุฉ ุญูู ูุง ูุฌุจ ุงุชุฎุงุฐู ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงุฐุง ุจุงููุณุจุฉ ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฃู ููููุฉ ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ููุฆุฉ ุงูุชุฏุฑูุจ ุชุญุช ุงูุฅุดุฑุงู ุ ุณูุชุถุญ ูู ุงูุฑุณูู ุงูุชูุถูุญูุฉ ุงูุชุงููุฉ. ุฃูุงุญุธ ููุท ุฃู ุชุดููู ุงููุชุฌู ุงููุณุชูุฏู (Y) ููุนูู ูุน ูู ูู ุงูุณูุงุณู ุงูุฒูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ ูุงููุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ ูู ููุณู: ูุชู ุชุฌููุน ุงููุชุฌู ุงููุฏู ุนูู ุฃุณุงุณ ุงูุนูุงูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T (degC)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก). ุงููุฑู ุจููููุง ูู "ูุฏููู" ูู ุชุดููู ูุฌููุนุฉ ูู ุงูููุฒุงุช ุงูุชู ูุชู ุชุบุฐูุชูุง ููุฏุฎูุงุช ุงููููุฐุฌ: ูู ุญุงูุฉ ุณูุณูุฉ ุฒูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ ููุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ุงููุณุชูุจู ุ ูุชููู ูุงูู ุงูุฅุฏุฎุงู (X) ูู ููุฒุฉ ูุงุญุฏุฉ: ูู ุงููุงูุน ุ ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ุ ููุฃุจุนุงุฏ ูุชุนุฏุฏุฉ - ุฃูุซุฑ ูู ูุงุญุฏ: ุจุงูุฅุถุงูุฉ ุฅูู ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ุ ูุชู ุงุณุชุฎุฏุงู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p (mbar)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุถุบุท ุงูุฌูู) ู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rho (g / m ** 3)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุฑุทูุจุฉ) </font><font style="vertical-align: inherit;">ูู ูุซุงู ุงูุฏููู ุงููุนูู </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุจุฏุงูุฉ ุ ุชุจุฏู ูุธุฑุฉ ุถุญูุฉ ุจุนูุฏุฉ ุ ูุซุงู ูุน ุงูุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุบูุฑ ูููุน ูู ูุฌูุฉ ูุธุฑ ุงุณุชุฎุฏุงู ูุฏุฎู ูุชุนุฏุฏ ุงูุฃุจุนุงุฏ: ููุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุ ุณุชููู ุงูุนูุงูุฉ ุงูุฃูุซุฑ ุตูุฉ ูู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ. ููุน ุฐูู ุ ููุณ ูุฐุง ูู ุงูุญุงู ุชูุงููุง: ูู ุฃุฌู ูุถุน ุชูุจุค ููุนู ูุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ุ ูุฌุจ ูุฑุงุนุงุฉ ุงูุนุฏูุฏ ูู ุงูุนูุงูู ุ ุญุชู ุงุญุชูุงู ุงูููุงุก ุนูู ุณุทุญ ุงูุฃุฑุถ ุ ุฅูุฎ. ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ุจุนุถ ุงูุฃุดูุงุก ุจุนูุฏุฉ ุนู ุงููุถูุญ ุ ููุฏ ูููู ูุงูู ุงููุฏู ูู ุดูู ุฐูู ุงููุฒูุฌ (ุฃู ุงูุจุฑุด). ูู ูุฐุง ุงูุตุฏุฏ ุ ูุฅู ุชุญููู ุงูุจูุงูุงุช ุงูุงุณุชูุดุงููุฉ ูุน ุงุฎุชูุงุฑ ุงูุณูุงุช ุงูุฃูุซุฑ ุตูุฉ ููุชูููู ุงููุงุญู ููุฏุฎูุงุช ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ ูู ุงููุฑุงุฑ ุงูุตุญูุญ ุงููุญูุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ุ ูุชู ุนุฑุถ ุชุฑุฌูุฉ ุงูุฏููู ุฃุฏูุงู. ุณูููู ุงููุต ุงูุฅุถุงูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆููุง</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุงูุฏููู ููุฏูุฉ ูุชูุจุค ุงูุณูุงุณู ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ (RNS ุ ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฅูุฌููุฒูุฉ </font><i><font style="vertical-align: inherit;">ุ RNN</font></i><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">ูุชููู ูู ุฌุฒุฃูู: ุงูุฃูู ูุตู ุงูุชูุจุค ุจุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ุนูู ุฃุณุงุณ ุณูุณูุฉ ุฒูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ ุ ูุงูุซุงูู - ูุนุชูุฏ ุนูู ุณูุณูุฉ ุฒูููุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-keyword">import</span> matplotlib <span class="hljs-keyword">as</span> mpl
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
mpl.rcParams[<span class="hljs-string">'figure.figsize'</span>] = (<span class="hljs-number">8</span>, <span class="hljs-number">6</span>)<font></font>
mpl.rcParams[<span class="hljs-string">'axes.grid'</span>] = <span class="hljs-literal">False</span>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุนุฉ ูู ุจูุงูุงุช ุงูุฃุฑุตุงุฏ ุงูุฌููุฉ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุฌููุน ุงูุฃูุซูุฉ ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุณูุณู ุงูุฒููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงุณุชุฎุฏุงู ุงููุฏูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ูุจูุงูุงุช ุงูุทูุณ</font></a><font style="vertical-align: inherit;"> ุงููุณุฌูุฉ ูู ูุญุทุฉ ุงูุฃุฑุตุงุฏ ุงูุฌููุฉ ุงูููุฏุฑูููุฌูุฉ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูุฏ ุงูููููุงุก ุงูุญูููุฉ ุงูุชู ุณููุช ุจุงุณู </font><font style="vertical-align: inherit;">ูุงูุณ ุจูุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุชุถูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฐู ููุงุณุงุช ูู 14 ูุคุดุฑูุง ูุฎุชูููุง ููุฃุฑุตุงุฏ ุงูุฌููุฉ (ูุซู ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ูุงูุถุบุท ุงูุฌูู ูุงูุฑุทูุจุฉ) ุ ูุชู ุฅุฌุฑุงุคูุง ูู 10 ุฏูุงุฆู ููุฐ ุนุงู 2003. </font><font style="vertical-align: inherit;">ูุชูููุฑ ุงูููุช ูุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุ ุณูุณุชุฎุฏู ุงูุฏููู ุจูุงูุงุช ุชุบุทู ุงููุชุฑุฉ ูู 2009 ุฅูู 2016. </font><font style="vertical-align: inherit;">ุฃุนุฏ ูุฐุง ุงููุณู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฑุงูุณูุง ุดูููู ุนู ูุชุงุจู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deep Learning with Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">zip_path = tf.keras.utils.get_file(<font></font>
    origin=<span class="hljs-string">'https://storage.googleapis.com/tensorflow/tf-keras-datasets/jena_climate_2009_2016.csv.zip'</span>,<font></font>
    fname=<span class="hljs-string">'jena_climate_2009_2016.csv.zip'</span>,<font></font>
    extract=<span class="hljs-literal">True</span>)<font></font>
csv_path, _ = os.path.splitext(zip_path)<font></font>
</code></pre><br>
<pre><code class="python hljs">df = pd.read_csv(csv_path)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ูุง ูุฏููุง.</font></font><br>
<br>
<pre><code class="python hljs">df.head()
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/d5d/bfa/539/d5dbfa539de3da5ca04103b2db380a70.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงูุชุญูู ูู ุญูููุฉ ุฃู ูุชุฑุฉ ุชุณุฌูู ุงูููุงุญุธุฉ 10 ุฏูุงุฆู ุจูุงุณุทุฉ ุงูุฌุฏูู ุฃุนูุงู. ูููุฐุง ุ ูู ุณุงุนุฉ ูุงุญุฏุฉ ุณูููู ูุฏูู 6 ููุงุญุธุงุช. ูู ุงูููุงุจู ุ ูุชู ุชุฌููุน 144 (6 ร 24) ููุงุญุธุฉ ูู ุงูููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชุฑุถ ุฃูู ุชุฑูุฏ ุงูุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุ ุงูุชู ุณุชููู ูู ุบุถูู 6 ุณุงุนุงุช ูู ุงููุณุชูุจู. ุชููู ุจุนูู ูุฐู ุงูุชููุนุงุช ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงูุชู ูุฏูู ููุชุฑุฉ ูุนููุฉ: ุนูู ุณุจูู ุงููุซุงู ุ ุชูุฑุฑ ุงุณุชุฎุฏุงู 5 ุฃูุงู ูู ุงููุฑุงูุจุฉ. ูุฐูู ุ ูุชุฏุฑูุจ ุงููููุฐุฌ ุ ูุฌุจ ุนููู ุฅูุดุงุก ูุงุตู ุฒููู ูุญุชูู ุนูู ุขุฎุฑ 720 ููุงุญุธุฉ (5x144) ูู ุงูููุงุญุธุงุช (ูุธุฑูุง ูุฃู ุงูุชููููุงุช ุงููุฎุชููุฉ ููููุฉ ุ ุชุนุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฐู ุฃุณุงุณูุง ุฌูุฏูุง ููุชุฌุงุฑุจ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุนุฑุถ ุงููุธููุฉ ุฃุฏูุงู ุงููุชุฑุงุช ุงูุฒูููุฉ ุฃุนูุงู ูุชุฏุฑูุจ ุงููููุฐุฌ. ุฌุฏุงู</font></font><code>history_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ูุฐุง ูู ุญุฌู ุงููุงุตู ุงูุฒููู ุงูุฃุฎูุฑ ุ </font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุญุฌุฉ ุชุญุฏุฏ ุฅูู ุฃู ูุฏู ูุฌุจ ุฃู ูุชุนูู ุงููููุฐุฌ ุงูุชูุจุค ูู ุงููุณุชูุจู. </font><font style="vertical-align: inherit;">ุจูุนูู ุขุฎุฑ ุ </font></font><code>target_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงูู ุงููุณุชูุฏู ุงูุฐู ูุฌุจ ุชููุนู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">univariate_data</span>(<span class="hljs-params">dataset, start_index, end_index, history_size, target_size</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i)<font></font>
    <span class="hljs-comment"># Reshape data from (history_size,) to (history_size, 1)</span>
    data.append(np.reshape(dataset[indices], (history_size, <span class="hljs-number">1</span>)))<font></font>
    labels.append(dataset[i+target_size])<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฌุฒุฃู ุงูุฏููู ุ ุณูุชู ุงุณุชุฎุฏุงู ุฃูู 300000 ุตู ูู ุงูุจูุงูุงุช ูุชุฏุฑูุจ ุงููููุฐุฌ ุ ูุงูุจุงูู ููุชุญูู ูู ุตุญุฉ (ุงูุชุญูู). </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ููุฏุงุฑ ุจูุงูุงุช ุงูุชุฏุฑูุจ 2100 ููููุง ุชูุฑูุจูุง.</font></font><br>
<br>
<pre><code class="python hljs">TRAIN_SPLIT = <span class="hljs-number">300000</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุถูุงู ูุชุงุฆุฌ ูุงุจูุฉ ููุชูุฑุงุฑ ุ ูุชู ุชุนููู ูุธููุฉ ุงูุจุฐูุฑ.</font></font><br>
<br>
<pre><code class="python hljs">tf.random.set_seed(<span class="hljs-number">13</span>)
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฒุก 1. ุงูุชูุจุค ุนูู ุฃุณุงุณ ุณูุณูุฉ ุฒูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุฌุฒุก ุงูุฃูู ุ ุณุชููู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู ุณูุฉ ูุงุญุฏุฉ ููุท - ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุ </font><font style="vertical-align: inherit;">ุณูุชู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงููุฏุฑุจ ููุชูุจุค ุจุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ ุงููุณุชูุจููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุจุฏุก ุ ูุณุชุฎุฑุฌ ููุท ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช.</font></font><br>
<br>
<pre><code class="python hljs">uni_data = df[<span class="hljs-string">'T (degC)'</span>]<font></font>
uni_data.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
uni_data.head()<font></font>
</code></pre><br>
<code>Date Time<br>
01.01.2009 00:10:00 -8.02<br>
01.01.2009 00:20:00 -8.41<br>
01.01.2009 00:30:00 -8.51<br>
01.01.2009 00:40:00 -8.31<br>
01.01.2009 00:50:00 -8.27<br>
Name: T (degC), dtype: float64<br>
</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏุนูุง ูุฑู ููู ุชุชุบูุฑ ูุฐู ุงูุจูุงูุงุช ุจูุฑูุฑ ุงูููุช.</font></font><br>
<br>
<pre><code class="python hljs">uni_data.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/208/b35/242/208b35242d3ce1ed30bd25d12d956703.jpg" alt="ุตูุฑุฉ"><br>
<br>
<pre><code class="python hljs">uni_data = uni_data.values
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจู ุชุฏุฑูุจ ุดุจูุฉ ุนุตุจูุฉ ุงุตุทูุงุนูุฉ (ูู ุงูุขู ูุตุงุนุฏูุง - ANN) ุ ูุฅู ุฎุทูุฉ ูููุฉ ูู ุชุญุฌูู ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ูุนุฏ ุงูุชูุญูุฏ ุงูููุงุณู ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุญูุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">ุฃุญุฏ ุงูุทุฑู ุงูุดุงุฆุนุฉ ูุฅุฌุฑุงุก ุงูููุงุณ ุ ููุชู ุฐูู </font><font style="vertical-align: inherit;">ุนู ุทุฑูู ุทุฑุญ ุงููุชูุณุท โโูุงูุงููุณุงู ุจูุงุณุทุฉ ุงูุงูุญุฑุงู ุงููุนูุงุฑู ููู ุฎุงุตูุฉ. </font><font style="vertical-align: inherit;">ููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุทุฑููุฉ </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">tf.keras.utils.normalize</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฌูู ุงูููู ุฅูู ุงููุทุงู [0ุ1]. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ูุฌุจ ุฃู ูุชู ุงูุชูููุณ ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุชุฏุฑูุจ ููุท.</font></font><br>
<br>
<pre><code class="python hljs">uni_train_mean = uni_data[:TRAIN_SPLIT].mean()<font></font>
uni_train_std = uni_data[:TRAIN_SPLIT].std()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุชูุญูุฏ ุงูุจูุงูุงุช.</font></font><br>
<br>
<pre><code class="python hljs">uni_data = (uni_data-uni_train_mean)/uni_train_std
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุณูููู ุจุฅุนุฏุงุฏ ุงูุจูุงูุงุช ูููููุฐุฌ ุจุฅุฏุฎุงู ุฃุญุงุฏู ุงูุจุนุฏ. </font><font style="vertical-align: inherit;">ุณูุชู ุชุบุฐูุฉ ุขุฎุฑ 20 ููุงุญุธุฉ ูุณุฌูุฉ ูุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุฅูู ูุฏุฎู ุงููููุฐุฌ ุ ููุฌุจ ุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ุงูุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ุงูุฎุทูุฉ ุงูุฒูููุฉ ุงูุชุงููุฉ.</font></font><br>
<br>
<pre><code class="python hljs">univariate_past_history = <span class="hljs-number">20</span>
univariate_future_target = <span class="hljs-number">0</span><font></font>
<font></font>
x_train_uni, y_train_uni = univariate_data(uni_data, <span class="hljs-number">0</span>, TRAIN_SPLIT,<font></font>
                                           univariate_past_history,<font></font>
                                           univariate_future_target)<font></font>
x_val_uni, y_val_uni = univariate_data(uni_data, TRAIN_SPLIT, <span class="hljs-literal">None</span>,<font></font>
                                       univariate_past_history,<font></font>
                                       univariate_future_target)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุงุฆุฌ ุชุทุจูู ุงููุธููุฉ </font></font><code>univariate_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history'</span>)
<span class="hljs-keyword">print</span> (x_train_uni[<span class="hljs-number">0</span>])
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict'</span>)
<span class="hljs-keyword">print</span> (y_train_uni[<span class="hljs-number">0</span>])
</code></pre><br>
<code>Single window of past history<br>
[[-1.99766294]<br>
 [-2.04281897]<br>
 [-2.05439744]<br>
 [-2.0312405 ]<br>
 [-2.02660912]<br>
 [-2.00113649]<br>
 [-1.95134907]<br>
 [-1.95134907]<br>
 [-1.98492663]<br>
 [-2.04513467]<br>
 [-2.08334362]<br>
 [-2.09723778]<br>
 [-2.09376424]<br>
 [-2.09144854]<br>
 [-2.07176515]<br>
 [-2.07176515]<br>
 [-2.07639653]<br>
 [-2.08913285]<br>
 [-2.09260639]<br>
 [-2.10418486]]<br>
<br>
Target temperature to predict<br>
-2.1041848598100876<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู: ูุชู ุนุฑุถ ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ููููุฐุฌ ูุน ุฅุฏุฎุงู ุฃุญุงุฏู ุงูุจุนุฏ ุจุดูู ุชุฎุทูุทู ูู ุงูุดูู ุงูุชุงูู (ููุฑุงุญุฉ ุ ูู ูุฐุง ุงูุดูู ูุงูุฃุดูุงู ุงููุงุญูุฉ ุ ูุชู ุชูุฏูู ุงูุจูุงูุงุช ูู ุดูู "ุฎุงู" ุ ูุจู ุงูุชูุญูุฏ ุงูููุงุณู ุ ูุฃูุถูุง ุจุฏูู ุงูุณูุฉ "ููุช ุงูุชุงุฑูุฎ" ููุคุดุฑ):</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fa0/d0f/530/fa0d0f530b3496324425eeb5e52baff7.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุงูุขู ุจุนุฏ ุฃู ุงูุจูุงูุงุช ุฃุนุฏ ุนูู ุงููุญู ุงูููุงุณุจ ุ ูุงููุธุฑ ูู ูุซุงู ููููุณ. </font><font style="vertical-align: inherit;">ูุชู ุชูููุฒ ุงููุนูููุงุช ุงููุฑุณูุฉ ุฅูู ANN ุจุงูููู ุงูุฃุฒุฑู ุ ููุดูุฑ ุงูุตููุจ ุงูุฃุญูุฑ ุฅูู ุงููููุฉ ุงููุณุชูุจููุฉ ุงูุชู ูุฌุจ ุฃู ุชุชููุนูุง ANN.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_time_steps</span>(<span class="hljs-params">length</span>):</span>
  <span class="hljs-keyword">return</span> list(range(-length, <span class="hljs-number">0</span>))
</code></pre><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_plot</span>(<span class="hljs-params">plot_data, delta, title</span>):</span>
  labels = [<span class="hljs-string">'History'</span>, <span class="hljs-string">'True Future'</span>, <span class="hljs-string">'Model Prediction'</span>]<font></font>
  marker = [<span class="hljs-string">'.-'</span>, <span class="hljs-string">'rx'</span>, <span class="hljs-string">'go'</span>]<font></font>
  time_steps = create_time_steps(plot_data[<span class="hljs-number">0</span>].shape[<span class="hljs-number">0</span>])
  <span class="hljs-keyword">if</span> delta:<font></font>
    future = delta<font></font>
  <span class="hljs-keyword">else</span>:<font></font>
    future = <span class="hljs-number">0</span><font></font>
<font></font>
  plt.title(title)<font></font>
  <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> enumerate(plot_data):
    <span class="hljs-keyword">if</span> i:<font></font>
      plt.plot(future, plot_data[i], marker[i], markersize=<span class="hljs-number">10</span>,<font></font>
               label=labels[i])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      plt.plot(time_steps, plot_data[i].flatten(), marker[i], label=labels[i])<font></font>
  plt.legend()<font></font>
  plt.xlim([time_steps[<span class="hljs-number">0</span>], (future+<span class="hljs-number">5</span>)*<span class="hljs-number">2</span>])<font></font>
  plt.xlabel(<span class="hljs-string">'Time-Step'</span>)
  <span class="hljs-keyword">return</span> plt
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Sample Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/589/38c/574/58938c5740abfb08ed0074a1233f512f.jpg" alt="ุตูุฑุฉ"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญู ุงูุฃุณุงุณู (ุจุฏูู ุฅุดุฑุงู ุงูุชุนูู ุงูุขูู)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูุจู ุจุฏุก ุชุฏุฑูุจ ุงููููุฐุฌ ุ ุณูููู ุจุชุซุจูุช ุญู ุฃุณุงุณู ุจุณูุท ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุท ุงูุฃุณุงุณ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). ูุชุชููู ูู ุงูุชุงูู: ุจุงููุณุจุฉ ููุชุฌู ุฅุฏุฎุงู ูุนูู ุ ูุฅู ุทุฑููุฉ ุงูุญู ุงูุฃุณุงุณูุฉ "ุชูุญุต" ุงูุชุงุฑูุฎ ุจุฃูููู ูุชุชูุจุฃ ุจุงููููุฉ ุงูุชุงููุฉ ููุชูุณุท โโูุขุฎุฑ 20 ููุงุญุธุฉ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baseline</span>(<span class="hljs-params">history</span>):</span>
  <span class="hljs-keyword">return</span> np.mean(history)
</code></pre><br>
<pre><code class="python hljs">show_plot([x_train_uni[<span class="hljs-number">0</span>], y_train_uni[<span class="hljs-number">0</span>], baseline(x_train_uni[<span class="hljs-number">0</span>])], <span class="hljs-number">0</span>,
           <span class="hljs-string">'Baseline Prediction Example'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/bed/941/0ef/bed9410ef6b96ad25ab68a0a3ebac05a.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ูุง ุฅุฐุง ูุงู ุจุฅููุงููุง ุชุฌุงูุฒ ูุชูุฌุฉ "ุงููุชูุณุท" ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุนุตุจูุฉ ูุชูุฑุฑุฉ. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ ุชุนุชุจุฑ ุงูุดุจูุฉ ุงูุนุตุจูุฉ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุงููุชูุฑุฑุฉ (RNS) ููุนูุง ูู ANN ููุงุณุจ ุชูุงููุง ูุญู ูุดููุงุช ุงูุณูุงุณู ุงูุฒูููุฉ. ุชููู RNS ุฎุทูุฉ ุจุฎุทูุฉ ุจูุนุงูุฌุฉ ุงูุชุณูุณู ุงูุฒููู ููุจูุงูุงุช ุ ููุฑุฒ ุนูุงุตุฑูุง ูุงูุญูุงุธ ุนูู ุงูุญุงูุฉ ุงูุฏุงุฎููุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุนู ุทุฑูู ูุนุงูุฌุฉ ุงูุนูุงุตุฑ ุงูุณุงุจูุฉ. ููููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู RNS ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฏููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชุงูู </font><font style="vertical-align: inherit;">. ุณูุณุชุฎุฏู ูุฐุง ุงูุฏููู ุทุจูุฉ ูุชุฎุตุตุฉ ูู RNC ุชุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LSTM</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฒูุฏ ูู ุงุณุชุฎุฏุงู</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">tf.data</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุท ูุฌููุนุฉ ุงูุจูุงูุงุช ูุชุฌููุนูุง ูุชุฎุฒูููุง ูุคูุชูุง. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุทุฑู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎูุท</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงูุฏููุนุฉ ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ุตูุญุฉ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">tensorflow</font></a><font style="vertical-align: inherit;"> :</font></font></i><br>
<br>
<pre><code class="python hljs">BATCH_SIZE = <span class="hljs-number">256</span>
BUFFER_SIZE = <span class="hljs-number">10000</span><font></font>
<font></font>
train_univariate = tf.data.Dataset.from_tensor_slices((x_train_uni, y_train_uni))<font></font>
train_univariate = train_univariate.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_univariate = tf.data.Dataset.from_tensor_slices((x_val_uni, y_val_uni))<font></font>
val_univariate = val_univariate.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูููุชุฑุถ ุฃู ูุณุงุนุฏู ุงูุชูุซูู ุงูุจุตุฑู ุงูุชุงูู ูู ููู ุดูู ุงูุจูุงูุงุช ุจุนุฏ ุงููุนุงูุฌุฉ ุงููุฌูุนุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/002/e4b/3ed/002e4b3ed48fa5d17f34ccee2cbfc40d.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุงุญุธุฉ ุฃู LSTM ูุชุทูุจ ููุนูุง ูุนูููุง ูู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุ ูุงูุฐู ูุชู ุชูููุฑู ูู.</font></font><br>
<br>
<pre><code class="python hljs">simple_lstm_model = tf.keras.models.Sequential([<font></font>
    tf.keras.layers.LSTM(<span class="hljs-number">8</span>, input_shape=x_train_uni.shape[<span class="hljs-number">-2</span>:]),<font></font>
    tf.keras.layers.Dense(<span class="hljs-number">1</span>)<font></font>
])<font></font>
<font></font>
simple_lstm_model.compile(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ุฅุฎุฑุงุฌ ุงููููุฐุฌ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">1</span>):<font></font>
    print(simple_lstm_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุดูู ุนุงู ุ ุชุนูู RNS ูุน ุงูุชุณูุณู. </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃู ุงูุจูุงูุงุช ุงูููุฏูุฉ ููุฏุฎูุงุช ุงููููุฐุฌ ูุฌุจ ุฃู ูููู ููุง ุงูุดูู ุงูุชุงูู: </font></font><br>
<br>
<code>[,  , - ]</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐุฌ ุจูุงูุงุช ุงูุชุฏุฑูุจ ูููููุฐุฌ ูุน ุฅุฏุฎุงู ุฃุญุงุฏู ุงูุจุนุฏ ูุฏูู ุงูุดูู ุงูุชุงูู:</font></font></i><br>
<br>
<code>print(x_train_uni.shape)<br>
(299980, 20, 1)</code><br>
<cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุณูู ูุฏุฑุณ ุงููููุฐุฌ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ููุญุฌู ุงููุจูุฑ ููุฌููุนุฉ ุงูุจูุงูุงุช ููู ุฃุฌู ุชูููุฑ ุงูููุช ุ ุณุชูุฑ ูู ุญูุจุฉ ุจู 200 ุฎุทูุฉ ููุท ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">steps_per_epoch = 200</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ุจุฏูุงู ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ุงููุงููุฉ ุ ููุง ูุญุฏุซ ุนุงุฏุฉู.</font></font><br>
<br>
<pre><code class="python hljs">EVALUATION_INTERVAL = <span class="hljs-number">200</span>
EPOCHS = <span class="hljs-number">10</span><font></font>
<font></font>
simple_lstm_model.fit(train_univariate, epochs=EPOCHS,<font></font>
                      steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                      validation_data=val_univariate, validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 2s 11ms/step - loss: 0.4075 - val_loss: 0.1351<br>
Epoch 2/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.1118 - val_loss: 0.0360<br>
Epoch 3/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0490 - val_loss: 0.0289<br>
Epoch 4/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0444 - val_loss: 0.0257<br>
Epoch 5/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0299 - val_loss: 0.0235<br>
Epoch 6/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0317 - val_loss: 0.0224<br>
Epoch 7/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0287 - val_loss: 0.0206<br>
Epoch 8/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0263 - val_loss: 0.0200<br>
Epoch 9/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0254 - val_loss: 0.0182<br>
Epoch 10/10<br>
200/200 [==============================] - 1s 4ms/step - loss: 0.0228 - val_loss: 0.0174<br>
</code><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุจุค ุจุงุณุชุฎุฏุงู ูููุฐุฌ LSTM ุจุณูุท</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุจุนุฏ ุงูุงูุชูุงุก ูู ุฅุนุฏุงุฏ ูููุฐุฌ LSTM ุจุณูุท ุ ุณูููู ุจุนูู ุงูุนุฏูุฏ ูู ุงูุชูุจุคุงุช.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_univariate.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    simple_lstm_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">0</span>, <span class="hljs-string">'Simple LSTM model'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf8/0f6/810/cf80f681038da62889884ae5de86722d.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃูุถู ูู ุงููุณุชูู ุงูุฃุณุงุณู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญุช ุนูู ุฏุฑุงูุฉ ุจุงูุฃุณุงุณูุงุช ุ ุฏุนูุง ููุชูู ุฅูู ุงูุฌุฒุก ุงูุซุงูู ุ ุงูุฐู ูุตู ุงูุนูู ูุน ุณูุณูุฉ ุฒูููุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฌุฒุก 2: ุงูุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุฐูุฑ ุ ุชุญุชูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ุนูู 14 ูุคุดุฑูุง ูุฎุชูููุง ููุฃุฑุตุงุฏ ุงูุฌููุฉ. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ุงูุจุณุงุทุฉ ูุงูุฑุงุญุฉ ุ ูู ุงูุฌุฒุก ุงูุซุงูู ููุท ุซูุงุซุฉ ูููุง - ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูููุงุก ูุงูุถุบุท ุงูุฌูู ููุซุงูุฉ ุงูููุงุก. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุณุชุฎุฏุงู ุงููุฒูุฏ ูู ุงูููุฒุงุช ุ ูุฌุจ ุฅุถุงูุฉ ุฃุณูุงุฆูู ุฅูู ูุงุฆูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feature_consosed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="python hljs">features_considered = [<span class="hljs-string">'p (mbar)'</span>, <span class="hljs-string">'T (degC)'</span>, <span class="hljs-string">'rho (g/m**3)'</span>]
</code></pre><br>
<pre><code class="python hljs">features = df[features_considered]<font></font>
features.index = df[<span class="hljs-string">'Date Time'</span>]<font></font>
features.head()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/1f8/589/b51/1f8589b51d64dcd9ba10e5f072df503e.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฑู ููู ุชุชุบูุฑ ูุฐู ุงููุคุดุฑุงุช ุจูุฑูุฑ ุงูููุช.</font></font><br>
<br>
<pre><code class="python hljs">features.plot(subplots=<span class="hljs-literal">True</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/7be/266/b59/7be266b59f38be1e4c365ee8562dffcd.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ูุงู ูู ูุจู ุ ูุฅู ุงูุฎุทูุฉ ุงูุฃููู ูู ุชูุญูุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุน ุญุณุงุจ ูุชูุณุท โโุงููููุฉ ูุงูุงูุญุฑุงู ุงููุนูุงุฑู ูุจูุงูุงุช ุงูุชุฏุฑูุจ.</font></font><br>
<br>
<pre><code class="python hljs">dataset = features.values<font></font>
data_mean = dataset[:TRAIN_SPLIT].mean(axis=<span class="hljs-number">0</span>)<font></font>
data_std = dataset[:TRAIN_SPLIT].std(axis=<span class="hljs-number">0</span>)
</code></pre><br>
<pre><code class="python hljs">dataset = (dataset-data_mean)/data_std
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชุญุฏุซ ุฃูุซุฑ ูู ุงูุฏููู ุนู ุงูุชูุจุค ุจุงูููุงุท ูุงูููุงุตู ุงูุฒูููุฉ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎูุงุตุฉ ุงูููู ูู ุนูู ุงููุญู ุงูุชุงูู. ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุงููููุฐุฌ ููุชูุจุค ุจูููุฉ ูุงุญุฏุฉ ูู ุงููุณุชูุจู (ุนูู ุณุจูู ุงููุซุงู ุ ูููุฉ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุจุนุฏ 12 ุณุงุนุฉ) (ูููุฐุฌ ูู ุฎุทูุฉ ูุงุญุฏุฉ / ุฎุทูุฉ ูุงุญุฏุฉ) ุ ููุฌุจ ุนููู ุชุฏุฑูุจ ุงููููุฐุฌ ุจุญูุซ ูุชูุจุฃ ุจูููุฉ ูุงุญุฏุฉ ููุท ูู ุงููุณุชูุจู. ุฅุฐุง ูุงูุช ุงููููุฉ ูู ุงูุชูุจุค ุจูุทุงู ุงูููู ูู ุงููุณุชูุจู (ุนูู ุณุจูู ุงููุซุงู ุ ุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ ููู ุณุงุนุฉ ุฎูุงู ุงูู 12 ุณุงุนุฉ ุงููุงุฏูุฉ) (ูููุฐุฌ ูุชุนุฏุฏ ุงูุฎุทูุงุช) ุ ููุฌุจ ุชุฏุฑูุจ ุงููููุฐุฌ ุฃูุถูุง ุนูู ุงูุชูุจุค ุจูุทุงู ุงูููู ูู ุงููุณุชูุจู. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/906/953/08e/90695308e69c21c37e772d98553209a4.png" alt="ุตูุฑุฉ"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุจุค ุจุงูููุงุท</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ุชููุน ูููุฉ ูุงุญุฏุฉ ูู ุงููุณุชูุจู ุจูุงุกู ุนูู ุจุนุถ ุงูุชุงุฑูุฎ ุงููุชุงุญ.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ุงููุธููุฉ ุฃุฏูุงู ุจุชูููุฐ ููุณ ุงููููุฉ ุงููุชูุซูุฉ ูู ุชูุธูู ุงููุชุฑุงุช ุงูุฒูููุฉ ููุท ูุน ุงูุงุฎุชูุงู ุงูุฐู ุชุญุฏุฏู ููุง ุฃุญุฏุซ ุงูููุงุญุธุงุช ุจูุงุกู ุนูู ุญุฌู ุฎุทูุฉ ูุนูู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multivariate_data</span>(<span class="hljs-params">dataset, target, start_index, end_index, history_size,
                      target_size, step, single_step=False</span>):</span><font></font>
  data = []<font></font>
  labels = []<font></font>
<font></font>
  start_index = start_index + history_size<font></font>
  <span class="hljs-keyword">if</span> end_index <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
    end_index = len(dataset) - target_size<font></font>
<font></font>
  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(start_index, end_index):<font></font>
    indices = range(i-history_size, i, step)<font></font>
    data.append(dataset[indices])<font></font>
<font></font>
    <span class="hljs-keyword">if</span> single_step:<font></font>
      labels.append(target[i+target_size])<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
      labels.append(target[i:i+target_size])<font></font>
<font></font>
  <span class="hljs-keyword">return</span> np.array(data), np.array(labels)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ุงูุฏููู ุ ูุนูู ANN ุนูู ุจูุงูุงุช ูุขุฎุฑ ุฎูุณุฉ (5) ุฃูุงู ุ ุฃู 720 ููุงุญุธุฉ (6 ร 24 ร 5). </font><font style="vertical-align: inherit;">ุงูุชุฑุถ ุฃู ุงุฎุชูุงุฑ ุงูุจูุงูุงุช ูุง ูุชู ูู 10 ุฏูุงุฆู ุ ูููู ูู ุณุงุนุฉ: ูู ุบุถูู 60 ุฏูููุฉ ุ ูุง ูุชููุน ุญุฏูุซ ุชุบููุฑุงุช ุญุงุฏุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฅู ุชุงุฑูุฎ ุงูุฃูุงู ุงูุฎูุณุฉ ุงูุฃุฎูุฑุฉ ูุชููู ูู 120 ููุงุญุธุฉ (720/6). </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ูููููุฐุฌ ุงูุฐู ูููู ุจุงูุชูุจุค ุงูููุถุนู ุ ูุฅู ุงููุฏู ูู ูุฑุงุกุฉ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุจุนุฏ 12 ุณุงุนุฉ ูู ุงููุณุชูุจู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ุงููุชุฌู ุงููุณุชูุฏู ูู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุจุนุฏ 72 ููุงุญุธุฉ (12 ร 6) ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุธุฑ ุงูุฅุถุงูุฉ ุงูุชุงููุฉ - ุงููุชุฑุฌู ุงูุชูุฑูุจู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="python hljs">past_history = <span class="hljs-number">720</span>
future_target = <span class="hljs-number">72</span>
STEP = <span class="hljs-number">6</span><font></font>
<font></font>
x_train_single, y_train_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                   TRAIN_SPLIT, past_history,<font></font>
                                                   future_target, STEP,<font></font>
                                                   single_step=<span class="hljs-literal">True</span>)<font></font>
x_val_single, y_val_single = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                               TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                               future_target, STEP,<font></font>
                                               single_step=<span class="hljs-literal">True</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ุงููุงุตู ุงูุฒููู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_single[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
</code><br>
<pre><code class="python hljs">train_data_single = tf.data.Dataset.from_tensor_slices((x_train_single, y_train_single))<font></font>
train_data_single = train_data_single.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_single = tf.data.Dataset.from_tensor_slices((x_val_single, y_val_single))<font></font>
val_data_single = val_data_single.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<pre><code class="python hljs">single_step_model = tf.keras.models.Sequential()<font></font>
single_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                           input_shape=x_train_single.shape[<span class="hljs-number">-2</span>:]))<font></font>
single_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">1</span>))<font></font>
<font></font>
single_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ูุชุญูู ูู ุงูุนููุฉ ููุดุชู ููุญููุงุช ุงูุฎุณุงุฑุฉ ูู ูุฑุงุญู ุงูุชุฏุฑูุจ ูุงูุชุญูู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">1</span>):<font></font>
  print(single_step_model.predict(x).shape)<font></font>
</code></pre><br>
<code>(256, 1)<br>
</code><br>
<pre><code class="python hljs">single_step_history = single_step_model.fit(train_data_single, epochs=EPOCHS,<font></font>
                                            steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                            validation_data=val_data_single,<font></font>
                                            validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 4s 18ms/step - loss: 0.3090 - val_loss: 0.2646<br>
Epoch 2/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2624 - val_loss: 0.2435<br>
Epoch 3/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2616 - val_loss: 0.2472<br>
Epoch 4/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2567 - val_loss: 0.2442<br>
Epoch 5/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2263 - val_loss: 0.2346<br>
Epoch 6/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2416 - val_loss: 0.2643<br>
Epoch 7/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2411 - val_loss: 0.2577<br>
Epoch 8/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2410 - val_loss: 0.2388<br>
Epoch 9/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2447 - val_loss: 0.2485<br>
Epoch 10/10<br>
200/200 [==============================] - 2s 9ms/step - loss: 0.2388 - val_loss: 0.2422<br>
</code><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_train_history</span>(<span class="hljs-params">history, title</span>):</span>
  loss = history.history[<span class="hljs-string">'loss'</span>]<font></font>
  val_loss = history.history[<span class="hljs-string">'val_loss'</span>]<font></font>
<font></font>
  epochs = range(len(loss))<font></font>
<font></font>
  plt.figure()<font></font>
<font></font>
  plt.plot(epochs, loss, <span class="hljs-string">'b'</span>, label=<span class="hljs-string">'Training loss'</span>)<font></font>
  plt.plot(epochs, val_loss, <span class="hljs-string">'r'</span>, label=<span class="hljs-string">'Validation loss'</span>)<font></font>
  plt.title(title)<font></font>
  plt.legend()<font></font>
<font></font>
  plt.show()<font></font>
</code></pre><br>
<pre><code class="python hljs">plot_train_history(single_step_history,
                   <span class="hljs-string">'Single Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/baa/481/4df/baa4814df5d278c7be5a4daf629ec8e0.jpg" alt="ุตูุฑุฉ"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ: ูุชู ุนุฑุถ </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ููููุฐุฌ ุฐู ุชูุจุค ููุทุฉ ุฅุฏุฎุงู ูุชุนุฏุฏ ุงูุฃุจุนุงุฏ ุจุดูู ุชุฎุทูุทู ูู ุงูุดูู ุงูุชุงูู. </font><font style="vertical-align: inherit;">ูู ุฃุฌู ุงูุฑุงุญุฉ ูุชูุซูู ุฃูุซุฑ ูุถูุญูุง ูุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุ ูุฅู ุงูุญุฌุฉ </font></font><code>STEP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู 1. ูุงุญุธ ุฃูู ูู ูุธุงุฆู ุงููููุฏ ุงููุญุฏุฏุฉ ุ ูุฅู </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุฌุฉ </font></font><code>STEP </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุตุตุฉ ููุท ูุชุดููู ุงูุชุงุฑูุฎ</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูููุณ ูููุชุฌู ุงููุณุชูุฏู. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bfd/c0b/ef1/bfdc0bef1203da6840adcb4311455645.png" alt="ุตูุฑุฉ"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ </font></font><code>x_train_single</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏููุง ุงูุดูู </font></font><code>(299280, 720, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู </font></font><code>STEP=6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุณูุฃุฎุฐ ุงููููุฐุฌ ุงูุดูู ุงูุชุงูู: </font></font><code>(299280, 120, 3)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชุฒุฏุงุฏ ุณุฑุนุฉ ุงููุธููุฉ ุจุดูู ููุญูุธ. </font><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ุชุญุชุงุฌ ุฅูู ููุญ ุงููุถู ูููุจุฑูุฌ: ุงููููุฏุงุช ุงูููุฏูุฉ ูู ุงูุฏููู ุดุฏูุฏุฉ ุงูุดููุฉ ูู ุญูุซ ุงุณุชููุงู ุงูุฐุงูุฑุฉ. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌุฑุงุก ุชูุจุค ุจุงูููุทุฉ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุจุนุฏ ุฃู ุชู ุชุฏุฑูุจ ุงููููุฐุฌ ุ ุณูุฌุฑู ุงูุนุฏูุฏ ูู ุชูุจุคุงุช ุงูุงุฎุชุจุงุฑ. ูุชู ุชุบุฐูุฉ ุณุฌู ููุงุญุธุงุช 3 ุฅุดุงุฑุงุช ููุฃูุงู ุงูุฎูุณุฉ ุงูุฃุฎูุฑุฉ ุ ุงูุชู ูุชู ุชุญุฏูุฏูุง ูู ุณุงุนุฉ (ุงููุงุตู ุงูุฒููู = 120) ุ ุจุฅุฏุฎุงู ุงููููุฐุฌ. ูุธุฑูุง ูุฃู ูุฏููุง ูู ุงูุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ููุท ุ </font><font style="vertical-align: inherit;">ูุชู </font><font style="vertical-align: inherit;">ุนุฑุถ ููู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุงูุณุงุจูุฉ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุงุฑูุฎ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">ุจุงูููู ุงูุฃุฒุฑู ุนูู ุงูุฑุณู ุงูุจูุงูู </font><font style="vertical-align: inherit;">. ุชู ุนูู ุงูุชููุนุงุช ููุฏุฉ ูุตู ููู ูู ุงููุณุชูุจู (ูุจุงูุชุงูู ุงููุฌูุฉ ุจูู ุงูุชุงุฑูุฎ ูุงููููุฉ ุงููุชููุนุฉ).</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_single.take(<span class="hljs-number">3</span>):<font></font>
  plot = show_plot([x[<span class="hljs-number">0</span>][:, <span class="hljs-number">1</span>].numpy(), y[<span class="hljs-number">0</span>].numpy(),<font></font>
                    single_step_model.predict(x)[<span class="hljs-number">0</span>]], <span class="hljs-number">12</span>,
                   <span class="hljs-string">'Single Step Prediction'</span>)<font></font>
  plot.show()<font></font>
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/6ac/a5b/ce3/6aca5bce3fef9de56f1fac299da5527c.jpg" alt="ุตูุฑุฉ"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชูุจุค ุจุงููุงุตู ุงูุฒููู</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ูู ูุฐู ุงูุญุงูุฉ ุ ุนูู ุฃุณุงุณ ุจุนุถ ุงูุชุงุฑูุฎ ุงููุชุงุญ ุ ูุชู ุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ุงูุชูุจุค ุจูุงุตู ุงูููู ุงููุณุชูุจููุฉ. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ุนูู ุนูุณ ุงููููุฐุฌ ุงูุฐู ูุชูุจุฃ ุจูููุฉ ูุงุญุฏุฉ ููุท ูู ุงููุณุชูุจู ุ ูุฅู ูุฐุง ุงููููุฐุฌ ูุชูุจุฃ ุจุณูุณูุฉ ูู ุงูููู ูู ุงููุณุชูุจู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชุฑุถ ุ ููุง ูู ุญุงูุฉ ุงูุชูุจุค ุจููุทุฉ ุฃุฏุงุก ุงููููุฐุฌ ุ ุจุงููุณุจุฉ ููุชูุจุค ุจุงููุงุตู ุงูุฒููู ูููููุฐุฌ ุ ุฃู ุจูุงูุงุช ุงูุชุฏุฑูุจ ูู ููุงุณุงุช ูู ุณุงุนุฉ ูุขุฎุฑ ุฎูุณุฉ ุฃูุงู (720/6). </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูุฌุจ ุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ุงูุชูุจุค ุจุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุฎูุงู ุงูู 12 ุณุงุนุฉ ุงููุงุฏูุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงูููุงุญุธุงุช ูุชู ุชุณุฌูููุง ูู 10 ุฏูุงุฆู ุ ูุฌุจ ุฃู ูุชููู ูุงุชุฌ ุงููููุฐุฌ ูู 72 ุชููุนูุง. </font><font style="vertical-align: inherit;">ูุฅููุงู ูุฐู ุงููููุฉ ุ ูู ุงูุถุฑูุฑู ุฅุนุฏุงุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฑุฉ ุฃุฎุฑู ุ ูููู ุจูุงุตู ุฒููู ูุฏู ูุฎุชูู.</font></font><br>
<br>
<pre><code class="python hljs">future_target = <span class="hljs-number">72</span>
x_train_multi, y_train_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>], <span class="hljs-number">0</span>,<font></font>
                                                 TRAIN_SPLIT, past_history,<font></font>
                                                 future_target, STEP)<font></font>
x_val_multi, y_val_multi = multivariate_data(dataset, dataset[:, <span class="hljs-number">1</span>],<font></font>
                                             TRAIN_SPLIT, <span class="hljs-literal">None</span>, past_history,<font></font>
                                             future_target, STEP)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ุงูุงุฎุชูุงุฑ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">print</span> (<span class="hljs-string">'Single window of past history : {}'</span>.format(x_train_multi[<span class="hljs-number">0</span>].shape))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'\n Target temperature to predict : {}'</span>.format(y_train_multi[<span class="hljs-number">0</span>].shape))
</code></pre><br>
<code>Single window of past history : (120, 3)<br>
<br>
Target temperature to predict : (72,)<br>
</code><br>
<pre><code class="python hljs">train_data_multi = tf.data.Dataset.from_tensor_slices((x_train_multi, y_train_multi))<font></font>
train_data_multi = train_data_multi.cache().shuffle(BUFFER_SIZE).batch(BATCH_SIZE).repeat()<font></font>
<font></font>
val_data_multi = tf.data.Dataset.from_tensor_slices((x_val_multi, y_val_multi))<font></font>
val_data_multi = val_data_multi.batch(BATCH_SIZE).repeat()<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุถุงูุฉ: ูุธูุฑ ุงููุฑู ูู ุชูููู ูุชุฌู ุงููุฏู ูู "ุงููููุฐุฌ ุงููุงุตู" ูู "ุงููููุฐุฌ ุงูููุทู" ูู ุงูุดูู ุงูุชุงูู. </font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/190/5c6/845/1905c6845d2746a1f0bc6ae88f913b99.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูููู ุจุฅุนุฏุงุฏ ุงูุชุตูุฑ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multi_step_plot</span>(<span class="hljs-params">history, true_future, prediction</span>):</span>
  plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))<font></font>
  num_in = create_time_steps(len(history))<font></font>
  num_out = len(true_future)<font></font>
<font></font>
  plt.plot(num_in, np.array(history[:, <span class="hljs-number">1</span>]), label=<span class="hljs-string">'History'</span>)<font></font>
  plt.plot(np.arange(num_out)/STEP, np.array(true_future), <span class="hljs-string">'bo'</span>,<font></font>
           label=<span class="hljs-string">'True Future'</span>)
  <span class="hljs-keyword">if</span> prediction.any():<font></font>
    plt.plot(np.arange(num_out)/STEP, np.array(prediction), <span class="hljs-string">'ro'</span>,<font></font>
             label=<span class="hljs-string">'Predicted Future'</span>)<font></font>
  plt.legend(loc=<span class="hljs-string">'upper left'</span>)<font></font>
  plt.show()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐุง ุงูุฑุณู ุงูุจูุงูู ูุงููุฎุทุทุงุช ุงููุงุญูุฉ ุงููุดุงุจูุฉ ุ ูููู ุงูุชุงุฑูุฎ ูุงูุจูุงูุงุช ุงููุณุชูุจููุฉ ูู ุณุงุนุฉ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> train_data_multi.take(<span class="hljs-number">1</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], np.array([<span class="hljs-number">0</span>]))
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/245/beb/236/245beb236bc1f87f2d611ce8d2c0bc81.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุฃู ูุฐู ุงููููุฉ ุฃูุซุฑ ุชุนููุฏูุง ููููุงู ูู ุงููููุฉ ุงูุณุงุจูุฉ ุ ูุฅู ุงููููุฐุฌ ุณูุชููู ูู ุทุจูุชูู LSTM. </font><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ููุฐ ุฅุฌุฑุงุก 72 ุงูุชูุจุคุงุช ุ ุชุญุชูู ุทุจูุฉ ุงูุฅุฎุฑุงุฌ ุนูู 72 ุฎููุฉ ุนุตุจูุฉ.</font></font><br>
<br>
<pre><code class="python hljs">multi_step_model = tf.keras.models.Sequential()<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">32</span>,<font></font>
                                          return_sequences=<span class="hljs-literal">True</span>,<font></font>
                                          input_shape=x_train_multi.shape[<span class="hljs-number">-2</span>:]))<font></font>
multi_step_model.add(tf.keras.layers.LSTM(<span class="hljs-number">16</span>, activation=<span class="hljs-string">'relu'</span>))<font></font>
multi_step_model.add(tf.keras.layers.Dense(<span class="hljs-number">72</span>))<font></font>
<font></font>
multi_step_model.compile(optimizer=tf.keras.optimizers.RMSprop(clipvalue=<span class="hljs-number">1.0</span>), loss=<span class="hljs-string">'mae'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูู ูุชุญูู ูู ุงูุนููุฉ ููุดุชู ููุญููุงุช ุงูุฎุณุงุฑุฉ ูู ูุฑุงุญู ุงูุชุฏุฑูุจ ูุงูุชุญูู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">1</span>):
  <span class="hljs-keyword">print</span> (multi_step_model.predict(x).shape)
</code></pre><br>
<code>(256, 72)<br>
</code><br>
<pre><code class="python hljs">multi_step_history = multi_step_model.fit(train_data_multi, epochs=EPOCHS,<font></font>
                                          steps_per_epoch=EVALUATION_INTERVAL,<font></font>
                                          validation_data=val_data_multi,<font></font>
                                          validation_steps=<span class="hljs-number">50</span>)
</code></pre><br>
<code>Train for 200 steps, validate for 50 steps<br>
Epoch 1/10<br>
200/200 [==============================] - 21s 103ms/step - loss: 0.4952 - val_loss: 0.3008<br>
Epoch 2/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3474 - val_loss: 0.2898<br>
Epoch 3/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.3325 - val_loss: 0.2541<br>
Epoch 4/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.2425 - val_loss: 0.2066<br>
Epoch 5/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1963 - val_loss: 0.1995<br>
Epoch 6/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.2056 - val_loss: 0.2119<br>
Epoch 7/10<br>
200/200 [==============================] - 18s 91ms/step - loss: 0.1978 - val_loss: 0.2079<br>
Epoch 8/10<br>
200/200 [==============================] - 18s 89ms/step - loss: 0.1957 - val_loss: 0.2033<br>
Epoch 9/10<br>
200/200 [==============================] - 18s 90ms/step - loss: 0.1977 - val_loss: 0.1860<br>
Epoch 10/10<br>
200/200 [==============================] - 18s 88ms/step - loss: 0.1904 - val_loss: 0.1863<br>
</code><br>
<pre><code class="python hljs">plot_train_history(multi_step_history, <span class="hljs-string">'Multi-Step Training and validation loss'</span>)
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/479/600/430/4796004305bd5b839ead7c35120ddc69.png" alt="ุตูุฑุฉ"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌุฑุงุก ุชูุจุค ุจุงููุงุตู ุงูุฒููู</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุ ููููุชุดู ูุฏู ูุฌุงุญ ุดุจูุฉ ANN ุงููุฏุฑุจุฉ ูู ุงูุชุนุงูู ูุน ุชููุนุงุช ููู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุงููุณุชูุจููุฉ.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> val_data_multi.take(<span class="hljs-number">3</span>):<font></font>
  multi_step_plot(x[<span class="hljs-number">0</span>], y[<span class="hljs-number">0</span>], multi_step_model.predict(x)[<span class="hljs-number">0</span>])
</code></pre><br>
<img src="https://habrastorage.org/getpro/habr/post_images/a3a/2fa/3cd/a3a2fa3cd17ec79c04d9ab44a3d3ad2c.jpg" alt="ุตูุฑุฉ"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุทูุงุช ุงูุชุงููุฉ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุงูุฏููู ูู ููุฏูุฉ ููุฌุฒุฉ ูุชูุจุค ุงูุณูุงุณู ุงูุฒูููุฉ ุจุงุณุชุฎุฏุงู RNS. ุงูุขู ููููู ูุญุงููุฉ ุงูุชูุจุค ุจุณูู ุงูุฃุณูู ูุชุตุจุญ ูููุงุฑุฏูุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ูู ุงูุฃุตู ุ ุชูุงููุง ูุซู ุฐูู :). - ููุญูุธุฉ ูุชุฑุฌู)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููููู ูุชุงุจุฉ ูููุฏู ุงูุฎุงุต ูุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุจุฏูุงู ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธููุฉ uni / multivariate_data</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุจุดูู ุฃูุซุฑ ููุงุกุฉ. ููููู ุฃูุถูุง ุงูุชุนุฑู ุนูู ุนูู "ุฅูุดุงุก </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุงุณู ุฒูููุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " ูุชูุฏูู ุฃููุงุฑูุง ุฅูู ูุฐุง ุงูุฏููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฒูุฏ ูู ุงูููู ุ ููุตู ุจูุฑุงุกุฉ ุงููุตู 15 ูู ูุชุงุจ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ุงูุชุนูู ุงูุขูู ุงูุชุทุจููู ุจุงุณุชุฎุฏุงู ุจุฑูุงูุฌ Scikit-Learn ู Keras ู TensorFlow"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Aurelien</font></a><font style="vertical-align: inherit;"> Geron ุ ุงูุฅุตุฏุงุฑ ุงูุซุงูู) ูุงููุตู 6 ูู ุงููุชุงุจ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ุงูุชุนูู ุงูุนููู ูู ุจุงูุซูู"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ูุฑุงูุณูุง ุดูู). </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุถุงูุฉ ุงูููุงุฆูุฉ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุซูุงุก ุงูุจูุงุก ูู ุงูููุฒู ุ ูุง ุชูุชู ููุท ุจุตุญุชู ุ ูููู ุฃูุถูุง ุงุดูู ุนูู ุงูููุจููุชุฑ ูู ุฎูุงู ุชูููุฐ ุฃูุซูุฉ ูู ุงูุฏููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ููุทูุนุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูุน ูุฑุงุนุงุฉ ูุณุจุฉ 70 ร 30 (ุชุฏุฑูุจ / ุงุฎุชุจุงุฑ) ุ ููููู ุชุญุฏูุฏูุง ุนูู ุงููุญู ุงูุชุงูู:</font></font></i><br>
<br>
<pre><code class="python hljs">dataset = features[<span class="hljs-number">300000</span>:].values<font></font>
TRAIN_SPLIT = <span class="hljs-number">85000</span></code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar495852/index.html">LDA ุนูู ููุงูุงุช LiveJournal + ุงูุชุตูุฑ</a></li>
<li><a href="../ar495854/index.html">ููููุฉ ุงููุฑูุจ ูู Covid ููู ุงููุฑุงูุจุฉุ</a></li>
<li><a href="../ar495856/index.html">Intel DevCloud ูู oneAPI - ุฎุฏูุฉ ุณุญุงุจูุฉ ูููุทูุฑูู ุงูุฐูู ูุฌูุณูู ูู ุงูููุฒู</a></li>
<li><a href="../ar495858/index.html">ุงูุจุนูุฏ ูุงูุนุฒูุฉ ุงูุฐุงุชูุฉ: ุชุฌุฑุจุฉ ุงููุถุงุก ููุณุงุนุฏุฉ ุฃุจูุงุก ุงูุฃุฑุถ</a></li>
<li><a href="../ar495870/index.html">ูุตุงุฆุญ ูุญูู ุงูุนูู ูุน Ceph ูู ุงููุดุงุฑูุน ุงููุฒุฏุญูุฉ</a></li>
<li><a href="../ar495888/index.html">ูุชุญุช PyCon Russia CFP ูููุชุญุฏุซูู ูู ุงููุณุชูุจู. ููุงุฐุฌ ุงููุดุงุฑูุฉ ูุงูููุงุถูุน ุงููุชููุนุฉ</a></li>
<li><a href="../ar495890/index.html">ุชูููู ุญุฒูุฉ Nginx / LetsEncrypt ูู Docker Swarm</a></li>
<li><a href="../ar495892/index.html">ูู ุชุนุฑู ุญูุง ูุง ูู ุงููุตูููุงุชุ</a></li>
<li><a href="../ar495894/index.html">ููุงุณ ุฃุฏุงุก ุฌุงูุง ุณูุฑูุจุช</a></li>
<li><a href="../ar495896/index.html">ุญุฒูุฉ ุงุณุชุฎุฏุงู ุงูุตูุช: ุงููุคุซุฑุงุช ุงูุตูุชูุฉ ูู ุชุทุจููุงุช ุงูุชูุงุนู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>