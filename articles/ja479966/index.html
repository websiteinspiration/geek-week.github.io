<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎀 ☣️ 📳 Playrix CI / CD：ゲームの構築方法とテスト方法 👨🏿‍🔬 👏🏿 🤛🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="チームは、CIが他にあるため、美しく成功したゲームの作成に集中する必要があります。
 
 CIはどこに適用しますか？どのようなアプローチと概念を使用していますか？ビルドをビルドしてテストする理由 CIの詳細と、CIがPlayrixでどのように構成されているかによって、講義のコースが決まります。カット...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Playrix CI / CD：ゲームの構築方法とテスト方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playrix/blog/479966/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チームは、CIが他にあるため、美しく成功したゲームの作成に集中する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CIはどこに適用しますか？</font><font style="vertical-align: inherit;">どのようなアプローチと概念を使用していますか？</font><font style="vertical-align: inherit;">ビルドをビルドしてテストする理由 </font><font style="vertical-align: inherit;">CIの詳細と、CIがPlayrixでどのように構成されているかによって、講義のコースが決まります。</font><font style="vertical-align: inherit;">カットの下-短いスクイーズといくつかのアクセント。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b4e/54d/ab2/b4e54dab26c1357b27e3e31b88c9378d.png"></div></a><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ねえ。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、少しウォームアップ：継続的インテグレーションとは何ですか？</font><font style="vertical-align: inherit;">チームがリポジトリを使用してナイトビルドを収集する場合-このCIはすでにですか？</font><font style="vertical-align: inherit;">継続的展開と配信の違いは何ですか？</font><font style="vertical-align: inherit;">それはほとんど重要ではありません。</font><font style="vertical-align: inherit;">詳細-専門家の狭いサークル向け。</font><font style="vertical-align: inherit;">会社全体を何らかのプロセスに関与させたい場合は、シンプルでわかりやすい名前を付けます。</font><font style="vertical-align: inherit;">Playrixでは、これらすべてのアプローチをCIと呼びます。</font><font style="vertical-align: inherit;">これはそのような地元のブランドとクールなロゴです：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ebe/d97/d8e/ebed97d8e7a2fff88508b8e73c6b0e97.png" width="500"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考え</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CIは目標ではなく、ツールです。継続的インテグレーションで達成したい目標、解決する必要のある問題がなければなりません。チームでの開発とリリースのプロセスは、「祈りと実稼働」の原則に基づいて構築されています。正当化されることもありますが、まれです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合の問題の可能性を最小限に抑え、見つかったエラーを修正するために必要なリソースを最小限に抑え、プロジェクト開発チームがCIプロセスをサポートする時間を短縮するために、目標を次のように策定しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CIは、ビルドプロセスの自動化、コードテストとそのさまざまな環境への配信、ルーチン開発プロセスの自動化、私たち全員が使用するサービスの相互統合です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイデアは、すべてを自動的に自動的に収集し、これを頻繁に実行し、ビルドをテストして配信し、何かがうまくいかなかった場合に便利なレポートを的確に報告するシステムにあります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CIはどこに適用しますか？</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンジンとユーティリティ、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのプラットフォーム向けのゲーム、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーコード</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析、マーケティングサービス、さまざまな自動化、CIサービス、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インフラ。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはどこでも、ほとんどどこでもです。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナーのアセンブルとテスト、テスト、ステージングと製品の自動デプロイメント、ローリングとカナリア更新-これはすべて私たちが持っているものであり、サービスとWebアプリケーションにより多く適用できます。</font><font style="vertical-align: inherit;">今日は、ゲームのCIに焦点を当てます。ビルドをビルドし、テストして、配信します。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e87/bab/b31/e87babb31e40c7d90e3994f45be77792.png" width="500"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラダイム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の目標を達成するには、いくつかの問題を解決する必要があります。</font><font style="vertical-align: inherit;">以下は、モバイルゲームクライアントの組み立てなど、開発のプロセスを自動化するときに従う計画です。</font><font style="vertical-align: inherit;">CIチームに分類される問題を解決できる質問のリストを用意しておくと非常に便利です。</font></font><br>
<br>
<ul>
<li><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメンテーション</font></font></h3></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドアセンブリの手順は、自動化されたプロセスの説明であるドキュメントです。</font><font style="vertical-align: inherit;">多くの場合、そのようなドキュメントはプログラマーの頭にあります。</font><font style="vertical-align: inherit;">チームがビルドの構築にスーパースペシャリストがいて、それがなければ、誰もすぐにエラーなしでビルドを構築することはできません。何かを変更するときが来たら、提出はありません。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、そのようなドキュメントがスクリプトの形式でフレーム化されている場合：準備された環境のマシンでコマンドラインと一連のパラメーターを入力しました-ビルドを取得しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最良のプロセスドキュメントは</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">猫の</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードです。</font><font style="vertical-align: inherit;">何らかの理由で手動で操作を繰り返す必要がある場合でも、いつでもそれを調べて行うことができます。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc1/b35/41c/bc1b3541c1eaf585466131dfc966a466.png" width="500"></div><ul>
<li><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロギング</font></font></h3></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドログを使用すると、いつ、誰から、いつ、どのコミットで、どのビルドでこのビルドまたはそのビルドが収集されたのかを常に確認できます。</font><font style="vertical-align: inherit;">昨日、ビルドはもうすぐでしたが、今日は違います。</font><font style="vertical-align: inherit;">ログを見て、最初のフロッピービルドを見つけ、そこに到達したコミットのリストを確認します-利益。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マガジンは、サーバーコードなどに関してはさらに便利です。</font><font style="vertical-align: inherit;">誰がいつ、いつprodを更新したかについての情報がない場合、一般的には、どのコードが現在そこで動作しているかはわかりません。</font><font style="vertical-align: inherit;">そして時にはそれは非常に重要です </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような仕訳帳は、台帳、できれば表またはwikiに保存できます。</font><font style="vertical-align: inherit;">CIシステムのビルドのリストは貴重です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4dc/a88/26c/4dca8826cad8ae341be5df436c3fcab4.png"></div><br>
<ul>
<li><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全性</font></font></h3></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドをビルドして環境にデプロイすることになると、ログイン/アクセスパスワードをどこに保存するかという疑問が常に生じます。通常は、ソースデータをダウンロードするためのリポジトリ、ゲームリソースを入力するためのファイルストレージ、文字を送信するためのHockeyApp、コードを更新するためのサーバーなどが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なアクセスがすべてリポジトリに保存されている場合があります。これはあまり良くないという仮説があります。ビルドの作成者が非表示の文字を入力するJenkinsなどの「パスワードの入力」フィールドがよく見られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのパスワードを暗記することは良いスキルです。 CIサーバー自体は、アセンブリに応じて必要なアクセスを受け取ります。通常、これらは有効期間が短いトークンであり、ビルドの開始時に生成され、何かをデプロイする場所や何かを読み取る場所に最小限の権限を与えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アセンブリと展開の集中管理により、インフラストラクチャへのアクセス権を区別する問題を解決できます。</font><font style="vertical-align: inherit;">このサーバーで必要な操作を行う対応するビルドのアセンブリへのアクセスのみを許可できるのに、誰かにサーバーへのアクセスを許可するのはなぜですか？</font><font style="vertical-align: inherit;">ビルドがあるので、ドキュメントとジャーナリングがあります。</font></font><br>
<br>
<ul>
<li><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーサビリティ</font></font></h3></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、ビルド時には多くのトレースが残っています。</font><font style="vertical-align: inherit;">いいえ、そうではありません。ビルドビルド中は、できるだけ多くのトレースを残す必要があります。</font><font style="vertical-align: inherit;">リポジトリ、タスクトラッカー、ビルド配布システム。</font><font style="vertical-align: inherit;">どこにいても、ビルドに遭遇したときはいつでも、ビルドに関する完全な情報につながるトレースがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの痕跡は一掃する必要はありません。逆に、注意深く残して慎重に保存する必要があります。</font><font style="vertical-align: inherit;">次に、これについて詳しく説明しますが、最初にビルドを収集する必要があります。</font><font style="vertical-align: inherit;">行け。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/75c/436/e91/75c436e91724a70d5442af7c6432516d.png" width="500"></div><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事前コミットフック</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しますが、アイデアはすべてを収集、テスト、報告するシステムです。</font><font style="vertical-align: inherit;">しかし、ビルドする必要がないのに、なぜビルドをビルドするのですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのゲームのすべての開発者には、事前コミットフックがインストールされています。</font><font style="vertical-align: inherit;">何かをコミットしようとするときに実行される一連のチェック。</font><font style="vertical-align: inherit;">チェックは変更されたファイルに対してのみ実行されますが、関連するすべてのコンテンツをチェックするために非常に巧妙な相互依存検索システムを実装しました。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">アーティストがテクスチャを追加した場合、フックは必要に応じて登録することを忘れていないこと、および封印していないことを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フックは小さなエラーのかなりの部分をキャッチしていることがわかりました。ビルドシステムのリソースを節約し、開発者が問題をすばやく修正できるようにします。問題の詳細を示すメッセージが表示されます。そして、彼はタスクを切り替える必要はありません。彼は文字通り変更を加えただけで、状況に応じています。エラー訂正時間は最小限です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とても気に入ったので、リポジトリに入ったコミットに対してフックが作成されたかどうかをチェックするシステムを作成しました。そうでない場合、そのようなコミットの作成者は、構成を依頼するタスクと、これを行う方法の詳細な指示を自動的に受け取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フックはすべてのプロジェクトで標準化されています。</font><font style="vertical-align: inherit;">カスタムテストの数は最小限です。</font><font style="vertical-align: inherit;">実行しているユーザーに依存するなど、便利なカスタマイズがあります。これはテストのテストに非常に便利です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルド</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドの問題をできるだけ早く確認するには、これらのビルドをできるだけ頻繁に収集してテストする必要があります。</font><font style="vertical-align: inherit;">私たちのゲームのクライアントは、すべてのプラットフォーム、すべてのコミット、すべてのプロジェクトに集まります。</font><font style="vertical-align: inherit;">おそらくいくつかの例外がありますが、多くはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、クライアント、特にモバイルのクライアントには、チートの有無にかかわらず、署名が異なるなど、いくつかの異なるバージョンがあります。</font><font style="vertical-align: inherit;">コミットごとに、開発者とテスターが常に使用する「通常の」ビルドを収集します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ごくまれに使用されるビルドがあります。たとえば、ストアiosビルド-送信で1回のみ、つまり </font><font style="vertical-align: inherit;">月1回程度。</font><font style="vertical-align: inherit;">ただし、すべてのビルドは定期的に収集する必要があると考えています。</font><font style="vertical-align: inherit;">このタイプのアセンブリで問題が発生した場合、開発側またはインフラストラクチャ側では、プロジェクトチームはビルドが配信された日ではなく、より早い段階でこれを認識し、事前に対応して問題を修正することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、単純なルールがあります。どのビルドも少なくとも1日に1回は起動されます。</font><font style="vertical-align: inherit;">プロジェクト開発チームは、この問題がリポジトリに現れた翌朝、最悪の場合、あらゆるプラットフォームでの問題の存在について調べます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような頻度のアセンブリとテストでは、実行時間を最適化するための特別なアプローチが必要です。&nbsp;</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常のクライアントビルドはすべて増分です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アトラスのパッケージングとリソースの準備も段階的です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アセンブリは細かく、一部のステップは個別のビルド構成にあります-これにより、それらを並行して実行したり、中間結果を再利用したりできます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、WildScapesのビルドとテストのチェーンのほぼ完全なスクリーンショットです。</font><font style="vertical-align: inherit;">完全に失敗しました：約2倍です。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/672/415/771/67241577111cb4d6b5d1df70a54337e5.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的テスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アセンブリの後、静的テストが実行されます。ビルドフォルダーを使用して、そこにあるすべてのコンテンツの一連のチェックを実行します。</font><font style="vertical-align: inherit;">コードもコンテンツなので、その静的分析（cppcheck + PVS-Studio）もここにあります。</font><font style="vertical-align: inherit;">私たちが静的テストをどのように実装したかについての</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">詳細な資料</font></a></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あった</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ので、私はそれをお勧めします。</font><font style="vertical-align: inherit;">ビルド後の静的テストとプリコミットフックの静的テストが同じコードで実行されることだけを強調します。</font><font style="vertical-align: inherit;">これにより、システムサポートが大幅に簡素化されます。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/69f/195/0dd/69f1950dd3434591d233507574609672.png" width="500"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランタイムテスト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静的テストのビルドが成功した場合は、先に進んで、アセンブルされたビルドを実行してみることができます。 UWPを除くすべてのプラットフォームでビルドをテストしています。 Windows、MacO、iOS、Android。 UWP-もそうですが、少し後で。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発でのみ必要と思われるデスクトップビルドをテストする理由質問への答えは、アーティストまたはレベルデザイナーが、とんでもない理由で起動時にクラッシュするビルドを受け取った場合、悪いことです。したがって、すべてのプラットフォームで、実行可能性と基本的なゲームプレイの最小セットのチェックであるSmoke-Testが実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドについて上記で説明したことはすべて、デバイスでのテストにも当てはまります-少なくとも1日に1回。いくつかの例外はありますが、1日で完了する時間のない非常に長いテストがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
煙のテストは、コミットごとに実行されます。</font><font style="vertical-align: inherit;">基本チェックが正常に完了することは、ビルドがディストリビューションシステムに入る前提条件です。</font><font style="vertical-align: inherit;">通常、明らかに機能しないビルドへのアクセスを誰かに与えることは意味がありません。</font><font style="vertical-align: inherit;">ここで、異議を唱え、例外を考え出すことができます。</font><font style="vertical-align: inherit;">プロジェクトには、機能していないビルドへのアクセスを許可する回避策がありますが、ほとんど使用しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他にどんなテストがあります：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベンチマーク：FPSとメモリのパフォーマンスをさまざまな状況で、すべてのデバイスで確認します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マッチ3ユニットテスト：各要素と各メカニズムは、個別に、および相互作用のすべての組み合わせでテストされます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲーム全体の最初から最後までの経過。</font></font></li>
<li>  , ,  ,     UI  ,       Fishdom   .</li>
<li>   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">AddressSanitizer’</a>.</li>
<li>   :       ,       ,   .</li>
<li>  ,     .</li>
</ul><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c7a/24e/992/c7a24e992e95338aa4e884f367168b9e.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストを実行するには、iOSおよびAndroidデバイスの独自のテストスタンドを使用します。</font><font style="vertical-align: inherit;">これにより、デバイスで必要なビルドを柔軟に起動し、コードからデバイスを操作できます。</font><font style="vertical-align: inherit;">私たちには完全なコントロールがあり、理解できるレベルの信頼性があり、私たちが直面する可能性のある問題とそれらを解決するのにかかる時間を知っています。</font><font style="vertical-align: inherit;">テストデバイスを提供するクラウドサービスは、そのような快適さを提供しません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">猫</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のテストは、プロジェクトコード内に実装されています。これにより、理論的にはあらゆる複雑さのテストを作成できますが、これらのテストを実装およびサポートするには、プロジェクトの開発からの労力とリソースが必要です。これらのリソースは利用できないことが多く、手動で多重回帰をテストすることは難しく、必要ありません。テスター自身にテストの自動化を本当にほしかった。そして、そのためのフレームワーク、つまりContinuous Automation Testing System（CATS）を考案しました。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f1/40d/aab/9f140daab4981b2700a9e40358ceb51e.png" width="500"></div>&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイデアとは：テストスクリプトの作成者がゲームアプリケーションとやり取りできるようにすることです。スクリプトはプリミティブpythonで記述し、一連の抽象化を通じてアプリケーションにアクセスします。例：「Homescapes、私にショッピングウィンドウを開いて、そのような製品を購入してください。」結果を確認してください、ビンゴ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトコマンドの実装全体は、一連の抽象化の背後に隠されています。アプリケーションとの対話を実装するAPIを使用すると、いくつかの方法で任意のアクションを実行できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何らかのコマンドを使用して、ゲームエンジンに組み込まれているサーバーにhttpリクエストを送信します。</font><font style="vertical-align: inherit;">このコマンドはゲームコードによって処理されます。</font><font style="vertical-align: inherit;">通常、これはある種のチートであり、任意に単純または複雑にすることができます。</font><font style="vertical-align: inherit;">たとえば、「指定された識別子を持つボタンの中心の座標を教えてください。」</font><font style="vertical-align: inherit;">または、「ここから指定された番号のレベルまでゲームを進めてください。」</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チートからウィンドウを開いたり、このウィンドウが開くボタンの座標を確認したり、このボタンのクリックをエミュレートしたり、仮想クリックを実行したりできます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に、指で画面上を操作したかのように、指定した座標で「実際の」クリックを実行できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後者の方法は、チートのない「戦闘」ビルドをテストすることが多いテスターの想像力のためのスペースを開きます。</font><font style="vertical-align: inherit;">そのようなシナリオを維持することはより困難ですが、「戦闘ビルド」は「戦闘」ビルドです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e25/0de/9ce/e250de9ce8a6e45d5ecfc8495eec7cb2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボタンの中心の座標を扱うのは非常に便利であることがわかりました。座標は時々変化しますが、ボタンの識別子はまれです。</font><font style="vertical-align: inherit;">これは、システムの別の重要な特性につながりました：すべてのプラットフォームとすべての画面解像度に対して1つのテストスクリプトを作成する機能。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配信、レポート、トレース</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配信により、すべてが非常にシンプルであることがわかりました。ビルドアーティファクトと配布システムのストレージには、単一の共有ストレージを使用します。</font><font style="vertical-align: inherit;">ビルドの「ロード」は、ビルドディストリビューションサービスのAPIへのリクエストのペアの呼び出しに要約され、基本的に登録されます。</font><font style="vertical-align: inherit;">このようにして、ビルドのポンピングとストレージの費用を節約しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドで見つかったエラーを修正するために必要なリソースを最小限に抑えることについて話しましたか？</font><font style="vertical-align: inherit;">レポートとトラック-これについて：</font></font><br>
<br>
<ul>
<li>    —    Asana.   ,    ,    CI,  -     .&nbsp;</li>
<li>     .     ,      .      :      ,           ,  ,  .</li>
<li>     , ,  ,    .    : «   »,              .</li>
<li>    Slack.  —  ,  «» ,     —       Playrix.   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレースは、ビルドとそれが収集された変更に関する完全な情報がどこにでもあるように必要です。</font><font style="vertical-align: inherit;">何も検索しないようにするため、すべてが手元にあり、問題を調査する際にしばしば必要となる詳細の検索に時間を費やす必要がありませんでした。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポートには、ビルドへのリンク、ビルドログ、見つかったコンパイルエラーのテキスト、フリップされたテストの名前が含まれます。</font><font style="vertical-align: inherit;">多くの場合、レポートタスクを受け取ったプログラマはエラーをすぐに修正できます。ファイル名、行、エラーテキストがレポートに含まれています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slackのメッセージには、すべて同じ+ Asanaのタスクへのリンクが含まれています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teamcityでは、タスクへのリンク。</font><font style="vertical-align: inherit;">ビルドエンジニアはすぐにタスクに入ることができ、ワンクリックで、何も探す必要がありません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github内-ビルドへのリンクがあるステータス、commitへのコメント内-このビルドが行われたタスクへのリンク。</font><font style="vertical-align: inherit;">タスク内-コミットへのリンクを含むコメント。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビルド配布サービス：ビルドへのリンク、コミットへのリンク。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
覚えておくべきことは何もありませんが、あなたはその考えを理解しました。</font><font style="vertical-align: inherit;">これにより、理解できない状況の調査が大幅にスピードアップします。&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94d/4dc/1a0/94d4dc1a015d9f068e9c5dce0461b17a.png"></div><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファーム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのプラットフォームのビルドを収集してテストします。</font><font style="vertical-align: inherit;">そのためには、さまざまなエージェントが必要です。</font><font style="vertical-align: inherit;">それらを手動で追跡および保守することは長く、困難です。</font><font style="vertical-align: inherit;">すべてのエージェントは自動的に準備されます。</font><font style="vertical-align: inherit;">パッカーとアンシブルを使用しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのエージェント、Teamcity、周りにあるすべてのサービスのすべてのログを保存します（この場合、ELKで）。</font><font style="vertical-align: inherit;">すべてのサービスは、ある種のビルドを処理し、このビルドの数をログの各行に追加します。</font><font style="vertical-align: inherit;">単一のリクエストで、キューに表示されてからすべてのレポートの送信が終了するまでのビルドのライフサイクル全体を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自のキュー最適化メカニズムを実装しました。</font><font style="vertical-align: inherit;">Teamcityにあるものは、私たちの数値ではあまりうまく機能しません。</font><font style="vertical-align: inherit;">数字と言えば：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは毎日約5,000のビルドを収集しています。</font><font style="vertical-align: inherit;">これは約500マシン時間の作業です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">300万番目のビルドは1か月前です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10か所に50以上のビルドサーバーがあります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストベンチ上の40以上のモバイルデバイス。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確に1つのTeamcityサーバー。</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e8/4eb/797/5e84eb79776709b09b73921f78cbb41a.png" width="500"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービスとしてのCI</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PlayrixのCIはサービスです。</font><font style="vertical-align: inherit;">多くのプロジェクト、多くのアイデアがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビルドがキューに入れられてから実行が終了するまでの時間を最適化します。これは、サービスのユーザーである開発者がまさに「ビルド時間」と見なすためです。</font><font style="vertical-align: inherit;">これにより、ビルド時間とキューで費やした時間のバランスを検索して見つけることができます。</font><font style="vertical-align: inherit;">会社の成長とプロジェクトの数に応じて、これらのプロジェクトを収集するビルドファームも成長するのは当然のようです。</font><font style="vertical-align: inherit;">しかし、最適化のおかげで、農場の成長率は会社の成長率をはるかに下回っています。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あらゆる最適化は、統計の系統的な収集による監視から始まります。私たちは多くの統計を収集し、ビルドに関するすべてを完全に知っています。しかし、ビルドファームのボリュームに加えて、CIシステムをサポートし、ビルドをどこから行うのかを誰も考える必要がないようにするチームもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このチームでのプロセスの最適化は、興味深い面白いプロセスでもあります。たとえば、ビルドの構成を設定するためのテストを作成します。これらの構成の多くがあるため、同様のテストがないと、編集する必要のあるすべての場所を見つけるのは簡単ではありません。ほとんどすべての変更について、最初にテストを作成し、次にそれを作成します。つまり、実際にはTDDがあります。任務、インシデント管理、着信タスクのフローのスケジュールに関連する多くのプロセスがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者は、ビルドの出所を気にすることなく、優れたゲームを作成することに集中する必要があります。</font><font style="vertical-align: inherit;">このため、PlayrixにはCIがあります。</font><font style="vertical-align: inherit;">継続的インテグレーションで達成したい目標、解決する必要のある問題がなければなりません。</font><font style="vertical-align: inherit;">問題を考え出さないこと、つまりそれを見つけることが重要です。</font><font style="vertical-align: inherit;">そして、あなたが彼女を見つけたら、私たちの経験を思い出し、もっと上手にしてください。</font><font style="vertical-align: inherit;">そして覚えておいてください：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CIは決して眠り</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ません。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/796/1f2/f01/7961f2f01ed13cee81c7ea0e604e7ace.png" width="500"></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479950/index.html">ビデオプロセッサの歴史、パート4：汎用GPUの登場</a></li>
<li><a href="../ja479952/index.html">shawarmaの中身：マイクロサービス、分散システム、Kafka。バックエンドユナイテッドの資料を共有する＃5</a></li>
<li><a href="../ja479954/index.html">Spring Boot Adminチュートリアル</a></li>
<li><a href="../ja479958/index.html">ファームウェアとプロセッサの脆弱性</a></li>
<li><a href="../ja479960/index.html">オンラインストアのメディア広告の効果のモデル</a></li>
<li><a href="../ja479970/index.html">千のUIバグ、または開発者がUIの一般的なエラーを回避する方法</a></li>
<li><a href="../ja479972/index.html">Appleパッチ履歴</a></li>
<li><a href="../ja479974/index.html">ゼロクリック攻撃：セキュリティがあなた次第ではない場合</a></li>
<li><a href="../ja479978/index.html">痛みなし、キャプチャなし、無料で、統一国家人権台帳の連邦州財産基金からの抜粋を人が読める形式（*）に</a></li>
<li><a href="../ja479982/index.html">ビドスと昆虫</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>