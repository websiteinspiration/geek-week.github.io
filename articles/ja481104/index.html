<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛓️ 🕑 🐬 OpenJDKとNodeJSのブレンド：言語間の相互作用と垂直アーキテクチャ 👨‍⚕️ 🤳🏼 👨🏾‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブル！
 
 長い間、私はあなたとGraalVMについて話し合う考えを持っていましたが、最終的に今日の記事が見つかるまで延期しました。その主題は、特定の仮想マシンの分析の範囲を真剣に超えています。著者のマイク・ハーンは、多言語相互作用と多言語プログラミング（多言語プログラミング）のパラ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenJDKとNodeJSのブレンド：言語間の相互作用と垂直アーキテクチャ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/481104/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、ハブル！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長い間、私はあなた</font><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraalVM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について話し合う考えを持っていましたが</font><font style="vertical-align: inherit;">、最終的に今日の記事が見つかるまで延期しました。その主題は、特定の仮想マシンの分析の範囲を真剣に超えています。著者のマイク・ハーンは、多言語相互作用と多言語プログラミング（多言語プログラミング）のパラダイム全体を概説しています。次は、垂直スケーリングの有名な例と、カットされた非常に長い記事です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w8/rn/pl/w8rnplm8qono1q-owxp4_dcmlxk.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は、将来的に普及するかもしれないが、おそらく今は普及しない可能性のあるソフトウェアを作成する革新的な方法についてです。記事には正直にコードがあります！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古代、つまり2015年に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlinが次のプログラミング言語になる理由</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を書き</font><font style="vertical-align: inherit;">、2016年に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraalとTruffle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について書きました</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。Ruby</font></a><font style="vertical-align: inherit;">などの言語の作業を大幅に加速するだけでなく、コンパイラに関連する2つの根本的な研究プロジェクトですだけでなく、実際にはシームレスな言語間相互作用も具現化します。これらのプロジェクトでは、動的（JIT）コンパイラーまたはOpenJDKが、注釈付きインタープリターを最新のJITコンパイラーに自動的に変換する機能を持つ新しいものに置き換えられます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年にこれらのトピックに戻って、3つのことを紹介します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaまたはKotlinで書かれたプログラムのコードからNPMモジュールをほぼシームレスに使用するために書いた小さなライブラリの使用方法。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魚油を数えずに、JavaScript / Javaが世界で最悪のものだと思っていても、それが必要になる可能性があるすべての理由を説明してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイクロサービス指向の設計と競合する垂直アーキテクチャーの概念を簡単に探索します。</font><font style="vertical-align: inherit;">GraalVMの最新バージョンとOpenJDKの共通部分にあり、最も高度なハードウェアが必要です。</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaおよびKotlinからのNPMの使用</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単な3つの手順を実行します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraalVMを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取り</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これはOpenJDKの上に構築された一連のパッチであり、ジャストインタイムで表示されます。これは、所有しているすべてのJVMバイトコードを実行できます。</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NodeJVMツールキットで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> githubを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">取得</font></a><font style="vertical-align: inherit;">し、パスに追加します。</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>java</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドラインでに</font><font style="vertical-align: inherit;">置き換え</font></font><code>nodejvm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">それで全部です！</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はいはい。</font><font style="vertical-align: inherit;">私は認めます、ここでは少し描いて誇張していますが、記事の最後までこのスタイルを許容する必要があります。</font><font style="vertical-align: inherit;">もちろん、すべてがそれほど単純ではありません。モジュールを取得して使用する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それがどのように見えるか</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f3/ov/xv/f3ovxvzch5mpwwmhy8w7tqyyiaw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
見</font><font style="vertical-align: inherit;">てみましょう：</font><font style="vertical-align: inherit;">NodeJVMを使用したサンプルコード</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この写真をよく見てください。はい、それはまさにそのようなものです。組み込みの複数行の文字列を持つKotlinでは、JavaScriptのオートコンプリートが発生し、その後静的なJavaScript分析が実行され、構文が正しく強調表示されます。 IntelliJが理解するJVMのJavaまたは他の言語から同じ操作が機能します。このような機会を得るには、IDE設定のスイッチをクリックする必要があります（これを行う方法については、NodeJVMのreadmeを参照してください）。ただし、後でこの機能は自動的に機能します。 IntelliJがデータストリームを分析することにより、最終的に文字列がメソッド</font></font><code>run</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><code>eval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">渡される必要があることを検出できた</font><font style="vertical-align: inherit;">場合</font><font style="vertical-align: inherit;">、それは埋め込みJSとして扱われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、KotlinのAPIについて説明します。これは、通常のJavaのAPIよりも少し洗練されており便利ですが、以下で説明するすべての操作はJavaから行うこともできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードでは、次のいくつかの機能に注意してください。</font></font><br>
<br>
<ul>
<li>   JavaScript    <code>nodejs {}</code>.   ,  JavaScript  , ,    NPM  “   Node”.  <code>nodejs {}</code>     ,   ,     . ,   :   - JS-  ,     .        ,         ,    .     JavaScript     Node, ,  ,         <code>nodejs</code>, ,        GUI,        .</li>
<li> <code>var x by bind(SomeObject())</code>     <code>nodejs</code>           JavaScript.   x  Kotlin     JS,  .      Java <code>File</code>   JS.</li>
<li> <code>eval</code>  … ,     , ,    .    ,     ,    ,  ,  eval    JavaScript       Java/Kotlin/Scala/.. ,      , <code>MemoryUsage</code> –   ,   ,      <code>rss()</code> <code>heapTotal()</code>.      JavaScript,    ,     API Node <code>process.memoryUsage()</code>.   JS      «»  Java;    ,   ,    GraalVM.      ,     , ,     <code>nodejs</code>.</li>
<li> JavaScript        ,       .   ,             ,      .   ,     .</li>
<li>  <code>require</code> –           <code>node_modules</code>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコードスニペットは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DAT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコルを使用しています</font><font style="vertical-align: inherit;">。これにより、BitTorrentに類似したピアツーピアネットワークにリモートで接続し、目的のファイルを持つピアを探すことができます。私は例としてDATを使用します。それは、（a）分散化されているために独自にシックであり、（b）良くも悪くも、そのリファレンス実装はJavaScriptで記述されているためです。これは、妥当な時間内にJSを使用せずに完全に記述できるプログラムではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはJavaからも実行できます。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> net.plan99.nodejs.NodeJS;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        <span class="hljs-keyword">int</span> result = NodeJS.runJS(() -&gt;<font></font>
            NodeJS.eval(<span class="hljs-string">"return 2 + 3 + 4"</span>).asInt()<font></font>
        );<font></font>
        System.out.println(result);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Java APIには、Kotlin APIのような快適な変数バインディングや自動キャスト機能はありませんが、使い方は非常に簡単です。</font><font style="vertical-align: inherit;">ここでは、結果をJava（</font></font><code>int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">整数型に変換し</font><font style="vertical-align: inherit;">、ノードストリームから「返す」</font><font style="vertical-align: inherit;">方法を示し</font><font style="vertical-align: inherit;">ます。この場合、メインのJavaストリームは</font><font style="vertical-align: inherit;">NodeJSストリーム</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はあり</font><b><font style="vertical-align: inherit;">ませんが、</font></b><font style="vertical-align: inherit;">これらのフローを完全にシームレスに切り替えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJVMはGraalVMの上にある非常に小さなラッパー</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それはわずかな量のコードを追加するので、サポートが終了したり消えたりすることを心配しないでください。この場合のすべての困難な作業の99.99％はGraalVMチームによって実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
改善を提案するためのいくつかの明白なアイデアを以下に示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSモジュールがMaven調整によりJavaモジュールをインポートできるようにします。</font></font></li>
<li> - « »    NPM. ,   JAR-   node_modules (: ,  NodeJS   -   /      , : ,    ).</li>
<li> : Python  Ruby     «»   ,    NodeJS,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">GraalVM Polyglot API</a>.   Kotlin ,   /  API          .</li>
<li> Windows.</li>
<li> Gradle,            </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツールとの統合、</font></font><code>native-image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いわゆる </font><font style="vertical-align: inherit;">SubstrateVM; </font><font style="vertical-align: inherit;">したがって、実行時にHotSpotの本格的なパフォーマンスが必要ない場合は、静的にリンクされた小さなバイナリをGolangスタイルで提供できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeScriptをJavaに変換するためのある種のコンバーターかもしれません。そうすれば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DefinitelyTyped</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して</font><font style="vertical-align: inherit;">、すぐに静的な世界に飛び込む</font><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パッチは大歓迎です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜこれが必要なのですか？</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらくあなたはすでに考えています：「わあ、私たちが開発したJavaScriptは今、相互に愛し合い、相互に尊重し、調和することができます！」</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pg/hg/_d/pghg_dqd6pgbortse6gaqdks-p8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理想化された熱狂的な反応</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この視点があなたに近づく可能性は非常に高く、</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/th/g6/j9thg6dscg5ce13x_vtpajwvjmm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScriptとJavaは単なる言語ではありません。これらは文化であり、CULTURAL WARSほど開発者にとって甘いものはありません！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、貴重なエコシステムへの$ OTHER_LANGの侵入を考えて銃を手に入れたい場合でも、少なくともこのページをブックマークして、後で参照できるようにする必要があります。</font></font><br>
<br>
<ul>
<li>    <b>Java</b>-,         JavaScript,        JVM (,  DAT).     ,    :    NPM-,       .    ,    -,       .          NodeJS,       Java,      .</li>
<li>    <b>JavaScript</b>-,          JVM,    JavaScript       (., <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Lucene</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Chronicle Map</a>)      ,     .          HTML,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">GUI-   </a>.      <b>  </b>, , Ruby  R.  JVM     NodeJS,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a>, ,    ,    .          Java,       NodeJS,      .</li>
<li>  <b>   </b>,     . - –  , ,        ,       .    ,   ,  …      .    Java, Kotlin, JavaScript, Scala, Python, Ruby, Lisp, R, Rust, Smalltalk, C/C++   FORTRAN,        GraalVM.</li>
<li>,     NodeJS,       , , ,       GraalVM.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJSはV8に基づいています。V8は、PCやスマートフォンで実行される短命のシングルスレッドスクリプトを使用するように設計されています。これはまさにGoogleのスポンサーですが、V8はサーバーでも使用されます。 OpenJDKは何十年にもわたってサーバーで最適化されてきました。最新バージョンには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZGC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shenandoah</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が含まれています。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">これは</font></a><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">レイテンシを最小限にできる2つのガベージコレクターで、テラバイトのメモリを消費できるツールで、数ミリ秒の一時停止でエスケープします。したがって、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">優れたGraalVMインフラストラクチャとツール</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する</font><font style="vertical-align: inherit;">ことで、単一言語をあきらめることなく</font><font style="vertical-align: inherit;">、コストを削減することさえできます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tn/4y/68/tn4y68r7cmq6z9tpheeuwafpncy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rubyオブジェクトを含むヒープを表示する</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/vc/jj/kovcjjmwvhnayjpfix25cs-rx48.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/fq/qy/sbfqqy9mzuppcp-vnro8tdscc_o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードがどのように最適化されたかを示す</font><font style="vertical-align: inherit;">
HTTP </font><font style="vertical-align: inherit;">超詳細エキスパート診断</font><font style="vertical-align: inherit;">を介して利用可能なCPUパフォーマンスの測定</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">垂直アーキテクチャ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事で説明したい最後のトピックに行きます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時々私は上記のすべてを誰かに話しますが、彼らは私に答えます：「</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは素晴らしいですが、これらのマイクロサービスは私たちにこれすべてを与えてくれませんか？何のために全体の大騒ぎは何ですか？</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ多言語プログラミングがそんなに好きなのか理解するのは難しいですが、マイクロサービスアーキテクチャは健全な競争を必要としているように見えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、はい、時々、相互作用する必要のある複数のサーバーで多くのサービスを実行する必要があります。私はGoogleに7年以上勤務し、ほぼ毎日、コンテナオーケストレーターのボーグとやり取りしました。 「マイクロサービス」とは呼んでいませんでしたが、消費しました。そうでなければ、私たちのワークロードは何千ものマシンの参加を必要としたので、対処する方法がありませんでした！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、このようなアーキテクチャーでは高額を支払う必要があります。</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリアル化</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">すぐに生産性が低下しますが、さらに重要なのは、少なくとも部分的に型付けおよび最適化されたデータ構造を常に調整し、それらを単純なツリーに変換することです。</font><font style="vertical-align: inherit;">JSONを使用すると、たとえば、いくつかの大きなオブジェクトを指す多くの小さなオブジェクトを持つなど、単純なことを実行できなくなります（繰り返しを避けるために、独自のインデックスを使用する必要があります）。</font></font></li>
<li><b></b>.  .       ,        ,    ,          ,    ,  ,     –    ,      ,     ?          ,      ?        ,   ,   .</li>
<li><b></b>.         .    ,         ,       ,  ,      .    ,          . : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  Google  </a>,       ,    ,      .</li>
<li><b> </b>.      ,      ,         ,     .  Google  -       ,      ;    ,        .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、代替案は何ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単に言えば、たくさんの鉄。この方法は不自然に古臭く見えるかもしれませんが、ハードウェアのコストは常に減少しており、多くのワークロードは「グローバルグローバル」とは呼ばれず、費やす価値についての直観が失敗する可能性があることに注意してください。</font><font style="vertical-align: inherit;">カナダのあるメーカーの</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
比較的最近の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価格</font></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/_2/ko/qq/_2koqq_9uanqjed7ebsfcwjzyqy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
リスト</font><font style="vertical-align: inherit;">は次のとおりです。</font><font style="vertical-align: inherit;">テラバイトのRAMとハードドライブのほぼ1テラバイトを備えた40核のマシンの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">価格</font></a><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">今日では約6,000ドルです。チームが分散システムの問題を解決するためにプロジェクト全体の存続期間にどれだけの時間がかかり、どれだけの費用がかかるかを想像してみてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、しかし今日のすべての会社がグローバルなウェブベースではありませんか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、いいえ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
世界には、次のことが当てはまる企業がたくさんあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らは安定した市場で動作します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らは物を売ることで稼ぐ。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その結果、その顧客ベースは数万人から数千万人ですが、数十億人ではありません。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らのデータセットは通常、自分の顧客と製品に関連付けられています。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような会社の良い例は銀行です。銀行は「超成長」を経験せず、「バイラル」にならない。彼らの成長モデルは中程度で予測可能ですが、それらが何らかの成長を遂げると想定されている場合（銀行は地域的であり、通常は飽和市場で運営されています）。米国最大の銀行の顧客ベースは約5,000万人のユーザーであり、もちろん6か月ごとに倍増することはありません。この場合、Instagramとまったく同じ状況ではありません。したがって、メインフレームが依然として典型的な銀行システムに基づいているのは不思議ではありませんか？もちろん、物流会社、製造会社なども同様です。これは私たちの経済のパンとバターです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなビジネスでは、それらに関連する特定の各アプリケーションのニーズが、1台の大型マシンのリソースで常に満たされる可能性があります。はい、あります。今日のいくつかのパブリックサイトでさえ、1台のマシンに適合します。 2015年、Maciej Tseglovskyは「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトの肥満による危機</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」について非常に興味深い講義を行い</font><font style="vertical-align: inherit;">、ブックマークサービスを備えた彼自身のサイトは利益を上げたが、競合他社は同じサイトをAWSに投稿しましたが、コストが異なるために失われました機器と複雑さに関するさまざまな仮定。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">垂直スケーリングと水平スケーリングを</font></a><font style="vertical-align: inherit;">比較する研究</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlentyOfFishは約1台のメガサーバーで実行されることがわかりました（記事は2009年からのものなので、そこにリストされている機器の価格は無視できます）。著者はいくつかの計算を行い、1台のサーバーが見かけほど馬鹿ではないことを示しています。最後に、Hadoopとビッグデータを検討している場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2013年のMicrosoftの調査記事を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読んでください。これ</font><font style="vertical-align: inherit;">は、Microsoft、Yahoo、FacebookのHadoopワークロードの多くが、クラスターではなく単一の大型マシンで実際より高速かつ効率的に実行されることを示しています。そして、それは6年前でした！おそらくそれ以来、垂直方向のスケーリングを支持する強調がさらに顕著になった。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、実際の節約は機器にはまったく関連していませんが、柔軟な需要管理で水平方向にスケーリングする必要がある小さなマイクロサービスの束を作成するために費やされる、エンジニアの非常に高価な作業時間の最適化に関連しています。このようなエンジニアリングへのアプローチは、たとえクラウドで入手可能な最新のおもちゃを使用していても、リスクと時間がかかります。 SQL、SOLIDトランザクション、統合プロファイリングを失う可能性があり、システム間スタックトレースなどの情報を確実に失うことになります。タイプセーフは、サーバーの境界を超えるたびに消えます。タイムアウトになる可能性のある関数呼び出し、動的コンパイルに関連する過剰なオーバーヘッド、予期しないバックプレッシャーエラー、奇妙な構成フォーマットを備えた複雑なオーケストレーションエンジン、そして...ああ、本当に、記憶が急増しました。独自のGoogleアーキテクチャと豊富なエンジニアリング予算を自由に使えるときにこれらすべてを処理することは興味深いことでしたが、今日は他に選択の余地がない場合にのみこれを繰り返すことにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
経験によると、ガベージコレクションで動作する非常に大規模なサーバーで作業することは不可能です。問題は、ガベージコレクション自体が十分に開発されていない技術であるため、このトピックは長い間純粋に学術的なものでした。いずれにしても、一度に複数のサーバーを駆動する必要がありました。ただし、ZGCとシェナンドアの登場により、1つのプロセスの一部として80ハイパー核で実行されるテラバイトヒープを使用することは完全に正常になり、顧客はハングに気付かないでしょう。大きなボックスをいくつか購入し、ビジネスロジックを1つで開始し、もう1つでデータベースサーバーをセットアップします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、本当にすべてのマイクロサービスが必要ですか？</font><font style="vertical-align: inherit;">または、ユーティリティとコストを徹底的に分析した方がいいですか？システムのどの要素を単純化できる可能性があるのか​​教えてくれますか？</font><font style="vertical-align: inherit;">垂直アーキテクチャは、古い学校の一種の復活です。最新のクロス言語コンパイルテクノロジーと最新の機器を組み合わせることで、コストを節約し、コードを再利用し、チームの作業をスピードアップします。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJVMは、GralVMの機能を評価できる控えめなデモです。 Java / KotlinコードからNPMモジュールを要求し、JSオブジェクトをインターフェイスにキャストし、ローカルKotlin変数をJavaScript変数にバインドし、コールバックを使用して、V8に匹敵する速度でJSを駆動できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
選択したモジュールを自由に組み合わせたり、JSコードベースをJavaに移植したり、JavaコードベースをJSに移植したり、同僚と言語のホリバーを開始したりできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
言語の相互運用性はマイクロサービスアーキテクチャでよく実現されますが、垂直スケーリングが多くの一般的なワークロードの優れた設計パターンとして機能することを認識すれば、ヒープのサイズに関係なく、わずか4ミリ秒の一時停止でガベージコレクションを実現できます。</font><font style="vertical-align: inherit;">ツールを使用することで得られるシンプルさとメリットは、非常に大きなものになります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja481092/index.html">PHP 8で最も興味深いこと</a></li>
<li><a href="../ja481094/index.html">ソーラーパワーを搭載したJBLワイヤレスヘッドフォンとその問題点</a></li>
<li><a href="../ja481096/index.html">トップベストジョーカートーク2019</a></li>
<li><a href="../ja481100/index.html">Angular 9の新機能</a></li>
<li><a href="../ja481102/index.html">クロスプラットフォームの.NET UIツールキットリリースAvaloniaUI 0.9</a></li>
<li><a href="../ja481106/index.html">LANITがオフィスでDIY-sitcomを撮影した方法</a></li>
<li><a href="../ja481110/index.html">Playme VEGAレビュー：タッチスクリーンとミラーマウントを備えたコンボレコーダー</a></li>
<li><a href="../ja481112/index.html">5700歳の「チューインガム」は、噛んだ人について何を伝えますか？</a></li>
<li><a href="../ja481114/index.html">KubernetesのSeccomp：最初から知っておくべき7つのこと</a></li>
<li><a href="../ja481116/index.html">コミュニティまたはVKページからDiscordに投稿を自動的に公開する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>