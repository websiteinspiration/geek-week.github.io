<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵 🔵 👴🏽 Menggunakan RabbitMQ dengan MonsterMQ Bagian 1 🎤 👼🏽 🙌🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini ditujukan bagi mereka yang belum terbiasa dengan antrian dan RabbitMQ. Mereka yang sudah tahu cara bekerja dengan RabbitMQ dan hanya ingin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Menggunakan RabbitMQ dengan MonsterMQ Bagian 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488850/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel ini ditujukan bagi mereka yang belum terbiasa dengan antrian dan RabbitMQ. </font><font style="vertical-align: inherit;">Mereka yang sudah tahu cara bekerja dengan RabbitMQ dan hanya ingin menjelajahi kemungkinan yang disediakan MonsterMQ, saya sarankan mengunjungi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman proyek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di github.com, di mana deskripsi menjelaskan secara rinci bagaimana Anda dapat menggunakan MonsterMQ tanpa menjelaskan dasar-dasar bekerja dengan RabbitMQ. </font><font style="vertical-align: inherit;">Sisa dari artikel ini akan membahas dasar-dasar bagaimana RabbitMQ bekerja dengan MonsterMQ.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RabbitMQ adalah broker pesan. Ia menerima, menyimpan, dan meneruskan pesan ke pelanggannya. Klien pengirim dan penerima pesan dapat melayani, misalnya, aplikasi yang ditulis dalam PHP. Komunikasi antara klien dan RabbitMQ terjadi sesuai dengan aturan tertentu yang disebut AMQP (Advanced Message Queuing Protocol). Misalnya, komunikasi antara browser Anda dan server web tempat artikel ini berada juga mengikuti aturan tertentu, mereka disebut HTTP (HyperText Transfer Protocol) - protokol transfer hypertext. HTTP dan AMQP adalah protokol client-server, yaitu, mereka menyiratkan keberadaan klien dan server. RabbitMQ adalah server AMQP, dan MonsterMQ adalah perpustakaan yang memungkinkan Anda untuk dengan cepat menulis klien AMQP dalam PHP, yang akan berkomunikasi dengan server AMQP.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMQP dan RabbitMQ menggunakan ketentuan berikut: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memproduksi - artinya mengirim pesan, Produser (pemasok) - orang yang mengirim pesan. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/093/98a/3af/09398a3afdf46d8e58c6c2f253037017.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengkonsumsi - berarti menerima pesan. </font><font style="vertical-align: inherit;">Konsumen - orang yang menerima pesan. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/918/3b0/d5e/9183b0d5e55eccdd919dee359a50d776.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antrian adalah antrian. </font><font style="vertical-align: inherit;">Sebelum mencapai konsumen dan setelah dikirim oleh pemasok, pesan disimpan dalam antrian di dalam RabbitMQ. </font><font style="vertical-align: inherit;">Antrian adalah buffer yang menyimpan pesan. </font><font style="vertical-align: inherit;">Banyak penyedia dapat mengirim pesan dalam satu antrian, dan banyak konsumen dapat membaca pesan dari satu antrian. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9d5/99c/8b9/9d599c8b96684a7a58e2aec05e6416b4.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa penyedia, konsumen dan broker tidak harus berada di host yang sama, sebaliknya mereka biasanya berada di tempat yang berbeda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo Dunia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian dalam artikel ini, kita akan menulis dua program dalam PHP menggunakan pustaka MonsterMQ, salah satunya akan mengirim pesan, dan yang lain akan menerima dan mengeluarkannya ke konsol. </font><font style="vertical-align: inherit;">Dalam gambar di bawah, "P" adalah penyedia, "C" adalah konsumen, kotak merah adalah antrian yang merupakan penyangga pesan (setiap kotak adalah pesan). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/2d8/ca1/fc0/2d8ca1fc0dce6c0c23e4524148027680.png" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Gambar diambil dari situs resmi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Untuk pekerjaan lebih lanjut, kita perlu menginstal MonsterMQ, untuk melakukan ini, masukkan perintah berikut di konsol:</font></font><br>
<br>
<pre><code class="bash hljs">composer require goootlib/monster-mq:dev-master</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Lebih lanjut tentang menginstal MonsterMQ dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halaman proyek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di github.com) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perintah ini akan menginstal MonsterMQ di folder saat ini.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keberangkatan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan memanggil pengirim kami </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan penerima </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accept.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pengirim akan bergabung dengan server dan mengirim pesan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk bergabung dengan server, tulis kode berikut di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :.</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kode ini, kami bergabung dengan RabbitMQ yang berjalan di server lokal pada port standar. </font><font style="vertical-align: inherit;">Tentukan alamat ip dan port lain jika RabbitMQ berjalan di alamat Anda yang lain. </font><font style="vertical-align: inherit;">Setelah koneksi, kami juga memanggil metode logIn (), yang memulai sesi dengan login dan kata sandi standar. </font><font style="vertical-align: inherit;">Jika Anda memiliki akun dengan nama pengguna dan kata sandi yang berbeda yang dikonfigurasi di RabbitMQ, tentukan di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengirim pesan, kita harus menyatakan antrian tempat pesan itu pertama kali ditempatkan. </font><font style="vertical-align: inherit;">Setelah antrian diumumkan, kami dapat mengirim pesan:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $producer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
   $producer-&gt;publish(<span class="hljs-string">'my-message'</span>, <span class="hljs-string">'test-queue'</span>);<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deklarasi antrian idempoten, yaitu tidak akan membuat dan tidak akan mengubah antrian, jika sudah ada. </font><font style="vertical-align: inherit;">Setelah kami menyelesaikan sesi dan bergabung.</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $producer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
   $producer-&gt;publish(<span class="hljs-string">'Test message'</span>, <span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $producer-&gt;disconnect();<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima pesan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berbeda dengan pengirim, penerima akan tetap berjalan untuk mendengarkan pesan yang masuk. </font><font style="vertical-align: inherit;">Dalam kode </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accept.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">pertama-tama </font><b><font style="vertical-align: inherit;">Anda</font></b><font style="vertical-align: inherit;"> harus melakukan hal yang sama seperti pada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accept.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami juga mendeklarasikan antrian kami, ini dimaksudkan agar penerima menyatakan antrian jika dimulai sebelum pengirim. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memberi tahu server bahwa kami ingin menerima pesan darinya, serta memulai siklus yang akan menunggu dan memproses pesan masuk, kami akan menulis kode berikut:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
<font></font>
   $consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $consumer-&gt;wait(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$message, $channelNumber</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$consumer</span>)</span>{
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"Message - {$message} received on channel {$channelNumber}"</span>;<font></font>
   });<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meluncurkan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat menjalankan kedua skrip sebagai penerima:</font></font><br>
<br>
<pre><code class="bash hljs">php receive.php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
jadi pengirim:</font></font><br>
<br>
<pre><code class="bash hljs">php send.php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penerima akan menampilkan pesan yang ia akan terima dari RabbitMQ ke konsol (yang pada gilirannya akan menerimanya dari send.php) dan nomor saluran yang digunakan. </font><font style="vertical-align: inherit;">Ini akan terus dieksekusi sampai Anda menutup terminal, atau sampai Anda berhenti menjalankannya dengan menekan Ctrl + C. </font><font style="vertical-align: inherit;">Dengan meluncurkan pengirim di terminal lain, Anda dapat mengamati bagaimana pesan dikirim ke penerima dan ditampilkan di konsol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda ingin melihat yang mana, saat ini, RabbitMQ berisi antrian dan berapa banyak pesan di dalamnya, Anda dapat melakukan ini sebagai pengguna istimewa menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rabbitmqctl</font></font></b><br>
<pre><code class="bash hljs">sudo rabbitmqctl list_queues</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di windows jangan gunakan sudo</font></font><br>
<pre><code class="bash hljs">rabbitmqctl.bat list_queues</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita siap untuk melanjutkan ke bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selanjutnya dari</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pelajaran kita.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id488836/index.html">Beberapa aspek bekerja dengan Kamus saat mengembangkan aplikasi yang dimuat</a></li>
<li><a href="../id488842/index.html">Tangkap satu elektron: amati proses yang membutuhkan seperempat miliar detik</a></li>
<li><a href="../id488844/index.html">Perbatasan untuk penjaga perbatasan: Pengadilan AS telah menetapkan aturan untuk memeriksa perangkat - membahas situasinya</a></li>
<li><a href="../id488846/index.html">Postgresso 19</a></li>
<li><a href="../id488848/index.html">CTO semua startup</a></li>
<li><a href="../id488852/index.html">Mengkonfigurasi fungsi kehilangan untuk jaringan saraf berdasarkan data seismik</a></li>
<li><a href="../id488854/index.html">10. Fortinet Memulai v6.0. Pengawal</a></li>
<li><a href="../id488856/index.html">Yah CRM dan CRM. Segalanya lebih mudah dari yang Anda pikirkan.</a></li>
<li><a href="../id488860/index.html">Substitusi dan pembuatan kapal impor</a></li>
<li><a href="../id488866/index.html">Memvalidasi Gambar dengan Gitlab CI / CD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>