<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏢 ♋️ 🔚 MongoDBサバイバルガイド 👨🏻‍🏭 👌🏽 👩‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="すべての優れた新興企業は、急速に死ぬか、規模が大きくなるかのいずれかです。このようなスタートアップをモデル化します。最初は機能について、次にパフォーマンスについてです。人気のあるNoSQLデータストレージソリューションであるMongoDBでパフォーマンスを向上させます。 MongoDBは簡単に始める...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MongoDBサバイバルガイド</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/454748/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての優れた新興企業は、急速に死ぬか、規模が大きくなるかのいずれかです。このようなスタートアップをモデル化します。最初は機能について、次にパフォーマンスについてです。人気のあるNoSQLデータストレージソリューションであるMongoDBでパフォーマンスを向上させます。 MongoDBは簡単に始めることができ、多くの問題にはすぐに解決策があります。ところが、負荷が増えると、いままで誰もあなたに警告しなかった熊手が…今日まで！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/rq/ua/ohrquayfyh04hfgs-gareddfzlk.gif" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルは、によって行われる</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セルゲイZagursky</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、特に一般的には、バックエンドのインフラを担当し、そしてMongoDBの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MMORPG Skyforgeの開発のサーバー側でも見られました。</font><font style="vertical-align: inherit;">セルゲイ自身が説明しているように、彼は「自分の額と熊手を備えたプロの旗手」です。</font><font style="vertical-align: inherit;">顕微鏡下で、技術的負債を管理するために累積戦略を使用するプロジェクト。</font><font style="vertical-align: inherit;">HighLoad ++ </font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポートの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このテキストバージョンで</font><font style="vertical-align: inherit;">は、問題の発生からMongoDBを使用した解決策へと時系列で移動します。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の困難</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはバンプを詰め込むスタートアップをモデル化しています。</font><font style="vertical-align: inherit;">人生の第一段階-私たちのスタートアップで機能がリリースされ、予想外にユーザーがやってくる。</font><font style="vertical-align: inherit;">私たちの小さな小さなMongoDBサーバーには、私たちが夢にも思わなかったほどの負荷があります。</font><font style="vertical-align: inherit;">しかし、私たちはクラウドにいます。私たちはスタートアップです！</font><font style="vertical-align: inherit;">私たちは可能な限り単純なことを行います。要求を確認します-ああ、ここで各ユーザーの修正全体が差し引かれています。ここでインデックスを作成し、そこにハードウェアを追加し、ここでキャッシュします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それだけです-私たちは生き続けます！</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このような簡単な方法で問題を解決できるのであれば、この方法で解決する必要があります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、成功するスタートアップの将来の道は、水平スケーリングの瞬間の遅くて痛みを伴う遅延です。</font><font style="vertical-align: inherit;">この期間を乗り切り、レーキを踏まないでスケーリングする方法をアドバイスしようと思います。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅い録音</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、遭遇する可能性のある課題の1つです。</font><font style="vertical-align: inherit;">あなたが彼女に会って、上記の方法が役に立たない場合はどうしますか？</font><font style="vertical-align: inherit;">回答：</font><strong><font style="vertical-align: inherit;">デフォルトでは、MongoDBの</font></strong><strong><font style="vertical-align: inherit;">耐久性</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保証モード</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">3つの言葉でこれは次のように機能します。</font></font><strong><font style="vertical-align: inherit;"></font></strong><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プライマリラインに来て、「書き込みます！」と言いました。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プライマリレプリカが記録されました。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その後、セカンダリレプリカが彼女から読み取られ、プライマリが「私たちは記録しました！」と言いました。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのセカンダリレプリカがこれを行った時点で、要求は完了したと見なされ、アプリケーションのドライバーに制御が戻ります。</font><font style="vertical-align: inherit;">このような保証により、アプリケーションに制御が戻ったときに、MongoDBが横になっていても、絶対にひどい災害を除いて、耐久性がどこにも及ばないことを確認できます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幸い、MongoDBは、個々のリクエストの耐久性の保証を減らすことができるデータベースです。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なリクエストについては、デフォルトで最大耐久性の保証を残すことができ、一部のリクエストについてはそれらを減らすことができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストクラス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
削除できる保証の最初の層は</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ほとんどのレプリカによるレコードの確認を待たないこと</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">これにより、レイテンシが節約されますが、帯域幅は追加されません。</font><font style="vertical-align: inherit;">ただし、特にクラスターの負荷が少し高く、セカンダリレプリカが思ったほど速く機能しない場合は、遅延が必要になることがあります。</font></font><br>
<br>
<pre><code class="javascript hljs">{<span class="hljs-attr">w</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">j</span>:<span class="hljs-literal">true</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような保証付きでレコードを書き込むと、アプリケーションで制御を取得した時点では、何らかの事故の後でレコードが生きているかどうかはわかりません。しかし、通常、彼女はまだ生きています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
帯域幅とレイテンシにも影響する次の保証は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログの確認を無効にすること</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。とにかく日記が書かれています。マガジンは基本的なメカニズムの1つです。 ：我々はそれへの書き込みの確認をオフにした場合、我々は2つのことをしない</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><u><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のfsyncを</font></font></strong></u></a><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログに</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それが終了するのを待ちません</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これ</font><font style="vertical-align: inherit;">により、保証の持続性を変更</font><strong><font style="vertical-align: inherit;">する</font></strong><font style="vertical-align: inherit;">だけで</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、多くのディスクリソース</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">節約し、</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スループットを複数向上させる</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことができ</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">{<span class="hljs-attr">w</span>:<span class="hljs-number">1</span>, <span class="hljs-attr">j</span>:<span class="hljs-literal">false</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も厳しい耐久性の保証は</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべての確認応答</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">無効にすること</font></strong><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">リクエストがプライマリレプリカに到達したという確認のみを受け取ります。</font><font style="vertical-align: inherit;">これにより、待ち時間が短縮され、帯域幅は増加しません。</font></font><br>
<br>
<pre><code class="javascript hljs">{<span class="hljs-attr">w</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">j</span>:<span class="hljs-literal">false</span>} —   .</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、一意のキーとの競合により記録が失敗したなど、さまざまなものを受け取ります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これはどの操作に適用されますか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Joomでのセットアップへの応用についてお話します。</font><font style="vertical-align: inherit;">耐久性の譲歩がないユーザーからの負荷に加えて、バックグラウンドのバッチロードとして説明できる負荷があります。更新、評価の再カウント、分析データの収集です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのバックグラウンドオペレーションには数時間かかる場合がありますが、バックエンドなどのブレークがクラ​​ッシュしたときにすべての作業の結果が失われることはなく、最近のポイントから再開するように設計されています。</font><font style="vertical-align: inherit;">耐久性保証の削減は、特に他の操作と同様にログのfsyncが読み取りのレイテンシを増加させるため、このようなタスクに役立ちます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読み取りスケーリング</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の問題は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不十分な読み取りスループット</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。クラスターにはプライマリレプリカだけでなく、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読み取り可能</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なセカンダリレプリカも存在することを思い出して</font><strong><font style="vertical-align: inherit;">ください</font></strong><font style="vertical-align: inherit;">。やってみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読むことはできますが、ニュアンスがあります。わずかに古くなったデータは、セカンダリレプリカから0.5〜1秒で取得されます。これはほとんどの場合正常ですが、セカンダリレプリカの動作はプライマリレプリカの動作とは異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セカンダリでは、プライマリレプリカにはないoplogを使用するプロセスがあります。このプロセスは低レイテンシ用に設計されたものではありません。MongoDB開発者だけがこれを気にしませんでした。特定の条件下では、プライマリからセカンダリへのoplogの使用プロセスにより、最大10秒の遅延が発生する可能性があります。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セカンダリレプリカはユーザークエリには適していません。ユーザーエクスペリエンスはすぐにビンに入ります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シェーディングされていないクラスターでは、これらのスパイクはあまり目立ちませんが、まだあります。</font><font style="vertical-align: inherit;">oplogは削除の影響を特に受け、削除</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はバランサーの仕事の一部である</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、シャードクラスターは影響を受けます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">バランサーは確実に、上品に、短時間で何万ものドキュメントを削除します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続数</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の考慮事項は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDBインスタンスの接続数の制限</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。デフォルトでは</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、OSリソースを除いて</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制限はありません</font><strong><font style="vertical-align: inherit;">-</font></strong><font style="vertical-align: inherit;">許可されている間接続できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、同時要求が多いほど、実行速度は遅くなります。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスは非線形的に低下し</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。したがって、リクエストのスパイクが到着した場合は、100％を処理するのではなく、80％を処理する方が適切です。接続数はMongoDBに直接制限する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これが原因で問題が発生する可能性のあるバグがあります。特に、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB側の接続プールは、ユーザーとサービスの両方のクラスター内接続に共通です。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">アプリケーションがこのプールからのすべての接続を「食べた」場合、整合性がクラスターで違反される可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスを再構築するときにこのことを学びました。インデックスから一意性を削除する必要があるため、手順はいくつかの段階を経ました。</font><font style="vertical-align: inherit;">MongoDBでは、インデックスの隣に同じものを作成することはできませんが、一意性を確保する必要があります。</font><font style="vertical-align: inherit;">したがって、私たちは欲しかった：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一意性のない類似のインデックスを作成する</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一意のインデックスを削除します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リモートではなく一意性のないインデックスを作成します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一時的に削除します。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一時インデックスがセカンダリでまだ完了していたときに、一意のインデックスを削除し始めました。</font><font style="vertical-align: inherit;">この時点で、セカンダリMongoDBがロックを発表しました。</font><font style="vertical-align: inherit;">一部のメタデータがブロックされ、大部分のレコードが停止しました。それらは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続プールで</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハングし</font><font style="vertical-align: inherit;">、レコードが通過したことを確認するのを待ちました。</font><font style="vertical-align: inherit;">グローバルログがキャプチャされたため、セカンダリのすべての読み取りも停止しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような興味深い状態のクラスターも、接続を失いました。</font><font style="vertical-align: inherit;">時々表示され、2つのレプリカが相互に接続されたときに、グローバルロックがあるため、作成できない状態で選択を試みました。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">話の教訓：接続の数を監視する必要があります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
よく知られているMongoDBのレーキがありますが、これはまだ頻繁に攻撃されているため、少し歩くことにしました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントを紛失しないでください</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスを使用してリクエストをMongoDBに送信する</font><font style="vertical-align: inherit;">と、完全に予期しないケース</font><font style="vertical-align: inherit;">では、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストは</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件を満たす</font><strong><font style="vertical-align: inherit;">すべてのドキュメント</font></strong><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">返すとは限りません</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、インデックスの先頭に移動すると、ドキュメントは最後に、渡したドキュメントの先頭に移動するためです。</font><font style="vertical-align: inherit;">これは単に</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスの可変性</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によるもの</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">信頼性の高い反復処理を行うには、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非安定フィールドにインデックスを</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用してください</font><font style="vertical-align: inherit;">。問題は発生しません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MongoDBには、使用するインデックスに関する独自のビューがあります。</font><font style="vertical-align: inherit;">解決策は簡単</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。$ヒントを使用して、指定したインデックスをMongoDBに使用させます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コレクションサイズ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのスタートアップは開発中ですが、データはたくさんありますが、ディスクを追加したくありません。先月はすでに3回追加しています。</font><font style="vertical-align: inherit;">データに何が格納されているかを見て、ドキュメントのサイズを見てみましょう。</font><font style="vertical-align: inherit;">コレクションのどこでサイズを小さくできるかを理解するにはどうすればよいですか？</font><font style="vertical-align: inherit;">2つのパラメータによると。</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のドキュメント</font></font></strong><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">のサイズによって、</font></strong><font style="vertical-align: inherit;">その長さで遊ぶ</font></font><code>Object.bsonsize()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：;</font></font><br>
</li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平均によると</font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、文書のサイズ</font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llektsii</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>db.c.stats().avgObjectSize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
</li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントのサイズにどのように影響しますか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この質問に対する具体的な回答はありません。まず、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド名が長いと、ドキュメントのサイズが大きくなります。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのフィールド名は各ドキュメントにコピーされるため、ドキュメントに長いフィールド名がある場合、名前のサイズを各ドキュメントのサイズに追加する必要があります。複数のフィールドに多数の小さなドキュメントがあるコレクションがある場合は、フィールドに短い名前を付けます。「A」、「B」、「CD」-最大2文字。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディスクでは、これは圧縮によってオフセットされ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますが、すべてがそのままキャッシュに保存されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のヒント- </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーディナリティが低い一部のフィールドは、コレクションの名前に含めることができます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。例えば、そのようなフィールドは言語であり得る。ロシア語、英語、フランス語への翻訳を含むコレクションと、保存されている言語に関する情報を含むフィールドがある場合、このフィールドの値をコレクションの名前に含めることができます。したがって</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ドキュメントのサイズを</font></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">減らし、インデックスの数とサイズを減らす</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことができ</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;"> - </font><strong><font style="vertical-align: inherit;">まったく</font></strong><font style="vertical-align: inherit;">節約できます！コレクションが異なるコレクションに分割されている場合に機能しないインデックスがドキュメント内にある場合があるため、常にそれを上げることができるとは限りません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントサイズに関する最後のヒント</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-_idフィールドを使用する</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">データに自然な一意のキーがある場合は、id_fieldに直接入力します。</font><font style="vertical-align: inherit;">キーが複合の場合でも、複合IDを使用します。</font><font style="vertical-align: inherit;">それは完全に索引付けされています。</font><font style="vertical-align: inherit;">小さなレーキは1つしかありません。マーシャラーがフィールドの順序を変更することがある場合、同じフィールド値を持つIDですが、MongoDB内の一意のインデックスに関しては、順序が異なると、異なるIDと見なされます。</font><font style="vertical-align: inherit;">これはGoで発生する場合があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスサイズ</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスには、それに含まれるフィールドのコピーが格納されます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。インデックスのサイズは、インデックス付けされたデータで構成されます。大きなフィールドにインデックスを付ける場合は、インデックスのサイズを大きくする準備をしてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の瞬間</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、インデックスを</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">強く膨らませます。インデックスの</font><strong><font style="vertical-align: inherit;">配列フィールドは、このインデックスのドキュメントの他のフィールドを乗算します</font></strong><font style="vertical-align: inherit;">。ドキュメント内の配列が大きい場合は注意してください。配列に他のインデックスを付けないか、インデックス内のフィールドがリストされている順序を試します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの順番に</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスフィールドの1が配列である場合は特に</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">フィールドのカーディナリティが異なり、1つのフィールドで可能な値の数が別のフィールドで可能な値の数と非常に異なる場合は、カーディナリティを増やしてフィールドを構築することは理にかなっています。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーディナリティが異なるフィールドを交換すると、インデックスサイズの50％を簡単に節約できます。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの置換により、サイズをさらに大幅に削減できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
場合によっては、フィールドに大きな値が含まれている場合、この値を多かれ少なかれ比較する必要はなく、明確な等価性による比較です。</font><font style="vertical-align: inherit;">次に、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><strong><font style="vertical-align: inherit;">多いフィールド</font></strong><font style="vertical-align: inherit;">の</font><strong><font style="vertical-align: inherit;">インデックスを、</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このフィールドのハッシュのインデックスで置き換える</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">インデックスには、これらのフィールドのコピーではなく、ハッシュのコピーが格納されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントを削除する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントの削除は不愉快な操作であり</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、可能であれば削除しない方がよい</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とすでに述べました</font><strong><font style="vertical-align: inherit;">。</font></strong><font style="vertical-align: inherit;">データスキーマを設計するときは、個々のデータの削除を最小限にするか、コレクション全体を削除することを検討してください。コレクション全体で削除できます。コレクションの削除は安価な操作であり、何千もの個々のドキュメントを削除することは困難な操作です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでも多くのドキュメントを削除する必要がある場合は、必ず</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スロットル</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">実行</font></strong><font style="vertical-align: inherit;">して</font><strong><font style="vertical-align: inherit;">ください</font></strong><font style="vertical-align: inherit;">。そうしないと、ドキュメントを大量に削除すると、読み取りのレイテンシが影響を受け、不快になります。これは、セカンダリのレイテンシにとって特に悪いことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スロットルを回すには、ある種の「ペン」を作成する価値があります。最初にレベルを上げるのは非常に困難です。何度も通過したので、3回目、4回目からスロットリングが推測されます。最初は、引き締めの可能性を検討します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大きなコレクションの30％以上を削除する場合は、ライブドキュメントを隣接するコレクション</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><strong><font style="vertical-align: inherit;">転送し</font></strong><font style="vertical-align: inherit;">、古いコレクション全体を削除します。ロードが古いコレクションから新しいコレクションに切り替えられるため、ニュアンスがあることは明らかですが、可能であればシフトしてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントを削除するもう1つの方法は、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスです。これは、ドキュメントの死亡日を含むMongoタイムスタンプを含むフィールドにインデックスを付けるインデックスです。この時間が来ると、MongoDBはこのドキュメントを自動的に削除します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TTLインデックスは便利ですが</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、実装にスロットルはありません。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDBは、これらの削除を削除する方法を気にしません。</font><font style="vertical-align: inherit;">数百万のドキュメントを同時に削除しようとすると、数分間、削除のみを処理し、それ以上は処理しないクラスターが動作しなくなります。</font><font style="vertical-align: inherit;">これが起こらないようにするには、ある種の</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダム性を</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">し、ビジネスロジックと遅延への特殊効果が許す限り</font><strong><font style="vertical-align: inherit;">TTL</font></strong><font style="vertical-align: inherit;">を塗りつぶします。</font><font style="vertical-align: inherit;">削除を一時点に集中させるビジネスロジックの自然な原因がある場合は、TTLを塗りつぶす必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーディング</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはこの瞬間を延期しようとしましたが、それは来ました-水平方向にスケーリングする必要があります。</font><font style="vertical-align: inherit;">MongoDBの場合、これはシャーディングです。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーディングが必要かどうか疑わしい場合は、必要ありません。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シャーディングは、さまざまな方法で開発者と開発者の生活を複雑にします。会社ではシャーディング税と呼んでいます。コレクション</font><font style="vertical-align: inherit;">をシャーディングする</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、コレクションの特定のパフォーマンスが低下し</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。MongoDBはシャーディング用に個別のインデックスを必要とし、より効率的に実行できるようにリクエストに追加のパラメーターを渡す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のシャーディングはうまく機能しません。たとえば</font></font><code>skip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ドキュメントが多い場合は特に、で</font><font style="vertical-align: inherit;">クエリを使用</font><font style="vertical-align: inherit;">することはお勧めできません。 「100,000ドキュメントをスキップします」というコマンドを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MongoDBはこのように考えています。「1番目、2番目、3番目... 10万分の1、さらに先に進みましょう。そして、これをユーザーに返します。」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非共有コレクションでは、MongoDBはそれ自体のどこかで操作を実行します。シャードのように、彼女は実際に100,000のドキュメントをすべて読み取り、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mongos</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のシャーディングプロキシに送信します。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><u><font style="vertical-align: inherit;">モンゴス</font></u></a><font style="vertical-align: inherit;">のシャーディングプロキシは</font><font style="vertical-align: inherit;">、最初の100,000を何らかの方法でフィルタリングして破棄します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーディングにより、コードは必然的に複雑になります</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。シャーディングキーを多くの場所にドラッグする</font><strong><font style="vertical-align: inherit;">必要が</font></strong><font style="vertical-align: inherit;">あり</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。これは常に便利であるとは限りません。一部のクエリは、ブロードキャストまたはマルチキャストのいずれかで送信されますが、スケーラビリティも追加されません。シャーディングがより正確になるキーを選択します。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャードコレクションで操作が中断する</font></font><code>count</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">彼女は実際よりも多くの数を返し始めます-彼女は2回嘘をつくことができます。</font><font style="vertical-align: inherit;">その理由は、ドキュメントが1つのシャードから別のシャードに注がれるときのバランシングプロセスにあります。</font><font style="vertical-align: inherit;">ドキュメントが隣接するシャードに注がれたが、まだ元のシャードに残っていない場合、</font></font><code>count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とにかくそれらをカウントします。</font><font style="vertical-align: inherit;">MongoDB開発者は、これをバグとは呼びません。これはそのような機能です。</font><font style="vertical-align: inherit;">彼らがそれを修正するかどうかはわかりません。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャッフルされたクラスターは、管理がはるかに困難</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">バックアップを削除するプロセスが根本的に複雑になるため、Devopはあなたに挨拶をやめます。</font><font style="vertical-align: inherit;">シャーディングすると、インフラストラクチャの自動化の必要性が火災警報のように点滅します。これは、以前は不要でした。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDBでのシャーディングの仕組み</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コレクションがあり、どういうわけかそれを破片の周りに散らしたいと思います。</font><font style="vertical-align: inherit;">これを行うために、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDBは</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャードキーを使用し</font><strong><font style="vertical-align: inherit;">てコレクションをチャンク</font></strong><font style="vertical-align: inherit;">に分割し、シャードキースペースでそれらを均等に分割しようとします。</font><font style="vertical-align: inherit;">次に、バランサーが来ます。バランサーは、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらのチャンクをクラスター内のシャードに合わせて</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熱心に</font><strong><font style="vertical-align: inherit;">レイアウトします</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さらに、これらのチャンクの重さやそれらに含まれるドキュメントの数はバランサーでは考慮されません。これは、バランシングが部分ごとに行われるためです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーディングキー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何をシャーディングするかまだ決めていますか？さて、最初の質問は、シャーディングキーの選択方法です。優れたキーは、いくつかのパラメータがあります：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高カーディナリティ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非安定性を</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それが</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頻繁に要求によく適合します</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シャーディングキーの自然な選択は、主キーであるidフィールドです。 idフィールドがシャーディングに適している場合は、直接シャーディングすることをお勧めします。これは優れた選択です。彼はカーディナリティが高く、安定していませんが、頻繁な要求にどれだけうまく適合するかは、ビジネスの特異性です。あなたの状況に基づいて構築します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
失敗したシャーディングキーの例を示します。</font><font style="vertical-align: inherit;">私はすでに翻訳のコレクションについて言及しました-翻訳。</font><font style="vertical-align: inherit;">言語を格納する言語フィールドがあります。</font><font style="vertical-align: inherit;">たとえば、コレクションは100の言語をサポートし、私たちはその言語に細分化します。</font><font style="vertical-align: inherit;">これは悪いです-カーディナリティ、可能な値の数はわずか100個です。</font><font style="vertical-align: inherit;">しかし、これは最悪ではありません-おそらくこれらの目的にはカーディナリティで十分です。</font><font style="vertical-align: inherit;">さらに悪いことに、言語をシャッフルするとすぐに、英語を話すユーザーが他のユーザーより3倍多いことがわかります。</font><font style="vertical-align: inherit;">英語が配置されている不幸なシャードへのリクエストは、他のすべてのリクエストの3倍になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、シャードキーは当然ながら負荷分散が不均一になる傾向があることを覚えておく必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バランシング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なときにシャーディングを開始します。MongoDBクラスターのきしみ音、そのディスクを使用したクランチ、プロセッサーなど、可能な限りのことを行います。どこへ行く？どこにもない、そして私たちはコレクションのかかとを英雄的にシャッフルします。シャーディングして起動し、突然、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バランス調整が無料ではない</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことがわかりました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バランス調整にはいくつかの段階があります。バランサーは、どこからどこに転送するかから、チャンクとシャードを選択します。その後の作業は2つのフェーズで行われます。最初に、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントが</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースからターゲットに</font><strong><font style="vertical-align: inherit;">コピーさ</font></strong><font style="vertical-align: inherit;">れ、次にコピーされたドキュメント</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が削除され</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シャードには負荷がかかりすぎて、すべてのコレクションが含まれていますが、操作の最初の部分は簡単です。しかし、2番目の-除去-は肩甲骨に破片を置き、すでに負荷がかかっているため、完全に不快です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、たとえば数千などの大量のチャンクのバランスを取る場合、デフォルト設定ではこれらのすべてのチャンクが最初にコピーされ、次にリムーバーが入り、それらを一括で削除し始めるという事実によってさらに悪化します。この時点で、手順は影響を受けなくなり、悲しいことに何が起こっているのかを悲しげに見なければなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、過負荷のクラスターをシャーディングする場合は、</font><strong><font style="vertical-align: inherit;">バランスを取るのに時間がかかる</font></strong><font style="vertical-align: inherit;">ため、計画を立てる必要があります</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この時間はプライムタイムではなく、負荷が低い時間帯に使用することをお勧めします。バランサー-切断されたスペアパーツ。手動モードでプライマリバランシングに近づき、プライムタイムにバランサーをオフにして、負荷が減少したときにオンにして、より多くのことを行えるようにすることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラウドの機能によって垂直方向にスケーリングできる場合は、事前にシャードソースを改善して、これらすべての特殊効果を少し減らすことをお勧めします。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャーディングは注意深く準備する必要があります。</font></font></b><br>
<br>
<blockquote><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HighLoad++ Siberia 2019</a>     24  25 . HighLoad ++ Siberia —        ,   -     «  »,          .  80     25,       ,          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,    .</blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454734/index.html">バックアップ、パート4：zbackup、restic、borgbackupの概要とテスト</a></li>
<li><a href="../ja454738/index.html">PVS-StudioでのVisual Studio 2019のサポート</a></li>
<li><a href="../ja454740/index.html">2019年5月Joomlaダイジェスト</a></li>
<li><a href="../ja454742/index.html">あなたが知らなかった少なくとも1つのVimトリック</a></li>
<li><a href="../ja454744/index.html">RigaDevDaysカンファレンスからのJava Trackレポートの概要</a></li>
<li><a href="../ja454750/index.html">Swift UI-ヨーロッパ中を駆け巡る</a></li>
<li><a href="../ja454754/index.html">いつまでも有効性の仮説をチェックする価値はありますか？</a></li>
<li><a href="../ja454756/index.html">サイトのパフォーマンスと広告設定の確認、卸売企業の顧客を引き付けるコスト</a></li>
<li><a href="../ja454758/index.html">Windows Defenderを安く陽気に回避する：Mimikatzを難読化する</a></li>
<li><a href="../ja454760/index.html">Intel Optane Memory M15-M10より高速</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>