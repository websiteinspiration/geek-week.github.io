<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öïÔ∏è ‚ôìÔ∏è ‚ù§Ô∏è How I Collected Wheel Physics at Unigine üö∂üèº üë®‚Äçüë©‚Äçüë¶ üßìüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 
 
 This time we will talk about the Russian Unigine engine , and how to assemble a simple machine in it. The scheme is not ideal, since I h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How I Collected Wheel Physics at Unigine</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502558/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good day. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This time we will talk about the Russian </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unigine engine</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and how to assemble a simple machine in it. </font><font style="vertical-align: inherit;">The scheme is not ideal, since I have not figured it out in some things, but at least I will share my experience.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c2/zw/ga/c2zwgaa8w_tvfzoalwi0twc8tpw.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First of all, to understand how the physics of wheels is done, we go to the official documentation and find this </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">example</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, note that this is an example for wheels joint, but for some reason it lies at the address / car_suspension_joints /. You also need to make sure that the documentation does not skip to the old versions (that is, that DOCS (2.11) is open) and mark the ‚ÄúC #‚Äù box on top of the article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having studied the example, we see that it was written by analogy with the early C ++ solution. That is, everything is created through code. So much for visual programming, we‚Äôve arrived. Well, not everything is so sad, but you can see how all this is done in code. And having run on the links, get a general idea of ‚Äã‚Äãthe wheels joint device and physics settings.</font></font><br>
<blockquote>           (               ).  ,   -,    UnigineScript,           .           LOD'.</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, I was expecting a ready-made step-by-step guide on visual assembly in order to get something rolling, costing little blood. </font><font style="vertical-align: inherit;">As a result, I still had to plunge into it all with my head in order to work out some approximate pipeline. </font><font style="vertical-align: inherit;">This partially succeeded, but it was far from being understood at all points and questions remain open, for example, whether the casing and wheel nodes should be built into a certain hierarchy, whether the axes of the points are oriented correctly, and so on. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, this instruction will help you grasp the basic principle, but in order to understand the intricacies of the settings, you will still have to study the documentation (or maybe they will tell you something useful in the comments).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frame assembly</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Create a new project. Choose the C # option. Open the project in the editor. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rk/tn/h7/rktnh7wpsyzisoq4ty669fphlse.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/-y/ap/5w/-yap5w7rp7hvkwcn5kvplalrl4y.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/qo/i9/h5/qoi9h50sjmgnd8ffvr0j_0adgqg.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We create the basis of the machine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, right-click in the scene, choosing </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primitive</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Box</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The result is a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuboid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> object </font><font style="vertical-align: inherit;">. Raise it slightly above the "floor". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/zv/wl/cvzvwl6izztpmcwchcizqgxtnok.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We create wheels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Click the mouse again and select </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primitive</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cylinder</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . It will take 4 pieces.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/zl/qe/zmzlqe9puvjmazj1oqxx4vyouj4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order not to get confused with the orientation, you can rotate the camera so that -Y glows from above in the cube (that is, we now look at the future machine from behind) and place two cylinders behind Cuboid, two others in front of it. Somehow to rotate and customize them is not necessary. For convenience, different colors can be assigned to the rear and front. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add physics based. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select Cuboid and on the left, in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameters</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> window </font><font style="vertical-align: inherit;">from the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tab, </font><font style="vertical-align: inherit;">switch to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physics</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the Body column, select the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rigid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> type </font><font style="vertical-align: inherit;">. After that, scroll down and select the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Box</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item in the opened Shapes column </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n3/if/mr/n3ifmrljrcf7hdti6jl1d_hkwzy.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ok/b7/bd/okb7bdarwhc9ecqndtxrv99_yvo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see the appeared </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ShapeBox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. We‚Äôll go into its settings and immediately set our base to the recommended mass ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) of 64 kilograms. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sc/3b/xg/sc3bxgfko_smsb0azhe3cxe6ska.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add physics to the wheels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In turn, select the cylinders and also put them </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rigid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the Physics tab. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They won‚Äôt need to create a Shape, because wheel joints work on rakcasts. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tie the wheels to the base. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Time to assign wheel joints. To do this, select Cuboid correctly and scroll down to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joints</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> column in the Physics tab </font><font style="vertical-align: inherit;">. In the list, select </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wheel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and when you click the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button, the </font><b><font style="vertical-align: inherit;">Select a Body</font></b><font style="vertical-align: inherit;"> window </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appears</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. There you select a cylinder, it is highlighted with a white grid in the scene, and press Ok. A </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WheelJoint</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> binding will appear in the list </font><font style="vertical-align: inherit;">. Here it is already desirable to rename them (for this you need to click on the line JointWheel and write a new name in the Name column). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xl/wc/55/xlwc55bh8sfeeycxgd_0g69bc4y.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/cy/tx/gu/cytxgutnev7f2dtruvcuxulb_di.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the same way, attach the remaining cylinders to Cuboid. So that in the end on his list of points burned 4 lines. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k9/w7/m0/k9w7m0xomsussfajdt7pfrma0bo.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Without renaming there would be 4 lines of WheelJoint. </font></font></i><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that you need to bind from Cuboid, and not from the Physics tab of the cylinders themselves. Although after, if you select a specific cylinder and go to its Physics, then its created joint is also displayed there and you can edit its parameters. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Set up the configuration of the bindings.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Again, select Cuboid, find in Physics a list of its points and select one of them. We see that a white corner with squares appeared in the scene inside Cuboid. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the settings of the joint, we find the graph of the vector </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anchor 0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and adjust the values ‚Äã‚Äãof its three fields so that this corner is shifted along the X axis, outside Cuboid and slightly lowered along the Z axis. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9r/qc/rq/9rqcrqrxixc4te5t044g7b6rgvc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/k2/9w/bz/k29wbzbjz46oihwptmknnhs2vvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then we shift the corner along the Y axis, depending on the binding which wheel is currently selected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We repeat the procedure with the rest of the points, setting exactly the same shifts along Z and the same, but multidirectional along the other axes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you select all the points at once, the overall design will become visible. You can also enable the display of joints in helpers on a special panel above the scene: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helpers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physics</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joints</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/up/zc/hbupzcovchgweojafgbxklzpqag.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rear view of the frame with the included helpers </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We look at what happened. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the editor there is a button for calculating physics. If you enable it, then a simulation of physics starts (the scripts do not work) and you can check how our Frankenstein behaves. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before starting, make sure that the enabled checkboxes for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Collision</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physics Intersection are checked</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the "floor" settings </font><font style="vertical-align: inherit;">. Otherwise, our creation may completely fail under the floor entirely or with just wheels. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qb/tm/o8/qbtmo8bd8kf3-p_w6sh7im8g3p0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Be careful, before turning on the simulation, it is better to save, and the parameters corrected during its operation will return to their values ‚Äã‚Äãafter disconnecting.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we see, the wheels are picked up in the right places, but the structure falls on the surface with the ends of the cylinders. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o1/fw/-1/o1fw-1vccn8ik64sqcdbuqy2ghg.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can freeze Cuboid itself in place by first enabling the Immovable checkbox on the Physics tab in the Body column. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adjust the axles of the wheels. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Disable physics simulation. Select Cuboid, go to its Physics tab and edit the axes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Axis 10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Axis 11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for each junction </font><font style="vertical-align: inherit;">. Please note that in the sum of the fields of each vector take values ‚Äã‚Äãfrom 0 to 1 and the editor will try to automatically correct the values ‚Äã‚Äãif you first put 1 in a new axis without zeroing the vector.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apparently, I have not yet developed the vectors quite correctly, the helpers show that the left and right parts are looking in the same direction, but they do not give a clear understanding of which axis is where, which makes tuning difficult. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In any case, this layout works less or less. Here I set the axis vectors as follows: Axis 00 ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Axis 10 ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Axis 11 ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t3/ag/gx/t3aggx5tphzit6yeuvzgwdlvaz0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you start a physics simulation now, then the design should fall on correctly rotated cylinders, which will subsequently spin along the correct axis. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wheel mass and behavior, physical iterations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely, the structure after falling to the floor now partially fails. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, let's go into the general settings of physics. We click on the top line of the editor. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Settings</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and in the Settings tab that opens, we find the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Physics</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> column </font><font style="vertical-align: inherit;">(Runtime / World /). We set </font><font style="vertical-align: inherit;">at least </font><b><font style="vertical-align: inherit;">5</font></b><font style="vertical-align: inherit;"> in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iterations</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> field </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Again we go into the settings of each joint. </font><font style="vertical-align: inherit;">
At the top of the list, everyone has an </font><b><font style="vertical-align: inherit;">Iteration</font></b><font style="vertical-align: inherit;"> field </font><font style="vertical-align: inherit;">, set </font><b><font style="vertical-align: inherit;">8</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">Linear Restitution</font></b><font style="vertical-align: inherit;"> and </font><b><font style="vertical-align: inherit;">Angular Restitution</font></b><font style="vertical-align: inherit;"> set to </font><b><font style="vertical-align: inherit;">0.1</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">Linear from</font></b></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/hz/rz/3a/hzrz3a_ss_pg09irawvrwz5i5tg.jpeg"><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">change </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-0.15</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linear To</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.15</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the bottom we affix them a mass of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kg in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wheel Mass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> field </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the simulation starts, the physics ‚Äúmachine‚Äù still has to partially fail / fail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Set each </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linear Damping</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . And set </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linear Spring</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, during the simulation, the structure should fall and bounce slightly on the floor. If that doesn't work, then experiment with the Linear Damping and Linear Spring values.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The documentation recommends setting damping 400 and spring 100, but personally, at the same time, the ‚Äúmachine‚Äù starts spinning like a helicopter, bounces and flies away. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The final setting of the frame. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Save and try to click </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Play</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the button above, next to the inclusion of physical simulation) to walk around the scene in the first person. Most likely the ‚Äúmachine‚Äù hung a little in the air, but rolls if it is pushed into the central cube. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gc/rm/ph/gcrmph0gmkv8unsmjjihna9glio.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can adjust </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anchor 0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the points so that they are approximately equidistant from the center (although not necessary). Then start the simulation and change </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linear Spring</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> right during it </font><font style="vertical-align: inherit;">to find the optimal value at which each wheel normally touches the ground.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After all these manipulations, you should get a ‚Äúmachine‚Äù correctly falling to the floor, which rolls slightly when pushing in game mode, where by default you run on a separate controller with a first-person view.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gz/tx/mp/gztxmpwohsuj6xw3pcwosvommj4.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Writing a control script</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have a blank of the ‚Äútypewriter‚Äù, now we will write a control code for it in C #. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, right-click in the window under the scene and select </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create C # Component</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Enter the name of the script in the window that appears. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7m/wt/tc/7mwttcgrd3_7ugr6w-9frtohwqo.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/o3/ha/x_/o3hax_u0jcam5wcbhrqwk4uwpiq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Double-click on the appeared script file and the development environment starts. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_i/ak/6t/_iak6tyajkyxwcwsharicq44s7o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select the lines filled with blue in the picture, delete them and instead add the following code to which I came up editing the script proposed in the documentation:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script snippet</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs">	[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Left Wheel"</span>)]
	<span class="hljs-keyword">private</span> Node targetWheelL = <span class="hljs-literal">null</span>;<font></font>
	[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Right Wheel"</span>)]
	<span class="hljs-keyword">private</span> Node targetWheelR = <span class="hljs-literal">null</span>;<font></font>
<font></font>
	[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Left Wheel F"</span>)]
	<span class="hljs-keyword">private</span> Node targetFWL = <span class="hljs-literal">null</span>;<font></font>
	[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Right Wheel F"</span>)]
	<span class="hljs-keyword">private</span> Node targetFWR = <span class="hljs-literal">null</span>;<font></font>
<font></font>
	[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"theCar"</span>)]
	<span class="hljs-keyword">private</span> Node targetCar = <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> JointWheel my_jointL;
    <span class="hljs-keyword">private</span> JointWheel my_jointR;
    <span class="hljs-keyword">private</span> JointWheel my_jointFL;
    <span class="hljs-keyword">private</span> JointWheel my_jointFR;<font></font>
<font></font>
	Controls controls = <span class="hljs-literal">null</span>;
	<span class="hljs-keyword">float</span> angle = <span class="hljs-number">0.0f</span>;
	<span class="hljs-keyword">float</span> velocity = <span class="hljs-number">0.0f</span>;
	<span class="hljs-keyword">float</span> torque = <span class="hljs-number">0.0f</span>;<font></font>
<font></font>
	<span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> ifps;<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Init</span>(<span class="hljs-params"></span>)</span><font></font>
	{<font></font>
	my_jointL = targetWheelL.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
	my_jointR = targetWheelR.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
	my_jointFL = targetFWL.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
	my_jointFR = targetFWR.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
<font></font>
	PlayerPersecutor player = <span class="hljs-keyword">new</span> PlayerPersecutor();<font></font>
	controls = player.Controls;<font></font>
	}<font></font>
	<font></font>
	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span><font></font>
	{<font></font>
			ifps = Game.IFps;<font></font>
<font></font>
			<span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_FORWARD) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_UP) == <span class="hljs-number">1</span>))<font></font>
			{<font></font>
				velocity = MathLib.Max(velocity, <span class="hljs-number">0.0f</span>);<font></font>
				velocity += ifps * <span class="hljs-number">50.0f</span>;<font></font>
				torque = <span class="hljs-number">5.0f</span>;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_BACKWARD) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_DOWN) == <span class="hljs-number">1</span>))<font></font>
			{<font></font>
				velocity = MathLib.Min(velocity, <span class="hljs-number">0.0f</span>);<font></font>
				velocity -= ifps * <span class="hljs-number">50.0f</span>;<font></font>
				torque = <span class="hljs-number">5.0f</span>;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
				velocity *= MathLib.Exp(-ifps);<font></font>
			}<font></font>
			velocity = MathLib.Clamp(velocity, <span class="hljs-number">-90.0f</span>, <span class="hljs-number">90.0f</span>);<font></font>
<font></font>
			<span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_MOVE_LEFT) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_LEFT) == <span class="hljs-number">1</span>))<font></font>
				angle += ifps * <span class="hljs-number">100.0f</span>;
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_MOVE_RIGHT) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_RIGHT) == <span class="hljs-number">1</span>))<font></font>
				angle -= ifps * <span class="hljs-number">100.0f</span>;
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
				<span class="hljs-keyword">if</span> (MathLib.Abs(angle) &lt; <span class="hljs-number">0.25f</span>) angle = <span class="hljs-number">0.0f</span>;
				<span class="hljs-keyword">else</span> angle -= MathLib.Sign(angle) * ifps * <span class="hljs-number">45.0f</span>;<font></font>
			}<font></font>
	<font></font>
			angle = MathLib.Clamp(angle, <span class="hljs-number">-10.0f</span>, <span class="hljs-number">10.0f</span>);<font></font>
<font></font>
			<span class="hljs-keyword">float</span> base_a = <span class="hljs-number">3.3f</span>;
			<span class="hljs-keyword">float</span> width = <span class="hljs-number">3.0f</span>;
			<span class="hljs-keyword">float</span> angle_0 = angle;
			<span class="hljs-keyword">float</span> angle_1 = angle;
			<span class="hljs-keyword">if</span> (MathLib.Abs(angle) &gt; MathLib.EPSILON)<font></font>
			{<font></font>
				<span class="hljs-keyword">float</span> radius = base_a / MathLib.Tan(angle * MathLib.DEG2RAD);<font></font>
				angle_0 = MathLib.Atan(base_a / (radius + width / <span class="hljs-number">2.0f</span>)) * MathLib.RAD2DEG;<font></font>
				angle_1 = MathLib.Atan(base_a / (radius - width / <span class="hljs-number">2.0f</span>)) * MathLib.RAD2DEG;<font></font>
			}<font></font>
<font></font>
			my_jointFL.Axis10 = MathLib.RotateZ(angle_0).GetColumn3(<span class="hljs-number">0</span>);<font></font>
			my_jointFR.Axis10 = MathLib.RotateZ(angle_1).GetColumn3(<span class="hljs-number">0</span>);<font></font>
<font></font>
			<span class="hljs-keyword">if</span> (controls.GetState(Controls.STATE_USE) == <span class="hljs-number">1</span>)<font></font>
			{<font></font>
				velocity = <span class="hljs-number">0.0f</span>;<font></font>
					my_jointL.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
					my_jointR.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
					my_jointFL.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
					my_jointFR.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
					my_jointL.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
					my_jointR.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
					my_jointFL.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
					my_jointFR.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
			}<font></font>
<font></font>
			<span class="hljs-keyword">if</span> (Input.IsKeyDown(Input.KEY.Q))<font></font>
			{<font></font>
				targetCar.ObjectBodyRigid.AddLinearImpulse(vec3.UP*<span class="hljs-number">1000f</span>);<font></font>
			}<font></font>
			<span class="hljs-keyword">if</span> (Input.IsKeyDown(Input.KEY.E))<font></font>
			{<font></font>
				targetCar.ObjectBodyRigid.AddLinearImpulse(vec3.DOWN*<span class="hljs-number">1000f</span>);<font></font>
			}<font></font>
<font></font>
	}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdatePhysics</span>(<span class="hljs-params"></span>)</span><font></font>
		{<font></font>
			my_jointL.AngularVelocity = velocity;<font></font>
			my_jointR.AngularVelocity = velocity;<font></font>
			<font></font>
			my_jointL.AngularTorque = torque;<font></font>
			my_jointR.AngularTorque = torque;<font></font>
		}<font></font>
</code></pre><br>
</div>
                    </div><br>
<br>
<i>      :</i><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">   TheVehicle.cs</b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> Unigine;<font></font>
<font></font>
[<span class="hljs-meta">Component(PropertyGuid = <span class="hljs-meta-string">"ca695c8787d5703a22a6c2516a3c177cddf38cab"</span>)</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TheVehicle</span> : <span class="hljs-title">Component</span><font></font>
{<font></font>
</code></pre><br>
,    ,       .     ,      .<br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Left Wheel"</span>)]
<span class="hljs-keyword">private</span> Node targetWheelL = <span class="hljs-literal">null</span>;<font></font>
[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Right Wheel"</span>)]
<span class="hljs-keyword">private</span> Node targetWheelR = <span class="hljs-literal">null</span>;<font></font>
<font></font>
[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Left Wheel F"</span>)]
<span class="hljs-keyword">private</span> Node targetFWL = <span class="hljs-literal">null</span>;<font></font>
[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"Right Wheel F"</span>)]
<span class="hljs-keyword">private</span> Node targetFWR = <span class="hljs-literal">null</span>;<font></font>
<font></font>
[<span class="hljs-meta">ShowInEditor</span>][Parameter(Tooltip = <span class="hljs-string">"theCar"</span>)]
<span class="hljs-keyword">private</span> Node targetCar = <span class="hljs-literal">null</span>;
</code></pre><br>
       .          tooltip     ,    .<br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> JointWheel my_jointL;
<span class="hljs-keyword">private</span> JointWheel my_jointR;
<span class="hljs-keyword">private</span> JointWheel my_jointFL;
<span class="hljs-keyword">private</span> JointWheel my_jointFR;
</code></pre><br>
   . <br>
<br>
<pre><code class="cs hljs">Controls controls = <span class="hljs-literal">null</span>;<font></font>
<font></font>
<span class="hljs-keyword">float</span> angle = <span class="hljs-number">0.0f</span>;
<span class="hljs-keyword">float</span> velocity = <span class="hljs-number">0.0f</span>;
<span class="hljs-keyword">float</span> torque = <span class="hljs-number">0.0f</span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> ifps;
</code></pre><br>
   .<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Init</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
my_jointL = targetWheelL.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
my_jointR = targetWheelR.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
my_jointFL = targetFWL.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;<font></font>
my_jointFR = targetFWR.ObjectBodyRigid.GetJoint(<span class="hljs-number">0</span>) <span class="hljs-keyword">as</span> JointWheel;
</code></pre><br>
   ,               JointWheel.<br>
        , ,    (    ).<br>
<br>
<pre><code class="cs hljs">			
<span class="hljs-comment">// setting up player and controls</span>
PlayerPersecutor player = <span class="hljs-keyword">new</span> PlayerPersecutor();<font></font>
controls = player.Controls;<font></font>
}<font></font>
</code></pre><br>
    ,  PlayerPresecutor,     Controls       player  .<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
ifps = Game.IFps;<font></font>
<font></font>
<span class="hljs-comment">// forward and backward movement by setting joint motor's velocity and torque</span>
			<span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_FORWARD) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_UP) == <span class="hljs-number">1</span>))<font></font>
			{<font></font>
				velocity = MathLib.Max(velocity, <span class="hljs-number">0.0f</span>);<font></font>
				velocity += ifps * <span class="hljs-number">50.0f</span>;<font></font>
				torque = <span class="hljs-number">5.0f</span>;<font></font>
			}<span class="hljs-comment">//Input.IsKeyDown(Input.KEY.DOWN)</span>
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_BACKWARD) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_DOWN) == <span class="hljs-number">1</span>))<font></font>
			{<font></font>
				velocity = MathLib.Min(velocity, <span class="hljs-number">0.0f</span>);<font></font>
				velocity -= ifps * <span class="hljs-number">50.0f</span>;<font></font>
				torque = <span class="hljs-number">5.0f</span>;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
				velocity *= MathLib.Exp(-ifps);<font></font>
			}<font></font>
			velocity = MathLib.Clamp(velocity, <span class="hljs-number">-90.0f</span>, <span class="hljs-number">90.0f</span>);<font></font>
<font></font>
			<span class="hljs-comment">// steering left and right by changing Axis01 for front wheel joints</span>
			<span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_MOVE_LEFT) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_LEFT) == <span class="hljs-number">1</span>))<font></font>
				angle += ifps * <span class="hljs-number">100.0f</span>;
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((controls.GetState(Controls.STATE_MOVE_RIGHT) == <span class="hljs-number">1</span>) || (controls.GetState(Controls.STATE_TURN_RIGHT) == <span class="hljs-number">1</span>))<font></font>
				angle -= ifps * <span class="hljs-number">100.0f</span>;
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
				<span class="hljs-keyword">if</span> (MathLib.Abs(angle) &lt; <span class="hljs-number">0.25f</span>) angle = <span class="hljs-number">0.0f</span>;
				<span class="hljs-keyword">else</span> angle -= MathLib.Sign(angle) * ifps * <span class="hljs-number">45.0f</span>;<font></font>
			}<font></font>
<font></font>
			angle = MathLib.Clamp(angle, <span class="hljs-number">-10.0f</span>, <span class="hljs-number">10.0f</span>);<span class="hljs-comment">//      30  (angle, -30.0f, 30.0f)</span><font></font>
<font></font>
			<span class="hljs-comment">// calculating steering angles for front joints (angle_0 and angle_1)</span>
			<span class="hljs-keyword">float</span> base_a = <span class="hljs-number">3.3f</span>;
			<span class="hljs-keyword">float</span> width = <span class="hljs-number">3.0f</span>;
			<span class="hljs-keyword">float</span> angle_0 = angle;
			<span class="hljs-keyword">float</span> angle_1 = angle;
			<span class="hljs-keyword">if</span> (MathLib.Abs(angle) &gt; MathLib.EPSILON)<font></font>
			{<font></font>
				<span class="hljs-keyword">float</span> radius = base_a / MathLib.Tan(angle * MathLib.DEG2RAD);<font></font>
				angle_0 = MathLib.Atan(base_a / (radius + width / <span class="hljs-number">2.0f</span>)) * MathLib.RAD2DEG;<font></font>
				angle_1 = MathLib.Atan(base_a / (radius - width / <span class="hljs-number">2.0f</span>)) * MathLib.RAD2DEG;<font></font>
			}<font></font>
</code></pre><br>
  Update,           ,     .<br>
<br>
<pre><code class="cs hljs">my_jointFL.Axis10 = MathLib.RotateZ(angle_0).GetColumn3(<span class="hljs-number">0</span>);<font></font>
my_jointFR.Axis10 = MathLib.RotateZ(angle_1).GetColumn3(<span class="hljs-number">0</span>);<font></font>
<font></font>
<span class="hljs-comment">// enabling or disabling a brake</span>
<span class="hljs-keyword">if</span> (controls.GetState(Controls.STATE_USE) == <span class="hljs-number">1</span>)<font></font>
{<font></font>
velocity = <span class="hljs-number">0.0f</span>;<font></font>
my_jointL.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
my_jointR.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
my_jointFL.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
my_jointFR.AngularDamping = <span class="hljs-number">20000.0f</span>;<font></font>
}<font></font>
<span class="hljs-keyword">else</span><font></font>
{<font></font>
my_jointL.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
my_jointR.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
my_jointFL.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
my_jointFR.AngularDamping = <span class="hljs-number">0.0f</span>;<font></font>
}<font></font>
</code></pre><br>
      ,  ,    .        ,     4 .     ,              ,         10 .<br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (Input.IsKeyDown(Input.KEY.Q))<font></font>
{<font></font>
targetCar.ObjectBodyRigid.AddLinearImpulse(vec3.UP*<span class="hljs-number">1000f</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span> (Input.IsKeyDown(Input.KEY.E))<font></font>
{<font></font>
targetCar.ObjectBodyRigid.AddLinearImpulse(vec3.DOWN*<span class="hljs-number">1000f</span>);<font></font>
}<font></font>
<font></font>
}<font></font>
</code></pre><br>
  Update   ,     .         ,            ‚Äî    ¬´this.¬ª    .<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdatePhysics</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
<span class="hljs-comment">// set angular velocity for rear joints</span><font></font>
my_jointL.AngularVelocity = velocity;<font></font>
my_jointR.AngularVelocity = velocity;<font></font>
<font></font>
<span class="hljs-comment">// set torque for rear joints</span><font></font>
my_jointL.AngularTorque = torque;<font></font>
my_jointR.AngularTorque = torque;<font></font>
<font></font>
}<font></font>
<font></font>
}<font></font>
</code></pre><br>
  Update Physics  ,     velocity  torque.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, save the script file and return to the editor window. Unigine will check the program for errors, and if everything is fine, then a green rectangle should appear at the bottom right with the notification Project build successful. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now select Cuboid, add the component field to it and drag our script there. A few fields appear that need to be filled. In the Target Wheel L field, gently drag the left rear wheel (that is, the Cylinder denoting it), Target Whell R - the right rear wheel, Target FWL - the front left, Target FWR - the front right, and Cuboid itself in the Target Car field. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/pw/hw/3fpwhwurb0yggyc7bob0_uvmjom.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To add a component, we find this field in the Cuboid properties and click on it. An </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/08/9q/kt/089qktyx8mxlma6h0p-lm4ecf4s.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empty line will appear where you can drag the script file (or find the path to it through the folder icon)</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/r8/tt/pj/r8ttpj5o5c76lgobt8l5qkq4cys.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fill in the fields</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Run Play - now the machine began to move. True, simultaneously with the character on whose behalf you are now looking at the world. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Her control is as follows: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - rolls forward, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - backward, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - turn the front wheels left and right, respectively. An </font><font style="vertical-align: inherit;">impulse is given up to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the machine, as it were, jumps. On </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , on the contrary, the impulse moves down.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may notice that the machine falls slightly slowly, like on the moon. To improve this moment there are two options. The documentation suggested making changes to the AppWorldLogic.cs file. But we don‚Äôt need this, since I carried out the initialization there in the typewriter script. Except a few lines that rule global physics. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fact is that you can independently enter these settings and change them. To do this, click on the top line of the editor. Windows&gt; Settings, in the window that opens, find the column Physics and set the value for Frozen Linear Velocity to 0.1, for Frozen Angular Velocity also 0.1, and change the lowest Gravity vector from (0,0, -9,8) to (0,0, - 19.6). </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The same can be done in the code by adding the following lines to Init:</font></font><br>
<br>
<pre><code class="cs hljs">Physics.Gravity = <span class="hljs-keyword">new</span> vec3(<span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">-9.8f</span> * <span class="hljs-number">2.0f</span>);<font></font>
Physics.FrozenLinearVelocity = <span class="hljs-number">0.1f</span>;<font></font>
Physics.FrozenAngularVelocity = <span class="hljs-number">0.1f</span>;
</code></pre></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you start Play now, then the ‚Äúmachine‚Äù will probably deteriorate again and begin to fail. To fix this, try spinning a Linear Spring at each wheel. Raise twice for a start. When you set up, you will notice that gravity during jumps is stronger (though I set the jump momentum to pretty high by default). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now that you‚Äôve already gotten wet while setting up this moody cart, it‚Äôs time to drop the shackles of firts_person_controller and look at what is happening from the side of the machine itself, with a third-person camera. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Downloaded disable first_person_controller (click on the box next to his name so that it becomes empty).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create a camera. </font><font style="vertical-align: inherit;">To do this, right-click on the scene and select Create&gt; Camera&gt; Presecutor. </font><font style="vertical-align: inherit;">The PlayerPresecutor camera itself and its dummy target Presecutor_Target will appear. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The dummy can be turned off. </font><font style="vertical-align: inherit;">We click on the camera itself, be sure to check the Main Player checkbox in its properties (so as not to get a black screen at startup). </font><font style="vertical-align: inherit;">In the Target Node field we find our Cuboid in the drop-down list. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Save and click Play. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can fully ride. </font><font style="vertical-align: inherit;">True, the camera can fly quite far. </font><font style="vertical-align: inherit;">To fix this, you need to adjust its limits. </font><font style="vertical-align: inherit;">We return to the editor and set in the camera properties, for example, Min Distance 10 and Max Distance 30.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neungers in the Unigine engine</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having learned to collect approximate wheel physics, I made a test scene with a bio-mechos model from my Nevanger project. </font><font style="vertical-align: inherit;">Here's what it looks like at the moment:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/2LRuL-i9MF8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshots</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/0u/-i/hp/0u-ihp26nyuwqnqhxxmd2pkicdu.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/bu/z4/oa/buz4oajcy-reimur3him3_wn-ya.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/5a/wy/dp/5awydpmdbzfbmjisfxveew-g2nw.jpeg"><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main problems at the moment are some instability of the design. Which is again due to the fact that I have not yet thoroughly understood all the aspects and nuances of the settings. Sometimes the machine stumbles about something and starts to rotate fiercely. Reducing Linear Damping doesn‚Äôt seem to help much, twisting the other parameters as well, although I haven‚Äôt twisted or configured something yet, but it‚Äôs not comprehensive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another bug - there are situations with total stuck in the floor, when the front wheels stick up, and the rear under the landscape. Or punching through the landscape itself at high speed, followed by flying away under it. All this, apparently, is corrected by setting tolerances and iterations, but so far has not found the optimal values.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, on a fairly flat surface, the movement is already more adequate. </font><font style="vertical-align: inherit;">It‚Äôs not clear how well Wheel Joints behave on an uneven surface ideally, as I understood in the video demos of the engine for cars they used outdated (seemingly), but more physically ‚Äúhonest‚Äù Suspension Joints (by the way, I didn‚Äôt try to assemble a machine on them, maybe , everything is somewhat easier there). </font><font style="vertical-align: inherit;">Do Wheel Joints take into account the friction parameters of the landscape, or they are only interested in whether the physics flag is turned on.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">General impressions of the engine</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As for working with the editor, what happened most reminded me of the process of working with CryEngine. Although in some places it‚Äôs more convenient. But it‚Äôs like someone, in the same CryEngine it was possible to model directly in the editor. This is not relevant for me, because for this I use Blender, where you have orders of magnitude more control over the model, and for someone it may be important. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the picture below, a list of materials is visible on the left. Meshes are painted through a group of mesh based materials, from which you can clone your material options. Painting terrane with a texture is already more difficult, but using masks to the full - you can mix textures, height maps, and so on, if you understand the device. For the same water, there is its own separate group of materials, it is added literally in one click and looks pretty good.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the right is the hierarchy of scene objects and the properties window. </font><font style="vertical-align: inherit;">It‚Äôs a little inconvenient to manipulate numerical values ‚Äã‚Äãon the fly - you need to get into the icon with small arrows. </font><font style="vertical-align: inherit;">Some sliders are initially misleading, because they do not show the entire possible range of the parameter, but, say, only the interval from 0 to 1. The flight speed of the camera is regulated in the field with a running man on top, by default it somehow moves slowly, judging by the sensations . </font><font style="vertical-align: inherit;">Perhaps this is more convenient when you work with models on a real scale.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s0/1o/v1/s01ov1bzrei4oabsjfjequkpzvo.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en502518/index.html">How to climb a tree</a></li>
<li><a href="../en502520/index.html">Video reports of mitap reports on product analytics</a></li>
<li><a href="../en502522/index.html">We open the galvanic isolation chip with a tiny transformer inside</a></li>
<li><a href="../en502554/index.html">Middle information technology as a way out of crisis</a></li>
<li><a href="../en502556/index.html">Microsoft Build 2020 conference - completely online today (look directly at Habr√©)</a></li>
<li><a href="../en502560/index.html">Just say no to end-2-end tests</a></li>
<li><a href="../en502562/index.html">Unusual industrial router applications</a></li>
<li><a href="../es486176/index.html">Memo de correspondencia de correo electr√≥nico corporativo</a></li>
<li><a href="../es486178/index.html">FOSS News No. 1 - revisi√≥n de noticias gratuitas y de c√≥digo abierto del 27 de enero al 2 de febrero de 2020</a></li>
<li><a href="../es486180/index.html">Consejos y fuentes para crear aplicaciones sin servidor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>