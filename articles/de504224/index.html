<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ½â€ğŸŒ¾ ğŸ­ ğŸ° Wie haben wir den starken Anstieg der x10-Last auf dem Remote-Standort Ã¼berstanden und welche Schlussfolgerungen haben wir gezogen? ğŸš” ğŸ›¬ ğŸ¤›ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! In den letzten Monaten haben wir in einer sehr interessanten Situation gelebt, und ich mÃ¶chte unsere Geschichte der Infrastrukturskalierun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wie haben wir den starken Anstieg der x10-Last auf dem Remote-Standort Ã¼berstanden und welche Schlussfolgerungen haben wir gezogen?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sbermarket/blog/504224/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr! </font><font style="vertical-align: inherit;">In den letzten Monaten haben wir in einer sehr interessanten Situation gelebt, und ich mÃ¶chte unsere Geschichte der Infrastrukturskalierung teilen. </font><font style="vertical-align: inherit;">In dieser Zeit wuchs der Auftragseingang von SberMarket um das Vierfache und startete einen Service in 17 neuen StÃ¤dten. </font><font style="vertical-align: inherit;">Aufgrund des explosionsartigen Anstiegs der Nachfrage nach Lebensmittellieferungen mussten wir unsere Infrastruktur skalieren. </font><font style="vertical-align: inherit;">Lesen Sie die interessantesten und nÃ¼tzlichsten Ergebnisse unter der Katze.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/el/ry/lnelryyy8ylmld9qzjuwsdfrafo.gif"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mein Name ist Dima Bobylev, ich bin der technische Direktor von SberMarket. </font><font style="vertical-align: inherit;">Da dies der erste Beitrag in unserem Blog ist, sage ich ein paar Worte Ã¼ber mich und das Unternehmen. </font><font style="vertical-align: inherit;">Im vergangenen Herbst nahm ich am Wettbewerb der jungen AnfÃ¼hrer der Runet teil. </font><font style="vertical-align: inherit;">FÃ¼r den Wettbewerb habe ich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine kurze Geschichte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> darÃ¼ber geschrieben, wie wir bei SberMarket die interne Kultur und Herangehensweise an die Entwicklung des Dienstes sehen. </font><font style="vertical-align: inherit;">Und obwohl es nicht mÃ¶glich war, den Wettbewerb zu gewinnen, habe ich mir die Grundprinzipien fÃ¼r die Entwicklung des IT-Ã–kosystems formuliert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Leitung eines Teams ist es wichtig, die Anforderungen des Unternehmens und die Anforderungen der einzelnen Entwickler zu verstehen und in Einklang zu bringen. Jetzt wÃ¤chst SberMarket 13 Mal von Jahr zu Jahr. Dies wirkt sich auf das Produkt aus und erfordert eine konstante Steigerung des Volumens und des Entwicklungstempos. Trotzdem widmen wir den Entwicklern genÃ¼gend Zeit fÃ¼r vorlÃ¤ufige Analysen und qualitativ hochwertiges Schreiben von Code. Der gebildete Ansatz hilft nicht nur bei der Schaffung eines funktionierenden Produkts, sondern auch bei seiner weiteren Skalierung und Entwicklung. Infolge dieses Wachstums hat sich SberMarket bereits zu einem fÃ¼hrenden Anbieter von Lieferservices fÃ¼r Lebensmittel entwickelt: Wir liefern tÃ¤glich etwa 18.000 Bestellungen, obwohl es Anfang Februar etwa 3.500 Bestellungen gab. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7v/jy/m7/7vjym762x2sa2ehkkvlwtzgi-og.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einmal bat ein Kunde den SberMarket-Kurier, ihm Produkte kontaktlos zu liefern - direkt auf den Balkon</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber gehen wir weiter zu den Einzelheiten. </font><font style="vertical-align: inherit;">In den letzten Monaten haben wir die Infrastruktur unseres Unternehmens aktiv skaliert. </font><font style="vertical-align: inherit;">Ein solcher Bedarf wurde durch externe und interne Faktoren erklÃ¤rt. </font><font style="vertical-align: inherit;">Gleichzeitig mit der Erweiterung des Kundenstamms stieg die Anzahl der verbundenen Filialen von 90 zu Jahresbeginn auf Ã¼ber 200 bis Mitte Mai. </font><font style="vertical-align: inherit;">NatÃ¼rlich haben wir die Hauptinfrastruktur vorbereitet, reserviert und mit der MÃ¶glichkeit der vertikalen und horizontalen Skalierung aller virtuellen Maschinen in der Yandex-Cloud gerechnet. </font><font style="vertical-align: inherit;">Die Praxis hat jedoch gezeigt: "Alles, was schief gehen kann, geht schief." </font><font style="vertical-align: inherit;">Und heute mÃ¶chte ich die interessantesten Situationen teilen, die in diesen Wochen passiert sind. </font><font style="vertical-align: inherit;">Ich hoffe, unsere Erfahrung wird Ihnen nÃ¼tzlich sein.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sklave in voller Alarmbereitschaft</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Noch bevor die Pandemie begann, waren wir mit einer Zunahme der Anfragen an unsere Backend-Server konfrontiert. Die Tendenz, Produkte mit Lieferung nach Hause zu bestellen, gewann zunehmend an Bedeutung, und mit der EinfÃ¼hrung der ersten SelbstisolierungsmaÃŸnahmen im Zusammenhang mit COVID-19 stieg die Belastung den ganzen Tag vor unseren Augen dramatisch an. Die Master-Server der Hauptdatenbank mussten schnell entladen und ein Teil der Leseanforderungen an die Replikatserver (Slaves) Ã¼bertragen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns im Voraus auf diesen Schritt vorbereitet und fÃ¼r ein solches ManÃ¶ver waren bereits 2 Slave-Server gestartet worden. Sie arbeiteten hauptsÃ¤chlich an Batch-Aufgaben zur Generierung von Informations-Feeds fÃ¼r den Datenaustausch mit Partnern. Diese Prozesse verursachten eine zusÃ¤tzliche Belastung und wurden zu Recht einige Monate zuvor â€auÃŸerhalb der Klammernâ€œ platziert.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da es auf Slave eine Replikation gab, haben wir uns an das Konzept gehalten, dass Anwendungen nur im schreibgeschÃ¼tzten Modus mit ihnen arbeiten kÃ¶nnen. Der Disaster Recovery Plan schlug vor, dass wir im Katastrophenfall einfach den Slave anstelle des Masters einbinden und alle Schreib- und Leseanforderungen an den Slave senden kÃ¶nnten. Wir wollten jedoch auch Replikate fÃ¼r die Anforderungen der Analyseabteilung verwenden, sodass die Server nicht vollstÃ¤ndig in den Status "Nur Lesen" versetzt wurden und jeder Host seine eigenen Benutzer hatte und einige Ã¼ber Schreibberechtigungen zum Speichern von Zwischenberechnungsergebnissen verfÃ¼gten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bis zu einer bestimmten Auslastung hatten wir genÃ¼gend Assistenten zum Schreiben und Lesen bei der Verarbeitung von http-Anforderungen. Mitte MÃ¤rz, als Sbermarket sich entschied, vollstÃ¤ndig auf einen Remote-Standort umzusteigen, begannen wir mit einer mehrfachen ErhÃ¶hung des RPS. Immer mehr unserer Kunden gingen zur Selbstisolierung oder zur Arbeit von zu Hause aus, was sich in den Lastindikatoren widerspiegelte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Leistung des â€Mastersâ€œ reichte nicht mehr aus, sodass wir einige der schwersten Leseanforderungen fÃ¼r ein Replikat ertragen mussten. Um Anfragen zum Schreiben an den Master und zum Lesen an den Slave transparent zu senden, haben wir den Rubinstein â€ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Octopus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">". Wir haben einen speziellen Benutzer mit dem Postfix _readonly ohne Schreibberechtigung erstellt. Aufgrund eines Fehlers in der Konfiguration eines der Hosts ging ein Teil der Schreibanforderungen im Auftrag eines Benutzers mit den entsprechenden Rechten an den Slave-Server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem manifestierte sich nicht sofort, weil Eine erhÃ¶hte Last erhÃ¶hte die Slave-VerzÃ¶gerung. Dateninkonsistenz wurde am Morgen aufgedeckt, als die Slaves nach nÃ¤chtlichen Importen den Master nicht â€einholtenâ€œ. Wir fÃ¼hrten dies auf die hohe Belastung des Dienstes selbst und den Import zurÃ¼ck, der mit der EinfÃ¼hrung neuer GeschÃ¤fte verbunden ist. Es war jedoch inakzeptabel, Informationen zu den vielen Stunden VerzÃ¶gerung zu geben, und wir wechselten zu den zweiten </font><font style="vertical-align: inherit;">Analyseprozessen </font><font style="vertical-align: inherit;">, die der Slave verwendet hatte, weil er </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fÃ¼r</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lshie-Ressourcen verwendet hatte und keine Leseanforderungen geladen hatte (und wir haben uns erklÃ¤rt, dass keine ReplikationsverzÃ¶gerung vorliegt).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als wir die GrÃ¼nde fÃ¼r das â€Kriechenâ€œ des Hauptsklaven herausfanden, schlug die Analyse aus demselben Grund bereits fehl. Trotz des Vorhandenseins von zwei zusÃ¤tzlichen Servern, auf die wir die Last im Falle eines Master-Absturzes aufgrund eines unglÃ¼cklichen Fehlers Ã¼bertragen wollten, stellte sich heraus, dass in einem kritischen Moment keine vorhanden sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir jedoch nicht nur die Datenbank (der Rest betrug zu diesem Zeitpunkt etwa 5 Stunden), sondern auch einen Snapshot-Master-Server gesichert haben, konnten wir das Replikat innerhalb von 2 Stunden starten. Zwar wurde danach erwartet, dass wir das Replikationsprotokoll fÃ¼r eine lange Zeit rollen (da sich der Prozess im Single-Thread-Modus befindet, aber dies ist eine ganz andere Geschichte).</font></font><br>
<br>
<blockquote><strong>:</strong>     ,            readonly  .      ,        .</blockquote><br>
<h3>      Â«  Â» </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl wir den Katalog auf der Site stÃ¤ndig aktualisieren, erlaubten die Anfragen, die wir an die Slave-Server stellten, eine leichte VerzÃ¶gerung vom Master. Die Zeit, in der wir das Problem des â€plÃ¶tzlichen Abbruchs von Sklavenâ€œ entdeckten und beseitigten, war mehr als eine â€psychologische Barriereâ€œ (wÃ¤hrend dieser Zeit hÃ¤tten die Preise aktualisiert werden kÃ¶nnen und die Kunden veraltete Daten gesehen hÃ¤tten), und wir mussten alle Anfragen an den Hauptdatenbankserver umschalten . Infolgedessen funktionierte die Site langsam ... aber zumindest funktionierte sie. Und wÃ¤hrend sich der Sklave erholte, hatten wir keine andere Wahl, als zu optimieren.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WÃ¤hrend sich die Slave-Server erholten, zogen sich die Minuten langsam hin, der Master blieb Ã¼berlastet, und wir haben alle Anstrengungen unternommen, um aktive Aufgaben gemÃ¤ÃŸ der Pareto-Regel zu optimieren: Wir haben die TOP-Anforderungen ausgewÃ¤hlt, die den grÃ¶ÃŸten Teil der Last liefern, und mit der Optimierung begonnen. Dies geschah direkt "on the fly".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein interessanter Effekt war, dass MySQL, das in den Augapfel geladen wurde, sogar auf eine leichte Verbesserung der Prozesse reagiert. </font><font style="vertical-align: inherit;">Die Optimierung eines Anforderungspaars, das nur 5% der Gesamtlast ergab, zeigte bereits eine spÃ¼rbare CPU-Entladung. </font><font style="vertical-align: inherit;">Infolgedessen konnten wir dem Master eine akzeptable Bereitstellung von Ressourcen zur VerfÃ¼gung stellen, um mit der Datenbank zu arbeiten und die erforderliche Zeit fÃ¼r die Wiederherstellung von Replikaten zu erhalten.&nbsp;</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schon eine kleine Optimierung ermÃ¶glicht es Ihnen, bei Ãœberlastung mehrere Stunden "zu Ã¼berleben". </font><font style="vertical-align: inherit;">Dies war gerade genug fÃ¼r uns bei der Wiederherstellung von Servern mit Replikaten. </font><font style="vertical-align: inherit;">Ãœbrigens werden wir die technische Seite der Abfrageoptimierung in einem der folgenden BeitrÃ¤ge diskutieren. </font><font style="vertical-align: inherit;">Abonnieren Sie also unseren Blog, wenn dies fÃ¼r Sie nÃ¼tzlich sein kÃ¶nnte.</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisieren Sie die LeistungsÃ¼berwachung von Partnerdiensten</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bearbeiten Bestellungen von Kunden und daher interagieren unsere Dienste stÃ¤ndig mit APIs von Drittanbietern - dies sind Gateways zum Senden von SMS, Zahlungsplattformen, Routing-Systemen, Geocoder, dem Federal Tax Service und vielen anderen Systemen. Und als die Last schnell zu wachsen begann, ruhten wir uns gegen die API-EinschrÃ¤nkungen unserer Servicepartner aus, an die wir vorher noch nicht einmal gedacht hatten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein unerwarteter Ãœberschuss an Quoten fÃ¼r Affiliate-Services kann zu eigenen Ausfallzeiten fÃ¼hren. Viele APIs blockieren Clients, die die Grenzwerte Ã¼berschreiten, und in einigen FÃ¤llen kann ein ÃœbermaÃŸ an Anforderungen die Produktion mit einem Partner Ã¼berlasten.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel konnten zum Zeitpunkt der ErhÃ¶hung der Anzahl der Lieferungen die begleitenden Dienste die Aufgaben ihrer Verteilung und Bestimmung der Routen nicht bewÃ¤ltigen. Infolgedessen stellte sich heraus, dass die Bestellungen getÃ¤tigt wurden und der Dienst, der die Route erstellt, nicht funktioniert. Ich muss sagen, dass unsere Logistiker es unter diesen Bedingungen fast unmÃ¶glich gemacht haben, und die klare Interaktion des Teams hat dazu beigetragen, vorÃ¼bergehende Servicefehler auszugleichen. Es ist jedoch unmÃ¶glich, ein solches Volumen von AntrÃ¤gen manuell manuell zu bearbeiten, und nach einiger Zeit wÃ¼rden wir eine inakzeptable LÃ¼cke zwischen AuftrÃ¤gen und deren AusfÃ¼hrung feststellen.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Reihe von organisatorischen MaÃŸnahmen wurden ergriffen, und die koordinierte Arbeit des Teams trug dazu bei, Zeit zu gewinnen, wÃ¤hrend wir uns auf neue Bedingungen einigten und auf die Modernisierung der Dienstleistungen einiger Partner warteten. Es gibt andere APIs, die Ihnen mit hoher Ausdauer und gottlosen Tarifen bei hohem Datenverkehr gefallen. Am Anfang haben wir beispielsweise eine bekannte Mapping-API verwendet, um die Adresse eines Zustellpunkts zu bestimmen. Aber am Ende des Monats erhielten sie eine ordentliche Rechnung von fast 2 Millionen Rubel. Danach beschlossen sie, es schnell zu ersetzen. Ich werde keine Werbung machen, aber ich werde sagen, dass unsere Ausgaben erheblich gesunken sind.</font></font><br>
<img src="https://habrastorage.org/webt/mn/3x/qr/mn3xqrx5sj531isw8dmeoezlz1g.png"><br>
<blockquote><strong>: </strong>            .    ,    Â«  Â»,   ,        . , ,    &nbsp;      .&nbsp;</blockquote><br>
<h3> ,  Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a>Â» ()  </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sind es gewohnt, die Hauptdatenbank oder die Anwendungsserver anzuschlieÃŸen, aber beim Skalieren kÃ¶nnen Probleme auftreten, die nicht erwartet wurden. FÃ¼r die Volltextsuche auf der Site verwenden wir die Apache Solr-Engine. Mit zunehmender Auslastung stellten wir eine Verringerung der Antwortzeit fest und die Auslastung des Serverprozessors erreichte 100%. Was kÃ¶nnte einfacher sein - wir werden mit Solr mehr Ressourcen fÃ¼r den Container bereitstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstelle des erwarteten Leistungsgewinns ist der Server einfach "gestorben". Es wurde sofort zu 100% geladen und reagierte noch langsamer. Anfangs hatten wir 2 Kerne und 2 GB RAM. Wir haben uns fÃ¼r das entschieden, was normalerweise hilft - wir haben dem Server 8 Kerne und 32 GB gegeben. Alles ist viel schlimmer geworden (genau wie und warum - wir werden es in einem separaten Beitrag erzÃ¤hlen).&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mehrere Tage lang haben wir die Feinheiten dieses Problems herausgefunden und mit 8 Kernen und 32 GB eine optimale Leistung erzielt. </font><font style="vertical-align: inherit;">Diese Konfiguration ermÃ¶glicht es uns, die Last heute weiter zu erhÃ¶hen, was sehr wichtig ist, da das Wachstum nicht nur in Bezug auf die Kunden, sondern auch in Bezug auf die Anzahl der verbundenen GeschÃ¤fte erfolgt - Ã¼ber 2 Monate hat sich ihre Anzahl verdoppelt.&nbsp;</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerung:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Standardmethoden wie "mehr Eisen hinzufÃ¼gen" funktionieren nicht immer. </font><font style="vertical-align: inherit;">Wenn Sie also einen Dienst skalieren, mÃ¼ssen Sie genau wissen, wie er Ressourcen verwendet, und seinen Betrieb unter neuen Bedingungen vorab testen.&nbsp;</font></font><br>
</blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Staatenlos - der SchlÃ¼ssel zur einfachen horizontalen Skalierung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen folgt unser Team einem bekannten Ansatz: Services sollten keinen zustandslosen Status haben und unabhÃ¤ngig von der Laufzeitumgebung sein. Dies ermÃ¶glichte es uns, das Lastwachstum durch einfache horizontale Skalierung zu Ã¼berstehen. Wir hatten jedoch eine Service-Ausnahme - einen Handler fÃ¼r lange Hintergrundaufgaben. Er war damit beschÃ¤ftigt, E-Mails und SMS zu senden, Ereignisse zu verarbeiten, Feeds zu generieren, Preise und LagerbestÃ¤nde zu importieren und Bilder zu verarbeiten. Es kam vor, dass es vom lokalen Dateispeicher abhing und sich in einer einzigen Kopie befand.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Anzahl der Aufgaben in der Prozessorwarteschlange zunahm (und dies geschah natÃ¼rlich mit einer Zunahme der Anzahl der Bestellungen), wurde die Leistung des Hosts, auf dem sich der Prozessor und der Dateispeicher befinden, zu einem begrenzenden Faktor. </font><font style="vertical-align: inherit;">Infolgedessen wurden die Aktualisierung des Sortiments und der Preise, das Senden von Benachrichtigungen an Benutzer und viele andere wichtige Funktionen in der Warteschlange gestoppt. </font><font style="vertical-align: inherit;">Das Ops-Team migrierte den Dateispeicher schnell in einen S3-Ã¤hnlichen Netzwerkspeicher. Dadurch konnten wir mehrere leistungsstarke Computer fÃ¼r die Skalierung des Hintergrund-Task-Handlers einrichten.</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerung:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die staatenlose Regel muss ausnahmslos fÃ¼r alle Komponenten eingehalten werden, auch wenn es den Anschein hat, dass wir uns definitiv nicht darum kÃ¼mmern. </font><font style="vertical-align: inherit;">Es ist besser, ein wenig Zeit mit der korrekten Organisation der Arbeit aller Systeme zu verbringen, als den Code in Eile neu zu schreiben und den Ã¼berlasteten Dienst zu reparieren.</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7 Prinzipien fÃ¼r intensives Wachstum</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz der VerfÃ¼gbarkeit zusÃ¤tzlicher KapazitÃ¤ten sind wir im Wachstumsprozess auf einige Rechen getreten. </font><font style="vertical-align: inherit;">In dieser Zeit hat sich die Anzahl der Bestellungen um mehr als das Vierfache erhÃ¶ht. </font><font style="vertical-align: inherit;">Jetzt liefern wir bereits mehr als 17.000 Bestellungen pro Tag in 62 StÃ¤dten und planen, unsere Geografie noch weiter auszubauen. Im ersten Halbjahr 2020 wird der Service voraussichtlich in ganz Russland eingefÃ¼hrt. </font><font style="vertical-align: inherit;">Um der wachsenden Belastung gerecht zu werden, haben wir unter BerÃ¼cksichtigung der bereits vollen Unebenheiten 7 Grundprinzipien der Arbeit unter Bedingungen konstanten Wachstums fÃ¼r uns entwickelt:</font></font><br>
<br>
<ol>
<li><strong>-</strong>.     Jira,   &nbsp;    .          .       â€”         .   ,    ,    ,      ,         .</li>
<li><strong> </strong>      .            Â« Â»   .  ,        ,      .           ,     .</li>
<li><strong> </strong>      . -,        . -,     ,           .</li>
<li><strong>   stateless. </strong>   ,        .      .          , ,   S3.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> https://12factor.net</a>.         ,             .</li>
<li><strong>    . </strong>          ,     .  ,       ,  -    .         ,    .&nbsp;</li>
<li><strong>   . </strong>  ,       .         ,      SMS       .        ,     .</li>
<li><strong> .</strong>      ,       .     , ,    .       API,    -.      .</li>
</ol><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nicht ohne Verluste, aber wir haben diese Phase Ã¼berstanden, und heute versuchen wir, alle gefundenen Prinzipien einzuhalten, und jede Maschine kann die x4-Leistung leicht steigern, um Ãœberraschungen zu bewÃ¤ltigen.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den folgenden BeitrÃ¤gen werden wir unsere Erfahrungen bei der Untersuchung der Leistungssenkung in Apache Solr teilen sowie Ã¼ber die Optimierung von Abfragen und darÃ¼ber sprechen, wie die Interaktion mit dem Federal Tax Service dem Unternehmen hilft, Geld zu sparen. </font><font style="vertical-align: inherit;">Abonnieren Sie unseren Blog, damit Sie nichts verpassen, und teilen Sie uns in den Kommentaren mit, ob Sie wÃ¤hrend des wachsenden Verkehrs solche Probleme hatten.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/ky/jx/iakyjxz9atsneo1adhjxi_qpwyi.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de504214/index.html">Die Entwicklung von DATA VAULT und der Ãœbergang zu BUSINESS DATA VAULT</a></li>
<li><a href="../de504216/index.html">Wie alt ist dieses Haus? Wie ich eine Karte des Zeitalters der HÃ¤user in St. Petersburg gemacht habe</a></li>
<li><a href="../de504218/index.html">ProduktivitÃ¤t, Praktikanten, Senioren und Geistesverlust im Silicon Valley. Zuckerbergs groÃŸartiges Interview Ã¼ber Fernarbeit</a></li>
<li><a href="../de504220/index.html">Server HTTP Header Verification Service</a></li>
<li><a href="../de504222/index.html">Wasserstoff ist der Kopf von allem: Wie Energie aus PlastikabfÃ¤llen fÃ¼r ein japanisches Hotel erzeugt wird</a></li>
<li><a href="../de504226/index.html">Die Zusammenfassung der Ereignisse fÃ¼r Personal- und IT-Personalvermittler im Juni 2020</a></li>
<li><a href="../de504228/index.html">RangeAmp - Eine neue SicherheitsanfÃ¤lligkeit ermÃ¶glicht DDoS-Angriffe mit einem VerstÃ¤rkungsfaktor von Zehntausenden</a></li>
<li><a href="../de504230/index.html">NextDNS aus der Beta - Datenschutz, Umgehung der staatlichen Zensur und Blockierung von Werbung fÃ¼r das gesamte Heimnetzwerk</a></li>
<li><a href="../de504232/index.html">Wie ein Ingenieur zu Techlida heranwÃ¤chst</a></li>
<li><a href="../de504236/index.html">Stellen Sie Docker Image mit Ansible in Dokku bereit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>