<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍💼 👩🏾‍🤝‍👩🏽 👺 異種混合プログラミングと1つのAPIツールキット。インテルの専門家による即興講義があなたの質問に答えます ↔️ 🈸 👎🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="「インテルのエキスパートに質問する」列の一部として、私たちは一流のインテルスペシャリストであるコンスタンティンウラジミロフに、異種混合プログラミング、oneAPIツールキット、および関連する興味深いことに関連する質問に回答するように依頼しました。結果は私たちのすべての期待を上回りました。コンスタンチ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>異種混合プログラミングと1つのAPIツールキット。インテルの専門家による即興講義があなたの質問に答えます</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/479486/"><img src="https://habrastorage.org/webt/tz/b5/gv/tzb5gvt-1m1z3yvd4tjzot84ao4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「インテルのエキスパートに質問する」列の一部として、私たちは一流のインテルスペシャリストであるコンスタンティンウラジ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミロフに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、異種混合プログラミング、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://"><font style="vertical-align: inherit;">oneAPIツールキット</font></a><font style="vertical-align: inherit;">、および関連する興味深いことに</font><font style="vertical-align: inherit;">関連する質問に回答するように依頼しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">結果は私たちのすべての期待を上回りました。</font><font style="vertical-align: inherit;">コンスタンチンは時間を無駄にせず、論争になることを恐れずに詳細で根拠のある答えを出しました。</font><font style="vertical-align: inherit;">実際、オフアーキテクチャのニュアンス、最適化、標準など、すべての形式のクロスアーキテクチャプログラミングに関する簡単な講義を受けました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイクを専門家に転送します。</font><font style="vertical-align: inherit;">さて、コメントは聴衆に与えられます。</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 質問 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soarex16</font></font></a> <br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCLからoneAPIへの移行はどれほど面倒で、これからどのようなメリットが得られますか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DPC ++への切り替えは難しい場合がありますが、私の意見では、それだけの価値があります。 2つの主要な段階があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、これは、APIに基づく可能性が最も高い異種プログラミング言語（OpenCL、Vulkanコンピューティング）からの移行です。ここで、あなたはすでにサブジェクト領域を知っているという事実で有利なスタートを切っており、難しいのは、APIによる直接制御からやや暗黙的な言語構成に思考を切り替えることです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、これはホスト言語からの移行です。純粋なCから人生全体をオフロードしている場合、入力しきい値はCからC ++に切り替えるためのしきい値と等しく、非常に高いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どうして？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、DPC ++はプログラマーにとって素晴らしい仕事です。悪夢のように、clXXXYYYへのこれらすべての明示的な呼び出し、6番目の引数の意味、および戻りコードを忘れたかどうかをすぐに忘れてしまいます。多くのオブジェクト指向のラッパーはルーチンを隠蔽しますが、通常は標準のOpenCL APIからそれほど標準的でないラッパーAPIに切り替えます（これらのバイクも見ました）。 DPC ++の場合は、Intel拡張機能を備えた標準SYCLを記述するだけです（これはまもなく標準SYCLにもなる可能性があります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二に、DPC ++は共同コンパイルを提供します。つまり、型を確認でき、寸法、パディング、配置を使用してAPIの境界で問題が発生しません。</font><font style="vertical-align: inherit;">カーネルとホストのコードを同じファイルに記述しますが、これは同じコードです。</font><font style="vertical-align: inherit;">USMを使用すると、複雑なデータ構造をはるかに簡単に操作することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第3に、DPC ++は実際のC ++です。つまり、汎用的なプログラミングが可能です。</font><font style="vertical-align: inherit;">たとえば、2つのベクトルを追加するための最も単純なカーネル：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> kern = [A, B, C](cl::sycl::id&lt;<span class="hljs-number">1</span>&gt; wiID) {<font></font>
  C[wiID] = A[wiID] + B[wiID]; <span class="hljs-comment">//   A, B  C?  !</span>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCLでも同じこと：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">_kernel <span class="hljs-keyword">void</span> <span class="hljs-title">vector_add</span><span class="hljs-params">(__global <span class="hljs-keyword">int</span> *A, __global <span class="hljs-keyword">int</span> *B, __global <span class="hljs-keyword">int</span> *C)</span> </span>{
  <span class="hljs-keyword">int</span> i = get_global_id(<span class="hljs-number">0</span>);<font></font>
  C[i] = A[i] + B[i]; }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほら、私はOpenCLタイプのintをポイントすることを余儀なくされました。</font><font style="vertical-align: inherit;">フロートが必要な場合は、別のカーネルを作成するか、プリプロセッサまたは外部コード生成を使用する必要があります。</font><font style="vertical-align: inherit;">C ++の経験がないと、C ++のほぼすべての機能を自由に使えるようになるのは少し恐ろしいことがあります。</font><font style="vertical-align: inherit;">しかし、これは大きな技術的シフトに関してはよくあることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、すべてのメリットはこれに限定されません。</font><font style="vertical-align: inherit;">以下の回答で別のことを述べます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">OneAPI</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
パッケージで</font><font style="vertical-align: inherit;">これを行うのは難しくない</font><font style="vertical-align: inherit;">ので、私はあなたの代わりにコンパイラをダウンロードして試してみました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">質問</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジャスター</font></font></a><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenVINOとoneAPIはどういうわけか関連していますか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenVINOディストリビューションはOneAPIディストリビューションの一部になりました。ニューラルネットワークの学習と使用は、計算の難しいタスクであり、異種混合プログラミングから大きな恩恵を受けます。遅かれ早かれ、OneAPIコンポーネントはすべて、利用可能なすべてのコンピューティングリソース（グラフィックアクセラレータとNervanaやFPGAなどの特別なアクセラレータの両方）を使用できるようになると思います。そして、C ++プログラムの言語パラダイムと型システムを離れることなく、これらすべてが可能になります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールからの質問</font></font><br>
<blockquote> ,    AI hardware accelerator  3 ,    .    Graphcore   IPU —     ,  FPGA,      — Python   TensorFlow   . , ,   Graphcore  ,   FPGA       ..  datascientists Python  ,  C++. <br>
   ,  FPGA       Python     ?   ML ,     FPGA  ? <br>
        ,        Python?</blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どんなIPUなのか一目見ました。全員が荷降ろしするもう1つの鉄片。これらの人たちは、FPGAとではなく、GPUと特別なアクセラレータと競合します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特殊なハードウェアが研ぎ澄まされるタスクでは、FPGAを常に上回ります。たとえば、ビデオカードでのビデオのレンダリングの方が優れています。しかし、世界（MLの世界を含む）には、特別なものは何も発明またはリリースされていない多くのタスクがあり、FPGAは常に不可欠です。たとえば、価格の問題があり、安価であるためには、専用のハードウェアを大量にする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、指定されたIPUが本当にすばらしいと仮定します。これは異種プログラミングをキャンセルしません、逆に、そのような優れたアクセラレータの存在はそれを刺激します。また、遅かれ早かれ誰かが「1つのプログラムでIPUとGPUの両方を使用したい」と言うため、OneAPIとDPC ++で大きなスタートを切ることにもなります。ヘテロジニアスプログラミングはそのためです。その意味は、適切なデバイスへの適切なタスクのオフロードです。タスクはどこからでも実行できます。また、このデバイスは何でもかまいません。プログラムが実行されているデバイスと同じデバイスでもかまいません。たとえば、ISPCで記述されたカーネルをオフロードし、Xeonのベクトル機能を最大限に利用する場合、それを自分でオフロードしても、大きな利益を得ることができます。ここでの主な基準はパフォーマンスです。まあ、この世界では生産性が高すぎることは決してありません。世界最高の加速器でも。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonとその便利さについては...私は動的に型付けされた言語が好きではないことをすぐに認めなければなりません。それらは遅く、通常のコンパイルエラーの代わりに、間違った型のためにランタイムに入る前に2時間待たなければなりません。</font><font style="vertical-align: inherit;">しかし、Pythonから同じオフロードを行うことがいかに悪いかはわかりません。</font><font style="vertical-align: inherit;">ちなみに、OneAPIにはすでにIntel Distribution for Pythonが含まれており、さまざまなレビューに非常に便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、Python愛好家の夢の世界では、プログラムを記述して、ベンダー固有のライブラリの束ではなく、OneAPIを使用して見つけられるすべてのアクセラレータにオフロードします。</font><font style="vertical-align: inherit;">別のことは、このアプローチでは、エンドツーエンドのタイピングを逃して、APIベースのプログラミングの非常に信頼性の低い世界に戻るということです。</font><font style="vertical-align: inherit;">おそらく、DPC ++の開発により、コミュニティはC ++などのより適切なツールをより積極的に使用するようになるでしょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> メールからの質問</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCLに対するパフォーマンス。</font><font style="vertical-align: inherit;">贅沢には税金がかかるに違いありません。</font><font style="vertical-align: inherit;">オーバーヘッド。</font><font style="vertical-align: inherit;">測定値はありますか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターネットでは、コンパイラ、タスク、実装の品質に応じて、さまざまな結果を伴う多数の測定結果を見つけることができます。</font><font style="vertical-align: inherit;">個人的な調査として、ラップトップ（統合されたSkylakeグラフィック）で単純なタスク（SGEMM、DGEMM）を測定しましたが、これまでのところ、ある程度のドローダウン（パーセント以内）があることがわかりました。</font><font style="vertical-align: inherit;">しかし、これはこれまでのところすべてベータ版であるという事実の結果であるように私には思えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理論的には、結果は減速ではなく加速でなければなりません。つまり、原則として、このすべての贅沢は負の値を持つ必要があります。それはすべてコンパイラに関するものです。プログラムが単一のソースで構成され、単一のプログラムとして処理される場合、コンパイラーは、最適化のための素晴らしい、信じられないほどの機会を手に入れます。遅かれ早かれ、彼女は間違いなく単一のソースモデルで学習します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、DPC ++は開発時間の面でマイナスのコストになります。簡単な例はSYCLアクセサーです。これは、コンパイラーがすでにイベントを調整し、非同期キューを管理するために使用しています。</font></font><br>
<br>
<pre><code class="cpp hljs">deviceQueue.submit([&amp;](cl::sycl::handler &amp;cgh) {
  <span class="hljs-keyword">auto</span> A = bufferA.<span class="hljs-keyword">template</span> get_access&lt;sycl_read&gt;(cgh);
  <span class="hljs-keyword">auto</span> B = bufferB.<span class="hljs-keyword">template</span> get_access&lt;sycl_read&gt;(cgh);
  <span class="hljs-keyword">auto</span> C = bufferC.<span class="hljs-keyword">template</span> get_access&lt;sycl_write&gt;(cgh);<font></font>
....<font></font>
deviceQueue.submit([&amp;](cl::sycl::handler &amp;cgh) {<font></font>
  <span class="hljs-keyword">auto</span> A = bufferA.<span class="hljs-keyword">template</span> get_access&lt;sycl_read&gt;(cgh);
  <span class="hljs-keyword">auto</span> B = bufferB.<span class="hljs-keyword">template</span> get_access&lt;sycl_read&gt;(cgh);
  <span class="hljs-keyword">auto</span> D = bufferD.<span class="hljs-keyword">template</span> get_access&lt;sycl_write&gt;(cgh);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでコンパイラーは、両方のパッケージがAとBを読み取り、独立したバッファーCとDを書き込むだけであることを確認します。その結果、十分なグローバルサイズがある場合、それらを並行して送信できることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、徹底的に書かれたOpenCLプログラムも同様にそれを行うことができますが、重要なカーネルで費やされた開発時間は比較できません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールからの質問</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCLアプリケーションをDPC ++用に最適化するすべての方法は関連していますか？</font><font style="vertical-align: inherit;">それらに追加される新機能は何ですか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルライターによって行われている微妙な手動による最適化のほとんどは、コンパイラーによって行うことができ、またそうすべきです。同じように、たとえば、インラインアセンブラをC ++プログラムに手動でインストールすることは有害な慣習だと私は考えています。なぜなら、それが戦術的な利益をもたらしたとしても、最適化を妨げ、製品の開発と転送のマイナス要因として機能するからです。さて、OpenCLはアセンブラーにもなりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より詳細な回答については、ここで奈落の底が怖いです。たとえば、よく知られているIntelのドキュメント「OpenCL Developer Guide for Intel Processor Graphics」があります。また</font><font style="vertical-align: inherit;">、過剰な同期を行わないようにするための方法についての</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ですから、私の見解では、これは原則として非人間的な仕事です。</font><font style="vertical-align: inherit;">人々はマルチスレッド同期についての推論が非常に下手であり、同期を控えめにまたは誤って、またはその両方を同時に作成する傾向があります-私はこのようにコンマを挿入します（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ただし、修正しました-編集後記</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、DPC ++では、次のように明示的なバリアを使用してコードを記述するのではなく、</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt; numTiles; t++) {
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> tiledRow = TS * t + row;
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> tiledCol = TS * t + col;<font></font>
    Asub[col][row] = A[globalRow * AY + tiledCol];<font></font>
    Bsub[col][row] = B[tiledRow * BY + globalCol];<font></font>
<font></font>
    <span class="hljs-comment">// Synchronise to make sure the tile is loaded</span><font></font>
    barrier(CLK_LOCAL_MEM_FENCE);<font></font>
<font></font>
    <span class="hljs-comment">// .... etc ....</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの</font><font style="vertical-align: inherit;">場合、その</font><i><font style="vertical-align: inherit;">グループ</font></i><font style="vertical-align: inherit;">内</font><font style="vertical-align: inherit;">で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parallel_for_work_groupの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明示的な反復を記述します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。parallel_for_work_item</font></font></i><br>
<br>
<pre><code class="cpp hljs">cgh.parallel_for_work_group&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mxm_kernel</span>&gt;(
  <span class="hljs-title">cl</span>:</span>:sycl::range&lt;<span class="hljs-number">2</span>&gt;{BIG_AX / TS, BIG_BY / TS},<font></font>
  cl::sycl::range&lt;<span class="hljs-number">2</span>&gt;{TS, TS}, [=](cl::sycl::group&lt;<span class="hljs-number">2</span>&gt; group) {
    <span class="hljs-comment">// .... etc ....</span><font></font>
<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> t = <span class="hljs-number">0</span>; t &lt; numTiles; t++) {<font></font>
      group.parallel_for_work_item([&amp;](cl::sycl::h_item&lt;<span class="hljs-number">2</span>&gt; it) {
        <span class="hljs-comment">// .... etc ....</span><font></font>
        Asub[col][row] = A[globalRow][tiledCol];<font></font>
        Bsub[col][row] = B[tiledRow][globalCol];<font></font>
      });<font></font>
<font></font>
   <span class="hljs-comment">//      ,   </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、同期を設定する必要がまったくなく、セクション全体を破棄できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、あなたはすべてのセクションを歩くことができます。</font><font style="vertical-align: inherit;">何かが生き残り、何かが去ります。</font><font style="vertical-align: inherit;">すべて本当に作業技術は以降のみと血で開発されているので、私は、新しい文書「DPC ++の最適化」の出現を予見したが、時間が通過しなければならない。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">質問のメールから</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCLには制限があります。たとえば、カーネルで「遠距離データ」を使用することはできません。たとえば、OpenCLワーキンググループより大きいピクセルの大きなグループからの入力データを1回の計算で使用する「ワイドフィルター」を実装します。</font><font style="vertical-align: inherit;">この点に関してDPC ++は何を提供していますか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まあ、それは不可能です。もちろん、特にカーネルを書くわけではありませんが、すべてのグローバルメモリをそのまま使用できることは間違いありません。必要なのは、アトミック操作で作業する（または階層カーネルを外部で同期する）ことだけです。また、システムSVMを接続することもできます（まあ、またはDPC ++のUSM）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
悲しいかな、これらすべては非常に非効率的であり、私はこれらすべてのトリックが好きではありません。さらに、コンパイラーによる最適化は困難です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、直接かつ効果的なソリューションについて説明する場合、もちろん、DPC ++には魔法はありません。結局のところ、プログラムは依然としてホストコードとデバイスコードの部分に分割されており、すべてのデバイス制限がデバイスコードに影響します。ワーキンググループの最大サイズは、ハードウェアで可能な実際の並列処理です。その上にあるのは、外に出るための方法にすぎず、パフォーマンスに劇的な悪影響を及ぼします。 DPC ++がこれを行う機会を提供するのはそのためです</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。device.get_info&lt;sycl :: info :: device :: max_work_group_size&gt;（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、結果の数値をどのように使用するかを決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、DPC ++でモデルを作成するのは魅力的です。プログラマーが任意の長さのループで好きなように作業し、コンパイラーが次に何をすべきかを検討するときですが、定数を隠したり、複雑さを追加したりするため、致命的に間違っています。どこからともなく現れるコンピューティング。別の理由で、Alexandrescuは「複雑さのカプセル化は犯罪と見なされるべきである」と書いており、これも当てはまります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズム自体を修正すると役立つ場合があります。ここでDPC ++を使用すると、構造化されたコードのリファクタリングが容易になるため、物事が簡単になります。しかし、これはまあまあの慰めです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールからの質問</font></font><br>
<blockquote>DPC++   SYCL.  ,     ,    OpenCL   back end,    . ,       –  ,    OpenCL?</blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたが内面に入るならば、これはOpenCLです。 SYCLのすべての利点と長所は、言語、つまりフロントエンドの利点と長所です。 OpenCLがフロントエンドから最適化されるのと同じ方法で、フロントエンドからバックエンドに行き、そこで（多くの場合、実行時にすでに、つまりJITである場合が多い）最適化された古き良きSPIRVがすでにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つは、異種デバイス間で作業を分散するメカニズムは、何をどこに送信するかを決定するホストコードであるため、バックエンドよりもフロントエンドのほうが多いということです。また、ホストコードはDPC ++から取得されます。アクセサーに基づいて、コンパイラーがパッケージの並列化を決定する方法をもう少し高い例をすでに示しました。そして、これは氷山の一角にすぎません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールからの質問</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図書館 </font><font style="vertical-align: inherit;">はい、CUDAについて話していません。</font><font style="vertical-align: inherit;">しかし、CUDA開発者にとっては、GPUで高性能で動作する非常に便利なライブラリがあることはわかっています。</font><font style="vertical-align: inherit;">OneAPIにはいくつかのライブラリも含まれていますが、たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -oneAPI / OpenCLで画像を操作するためのアーカイブに役立つものはありません。</font><font style="vertical-align: inherit;">何かありますか？この場合、CUDAからoneAPIに切り替える方法は？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CUDAから単一のオープンスタンダードへの移行は困難ですが、避けられません。</font><font style="vertical-align: inherit;">もちろん、CUDAはより成熟したインフラストラクチャを備えています。</font><font style="vertical-align: inherit;">しかし、そのライセンスの機能はブロッキングの欠点です。なぜなら、より多くのプレイヤーが異機種システムの市場に登場し、異なるメーカーのますます興味深いカードとアクセラレータが登場するからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既存のAPIの多様性により、この機能の世界を使用することは、クラシックなCPU経験を持つプログラマーにとって困難です。これはOneAPIまたはそれに似たものにつながります。ここでの魔法はグラフィックスにおけるIntelの画期的なものではなく、Intelがすべての人にDPC ++への扉を開くという事実にあります。私たちはSYCL標準も所有していません。それはKhronosグループに属しており、すべてのIntel拡張機能は誰でもコミットできるKhronosの拡張機能です（そしてそこにはすべての主要なプレーヤーからの代表者がいます）。これは、ライブラリとコミュニティが表示される（すでに表示される）ことを意味し、この方向に多くの空きがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてもちろん、IPPは新しい現実に合わせて書き直されます。私はIPPとは何の関係もありませんが、DPC ++を使用することは常識であり、正気な人々がそこに座っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、より重要なのは、IPPを超えて全世界が使用する独自のライブラリを作成できるようになったのは、今が歴史の瞬間です。</font><font style="vertical-align: inherit;">オープンスタンダードが常に勝つからです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/_f/jj/pb_fjj71wjkak3kyklvojjcao5w.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールからの質問</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニングと推論ニューラルネットワークアルゴリズムの発売をNervanaとFPGAで比較すると、プログラミングとその結果の効率の違いは何ですか？</font></font></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FPGAプログラミングの詳細については何も知りません。コンパイラを書きます。しかし、私は反論の質問があります。そして、どのように比較しますか？標準的なベンチマークではスポーツマンらしくない、Nervanaはその下をなめました。しかし、何か面白いものがある場合は、FPGAが手を解き、これをNervanaに置くのは長くて高価になる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
質問自体が、シリーズの「象やクジラより強い人」からであることがわかりました。しかし、これは本当の問題ではありません。本当の質問は、象とクジラの両方を1つのカートで利用する方法ですか？まあ、または少なくとも、たとえば象が陸で引っ張って、クジラが海で引っ張るように分配してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OneAPIの場合、通常は標準C ++で同じプログラムを使用します。</font><font style="vertical-align: inherit;">そして、あなたはそれを自分で書いて、オフロードで実行することができます。</font><font style="vertical-align: inherit;">これは、あなた自身がパフォーマンスを測定および最適化できる、興味のあるタスクそのものです。</font><font style="vertical-align: inherit;">異種デバイスへの単一の標準と単一のインターフェースは、そのような問題でリンゴとリンゴを比較するためのステップになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例：「プログラミングの容易さと効率性の観点から、私のタスクの％には何が良いのですか？この部分をFPGAに配置し、これをNervanaに残すか、この部分を2つに分割して、この部分をGPU用に書き換えますか？」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、OneAPIのすべての話-それはあなたが「長い間それについてなぜ考えるか、私はすぐにそれを試してみます、それは簡単です」と言うだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まだ、簡単ではありません。</font><font style="vertical-align: inherit;">しかし、あります。</font></font><br>
<br>
<hr><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">専門家のあとがき</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ご質問ありがとうございます。</font><font style="vertical-align: inherit;">私が間違っていたり、不正確だったり、間違いを犯したりすることはあり得ます。</font><font style="vertical-align: inherit;">それは起こります、インターネットでは常に誰かが間違っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異種混合プログラミングとDPC ++に興味を持っていただけたと思います。</font><font style="vertical-align: inherit;">世界的に有名な専門家からの報告を含め、大量のレポートがある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sycl.tech</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のサイトをすべての人に推奨したい</font><font style="vertical-align: inherit;">（英語が必要）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての人に良い！</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出版社からのPS。</font><font style="vertical-align: inherit;">今回、編集委員会の全会一致の決定により、回答者に最高の質問に対する賞を授与することが決定されました。</font><font style="vertical-align: inherit;">これは公正であることに同意するでしょう。</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479466/index.html">Habraiting 2019：2019年の最高の記事の統計とランキング</a></li>
<li><a href="../ja479468/index.html">正直さとジョン・ドウの縁</a></li>
<li><a href="../ja479474/index.html">なぜスクラムではチームの自己組織化が非常に重要であり、その中にマネージャーが存在できないのか</a></li>
<li><a href="../ja479478/index.html">痛みのないJavaプラグイン</a></li>
<li><a href="../ja479482/index.html">SARIF SDKとそのエラー</a></li>
<li><a href="../ja479488/index.html">ラップトップから-Mikrotikルーターへの冗長電源を備えたホームサーバー</a></li>
<li><a href="../ja479492/index.html">OpenWhiskに基づくサーバーレスコンピューティング、パート3</a></li>
<li><a href="../ja479496/index.html">JavaScriptでのWTFタスクの解析</a></li>
<li><a href="../ja479498/index.html">線形時間がO（n²）でWindowsになる仕組み</a></li>
<li><a href="../ja479502/index.html">地球の歴史の中で最も厳しい氷河期を生き残るには？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>