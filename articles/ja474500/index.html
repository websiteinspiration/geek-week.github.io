<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔙 🖥️ ♥️ Grafanaのプラグイン開発：ぬいぐるみの歴史 ✍️ ⛄️ 🏗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは！数か月前、DevOpsProdigy KubeGrafと呼ばれるKubernetesを監視するための新しいオープンソースプロジェクトであるGrafanaプラグインを本番環境にリリースしました。プラグインのソースコードは、GitHubのパブリックリポジトリで入手できます。この記事...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Grafanaのプラグイン開発：ぬいぐるみの歴史</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/474500/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みなさん、こんにちは！</font><font style="vertical-align: inherit;">数か月前、DevOpsProdigy KubeGrafと呼ばれる</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を監視するための新しいオープンソースプロジェクトであるGrafanaプラグインを</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">本番環境にリリースしました</font></a></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">プラグインのソースコードは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubのパブリックリポジトリで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入手でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この記事では、プラグインの作成方法、使用したツール、開発プロセス中に遭遇した落とし穴についてのストーリーを紹介します。</font><font style="vertical-align: inherit;">行こう！</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート0-紹介：どうやってこれに到達したのですか？</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafan用の独自のプラグインを作成するというアイデアは、偶然に生まれました。当社は、さまざまなレベルの複雑さのWebプロジェクトを10年以上監視しています。この間、多くの専門知識、興味深い事例、さまざまな監視システムの使用経験を蓄積してきました。そして、ある時点で、「Kubernetesを監視するための魔法のツールがあるので、彼らが言うように、「設定して忘れる」」と自分自身に問いかけました。そして、このスタックの既製のソリューションとして、prometheus-operator、ダッシュボードセットkubernetes-mixin、grafana-kubernetes-appなど、さまざまな種類のツールの大規模なセットがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
grafana-kubernetes-appプラグインは私たちにとって最も興味深いオプションのように思われましたが、1年以上サポートされておらず、さらに、node-exporterとkube-state-metricsの新しいバージョンを操作する方法がわかりません。</font><font style="vertical-align: inherit;">そして、ある時点で、「しかし、私たちは自分たちで決断しないのではないか」と決めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プラグインに実装することに決めたアイデア：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「アプリケーションマップ」の視覚化：名前空間、展開などによってグループ化された、クラスター内のアプリケーションの便利な表示...;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「デプロイメント-サービス（+ポート）」形式の接続の視覚化。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスタノードによるクラスタアプリケーションの分布の視覚化。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかのソースからのメトリックと情報の収集：Prometheusおよびk8s apiサーバー。</font></font></li>
<li>    (  , ,  , ),     — health-status pod’,   ,    liveness/readyness-.</li>
</ul><br>
<h4> 1:   «  Grafana»?</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
技術的な観点から見ると、Grafanaのプラグインは角度コントローラーであり、Grafanaデータディレクトリ（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/var/grafana/plugins/&lt;your_plugin_name&gt;/dist/module.js</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">格納</font><font style="vertical-align: inherit;">され、SystemJSモジュールとしてロードできます。また、このディレクトリには、プラグインに関するすべてのメタ情報（名前、バージョン、プラグインのタイプ、リポジトリへのリンク/サイト/ライセンス、依存関係など）を含むplugin.jsonファイルが必要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/rz/kf/lnrzkf9mc6n6xcyn6iciuvak6cy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">module.ts </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/lf/mk/3x/lfmk3xekikfm-p0y-donjv3rvw4.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plugin.json</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スクリーンショットからわかるように、plugin.type = appを指定しました。 Grafanaのプラグインには3つのタイプがあるため</font><font style="vertical-align: inherit;">、</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パネル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：最も一般的なタイプのプラグイン-メトリックを視覚化するためのパネルであり、さまざまなダッシュボードを構築するために使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情報源</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：任意のデータソースへのプラグインコネクタ（たとえば、Prometheus-datasource、ClickHouse-datasource、ElasticSearch-datasource）。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Grafana内で独自のフロントエンドアプリケーションを構築し、独自のhtmlページを作成し、データソースに手動でアクセスしてさまざまなデータを視覚化できるプラグイン。また、他のタイプのプラグイン（データソース、パネル）およびさまざまなダッシュボードを依存関係として使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x_/f-/3x/x_f-3x9bj18pz5zfvmx2yzg-9gg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type = appのプラグイン依存関係の例</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラミング言語として、JavaScriptとTypeScriptの両方を使用できます（私たちはそれを選択しました）。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここ</font></a><font style="vertical-align: inherit;">で、あらゆるタイプのhello-worldプラグインの空白を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">見つける</font></a><font style="vertical-align: inherit;">ことができ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：このリポジトリには、事前にインストールおよび設定されたビルダーを備えた多数のスターターパック（Reactのプラグインの実験的な例もある）があります。 </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2：ローカル環境の準備</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プラグインで作業するには、プロメテウス、ノードエクスポート、kube-state-metrics、grafanaなどのすべてのプリインストールツールを備えたkubernetesクラスターが当然必要です。環境は迅速、簡単、自然にセットアップする必要があり、ホットリロードデータを確実にするには、Grafanaディレクトリを開発者のマシンから直接マウントする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの意見では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kubernetesを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカルで操作する最も便利な方法は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">minikube</font></a><font style="vertical-align: inherit;">です。次のステップは、prometheus-operatorを使用してPrometheus + Grafanaバンドルを確立することです。で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、この記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細プロメテウスオペレータインストールプロセスminikubeに記載されています。永続性を有効にするには、</font><i><font style="vertical-align: inherit;">persistence</font></i><font style="vertical-align: inherit;">パラメータを設定する必要があります</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">charts / grafana / values.yamlファイルで、独自のPVとPVCを追加し、それらをpersistence.existingClaimパラメーターで指定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最終的なminikube起動スクリプトは次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">minikube start --kubernetes-version=v1.13.4 --memory=4096 --bootstrapper=kubeadm --extra-config=scheduler.address=0.0.0.0 --extra-config=controller-manager.address=0.0.0.0<font></font>
minikube mount <font></font>
/home/sergeisporyshev/Projects/Grafana:/var/grafana --gid=472 --uid=472 --9p-version=9p2000.L</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート3：開発自体</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトモデル</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プラグインの実装の準備として、TypeScriptクラスとして使用するすべての基本的なKubernetesエンティティ（ポッド、デプロイメント、デーモンセット、ステートフルセット、ジョブ、cronjob、サービス、ノード、ネームスペース）について説明することにしました。</font><font style="vertical-align: inherit;">これらの各クラスは、コンストラクター、デストラクター、可視性の更新と切り替えのためのメソッドを記述する一般的なBaseModelクラスから継承します。</font><font style="vertical-align: inherit;">各クラスは、他のエンティティとのネストされた関係、たとえば、デプロイメントタイプのエンティティのポッドのリストを記述します。</font></font><br>
<br>
<pre><code class="plaintext hljs">import {Pod} from "./pod";<font></font>
import {Service} from "./service";<font></font>
import {BaseModel} from './traits/baseModel';<font></font>
<font></font>
export class Deployment extends BaseModel{<font></font>
   pods: Array&lt;Pod&gt;;<font></font>
   services: Array&lt;Service&gt;;<font></font>
<font></font>
   constructor(data: any){<font></font>
       super(data);<font></font>
       this.pods = [];<font></font>
       this.services = [];<font></font>
   }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲッターとセッターを使用して、必要なエンティティメトリックを便利で読みやすい方法で表示または設定できます。たとえば、割り当て可能なCPUノードのフォーマットされた出力は次のとおりです。</font></font><br>
<br>
<pre><code class="plaintext hljs">get cpuAllocatableFormatted(){<font></font>
   let cpu = this.data.status.allocatable.cpu;<font></font>
   if(cpu.indexOf('m') &gt; -1){<font></font>
       cpu = parseInt(cpu)/1000;<font></font>
   }<font></font>
   return cpu;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プラグインのすべてのページのリストは、依存関係セクションのpluing.jsonに最初に記述されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vs/ij/b_/vsijb_avnlpat0ukzzgikcgmh4m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各ページのブロックで、ページタイトルを指定する必要があります（それにより、スラッグに変換され、このページが使用可能になります）; </font><font style="vertical-align: inherit;">このページの操作を担当するコンポーネントの名前（コンポーネントのリストはmodule.tsにエクスポートされます）。</font><font style="vertical-align: inherit;">このページにアクセスできるユーザーの役割とサイドバーのナビゲーション設定を指定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページの操作を担当するコンポーネントで、templateUrlをインストールし、そこにマークアップ付きのhtmlファイルへのパスを渡す必要があります。</font><font style="vertical-align: inherit;">コントローラー内では、依存性注入を通じて、最大2つの重要な角度のサービスにアクセスできます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backendSrv-grafana api-serverとの相互作用を提供するサービス。</font></font></li>
<li>datasourceSrv — ,      datasource,    Grafana (,  .getAll() —     datasource’; .get(&lt;nme&gt;) —  -  datasource.</li>
</ul><br>
<img src="https://habrastorage.org/webt/hd/ss/w8/hdssw8bsserz_p6ffzvuq49xbxs.png"><br>
<br>
<img src="https://habrastorage.org/webt/ps/we/ke/pswekesfljdpxjyedl4loxyuu_4.png"><br>
<br>
<img src="https://habrastorage.org/webt/aw/hv/ks/awhvksak5uamftrs_kwvbxdo71k.png"><br>
<br>
<h4> 4: datasource</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafanaの観点から見ると、データソースは他の皆とまったく同じプラグインです。それは独自のエントリポイントmodule.jsを持ち、メタ情報plugin.jsonを含むファイルがあります。 type = appのプラグインを開発する場合、プラグインディレクトリ（dist / datasource / *）に直接格納するか、依存関係として設定できる独自のデータソースだけでなく、既存のデータソース（prometheus-datasourceなど）と対話できます。私たちの場合、データソースにはプラグインコードが付属しています。また、データソースのロジックを実装するデータソースインスタンスとデータソースコントローラーの構成ページに使用されるconfig.htmlテンプレートとConfigCtrlコントローラーも必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KubeGrafプラグインでは、ユーザーインターフェースの観点から見ると、データソースは次の機能が実装されているkubernetesクラスターのインスタンスです（ソースコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照により</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">利用可能です</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k8s api-serverからのデータ収集（名前空間「ov、デプロイメント」ovのリストを取得する...）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prometheus-datasource（特定の各クラスターのプラグイン設定で選択されています）でリクエストをプロキシし、静的ページとダッシュボードの両方でデータを使用するための応答をフォーマットします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プラグインの静的ページのデータを更新します（リフレッシュレートを設定します）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grafana-dashboards（.metriFindQuery（）メソッド）でテンプレートリストを生成するためのリクエストの処理</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/m0/dp/eg/m0dpeghprcomipkozpjqmwle888.png"><br>
<br>
<img src="https://habrastorage.org/webt/kg/il/f5/kgilf58m2_urrtf9ad9cbdqoiby.png"><br>
<br>
<img src="https://habrastorage.org/webt/zh/em/xa/zhemxa8z6uu7mf6tflfbzqbuf-m.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後のk8sクラスターとの接続をテストします。</font></font></li>
</ul><br>
<br>
<pre><code class="plaintext hljs">testDatasource(){<font></font>
   let url = '/api/v1/namespaces';<font></font>
   let _url = this.url;<font></font>
   if(this.accessViaToken)<font></font>
       _url += '/__proxy';<font></font>
   _url += url;<font></font>
   return this.backendSrv.datasourceRequest({<font></font>
       url: _url,<font></font>
       method: "GET",<font></font>
       headers: {"Content-Type": 'application/json'}<font></font>
   })<font></font>
       .then(response =&gt; {<font></font>
           if (response.status === 200) {<font></font>
               return {status: "success", message: "Data source is OK", title: "Success"};<font></font>
           }else{<font></font>
               return {status: "error", message: "Data source is not OK", title: "Error"};<font></font>
           }<font></font>
       }, error =&gt; {<font></font>
           return {status: "error", message: "Data source is not OK", title: "Error"};<font></font>
       })<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの意見では、別の興味深い点は、データソースの認証および承認メカニズムの実装です。原則として、最終的なデータソースへのアクセスを構成するための箱から出して、組み込みのGrafanaコンポーネント-datasourceHttpSettingsを使用できます。このコンポーネントを使用して、URLと基本認証/許可設定を指定することにより、httpデータソースへのアクセスを構成できます：ログインパスワード、またはクライアント証明書/クライアントキー。ベアラートークン（事実上k8sの標準）を使用してアクセスを構成する機能を実現するために、少し行う必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するには、組み込みのGrafana「プラグインルート」メカニズムを使用できます（詳細は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式ドキュメントページをご覧ください）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">データソースの設定では、grafanaプロキシサーバーによって処理されるルーティングルールのセットを宣言できます。</font><font style="vertical-align: inherit;">たとえば、個々のエンドポイントごとに、ヘッダーまたはURLにテンプレート機能を付加する可能性があり、そのデータはjsonDataおよびsecureJsonDataフィールドから取得できます（パスワードまたはトークンを暗号化された形式で格納するため）。</font><font style="vertical-align: inherit;">この例では、フォーム</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ __ proxy / api / v1 / namespacesの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストは、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;your_k8s_api_url&gt; / api / v1 / namespaces </font><font style="vertical-align: inherit;">という形式</font><font style="vertical-align: inherit;">のAuthorization：Bearerヘッダー</font><font style="vertical-align: inherit;">のURLにプロキシされ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/xt/nm/htxtnmm0hw6xg0wutfdr11kx1a4.png"><br>
<br>
<img src="https://habrastorage.org/webt/mj/z8/ra/mjz8razkuln7puiqzwuplxhfqc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然、k8s api-serverを使用するには、読み取り専用アクセス権を持つユーザーが必要です</font><font style="vertical-align: inherit;">。これ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、プラグインのソースコードに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もある作成用のマニフェストです</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート5：リリース</font></font></h4><br>
<img src="https://habrastorage.org/webt/wx/hb/bl/wxhbbl4dw6dszbcic1hhe9g5pte.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafana用の独自のプラグインを作成した後、当然それをパブリックドメインに配置する必要があります。</font><font style="vertical-align: inherit;">Grafanaにはプラグインライブラリがあり、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grafana.com / grafana / pluginsで</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入手できます</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プラグインを公式ストアで使用できるようにするには</font><font style="vertical-align: inherit;">、repo.jsonファイルに次のコンテンツを追加して、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このリポジトリで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PRを実行する必要があり</font><font style="vertical-align: inherit;">ます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/cf/nt/bkcfntnwmmnx8scgebsbtxpgjfk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
versionはプラグインのバージョンです。 、urlはリポジトリへのリンク、commitはコミットのハッシュで、これによりプラグインの特定のバージョンが利用可能になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、出口であなたはフォームの素晴らしい絵を見るでしょう：そのための</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j3/cb/ul/j3cbulols6yx4buc_ysgd9qffdo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データは自動的にあなたのReadme.md、Changelog.md、およびプラグインの説明を含むplugin.jsonファイルから取得されます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート6：結論の代わり</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リリース後、プラグインの開発を中止しませんでした。</font><font style="vertical-align: inherit;">そして今、私たちはクラスターノードのリソースの使用の正しい監視、UXを増やすための新機能の導入、クライアントとgithubのishuiの両方からプラグインをインストールした後に受け取った大量のフィードバックを取り除いています（問題を残したり、リクエストをプルした場合、私は私はとても幸せになります ：-））。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事がGrafanaなどの優れたツールを理解し、おそらく独自のプラグインを作成するのに役立つことを願っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感謝！）</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja474490/index.html">時が来ました：Coclean鼻吸引の概要</a></li>
<li><a href="../ja474492/index.html">Chatixバックエンドでマルチユーザーチャットに反応する</a></li>
<li><a href="../ja474494/index.html">Zabbix Summit 2019はどうでしたか</a></li>
<li><a href="../ja474496/index.html">HighLoad ++ 2019上のデータベース</a></li>
<li><a href="../ja474498/index.html">JavaFXチュートリアル：Hello World</a></li>
<li><a href="../ja474502/index.html">Joker 2019でのOdnoklassniki解析</a></li>
<li><a href="../ja474504/index.html">オーソドックスなバックエンド</a></li>
<li><a href="../ja474508/index.html">皮膚移植片の3Dバイオプリンティングの成果</a></li>
<li><a href="../ja474514/index.html">中国のビットコインマイニングの大物はどのように生き残るのですか</a></li>
<li><a href="../ja474516/index.html">音声アプリケーション：ロシアが気付かない10億番目の市場</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>