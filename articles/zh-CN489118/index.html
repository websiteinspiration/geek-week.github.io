<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ŒğŸ¿ ğŸ‘¨ğŸ¼â€ğŸ“ ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ã€Šå·«å¸ˆ3ã€‹æ¸²æŸ“çš„é€†å‘å·¥ç¨‹ï¼šå„ç§å¤©ç©ºæ•ˆæœ ğŸ‘´ğŸ¿ ğŸ™ğŸ» ğŸ˜“</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[åˆ†æçš„å…ˆå‰éƒ¨åˆ†ï¼šç¬¬ä¸€ï¼Œç¬¬äºŒå’Œç¬¬ä¸‰ã€‚]
 
 ç¬¬1éƒ¨åˆ†ã€‚å·äº‘
 å½“æ¸¸æˆåœ¨å¼€æ”¾ç©ºé—´ä¸­è¿›è¡Œæ—¶ï¼Œå†³å®šä¸–ç•Œä¿¡èª‰çš„å› ç´ ä¹‹ä¸€å°±æ˜¯å¤©ç©ºã€‚è€ƒè™‘ä¸€ä¸‹-å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¤©ç©ºå®é™…ä¸Šå æ®äº†æ•´ä¸ªå±å¹•çš„40-50ï¼…ã€‚å¤©ç©ºä¸ä»…ä»…æ˜¯ç¾ä¸½çš„æ¢¯åº¦ã€‚å®ƒæœ‰æ˜Ÿæ˜Ÿï¼Œå¤ªé˜³ï¼Œæœˆäº®ï¼Œæœ€åè¿˜æœ‰äº‘ã€‚
 
 å°½ç®¡å½“å‰çš„è¶‹åŠ¿ä¼¼ä¹åœ¨äºä½¿ç”¨å…‰çº¿è¡Œè¿›æ³•å¯¹äº‘è¿›è¡Œä½“ç§¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ã€Šå·«å¸ˆ3ã€‹æ¸²æŸ“çš„é€†å‘å·¥ç¨‹ï¼šå„ç§å¤©ç©ºæ•ˆæœ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489118/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f2/033/d27/8f2033d27bc9d8a498716c85be1be1c0.png" alt="å›¾ç‰‡"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[åˆ†æçš„å…ˆå‰éƒ¨åˆ†ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬äºŒ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚]</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬1éƒ¨åˆ†ã€‚å·äº‘</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æ¸¸æˆåœ¨å¼€æ”¾ç©ºé—´ä¸­è¿›è¡Œæ—¶ï¼Œå†³å®šä¸–ç•Œä¿¡èª‰çš„å› ç´ ä¹‹ä¸€å°±æ˜¯å¤©ç©ºã€‚è€ƒè™‘ä¸€ä¸‹-å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¤©ç©ºå®é™…ä¸Šå æ®äº†æ•´ä¸ªå±å¹•çš„40-50ï¼…ã€‚å¤©ç©ºä¸ä»…ä»…æ˜¯ç¾ä¸½çš„æ¢¯åº¦ã€‚å®ƒæœ‰æ˜Ÿæ˜Ÿï¼Œå¤ªé˜³ï¼Œæœˆäº®ï¼Œæœ€åè¿˜æœ‰äº‘ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°½ç®¡å½“å‰çš„è¶‹åŠ¿ä¼¼ä¹åœ¨äºä½¿ç”¨å…‰çº¿è¡Œè¿›æ³•å¯¹äº‘è¿›è¡Œä½“ç§¯æ¸²æŸ“ï¼ˆè¯·å‚é˜…</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æ–‡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œä½†æ˜¯ã€Šå·«å¸ˆ3ã€‹ä¸­çš„äº‘å®Œå…¨åŸºäºçº¹ç†ã€‚æˆ‘ä¹‹å‰å·²ç»æ£€æŸ¥è¿‡å®ƒä»¬ï¼Œä½†äº‹å®è¯æ˜ï¼Œæœ‰äº†å®ƒä»¬ï¼Œä¸€åˆ‡éƒ½æ¯”æˆ‘æœ€åˆé¢„æœŸçš„è¦å¤æ‚ã€‚å¦‚æœæ‚¨å…³æ³¨äº†æˆ‘çš„ç³»åˆ—æ–‡ç« ï¼Œé‚£ä¹ˆæ‚¨å°±ä¼šçŸ¥é“Blood and Wine DLCä¸æ¸¸æˆå…¶ä½™éƒ¨åˆ†ä¹‹é—´å­˜åœ¨å·®å¼‚ã€‚è€Œä¸”ï¼Œæ‚¨å¯èƒ½ä¼šçŒœåˆ°ï¼ŒDLCä¸­ä½¿ç”¨äº‘çš„å·¥ä½œæœ‰æ‰€å˜åŒ–ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å·«å¸ˆ3æœ‰å‡ å±‚äº‘ã€‚æ ¹æ®å¤©æ°”çš„ä¸åŒï¼Œå®ƒåªèƒ½æ˜¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·äº‘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é«˜ç§¯äº‘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¯èƒ½æ˜¯å±‚äº‘å®¶æ—ä¸­çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ æœµäº‘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆä¾‹å¦‚ï¼Œæš´é£é›¨æœŸé—´ï¼‰ã€‚æœ€åï¼Œå¯èƒ½æ ¹æœ¬æ²¡æœ‰äº‘ã€‚</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŸäº›å›¾å±‚åœ¨ç”¨äºæ¸²æŸ“å®ƒä»¬çš„çº¹ç†å’Œç€è‰²å™¨æ–¹é¢æœ‰æ‰€ä¸åŒã€‚æ˜¾ç„¶ï¼Œè¿™ä¼šå½±å“åƒç´ ç€è‰²å™¨çš„æ±‡ç¼–ä»£ç çš„å¤æ‚åº¦å’Œé•¿åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°½ç®¡å­˜åœ¨æ‰€æœ‰è¿™äº›å¤šæ ·æ€§ï¼Œä½†åœ¨Witcher 3ä¸­æ¸²æŸ“äº‘æ—¶ä»å¯ä»¥è§‚å¯Ÿåˆ°ä¸€äº›å¸¸è§çš„æ¨¡å¼ã€‚é¦–å…ˆï¼Œå®ƒä»¬éƒ½ä»¥ä¸»åŠ¨æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œè¿™æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚ä»–ä»¬éƒ½ä½¿ç”¨æ··åˆï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚è¿™æ ·å¯ä»¥æ›´è½»æ¾åœ°æ§åˆ¶å•ç‹¬çš„å›¾å±‚å¦‚ä½•è¦†ç›–å¤©ç©º-è¿™å—åƒç´ ç€è‰²å™¨çš„alphaå€¼å½±å“ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/aec/b8a/263aecb8afa21e2b79b0333bcde55011.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æœ‰è¶£çš„æ˜¯ï¼ŒæŸäº›å›¾å±‚ä½¿ç”¨ç›¸åŒçš„å‚æ•°æ¸²æŸ“ä¸¤æ¬¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çœ‹å®Œä»£ç åï¼Œæˆ‘é€‰æ‹©äº†æœ€çŸ­çš„ç€è‰²å™¨ï¼Œä»¥ä¾¿ï¼ˆ1ï¼‰æœ€æœ‰å¯èƒ½æ‰§è¡Œå…¶å®Œæ•´çš„åå‘å·¥ç¨‹ï¼Œï¼ˆ2ï¼‰æ‰¾å‡ºæ‰€æœ‰æ–¹é¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»”ç»†è§‚å¯Ÿäº†ã€Šå·«å¸ˆ3ï¼šè¡€ä¸é…’ã€‹ä¸­çš„å·äº‘ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ¡†æ¶ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f81/eb8/a49/f81eb8a49dc315ef04d72b582fba869b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸²æŸ“ä¹‹å‰</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/885/b27/206/885b2720624e7a455987bb6239d0e371.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€æ¬¡æ¸²æŸ“é€šè¿‡ä¹‹å</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f2/033/d27/8f2033d27bc9d8a498716c85be1be1c0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“ä¹‹åã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨æ­¤ç‰¹å®šå¸§ä¸­ï¼Œå·äº‘æ˜¯æ¸²æŸ“çš„ç¬¬ä¸€å±‚ã€‚</font><font style="vertical-align: inherit;">å¦‚æ‚¨æ‰€è§ï¼Œå®ƒè¢«æ¸²æŸ“äº†ä¸¤æ¬¡ï¼Œä»è€Œå¢åŠ äº†å®ƒçš„äº®åº¦ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ ä½•å’Œé¡¶ç‚¹ç€è‰²å™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨åƒç´ ç€è‰²å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ç®€è¦è®¨è®ºä½¿ç”¨çš„å‡ ä½•ç€è‰²å™¨å’Œé¡¶ç‚¹ç€è‰²å™¨ã€‚</font><font style="vertical-align: inherit;">ç”¨äºæ˜¾ç¤ºäº‘çš„ç½‘æ ¼æœ‰ç‚¹åƒæ™®é€šçš„ç©¹é¡¶ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b4c/774/8de/b4c7748de95ad07f2dddfc090e62e0d2.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰é¡¶ç‚¹éƒ½åœ¨[0-1]åŒºé—´å†…ï¼Œå› æ­¤è¦ä½¿ç½‘æ ¼åœ¨ç‚¹ï¼ˆ0,0,0ï¼‰ä¸Šå±…ä¸­ï¼Œè¯·åœ¨è½¬æ¢ä¸ºworldViewProjä¹‹å‰ä½¿ç”¨ç¼©æ”¾å’Œåå·®ï¼ˆæˆ‘ä»¬å·²ç»ä»ç³»åˆ—çš„å…ˆå‰éƒ¨åˆ†ä¸­çŸ¥é“äº†è¿™ç§æ¨¡å¼ï¼‰ã€‚</font><font style="vertical-align: inherit;">åœ¨äº‘çš„æƒ…å†µä¸‹ï¼Œç½‘æ ¼æ²¿XYå¹³é¢ï¼ˆZè½´æŒ‡å‘ä¸Šï¼‰å¼ºçƒˆä¼¸å±•ï¼Œä»¥è¦†ç›–æ¯”å¯è§è§’é‡‘å­—å¡”æ›´å¤§çš„ç©ºé—´ã€‚</font><font style="vertical-align: inherit;">ç»“æœå¦‚ä¸‹ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/341/0ca/95e/3410ca95ea9f0b3ef1fafe62cb5dba13.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œç½‘æ ¼å…·æœ‰æ³•çº¿å’Œåˆ‡å‘é‡ã€‚</font><font style="vertical-align: inherit;">é¡¶ç‚¹ç€è‰²å™¨è¿˜é€šè¿‡çŸ¢é‡ä¹˜ç§¯è®¡ç®—åŒåˆ‡å‘é‡-æ‰€æœ‰ä¸‰ä¸ªå‡ä»¥æ ‡å‡†åŒ–å½¢å¼æ˜¾ç¤ºã€‚</font><font style="vertical-align: inherit;">è¿˜æœ‰ä¸€ä¸ªæœ€é«˜çº§çš„é›¾è®¡ç®—ï¼ˆå®ƒçš„é¢œè‰²å’Œäº®åº¦ï¼‰ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åƒç´ ç€è‰²å™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åƒç´ ç€è‰²å™¨æ±‡ç¼–ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> ps_5_0  <font></font>
    dcl_globalFlags refactoringAllowed  <font></font>
    dcl_constantbuffer cb0[<span class="hljs-number">10</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb1[<span class="hljs-number">9</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb12[<span class="hljs-number">238</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb4[<span class="hljs-number">13</span>], immediateIndexed  <font></font>
    dcl_sampler s0, <span class="hljs-function">mode_default  
    <span class="hljs-title">dcl_resource_texture2d</span> <span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> t0  
    <span class="hljs-title">dcl_resource_texture2d</span> <span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> t1  
    dcl_input_ps linear v0.xyzw  
    dcl_input_ps linear v1.xyzw  
    dcl_input_ps linear v2.w  
    dcl_input_ps linear v3.xyzw  
    dcl_input_ps linear v4.xyz  
    dcl_input_ps linear v5.xyz  
    dcl_output o0.xyzw  
    dcl_temps 4  
   0: mul r0.xyz, cb0[9].xyzx, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">-1.000000</span>, <span class="hljs-number">0.000000</span>)</span>  
   1: dp3 r0.w, r0.xyzx, r0.xyzx  
   2: rsq r0.w, r0.w  
   3: mul r0.xyz, r0.wwww, r0.xyzx  
   4: mul r1.xy, cb0[0].xxxx, cb4[5].xyxx  
   5: mad r1.xy, v1.xyxx, cb4[4].xyxx, r1.xyxx  
   6: <span class="hljs-title">sample_indexable</span><span class="hljs-params">(texture2d)</span><span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> r1.xyzw, r1.xyxx, t0.xyzw, s0  
   7: add r1.xyz, r1.xyzx, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">-0.500000</span>, <span class="hljs-number">-0.500000</span>, <span class="hljs-number">-0.500000</span>, <span class="hljs-number">0.000000</span>)</span>  
   8: add r1.xyz, r1.xyzx, r1.xyzx  
   9: dp3 r0.w, r1.xyzx, r1.xyzx  
  10: rsq r0.w, r0.w  
  11: mul r1.xyz, r0.wwww, r1.xyzx  
  12: mul r2.xyz, r1.yyyy, v3.xyzx  
  13: mad r2.xyz, v5.xyzx, r1.xxxx, r2.xyzx  
  14: mov r3.xy, v1.zwzz  
  15: mov r3.z, v3.w  
  16: mad r1.xyz, r3.xyzx, r1.zzzz, r2.xyzx  
  17: dp3_sat r0.x, r0.xyzx, r1.xyzx  
  18: add r0.y, -cb4[2].x, cb4[3].x  
  19: mad r0.x, r0.x, r0.y, cb4[2].x  
  20: dp2 r0.y, -cb0[9].xyxx, -cb0[9].xyxx  
  21: rsq r0.y, r0.y  
  22: mul r0.yz, r0.yyyy, -cb0[9].xxyx  
  23: add r1.xyz, -v4.xyzx, cb1[8].xyzx  
  24: dp3 r0.w, r1.xyzx, r1.xyzx  
  25: rsq r1.z, r0.w  
  26: <span class="hljs-built_in">sqrt</span> r0.w, r0.w  
  27: add r0.w, r0.w, -cb4[7].x  
  28: mul r1.xy, r1.zzzz, r1.xyxx  
  29: dp2_sat r0.y, r0.yzyy, r1.xyxx  
  30: add r0.y, r0.y, r0.y  
  31: min r0.y, r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  32: add r0.z, -cb4[0].x, cb4[1].x  
  33: mad r0.z, r0.y, r0.z, cb4[0].x  
  34: mul r0.x, r0.x, r0.z  
  35: <span class="hljs-built_in">log</span> r0.x, r0.x  
  36: mul r0.x, r0.x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">2.200000</span>)</span>  
  37: <span class="hljs-built_in">exp</span> r0.x, r0.x  
  38: add r1.xyz, cb12[236].xyzx, -cb12[237].xyzx  
  39: mad r1.xyz, r0.yyyy, r1.xyzx, cb12[237].xyzx  
  40: mul r2.xyz, r0.xxxx, r1.xyzx  
  41: mad r0.xyz, -r1.xyzx, r0.xxxx, v0.xyzx  
  42: mad r0.xyz, v0.wwww, r0.xyzx, r2.xyzx  
  43: add r1.x, -cb4[7].x, cb4[8].x  
  44: div_sat r0.w, r0.w, r1.x  
  45: mul r1.x, r1.w, cb4[9].x  
  46: mad r1.y, -cb4[9].x, r1.w, r1.w  
  47: mad r0.w, r0.w, r1.y, r1.x  
  48: mul r1.xy, cb0[0].xxxx, cb4[11].xyxx  
  49: mad r1.xy, v1.xyxx, cb4[10].xyxx, r1.xyxx  
  50: <span class="hljs-title">sample_indexable</span><span class="hljs-params">(texture2d)</span><span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> r1.x, r1.xyxx, t1.xyzw, s0  
  51: mad r1.x, r1.x, cb4[12].x, -cb4[12].x  
  52: mad_sat r1.x, cb4[12].x, v2.w, r1.x  
  53: mul r0.w, r0.w, r1.x  
  54: mul_sat r0.w, r0.w, cb4[6].x  
  55: mul o0.xyz, r0.wwww, r0.xyzx  
  56: mov o0.w, r0.w  
  57: ret </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¾“å…¥ä¸¤ä¸ªæ— ç¼çº¹ç†ã€‚</font><font style="vertical-align: inherit;">å…¶ä¸­ä¸€ä¸ªåŒ…å«æ³•çº¿è´´å›¾ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šé“</font><font style="vertical-align: inherit;">ï¼‰å’Œäº‘å½¢çŠ¶ï¼ˆé€šé“</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">ç¬¬äºŒä¸ªæ˜¯ä½¿å½¢çŠ¶å˜å½¢çš„å™ªéŸ³ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1f3/c27/a5e/1f3c27a5eea1412d5fa1fa632861a342.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³•çº¿è´´å›¾ï¼ŒCD Projektçº¢è‰²å±æ€§</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37b/a53/d41/37ba53d412d20f476ddf71e81892b62a.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‘å½¢ï¼Œå±æ€§CDé¡¹ç›®çº¢è‰²</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/05e/1bb/edd/05e1bbedded7c16acefc1f67d5b3fd49.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å™ªå£°çº¹ç†ï¼ŒCD Projekt Red</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
çš„</font><i><font style="vertical-align: inherit;">å±æ€§ã€‚</font></i><font style="vertical-align: inherit;">å…·æœ‰äº‘å‚æ•°çš„å¸¸é‡çš„ä¸»è¦ç¼“å†²åŒºä¸ºcb4ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæ­¤æ¡†æ¶ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å«ä¹‰ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/942/229/4de/9422294de7d9ead5e2bec154eb897c7a.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦å¤–ï¼Œä½¿ç”¨æ¥è‡ªå…¶ä»–cbufferçš„å…¶ä»–å€¼ã€‚</font><font style="vertical-align: inherit;">ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¹Ÿä¼šè€ƒè™‘å®ƒä»¬ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zå‘å€’ç½®é˜³å…‰</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç€è‰²å™¨ä¸­å‘ç”Ÿçš„ç¬¬ä¸€ä»¶äº‹æ˜¯è®¡ç®—æ²¿Zè½´åè½¬çš„é˜³å…‰çš„å½’ä¸€åŒ–æ–¹å‘ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-number">0</span>: mul r0.xyz, cb0[<span class="hljs-number">9</span>].xyzx, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">-1.000000</span>, <span class="hljs-number">0.000000</span>)  
   <span class="hljs-number">1</span>: dp3 r0.w, r0.xyzx, r0.xyzx  
   <span class="hljs-number">2</span>: rsq r0.w, r0.w  
   <span class="hljs-number">3</span>: mul r0.xyz, r0.wwww, r0.xyzx  <font></font>
<font></font>
   float3 invertedSunlightDir = normalize(lightDir * float3(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>) );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚å‰æ‰€è¿°ï¼ŒZè½´æŒ‡å‘ä¸Šæ–¹ï¼Œè€Œcb0 [9]æ˜¯å¤ªé˜³å…‰çš„æ–¹å‘ã€‚</font><font style="vertical-align: inherit;">è¯¥å‘é‡é’ˆå¯¹</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é˜³å…‰ä¸‹-è¿™æ˜¯å¾ˆé‡è¦çš„ï¼</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥é€šè¿‡ç¼–å†™è¿è¡Œç®€å•NdotLçš„ç®€å•è®¡ç®—ç€è‰²å™¨å¹¶å°†å…¶æ’å…¥å»¶è¿Ÿçš„ç€è‰²å™¨éå†ä¸­æ¥éªŒè¯è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‘çº¹ç†é‡‡æ ·</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹ä¸€æ­¥æ˜¯è®¡ç®—texcoordsä»¥é‡‡æ ·äº‘çº¹ç†ï¼Œè§£å‹ç¼©æ³•çº¿å‘é‡å¹¶å°†å…¶æ ‡å‡†åŒ–ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-number">4</span>: mul r1.xy, cb0[<span class="hljs-number">0</span>].xxxx, cb4[<span class="hljs-number">5</span>].xyxx   
   <span class="hljs-number">5</span>: mad r1.xy, v1.xyxx, cb4[<span class="hljs-number">4</span>].xyxx, r1.xyxx   
   <span class="hljs-number">6</span>: sample_indexable(texture2d)(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>) r1.xyzw, r1.xyxx, t0.xyzw, s0   
   <span class="hljs-number">7</span>: add r1.xyz, r1.xyzx, l(<span class="hljs-number">-0.500000</span>, <span class="hljs-number">-0.500000</span>, <span class="hljs-number">-0.500000</span>, <span class="hljs-number">0.000000</span>)   
   <span class="hljs-number">8</span>: add r1.xyz, r1.xyzx, r1.xyzx   
   <span class="hljs-number">9</span>: dp3 r0.w, r1.xyzx, r1.xyzx   
  <span class="hljs-number">10</span>: rsq r0.w, r0.w   <font></font>
   <font></font>
   <font></font>
   <span class="hljs-comment">// Calc sampling coords  </span><font></font>
   float2 cloudTextureUV = Texcoords * textureScale + elapsedTime * speedFactors;  <font></font>
   <font></font>
   <span class="hljs-comment">// Sample texture and get data from it  </span><font></font>
   float4 cloudTextureValue = texture0.Sample( sampler0, cloudTextureUV ).rgba;  <font></font>
   float3 normalMap = cloudTextureValue.xyz;  <font></font>
   <span class="hljs-keyword">float</span> cloudShape = cloudTextureValue.a;  <font></font>
   <font></font>
   <span class="hljs-comment">// Unpack normal and normalize it  </span>
   float3 unpackedNormal = (normalMap - <span class="hljs-number">0.5</span>) * <span class="hljs-number">2.0</span>;  <font></font>
   unpackedNormal = normalize(unpackedNormal);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬é€æ­¥è§£å†³å®ƒã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†è·å¾—äº‘çš„è¿åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦ç»è¿‡çš„æ—¶é—´ï¼ˆç§’ï¼‰ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb [0] .x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ä¹˜ä»¥é€Ÿåº¦ç³»æ•°ï¼Œè¿™ä¼šå½±å“äº‘åœ¨å¤©ç©ºä¸­ç§»åŠ¨çš„é€Ÿåº¦ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb4 [5] .xy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘ä¹‹å‰è¯´çš„ï¼ŒUVæ²¿ç€ç©¹é¡¶çš„å‡ ä½•å½¢çŠ¶ä¼¸å±•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å½±å“äº‘å¤§å°çš„çº¹ç†ç¼©æ”¾å› å­ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb4 [4] .xy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ç»ˆå…¬å¼ä¸ºï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">samplingUV = Input.TextureUV * textureScale + time * speedMultiplier;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹æ‰€æœ‰4ä¸ªé€šé“è¿›è¡Œé‡‡æ ·åï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ³•çº¿è´´å›¾ï¼ˆRGBé€šé“ï¼‰å’Œä¸€ä¸ªäº‘å½¢çŠ¶ï¼ˆé€šé“aï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»åŒºé—´[0; </font><font style="vertical-align: inherit;">1]åœ¨åŒºé—´[-1; </font><font style="vertical-align: inherit;">1]æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å…¬å¼ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">unpackedNormal = (packedNormal - <span class="hljs-number">0.5</span>) * <span class="hljs-number">2.0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">unpackedNormal = packedNormal * <span class="hljs-number">2.0</span> - <span class="hljs-number">1.0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œæˆ‘ä»¬å°†è§£å‹ç¼©åçš„æ³•çº¿å‘é‡å½’ä¸€åŒ–ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦†ç›–æ³•çº¿</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å…·æœ‰æ³•çº¿å‘é‡ï¼Œæ¥è‡ªé¡¶ç‚¹ç€è‰²å™¨çš„åˆ‡çº¿å’ŒåŒåˆ‡çº¿å‘é‡ä»¥åŠæ³•çº¿è´´å›¾çš„æ³•çº¿å‘é‡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ˜ å°„æ³•çº¿ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">11</span>: mul r1.xyz, r0.wwww, r1.xyzx  
  <span class="hljs-number">12</span>: mul r2.xyz, r1.yyyy, v3.xyzx  
  <span class="hljs-number">13</span>: mad r2.xyz, v5.xyzx, r1.xxxx, r2.xyzx  
  <span class="hljs-number">14</span>: mov r3.xy, v1.zwzz  
  <span class="hljs-number">15</span>: mov r3.z, v3.w  
  <span class="hljs-number">16</span>: mad r1.xyz, r3.xyzx, r1.zzzz, r2.xyzx  <font></font>
    <font></font>
   <span class="hljs-comment">// Perform bump mapping  </span><font></font>
   float3 SkyTangent = Input.Tangent;  <font></font>
   float3 SkyNormal = (float3( Input.Texcoords.zw, Input.param3.w ));  <font></font>
   float3 SkyBitangent = Input.param3.xyz;  <font></font>
        <font></font>
   float3x3 TBN = float3x3(SkyTangent, SkyBitangent, SkyNormal);  <font></font>
   float3 finalNormal = (float3)mul( unpackedNormal, (TBN) );</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº®åº¦ï¼ˆ1ï¼‰</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œå°†åº”ç”¨NdotLè®¡ç®—ï¼Œè¿™ä¼šå½±å“ç‰¹å®šåƒç´ çš„ç…§æ˜é‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è€ƒè™‘ä»¥ä¸‹æ±‡ç¼–ä»£ç ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">17</span>: dp3_sat r0.x, r0.xyzx, r1.xyzx  
  <span class="hljs-number">18</span>: add r0.y, -cb4[<span class="hljs-number">2</span>].x, cb4[<span class="hljs-number">3</span>].x  
  <span class="hljs-number">19</span>: mad r0.x, r0.x, r0.y, cb4[<span class="hljs-number">2</span>].x  </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯æœ‰å…³æ¡†æ¶ä¸ŠNdotLçš„å¯è§†åŒ–ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/283/f29/1a1/283f291a18105785a51af59dbbe8905a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤æ ‡é‡ç§¯ï¼ˆå…·æœ‰é¥±å’Œåº¦ï¼‰ç”¨äºåœ¨minIntensityå’ŒmaxIntensityä¹‹é—´è¿›è¡Œæ’å€¼ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œé˜³å…‰ç…§å°„ä¸‹çš„äº‘å±‚ä¼šæ›´äº®ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-comment">// Calculate cosine between normal and up-inv lightdir  </span>
   <span class="hljs-keyword">float</span> NdotL = saturate( dot(invertedSunlightDir, finalNormal) );  <font></font>
   <font></font>
   <span class="hljs-comment">// Param 1, line 19, r0.x  </span>
   <span class="hljs-keyword">float</span> intensity1 = lerp( param1Min, param1Max, NdotL );</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº®åº¦ï¼ˆ2ï¼‰</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜æœ‰å¦ä¸€ä¸ªå› ç´ ä¼šå½±å“äº‘çš„äº®åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº”å½“æ›´åŠ çªå‡ºä½äºå¤ªé˜³æ‰€åœ¨çš„å¤©ç©ºéƒ¨åˆ†çš„äº‘ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä»¬åŸºäºXYå¹³é¢è®¡ç®—æ¢¯åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ¢¯åº¦ç”¨äºè®¡ç®—æœ€å°å€¼/æœ€å¤§å€¼ä¹‹é—´çš„çº¿æ€§æ’å€¼ï¼Œç±»ä¼¼äºåœ¨éƒ¨åˆ†ï¼ˆ1ï¼‰ä¸­å‘ç”Ÿçš„æƒ…å†µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ç†è®ºä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ä½¿ä½äºå¤ªé˜³å¦ä¸€ä¾§çš„äº‘å˜æš—ï¼Œä½†è¿™åœ¨æ­¤ç‰¹å®šå¸§ä¸­ä¸ä¼šå‘ç”Ÿï¼Œå› ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param2Min</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param2Max</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb4 [0] .x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb4 [1] .x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰è®¾ç½®ä¸º1.0fã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">20</span>: dp2 r0.y, -cb0[<span class="hljs-number">9</span>].xyxx, -cb0[<span class="hljs-number">9</span>].xyxx  
  <span class="hljs-number">21</span>: rsq r0.y, r0.y  
  <span class="hljs-number">22</span>: mul r0.yz, r0.yyyy, -cb0[<span class="hljs-number">9</span>].xxyx  
  <span class="hljs-number">23</span>: add r1.xyz, -v4.xyzx, cb1[<span class="hljs-number">8</span>].xyzx  
  <span class="hljs-number">24</span>: dp3 r0.w, r1.xyzx, r1.xyzx  
  <span class="hljs-number">25</span>: rsq r1.z, r0.w  
  <span class="hljs-number">26</span>: <span class="hljs-built_in">sqrt</span> r0.w, r0.w  
  <span class="hljs-number">27</span>: add r0.w, r0.w, -cb4[<span class="hljs-number">7</span>].x  
  <span class="hljs-number">28</span>: mul r1.xy, r1.zzzz, r1.xyxx  
  <span class="hljs-number">29</span>: dp2_sat r0.y, r0.yzyy, r1.xyxx  
  <span class="hljs-number">30</span>: add r0.y, r0.y, r0.y  
  <span class="hljs-number">31</span>: min r0.y, r0.y, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">32</span>: add r0.z, -cb4[<span class="hljs-number">0</span>].x, cb4[<span class="hljs-number">1</span>].x  
  <span class="hljs-number">33</span>: mad r0.z, r0.y, r0.z, cb4[<span class="hljs-number">0</span>].x  
  <span class="hljs-number">34</span>: mul r0.x, r0.x, r0.z  
  <span class="hljs-number">35</span>: <span class="hljs-built_in">log</span> r0.x, r0.x  
  <span class="hljs-number">36</span>: mul r0.x, r0.x, l(<span class="hljs-number">2.200000</span>)  
  <span class="hljs-number">37</span>: <span class="hljs-built_in">exp</span> r0.x, r0.x   <font></font>
   <font></font>
   <font></font>
   <span class="hljs-comment">// Calculate normalized -lightDir.xy (20-22)  </span><font></font>
   float2 lightDirXY = normalize( -lightDir.xy );  <font></font>
   <font></font>
   <span class="hljs-comment">// Calculate world to camera  </span><font></font>
   float3 vWorldToCamera = ( CameraPos - WorldPos );  <font></font>
   <span class="hljs-keyword">float</span> worldToCamera_distance = length(vWorldToCamera);  <font></font>
        <font></font>
   <span class="hljs-comment">// normalize vector  </span><font></font>
   vWorldToCamera = normalize( vWorldToCamera );  <font></font>
        <font></font>
   <font></font>
   <span class="hljs-keyword">float</span> LdotV = saturate( dot(lightDirXY, vWorldToCamera.xy) );  
   <span class="hljs-keyword">float</span> highlightedSkySection = saturate( <span class="hljs-number">2</span>*LdotV );  
   <span class="hljs-keyword">float</span> intensity2 = lerp( param2Min, param2Max, highlightedSkySection );  <font></font>
   <font></font>
   <span class="hljs-keyword">float</span> finalIntensity = <span class="hljs-built_in">pow</span>( intensity2 *intensity1, <span class="hljs-number">2.2</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªäº®åº¦ç›¸ä¹˜å¹¶å°†ç»“æœæé«˜åˆ°2.2çš„å¹‚ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‘è‰²</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº‘çš„é¢œè‰²çš„è®¡ç®—é¦–å…ˆä»ç¼“å†²åŒºå¸¸é‡ä¸­è·å¾—ä¸¤ä¸ªå€¼ï¼Œè¿™äº›å€¼æŒ‡ç¤ºå¤ªé˜³æ—è¾¹çš„äº‘å’Œå¤©ç©ºå¦ä¸€ä¾§çš„äº‘çš„é¢œè‰²ã€‚</font><font style="vertical-align: inherit;">åœ¨å®ƒä»¬ä¹‹é—´ï¼ŒåŸºäº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é«˜äº®æ˜¾ç¤ºçš„</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SkySectionè¿›è¡Œçº¿æ€§æ’å€¼</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åå°†ç»“æœä¹˜ä»¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">finalIntensity</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œç»“æœä¸é›¾æ··åˆï¼ˆå‡ºäºæ€§èƒ½åŸå› ï¼Œå®ƒæ˜¯ç”±é¡¶ç‚¹ç€è‰²å™¨è®¡ç®—çš„ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">38</span>: add r1.xyz, cb12[<span class="hljs-number">236</span>].xyzx, -cb12[<span class="hljs-number">237</span>].xyzx  
  <span class="hljs-number">39</span>: mad r1.xyz, r0.yyyy, r1.xyzx, cb12[<span class="hljs-number">237</span>].xyzx  
  <span class="hljs-number">40</span>: mul r2.xyz, r0.xxxx, r1.xyzx  
  <span class="hljs-number">41</span>: mad r0.xyz, -r1.xyzx, r0.xxxx, v0.xyzx  
  <span class="hljs-number">42</span>: mad r0.xyz, v0.wwww, r0.xyzx, r2.xyzx  <font></font>
   <font></font>
  float3 cloudsColor = lerp( cloudsColorBack, cloudsColorFront, highlightedSunSection );  <font></font>
  cloudsColor *= finalIntensity;  <font></font>
  cloudsColor = lerp( cloudsColor, FogColor, FogAmount );</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿å·äº‘åœ¨åœ°å¹³çº¿ä¸Šæ›´æ¸…æ™°å¯è§</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™åœ¨æ¡†æ¶ä¸Šä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œåœ¨é è¿‘åœ°å¹³çº¿çš„åœ°æ–¹æ¯”åœ¨Geraltçš„å¤´éƒ¨ä¸Šæ–¹æ›´å®¹æ˜“çœ‹åˆ°è¿™ä¸€å±‚ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ“ä½œæ–¹æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œåœ¨è®¡ç®—ç¬¬äºŒä¸ªäº®åº¦æ—¶ï¼Œæˆ‘ä»¬è®¡ç®—äº†å‘é‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worldToCamera</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„é•¿åº¦</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">23</span>: add r1.xyz, -v4.xyzx, cb1[<span class="hljs-number">8</span>].xyzx  
  <span class="hljs-number">24</span>: dp3 r0.w, r1.xyzx, r1.xyzx  
  <span class="hljs-number">25</span>: rsq r1.z, r0.w  
  <span class="hljs-number">26</span>: <span class="hljs-built_in">sqrt</span> r0.w, r0.w</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­æ‰¾åˆ°ä»¥ä¸‹è¿™ç§é•¿åº¦çš„æƒ…å†µï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">26</span>: <span class="hljs-built_in">sqrt</span> r0.w, r0.w  
  <span class="hljs-number">27</span>: add r0.w, r0.w, -cb4[<span class="hljs-number">7</span>].x  <font></font>
  ...  <font></font>
  <span class="hljs-number">43</span>: add r1.x, -cb4[<span class="hljs-number">7</span>].x, cb4[<span class="hljs-number">8</span>].x  
  <span class="hljs-number">44</span>: div_sat r0.w, r0.w, r1.x</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å“‡ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cb [7] .xå’Œcb [8] .xçš„å€¼åˆ†åˆ«ä¸º2000.0å’Œ7000.0ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº‹å®è¯æ˜ï¼Œè¿™æ˜¯ä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linstep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°çš„ç»“æœ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¥¹æ”¶åˆ°ä¸‰ä¸ªå‚æ•°ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">min / max-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—´éš”å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼šå¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨é—´éš”[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">min</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]ä¸­ï¼Œåˆ™å‡½æ•°å°†åœ¨é—´éš”[0.0-1.0]ä¸­è¿”å›çº¿æ€§æ’å€¼ã€‚</font><font style="vertical-align: inherit;">å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¶…å‡ºèŒƒå›´ï¼Œåˆ™linstepè¿”å›0.0æˆ–1.0ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">linstep( <span class="hljs-number">1000.0</span>, <span class="hljs-number">2000.0</span>, <span class="hljs-number">999.0</span>) = <span class="hljs-number">0.0</span>
linstep( <span class="hljs-number">1000.0</span>, <span class="hljs-number">2000.0</span>, <span class="hljs-number">1500.0</span>) = <span class="hljs-number">0.5</span>
linstep( <span class="hljs-number">1000.0</span>, <span class="hljs-number">2000.0</span>, <span class="hljs-number">2000.0</span>) = <span class="hljs-number">1.0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸</font><font style="vertical-align: inherit;">HLSL </font><font style="vertical-align: inherit;">çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹³æ»‘æ­¥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éå¸¸ç›¸ä¼¼</font><font style="vertical-align: inherit;">ï¼Œé™¤äº†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸æ˜¯æ‰§è¡ŒHermitianæ’å€¼è€Œæ˜¯æ‰§è¡Œçº¿æ€§ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linstepä¸æ˜¯HLSLçš„åŠŸèƒ½ï¼Œä½†å®ƒéå¸¸æœ‰ç”¨ã€‚</font><font style="vertical-align: inherit;">å€¼å¾—åœ¨æ‚¨çš„å·¥å…·åŒ…ä¸­ä½¿ç”¨å®ƒã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-comment">// linstep:  </span>
 <span class="hljs-comment">//  </span>
 <span class="hljs-comment">// Returns a linear interpolation between 0 and 1 if t is in the range [min, max]   </span>
 <span class="hljs-comment">// if "v" is &lt;= min, the output is 0  </span>
 <span class="hljs-comment">// if "v" i &gt;= max, the output is 1  </span><font></font>
   <font></font>
 <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">linstep</span><span class="hljs-params">( <span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max, <span class="hljs-keyword">float</span> v )</span>  
 </span>{  
   <span class="hljs-keyword">return</span> saturate( (v - min) / (max - min) );  <font></font>
 } </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬å›åˆ°å·«å¸ˆ3ï¼šè®¡ç®—å®Œè¯¥æŒ‡æ ‡åï¼ŒæŠ¥å‘Šå¤©ç©ºçš„ç‰¹å®šéƒ¨åˆ†ç¦»Geraltæœ‰å¤šè¿œï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥å‡å¼±äº‘å±‚çš„äº®åº¦ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">45</span>: mul r1.x, r1.w, cb4[<span class="hljs-number">9</span>].x  
  <span class="hljs-number">46</span>: mad r1.y, -cb4[<span class="hljs-number">9</span>].x, r1.w, r1.w  
  <span class="hljs-number">47</span>: mad r0.w, r0.w, r1.y, r1.x  <font></font>
   <font></font>
   <span class="hljs-keyword">float</span> distanceAttenuation = linstep( fadeDistanceStart, fadeDistanceEnd, worldToCamera_distance );  <font></font>
    <font></font>
   <span class="hljs-keyword">float</span> fadedCloudShape = closeCloudsHidingFactor * cloudShape;  <font></font>
   cloudShape = lerp( fadedCloudShape, cloudShape, distanceAttenuation );</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloudShape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ç¬¬ä¸€ä¸ªçº¹ç†çš„.aé€šé“ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">closeCloudsHidingFactor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ä¸€ä¸ªæ’å®šçš„ç¼“å†²åŒºå€¼ï¼Œç”¨äºæ§åˆ¶Geraltå¤´é¡¶ä¸Šæ–¹äº‘çš„å¯è§æ€§ã€‚</font><font style="vertical-align: inherit;">åœ¨æˆ‘æµ‹è¯•çš„æ‰€æœ‰å¸§ä¸­ï¼Œå®ƒç­‰äº0.0ï¼Œè¿™ç­‰äºæ²¡æœ‰äº‘ã€‚</font><font style="vertical-align: inherit;">éšç€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distanceAttenuation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥è¿‘1.0ï¼ˆä»æ‘„åƒæœºåˆ°å¤©ç©ºç©¹é¡¶çš„è·ç¦»å¢åŠ ï¼‰ï¼Œäº‘å˜å¾—æ›´åŠ å¯è§ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å™ªå£°çº¹ç†é‡‡æ ·</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡‡æ ·å™ªå£°çº¹ç†çš„åæ ‡è®¡ç®—å¯¹äº‘çš„çº¹ç†è¿›è¡Œç±»ä¼¼çš„è®¡ç®—ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œæ‚¨ä½¿ç”¨äº†ä¸åŒçš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">textureScale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">speedMultiplieré›†</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ç„¶ï¼Œå¯ç”¨äº†</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¯ç»•</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯»å€æ¨¡å¼çš„é‡‡æ ·å™¨</font><b><font style="vertical-align: inherit;">å°†</font></b><font style="vertical-align: inherit;">ç”¨äºé‡‡æ ·æ‰€æœ‰è¿™äº›çº¹ç†</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">48</span>: mul r1.xy, cb0[<span class="hljs-number">0</span>].xxxx, cb4[<span class="hljs-number">11</span>].xyxx  
  <span class="hljs-number">49</span>: mad r1.xy, v1.xyxx, cb4[<span class="hljs-number">10</span>].xyxx, r1.xyxx  
  <span class="hljs-number">50</span>: sample_indexable(texture2d)(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>) r1.x, r1.xyxx, t1.xyzw, s0  <font></font>
   <font></font>
   <span class="hljs-comment">// Calc sampling coords for noise  </span><font></font>
   float2 noiseTextureUV = Texcoords * textureScaleNoise + elapsedTime * speedFactorsNoise;  <font></font>
   <font></font>
   <span class="hljs-comment">// Sample texture and get data from it  </span>
   <span class="hljs-keyword">float</span> noiseTextureValue = texture1.Sample( sampler0, noiseTextureUV ).x;</code></pre> <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¨éƒ¨æ”¾åœ¨ä¸€èµ·</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”¶åˆ°å™ªå£°å€¼åï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶ä¸cloudShapeç»“åˆä½¿ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åœ¨ç†è§£è¿™äº›è¡Œæ—¶é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œè¿™äº›è¡Œä¸­æœ‰param2.wï¼ˆå§‹ç»ˆä¸º1.0ï¼‰å’ŒnoiseMultï¼ˆå€¼ä¸º5.0ï¼Œå–è‡ªå¸¸é‡ç¼“å†²åŒºï¼‰ã€‚</font><i><font style="vertical-align: inherit;">ä¸ç®¡æ€æ ·</font></i><font style="vertical-align: inherit;">ï¼Œ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œæœ€é‡è¦çš„æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generalCloudsVisibility</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æœ€ç»ˆå€¼</font><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">ä¼šå½±å“äº‘çš„å¯è§æ€§ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜è¦çœ‹çœ‹å™ªå£°çš„æœ€ç»ˆå€¼ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloudsColor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è¾“å‡ºé¢œè‰²</font><font style="vertical-align: inherit;">ä¹˜ä»¥æœ€ç»ˆå™ªå£°ï¼Œè¯¥å™ªå£°ä¹Ÿä¼šè¾“å‡ºåˆ°Alphaé€šé“ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">51</span>: mad r1.x, r1.x, cb4[<span class="hljs-number">12</span>].x, -cb4[<span class="hljs-number">12</span>].x
  <span class="hljs-number">52</span>: mad_sat r1.x, cb4[<span class="hljs-number">12</span>].x, v2.w, r1.x
  <span class="hljs-number">53</span>: mul r0.w, r0.w, r1.x
  <span class="hljs-number">54</span>: mul_sat r0.w, r0.w, cb4[<span class="hljs-number">6</span>].x
  <span class="hljs-number">55</span>: mul o0.xyz, r0.wwww, r0.xyzx
  <span class="hljs-number">56</span>: mov o0.w, r0.w
  <span class="hljs-number">57</span>: ret   <font></font>
<font></font>
   <span class="hljs-comment">// Sample noise texture and get data from it  </span>
   <span class="hljs-keyword">float</span> noiseTextureValue = texture1.Sample( sampler0, noiseTextureUV ).x;  <font></font>
   noiseTextureValue = noiseTextureValue * noiseMult - noiseMult;  <font></font>
     <font></font>
   <span class="hljs-keyword">float</span> noiseValue = saturate( noiseMult * Input.param2.w + noiseTextureValue);  <font></font>
   noiseValue *= cloudShape;  <font></font>
     <font></font>
   <span class="hljs-keyword">float</span> finalNoise = saturate( noiseValue * generalCloudsVisibility);  <font></font>
   <font></font>
   <span class="hljs-keyword">return</span> float4( cloudsColor*finalNoise, finalNoise ); </code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€»</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ç»ˆç»“æœçœ‹èµ·æ¥éå¸¸å¯ä¿¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥æ¯”è¾ƒã€‚</font><font style="vertical-align: inherit;">ç¬¬ä¸€å¼ å›¾ç‰‡æ˜¯æˆ‘çš„ç€è‰²å™¨ï¼Œç¬¬äºŒå¼ æ˜¯æ¸¸æˆç€è‰²å™¨ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4cc/331/897/4cc3318976e9c1c54178683a2fee44c0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨å¥½å¥‡ï¼Œå¯ä»¥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ç€è‰²å™¨</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬2éƒ¨åˆ†ã€‚é›¾</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é›¾å¯ä»¥ä»¥å¤šç§æ–¹å¼å®ç°ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨ç®€å•çš„ä¸</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·ç¦»ç›¸å…³çš„é›¾</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶æ¶ˆé™¤å®ƒçš„æ—¶ä»£åœ¨è¿‡å»æ˜¯æ°¸è¿œçš„ï¼ˆæœ€æœ‰å¯èƒ½ï¼‰ã€‚ç”Ÿæ´»åœ¨å¯ç¼–ç¨‹ç€è‰²å™¨ä¸–ç•Œä¸­çš„äººä»¬ä¸ºç–¯ç‹‚çš„ï¼Œä½†æ›´é‡è¦çš„æ˜¯ç‰©ç†ä¸Šç²¾ç¡®çš„å’Œè§†è§‰ä¸Šé€¼çœŸçš„è§£å†³æ–¹æ¡ˆæ‰“å¼€äº†å¤§é—¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç›®å‰åœ¨é›¾æ¸²æŸ“è¶‹åŠ¿æ˜¯åŸºäºè®¡ç®—ç€è‰²å™¨ï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¼”ç¤ºæ–‡ç¨¿ç”±Bart Wronskyï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°½ç®¡è¯¥æ¼”ç¤ºæ–‡ç¨¿äº2014å¹´å‡ºç°ï¼Œã€Šå·«å¸ˆ3ã€‹äº2015/2016å¹´å‘å¸ƒï¼Œä½†Geraltå†’é™©çš„æœ€åä¸€éƒ¨åˆ†ä¸­çš„è¿·é›¾å®Œå…¨å–å†³äºå±å¹•ï¼Œå¹¶ä½œä¸ºå…¸å‹çš„åå¤„ç†æ¥å®ç°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘ä»¬å¼€å§‹ä¸‹ä¸€ä¸ªé€†å‘å·¥ç¨‹ä¼šè®®ä¹‹å‰ï¼Œæˆ‘å¿…é¡»è¯´ï¼Œåœ¨è¿‡å»çš„ä¸€å¹´ä¸­ï¼Œæˆ‘è¯•å›¾æ‰¾å‡ºå·«å¸ˆ3çš„è¿·é›¾è‡³å°‘äº”æ¬¡ï¼Œä½†æ¯æ¬¡éƒ½å¤±è´¥äº†ã€‚æ­£å¦‚æ‚¨å°†å¾ˆå¿«çœ‹åˆ°çš„ï¼Œæ±‡ç¼–ä»£ç éå¸¸å¤æ‚ï¼Œè¿™ä½¿å¾—åœ¨HLSLä¸Šåˆ›å»ºå¯è¯»çš„é›¾ç€è‰²å™¨çš„è¿‡ç¨‹å‡ ä¹å˜å¾—ä¸å¯èƒ½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œæˆ‘è®¾æ³•åœ¨Internetä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªé›¾ç€è‰²å™¨ï¼Œå› ä¸ºå®ƒåœ¨å˜é‡åå’Œä¸€èˆ¬æŒ‡ä»¤é¡ºåºæ–¹é¢ä¸Witcher 3 fogç›¸ä¼¼ï¼Œå› æ­¤ç«‹å³å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚è¯¥ç€è‰²å™¨ä¸æ¸¸æˆä¸­çš„ç€è‰²å™¨å¹¶ä¸å®Œå…¨ç›¸åŒï¼Œå› æ­¤æˆ‘ä¸å¾—ä¸å¯¹å…¶è¿›è¡Œä¸€äº›é‡æ–°è®¾è®¡ã€‚æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œæ‚¨çœ‹åˆ°çš„HLSLä»£ç çš„ä¸»è¦éƒ¨åˆ†æ˜¯ç”±æˆ‘åˆ›å»º/åˆ†æçš„ï¼Œåªæœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚è®°ä½è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯åƒç´ é›¾ç€è‰²å™¨çš„æ±‡ç¼–ä»£ç -å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•´ä¸ªæ¸¸æˆï¼ˆ2015å¹´çš„ä¸»è¦éƒ¨åˆ†å’Œä¸¤ä¸ªDLCï¼‰éƒ½ç›¸åŒï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> ps_5_0  <font></font>
    dcl_globalFlags refactoringAllowed  <font></font>
    dcl_constantbuffer cb3[<span class="hljs-number">2</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb12[<span class="hljs-number">214</span>], <span class="hljs-function">immediateIndexed  
    <span class="hljs-title">dcl_resource_texture2d</span> <span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> t0  
    <span class="hljs-title">dcl_resource_texture2d</span> <span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> t1  
    <span class="hljs-title">dcl_resource_texture2d</span> <span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> t2  
    dcl_input_ps_siv v0.xy, position  
    dcl_output o0.xyzw  
    dcl_temps 7  
   0: ftou r0.xy, v0.xyxx  
   1: mov r0.zw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
   2: <span class="hljs-title">ld_indexable</span><span class="hljs-params">(texture2d)</span><span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> r1.x, r0.xyww, t0.xyzw  
   3: mad r1.y, r1.x, cb12[22].x, cb12[22].y  
   4: lt r1.y, r1.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
   5: if_nz r1.y  
   6:  utof r1.yz, r0.xxyx  
   7:  mul r2.xyzw, r1.zzzz, cb12[211].xyzw  
   8:  mad r2.xyzw, cb12[210].xyzw, r1.yyyy, r2.xyzw  
   9:  mad r1.xyzw, cb12[212].xyzw, r1.xxxx, r2.xyzw  
  10:  add r1.xyzw, r1.xyzw, cb12[213].xyzw  
  11:  div r1.xyz, r1.xyzx, r1.wwww  
  12:  <span class="hljs-title">ld_indexable</span><span class="hljs-params">(texture2d)</span><span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> r2.xyz, r0.xyww, t1.xyzw  
  13:  <span class="hljs-title">ld_indexable</span><span class="hljs-params">(texture2d)</span><span class="hljs-params">(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>)</span> r0.x, r0.xyzw, t2.xyzw  
  14:  max r0.x, r0.x, cb3[1].x  
  15:  add r0.yzw, r1.xxyz, -cb12[0].xxyz  
  16:  dp3 r1.x, r0.yzwy, r0.yzwy  
  17:  <span class="hljs-built_in">sqrt</span> r1.x, r1.x  
  18:  add r1.y, r1.x, -cb3[0].x  
  19:  add r1.zw, -cb3[0].xxxz, cb3[0].yyyw  
  20:  div_sat r1.y, r1.y, r1.z  
  21:  mad r1.y, r1.y, r1.w, cb3[0].z  
  22:  add r0.x, r0.x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">-1.000000</span>)</span>  
  23:  mad r0.x, r1.y, r0.x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  24:  div r0.yzw, r0.yyzw, r1.xxxx  
  25:  mad r1.y, r0.w, cb12[22].z, cb12[0].z  
  26:  add r1.x, r1.x, -cb12[22].z  
  27:  max r1.x, r1.x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>  
  28:  min r1.x, r1.x, cb12[42].z  
  29:  mul r1.z, r0.w, r1.x  
  30:  mul r1.w, r1.x, cb12[43].x  
  31:  mul r1.zw, r1.zzzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.062500</span>, <span class="hljs-number">0.062500</span>)</span>  
  32:  dp3 r0.y, cb12[38].xyzx, r0.yzwy  
  33:  add r0.z, r0.y, cb12[42].x  
  34:  add r0.w, cb12[42].x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  35:  div_sat r0.z, r0.z, r0.w  
  36:  add r0.w, -cb12[43].z, cb12[43].y  
  37:  mad r0.z, r0.z, r0.w, cb12[43].z  
  38:  mul r0.w, <span class="hljs-title">abs</span><span class="hljs-params">(r0.y)</span>, <span class="hljs-title">abs</span><span class="hljs-params">(r0.y)</span>  
  39:  mad_sat r2.w, r1.x, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0.002000</span>)</span>, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">-0.300000</span>)</span>  
  40:  mul r0.w, r0.w, r2.w  
  41:  lt r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, r0.y  
  42:  movc r3.xyz, r0.yyyy, cb12[39].xyzx, cb12[41].xyzx  
  43:  add r3.xyz, r3.xyzx, -cb12[40].xyzx  
  44:  mad r3.xyz, r0.wwww, r3.xyzx, cb12[40].xyzx  
  45:  movc r4.xyz, r0.yyyy, cb12[45].xyzx, cb12[47].xyzx  
  46:  add r4.xyz, r4.xyzx, -cb12[46].xyzx  
  47:  mad r4.xyz, r0.wwww, r4.xyzx, cb12[46].xyzx  
  48:  ge r0.y, r1.x, cb12[48].y  
  49:  if_nz r0.y  
  50:   add r0.y, r1.y, cb12[42].y  
  51:   mul r0.w, r0.z, r0.y  
  52:   mul r1.y, r0.z, r1.z  
  53:   mad r5.xyzw, r1.yyyy, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">16.000000</span>, <span class="hljs-number">15.000000</span>, <span class="hljs-number">14.000000</span>, <span class="hljs-number">13.000000</span>)</span>, r0.wwww  
  54:   max r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
  55:   add r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  56:   div_sat r5.xyzw, r1.wwww, r5.xyzw  
  57:   add r5.xyzw, -r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  58:   mul r1.z, r5.y, r5.x  
  59:   mul r1.z, r5.z, r1.z  
  60:   mul r1.z, r5.w, r1.z  
  61:   mad r5.xyzw, r1.yyyy, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">12.000000</span>, <span class="hljs-number">11.000000</span>, <span class="hljs-number">10.000000</span>, <span class="hljs-number">9.000000</span>)</span>, r0.wwww  
  62:   max r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
  63:   add r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  64:   div_sat r5.xyzw, r1.wwww, r5.xyzw  
  65:   add r5.xyzw, -r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  66:   mul r1.z, r1.z, r5.x  
  67:   mul r1.z, r5.y, r1.z  
  68:   mul r1.z, r5.z, r1.z  
  69:   mul r1.z, r5.w, r1.z  
  70:   mad r5.xyzw, r1.yyyy, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">8.000000</span>, <span class="hljs-number">7.000000</span>, <span class="hljs-number">6.000000</span>, <span class="hljs-number">5.000000</span>)</span>, r0.wwww  
  71:   max r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
  72:   add r5.xyzw, r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  73:   div_sat r5.xyzw, r1.wwww, r5.xyzw  
  74:   add r5.xyzw, -r5.xyzw, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)</span>  
  75:   mul r1.z, r1.z, r5.x  
  76:   mul r1.z, r5.y, r1.z  
  77:   mul r1.z, r5.z, r1.z  
  78:   mul r1.z, r5.w, r1.z  
  79:   mad r5.xy, r1.yyyy, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">4.000000</span>, <span class="hljs-number">3.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)</span>, r0.wwww  
  80:   max r5.xy, r5.xyxx, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
  81:   add r5.xy, r5.xyxx, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)</span>  
  82:   div_sat r5.xy, r1.wwww, r5.xyxx  
  83:   add r5.xy, -r5.xyxx, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)</span>  
  84:   mul r1.z, r1.z, r5.x  
  85:   mul r1.z, r5.y, r1.z  
  86:   mad r0.w, r1.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">2.000000</span>)</span>, r0.w  
  87:   max r0.w, r0.w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>  
  88:   add r0.w, r0.w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  89:   div_sat r0.w, r1.w, r0.w  
  90:   add r0.w, -r0.w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  91:   mul r0.w, r0.w, r1.z  
  92:   mad r0.y, r0.y, r0.z, r1.y  
  93:   max r0.y, r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>  
  94:   add r0.y, r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  95:   div_sat r0.y, r1.w, r0.y  
  96:   add r0.y, -r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  97:   mad r0.y, -r0.w, r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  98:   add r0.z, r1.x, -cb12[48].y  
  99:   mul_sat r0.z, r0.z, cb12[48].z  
  100:  <span class="hljs-keyword">else</span>  
  101:   mov r0.yz, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)</span>  
  102:  endif  
  103:  <span class="hljs-built_in">log</span> r0.y, r0.y  
  104:  mul r0.w, r0.y, cb12[42].w  
  105:  <span class="hljs-built_in">exp</span> r0.w, r0.w  
  106:  mul r0.y, r0.y, cb12[48].x  
  107:  <span class="hljs-built_in">exp</span> r0.y, r0.y  
  108:  mul r0.yw, r0.yyyw, r0.zzzz  
  109:  mad_sat r1.xy, r0.wwww, cb12[189].xzxx, cb12[189].ywyy  
  110:  add r5.xyz, -r3.xyzx, cb12[188].xyzx  
  111:  mad r5.xyz, r1.xxxx, r5.xyzx, r3.xyzx  
  112:  add r0.z, cb12[188].w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">-1.000000</span>)</span>  
  113:  mad r0.z, r1.y, r0.z, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  114:  mul_sat r5.w, r0.z, r0.w  
  115:  lt r0.z, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span>, cb12[192].x  
  116:  if_nz r0.z  
  117:   mad_sat r1.xy, r0.wwww, cb12[191].xzxx, cb12[191].ywyy  
  118:   add r6.xyz, -r3.xyzx, cb12[190].xyzx  
  119:   mad r3.xyz, r1.xxxx, r6.xyzx, r3.xyzx  
  120:   add r0.z, cb12[190].w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">-1.000000</span>)</span>  
  121:   mad r0.z, r1.y, r0.z, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  122:   mul_sat r3.w, r0.z, r0.w  
  123:   add r1.xyzw, -r5.xyzw, r3.xyzw  
  124:   mad r5.xyzw, cb12[192].xxxx, r1.xyzw, r5.xyzw  
  125:  endif  
  126:  mul r0.z, r0.x, r5.w  
  127:  mul r0.x, r0.x, r0.y  
  128:  dp3 r0.y, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0.333000</span>, <span class="hljs-number">0.555000</span>, <span class="hljs-number">0.222000</span>, <span class="hljs-number">0.000000</span>)</span>, r2.xyzx  
  129:  mad r1.xyz, r0.yyyy, r4.xyzx, -r2.xyzx  
  130:  mad r0.xyw, r0.xxxx, r1.xyxz, r2.xyxz  
  131:  add r1.xyz, -r0.xywx, r5.xyzx  
  132:  mad r0.xyz, r0.zzzz, r1.xyzx, r0.xywx  
  133: <span class="hljs-keyword">else</span>  
  134:  mov r0.xyz, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</span>  
  135: endif  
  136: mov o0.xyz, r0.xyzx  
  137: mov o0.w, <span class="hljs-title">l</span><span class="hljs-params">(<span class="hljs-number">1.000000</span>)</span>  
  138: ret </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è€å®è¯´ï¼Œç€è‰²å™¨å¾ˆé•¿ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæœ‰æ•ˆçš„åå‘å·¥ç¨‹è¿‡ç¨‹è€Œè¨€ï¼Œå¯èƒ½å¤ªé•¿äº†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯ä¸€ä¸ªæœ‰é›¾çš„æ—¥è½åœºæ™¯çš„ç¤ºä¾‹ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/375/d59/f51/375d59f5199e791efd99c218a0ea6f53.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å…¥ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡³äºçº¹ç†ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ·±åº¦ç¼“å†²åŒºï¼Œç¯å¢ƒå…‰é®æŒ¡å’Œä¸€ä¸ªHDRé¢œè‰²ç¼“å†²åŒºã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ea/24d/ff0/9ea24dff07dad409a78834272d553b29.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¥ç«™æ·±åº¦ç¼“å†²åŒº</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e7/c8f/e3e/3e7c8fe3ee0dc58e3007f9a1bad7f877.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼ å…¥ç¯å¢ƒå…‰é®æŒ¡</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/748/51f/f3c/74851ff3ce8d38b77d9319329a334d4f.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼ å…¥çš„HDRé¢œè‰²ç¼“å†²åŒº</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
...ä»¥åŠåœ¨æ­¤åœºæ™¯ä¸­åº”ç”¨é›¾ç€è‰²å™¨çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ee/2f8/5ad/1ee2f85adc2cc870769985308b6dcc48.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–½åŠ é›¾åçš„HDRçº¹ç†</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ·±åº¦ç¼“å†²åŒºç”¨äºé‡æ–°åˆ›å»ºä¸–ç•Œä¸­çš„ä½ç½®ã€‚è¿™æ˜¯Witcher 3ç€è‰²å™¨çš„æ ‡å‡†æ¨¡å¼ï¼Œ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…·æœ‰ç¯å¢ƒå…‰é®æŒ¡æ•°æ®ï¼ˆå¦‚æœå¯ç”¨ï¼‰å¯ä½¿æˆ‘ä»¬é®ä½é›¾ã€‚ä¸€ä¸ªéå¸¸èªæ˜çš„ä¸»æ„ï¼Œä¹Ÿè®¸æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¸»æ„ï¼Œä½†æˆ‘ä»æœªæƒ³åˆ°è¿‡ã€‚ç¨åæˆ‘å°†å›åˆ°è¿™æ–¹é¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç€è‰²å™¨ä»ç¡®å®šåƒç´ æ˜¯å¦åœ¨å¤©ç©ºä¸­å¼€å§‹ã€‚å¦‚æœåƒç´ ä½äºå¤©ç©ºä¸­ï¼ˆæ·±åº¦== 1.0ï¼‰ï¼Œåˆ™ç€è‰²å™¨å°†è¿”å›é»‘è‰²ã€‚å¦‚æœåƒç´ åœ¨åœºæ™¯ä¸­ï¼ˆæ·±åº¦&lt;1.0ï¼‰ï¼Œåˆ™æˆ‘ä»¬ä½¿ç”¨æ·±åº¦ç¼“å†²åŒºï¼ˆ7-11è¡Œï¼‰åœ¨ä¸–ç•Œä¸Šé‡æ–°åˆ›å»ºä½ç½®ï¼Œç„¶åç»§ç»­è®¡ç®—é›¾ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å»¶è¿Ÿé®è”½è¿‡ç¨‹åä¸ä¹…ï¼Œé›¾å°±ä¼šé€šè¿‡ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸å‘å‰è¿è¡Œç›¸å…³çš„æŸäº›å…ƒç´ å°šä¸å¯ç”¨ã€‚</font><font style="vertical-align: inherit;">åœ¨æ­¤ç‰¹å®šåœºæ™¯ä¸­ï¼Œåº”ç”¨äº†å»¶è¿Ÿçš„ç…§æ˜é‡ï¼Œç„¶åæ¸²æŸ“Geraltçš„å¤´å‘/è„¸éƒ¨/çœ¼ç›ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…³äºâ€œå·«å¸ˆ3â€ä¸­çš„é›¾ï¼Œæ‚¨éœ€è¦äº†è§£çš„ç¬¬ä¸€ä»¶äº‹ï¼šå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šâ€œé›¾çš„é¢œè‰²â€å’Œâ€œå¤§æ°”çš„é¢œè‰²â€ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">FogResult</span>  
 {</span>  
    float4 paramsFog;     <span class="hljs-comment">// RGB: color, A: influence  </span>
    float4 paramsAerial;  <span class="hljs-comment">// RGB: color, A: influence  </span>
 };</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰ä¸‰ç§é¢œè‰²ï¼šæ­£é¢ï¼Œä¸­é—´å’ŒèƒŒé¢ã€‚</font><font style="vertical-align: inherit;">ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¸¸é‡ç¼“å†²åŒºä¸­æœ‰è¯¸å¦‚â€œ FogColorFrontâ€ï¼Œâ€œ FogColorMiddleâ€ï¼Œâ€œ AerialColorBackâ€ç­‰æ•°æ®ã€‚...è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¼ å…¥çš„æ•°æ®ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b2/cd0/55d/0b2cd055d9f6876c57527b9934b3b6ad.png"></div><br>
<pre><code class="cpp hljs">   <span class="hljs-comment">// *** Inputs *** //  </span><font></font>
   float3 FogSunDir = cb12_v38.xyz;  <font></font>
   float3 FogColorFront = cb12_v39.xyz;  <font></font>
   float3 FogColorMiddle = cb12_v40.xyz;  <font></font>
   float3 FogColorBack = cb12_v41.xyz;  <font></font>
     <font></font>
   float4 FogBaseParams = cb12_v42;  <font></font>
   float4 FogDensityParamsScene = cb12_v43;  <font></font>
   float4 FogDensityParamsSky = cb12_v44;  <font></font>
     <font></font>
   float3 AerialColorFront = cb12_v45.xyz;  <font></font>
   float3 AerialColorMiddle = cb12_v46.xyz;  <font></font>
   float3 AerialColorBack = cb12_v47.xyz;  <font></font>
   float4 AerialParams = cb12_v48;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è®¡ç®—æœ€ç»ˆé¢œè‰²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å‘é‡å’Œæ ‡é‡ç§¯ã€‚</font><font style="vertical-align: inherit;">ç€è‰²å™¨å¯ä»¥è®¿é—®ä¸–ç•Œä¸Šçš„åƒç´ ä½ç½®ï¼Œç›¸æœºä½ç½®ï¼ˆcb12 [0] .xyzï¼‰å’Œé›¾/å…‰ç…§æ–¹å‘ï¼ˆcb12 [38] .xyzï¼‰ã€‚</font><font style="vertical-align: inherit;">è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿè®¡ç®—é›¾çš„å½¢å¼å’Œæ–¹å‘çš„å‘é‡çš„æ ‡é‡ç§¯ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">   float3 frag_vec = fragPosWorldSpace.xyz - customCameraPos.xyz;  
   <span class="hljs-keyword">float</span> frag_dist = length(frag_vec);  <font></font>
     <font></font>
   float3 frag_dir = frag_vec / frag_dist;  <font></font>
   <font></font>
   <span class="hljs-keyword">float</span> dot_fragDirSunDir = dot(GlobalLightDirection.xyz, frag_dir);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦è®¡ç®—æ··åˆæ¢¯åº¦ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ç»å¯¹æ ‡é‡ç§¯çš„å¹³æ–¹ï¼Œç„¶åå†æ¬¡å°†ç»“æœä¹˜ä»¥å–å†³äºè·ç¦»çš„æŸä¸ªå‚æ•°ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   float3 curr_col_fog;  <font></font>
   float3 curr_col_aerial;  <font></font>
   {  <font></font>
     <span class="hljs-keyword">float</span> _dot = dot_fragDirSunDir;  <font></font>
   <font></font>
     <span class="hljs-keyword">float</span> _dd = _dot;  <font></font>
     {  <font></font>
       <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _distOffset = <span class="hljs-number">-150</span>;  
       <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _distRange = <span class="hljs-number">500</span>;  
       <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _mul = <span class="hljs-number">1.0</span> / _distRange;  
       <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> _bias = _distOffset * _mul;  <font></font>
   <font></font>
       _dd = <span class="hljs-built_in">abs</span>(_dd);  <font></font>
       _dd *= _dd;  <font></font>
       _dd *= saturate( frag_dist * _mul + _bias );  <font></font>
     }  <font></font>
   <font></font>
     curr_col_fog = lerp( FogColorMiddle.xyz, (_dot&gt;<span class="hljs-number">0.0f</span> ? FogColorFront.xyz : FogColorBack.xyz), _dd );  <font></font>
     curr_col_aerial = lerp( AerialColorMiddle.xyz, (_dot&gt;<span class="hljs-number">0.0f</span> ? AerialColorFront.xyz : AerialColorBack.xyz), _dd );  <font></font>
   }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥ä»£ç å—ä½¿æˆ‘ä»¬æ¸…æ¥šåœ°çŸ¥é“è¿™0.002å’Œ-0.300çš„æ¥æºã€‚</font><font style="vertical-align: inherit;">æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œè§†å›¾çŸ¢é‡å’Œç…§æ˜çŸ¢é‡ä¹‹é—´çš„æ ‡é‡ç§¯è´Ÿè´£â€œå‰â€å’Œâ€œåâ€é¢œè‰²ä¹‹é—´çš„é€‰æ‹©ã€‚</font><font style="vertical-align: inherit;">èªæ˜ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯æœ€ç»ˆæ¢¯åº¦ï¼ˆ_ddï¼‰çš„å¯è§†åŒ–ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d43/f03/ca0/d43f03ca005d504abd5cd236007f34f4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œè®¡ç®—å¤§æ°”/é›¾æ°”çš„å½±å“è¦å¤æ‚å¾—å¤šã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬ä¸ä»…æä¾›rgbé¢œè‰²ï¼Œè¿˜æœ‰æ›´å¤šé€‰æ‹©ã€‚å®ƒä»¬åŒ…æ‹¬ä¾‹å¦‚åœºæ™¯å¯†åº¦ã€‚æˆ‘ä»¬ä½¿ç”¨raymarchingï¼ˆ16æ­¥ï¼Œè¿™å°±æ˜¯å¯ä»¥æ‰©å±•å¾ªç¯çš„åŸå› ï¼‰æ¥ç¡®å®šé›¾çš„å¤§å°å’Œæ¯”ä¾‹å› å­ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰äº†å‘é‡[camera ---&gt; world]ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ‰€æœ‰åˆ†é‡åˆ’åˆ†ä¸º16-è¿™å°†æ˜¯raymarchingçš„ä¸€æ­¥ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œè®¡ç®—ä¸­ä»…æ¶‰åŠ.zï¼ˆé«˜åº¦ï¼‰åˆ†é‡ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">curr_pos_z_step</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†è§£æœ‰å…³é€šè¿‡å°„çº¿è¡Œè¿›å®ç°çš„é›¾çš„æ›´å¤šä¿¡æ¯</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-keyword">float</span> fog_amount = <span class="hljs-number">1</span>;  
   <span class="hljs-keyword">float</span> fog_amount_scale = <span class="hljs-number">0</span>;  <font></font>
   [branch]  <font></font>
   <span class="hljs-keyword">if</span> ( frag_dist &gt;= AerialParams.y )  <font></font>
   {  <font></font>
     <span class="hljs-keyword">float</span> curr_pos_z_base = (customCameraPos.z + FogBaseParams.y) * density_factor;  
     <span class="hljs-keyword">float</span> curr_pos_z_step = frag_step.z * density_factor;  <font></font>
   <font></font>
     [unroll]  <font></font>
     <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">int</span> i=<span class="hljs-number">16</span>; i&gt;<span class="hljs-number">0</span>; --i )  <font></font>
     {  <font></font>
       fog_amount *= <span class="hljs-number">1</span> - saturate( density_sample_scale / (<span class="hljs-number">1</span> + max( <span class="hljs-number">0.0</span>, curr_pos_z_base + (i) * curr_pos_z_step ) ) );  <font></font>
     }  <font></font>
   <font></font>
     fog_amount = <span class="hljs-number">1</span> - fog_amount;  <font></font>
     fog_amount_scale = saturate( (frag_dist - AerialParams.y) * AerialParams.z );  <font></font>
   }  <font></font>
   <font></font>
   FogResult ret;  <font></font>
   <font></font>
   ret.paramsFog = float4 ( curr_col_fog, fog_amount_scale * <span class="hljs-built_in">pow</span>( <span class="hljs-built_in">abs</span>(fog_amount), final_exp_fog ) );  <font></font>
   ret.paramsAerial = float4 ( curr_col_aerial, fog_amount_scale * <span class="hljs-built_in">pow</span>( <span class="hljs-built_in">abs</span>(fog_amount), final_exp_aerial ) );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é›¾çš„æ•°é‡æ˜¾ç„¶å–å†³äºé«˜åº¦ï¼ˆåˆ†é‡.zï¼‰ï¼Œæœ€åé›¾çš„æ•°é‡å¢åŠ åˆ°é›¾/å¤§æ°”å‹çš„ç¨‹åº¦ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_exp_fog</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_exp_aerial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ä»å¸¸é‡ç¼“å†²åŒºä¸­è·å–çš„ï¼›</font><font style="vertical-align: inherit;">å®ƒä»¬ä½¿æ‚¨å¯ä»¥æ§åˆ¶é›¾å’Œå¤§æ°”çš„é¢œè‰²å¦‚ä½•éšç€æµ·æ‹”çš„å‡é«˜å½±å“ä¸–ç•Œã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é˜²é›¾</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å‘ç°çš„ç€è‰²å™¨æ²¡æœ‰ä»¥ä¸‹æ±‡ç¼–ä»£ç ç‰‡æ®µï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">109</span>:  mad_sat r1.xy, r0.wwww, cb12[<span class="hljs-number">189</span>].xzxx, cb12[<span class="hljs-number">189</span>].ywyy  
  <span class="hljs-number">110</span>:  add r5.xyz, -r3.xyzx, cb12[<span class="hljs-number">188</span>].xyzx  
  <span class="hljs-number">111</span>:  mad r5.xyz, r1.xxxx, r5.xyzx, r3.xyzx  
  <span class="hljs-number">112</span>:  add r0.z, l(<span class="hljs-number">-1.000000</span>), cb12[<span class="hljs-number">188</span>].w  
  <span class="hljs-number">113</span>:  mad r0.z, r1.y, r0.z, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">114</span>:  mul_sat r5.w, r0.w, r0.z  
  <span class="hljs-number">115</span>:  lt r0.z, l(<span class="hljs-number">0.000000</span>), cb12[<span class="hljs-number">192</span>].x  
  <span class="hljs-number">116</span>:  if_nz r0.z  
  <span class="hljs-number">117</span>:   mad_sat r1.xy, r0.wwww, cb12[<span class="hljs-number">191</span>].xzxx, cb12[<span class="hljs-number">191</span>].ywyy  
  <span class="hljs-number">118</span>:   add r6.xyz, -r3.xyzx, cb12[<span class="hljs-number">190</span>].xyzx  
  <span class="hljs-number">119</span>:   mad r3.xyz, r1.xxxx, r6.xyzx, r3.xyzx  
  <span class="hljs-number">120</span>:   add r0.z, l(<span class="hljs-number">-1.000000</span>), cb12[<span class="hljs-number">190</span>].w  
  <span class="hljs-number">121</span>:   mad r0.z, r1.y, r0.z, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">122</span>:   mul_sat r3.w, r0.w, r0.z  
  <span class="hljs-number">123</span>:   add r1.xyzw, -r5.xyzw, r3.xyzw  
  <span class="hljs-number">124</span>:   mad r5.xyzw, cb12[<span class="hljs-number">192</span>].xxxx, r1.xyzw, r5.xyzw  
  <span class="hljs-number">125</span>:  endif</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»æˆ‘çš„ç†è§£æ¥çœ‹ï¼Œè¿™å°±åƒé‡æ–°å®šä¹‰é¢œè‰²å’Œé›¾çš„æ•ˆæœä¸€æ ·ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤§å¤šæ•°æ—¶å€™ï¼Œä»…æ‰§è¡Œä¸€æ¬¡é‡æ–°å®šä¹‰ï¼ˆcb12_v192.xä¸º0.0ï¼‰ï¼Œä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…¶å€¼ä¸ºã€œ0.22ï¼Œå› æ­¤æˆ‘ä»¬è¿›è¡Œç¬¬äºŒæ¬¡è¦†ç›–ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cc7/2bd/1b8/cc72bd1b8cff0742cf4aad51a7e6ab3f.png"></div><br>
<pre><code class="cpp hljs"> <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> OVERRIDE_FOG  </span><font></font>
     <font></font>
   <span class="hljs-comment">// Override  </span>
   <span class="hljs-keyword">float</span> fog_influence = ret.paramsFog.w; <span class="hljs-comment">// r0.w  </span><font></font>
   <font></font>
   <span class="hljs-keyword">float</span> override1ColorScale = cb12_v189.x;  
   <span class="hljs-keyword">float</span> override1ColorBias = cb12_v189.y;  <font></font>
   float3 override1Color = cb12_v188.rgb;  <font></font>
     <font></font>
   <span class="hljs-keyword">float</span> override1InfluenceScale = cb12_v189.z;  
   <span class="hljs-keyword">float</span> override1InfluenceBias = cb12_v189.w;  
   <span class="hljs-keyword">float</span> override1Influence = cb12_v188.w;  <font></font>
     <font></font>
   <span class="hljs-keyword">float</span> override1ColorAmount = saturate(fog_influence * override1ColorScale + override1ColorBias);  
   <span class="hljs-keyword">float</span> override1InfluenceAmount = saturate(fog_influence * override1InfluenceScale + override1InfluenceBias);    <font></font>
     <font></font>
<font></font>
   float4 paramsFogOverride;  <font></font>
   paramsFogOverride.rgb = lerp(curr_col_fog, override1Color, override1ColorAmount ); <span class="hljs-comment">// ***r5.xyz   </span><font></font>
     <font></font>
   <span class="hljs-keyword">float</span> param1 = lerp(<span class="hljs-number">1.0</span>, override1Influence, override1InfluenceAmount); <span class="hljs-comment">// r0.x  </span>
   paramsFogOverride.w = saturate(param1 * fog_influence ); <span class="hljs-comment">// ** r5.w  </span><font></font>
   <font></font>
     <font></font>
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> extraFogOverride = cb12_v192.x;  <font></font>
     <font></font>
   [branch]   <font></font>
   <span class="hljs-keyword">if</span> (extraFogOverride &gt; <span class="hljs-number">0.0</span>)  <font></font>
   {  <font></font>
     <span class="hljs-keyword">float</span> override2ColorScale = cb12_v191.x;  
     <span class="hljs-keyword">float</span> override2ColorBias = cb12_v191.y;  <font></font>
     float3 override2Color = cb12_v190.rgb;  <font></font>
     <font></font>
     <span class="hljs-keyword">float</span> override2InfluenceScale = cb12_v191.z;  
     <span class="hljs-keyword">float</span> override2InfluenceBias = cb12_v191.w;  
     <span class="hljs-keyword">float</span> override2Influence = cb12_v190.w;  <font></font>
       <font></font>
     <span class="hljs-keyword">float</span> override2ColorAmount = saturate(fog_influence * override2ColorScale + override2ColorBias);  
     <span class="hljs-keyword">float</span> override2InfluenceAmount = saturate(fog_influence * override2InfluenceScale + override2InfluenceBias);  <font></font>
      <font></font>
<font></font>
     float4 paramsFogOverride2;  <font></font>
     paramsFogOverride2.rgb = lerp(curr_col_fog, override2Color, override2ColorAmount); <span class="hljs-comment">// r3.xyz   </span><font></font>
           <font></font>
     <span class="hljs-keyword">float</span> ov_param1 = lerp(<span class="hljs-number">1.0</span>, override2Influence, override2InfluenceAmount); <span class="hljs-comment">// r0.z  </span>
     paramsFogOverride2.w = saturate(ov_param1 * fog_influence); <span class="hljs-comment">// r3.w  </span><font></font>
   <font></font>
     paramsFogOverride = lerp(paramsFogOverride, paramsFogOverride2, extraFogOverride);  <font></font>
   <font></font>
   }  <font></font>
   ret.paramsFog = paramsFogOverride;  <font></font>
     <font></font>
 <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯æˆ‘ä»¬æ²¡æœ‰é‡æ–°å®šä¹‰é›¾ï¼ˆç¬¬ä¸€å¼ å›¾ç‰‡ï¼‰ï¼Œä¸€æ¬¡é‡æ–°å®šä¹‰ï¼ˆç¬¬äºŒå¼ å›¾ç‰‡ï¼‰å’Œä¸¤æ¬¡é‡æ–°å®šä¹‰ï¼ˆç¬¬ä¸‰å¼ å›¾ç‰‡ï¼Œæœ€ç»ˆç»“æœï¼‰çš„æœ€ç»ˆä»·æ ¼ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b9/011/3c8/3b90113c8ad27f287cdb29a25a37470d.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03a/791/d39/03a791d39e2082b80e86ea8daa488a64.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/375/d59/f51/375d59f5199e791efd99c218a0ea6f53.jpg"></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è°ƒèŠ‚ç¯å¢ƒå…‰é®æŒ¡</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å‘ç°çš„ç€è‰²å™¨ä¹Ÿæ ¹æœ¬ä¸ä½¿ç”¨ç¯å¢ƒå…‰é®æŒ¡ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å†æ¬¡çœ‹ä¸€ä¸‹AOçš„çº¹ç†å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„ä»£ç ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e7/c8f/e3e/3e7c8fe3ee0dc58e3007f9a1bad7f877.jpg"></div><br>
<pre><code class="cpp hljs">  <span class="hljs-number">13</span>:  ld_indexable(texture2d)(<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>,<span class="hljs-keyword">float</span>) r0.x, r0.xyzw, t2.xyzw  
  <span class="hljs-number">14</span>:  max r0.x, r0.x, cb3[<span class="hljs-number">1</span>].x  
  <span class="hljs-number">15</span>:  add r0.yzw, r1.xxyz, -cb12[<span class="hljs-number">0</span>].xxyz  
  <span class="hljs-number">16</span>:  dp3 r1.x, r0.yzwy, r0.yzwy  
  <span class="hljs-number">17</span>:  <span class="hljs-built_in">sqrt</span> r1.x, r1.x  
  <span class="hljs-number">18</span>:  add r1.y, r1.x, -cb3[<span class="hljs-number">0</span>].x  
  <span class="hljs-number">19</span>:  add r1.zw, -cb3[<span class="hljs-number">0</span>].xxxz, cb3[<span class="hljs-number">0</span>].yyyw  
  <span class="hljs-number">20</span>:  div_sat r1.y, r1.y, r1.z  
  <span class="hljs-number">21</span>:  mad r1.y, r1.y, r1.w, cb3[<span class="hljs-number">0</span>].z  
  <span class="hljs-number">22</span>:  add r0.x, r0.x, l(<span class="hljs-number">-1.000000</span>)  
  <span class="hljs-number">23</span>:  mad r0.x, r1.y, r0.x, l(<span class="hljs-number">1.000000</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹Ÿè®¸è¿™ä¸ªåœºæ™¯ä¸æ˜¯æœ€å¥½çš„ä¾‹å­ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é¥è¿œçš„å²›å±¿ä¸Šçœ‹ä¸åˆ°ç»†èŠ‚ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¸¸é‡ç¼“å†²åŒºï¼Œè¯¥ç¼“å†²åŒºç”¨äºè®¾ç½®ç¯å¢ƒå…‰é®æŒ¡å€¼ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/343/c52/af4/343c52af44338628770912801bc3b32c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é¦–å…ˆä»çº¹ç†åŠ è½½AOï¼Œç„¶åæ‰§è¡ŒmaxæŒ‡ä»¤ã€‚åœ¨æ­¤åœºæ™¯ä¸­ï¼Œcb3_v1.xéå¸¸é«˜ï¼ˆ0.96888ï¼‰ï¼Œè¿™ä½¿AOéå¸¸å¼±ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥ä»£ç çš„ä¸‹ä¸€éƒ¨åˆ†å°†è®¡ç®—ç…§ç›¸æœºçš„ä½ç½®ä¸ä¸–ç•Œä¸­åƒç´ ä¹‹é—´çš„è·ç¦»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ç›¸ä¿¡ä»£ç æœ‰æ—¶å¯ä»¥è¯´æ˜ä¸€åˆ‡ï¼Œå› æ­¤è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹HLSLï¼Œå®ƒå®Œæˆäº†å¤§éƒ¨åˆ†è®¾ç½®ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">AdjustAmbientOcclusion</span><span class="hljs-params">(in <span class="hljs-keyword">float</span> inputAO, in <span class="hljs-keyword">float</span> worldToCameraDistance)</span>  
 </span>{  
   <span class="hljs-comment">// *** Inputs *** //  </span>
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> aoDistanceStart = cb3_v0.x;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> aoDistanceEnd = cb3_v0.y;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> aoStrengthStart = cb3_v0.z;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> aoStrengthEnd = cb3_v0.w;  <font></font>
      <font></font>
   <span class="hljs-comment">// * Adjust AO  </span>
   <span class="hljs-keyword">float</span> aoDistanceIntensity = linstep( aoDistanceStart, aoDistanceEnd, worldToCameraDistance );  
   <span class="hljs-keyword">float</span> aoStrength = lerp(aoStrengthStart, aoStrengthEnd, aoDistanceIntensity);   
   <span class="hljs-keyword">float</span> adjustedAO = lerp(<span class="hljs-number">1.0</span>, inputAO, aoStrength);  <font></font>
     <font></font>
   <span class="hljs-keyword">return</span> adjustedAO;   <font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€è®¡ç®—å‡ºçš„ç›¸æœºä¸ä¸–ç•Œä¹‹é—´çš„è·ç¦»ç”¨äºlinstepå‡½æ•°ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å·²ç»çŸ¥é“æ­¤åŠŸèƒ½ï¼Œå®ƒå‡ºç°åœ¨å·äº‘ç€è‰²å™¨ä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œåœ¨å¸¸é‡ç¼“å†²åŒºä¸­ï¼Œæˆ‘ä»¬å…·æœ‰AOå¼€å§‹/ç»“æŸè·ç¦»å€¼ã€‚</font><font style="vertical-align: inherit;">linstepçš„è¾“å‡ºä¼šå½±å“AOçš„å¼ºåº¦ï¼ˆä»¥åŠæ¥è‡ªcbufferçš„å¼ºåº¦ï¼‰ï¼Œè€Œå¼ºåº¦ä¼šå½±å“AOçš„è¾“å‡ºã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šåƒç´ å¾ˆè¿œï¼Œä¾‹å¦‚ï¼Œè·ç¦»æ˜¯</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
500ã€‚linstepè¿”å›1.0ï¼›</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
aoStrengthç­‰äºaoStrengthEnd; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ä¼šå¯¼è‡´AOè¿”å›ï¼Œå¤§çº¦æ˜¯è¾“å…¥å€¼çš„77ï¼…ï¼ˆæœ€ç»ˆåŠ›ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤åŠŸèƒ½çš„ä¼ å…¥AOä¹‹å‰å·²æ¥å—maxæ“ä½œã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”¾åœ¨ä¸€èµ·</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”¶åˆ°é›¾çš„é¢œè‰²å’Œæ°”æ°›çš„é¢œè‰²å’Œæ•ˆæœåï¼Œæ‚¨ç»ˆäºå¯ä»¥å°†å®ƒä»¬ç»„åˆèµ·æ¥äº†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é¦–å…ˆä»äº§ç”Ÿçš„AOè¡°å‡æ•ˆæœå¼€å§‹ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   ...<font></font>
   FogResult fog = CalculateFog( worldPos, CameraPosition, fogStart, ao, <span class="hljs-literal">false</span> );  <font></font>
      <font></font>
   <span class="hljs-comment">// Apply AO to influence  </span><font></font>
   fog.paramsFog.w *= ao;  <font></font>
   fog.paramsAerial.w *= ao; <font></font>
      <font></font>
   <span class="hljs-comment">// Mix fog with scene color  </span>
   outColor = ApplyFog(fog, colorHDR);</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰ç¥å¥‡çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‹æƒ…éƒ½å‘ç”Ÿ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font><b><font style="vertical-align: inherit;">ApplyFog</font></b><font style="vertical-align: inherit;">å‡½æ•°ä¸­</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-function">float3 <span class="hljs-title">ApplyFog</span><span class="hljs-params">(FogResult fog, float3 color)</span>  
 </span>{  
   <span class="hljs-keyword">const</span> float3 LuminanceFactors = float3(<span class="hljs-number">0.333f</span>, <span class="hljs-number">0.555f</span>, <span class="hljs-number">0.222f</span>);  <font></font>
   <font></font>
   float3 aerialColor = dot(LuminanceFactors, color) * fog.paramsAerial.xyz;  <font></font>
   color = lerp(color, aerialColor, fog.paramsAerial.w);  <font></font>
   color = lerp(color, fog.paramsFog.xyz, fog.paramsFog.w);  <font></font>
    <font></font>
   <span class="hljs-keyword">return</span> color.xyz;  <font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—åƒç´ çš„äº®åº¦ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6bd/b00/570/6bdb005708a11953aeb8ce711a942f0d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åæˆ‘ä»¬å°†å…¶ä¹˜ä»¥å¤§æ°”çš„é¢œè‰²ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/f89/f04/e7df89f04524c4e547a91a645317a387.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬å°†HDRé¢œè‰²ä¸æ°”æ°›é¢œè‰²ç»“åˆèµ·æ¥ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cae/40a/912/cae40a9124b33e97aa38ac5b72b9a5ae.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åä¸€æ­¥æ˜¯å°†ä¸­é—´ç»“æœä¸é›¾çš„é¢œè‰²ç»“åˆèµ·æ¥ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ee/2f8/5ad/1ee2f85adc2cc870769985308b6dcc48.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±è¿™æ ·ï¼</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€äº›è°ƒè¯•å±å¹•æˆªå›¾</font></font></h4><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/012/b08/e69/012b08e69615702c9267f24f167dfa98.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤§æ°”æ•ˆåº”</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1b/c3a/f2c/b1bc3af2c5d59db606570a54e861659b.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤§æ°”è‰²</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d10/b17/0ab/d10b170ab255b3ff9b4d6fad60e1c1e3.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é›¾æ•ˆæœ</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d76/9ae/dde/d769aedde1917ab6024e524d9c99625d.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é›¾è‰²</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ad/b15/0dd/7adb150dddf4df73c8dc75e51aa9e138.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆå“åœºæ™¯æ— é›¾</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/fdc/507/f53fdc5076e000acb24a775ba7558e8a.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°æˆçš„åœºæ™¯åªæœ‰é›¾</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad1/223/e4a/ad1223e4aabc3dc3f07a77125b54211f.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Œæˆçš„åœºæ™¯åªæ˜¯ä¸»é›¾</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/375/d59/f51/375d59f5199e791efd99c218a0ea6f53.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°æˆçš„åœºæ™¯å†æ¬¡å……æ»¡é›¾æ°”ï¼Œä¾¿äºæ¯”è¾ƒ</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€»</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æƒ³æ‚¨å¯ä»¥ç†è§£ä¸Šé¢çš„è®¸å¤šå†…å®¹ï¼Œå¦‚æœæ‚¨çœ‹ä¸€ä¸‹ç€è‰²å™¨ï¼Œå®ƒå°±åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å¯ä»¥é«˜å…´åœ°è¯´è¯¥ç€è‰²å™¨</font><font style="vertical-align: inherit;">ä¸åŸå§‹</font><font style="vertical-align: inherit;">ç€è‰²å™¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Œå…¨ç›¸åŒ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -å®ƒä½¿æˆ‘éå¸¸é«˜å…´ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šå¸¸ï¼Œæœ€ç»ˆç»“æœé«˜åº¦ä¾èµ–ä¼ é€’ç»™ç€è‰²å™¨çš„å€¼ã€‚è¿™ä¸æ˜¯åœ¨è¾“å‡ºä¸­æä¾›å®Œç¾è‰²å½©çš„â€œç¥å¥‡â€è§£å†³æ–¹æ¡ˆï¼›å®ƒéœ€è¦å¤§é‡è¿­ä»£å’Œç¾å·¥æ‰èƒ½ä½¿æœ€ç»ˆç»“æœçœ‹èµ·æ¥ä¸é”™ã€‚æˆ‘è®¤ä¸ºè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å®Œæˆæ­¤è¿‡ç¨‹ä¹‹åï¼Œç»“æœå°†éå¸¸ä»¤äººä¿¡æœï¼Œå°±åƒè¿™ä¸ªæ—¥è½åœºæ™¯ä¸€æ ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Witcher 3 Sky Shaderè¿˜ä½¿ç”¨é›¾è®¡ç®—åœ¨åœ°å¹³çº¿é™„è¿‘åˆ›å»ºå¹³æ»‘çš„é¢œè‰²è¿‡æ¸¡ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œä¸€ç»„ä¸åŒçš„å¯†åº¦ç³»æ•°å°†ä¼ é€’ç»™å¤©ç©ºç€è‰²å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘æé†’æ‚¨-å¤§å¤šæ•°ç€è‰²å™¨ä¸æ˜¯æˆ‘åˆ›å»º/åˆ†æçš„ã€‚</font><font style="vertical-align: inherit;">æ‰€æœ‰ç¡®è®¤åº”å‘é€è‡³CD PROJEKT REDã€‚</font><font style="vertical-align: inherit;">æ”¯æŒä»–ä»¬ï¼Œä»–ä»¬åšå¾—å¾ˆå¥½ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬3éƒ¨åˆ†ã€‚æµæ˜Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ã€Šå·«å¸ˆ3ã€‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå°è€Œæœ‰è¶£çš„ç»†èŠ‚-æµæ˜Ÿã€‚</font><font style="vertical-align: inherit;">æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä»¬ä¼¼ä¹ä¸åœ¨Blood and Wine DLCä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è§†é¢‘ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å®ƒä»¬çš„å¤–è§‚ï¼š</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IWtutrr6ilE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•è·å¾—è¿™ç§æ•ˆæœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œæµæ˜Ÿçš„èº«ä½“æ¯”å°¾å·´äº®å¾—å¤šã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ä¸ªé‡è¦å±æ€§ï¼Œç¨åæˆ‘ä»¬å°†ä½¿ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬çš„è®®ç¨‹éå¸¸ç†Ÿæ‚‰ï¼šé¦–å…ˆï¼Œæˆ‘å°†æè¿°å¸¸è§„å±æ€§ï¼Œç„¶åå†è®¨è®ºä¸å‡ ä½•ç›¸å…³çš„ä¸»é¢˜ï¼Œæœ€åï¼Œæˆ‘ä»¬å°†è½¬åˆ°å‘ç”Ÿæœ€æœ‰è¶£çš„äº‹æƒ…çš„åƒç´ ç€è‰²å™¨ã€‚</font></font><br>
<cut></cut><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.æ¦‚è¿°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç®€è¦æè¿°æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å¤©ç©ºï¼Œå¤©ç©ºå’Œæœˆäº®çš„ç©¹é¡¶ä¹‹åï¼Œæµæ˜Ÿåœ¨ä¸»åŠ¨é€šé“ä¸­è¢«å¸å¼•ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c5/a71/7db/1c5a717dbd047aeaa183ce2a25e394d9.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DrawIndexedï¼ˆ720ï¼‰-å¤©ç©ºçš„åœ†é¡¶ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DrawIndexedï¼ˆ2160ï¼‰-å¤©ç©º/æœˆäº®çš„çƒä½“ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DrawIndexedï¼ˆ36ï¼‰-æ— å…³ç´§è¦ï¼Œçœ‹èµ·æ¥åƒæ˜¯å¤ªé˜³çš„å¹³è¡Œå…­é¢ä½“ï¼ˆï¼Ÿï¼‰</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DrawIndexedï¼ˆ12ï¼‰-æµæ˜Ÿ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DrawIndexedInstancedï¼ˆ1116ï¼Œ1ï¼‰ -å·äº‘</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±åƒ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·äº‘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€æ ·</font><font style="vertical-align: inherit;">ï¼Œæ¯ä¸ªæµæ˜Ÿè¿ç»­ç»˜åˆ¶ä¸¤æ¬¡ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/baa/27d/e4c/baa27de4ced017770e9c89a01e136abd.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¬¬ä¸€æ¬¡æŠ½å¥–ç”µè¯ä¹‹å‰</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cc8/78b/cef/cc878bcef6dcc4b58e85f3a62f90be31.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€æ¬¡æŠ½å¥–çš„ç»“æœ</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ee/33f/f6c/0ee33ff6cef3d11ca7cd460f21dc2b3f.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬äºŒæ¬¡æŠ½å¥–çš„ç»“æœ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ­¤å¤–ï¼Œä¸è¯¥æ¸¸æˆå…ˆå‘åˆ¶äººçš„é€šè¡Œè¯ä¸­çš„è®¸å¤šè¦ç´ ä¸€æ ·ï¼Œä½¿ç”¨äº†ä»¥ä¸‹æ··åˆçŠ¶æ€ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/aec/b8a/263aecb8afa21e2b79b0333bcde55011.jpg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.å‡ ä½•</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å‡ ä½•æ–¹é¢ï¼Œé¦–å…ˆè¦æåˆ°çš„æ˜¯ï¼Œæ¯ä¸ªæµæ˜Ÿéƒ½ç”±ä¸€ä¸ªå¸¦æœ‰texcoordsçš„ç»†å››è¾¹å½¢è¡¨ç¤ºï¼š4ä¸ªé¡¶ç‚¹ï¼Œ6ä¸ªç´¢å¼•ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æœ€ç®€å•çš„å››è¾¹å½¢ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82c/fbf/96b/82cfbf96bbc652ea5ac32a5e568434a3.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€é¢—æµæ˜Ÿ</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/83c/59e/3f7/83c59e3f7e685d6e7f2080e88ff5be25.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è¿‘ä¼¼å››åˆ†ä¹‹ä¸€ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥çœ‹åˆ°è¡¨ç¤ºä¸¤ä¸ªä¸‰è§’å½¢çš„çº¿çš„çº¿æ¡†æ˜¾ç¤ºã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç­‰ä¸€ä¸‹ï¼Œä½†æ˜¯æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DrawIndexedï¼ˆ12ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼</font><font style="vertical-align: inherit;">è¿™æ˜¯å¦æ„å‘³ç€æˆ‘ä»¬åŒæ—¶ç”»äº†ä¸¤ä¸ªæµæ˜Ÿï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d55/b39/bb2/d55b39bb2d2ea5908f4576d6396455fa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ­¤æ¡†æ¶ä¸­ï¼Œå…¶ä¸­ä¸€é¢—æµæ˜Ÿå®Œå…¨åœ¨èƒ½è§åº¦é‡‘å­—å¡”ä¹‹å¤–ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é¡¶ç‚¹ç€è‰²å™¨çš„æ±‡ç¼–ä»£ç ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> vs_5_0  <font></font>
    dcl_globalFlags refactoringAllowed  <font></font>
    dcl_constantbuffer cb1[<span class="hljs-number">9</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb2[<span class="hljs-number">3</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb12[<span class="hljs-number">193</span>], immediateIndexed  <font></font>
    dcl_input v0.xyz  <font></font>
    dcl_input v1.xyzw  <font></font>
    dcl_input v2.xy  <font></font>
    dcl_input v3.xy  <font></font>
    dcl_input v4.xy  <font></font>
    dcl_input v5.xyz  <font></font>
    dcl_input v6.x  <font></font>
    dcl_input v7.x  <font></font>
    dcl_output o0.xyzw  <font></font>
    dcl_output o1.xyzw  <font></font>
    dcl_output o2.xy  <font></font>
    dcl_output o3.xyzw  <font></font>
    dcl_output_siv o4.xyzw, position  <font></font>
    dcl_temps <span class="hljs-number">5</span>  
   <span class="hljs-number">0</span>: mov r0.xyz, v0.xyzx  
   <span class="hljs-number">1</span>: mov r0.w, l(<span class="hljs-number">1.000000</span>)  
   <span class="hljs-number">2</span>: dp4 r1.x, r0.xyzw, cb2[<span class="hljs-number">0</span>].xyzw  
   <span class="hljs-number">3</span>: dp4 r1.y, r0.xyzw, cb2[<span class="hljs-number">1</span>].xyzw  
   <span class="hljs-number">4</span>: dp4 r1.z, r0.xyzw, cb2[<span class="hljs-number">2</span>].xyzw  
   <span class="hljs-number">5</span>: add r0.x, v2.x, v2.y  
   <span class="hljs-number">6</span>: add r0.y, -v2.y, v2.x  
   <span class="hljs-number">7</span>: add r2.xyz, -r1.zxyz, cb1[<span class="hljs-number">8</span>].zxyz  
   <span class="hljs-number">8</span>: dp3 r0.z, r2.xyzx, r2.xyzx  
   <span class="hljs-number">9</span>: rsq r0.z, r0.z  
  <span class="hljs-number">10</span>: mul r2.xyz, r0.zzzz, r2.xyzx  
  <span class="hljs-number">11</span>: dp3 r0.z, v5.xyzx, v5.xyzx  
  <span class="hljs-number">12</span>: rsq r0.z, r0.z  
  <span class="hljs-number">13</span>: mul r3.xyz, r0.zzzz, v5.xyzx  
  <span class="hljs-number">14</span>: mul r4.xyz, r2.xyzx, r3.yzxy  
  <span class="hljs-number">15</span>: mad r2.xyz, r2.zxyz, r3.zxyz, -r4.xyzx  
  <span class="hljs-number">16</span>: dp3 r0.z, r2.xyzx, r2.xyzx  
  <span class="hljs-number">17</span>: rsq r0.z, r0.z  
  <span class="hljs-number">18</span>: mul r2.xyz, r0.zzzz, r2.xyzx  
  <span class="hljs-number">19</span>: mad r0.z, v7.x, v6.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">20</span>: mul r3.xyz, r0.zzzz, r3.xyzx  
  <span class="hljs-number">21</span>: mul r3.xyz, r3.xyzx, v3.xxxx  
  <span class="hljs-number">22</span>: mul r2.xyz, r2.xyzx, v3.yyyy  
  <span class="hljs-number">23</span>: mad r0.xzw, r3.xxyz, r0.xxxx, r1.xxyz  
  <span class="hljs-number">24</span>: mad r0.xyz, r2.xyzx, r0.yyyy, r0.xzwx  
  <span class="hljs-number">25</span>: mov r0.w, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">26</span>: dp4 o4.x, r0.xyzw, cb1[<span class="hljs-number">0</span>].xyzw  
  <span class="hljs-number">27</span>: dp4 o4.y, r0.xyzw, cb1[<span class="hljs-number">1</span>].xyzw  
  <span class="hljs-number">28</span>: dp4 o4.z, r0.xyzw, cb1[<span class="hljs-number">2</span>].xyzw  
  <span class="hljs-number">29</span>: dp4 o4.w, r0.xyzw, cb1[<span class="hljs-number">3</span>].xyzw  
  <span class="hljs-number">30</span>: add r0.xyz, r0.xyzx, -cb12[<span class="hljs-number">0</span>].xyzx  
  <span class="hljs-number">31</span>: dp3 r0.w, r0.xyzx, r0.xyzx  
  <span class="hljs-number">32</span>: <span class="hljs-built_in">sqrt</span> r0.w, r0.w  
  <span class="hljs-number">33</span>: div r0.xyz, r0.xyzx, r0.wwww  
  <span class="hljs-number">34</span>: add r0.w, r0.w, -cb12[<span class="hljs-number">22</span>].z  
  <span class="hljs-number">35</span>: max r0.w, r0.w, l(<span class="hljs-number">0</span>)  
  <span class="hljs-number">36</span>: min r0.w, r0.w, cb12[<span class="hljs-number">42</span>].z  
  <span class="hljs-number">37</span>: dp3 r0.x, cb12[<span class="hljs-number">38</span>].xyzx, r0.xyzx  
  <span class="hljs-number">38</span>: mul r0.y, <span class="hljs-built_in">abs</span>(r0.x), <span class="hljs-built_in">abs</span>(r0.x)  
  <span class="hljs-number">39</span>: mad_sat r1.x, r0.w, l(<span class="hljs-number">0.002000</span>), l(<span class="hljs-number">-0.300000</span>)  
  <span class="hljs-number">40</span>: mul r0.y, r0.y, r1.x  
  <span class="hljs-number">41</span>: lt r1.x, l(<span class="hljs-number">0</span>), r0.x  
  <span class="hljs-number">42</span>: movc r1.yzw, r1.xxxx, cb12[<span class="hljs-number">39</span>].xxyz, cb12[<span class="hljs-number">41</span>].xxyz  
  <span class="hljs-number">43</span>: add r1.yzw, r1.yyzw, -cb12[<span class="hljs-number">40</span>].xxyz  
  <span class="hljs-number">44</span>: mad r1.yzw, r0.yyyy, r1.yyzw, cb12[<span class="hljs-number">40</span>].xxyz  
  <span class="hljs-number">45</span>: movc r2.xyz, r1.xxxx, cb12[<span class="hljs-number">45</span>].xyzx, cb12[<span class="hljs-number">47</span>].xyzx  
  <span class="hljs-number">46</span>: add r2.xyz, r2.xyzx, -cb12[<span class="hljs-number">46</span>].xyzx  
  <span class="hljs-number">47</span>: mad o0.xyz, r0.yyyy, r2.xyzx, cb12[<span class="hljs-number">46</span>].xyzx  
  <span class="hljs-number">48</span>: ge r0.y, r0.w, cb12[<span class="hljs-number">48</span>].y  
  <span class="hljs-number">49</span>: if_nz r0.y  
  <span class="hljs-number">50</span>:  mad r0.y, r0.z, cb12[<span class="hljs-number">22</span>].z, cb12[<span class="hljs-number">0</span>].z  
  <span class="hljs-number">51</span>:  mul r0.z, r0.w, r0.z  
  <span class="hljs-number">52</span>:  mul r0.z, r0.z, l(<span class="hljs-number">0.062500</span>)  
  <span class="hljs-number">53</span>:  mul r1.x, r0.w, cb12[<span class="hljs-number">43</span>].x  
  <span class="hljs-number">54</span>:  mul r1.x, r1.x, l(<span class="hljs-number">0.062500</span>)  
  <span class="hljs-number">55</span>:  add r0.x, r0.x, cb12[<span class="hljs-number">42</span>].x  
  <span class="hljs-number">56</span>:  add r2.x, cb12[<span class="hljs-number">42</span>].x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">57</span>:  div_sat r0.x, r0.x, r2.x  
  <span class="hljs-number">58</span>:  add r2.x, -cb12[<span class="hljs-number">43</span>].z, cb12[<span class="hljs-number">43</span>].y  
  <span class="hljs-number">59</span>:  mad r0.x, r0.x, r2.x, cb12[<span class="hljs-number">43</span>].z  
  <span class="hljs-number">60</span>:  add r0.y, r0.y, cb12[<span class="hljs-number">42</span>].y  
  <span class="hljs-number">61</span>:  mul r2.x, r0.x, r0.y  
  <span class="hljs-number">62</span>:  mul r0.z, r0.x, r0.z  
  <span class="hljs-number">63</span>:  mad r3.xyzw, r0.zzzz, l(<span class="hljs-number">16.000000</span>, <span class="hljs-number">15.000000</span>, <span class="hljs-number">14.000000</span>, <span class="hljs-number">13.000000</span>), r2.xxxx  
  <span class="hljs-number">64</span>:  max r3.xyzw, r3.xyzw, l(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  
  <span class="hljs-number">65</span>:  add r3.xyzw, r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">66</span>:  div_sat r3.xyzw, r1.xxxx, r3.xyzw  
  <span class="hljs-number">67</span>:  add r3.xyzw, -r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">68</span>:  mul r2.y, r3.y, r3.x  
  <span class="hljs-number">69</span>:  mul r2.y, r3.z, r2.y  
  <span class="hljs-number">70</span>:  mul r2.y, r3.w, r2.y  
  <span class="hljs-number">71</span>:  mad r3.xyzw, r0.zzzz, l(<span class="hljs-number">12.000000</span>, <span class="hljs-number">11.000000</span>, <span class="hljs-number">10.000000</span>, <span class="hljs-number">9.000000</span>), r2.xxxx  
  <span class="hljs-number">72</span>:  max r3.xyzw, r3.xyzw, l(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  
  <span class="hljs-number">73</span>:  add r3.xyzw, r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">74</span>:  div_sat r3.xyzw, r1.xxxx, r3.xyzw  
  <span class="hljs-number">75</span>:  add r3.xyzw, -r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">76</span>:  mul r2.y, r2.y, r3.x  
  <span class="hljs-number">77</span>:  mul r2.y, r3.y, r2.y  
  <span class="hljs-number">78</span>:  mul r2.y, r3.z, r2.y  
  <span class="hljs-number">79</span>:  mul r2.y, r3.w, r2.y  
  <span class="hljs-number">80</span>:  mad r3.xyzw, r0.zzzz, l(<span class="hljs-number">8.000000</span>, <span class="hljs-number">7.000000</span>, <span class="hljs-number">6.000000</span>, <span class="hljs-number">5.000000</span>), r2.xxxx  
  <span class="hljs-number">81</span>:  max r3.xyzw, r3.xyzw, l(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  
  <span class="hljs-number">82</span>:  add r3.xyzw, r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">83</span>:  div_sat r3.xyzw, r1.xxxx, r3.xyzw  
  <span class="hljs-number">84</span>:  add r3.xyzw, -r3.xyzw, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">85</span>:  mul r2.y, r2.y, r3.x  
  <span class="hljs-number">86</span>:  mul r2.y, r3.y, r2.y  
  <span class="hljs-number">87</span>:  mul r2.y, r3.z, r2.y  
  <span class="hljs-number">88</span>:  mul r2.y, r3.w, r2.y  
  <span class="hljs-number">89</span>:  mad r2.zw, r0.zzzz, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">4.000000</span>, <span class="hljs-number">3.000000</span>), r2.xxxx  
  <span class="hljs-number">90</span>:  max r2.zw, r2.zzzw, l(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  
  <span class="hljs-number">91</span>:  add r2.zw, r2.zzzw, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">92</span>:  div_sat r2.zw, r1.xxxx, r2.zzzw  
  <span class="hljs-number">93</span>:  add r2.zw, -r2.zzzw, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">1.000000</span>, <span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">94</span>:  mul r2.y, r2.z, r2.y  
  <span class="hljs-number">95</span>:  mul r2.y, r2.w, r2.y  
  <span class="hljs-number">96</span>:  mad r2.x, r0.z, l(<span class="hljs-number">2.000000</span>), r2.x  
  <span class="hljs-number">97</span>:  max r2.x, r2.x, l(<span class="hljs-number">0</span>)  
  <span class="hljs-number">98</span>:  add r2.x, r2.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">99</span>:  div_sat r2.x, r1.x, r2.x  
  <span class="hljs-number">100</span>:  add r2.x, -r2.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">101</span>:  mul r2.x, r2.x, r2.y  
  <span class="hljs-number">102</span>:  mad r0.x, r0.y, r0.x, r0.z  
  <span class="hljs-number">103</span>:  max r0.x, r0.x, l(<span class="hljs-number">0</span>)  
  <span class="hljs-number">104</span>:  add r0.x, r0.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">105</span>:  div_sat r0.x, r1.x, r0.x  
  <span class="hljs-number">106</span>:  add r0.x, -r0.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">107</span>:  mad r0.x, -r2.x, r0.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">108</span>:  add r0.y, r0.w, -cb12[<span class="hljs-number">48</span>].y  
  <span class="hljs-number">109</span>:  mul_sat r0.y, r0.y, cb12[<span class="hljs-number">48</span>].z  
  <span class="hljs-number">110</span>: <span class="hljs-keyword">else</span>  
  <span class="hljs-number">111</span>:  mov r0.xy, l(<span class="hljs-number">1.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)  
  <span class="hljs-number">112</span>: endif  
  <span class="hljs-number">113</span>: <span class="hljs-built_in">log</span> r0.x, r0.x  
  <span class="hljs-number">114</span>: mul r0.z, r0.x, cb12[<span class="hljs-number">42</span>].w  
  <span class="hljs-number">115</span>: <span class="hljs-built_in">exp</span> r0.z, r0.z  
  <span class="hljs-number">116</span>: mul r0.z, r0.z, r0.y  
  <span class="hljs-number">117</span>: mul r0.x, r0.x, cb12[<span class="hljs-number">48</span>].x  
  <span class="hljs-number">118</span>: <span class="hljs-built_in">exp</span> r0.x, r0.x  
  <span class="hljs-number">119</span>: mul o0.w, r0.x, r0.y  
  <span class="hljs-number">120</span>: mad_sat r0.xy, r0.zzzz, cb12[<span class="hljs-number">189</span>].xzxx, cb12[<span class="hljs-number">189</span>].ywyy  
  <span class="hljs-number">121</span>: add r2.xyz, -r1.yzwy, cb12[<span class="hljs-number">188</span>].xyzx  
  <span class="hljs-number">122</span>: mad r2.xyz, r0.xxxx, r2.xyzx, r1.yzwy  
  <span class="hljs-number">123</span>: add r0.x, cb12[<span class="hljs-number">188</span>].w, l(<span class="hljs-number">-1.000000</span>)  
  <span class="hljs-number">124</span>: mad r0.x, r0.y, r0.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">125</span>: mul_sat r2.w, r0.x, r0.z  
  <span class="hljs-number">126</span>: lt r0.x, l(<span class="hljs-number">0</span>), cb12[<span class="hljs-number">192</span>].x  
  <span class="hljs-number">127</span>: if_nz r0.x  
  <span class="hljs-number">128</span>:  mad_sat r0.xy, r0.zzzz, cb12[<span class="hljs-number">191</span>].xzxx, cb12[<span class="hljs-number">191</span>].ywyy  
  <span class="hljs-number">129</span>:  add r3.xyz, -r1.yzwy, cb12[<span class="hljs-number">190</span>].xyzx  
  <span class="hljs-number">130</span>:  mad r1.xyz, r0.xxxx, r3.xyzx, r1.yzwy  
  <span class="hljs-number">131</span>:  add r0.x, cb12[<span class="hljs-number">190</span>].w, l(<span class="hljs-number">-1.000000</span>)  
  <span class="hljs-number">132</span>:  mad r0.x, r0.y, r0.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">133</span>:  mul_sat r1.w, r0.x, r0.z  
  <span class="hljs-number">134</span>:  add r0.xyzw, -r2.xyzw, r1.xyzw  
  <span class="hljs-number">135</span>:  mad o1.xyzw, cb12[<span class="hljs-number">192</span>].xxxx, r0.xyzw, r2.xyzw  
  <span class="hljs-number">136</span>: <span class="hljs-keyword">else</span>  
  <span class="hljs-number">137</span>:  mov o1.xyzw, r2.xyzw  
  <span class="hljs-number">138</span>: endif  
  <span class="hljs-number">139</span>: mov o3.xyzw, v1.xyzw  
  <span class="hljs-number">140</span>: mov o2.xy, v4.yxyy  
  <span class="hljs-number">141</span>: ret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œé›¾çš„è®¡ç®—å¯ä»¥ç«‹å³å¼•èµ·æ³¨æ„ï¼ˆç¬¬30-138è¡Œï¼‰ã€‚å‡ºäºæ€§èƒ½åŸå› ï¼Œè®¡ç®—é›¾é¡¶æ˜¯æœ‰æ„ä¹‰çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¦‚æ­¤ç²¾ç¡®çš„é›¾-æµæ˜Ÿä½“é€šå¸¸é£è¿‡Geraltçš„å¤´é¡¶å¹¶ä¸”ä¸ä¼šåˆ°è¾¾åœ°å¹³çº¿ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤§æ°”å‚æ•°ï¼ˆrgb =é¢œè‰²ï¼Œa =å½±å“ï¼‰å­˜å‚¨åœ¨o0.xyzwä¸­ï¼Œé›¾å‚æ•°å­˜å‚¨åœ¨o1.xyzwä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o2.xyï¼ˆç¬¬140è¡Œï¼‰åªæ˜¯texcoordsã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o3.xyzwï¼ˆç¬¬139è¡Œï¼‰æ— å…³ç´§è¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è®©æˆ‘ä»¬è°ˆè°ˆè®¡ç®—ä¸–ç•Œä½ç½®çš„å‡ å¥è¯ã€‚é¡¶ç‚¹ç€è‰²å™¨æ‰§è¡Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¿å‘Šç‰Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚é¦–å…ˆï¼Œå¹¿å‘Šç‰Œçš„ä¼ å…¥æ•°æ®æ¥è‡ªé¡¶ç‚¹ç¼“å†²åŒº-è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒä»¬ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€ä¸ªæ•°æ®æ˜¯æ’åï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/99a/470/7d5/99a4707d5f914222e7d55e2435f5692f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™é‡Œæœ‰2ä¸ªå››è¾¹å½¢ï¼š8ä¸ªé¡¶ç‚¹ï¼Œ12ä¸ªç´¢å¼•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ä¸ºä»€ä¹ˆæ¯ä¸ªå››è¾¹å½¢çš„ä½ç½®éƒ½ç›¸åŒï¼Ÿ</font><font style="vertical-align: inherit;">éå¸¸ç®€å•-è¿™æ˜¯å››è¾¹å½¢ä¸­å¿ƒçš„ä½ç½®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œæ¯ä¸ªé¡¶ç‚¹ä»å››è¾¹å½¢çš„ä¸­å¿ƒåˆ°è¾¹ç¼˜éƒ½æœ‰ä¸€ä¸ªåç§»é‡ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cde/fdf/7e0/cdefdf7e0e5cfe91c4b9d20257b529b4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ„å‘³ç€æ¯ä¸ªæµæ˜Ÿåœ¨ä¸–ç•Œç©ºé—´ä¸­çš„å¤§å°ä¸ºï¼ˆ400ï¼Œ3ï¼‰ä¸ªå•ä½ã€‚</font><font style="vertical-align: inherit;">ï¼ˆåœ¨Witcher 3ä¸­ï¼Œåœ¨XYå¹³é¢ä¸Šï¼ŒZè½´æŒ‡å‘ä¸Šï¼‰</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯ä¸ªé¡¶ç‚¹å…·æœ‰çš„æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ä¸–ç•Œç©ºé—´ä¸­æ§åˆ¶æµæ˜Ÿè¿åŠ¨çš„å•ä½æ–¹å‘å‘é‡ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/416/06d/71a/41606d71a99d2f751f8b1d5a609b6c96.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæ•°æ®æ¥è‡ªCPUï¼Œå› æ­¤å¾ˆéš¾ç†è§£å…¶è®¡ç®—æ–¹å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­çœ‹å¹¿å‘Šç‰Œä»£ç ã€‚</font><font style="vertical-align: inherit;">è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•-é¦–å…ˆï¼Œæ‚¨ä»å››è¾¹å½¢çš„ä¸­å¿ƒåˆ°ç›¸æœºè·å–ä¸€ä¸ªå•ä½å‘é‡ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-number">7</span>: add r2.xyz, -r1.zxyz, cb1[<span class="hljs-number">8</span>].zxyz  
   <span class="hljs-number">8</span>: dp3 r0.z, r2.xyzx, r2.xyzx  
   <span class="hljs-number">9</span>: rsq r0.z, r0.z  
  <span class="hljs-number">10</span>: mul r2.xyz, r0.zzzz, r2.xyzx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ§åˆ¶åˆ‡æ˜Ÿè¿åŠ¨çš„å•åˆ‡å‘é‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡è®¾æ­¤å‘é‡å·²åœ¨CPUç«¯è¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œåˆ™è¯¥æ ‡å‡†åŒ–æ˜¯å¤šä½™çš„ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">11</span>: dp3 r0.z, v5.xyzx, v5.xyzx  
  <span class="hljs-number">12</span>: rsq r0.z, r0.z  
  <span class="hljs-number">13</span>: mul r3.xyz, r0.zzzz, v5.xyzx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæœ‰ä¸¤ä¸ªå‘é‡ï¼Œåˆ™ä½¿ç”¨å‘é‡ä¹˜ç§¯ç¡®å®šå‚ç›´äºä¸¤ä¸ªä¼ å…¥å‘é‡çš„åŒåˆ‡å‘é‡ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">14</span>: mul r4.xyz, r2.xyzx, r3.yzxy  
  <span class="hljs-number">15</span>: mad r2.xyz, r2.zxyz, r3.zxyz, -r4.xyzx  
  <span class="hljs-number">16</span>: dp3 r0.z, r2.xyzx, r2.xyzx  
  <span class="hljs-number">17</span>: rsq r0.z, r0.z  
  <span class="hljs-number">18</span>: mul r2.xyz, r0.zzzz, r2.xyzx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å·²å°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ‡çº¿</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆr3.xyzï¼‰å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒ</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">åˆ‡çº¿</font></i><font style="vertical-align: inherit;">ï¼ˆr2.xyzï¼‰</font><font style="vertical-align: inherit;">å½’ä¸€åŒ–</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ä»‹ç»</font><font style="vertical-align: inherit;">ä¸</font><font style="vertical-align: inherit;">ä¼ å…¥å…ƒç´ </font><i><font style="vertical-align: inherit;">TEXCOORD1</font></i><font style="vertical-align: inherit;">ç›¸å¯¹åº”</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xsize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ysize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä¾‹å¦‚ï¼ˆ-200ï¼Œ1.50ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹ä¸–ç•Œç©ºé—´ä½ç½®çš„æœ€ç»ˆè®¡ç®—å¦‚ä¸‹ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">19</span>: mad r0.z, v7.x, v6.x, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">20</span>: mul r3.xyz, r0.zzzz, r3.xyzx  
  <span class="hljs-number">21</span>: mul r3.xyz, r3.xyzx, v3.xxxx  
  <span class="hljs-number">22</span>: mul r2.xyz, r2.xyzx, v3.yyyy  
  <span class="hljs-number">23</span>: mad r0.xzw, r3.xxyz, r0.xxxx, r1.xxyz  
  <span class="hljs-number">24</span>: mad r0.xyz, r2.xyzx, r0.yyyy, r0.xzwx  
  <span class="hljs-number">25</span>: mov r0.w, l(<span class="hljs-number">1.000000</span>) </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡è®¾r0.xï¼Œr0.yå’Œr0.zç­‰äº1.0ï¼Œåˆ™ç®€åŒ–äº†æœ€ç»ˆè®¡ç®—ï¼š</font></font><br>
<br>
<code>worldSpacePosition = quadCenter + tangent * Xsize + bitangent * Ysize</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åä¸€éƒ¨åˆ†æ˜¯å°†ä¸–ç•Œç©ºé—´ä¸­çš„ä½ç½®ä¸è§†å›¾æŠ•å½±çŸ©é˜µç®€å•ç›¸ä¹˜ä»¥è·å¾—SV_Positionï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-number">26</span>: dp4 o4.x, r0.xyzw, cb1[<span class="hljs-number">0</span>].xyzw  
  <span class="hljs-number">27</span>: dp4 o4.y, r0.xyzw, cb1[<span class="hljs-number">1</span>].xyzw  
  <span class="hljs-number">28</span>: dp4 o4.z, r0.xyzw, cb1[<span class="hljs-number">2</span>].xyzw  
  <span class="hljs-number">29</span>: dp4 o4.w, r0.xyzw, cb1[<span class="hljs-number">3</span>].xyzw  </code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.åƒç´ ç€è‰²å™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚â€œæ¦‚è¿°â€éƒ¨åˆ†æ‰€è¿°ï¼Œä½¿ç”¨ä»¥ä¸‹æ··åˆçŠ¶æ€ï¼š</font><font style="vertical-align: inherit;">
å…¶ä¸­</font><i><font style="vertical-align: inherit;">SrcColor</font></i><font style="vertical-align: inherit;">å’Œ</font><i><font style="vertical-align: inherit;">SrcAlpha</font></i><font style="vertical-align: inherit;">åˆ†åˆ«æ˜¯åƒç´ ç€è‰²å™¨ä¸­çš„.rgbå’Œ.aåˆ†é‡ï¼Œè€Œ</font><i><font style="vertical-align: inherit;">DestColoræ˜¯</font></i><font style="vertical-align: inherit;">å½“å‰åœ¨rendertargetä¸­</font><i><font style="vertical-align: inherit;">çš„.rgb</font></i><font style="vertical-align: inherit;">é¢œè‰²ã€‚</font><font style="vertical-align: inherit;">
æ§åˆ¶é€æ˜åº¦çš„ä¸»è¦æŒ‡æ ‡æ˜¯</font><i><font style="vertical-align: inherit;">SrcAlpha</font></i><font style="vertical-align: inherit;">ã€‚è®¸å¤šä¸»åŠ¨å‹æ¸¸æˆç€è‰²å™¨å°†å…¶è®¡ç®—ä¸ºä¸é€æ˜åº¦ï¼Œå¹¶æœ€ç»ˆå°†å…¶åº”ç”¨å¦‚ä¸‹ï¼š</font><font style="vertical-align: inherit;">
å æ˜Ÿç€è‰²å™¨ä¹Ÿä¸ä¾‹å¤–ã€‚æŒ‰ç…§è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬è€ƒè™‘</font><i><font style="vertical-align: inherit;">ä¸é€æ˜åº¦</font></i><font style="vertical-align: inherit;">ä¸º1.0ã€0.1å’Œ0.0çš„</font><font style="vertical-align: inherit;">ä¸‰ç§æƒ…å†µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<code>FinalColor = SrcColor * One + DestColor * (1.0 - SrcAlpha) =<br>
FinalColor = SrcColor + DestColor * (1.0 - SrcAlpha)</code><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<code>return float4( color * opacity, opacity )</code><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<code>a) opacity = 1.0<br>
<br>
FinalColor = color * opacity + DestColor * (1.0 - opacity) =<br>
FinalColor = color = SrcColor</code><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/934/711/31c/93471131c99ec7b2249cff6edb698859.jpg"></div><br>
<code>b) opacity = 0.1<br>
<br>
FinalColor = color * opacity + DestColor * (1.0 - opacity) =<br>
FinalColor = 0.1 * color + 0.9 * DestColor</code><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/269/b24/d90/269b24d90592abb5065fba0f2a0aaf9f.jpg"></div><br>
<code>c) opacity = 0.0<br>
<br>
FinalColor = color * opacity + DestColor * (1.0 - opacity) =<br>
FinalColor = DestColor</code><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/191/75e/b6e/19175eb6e6757c04a0a063e75bad96f2.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤ç€è‰²å™¨çš„åŸºæœ¬æ€æƒ³æ˜¯å»ºæ¨¡å’Œä½¿ç”¨ä¸é€æ˜åº¦å‡½æ•°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacityï¼ˆxï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">æ§åˆ¶æµæ˜Ÿæ²¿ä¸€ä¸ªåƒç´ çš„ä¸é€æ˜åº¦ã€‚ä¸»è¦è¦æ±‚æ˜¯ä¸é€æ˜åº¦åº”åœ¨æ’æ˜Ÿæœ«ç«¯ï¼ˆå…¶``èº«ä½“''ï¼‰è¾¾åˆ°æœ€å¤§å€¼å¹¶å¹³æ»‘æ¸å˜ä¸º0.0ï¼ˆè‡³å…¶``å°¾å·´''ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æˆ‘ä»¬å¼€å§‹ç†è§£åƒç´ ç€è‰²å™¨çš„æ±‡ç¼–ä»£ç æ—¶ï¼Œè¿™å˜å¾—æ˜¾è€Œæ˜“è§ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> ps_5_0  <font></font>
    dcl_globalFlags refactoringAllowed  <font></font>
    dcl_constantbuffer cb0[<span class="hljs-number">10</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb2[<span class="hljs-number">3</span>], immediateIndexed  <font></font>
    dcl_constantbuffer cb4[<span class="hljs-number">2</span>], immediateIndexed  <font></font>
    dcl_input_ps linear v0.xyzw  <font></font>
    dcl_input_ps linear v1.xyzw  <font></font>
    dcl_input_ps linear v2.y  <font></font>
    dcl_input_ps linear v3.w  <font></font>
    dcl_output o0.xyzw  <font></font>
    dcl_temps <span class="hljs-number">4</span>  
   <span class="hljs-number">0</span>: mov_sat r0.x, v2.y  
   <span class="hljs-number">1</span>: ge r0.y, r0.x, l(<span class="hljs-number">0.052579</span>)  
   <span class="hljs-number">2</span>: ge r0.z, l(<span class="hljs-number">0.965679</span>), r0.x  
   <span class="hljs-number">3</span>: <span class="hljs-keyword">and</span> r0.y, r0.z, r0.y  
   <span class="hljs-number">4</span>: if_nz r0.y  
   <span class="hljs-number">5</span>:  ge r0.y, l(<span class="hljs-number">0.878136</span>), r0.x  
   <span class="hljs-number">6</span>:  add r0.z, r0.x, l(<span class="hljs-number">-0.052579</span>)  
   <span class="hljs-number">7</span>:  mul r1.w, r0.z, l(<span class="hljs-number">1.211303</span>)  
   <span class="hljs-number">8</span>:  mov_sat r0.z, r1.w  
   <span class="hljs-number">9</span>:  mad r0.w, r0.z, l(<span class="hljs-number">-2.000000</span>), l(<span class="hljs-number">3.000000</span>)  
  <span class="hljs-number">10</span>:  mul r0.z, r0.z, r0.z  
  <span class="hljs-number">11</span>:  mul r0.z, r0.z, r0.w  
  <span class="hljs-number">12</span>:  mul r2.x, r0.z, l(<span class="hljs-number">0.084642</span>)  
  <span class="hljs-number">13</span>:  mov r1.yz, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.084642</span>, <span class="hljs-number">0.000000</span>)  
  <span class="hljs-number">14</span>:  movc r2.yzw, r0.yyyy, r1.yyzw, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.500000</span>)  
  <span class="hljs-number">15</span>:  <span class="hljs-keyword">not</span> r0.z, r0.y  
  <span class="hljs-number">16</span>:  if_z r0.y  
  <span class="hljs-number">17</span>:   ge r0.y, l(<span class="hljs-number">0.924339</span>), r0.x  
  <span class="hljs-number">18</span>:   add r0.w, r0.x, l(<span class="hljs-number">-0.878136</span>)  
  <span class="hljs-number">19</span>:   mul r1.w, r0.w, l(<span class="hljs-number">21.643608</span>)  
  <span class="hljs-number">20</span>:   mov_sat r0.w, r1.w  
  <span class="hljs-number">21</span>:   mad r3.x, r0.w, l(<span class="hljs-number">-2.000000</span>), l(<span class="hljs-number">3.000000</span>)  
  <span class="hljs-number">22</span>:   mul r0.w, r0.w, r0.w  
  <span class="hljs-number">23</span>:   mul r0.w, r0.w, r3.x  
  <span class="hljs-number">24</span>:   mad r1.x, r0.w, l(<span class="hljs-number">0.889658</span>), l(<span class="hljs-number">0.084642</span>)  
  <span class="hljs-number">25</span>:   mov r1.yz, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.084642</span>, <span class="hljs-number">0.974300</span>, <span class="hljs-number">0.000000</span>)  
  <span class="hljs-number">26</span>:   movc r2.xyzw, r0.yyyy, r1.xyzw, r2.xyzw  
  <span class="hljs-number">27</span>:  <span class="hljs-keyword">else</span>  
  <span class="hljs-number">28</span>:   mov r2.y, l(<span class="hljs-number">0</span>)  
  <span class="hljs-number">29</span>:   mov r0.y, l(<span class="hljs-number">-1</span>)  
  <span class="hljs-number">30</span>:  endif  
  <span class="hljs-number">31</span>:  <span class="hljs-keyword">not</span> r0.w, r0.y  
  <span class="hljs-number">32</span>:  <span class="hljs-keyword">and</span> r0.z, r0.w, r0.z  
  <span class="hljs-number">33</span>:  if_nz r0.z  
  <span class="hljs-number">34</span>:   ge r0.y, r0.x, l(<span class="hljs-number">0.924339</span>)  
  <span class="hljs-number">35</span>:   add r0.x, r0.x, l(<span class="hljs-number">-0.924339</span>)  
  <span class="hljs-number">36</span>:   mul r1.w, r0.x, l(<span class="hljs-number">24.189651</span>)  
  <span class="hljs-number">37</span>:   mov_sat r0.x, r1.w  
  <span class="hljs-number">38</span>:   mad r0.z, r0.x, l(<span class="hljs-number">-2.000000</span>), l(<span class="hljs-number">3.000000</span>)  
  <span class="hljs-number">39</span>:   mul r0.x, r0.x, r0.x  
  <span class="hljs-number">40</span>:   mul r0.x, r0.x, r0.z  
  <span class="hljs-number">41</span>:   mad r1.x, r0.x, l(<span class="hljs-number">-0.974300</span>), l(<span class="hljs-number">0.974300</span>)  
  <span class="hljs-number">42</span>:   mov r1.yz, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.974300</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>)  
  <span class="hljs-number">43</span>:   movc r2.xyzw, r0.yyyy, r1.xyzw, r2.xyzw  
  <span class="hljs-number">44</span>:  endif  
  <span class="hljs-number">45</span>: <span class="hljs-keyword">else</span>  
  <span class="hljs-number">46</span>:  mov r2.yzw, l(<span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.000000</span>, <span class="hljs-number">0.500000</span>)  
  <span class="hljs-number">47</span>:  mov r0.y, l(<span class="hljs-number">0</span>)  
  <span class="hljs-number">48</span>: endif  
  <span class="hljs-number">49</span>: mov_sat r2.w, r2.w  
  <span class="hljs-number">50</span>: mad r0.x, r2.w, l(<span class="hljs-number">-2.000000</span>), l(<span class="hljs-number">3.000000</span>)  
  <span class="hljs-number">51</span>: mul r0.z, r2.w, r2.w  
  <span class="hljs-number">52</span>: mul r0.x, r0.z, r0.x  
  <span class="hljs-number">53</span>: add r0.z, -r2.y, r2.z  
  <span class="hljs-number">54</span>: mad r0.x, r0.x, r0.z, r2.y  
  <span class="hljs-number">55</span>: movc r0.x, r0.y, r2.x, r0.x  
  <span class="hljs-number">56</span>: mad r0.y, cb4[<span class="hljs-number">1</span>].x, -cb0[<span class="hljs-number">9</span>].w, l(<span class="hljs-number">1.000000</span>)  
  <span class="hljs-number">57</span>: mul_sat r0.y, r0.y, v3.w  
  <span class="hljs-number">58</span>: mul r0.x, r0.y, r0.x  
  <span class="hljs-number">59</span>: mul r0.yzw, cb2[<span class="hljs-number">2</span>].xxyz, cb4[<span class="hljs-number">0</span>].xxxx  
  <span class="hljs-number">60</span>: mul r0.x, r0.x, cb2[<span class="hljs-number">2</span>].w  
  <span class="hljs-number">61</span>: dp3 r1.x, l(<span class="hljs-number">0.333000</span>, <span class="hljs-number">0.555000</span>, <span class="hljs-number">0.222000</span>, <span class="hljs-number">0.000000</span>), r0.yzwy  
  <span class="hljs-number">62</span>: mad r1.xyz, r1.xxxx, v0.xyzx, -r0.yzwy  
  <span class="hljs-number">63</span>: mad r0.yzw, v0.wwww, r1.xxyz, r0.yyzw  
  <span class="hljs-number">64</span>: add r1.xyz, -r0.yzwy, v1.xyzx  
  <span class="hljs-number">65</span>: mad r0.yzw, v1.wwww, r1.xxyz, r0.yyzw  
  <span class="hljs-number">66</span>: mul o0.xyz, r0.xxxx, r0.yzwy  
  <span class="hljs-number">67</span>: mov o0.w, r0.x  
  <span class="hljs-number">68</span>: ret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šå¸¸ï¼Œç€è‰²å™¨æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘å¾ˆéš¾å¼„æ¸…æ¥šå…¶ä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œæ‰€æœ‰å€¼å¦‚1.211303ã€21.643608å’Œ24.189651éƒ½æ¥è‡ªå“ªé‡Œï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæˆ‘ä»¬åœ¨è°ˆè®ºä¸é€æ˜åº¦å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾“å…¥å€¼ã€‚</font><font style="vertical-align: inherit;">è¿™éå¸¸ç®€å•-åœ¨[0,1]ï¼ˆç¬¬0è¡Œï¼‰èŒƒå›´å†…çš„texcoordåœ¨è¿™é‡Œå¾ˆæœ‰ç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¯¥åŠŸèƒ½åº”ç”¨äºæµæ˜Ÿä½“çš„æ•´ä¸ªé•¿åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸é€æ˜åº¦åŠŸèƒ½å…·æœ‰ç”±å››ä¸ªæ§åˆ¶ç‚¹å®šä¹‰çš„ä¸‰ä¸ªæ®µ/é—´éš”ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-comment">// current status: no idea how these are generated  </span>
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> controlPoint0 = <span class="hljs-number">0.052579</span>;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> controlPoint1 = <span class="hljs-number">0.878136</span>;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> controlPoint2 = <span class="hljs-number">0.924339</span>;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> controlPoint3 = <span class="hljs-number">0.965679</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä¸çŸ¥é“å¦‚ä½•é€‰æ‹©/è®¡ç®—å®ƒä»¬ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»æ±‡ç¼–ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶åªæ˜¯æ£€æŸ¥è¾“å…¥å€¼æ˜¯å¦åœ¨[controlPoint0-controlPoint3]èŒƒå›´å†…ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä¸æ˜¯ï¼Œåˆ™ä¸é€æ˜åº¦ä»…ä¸º0.0ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-comment">// Input for the opacity function</span>
   <span class="hljs-keyword">float</span> y = saturate(Input.Texcoords.y);  <span class="hljs-comment">// r0.x</span><font></font>
     <font></font>
   <span class="hljs-comment">// Value of opacity function.  </span>
   <span class="hljs-comment">// 0 - no change  </span>
   <span class="hljs-comment">// 1 - full color  </span>
   <span class="hljs-keyword">float</span> opacity = <span class="hljs-number">0.0</span>;  <font></font>
     <font></font>
   [branch]   <font></font>
   <span class="hljs-keyword">if</span> (y &gt;= controlPoint0 &amp;&amp; y &lt;= controlPoint3)  <font></font>
   {  <font></font>
      ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬æƒ³äº†è§£ä¸é€æ˜åº¦å‡½æ•°çš„å·¥ä½œåŸç†ï¼Œ</font><font style="vertical-align: inherit;">
åˆ™</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éœ€è¦</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹ä»¥ä¸‹æ±‡ç¼–ä»£ç è¿›è¡Œè§£å¯†</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-number">6</span>: add r0.z, r0.x, l(<span class="hljs-number">-0.052579</span>)   
   <span class="hljs-number">7</span>: mul r1.w, r0.z, l(<span class="hljs-number">1.211303</span>)   
   <span class="hljs-number">8</span>: mov_sat r0.z, r1.w   
   <span class="hljs-number">9</span>: mad r0.w, r0.z, l(<span class="hljs-number">-2.000000</span>), l(<span class="hljs-number">3.000000</span>)   
  <span class="hljs-number">10</span>: mul r0.z, r0.z, r0.z   
  <span class="hljs-number">11</span>: mul r0.z, r0.z, r0.w   
  <span class="hljs-number">12</span>: mul r2.x, r0.z, l(<span class="hljs-number">0.084642</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬9è¡Œçš„ç³»æ•°ä¸ºâ€œ -2.0â€å’Œâ€œ 3.0â€ï¼Œè¿™æš—ç¤ºç€ä½¿ç”¨äº†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stepsstep</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„çŒœæµ‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¸¦æœ‰åŸå‹çš„HLSLå¹³æ»‘æ­¥å‡½æ•°ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retå¹³æ»‘æ­¥ï¼ˆæœ€å°ï¼Œæœ€å¤§ï¼Œxï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å§‹ç»ˆå°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é™åˆ¶</font><i><font style="vertical-align: inherit;">ä¸º</font></i><font style="vertical-align: inherit;"> [ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å°-æœ€å¤§</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]ã€‚ä»æ±‡ç¼–ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¼š</font><font style="vertical-align: inherit;">ä»è¾“å…¥å€¼ä¸­</font><font style="vertical-align: inherit;">å‡å»</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å°å€¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå³ä»ç¬¬9è¡Œçš„r0.zä¸­å‡å»ï¼‰ï¼Œä½†æ˜¯ä»£ç ä¸­æ²¡æœ‰ç±»ä¼¼çš„ä¸œè¥¿ã€‚å¯¹äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ„å‘³ç€è¾“å…¥å€¼çš„ä¹˜ç§¯ï¼Œä½†æ˜¯ä»£ç ä¸­æ²¡æœ‰åƒâ€œ mul_satâ€è¿™æ ·çš„å†…å®¹ã€‚è€Œæ˜¯æœ‰â€œ mov_satâ€ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œ</font><font style="vertical-align: inherit;">å¹³æ»‘æ­¥é•¿</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å°å€¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å¤§å€¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°åˆ†åˆ«ä¸º0å’Œ1ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬çŸ¥é“</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…é¡»åœ¨[0ï¼Œ1]ä¹‹é—´ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œä¸é€æ˜åº¦å‡½æ•°ä¸­åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ã€‚è¿™æ˜¾ç„¶æš—ç¤ºä»£ç æ­£åœ¨å¯»æ‰¾[segmentStart-segmentEnd]åŒºé—´ä¸­çš„ä½ç½®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç­”æ¡ˆæ˜¯Linstepå‡½æ•°ï¼</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">linstep</span><span class="hljs-params">(<span class="hljs-keyword">float</span> min, <span class="hljs-keyword">float</span> max, <span class="hljs-keyword">float</span> v)</span>  
 </span>{  
   <span class="hljs-keyword">return</span> ( (v-min) / (max-min) );  <font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ç¬¬ä¸€æ®µï¼š[0.052579-0.878136]ã€‚</font><font style="vertical-align: inherit;">å‡æ³•åœ¨ç¬¬6è¡Œã€‚å¦‚æœæˆ‘ä»¬ç”¨ä¹˜æ³•æ›¿æ¢é™¤æ³•-&gt; 1.0 /ï¼ˆ0.878136-0.052579ï¼‰= 1.0 / 0.825557 =ã€œ1.211303ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹³æ»‘æ­¥çš„ç»“æœåœ¨[0ï¼Œ1]èŒƒå›´å†…ã€‚</font><font style="vertical-align: inherit;">ç¬¬12è¡Œçš„ä¹˜æ³•æ˜¯æ®µçš„æƒé‡ã€‚</font><font style="vertical-align: inherit;">æ¯ä¸ªæ®µéƒ½æœ‰è‡ªå·±çš„æƒé‡ï¼Œä½¿æ‚¨å¯ä»¥æ§åˆ¶æ­¤ç‰¹å®šæ®µçš„æœ€å¤§ä¸é€æ˜åº¦ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ„å‘³ç€å¯¹äºç¬¬ä¸€æ®µ[0.052579-0.878136]ï¼Œä¸é€æ˜åº¦åœ¨[0-0.084642]èŒƒå›´å†…ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®¡ç®—ä»»æ„æ®µçš„ä¸é€æ˜åº¦çš„HLSLå‡½æ•°å¯ä»¥ç¼–å†™å¦‚ä¸‹ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword">float</span> <span class="hljs-title">getOpacityFunctionValue</span><span class="hljs-params">(<span class="hljs-keyword">float</span> x, <span class="hljs-keyword">float</span> cpLeft, <span class="hljs-keyword">float</span> cpRight, <span class="hljs-keyword">float</span> weight)</span>  
 </span>{  
   <span class="hljs-keyword">float</span> val = smoothstep( <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, linstep(cpLeft, cpRight, x) );  
   <span class="hljs-keyword">return</span> val * weight;  <font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œé‡ç‚¹ä»…åœ¨äºä¸ºç›¸åº”çš„æ®µè°ƒç”¨æ­¤å‡½æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çœ‹ä¸€ä¸‹æƒé‡ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> weight0 = <span class="hljs-number">0.084642</span>;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> weight1 = <span class="hljs-number">0.889658</span>;  
   <span class="hljs-keyword">const</span> <span class="hljs-keyword">float</span> weight2 = <span class="hljs-number">0.974300</span>; <span class="hljs-comment">// note: weight0+weight1 = weight2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ ¹æ®æ±‡ç¼–ä»£ç ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€æ˜åº¦ï¼ˆxï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°çš„</font><font style="vertical-align: inherit;">è®¡ç®—å¦‚ä¸‹ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-keyword">float</span> opacity = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
   [branch]   <font></font>
   <span class="hljs-keyword">if</span> (y &gt;= controlPoint0 &amp;&amp; y &lt;= controlPoint3)  <font></font>
   {  <font></font>
     <span class="hljs-comment">// Range of v: [0, weight0]  </span>
     <span class="hljs-keyword">float</span> v = getOpacityFunctionValue(y, controlPoint0, controlPoint1, weight0);  <font></font>
     opacity = v;  <font></font>
     <font></font>
     [branch]  <font></font>
     <span class="hljs-keyword">if</span> ( y &gt;= controlPoint1 )  <font></font>
     {  <font></font>
       <span class="hljs-comment">// Range of v: [0, weight1]  </span>
       <span class="hljs-keyword">float</span> v = getOpacityFunctionValue(y, controlPoint1, controlPoint2, weight1);  <font></font>
       opacity = weight0 + v;  <font></font>
   <font></font>
       [branch]  <font></font>
       <span class="hljs-keyword">if</span> (y &gt;= controlPoint2)  <font></font>
       {  <font></font>
         <span class="hljs-comment">// Range of v: [0, weight2]  </span>
         <span class="hljs-keyword">float</span> v = getOpacityFunctionValue(y, controlPoint2, controlPoint3, weight2);<font></font>
         opacity = weight2 - v;          <font></font>
       }  <font></font>
     }  <font></font>
   }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯ä¸é€æ˜åº¦å‡½æ•°çš„å›¾å½¢ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥è½»æ¾åœ°çœ‹åˆ°ä¸é€æ˜æ€§æ€¥å‰§å¢åŠ ï¼Œè¡¨æ˜æµæ˜Ÿçš„å¼€å§‹ï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5da/326/1f0/5da3261f0f88fa41ac963ca84fc79f99.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾å½¢ä¸é€æ˜åº¦å‡½æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çº¢è‰²é€šé“-ä¸é€æ˜åº¦å€¼ï¼›</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»¿è‰²é€šé“-æ§åˆ¶ç‚¹ï¼›</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è“è‰²é€šé“-æƒé‡ï¼›</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
è®¡ç®—äº†ä¸é€æ˜åº¦åï¼Œå…¶ä»–æ‰€æœ‰å†…å®¹éƒ½åªæ˜¯ç”»é¾™ç‚¹ç›ã€‚</font><font style="vertical-align: inherit;">ç„¶åè¿˜æœ‰å…¶ä»–å€å¢ï¼šæ˜Ÿæ˜Ÿçš„ä¸é€æ˜åº¦ï¼Œæµæ˜Ÿçš„é¢œè‰²å’Œé›¾çš„å½±å“ã€‚</font><font style="vertical-align: inherit;">åƒåœ¨TW3ç€è‰²å™¨ä¸­ä¸€æ ·ï¼Œæ‚¨è¿˜å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°1.0çš„å†—ä½™ä¹˜æ³•ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-comment">// cb4_v1.x = 1.0  </span>
   <span class="hljs-keyword">float</span> starsOpacity = <span class="hljs-number">1.0</span> - cb0_v9.w * cb4_v1.x;    <font></font>
   opacity *= starsOpacity;  <font></font>
<font></font>
   <span class="hljs-comment">// Calculate color of a shooting star  </span>
   <span class="hljs-comment">// cb4_v0.x = 10.0</span>
   <span class="hljs-comment">// cb2_v2.rgb = (1.0, 1.0, 1.0)</span><font></font>
   float3 color = cb2_v2.rgb * cb4_v0.x;<font></font>
     <font></font>
   <span class="hljs-comment">// cb2_v2.w = 1  </span><font></font>
   opacity *= cb2_v2.w;<font></font>
     <font></font>
   FogResult fr = { Input.FogParams, Input.AerialParams };  <font></font>
   color = ApplyFog(fr, color);<font></font>
     <font></font>
   <span class="hljs-keyword">return</span> float4( color*opacity, opacity);  <font></font>
 }</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.æ€»ç»“</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸»è¦å›°éš¾åœ¨äºå…·æœ‰ä¸é€æ˜åº¦åŠŸèƒ½çš„éƒ¨åˆ†ã€‚è§£ç åï¼Œå…¶ä»–æ‰€æœ‰å†…å®¹éƒ½å¾ˆå®¹æ˜“ç†è§£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åœ¨ä¸Šé¢è¯´è¿‡ï¼Œåƒç´ ç€è‰²å™¨æœ‰äº›å¤æ‚ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬åªå…³å¿ƒ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€æ˜åº¦ï¼ˆxï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°çš„å€¼</font><font style="vertical-align: inherit;">ï¼Œè¯¥å€¼å­˜å‚¨åœ¨r2.xä¸­ï¼ˆä»ç¬¬49è¡Œå¼€å§‹ï¼‰ã€‚ä½†æ˜¯ï¼Œæ±‡ç¼–ä»£ç ä¸­çš„ä¸é€æ˜åº¦å‡½æ•°ä¼šåˆ›å»ºå¦å¤–ä¸‰ä¸ªå˜é‡ï¼šminRangeï¼ˆr2.yï¼‰ï¼ŒmaxRangeï¼ˆr2.zï¼‰å’Œvalueï¼ˆr2.wï¼‰ã€‚å½“</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ä¸</font><i><font style="vertical-align: inherit;">é€æ˜åº¦ï¼ˆxï¼‰</font></i><font style="vertical-align: inherit;">æ—¶ï¼Œæ‰€æœ‰è¿™äº›å‚æ•°éƒ½æ˜¯ç”¨äºè®¡ç®—ä¸é€æ˜åº¦çš„å‚æ•°</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<code>lerp( minRange, maxRange, smoothstep(0, 1, value) );</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œå¦‚æœè¾“å…¥å€¼ä¸º</font><i><font style="vertical-align: inherit;">x</font></i><font style="vertical-align: inherit;">ï¼Œåˆ™æœ€ç»ˆçš„ä¸é€æ˜åº¦å€¼æ˜¯åœ¨ç¬¬55è¡Œçš„æ¡ä»¶åˆ†æ”¯ä¸­è·å¾—çš„</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨[controlPoint0-controlPoint3]èŒƒå›´å†…ï¼Œè¿™æ„å‘³ç€ä½¿ç”¨äº†ä¸é€æ˜åº¦åŠŸèƒ½ï¼Œå› æ­¤é€‰æ‹©äº†r2.xã€‚</font><font style="vertical-align: inherit;">å¦åˆ™ï¼Œå½“</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨é—´éš”ä¹‹å¤–</font><font style="vertical-align: inherit;">æ—¶</font><font style="vertical-align: inherit;">ï¼Œä¸é€æ˜åº¦æ˜¯æ ¹æ®r0.xè®¡ç®—çš„ï¼Œå³æ ¹æ®ä¸Šé¢çš„å…¬å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åœ¨é—´éš”[controlPoint0-controlPoint3]ä¹‹å¤–è°ƒè¯•äº†å‡ ä¸ªåƒç´ ï¼Œæœ€ç»ˆçš„ä¸é€æ˜åº¦å§‹ç»ˆä¸ºé›¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»Šå¤©å°±è¿™äº›ã€‚</font><font style="vertical-align: inherit;">å’Œå¾€å¸¸ä¸€æ ·ï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN489092/index.html">æˆ‘å¦‚ä½•åœ¨12ä¸ªæœˆå†…ç‹¬ç«‹å­¦ä¹ æ–°è¯­è¨€ï¼šæ€»æŒ‡å—</a></li>
<li><a href="../zh-CN489100/index.html">SARS-CoV-2å† çŠ¶ç—…æ¯’æ•°æ®åˆ†æï¼ˆ2019-nCovï¼‰</a></li>
<li><a href="../zh-CN489102/index.html">å‡çš„å±å¹•å¯¿å‘½ã€‚â€œæ˜¯çš„ï¼Œæˆ‘ä¸ªäººè®¤è¯†éº¦å½“å¨œâ€</a></li>
<li><a href="../zh-CN489106/index.html">æˆ‘å¦‚ä½•é€€å‡ºæ–°é—»ä¸šå¹¶æˆä¸ºä¸€åç¨‹åºå‘˜</a></li>
<li><a href="../zh-CN489108/index.html">å°†æ‚¨çš„å­—æ®µæ·»åŠ åˆ°PytestæŠ¥å‘Šä¸­</a></li>
<li><a href="../zh-CN489122/index.html">TypeScriptä¸­çš„ç±»å‹åŒ–ODataæŸ¥è¯¢</a></li>
<li><a href="../zh-CN489128/index.html">å›½é™…åŒ–ï¼šå¦‚ä½•å°†äº§å“æ¨å‘å›½é™…å¸‚åœºï¼ˆè€Œä¸æ˜¯å‘ç–¯ï¼‰</a></li>
<li><a href="../zh-CN489132/index.html">ã€Š 2020å¹´æ¬§æ´²ç»¼åˆç³»ç»Ÿã€‹äº®ç‚¹</a></li>
<li><a href="../zh-CN489134/index.html">ä¿„ç½—æ–¯é£Ÿå“å…¬å¸è®¾è®¡å›¢é˜Ÿç ”ç©¶</a></li>
<li><a href="../zh-CN489136/index.html">èµ¢å¾—äºŒåæ¡Haskellå°è¯ï¼šç¼–å†™Wc</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>