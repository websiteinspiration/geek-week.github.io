<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöó üë®üèª‚Äç‚öñÔ∏è ‚òÆÔ∏è (‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó) ‡§∞‡§æ‡§ú‡•ç‡§Ø (‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó) ‡§∂‡•á‡§≤ ‡§Æ‡•á‡§Ç: ‡§è‡§ï‡§≤ ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§® ‡§®‡§π‡•Ä‡§Ç üåΩ üë®üèø‚Äçüíª üßëüèø‚Äçü§ù‚Äçüßëüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‡§Ö‡§∞‡•á, ‡§è‡§ï ‡§ë‡§ü‡•ã-‡§™‡•Ç‡§∞‡•ç‡§£ ‡§á‡§Ç‡§ü‡§∞‡•á‡§ï‡•ç‡§ü‡§ø‡§µ ‡§∂‡•á‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ, ‡§Æ‡§¶‡§¶, ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï? ‡§î‡§∞ ‡§Æ‡•Å‡§∏‡•Ä‡§¨‡§§‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ, ‡§î‡§∞ ‡§ú‡•á‡§µ‡•Ä‡§è‡§Æ ‡§™‡§∞ ‡§≠‡•Ä?
 
 

‡§™‡•ã‡§∏‡•ç‡§ü‡§Æ‡•à‡§® ‡§Æ‡•á‡§∞‡•á ‡§≤‡§ø‡§è ‡§ï‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§ø‡§∞‡§¶‡§∞‡•ç‡§¶ ‡§¨‡§® ‡§ó‡§Ø‡§æ‡•§ ‡§Ø...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>(‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó) ‡§∞‡§æ‡§ú‡•ç‡§Ø (‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó) ‡§∂‡•á‡§≤ ‡§Æ‡•á‡§Ç: ‡§è‡§ï‡§≤ ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§® ‡§®‡§π‡•Ä‡§Ç</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500108/"><p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§Ö‡§∞‡•á, ‡§è‡§ï ‡§ë‡§ü‡•ã-‡§™‡•Ç‡§∞‡•ç‡§£ ‡§á‡§Ç‡§ü‡§∞‡•á‡§ï‡•ç‡§ü‡§ø‡§µ ‡§∂‡•á‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ, ‡§Æ‡§¶‡§¶, ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï? </font><font style="vertical-align: inherit;">‡§î‡§∞ ‡§Æ‡•Å‡§∏‡•Ä‡§¨‡§§‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ, ‡§î‡§∞ ‡§ú‡•á‡§µ‡•Ä‡§è‡§Æ ‡§™‡§∞ ‡§≠‡•Ä?</font></font></em><br>
<img src="https://habrastorage.org/webt/pb/xm/lv/pbxmlvw53tndaougujmxrcj-eea.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">‡§™‡•ã‡§∏‡•ç‡§ü‡§Æ‡•à‡§®</font></a><font style="vertical-align: inherit;"> ‡§Æ‡•á‡§∞‡•á ‡§≤‡§ø‡§è ‡§ï‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§ø‡§∞‡§¶‡§∞‡•ç‡§¶ ‡§¨‡§® ‡§ó‡§Ø‡§æ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡•§ ‡§Ø‡§¶‡•ç‡§Ø‡§™‡§ø ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§π‡§Æ ‡§∏‡§≠‡•Ä ‡§ü‡•Ä‡§°‡•Ä‡§°‡•Ä ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§ï‡§ï‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§≤‡§æ‡§≤ ‡§¨‡§§‡•ç‡§§‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§π‡§Æ ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§ü‡•Ç‡§ü ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•Å‡§ù‡•á ‡§™‡•ã‡§∏‡•ç‡§ü‡§Æ‡•à‡§® ‡§á‡§Ç‡§ü‡§∞‡§´‡§º‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§æ‡§∞ ‡§≠‡•á‡§ú‡§®‡§æ ‡§™‡§°‡§º‡§æ‡•§ ‡§ï‡§æ‡§Æ ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§Æ‡•á‡§Ç, ‡§è‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ü‡•ã‡§ï‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§•‡§æ (‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§î‡§∞ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§≤‡§ó ‡§π‡•à‡§Ç), ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§¨‡•Å‡§ï‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§∏‡•á ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç, ‡§Æ‡§æ‡§™‡§¶‡§Ç‡§°‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§ï‡•ç‡§≤‡§ø‡§ï-‡§ï‡•ç‡§≤‡§ø‡§ï-‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§è‡§ï ‡§Ö‡§≤‡§ó ‡§ï‡•ç‡§∞‡§Æ ‡§Æ‡•á‡§Ç‡•§ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§™‡§π‡§≤‡•á ‡§π‡•Ä cURL ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•Ä ‡§•‡•Ä, ‡§î‡§∞ ‡§Æ‡•à‡§Ç‡§®‡•á IDEA ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§ø‡§è - ‡§Ø‡§π ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ú‡§®‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£‡•ã‡§Ç ‡§™‡§∞ ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§Ü‡§¶‡§∞‡•ç‡§∂ ‡§™‡•ç‡§∞‡•á‡§∞‡§ï, ‡§Ø‡•á ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§•‡•á ‡§ï‡§ø ‡§∏‡•á‡§µ‡§æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø, ‡§á‡§∏‡§ï‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£, ‡§á‡§∏‡§ï‡•á ‡§™‡•Ä‡§õ‡•á ‡§Æ‡•á‡§®‡§´‡•ç‡§∞‡•á‡§Æ, ‡§ò‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§∏‡§Æ, ‡§î‡§∞ ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§ó‡§Æ‡§® ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡•á ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§Ü‡§Ø‡§æ ‡§•‡§æ‡•§ ‡§ï‡•ç‡§≤‡§ø‡§ï-‡§ï‡•ç‡§≤‡§ø‡§ï ‡§®‡•á ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡§Æ‡§Ø ‡§ñ‡§æ‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§î‡§∞ ‡§Æ‡§æ‡§â‡§∏ ‡§ï‡§æ ‡§Æ‡§æ‡§á‡§≤‡•á‡§ú ‡§¨‡§¢‡§º‡§æ ‡§¶‡§ø‡§Ø‡§æ‡•§</font></font></p><br>
<p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">Spring Shell</a>,    shell     ,    Spring.     ,       . ,      ‚Äî  .   ‚Äî      shell,    .    ,         ‚Äî <em>Spring State Machine</em>.  ,    ‚Äî    ,    ‚Äî  , ,    Kotlin,   <em>Akka</em>    ""  .   <em>State Machine</em>  ,    .</p><a name="habracut"></a><br>
<h3 id="nastroyka-sredy"> </h3><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">Spring Initializr</a>     Gradle  Kotlin.     .</p><br>
<pre><code class="bash hljs">curl <span class="hljs-string">'https://start.spring.io/starter.zip?type=gradle-project&amp;language=kotlin&amp;bootVersion=2.2.6.RELEASE&amp;baseDir=shell-state&amp;groupId=me.votez.spring&amp;artifactId=shell-state&amp;name=shell-state&amp;description=Demo%20project%20for%20Spring%20State%20Machine%20and%20Shell&amp;packageName=me.votez.spring.shellstate&amp;packaging=jar&amp;javaVersion=1.8'</span> --compressed --output shellstate.zip &amp;&amp; unzip shellstate.zip</code></pre><br>
<p>    <em>Spring Shell</em>  gradle</p><br>
<pre><code class="kotlin hljs">    implementation(<span class="hljs-string">"org.springframework.shell:spring-shell-starter:2.0.0.RELEASE"</span>)</code></pre><br>
<h3 id="opisanie-komand-dlya-obolochki">   </h3><br>
<p>     (shell).    ,   <em>ShellComponent</em> (   )      ,  <em>ShellMethod</em>  ,   .   ,    <em>ShellOption</em>.       ,     Bean Validation. ,         Enum          ( ,     <em>help</em>).</p><br>
<p>       ‚Äî     .      ‚Äî   ,   ,  actuator  .‚Ä¶<br>
(  <em>runBlocking</em>    ‚Äî     )</p><br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">package</span> me.votez.spring.shellstate<font></font>
<font></font>
<span class="hljs-keyword">import</span> org.springframework.shell.standard.ShellComponent
<span class="hljs-keyword">import</span> org.springframework.shell.standard.ShellMethod
<span class="hljs-keyword">import</span> org.springframework.shell.standard.ShellOption
<span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> org.springframework.shell.standard.ShellMethodAvailability
<span class="hljs-keyword">import</span> java.util.*
<span class="hljs-keyword">import</span> kotlin.random.Random<font></font>
<font></font>
<span class="hljs-meta">@ShellComponent</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServerCommands</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> token: String? = <span class="hljs-literal">null</span><font></font>
<font></font>
    <span class="hljs-meta">@ShellMethod(<span class="hljs-meta-string">"Authenticate and obtain token"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">login</span><span class="hljs-params">(
           <span class="hljs-meta">@ShellOption</span> name:<span class="hljs-type">String</span>, 
           <span class="hljs-meta">@ShellOption</span> password:<span class="hljs-type">String</span>, 
           <span class="hljs-meta">@ShellOption(defaultValue = <span class="hljs-meta-string">"admin"</span>)</span> scope: <span class="hljs-type">String</span>)</span></span> = runBlocking {<font></font>
            token = UUID.randomUUID().toString()<font></font>
            delay(<span class="hljs-number">2_000</span>)
            <span class="hljs-string">"Connected"</span><font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@ShellMethod(<span class="hljs-meta-string">"List projects regstered on server"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">list</span><span class="hljs-params">(
        <span class="hljs-meta">@ShellOption(defaultValue = <span class="hljs-meta-string">"PROJECT"</span>, help = <span class="hljs-meta-string">"Possible values are PROJECT and USER"</span>)</span> type:<span class="hljs-type">EntityType</span>)</span></span> = <span class="hljs-keyword">when</span>(type) {<font></font>
        EntityType.PROJECT -&gt; listOf(<span class="hljs-string">"Roga i Kopita"</span>, <span class="hljs-string">"Svetliy Put"</span>, <span class="hljs-string">"NIICHAVO"</span>)<font></font>
        EntityType.USER -&gt; listOf( <span class="hljs-string">"Ivanov"</span>, <span class="hljs-string">"Petrov"</span>, <span class="hljs-string">"Sidorov"</span>)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EntityType</span> </span>{<font></font>
    PROJECT,<font></font>
    USER<font></font>
}</code></pre><br>
<p>    .      IntelliJ IDEA,   Spring Shell      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">JLine</a>,     Linux, MacOS  Windows,    IDE ‚Äî .</p><br>
<pre><code class="bash hljs">$ bash ./gradlew build<font></font>
$ java -jar build/libs/shell-state-0.0.1-SNAPSHOT.jar </code></pre><br>
<p>     <strong>help</strong>,         .    <strong>clear, exit, quit, script, stacktrace</strong>.</p><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"></b>
                        <div class="spoiler_text"><pre><code class="plaintext hljs">2020-05-03 12:49:35.442  INFO 23211 --- [           main] m.v.s.s.ShellStateApplicationKt          : Started ShellStateApplicationKt in 1.036 seconds (JVM running for 0.936)<font></font>
shell:&gt;help<font></font>
AVAILABLE COMMANDS<font></font>
<font></font>
Built-In Commands<font></font>
        clear: Clear the shell screen.<font></font>
        exit, quit: Exit the shell.<font></font>
        help: Display help about available commands.<font></font>
        script: Read and execute commands from a file.<font></font>
        stacktrace: Display the full stacktrace of the last error.<font></font>
<font></font>
Server Commands<font></font>
        list: List projects registered on server<font></font>
        login: Authenticate and obtain token<font></font>
<font></font>
shell:&gt;help list<font></font>
<font></font>
NAME<font></font>
        list - List projects registered on server<font></font>
<font></font>
SYNOPSYS<font></font>
        list [[--type] entity-type]  <font></font>
<font></font>
OPTIONS<font></font>
        --type  entity-type<font></font>
                Possible values are PROJECT and USER<font></font>
                [Optional, default = PROJECT]</code></pre></div>
                    </div><br>
<p> .  <em>login</em>  <em>list</em>   <em>L</em>,     .  <em>l</em>  <em>TAB</em>      ,   <em>o</em>   <em>TAB</em>,   <em>login</em>.       .     ,    <em>&gt; login root 123456</em>   ,     ‚Äî    <em>Connected</em>.     <em>list</em> .</p><br>
<h3 id="upravlenie-dostupnostyu-komandy">  </h3><br>
<p>    <em>list</em>      ,       <em>list</em>  .            :</p><br>
<pre><code class="kotlin hljs">
    <span class="hljs-meta">@ShellMethodAvailability(<span class="hljs-meta-string">"list"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">listAvailable</span><span class="hljs-params">()</span></span> = <span class="hljs-keyword">if</span> (token != <span class="hljs-literal">null</span>) Availability.available()  <span class="hljs-keyword">else</span> Availability.unavailable(<span class="hljs-string">"cannot run without auth token"</span>)
</code></pre><br>
<p>      shell,       ,      .  <em>help</em>   ,   .</p><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">   </b>
                        <div class="spoiler_text"><pre><code class="plaintext hljs">2020-05-02 13:30:12.593  INFO 4443 --- [           main] m.v.s.s.ShellStateApplicationKt          : Started ShellStateApplicationKt in 1.525 seconds (JVM running for 1.252)<font></font>
shell:&gt;list<font></font>
Command 'list' exists but is not currently available because cannot run without auth token<font></font>
Details of the error have been omitted. You can use the stacktrace command to print the full stacktrace.<font></font>
shell:&gt;help<font></font>
AVAILABLE COMMANDS<font></font>
<font></font>
Built-In Commands<font></font>
        clear: Clear the shell screen.<font></font>
        exit, quit: Exit the shell.<font></font>
        help: Display help about available commands.<font></font>
        script: Read and execute commands from a file.<font></font>
        stacktrace: Display the full stacktrace of the last error.<font></font>
<font></font>
Server Commands<font></font>
      * list: List projects regstered on server<font></font>
        login: Authenticate and obtain token<font></font>
<font></font>
Commands marked with (*) are currently unavailable.<font></font>
Type `help &lt;command&gt;` to learn more.<font></font>
<font></font>
shell:&gt;help list<font></font>
<font></font>
NAME<font></font>
        list - List projects registered on server<font></font>
<font></font>
SYNOPSYS<font></font>
        list [[--type] entity-type]  <font></font>
<font></font>
OPTIONS<font></font>
        --type  entity-type<font></font>
                Possible values are PROJECT and USER<font></font>
                [Optional, default = PROJECT]<font></font>
<font></font>
CURRENTLY UNAVAILABLE<font></font>
        This command is currently not available because cannot run without auth token.<font></font>
</code></pre></div>
                    </div><br>
<h3 id="nemnogo-krasoty"> </h3><br>
<p>    ,   . ,            ,     ,        .      command prompt,            .     ,        application.properties ‚Äî   ,    Spring Framework    (   ).     prompt    ,   .</p><br>
<p>    PrompProvider,    ,  JLine.</p><br>
<pre><code class="kotlin hljs"><span class="hljs-meta">@ConfigurationProperties(prefix=<span class="hljs-meta-string">"shell"</span>)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServerCommands</span> : <span class="hljs-type">PromptProvider</span></span><font></font>
<font></font>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> env: String <span class="hljs-comment">//   application.properties</span><font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPrompt</span><span class="hljs-params">()</span></span>: AttributedString =<font></font>
            AttributedString(<span class="hljs-string">"<span class="hljs-subst">${env}</span>:&gt;"</span>,<font></font>
                    AttributedStyle.DEFAULT.foreground(<font></font>
                            <span class="hljs-keyword">if</span> (token == <span class="hljs-literal">null</span>) AttributedStyle.YELLOW <span class="hljs-keyword">else</span> AttributedStyle.GREEN))</code></pre><br>
<p>     ,    . . </p><br>
<p>  ,          ,     (soap, protobuf   ) ‚Äî     ,    -  . ,      .</p><br>
<h2 id="i-o-spring-state-machine">  Spring State Machine</h2><br>
<p>      ,    .       .  ,      ,    ,    .      ,           ‚Ä¶    ,  .</p><br>
<h3 id="moi-pyat-kopeek-v-rassuzhdenie-ob-avtomatah-v-kontekste-spring-state-machine">         Spring State Machine.</h3><br>
<p>    ,       (),         -.  ‚Äî   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">The Evolution of Trust</a>.   ,     ()        .      xml   ‚Äî          ,       -    .</p><br>
<p> ,     . ,  ""            .       Spring State Machine    ,  ,       .</p><br>
<p> ,          .      ,    .   ‚Äî Spring SM       ,         .    "  ",    -  , -      ,  ,       ‚Äî    .</p><br>
<p>,    ,    .  -           ‚Äî   ,   . </p><br>
<h3 id="tak-kuda-ego-zasunut-v-moem-primere">      ?</h3><br>
<p>  , .<br>
<img src="https://habrastorage.org/webt/s_/ab/k6/s_abk6dkgs-vfqurcdpenok33v8.png"><br>
         ,   ""  .       .         (  )   ,     Thread Pool,          shell,   SSM  -      ‚Äî     .</p><br>
<p>    command prompt     " ",     .</p><br>
<p>        ,     .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">Quick Start</a>.</p><br>
<p>, <del> </del>            ‚Äî   .          ‚Äî        command prompt.   ,      ,              ‚Äî , <em>token</em>.     <em>null-safe</em>  <em>lateinit</em>.<br>
 .</p><br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">configure</span><span class="hljs-params">(transitions: <span class="hljs-type">StateMachineTransitionConfigurer</span>&lt;<span class="hljs-type">State</span>, Event&gt;)</span></span> {<font></font>
        transitions<font></font>
                .withExternal()<font></font>
                .source(State.INIT).target(State.CONNECTING)<font></font>
                .event(Event.LOGIN)<font></font>
                .and()<font></font>
                .withExternal()<font></font>
                .source(State.CONNECTING).target(State.READY).event(Event.CONNECTED)<font></font>
                .action { context -&gt; context.extendedState.variables[<span class="hljs-string">"token"</span>] = context.messageHeaders[<span class="hljs-string">"token"</span>] }.and()<font></font>
                .withExternal()<font></font>
                .source(State.CONNECTING).target(State.INIT).event(Event.FAILED).and()<font></font>
                .withInternal()<font></font>
                .source(State.READY).event(Event.COMMAND).and()<font></font>
                .withExternal()<font></font>
                .source(State.READY).target(State.CONNECTING).event(Event.LOGIN)<font></font>
    }<font></font>
<font></font>
....<font></font>
<span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span> </span>{    INIT, CONNECTING, READY }
<span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Event</span> </span>{  LOGIN, CONNECTED, FAILED, COMMAND }</code></pre><br>
<p>  ‚Äî  ,    ‚Äî   .             Spring. ,         ,   .  .</p><br>
<p>       .    <em>login</em>:</p><br>
<pre><code class="kotlin hljs">    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> stateMachine: StateMachine&lt;State, Event&gt;<font></font>
<font></font>
   <span class="hljs-comment">//    null</span>
    <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> token: String<font></font>
<font></font>
    <span class="hljs-meta">@ShellMethod(<span class="hljs-meta-string">"Authenticate and obtain token"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">login</span><span class="hljs-params">(
            <span class="hljs-meta">@ShellOption</span> name: <span class="hljs-type">String</span>,
            <span class="hljs-meta">@ShellOption</span> password: <span class="hljs-type">String</span>,
            <span class="hljs-meta">@ShellOption(defaultValue = <span class="hljs-meta-string">"admin"</span>)</span> scope: <span class="hljs-type">String</span>)</span></span> =<font></font>
            runBlocking {<font></font>
                stateMachine.sendEvent(<font></font>
                        MessageBuilder.createMessage(Event.LOGIN, MessageHeaders(mapOf(<span class="hljs-string">"login"</span> to name))))<font></font>
                delay(<span class="hljs-number">1_000</span>)<font></font>
                token = UUID.randomUUID().toString()<font></font>
                stateMachine.sendEvent(<font></font>
                        MessageBuilder.createMessage(Event.CONNECTED, MessageHeaders(mapOf(<span class="hljs-string">"token"</span> to token))))
                <span class="hljs-string">"Connected"</span><font></font>
            }<font></font>
...</code></pre><br>
<p>   command prompt:</p><br>
<pre><code class="kotlin hljs">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> colors = mapOf(State.READY to AttributedStyle.DEFAULT.foreground(AttributedStyle.GREEN))<font></font>
            .withDefault { AttributedStyle.DEFAULT.foreground(AttributedStyle.YELLOW) }<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPrompt</span><span class="hljs-params">()</span></span>: AttributedString =<font></font>
            AttributedString(<span class="hljs-string">"<span class="hljs-subst">${env}</span>:&gt;"</span>, colors.getValue(stateMachine.state.id))
</code></pre><br>
<p>   :</p><br>
<pre><code class="kotlin hljs">    <span class="hljs-meta">@ShellMethodAvailability(<span class="hljs-meta-string">"list"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">listAvailable</span><span class="hljs-params">()</span></span> =
            <span class="hljs-keyword">if</span> (stateMachine.state.id == State.READY) Availability.available()
            <span class="hljs-keyword">else</span> Availability.unavailable(<span class="hljs-string">"requires authentication performed first"</span>)</code></pre><br>
<p> Spring State Machine   ‚Äî     (guards),   ,  ,   ,       ,  . </p><br>
<h3 id="zaklyuchenie"></h3><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§∂‡•à‡§≤ ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ø‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§â‡§§‡•ç‡§ï‡•É‡§∑‡•ç‡§ü ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§π‡•à, ‡§ú‡§¨ </font><font style="vertical-align: inherit;">‡§ó‡•à‡§∞-‡§§‡•Å‡§ö‡•ç‡§õ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•á </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§® ‡§ï‡•Ä</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä </font><font style="vertical-align: inherit;">‡§π‡•à‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§∏‡•ç‡§™‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§ü‡•á‡§ü ‡§Æ‡§∂‡•Ä‡§® ‡§ï‡§à ‡§∏‡§æ‡§Æ‡•Å‡§¶‡§æ‡§Ø‡§ø‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï ‡§π‡•à ‡§ú‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§π‡•à ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ó‡•ç‡§∞‡§π ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶ ‡§Ö‡§™-‡§ü‡•Ç-‡§°‡•á‡§ü ‡§§‡§ï‡§®‡•Ä‡§ï ‡§π‡•à‡•§</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‡§®‡§Æ‡•Ç‡§®‡§æ ‡§ï‡•ã‡§° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‡§™‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">‡§π‡•à</font></a><font style="vertical-align: inherit;"> ‡•§</font></font></p><br>
<p><img src="https://habrastorage.org/webt/dv/c9/44/dvc944kcgfhqoczcee-0upljwvq.png"></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi500098/index.html">‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§§‡§Ç‡§§‡•ç‡§∞‡§ø‡§ï‡§æ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡•Ä</a></li>
<li><a href="../hi500100/index.html">‡§ü‡•Ä‡§µ‡•Ä ‡§™‡§π‡§≤‡•á, ‡§â‡§§‡•ç‡§§‡§∞‡§¶‡§æ‡§Ø‡•Ä ‡§ü‡§æ‡§á‡§™‡•ã‡§ó‡•ç‡§∞‡§æ‡§´‡•Ä ‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§â‡§™‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•à‡§∏‡•á ‡§®‡§π‡•Ä‡§Ç ‡§≠‡•Ç‡§≤‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è</a></li>
<li><a href="../hi500102/index.html">‡§∞‡•ã‡§∏‡§≤‡§ø‡§® ‡§î‡§∞ EF ‡§ï‡•ã‡§∞: ‡§∞‡§®‡§ü‡§æ‡§á‡§Æ ‡§Æ‡•á‡§Ç DbContext ‡§ï‡§æ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£</a></li>
<li><a href="../hi500104/index.html">‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•â‡§°‡§≤‡§ø‡§Ç‡§ó, ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§Ü‡§∞‡•á‡§ñ-‡§™‡§æ‡§† ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§î‡§∞ CH-1 ‡§∏‡§Ç‡§ï‡•á‡§§‡§®</a></li>
<li><a href="../hi500106/index.html">‡§ú‡§æ‡§µ‡§æ ‡§Æ‡•á‡§Ç GPU ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ‡§ø‡§Ç‡§ó</a></li>
<li><a href="../hi500110/index.html">‡§Æ‡§æ‡§≤ ‡§ï‡•Ä ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∂‡§¨‡•ç‡§¶</a></li>
<li><a href="../hi500114/index.html">‡§ú‡§∞‡•ç‡§Æ‡§®‡•Ä ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§â‡§§‡•ç‡§™‡§æ‡§¶ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§®‡•å‡§ï‡§∞‡•Ä ‡§ï‡•Ä ‡§ñ‡•ã‡§ú‡•§ ‡§≠‡§æ‡§ó ‡•®/‡•´ ‡§∂‡•ç‡§∞‡§Æ ‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§ï‡•Ä ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ‡•§ ‡§è‡§ü‡•Ä‡§è‡§∏‡•§ ‡§®‡•å‡§ï‡§∞‡•Ä ‡§¨‡•ã‡§∞‡•ç‡§°</a></li>
<li><a href="../hi500116/index.html">‡§∏‡•ç‡§µ-‡§Ö‡§≤‡§ó‡§æ‡§µ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§µ‡§ø‡§§‡§∞‡§ø‡§§ ‡§ü‡•Ä‡§Æ ‡§ï‡§æ ‡§ï‡§æ‡§Æ: ‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø ‡§π‡§Æ‡§®‡•á ‡§≤‡§ó‡§≠‡§ó ‡§Ö‡§Ç‡§§‡§∞ ‡§™‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§¶‡§ø‡§Ø‡§æ</a></li>
<li><a href="../hi500118/index.html">‡§Ö‡§™‡§∞‡§ø‡§π‡§æ‡§∞‡•ç‡§Ø ‡§Ø‡§æ ‡§ï‡•ç‡§∞‡•â‡§∏-‡§∏‡•á‡§≤‡§ø‡§Ç‡§ó ‡§∞‡•á‡§´‡§∞‡§≤ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§æ‡§Ç‡§ö ‡§ö‡§∞‡§£</a></li>
<li><a href="../hi500120/index.html">‡§ï‡•â‡§™‡•Ä‡§∞‡§æ‡§á‡§ü ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç, ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç "‡§ï‡§≤‡§æ‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ" ‡§ï‡•à‡§∏‡•á ‡§†‡•Ä‡§ï ‡§∏‡•á ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>