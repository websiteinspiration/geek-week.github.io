<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏿 🧕 🚶🏼 Async / await in Unity 🛒 🚟 ⏭️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salute, Khabrovsk. Very little time remains before the start of the course "Game Developer on Unity" , in this regard, we have prepared for you anothe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Async / await in Unity</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/506962/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salute, Khabrovsk. </font><font style="vertical-align: inherit;">Very little time remains before the start of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Game Developer on Unity"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in this regard, we have prepared for you another interesting translation.</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/37/kv/yt/37kvytgqxylnrra818g7eckd5ly.png"><br>
<hr><br>
<code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity already works </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> any plugins or </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corutin wrappers that simulate asynchronous behavior, checking completion on every frame. </font><font style="vertical-align: inherit;">But it's still a kind of magic. </font><font style="vertical-align: inherit;">Let’s go a little deeper into this topic. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Note: for the time being I do not have an ideal understanding of all the hood details </font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in C #, so I will try to supplement the foregoing, as my understanding deepens.)</font></font></i><a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example</font></font></h4><br>
<img src="https://habrastorage.org/webt/ps/8i/so/ps8isowfho7xsjl99bnyzfh_5fo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose I need a button that, when clicked, would play a classic box animation. But there is one catch: the button must go into an inactive state (darken by </font></font><code>.interactable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">until the</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> box finishes rotation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For reasons of code cleanliness, I want to use one </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that waits for the completion of the rotation of the box and immediately add a line that restores </font></font><code>interactable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, instead of something like creating an object containing coroutine that checks the state on each frame to start this task. Having an obvious linear code in one place is a big plus in terms of readability. Such code is nice to write. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following simple, compact code implements the required task. (</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> methods also appear on the Unity delegate list, don't worry.)</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.UI;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SpinBox</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> Button button;
    <span class="hljs-keyword">public</span> Animation ani;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpinAndDisableButton</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        ani.Play();<font></font>
        button.interactable = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (ani.isPlaying == <span class="hljs-literal">true</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">await</span> Task.Yield();<font></font>
        }<font></font>
        button.interactable = <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/m-/or/ad/m-orad9ixe4ebtae_f6hm0ast1w.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are some questions you should have asked:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Who” “executes” the </font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rest of the method? </font><font style="vertical-align: inherit;">How magically it is checked in the next frame, while the call </font></font><code>SpinAndDisableButton</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is made only once, and there are no </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or coroutines to restart.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the timing of each run?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is </font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">This seems to be the key to everything that happens here. </font><font style="vertical-align: inherit;">I suppose you're used to </font></font><code>yield return null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in coroutines. </font><font style="vertical-align: inherit;">A good guess would be to try again in the next frame, but you say this through the C # enumerator. </font><font style="vertical-align: inherit;">The wording for yield is similar, and even the behavior is similar.</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sync context</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check out </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about how the rest of the program can be captured and continued as we want (for example, in which thread? In the calling thread or in the thread that launches the task?) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then you will notice that there is also in Unity such a concept, but it is not visible to us at first glance.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compared to a regular C # program</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Everything is not quite the same as in regular C # programs. A look at the official documentation </font></font><code>await. await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implies a return to the caller of the object </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The caller can continue until he needs the result of execution, and he can no longer afford to do something else at this time (it does not matter if the task is multithreaded or not), except </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This chain can continue until you finally get to </font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Where, if we also meet </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">there is another await</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> generated by the compiler, which immediately requests the result. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now back to ours </font></font><code>SpinAndDisableButton</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Where is the return going </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? In Unity we do not have</font></font><code>Main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, since it is deeply hidden in the engine code. The question, in fact, is the same as who performs </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and so on. This is an </font></font><code>PlayerLoop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API that supports the engine code within the game cycle to provide an orderly rendering of objects and everything that is executed in the frame. But before, this did not bother us, since so far these entry points have returned </font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returns the execution point to someone in the hope that he can continue from that point later, at a certain point, automatically. Then the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">game loop continues</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> until</font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is waiting. </font><font style="vertical-align: inherit;">Otherwise, we would not see the rotating box at all, if we really waited until the box finished the animation, because the animation could not end if the frame change did not continue. </font><font style="vertical-align: inherit;">So what will happen in the next frame? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the pseudocode that we want to receive in a frame different from the one in which we pressed the button and thereby disabled it:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">for</span> ( )<font></font>
{<font></font>
    <span class="hljs-keyword">if</span>(  )<font></font>
    {<font></font>
    	 .<font></font>
    }<font></font>
  <font></font>
     .<font></font>
         .<font></font>
        .<font></font>
}</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debugging</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Include more logs in the code, and we will try step-by-step debugging.</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.UI;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SpinBox</span> : <span class="hljs-title">MonoBehaviour</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> Button button;
    <span class="hljs-keyword">public</span> Animation ani;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SpinAndDisableButton</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Started async <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
        ani.Play();<font></font>
        button.interactable = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">while</span> (ani.isPlaying == <span class="hljs-literal">true</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">await</span> Task.Yield();<font></font>
        }<font></font>
        button.interactable = <span class="hljs-literal">true</span>;<font></font>
        Debug.Log(<span class="hljs-string">$"Finished async <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Update <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LateUpdate</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        Debug.Log(<span class="hljs-string">$"Late Update <span class="hljs-subst">{Time.frameCount}</span>"</span>);<font></font>
    }<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The update order is as follows:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ku/rp/b7/kurpb70kzx35oellcgqqwor5eow.png"><br>
<br>
<img src="https://habrastorage.org/webt/1c/k8/ef/1ck8ef1r0hmycnkfcubqfa4kwec.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The frame in which we start the animation is preceded by, </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>LateUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">because the mouse click comes from </font></font><code>EventSystem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>GraphicRaycaster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from UGUI Unity, which, as it turned out, has the order of execution in </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">any of your scripts above.</font></font></li>
<li><code>while</code>   <b> </b>      ,   <b></b> <code>Update</code>,   <code>LateUpdate</code>.     ,     !</li>
<li>      ,    ,      ,   <code>Awaiting</code>,    UGUI   ,   ,  <code>await</code> ,        -   </li>
<li>         <code>Update</code>  -   . <code>await</code>     .</li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It remains to demystify the “pending object”, which I did not fully solve, but at least I see how it works, because it was intentionally encoded. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the first frame, where I clicked on the button, there is nothing strange. </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(the same magic one </font></font><code>MonoBehaviour Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><code>EventSystem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uses the </font></font><code>Input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API and sees my click, after which it scans my button on the canvas and sees that it can do something. Then it is called in </font></font><code>public async void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and reaches that line. (You can also use these </font></font><code>ExecuteEvents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manually! This is a helper </font></font><code>static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">class.) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ut/6q/yb/ut6qybougoh8yuhav3o2gpn8hly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the next frame, where the magic happens, the call stack can accurately show us who processes the check for us every few frames. I do not quite understand what is happening here. (although this works) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fr/gw/uj/frgwujptlworykklroix5o0m4sk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When I checked</font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, a lot seems to be called from the engine code, so I can do nothing but guess. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/re/qh/vm/reqhvmmgmoxuzm6i-e-9ts49txm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But there is something called there </font></font><code>WorkRequest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that represents each of your expected unfinished business. </font><font style="vertical-align: inherit;">I assume that the return is </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properly registered in a “game-like” way, which is compatible with the personnel paradigm and ensures that all safe code is locked in the main thread so that you can fully do something after any </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, because it will be done at the right time in the frame .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Task.Yield ()</font></font></h4><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This method has a very confusing description: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.yield?view=netframework-4.8</font></font></a></i><br>
<blockquote><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">YieldAwaitable</a><br>
<br>
 ,  ,          .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">SynchronizationContext</a>   NULL,     .     ,     ,    .<br>
<br>
<b></b><br>
<br>
   <code>await Task.Yield()</code>;   ,     .      ( SynchronizationContext),         .   ,  ,         ,    .  ,    UI     UI,    ,    ,     .     ,  <code>await Task.Yield()</code>;   UI .      « ,    ContinueWith»   «   .NET».</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
English is not my native language, and I think that neither C # </font></font><code>yield return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nor </font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reflect the function that they perform. But let's move on to the definition of the method. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6k/-f/oi/6k-foipgostpw8fxs9c9znoz7jo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The alleged use case in the note seems to indicate that the method is not really </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but you would like to turn it into </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, so you need to </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(expect) somewhere in it, therefore it </font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is an ideal scapegoat. Instead of immediately terminating the method (remember that async will not magically turn the method into asynchronous, it depends on the contents of the method), now you </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">force</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it to be asynchronous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in our case, the recipient of the context is not an ordinary context, but </font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Now</font></font><code>Task.Yield()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">has a more useful function that effectively continues to work in the next frame. </font><font style="vertical-align: inherit;">If it were ordinary </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, I suppose it could produce an infinite loop in our example, since it will continue continue straight through </font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">again and again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It returns </font></font><code>YieldAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which the caller can use to continue. </font><font style="vertical-align: inherit;">As our log testifies, “Awaited” was recorded at the beginning of each frame, because the context (the code next to it </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) was saved in this aviator. </font></font><code>UnitySynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does some magic, waits for the frame and uses this aveyter to continue, then he reaches </font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and returns a new one again </font></font><code>YieldAwaiter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This will probably continue to add new </font></font><code>WorkRequest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code earlier in each frame as a waiting task until </font></font><code>while</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it becomes</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UniTask</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is a popular </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UniTask</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package </font><font style="vertical-align: inherit;">that completely eliminates </font></font><code>SynchronizationContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and introduces a new type of lighter task </font></font><code>UniTask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that directly binds to the </font></font><code>PlayerLoop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API. </font><font style="vertical-align: inherit;">Then you can choose the time when the check should occur in the next frame. </font><font style="vertical-align: inherit;">(Initialization? Late update?) But, in fact, you know what </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">works without any plugin. </font><font style="vertical-align: inherit;">This will be useful with Addressables wherever </font></font><code>AsyncOperationHandle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">possible. </font></font><code>Task</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which you can use with </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To view</font></font></h3><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7eKi6NKri6I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a good conversation, which shows that it </font></font><code>Await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already works fine, but there are pluses to the reasonably used coroutine. </font><font style="vertical-align: inherit;">You can pay more attention to this slide to sort it out a bit if you are still confused.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/md/kw/8cmdkwfptrr0hr-y6twos_oto7u.png"><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We create a network shooter in space in an hour and a half.</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506940/index.html">The road to ideal: a short guide for programmers and their leaders</a></li>
<li><a href="../en506950/index.html">What is School 21, and why is it so designed</a></li>
<li><a href="../en506952/index.html">API portal: what to look for when designing. Wrike Experience</a></li>
<li><a href="../en506954/index.html">Another article about Rails and ELK</a></li>
<li><a href="../en506956/index.html">Quantum Technology and Health</a></li>
<li><a href="../en506964/index.html">Android Development: Career Review for May 2020</a></li>
<li><a href="../en506976/index.html">Overview of Solutionix D500 and D700 3D Scanners</a></li>
<li><a href="../en506980/index.html">HackTheBox endgame. Walkthrough Xen Lab. Pentest Active Directory</a></li>
<li><a href="../es486176/index.html">Memo de correspondencia de correo electrónico corporativo</a></li>
<li><a href="../es486178/index.html">FOSS News No. 1 - revisión de noticias gratuitas y de código abierto del 27 de enero al 2 de febrero de 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>