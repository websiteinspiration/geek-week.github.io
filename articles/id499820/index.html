<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¤¸ğŸ¿ ğŸ§˜ğŸ» Mengapa kami memilih Kotlin sebagai salah satu bahasa target kami. Bagian 2: Kotlin Multiplatform ğŸ• âŒ›ï¸ ğŸ˜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami melanjutkan serangkaian artikel tentang memperkenalkan bahasa Kotlin ke dalam proses pengembangan kami. Cari bagian pertama di sini . 
 
 Pada 20...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Mengapa kami memilih Kotlin sebagai salah satu bahasa target kami. Bagian 2: Kotlin Multiplatform</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/domclick/blog/499820/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami melanjutkan serangkaian artikel tentang memperkenalkan bahasa Kotlin ke dalam proses pengembangan kami. Cari bagian pertama di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada 2017, proyek ambisius dari Jetbrains menyaksikan hari yang cerah, menawarkan perspektif baru tentang pengembangan lintas platform. Kompilasi kode kotlin menjadi kode asli berbagai platform! Kami di Domklik, pada gilirannya, selalu mencari cara untuk mengoptimalkan proses pengembangan. Apa yang bisa lebih baik daripada menggunakan kembali kode, kami pikir? Itu benar - jangan menulis kode sama sekali. Dan agar semuanya berfungsi seperti yang Anda inginkan. Tetapi sementara ini tidak terjadi. Dan jika ada solusi yang memungkinkan kita, tanpa menghabiskan banyak usaha, untuk menggunakan basis kode tunggal untuk platform yang berbeda, mengapa tidak mencoba?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halo semuanya! </font><font style="vertical-align: inherit;">Nama saya Gennady Vasilkov, saya seorang pengembang android di Domklik dan hari ini saya ingin berbagi dengan Anda pengalaman kami dalam mengembangkan Kotlin Multiplatform untuk perangkat seluler, beri tahu kami kesulitan apa yang kami hadapi, bagaimana kami menyelesaikan dan apa yang akhirnya kami lakukan. </font><font style="vertical-align: inherit;">Topiknya pasti akan menarik bagi mereka yang ingin mencoba Kotlin MPP (proyek Multiplatform), atau sudah mencobanya, tetapi tidak menyelesaikan produksi. </font><font style="vertical-align: inherit;">Atau membawa, tetapi tidak seperti yang saya inginkan. </font><font style="vertical-align: inherit;">Saya akan mencoba menyampaikan visi kami tentang bagaimana proses pengembangan dan pengiriman perpustakaan yang dikembangkan harus diatur (menggunakan salah satunya sebagai contoh, saya akan memberi tahu Anda awal dari jalur pengembangan kami di Kotlin MPP). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda ingin cerita bagaimana kami melakukannya? </font><font style="vertical-align: inherit;">Kami memilikinya!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/yh/d9/axyhd9vvdn715-ifysok3lk0gpg.jpeg"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secara singkat tentang teknologi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi mereka yang belum mendengar atau tidak terjun ke topik, itu menggantung di dunia Jawa dan hanya pergi ke dunia Kotlin (atau tidak pergi, tetapi mengintip): Kotlin MPP adalah teknologi yang memungkinkan Anda untuk menggunakan kode yang pernah ditulis pada banyak platform sekaligus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perkembangannya, tidak mengherankan, dalam bahasa Kotlin di IntelliJ IDEA atau Android Studio. Nilai tambahnya adalah semua pengembang android (setidaknya bersama kami) tahu dan menyukai bahasa dan lingkungan pengembangan yang luar biasa ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga merupakan nilai tambah besar dalam mengkompilasi kode yang dihasilkan ke bahasa-bahasa asli untuk setiap platform (OBJ-C, JS, semuanya jelas dengan JVM).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yaitu, semuanya keren. </font><font style="vertical-align: inherit;">Menurut pendapat saya, Kotlin Multiplatform ideal untuk membawa logika bisnis ke perpustakaan. </font><font style="vertical-align: inherit;">Dimungkinkan juga untuk menulis aplikasi sepenuhnya, tetapi untuk saat ini terlihat terlalu ekstrem, tetapi pengembangan perpustakaan cocok untuk proyek-proyek besar seperti kita.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit teknis, untuk memahami bagaimana proyek ini bekerja di MPP Kotlin</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistem build adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mendukung sintaks dalam skrip groovy dan kotlin (kts).</font></font><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlin MPP memiliki konsep target - platform target. </font><font style="vertical-align: inherit;">Dalam blok ini, sistem operasi yang kita butuhkan dikonfigurasi, kode asli yang akan mengkompilasi kode kita di Kotlin. </font><font style="vertical-align: inherit;">Pada gambar di bawah ini 2 target diimplementasikan, jvm dan js (gambar sebagian diambil dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">situs web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<img src="https://habrastorage.org/webt/xw/sd/qk/xwsdqkspxy9vbirtocrlj0cf2n8.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dukungan untuk platform lain diimplementasikan dengan cara yang sama.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set sumber - nama itu sendiri jelas bahwa kode sumber untuk platform disimpan di sini. </font><font style="vertical-align: inherit;">Ada set sumber umum dan platform (ada banyak dari mereka karena ada target dalam proyek ini, ini diikuti oleh IDE). </font><font style="vertical-align: inherit;">Tidak mungkin untuk tidak menyebutkan mekanisme harapan-aktual di sini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3c/yn/mw/3cynmwhc0ctyakpsq1awmjk9gmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mekanisme ini memungkinkan pengaksesan kode khusus platform dari modul Common. </font><font style="vertical-align: inherit;">Kami mendeklarasikan pernyataan harapan dalam modul Umum dan mengimplementasikannya di platform. </font><font style="vertical-align: inherit;">Di bawah ini adalah contoh penggunaan mekanisme untuk mendapatkan tanggal pada perangkat:</font></font><br>
<br>
<pre><code class="kotlin hljs">Common:
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">expect</span> <span class="hljs-keyword">val</span> timestamp: <span class="hljs-built_in">Long</span><font></font>
<font></font>
Android/JVM:<font></font>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">val</span> timestamp: <span class="hljs-built_in">Long</span> 
    <span class="hljs-keyword">get</span>() = java.lang.System.currentTimeMillis()<font></font>
<font></font>
iOS:<font></font>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">val</span> timestamp: <span class="hljs-built_in">Long</span> 
    <span class="hljs-keyword">get</span>() = platform.Foundation.NSDate().timeIntervalSince1970.toLong()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat untuk modul platform, pustaka sistem Java dan iOS Foundation masing-masing tersedia.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Poin-poin ini cukup untuk memahami apa yang akan dibahas nanti.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengalaman kami</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, pada titik tertentu, kami memutuskan bahwa semuanya diterima oleh Kotlin MPP (kemudian juga disebut Kotlin / Asli) sebagai standar dan kami mulai menulis perpustakaan tempat kami berbagi kode umum. </font><font style="vertical-align: inherit;">Pada awalnya itu hanya kode untuk platform mobile, di beberapa titik mereka menambahkan dukungan untuk jvm backend. </font><font style="vertical-align: inherit;">Di android, pengembangan dan publikasi perpustakaan yang dikembangkan tidak menimbulkan masalah, pada iOS, dalam praktiknya, mereka menghadapi beberapa masalah, tetapi mereka berhasil diselesaikan dan model kerja untuk mengembangkan dan menerbitkan kerangka kerja berhasil.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saatnya sesuatu untuk nongkrong!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami telah melakukan berbagai fungsi di perpustakaan terpisah yang kami gunakan dalam proyek utama.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Analisis</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Latar belakang kejadian</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bukan rahasia lagi bahwa semua aplikasi seluler mengumpulkan banyak analitik. Acara digantung dengan semua peristiwa penting dan tidak terlalu (misalnya, dalam aplikasi kita lebih dari 600 berbagai metrik dikumpulkan). Dan apa itu koleksi metrik? Secara sederhana, ini adalah panggilan ke fungsi yang mengirimkan acara dengan kunci tertentu ke isi mesin analitik. Dan kemudian masuk ke berbagai sistem analitik seperti firebase, appmetrica, dan lainnya. Apa masalah dengan ini? Duplikasi konstan dari kode yang sama (plus atau minus) pada dua platform! Ya, dan faktor manusia tidak dapat ditemukan di mana pun - pengembang bisa keliru, baik atas nama kunci dan dalam set meta-data yang dikirimkan dengan acara tersebut. Ini jelas perlu ditulis sekali dan digunakan pada setiap platform. Kandidat ideal untuk membuat logika umum dan teknologi pengujian (ini adalah pena uji kami di Kotlin Mpp).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana cara mengimplementasikannya</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mentransfer peristiwa itu sendiri ke perpustakaan (dalam bentuk fungsi dengan kunci kabel dan satu set data meta yang diperlukan dalam argumen) dan menulis logika baru untuk memproses peristiwa ini. </font><font style="vertical-align: inherit;">Format acara disatukan dan mesin pawang (bus) dibuat, di mana semua acara dituangkan. </font><font style="vertical-align: inherit;">Dan untuk berbagai sistem analitik, pendengar adaptor menulis (solusi yang sangat berguna ternyata, ketika menambahkan analitik baru, kita dapat dengan mudah mengarahkan ulang semuanya, atau secara selektif, setiap peristiwa ke analitik baru).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vc/zh/vq/vczhvqo8-r4ap2r0tmwoczqloqe.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menarik dalam proses implementasi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena fitur penerapan bekerja dengan stream di Kotlin / Native untuk iOS, Anda tidak bisa hanya mengambil dan bekerja dengan objek Kotlin sebagai singleton dan menulis data di sana kapan saja. </font><font style="vertical-align: inherit;">Semua objek yang mentransfer statusnya di antara utas harus dibekukan (ada fungsi beku () untuk ini). </font><font style="vertical-align: inherit;">Tetapi perpustakaan, antara lain, menyimpan keadaan yang dapat berubah selama kehidupan aplikasi. </font><font style="vertical-align: inherit;">Ada beberapa cara untuk mengatasi situasi ini, kami memutuskan yang paling sederhana:</font></font><br>
<br>
<pre><code class="kotlin hljs">Common:<font></font>
<font></font>
<span class="hljs-keyword">expect</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicReference</span>&lt;<span class="hljs-type">T</span>&gt;</span>(value_: T) {
    <span class="hljs-keyword">var</span> value: T<font></font>
}<font></font>
<font></font>
Android:<font></font>
<font></font>
<span class="hljs-keyword">actual</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicReference</span>&lt;<span class="hljs-type">T</span>&gt; <span class="hljs-title">actual</span> <span class="hljs-keyword">constructor</span></span>(value_: T) {
    <span class="hljs-keyword">actual</span> <span class="hljs-keyword">var</span> value: T = value_<font></font>
}<font></font>
<font></font>
iOS:<font></font>
<font></font>
<span class="hljs-keyword">actual</span> <span class="hljs-keyword">typealias</span> AtomicReference&lt;V&gt; = kotlin.<span class="hljs-keyword">native</span>.concurrent.AtomicReference&lt;V&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Opsi ini cocok untuk penyimpanan keadaan sederhana. </font><font style="vertical-align: inherit;">Dalam kasus kami, konfigurasi platform disimpan:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">object</span> Config {
    <span class="hljs-keyword">val</span> platform = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> manufacturer = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> model = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> deviceId = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> appVersion = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> sessionId = AtomicReference&lt;String?&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">var</span> debug = AtomicReference&lt;<span class="hljs-built_in">Boolean</span>&gt;(<span class="hljs-literal">false</span>)<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengapa ini dibutuhkan? Kami tidak mendapatkan beberapa informasi di awal aplikasi, ketika modul seharusnya sudah dimuat dan objeknya sudah dalam keadaan beku. Untuk menambahkan informasi ini ke konfigurasi dan kemudian dapat dibaca dari aliran yang berbeda di iOS dan langkah seperti itu diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menghadapi masalah penerbitan perpustakaan. Dan jika Android tidak memiliki masalah dengan ini, maka metode yang diusulkan oleh dokumentasi resmi pada waktu itu untuk menghubungkan kerangka kerja yang dirakit secara langsung ke proyek iOS tidak sesuai dengan kami karena sejumlah alasan, saya ingin mendapatkan versi baru yang sesederhana dan setransparan mungkin. Plus, versi didukung.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusinya adalah dengan menghubungkan kerangka kerja melalui file pod. </font><font style="vertical-align: inherit;">Untuk melakukan ini, mereka membuat file podspec dan kerangka itu sendiri, menempatkannya di repositori dan menghubungkan pustaka ke proyek menjadi sangat sederhana dan nyaman bagi pengembang iOS. </font><font style="vertical-align: inherit;">Juga, sekali lagi, untuk kenyamanan pengembangan, kami mengumpulkan artefak tunggal untuk semua arsitektur, kerangka kerja yang disebut lemak (sebenarnya biner tebal di mana semua arsitektur dan menambahkan file meta yang dihasilkan oleh plugin kotlin bergaul bersama). </font><font style="vertical-align: inherit;">Implementasi semua ini di bawah spoiler:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Siapa yang peduli bagaimana kami melakukannya sebelum keputusan resmi</font></font></b>
                        <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah plugin kotlin mengumpulkan banyak kerangka kerja berbeda untuk arsitektur berbeda, kami secara manual membuat kerangka universal baru tempat kami menyalin data meta dari apa pun (dalam kasus kami, kami mengambil arm64):</font></font><br>
<pre><code class="kotlin hljs"><span class="hljs-comment">//add meta files (headers, modules and plist) from arm64 platform</span><font></font>
task copyMeta() {<font></font>
    dependsOn build<font></font>
<font></font>
    doLast {<font></font>
        copy {<font></font>
            from(<span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/bin/iphone/main/release/framework/<span class="hljs-subst">${frameworkName}</span>.framework"</span>)<font></font>
            into <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/iphone_universal/<span class="hljs-subst">${frameworkName}</span>.framework"</span><font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
,    ,   ,   .     lipo,    :<br>
<pre><code class="kotlin hljs"><span class="hljs-comment">//merge binary files into one</span><font></font>
task lipo(type: Exec) {<font></font>
    dependsOn copyMeta<font></font>
<font></font>
    def frameworks = files(<font></font>
            <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/bin/iphone32/main/release/framework/<span class="hljs-subst">${frameworkName}</span>.framework/<span class="hljs-variable">$frameworkName</span>"</span>,
            <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/bin/iphone/main/release/framework/<span class="hljs-subst">${frameworkName}</span>.framework/<span class="hljs-variable">$frameworkName</span>"</span>,
            <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/bin/iphoneSim/main/release/framework/<span class="hljs-subst">${frameworkName}</span>.framework/<span class="hljs-variable">$frameworkName</span>"</span><font></font>
    )<font></font>
    def output = file(<span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/iphone_universal/<span class="hljs-subst">${frameworkName}</span>.framework/<span class="hljs-variable">$frameworkName</span>"</span>)<font></font>
    inputs.files frameworks<font></font>
    outputs.file output<font></font>
    executable = <span class="hljs-string">'lipo'</span><font></font>
    args = frameworks.files<font></font>
    args += [<span class="hljs-string">'-create'</span>, <span class="hljs-string">'-output'</span>, output]<font></font>
}<font></font>
</code></pre><br>
  ,     -       Kotlin MPP   Info.plist   UIRequiredDeviceCapabilities,        (    ).       PlistBuddy:<br>
<pre><code class="kotlin hljs"><span class="hljs-comment">//workaround</span>
<span class="hljs-comment">//remove UIRequiredDeviceCapabilities key from plist file (because we copy this file from arm64, only arm64 architecture was available)</span><font></font>
task editPlistFile(type: Exec) {<font></font>
    dependsOn lipo<font></font>
<font></font>
    executable = <span class="hljs-string">"/bin/sh"</span>
    def script = <span class="hljs-string">'./scripts/edit_plist_file.sh'</span>
    def command = <span class="hljs-string">"Delete :UIRequiredDeviceCapabilities"</span>
    def file = <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/iphone_universal/<span class="hljs-subst">${frameworkName}</span>.framework/Info.plist"</span><font></font>
<font></font>
    args += [script, command, file]<font></font>
}<font></font>
</code></pre><br>
edit_plist_file.sh:<br>
<pre><code class="bash hljs">/usr/libexec/PlistBuddy -c <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>
</code></pre><br>
 ,  zip      (    podspec ):<br>
<pre><code class="kotlin hljs">task zipIosFramework(type: Zip) {<font></font>
    dependsOn editPlistFile<font></font>
    from <span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/iphone_universal/"</span>
    include <span class="hljs-string">'**/*'</span><font></font>
    archiveName = iosArtifactName<font></font>
    destinationDir(file(<span class="hljs-string">"<span class="hljs-variable">$buildDir</span>/iphone_universal_zipped/"</span>))<font></font>
}<font></font>
</code></pre><br>
  podspec :<br>
<pre><code class="kotlin hljs">task generatePodspecFile(type: Exec) {<font></font>
    dependsOn zipIosFramework<font></font>
<font></font>
    executable = <span class="hljs-string">"/bin/sh"</span><font></font>
<font></font>
    def script = <span class="hljs-string">'./scripts/generate_podspec_file.sh'</span><font></font>
<font></font>
    def templateStr = <span class="hljs-string">"version_name"</span>
    def sourceFile = <span class="hljs-string">'./podspec/template.podspec'</span>
    def replaceStr = <span class="hljs-string">"<span class="hljs-variable">$version</span>"</span><font></font>
<font></font>
    args += [script, templateStr, replaceStr, sourceFile, generatedPodspecFile]<font></font>
}<font></font>
</code></pre><br>
 generate_podscpec_file.sh      :<br>
<pre><code class="bash hljs">sed -e s/<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>/<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>/g &lt;<span class="hljs-string">"<span class="hljs-variable">$3</span>"</span> &gt;<span class="hljs-string">"<span class="hljs-variable">$4</span>"</span>
</code></pre><br>
   curl        :<br>
<pre><code class="kotlin hljs">task uploadIosFrameworkToNexus(type: Exec) {<font></font>
    dependsOn generatePodspecFile<font></font>
<font></font>
    executable = <span class="hljs-string">"/bin/sh"</span>
    def body = <span class="hljs-string">"-s -k -v --user \'<span class="hljs-variable">$userName</span>:<span class="hljs-variable">$password</span>\' "</span> +
            <span class="hljs-string">"--upload-file <span class="hljs-variable">$buildDir</span>/iphone_universal_zipped/<span class="hljs-variable">$iosArtifactName</span> <span class="hljs-variable">$iosUrlRepoPath</span>"</span>
    args += [<span class="hljs-string">'-c'</span>, <span class="hljs-string">"curl <span class="hljs-variable">$body</span>"</span>]<font></font>
}<font></font>
<font></font>
task uploadPodspecFileToNexus(type: Exec) {<font></font>
    dependsOn uploadIosFrameworkToNexus<font></font>
<font></font>
    executable = <span class="hljs-string">"/bin/sh"</span>
    def body = <span class="hljs-string">"-s -k -v --user \'<span class="hljs-variable">$userName</span>:<span class="hljs-variable">$password</span>\' "</span> +
            <span class="hljs-string">"--upload-file <span class="hljs-variable">$generatedPodspecFile</span> <span class="hljs-variable">$iosUrlRepoPath</span>"</span>
    args += [<span class="hljs-string">'-c'</span>, <span class="hljs-string">"curl <span class="hljs-variable">$body</span>"</span>]<font></font>
}<font></font>
</code></pre><br>
        :<br>
<pre><code class="kotlin hljs">task createAndUploadUniversalIosFramework() {<font></font>
    dependsOn uploadPodspecFileToNexus<font></font>
    doLast {<font></font>
        println <span class="hljs-string">'createAndUploadUniversalIosFramework complete'</span><font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<br>
Profit!<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat penulisan, ada solusi resmi untuk membuat kerangka kerja yang gemuk dan menghasilkan file podspec (dan umumnya integrasi dengan CocoaPods). </font><font style="vertical-align: inherit;">Jadi kita hanya perlu mengunggah kerangka kerja dan file podspec ke repositori dan menghubungkan proyek di iOS dengan cara yang sama seperti sebelumnya:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  fat framework  Jetbrains</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  podspec   Jetbrains</a><br>
</li>
</ul><br>
<br>
<h4></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menerapkan skema tersebut dengan satu tempat untuk menyimpan acara, mekanisme untuk memproses dan mengirim metrik, proses kami menambahkan metrik baru dikurangi menjadi fakta bahwa satu pengembang menambahkan fungsi baru ke perpustakaan, yang menggambarkan kunci acara dan meta-data yang diperlukan yang harus ditransmisikan oleh pengembang untuk acara tertentu . Lebih jauh, pengembang platform lain hanya mengunduh versi baru perpustakaan dan menggunakan fungsi baru di tempat yang tepat. Telah menjadi jauh lebih mudah untuk mempertahankan konsistensi seluruh sistem analitik, kini juga jauh lebih mudah untuk mengubah implementasi internal bus peristiwa. Sebagai contoh, di beberapa titik, untuk salah satu analis kami, perlu bagi kami untuk menerapkan buffer acara kami sendiri, yang dilakukan segera di perpustakaan, tanpa perlu mengubah kode pada platform. Keuntungan!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami terus mentransfer kode semakin banyak ke Kotlin MPP, dalam artikel berikut saya akan melanjutkan kisah pengantar kami ke dunia pengembangan lintas platform menggunakan dua perpustakaan lebih sebagai contoh, di mana serialisasi dan database digunakan, bekerja dengan waktu. </font><font style="vertical-align: inherit;">Saya akan memberi tahu Anda tentang batasan yang ditemui saat menggunakan beberapa kerangka kerja kotlin dalam satu proyek iOS dan cara mengatasi batasan ini.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan sekarang secara singkat tentang hasil penelitian kami</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ Semuanya bekerja dengan stabil dalam produksi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ Basis kode terpadu logika layanan bisnis untuk semua platform (lebih sedikit kesalahan dan perbedaan). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ Mengurangi biaya dukungan dan mengurangi waktu pengembangan untuk persyaratan baru. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ Kami meningkatkan keahlian pengembang.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan yang berhubungan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Situs web </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiplin Platform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kotlin: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">www.jetbrains.com/lp/mobilecrossplatform</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ZY: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak ingin mengulangi tentang bahasa singkat, dan karenanya fokus pada logika bisnis saat menulis kode. Saya dapat menyarankan beberapa artikel yang </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
membahas </font><font style="vertical-align: inherit;">topik ini: </font><font style="vertical-align: inherit;">â€œKotlin di bawah tenda - lihat dekode yang didekompilasiâ€ - sebuah artikel yang menjelaskan pengoperasian kompiler Kotlin dan membahas struktur dasar bahasa. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr.com/en/post/425077</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dua bagian artikel "Kotlin, kompilasi dalam bytecode dan kinerja", melengkapi artikel sebelumnya. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr.com/ru/company/inforion/blog/330060 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habr.com/ru/company/inforion/blog/330064</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasha Finkelstein melaporkan "Kotlin - dua tahun dalam produksi dan bukan celah tunggal", yang didasarkan pada pengalaman menggunakan dan mengimplementasikan Kotlin di perusahaan kami. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.youtube.com/watch?v=nCDWb7O1ZW4</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495340/index.html">Cara mengubah pekerjaan administrator di restoran untuk pekerjaan yang baik di bidang TI</a></li>
<li><a href="../id495342/index.html">Penyelesaian kartu bank dalam perdagangan - membuat dataset terbuka dan infografis di Google Data Studio</a></li>
<li><a href="../id495344/index.html">Menyatukannya: bagaimana Lamoda membuat layanan Go-nya konsisten</a></li>
<li><a href="../id495346/index.html">Dari kesalahan hingga peringatan dengan tindakan</a></li>
<li><a href="../id499818/index.html">Pemasaran Telegram Uzbek</a></li>
<li><a href="../id499822/index.html">Titik akses nirkabel vs router: apa perbedaannya?</a></li>
<li><a href="../id499824/index.html">Intisari acara untuk perekrut SDM dan TI pada Mei 2020</a></li>
<li><a href="../id499826/index.html">Tekanan darah terdistribusi</a></li>
<li><a href="../id499832/index.html">Bagaimana cara mengatur dengan cepat dan aman pekerjaan jarak jauh karyawan? Kami berbicara tentang berbagai pendekatan: dengan VDI dan tidak hanya</a></li>
<li><a href="../id499834/index.html">Temui Felix Arithmometer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>