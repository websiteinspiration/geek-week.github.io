<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🔧 🔋 👧🏾 Accès à distance aux machines virtuelles avec GPU à l'aide de Citrix 🐎 🏴󠁧󠁢󠁳󠁣󠁴󠁿 😏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ce guide détaille les étapes à suivre pour préparer l'accès à distance aux bureaux virtuels à l'aide de la technologie offerte par Citrix. 
 
 Il sera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Accès à distance aux machines virtuelles avec GPU à l'aide de Citrix</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497818/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce guide détaille les étapes à suivre pour préparer l'accès à distance aux bureaux virtuels à l'aide de la technologie offerte par Citrix. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il sera utile à ceux qui se sont récemment familiarisés avec la technologie de virtualisation de bureau, car il s'agit d'une collection de commandes utiles assemblées à partir de ~ 10 manuels, dont beaucoup sont disponibles sur les sites Citrix, Nvidia, Microsoft, après autorisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette implémentation contient les étapes de préparation de l'accès à distance aux machines virtuelles (VM) avec les accélérateurs graphiques Nvidia Tesla M60 et le système d'exploitation Centos 7.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons donc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Préparation d'un hyperviseur pour l'hébergement de machines virtuelles</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment télécharger et installer XenServer 7.4? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment ajouter XenServer à Citrix XenCenter? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment télécharger et installer le pilote Nvidia? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment changer le mode Nvidia Tesla M60? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment monter le stockage?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le lien de téléchargement de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est disponible après autorisation sur le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eb/p2/kr/ebp2kr2edt_ktpzrhsimmkaofbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installons XenServer.iso sur un serveur avec 4x NVIDIA Tesla M60 de manière régulière. Dans mon cas, l'iso est monté via IPMI. Pour les serveurs Dell, le BMC est géré via IDRAC. Les étapes d'installation sont presque identiques à l'installation de systèmes d'exploitation de type Linux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon adresse GPU XenServer c est 192.168.1.100 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez XenCenter.msi sur l'ordinateur local à partir duquel nous gérerons les hyperviseurs et les machines virtuelles. Ajoutez-y un serveur avec un GPU et XenServer en cliquant sur l'onglet «Serveur», puis sur «Ajouter». Saisissez le nom d'utilisateur et le mot de passe root spécifiés lors de l'installation de XenServer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yy/qv/qw/yyqvqwxcbnxhwkj0ho3brs1lqom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans XenCenter, après avoir cliqué sur le nom de l'hyperviseur ajouté, l'onglet Console sera disponible. </font><font style="vertical-align: inherit;">Dans le menu, sélectionnez «Configuration du service distant» et activez l'autorisation SSH - «Activer / désactiver le shell distant».</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilote Nvidia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais laisser libre cours à mes émotions et dire que pendant tout le temps que j'ai travaillé avec vGPU, je n'ai jamais </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visité le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">nvid.nvidia.com</font></a><font style="vertical-align: inherit;"> du premier coup. </font><font style="vertical-align: inherit;">Si l'autorisation ne fonctionne pas, je recommande Internet Explorer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez zip depuis vGPU, ainsi que GPUMode Change Utility: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-gpumodeswitch-2020-01.zip </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/ia/ny/sjianylmppn9as35nnxtrwj-bhw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous suivons les versions. </font><font style="vertical-align: inherit;">Le nom de l'archive téléchargée indique la version des pilotes NVIDIA appropriés qui pourront être installés sur des machines virtuelles à l'avenir. </font><font style="vertical-align: inherit;">Dans mon cas, c'est 390,72. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetez des zip sur XenServer et décompressez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Changer le mode GPU et installer le pilote vGPU</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> NVIDIA-gpumodeswitch-2020-01<font></font>
$ gpumodeswitch --listgpumodes<font></font>
$ gpumodeswitch --gpumode graphics<font></font>
$ <span class="hljs-built_in">cd</span> ../NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81<font></font>
$ yum install NVIDIA-vGPU-xenserver-7.4-390.72.x86_64.rpm<font></font>
$ reboot</code></pre><br>
<img src="https://habrastorage.org/webt/qg/0m/lx/qg0mlxigfdyfvxvfpoijuh-sisa.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monter le stockage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurez un répertoire partagé à l'aide de NFS sur n'importe quel ordinateur du réseau.</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install epel-release<font></font>
$ yum install nfs-utils libnfs-utils<font></font>
$ systemctl <span class="hljs-built_in">enable</span> rpcbind<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-server<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-lock<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-idmap<font></font>
$ systemctl start rpcbind<font></font>
$ systemctl start nfs-server<font></font>
$ systemctl start nfs-lock<font></font>
$ systemctl start nfs-idmap<font></font>
$ firewall-cmd --permanent --zone=public --add-service=nfs<font></font>
$ firewall-cmd --permanent --zone=public --add-service=mountd<font></font>
$ firewall-cmd --permanent --zone=public --add-service=rpc-bind<font></font>
$ firewall-cmd --reload<font></font>
$ mkdir -p /nfs/store1<font></font>
$ chmod -R 777 /nfs/store1<font></font>
$ touch /nfs/store1/forcheck<font></font>
$ cat /etc/exports<font></font>
  ...<font></font>
  /nfs/store1 192.168.1.0/24(rw,async,crossmnt,no_root_squash,no_all_squash,no_subtree_check)<font></font>
$ systemctl restart nfs-server</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans XenCenter, sélectionnez XenServer et sélectionnez «Nouveau SR» dans l'onglet «Stockage». </font><font style="vertical-align: inherit;">Spécifiez le type de stockage - NFS ISO. </font><font style="vertical-align: inherit;">Le chemin doit pointer vers le répertoire partagé NFS.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image Citrix Master basée sur Centos 7</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment créer une machine virtuelle avec Centos 7? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment préparer une machine virtuelle pour créer un répertoire?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'image de Centos 7</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide de XenCenter, nous allons créer une machine virtuelle avec un GPU. </font><font style="vertical-align: inherit;">Dans l'onglet «VM», cliquez sur «New VM». </font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/fs/9g/etfs9g7biwgmswos8eazlinr_ba.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sélectionnons les paramètres nécessaires: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
modèle de VM - autre support d'installation </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom - modèle d' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
installation à partir de la bibliothèque ISO - Centos 7 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">téléchargement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), sélectionnez dans le stockage ISO NFS monté. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nombre de processeurs virtuels - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologie - 1 socket avec 4 cœurs par socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mémoire - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Type de GPU </font><font style="vertical-align: inherit;">30 Go </font><font style="vertical-align: inherit;">- GRID M60-4Q </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez ce disque virtuel - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réseau </font><font style="vertical-align: inherit;">80 Go </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après la création, la machine virtuelle apparaîtra dans la liste verticale à gauche. </font><font style="vertical-align: inherit;">Cliquez dessus et allez dans l'onglet "Console". </font><font style="vertical-align: inherit;">Nous attendrons que le programme d'installation de Centos 7 se charge et effectue les étapes nécessaires pour installer le système d'exploitation avec le shell GNOME.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Préparation d'image</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il m'a fallu beaucoup de temps pour préparer l'image avec Centos 7. </font><font style="vertical-align: inherit;">Cela a abouti à un ensemble de scripts qui facilite la configuration initiale de Linux et vous permet de créer un catalogue de machines virtuelles à l'aide de Citrix Machine Creation Services (MCS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le serveur DHCP installé sur ws-ad a attribué l'adresse IP 192.168.1.129 à la nouvelle machine virtuelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les paramètres de base.</font></font><br>
<br>
<pre><code class="bash hljs">$ hostnamectl <span class="hljs-built_in">set</span>-hostname template<font></font>
$ yum install -y epel-release<font></font>
$ yum install -y lsb mc gcc<font></font>
$ firewall-cmd --permanent --zone=dmz --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=external --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --add-service=ssh<font></font>
$ firewall-cmd --complete-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans XenCenter, dans l'onglet «Console», montez guest-tools.iso dans le lecteur DVD de la machine virtuelle et installez XenTools pour Linux.</font></font><br>
<br>
<pre><code class="bash hljs">$ mount /dev/cdrom /mnt<font></font>
$ /mnt/Linux/install.sh<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la configuration de XenServer, nous avons utilisé l'archive NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip téléchargée à partir du site Web NVIDIA, qui, en plus du pilote NVIDIA pour XenServer, contient le pilote NVIDIA dont nous avons besoin pour les clients vGPU. </font><font style="vertical-align: inherit;">Téléchargez et installez-le sur la machine virtuelle.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat /etc/default/grub<font></font>
  GRUB_TIMEOUT=5<font></font>
  GRUB_DISTRIBUTOR=<span class="hljs-string">"<span class="hljs-subst">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span><font></font>
  GRUB_DEFAULT=saved<font></font>
  GRUB_DISABLE_SUBMENU=<span class="hljs-literal">true</span>
  GRUB_TERMINAL_OUTPUT=<span class="hljs-string">"console"</span>
  GRUB_CMDLINE_LINUX=<span class="hljs-string">"rhgb quiet modprobe.blacklist=nouveau"</span>
  GRUB_DISABLE_RECOVERY=<span class="hljs-string">"true"</span><font></font>
$ grub2-mkconfig -o /boot/grub2/grub.cfg<font></font>
$ wget http://vault.centos.org/7.6.1810/os/x86_64/Packages/kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ yum install kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ reboot<font></font>
$ init 3<font></font>
$ NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81/NVIDIA-Linux-x86_64-390.75-grid.run<font></font>
$ cat /etc/nvidia/gridd.conf<font></font>
  ServerAddress=192.168.1.111<font></font>
  ServerPort=7070<font></font>
  FeatureType=1<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez le Linux Virtual Delivery Agent 1811 (VDA) pour Centos 7. Le lien de téléchargement pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux VDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est disponible après autorisation sur le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install -y LinuxVDA-1811.el7_x.rpm<font></font>
$ cat /var/xdl/mcs/mcs.conf<font></font>
  <span class="hljs-comment">#!/bin/bash</span><font></font>
  dns1=192.168.1.110<font></font>
  NTP_SERVER=some.ntp.ru<font></font>
  AD_INTEGRATION=winbind<font></font>
  SUPPORT_DDC_AS_CNAME=N<font></font>
  VDA_PORT=80<font></font>
  REGISTER_SERVICE=Y<font></font>
  ADD_FIREWALL_RULES=Y<font></font>
  HDX_3D_PRO=Y<font></font>
  VDI_MODE=Y<font></font>
  SITE_NAME=domain.ru<font></font>
  LDAP_LIST=ws-ad.domain.ru<font></font>
  SEARCH_BASE=DC=domain,DC=ru<font></font>
  START_SERVICE=Y<font></font>
$ /opt/Citrix/VDA/sbin/deploymcs.sh<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"exclude=kernel* xorg*"</span> &gt;&gt; /etc/yum.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Citrix Studio, créez le groupe Machine Catalog and Delivery. </font><font style="vertical-align: inherit;">Avant cela, vous devez installer et configurer Windows Server.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server avec contrôleur de domaine</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment télécharger et installer Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment installer les composants de Windows Server? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment configurer Active Directory, DHCP et DNS?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur Windows 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'une machine virtuelle (VM) avec Windows Server n'a pas besoin d'un GPU, nous utiliserons un serveur sans GPU comme hyperviseur. Par analogie avec la description ci-dessus, installez un autre XenServer pour héberger les machines virtuelles du système. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, créez une machine virtuelle pour Windows Server avec Active Directory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez Windows Server 2016 depuis le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il vaut mieux suivre le lien en utilisant Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide de XenCenter, nous allons créer une machine virtuelle. Dans l'onglet «VM», cliquez sur «New VM». </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sélectionnons les paramètres nécessaires: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modèle de machine virtuelle - Windows Server 2016 (64 bits) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom - ws-ad.domain.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installer à partir de la bibliothèque ISO - WindowsServer2016.iso, sélectionnez dans le stockage ISO NFS monté. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nombre de processeurs virtuels - 4</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologie - 1 socket avec 4 cœurs par socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mémoire - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Type GPU </font><font style="vertical-align: inherit;">20 Go </font><font style="vertical-align: inherit;">- aucun </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utiliser ce disque virtuel - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réseau </font><font style="vertical-align: inherit;">100 Go </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après la création, la machine virtuelle apparaîtra dans la liste verticale à gauche. Cliquez dessus et allez dans l'onglet "Console". Attendez que le programme d'installation de Windows Server se charge et suivez les étapes nécessaires pour installer le système d'exploitation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez dans XenTools VM. Faites un clic droit sur VM, puis "Installer Citrix VM Tools ...". Après cela, l'image dont vous avez besoin pour exécuter et installer XenTools sera montée. À la fin de l'installation, un redémarrage de la VM sera nécessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurer la carte réseau: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
adresse IP - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
masque </font><font style="vertical-align: inherit;">192.168.1.110 </font><font style="vertical-align: inherit;">- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
passerelle </font><font style="vertical-align: inherit;">255.255.255.0 </font><font style="vertical-align: inherit;">- 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si Windows Server n'est pas activé, activez-le. </font><font style="vertical-align: inherit;">La clé peut être prise au même endroit où l'image a été téléchargée.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurez le nom de l'ordinateur. </font><font style="vertical-align: inherit;">Dans mon cas, c'est ws-ad.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation des composants</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le gestionnaire de serveur, sélectionnez «Ajouter des rôles et des fonctionnalités». </font><font style="vertical-align: inherit;">Notez l'installation du serveur DHCP, du serveur DNC et des services de domaine Active Directory. </font><font style="vertical-align: inherit;">Cochez la case "Recharger automatiquement".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/5c/mk/r25cmkhjpon52zta-7ysbpffyig.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer Active Directoy</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir redémarré la machine virtuelle, cliquez sur "Élever ce serveur au niveau du contrôleur de domaine" et ajoutez une nouvelle forêt domain.ru.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration du serveur DHCP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le panneau supérieur du gestionnaire de serveurs, cliquez sur le point d'exclamation pour enregistrer les modifications lors de l'installation du serveur DHCP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons aux paramètres du serveur DHCP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wf/t6/pg/wft6pgjw4_lxdcvqa0rkphy4hhe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez une nouvelle zone 192.168.1.120-130. </font><font style="vertical-align: inherit;">Nous ne changeons pas le reste. </font><font style="vertical-align: inherit;">Sélectionnez «Configurer les paramètres DHCP maintenant» et entrez l'adresse IP ws-ad (192.168.1.110) comme passerelle et DNS, qui sera spécifié dans les paramètres des adaptateurs réseau des machines virtuelles à partir du répertoire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration du serveur DNS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons aux paramètres du serveur DNS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sg/pc/kc/sgpckcwrrfz4z-6jy5pf0ibbnbo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créons une nouvelle zone de visualisation directe - zone principale, pour tous les serveurs DNS du domaine domain.ru. </font><font style="vertical-align: inherit;">Ne changez rien d'autre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créez une nouvelle zone de recherche inversée en sélectionnant les mêmes options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les propriétés du serveur DNS, dans l'onglet "Avancé", cochez la case "Désactiver la récursivité".</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer un utilisateur test</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allons au "Centre d'administration Active Directory" </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4s/si/tp4ssidqmpefwnpa1excc5oexii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section "Utilisateurs" à droite, cliquez sur "Créer". </font><font style="vertical-align: inherit;">Saisissez un nom, par exemple test, puis cliquez sur OK ci-dessous. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/vd/pm/b-vdpmjw8osh9g0tor-ab0jl4sg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons sélectionner l'utilisateur créé et sélectionner "Réinitialiser le mot de passe" dans le menu vertical à droite. </font><font style="vertical-align: inherit;">Laissez la coche «Exiger un changement de mot de passe la prochaine fois que vous vous connecterez au système».</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server avec Citrix Delivery Controller</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment télécharger et installer Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment télécharger et installer Citrix Delivery Controller? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment installer et configurer Citrix License Manager? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment installer et configurer NVIDIA License Manager?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur Windows 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'une machine virtuelle (VM) avec Windows Server n'a pas besoin d'un GPU, nous utiliserons un serveur sans GPU comme hyperviseur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez Windows Server 2016 depuis le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il vaut mieux suivre le lien en utilisant Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide de XenCenter, nous allons créer une machine virtuelle. Dans l'onglet «VM», cliquez sur «New VM». </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sélectionnez les paramètres nécessaires: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modèle de machine virtuelle - Windows Server 2016 (64 bits) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom - ws-dc </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installer à partir de la bibliothèque ISO - WindowsServer2016.iso, sélectionnez dans le stockage ISO NFS monté. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nombre de vCPU - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topologie - 1 socket avec 4 cœurs par socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mémoire - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Type de GPU </font><font style="vertical-align: inherit;">20 Go </font><font style="vertical-align: inherit;">- aucun </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utiliser ce disque virtuel - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réseau </font><font style="vertical-align: inherit;">100 Go</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après la création, la machine virtuelle apparaîtra dans la liste verticale à gauche. Cliquez dessus et allez dans l'onglet "Console". Nous attendrons que le programme d'installation de Windows Server se charge et accomplisse les étapes nécessaires pour installer le système d'exploitation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez dans XenTools VM. Faites un clic droit sur VM, puis "Installer Citrix VM Tools ...". Après cela, l'image dont vous avez besoin pour exécuter et installer XenTools sera montée. À la fin de l'installation, un redémarrage de la machine virtuelle est requis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurez la carte réseau: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
adresse IP - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
masque </font><font style="vertical-align: inherit;">192.168.1.111 </font><font style="vertical-align: inherit;">- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
passerelle </font><font style="vertical-align: inherit;">255.255.255.0 </font><font style="vertical-align: inherit;">- 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si Windows Server n'est pas activé, nous l'activerons. La clé peut être prise au même endroit où l'image a été téléchargée.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configurez le nom de l'ordinateur. </font><font style="vertical-align: inherit;">Dans mon cas, c'est ws-dc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez la machine virtuelle au domaine domen.ru, redémarrez et connectez-vous sous le compte d'administrateur de domaine DOMEN \ Administrator.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrôleur de distribution Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez Citrix Virtual Apps and Desktops 1811 sur ws-dc.domain.com. </font><font style="vertical-align: inherit;">Le lien de téléchargement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Virtual Apps and Desktops</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est disponible après la connexion au site Web </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/wy/--/ikwy--onnx7q_qlpdy8jjrn9_qi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Montez l'iso téléchargé et exécutez. </font><font style="vertical-align: inherit;">Choisissez Citrix Virtual Apps and Desktops 7. </font><font style="vertical-align: inherit;">Ensuite, cliquez sur "Commencer". </font><font style="vertical-align: inherit;">Un redémarrage peut être nécessaire. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/-l/x5/po-lx5nd34-fuw7gibvgajcg42w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans mon cas, il suffit de sélectionner les composants suivants pour l'installation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delivery Controller </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Studio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
License Server </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
StoreFront </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ne changez rien d'autre et cliquez sur «Installer». </font><font style="vertical-align: inherit;">Un redémarrage sera nécessaire plusieurs fois, après quoi l'installation se poursuivra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dès que l'installation est terminée, Citrix Studio, l'environnement de gestion de batterie de serveurs Citrix, démarre.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4q/_x/tp4q_xeo9tdviobu4zaannj-vfk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration du site Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choisissez la première section des trois - Configuration du site. </font><font style="vertical-align: inherit;">Lors de la définition, spécifiez le nom du site - domaine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section «Connexion», nous spécifions les données de connexion de l'hyperviseur au GPU: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adresse de connexion - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.168.1.100</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nom d'utilisateur - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mot de passe </font><font style="vertical-align: inherit;">root </font><font style="vertical-align: inherit;">- Votre mot de passe </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom de connexion - </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gestion du magasin </font><font style="vertical-align: inherit;">m60 </font><font style="vertical-align: inherit;">- Utilisez le stockage local sur l'hyperviseur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom de ces ressources - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sélectionnez les réseaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sélectionnez un type et un groupe de GPU - GRID M60-4Q.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimisation des catalogues de machines Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la configuration de la deuxième section - Catalogues de machines, sélectionnez OS à session unique (OS de bureau). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Image principale - nous sélectionnerons l'image de la machine virtuelle préparée et la version de Citrix Virtual Apps and Desktops - 1811. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous </font><font style="vertical-align: inherit;">sélectionnerons le </font><font style="vertical-align: inherit;">nombre de machines virtuelles dans le répertoire, par exemple 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous indiquerons le schéma par lequel les machines virtuelles seront nommées, dans mon cas, c'est le bureau ##. </font><font style="vertical-align: inherit;">Dans ce cas, 4 VM avec les noms desktop01-04 seront créées. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom du catalogue de machines - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Description du catalogue de machines - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir créé le catalogue de machines avec quatre machines virtuelles, elles se trouvent dans la liste verticale de XenCenter à gauche.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Groupe de mise à disposition Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième section commence par sélectionner le nombre de machines virtuelles auxquelles l'accès doit être accordé. </font><font style="vertical-align: inherit;">Je vais indiquer les quatre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la section "Ordinateurs de bureau", cliquez sur "Ajouter" pour ajouter le groupe de machines virtuelles auquel nous fournirons l'accès. </font><font style="vertical-align: inherit;">Nom d'affichage - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nom du groupe de mise à disposition - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir configuré les trois sections principales, la fenêtre principale de Citrix Studio ressemblera à ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/s3/up/kbs3up5h_utcj8db_caznbwgo_i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestionnaire de licences Citrix</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez le fichier de licence via votre compte personnel sur le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la liste verticale à gauche, sélectionnez Tous les outils de licence (hérités). Accédez à l'onglet "Activer et attribuer des licences". Sélectionnez les licences Citrix VDA et cliquez sur Continuer. Indiquez le nom de notre Delivery Controller - ws-dc.domain.ru et le nombre de licences - 4. Cliquez sur "Continuer". Téléchargez le fichier de licence généré pour ws-dc.domain.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-f/6o/tg/-f6otgoimp8n0qh_xdcrfvf5hew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la liste verticale de gauche de Citrix Studio, sélectionnez la section "Licence". Dans la liste verticale de droite, cliquez sur "License Management Console". Dans la fenêtre du navigateur qui s'ouvre, entrez les données pour l'autorisation de l'utilisateur de domaine DOMEN \ Administrateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Citrix Licensing Manager, accédez à l'onglet «Installer la licence». Pour ajouter un fichier de licence, sélectionnez "Utiliser le fichier de licence téléchargé".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/sy/rz/bosyrz3sj4ysmjs0vlwfhcp36ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'installation des composants Citrix implique l'utilisation de plusieurs machines virtuelles, un composant - une VM. </font><font style="vertical-align: inherit;">Dans mon cas, tous les services système Citrix fonctionnent sur la même machine virtuelle. </font><font style="vertical-align: inherit;">À cet égard, je note un bug, dont la correction a été particulièrement difficile pour moi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si après le redémarrage de ws-dc il y a des problèmes de nature différente, je vous recommande de vérifier d'abord les services en cours d'exécution. </font><font style="vertical-align: inherit;">Voici une liste des services Citrix qui devraient démarrer automatiquement après un redémarrage de la machine virtuelle:</font></font><br>
<br>
<pre><code class="plaintext hljs">SQL Server (SQLEXPRESS)<font></font>
Citrix Configuration Service<font></font>
Citrix Delegated Administration Service<font></font>
Citrix Analytics<font></font>
Citrix Broker Service<font></font>
Citrix Configuration Logging Service<font></font>
Citrix AD Identity Service<font></font>
Citrix Host Service<font></font>
Citrix App Library<font></font>
Citrix Machine Creation Service<font></font>
Citrix Monitor Service<font></font>
Citrix Storefront Service<font></font>
Citrix Trust Service<font></font>
Citrix Environment Test Service<font></font>
Citrix Orchestration Service<font></font>
FlexNet License Server -nvidia</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai rencontré un problème qui se produit lors de l'installation de divers services Citrix sur une seule machine virtuelle. </font><font style="vertical-align: inherit;">Après un redémarrage, tous les services ne démarrent pas. </font><font style="vertical-align: inherit;">Un par un pour lancer toute la chaîne, c'était la paresse. </font><font style="vertical-align: inherit;">La solution a été recherchée sur Google, je l'apporte ici - deux paramètres doivent être modifiés dans le registre:</font></font><br>
<br>
<pre><code class="bash hljs">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control<font></font>
Name : ServicesPipeTimeout<font></font>
Value :240000<font></font>
<font></font>
Name : WaitToKillServiceTimeout<font></font>
Value : 20000</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestionnaire de licence Nvidia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez NVIDIA License Manager pour Windows via votre compte personnel sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il vaut mieux passer par Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/hb/ih/auhbihphsv81hapm3cpgpxjbcmi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez-le sur ws-dc. Pour ce faire, vous devez d'abord installer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JAVA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ajouter la variable d'environnement JAVA_HOME. Après cela, vous pouvez exécuter setup.exe pour installer le gestionnaire de licences NVIDIA. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nv/bd/wu/nvbdwuyf4xtx-fsqqpa2qwzunke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Créons un serveur, générons et téléchargeons le fichier de licence dans votre compte personnel sur le site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Transférons le fichier de licence pour ws-dc. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/ui/zb/r-uizbl706_p1w35j27fk0lv2wu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide d'un navigateur, nous nous connectons à l'interface Web du gestionnaire de licences NVIDIA, disponible sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8080 / licserver et ajoutons un fichier de licence. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ut/oc/viutocj16sitn-q_diao-oehmfa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les sessions actives utilisant vGPU peuvent être consultées dans la section Clients sous licence.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accès à distance au catalogue de machines Citrix</font></font></h2><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment installer Citrix Receiver? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment se connecter à un bureau virtuel? </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur l'ordinateur de travail, ouvrez un navigateur, dans mon cas c'est Chrome, et allez à l'adresse de l'interface web de Citrix StoreWeb</font></font><br>
<br>
<pre><code class="bash hljs">http://192.168.1.111/Citrix/StoreWeb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si Citrix Recever n'est pas déjà installé, cliquez sur "Découvrir Receiver". Nous </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/iv/nh/riivnhuygym-oivw0iaq0hghr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lisons attentivement le contrat de licence, téléchargez et installez Citrix Receiver. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/9b/cd/r39bcddyu-e57s9tpk6gj-o19vg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'installation, revenez au navigateur et cliquez sur "Continuer". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/vw/dg/iavwdgrxnyukfifcb03b0gvbyf4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, une notification s'ouvre dans le navigateur Chrome, cliquez sur "Ouvrir l'application Citrix Receiver Launcher". , puis «Détecter à nouveau» ou «Déjà installé». </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7o/hs/bx/7ohsbxmdogzv7tvdwji5xwa1xam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la première connexion, nous utiliserons les données du test utilisateur test. </font><font style="vertical-align: inherit;">Remplacez le mot de passe temporaire par un mot de passe permanent. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/as/9k/l0/as9kl0vlibg4fmhts2rjgrsupvw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après autorisation, allez dans l'onglet «Applications» et sélectionnez le </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/fb/md/j9fbmdbevvo42-2su76ifsaisnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
répertoire </font><font style="vertical-align: inherit;">«M60» </font><font style="vertical-align: inherit;">Téléchargez le fichier proposé avec l'extension .ica. </font><font style="vertical-align: inherit;">Après avoir double-cliqué dessus, une fenêtre s'ouvre dans Desktop Veiwer avec le bureau Centos 7</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/70/3p/n2703pzygelapwl6ixj7n5wcgfm.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr497808/index.html">Faites-le vous-même en 3D. Partie 2: c'est tridimensionnel</a></li>
<li><a href="../fr497810/index.html">PVS Studio.VS. Analyse statistique de GCC 10. Mini-test indépendant</a></li>
<li><a href="../fr497812/index.html">Les scientifiques du MIT développent un appareil qui permettra de contrôler au moins partiellement leurs rêves</a></li>
<li><a href="../fr497814/index.html">Cinq étapes pour accepter l'inévitable, ou comment nous avons développé un programme de profilage automatisé</a></li>
<li><a href="../fr497816/index.html">Les chemins de fer russes m'envoient les billets de quelqu'un d'autre</a></li>
<li><a href="../fr497820/index.html">Régularisation statistique de problèmes inverses incorrects. Turchin (partie 1)</a></li>
<li><a href="../fr497822/index.html">Homme dans une bouteille</a></li>
<li><a href="../fr497826/index.html">Comment capturer rapidement le monde ou gérer un réseau d'ordinateurs Windows à l'aide d'OPSI</a></li>
<li><a href="../fr497828/index.html">2 en 1: chiffrement avec protection de sécurité</a></li>
<li><a href="../fr497830/index.html">Enregistrements OWASP Moscou 2020/1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>