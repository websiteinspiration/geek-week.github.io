<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äç‚öñÔ∏è üòé üì∏ Fer ou optimisation? Badoo, Avito et Mamba - √† propos des performances PHP üßïüèø üßùüèø üë©üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le probl√®me de performances PHP pour Badoo est l'un des plus importants. La qualit√© du backend PHP d√©pend directement de la quantit√© de ressources que...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fer ou optimisation? Badoo, Avito et Mamba - √† propos des performances PHP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/487234/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le probl√®me de performances PHP pour Badoo est l'un des plus importants. La qualit√© du backend PHP d√©pend directement de la quantit√© de ressources que nous d√©pensons pour le d√©veloppement et le fonctionnement, de la vitesse du service et de l'impression qu'il fait aux utilisateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, le sujet de la troisi√®me r√©union de la communaut√© des d√©veloppeurs PHP dans notre bureau, nous avons fait des performances de backend et invit√© des coll√®gues d'Avito et Mamba √† discuter. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t-/p7/se/t-p7sef1pbww8vboigkup6ditzu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lisez la transcription de la discussion, dans laquelle j'ai eu la chance d'√™tre mod√©rateur: comment l'infrastructure des trois soci√©t√©s est organis√©e, comment nous mesurons la productivit√© et sur quelles mesures nous nous concentrons, quels outils nous utilisons, comment nous faisons un choix entre le mat√©riel et l'optimisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le 15 f√©vrier, venez au </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prochain Meetup Badoo PHP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : discutez de Legacy.</font></font><br>
<a name="habracut"></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kWBm0C9A8oo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous n'avons d√©chiffr√© que la partie de la discussion qui nous a paru la plus int√©ressante. </font><font style="vertical-align: inherit;">La version compl√®te est disponible en vid√©o. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Experts:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, chef de l'unit√© de d√©veloppement chez Core Services Avito</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pmurzakov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, PHP Timlid √† Badoo </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mipxtx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Directeur informatique de Mamba</font></font></li>
</ul><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Racontez une histoire sur l'optimisation de votre pratique: grand succ√®s ou grand √©chec est quelque chose d'int√©ressant √† partager. </font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai une parabole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Environ une fois tous les six mois, nous examinons les mesures et recherchons ce qui ralentit, ne fonctionne pas bien, ce qui doit √™tre optimis√©. </font><font style="vertical-align: inherit;">Une fois que nous avons remarqu√© notre conteneur de d√©pendances symfony, qui est pass√© √† 52 000 lignes. </font><font style="vertical-align: inherit;">Nous avons d√©cid√© que lui, le sc√©l√©rat, √©tait √† bl√¢mer pour tout: 20 ms de frais g√©n√©raux pour chaque demande. </font><font style="vertical-align: inherit;">Nous l'avons vu. </font><font style="vertical-align: inherit;">Nous l'avons r√©duit. </font><font style="vertical-align: inherit;">Nous avons en quelque sorte essay√© de le s√©parer, mais rien n'a aid√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis il s'est av√©r√© que nous avons un anti-spam qui doit aller dans 20 bases de donn√©es afin de r√©pondre √† toutes les demandes n√©cessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les solutions qui viennent en premier ne sont pas toujours les bonnes. </font><font style="vertical-align: inherit;">Regardez mieux les traces, les journaux et les rep√®res de vos demandes, et ne cassez pas directement. </font><font style="vertical-align: inherit;">Voici une histoire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons un √©cosyst√®me assez vaste en PHP, nous faisons donc r√©guli√®rement de l'optimisation. </font><font style="vertical-align: inherit;">Nous grandissons, nous atteignons un certain niveau de CPU, nous comprenons que nous devons soit acheter du mat√©riel, soit optimiser. </font><font style="vertical-align: inherit;">Pesez les arguments pour et contre chaque option et d√©cidez. </font><font style="vertical-align: inherit;">Le plus souvent - en faveur de l'optimisation, car le fer a besoin de beaucoup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä l'un de ces points, nous avons identifi√© tout un groupe qui √©tait engag√© dans la recherche de diverses choses non optimales dans les scripts PHP et l'optimisation. </font><font style="vertical-align: inherit;">Cela s'est produit litt√©ralement ¬´goutte √† goutte¬ª: ici, ils ont trouv√© un pourcentage, l√†, ils ont trouv√© un pourcentage - plusieurs personnes ont trouv√© un pourcentage en un mois. </font><font style="vertical-align: inherit;">√Ä un moment donn√©, notre sishnik √©tait √† proximit√©</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einstein_man</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il a d√©cid√© de voir ce qu'il pouvait faire: il est all√© le soir, a lanc√© Perf, a trouv√© quelques probl√®mes dans les extensions PHP - et a tout acc√©l√©r√© de 13% en quelques soir√©es!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai deux histoires. L'un sur le fichier, l'autre sur le super d√©veloppeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä propos de l'√©chec. Nous avons de nombreux microservices, dont PHP. Tout le monde travaille chez Kubernetes. J'ai travaill√© sur l'un de ces microservices. Il y avait une utilisation importante du processeur: ils ont pass√© une semaine √† optimiser et √† trouver des probl√®mes. Il s'est av√©r√© que l'un des d√©veloppeurs a ajout√© Xdebug aux images de base pour calculer les tests de couverture de code dans son (autre) service, apr√®s quoi tous les microservices en production ont travaill√© avec Xdebug pendant un trimestre! Apr√®s un trimestre, nous avons d√©couvert cela, fix√© des images de base - et commenc√© √† attraper des cadeaux inattendus: j'ai relanc√© mon service, et cela a commenc√© √† fonctionner plus rapidement. √Ä chaque d√©ploiement, notre image de service est reconstruite, et maintenant sans Xdebug.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Histoire de succ√®s. Nous avons de nombreux microservices, et ils sont devenus de plus en plus nombreux. Dans cette situation, le nombre d'appels RPC devient un probl√®me. Par exemple, sur une carte d'annonce - et c'est l'une des pages les plus fr√©quentes dans Avito - environ 30 microservices sont impliqu√©s dans le rendu d'une page. De plus, tout cela n'a pas √©t√© fait de mani√®re tr√®s explicite: il semble que vous appeliez une sorte d'abstraction, et en dessous, cinq appels RPC vers d'autres services sont effectu√©s s√©quentiellement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au fil des ans, la carte d'annonce s'est consid√©rablement d√©grad√©e. </font><font style="vertical-align: inherit;">Un d√©veloppeur solide s'est battu pendant un trimestre, optimis√© et a lanc√© tous les appels RPC. </font><font style="vertical-align: inherit;">Lorsqu'il a pu le faire, il les a parall√©lis√©es via plusieurs requ√™tes Guzzle - et au lieu de 30 requ√™tes synchrones cons√©cutives, il a re√ßu les m√™mes 30 requ√™tes, mais parall√®les, ce qui a consid√©rablement acc√©l√©r√© le travail. </font><font style="vertical-align: inherit;">Apr√®s cette refactorisation, le temps de r√©ponse de la carte est √©gal au temps de r√©ponse maximum de l'un des services. </font><font style="vertical-align: inherit;">Mais il avait besoin d'un quart entier pour optimiser / r√©√©crire le code d'affichage de la carte d'annonce.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dites-nous, quelle est la taille de votre cluster PHP, comment est-il configur√© - au moins PHP-FPM, ou peut-√™tre un endroit o√π Apache a eu des probl√®mes?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons environ 15 000 RPS. </font><font style="vertical-align: inherit;">Un cluster de 80 serveurs FPM achet√© il y a plusieurs ann√©es. </font><font style="vertical-align: inherit;">Sur chaque cluster, FPM (jusqu'√† 50 enfants maximum) est lanc√© en statique. </font><font style="vertical-align: inherit;">Il a charg√© environ dix heures de pointe aux heures de grande √©coute. </font><font style="vertical-align: inherit;">Le temps de r√©ponse moyen est de 100 ms, et nous essayons de le maintenir (lorsqu'il d√©passe 100 ms, nous commen√ßons la recherche de pi√®ces de freinage). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons notre propre syst√®me de surveillance des performances. </font><font style="vertical-align: inherit;">Nous avons dispers√© un grand nombre de compteurs dans le code, environ 120 par demande. </font><font style="vertical-align: inherit;">Nous surveillons de nombreux √©v√©nements qui se produisent dans le code en PHP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est standard chez nous: nginx, PHP-FPM. Environ 600 serveurs avec FPM. Si nous parlons de PHP, alors, il y a probablement environ 300 serveurs suppl√©mentaires √† des fins diverses, comme les scripts, le back-office et autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les fonctionnalit√©s de configuration, il y en a deux. Premi√®rement, nous avons un proxy BMA - c'est un proxy pour mobile. Autrement dit, avant qu'une demande n'arrive dans nginx, elle parvient √† un proxy sp√©cial qui d√©tient une connexion persistante et envoie des demandes √† nginx. La deuxi√®me fonctionnalit√© - parfois, vous devez d√©sactiver l'opcache CLI (nous l'avons activ√© sur les machines de script). Une fois que nous ne l'avons pas √©teint et que nous avons perdu 30% du processeur. Apr√®s avoir r√©alis√© leur erreur, ils ont √©t√© surpris de voir combien vous pouvez √©conomiser avec un seul r√©glage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons des correctifs PHP, mais ils ne sont presque pas li√©s aux performances.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a un point avec le verrou APCu comp√©titif - quand vous avez besoin d'√©crire beaucoup sur la m√™me cl√©. </font><font style="vertical-align: inherit;">L'architecture interne d'APCu est con√ßue de mani√®re √† ce qu'il y ait un verrouillage global des touches et pendant l'enregistrement intensif, les freins commencent. </font><font style="vertical-align: inherit;">Par cons√©quent, nous avons une extension personnalis√©e qui r√©sout ce probl√®me. </font><font style="vertical-align: inherit;">Cela ne concerne que partiellement les performances, car il affecte le temps de r√©ponse, mais pas la consommation du processeur.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons environ 2 millions de demandes par minute (~ 33 kRPS). </font><font style="vertical-align: inherit;">Une application monolithique √©crite en PHP est √©crite depuis plus de 11 ans. </font><font style="vertical-align: inherit;">Il est dans une phase de croissance rapide. </font><font style="vertical-align: inherit;">Lorsque l'entreprise a d√©marr√©, il y avait 65 LXC sur 65 serveurs physiques. </font><font style="vertical-align: inherit;">Sur chaque conteneur avec l'application, PHP-FPM, nginx et un logiciel auxiliaire pour les m√©triques et la journalisation sont en cours d'ex√©cution. </font><font style="vertical-align: inherit;">Rien de sp√©cial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au fil des ans, nous n'avons jamais ajout√© de fer pour un monolithe. </font><font style="vertical-align: inherit;">Nous augmentons la fr√©quentation, le nombre d'annonces, le nombre de transactions des utilisateurs, et nous optimisons constamment, am√©liorons le code, optimisons les logiciels. </font><font style="vertical-align: inherit;">La consommation de CPU et de m√©moire a diminu√© ces derni√®res ann√©es: 65 conteneurs pour un monolithe nous suffisent d√©sormais.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment mesurez-vous les performances? </font><font style="vertical-align: inherit;">Quel outil mesurez-vous le temps de r√©ponse du client?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons un syst√®me de collecte de journaux. </font><font style="vertical-align: inherit;">Il enregistre deux indicateurs - le temps entre le d√©but de FPM et la fonction d'arr√™t et jusqu'√† la fin du script. </font><font style="vertical-align: inherit;">La deuxi√®me mesure est n√©cessaire pour voir ce qui se passe apr√®s la fonction d'arr√™t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous mesurons JS. </font><font style="vertical-align: inherit;">En fait, il s'agit d'une m√©trique m√©diocre; les canaux r√©seau sont tr√®s souvent viol√©s. </font><font style="vertical-align: inherit;">En cons√©quence, le chargement quelque part dans l'outback russe commence √† √©mousser. </font><font style="vertical-align: inherit;">Par cons√©quent, nous ressemblons √† ceci: "Oh, a saut√© - cela signifie que quelque part quelque chose est tomb√©." </font><font style="vertical-align: inherit;">De plus, la publicit√© tierce d√©forme consid√©rablement la m√©trique. </font><font style="vertical-align: inherit;">Et, plus important encore, les spammeurs viennent, et c'est g√©n√©ralement une sorte de hasard.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tr√®s activement </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Pinba</font></a><font style="vertical-align: inherit;"> de Badoo. </font><font style="vertical-align: inherit;">Je l'aime maintenant. </font><font style="vertical-align: inherit;">La plupart des m√©triques ont √©t√© collect√©es par lui, mais sont ensuite pass√©es au protocole StatsD. </font><font style="vertical-align: inherit;">Maintenant, nous prenons des mesures √† partir de diff√©rents points: de l'avant, des serveurs devant l'application, de nginx et de l'application PHP elle-m√™me. </font><font style="vertical-align: inherit;">Nous avons une √©quipe de performance d√©di√©e. </font><font style="vertical-align: inherit;">Elle a commenc√© par la performance du front, mais est ensuite pass√©e au support. </font><font style="vertical-align: inherit;">De face, il collecte non seulement JS, CSS et autres statiques, mais √©galement le temps de r√©ponse du serveur. </font><font style="vertical-align: inherit;">Tout d'abord, nous nous concentrons sur le temps de r√©ponse de l'application.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est similaire √† ce que les gars nous ont dit. </font><font style="vertical-align: inherit;">En utilisant le Pinba classique pour PHP, nous mesurons le temps d'ex√©cution d'un script PHP en termes de PHP. </font><font style="vertical-align: inherit;">Mais nous avons aussi, par exemple, Pinba pour nginx, qui mesure le temps de r√©ponse du point de vue de nginx. </font><font style="vertical-align: inherit;">Nous collectons √©galement des m√©triques sur le client. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que regardons-nous? </font><font style="vertical-align: inherit;">D'une part, le temps de r√©ponse. </font><font style="vertical-align: inherit;">Elle n'est pas li√©e √† la planification des ressources. </font><font style="vertical-align: inherit;">S'il est mauvais, il doit √™tre am√©lior√©, car c'est en fait la qualit√© du service. </font><font style="vertical-align: inherit;">Une autre chose est que vous devez planifier le fer √† repasser. </font><font style="vertical-align: inherit;">Nos ITOps et nos √©quipes de surveillance surveillent tout le mat√©riel. </font><font style="vertical-align: inherit;">Il y a quelques barres sur le r√©seau, sur le disque. </font><font style="vertical-align: inherit;">Il y a certaines valeurs apr√®s lesquelles l'alerte se produit - et nous faisons quelque chose. </font><font style="vertical-align: inherit;">Comme la pratique l'a montr√©, nous optimisons g√©n√©ralement pour le CPU: nous le rencontrons.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chez nous, l'application PHP se mesure et dans register_shutdown_function () jette des m√©triques. </font><font style="vertical-align: inherit;">Chaque LXC poss√®de un serveur StatsD, qui collecte ces m√©triques et les envoie via les collecteurs au cluster Graphite (y compris ClickHouse), o√π les donn√©es sont stock√©es. </font><font style="vertical-align: inherit;">Ceci est un auto-diagnostic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur chaque conteneur se trouve √©galement nginx, c'est-√†-dire nginx + PHP-FPM. </font><font style="vertical-align: inherit;">Avec nginx, nous collectons des m√©triques externes li√©es au temps d'ex√©cution d'une application PHP. </font><font style="vertical-align: inherit;">Ils sont √©galement confront√©s √† des serveurs distincts (nous les appelons avi-http) nginx, qui effectue un routage de base, qui collecte √©galement des mesures de niveau sup√©rieur, telles que le temps de r√©ponse, le nombre de 500 codes de r√©ponse, etc.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De quels outils disposez-vous pour une piste de performance? </font><font style="vertical-align: inherit;">Qu'utilisez-vous le plus souvent?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©crit notre propre outil. Lorsque Pinba est sorti - en 2012, il y a tr√®s longtemps - c'√©tait un module pour MySQL qui a re√ßu quelque chose comme √ßa sur UDP. Il √©tait difficile de retirer les graphiques; il n'√©tait pas tr√®s optimis√© pour les performances. Et nous n‚Äôavons rien trouv√© de mieux que d‚Äô√©crire notre propre truc appel√© Better Than Pinba. C'est juste un serveur de comptoir qui les accepte d'un client PHP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons dispers√© beaucoup de minuteurs dans le code: chaque fois que nous voulons mesurer quelque chose, nous d√©finissons le d√©but et la fin du minuteur dans le code. Le module lui-m√™me calculera le temps d'ex√©cution du compteur, agr√©gera les compteurs accumul√©s dans un paquet et les enverra au d√©mon. L'interface elle-m√™me extraira tout ce dont vous avez besoin et construira des graphiques connect√©s sur le compteur souhait√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un des probl√®mes de Pinba √©tait le manque de sa propre interface - il √©tait n√©cessaire de transf√©rer des donn√©es vers RRD (alors il y avait une telle obscurit√©). </font><font style="vertical-align: inherit;">Par cons√©quent, nous avons √©crit notre propre interface. </font><font style="vertical-align: inherit;">Chaque fois que nous voyons ce qui a saut√©, nous pouvons installer le script. </font><font style="vertical-align: inherit;">Dans le script, tous les compteurs agr√©g√©s nous sont envoy√©s, qui nous sont envoy√©s. </font><font style="vertical-align: inherit;">Nous pouvons voir o√π le compteur a augment√©, ou le temps de r√©ponse au compteur a augment√©, ou le nombre de compteurs a augment√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il peut √™tre vu lorsque les performances diminuent. </font><font style="vertical-align: inherit;">Nous commen√ßons √† creuser de cette fa√ßon. </font><font style="vertical-align: inherit;">Avant PHP 7, nous utilisions XHProf, puis il a cess√© de construire avec nous. </font><font style="vertical-align: inherit;">Par cons√©quent, nous sommes pass√©s √† Xdebug. </font><font style="vertical-align: inherit;">Xdebug nous poussons uniquement lorsque le probl√®me est visible.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est une croyance commune que XHProf ne va pas √™tre construit en PHP 7. </font><font style="vertical-align: inherit;">C'est vrai, mais seulement en partie. </font><font style="vertical-align: inherit;">Si vous prenez XHProf depuis l'assistant, ce ne sera vraiment pas le cas. </font><font style="vertical-align: inherit;">Mais si sur GitHub vous passez √† une branche appel√©e Experimental (ou quelque chose comme √ßa), alors tout fonctionne bien pour PHP 7, pr√™t pour la production. </font><font style="vertical-align: inherit;">V√©rifi√©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non, j'ai chang√©. </font><font style="vertical-align: inherit;">√áa n'a pas march√© pour moi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je veux ajouter quelque chose sur Pinba. </font><font style="vertical-align: inherit;">Vous √™tes devenus des proph√®tes dans une certaine mesure. </font><font style="vertical-align: inherit;">Nous aussi, √† un moment donn√©, nous avons perdu de la productivit√©. </font><font style="vertical-align: inherit;">Nous avons cr√©√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pinba2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui est tr√®s rapide. </font><font style="vertical-align: inherit;">Il peut √™tre utilis√© en remplacement de Pinba.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est modeste avec nous. </font><font style="vertical-align: inherit;">Nous venons de prendre la direction de la performance dans le travail: nous collectons des m√©triques, telles que le temps de r√©ponse. </font><font style="vertical-align: inherit;">Nous utilisons StatsD. </font><font style="vertical-align: inherit;">Nous n'utilisons pas encore de profileurs sur une base r√©guli√®re, mais je sais avec certitude que certaines √©quipes les utilisent dans leurs microservices √©crits en PHP. </font><font style="vertical-align: inherit;">√Ä mon avis, m√™me quelqu'un relaie New Relic. </font><font style="vertical-align: inherit;">Mais dans le cadre de la principale application monolithique, nous ne nous en approchons pour l'instant que.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'histoire du fer est surveill√©e √† Grafana, Zabbix. </font><font style="vertical-align: inherit;">Quant √† la partie PHP, nous avons Pinba, nous avons un tas de minuteries; </font><font style="vertical-align: inherit;">Nous construisons des graphiques pratiques sur eux. </font><font style="vertical-align: inherit;">Nous utilisons XHProf, en production nous le pilotons pour une partie des demandes. </font><font style="vertical-align: inherit;">Nous avons toujours de nouveaux profils XHProf disponibles. </font><font style="vertical-align: inherit;">Nous avons liveprof: c'est notre outil, vous pouvez le lire, y compris </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans mon article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tout se passe automatiquement, il suffit de regarder. </font><font style="vertical-align: inherit;">Nous utilisons phpspy. </font><font style="vertical-align: inherit;">√áa ne commence pas toujours chez nous: quand quelqu'un veut voir quelque chose, il monte dans la voiture, enl√®ve son profil. </font><font style="vertical-align: inherit;">En principe, comme c'est le cas avec Perf.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
XHProf a la m√™me histoire. </font><font style="vertical-align: inherit;">Nous l'avons utilis√© il y a longtemps: c'√©tait une initiative personnelle d'un couple de d√©veloppeurs et, en fait, n'a pas d√©coll√©. </font><font style="vertical-align: inherit;">Il a cess√© de collectionner. </font><font style="vertical-align: inherit;">Nous collectons un tas de m√©triques √† partir d'appels de routeurs, de contr√¥leurs, de divers mod√®les. </font><font style="vertical-align: inherit;">Environ 60 √† 70% du r√©seau interne du centre de donn√©es est occup√© par des paquets UDP avec des m√©triques. </font><font style="vertical-align: inherit;">Pour le moment, cela nous suffit. </font><font style="vertical-align: inherit;">Nous allons maintenant chercher de nouveaux endroits pour l'optimisation.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depuis que nous avons atteint le point de fer: quelqu'un est-il syst√©matiquement engag√© dans la planification des capacit√©s de votre entreprise? </font><font style="vertical-align: inherit;">Comment se construit ce processus?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une application monolithique fonctionne au moins 65 LXC pendant au moins cinq ans. </font><font style="vertical-align: inherit;">Nous optimisons le code, l'am√©liorons: il a suffisamment de ressources. </font><font style="vertical-align: inherit;">Notre principale planification de capacit√© va √† Kubernetes, o√π environ 400 microservices plus ou moins vivants sont √©crits en PHP / Go. </font><font style="vertical-align: inherit;">Nous coupons lentement des morceaux du monolithe, mais il continue de cro√Ætre. </font><font style="vertical-align: inherit;">Nous ne pouvons pas l'arr√™ter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, PHP est un langage sympa. </font><font style="vertical-align: inherit;">Il impl√©mente rapidement la logique m√©tier.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, les ITOps et les √©quipes de surveillance s'assurent qu'il y a suffisamment de ressources. </font><font style="vertical-align: inherit;">Si nous commen√ßons √† approcher la valeur seuil, les coll√®gues le remarquent. </font><font style="vertical-align: inherit;">Ils sont probablement principalement responsables de la planification des capacit√©s mondiales. </font><font style="vertical-align: inherit;">La partie PHP a la principale ressource CPU, nous la suivons donc nous-m√™mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nous mettons la barre: il ne faut pas "manger" plus de 60% du cluster. </font><font style="vertical-align: inherit;">60%, et non 95%, parce que nous avons l'hypertreading, qui en plus √©vacue plus du processeur que vous ne pouvez le faire sans lui. </font><font style="vertical-align: inherit;">Pour cela, nous payons par le fait qu'apr√®s 50% de notre consommation CPU nous pouvons cro√Ætre de fa√ßon impr√©visible, car les noyaux hyper-lisibles ne sont pas tout √† fait honn√™tes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous faisons un d√©ploiement et constatons que quelque chose a √©chou√© avec nous - une telle planification des capacit√©s. </font><font style="vertical-align: inherit;">A l'oeil! </font><font style="vertical-align: inherit;">Nous avons une certaine marge de productivit√© qui nous permet de le faire. </font><font style="vertical-align: inherit;">Nous essayons de nous y tenir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, nous effectuons une optimisation post factum. </font><font style="vertical-align: inherit;">Quand nous voyons que quelque chose est tomb√©, nous reculons si tout est compl√®tement mauvais. </font><font style="vertical-align: inherit;">Mais cela ne se produit pratiquement pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou nous voyons juste que "ici n'est pas optimal, maintenant nous allons tout r√©parer rapidement et tout fonctionnera comme il se doit". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On ne s'en soucie pas particuli√®rement: c'est tr√®s difficile, et l'√©chappement ne sera pas tr√®s gros.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous parlez de microservices. </font><font style="vertical-align: inherit;">Comment interagissent-ils? </font><font style="vertical-align: inherit;">Est-ce REST ou utilisez-vous des protocoles binaires?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kafka est utilis√© pour envoyer des √©v√©nements entre les services, JSON-RPC est utilis√© pour assurer l'interaction entre les services, mais pas complet, mais sa version simplifi√©e, dont nous ne pouvons pas nous d√©barrasser. </font><font style="vertical-align: inherit;">Il existe des impl√©mentations plus rapides: le m√™me protobuf, gRPC. </font><font style="vertical-align: inherit;">C'est dans nos plans, mais certainement pas une priorit√©. </font><font style="vertical-align: inherit;">Avec plus de 400 microservices, il est difficile de les porter tous vers le nouveau protocole. </font><font style="vertical-align: inherit;">Il y a des tonnes d'autres endroits √† optimiser. </font><font style="vertical-align: inherit;">Nous ne sommes d√©finitivement pas √† la hauteur maintenant.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que tels, nous n'avons pas de microservices. </font><font style="vertical-align: inherit;">Il y a des services, il y a aussi Kafka, son propre protocole en plus de Google protobuf. </font><font style="vertical-align: inherit;">Probablement, nous utiliserions gRPC, car il est cool, il prend en charge toutes les langues, la possibilit√© de lier tr√®s facilement diff√©rentes pi√®ces. </font><font style="vertical-align: inherit;">Mais quand nous en avions besoin, gRPC n'√©tait pas encore l√†. </font><font style="vertical-align: inherit;">Mais il y avait un protobuf, et nous l'avons pris. </font><font style="vertical-align: inherit;">En plus de cela, diff√©rentes choses ont √©t√© ajout√©es afin que ce ne soit pas seulement la s√©rialisation, mais un protocole complet.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous n'avons pas non plus de microservices. </font><font style="vertical-align: inherit;">Il existe des services principalement √©crits en C. Nous utilisons JSON-RPC parce que c'est pratique. </font><font style="vertical-align: inherit;">Vous venez d'ouvrir le socket lorsque vous d√©boguez votre code et avez rapidement √©crit ce que vous vouliez. </font><font style="vertical-align: inherit;">Quelque chose vous est revenu. </font><font style="vertical-align: inherit;">Protobuf est plus difficile car vous devez utiliser des outils suppl√©mentaires. </font><font style="vertical-align: inherit;">Il y a un petit frais g√©n√©raux, mais nous pensons que vous devez payer pour plus de commodit√©, et ce n'est pas un gros prix.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous avez d'√©normes bases de donn√©es. </font><font style="vertical-align: inherit;">Lorsque vous devez changer le circuit de l'un d'eux, comment proc√©dez-vous? </font><font style="vertical-align: inherit;">Une sorte de migrations? </font><font style="vertical-align: inherit;">Si ces migrations prennent plusieurs jours, comment cela affecte-t-il les performances?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons de grandes tables, monolithiques. </font><font style="vertical-align: inherit;">Il y a un √©clat. </font><font style="vertical-align: inherit;">Le fragment change assez rapidement, car il y a plusieurs modifications parall√®les √† la fois. </font><font style="vertical-align: inherit;">Une grande table avec des profils a chang√© environ trois heures. </font><font style="vertical-align: inherit;">Nous utilisons des outils Perkonovskie qui ne le font ni lire ni √©crire. </font><font style="vertical-align: inherit;">De plus, nous d√©ployons pour modifier afin que le code prenne en charge les deux √©tats. </font><font style="vertical-align: inherit;">Apr√®s alter, nous d√©ployons √©galement: le d√©ploiement est plus rapide que l'application de tout sch√©ma.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons le plus grand stockage (nous l'appelons "spots") - c'est une √©norme base de donn√©es fragment√©e. </font><font style="vertical-align: inherit;">Si nous prenons la table ¬´Utilisateur¬ª, alors elle a beaucoup d'√©clats. </font><font style="vertical-align: inherit;">Je ne vous dirai pas exactement combien de tables seront sur un serveur: l'id√©e est qu'il y en a beaucoup de petites. </font><font style="vertical-align: inherit;">Quand on change de circuit, en fait, on fait juste un alter. </font><font style="vertical-align: inherit;">Sur chaque petite table, √ßa arrive vite. </font><font style="vertical-align: inherit;">Il existe d'autres r√©f√©rentiels - il existe d√©j√† d'autres approches. </font><font style="vertical-align: inherit;">S'il existe une √©norme base, il existe des outils perconiens. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, nous utilisons diff√©rentes choses selon les besoins. </font><font style="vertical-align: inherit;">Le changement le plus fr√©quent est un changement dans cette √©norme base de tache fragment√©e, dans laquelle nous avons d√©j√† un processus construit. </font><font style="vertical-align: inherit;">Tout fonctionne tr√®s simplement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√™me application monolithique qui dessert la majeure partie du trafic est d√©ploy√©e cinq √† six fois par jour. </font><font style="vertical-align: inherit;">Presque toutes les deux heures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce qui est de travailler avec la base de donn√©es, il s'agit d'un probl√®me distinct. </font><font style="vertical-align: inherit;">Il y a des migrations, elles roulent automatiquement. </font><font style="vertical-align: inherit;">Ceci est une revue DBA. </font><font style="vertical-align: inherit;">Il existe une option pour ignorer la migration et effectuer un roulement manuel. </font><font style="vertical-align: inherit;">La migration sera automatiquement mise en sc√®ne lors du test du code. </font><font style="vertical-align: inherit;">Mais en production, s'il y a une sorte de migration douteuse qui utilise un tas de ressources, le DBA la d√©marrera manuellement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code doit √™tre tel qu'il fonctionne avec les anciennes et nouvelles structures de base de donn√©es. </font><font style="vertical-align: inherit;">Nous effectuons souvent plusieurs d√©placements pour d√©ployer des fonctionnalit√©s. </font><font style="vertical-align: inherit;">Pour deux ou trois d√©ploiements, il est possible d'obtenir l'√©tat souhait√©. </font><font style="vertical-align: inherit;">De m√™me, il existe d'√©normes bases de donn√©es, des bases de donn√©es fragment√©es. </font><font style="vertical-align: inherit;">Si nous comptons pour tous les microservices, il y a certainement 100 √† 150 d√©ploiements par jour.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voudrais savoir quel est le temps de r√©ponse standard pour vous que vous suivez? </font><font style="vertical-align: inherit;">Quand comprenez-vous ce dont vous avez besoin pour optimiser davantage, ou quel est le temps de terminer? </font><font style="vertical-align: inherit;">Y a-t-il une valeur ¬´moyenne hospitali√®re¬ª?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non. </font><font style="vertical-align: inherit;">D√©pend du point final. </font><font style="vertical-align: inherit;">Nous regardons tout s√©par√©ment. </font><font style="vertical-align: inherit;">Essayer de comprendre √† quel point c'est critique. </font><font style="vertical-align: inherit;">Certains points d'extr√©mit√© sont g√©n√©ralement demand√©s en arri√®re-plan. </font><font style="vertical-align: inherit;">Cela n'affecte en rien l'utilisateur, m√™me si le temps de r√©ponse est de 20 s. </font><font style="vertical-align: inherit;">Cela se passera en arri√®re-plan, il n'y a pas de diff√©rence. </font><font style="vertical-align: inherit;">L'essentiel est que certaines choses importantes soient faites rapidement. </font><font style="vertical-align: inherit;">Peut-√™tre que 200 ms sont encore corrects, mais une petite augmentation compte d√©j√†.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons du rendu HTML aux requ√™tes API. </font><font style="vertical-align: inherit;">Ici, en fait, l'API r√©pond beaucoup plus rapidement que la grande r√©ponse HTML lourde. </font><font style="vertical-align: inherit;">Par cons√©quent, il est difficile de distinguer, par exemple, une valeur de 100 ms. </font><font style="vertical-align: inherit;">Nous nous sommes concentr√©s sur 200 ms. </font><font style="vertical-align: inherit;">Puis est arriv√© PHP 7 - et nous avons commenc√© √† nous concentrer sur 100 ms. </font><font style="vertical-align: inherit;">Il s'agit de la ¬´moyenne de l'h√¥pital¬ª. </font><font style="vertical-align: inherit;">Il s'agit d'une m√©trique tr√®s vague, ce qui sugg√®re qu'il est au moins temps d'y regarder. </font><font style="vertical-align: inherit;">Et donc nous nous concentrons plut√¥t sur le d√©ploiement et avons saut√© le temps de r√©ponse apr√®s.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons fait un croquis de l'une des √©quipes de performance. Des coll√®gues ont mesur√© combien une entreprise gagne davantage en acc√©l√©rant le chargement des pages dans divers sc√©narios. Nous avons calcul√© combien plus d'acheteurs, de transactions, d'appels, de transitions, etc. se produisent. D'apr√®s ces donn√©es, on peut comprendre qu'√† un moment donn√©, l'acc√©l√©ration cesse de faire sens. Par exemple, si le temps de r√©ponse d'une des pages de 90 ms √©tait acc√©l√©r√© √† 70 ms, cela donnait + 2% d'acheteurs. Et si vous acc√©l√©rez de 70 √† 60 ms, il y a d√©j√† plus 0,1% d'acheteurs, ce qui est g√©n√©ralement inclus dans l'erreur. Tout comme avec les gars, tout d√©pend beaucoup de la page avec laquelle nous travaillons. En g√©n√©ral, Avito 75e centile - environ 75 ms. √Ä mon avis, c'est lent. Nous recherchons maintenant des endroits √† optimiser. Avant la transition vers les microservices, tout s'est pass√© beaucoup plus rapidement pour nous, et nous essayons d'optimiser les performances.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5j/tw/ig/5jtwigxel1bcp3pbmmvhdxdslhu.jpeg"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et l'√©ternelle question: le fer ou l'optimisation? </font><font style="vertical-align: inherit;">Comment comprendre s'il vaut la peine d'acheter du mat√©riel ou vaut-il mieux investir dans l'optimisation? </font><font style="vertical-align: inherit;">O√π est la fronti√®re?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon avis: un vrai programmeur c'est l'optimisation. </font><font style="vertical-align: inherit;">Il me semble que dans les grandes entreprises comme Badoo, la mienne, Yandex, il existe de nombreux d√©veloppeurs de diff√©rents niveaux. </font><font style="vertical-align: inherit;">Il y a √† la fois des d√©veloppeurs / stagiaires juniors et des d√©veloppeurs de premier plan. </font><font style="vertical-align: inherit;">Il me semble que le nombre de places pour l'optimisation / r√©vision y est toujours ajout√©. </font><font style="vertical-align: inherit;">Le fer est la derni√®re √©tape. </font><font style="vertical-align: inherit;">Pour un monolithe sur 65 LXC, nous n'avons pas ajout√© de fer depuis tr√®s longtemps. </font><font style="vertical-align: inherit;">Utilisation du processeur - 20%. </font><font style="vertical-align: inherit;">Nous envisageons d√©j√† de les transf√©rer dans le cluster Kubernetes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'aime vraiment la position de Semyon. Mais j'ai un point de vue compl√®tement oppos√©. Tout d'abord, je regardais le fer. Est-il possible de faire tomber du fer et sera-t-il moins cher? Si c'est le cas, il est plus facile de r√©soudre le probl√®me avec le fer. Le d√©veloppeur peut faire autre chose, utile pour le moment. Le temps du d√©veloppeur co√ªte de l'argent. Le fer co√ªte aussi de l'argent, vous devez donc comparer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lequel de ceux-ci est le plus important n'est pas clair. Si les deux co√ªtent le m√™me prix, le mat√©riel gagne, car le d√©veloppeur sera en mesure de faire quelque chose √† ce stade. Plus pr√©cis√©ment, en termes de backend PHP, nous ne pouvons pas le faire. L'optimisation nous co√ªte beaucoup moins cher que l'achat de fer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur le point de s'arr√™ter. </font><font style="vertical-align: inherit;">En termes de planification, nous avons une sorte de bar. </font><font style="vertical-align: inherit;">Si nous r√©duisons la consommation du processeur en dessous, nous nous arr√™tons. </font><font style="vertical-align: inherit;">D'un autre c√¥t√©, il y a aussi la qualit√© de service. </font><font style="vertical-align: inherit;">Si nous voyons que le temps de r√©ponse ne nous convient pas quelque part, alors nous devons optimiser.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il me semble que tout d√©pend de la taille de l'√©quipe et du projet. </font><font style="vertical-align: inherit;">Plus le projet est petit, plus il est facile d'acheter du mat√©riel, car le salaire du d√©veloppeur est constant et le code qui fonctionne, les utilisateurs qui travaillent avec lui, sont tr√®s diff√©rents. </font><font style="vertical-align: inherit;">S'il y a peu d'utilisateurs, il est plus facile d'acheter du mat√©riel et de confier au d√©veloppeur le travail de d√©veloppement du projet. </font><font style="vertical-align: inherit;">S'il y a beaucoup d'utilisateurs, un d√©veloppeur peut compenser la majeure partie du co√ªt des serveurs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d√©pend vraiment de l'√©chelle. </font><font style="vertical-align: inherit;">Si vous avez un millier de serveurs et que l'optimisation conduit au fait que vous n'avez pas besoin d'un autre millier de serveurs, il est clairement pr√©f√©rable d'optimiser. </font><font style="vertical-align: inherit;">Si vous avez un serveur, vous pouvez acheter en toute s√©curit√© deux ou trois serveurs suppl√©mentaires et obtenir un score d'optimisation. </font><font style="vertical-align: inherit;">Si la commande est petite, d√©marrez les serveurs achet√©s. </font><font style="vertical-align: inherit;">Si l'√©quipe est nombreuse et que vous avez deux ou trois centres de donn√©es, acheter six centres de donn√©es n'est d√©j√† pas si bon march√©, ni si rapide.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puisque nous avons un mitap PHP, cette phrase devrait sonner: pourquoi avons-nous besoin de PHP, car nous avons de tels probl√®mes tout le temps? </font><font style="vertical-align: inherit;">R√©√©crivons Go, C, C #, Rust, Node.js! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensez-vous que l'approche de r√©√©criture est g√©n√©ralement justifi√©e? </font><font style="vertical-align: inherit;">Y a-t-il des probl√®mes pour la solution desquels cela vaut la peine de le faire et d'investir en ce moment?</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, PHP est un tr√®s bon langage. Cela vous permet vraiment de r√©soudre des probl√®mes commerciaux. Il est assez rapide. Tous les probl√®mes de performances sont des probl√®mes d'erreurs, de bogues, de code h√©rit√© (du code sous-coup√©, des choses non optimales qui auraient tourn√© dans une autre langue de la m√™me mani√®re). En les portant brut sur Golang, Java, Python, vous obtenez les m√™mes performances. Tout le probl√®me est qu'il y a beaucoup d'h√©ritage.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä mon avis, l'introduction d'une nouvelle langue est logique afin d'√©largir la pile et les possibilit√©s d'emploi. Il est maintenant assez difficile de trouver de bons d√©veloppeurs PHP. Si nous introduisons Golang dans le techradar, nous pouvons engager des gaufres. Il y a peu de shniks PHP et peu de gophers sur le march√©, et ensemble il y en a d√©j√† beaucoup. Par exemple, nous avons eu une exp√©rience. Nous avons pris des d√©veloppeurs C # qui sont pr√™ts √† apprendre de nouveaux langages - nous avons simplement √©largi la pile d'embauche. Si nous disons aux gens que nous allons leur apprendre √† √©crire en PHP, ils disent que c'est mieux de ne pas le faire. Et si nous leur proposons d'apprendre √† √©crire en PHP, Go et promettons toujours la possibilit√© d'√©crire en Python, alors les gens sont plus dispos√©s √† r√©pondre. Pour moi, c'est une extension des opportunit√©s d'emploi. Dans d'autres langages, il y a des choses qui manquent vraiment en PHP. Mais en g√©n√©ral, PHP est super suffisant pour r√©soudre des probl√®mes commerciaux et mettre en ≈ìuvre de grands projets.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis probablement tout √† fait d'accord avec Semyon. </font><font style="vertical-align: inherit;">La r√©√©criture n'a tout simplement pas de sens. </font><font style="vertical-align: inherit;">PHP est un langage assez productif. </font><font style="vertical-align: inherit;">Si vous le comparez avec d'autres langages script√©s non compil√©s, il sera probablement presque le plus rapide. </font><font style="vertical-align: inherit;">R√©√©crire dans certaines langues comme Go et d'autres? </font><font style="vertical-align: inherit;">Ce sont d'autres langues, elles ont d'autres probl√®mes. </font><font style="vertical-align: inherit;">C‚Äôest encore plus difficile de les √©crire: pas si vite et il y a beaucoup de nuances.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√©anmoins, il y a des choses qui sont difficiles ou incommodes √† √©crire en PHP. </font><font style="vertical-align: inherit;">Certaines choses multi-processus et multi-threads sont mieux √©crites dans une autre langue. </font><font style="vertical-align: inherit;">Un exemple de t√¢che o√π la non-utilisation de PHP est justifi√©e est, en principe, tout stockage. </font><font style="vertical-align: inherit;">S'il s'agit d'un service qui stocke beaucoup en m√©moire, alors PHP n'est probablement pas le meilleur langage, car il a une surcharge de m√©moire tr√®s importante en raison de la frappe dynamique. </font><font style="vertical-align: inherit;">Il s'av√®re que vous enregistrez un entier de 4 octets et que 50 octets sont consomm√©s. </font><font style="vertical-align: inherit;">Bien s√ªr, j'exag√®re, mais cette surcharge est toujours tr√®s importante. </font><font style="vertical-align: inherit;">Si vous avez une sorte de stockage, il est pr√©f√©rable de l'√©crire dans un autre langage compil√© avec une saisie statique. </font><font style="vertical-align: inherit;">Tout comme certaines choses qui n√©cessitent une ex√©cution multi-thread.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi PHP n'est-il pas consid√©r√© comme tr√®s rapide? Parce que c'est dynamique. La traduction Go est une solution au probl√®me de la conversion du code de la frappe dynamique en statique. Pour cette raison, tout se passe plus rapidement. Sp√©cifiquement pour Go, dans mon plan, il y a des t√¢ches d'un flux de donn√©es sp√©cifique. Par exemple, s'il existe une sorte de flux de donn√©es qui doit √™tre converti dans des formats plus pratiques, c'est l'id√©al. √âlev√© par un d√©mon, il re√ßoit un flux de donn√©es en entr√©e, il en √©met un autre. Peu de m√©moire mange. PHP consomme beaucoup de m√©moire dans ce cas: vous devez vous assurer soigneusement qu'il est nettoy√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transfer to Go est un transfert vers des microservices, car vous n'aurez pas supprim√© tout le code. </font><font style="vertical-align: inherit;">Vous ne le prendrez pas et ne le r√©√©crirez pas dans son int√©gralit√©. </font><font style="vertical-align: inherit;">La traduction vers des microservices est une t√¢che plus profonde que la traduction d'une langue √† une autre. </font><font style="vertical-align: inherit;">Il faut d'abord le r√©soudre, puis r√©fl√©chir √† la langue √† √©crire. </font><font style="vertical-align: inherit;">La partie la plus difficile est d'apprendre √† microservices.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semyon Kataev, Avito</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'est pas n√©cessaire d'utiliser Go dans les microservices. De nombreux services sont √©crits en PHP et ont un temps de r√©ponse acceptable. L'√©quipe qui les accompagne a d√©cid√© par eux-m√™mes qu'ils avaient besoin d'√©crire tr√®s rapidement la logique m√©tier et d'introduire des fonctionnalit√©s. Ils font en fait parfois plus vite que les gaufres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons tendance √† embaucher des gaufres, traduisez en Go. Mais nous avons encore la plupart du code √©crit en PHP, et il en sera ainsi pendant au moins quelques ann√©es de plus. Il n'y a pas de vraie course, nous n'avons pas d√©cid√© que Go est meilleur ou pire. Six versions sont d√©ploy√©es quotidiennement dans le monolithe. Notre chat ¬´Avito Deploy¬ª a une liste de t√¢ches qui sont d√©ploy√©es. Au moins 20 t√¢ches sont d√©ploy√©es par jour dans chaque version: au moins cinq ou six versions par jour, soit environ 80 t√¢ches que les gens ont effectu√©es sur ces t√¢ches. Tout cela se fait en PHP.</font></font><br>
<br>
<blockquote>      ?       -,    ?</blockquote><br>
<h3> , </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tr√®s difficile. Il y a un moment psychologique: j'ai lanc√© une nouvelle fonctionnalit√© - vous avez termin√©. Lancement d'une nouvelle fonctionnalit√© gigantesque - vous √™tes super jeune! Lorsqu'un gestionnaire ou d√©veloppeur dit qu'il a supprim√© une fonctionnalit√© (d√©class√©e), il ne re√ßoit pas une telle reconnaissance. Son travail n'est pas visible. Par exemple, une √©quipe peut recevoir un bonus pour la mise en ≈ìuvre r√©ussie de nouvelles fonctionnalit√©s, mais je n'ai vu aucun prix pour des fonctionnalit√©s mortes ou exp√©rimentales. Et le r√©sultat de cela peut √™tre vraiment colossal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tas de fonctionnalit√©s h√©rit√©es que personne n'utilise d√©j√† ralentit vraiment le d√©veloppement. Il y a des centaines de cas o√π une nouvelle personne entre dans une entreprise et refactorise un code mort qui n'est jamais appel√© parce qu'il ne sait pas qu'il s'agit d'un code mort.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons en quelque sorte de n√©gocier avec les gestionnaires, de d√©couvrir par golog de quel type de fonctionnalit√© il s'agissait, avec les analystes, nous consid√©rons combien d'argent cela rapporte, qui en a besoin, et seulement apr√®s cela, nous essayons de le r√©duire. </font><font style="vertical-align: inherit;">C'est un processus compliqu√©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Buylov, Mamba </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous coupons le code mort quand nous y arrivons. </font><font style="vertical-align: inherit;">Et il est loin d'√™tre toujours possible de le couper rapidement. </font><font style="vertical-align: inherit;">D'abord, vous √©crivez un code, puis un autre, au-dessus d'un troisi√®me, puis en dessous il s'av√®re que cette fonctionnalit√© n'est pas n√©cessaire. </font><font style="vertical-align: inherit;">Elle tire un nombre sauvage de d√©pendances, qui doivent √©galement √™tre corrig√©es. </font><font style="vertical-align: inherit;">Ce n'est pas toujours possible et les gestionnaires doivent le signaler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le manager d√©finit la t√¢che, vous l'√©valuez. </font><font style="vertical-align: inherit;">Vous dites: "Vous savez, mec, je vais le faire pendant six mois. </font><font style="vertical-align: inherit;">√ätes-vous pr√™t √† tol√©rer six mois? ¬ª </font><font style="vertical-align: inherit;">Il dit: ¬´Non, r√©fl√©chissons √† ce qui doit √™tre coup√©, √† ce qui peut √™tre laiss√©. </font><font style="vertical-align: inherit;">Ce qui est fondamentalement n√©cessaire et ce qui est n√©cessaire pour jouer. ¬ª </font><font style="vertical-align: inherit;">Voil√† comment √ßa se passe.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Murzakov, Badoo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un d√©veloppeur re√ßoit une fonctionnalit√©, il √©value sa difficult√© en termes de d√©veloppement, sa difficult√© en termes de performances. S'il voit que l'un ou l'autre, il clarifie avec le chef de produit si cela est vraiment n√©cessaire, si nous pouvons retirer quelque chose quelque part. Parfois, il arrive que les changements ne soient pas critiques, et les gestionnaires font rapidement des concessions lorsqu'ils d√©couvrent que cette chose est compliqu√©e ou mange des ressources. Cela se produit simplement: vous dites "Supprimons-le" - et c'est tout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il arrive qu'une fonctionnalit√© quitte, et apr√®s cela, nous remarquons qu'elle ne fonctionnera pas aussi bien que nous le souhaiterions. Et puis, encore une fois, vous pouvez parler avec le gestionnaire. Souvent, tout se termine avec succ√®s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas de processus int√©gr√© pour supprimer des fonctionnalit√©s. Cela se fait de fa√ßon sporadique. Nous voyons qu'il y a une fonctionnalit√©, nous arrivons et proposons de la d√©sactiver. Nous l'√©teignons, regardons ce qu'il donne et le coupons. Une autre chose est le code mort. Nous avons une extension sp√©ciale, m√™me une infrastructure enti√®re, pour la d√©tection de code mort. Nous voyons ce code mort. Nous essayons de le couper lentement. Une autre question est de savoir si elle est vraiment morte et que la requ√™te n'y entre jamais, alors cela n'affecte en rien les performances. Il affecte la prise en charge. Les gens le lisent constamment, bien qu'ils ne le lisent peut-√™tre pas. Il n'y a pas de lien particulier avec les performances.</font></font><br>
<br>
<blockquote><i>15      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Badoo PHP Meetup</a>. ,      : SuperJob, ManyChat, , Badoo  FunCorp    . <br>
<br>
,   ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">YouTube-</a>. ,       - .<br>
<br>
   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>,     .</i><br>
</blockquote></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr487224/index.html">Combien de temps une construction √† long terme, destin√©e √† devenir un chef-d'≈ìuvre</a></li>
<li><a href="../fr487226/index.html">Cr√©ez votre badge: Shitty Add-On ne d√©range pas OFFZONE</a></li>
<li><a href="../fr487228/index.html">Mitap Facebook et AvitoTech</a></li>
<li><a href="../fr487230/index.html">USA Life Notes</a></li>
<li><a href="../fr487232/index.html">L'impression immunitaire dans l'enfance: l'origine de la protection antivirus</a></li>
<li><a href="../fr487238/index.html">Comment concevoir un √©quipement de protection de r√©seau √©lectrique</a></li>
<li><a href="../fr487242/index.html">R√©sum√© des √©v√©nements informatiques de f√©vrier</a></li>
<li><a href="../fr487246/index.html">L'autorit√© de certification Tensor peut compromettre les cl√©s priv√©es des clients</a></li>
<li><a href="../fr487248/index.html">Un peu plus sur les tests incorrects</a></li>
<li><a href="../fr487250/index.html">M√©lange Alpha retard√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>