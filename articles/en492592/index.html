<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø üë£ üçπ Lazy loading using Intersection Observer API üÜí üö© üêó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, friends! 
 
 In this article, we will introduce the Intersection Observer API, a powerful new tool for lazily loading images and other eleme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Lazy loading using Intersection Observer API</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492592/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good day, friends! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we will introduce the Intersection Observer API, a powerful new tool for lazily loading images and other elements on a page, supported by all modern browsers. </font><font style="vertical-align: inherit;">We can use this tool to control the visibility of elements by defining preliminary or delayed loading of our DOM content.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the web evolves, browsers support more and more new features and APIs, but something still hurts developers - DOM rendering. When we start developing a new application, create components, think over the HTML structure, style elements with CSS, we also think about the rendering process, how our page will look in general, and some other important things that require careful handling and affect application rendering. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This, in turn, affects how we create our elements, how our CSS will be organized, which libraries and frameworks will be used in the project, etc. This is why rendering is so important to developers.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the reasons for the popularity of the React library in the developer community is the fact that it uses a virtual DOM. In essence, this is a virtual representation of the real DOM, which you can control as you wish. After all the updates, the virtual DOM decides what changes need to be made to the original DOM, and makes these changes in a "seamless" way; there is no need to refresh the whole page when changing one element. This is one of the most significant advantages of React over other libraries and frameworks. DOM rendering is a costly (in terms of performance) task that React does just fine without any problems.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some libraries and APIs allow us to improve the rendering of elements of our applications. </font><font style="vertical-align: inherit;">We are going to get acquainted with one of them - the Intersection Observer API. </font><font style="vertical-align: inherit;">But first, let's figure out what ‚Äúlazy‚Äù image loading is.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How does lazy loading images work?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lazy loading is one of the techniques for rendering page content. The concept of "lazy" loading is that instead of fully loading the page, we load only the necessary parts and postpone (delay) the loading of the remaining parts until they are needed by the user. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An example of a "lazy" download, which you probably heard about or that you have encountered, is the endless scrolling of the page. This works something like this: the user visits the page, the initial content is loaded, and only after the user scrolls the page down to the very end, the next portion of the content is loaded. In this case, there is no need to download all the content at once, which greatly facilitates the application.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If a ‚Äúlazy‚Äù download serves to download only ‚Äúuser-generated‚Äù content, what is the opposite technique called? Some have heard of lazy loading before, but have not heard the opposite. The opposite of ‚Äúlazy‚Äù loading is ‚Äúenergetic‚Äù loading (other options are impatient, fast-moving) - when all the content is immediately rendered. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do you know that there are HTML attributes for lazy loading images? To use them, just add loading = ‚Äúlazy‚Äù to the ‚Äúimg‚Äù or ‚Äúiframe‚Äù element.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/6v/hy/wo6vhy3y4zhzk3kk1edxmtsgmvu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using this technique, we get a lot of advantages: loading only the necessary resources reduces memory consumption and, ultimately, page load time. </font><font style="vertical-align: inherit;">It also prevents the rendering of "unclaimed" code, which optimizes the application to work in low network bandwidth conditions. </font><font style="vertical-align: inherit;">However, there are some drawbacks: this can affect the ranking of the page by search engines. </font><font style="vertical-align: inherit;">In addition, it takes some time to choose the right library or API to work with.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intersection Observer API</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScript is developing so fast that we get a new API almost every year. The main goal of the new APIs is to help create awesome applications and pages. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intersection Observer is an API that allows you to monitor the visibility and position of DOM elements. The thing is that it works asynchronously, allowing you to smoothly (imperceptibly) change the visibility of elements, determining the preliminary or delayed loading of the content of our DOM. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h7/yj/qj/h7yjqj1e_xj4luztht-s08hle1e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A few years ago, we did not have an API or other tool for positioning and tracking an element. We had to write crazy and huge functions, create expensive (in terms of performance) methods that created more problems. Using the Intersection Observer API, we can do cool things like:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endless page scrolling - create endless scrolling of tables, lists, grid containers, etc. </font><font style="vertical-align: inherit;">It has never been so easy.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Images - why upload all images at once, when you can use the "lazy" download and display only the content that the user needs at the moment? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoring elements - you can monitor the elements on the page. </font><font style="vertical-align: inherit;">For example, you may receive messages about the closure of advertisements.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's where it all starts:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> myFirstObserver = <span class="hljs-keyword">new</span> IntersectionObserver(callback, options)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We initialize the IntersectionObserver constructor and pass two parameters to it. </font><font style="vertical-align: inherit;">The first parameter is a callback function, which is called in response to the intersection of our element with the viewport (i.e., when the element goes beyond the bounds of the viewport) or with another element. </font><font style="vertical-align: inherit;">The options parameter is an object that controls the conditions for launching the callback function. </font><font style="vertical-align: inherit;">This object has the following fields:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root - the parent element that serves as the viewport for the target element (for the element we are observing)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootMargin - the outer margin around the root element (the values ‚Äã‚Äãof this field are similar to the margin values ‚Äã‚Äãin CSS). </font><font style="vertical-align: inherit;">These values ‚Äã‚Äãcan change for each side of the root before committing the intersection.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">threshold - a number or an array of numbers that determines the percentage of intersection of the target element with the root element, at which the callback function is launched </font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/sp/up/tk/spuptkzkbpv0m30sblumsls7cgy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's take a look at using the Intersection Observer API:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> options = {
    <span class="hljs-attr">root</span>: <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.scroll-list'</span>),
    <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'5px'</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.5</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">let</span> myFirstObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function"><span class="hljs-params">elements</span> =&gt;</span> { elements.forEach(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'element'</span>, element)) }, options)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to start ‚Äúmonitoring‚Äù an element, you need to determine the target and call observer using the ‚Äúobserve‚Äù method, passing the target as a parameter:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> myDivTarget = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.header'</span>)<font></font>
<font></font>
observer.observe(myDivTarget)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should be remembered that all elements observed by the observer are rectangles. </font><font style="vertical-align: inherit;">Irregularly shaped elements fit into the smallest rectangle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What about browser support? </font><font style="vertical-align: inherit;">Intersection Observer API is supported by all modern browsers such as Chrome, Edge, Firefox and Opera. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pp/0g/vc/pp0gvc64xhmxpi8ehtktge53zic.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you intend to work with a lot of data, for example, with a table containing a lot of information, the Intersection Observer API will be extremely useful for you. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the advantages of this API is that to solve such problems you no longer need to use any library.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We studied the Intersection Observer API and its use for lazy loading, observing the position of DOM elements, etc. </font><font style="vertical-align: inherit;">Browsers support more and more APIs that reduce page rendering time, primarily for users with a slow connection, reducing the size of the project and displaying only relevant content. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From a translator: the article seemed to me insufficiently informative, so here are links to additional literature:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Specification</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article about Intersection Observer API in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MDN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Russian)</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSS Tricks Sample</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Article </font><font style="vertical-align: inherit;">(English)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article with examples on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envato</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (English)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">endless scroll example</font></a></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">couple more examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on GitHub</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492572/index.html">The current state of the Java world: trends and facts for one of the most popular programming languages</a></li>
<li><a href="../en492574/index.html">Reflections on Takeoff Probability: Apple AirPods with Momentum True Wireless 2</a></li>
<li><a href="../en492580/index.html">What do coronavirus and chess have in common?</a></li>
<li><a href="../en492582/index.html">Cisco Offers Secure Remote Access</a></li>
<li><a href="../en492590/index.html">How speech synthesis appeared on PC</a></li>
<li><a href="../en492594/index.html">Localization of indie games: is the game worth the candle?</a></li>
<li><a href="../en492596/index.html">Space as a database</a></li>
<li><a href="../en492600/index.html">Semi-Scientific Guide to Hosting a WiFi Router</a></li>
<li><a href="../en492604/index.html">Working with View asynchronously using coroutine</a></li>
<li><a href="../en492606/index.html">Toolkit issues in large projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>