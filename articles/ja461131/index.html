<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🚒 📍 🧒🏽 ROSカートトラック。パート2.ソフトウェア 🙎🏽 💆🏿 🔨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="シリーズの投稿：
 8. ROS制御電話、GPSノードから制御します
 。7.ロボットのローカライズ：マッピング、AMCL、ルームマップ上の基準点
 6.ホイールエンコーダー、ルームマップ、ライダーによる
 オドメトリ5. rvizとガゼボで作業します：xacro、新しいセンサー。 
 4. rvi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ROSカートトラック。パート2.ソフトウェア</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461131/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリーズの投稿：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. ROS制御電話、GPSノードから制御します</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。7.ロボットのローカライズ：マッピング、AMCL、ルームマップ上の基準点</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.ホイールエンコーダー、ルームマップ、ライダーによる</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オドメトリ5. rvizとガゼボで作業します：xacro、新しいセンサー。</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. rvizおよびgazeboエディターを使用してロボットシミュレーションを作成します。</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.加速、カメラの変更、歩行の修正</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.ソフトウェア</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.アイロン</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">笑顔に移る</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投稿</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からスキームに沿って「ハンバーガー」を集めたら</font><font style="vertical-align: inherit;">、番組内容に移ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既に完了しているプロジェクトを募集しているので、そこに示されている指示を出すのは当然です。</font><font style="vertical-align: inherit;">彼らは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが非常に便利で、同じ場所でRaspbian Stretch + ROS + OpenCVから既製のイメージをダウンロードして、ラズベリーのsdカードに書き込むことができます。</font><font style="vertical-align: inherit;">（ROS Kinetic、OpenCV 3.4.1。はい、新しいものがありますが、ソースからすべてを収集するよりも、行ったり来たりした方がよい場合があります）。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それにもかかわらず、便利さにもかかわらず、私はまだ少し画像を修正しなければなりませんでした。</font><font style="vertical-align: inherit;">元の画像の不快な詳細が判明したので、</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GUI（グラフィカルインターフェイス）なし。</font><font style="vertical-align: inherit;">これは特にROSにとって重要ではありませんが、ラインに乗るには、ラズベリー自体でカメラを調整し、それが（カメラ）が色をどのように伝えるかを確認する必要があります（詳細は以下を参照）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCVアセンブリは、自分でGUIをインストールしても、画面に画像を表示しません。</font><font style="vertical-align: inherit;">明らかに、rosbotsプロジェクトでは、opencvはこのオプションなしでビルドされました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小さな松葉杖はありません（VNC、メモ用テキストエディター、mc）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、OpenCVはGUI（openCV 3.4.3でコンパイル）でのイメージ出力のサポートを使用して再構築され、GUIがインストールされ、小さな松葉杖がインストールされました。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成したイメージは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にあり、それを基にさらに作業が行われます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラズベリーpiでネットワーク（wi-fi）とROSマスターを構成する</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験用にWi-Fiとは別のルーターを使用することを強くお勧めします。これらの目的のために、電話機にアクセスポイントを作成するだけです。これは、多くのパケットがwi-fi経由で飛ぶため、できれば一般的なトラフィックに落ち込まないことが原因です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像をraspberry sdカードにアップロードした後、ネットワークを構成します。ネットワークの初期設定は次のとおりです。</font></font><br>
<br>
<pre><code class="bash hljs">interface wlan0<font></font>
static ip_address=192.168.43.174/24<font></font>
static routers=192.168.43.1<font></font>
static domain_name_servers=192.168.43.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらは/etc/dhcpcd.confに含まれている</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ため、ホースをラズベリーに接続してすべてを変更することはできません。パス名がbossでパスワードが1234554321のアクセスポイントを作成するだけです。ラズベリーアドレスは192.168.43.174になります。 sshのほかに、VNCを介してこのアドレスにアクセスできます：ログイン-pi、パスワード-123qweasdzxcV。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROS-masterをセットアップします</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。ROS（ロボット操作システム）に出会ったことがない人のための簡単な説明です。 ROSマスターは、さまざまなノードがros（ノード、サービスなど）で通信するための仲介者です。rosマスターが実行されていないか、間違ったアドレスで実行されている場合、ノードはお互いを認識しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのROSシステムでは、ウィザードはOSのロードとともに自動的に開始し、対応するシステムファイルでROSウィザードのIPアドレスを指定するだけで済みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のネットワーク設定を変更していない場合は、何も構成する必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それ以外の場合は、bashrcを編集します。</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/.bashrc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルの最後で、ケースのIPアドレス（両方）を修正します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">export</span> ROS_MASTER_URI=http://192.168.43.174:11311
<span class="hljs-built_in">export</span> ROS_HOSTNAME=192.168.43.174
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リブート。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カートでターミナルを起動すると、出力は次のようになります（または設定で指定したもの）。</font></font><br>
<br>
<pre><code class="plaintext hljs">For all slaves, "export ROS_MASTER_URI=http://192.168.43.174:11311"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、ROSマスターが指定されたIPアドレスで動作することを意味します。 </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wi-Fiでトロリーを制御します</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初からノードが機能することを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルで：</font></font><br>
<br>
<pre><code class="bash hljs">rosnode list</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出力は次のようになります</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。/ rosout </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ uno_serial_node </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何も</font><font style="vertical-align: inherit;">表示さ</font><font style="vertical-align: inherit;">れない場合は、上記の設定でROSマスターを登録しているかどうか、USBホースをarduinoに接続しているかどうかを確認し、再起動します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チェック後、移動を担当する最初のノードを実行します。</font></font><br>
<br>
<pre><code class="bash hljs">rosrun rosbots_driver part2_cmr.py </code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*特別なrosコマンドは、rosbots_driver pythonパッケージからファイルpart2_cmr.pyを開始します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムはノードが実行中</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/pi/bh/fdpibhvndu-d6cxfonymmdcklsu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
であることを</font><font style="vertical-align: inherit;">通知します：</font><font style="vertical-align: inherit;">ここで、ホイールの半径とそれらの間の距離が決定されていることがわかります。</font><font style="vertical-align: inherit;">これらの値と、パスに沿ったrobot.pyファイルの動きに関連する他の値を修正できます</font></font><br>
<br>
<pre><code class="bash hljs">/home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/examples/coursera_control_of_mobile_robots/part2/full/controller</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
part2_cmr.py自体にはこれらのパラメーターがないためです。</font><font style="vertical-align: inherit;">2番目のターミナルを開き、rostopicリストを入力します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/1v/4t/5d1v4tmlmyminhgqzkkciavcvq4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、トピック/ part2_cmr / cmd_velが表示されていることがわかります。</font><font style="vertical-align: inherit;">このトピックでは、/ part2_cmrが他のノードが言うことを「聞き取り」、それらが言うことに応じて、動きを制御します。</font><font style="vertical-align: inherit;">正確に「聞く」が「話す」ことではないことは、コマンドを使用して理解できます。</font></font><br>
<br>
<pre><code class="bash hljs">rostopic info   /part2_cmr/cmd_vel</code></pre><br>
<img src="https://habrastorage.org/webt/ts/bp/pj/tsbppjpegozrwhekno2hebxtwte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、トピックに/ part2_cmrサブスクライバー（サブスクライブ済み）が表示され、リッスンしていることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*ノードなしで、トピックについて何かを「言う」ことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例えば：</font></font><br>
<br>
<pre><code class="bash hljs">rostopic pub -1 /wheel_power_left std_msgs/Float32 <span class="hljs-string">'{data: 1.0}'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左輪で前に曲がる</font></font><br>
<br>
<pre><code class="bash hljs">rostopic pub -1 /wheel_power_left std_msgs/Float32 <span class="hljs-string">'{data: 0.0}'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左輪を止める</font></font><br>
<br>
<pre><code class="bash hljs">rostopic pub -1 /wheel_power_left std_msgs/Float32 <span class="hljs-string">'{data: -1.0}'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホイールで背中合わせに</font></font><br>
<br>
<pre><code class="bash hljs">rostopic pub -1 /wheel_power_left std_msgs/Float32 <span class="hljs-string">'{data: -0.5}'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左のホイールをゆっくりと戻します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
構文は次のとおりです。rostopicpub-トピックで話したいという欲求、-1-一度だけの欲求、/ wheel_power_left-私たちが言うところのトピック、std_msgs / Float32-言語（メッセージ形式）、 '{data：-0.5}'-私たちが言うこと。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、トピック/ part2_cmr / cmd_velで話す人を実行します。</font><font style="vertical-align: inherit;">これがキーボードコマンド送信ノードになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
稼働中のノードで前のターミナルを閉じずに、別のターミナルを実行して次のように入力します。</font></font><br>
<br>
<pre><code class="bash hljs">rosrun teleop_twist_keyboard teleop_twist_keyboard.py /cmd_vel:=/part2_cmr/cmd_vel</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*パブリケーションはデフォルトでトピック/ cmd_velにあるため、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ cmd_vel：= / part2_cmr / cmd_vel </font><font style="vertical-align: inherit;">を使用してリダイレクトし</font><font style="vertical-align: inherit;">、メッセージが/ part2_cmr / cmd_velに注がれるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コントロールノードが起動し、キーボードのキーを押して乗ることができ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fy/bz/fl/fybzflgbhdqykv-vvxhk72qy_hq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。運転できない場合や、車輪の下から微妙なきしみ音がある場合は、ノードを実行した状態でターミナルで「w」を押して速度を上げる必要があります。</font><font style="vertical-align: inherit;">同じ（増加または減少）は、回転速度-「e」ボタンでも実行できます。</font><font style="vertical-align: inherit;">別の端末に切り替えたときにコントロールボタンが機能しない場合は、実行中のノードがある端末にいることも重要です。</font><font style="vertical-align: inherit;">操作端末の「k」ボタンはストップです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のターミナルで、トピック/ part2_cmr / cmd_velを見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/su/ab/cr/suabcrxmna11bzfmnxqsdzq0rxs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、トピック/ part2_cmr / cmd_velには、スピーカーとリスナーの両方がいます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCVに乗る</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どこかに行く前に、ロボットがキーボード制御で移動することを確認する必要があります。</font><font style="vertical-align: inherit;">ここで重要な注意が必要です。</font><font style="vertical-align: inherit;">上記の例でキーボードから制御する場合、左ターンはj、右l（ラテンl）、前i、後（コンマ）を押すことに対応する必要があります。</font><font style="vertical-align: inherit;">これがケースに当てはまらない場合は、旅行に問題がある可能性があります。</font><font style="vertical-align: inherit;">すべてを正常に戻すには、エンジンドライバーからのワイヤーペアをバーガーのArduinoの脚に変更する必要があります4,5,6,7 arduino：4,5はそれぞれ6,7または4と5,6と7と交換し、ホイールが回転する場所に応じて別の。</font><font style="vertical-align: inherit;">パスに沿ってarduinoのコードを調整することにより、プログラムでこれを行うこともできます-/home/pi/gitspace/rosbots_driver/platformio/rosbots_firmware/examples/motor_driver/src/main.cpp</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define M_LEFT_PWM 6</span>
<span class="hljs-comment">#define M_LEFT_FR 7</span>
<span class="hljs-comment">#define M_RIGHT_PWM 5</span>
<span class="hljs-comment">#define M_RIGHT_FR 4</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして次のコマンドでarduinoにリロードします：</font></font><br>
<br>
<pre><code class="bash hljs">upload_firmware ~/gitspace/rosbots_driver/platformio/rosbots_firmware/examples/motor_driver</code></pre> <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">花を使ってみましょう</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
園芸の経験では、ロボットが移動する床の線を選択し、その色を決定します。デフォルトでは、ロボットはそれを認識しません。ラインとしては、粘着テープ（黄色）や電気テープなど、特徴的な色で幅の広いものを使用できます。 *透明粘着テープは機能しません。背景を強調するのは難しいでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォルダーに移動してスクリプトを実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver<font></font>
python bgr-to-hsv.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*注意！</font><font style="vertical-align: inherit;">自分のものではなく、Rosbotsの元の画像を使用している場合、このプログラムはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのウィンドウが開きます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_v/qy/lw/_vqylwcxaerfndl2h7fgomt2zcy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの前にHSVの色の範囲があります。</font><font style="vertical-align: inherit;">HSVとは何ですか、なぜRGBではないのですか？自分でググってください </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
h1、s1、v1-下限およびh2、s2、v2-それぞれ、上限。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ウィンドウ内のスライダーを動かして、床に電気テープ（おそらくテープではなくテープ）があるラインを選択する必要があります。</font><font style="vertical-align: inherit;">結果ウィンドウには電気テープの線のみが残るはずです。電気テープ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xv/4y/cs/xv4ycskbhskfqq-1pwzgc_-llgc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の線は異常に白く、その他はすべて黒です。</font><font style="vertical-align: inherit;">この結果は必要です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HSV範囲の数を記録し、覚えておいてください。</font><font style="vertical-align: inherit;">私の場合は56,155,40と136,255,255です。</font><font style="vertical-align: inherit;">HSVの範囲は、ロボットカメラの近くのさまざまな光の条件下では異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルでctrl + cを入力してウィンドウを閉じ、HSV範囲をfollow_line_step_hsv.pyファイルに追加します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver<font></font>
nano follow_line_step_hsv.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行：</font></font><br>
<br>
<pre><code class="plaintext hljs">lower_yellow = np.array([21,80,160])<font></font>
upper_yellow = np.array([255,255,255])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HSV範囲の数を示します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線に沿って進む時間</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ターミナル1でモーターノードを開始します。</font></font><br>
<br>
<pre><code class="bash hljs">rosrun rosbots_driver part2_cmr.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のターミナルでカメラノードを起動します。</font></font><br>
<br>
<pre><code class="bash hljs">sudo modprobe bcm2835-v4l2<font></font>
roslaunch usb_cam usb_cam-test.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のターミナルでopencvノードを実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver<font></font>
python follow_line_step_hsv.py<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがうまくいくと、ロボットは線に沿って進み、追加のウィンドウが表示されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/ug/aj/bkugajoo0itqwwkbn8zckbm2mvy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。このウィンドウでは、電気テープに赤い丸が付いています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードの一般的な意味は、カメラから特定の距離にあるカラーセグメントを選択し、赤い円を描き、この円に移動して、中心に維持しようとすることです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最後に、重要なことについて-猫と笑顔について</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの目標は猫または笑顔の人に行くことなので、コードではより複雑なものを使用する必要があります。</font><font style="vertical-align: inherit;">猫と笑顔の人も必要です。</font><font style="vertical-align: inherit;">もう1つはより困難になりました。この困難で憂慮すべき時間に笑う人はほとんどいません。</font><font style="vertical-align: inherit;">だから猫から始めましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験には、猫の顔の写真が適しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1番目のターミナルでカメラノードを実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver<font></font>
python pi_camera_driver.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のターミナルのモーターノード：</font></font><br>
<br>
<pre><code class="bash hljs">rosrun rosbots_driver part2_cmr.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
猫検索ノードの3番目のターミナルで：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/pi/rosbots_catkin_ws/src/rosbots_driver/scripts/rosbots_driver<font></font>
python follow_cat2.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カートは次第に猫に移動し</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xj/yr/fm/xjyrfmqyd4lw2gv_neuscw7aus0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">今、あなたは笑顔の仕方を知っているボランティアが必要です。</font><font style="vertical-align: inherit;">小さな国であまり知られていない公人のポートレートを撮ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
猫の検索ノードの3番目のターミナルでは、閉じることができます-ctrl + cの代わりに、あまり知られていない公共の人物の笑顔を検索し始めます。</font></font><br>
<br>
<pre><code class="bash hljs">python follow_smile.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カートは、あまり知られていない人の笑顔にゆっくりと信じられないほど駆り立て</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5z/01/tr/5z01tr6a1npd3gppcqotqn5item.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
られる必要があります。多くの</font><font style="vertical-align: inherit;">人</font><font style="vertical-align: inherit;">が推測しているように、私たちが起動したスクリプトはHaarカスケードを使用しています。線に沿って移動するのと同じ原理で、目的の領域の四角が強調表示され、プログラムはロボットを動かすことによってそれを中心に維持しようとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、320x240と15 Fpsのカメラ設定にもかかわらず、raspberry 3bのパフォーマンスは、まだ多くが望まれています。遅延は時間の経過とともに顕著になります。すべての猫が耐えられるわけではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをどのように改善できますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エイドリアンが推奨するように、最適化されたopencvを再構築してみてください（https://www.pyimagesearch.com/2017/10/09/optimizing-opencv-on-the-raspberry-pi/）？</font><font style="vertical-align: inherit;">画像処理に外部PCリソースを使用しますか？</font><font style="vertical-align: inherit;">Haarハンドラーに飛ぶjpegの画像を圧縮しないようにしてみませんか？</font><font style="vertical-align: inherit;">そしてもう1つの大きなマイナス-猫は大きく、正面にある必要があります。</font><font style="vertical-align: inherit;">A4シートで15 cmの距離。</font><font style="vertical-align: inherit;">カメラから離れるとき、猫はすでに認識されず、不死身です。</font><font style="vertical-align: inherit;">8倍の倍率でカメラにラズベリーモノクルを入れますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS：記事に記載されている画像を実際に試してみても、体のさまざまな部分に乗ることができ、それに応じてcatノードの代わりに起動できます。</font></font><br>
<br>
<pre><code class="bash hljs">python follow_fullbody.py<font></font>
python follow_upperbody.py<font></font>
python follow_lowerbody.py<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顔または目：</font></font><br>
<br>
<pre><code class="bash hljs">python follow_face.py <font></font>
python follow_right_eye.py </code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットがお茶をこぼさないようにスムーズに離れる方法、およびラズベリー自体でそれを管理しない方法に興味がある場合は、書いてください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461113/index.html">製造中のマイクロコントローラーのプロジェクトにC ++を使用してから5年</a></li>
<li><a href="../ja461121/index.html">マイクロコントローラーでの小さなマルチタスク実験</a></li>
<li><a href="../ja461125/index.html">Visual Studioのソースコードでメッセージに番号を付けるための連続した数値コードを作成するタスク（例：C＃）</a></li>
<li><a href="../ja461127/index.html">VMware vSphereでのVMパフォーマンス分析。パート3：ストレージ</a></li>
<li><a href="../ja461129/index.html">コート、妻、二人の息子についての考え…そしてそれだけではありません。続きのある物語</a></li>
<li><a href="../ja461133/index.html">tSQLtを使用したSQL Serverコードのテスト</a></li>
<li><a href="../ja461137/index.html">ドライバーの注意を監視するためのデバイスをどのように開発したか。Yandex.Taxiを体験</a></li>
<li><a href="../ja461139/index.html">保険料詐欺スキーム</a></li>
<li><a href="../ja461141/index.html">俳句初日：意外といい</a></li>
<li><a href="../ja461143/index.html">ゲームデザインの現在の問題とそれらを解決する方法について。下から見る</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>