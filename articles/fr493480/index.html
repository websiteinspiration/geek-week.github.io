<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🌾 🎹 🐰 Architecture pour débutants ou pourquoi vous n'avez pas besoin d'insérer un drapeau dans l'épée 🖕🏾 👨🏼‍🤝‍👨🏻 🎱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Annotation:
 
 

1. Un exemple de l'implémentation de nouvelles fonctionnalités dans la classe en ajoutant un "flag".
2. Effets.
3. Approche alternati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Architecture pour débutants ou pourquoi vous n'avez pas besoin d'insérer un drapeau dans l'épée</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493480/"><img src="https://habrastorage.org/webt/9s/96/tv/9s96tvz6feehvgoiz_gmwdoktl8.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annotation:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple de l'implémentation de nouvelles fonctionnalités dans la classe en ajoutant un "flag".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effets.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Approche alternative et comparaison des résultats.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment éviter la situation: "Overkill architectural"?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le moment où vient le temps de tout changer.</font></font></li>
</ol></blockquote><br>
<a name="habracut"></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avant de commencer, quelques notes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'une histoire sur l'architecture logicielle - au sens où l'oncle Bob l'utilise. </font><font style="vertical-align: inherit;">Oui, celui-là.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les personnages, leurs noms et code dans l'article sont fictifs, toutes les coïncidences avec la réalité sont aléatoires.</font></font></li>
</ul></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que je sois un programmeur-programmeur ordinaire sur un projet. </font><font style="vertical-align: inherit;">Le projet est un jeu dans lequel un seul héros (alias Hero) suit une ligne parfaitement horizontale de gauche à droite. </font><font style="vertical-align: inherit;">Les monstres interfèrent avec ce merveilleux voyage. </font><font style="vertical-align: inherit;">À la demande de l'utilisateur, le héros les coupe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec une épée</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le chou et ne souffle pas dans la moustache. </font><font style="vertical-align: inherit;">Le projet compte déjà 100 000 lignes et «vous avez besoin de plus de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes de</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctionnalités!» </font><font style="vertical-align: inherit;">Regardons notre héros:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//   1</span><font></font>
    }<font></font>
    <span class="hljs-comment">//   </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons également que mon chef d'équipe personnel, Vasily, puisse également partir en vacances. </font><font style="vertical-align: inherit;">Tout à coup. </font><font style="vertical-align: inherit;">Qui aurait pensé? </font><font style="vertical-align: inherit;">De plus, la situation évolue en standard: une Chouette s'envole et a urgemment besoin, hier même, de pouvoir choisir avant le début du jeu: jouer pour le Héros avec un club ou avec une épée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ça doit être très rapide. </font><font style="vertical-align: inherit;">Et oui, bien sûr, lui-même a été programmeur pendant plus de ans que je ne peux marcher, il sait donc que la tâche est de cinq minutes. </font><font style="vertical-align: inherit;">Mais tant pis, estimez pour 2 heures. </font><font style="vertical-align: inherit;">Vous avez juste besoin d'ajouter une case à cocher et if-chik. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: if-chik dans la valeur @! ^% $ # @ ^% &amp; @! 11 $ its # $% @ ^% &amp;! @ !!! </font><font style="vertical-align: inherit;">dans &amp;! ^% # $ ^%! 1 if-chic! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mes pensées: «Ha! </font><font style="vertical-align: inherit;">Deux heures! </font><font style="vertical-align: inherit;">Terminé! ":</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">WeaponTypes</span> </span>{
        <span class="hljs-keyword">case</span> sword:
        <span class="hljs-keyword">case</span> club:<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-keyword">var</span> weaponType: <span class="hljs-type">WeaponTypes?</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> weaponType = weaponType <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">assertionFailure</span>()
            <span class="hljs-keyword">return</span>	<font></font>
        }<font></font>
        <span class="hljs-comment">//  : switch  Swift  if- -    !</span>
        <span class="hljs-keyword">switch</span> (weaponType) {
            <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//     </span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-comment">//  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez découvert ma décision, hélas: j'ai deux nouvelles pour vous:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme si c'était bon: nous livrons tous les deux. </font><font style="vertical-align: inherit;">Nous livrons - du mot livrer la valeur ou du mot code drôle (à travers les larmes).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et le mauvais: sans Vasily, le projet des kapets.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, qu'est-ce-qu'il s'est passé? </font><font style="vertical-align: inherit;">Il semblerait pour l'instant rien. </font><font style="vertical-align: inherit;">Mais voyons ce qui se passe ensuite (pendant que nous faisons tout notre possible pour garder Vasily en vacances). </font><font style="vertical-align: inherit;">Et puis il y aura ceci: le département QA fera attention au poids de notre héros. </font><font style="vertical-align: inherit;">Et non, ce n'est pas parce que le héros doit suivre un régime, mais voici pourquoi:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + swordWeight<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai oublié de fixer le calcul du poids. </font><font style="vertical-align: inherit;">Eh bien, vous pensez, erreur, avec qui ne se produit pas?! </font><font style="vertical-align: inherit;">Slap-bloop, fuck-tibidoch, prêt:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">//   guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + clubWeight<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais rapidement corrigé! </font><font style="vertical-align: inherit;">Le héros saute maintenant, en tenant compte du poids, mais. </font><font style="vertical-align: inherit;">Un travail axé sur les résultats! </font><font style="vertical-align: inherit;">Ce n'est pas à vous de regarder les nombrils, les astronautes architecturaux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, vraiment, alors il a corrigé un peu plus. </font><font style="vertical-align: inherit;">Dans la liste des sorts, je devais faire ceci:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//   guard let weaponType </span>
    <span class="hljs-comment">// ,   let spellsWithoutWeapon: [Spells]</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword:
            <span class="hljs-comment">//  let swordSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + swordSpells
	<span class="hljs-keyword">case</span> .club:
            <span class="hljs-comment">//  let clubSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + clubSpells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis Petya est venu et a tout cassé. </font><font style="vertical-align: inherit;">Eh bien, la vérité est que nous avons un tel juin sur le projet. </font><font style="vertical-align: inherit;">Inattentif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il avait juste besoin d'ajouter le concept de "niveau d'arme" aux formules pour calculer la force du coup et le poids du héros. </font><font style="vertical-align: inherit;">Et Petya a raté l'un des quatre cas. </font><font style="vertical-align: inherit;">Mais rien! </font><font style="vertical-align: inherit;">J'ai tout corrigé:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//guard let weaponType</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//        weaponGrade</span>
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//        weaponGrade</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">// guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight / grade
	<span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + pow(clubWeight, <span class="hljs-number">1</span> / grade)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//     , ! </span>
    <span class="hljs-comment">// ,     .    ,    ,   .   !</span>
}</code></pre><br>
<img src="https://habrastorage.org/webt/aw/ev/fo/awevfo6jjlysv_8l9wq-dl9npkw.png" height="80" width="80" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inutile de dire que quand (du coup!) Il fallait ajouter un arc / mettre à jour les formules, là encore il y avait des cas oubliés, des bugs et c'était tout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est ce qui ne s'est pas bien passé? </font><font style="vertical-align: inherit;">Où avais-je tort et qu'est-ce que (sauf pour les camarades) Vasily a dit à son retour de vacances? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, vous ne pouvez pas lire l'histoire plus loin, mais, par exemple, pensez à l'éternel, à l'architecture. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et avec ceux qui ont encore décidé de lire, nous continuons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, regardons les classiques:</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'optimisation prématurée est la racine de tout Mal!</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et ... euh ... ce n'est pas ça. </font><font style="vertical-align: inherit;">Voici la chose: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans les langages OOP (comme Swift, par exemple), il existe trois façons principales d'étendre les capacités d'une classe:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La première façon est «naïve». </font><font style="vertical-align: inherit;">Nous venons de le voir. </font><font style="vertical-align: inherit;">Ajout d'une case à cocher. </font><font style="vertical-align: inherit;">Ajout de responsabilité. </font><font style="vertical-align: inherit;">Cours de gonflement.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxième voie est l'héritage. </font><font style="vertical-align: inherit;">Tout le monde connaît un mécanisme puissant pour réutiliser le code. </font><font style="vertical-align: inherit;">On pourrait par exemple:</font></font><br>
 <ul>
<li><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Héritez le nouveau héros avec l'arc et le héros de Dubina du héros (qui tient une épée, mais cela ne se reflète pas dans le nom de la classe de héros maintenant). </font><font style="vertical-align: inherit;">Et puis dans les héritiers, remplacez les méthodes modifiées. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce chemin est très mauvais (croyez-moi).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faites de la classe de base (ou protocole) un héros et supprimez toutes les fonctionnalités associées à un type d'arme spécifique en tant qu'héritiers </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: héros avec une </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
épée: héros, </font><font style="vertical-align: inherit;">héros avec un </font><font style="vertical-align: inherit;">arc: héros, héros avec </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dubina: héros. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est mieux, mais les noms de ces classes nous regardent en quelque sorte mécontents, farouchement et à la fois tristes et perplexes. </font><font style="vertical-align: inherit;">S'ils ne regardent pas quelqu'un comme ça, alors j'essaierai d'écrire un autre article, où en plus du héros masculin ennuyeux, ils seront ...</font></font><img src="https://habrastorage.org/webt/7i/7w/l7/7i7wl7kxg1ol1mmtplsfv-h7i4w.png" height="80" width="80"></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La troisième voie est la séparation des responsabilités par l'injection de dépendance. </font><font style="vertical-align: inherit;">Il peut s'agir d'une dépendance fermée par un protocole ou d'une fermeture (comme si elle était fermée par une signature), peu importe. </font><font style="vertical-align: inherit;">L'essentiel est que la mise en œuvre de nouvelles responsabilités quitte la classe principale.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À quoi cela peut-il ressembler dans notre cas? </font><font style="vertical-align: inherit;">Par exemple, comme ceci (décision de Vasily):</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-keyword">let</span> weapon: <span class="hljs-type">Weapon</span> <span class="hljs-comment">//   , ..    </span><font></font>
<font></font>
    <span class="hljs-keyword">init</span> (<span class="hljs-number">_</span> weapon: <span class="hljs-type">Weapon</span>) { <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">self</span>.weapon = weapon<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {<font></font>
        weapon.strike()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + weapon.weight<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> spellsWithoutWeapon + weapon.spells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De quoi avez-vous besoin pour être ainsi? </font><font style="vertical-align: inherit;">Ninjutsu - protocole:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {<span class="hljs-keyword">get</span>}
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {<span class="hljs-keyword">get</span>}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple de mise en œuvre du protocole:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>: <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De même, les classes Sword sont écrites pour: Club, Bow, Pike, etc. </font><font style="vertical-align: inherit;">«Il est facile de voir» (c) que dans la nouvelle architecture tout le code qui se rapporte à chaque type particulier d'arme est groupé dans la classe correspondante, et n'est pas réparti selon le Héros avec d'autres types d'armes. </font><font style="vertical-align: inherit;">Cela facilite la lecture et la compréhension du héros et de toute arme particulière. </font><font style="vertical-align: inherit;">De plus, en raison des exigences du protocole imposé, il est beaucoup plus facile de suivre toutes les méthodes qui doivent être mises en œuvre lors de l'ajout d'un nouveau type d'arme ou lors de l'ajout d'une nouvelle fonctionnalité à une arme (par exemple, une arme peut avoir une méthode de calcul de prix). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous pouvez voir que l'injection de dépendances a compliqué la création d'objets de classe Hero. </font><font style="vertical-align: inherit;">Ce qui était auparavant fait simplement:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> lastHero = <span class="hljs-type">Hero</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, il s'est transformé en un ensemble d'instructions qui seront dupliquées partout où il est nécessaire de créer un héros. </font><font style="vertical-align: inherit;">Cependant, Vasily s'est occupé de cela:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSwordsman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> { <span class="hljs-comment">// ,  static -  </span>
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Sword</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeClubman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> {
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Club</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est clair que Vasily a dû transpirer pour disperser le tas qui a été </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empilé</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conçu par Petya (et moi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, en regardant la dernière solution, la pensée suivante peut se poser:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, ça s'est avéré, des normes. </font><font style="vertical-align: inherit;">Il est pratique de lire et d'étendre, mais toutes ces usines / protocoles / dépendances sont-ils un tas de frais généraux? </font><font style="vertical-align: inherit;">Un code qui ne donne rien en termes de fonctionnalités, mais n'existe que pour organiser le code. </font><font style="vertical-align: inherit;">"Code pour organiser le code", mgm. </font><font style="vertical-align: inherit;">Faut-il vraiment clôturer ce jardin toujours et partout?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une réponse honnête à la première question serait:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oui, c'est une surcharge pour les fonctionnalités que les entreprises aiment tant. </font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et à la question "quand?" </font><font style="vertical-align: inherit;">section réponses:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La philosophie de l'épéiste ou «quand avez-vous dû régner?»</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, c'était un épéiste. </font><font style="vertical-align: inherit;">Dans le système de sens de l'ancien code, c'était tout à fait normal. </font><font style="vertical-align: inherit;">Tant qu'il y avait un héros et une arme, il n'était pas nécessaire de les distinguer - tout de même, il n'y avait rien d'autre pour le héros. </font><font style="vertical-align: inherit;">Et le code monolithique a confirmé ce fait avec son texte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swordman - ça ne sonne même pas si mal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et à quoi ont conduit les premières modifications «naïves»? </font><font style="vertical-align: inherit;">À quoi l'ajout de l'if-chik? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ajout d'un if-chic a conduit à ... un mutant! </font><font style="vertical-align: inherit;">Mutant, c'est-à-dire </font><font style="vertical-align: inherit;">objet mutable qui peut muter entre un «humain» et un «Dubin humain». </font><font style="vertical-align: inherit;">Dans le même temps, si vous faites une petite erreur dans la mise en œuvre du mutant, alors l'état de «médulline humaine» apparaît. </font><font style="vertical-align: inherit;">Ne fais pas ça! </font><font style="vertical-align: inherit;">Il n'y a aucun besoin de «Dubin humain». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est nécessaire:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homme + addiction à l'épée (besoin d'une épée);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homme + addiction à un club (besoin d'un club).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les dépendances ne sont pas mauvaises! </font><font style="vertical-align: inherit;">Cette dépendance à l'alcool est mauvaise et le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocole</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est bon. </font><font style="vertical-align: inherit;">Oui, même la dépendance à l'objet est meilleure que «Dubin humain»! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quand la mutation s'est-elle produite? </font><font style="vertical-align: inherit;">La transformation en mutant s'est produite au moment où le drapeau a été ajouté: le code monolithique est resté monolithique, mais lorsque le drapeau a été changé (muté), le comportement du même objet a commencé à changer de manière significative. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vasily distinguerait deux étapes de mutation:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout d'un drapeau et du tout premier «si» (ou «commutateur» ou autre mécanisme de branchement) au drapeau. </font><font style="vertical-align: inherit;">La situation est menaçante, mais supportable: le héros est déversé de déchets radioactifs, mais il le surmonte.</font></font></li>
<li>     «if»   ,     . .    —   . ,    -  - .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, dans la situation considérée, afin d'éviter l'apparition de dettes techniques, il est logique de construire l'architecture avant de passer par la première étape, dans le pire des cas, par la seconde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'a fait Vasily exactement pour traiter un mutant? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'un point de vue technique - protocole fermé de dépendance d'injection utilisé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la responsabilité philosophique - partagée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les caractéristiques du travail de la classe, qui peuvent être échangées entre elles (ce qui signifie qu'elles sont alternatives les unes aux autres), ont été supprimées du héros en fonction. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La nouvelle </font><font style="vertical-align: inherit;">fonctionnalité </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alternative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - la mise en œuvre du travail de l'épée, la mise en œuvre du travail du club - dès son apparition, est devenue différente les unes des autres et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">différente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des autres comme auparavant</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> code </font><i><font style="vertical-align: inherit;">alternatif de</font></i><font style="vertical-align: inherit;"> héros. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donc déjà dans le code "naïf"</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quelque chose de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nouveau</font><font style="vertical-align: inherit;">est apparu</font><i><font style="vertical-align: inherit;"> qui était</font></i><font style="vertical-align: inherit;"> différent dans son comportement alternatif de la partie incontestée du Héros. </font><font style="vertical-align: inherit;">Ainsi, dans le code «naïf», une description implicite de nouvelles</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entités commerciales</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : une épée et un club</font><font style="vertical-align: inherit;">, répartis selon le Héros, a surgi</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Afin de faciliter le fonctionnement avec de nouvelles</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entités commerciales</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il est devenu nécessaire de les distinguer en tant</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'entités de code</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distinctes</font><font style="vertical-align: inherit;">avec leurs propres</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> noms</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y avait donc une division des responsabilités. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS TL; DR;</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tu vois le drapeau?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soyez un homme, bon sang! </font><font style="vertical-align: inherit;">Efface le!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injection de toxicomanie</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bénéfice! 11</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493458/index.html">Libérez votre Android - Alaverdi</a></li>
<li><a href="../fr493462/index.html">Bain à ultrasons. Partie 2</a></li>
<li><a href="../fr493468/index.html">N'ayez pas peur de respirer profondément</a></li>
<li><a href="../fr493470/index.html">Des scientifiques découvrent de nouvelles planètes mineures en dehors de Neptune</a></li>
<li><a href="../fr493478/index.html">Hack The Box - Walkthrough Forest. Attaques de torréfaction AS-REP, DCSync et Pass-The-Hash</a></li>
<li><a href="../fr493482/index.html">Rencontrez la tortue cybernétique, le prédécesseur de Roomba</a></li>
<li><a href="../fr493484/index.html">Votre C # est déjà «fonctionnel», laissez-le.</a></li>
<li><a href="../fr493486/index.html">Les startups automobiles les plus intéressantes 2019-2020</a></li>
<li><a href="../fr493488/index.html">Unité + git = amitié: partie 1 set de gentleman</a></li>
<li><a href="../fr493496/index.html">ReactJS. Avertissement: impossible d'effectuer une mise à jour de l'état React sur un composant non monté. Ceci est un no-op, mais il indique un mémo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>