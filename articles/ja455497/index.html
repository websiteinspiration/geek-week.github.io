<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🎓 🤵🏼 🖖 最適な線形フィルタリング：勾配降下から適応フィルターまで 🧕🏿 🤝 📘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="修士号「通信と信号処理」（TUイルメナウ）でアブストラクトのトピックを発展させ、「適応およびアレイ信号処理」コースの主要トピックの1つを続けたいと思います。つまり、適応フィルタリングの基本です。
 

この記事が最初に書かれたのは、次の人です
 
 。1）学生の母性専門分野の学生の友愛。
 2）実用...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最適な線形フィルタリング：勾配降下から適応フィルターまで</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455497/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修士号「通信と信号処理」（TUイルメナウ）でアブストラクトのトピックを発展させ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「適応およびアレイ信号処理」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コースの主要トピックの1つを続けたいと思い</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">つまり、適応フィルタリングの基本です。</font></font></p><br>
<p><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事が最初に書かれたのは、次の人です</font></font><br>
</u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。1）学生の母性</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">専門分野の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学生の友愛</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）実用的なセミナーを準備しているが、まだツールを決定していない教師向け-以下は</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">python</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matlab / Octaveの</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font><font style="vertical-align: inherit;">です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）フィルタリングのトピックに興味がある人向け。</font></font></p><br>
<p><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カットの下で見つけることができるもの：</font></font><br>
</u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
1）理論からの情報。私はできるだけ簡潔に整理しようとしましたが、情報的には私には思えます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）フィルターの使用例：特に、アンテナアレイのイコライザーの一部として。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）研究に役立つ可能性のある基本的な文献やオープンライブラリ（Python）へのリンク。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般に、歓迎し、すべてをポイントで分類しましょう。</font></font></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/2f1/98b/d67/2f198bd673789161db58ad770c629faf.jpg"></p><a name="habracut"></a><br>
<p><em>    —  ,  ,  .    ,   ,   . ,        —   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> 1941  </a>         ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Kolmogorov-Wiener filtering theory</a>.</em></p><br>
<h2 id="chto-rassmatrivaem"> ?</h2><br>
<p>         (, FIR — finite impulse response),       (. 1). </p><br>
<p><img src="https://habrastorage.org/webt/to/or/u7/tooru7vj_f6aj0oe9wvpcde28kw.png"></p><br>
<p><em>.1.  -    .[1. c.117]</em></p><br>
<p>   ,       :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c5/25f/391/0c525f391cd5d4b8c395e7aae0357eb3.svg" alt="e(n) = d(n) - \hat{d}(n|\mathcal{U}_n) =  d(n) - \mathbf{w}^H\mathbf{u} \qquad(1)"></div><br>
<p> :</p><br>
<ul>
<li><img src="https://habrastorage.org/getpro/habr/post_images/bff/68b/2d0/bff68b2d026ccfaef3bc2bd3bf9ba94c.svg" alt="e(n)"> —   ()     </li>
<li><img src="https://habrastorage.org/getpro/habr/post_images/12c/099/3c9/12c0993c9a275cc8266a468acb2c7692.svg" alt="d(n)"> —      (<em>desired signal</em>)</li>
<li><img src="https://habrastorage.org/getpro/habr/post_images/960/b4e/a48/960b4ea48f3968f42c64eed1af640e1d.svg" alt="\mathbf{u}"> —    ,  ,    </li>
<li><img src="https://habrastorage.org/getpro/habr/post_images/10a/457/ee7/10a457ee7b9b01c032a4024549ee0151.svg" alt="\hat{d}(n|\mathcal{U}_n)"> —     </li>
<li><img src="https://habrastorage.org/getpro/habr/post_images/50d/424/7ba/50d4247ba4986d234f52eb23ec7797e6.svg" alt="\mathbf{w}^H"> —       — <u>        </u></li>
</ul><br>
<p>   ,            ,     .       .</p><br>
<h2 id="chto-budem-optimizirovat">  ?</h2><br>
<p>,        , <strong>  </strong> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MSE — Mean Sqared Error</a>):</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/926/a52/15b/926a5215b2ba5533f2bdabd7ce89bc42.svg" alt="MSE: J(\mathbf{w}) = E\{e(n)^2\} \qquad (2)"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/dc7/ce1/7df/dc7ce17dfb6f5863c27db60356d78a15.svg" alt="J(\mathbf{w})">    (cost function)    ,  <img src="https://habrastorage.org/getpro/habr/post_images/a73/317/bad/a73317bad2bf7d6419c448e2051efdc9.svg" alt="E\{*\}">  . .</p><br>
<p>     ,    ,     <em> </em> (      <em>convex optimization</em>), ,   ,  <u> </u> (   ).</p><br>
<p><img src="https://habrastorage.org/webt/hr/xj/mb/hrxjmbmimv7c2uvvicnuklqn9y0.png"></p><br>
<p><em>.2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   </a>.</em></p><br>
<p>       [1, c.121]:</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/661/2b2/e5c/6612b2e5c710b35abd35d4de3273de07.svg" alt="J(\mathbf{w}) = \sigma^2_d - \mathbf{w}^H\mathbf{p} - \mathbf{p}^H\mathbf{w} + \mathbf{w}^H\mathbf{R}\mathbf{w} \qquad (3)"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/b68/d84/304/b68d8430402c799df3f86e0a38745043.svg" alt="\sigma^2_d"> —    , <img src="https://habrastorage.org/getpro/habr/post_images/64b/5ae/fac/64b5aefac6c20352af629cc0408187cf.svg" alt="\mathbf{p} = E\{\mathbf{u}(n)d^*(n)\}"> —   -      ,  <img src="https://habrastorage.org/getpro/habr/post_images/390/171/e50/390171e5078190a80c6ce23b77243c33.svg" alt="\mathbf{R} = E\{\mathbf{u}(n)\mathbf{u}^H(n)\}"> —     .</p><br>
<div class="spoiler"><b class="spoiler_title">    ( ).</b><div class="spoiler_text"><img src="https://habrastorage.org/webt/q6/sw/p5/q6swp5meopsxauj7yvygkwuc7-g.png" width="650"></div></div><br>
<p>    ,       ,    ()    .  ,       (   ),       ,  , <u> </u>    :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e78/f48/515/e78f48515a7f3f06e9e60530bc1a5cde.svg" alt="\frac{\delta J(\mathbf{w})}{\delta w^*} = - \mathbf{p} + \mathbf{R}\mathbf{w} \qquad (4)"></div><br>
<p>   (<img src="https://habrastorage.org/getpro/habr/post_images/361/fa8/5c0/361fa85c0a9daf324fa8365c8d0438ac.svg" alt="\mathbf{w} = \mathbf{w}_{opt}">),   ,  , ,      :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/954/6a1/0d8/9546a10d8b39de82210043f3ec1b3eb3.svg" alt="\mathbf{R}\mathbf{w}_{opt} = \mathbf{p}   \qquad (5)"></div><br>
<p>,  ,  ,      :   <u>  </u>. </p><br>
<h2 id="kak-budem-reshat">  ?</h2><br>
<p>  ,   ,    ,       ,   <img src="https://habrastorage.org/getpro/habr/post_images/1cf/d71/499/1cfd714992b16fcc961ad10bcc855134.svg" alt="\mathbf{R}">  <img src="https://habrastorage.org/getpro/habr/post_images/74d/442/360/74d4423608a641261b69dbb26ba3aae3.svg" alt="\mathbf{p}">   (            ). ,      —  ,       .</p><br>
<h3 id="analiticheskoe-reshenie"> </h3><br>
<p>   ,  ,   —    :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77d/6b8/35a/77d6b835a3b7c9207f0493e64c98c12d.svg" alt="\mathbf{w}_{opt} = \mathbf{R}^{-1}\mathbf{p}   \qquad (6)"></div><br>
<p>   <strong> -</strong> (Wiener–Hopf equation) —        . </p><br>
<blockquote>,    , , ,         , ..   <img src="https://habrastorage.org/getpro/habr/post_images/e27/e87/9ab/e27e879abf7938d2f497015d20da4ea6.svg" alt="^{-}">,   <img src="https://habrastorage.org/getpro/habr/post_images/047/e6f/c99/047e6fc9984b5ab2733de01283b4bbf6.svg" alt="^+"> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">-</a>):<br>
<img src="https://habrastorage.org/getpro/habr/post_images/acc/f95/c4e/accf95c4eb0202fa322e4b17860f4378.svg" alt="\mathbf{R}^+ = \mathbf{R}^H(\mathbf{R}\mathbf{R}^H)^{-1}"> <br>
<br>
,      -  ,    ,    .</blockquote><p>     ,        (..    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MMSE</a> — minimum mean square error):</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc6/84a/1cc/bc684a1cc6da877423a8c131055cce6c.svg" alt="J_{min} = J(\mathbf{w}_{opt}) = \sigma^2_d - \mathbf{p}^H\mathbf{R}^{-1}\mathbf{p}  \qquad (7)"></div><br>
<div class="spoiler"><b class="spoiler_title">   (  ).</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ds/vh/nx/dsvhnxoudmo_qd4hesg_qkysdg8.jpeg"></p></div></div><br>
<p>,   .</p><br>
<h3 id="reshenie-iterativnym-metodom">  </h3><br>
<p>, ,           —  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">to save computations</a>).        <strong>  </strong> (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">method of steepest/gradient descent</a>).</p><br>
<p>     : </p><br>
<ol>
<li>    -    (, <img src="https://habrastorage.org/getpro/habr/post_images/912/3f7/563/9123f7563a1d924b1e50ab6dfa3f0c41.svg" alt="\mathbf{w}(0) = \mathbf{0}">)</li>
<li>   <img src="https://habrastorage.org/getpro/habr/post_images/849/a42/16c/849a4216c1bc55877bc86f4a97513f7a.svg" alt="\mu"> (  ,   ).</li>
<li> ,  ,       (  ,   MSE)    <img src="https://habrastorage.org/getpro/habr/post_images/849/a42/16c/849a4216c1bc55877bc86f4a97513f7a.svg" alt="\mu">   ,   .</li>
</ol><br>
<p>  : <em>gradient</em> —   <em>steepest</em> —  <em>descent </em> — . </p><br>
<p>     :  ,   ,     (  ,   [1, . 220]).           ( ) [1, . 220]:</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d76/224/e5b/d76224e5b6fe810b12dcab11e6dad25d.svg" alt="\ mathbf {w}（n + 1）= \ mathbf {w}（n）-\ mu [-\ mathbf {p} + \ mathbf {R} \ mathbf {w}（n）] \ qquad（8）"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/fd6/0b2/b5b/fd60b2b5be4b7e93a0d905dd970c314f.svg" alt="ん"> —   .</p><br>
<p>      . </p><br>
<p>  :</p><br>
<ul>
<li>      </li>
<li>     ,     (,  ,     ,    )</li>
<li>, ,    ,        —      </li>
</ul><br>
<p>   , ,     [1, .222-226]:</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f19/595/676/f19595676b9a46be211cc5007cfee5ef.svg" alt="0 <\ mu <\ frac {2} {\ lambda_ {max}} \ qquad（9）"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/cfe/3ad/e34/cfe3ade34616069402c59cc528896790.svg" alt="\ lambda_ {最大}"> —       <img src="https://habrastorage.org/getpro/habr/post_images/1cf/d71/499/1cfd714992b16fcc961ad10bcc855134.svg" alt="\ mathbf {R}">. </p><br>
<blockquote> ,     —        .       <em>Eigen filter</em> (.  1).</blockquote><p>  ,  ,  .   ,  :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/816/8b6/010/8168b60109c9cf919fcd9f5406953920.svg" alt="\ mu（n）= \ frac {\ mathbf {\ gamma}（n）^ H \ mathbf {\ gamma}（n）} {\ mathbf {\ gamma}（n）^ H \ mathbf {R} \ mathbf { \ gamma}（n）} \ qquad（10）"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/3fa/f88/072/3faf880725473bd8fb01dbcd07e230f5.svg" alt="\ mathbf {\ gamma}（n）= \ mathbf {p}-\ mathbf {R} \ mathbf {w}（n）"> —   .    ,     ,   .</p><br>
<div class="spoiler"><b class="spoiler_title">   (  -      ,  ).</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/au/hq/0s/auhq0sxrspaduxdkclqctns1xtw.jpeg"></p></div></div><br>
<p>,       .</p><br>
<h2 id="a-nelzya-li-na-primerah">    ?</h2><br>
<p>    .   <strong>Python 3.6.4</strong>.</p><br>
<blockquote> ,   —      ,           .     python (     ). ,      -     . </blockquote><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np 
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> scipy.linalg <span class="hljs-keyword">import</span> toeplitz<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">convmtx</span>(<span class="hljs-params">h,n</span>):</span>
    <span class="hljs-keyword">return</span> toeplitz(np.hstack([h, np.zeros(n<span class="hljs-number">-1</span>)]),\<font></font>
                           np.hstack([h[<span class="hljs-number">0</span>], np.zeros(n<span class="hljs-number">-1</span>)]))<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MSE_calc</span>(<span class="hljs-params">sigmaS, R, p, w</span>):</span>
    w = w.reshape(w.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)<font></font>
    wH = np.conj(w).reshape(<span class="hljs-number">1</span>, w.shape[<span class="hljs-number">0</span>])<font></font>
    p = p.reshape(p.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)<font></font>
    pH = np.conj(p).reshape(<span class="hljs-number">1</span>, p.shape[<span class="hljs-number">0</span>])<font></font>
    MSE = sigmaS - np.dot(wH, p) - np.dot(pH, w) + np.dot(np.dot(wH, R), w)<font></font>
    <span class="hljs-keyword">return</span> MSE[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">mu_opt_calc</span>(<span class="hljs-params">gamma, R</span>):</span>
    gamma = gamma.reshape(gamma.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>)<font></font>
    gammaH = np.conj(gamma).reshape(<span class="hljs-number">1</span>, gamma.shape[<span class="hljs-number">0</span>])<font></font>
    mu_opt = np.dot(gammaH, gamma) / np.dot(np.dot(gammaH, R), gamma)<font></font>
    <span class="hljs-keyword">return</span> mu_opt[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]</code></pre><br>
<p>       <u>  (channel equalization)</u>,             .</p><br>
<blockquote>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a> (,      —  ).</blockquote><br>
<h3 id="model-sistemy"> </h3><br>
<p>,    (       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">MUSIC</a>).</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/4eb/c16/1b9/4ebc161b92bdb73519d3cb5c188494ec.png"></p><br>
<p><em>. 3.     (ULAA — uniform linear antenna array) [2, . 32].</em></p><br>
<p>   :</p><br>
<pre><code class="python hljs">M = <span class="hljs-number">5</span> <span class="hljs-comment">#     (number of sensors)</span></code></pre><br>
<p>      -  <u>   </u>,     <u> </u>.      ,           (. 4).</p><br>
<p><img src="https://habrastorage.org/webt/3t/tc/va/3ttcvau0o4njat-1beejefcudpy.png"></p><br>
<p><em>. 4.     n  .[3, c. 29].   ,      —      .</em></p><br>
<p>        :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cbd/c9d/9d7/cbdc9d9d7e9a433fdc510d5a551ec404.svg" alt="x（n）= \ sum_ {l = 0} ^ Lh（l）s（nl）+ \ nu（n）"></div><br>
<p>   <img src="https://habrastorage.org/getpro/habr/post_images/fd6/0b2/b5b/fd60b2b5be4b7e93a0d905dd970c314f.svg" alt="ん">   , <img src="https://habrastorage.org/getpro/habr/post_images/b4a/1f9/e0a/b4a1f9e0a708be7e03547969d17375c8.svg" alt="h（l）"> —     <em>l</em>- , <em>L</em> —   , <em>s</em> —  () , <img src="https://habrastorage.org/getpro/habr/post_images/cb1/273/bf1/cb1273bf139b37d6ec47ba4bb1b828f2.svg" alt="\ nu（n）"> —  . </p><br>
<p>     :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/471/2ef/96e/4712ef96edeb0a21d6fcf6bfc46ce6d2.svg" alt="\ mathbf {x}（n）= \ mathbf {H} \ mathbf {s}（n）+ \ mathbf {\ nu}（n）"></div><br>
<p> <img src="https://habrastorage.org/getpro/habr/post_images/b33/599/d30/b33599d30c28fc4838113de7530be463.svg" alt="\ mathbf {x}（n）">  <img src="https://habrastorage.org/getpro/habr/post_images/cb1/273/bf1/cb1273bf139b37d6ec47ba4bb1b828f2.svg" alt="\ mathbf {\ nu}（n）"> —   <img src="https://habrastorage.org/getpro/habr/post_images/ce3/d15/e06/ce3d15e0646c4e20bca7f0d37cd8de40.svg" alt="M \回1">,  <img src="https://habrastorage.org/getpro/habr/post_images/e79/cb6/ae8/e79cb6ae8d0e454f94b42ad408308b72.svg" alt="\ mathbf {H}">  <img src="https://habrastorage.org/getpro/habr/post_images/00d/c51/230/00dc5123059ae5e5f8a17f9722312929.svg" alt="M \回（ML）">,   <img src="https://habrastorage.org/getpro/habr/post_images/fee/7f3/e79/fee7f3e798e6e42ca41b2a78d8988a9b.svg" alt="\ mathbf {s}（n）">  <img src="https://habrastorage.org/getpro/habr/post_images/3aa/e10/59e/3aae1059ec9d038c13c734e93c046d6b.svg" alt="（ML）\回1">.</p><br>
<p>,        - ,      - .  <img src="https://habrastorage.org/getpro/habr/post_images/e79/cb6/ae8/e79cb6ae8d0e454f94b42ad408308b72.svg" alt="\ mathbf {H}">            . ,     :</p><br>
<pre><code class="python hljs">h = np.array([<span class="hljs-number">0.722</span><span class="hljs-number">-1j</span>*<span class="hljs-number">0.779</span>, <span class="hljs-number">-0.257</span><span class="hljs-number">-1j</span>*<span class="hljs-number">0.722</span>, <span class="hljs-number">-0.789</span><span class="hljs-number">-1j</span>*<span class="hljs-number">1.862</span>])<font></font>
L = len(h)<span class="hljs-number">-1</span> <span class="hljs-comment"># number of signal sources</span><font></font>
H = convmtx(h,M-L)<font></font>
<font></font>
print(H.shape)<font></font>
print(H)</code></pre><br>
<p> :</p><br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>array([[ <span class="hljs-number">0.722</span><span class="hljs-number">-0.779j</span>,  <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   ,  <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   ],<font></font>
       [<span class="hljs-number">-0.257</span><span class="hljs-number">-0.722j</span>,  <span class="hljs-number">0.722</span><span class="hljs-number">-0.779j</span>,  <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   ],<font></font>
       [<span class="hljs-number">-0.789</span><span class="hljs-number">-1.862j</span>, <span class="hljs-number">-0.257</span><span class="hljs-number">-0.722j</span>,  <span class="hljs-number">0.722</span><span class="hljs-number">-0.779j</span>],<font></font>
       [ <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   , <span class="hljs-number">-0.789</span><span class="hljs-number">-1.862j</span>, <span class="hljs-number">-0.257</span><span class="hljs-number">-0.722j</span>],<font></font>
       [ <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   ,  <span class="hljs-number">0.</span>   +<span class="hljs-number">0.j</span>   , <span class="hljs-number">-0.789</span><span class="hljs-number">-1.862j</span>]])</code></pre><br>
<p>        :</p><br>
<pre><code class="python hljs">sigmaS = <span class="hljs-number">1</span> <span class="hljs-comment">#    (the signal's s(n) power)</span>
sigmaN = <span class="hljs-number">0.01</span> <span class="hljs-comment">#   (the noise's n(n) power)</span></code></pre><br>
<p>   .</p><br>
<pre><code class="python hljs">Rxx = (sigmaS)*(np.dot(H,np.matrix(H).H))+(sigmaN)*np.identity(M)<font></font>
<font></font>
p = (sigmaS)*H[:,<span class="hljs-number">0</span>]<font></font>
p = p.reshape((len(p), <span class="hljs-number">1</span>))</code></pre><br>
<div class="spoiler"><b class="spoiler_title">   (    ).</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hi/lh/ks/hilhksxoc_rkum_5ibn3m42ukxc.jpeg"></p></div></div><br>
<p>   :</p><br>
<pre><code class="python hljs"><span class="hljs-comment"># Solution of the Wiener-Hopf equation:</span><font></font>
wopt = np.dot(np.linalg.inv(Rxx), p)<font></font>
MSEopt = MSE_calc(sigmaS, Rxx, p, wopt)</code></pre><br>
<p>     .</p><br>
<p>   ,         (.  (9)):</p><br>
<pre><code class="python hljs">lamda_max = max(np.linalg.eigvals(Rxx))</code></pre><br>
<p>    ,       :</p><br>
<pre><code class="python hljs">coeff = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.1</span>]) <font></font>
mus = <span class="hljs-number">2</span>/lamda_max*coeff <span class="hljs-comment"># different step sizes</span></code></pre><br>
<p>   :</p><br>
<pre><code class="python hljs">N_steps = <span class="hljs-number">100</span></code></pre><br>
<p> :</p><br>
<pre><code class="python hljs">MSE = np.empty((len(mus), N_steps), dtype=complex)
<span class="hljs-keyword">for</span> mu_idx, mu <span class="hljs-keyword">in</span> enumerate(mus):<font></font>
    w = np.zeros((M,<span class="hljs-number">1</span>), dtype=complex)
    <span class="hljs-keyword">for</span> N_i <span class="hljs-keyword">in</span> range(N_steps):<font></font>
        w = w - mu*(np.dot(Rxx, w) - p)<font></font>
        MSE[mu_idx, N_i] = MSE_calc(sigmaS, Rxx, p, w)</code></pre><br>
<p>    ,      ( (10)):</p><br>
<pre><code class="python hljs">MSEoptmu = np.empty((<span class="hljs-number">1</span>, N_steps), dtype=complex)<font></font>
w = np.zeros((M,<span class="hljs-number">1</span>), dtype=complex)
<span class="hljs-keyword">for</span> N_i <span class="hljs-keyword">in</span> range(N_steps):<font></font>
    gamma = p - np.dot(Rxx,w)<font></font>
    mu_opt = mu_opt_calc(gamma, Rxx)<font></font>
    w = w - mu_opt*(np.dot(Rxx,w) - p)<font></font>
    MSEoptmu[:, N_i] = MSE_calc(sigmaS, Rxx, p, w)</code></pre><br>
<p>   :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="python hljs">x = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, N_steps+<span class="hljs-number">1</span>)]<font></font>
<font></font>
plt.figure(figsize=(<span class="hljs-number">5</span>, <span class="hljs-number">4</span>), dpi=<span class="hljs-number">300</span>)<font></font>
<font></font>
<span class="hljs-keyword">for</span> idx, item <span class="hljs-keyword">in</span> enumerate(coeff):
    <span class="hljs-keyword">if</span> item == <span class="hljs-number">1</span>:<font></font>
        item = <span class="hljs-string">''</span><font></font>
    plt.loglog(x, np.abs(MSE[idx, :]),\<font></font>
           label=<span class="hljs-string">'$\mu = '</span>+str(item)+<span class="hljs-string">'\mu_{max}$'</span>)<font></font>
<font></font>
plt.loglog(x, np.abs(MSEoptmu[<span class="hljs-number">0</span>, :]),\<font></font>
           label=<span class="hljs-string">'$\mu = \mu_{opt}$'</span>)<font></font>
<font></font>
plt.loglog(x, np.abs(MSEopt*np.ones((len(x), <span class="hljs-number">1</span>), dtype=complex)),\<font></font>
          label = <span class="hljs-string">'Wiener solution'</span>)<font></font>
plt.grid(<span class="hljs-literal">True</span>)<font></font>
plt.xlabel(<span class="hljs-string">'Number of steps'</span>)<font></font>
plt.ylabel(<span class="hljs-string">'Mean-Square Error'</span>)<font></font>
plt.title(<span class="hljs-string">'Steepest descent'</span>)<font></font>
plt.legend(loc=<span class="hljs-string">'best'</span>)<font></font>
plt.minorticks_on()<font></font>
plt.grid(which=<span class="hljs-string">'major'</span>)<font></font>
plt.grid(which=<span class="hljs-string">'minor'</span>, linestyle=<span class="hljs-string">':'</span>)<font></font>
plt.show()</code></pre></div></div><br>
<p><img src="https://habrastorage.org/webt/il/fa/8d/ilfa8dmoxgt4sjitiyvwbdjga6m.png"></p><br>
<p><em>. 5.   (learning curves)    .</em></p><br>
<p>       :</p><br>
<ul>
<li>  ,      ;</li>
<li>   :        .</li>
</ul><br>
<p>       ,        — <u> </u>.</p><br>
<h2 id="a-est-chto-to-bolee-blizkoe-k-realnosti">  -    ?</h2><br>
<p>!     ,    (..     )  real-time  —      . ,      :   <em></em>     <u></u>.        [1, c. 246]:</p><br>
<ul>
<li><em> (stochastic)</em> (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">SG</a> — Stochastic Gradient)</li>
<li>    <em> </em> (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">LMS</a> — Least Mean Squares  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">RLS</a> — Recursive Least Squares)</li>
</ul><br>
<p>       open-source  (  python):</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">pyroomacoustics</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">padasip</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">adaptfilt</a></li>
</ul><br>
<blockquote>      . ,  !     <strong>padasip</strong>,         (    float64). ,          -  .</blockquote><p>,  ,     ,       . </p><br>
<p>   :        <em>SG</em>, <em>LMS</em>  <em>RLS</em> (    MATLAB — ,   ,       … ...).</p><br>
<p>  <em>LMS</em>  <em>RLS</em>  , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">padasip</a>. </p><br>
<div class="spoiler"><b class="spoiler_title"> SG   .</b><div class="spoiler_text"><p>        :</p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb9/c84/a3a/bb9c84a3a631529893c4b196abfedbc0.svg" alt="\mathbf{w}[n] = \mathbf{w}[n-1] + \mu \left(\mathbf{\hat{p}}[n] - \mathbf{\hat{R}}_{xx}[n]\mathbf{w}[n-1]\right)"></div><br>
<p></p><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e4d/23d/d3b/e4d23dd3b3792b570b40518bf881bca5.svg" alt="\mathbf{\hat{R}}_{xx}[n] = \frac{1}{n}\left( (n-1) \mathbf{\hat{R}}_{xx}[n-1] + \mathbf{x}[n]\mathbf{x}[n]^H\right)"></div><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ee/2ad/05a/2ee2ad05aa2664b5c91d2a3018716349.svg" alt="\mathbf{\hat{p}}[n] = \frac{1}{n}\left( (n-1) \mathbf{\hat{p}}[n-1] + \mathbf{x}[n]d[n]^*\right)"></div></div></div><br>
<p>1) ,   .</p><br>
<div class="spoiler"><b class="spoiler_title"> (MatLab/Octave).</b><div class="spoiler_text"><p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</p></div></div><br>
<p><img src="https://habrastorage.org/webt/ff/zm/hq/ffzmhqsrnwvvc0hdrcyzhapropw.png"></p><br>
<p><em>. 6.   (learning curves)  LMS, RLS  SG.</em></p><br>
<p>  ,       LMS             .     RLS,         <em>  (forgetting factor)</em>.    SG,      .</p><br>
<p>2) ,     .</p><br>
<div class="spoiler"><b class="spoiler_title"> (MatLab/Octave).</b><div class="spoiler_text"><p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</p></div></div><br>
<p><img src="https://habrastorage.org/webt/v-/9d/sx/v-9dsxxwzr9jnbnswf0dmnvqrcu.png"></p><br>
<p><em>. 7.   (learning curves)  LMS, RLS  SG (   ).</em></p><br>
<p>      :           LMS.    .   RLS   forgetting factor    .</p><br>
<div class="spoiler"><b class="spoiler_title">   .</b><div class="spoiler_text"><p>,        ,              120       LMS  SG    250      RLS.   ,  -, .</p></div></div><br>
<p>      .  ,  !</p><br>
<h2 id="literatura"></h2><br>
<ol>
<li>Haykin S. S. Adaptive filter theory. – Pearson Education India, 2005.</li>
<li>Haykin, Simon, and KJ Ray Liu. Handbook on array processing and sensor networks. Vol. 63. John Wiley &amp; Sons, 2010. pp. 102-107</li>
<li>Arndt, D. (2015). On Channel Modelling for Land Mobile Satellite Reception (Doctoral dissertation).</li>
</ol><br>
<h2 id="prilozhenie-1"> 1</h2><br>
<div class="spoiler"><b class="spoiler_title">Eigen filter</b><div class="spoiler_text"><p>    —    - (SNR — Signal-to-Noise Ratio).</p><br>
<p><img src="https://habrastorage.org/webt/kk/v_/uu/kkv_uu-08dppu5i4yhkucc_b0ww.jpeg"></p><br>
<p>      ,     ,   . </p></div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja455483/index.html">アイダ・アーティスト：ヒューマノイド・ロボットが最初の個展に備える</a></li>
<li><a href="../ja455485/index.html">Check Pointスクリプト-Smart Consoleから直接スクリプトを実行します</a></li>
<li><a href="../ja455487/index.html">Cisco 200-125 CCNA v3.0のトレーニング。10日目。ポートの動作モードを切り替える</a></li>
<li><a href="../ja455489/index.html">サードパーティのオーディオおよびビデオソリューションをMicrosoft Teamsに接続する</a></li>
<li><a href="../ja455493/index.html">Angular 8バージョンの新機能</a></li>
<li><a href="../ja455499/index.html">親知らずの抽出：これはどのように行われますか？</a></li>
<li><a href="../ja455501/index.html">ハリウッドがAIを秘密裏に使用して主要な撮影の決定を下す方法</a></li>
<li><a href="../ja455503/index.html">効果的なAngular開発者になるために学ぶ必要がある19の概念</a></li>
<li><a href="../ja455505/index.html">React Application Acceleration Fourfold</a></li>
<li><a href="../ja455507/index.html">データテーブルPythonパッケージの概要</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>