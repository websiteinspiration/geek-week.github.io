<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👧🏻 👐 🧣 MySQLクラスターのHAソリューションとしてのOrchestratorとVIP 🈲 🥁 👋🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CityMobileでは、永続データのメインストレージとしてMySQLデータベースを使用します。さまざまなサービスと目的のために、いくつかのデータベースクラスタがあります。
 
 ウィザードが常に利用可能であることは、システム全体とその個々の部分の正常性の重要な指標です。ウィザードに障害が発生した場...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MySQLクラスターのHAソリューションとしてのOrchestratorとVIP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/citymobil/blog/491044/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CityMobileでは、永続データのメインストレージとしてMySQLデータベースを使用します。</font><font style="vertical-align: inherit;">さまざまなサービスと目的のために、いくつかのデータベースクラスタがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィザードが常に利用可能であることは、システム全体とその個々の部分の正常性の重要な指標です。</font><font style="vertical-align: inherit;">ウィザードに障害が発生した場合の自動クラスター回復により、インシデントの応答時間とシステムのダウンタイムが大幅に削減されます。</font><font style="vertical-align: inherit;">この記事では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Orchestrator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と仮想IPアドレス（VIP）に</font><font style="vertical-align: inherit;">基づく</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">MySQL</font></a><font style="vertical-align: inherit;"> HAクラスターについて説明し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dn/78/bb/dn78bbg_qvozrgufsyzr0joysuw.png"><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VIP HAソリューション</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、データストレージシステムの概要について簡単に説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つの書き込み専用ウィザードと多くの読み取り専用レプリカを備えた従来のレプリケーションスキームを使用します。クラスターには、中間マスター（レプリカであり、他のマスターであるノード）を含めることができます。クライアントはHAProxyを介してレプリカにアクセスします。これにより、負荷分散と容易なスケーラビリティが可能になります。 HAProxyの使用は歴史的な理由によるものであり、現在ProxySQLへの移行を進めています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レプリケーションは、に基づいて準同期です</font></font><code>GTID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。つまり、トランザクションが成功したと見なされるには、少なくとも1つのレプリカがトランザクションをログに書き込む必要があります。このレプリケーションモードは、メインノードに障害が発生した場合のパフォーマンスとデータの安全性の最適なバランスを提供します。基本的に、すべての変更は、を使用してマスターからレプリカに転送されますが</font></font><code>Row Based Replication (RBR)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、一部のノードにはがある場合があります</font></font><code>mixed binlog format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーケストレーターは定期的にクラスタートポロジーの状態を更新し、受信した情報を分析します。問題が発生した場合は、自動復旧手順を開始できます。プロシージャは、VIP、DNSに基づいて、サービスディスカバリサービスまたは自己完結型メカニズムを使用して、さまざまな方法で実装できるため、開発者はプロシージャ自体に責任があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
失敗した場合にウィザードを復元する最も簡単な方法の1つは、フローティングVIPアドレスを使用することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に進む前に、このソリューションについて知っておくべきこと：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VIPは、特定の物理ネットワークインターフェイスに関連付けられていないIPアドレスです。</font><font style="vertical-align: inherit;">ノードに障害が発生した場合、またはスケジュールされた作業中に、最小限のダウンタイムでVIPを別のリソースに切り替えることができます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仮想IPアドレスの解放と発行は、安価で高速な操作です。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VIPを使用するには、SSHを介したサーバーへのアクセス、またはなどの特別なツールの使用が必要です</font></font><code>keepalived</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスターで起こりうる問題を検討し、自動回復メカニズムがどのように機能するかを想像します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターへのネットワーク接続がなくなったか、ハードウェアレベルで問題が発生し、サーバーが利用できなくなっています</font></font></h4><br>
<ol>
<li>   ,      .     ,     ,   .<br>
</li>
<li>  VIP    — .<br>
</li>
<li>    .  .<br>
</li>
<li>     VIP.   VIP  ,        <b>gratuitous ARP</b>.   /        IP-  MAC-,       VIP.    <code>split brain</code>    . <br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい接続はすべて、すぐに新しいマスターにリダイレクトされます。</font><font style="vertical-align: inherit;">古い接続は失敗し、アプリケーションレベルでデータベースに対して繰り返し呼び出しが行われます。</font></font><br>
</li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーは通常モードで動作していますが、DBMSレベルで障害が発生しました</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムは前のケースと同様です：トポロジーの更新と回復プロセスの開始。</font><font style="vertical-align: inherit;">サーバーが使用可能であるため、古いマスターのVIPを正常に解放し、新しいマスターに転送して、いくつかのARP要求を送信します。</font><font style="vertical-align: inherit;">古いウィザードが戻る可能性があっても、再構築されたクラスターとアプリケーションの操作には影響しません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その他の問題</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レプリカまたは中間マスターに障害が発生</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しても</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、自動アクション</font><em><font style="vertical-align: inherit;">は発生せず</font></em><font style="vertical-align: inherit;">、手動による介入が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仮想ネットワークインターフェイスは常に一時的に追加されます。つまり、VIPサーバーの再起動後は自動的に割り当てられません。</font><font style="vertical-align: inherit;">データベースの各インスタンスはデフォルトで読み取り専用モードで起動され、オーケストレーターは自動的に新しいマスターを記録に切り替え</font></font><code>read only</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、古いマスター</font><font style="vertical-align: inherit;">へのインストールを試み</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これらのアクションは、可能性を減らすことを目的としてい</font></font><code>split brain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回復プロセス中に問題が発生する可能性があります。これは、標準の監視ツールに加えて、オーケストレーターのUIを通じて通知する必要があります。</font><font style="vertical-align: inherit;">この機能を追加してREST APIを拡張しました（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は現在検討中です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HAソリューションの一般的なスキームを以下に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yl/pk/gk/ylpkgksjn1cfj0wdbil7dje9qss.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいウィザードの選択</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーケストラは十分にスマートであり</font><font style="vertical-align: inherit;">、次の基準に従って</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も適切なレプリカ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を新しいマスターとして</font><font style="vertical-align: inherit;">選択しようとします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターからのレプリカのラグ。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLウィザードとレプリカバージョン。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レプリケーションのタイプ（RBR、SBR、または混合）;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つまたは異なるデータセンター内の場所。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用性</font></font><code>errant GTID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-レプリカで実行され、マスターには存在しないトランザクション。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム選択ルールも考慮されます。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのレプリカがマスターの役割の理想的な候補であるとは限りません。</font><font style="vertical-align: inherit;">たとえば、レプリカを使用してデータをバックアップしたり、サーバーのハードウェア構成を弱めたりできます。</font><font style="vertical-align: inherit;">オーケストレーター</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手動ルールを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サポートしている</font></a><font style="vertical-align: inherit;">ため、優先度を最も高いものから無視するものまで選択するための設定を調整できます。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">応答時間と回復時間</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インシデントが発生した場合は、システムのダウンタイムを最小限に抑えることが重要です。そのため、オーケストラによるクラスタートポロジの構築と更新に影響を与えるMySQLパラメーターを検討します。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>slave_net_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-接続が失われたと認識されて再接続が実行される前に、レプリカがマスターからの新しいデータまたはハートビート信号を待機する秒数。</font><font style="vertical-align: inherit;">値が低いほど、レプリカはマスターとの接続が切断されていることをより速く判別できます。</font><font style="vertical-align: inherit;">この値を5秒に設定します。</font></font><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>MASTER_CONNECT_RETRY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-再接続の試行間の秒数。</font><font style="vertical-align: inherit;">ネットワークの問題が発生した場合、このパラメーターの値を小さくすると、迅速に再接続してクラスターの回復プロセスを開始できなくなります。</font><font style="vertical-align: inherit;">推奨値は1秒です。</font></font><br>
</li>
<li><code>MASTER_RETRY_COUNT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -再接続の最大試行回数。 </font></font><br>
</li>
<li><code>MASTER_HEARTBEAT_PERIOD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-マスターがハートビート信号を送信するまでの間隔（秒）。</font><font style="vertical-align: inherit;">デフォルトは半分の値</font></font><code>slave_net_timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーケストレーターオプション：</font></font><br>
<br>
<ul>
<li><code>DelayMasterPromotionIfSQLThreadNotUpToDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-等しい場合</font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、レプリカSQLストリームがリレーログから適用されていないすべてのトランザクションを完了するまで、ウィザードの役割は候補レプリカに適用されません。</font><font style="vertical-align: inherit;">すべての候補レプリカが遅れているときにトランザクションを失わないようにするために、このオプションを使用します。</font></font><br>
</li>
<li><code>InstancePollSeconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -トポロジを構築および更新する頻度。</font></font><br>
</li>
<li><code>RecoveryPollSeconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-トポロジ分析の頻度。</font><font style="vertical-align: inherit;">問題が検出されると、トポロジー回復が開始されます。</font><font style="vertical-align: inherit;">これは</font><font style="vertical-align: inherit;">1秒に等しい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各クラスターノードは、オーケストレーターによって毎秒1回ポーリングされます</font></font><code>InstancePollSeconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">問題が検出されると、クラスターの状態が強制的に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新され</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、最終的な回復が実行されます。</font><font style="vertical-align: inherit;">データベースとオーケストラのさまざまなパラメーターを実験することにより、応答と回復の時間を30秒に短縮することができました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストスタンド</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ローカル</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベンチ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">開発し、</font><font style="vertical-align: inherit;">さらにテストおよび戦闘環境に実装することで</font><font style="vertical-align: inherit;">、HAスキームのテストを開始しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ローカルスタンドはDockerに基づいて完全に自動化されており、オーケストラとネットワークの構成を実験したり、クラスターを2〜3台のサーバーから数十台に拡張したり、安全な環境で演習を行ったりできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
演習では、問題をエミュレートする方法の1つを選択します。でウィザードを即座に撮影</font></font><code>kill -9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、プロセスをゆっくりと完了してサーバーを停止し（</font></font><code>docker-compose stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、</font></font><code>iptables -j REJECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはで</font><font style="vertical-align: inherit;">ネットワークの問題をシミュレートします</font></font><code>iptables -j DROP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私たちはこれらの結果を期待します：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オーケストラはマスターの問題を検出し、10秒以内にトポロジを更新します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リカバリ手順が自動的に開始されます。ネットワーク構成が変更され、ウィザードの役割がレプリカに移動し、トポロジが再構築されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいマスターは記録に使用でき、ライブレプリカは再構築の過程で失われません。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データは新しいマスターに書き込まれ、複製されます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">総回復時間は30秒以内です。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご存じのとおり、ハードウェアとネットワークの構成の違い、合成負荷と実際の負荷の違いなどにより、テスト環境と本番環境ではシステムの動作が異なる場合があります。</font><font style="vertical-align: inherit;">したがって、ネットワーク接続が失われたり、個々のパーツが劣化した場合のシステムの動作を確認しながら、実際の状況で定期的にエクササイズを行います。</font><font style="vertical-align: inherit;">将来的には、両方の環境で完全に同一のインフラストラクチャを構築し、そのテストを自動化したいと考えています。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストレージシステムのメインノードの操作性は、SREチームと運用の主要なタスクの1つです。</font><font style="vertical-align: inherit;">オーケストラとVIPに基づくHAソリューションの導入により、次の結果が得られました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースクラスタのトポロジに関する問題の信頼できる検出。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターに関連するインシデントへの自動で迅速な応答。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、ソリューションには制限と欠点があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAスキームを複数のデータセンターに拡張するには、それらの間に単一のL2ネットワークが必要です。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいマスターにVIPを割り当てる前に、古いマスターでVIPを解放する必要があります。</font><font style="vertical-align: inherit;">プロセスはシーケンシャルであり、回復時間が長くなります。</font></font><br>
</li>
<li> VIP  SSH-  ,       .      ,   ,     ,   VIP  .            IP-   <code>split brain</code>.<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を回避</font></font><code>split brain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STONITH</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">（「頭の中の他のノードを撃つ」）</font><font style="vertical-align: inherit;">を使用できます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">この</font></a><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">は、問題のあるノードを完全に分離または切断します。</font><font style="vertical-align: inherit;">クラスターの高可用性を実装する方法は他にもあります。VIPとDNSの組み合わせ、サービス検出とプロキシサービス、同期レプリケーション、およびそれらの欠点と利点を持つその他の方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQLフェイルオーバークラスターを作成するためのアプローチについて話しました。</font><font style="vertical-align: inherit;">実装は簡単で、現在の環境で許容できるレベルの信頼性を提供します。</font><font style="vertical-align: inherit;">システム全体、特にインフラストラクチャの開発により、このアプローチは間違いなく進化します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja491032/index.html">「RTFM、おい！」または、チーズがいかに無料で5ドルかかるか。そしてそれは80ドルであったかもしれません+</a></li>
<li><a href="../ja491034/index.html">WireGuard-Linuxカーネルでの高速で安全なVPN</a></li>
<li><a href="../ja491036/index.html">JavaScriptフレームワークが不要な場合</a></li>
<li><a href="../ja491038/index.html">YandexがTestsuiteをオープン</a></li>
<li><a href="../ja491040/index.html">ニジニでのQAミートアップ-現状とイベントの資料</a></li>
<li><a href="../ja491050/index.html">NeoQUEST-2020への登録：ポスト黙示録的な世界オープン</a></li>
<li><a href="../ja491052/index.html">サンクトペテルブルクHSEのキュレーターが新入生プログラマーをどのように、そしてなぜ支援するか</a></li>
<li><a href="../ja491054/index.html">PKCS＃11トークンを使用してGPGキーでメールの通信に署名する方法</a></li>
<li><a href="../ja491056/index.html">Ampere Altra-世界初の80コアARMプロセッサ</a></li>
<li><a href="../ja491058/index.html">死亡率、死亡率、コロナウイルスおよびマタン</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>