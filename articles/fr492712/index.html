<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéóÔ∏è üí™üèº üé∫ Ma√Ætriser le d√©veloppement gr√¢ce aux tests sur Android √† l'aide de tests d'interface üîû ‚èπÔ∏è üî≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. En pr√©vision du lancement d'un nouvel ensemble de cours de base et avanc√©s sur le d√©veloppement Android, nous avons pr√©par√© une traduc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Ma√Ætriser le d√©veloppement gr√¢ce aux tests sur Android √† l'aide de tests d'interface</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/492712/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour √† tous. </font><font style="vertical-align: inherit;">En pr√©vision du lancement d'un nouvel ensemble de cours de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avanc√©s</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le d√©veloppement Android, nous avons pr√©par√© une traduction de mat√©riel int√©ressant.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/0i/ef/lj/0iefljfwnqnrpvgj9hizrlqeatg.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de la derni√®re ann√©e de travail de l'√©quipe de d√©veloppement Android chez Buffer, nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avons beaucoup parl√© de la propret√© de notre projet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de l'am√©lioration de sa stabilit√©. </font><font style="vertical-align: inherit;">L'un des facteurs a √©t√© l'introduction () de tests qui, comme nous l'avons d√©j√† d√©couvert, nous aident √† √©viter les r√©gressions dans notre code et nous donnent plus de confiance dans les fonctionnalit√©s que nous proposons. </font><font style="vertical-align: inherit;">Et maintenant, lorsque nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lan√ßons de nouveaux produits dans Buffer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous voulons nous assurer que la m√™me approche est appliqu√©e en ce qui les concerne - juste pour que nous ne soyons pas dans la m√™me situation qu'auparavant.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contexte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'√©criture de tests unitaires pour les applications Buffer, nous avons toujours respect√© les pratiques de d√©veloppement par le biais de tests (Test-Driven-Development - ci-apr√®s TDD). </font><font style="vertical-align: inherit;">Il existe de nombreuses ressources sur ce qu'est le TDD, sur ses avantages et d'o√π ils viennent, mais nous ne nous attarderons pas sur ce sujet, car il y a beaucoup d'informations sur Internet. </font><font style="vertical-align: inherit;">√Ä un niveau √©lev√©, j'en note personnellement certains:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temps de d√©veloppement r√©duit</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code plus simple, plus propre et plus facile √† g√©rer</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code plus fiable avec plus de confiance dans notre travail.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couverture de test plus √©lev√©e (cela semble assez √©vident)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais jusqu'√† r√©cemment, nous ne suivions les principes de TDD que sous la forme de tests unitaires pour nos impl√©mentations qui n'√©taient pas bas√©s sur l'interface utilisateur ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c8/df/_w/c8df_wzud2rosic5vw82xx1axyg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je sais, je sais ... Nous avons toujours eu l'habitude d'√©crire des tests d'interface une fois que ce qui a √©t√© impl√©ment√© a √©t√© termin√©. - et cela n'a pas de sens. Nous avons surveill√© TDD pour le backend afin que le code que nous √©crivons r√©ponde aux exigences d√©finies par les tests, mais en ce qui concerne les tests d'interface utilisateur, nous √©crivons des tests qui satisfont √† l'impl√©mentation d'une fonctionnalit√© sp√©cifique. Comme vous pouvez le voir, c'est un peu controvers√©, et √† certains √©gards, c'est pourquoi le TDD est utilis√© en premier lieu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, ici, je veux examiner pourquoi il en est ainsi et comment nous exp√©rimentons le changement. Mais pourquoi y pr√™tons-nous attention en premier lieu?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il √©tait toujours difficile de travailler avec les activit√©s existantes dans notre application en raison de la fa√ßon dont elles sont √©crites. </font><font style="vertical-align: inherit;">Ce n'est pas une excuse compl√®te, mais ses nombreuses d√©pendances, responsabilit√©s et liens √©troits les rendent extr√™mement difficiles √† tester. </font><font style="vertical-align: inherit;">Pour les nouvelles activit√©s que nous avons ajout√©es, par habitude, j'ai moi-m√™me toujours √©crit des tests d'interface utilisateur apr√®s la mise en ≈ìuvre - √† part l'habitude, il n'y avait pas d'autre raison √† cela. </font><font style="vertical-align: inherit;">Cependant, lors de la cr√©ation de notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code mod√®le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pr√™t pour de nouveaux projets, j'ai pens√© √† un changement. </font><font style="vertical-align: inherit;">Et vous serez heureux de savoir que cette habitude a √©t√© rompue, et maintenant nous travaillons sur nous-m√™mes, explorant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour les </font><font style="vertical-align: inherit;">tests d' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface utilisateur</font></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premiers pas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce que nous allons explorer ici est un exemple assez simple, afin que le concept soit plus facile √† suivre et √† comprendre - j'esp√®re que cela suffira pour voir certains des avantages de cette approche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons commencer par cr√©er une activit√© de base. Nous devons le faire pour pouvoir ex√©cuter notre test d'interface utilisateur - imaginez que cette configuration est la base de notre impl√©mentation, et non l'impl√©mentation elle-m√™me. Voici √† quoi ressemble notre activit√© de base:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginActivity</span>: <span class="hljs-title">AppCompatActivity</span>(), <span class="hljs-title">LoginContract</span>.<span class="hljs-title">View</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Inject</span> lateinit <span class="hljs-keyword">var</span> loginPresenter: LoginContract.<span class="hljs-function">Presenter

    override fun <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: Bundle?)</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<font></font>
        setContentView(R.layout.activity_login)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">setPresenter</span><span class="hljs-params">(presenter: LoginContract.Presenter)</span> </span>{<font></font>
        loginPresenter = presenter<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showServerErrorMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showGeneralErrorMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showProgress</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideProgress</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showInvalidEmailMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideInvalidEmailMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous remarquerez peut-√™tre que cette activit√© ne fait rien d'autre que la configuration initiale, qui est requise pour l'activit√©. Dans la m√©thode onCreate (), nous √©tablissons simplement un lien vers la mise en page, nous avons √©galement un lien vers notre interface View, qui est impl√©ment√©e √† l'aide de l'activit√©, mais ils n'ont pas encore d'impl√©mentations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des choses les plus courantes que nous trouvons dans les tests Espresso est les vues de r√©f√©rence et les cha√Ænes par ID de ressource trouv√©es dans notre application. √Ä cet √©gard, nous devons √† nouveau fournir un fichier de mise en page √† utiliser dans notre activit√©. Cela est d√ª au fait que: a) notre activit√© a besoin d'un fichier de mise en page pour afficher la mise en page pendant les tests, et b) nous avons besoin d'une vue ID pour les liens dans nos tests. Allons de l'avant et faisons une mise en page tr√®s simple pour notre activit√© de connexion:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">EditText</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/input_email"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">EditText</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/input_password"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/button_login"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous pouvez voir que nous ne nous soucions d'aucun style ou position, souvenez-vous - pendant que nous cr√©ons la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fondation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et non l'impl√©mentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour la derni√®re partie de la configuration, nous allons d√©finir les lignes qui seront utilis√©es dans cet exercice. </font><font style="vertical-align: inherit;">Encore une fois, nous devrons les r√©f√©rencer dans les tests - jusqu'√† ce que vous les ajoutiez √† votre disposition XML ou √† votre classe d'activit√©, d√©finissez-les simplement dans le fichier </font></font><code>strings.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="java hljs">&lt;string name=<span class="hljs-string">"error_message_invalid_email‚Äù&gt;‚Ä¶&lt;/string&gt;
&lt;string name="</span>error_message_invalid_password‚Äù&gt;‚Ä¶&lt;/string&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous remarquerez peut-√™tre que dans cette configuration, nous √©crivons le moins possible, mais nous fournissons suffisamment de d√©tails sur notre activit√© et sa configuration pour √©crire des tests. </font><font style="vertical-align: inherit;">Notre activit√© ne fonctionne pas actuellement, mais elle s'ouvre et a une vue qui peut √™tre r√©f√©renc√©e. </font><font style="vertical-align: inherit;">Maintenant que nous avons suffisamment de minimum pour travailler, continuons et ajoutons quelques tests.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout de tests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous avons trois situations que nous devons impl√©menter, nous allons donc √©crire des tests pour eux.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsqu'un utilisateur entre une adresse e-mail non valide dans le champ de saisie e-mail, nous devons afficher un message d'erreur. </font><font style="vertical-align: inherit;">Nous allons donc √©crire un test qui v√©rifie si ce message d'erreur est affich√©.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque l'utilisateur recommence √† entrer des donn√©es dans le champ de saisie de l'e-mail, le message d'erreur ci-dessus devrait dispara√Ætre - nous allons donc √©crire un test pour cela.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin, lorsque l'API renvoie un message d'erreur, il doit s'afficher dans une bo√Æte de dialogue d'avertissement - nous allons donc √©galement ajouter un test pour cela.</font></font></li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">invalidEmailErrorHidesWhenUserTypes</span><span class="hljs-params">()</span> </span>{<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withId(R.id.input_email))<font></font>
            .perform(typeText(<span class="hljs-string">"j"</span>))<font></font>
<font></font>
    onView(withText(R.string.error_message_invalid_email))<font></font>
            .check(doesNotExist())<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">invalidPasswordErrorDisplayed</span><span class="hljs-params">()</span> </span>{<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withText(R.string.error_message_invalid_password))<font></font>
            .check(matches(isDisplayed()))<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">serverErrorMessageDisplays</span><span class="hljs-params">()</span> </span>{<font></font>
    val response = ConnectResponseFactory.makeConnectResponseForError()<font></font>
    stubConnectRepositorySignIn(Single.just(response))<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.input_email))<font></font>
            .perform(typeText(<span class="hljs-string">"joe@example.com"</span>))<font></font>
<font></font>
    onView(withId(R.id.input_password))<font></font>
            .perform(typeText(DataFactory.randomUuid()))<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withText(response.message))<font></font>
            .check(matches(isDisplayed()))<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, maintenant nous avons des tests √©crits - continuons et ex√©cutons-les. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2x/ac/bv/2xacbvdf2rumlv9asggjp9mwsp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et il n'est pas surprenant qu'ils aient √©chou√© - c'est parce que nous n'avons pas encore d'impl√©mentation, donc cela devrait √™tre pr√©vu. En tout cas, nous devrions √™tre heureux de voir du rouge pour les tests d√®s maintenant! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors maintenant, nous devons ajouter des impl√©mentations pour notre activit√© jusqu'√† ce que les tests r√©ussissent. Alors que nous √©crivons des tests cibl√©s qui testent un seul concept (ou du moins cela devrait l'√™tre!), Nous pouvons ajouter des impl√©mentations une par une et √©galement regarder nos tests devenir verts l'un apr√®s l'autre. </font><b><font style="vertical-align: inherit;">Examinons donc</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
l'un des tests ayant √©chou√©, commen√ßons par le test </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">invalidPasswordErrorDisplayed ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nous savons quelques choses:</font></font><br>
<br>
<ul>
<li>     ,    ,       ,          ,       :</li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> fun <span class="hljs-title">setupLoginButtonClickListener</span><span class="hljs-params">()</span> </span>{<font></font>
    button_login.setOnClickListener {<font></font>
        loginPresenter.performSignIn(input_email.text.toString(),<font></font>
                input_password.text.toString()) }<font></font>
}</code></pre><br>
<ul>
<li>       ,          .    TextInputLayout,             ,    :</li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function">override fun <span class="hljs-title">showInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
    layout_input_password.error = getString(R.string.error_message_invalid_password)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous avons ajout√© la logique de cette situation, continuons et r√©ex√©cutons nos tests! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/4-/et/jq4-etd3rfq9tddsy4x0lusrti0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Super, il semble que le ch√®que </font></font><code>invalidPassworrdErrorDisplays()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ait r√©ussi. Mais nous n'avons pas encore fini, nous avons encore deux tests qui n'ont pas √©t√© pass√©s pour les parties de notre fonction de connexion que nous devons impl√©menter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous consid√©rerons le test </font></font><code>serverErrorMessageDisplays()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. C'est assez simple, nous savons que lorsque l'API renvoie une r√©ponse d'erreur (et non une erreur g√©n√©rale de notre biblioth√®que r√©seau), l'application doit afficher un message d'erreur √† l'utilisateur dans une bo√Æte de dialogue d'avertissement. Pour ce faire, nous avons juste besoin de cr√©er une instance de la bo√Æte de dialogue en utilisant notre message d'erreur de serveur dans le texte de la bo√Æte de dialogue:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">override fun <span class="hljs-title">showServerErrorMessage</span><span class="hljs-params">(message: String)</span> </span>{<font></font>
    DialogFactory.createSimpleInfoDialog(<span class="hljs-keyword">this</span>, R.string.error_message_login_title, message, <font></font>
            R.string.error_message_login_ok).show()<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Continuons et ex√©cutons √† nouveau nos tests: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/td/le/m2/tdlem2qq8vgtq9wcggplu-dra_0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hourra! </font><font style="vertical-align: inherit;">Nous allons de l'avant, il ne nous reste plus qu'un test, c'est un test </font></font><code>invalidEmailErrorHidesWhenUserTypes()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Encore une fois, c'est un cas simple, mais regardons-le:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque l'utilisateur clique sur le bouton de connexion et que l'adresse e-mail est manquante ou que l'adresse e-mail est incorrecte, nous affichons √† l'utilisateur un message d'erreur. </font><font style="vertical-align: inherit;">Nous l'avons d√©j√† impl√©ment√©, je l'ai simplement exclu pour plus de simplicit√©</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, lorsque l'utilisateur recommence √† saisir des donn√©es dans le champ, le message d'erreur doit √™tre supprim√© de l'affichage. </font><font style="vertical-align: inherit;">Pour ce faire, nous devons √©couter lorsque le contenu textuel du champ de saisie change:</font></font></li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> fun <span class="hljs-title">setupOnEmailTextChangedListener</span><span class="hljs-params">()</span> </span>{<font></font>
    input_email.addTextChangedListener(object : TextWatcher {<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">afterTextChanged</span><span class="hljs-params">(s: Editable)</span> </span>{}<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">beforeTextChanged</span><span class="hljs-params">(s: CharSequence, start: Int,
                                       count: Int, after: Int)</span> </span>{<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">onTextChanged</span><span class="hljs-params">(s: CharSequence, start: Int,
                                   before: Int, count: Int)</span> </span>{<font></font>
            loginPresenter.handleEmailTextChanged(s)<font></font>
        }<font></font>
    })<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, cela devrait √™tre suffisant pour garantir que notre message d'erreur sera masqu√© lors de la modification du contenu du champ de saisie. </font><font style="vertical-align: inherit;">Mais nous avons des tests pour confirmer nos changements: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/du/ni/aa/duniaa83g3b84ennz4ljp03uez8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
super! </font><font style="vertical-align: inherit;">Nos exigences de mise en ≈ìuvre sont remplies lorsque nous passons nos tests - c'est formidable de voir le feu vert</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de noter que l'exemple auquel nous avons appliqu√© TDD est extr√™mement primitif. Imaginez que nous d√©veloppons un √©cran complexe, tel qu'un flux de contenu, dans lequel vous pouvez effectuer plusieurs actions avec des √©l√©ments de flux (par exemple, comme dans l'application Buffer pour Android) - dans ces cas, nous utiliserons de nombreuses fonctions diff√©rentes qui devraient √™tre impl√©ment√©es dans l'activit√© donn√©e / fragment. Ce sont des situations o√π TDD sera r√©v√©l√© encore plus dans les tests d'interface utilisateur, car ce qui peut conduire √† √©crire du code trop complexe pour ces fonctions peut √™tre r√©duit √† des impl√©mentations qui satisfont les tests donn√©s que nous avons √©crits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©sumer, je partagerai quelques points tir√©s de mon exp√©rience:</font></font><br>
<br>
<ul>
<li>  ,   ,  TDD  .   ,        .   ,  Espresso     (/,     ),         .       activity,  ,      ,        .                .</li>
<li>  ,   ,     ,   , ,  ,   ,       .  ,        , ,      ,  ,      ( ,      !). -         .           , , ,  - .</li>
<li> ,   Ui-              ,   ,          . ,   , ,   ,       ,      ,    .</li>
<li> ,      .       ,        ‚Äî      ,      ,        ,     - .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela semble plus naturel. </font><font style="vertical-align: inherit;">√âtant donn√© que TDD est d√©j√† utilis√© pour les tests unitaires, vous vous sentez un peu en arri√®re lorsque vous √©crivez des tests unitaires, suivis des impl√©mentations, puis des tests d'interface utilisateur. </font><font style="vertical-align: inherit;">Vous vous sentirez plus naturel en prenant des mesures compl√®tes avec TDD, pas √† mi-chemin.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Utilisez-vous d√©j√† TDD lors de l'√©criture de tests d'interface utilisateur et faites-vous quelque chose de similaire ou de compl√®tement diff√©rent? </font><font style="vertical-align: inherit;">Ou voulez-vous en savoir un peu plus et poser quelques questions? </font><font style="vertical-align: inherit;">N'h√©sitez pas √† commenter ci-dessous ou √† nous tweeter √† </font></font><code>@bufferdevs</code> <br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est tout. </font><font style="vertical-align: inherit;">Nous vous attendons aux cours:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avanc√©e</font></font></a></li>
</ul></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr492702/index.html">Traduction automatique. De la guerre froide √† nos jours</a></li>
<li><a href="../fr492704/index.html">Pour augmenter l'efficacit√© de la survie des implants de 5 √† 7 fois - comment est-ce possible?</a></li>
<li><a href="../fr492706/index.html">Archives de la m√©moire: comment le cerveau code et reproduit les souvenirs</a></li>
<li><a href="../fr492708/index.html">Internet satellite mondial - y a-t-il des nouvelles des champs?</a></li>
<li><a href="../fr492710/index.html">Chemin √©pineux du candidat √† travers divers syst√®mes de GRH</a></li>
<li><a href="../fr492714/index.html">Travail efficace √† domicile: g√©n√©ral et personnel</a></li>
<li><a href="../fr492718/index.html">S√©curit√© gr√¢ce √† la restriction des utilisateurs ou comment cr√©er une vuln√©rabilit√©</a></li>
<li><a href="../fr492720/index.html">discussion: service de fichiers de projet</a></li>
<li><a href="../fr492724/index.html">Bj√∂rn Straustrup r√©pond aux 5 meilleures questions C ++ avec d√©bordement de pile</a></li>
<li><a href="../fr492726/index.html">OS Sivelkiriya: processus de d√©veloppement logiciel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>