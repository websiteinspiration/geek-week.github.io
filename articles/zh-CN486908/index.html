<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕣 👨🏽‍✈️ 👆🏿 Wulfric勒索软件是不存在的加密器 👊 🍴 🧟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="有时人们真的很想研究某种病毒编写者，然后问：为什么以及为什么？我们将处理与问题的回答“如何”自己，但是这将是非常有趣的，以找出什么是恶意软件的创造者是通过指导。特别是当我们遇到这样的“珍珠”时。
 
 今天这篇文章的英雄是一位有趣的密码学家。他显然以为是另一种勒索软件，但其技术实现更像是一个恶作剧。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wulfric勒索软件是不存在的加密器</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/486908/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时人们真的很想研究某种病毒编写者，然后问：为什么以及为什么？我们将</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与问题的回答“如何”自己，但是</font><font style="vertical-align: inherit;">这将是非常有趣的</font><font style="vertical-align: inherit;">，以找出什么是</font><font style="vertical-align: inherit;">恶意软件的创造者</font><s><font style="vertical-align: inherit;">是</font></s><font style="vertical-align: inherit;">通过指导。特别是当我们遇到这样的“珍珠”时。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今天这篇文章的英雄是一位有趣的密码学家。他显然以为是另一种勒索软件，但其技术实现更像是一个恶作剧。今天我们将讨论这种实现。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，实际上不可能追踪此编码器的生命周期-编码统计太少，因为幸运的是，它尚未收到分配。</font><font style="vertical-align: inherit;">因此，我们将起源，感染方法和其他参考资料排除在外。</font><font style="vertical-align: inherit;">我们只会谈论与</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wulfric Ransomware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会面的案例，</font><font style="vertical-align: inherit;">以及我们如何帮助用户保存他的文件。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一开始</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
经常受到密码学家影响的人会与我们的防病毒实验室联系。</font><font style="vertical-align: inherit;">无论他们安装了什么防病毒产品，我们都会提供帮助。</font><font style="vertical-align: inherit;">这次，我们遇到了一个文件被未知编码器删除的人。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下午好！</font><font style="vertical-align: inherit;">具有无密码输入的文件存储（samba4）中的文件已加密。</font><font style="vertical-align: inherit;">我怀疑感染来自我女儿的计算机（带有本机Windows Defender保护的Windows 10）。</font><font style="vertical-align: inherit;">此后，女儿的计算机没有打开。</font><font style="vertical-align: inherit;">文件主要是加密的.jpg和.cr2。</font><font style="vertical-align: inherit;">加密后的文件扩展名：.aef。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们从用户那里收到了加密文件的样本，赎金记录和文件，这可能是加密作者解密文件所需的密钥。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那就是我们所有的线索：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01c.aef（4481K） </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacked.jpg（254K） </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacked.txt（0K） </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">04c.aef（6540K） </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass.key（0K） </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下笔记。</font><font style="vertical-align: inherit;">这次有多少个比特币？</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递：</font></font></b><br>
<blockquote>,   !<br>
    .<br>
<br>
  0.05 BTC  -: 1ERtRjWAKyG2Edm9nKLLCzd8p1CjjdTiF<br>
    ,   pass.key  Wulfric@gmx.com    .<br>
<br>
       .<br>
<br>
      :<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">buy.blockexplorer.com</a> —   <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.buybitcoinworldwide.com</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">localbitcoins.net</a><br>
<br>
 :<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">en.wikipedia.org/wiki/Bitcoin</a><br>
    - ,    Wulfric@gmx.com<br>
    ,          .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
悲情狼，旨在向受害者展示情况的严重性。</font><font style="vertical-align: inherit;">但是，情况可能更糟。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nn/e9/_s/nne9_svoarapfsjf2yajkqb9c84.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">1.-作为奖励，我将告诉您将来如何保护计算机。</font><font style="vertical-align: inherit;">-似乎是合法的。</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二。</font><font style="vertical-align: inherit;">开始工作</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，我们看了发送样本的结构。奇怪的是，它看起来不像是遭受加密器攻击的文件。我们打开十六进制编辑器并查看。前4个字节包含原始文件大小，后60个字节用零填充。但是最有趣的是最后：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0u/ej/nq/0uejnqz2z2-r770dvhba1u90no0.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 2分析损坏的文件。什么立即引起您的注意？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
一切都变得很简单：将标头中的0x40字节移到文件末尾。要恢复数据，只需将它们返回到开头即可。恢复了对该文件的访问权限，但名称仍保持加密，因此一切都变得更加复杂。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4e/m3/ht/4em3htrjjmfvb4xwspngahu_61w.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 3. Base64中的加密名称看起来像一个不连贯的字符集。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
让我们尝试解析</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass.key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由用户发送。在其中，我们看到了一个162字节的ASCII字符序列。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/v0/c0/n6v0c0yosdvlv3gdh3ubgxj4ggy.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 4.受害人的PC上还剩下162个字符。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果仔细观察，您会注意到以一定的频率重复字符。这可能表示使用XOR，其中重复是特征性的，其频率取决于密钥的长度。折断了6个字符的行并执行了XOR序列的某些变体后，我们没有获得任何有意义的结果。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3c/gp/vq/3cgpvqvoieizntwut0pk8g2pczo.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 5.看到中间的重复常量？</font></font></b> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们决定对这些常量进行Google搜索，因为是的，这也是可能的！所有这些最终导致了一种算法-批量加密。在研究了脚本之后，很明显，我们的台词不过是其工作的结果。应该提到的是，它根本不是加密器，而仅仅是用6字节序列替换字符的编码器。没有密钥或其他机密供您使用：（</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bv/ln/ej/bvlnejuy9fwyzjlofrrfi1rpuoi.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图6.原始作者身份未知的算法的一部分。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果没有一个细节，该算法将无法正常工作：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xk/oc/qz/xkocqz5aldw_y5sthecwwumvyqo.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图7. Morpheus批准。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
使用反向替换，我们将字符串从</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass.key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转换为文本共27个字符，特别值得注意的是人类（很可能是）文本“ asmodat”（</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/0a/gd/hj0agdeqdmzzwzyob5skbrnr8rq.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图8. USGFDG = 7）。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google会再次帮助我们。简短搜索后，我们在GitHub上找到了一个有趣的项目-Folder Locker，它是用.Net编写的，并使用了Gita上另一个帐户的'asmodat'库。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/zz/qz/pnzzqzct6wwxs6gks6rwwjgrthk.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 9. Folder Locker界面。确保检查恶意软件。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
该实用程序是Windows 7及更高版本的加密器，它是分布式开放源代码。加密时，使用后续解密所需的密码。使您可以处理单个文件以及整个目录。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
她的库在CBC模式下使用对称Rijndael加密算法。值得注意的是，与AES标准相比，选择的块大小等于256位。在后者中，大小限制为128位。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的密钥是根据PBKDF2标准形成的。</font><font style="vertical-align: inherit;">在这种情况下，该实用程序中输入的行的密码为SHA-256。</font><font style="vertical-align: inherit;">剩下的只是找到这一行来形成解密密钥。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好了，回到我们已经解码的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass.key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">还记得那条带有一组数字和文字“ asmodat”的行吗？</font><font style="vertical-align: inherit;">我们尝试使用字符串的前20个字节作为Folder Locker的密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
看，行得通！</font><font style="vertical-align: inherit;">代码字出现了，一切都被完美地解密了。</font><font style="vertical-align: inherit;">从密码字符来看，这是ASCII中特定单词的十六进制表示。</font><font style="vertical-align: inherit;">让我们尝试以文本形式显示代码字。</font><font style="vertical-align: inherit;">我们得到了“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影子狼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”。</font><font style="vertical-align: inherit;">已经感觉到巨人症的症状了吗？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们再来看一下受影响文件的结构，现在知道了锁柜的机制：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">02 00 00 00-名称加密模式；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58 00 00 00-以base64加密和编码的文件名的长度；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40 00 00 00-传输标题的大小。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
加密名称本身和传输的标题分别以红色和黄色突出显示。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/4x/cn/lc4xcnocaus9bh9e3hgezu9_pka.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">10.加密的名称以红色突出显示，传输的标题为黄色。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，以十六进制表示形式比较加密和解密的名称。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解密数据的结构：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">78 B9 B8 2E-实用程序创建的垃圾（4个字节）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">000 00 00-解密名称的长度（12个字节）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来是实际的文件名，并使用零填充到所需的块长度（填充）。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/tt/ad/kj/ttadkjqsidbzxibbzfghqp60eee.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">11. IMG_4114看起来好多了。</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三，</font><font style="vertical-align: inherit;">结论与结论</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回到开始。我们不知道Wulfric.Ransomware的作者受到什么指导以及他追求的目的是什么。当然，对于普通用户而言，即使是这样的加密器，其结果也似乎是一场巨大的灾难。文件无法打开。所有名称都消失了。而不是通常的图片-屏幕上的狼。他们让我读到了有关比特币的信息。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
没错，这次以“可怕的编码器”为幌子被掩盖了，这样愚蠢而愚蠢的勒索企图，攻击者使用现成的程序并将密钥留在犯罪现场。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
说到按键。我们没有恶意脚本或木马来了解</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pass.key的起源</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-在受感染的PC上显示文件的机制仍然未知。</font><font style="vertical-align: inherit;">但是，我记得在他的笔记中，作者提到了密码的唯一性。</font><font style="vertical-align: inherit;">因此，用于解密的代码字与“影子狼”用户名是唯一的一样独特：) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，“影子狼”为什么以及为什么呢？</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN486890/index.html">自我发展：我如何不坐在两把椅子上而发现第三把椅子</a></li>
<li><a href="../zh-CN486892/index.html">联系人选择器API，或如何与浏览器共享联系人</a></li>
<li><a href="../zh-CN486896/index.html">MAG250的UID和Stalker授权</a></li>
<li><a href="../zh-CN486902/index.html">Swift 5.1中面向协议的编程</a></li>
<li><a href="../zh-CN486904/index.html">向开发人员显示SonarQube中源代码质量控制的状态</a></li>
<li><a href="../zh-CN486912/index.html">Lowkiq。我们为什么要这样做？</a></li>
<li><a href="../zh-CN486914/index.html">8. Fortinet入门v6.0。与用户合作</a></li>
<li><a href="../zh-CN486918/index.html">Emacs-6个生产力技巧</a></li>
<li><a href="../zh-CN486920/index.html">如何制作应用程序分步指南（如果您的项目在Angular上）</a></li>
<li><a href="../zh-CN486922/index.html">Raiffeisenbank的Scrum社区聚会</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>