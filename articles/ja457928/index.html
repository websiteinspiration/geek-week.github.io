<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>↔️ 🧘 🎅🏻 2つの画像を比較するための深いランキング 👏🏽 😛 📉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブル！Akarsh Zingadeによる記事「ディープランキングを使用した画像の類似性」の翻訳を紹介します。
 
 ディープランキングアルゴリズム
 「2つの画像の類似性」という概念が導入されていなかったので、少なくとも記事の枠組みの中でこの概念を紹介しましょう。
 
 2つの画像の類...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>2つの画像を比較するための深いランキング</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457928/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、ハブル！</font><font style="vertical-align: inherit;">Akarsh Zingadeによる</font><font style="vertical-align: inherit;">記事</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ディープランキングを使用した画像の類似性」の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳を</font><font style="vertical-align: inherit;">紹介します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディープランキングアルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの画像の類似性</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」という概念が</font><font style="vertical-align: inherit;">導入されていなかったので、少なくとも記事の枠組みの中でこの概念を紹介しましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの画像の類似性は、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定の基準に従って2つの画像を比較した結果です。</font><font style="vertical-align: inherit;">その量的尺度は、2つの画像の強度図間の類似度を決定します。</font><font style="vertical-align: inherit;">類似性の尺度を使用して、画像を表すいくつかの特徴が比較されます。</font><font style="vertical-align: inherit;">類似性の尺度として、ハミング距離、ユークリッド距離、マンハッタン距離など。</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディープランキング</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -画像のきめの細かい類似性を調査し、トリプレットのセットを使用して細かく分割された画像の類似性比を特徴付けます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリプレットとは何ですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トリプレットには、リクエスト画像、ポジティブ画像とネガティブ画像が含まれています。</font><font style="vertical-align: inherit;">ポジティブイメージがネガティブではなくリクエストイメージに近い場合。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリプレットのセットの例：</font></font></b><br>
<br>
<img src="https://cdn-images-1.medium.com/max/1000/0*vw4M7uZ5exyLZfLv." alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
1行目、2行目、3行目は、リクエストのイメージに対応しています。</font><font style="vertical-align: inherit;">2行目（ポジティブイメージ）は、3行目（ネガティブイメージ）よりもリクエストイメージに似ています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディープランキングネットワークアーキテクチャ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークは、トリプレットサンプリング、ConvNet、ランキングレイヤーの3つの部分で構成されています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークは、画像のトリプレットを入力として受け入れます。</font><font style="vertical-align: inherit;">1つの画像トリプレットにリクエスト画像が含まれています</font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1">p_i</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポジティブイメージ </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>+</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2B" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-2"> p_i^+ </script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして否定的なイメージ </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>&amp;#x2212;</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2212" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-3">p_i^-</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3つの同一のディープニューラルネットワークに個別に送信されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最上位のランク付けレイヤー-三重項損失関数を評価します。このエラーは、損失関数を最小限に抑えるために、下位層で修正されます。</font></font><br>
<img src="https://cdn-images-1.medium.com/max/1000/0*ICR1FjUFC8xHXoh1." alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、中間層を詳しく見てみましょう</font></font><br>
<br>
<img src="https://cdn-images-1.medium.com/max/1000/0*tOd5HC3R-kFqobpM." alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。ConvNetは任意のディープニューラルネットワークにすることができます（この記事では、畳み込みニューラルネットワークVGG16の実装の1つについて説明します）。 ConvNetには、たたみ込み層、最大プール層、ローカル正規化層、完全に接続された層が含まれています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の2つの部分は、サンプリングレートを下げて画像を受け取り、畳み込みと最大プーリングの段階を実行します。次に、3つの部分の正規化段階が行われ、最後に線形層と組み合わされて、その後の正規化が行われます。</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三重項形成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トリプレットファイルを作成するには、いくつかの方法があります。たとえば、専門家の評価を使用します。</font><font style="vertical-align: inherit;">ただし、この記事では次のアルゴリズムを使用します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> クラス内の各画像はリクエスト画像を形成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエスト画像を除く各画像は、ポジティブ画像を形成します。</font><font style="vertical-align: inherit;">ただし、リクエスト画像ごとにポジティブ画像の数を制限できます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ネガティブ画像は、リクエスト画像クラスではないクラスからランダムに選択されます</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三重項損失関数</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目標は、最も類似した画像に短い距離を割り当て、別の画像に大きな距離を割り当てる関数をトレーニングすることです。</font><font style="vertical-align: inherit;">これは、のように表すことができる：</font></font><br>
<img src="https://cdn-images-1.medium.com/max/1000/0*kC_DghyAeP7ulsGL." alt="画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Lは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリプレットに対する損失係数であり、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像の二対の距離との間のギャップの係数であります：（</font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">p_i</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>+</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2B" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-5">p_i^+</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）と（</font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">p_i</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>&amp;#x2212;</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2212" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-7">p_i^-</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像をベクトルで表示する埋め込み関数、</font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">p_i</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> リクエストのイメージですが、 </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>+</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2B" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-9">p_i^+</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ポジティブなイメージです </font></font><math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>p</mi><mi>i</mi><mo>&amp;#x2212;</mo></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.77ex" height="3.009ex" viewBox="-38.5 -916.9 1192.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMAIN-2212" x="712" y="570"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/457928/&amp;usg=ALkJrhjSu1OShYo30-96ZQlD8hAaK1UJMA#MJMATHI-69" x="712" y="-430"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-10">p_i^-</script></math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は負のイメージであり、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は2つのユークリッド点間のユークリッド距離です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディープランキングアルゴリズムの実装</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerasによる実装。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クエリ、ポジティブおよびネガティブイメージには、3つの並列ネットワークが使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実装には3つの主要な部分があります。これらは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3つの並列マルチスケールニューラルネットワークの実装</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失関数の実装</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリプレット生成</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つの並列ディープネットワークを学習すると、多くのメモリリソースが消費されます。リクエスト画像、ポジティブ画像とネガティブ画像を受け取る3つの並列ディープネットワークの代わりに、これらの画像は、ニューラルネットワークの入力で1つのディープニューラルネットワークに順次供給されます。損失層に転送されたテンソルは、各行に画像の添付ファイルを含みます。各行は、パケットの各入力画像に対応しています。リクエスト画像、ポジ画像、ネガ画像が順次送信されるため、1行目がリクエスト画像、2行目がポジ画像、3行目がネガ画像となり、パケットの最後まで繰り返されます。したがって、ランキングレイヤーはすべての画像の埋め込みを受け取ります。その後、損失関数が計算されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランキングレイヤーを実装するには、独自の損失関数を記述する必要があります。これは、リクエスト画像とポジティブ画像間のユークリッド距離、およびリクエスト画像とネガティブ画像間のユークリッド距離を計算します。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失計算機能の実装</font></font></b><div class="spoiler_text"><pre><code class="python hljs">_EPSILON = K.epsilon()
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_loss_tensor</span>(<span class="hljs-params">y_true, y_pred</span>):</span>
    y_pred = K.clip(y_pred, _EPSILON, <span class="hljs-number">1.0</span>-_EPSILON)<font></font>
    loss =  tf.convert_to_tensor(<span class="hljs-number">0</span>,dtype=tf.float32) <span class="hljs-comment"># initialise the loss variable to zero</span>
    g = tf.constant(<span class="hljs-number">1.0</span>, shape=[<span class="hljs-number">1</span>], dtype=tf.float32) <span class="hljs-comment"># set the value for constant 'g'</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,batch_size,<span class="hljs-number">3</span>):
        <span class="hljs-keyword">try</span>:<font></font>
            q_embedding = y_pred[i+<span class="hljs-number">0</span>] <span class="hljs-comment"># procure the embedding for query image</span>
            p_embedding =  y_pred[i+<span class="hljs-number">1</span>] <span class="hljs-comment"># procure the embedding for positive image</span>
            n_embedding = y_pred[i+<span class="hljs-number">2</span>] <span class="hljs-comment"># procure the embedding for negative image</span>
            D_q_p =  K.sqrt(K.sum((q_embedding - p_embedding)**<span class="hljs-number">2</span>)) <span class="hljs-comment"># calculate the euclidean distance between query image and positive image</span>
            D_q_n = K.sqrt(K.sum((q_embedding - n_embedding)**<span class="hljs-number">2</span>)) <span class="hljs-comment"># calculate the euclidean distance between query image and negative image</span>
            loss = (loss + g + D_q_p - D_q_n ) <span class="hljs-comment"># accumulate the loss for each triplet           </span>
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">continue</span>
    loss = loss/(batch_size/<span class="hljs-number">3</span>) <span class="hljs-comment"># Average out the loss </span>
    zero = tf.constant(<span class="hljs-number">0.0</span>, shape=[<span class="hljs-number">1</span>], dtype=tf.float32)
    <span class="hljs-keyword">return</span> tf.maximum(loss,zero)</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パケットサイズは常に3の倍数である必要があります。トリプレットには3つのイメージが含まれ、トリプレットイメージは順次送信されます（各イメージをディープニューラルネットワークに順次送信します）</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。残りのコードはここにあります</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></b><div class="spoiler_text">[1] Object Recognition from Local Scale-Invariant Features- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.cs.ubc.ca/~lowe/papers/iccv99.pdf</a><br>
<br>
[2] Histograms of Oriented Gradients for Human Detection- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">courses.engr.illinois.edu/ece420/fa2017/hog_for_human_detection.pdf</a><br>
<br>
[3] Learning Fine-grained Image Similarity with Deep Ranking- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">static.googleusercontent.com/media/research.google.com/en//pubs/archive/42945.pdf</a><br>
<br>
[4] ImageNet Classification with Deep Convolutional Neural Networks- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf</a><br>
<br>
[5] Dropout: A Simple Way to Prevent Neural Networks from Overfitting- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf</a><br>
<br>
[6] ImageNet: A Large-Scale Hierarchical Image Database- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.image-net.org/papers/imagenet_cvpr09.pdf</a><br>
<br>
[7] Fast Multiresolution Image Querying- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">grail.cs.washington.edu/projects/query/mrquery.pdf</a><br>
<br>
[8] Large-Scale Image Retrieval with Compressed Fisher Vectors- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.401.9140&amp;rep=rep1&amp;type=pdf</a><br>
<br>
[9] Beyond Bags of Features: Spatial Pyramid Matching for Recognizing Natural Scene Categories- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ieeexplore.ieee.org/document/1641019</a><br>
<br>
[10] Improved Consistent Sampling, Weighted Minhash and L1 Sketching- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">static.googleusercontent.com/media/research.google.com/en//pubs/archive/36928.pdf</a><br>
<br>
[11] Large scale online learning of image similarity through ranking- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">jmlr.csail.mit.edu/papers/volume11/chechik10a/chechik10a.pdf</a><br>
<br>
[12] Learning Fine-grained Image Similarity with Deep Ranking- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">users.eecs.northwestern.edu/~jwa368/pdfs/deep_ranking.pdf</a><br>
<br>
[13] Image Similarity using Deep Ranking- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">medium.com/@akarshzingade/image-similarity-using-deep-ranking-c1bd83855978</a><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja457906/index.html">医師は、近い将来、ワクチン製造装置が家庭や薬局に登場すると信じています</a></li>
<li><a href="../ja457910/index.html">WebFPGA-ブラウザでのVerilog開発</a></li>
<li><a href="../ja457916/index.html">CCAの能力におけるネットワークモジュールのWorldSkillsタスクのソリューション。パート2-基本設定</a></li>
<li><a href="../ja457920/index.html">ジェットワールド：会議Joker 2018のレポートへの無料アクセス+トップ10のレビュー</a></li>
<li><a href="../ja457926/index.html">アジャイル認定の比較、パート1-ICAgile、Scrum.org、ScrumAllianceおよびPMI</a></li>
<li><a href="../ja457930/index.html">Pythonで静的に安全な動的型付け</a></li>
<li><a href="../ja457932/index.html">Positive Hack Days 9でのIDSバイパスコンテストの分析</a></li>
<li><a href="../ja457936/index.html">ロシアでの最初のZabbixカンファレンスにあなたを招待します</a></li>
<li><a href="../ja457940/index.html">相手方をのぞく方法</a></li>
<li><a href="../ja457942/index.html">Pythonの最適化について学んだこと</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>