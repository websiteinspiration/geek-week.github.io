<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíë üë©üèª‚Äçüî¨ üìÇ De la vida con Kubernetes: c√≥mo eliminamos DBMS (y no solo) de entornos de revisi√≥n a est√°ticos üê£ ‚öõÔ∏è üë©üèº‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota : este art√≠culo no pretende ser una mejor pr√°ctica. Describe la experiencia de una implementaci√≥n espec√≠fica de una tarea de infraestructura en t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>De la vida con Kubernetes: c√≥mo eliminamos DBMS (y no solo) de entornos de revisi√≥n a est√°ticos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/501424/"><img src="https://habrastorage.org/webt/ae/yu/zw/aeyuzw9pz0k6d0pbc0g86pxkfd0.png"><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : este art√≠culo no pretende ser una mejor pr√°ctica. </font><font style="vertical-align: inherit;">Describe la experiencia de una implementaci√≥n espec√≠fica de una tarea de infraestructura en t√©rminos de uso de Kubernetes y Helm, que puede ser √∫til para resolver problemas relacionados. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El uso de entornos de revisi√≥n en CI / CD puede ser muy √∫til, tanto para desarrolladores como para ingenieros de sistemas. </font><font style="vertical-align: inherit;">Primero sincronicemos las ideas generales sobre ellos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Los entornos de revisi√≥n se pueden crear desde ramas separadas en repositorios Git definidos por los desarrolladores (las denominadas ramas de caracter√≠sticas).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pueden tener instancias DBMS separadas, procesadores de cola, servicios de almacenamiento en cach√©, etc. </font><font style="vertical-align: inherit;">- en general, todo para la reproducci√≥n completa del entorno de producci√≥n.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permiten el desarrollo paralelo, acelerando significativamente el lanzamiento de nuevas caracter√≠sticas en la aplicaci√≥n. </font><font style="vertical-align: inherit;">Al mismo tiempo, se pueden requerir docenas de tales entornos todos los d√≠as, por lo que la velocidad de su creaci√≥n es cr√≠tica.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la intersecci√≥n del segundo y el tercer punto, a menudo surgen dificultades: dado que la infraestructura es muy diferente, sus componentes se pueden implementar durante mucho tiempo. </font><font style="vertical-align: inherit;">Este tiempo empleado, por ejemplo, incluye restaurar la base de datos desde una copia de seguridad ya preparada *. </font><font style="vertical-align: inherit;">El art√≠culo trata sobre la forma fascinante en la que una vez fuimos para resolver este problema.</font></font><a name="habracut"></a><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Por cierto, espec√≠ficamente sobre volcados de bases de datos grandes en este contexto, ya escribimos en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">material sobre la aceleraci√≥n de la base de datos de bootstrap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El problema y la forma de resolverlo.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En uno de los proyectos, se nos asign√≥ la tarea de "crear un √∫nico punto de entrada para desarrolladores e ingenieros de control de calidad". </font><font style="vertical-align: inherit;">Esta formulaci√≥n oculta t√©cnicamente lo siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para simplificar el trabajo de los ingenieros de control de calidad y algunos otros empleados, elimine todas las bases de datos (y los correspondientes vhosts) utilizados en la revisi√≥n, en un entorno separado, est√°tico. </font><font style="vertical-align: inherit;">Por las razones que prevalecen en el proyecto, esta forma de interactuar con ellos fue √≥ptima.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reduzca el tiempo que lleva crear un entorno de revisi√≥n. </font><font style="vertical-align: inherit;">Todo el proceso de su creaci√≥n desde cero est√° impl√≠cito, es decir </font><font style="vertical-align: inherit;">incluyendo clonaci√≥n de bases de datos, migraciones, etc.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde el punto de vista de la implementaci√≥n, el problema principal se reduce a garantizar la idempotencia al crear y eliminar entornos de revisi√≥n. Para lograr esto, cambiamos el mecanismo para crear entornos de revisi√≥n migrando primero los servicios </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL, MongoDB y RabbitMQ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a un entorno est√°tico. Est√°tico se refiere a un entorno "permanente" que no se crear√° a petici√≥n del usuario (como es el caso de los entornos de revisi√≥n). </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Importante!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El enfoque con un entorno est√°tico est√° </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lejos de ser ideal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; para conocer sus deficiencias espec√≠ficas, consulte el final del art√≠culo. Sin embargo, compartimos esta experiencia en detalle, ya que puede ser m√°s o menos aplicable en otras tareas, y al mismo tiempo sirve como argumento cuando se discuten problemas de dise√±o de infraestructura.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, la secuencia de acciones en la implementaci√≥n:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al crear un entorno de revisi√≥n, lo siguiente deber√≠a suceder una vez: la creaci√≥n de bases de datos en dos DBMS (MongoDB y PostgreSQL), la restauraci√≥n de bases de datos desde una copia de seguridad / plantilla y la creaci√≥n de vhost en RabbitMQ. </font><font style="vertical-align: inherit;">Esto requerir√° una forma conveniente de cargar los volcados actuales. </font><font style="vertical-align: inherit;">(Si antes ten√≠a entornos de revisi√≥n, lo m√°s probable es que ya tenga una soluci√≥n preparada para esto).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Despu√©s de completar el entorno de revisi√≥n, debe eliminar la base de datos y el host virtual en RabbitMQ.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, la infraestructura opera dentro del marco de Kubernetes (usando Helm). </font><font style="vertical-align: inherit;">Por lo tanto, para la implementaci√≥n de las tareas anteriores, los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganchos Helm fueron</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> excelentes </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se pueden realizar tanto antes de la creaci√≥n de todos los dem√°s componentes en la versi√≥n de Helm como despu√©s de su eliminaci√≥n. </font><font style="vertical-align: inherit;">Por lo tanto:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para la tarea de inicializaci√≥n, usaremos un enlace </font></font><code>pre-install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para iniciarlo antes de crear todos los recursos en el lanzamiento;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para la tarea de eliminaci√≥n, un gancho </font></font><code>post-delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos a los detalles de implementaci√≥n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementaci√≥n pr√°ctica</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n original, este proyecto utilizaba solo un trabajo, que constaba de tres contenedores. </font><font style="vertical-align: inherit;">Por supuesto, esto no es del todo conveniente, ya que el resultado es un gran manifiesto que es curiosamente dif√≠cil de leer. </font><font style="vertical-align: inherit;">Por lo tanto, lo dividimos en tres peque√±os trabajos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La siguiente es una lista de PostgreSQL, y los otros dos (MongoDB y RabbitMQ) son id√©nticos en estructura de manifiesto:</font></font><br>
<br>
<pre><code class="plaintext hljs">{{- if .Values.global.review }}<font></font>
---<font></font>
apiVersion: batch/v1<font></font>
kind: Job<font></font>
metadata:<font></font>
  name: db-create-postgres-database<font></font>
  annotations:<font></font>
    "helm.sh/hook": "pre-install"<font></font>
    "helm.sh/hook-weight": "5"<font></font>
spec:<font></font>
  template:<font></font>
    metadata:<font></font>
      name: init-db-postgres<font></font>
    spec:<font></font>
      volumes:<font></font>
      - name: postgres-scripts<font></font>
        configMap:<font></font>
          defaultMode: 0755<font></font>
          name: postgresql-configmap<font></font>
      containers:<font></font>
      - name: init-postgres-database<font></font>
        image: private-registry/postgres <font></font>
        command: ["/docker-entrypoint-initdb.d/01-review-load-dump.sh"]<font></font>
        volumeMounts:<font></font>
        - name: postgres-scripts<font></font>
          mountPath: /docker-entrypoint-initdb.d/01-review-load-dump.sh<font></font>
          subPath: review-load-dump.sh<font></font>
        env:<font></font>
{{- include "postgres_env" . | indent 8 }}<font></font>
      restartPolicy: Never<font></font>
{{- end }}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comentarios sobre el contenido del manifiesto:</font></font><br>
<br>
<ol>
<li> Job    review-.  review   CI/CD       Helm- (. <code>if</code>  <code>.Values.global.review</code>    ).</li>
<li>  Job      ‚Äî , ConfigMap.       ,  ,       .       ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>hook-weight</code></a>.</li>
<li>      cURL   ,        PostgreSQL,       .</li>
<li>      PostgreSQL    :     ,     shell- .</li>
</ol><br>
<h3>PostgreSQL</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo m√°s interesante est√° en el script de shell ( </font></font><code>review-load-dump.sh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">ya mencionado en el listado </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">¬øCu√°les son las opciones generales para restaurar una base de datos en PostgreSQL?</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recuperaci√≥n "est√°ndar" de la copia de seguridad;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuperaci√≥n utilizando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plantillas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, la diferencia entre los dos enfoques est√° principalmente en la velocidad de crear una base de datos para el nuevo entorno. </font><font style="vertical-align: inherit;">En el primero, cargamos el volcado de la base de datos y lo restauramos </font></font><code>pg_restore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Y con nosotros esto sucede m√°s lentamente que el segundo m√©todo, por lo que se hizo la elecci√≥n correspondiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando la segunda opci√≥n ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recuperaci√≥n con plantillas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) puede clonar la base de datos a nivel f√≠sico sin enviarle datos de forma remota desde el contenedor en otro entorno; esto reduce el tiempo de recuperaci√≥n. </font><font style="vertical-align: inherit;">Sin embargo, hay una limitaci√≥n: no puede clonar una base de datos a la que permanecen las conexiones activas. </font><font style="vertical-align: inherit;">Dado que usamos stage como el entorno est√°tico (y no como un entorno de revisi√≥n separado), necesitamos crear una segunda base de datos y convertirla en una plantilla, actualiz√°ndola diariamente (por ejemplo, en la ma√±ana). </font><font style="vertical-align: inherit;">Se prepar√≥ un peque√±o CronJob para esto:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: batch/v1beta1<font></font>
kind: CronJob<font></font>
metadata:<font></font>
  name: update-postgres-template<font></font>
spec:<font></font>
  schedule: "50 4 * * *"<font></font>
  concurrencyPolicy: Forbid<font></font>
  successfulJobsHistoryLimit: 3<font></font>
  failedJobsHistoryLimit: 3<font></font>
  startingDeadlineSeconds: 600<font></font>
  jobTemplate:<font></font>
    spec:<font></font>
      template:<font></font>
        spec:<font></font>
          restartPolicy: Never<font></font>
          imagePullSecrets:<font></font>
          - name: registrysecret<font></font>
          volumes:<font></font>
          - name: postgres-scripts<font></font>
            configMap:<font></font>
              defaultMode: 0755<font></font>
              name: postgresql-configmap-update-cron<font></font>
          containers:<font></font>
          - name: cron<font></font>
            command: ["/docker-entrypoint-initdb.d/update-postgres-template.sh"]<font></font>
          image: private-registry/postgres <font></font>
            volumeMounts:<font></font>
            - name: postgres-scripts<font></font>
              mountPath: /docker-entrypoint-initdb.d/update-postgres-template.sh<font></font>
              subPath: update-postgres-template.sh<font></font>
            env:<font></font>
{{- include "postgres_env" . | indent 8 }}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El manifiesto completo de ConfigMap que contiene el script probablemente no tenga mucho sentido (informe en los comentarios si este no es el caso). </font><font style="vertical-align: inherit;">En cambio, dar√© lo m√°s importante: un script bash:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#!/bin/bash -x</span><font></font>
<font></font>
CREDENTIALS=<span class="hljs-string">"postgresql://<span class="hljs-variable">${POSTGRES_USER}</span>:<span class="hljs-variable">${POSTGRES_PASSWORD}</span>@<span class="hljs-variable">${POSTGRES_HOST}</span>/postgres"</span><font></font>
<font></font>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"REVOKE CONNECT ON DATABASE <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span> FROM public"</span>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE pg_stat_activity.datname = '<span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span>'"</span><font></font>
<font></font>
curl --fail -vsL <span class="hljs-variable">${HOST_FORDEV}</span>/latest_<span class="hljs-variable">${POSTGRES_DB_STAGE}</span>.psql -o /tmp/<span class="hljs-variable">${POSTGRES_DB}</span>.psql<font></font>
<font></font>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"ALTER DATABASE <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span> WITH is_template false allow_connections true;"</span>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"DROP DATABASE <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span>;"</span> || <span class="hljs-literal">true</span>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"CREATE DATABASE <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span>;"</span> || <span class="hljs-literal">true</span>
pg_restore -U <span class="hljs-variable">${POSTGRES_USER}</span> -h <span class="hljs-variable">${POSTGRES_HOST}</span> -w -j 4 -d <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span> /tmp/<span class="hljs-variable">${POSTGRES_DB}</span>.psql<font></font>
<font></font>
psql -d <span class="hljs-string">"<span class="hljs-variable">${CREDENTIALS}</span>"</span> -w -c <span class="hljs-string">"ALTER DATABASE <span class="hljs-variable">${POSTGRES_DB_TEMPLATE}</span> WITH is_template true allow_connections false;"</span><font></font>
<font></font>
rm -v /tmp/<span class="hljs-variable">${POSTGRES_DB}</span>.psql</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede restaurar varias bases de datos a la vez desde una plantilla sin ning√∫n conflicto. </font><font style="vertical-align: inherit;">Lo principal es que las conexiones a la base de datos deber√≠an estar prohibidas, y la base de datos deber√≠a ser una plantilla. </font><font style="vertical-align: inherit;">Esto se hace en el pen√∫ltimo paso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El manifiesto que contiene el script de shell para restaurar la base de datos result√≥ as√≠:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: postgresql-configmap<font></font>
  annotations:<font></font>
    "helm.sh/hook": "pre-install"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded<font></font>
data:<font></font>
  review-load-dump.sh: |<font></font>
    #!/bin/bash -x<font></font>
    <font></font>
 <font></font>
 <font></font>
    CREDENTIALS="postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}/postgres"<font></font>
<font></font>
    if [ "$( psql -d "${CREDENTIALS}" -tAc "SELECT CASE WHEN EXISTS (SELECT * FROM pg_stat_activity WHERE datname = '${POSTGRES_DB}' LIMIT 1) THEN 1 ELSE 0 END;" )" = '1' ]<font></font>
      then<font></font>
          echo "Open connections has been found in ${POSTGRES_DB} database, will drop them"<font></font>
          psql -d "${CREDENTIALS}" -c "SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE pg_stat_activity.datname = '${POSTGRES_DB}' -- AND pid &lt;&gt; pg_backend_pid();"<font></font>
      else<font></font>
          echo "No open connections has been found ${POSTGRES_DB} database, skipping this stage"<font></font>
    fi<font></font>
<font></font>
    psql -d "${CREDENTIALS}" -c "DROP DATABASE ${POSTGRES_DB}"<font></font>
<font></font>
    if [ "$( psql -d "${CREDENTIALS}" -tAc "SELECT 1 FROM pg_database WHERE datname='${POSTGRES_DB}'" )" = '1' ]<font></font>
      then<font></font>
          echo "Database ${POSTGRES_DB} still exists, delete review job failed"<font></font>
          exit 1<font></font>
      else<font></font>
          echo "Database ${POSTGRES_DB} does not exist, skipping"<font></font>
    fi<font></font>
<font></font>
<font></font>
    psql ${CREDENTIALS} -d postgres -c 'CREATE DATABASE ${POSTGRES_DB} TEMPLATE "loot-stage-copy"'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aparentemente, est√°n involucrados aqu√≠ </font></font><code>hook-delete-policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Los detalles sobre la aplicaci√≥n de estas pol√≠ticas est√°n escritos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En el manifiesto dado usamos los </font></font><code>before-hook-creation,hook-succeeded</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que permiten cumplir los siguientes requisitos: eliminar el objeto anterior antes de crear un nuevo enlace y eliminar solo cuando el enlace fue exitoso. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eliminaremos la base de datos en este mapa de configuraci√≥n:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: postgresql-configmap-on-delete<font></font>
  annotations:<font></font>
    "helm.sh/hook": "post-delete, pre-delete"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation<font></font>
data:<font></font>
  review-delete-db.sh: |<font></font>
    #!/bin/bash -e<font></font>
<font></font>
    CREDENTIALS="postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}/postgres"<font></font>
<font></font>
    psql -d "${CREDENTIALS}" -w postgres -c "DROP DATABASE ${POSTGRES_DB}"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aunque lo trasladamos a un ConfigMap separado, se puede colocar en un ConfigMap normal </font></font><code>command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Despu√©s de todo, se puede hacer una l√≠nea sin complicar la apariencia del manifiesto en s√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la opci√≥n con las plantillas de PostgreSQL por alguna raz√≥n no se ajusta o no se ajusta, puede volver a la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ruta de recuperaci√≥n "est√°ndar"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mencionada anteriormente </font><b><font style="vertical-align: inherit;">utilizando la copia de seguridad</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El algoritmo ser√° trivial:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Todas las noches, se realiza una copia de seguridad de la base de datos para que se pueda descargar desde la red local del cl√∫ster.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En el momento de la creaci√≥n del entorno de revisi√≥n, la base de datos se carga y se restaura desde el volcado.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cuando se despliega el volcado, se realizan todas las dem√°s acciones.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, el script de recuperaci√≥n se convertir√° aproximadamente de la siguiente manera:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: postgresql-configmap<font></font>
  annotations:<font></font>
    "helm.sh/hook": "pre-install"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded<font></font>
data:<font></font>
  review-load-dump.sh: |<font></font>
    #!/bin/bash -x<font></font>
<font></font>
    CREDENTIALS="postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}/postgres"<font></font>
    psql -d "${CREDENTIALS}" -w -c "DROP DATABASE ${POSTGRES_DB}" || true<font></font>
    psql -d "${CREDENTIALS}" -w -c "CREATE DATABASE ${POSTGRES_DB}"<font></font>
<font></font>
    curl --fail -vsL ${HOST_FORDEV}/latest_${POSTGRES_DB_STAGE}.psql -o /tmp/${POSTGRES_DB}.psql<font></font>
<font></font>
    psql psql -d "${CREDENTIALS}" -w -c "CREATE EXTENSION ip4r;"<font></font>
    pg_restore -U ${POSTGRES_USER} -h ${POSTGRES_HOST} -w -j 4 -d ${POSTGRES_DB} /tmp/${POSTGRES_DB}.psql<font></font>
    rm -v /tmp/${POSTGRES_DB}.psql</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El procedimiento corresponde a lo que ya se ha descrito anteriormente. El √∫nico cambio es la eliminaci√≥n del archivo psql despu√©s de que se haya agregado todo el trabajo. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : tanto en el script de recuperaci√≥n como en el script de desinstalaci√≥n, la base de datos se elimina cada vez. Esto se hace para evitar posibles conflictos durante la recreaci√≥n de la revisi√≥n: debe asegurarse de que la base de datos se elimine realmente. Adem√°s, este problema puede resolverse potencialmente agregando un indicador </font></font><code>--clean</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la utilidad </font></font><code>pg_restore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero tenga cuidado: este indicador borra los datos de solo aquellos elementos que est√°n en el volcado, por lo que en nuestro caso esta opci√≥n no funciona.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtuvimos un mecanismo de trabajo que requiere mejoras adicionales (hasta reemplazar los scripts de Bash con un c√≥digo m√°s elegante). </font><font style="vertical-align: inherit;">Los dejaremos fuera del alcance del art√≠culo (aunque los comentarios sobre el tema, por supuesto, son bienvenidos).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mongodb</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente componente es MongoDB. </font><font style="vertical-align: inherit;">La principal dificultad es que para este DBMS, la opci√≥n de copiar la base de datos (como en PostgreSQL) existe de manera bastante nominal, porque:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âl est√° en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un estado desaprobado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seg√∫n los resultados de nuestras pruebas, no encontramos una gran diferencia en el tiempo de recuperaci√≥n de la base de datos en comparaci√≥n con el habitual </font></font><code>mongo_restore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sin embargo, observo que las pruebas se llevaron a cabo como parte de un proyecto; en su caso, los resultados pueden ser completamente diferentes.</font></font></i></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resulta que en el caso de un gran volumen de base de datos, puede surgir un problema grave: ahorramos tiempo en la restauraci√≥n de la base de datos en PgSQL, pero al mismo tiempo restauramos el volcado en Mongo durante mucho tiempo. </font><font style="vertical-align: inherit;">Al momento de escribir, y dentro del marco de la infraestructura existente, vimos tres formas (por cierto, se pueden combinar):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La recuperaci√≥n puede llevar mucho tiempo, por ejemplo, si su DBMS est√° ubicado en un sistema de archivos de red (para casos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con entorno de producci√≥n). </font><font style="vertical-align: inherit;">Luego, simplemente puede transferir el DBMS del escenario a un nodo separado y usar el almacenamiento local. </font><font style="vertical-align: inherit;">Como esto no es producci√≥n, la velocidad de crear una revisi√≥n es m√°s cr√≠tica para nosotros.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede llevar cada recuperaci√≥n de trabajo a un pod separado, lo que le permite ejecutar previamente migraciones y otros procesos que dependen del funcionamiento del DBMS. </font><font style="vertical-align: inherit;">As√≠ que ahorramos tiempo al completarlos por adelantado.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A veces puede reducir el tama√±o del volcado eliminando datos antiguos / irrelevantes, hasta el punto de que es suficiente dejar solo la estructura de la base de datos. </font><font style="vertical-align: inherit;">Por supuesto, esto no es para aquellos casos en que se requiere un volcado completo (por ejemplo, para tareas de prueba de control de calidad).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si no necesita crear r√°pidamente entornos de revisi√≥n, puede ignorar todas las dificultades descritas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosotros, al no poder copiar la base de datos de manera similar a PgSQL, iremos por el primer camino, es decir </font><font style="vertical-align: inherit;">recuperaci√≥n est√°ndar de respaldo. </font><font style="vertical-align: inherit;">El algoritmo es el mismo que con PgSQL. </font><font style="vertical-align: inherit;">Esto es f√°cil de ver si nos fijamos en los manifiestos:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: mongodb-scripts-on-delete<font></font>
  annotations:<font></font>
    "helm.sh/hook": "post-delete, pre-delete"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation<font></font>
data:<font></font>
  review-delete-db.sh: |<font></font>
    #!/bin/bash -x<font></font>
<font></font>
    mongo ${MONGODB_NAME} --eval "db.dropDatabase()" --host ${MONGODB_REPLICASET}/${MONGODB_HOST}<font></font>
---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: mongodb-scripts<font></font>
  annotations:<font></font>
    "helm.sh/hook": "pre-install"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded<font></font>
data:<font></font>
  review-load-dump.sh: |<font></font>
    #!/bin/bash -x<font></font>
<font></font>
    curl --fail -vsL ${HOST_FORDEV}/latest_${MONGODB_NAME_STAGE}.gz -o /tmp/${MONGODB_NAME}.gz<font></font>
<font></font>
    mongo ${MONGODB_NAME} --eval "db.dropDatabase()" --host ${MONGODB_REPLICASET}/${MONGODB_HOST}<font></font>
    mongorestore --gzip --nsFrom "${MONGODB_NAME_STAGE}.*" --nsTo "${MONGODB_NAME}.*" --archive=/tmp/${MONGODB_NAME}.gz --host ${MONGODB_REPLICASET}/${MONGODB_HOST}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay un detalle importante aqu√≠. En nuestro caso, MongoDB est√° en el cl√∫ster y debe asegurarse de que la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conexi√≥n siempre le ocurra al nodo primario</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si especifica, por ejemplo, el primer host en el qu√≥rum, luego de un tiempo puede cambiar de Primario a Secundario, lo que evitar√° la creaci√≥n de una base de datos. Por lo tanto, debe conectarse no a un host, sino inmediatamente a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReplicaSet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , enumerando todos los hosts en √©l. Solo por esta raz√≥n, debe hacer MongoDB como StatefulSet para que los nombres de host sean siempre los mismos (sin mencionar que MongoDB es una aplicaci√≥n con estado por naturaleza). En esta opci√≥n, tiene la garant√≠a de conectarse al nodo primario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para MongoDB, tambi√©n eliminamos la base de datos antes de crear la revisi√≥n, esto se hace por las mismas razones que en PostgreSQL.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√öltimo matiz: dado que la base de datos para revisi√≥n est√° en el mismo entorno que la etapa, se requiere un nombre diferente para la base de datos clonada. </font><font style="vertical-align: inherit;">Si el volcado no es un archivo BSON, se producir√° el siguiente error:</font></font><br>
<br>
<pre><code class="plaintext hljs">the --db and --collection args should only be used when restoring from a BSON file. Other uses are deprecated and will not exist in the future; use --nsInclude instead</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, en el ejemplo anterior, </font></font><code>--nsFrom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">se utilizan </font></font><code>--nsTo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No encontramos otros problemas con la recuperaci√≥n. </font><font style="vertical-align: inherit;">Al final, solo agregar√© que la documentaci√≥n de </font></font><code>copyDatabase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB est√° disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en caso de que desee probar esta opci√≥n.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rabbitmq</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La √∫ltima aplicaci√≥n en nuestra lista de requisitos fue RabbitMQ. </font><font style="vertical-align: inherit;">Es simple: necesita crear un nuevo vhost en nombre del usuario con el que se conectar√° la aplicaci√≥n. </font><font style="vertical-align: inherit;">Y luego b√≥rralo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manifiesto para crear y eliminar vhosts:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: rabbitmq-configmap<font></font>
  annotations:<font></font>
    "helm.sh/hook": "pre-install"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded<font></font>
data:<font></font>
  rabbitmq-setup-vhost.sh: |<font></font>
    #!/bin/bash -x<font></font>
<font></font>
    /usr/local/bin/rabbitmqadmin -H ${RABBITMQ_HOST} -u ${RABBITMQ_USER} -p ${RABBITMQ_PASSWORD} declare vhost name=${RABBITMQ_VHOST}<font></font>
---<font></font>
apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: rabbitmq-configmap-on-delete<font></font>
  annotations:<font></font>
    "helm.sh/hook": "post-delete, pre-delete"<font></font>
    "helm.sh/hook-weight": "1"<font></font>
    "helm.sh/hook-delete-policy": before-hook-creation<font></font>
data:<font></font>
  rabbitmq-delete-vhost.sh: |<font></font>
    #!/bin/bash -x<font></font>
<font></font>
    /usr/local/bin/rabbitmqadmin -H ${RABBITMQ_HOST} -u ${RABBITMQ_USER} -p ${RABBITMQ_PASSWORD} delete vhost name=${RABBITMQ_VHOST}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con grandes dificultades en RabbitMQ nosotros (¬øhasta ahora?) No nos hemos encontrado. </font><font style="vertical-align: inherit;">En general, el mismo enfoque puede aplicarse a cualquier otro servicio que no tenga un v√≠nculo cr√≠tico para los datos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desventajas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øPor qu√© esta decisi√≥n no pretende ser "mejores pr√°cticas"?</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resulta un solo punto de falla en la forma de un entorno de escenario.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si una aplicaci√≥n en un entorno de etapa se ejecuta solo en una r√©plica, dependemos a√∫n m√°s del host en el que se ejecuta esta aplicaci√≥n. </font><font style="vertical-align: inherit;">En consecuencia, con un aumento en el n√∫mero de entornos de revisi√≥n, la carga en el nodo aumenta proporcionalmente sin la capacidad de equilibrar esta carga.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No fue posible resolver completamente estos dos problemas, teniendo en cuenta las capacidades de la infraestructura de un proyecto en particular, sin embargo, el da√±o potencial se puede minimizar mediante la agrupaci√≥n (agregando nuevos nodos) y el escalado vertical. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A medida que la aplicaci√≥n se desarrolla y con el aumento en el n√∫mero de desarrolladores, tarde o temprano, la carga en los entornos de revisi√≥n aumenta y se les agregan nuevos requisitos. Es importante que los desarrolladores entreguen los pr√≥ximos cambios en la producci√≥n lo m√°s r√°pido posible, pero para que esto sea posible, necesitamos entornos de revisi√≥n din√°micos que hagan que el desarrollo sea "paralelo". Como resultado, la carga en la infraestructura est√° creciendo y el tiempo para crear tales entornos est√° aumentando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este art√≠culo fue escrito en base a experiencias reales y bastante espec√≠ficas. Solo en casos excepcionales aislamos los servicios en entornos est√°ticos, y aqu√≠ se trataba espec√≠ficamente de √©l. Tal medida necesaria nos permiti√≥ acelerar el desarrollo y la depuraci√≥n de la aplicaci√≥n, gracias a la capacidad de crear r√°pidamente entornos de revisi√≥n desde cero.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando comenzamos a hacer esta tarea, parec√≠a muy simple, pero a medida que trabaj√°bamos, encontramos muchos matices. </font><font style="vertical-align: inherit;">Fueron ellos los que se reunieron en el art√≠culo final: aunque no son universales, pueden servir como ejemplo para la base / inspiraci√≥n de sus propias decisiones sobre entornos de revisi√≥n acelerados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lea tambi√©n en nuestro blog:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consejos y trucos de Kubernetes: acelerar el arranque de grandes bases de datos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migraci√≥n RabbitMQ sin obst√°culos a Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migraci√≥n de MongoDB sin obst√°culos a Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejecutar equipos en el proceso de entregar una nueva versi√≥n de la aplicaci√≥n a Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es501412/index.html">Seguimiento ocular m√≥vil en PyTorch</a></li>
<li><a href="../es501414/index.html">Configuraci√≥n de Debian, Nginx y Gunicorn para un proyecto Django</a></li>
<li><a href="../es501416/index.html">Un poco sobre WebRTC: qu√© usar y el caso de la pr√°ctica</a></li>
<li><a href="../es501418/index.html">Semana 4 Marat√≥n: Motivaci√≥n</a></li>
<li><a href="../es501420/index.html">Shows en l√≠nea de Mitapas y YouTube: JUG Ru Group Stream Week</a></li>
<li><a href="../es501426/index.html">Unison: configuraci√≥n y automatizaci√≥n de la sincronizaci√≥n bidireccional de directorios en dos servidores</a></li>
<li><a href="../es501430/index.html">Gran gu√≠a para el dise√±o y la planificaci√≥n del contenido del sitio web</a></li>
<li><a href="../es501432/index.html">Dos alternativas a JDBC</a></li>
<li><a href="../es501434/index.html">Semana de la seguridad 20: piratear una computadora a trav√©s de Thunderbolt</a></li>
<li><a href="../es501436/index.html">Algoritmo de reconocimiento de n√∫meros en la imagen con baja probabilidad del segundo tipo de error</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>