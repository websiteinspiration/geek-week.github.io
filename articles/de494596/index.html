<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😫 😁 🌒 So erstellen Sie ein Transportmodell für mehrere Agenten 🌴 👨🏼‍🔬 🙆</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! 
 
 Stellen Sie sich vor, wir haben die Aufgabe, eine neue Straße zu bauen. Sie können eine Autobahn mit zwei Fahrspuren in jede Richtung ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>So erstellen Sie ein Transportmodell für mehrere Agenten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494596/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich vor, wir haben die Aufgabe, eine neue Straße zu bauen. Sie können eine Autobahn mit zwei Fahrspuren in jede Richtung bauen, aber was ist, wenn dies nicht ausreicht? Oder im Gegenteil, es stellt sich heraus, dass ein Streifen ausreichen würde, aber für die Umsetzung des Projekts mussten viele Grundstücke gekauft werden? In beiden Fällen ist die Entscheidung unwirksam. Um solche Risiken zu minimieren, wenden sich Transportplaner an die Computermodellierung, um Hilfe zu erhalten. Dieser Artikel ist ein kurzer Exkurs in die Welt der Multi-Agent-Modellierung.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/k0/kj/bqk0kjbb814y7q7twu1uvqk3yf4.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Modell, das eine Kopie des realen Verkehrssystems ist, können Sie den erforderlichen Durchsatz auf jedem Abschnitt der projizierten Straße schätzen, verschiedene Rückverfolgungsoptionen ausprobieren oder beispielsweise die Amortisationszeit eines Projekts schätzen, wenn es sich im Rahmen einer öffentlich-privaten Partnerschaft um eine mautpflichtige Straße handelt. Es können jedoch auch andere wichtige Aufgaben gelöst werden: Wie können optimale öffentliche Verkehrswege organisiert und die potenziellen Einnahmen der Betreiber berechnet werden? Wie kann das Vorhandensein eines Parkplatzmangels in einem bestimmten Gebiet und in vielen anderen Bereichen bewertet werden? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am interessantesten ist, dass jeder im Zeitalter der freien Software ein ähnliches Modell bauen kann! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eines der am häufigsten verwendeten Multi-Agent-Modellierungswerkzeuge ist Open Source.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim (Multi-Agent-Transportsimulation)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MATSim simuliert das Verhalten einzelner Agenten. Ein Agent ist eine Computerdarstellung eines Individuums in der realen Welt. Jeder dieser Agenten hat einen Tagesplan, auf dessen Grundlage er von einer Aktivität zur nächsten wechselt (z. B. Heimarbeitsheim, Heiminstitut-Heimarbeit, Heimarbeitsgeschäft1-Arbeit2-Heim usw.) und erstellt daher die Nachfrage nach Straßeninfrastruktur. Eine schematische Darstellung des Tagesplans sieht ungefähr so ​​aus:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/xt/m_/n6xtm_ps8u0stk6f8doybvsxzq8.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um realistische Pläne von Agenten zu erstellen, die das tatsächliche Verhalten der Menschen während des Tages widerspiegeln, werden die Gesamtzahl der Bewohner der Agenten, ihre Umsiedlung, Arbeitsorte, Studienorte, Standorte von Geschäften, Einkaufszentren, Bahnhöfen und anderen Tätigkeitsorten berücksichtigt. Zur Validierung der Nachfrage wird das Modell auch anhand von Felduntersuchungen kalibriert: Erkennung und Berechnung der Flüsse von Überwachungskameras und Drohnen mithilfe eines neuronalen Netzes oder beispielsweise manuelle Intensitätsmessungen auf Straßen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/t-/ke/0xt-kelsnwf39k3mmu2saye2zky.gif" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der Simulation werden die Agenten über das Netzwerk verteilt und ahmen das realistische Verhalten der Menschen nach: Bei der Umsetzung ihres Plans nehmen Autos einen Platz auf der Straße und auf Parkplätzen ein, Benutzer öffentlicher Verkehrsmittel nehmen im Bus Platz und interagieren miteinander. Wenn viele Agenten jeweils eine Straße auswählen, Staus und Staus entstehen. Alles ist wie in der realen Welt! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Abschluss der Simulation wird die Erfüllung der täglichen Pläne der Agenten bewertet, die als Bewertung bezeichnet werden. Der Agent erwirbt während des Aktivitätsprozesses Versorgungseinheiten und verliert diese während der Bewegung. Dementsprechend verlieren Agenten, die in einen Stau geraten sind, mehr Versorgungseinheiten als Agenten, die sich auf freien Straßen bewegen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach jeder Iteration erstellen einige Agenten ihren Plan auf der Grundlage von Informationen über die Auslastung des Straßennetzes neu, um ihre Leistung zu verbessern: Agenten können die Abfahrtszeit, das Transportmittel oder die Route ändern. </font><font style="vertical-align: inherit;">Die übrigen Agenten halten sich an ihre bisherigen Pläne, die im Programmspeicher gespeichert sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Idealerweise sollte nach der Simulation ein Nash-Gleichgewicht erreicht werden - das heißt, eine Situation, in der kein Agent seine Position verbessern kann, ohne die Position anderer Agenten zu verschlechtern. </font><font style="vertical-align: inherit;">Normalerweise ist dies die Situation, die sich im Laufe der Zeit auf den Straßen der Stadt entwickelt, da die Bewohner die Erfahrungen des Vortages täglich überdenken. </font><font style="vertical-align: inherit;">Hierzu werden im Rahmen eines Szenarios mindestens 200 Iterationen durchgeführt. </font><font style="vertical-align: inherit;">Der gesamte MATSim-Arbeitszyklus sieht ungefähr so ​​aus:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/zv/ds/mrzvds3njmsli5hbkiqvzhnuoju.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von der Theorie zur Praxis! </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um das erste Szenario auszuführen, benötigen wir Intellij IDEA (oder Eclipse) mit Java 1.8 an Bord. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir öffnen die IDE, klonen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das MATSim-Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vom Github und unser erstes Szenario kann ausgeführt werden! </font><font style="vertical-align: inherit;">So einfach. </font><font style="vertical-align: inherit;">Aber lassen Sie uns zuerst sehen, welche Eingabedateien wir verwenden. </font><font style="vertical-align: inherit;">Für die einfachste Simulation gibt es drei davon: Netzwerk, Pläne, Konfiguration.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerk</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Netzwerkdatei ist das Netzwerk, in dem sich Agenten bewegen. </font><font style="vertical-align: inherit;">Es besteht aus Knoten und Knoten / Links. </font><font style="vertical-align: inherit;">Jede Verbindung hat unterschiedliche Attribute: Typ, Länge des Segments, Durchsatz, Höchstgeschwindigkeit, Anzahl der Fahrspuren, Einbahnverkehr, zulässige Verkehrsträger usw. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_n/5p/rx/_n5prxnenyiuei82fndy2uekigy.jpeg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das manuelle Erstellen eines Stadtnetzes ist schwierig, unpraktisch und ineffizient. </font><font style="vertical-align: inherit;">Zum Beispiel besteht unser St. Petersburg-Netz aus 26.000 Knoten und 46.000 Verbindungen. </font><font style="vertical-align: inherit;">Aber es gibt gute Nachrichten. </font><font style="vertical-align: inherit;">Das Raster kann aus OpenStreetMap konvertiert und dann mit JOSM bearbeitet werden, das ebenfalls Open Source ist.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pläne</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Planungsdatei ist eine strukturierte Darstellung der täglichen Pläne von Agenten. </font><font style="vertical-align: inherit;">Im ersten Szenario haben wir 100 Agenten, die morgens (end_time = ”05:59”) mit dem Auto (mode = ”car”) von zu Hause (type = ”h”, link = ”1”) zur Arbeit (type =) fahren "W", link = "20"), nach einiger Zeit (dur = "02:30") kehren sie nach Hause zurück.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8g/vh/sp/8gvhsph0hfmjwzpfspy0liqv7xo.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfig</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schließlich werden in der Konfigurationsdatei alle erforderlichen Einstellungen festgelegt, um das Skript auszuführen. </font><font style="vertical-align: inherit;">MATSim besteht aus Modulen, die Sie nach Bedarf anpassen, hinzufügen oder entfernen können. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viele der Einstellungen in der Konfigurationsdatei sind intuitiv, aber Sie können auch immer in die sogenannten schauen. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim-Buch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jetzt betrachten wir nur zwei Module.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bewertungsparameter werden im planCalcScore-Modul festgelegt: Beispielsweise erhält ein Agent eine Strafe von 18 Einheiten für verspätete Ankunft. </font><font style="vertical-align: inherit;">Stromversorgung pro Stunde (jeweils 10 Minuten Verspätung entspricht dem Verlust von 3 Stromversorgungseinheiten); </font><font style="vertical-align: inherit;">Die Leistung einer Aktivität (z. B. Leistung) bringt 6 Versorgungseinheiten pro Stunde mit sich, und das Autofahren kostet die gleichen 6 Versorgungseinheiten pro Stunde. Um realistische Bewertungsparameter zu finden, werden Meinungsumfragen am häufigsten zur Analyse der „Kosten“ verwendet. Zeit. “ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Strategiemodul werden Neuplanungsparameter konfiguriert, z. B. wie viel Prozent der Agenten (ModuleProbability) die neue Route (ReRoute) während der nächsten Iteration ausprobieren. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/jf/yo/dcjfyoldbtrsg_zgrydyrrkc6ce.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ziel der Simulation ist es daher, dem Agenten zu helfen, zu den niedrigsten Kosten von Punkt A nach Punkt B zu gelangen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skript ausführen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeit, RunMatsim Runner zu öffnen und unser erstes Skript auszuführen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Simulationsergebnisse befinden sich im Ausgabeordner im Stammverzeichnis des Projekts. Die Hauptdateien für die Visualisierung sind Netzwerk und Ereignisse. Die Ereignisdatei enthält pro Sekunde Informationen zu allen Aktionen der einzelnen Agenten. Auf der Grundlage dieser Datei können Sie das vollständige Bild der Bewegung aller Agenten wiederherstellen. Sie können die Ergebnisse mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Via</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> visualisieren </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für repräsentativere Ergebnisse werde ich die Anzahl der Agenten auf 500 erhöhen. So sieht die Verteilung von 500 Agenten nach der ersten Iteration aus ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/by/o3/zk/byo3zk14bt0yj1y7od2sth35nok.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu Beginn der Iteration berechneten die Agenten den kürzesten Weg mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dijkstra</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infolgedessen überstieg die Verkehrsintensität in einem Abschnitt des Netzwerks seinen Durchsatz, was zu einer Überlastung führte. </font><font style="vertical-align: inherit;">Aber was ist, wenn Sie ihnen die Möglichkeit geben, verschiedene Routen auszuprobieren? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7l/_j/5_/7l_j5_q_n2g3roivtbnht8iwqfq.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach 200 Iterationen (~ 5 Minuten) wurden die Agenten über das Netzwerk neu verteilt, die Verbindungslast überschreitet nun nicht mehr 0,5 und die durchschnittliche Reisezeit für alle Agenten verringerte sich um 14% (5 Minuten). </font><font style="vertical-align: inherit;">Hurra, wir haben den Korken überwunden! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh, wenn es nur so einfach wäre! </font><font style="vertical-align: inherit;">In der Realität sind Transportsysteme viel komplizierter. </font><font style="vertical-align: inherit;">In den folgenden Artikeln werde ich Ihnen erzählen, wie ich an der Entwicklung von Modellen für St. Petersburg und andere Städte teilgenommen habe und wie wir praktische Probleme in realen Fällen gelöst haben. </font><font style="vertical-align: inherit;">Scientia potentia est! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/v-/t0/cjv-t0plurhha0_szf4vhthcubo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gepostet von Andrey Kolomatsky, Transport Analyst bei OTSLab.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de494580/index.html">Fraktale im Sand oder mehr als drei sammeln sich nicht</a></li>
<li><a href="../de494582/index.html">Microsoft stellt keine MCSE / MCSD / MCSA-Zertifikate mehr aus</a></li>
<li><a href="../de494586/index.html">Funktionale Programmierung als Beispiel für die Arbeit mit Matrizen aus der Theorie der linearen Algebra</a></li>
<li><a href="../de494590/index.html">Coronavirus - die Apotheose der Panik</a></li>
<li><a href="../de494592/index.html">Selbst gemachter Mangan-Dampflaser</a></li>
<li><a href="../de494598/index.html">Forscher in Stanford haben ein Exoskelett zum Laufen entwickelt</a></li>
<li><a href="../de494600/index.html">Erstellen eines einfachen Discord-Bots mithilfe der discord.py-Bibliothek</a></li>
<li><a href="../de494604/index.html">UV-Sterilisationsbox zur Wiederverwendung von Einwegmasken</a></li>
<li><a href="../de494606/index.html">Wie man den Mond und die Planeten beobachtet</a></li>
<li><a href="../de494608/index.html">Vorbereitung auf Ludum Dare</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>