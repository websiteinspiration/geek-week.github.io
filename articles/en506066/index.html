<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏼 🌹 👩🏿‍🔬 Building a digital model of a successful securities trading strategy. Description. Evidence 🏳️‍🌈 👩🏾‍💻 👩🏻‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you guessed by the title, my hobby is algorithmic trading. I decided to share the results to demonstrate to you how a multi-criteria analysis and s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Building a digital model of a successful securities trading strategy. Description. Evidence</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506066/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you guessed by the title, my hobby is algorithmic trading. </font><font style="vertical-align: inherit;">I decided to share the results to demonstrate to you how a multi-criteria analysis and selection of coefficients (sales, purchases) individually for each instrument (stock) can affect the result. </font><font style="vertical-align: inherit;">In order to amaze your imagination, I will demonstrate an example with 500% per annum (actually not). </font><font style="vertical-align: inherit;">I will conduct analysis on historical data using the Alfa-Direct trading terminal, but the experience presented here does not particularly limit you in choosing an instrument.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/d4/lo/wx/d4lowx0a3phey9degjed-rknqa0.jpeg"><br>
<a name="habracut"></a><br>
 <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The essence, philosophy and detailed description of the strategy</font></font></h2><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The essence</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is simple and simple: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Buy cheaper, sell more expensive</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">" </font></i><font style="vertical-align: inherit;">To simplify, trading will be carried out without taking into account the signals of indicators, fundamental analysis, recommendations of analysts, insiders, conspiracy theories. </font><font style="vertical-align: inherit;">The idea is to create a simple tool, and how / when / where to use it is up to the user. </font></font><br>
 <br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Philosophy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : I believe that each stock is individual and depends on the value of the lot, liquidity, and volatility. </font><font style="vertical-align: inherit;">The task of the script - by adjusting the coefficients - is the most efficient way to earn money on any movements of the action.</font></font><br>
 <br>
 <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strategy Description</font></font></h2><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 1. </font></font></b><br>
<br>
<ul>
<li>     (    <b>first_buy_ratio</b>)    .    .    100 —     ,  101,      1%  , ,  first_buy_ratio=99,      1%  .</li>
<li>          « ». </li>
<li>    2.</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 2.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Several coefficients are used here, I will immediately describe them: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first_sell_ratio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - how much more expensive it is to sell shares after the first purchase. Indicated as a percentage of the purchase price. For example, if 1% of profit is enough for you, then we bet 101, if 100.1, then - one tenth of a percent. </font></font><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buy_in_ratio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - when are we averaging? Indicate as a percentage of the purchase price. For example, if you want to buy up shares after a 5% price drop, then set 95 </font></font><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sec_sell_ratio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - how much more expensive to sell shares after a price drop </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AND</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">additional purchases? </font><font style="vertical-align: inherit;">This percentage is added to first_sell_ratio. </font><font style="vertical-align: inherit;">For example, after the first purchase, 1% of the profit was enough for you, but the price went down, you bought twice as many shares and you probably want to sell the entire volume of shares not already 1% more expensive FROM THE PURCHASE PRICE, but for example by 1.5% Then we set sec_sell_ratio = 0.5 </font></font><br>
 <br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So , step 2:</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
If the current price is higher than the purchase price by the value of first_sell_ratio, then:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sell</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> happily returning to step 1.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 If the current stock price is lower than the purchase price by the value of the buy_in_ratio coefficient, then:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buying twice as many stocks</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Purchase Price = Purchase Price</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We increase the% sale of the total volume of purchased shares by the value of the sec_sell_ratio coefficient</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We remain in step 2.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 If none of the conditions of step 2 happened, then the script continues to remain at this step, checking the price value with a given frequency (I recommend it with a frequency of 1 second) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Here is such a simple strategy, the philosophy of which is implemented in coefficients. </font><font style="vertical-align: inherit;">Well, now, let's move on to magic and try to mathematically solve the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">struggle of “greed with fear”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which are constantly pursuing the trader. </font><font style="vertical-align: inherit;">Simply put, we’ll calculate the answer to the questions “When to sell?” </font><font style="vertical-align: inherit;">When to buy? "</font></font><br>
 <br>
 <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The proof, it’s also “testing on historical data”, it’s also “building a model”</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 How to prove, first of all to yourself, that your strategy is profitable? That's right, drive it to historical data. But not only ... remember how you used to do math homework at school and if you couldn’t solve the problem, look at the correct answer at the end of the textbook and adjust the solution to the answer? :) It turns out that this was called not trickery, but mathematical deduction :) We want to get the maximum profit, which means we can “adjust” well or choose the value of the strategy coefficients that will yield the most expected result at the output. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's try an example. The most significant shares of Polymetal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I use the Alpha Direct trading terminal, this function is implemented there. We start testing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We set modest coefficients. Please note that the smaller the timeframe, the greater the result. There is a very big difference between testing on the “days” or “minutes”, this is quite obvious, because sometimes strong round-trip movements occur at short intervals (hello, HFT). But, time frames are less than a “minute” Alpha-direct gives a very long and reluctantly. Therefore, I use "minutes" in testing. </font></font><br>
 <br>
 <img src="https://habrastorage.org/webt/dl/-5/fh/dl-5fhowqzp4o0qbnxlmih9zgmo.jpeg"><br>
 <br>
<img src="https://habrastorage.org/webt/yp/y8/ly/ypy8lyqulnwje_b0sib7atjfbdc.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 What have we done? We started the process of testing the strategy, specifying parameters that can be decrypted as follows:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“We trade Polymetal shares on minute timeframes. The first purchase is made from the amount per share, from the current price. We sell the first purchase with a price increase of 0.3%. We buy when the price drops by 2%, and when buying, we increase the percentage of sales by 0.5%. We are testing this strategy on historical data from January 16, 2019 to June 2, 2020. Maximum drawdown of 10,000 shares. ”</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
That's what happened. </font></font><br>
 <br>
 <img src="https://habrastorage.org/webt/vw/vq/ol/vwvqol7zeret8p4rqhafc4-qwxi.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Profit 17.38% for 505 days, a total of 1298 transactions were completed, of which 1030 were successful. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modestly, but tastefully. Let's try to experiment? We start the testing process again, and increase the sec_sell_ratio coefficient to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sec_sell_ratio = 1.</font></font></b> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Here's what we got:</font></font><br>
 <br>
 <img src="https://habrastorage.org/webt/ik/zh/7s/ikzh7swck_calmhq9uhnhpaaruu.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Profit 47.88%. Awesome? Actually not really, I will explain a bit later. And now I’ll try to excite your imagination, start the testing process again, set </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sec_sell_ratio = 5.5</font></font></b><br>
 <br>
 <img src="https://habrastorage.org/webt/d4/lo/wx/d4lowx0a3phey9degjed-rknqa0.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 518% for 505 days, Karl !!! Wow. And this “You have looked into the rocket yet”, did not increase the number of shares for the first purchase. Increase </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qty</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to 10 stocks and get a great picture for the presentation of some adventurer thread. But </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">please do not self-deceive!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Look, in the last two tests, the profitability chart is not flat, but just at some point there was a jump in prices by 50% and the robot took advantage of this. The rest of the time, the robot behaved rather sluggishly.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 There is one important nuance that must always be taken into account when using this strategy: you must be very careful about the buy_in_ratio coefficient, i.e. the percentage of drawdown prices for additional purchase. If you set it very large, for example 99.99, then if the stock price falls by 5%, the robot will very quickly deprive innocence of any biggest deposit ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">read about the parable about grains on a chessboard</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Therefore, I highly recommend it, I ask you very directly: as a drawdown coefficient, do not put a number greater than 98, and the volume of shares for the first purchase should not exceed 1/20 of your deposit. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 I believe that you immediately have a reasonable question: how to trade with safety in mind? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I determined the following approach for myself:</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are counting the shares of the first echelon, we select the safest and most profitable digital models. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We launch a robot for each share in compliance with all precautions (minimum number of shares, minimum percentage drawdown, and so on)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We control our farm of robots so that one of them does not “eat out” the entire total deposit</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If this is not enough for you, for example, transactions are successful, but their frequency is not high, then “look abroad”, for example, we consider models for foreign markets.</font></font></li>
</ol> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 I hope I tried not in vain and you liked my article. </font><font style="vertical-align: inherit;">I repeat, I use Alpha Direct and my strategy is implemented for it in literally 80 lines of code. </font><font style="vertical-align: inherit;">I do not think that for other trading terminals it will be difficult to implement something similar. </font><font style="vertical-align: inherit;">You can do it yourself (the whole strategy is described in detail above), well, or write me your wish.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additional materials</font></font></h2><br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a link to the instructions on GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select and download the file Greedy.docx. I </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">also</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> posted </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">my thoughts on the forum, here</font></a><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506042/index.html">Neural network language models as a multi-purpose medical AI</a></li>
<li><a href="../en506044/index.html">Assessment of market risk (Value at Risk) of a bond portfolio (theory)</a></li>
<li><a href="../en506050/index.html">Unit tests in uVision Keil (and not only)</a></li>
<li><a href="../en506054/index.html">MskDotNet Meetup at Raiffeisenbank 11/06</a></li>
<li><a href="../en506064/index.html">Develop an interactive web application in C # with zero knowledge of JavaScript</a></li>
<li><a href="../en506082/index.html">Linux and WYSIWYG</a></li>
<li><a href="../en506086/index.html">Jurisprudence Artificial Intelligence</a></li>
<li><a href="../en506088/index.html">Explain to me how you figured out typing models for yourself - they are all blurry</a></li>
<li><a href="../en506096/index.html">Spine - a cross-platform game in the setting of cyberpunk from Banzai Games and Nekki</a></li>
<li><a href="../en506098/index.html">Studying the behavior of users of the online store. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>