<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✍🏾 😿 👠 Java 11中的AWS Lambda付诸实践 👩🏻‍✈️ 🧔🏽 🎠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文是一个如何通过一个简单示例快速轻松地开始使用AWS Lambda的指南。适合完全不使用Lambda的开发人员，以及知道Cloud可以评估开发无服务器应用程序的另一种愿景的开发人员。
 
 
 
 
 介绍
 大家好。
 我的名字叫Alexander Gruzdev，我是DINS的Java团队负责...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Java 11中的AWS Lambda付诸实践</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/486648/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文是一个如何通过一个简单示例快速轻松地开始使用AWS Lambda的指南。</font><font style="vertical-align: inherit;">适合完全不使用Lambda的开发人员，以及知道Cloud可以评估开发无服务器应用程序的另一种愿景的开发人员。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/y8/lu/bdy8luzeox9qq09msokx8yzoba4.jpeg" alt="图片"><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大家好。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的名字叫Alexander Gruzdev，我是DINS的Java团队负责人。两年多来，我一直与AWS基础架构紧密合作，并且在编写适用于AWS的应用程序以及部署这些应用程序方面都有经验。在我的工作中，我不得不使用ElasticBeanstalk，ECS，Fargate，EKS，当然还有AWS Lambda。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这些服务中的每一个都以其自己的方式很好，并且在本文的框架内，我不会敦促仅使用AWS Lambda替代所有其他选项。我只想展示开始使用Lambda的过程是多么容易，在什么情况下您会从中受益。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从开发人员到管理人员，每个人都需要一个清晰的过程来为客户交付更改。</font><font style="vertical-align: inherit;">该路径越透明，需要的工作量越少，利润就越高。</font><font style="vertical-align: inherit;">大多数情况下，开发人员和测试人员不希望知道应用程序将部署在何处，选择哪种硬件，要将副本放置在哪个区域等。</font><font style="vertical-align: inherit;">在下图中，您可以看到“ aaS”服务类（作为服务），其中AWS Lambda代表FaaS类别。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z8/nj/wl/z8njwlqjrgatljwptthtqe9ealu.png" alt="图片"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概述</font></font></b>
                        <div class="spoiler_text">FaaS ,            .     ,  , CRUD   C, R, U, D     Create   Read.      ,   —  .<br>
</div>
                    </div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理念</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了演示无服务器解决方案的发展，我决定举一个平庸的例子。</font><font style="vertical-align: inherit;">我认为您已经在许多站点上看到了“与我们联系”反馈表，您可以在其中留下您的邮件或电话并提出问题以待日后回答。</font><font style="vertical-align: inherit;">在下面的屏幕上，表单不是超级，但本文的主题不是材料设计。</font></font><br>
<img src="https://habrastorage.org/webt/gv/5g/iv/gv5givju7glj8vftkb1cdhupdiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过填写此表格，潜在客户将等待您的来电或来信。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从技术方面，您需要：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将数据从表单保存到数据库；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">寄信给将回答问题的代理商；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也许编写另一个服务，代理将在该服务上标记基于同一数据库完成的工作（不包括在本文范围内）。</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个想法的实现可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">找到</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建筑</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在实现过程中首先想到的是我们需要的：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机器背面，正面，图像等下方，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带底座车</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机带有电子邮件服务。</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/9a/7h/83/9a7h83iyieeicpht4-bcwy8l-ja.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
需要很好地复制背面和底面，但是假设我们是在我们的迷你商店中这样做的，那么此表单上的负载是最小的。</font><font style="vertical-align: inherit;">因此，所有这些机器都可以组合为一个，并在单个集合中部署。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，由于我们正在考虑无服务器，因此让我们完全在无服务器组件上构建体系结构。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论Serverless听起来多么有前途，我们都知道服务器仍在这里，它们只是从您的视野中消失了。</font><font style="vertical-align: inherit;">现在，您可以完成云工作，而您可以自己完成琐事。</font><font style="vertical-align: inherit;">但是，让我们尝试仅使用此类无服务器组件：</font></font><br>
<img src="https://habrastorage.org/webt/mf/iw/6i/mfiw6if-6nlss4pl-brkgxenxuc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该图显示了每个组件功能的非常清晰的分离。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda是包含代码/逻辑的主要组件，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S3负责存储静态资源和JS脚本，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CloudFront-用于缓存机制和多区域支持，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SES-电子邮件服务，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DynamoDB-用于存储表单数据的基础（从谁那里，什么问题，在哪里发送答案），</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网关API-用于我们的lambda的HTTP API，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route53-如果要添加漂亮的域名，则需要。</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并非所有这些组件都将在我们的下一个指南中使用，只是为了避免拉伸本文。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Route53和CloudFront是相当简单的组件，您可以分别阅读。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一些破坏者将为我们提供这样的解决方案：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们不再支持EC2机器，不再通过ssh进行调试，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">轻松配置：一键配置限制/缓存/访问，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持访问策略：限制权限并授予访问权限，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开箱即用地记录/监视，</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只为已使用的资源/请求付费。</font></font></li>
</ul><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演示版</font></font></h1><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要开始开发我们的无服务器解决方案，您必须满足以下要求：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效的AWS账户</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aws-cli</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">桑克里</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杰克11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摇篮</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装完上述所有工具后，您需要配置aws-cli以远程访问AWS。</font><font style="vertical-align: inherit;">请按照</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明进行操作</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这将需要创建一个新用户并卸载其访问密钥和秘密密钥。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目组装</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.从模板创建项目</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打开未来项目的目录，然后从中启动SAM CLI。</font><font style="vertical-align: inherit;">请按照说明进行操作：</font></font><br>
<img src="https://habrastorage.org/webt/kn/gu/7f/kngu7fr3q_h_7t7bq-ygr7baccs.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：根据SAM-CLI版本，命令可能会略有不同，但是它们都保持直观。</font><font style="vertical-align: inherit;">只需选择与上面使用的最相似的那些即可。</font><font style="vertical-align: inherit;">如果Gradle不适合您，您还可以选择其他构建工具。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
项目“你好，世界！” </font><font style="vertical-align: inherit;">准备。</font><font style="vertical-align: inherit;">现在，您可以处理项目的名称以及程序包，依赖项和源代码。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.让我们应对成瘾</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将以下依赖项添加到build.gradle：</font></font><br>
<pre><code class="javascript hljs">dependencies {
    <span class="hljs-comment">// AWS</span>
    implementation group: <span class="hljs-string">'com.amazonaws.serverless'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-serverless-java-container-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.4'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.2.0'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-ses'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-dynamodb'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-log4j2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.1.0'</span><font></font>
<font></font>
    <span class="hljs-comment">// Utils</span>
    implementation group: <span class="hljs-string">'com.fasterxml.jackson.core'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'jackson-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.10.0'</span>
    implementation group: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.6'</span><font></font>
<font></font>
    <span class="hljs-comment">// Test</span>
    testImplementation group: <span class="hljs-string">'org.mockito'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'mockito-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'3.1.0'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-api-mockito2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-module-junit4'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'4.12'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主要的是AWS开发工具包。</font><font style="vertical-align: inherit;">它们将允许您使用特定的服务，例如SES，DynamoDB等。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.我们写一个lambda</font></font></h3><br>
<ul>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将RequestHandler的模板请求和响应类更改为AwsProxyRequest和ContactUsProxyResponse。</font></font></b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">RequestHandler</span>&lt;<span class="hljs-title">AwsProxyRequest</span>, <span class="hljs-title">ContactUsProxyResponse</span>&gt;
...
<span class="hljs-title">public</span> <span class="hljs-title">ContactUsProxyResponse</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-title">AwsProxyRequest</span> <span class="hljs-title">request</span>, <span class="hljs-title">Context</span> <span class="hljs-title">context</span>) </span></code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">  AwsClientFactory   AWS SDK-.</b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">/**
 * Just an util class for an eager initialization of sdk clients.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AwsClientFactory</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOG = LogManager.getLogger(AwsClientFactory.class);<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AmazonSimpleEmailService sesClient;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DynamoDB dynamoDB;<font></font>
<font></font>
    /**<font></font>
     * AWS regions should be env variables <span class="hljs-keyword">if</span> you want to generalize the solution.<font></font>
     */<font></font>
    AwsClientFactory() {<font></font>
        LOG.debug("AWS clients factory initialization.");<font></font>
        sesClient = AmazonSimpleEmailServiceClient.builder().withRegion(Regions.EU_WEST_1).build();<font></font>
        AmazonDynamoDB dynamoDBClient = AmazonDynamoDBClientBuilder.standard().withRegion(Regions.EU_WEST_1).build();<font></font>
        dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(dynamoDBClient);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">DynamoDB <span class="hljs-title">getDynamoDB</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> dynamoDB;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">AmazonSimpleEmailService <span class="hljs-title">getSesClient</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sesClient;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    ObjectMapper   .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ObjectMapper OBJECT_MAPPER = <span class="hljs-keyword">new</span> ObjectMapper();
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AwsClientFactory AWS_CLIENT_FACTORY = <span class="hljs-keyword">new</span> AwsClientFactory();
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
 <span class="hljs-function"><span class="hljs-keyword">private</span> SendEmailResult <span class="hljs-title">sendEmail</span><span class="hljs-params">(ContactUsRequest contactUsRequest)</span> </span>{<font></font>
        String emailTemplate = getEmailTemplate();<font></font>
        String email = fillTemplate(emailTemplate, contactUsRequest);<font></font>
<font></font>
        SendEmailRequest sendEmailRequest =<font></font>
                <span class="hljs-keyword">new</span> SendEmailRequest(<font></font>
                        System.getenv(<span class="hljs-string">"SENDER_EMAIL"</span>),
                        <span class="hljs-keyword">new</span> Destination(List.of(System.getenv(<span class="hljs-string">"RECIPIENT_EMAIL"</span>))),
                        <span class="hljs-keyword">new</span> Message()<font></font>
                                .withSubject(<font></font>
                                        <span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(contactUsRequest.getSubject()))<font></font>
                                .withBody(<span class="hljs-keyword">new</span> Body()<font></font>
                                        .withHtml(<span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(email))));<font></font>
        LOG.info(<span class="hljs-string">"Email template is ready"</span>);
        <span class="hljs-keyword">return</span> AWS_CLIENT_FACTORY.getSesClient().sendEmail(sendEmailRequest);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">fillTemplate</span><span class="hljs-params">(String emailTemplate, ContactUsRequest contactUsRequest)</span> </span>{
        <span class="hljs-keyword">return</span> String.format(<font></font>
                emailTemplate,<font></font>
                contactUsRequest.getUsername(),<font></font>
                contactUsRequest.getEmail(),<font></font>
                contactUsRequest.getPhone(),<font></font>
                contactUsRequest.getQuestion());<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getEmailTemplate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> IOUtils.toString(<font></font>
                    Objects.requireNonNull(<span class="hljs-keyword">this</span>.getClass().getClassLoader()<font></font>
                                               .getResourceAsStream(<span class="hljs-string">"email_template.html"</span>)),<font></font>
                    UTF_8);<font></font>
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Loading an email template failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addEmailDetailsToDb</span><span class="hljs-params">(ContactUsRequest contactUsRequest, SendEmailResult sendEmailResult)</span> </span>{<font></font>
        AWS_CLIENT_FACTORY.getDynamoDB().getTable(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                          .putItem(<span class="hljs-keyword">new</span> Item()<font></font>
                                  .withPrimaryKey(<span class="hljs-string">"Id"</span>, sendEmailResult.getMessageId())<font></font>
                                  .withString(<span class="hljs-string">"Subject"</span>, contactUsRequest.getSubject())<font></font>
                                  .withString(<span class="hljs-string">"Username"</span>, contactUsRequest.getUsername())<font></font>
                                  .withString(<span class="hljs-string">"Phone"</span>, contactUsRequest.getPhone())<font></font>
                                  .withString(<span class="hljs-string">"Email"</span>, contactUsRequest.getEmail())<font></font>
                                  .withString(<span class="hljs-string">"Question"</span>, contactUsRequest.getQuestion()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-function"><span class="hljs-keyword">private</span> ContactUsProxyResponse <span class="hljs-title">buildResponse</span><span class="hljs-params">(<span class="hljs-keyword">int</span> statusCode, String body)</span> </span>{<font></font>
        ContactUsProxyResponse awsProxyResponse =<font></font>
                <span class="hljs-keyword">new</span> ContactUsProxyResponse();<font></font>
        awsProxyResponse.setStatusCode(statusCode);<font></font>
        awsProxyResponse.setBody(getBodyAsString(body));<font></font>
        awsProxyResponse.addHeader(CONTENT_TYPE, ContentType.APPLICATION_JSON.toString());<font></font>
        awsProxyResponse.addHeader(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>);
        <span class="hljs-keyword">return</span> awsProxyResponse;<font></font>
}<font></font>
<font></font>
 <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getBodyAsString</span><span class="hljs-params">(String body)</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> OBJECT_MAPPER.writeValueAsString(<span class="hljs-keyword">new</span> ContactUsResponseBody(body));<font></font>
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Writing ContactUsResponseBody as string failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    .      «// WARMING UP».</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         handleRequest()</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ContactUsProxyResponse <span class="hljs-title">handleRequest</span><span class="hljs-params">(AwsProxyRequest request, Context context)</span> </span>{<font></font>
        LOG.info(<span class="hljs-string">"Request was received"</span>);<font></font>
        LOG.debug(getAsPrettyString(request));<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
        }<font></font>
<font></font>
        ContactUsRequest contactUsRequest = getContactUsRequest(request);<font></font>
<font></font>
        SendEmailResult sendEmailResult = sendEmail(contactUsRequest);<font></font>
        LOG.info(<span class="hljs-string">"Email was sent"</span>);<font></font>
<font></font>
        addEmailDetailsToDb(contactUsRequest, sendEmailResult);<font></font>
        LOG.info(<span class="hljs-string">"DB is updated"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">200</span>,<font></font>
                String.format(<span class="hljs-string">"Message %s has been sent successfully."</span>, sendEmailResult.getMessageId()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本逻辑很简单，因此我认为不值得对其进行详细描述。有几点需要注意。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先是日志记录。上下文lambda方法的参数之一包含许多辅助信息以及一个记录器。因此，您不能创建单独的记录器，而是使用提供的lambda上下文。为此，只需在使用前调用即可：</font></font><br>
<blockquote><code>LambdaLogger logger = context.getLogger(); </code></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二点是热身。由于为lambda创建可执行环境是很懒的，因此启动JVM，加载类路径并执行代码需要一些时间。第一次调用可能需要花费几秒钟的时间，如果您编写不同的同步API，则效果不佳。对于此类情况，您自己可以告诉AWS您需要保持几个lambda实例处于警报状态。但这需要有人调用lambda。如果我们使用基本版本的代码执行此操作，那么实际上，我们将发送一封信并将一些不正确的数据写入数据库。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为避免这种情况，我们可以添加某种请求处理，以区分实际请求和预热请求。例如，我们可以向请求添加特殊的标头。在我们的例子中，“ X-WARM-UP”头将与任何值一起使用-为了了解这是一个预热请求，我们只需要返回某种响应即可，而无需执行业务逻辑。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我要引起注意的最后一件事是使用静态变量。</font><font style="vertical-align: inherit;">在我们的例子中，这不会产生有状态的lambda实例，而只是允许重用现有和初始化的对象。</font><font style="vertical-align: inherit;">如果要初始化的对象在代码执行过程中发生静态更改，请尝试再次考虑这是否会干扰后续对lambda的调用的操作。</font><font style="vertical-align: inherit;">另外，如果这些对象在初始化期间使用环境变量，则不应将其设置为静态。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.我们编写测试</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lambda代码可以被大多数情况下使用的相同类型的测试所覆盖。</font><font style="vertical-align: inherit;">但是，为了防止文章进一步发展，我将在下一篇有关AWS Lambda测试和本地开发的文章中介绍测试无服务器应用程序。</font><font style="vertical-align: inherit;">尽管在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中已经可以使用单元测试</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.我们编写了SAM资源模板</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本地编写并测试了lambda之后，我们需要编写SAM模板以在AWS中部署所有这些资源。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于SAM的一点</font></font></b>
                        <div class="spoiler_text">Serverless Application Model –     serverless .  ,      CloudFormation DSL,     –   Lambda, Gateway, DynamoDB  . . <br>
SAM, CloudFormation, Terraform –   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IaC-</a>. SAM     Serverless-,   Terraform        . <br>
 Terraform   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">    DINS</a>.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，让我们看一下需要在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM-template中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明哪些资源</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS :: Serverless ::函数</font></font></b></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果我们使用SAM初始化来创建项目，则主要功能已经为我们填充。</font><font style="vertical-align: inherit;">但是在我的示例中，它们是这样的：</font></font><br>
<pre><code class="plaintext hljs">CodeUri: contact-us-function<font></font>
Handler: com.gralll.sam.App::handleRequest<font></font>
Runtime: java8<font></font>
MemorySize: 256<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，我认为一切都足够清楚。</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeUri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是我们的目录</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理器</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拉姆达</font><font style="vertical-align: inherit;">-的完整路径</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">-什么</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拉姆达写</font><i><font style="vertical-align: inherit;">上</font></i><font style="vertical-align: inherit;"> -不言自明</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说到内存</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：高达3GB的内存可用在lambda，这相当于2个CPU的资源。也就是说，您不能单独调整CPU，而只能增加/减少内存量。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
需要下一个框来选择部署方法。</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoPublishAlias-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许您为每个新的部署版本</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加别名</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。为了实现金丝雀部署，这是必需的。</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canary10Percent10Minutes-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一种部署类型，它允许您同时容纳lambda的两个版本：旧版本和新版本，但仅将10％的流量重定向到新版本。如果十分钟之内没有问题，其余的流量也将被重定向到新版本。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在SAM页面上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读有关使用高级功能的更多信息</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来是将在代码中使用的环境变量。之后，另一个lambda块：</font></font><br>
<pre><code class="plaintext hljs">Events:<font></font>
  ContactUs:<font></font>
    Type: Api<font></font>
    Properties:<font></font>
      Path: /contact<font></font>
      Method: post<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在其中，我们必须描述调用lambda的触发器。在我们的情况下，这些将是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API网关请求</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是描述API的一种相当简化的形式，但是对于新创建的Gateway API而言，足以将所有</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POST /联系</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求重定向</font><font style="vertical-align: inherit;">到我们的lambda。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，我们需要描述安全性方面。开箱即用，创建的lambda将无法访问数据库或电子邮件服务。因此，我们需要明确规定允许的内容。有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几种方法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在AWS内部进行访问。我们将使用基于资源的策略：</font></font><br>
<pre><code class="plaintext hljs">Policies:<font></font>
  - AWSLambdaExecute<font></font>
  - Version: '2012-10-17'<font></font>
    Statement:<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - ses:SendEmail<font></font>
          - ses:SendRawEmail<font></font>
        Resource: 'arn:aws:ses:eu-west-1:548476639829:identity/aleksandrgruzdev11@gmail.com'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:List*<font></font>
        Resource: '*'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:Get*<font></font>
          - dynamodb:PutItem<font></font>
          - dynamodb:DescribeTable<font></font>
        Resource: 'arn:aws:dynamodb:*:*:table/ContactUsTable'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，对于数据库表，我们指定了一个特定的名称，因此，我们将需要创建一个具有相同名称的表。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于SES：您会看到我的电子邮件地址。就您而言，它必须是您自己确认的地址。如何执行此操作，请参见</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
之后，您可以通过单击创建的地址找到该资源的身份ARN，并在上面的示例中将其替换为电子邮件。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他们有点想出了lambda。现在让我们进入数据库。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS ::无服务器:: SimpleTable</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
对于我们的任务，我们将仅创建一个</font><b><i><font style="vertical-align: inherit;">ContactUsTable</font></i></b><font style="vertical-align: inherit;">表：</font></font><br>
<pre><code class="plaintext hljs">ContactUsTable:<font></font>
  Type: AWS::Serverless::SimpleTable<font></font>
  Properties:<font></font>
    PrimaryKey:<font></font>
      Name: Id<font></font>
      Type: String<font></font>
    TableName: ContactUsTable<font></font>
    ProvisionedThroughput:<font></font>
      ReadCapacityUnits: 2<font></font>
      WriteCapacityUnits: 2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在必填字段中-仅是ID，还指示ReadCapacityUnits和WriteCapacityUnits。</font><font style="vertical-align: inherit;">我们不会详细介绍选择什么值，因为这也是一个相当广泛的话题。</font><font style="vertical-align: inherit;">您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于测试应用程序，较小的1-2数量级就足够了。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全局</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
参数例如，如果您声明了几个Function或API类型的资源，则可以在此块中取出General参数。</font></font><br>
<pre><code class="plaintext hljs">Globals:<font></font>
  Function:<font></font>
    Timeout: 15<font></font>
  Api:<font></font>
    Cors:<font></font>
      AllowOrigin: "'*'"<font></font>
      AllowHeaders: "'Content-Type,X-WARM-UP,X-Amz-Date,Authorization,X-Api-Key'"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我用它来设置函数的超时时间和一些Cors设置，以便稍后通过ContactUs表单从我的静态页面调用Gateway API。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
此块使您可以在全局AWS CloudFormation上下文中动态定义一些变量。</font></font><br>
<pre><code class="plaintext hljs">Outputs:<font></font>
  ContactUsApi:<font></font>
    Description: "API Gateway endpoint URL for Prod stage for ContactUs function"<font></font>
    Value: !Sub "https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/contact/"<font></font>
  ContactUsFunction:<font></font>
    Description: "ContactUs Lambda Function ARN"<font></font>
    Value: !GetAtt ContactUsFunction.Arn<font></font>
  ContactUsFunctionIamRole:<font></font>
    Description: "Implicit IAM Role created for ContactUs function"<font></font>
    Value: !GetAtt ContactUsFunctionRole.Arn<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，我们声明了一个ContactUsApi变量，该变量将被设置为一个值，作为我们创建的API端点的公共地址。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于我们使用的是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {ServerlessRestApi}</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，AWS将在字符串中插入新网关API的唯一标识符。结果，任何有权访问CloudFormation的应用程序都将能够获得该地址-因此，您无法对服务的URL进行硬编码。好吧，另一个好处是，查看输出列表非常方便-有关堆栈的一些元信息。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以找到功能的完整列表以及可以使用的参数</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
除了上述所有以外，您还可以添加一个</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Parameters</font></a><font style="vertical-align: inherit;">块</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些选项将有助于使模板更具通用性。</font><font style="vertical-align: inherit;">在模板的任何其他块中，您都可以引用这些参数，从而不必对某些值进行硬编码。</font><font style="vertical-align: inherit;">例如，在我的模板中，它可以是电子邮件，SES ARN，内存量等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是整个模板。</font><font style="vertical-align: inherit;">没有人禁止在附近添加更多资源，例如S3存储桶，任何其他CloudFormation资源或一般的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义资源</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.我们继续进行部署</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了组装我们的项目，我们将不使用Gradle，而是使用SAM。</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部件</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam build<font></font>
Building resource <span class="hljs-string">'ContactUsFunction'</span><font></font>
Running JavaGradleWorkflow:GradleBuild<font></font>
Running JavaGradleWorkflow:CopyArtifacts<font></font>
<font></font>
Build Succeeded<font></font>
<font></font>
Built Artifacts  : .aws-sam\build<font></font>
Built Template   : .aws-sam\build\template.yaml<font></font>
<font></font>
Commands you can use next<font></font>
=========================<font></font>
[*] Invoke Function: sam <span class="hljs-built_in">local</span> invoke<font></font>
[*] Deploy: sam deploy –guided<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从项目的根目录</font><font style="vertical-align: inherit;">
运行</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令将自动将</font><font style="vertical-align: inherit;">所有必需的文件</font><font style="vertical-align: inherit;">收集到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.aws-sam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹中：类，依赖项，SAM模板。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，您需要创建一个S3存储桶，SAM随后将在其中上传所有收集的工件。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以通过基于浏览器的AWS控制台或使用以下命令来完成此操作</font></font><br>
<blockquote><code>aws s3 mb s3://bucket-name</code></blockquote><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：所有存储桶都是在全局上下文中创建的，并且在所有帐户之间都经过了翻版。</font><font style="vertical-align: inherit;">因此，如果有人已经在您的帐户中创建了存储桶，则无法创建该存储桶。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
存储桶准备就绪后，执行以下命令：</font></font><br>
<blockquote><code>sam package --output-template-file packaged.yaml --s3-bucket &lt;YOUR_BACKET&gt;</code></blockquote><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包装结果</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam package --output-template-file packaged.yaml --s3-bucket contact-us-sam-app<font></font>
Uploading to ea0c122c06a50d9676fbf9000a80a3bf  9212768 / 9212768.0  (100.00%)<font></font>
<font></font>
Successfully packaged artifacts and wrote output template to file packaged.yaml.<font></font>
Execute the following <span class="hljs-built_in">command</span> to deploy the packaged template<font></font>
sam deploy --template-file F:\aws\projects\contact-us-sam-app\packaged.yaml --stack-name &lt;YOUR STACK NAME&gt;<font></font>
</code></pre></div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我指向了我的contact-us-sam-app存储桶，SAM将所有资源上传到了指定位置。</font><font style="vertical-align: inherit;">接下来，SAM已经告诉您使用资源创建堆栈的命令，从而嵌入您的决定。</font><font style="vertical-align: inherit;">我们执行了一下命令，并完成了一点：</font></font><br>
<blockquote><code>sam deploy --template-file packaged.yaml --region eu-west-1 --capabilities CAPABILITY_IAM --stack-name contact-us-sam-app </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，我添加了</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--capabilities CAPABILITY_IAM</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这将使CloudFormation能够创建IAM资源。</font><font style="vertical-align: inherit;">否则，创建时会收到InsufficientCapabilities错误。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下是此命令的工作日志（图片可单击）。</font><font style="vertical-align: inherit;">每个资源的状态和输出值等详细信息仅在SAM CLI的最新版本中可用。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/nv/7p/4z/nv7p4zreqati1wd8c8vy3ubuzcm.png"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.检查CloudFormation的状态</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们可以等待控制台中的部署完成，直到出现一条消息，指出已部署了堆栈（deploy命令记录在上一段中）：</font></font><br>
<blockquote><code>Successfully created/updated stack - contact-us-sam-app in eu-west-1</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是在我们的情况下，由于金丝雀部署模式，您只会在十分钟后看到此消息。因此，打开浏览器控制台并查看其中的堆栈会更加容易。</font></font><br>
<img src="https://habrastorage.org/webt/97/ki/k8/97kik8apukwxsvqwyvsd_wtmaqo.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一段时间后，状态将更改为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE_COMPLETE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这表示成功完成。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项卡中，</font><font style="vertical-align: inherit;">您可以查看所有资源的状态。如果您的堆栈出现故障，则可以在这里找到详细的错误消息。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，这：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE_FAILED-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您在模板中错误地配置了网关API。</font></font><br>
<img src="https://habrastorage.org/webt/ce/mh/aq/cemhaqtl6uvdmlvnr0bsvrbokok.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在资源选项卡中，您可以找到所有创建的资源。</font><font style="vertical-align: inherit;">不要惊讶于其数量。</font><font style="vertical-align: inherit;">尽管我们仅在SAM模板中声明了一个函数和一个数据库表，但是CloudFormation为我们创建了许多其他资源。</font><font style="vertical-align: inherit;">如果查看它们的类型，就可以了解它们所属的服务。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于Api Gateway，它是隐式创建的：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApi部署</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApiProdStage</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同样为lambda创建了几个其他对象。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在打开“ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并找到我们API的URL。</font><font style="vertical-align: inherit;">复制它，它将很快派上用场。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. HTML ContactUs表单</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所记得，我决定制作一个ContactUs表单，现在我们需要以某种方式使它不仅在本地计算机上可用。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
例如，对于表单本身，我决定采用最简单的HTML表单，并通过ajax添加了Gateway API调用。</font></font><br>
<img src="https://habrastorage.org/webt/ps/e-/4h/pse-4hta3mojfuamij0dhj3bmyg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了表单本身之外，我还添加了一些用于调试和简化填充的按钮：</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置默认值</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -可以预期地替换HTML内部指定的默认参数。</font></font><br>
<pre><code class="javascript hljs">$(<span class="hljs-string">"#url-input"</span>).val(<span class="hljs-string">"https://4ykskscuq0.execute-api.eu-west-1.amazonaws.com/Prod/contact"</span>);<font></font>
$(<span class="hljs-string">"#name-input"</span>).val(<span class="hljs-string">"Mike"</span>);<font></font>
$(<span class="hljs-string">"#email-input"</span>).val(<span class="hljs-string">"Mike@somemail.com"</span>);<font></font>
$(<span class="hljs-string">"#phone-input"</span>).val(<span class="hljs-string">"+79999999999"</span>);<font></font>
$(<span class="hljs-string">"#description-input"</span>).val(<span class="hljs-string">"How much does it cost?"</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果要使用此功能，请将url-input更改为从</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制的Gateway API的路径</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代管</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个新的S3存储桶。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过选择将文件公开的选项，我们将HTML文件加载到存储桶中。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们进入上载文件的存储桶。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转到“属性”，然后打开“静态”网站托管，然后查看新的公共可用端点。</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.健康检查</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准请求</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
现在，您可以单击表单的链接，单击“设置默认值”和“发送”。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这样，您将发出将通过网关API到达AWS Lambda的请求。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果过一会儿您正确配置了所有内容，您将收到以下消息：</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功：消息0102016f28b06243-ae897a1e-b805-406b-9987-019f21547682-000000已成功发送。</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这意味着邮件已成功传递。检查您在SAM模板中指定的邮箱。如果尚未更改模板，则字母将采用以下格式：</font></font><br>
<img src="https://habrastorage.org/webt/0z/wy/sv/0zwysv5ytv3uzn9fb9az7bsa6lg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还可以打开DynamoDB并确保已出现新条目。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">冷启动的功能</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我想您已经注意到有关成功发送的消息是在相当长的一段时间之后发出的。这是由于以下事实：AWS Lambda服务已收到处理请求，并开始引发Java应用程序的实例，这包括使用操作系统和JRE提升容器，加载类路径，初始化所有变量，然后才是</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">handleRequest（ ）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这称为冷启动。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尝试填写并再次提交表单。这次答案几乎立刻就来了，对吗？如果在第一个请求和第二个请求之间经过了20-30分钟，则结果可能会有所不同。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是什么原因呢？事实是，AWS Lambda缓存已使用带有lambda的容器进行重复使用。这减少了用于启动该方法的整个上下文的初始化时间。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lambdas的缓存时间长短并没有明显的相关性，但是有人通过实验发现这</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接取决于所选择的RAM值</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。也就是说，具有128MB内存的lambda将比3GB可用的时间更长。也许还有其他参数，例如，执行lambda的区域的平均负载，但这是不准确的。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，如果您使用同步请求，请尝试一下并计划缓存时间。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">热身</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
作为附加选项，你可以使用拉姆达加热。在代码中，我添加了</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-WAMP-UP标头</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查</font><font style="vertical-align: inherit;">。如果有一个，则lambda仅返回响应而不执行任何业务逻辑，但容器将为后续调用做好准备。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，您可以使用CloudWatch自己通过皇冠计时器调用lambda。如果您不希望客户加入冷启动，这将有所帮助。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在HTML表单中，您可以找到WarmUp模式按钮，该按钮将此特殊标头添加到请求中。</font><font style="vertical-align: inherit;">您可以验证既不会发送信件也不会写入数据库，但是来自lambda的响应到达了，随后对真实请求的调用将不会花费很多时间。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总结</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本文中，我们经历了从应用程序设计到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所谓的生产</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发布的所有主要阶段</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望那些已经听说过Serverless和AWS Lambda但又没有实际经验的人能够使用本指南，并感到这样做不仅在某些软件解决方案的部署速度上具有显着的优势。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好处</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
对于我自己，我已经确定了最宝贵的好处：</font></font><br>
<ul>
<li>     Free Tier      ,     ,       .</li>
<li>           1-2 .        /.</li>
<li>  ,          ,         .</li>
<li>  Serverless      .   ,  —  .   SAM          AWS. AWS    ,         ,   .</li>
<li>      Lambda ,     .</li>
<li>   Serverless    , , .          ELK/Promethes/Grafana      .</li>
<li>   ,             API.          API Key,   IAM ,                      .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好吧，最基本的东西可能是无服务器。</font><font style="vertical-align: inherit;">无需考虑需要为哪个EC2实例付费，如何配置对其的访问权限，在应用程序崩溃时如何配置警报，配置自动缩放等。</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缺点</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
不幸的是，这并不意味着现在您可以采用此解决方案并将其用作企业系统的一部分，而不是您在cuber中最喜欢的微服务。</font><font style="vertical-align: inherit;">很多时候，您需要深入研究以确定在特定情况下更合适的解决方案。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我也有评论，选择Lambda时应注意：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">冷启动。</font><font style="vertical-align: inherit;">在使用同步查询以及Java或C＃等语言时特别重要。</font><font style="vertical-align: inherit;">通过预热可以适当地解决此问题，但最好事先考虑一下这种解决方案，然后比较成本和可能的收益</font></font></li>
<li>    .       3GB  ,    2   ,    ,     - Fargate,       ,     .</li>
<li>          API,       ,           .</li>
<li>    /   1-2     Serverless,                .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您已经拥有在Coober中开发微服务和CI / CD的基础结构，那么（特别是对于管理人员）争辩是否需要支持另一个CI / CD流程将再次成为问题。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好吧，这里没有测试。</font><font style="vertical-align: inherit;">而且，测试lambda的吞吐量非常困难，因为它仍然与通常的性能测试不同，并且必须考虑许多因素。</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用法</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
通常，AWS Lambda和其他无服务器服务的使用非常适合异步和事件驱动的开发原则。</font><font style="vertical-align: inherit;">通过使用异步处理，可以在性能和成本上获得最佳结果。</font><font style="vertical-align: inherit;">这是Serveress解决方案将在其中发挥重要作用的解决方案列表：</font></font><br>
<img src="https://habrastorage.org/webt/i6/ov/y6/i6ovy6ha2pszsiui5jvyewbf-dk.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚苯乙烯</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于这篇文章的内容相当广泛，并且我不想再夸大其词，因此我很可能会准备一个续集，其中将展示如何使用AWS控制台，SAM框架甚至IntelljIDEA的所有功能更有效地进行开发。</font><font style="vertical-align: inherit;">好吧，由于我省略了测试部分，因此我将尝试更详细地描述开发的这一方面。</font><font style="vertical-align: inherit;">另外，如果您有任何要添加到下一篇文章或问题的愿望，请随时在评论或私人消息中写。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">补充：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda的实际应用。</font><font style="vertical-align: inherit;">第2</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
部分文章中的一些重要和有用的链接：</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub项目</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载AWS-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载SAM-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS-CLI配置</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基础架构即代码</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Terraform的经验</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM资源的描述</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda函数别名</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级Lambda部署</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM Api资源配置</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AWS IAM   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">       SES</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Read/Write capacity  DynamoDB </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SAM/CloudFormation  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Parameters   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  CloudFormation </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">      </a></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN486648/">https://habr.com/ru/post/zh-CN486648/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN486634/index.html">Visual Studio 2019版本16.3和16.4中的MSVC后端更新</a></li>
<li><a href="../zh-CN486638/index.html">Blazor WebAssembly 3.2.0 Preview 1现在可用</a></li>
<li><a href="../zh-CN486640/index.html">331号移动开发人员的有趣材料摘要（1月27日至2月2日）</a></li>
<li><a href="../zh-CN486644/index.html">5分钟内DIY天线</a></li>
<li><a href="../zh-CN486646/index.html">摆脱jQuery到Svelte的烦恼</a></li>
<li><a href="../zh-CN486650/index.html">硬实时系统中的动态内存</a></li>
<li><a href="../zh-CN486652/index.html">程序员的“纯理性批判”</a></li>
<li><a href="../zh-CN486654/index.html">Raspberry Pi上家庭助手中的运动传感器以及警报和视频注册连接</a></li>
<li><a href="../zh-CN486656/index.html">如何向Unicode添加新字符：外行的经验</a></li>
<li><a href="../zh-CN486658/index.html">Moxy策略插件</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>