<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîù üéôÔ∏è üîû Optimiser le stockage: un cas d'unification et de moindre co√ªt de possession üßñ üë©üèø‚Äç‚öïÔ∏è ‚ÜòÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article d√©crit le processus d'optimisation de l'infrastructure de stockage d'une entreprise de classe moyenne. 
 
 Les justifications d'une telle tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Optimiser le stockage: un cas d'unification et de moindre co√ªt de possession</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/icl_services/blog/487752/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'article d√©crit le processus d'optimisation de l'infrastructure de stockage d'une entreprise de classe moyenne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les justifications d'une telle transition et une br√®ve description du processus de mise en place d'un nouveau syst√®me de stockage sont consid√©r√©es. </font><font style="vertical-align: inherit;">Nous donnons un exemple des avantages et des inconv√©nients du passage au syst√®me s√©lectionn√©.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'infrastructure de l'un de nos clients √©tait constitu√©e de nombreux syst√®mes de stockage h√©t√©rog√®nes de diff√©rents niveaux: des syst√®mes SOHO QNAP, Synology pour les donn√©es utilisateur aux syst√®mes de stockage d'entr√©e et de milieu de gamme Eternus DX90 et DX600 pour iSCSI et FC pour les donn√©es de service et les syst√®mes de virtualisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela diff√©rait √† la fois dans les g√©n√©rations et dans les disques utilis√©s; une partie des syst√®mes √©tait un √©quipement h√©rit√© qui ne b√©n√©ficiait pas de l'assistance d'un fournisseur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un probl√®me distinct √©tait la gestion de l'espace libre, car tout l'espace disque disponible √©tait tr√®s fragment√© sur de nombreux syst√®mes. En cons√©quence, les inconv√©nients de l'administration et le co√ªt √©lev√© de la maintenance d'une flotte de syst√®mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©t√© confront√©s au d√©fi d'optimiser l'infrastructure de stockage afin de r√©duire le co√ªt de possession et d'unification.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La t√¢che a √©t√© analys√©e de mani√®re approfondie par les experts de notre entreprise en tenant compte des exigences des clients en mati√®re de disponibilit√© des donn√©es, IOPS, RPO / RTO, ainsi que de la possibilit√© de mettre √† niveau l'infrastructure existante.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la mise en oeuvre</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les principaux acteurs du march√© des syst√®mes de stockage de milieu de gamme (et sup√©rieurs) sont IBM avec Storwize; Fujitsu, repr√©sent√© par la ligne Eternus, et NetApp avec la s√©rie FAS. En tant que syst√®me de stockage r√©pondant aux exigences donn√©es, ces syst√®mes ont √©t√© consid√©r√©s, √† savoir: IBM Storwize V7000U, Fujitsu Eternus DX100, NetApp FAS2620. Tous les trois sont Unified-SHD, c'est-√†-dire qu'ils fournissent √† la fois un acc√®s par bloc et un acc√®s aux fichiers, et fournissent des indicateurs de performance proches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais dans le cas du Storwize V7000U, l'acc√®s aux fichiers est organis√© via un contr√¥leur s√©par√© - un module de fichiers qui se connecte au contr√¥leur de bloc principal, ce qui constitue un point de d√©faillance suppl√©mentaire. De plus, ce syst√®me est relativement difficile √† g√©rer et n'assure pas une bonne isolation des services.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le syst√®me de stockage Eternus DX100, √©tant √©galement un syst√®me de stockage unifi√©, a de s√©rieuses limitations sur le nombre de syst√®mes de fichiers cr√©√©s, sans donner l'isolement n√©cessaire. De plus, le processus de cr√©ation d'un nouveau syst√®me de fichiers prend beaucoup de temps (jusqu'√† une demi-heure). Les deux syst√®mes d√©crits ne permettent pas de partager des serveurs CIFS / NFS utilis√©s au niveau du r√©seau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tenant compte de tous les param√®tres, y compris le co√ªt total de possession du syst√®me, NetApp FAS2620 a √©t√© choisi, compos√© d'une paire de contr√¥leurs fonctionnant en mode actif-actif, et permettant de r√©partir la charge entre les contr√¥leurs. Et lorsqu'il est combin√© avec les m√©canismes int√©gr√©s de d√©duplication et de compression en ligne, il peut consid√©rablement √©conomiser sur l'espace occup√© par les donn√©es sur les disques. Ces m√©canismes deviennent beaucoup plus efficaces lors de l'agr√©gation de donn√©es sur un syst√®me par rapport √† la situation initiale, lorsque des donn√©es potentiellement identiques √©taient localis√©es sur diff√©rents syst√®mes de stockage et qu'il √©tait impossible de les d√©dupliquer entre elles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tel syst√®me a permis de placer tous les types de services sous le contr√¥le d'un seul cluster de basculement: SAN sous forme de blocs de virtualisation et NAS sous forme de CIFS, partages NFS pour les donn√©es utilisateurs Windows et syst√®mes * nix. Dans le m√™me temps, il restait la possibilit√© d'une s√©paration logique s√ªre de ces services gr√¢ce √† la technologie SVM (Storage Virtual Machine): les services responsables des diff√©rents composants n'affectent pas les ¬´voisins¬ª et ne leur permettent pas d'y acc√©der. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est √©galement possible d'isoler les services au niveau du disque, en √©vitant l'affaissement des performances sous une forte charge des "voisins".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les services qui n√©cessitent une lecture / √©criture rapide, vous pouvez utiliser un type hybride de matrice RAID, en ajoutant plusieurs SSD √† l'agr√©gat HDD. </font><font style="vertical-align: inherit;">Le syst√®me lui-m√™me y placera des donn√©es ¬´√† chaud¬ª, r√©duisant ainsi la latence de lecture des donn√©es fr√©quemment utilis√©es. </font><font style="vertical-align: inherit;">Cela s'ajoute au cache NVRAM, qui garantit son atomicit√© et son int√©grit√© en plus de la vitesse d'√©criture √©lev√©e (les donn√©es seront stock√©es dans la NVRAM aliment√©e par la batterie jusqu'√† ce que la confirmation de leur enregistrement complet soit re√ßue du syst√®me de fichiers) en cas de panne de courant soudaine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s la migration des donn√©es vers un nouveau syst√®me de stockage, il devient possible d'utiliser plus efficacement l'espace disque du cache.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cot√©s positifs</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme mentionn√© ci-dessus, l'utilisation de ce syst√®me a permis de r√©soudre deux probl√®mes √† la fois: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Unification</font></font></b><br>
<br>
<ul>
<li>     ,    ,     ,   .</li>
<li>       .    ,     LUN,            .</li>
<li>   .    ,     .     ,    Ethernet  Fiber Channel   .</li>
<li>          ,     ,     .         .</li>
</ul><br>
<b>‚Äî </b><br>
<br>
<ul>
<li>   NetApp  SVM (Storage Virtual Machine),     ,   ,     .        SVM,     .          /.</li>
<li>    .<br>
 SVM      ,       ,  VLAN-.  ,              SVM,      VLAN‚Äô.  ,     trunk-.<br>
    iSCSI-,     SAN-      ,        , ¬´ ¬ª    .<br>
</li>
<li>     .<br>
      - RAID- (     RAID-   ),          Volume. Volume  SVM‚Äô,       SVM‚Äô   .     ¬´¬ª  , ¬´¬ª  SVM‚Äô  .<br>
        RAID-    ,        .<br>
</li>
</ul><br>
<b>‚Äî </b><br>
<br>
<ul>
<li>                .          RAID-,    .</li>
<li>           (CPU, RAM).           storage-,     ,   IO-,      .</li>
<li> NetApp  S3-       ,          on-premise    , .</li>
</ul><br>
<h4> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Apr√®s avoir r√©duit tous les services sous le contr√¥le d'un syst√®me, nous pr√©voyons un impact plus important en d√©sactivant un composant (1 contr√¥leur sur 2 contre 1 sur 10+ dans l'ancienne infrastructure). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Diminution de la distribution des infrastructures de stockage. </font><font style="vertical-align: inherit;">Si les syst√®mes de stockage ant√©rieurs pouvaient √™tre situ√©s √† diff√©rents √©tages / dans diff√©rents b√¢timents, maintenant tout est concentr√© dans un seul rack. </font><font style="vertical-align: inherit;">Cet √©l√©ment peut √™tre compens√© en achetant un syst√®me moins efficace et en utilisant la r√©plication synchrone / asynchrone en cas de force majeure.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration √©tape par √©tape</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En raison de la confidentialit√© des informations, il est impossible de faire des captures d'√©cran de l'environnement r√©el du client. Les √©tapes de configuration sont donc affich√©es dans l'environnement de test et r√©p√®tent compl√®tement les √©tapes effectu√©es dans l'environnement productif du client. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/f1/ko/1t/f1ko1tluxp7grrcm0vfi6iwe1vw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'√©tat initial du cluster. Deux agr√©gats pour les partitions racine des n≈ìuds de cluster clus01_01 et clus01_02 correspondants </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/5f/-n/k1/5f-nk1hym-z5y7v92zqlvmnjgwe.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'agr√©gats pour les donn√©es. Chaque n≈ìud poss√®de son propre agr√©gat compos√© d'une matrice RAID-DP. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/d8/id/5w/d8id5wywwsh0fpnjof0ag10ucyq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sultat: deux agr√©gats ont √©t√© cr√©√©s: rg0_node02, rg1_node01. Il n'y a pas encore de donn√©es les concernant. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/pb/7q/xz/pb7qxz8bpdoyxxvh76b_ud8vwis.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation de SVM en tant que serveur CIFS. Pour SVM, il est obligatoire de cr√©er un volume racine pour lequel l'agr√©gat racine est s√©lectionn√© - rg1_node01. Ce volume stockera les param√®tres SVM individuels.</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/pp/jv/_b/ppjv_brwqb09psalyq0cue4ftru.png"><br>
<i> CIFS-  SVM.   IP-   .,      .       VLAN-,   LACP .      Volume   ,   ,       .</i><br>
<br>
<img src="https://habrastorage.org/webt/vj/9w/tm/vj9wtmzdhhm0brl9s7fr2vrz8ro.png"><br>
<i>      ,        .        4,9  ,    .        .</i><br>
<br>
<img src="https://habrastorage.org/webt/ha/sy/2h/hasy2hzg7gzbn3p486hoivjwk0i.png"><br>
<i> SVM   iSCSI-.   ,     Root Volume  .         CIFS-  IP-   iSCSI-, .  ,     (LUN),    .</i><br>
<br>
<img src="https://habrastorage.org/webt/lw/ui/or/lwuiorx2n-cxtgehsnkes7dvjj4.png"><br>
<i> LUN  10 .     ,     .</i><br>
<br>
<img src="https://habrastorage.org/webt/if/p1/og/ifp1ogwj-7c84uv6jr5f7vsotws.png"><br>
<i>     Hyper-V Server    iqn.</i><br>
<br>
<img src="https://habrastorage.org/webt/tg/mj/35/tgmj35rac-x-uswp0sttjp8int4.png"><br>
<i>   Hyper-V Server LUN         Linux.       Volume,   ,   ,    .     LUN     ,        .</i></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr487742/index.html">N√©gociation d'arbitrage (algorithme Bellman-Ford)</a></li>
<li><a href="../fr487744/index.html">FARO pr√©sente le scanner laser laser FOCUS S 70</a></li>
<li><a href="../fr487746/index.html">√âternel</a></li>
<li><a href="../fr487748/index.html">Cl√© de chiffrement mat√©riel √† 3 $ - est-ce possible?</a></li>
<li><a href="../fr487750/index.html">Quelques subtilit√©s des collections d'injection au printemps</a></li>
<li><a href="../fr487754/index.html">Organisation de l'intranet (automatisation de la production informatique). Partie 1 - Utilisateurs et courrier</a></li>
<li><a href="../fr487756/index.html">RIT, Maxim Lapshin (Erlyvideo): comment un programmeur pour faire cro√Ætre une entreprise</a></li>
<li><a href="../fr487764/index.html">J'ai 14 ans et je combine l'√©cole avec le travail en informatique</a></li>
<li><a href="../fr487768/index.html">Ouverture des ports 4321 et 9898 sur Xiaomi Gateway 2</a></li>
<li><a href="../fr487772/index.html">Rencontrez la langue tchouvache dans Yandex.Translate: comment nous r√©solvons le principal probl√®me de la traduction automatique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>