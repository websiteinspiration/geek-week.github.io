<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™ŒğŸ¾ ğŸ‘ğŸ» ğŸ‘©ğŸ¿â€ğŸš’ JOOQå’Œä»–çš„å…”å­æ´ã€‚å¦‚ä½•åœ¨æ²¡æœ‰å†¬çœ çš„æƒ…å†µä¸‹ç”Ÿå­˜ ğŸ‘©ğŸ½â€ğŸ­ â—ï¸ ğŸ‘´ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¸ä¼šæ·¹æ²¡JOOQã€‚æˆ‘æ›´å–œæ¬¢HibernateåŠå…¶èƒŒåçš„æ‰€æœ‰Spring Data JPAåŠŸèƒ½ã€‚ä½†æ˜¯æœ¬æ–‡å°†ä¸æ¶‰åŠå®ƒä»¬ã€‚
 
 
 
 å½“æˆ‘ä»¬ä½¿ç”¨Hibernateå’ŒSpring Data JPAæ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘å†…éƒ¨æµç¨‹-äº†è§£æ³¨é‡Šå¹¶åœ¨å­˜å‚¨åº“ä¸­ç¼–å†™æ­£ç¡®çš„æ–¹æ³•åç§°-è¿™ä¸¤ä¸ªæ€ªç‰©å°†ä¸ºæ‚¨å®Œæˆå…¶ä½™å·¥ä½œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>JOOQå’Œä»–çš„å…”å­æ´ã€‚å¦‚ä½•åœ¨æ²¡æœ‰å†¬çœ çš„æƒ…å†µä¸‹ç”Ÿå­˜</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488522/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¸ä¼šæ·¹æ²¡JOOQã€‚</font><font style="vertical-align: inherit;">æˆ‘æ›´å–œæ¬¢HibernateåŠå…¶èƒŒåçš„æ‰€æœ‰Spring Data JPAåŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æœ¬æ–‡å°†ä¸æ¶‰åŠå®ƒä»¬ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wt/-0/co/wt-0condklmkd6zkb2ag_a46vb4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æˆ‘ä»¬ä½¿ç”¨Hibernateå’ŒSpring Data JPAæ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘å†…éƒ¨æµç¨‹-äº†è§£æ³¨é‡Šå¹¶åœ¨å­˜å‚¨åº“ä¸­ç¼–å†™æ­£ç¡®çš„æ–¹æ³•åç§°-è¿™ä¸¤ä¸ªæ€ªç‰©å°†ä¸ºæ‚¨å®Œæˆå…¶ä½™å·¥ä½œã€‚</font><font style="vertical-align: inherit;">å¯¹äºJOOQè€Œè¨€ï¼Œä¸å¹¸çš„æ˜¯ï¼Œå¯¹äºè®¸å¤šäººæ¥è¯´ï¼Œè¿™å°†èŠ±è´¹ä¸€äº›ç²¾åŠ›ï¼Œå¹¶ä¸”è¦æ¯”</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">findAllByUserIdï¼ˆLong userIdï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–å†™æ›´å¤šå†…å®¹</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»€ä¹ˆæ˜¯JOOQï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„SQLæŸ¥è¯¢ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> countries c <span class="hljs-keyword">where</span> c.population &gt; <span class="hljs-number">10000000</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œæ­¤è¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">å¥½çš„ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æ„Ÿè§‰å¥½åƒä¸åœ¨æ§åˆ¶å°ä¸­ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå‘é€æ­¤è¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">å®ƒä¸æ˜¯ä¸€æ¬¡æ€§è„šæœ¬ï¼Œå¹¶ä¸”è‡³å°‘å·²é’ˆå¯¹è¯­æ³•è¿›è¡Œäº†éªŒè¯ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬é€šè¿‡Spring Data JPAåšåˆ°è¿™ä¸€ç‚¹ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">List&lt;Country&gt; <span class="hljs-title">findAllByPopulationAfter</span><span class="hljs-params">(Long amount)</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ä¸Šé¢ç›¸åŒçš„è¯·æ±‚è¢«æ‰§è¡Œï¼Œä½†æ˜¯ç”±Springæ‰§è¡Œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ç§æ–¹æ³•çš„æ˜æ˜¾ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">å®ƒç”±åŠŸèƒ½å¼ºå¤§çš„æ¡†æ¶æ‰§è¡Œï¼›å®ƒè¿˜éªŒè¯å¯¹é”™è¯¯çš„è¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æŸ¥è¯¢ç®¡ç†è´Ÿè´£æ¡†æ¶ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¸Œæœ›åŒæ—¶å®Œå…¨ç®¡ç†è¯¥è¯·æ±‚ï¼Œä»¥ä¾¿å®Œå…¨éªŒè¯è¯¥è¯·æ±‚ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡‡ç”¨</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¢é—®</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Query("select c from Country c where c.population &gt; :amount")</span>
<span class="hljs-function">List&lt;Country&gt; <span class="hljs-title">findAllPopulationGreaterThan</span><span class="hljs-params">(<span class="hljs-meta">@Param("amount")</span> Long amount)</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨SQLå’ŒDSLä¹‹é—´è¿›è¡Œè¿™ç§æŠ˜è¡·ä¹Ÿå¾ˆå¥½ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³å¼„ä¹±SQLï¼Œæˆ‘ä»¬å°†å¾ˆé«˜å…´çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">return</span> dsl.selectFrom(COUNTRIES)<font></font>
                .where(COUNTRIES.POPULATION.greaterThan(amount))<font></font>
                .fetch();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€äº›åº“éƒ½é€‚åˆè¿™æ ·çš„ï¼š</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QueryDSL </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JOOQ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speedment</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å…³äºQueryDSLæˆ‘</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ä¸ªå†™äº†</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ å¹´å‰ã€‚</font><font style="vertical-align: inherit;">æˆ‘æ²¡æœ‰ç ”ç©¶Speedmentï¼Œä½†å®ƒä¼¼ä¹ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„DSLç”Ÿæˆå™¨ï¼Œè€Œä¸”æˆ‘è¿˜å¿…é¡»å­¦ä¹ ä»–ä»¬åŠ å¯†SQLæŸ¥è¯¢å‘½ä»¤çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">ä¸€èˆ¬æ¥è¯´ï¼Œä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºJOOQã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JOOQæŸ¥è¯¢</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯çš„ï¼Œæˆ‘ä»¬å·²ç»åœ¨ä¸Šé¢çœ‹åˆ°äº†ä»¥ä¸‹æŸ¥è¯¢ä¹‹ä¸€ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">return</span> dsl.selectFrom(COUNTRIES)<font></font>
                .where(COUNTRIES.POPULATION.greaterThan(amount))<font></font>
                .fetch();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜æœ‰ä»€ä¹ˆï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œä¸€ä¸ªç®€å•çš„getè¯·æ±‚ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">return</span> dsl.selectFrom(Countries.COUNTRIES)<font></font>
                .where(Countries.COUNTRIES.ID.eq(id))<font></font>
                .fetchAny();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ–æ’å…¥è¯·æ±‚ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)<font></font>
                .set(Countries.COUNTRIES.NAME, country.getName())<font></font>
                .set(Countries.COUNTRIES.POPULATION, country.getPopulation())<font></font>
                .set(Countries.COUNTRIES.GOVERNMENT_FORM, nameOrNull(country.getGovernmentForm()))<font></font>
                .returning()<font></font>
                .fetchOne();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œä¸€åˆ‡éƒ½æ¸…æ¥šäº†ï¼Œä»…æ­¤è€Œå·²ã€‚</font><font style="vertical-align: inherit;">ä½†è¿™åªæ˜¯ä¹çœ‹ä¹‹ä¸‹ã€‚</font><font style="vertical-align: inherit;">æ‰¾å‡ºè¿™ä¸ªå…”å­æ´æœ‰å¤šæ·±å¯èƒ½éœ€è¦å‡ ä¸ªæ˜ŸæœŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬ä»å¤´å¼€å§‹ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œå®ƒå°†æˆä¸ºä¸“å®¶</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æ›´å–œæ¬¢Gradleã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯å‡ºäºæŸç§åŸå› ï¼ŒJOOQå¼€å‘äººå‘˜å¯¹Gradleçš„å…³æ³¨åº¦é™ä½äº†ï¼Œä»–ä»¬é€‰æ‹©äº†ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚</font><font style="vertical-align: inherit;">å¥½çš„ï¼ŒåŸ¹è®­é¡¹ç›®å°†åœ¨Mavenä¸Šè¿›è¡Œã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œäº²çˆ±çš„è¯»è€…ï¼Œå¦‚æœæ‚¨åœ¨githubçš„æ·±å¤„ç¿»é˜…ï¼Œå¹¶ä¸”å‡†å¤‡åœ¨Gradleä¸Šå±•ç¤ºä¸€ä¸ªå®Œå…¨è‡ªå®šä¹‰çš„é¡¹ç›®ï¼Œè¯·å†™ä¿¡ç»™æˆ‘ï¼Œæ‚¨å°†æˆä¸ºæœ¬æ–‡çš„åˆè‘—è€…ã€‚</font><font style="vertical-align: inherit;">H2åŒæ ·é€‚ç”¨ï¼ˆåŸ¹è®­é¡¹ç›®å°†åœ¨PostgreSQLä¸Šï¼‰ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆæˆ‘åœ¨Gradleå’ŒH2ä¸Šæ²¡æœ‰æˆåŠŸ</font></font></b><div class="spoiler_text">    ,      Gradle.           jooq-generator .          H2,  Â«  Â»   H2         ,   ,  ,     .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¿…è¦çš„Mavenä¾èµ–é¡¹ï¼š</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><font></font>
<font></font>
        <span class="hljs-comment">&lt;!-- Spring Starters --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-jooq<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><font></font>
<font></font>
        <span class="hljs-comment">&lt;!-- Database --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.flywaydb<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flyway-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.postgresql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>postgresql<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><font></font>
<font></font>
        <span class="hljs-comment">&lt;!-- Helpers --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${commons.lang3.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><font></font>
<font></font>
        <span class="hljs-comment">&lt;!--Test --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><font></font>
<font></font>
        <span class="hljs-comment">&lt;!-- JOOQ Generator --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.jooq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jooq<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${jooq.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.jooq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jooq-meta<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${jooq.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.jooq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jooq-codegen<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${jooq.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Springå·²ç»æœ‰ä¸€ä¸ªJOOQå¯åŠ¨å™¨ï¼Œå®ƒå°†æ ¹æ®application.ymlä¸­çš„æŒ‡å®šè®¾ç½®è‡ªé…ç½®DataSourceã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯å¯¹äºJOOQçš„å…¨éƒ¨å·¥ä½œæ¥è¯´ï¼Œè¿™è¿˜ä¸å¤Ÿã€‚</font><font style="vertical-align: inherit;">å¿…é¡»äº§ç”Ÿå®ä½“ã€‚</font><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œæ˜¯çš„ï¼Œæˆ‘ä»¬ä¸ç¼–å†™å®ä½“ï¼Œè€Œæ˜¯ç”Ÿæˆå®ƒä»¬ã€‚</font><font style="vertical-align: inherit;">æ‰€è°“è¡¨ä¼˜å…ˆçš„æ–¹æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸“æ³¨äºä½¿ç”¨æ•°æ®åº“çš„å¸¸è§„åº”ç”¨ç¨‹åºç»“æ„å¦‚ä¸‹ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c-/pz/tp/c-pztpdxbkn5kxot-s_08tzlzbk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœåŠ¡å±‚ä¹‹å‰ï¼Œæ•°æ®ä»¥å¹³é¢æ¨¡å‹ï¼ˆDTOï¼‰çš„å½¢å¼åœ¨åº”ç”¨ç¨‹åºä¸­ä¼ æ’­ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œå½“æœåŠ¡éœ€è¦ä½¿ç”¨æ•°æ®åº“æ—¶ï¼Œå®ƒå°†DTOè½¬æ¢ä¸ºå®ä½“ï¼Œå°†å…¶å‘é€åˆ°å­˜å‚¨åº“ï¼Œå¹¶ä¸”è¯¥DTOå·²ç»å°†å…¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚</font><font style="vertical-align: inherit;">JOOQå¼€å‘äººå‘˜å¯¹äº‹ç‰©çš„çœ‹æ³•æœ‰æ‰€ä¸åŒï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/wy/4b/vvwy4bbp1ox57f4j0edmulfe7ni.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œåœ¨JOOQä¸­ï¼Œä»–ä»¬è®¤çœŸä¿®æ”¹äº†æ ‡å‡†æ¨¡å¼å¹¶å†³å®šèµ°è‡ªå·±çš„è·¯ã€‚</font><font style="vertical-align: inherit;">å·®å¼‚éå¸¸æ˜æ˜¾ï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DTOè½¬æ¢ä¸ºå®ä½“å·²ç»åœ¨å­˜å‚¨åº“ä¸­è¿›è¡Œã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä¸ä¼šè¿™æ ·å†™å®ä½“ã€‚</font><font style="vertical-align: inherit;">å®ƒæ˜¯ç”±JOOQç”Ÿæˆå™¨ä¸ºæˆ‘ä»¬ç¼–å†™çš„ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å·²ç»è¶³ä»¥å¾—å‡ºç»“è®ºï¼ŒJOOQå¹¶ä¸æ˜¯é‚£ä¹ˆç®€å•ã€‚</font><font style="vertical-align: inherit;">é«˜åº¦å¯å®šåˆ¶çš„ç”Ÿæˆå®ä½“ï¼ŒDTOä¸­éš¾ä»¥ç†è§£çš„æ˜ å°„ä»¥åŠå…¶ä»–å›°éš¾å°†å“è·‘è®¸å¤šäººã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œåœ¨æ— å¤„å¯å»çš„æƒ…å†µä¸‹ï¼Œå¯¹JOOQçš„è¿™äº›æ–¹é¢è¿›è¡Œå®šå‘ç ”ç©¶å¯èƒ½ä¼šä¸¥é‡å¸¦èµ°å¹¶èŠ±è´¹æ•°å¤©ç”šè‡³æ•°å‘¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘ç›¸ä¿¡æˆ‘çš„å¸–å­å°†å¤§å¤§èŠ‚çœæ‚¨çš„æ—¶é—´ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä»‹ç»ä¸JOOQåˆä½œçš„ä»¥ä¸‹æ–¹é¢ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ä½“ç”Ÿæˆã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–å†™CRUDæŸ¥è¯¢ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼˜åŒ–CRUDè¯·æ±‚ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜æœ‰å¦ä¸€ä¸ªCRUDè¯·æ±‚ä¼˜åŒ–ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨æ ‡å‡†çš„JOOQåº“æ˜ å°„å®ä½“ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶è®¨è®ºä¸ºä»€ä¹ˆæ‰€æœ‰è¿™äº›éƒ½æ˜¯å¿…è¦çš„ã€‚ </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬èµ°å§ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å†™ä»€ä¹ˆï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬çš„é¡¹ç›®å°†æœ‰ä¸¤ä¸ªå®ä½“ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›½å®¶/åœ°åŒºï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Country</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> GovernmentForm governmentForm;
    <span class="hljs-keyword">private</span> Integer population;<font></font>
<font></font>
    <span class="hljs-keyword">private</span> List&lt;City&gt; cities;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¸‚ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">City</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> Long countryId;
    <span class="hljs-keyword">private</span> String name;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€å¯¹å¤šå…³ç³»ã€‚</font><font style="vertical-align: inherit;">å›½å®¶åŒ…å«è®¸å¤šç›¸å…³çš„åŸå¸‚ã€‚</font><font style="vertical-align: inherit;">åŸå¸‚åŒ…å«countryIdã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flywayè¿ç§»çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> countries<font></font>
(<font></font>
    <span class="hljs-keyword">id</span>              bigserial primary <span class="hljs-keyword">key</span>,
    <span class="hljs-keyword">name</span>            <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),<font></font>
    government_form <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>),<font></font>
    population      <span class="hljs-built_in">int</span><font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> cities<font></font>
(<font></font>
    <span class="hljs-keyword">id</span>         bigserial primary <span class="hljs-keyword">key</span>,<font></font>
    country_id <span class="hljs-built_in">bigint</span>,
    <span class="hljs-keyword">name</span>       <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>)<font></font>
);</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä»å®ä½“ç”Ÿæˆå¼€å§‹ã€‚</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘æ‰€è¯´ï¼Œå®ä½“æ˜¯åˆ†åˆ«ç”Ÿæˆçš„ã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡Mavenæ’ä»¶ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨Javaä»£ç ç¼–å†™ã€‚ </font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨Mavenä¸­ç”Ÿæˆå®ä½“</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“é¡¹ç›®ç”Ÿæˆæ—¶ï¼ŒMavenå¯åŠ¨ç”Ÿæˆå™¨å¹¶ç”Ÿæˆå®ä½“ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœ¨ä»»ä½•æ–¹ä¾¿çš„æ—¶é—´è°ƒç”¨ç”Ÿæˆå™¨å¹¶ç”Ÿæˆå®ä½“ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå½“åŸºåº§çš„ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™æ˜¯å¿…éœ€çš„ã€‚</font><font style="vertical-align: inherit;">Mavenä¸­çš„æ’ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="xml hljs">            <span class="hljs-comment">&lt;!-- JOOQ Generator Plugin --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.jooq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jooq-codegen-maven<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${jooq.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>generate-sources<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>generate<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">jdbc</span>&gt;</span>  <span class="hljs-comment">&lt;!--    --&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">driver</span>&gt;</span>${db.driver}<span class="hljs-tag">&lt;/<span class="hljs-name">driver</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>${db.url}<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span>${db.username}<span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>${db.password}<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">jdbc</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">generator</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">database</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span>.*<span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span>  <span class="hljs-comment">&lt;!--     --&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">excludes</span>&gt;</span>  <span class="hljs-comment">&lt;!--     --&gt;</span><font></font>
                                flyway_schema_history<font></font>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">excludes</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">inputSchema</span>&gt;</span>public<span class="hljs-tag">&lt;/<span class="hljs-name">inputSchema</span>&gt;</span>  <span class="hljs-comment">&lt;!--  --&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">database</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">generate</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">records</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">records</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">generate</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">target</span>&gt;</span>
                            <span class="hljs-comment">&lt;!--      --&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">packageName</span>&gt;</span>ru.xpendence.jooqexample.domain<span class="hljs-tag">&lt;/<span class="hljs-name">packageName</span>&gt;</span>
                            <span class="hljs-comment">&lt;!--  .    target. --&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>target/generated-sources/jooq<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">target</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">generator</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨æ­£ç¡®æ‰§è¡Œäº†æ‰€æœ‰æ“ä½œï¼Œè¯·æ›´æ–°Mavenï¼Œç„¶ååœ¨æ’ä»¶ä¸­çœ‹åˆ°jooq-codegenã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1n/ch/pv/1nchpvafnxml7qle_dfsq1zsuje.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œã€‚å®ƒå°†ä¸ºæ‚¨ç”Ÿæˆå®ä½“ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cs/kf/la/cskfla2pzxfkm-vkot_dcggqoia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™äº›æ˜¯ç”¨äºè®¿é—®æ•°æ®åº“çš„å®ä½“ã€‚ç¬¬ä¸€ä¸ªéº»çƒ¦ï¼šå®ƒä»¬æ˜¯ä¸€æˆä¸å˜çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯ç±»å‹æ›´æ”¹ä»¥ä¸€ç§äººä¸ºè®¾è®¡çš„æ–¹å¼å‘ç”Ÿï¼Œå› æ­¤è¯¥è¿‡ç¨‹æè¿°å°†è¢«æ‹‰åˆ°å•ç‹¬çš„æ–‡ç« ä¸­ã€‚å› æ­¤ï¼Œå°è¯•åœ¨è¡¨ç”Ÿæˆé˜¶æ®µè€ƒè™‘æ•°æ®ç±»å‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ä½“çœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯CountrysRecordç±»çš„ç­¾åï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CountriesRecord</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">UpdatableRecordImpl</span>&lt;<span class="hljs-title">CountriesRecord</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Record4</span>&lt;<span class="hljs-title">Long</span>, <span class="hljs-title">String</span>, <span class="hljs-title">String</span>, <span class="hljs-title">Integer</span>&gt; </span>{
    <span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒCountryRecordå®ç°äº†Record4ï¼Œå®ƒç”±4ç§ç±»å‹æ¥é”®å…¥ã€‚</font><font style="vertical-align: inherit;">å›½å®¶è¡¨æœ‰4åˆ—ï¼Œå› æ­¤ä¸ºRecord4ã€‚</font><font style="vertical-align: inherit;">åŸå¸‚ä¸­æœ‰3åˆ—ï¼Œå› æ­¤ä¸ºRecord3ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™æ ·å‘æ˜ã€‚</font><font style="vertical-align: inherit;">JOOQåº“ä¸­æœ‰22ä¸ªè¿™æ ·çš„è®°å½•ï¼Œå³Record1 ... Record22ã€‚</font><font style="vertical-align: inherit;">ä»ä¸­å¯ä»¥å¾—å‡ºç»“è®ºï¼ŒJOOQçš„åŠŸèƒ½ä»…é™äºå¤„ç†æœ€å¤š22åˆ—çš„è¡¨ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚</font><font style="vertical-align: inherit;">æˆ‘æœ‰åŒ…å«æ•°ååˆ—çš„è¡¨ï¼ŒJOOQåªæ˜¯ç«‹å³å®ç°Recordã€‚</font><font style="vertical-align: inherit;">å¥½å§ï¼Œ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”¨Javaä»£ç ç”ŸæˆJOOQå®ä½“çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AfterStartupApplicationListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationListener</span>&lt;<span class="hljs-title">ContextRefreshedEvent</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.datasource.driver-class-name}")</span>
    <span class="hljs-keyword">private</span> String driver;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.datasource.url}")</span>
    <span class="hljs-keyword">private</span> String url;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.datasource.username}")</span>
    <span class="hljs-keyword">private</span> String username;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${spring.datasource.password}")</span>
    <span class="hljs-keyword">private</span> String password;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${jooq.generator.database.name}")</span>
    <span class="hljs-keyword">private</span> String databaseName;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${jooq.generator.database.with-includes}")</span>
    <span class="hljs-keyword">private</span> String databaseWithIncludes;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${jooq.generator.database.with-input-schema}")</span>
    <span class="hljs-keyword">private</span> String databaseWithInputSchema;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${jooq.generator.target.package-name}")</span>
    <span class="hljs-keyword">private</span> String targetPackageName;<font></font>
<font></font>
    <span class="hljs-meta">@Value("${jooq.generator.target.directory}")</span>
    <span class="hljs-keyword">private</span> String targetDirectory;<font></font>
<font></font>
    <span class="hljs-meta">@SneakyThrows</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onApplicationEvent</span><span class="hljs-params">(ContextRefreshedEvent contextRefreshedEvent)</span> </span>{
        <span class="hljs-keyword">new</span> GenerationTool().run(configureGenerator());<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> Configuration <span class="hljs-title">configureGenerator</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Configuration()<font></font>
                .withJdbc(<span class="hljs-keyword">new</span> Jdbc()<font></font>
                        .withDriver(driver)<font></font>
                        .withUrl(url)<font></font>
                        .withUser(username)<font></font>
                        .withPassword(password))<font></font>
                .withGenerator(<span class="hljs-keyword">new</span> Generator()<font></font>
                        .withDatabase(<span class="hljs-keyword">new</span> Database()<font></font>
                                .withName(databaseName)<font></font>
                                .withIncludes(databaseWithIncludes)<font></font>
                                .withExcludes(<span class="hljs-string">""</span>)<font></font>
                                .withInputSchema(databaseWithInputSchema))<font></font>
                        .withTarget(<span class="hljs-keyword">new</span> Target()<font></font>
                                .withPackageName(targetPackageName)<font></font>
                                .withDirectory(targetDirectory)));<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±æˆ‘è€Œè¨€ï¼Œå½“æ‰€æœ‰æ–°çš„è¿ç§»éƒ½æ±‡æ€»å¹¶ä¸”æ•°æ®åº“æ˜¯æœ€æ–°çš„æ—¶ï¼Œç”Ÿæˆå™¨å°†åœ¨åº”ç”¨ç¨‹åºå®Œå…¨å¯åŠ¨åå¯åŠ¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæˆ‘ä»¬æœ‰æ¨¡å‹ï¼Œæœ‰å®ä½“ï¼Œæœ‰åŸºç¡€ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨è¯¥åˆ›å»ºå­˜å‚¨åº“å¹¶ç¼–å†™æŸ¥è¯¢äº†ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºå­˜å‚¨åº“</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰è¯·æ±‚éƒ½é€šè¿‡DslContextã€‚</font><font style="vertical-align: inherit;">é‡å¤DslContextã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Repository</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CountryRepository</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CrudRepository</span>&lt;<span class="hljs-title">Country</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DSLContext dsl;<font></font>
<font></font>
} </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å­˜å‚¨åº“å·²å‡†å¤‡å°±ç»ªã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–å†™CRUDæŸ¥è¯¢</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ’</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœä½¿ç”¨SQLï¼Œåˆ™æ·»åŠ å¦ä¸€ä¸ªå›½å®¶/åœ°åŒºçš„è¯·æ±‚å°†æ˜¯ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> countries(<span class="hljs-keyword">name</span>, government_form, population)
<span class="hljs-keyword">values</span> (<span class="hljs-string">' -'</span>, <span class="hljs-string">'UNITARY'</span>, <span class="hljs-number">100500</span>) <span class="hljs-keyword">returning</span> *;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨JOOQä¸­ï¼ŒæŸ¥è¯¢å°½å¯èƒ½æ¥è¿‘SQLè¯­æ³•ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">insertValues</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)  <span class="hljs-comment">//insert into countries</span>
                .values(country.getId(), country.getName(), country.getPopulation(), nameOrNull(country.getGovernmentForm()))  <span class="hljs-comment">//values (? ? ? ?)</span>
                .returning()  <span class="hljs-comment">//returning</span>
                .fetchOne()  <span class="hljs-comment">//*</span><font></font>
                .into(Country.class);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œè¿™æ ·çš„è¯·æ±‚ä¸é€‚åˆæˆ‘ä»¬ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼ŒIDæ˜¯åœ¨æ•°æ®åº“ä¸­ç”Ÿæˆçš„ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬è¿™æ ·å†™ï¼š</font></font><br>
<br>
<pre><code class="java hljs">.values(<span class="hljs-keyword">null</span>, country.getName(), country.getPopulation(), nameOrNull(country.getGovernmentForm()))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ä¼šå¾—åˆ° </font></font><br>
<br>
<pre><code class="java hljs">org.postgresql.util.PSQLException: :     <span class="hljs-string">"id"</span>   NOT NULL</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºç«¯ç”Ÿæˆäº†IDï¼Œé‚£ä¹ˆè¿™æ ·çš„è¯·æ±‚å°†æ˜¯ä¸€ä¸ªæ—…ç¨‹ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä¸å¾—ä¸é‡å†™è¯·æ±‚ï¼Œä¸ºæ¯ä¸ªå­—æ®µæŒ‡å®šä¸€ä¸ªç‰¹å®šå€¼ã€‚</font><font style="vertical-align: inherit;">æ‰€ä»¥ä½ å¯ä»¥ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">insert</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)<font></font>
                .set(Countries.COUNTRIES.NAME, country.getName())<font></font>
                .set(Countries.COUNTRIES.POPULATION, country.getPopulation())<font></font>
                .set(Countries.COUNTRIES.GOVERNMENT_FORM, nameOrNull(country.getGovernmentForm()))<font></font>
                .returning()<font></font>
                .fetchOne()<font></font>
                .into(Country.class);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å­—æ®µä¸­æ‰‹åŠ¨è®¾ç½®å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">è¿™ä¸ªé€‰é¡¹å¾ˆæœ‰æ•ˆï¼Œä½†æ˜¯æ›´å¥½ã€‚</font><font style="vertical-align: inherit;">åƒSpring Data JPAä¸€æ ·ï¼Œå‘é€æ•´ä¸ªå¯¹è±¡è¿›è¡Œä¿å­˜æ˜¯ç†æƒ³çš„ï¼š</font></font><br>
<br>
<pre><code class="java hljs">repository.save(country);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯èƒ½æ˜¯è¿™æ ·ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„æ¨¡å‹æ˜ å°„åˆ°extended Recordå®ä½“å¹¶å°†å…¶å‘é€ä»¥è¿›è¡Œä¿å­˜ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">insert</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)<font></font>
                .set(dsl.newRecord(Countries.COUNTRIES, country))  <span class="hljs-comment">//   </span><font></font>
                .returning()<font></font>
                .fetchOptional()<font></font>
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> DataAccessException(<span class="hljs-string">"Error inserting entity: "</span> + country.getId()))<font></font>
                .into(Country.class);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºä¸éœ€è¦é…ç½®æ˜ å°„çš„æƒ…å†µï¼Œæ­¤æ–¹æ³•æ˜¯æœ€ç®€å•ä¸”æœ€å®¹æ˜“ç†è§£çš„ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æ˜ å°„è®¾ç½®ä¼šæ›´ä½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘ä»¬æ³¨æ„åˆ°çš„ï¼Œæ­¤æŸ¥è¯¢è¿”å›æ•´ä¸ªå®ä½“ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœ¨fetchï¼ˆï¼‰æ–¹æ³•ä¸­ç¡®å®šç¡®åˆ‡éœ€è¦è¿”å›çš„å†…å®¹ã€‚</font><font style="vertical-align: inherit;">çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Long <span class="hljs-title">insertAndReturnId</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)<font></font>
                .set(dsl.newRecord(Countries.COUNTRIES, country))<font></font>
                .returning(Countries.COUNTRIES.ID) <span class="hljs-comment">//  Record    - id</span><font></font>
                .fetchOptional()<font></font>
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> DataAccessException(<span class="hljs-string">"Error inserting entity: "</span> + country.getId()))<font></font>
                .get(Countries.COUNTRIES.ID); <span class="hljs-comment">// id</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯åˆè¦æ¯”è¾ƒä¸€ä¸‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ç¼–å†™å…¶ä½™çš„CRUDæ–¹æ³•ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°èµ„æ–™</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SQLæŸ¥è¯¢ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">update</span> countries
<span class="hljs-keyword">set</span> <span class="hljs-keyword">name</span>            = <span class="hljs-string">''</span>,<font></font>
    government_form = <span class="hljs-string">'CONFEDERATE'</span>,<font></font>
    population      = <span class="hljs-number">100500</span>
<span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> = <span class="hljs-number">1</span>
<span class="hljs-keyword">returning</span> *;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JOOQè¯·æ±‚ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">update</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.update(Countries.COUNTRIES)<font></font>
                .set(dsl.newRecord(Countries.COUNTRIES, country))<font></font>
                .where(Countries.COUNTRIES.ID.eq(country.getId()))<font></font>
                .returning()<font></font>
                .fetchOptional()<font></font>
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> DataAccessException(<span class="hljs-string">"Error updating entity: "</span> + country.getId()))<font></font>
                .into(Country.class);<font></font>
    }</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‰æ‹©</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SQLä¸­çš„æŸ¥è¯¢ä¸ºï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">select</span> *
<span class="hljs-keyword">from</span> countries c
<span class="hljs-keyword">where</span> <span class="hljs-keyword">id</span> = ?;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨JOOQä¸­ï¼ŒæŸ¥è¯¢å°†ç›¸åº”åœ°æ˜¾ç¤ºï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">find</span><span class="hljs-params">(Long id)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.selectFrom(Countries.COUNTRIES) <span class="hljs-comment">//select * from countries</span>
                .where(Countries.COUNTRIES.ID.eq(id))  <span class="hljs-comment">//where id = ?</span>
                .fetchAny()  <span class="hljs-comment">// ,    </span><font></font>
                .into(Country.class);<font></font>
    }</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ é™¤</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ‰äº›è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»»ä½•é€€è´§ã€‚</font><font style="vertical-align: inherit;">æ­¤ç±»æŸ¥è¯¢è¿”å›å—å½±å“çš„è¡Œæ•°ã€‚</font><font style="vertical-align: inherit;">åœ¨åˆ é™¤ä¸­ï¼Œæˆ‘ä»¬ä»€ä¹ˆä¹Ÿæ²¡é€€ï¼Œä½†æ˜¯æˆ‘ä»¬æ”¶åˆ°çš„ä¿¡æ¯ä»ç„¶å¯¹æˆ‘ä»¬æœ‰ç”¨ã€‚</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">delete</span><span class="hljs-params">(Long id)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.deleteFrom(Countries.COUNTRIES)<font></font>
                .where(Countries.COUNTRIES.ID.eq(id))<font></font>
                .execute() == <span class="hljs-number">1</span>;<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬åˆ é™¤ä¸€è¡Œã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼ŒSQLæŸ¥è¯¢å°†è¿”å›ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å†…å®¹ï¼š</font></font><br>
<br>
<pre><code class="sql hljs">1 row affected in 5 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”¶åˆ°è¿™æ ·çš„ç­”æ¡ˆåï¼Œæˆ‘ä»¬è‚¯å®šçŸ¥é“è¯¥è¡Œå·²è¢«åˆ é™¤ã€‚</font><font style="vertical-align: inherit;">è¿™è¶³ä»¥å®£å¸ƒæ“ä½œæˆåŠŸã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™ä¸æ˜¯ç«¥è¯ã€‚</font><font style="vertical-align: inherit;">é‚£åªæ˜¯æ¶¦æ»‘å‰‚ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨å¸¸è§„æ˜ å°„å™¨åœ¨Recordä¸­å¯¹å®ä½“è¿›è¡Œç˜¦æ˜ å°„ï¼Œåä¹‹äº¦ç„¶</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â€œå¥½å§ï¼Œâ€è¯»è€…å¯¹è¯»è€…è¯´ï¼Œâ€œä¸€å¯¹å¤šåœ¨å“ªé‡Œï¼Ÿæˆ‘æ²¡æœ‰çœ‹åˆ°ä¹¡æ‘éšä¼—å¤šåŸå¸‚ä¸€èµ·æˆé•¿çš„é‚£ä¸€åˆ»ã€‚â€ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½ ä¼šæ˜¯å¯¹çš„ã€‚è¿™ä¸æ˜¯ä¼‘çœ ï¼›åœ¨è¿™é‡Œæ‚¨å¿…é¡»æ‰‹åŠ¨è¿›è¡Œã€‚æ‚¨æ‰€éœ€è¦åšçš„å°±æ˜¯è·å–ID = country.getIdï¼ˆï¼‰çš„åŸå¸‚åˆ—è¡¨ã€‚æˆ‘å·²ç»å±•ç¤ºäº†intoï¼ˆï¼‰æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨å¸¸è§„æ˜ å°„å™¨å°†Recordæ˜ å°„åˆ°å®ä½“ã€‚ä½†æ˜¯JOOQè¿˜æœ‰ä¸€ä¸ªmapï¼ˆï¼‰æ–¹æ³•ï¼Œä½¿æˆ‘ä»¬å¯ä»¥å¯¹Recordè¿›è¡Œä»»ä½•æ“ä½œã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒçš„åŠŸèƒ½å¹¶æ·»åŠ åŸå¸‚ï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">find</span><span class="hljs-params">(Long id)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.selectFrom(Countries.COUNTRIES)<font></font>
                .where(Countries.COUNTRIES.ID.eq(id))<font></font>
                .fetchAny()<font></font>
                .map(r -&gt; {<font></font>
                    Country country = r.into(Country.class);<font></font>
                    country.setCities(cityRepository.findAll(Cities.CITIES.COUNTRY_ID.eq(country.getId())));<font></font>
                    <span class="hljs-keyword">return</span> country;<font></font>
                });<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æˆ‘ä»¬æ‰€è§ï¼Œç°åœ¨æˆ‘ä»¬é¦–å…ˆæ˜ å°„â€œå›½å®¶/åœ°åŒºä¸­çš„è®°å½•â€ï¼Œç„¶åå†åœ¨åŸå¸‚ä¸­æå‡ºå¦ä¸€ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬è·å¾—äº†è¯¥å›½å®¶/åœ°åŒºçš„æ‰€æœ‰åŸå¸‚å¹¶å°†å…¶è®¾ç½®ä¸ºå®è´¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯å¯ä»¥æœ‰æ•°åä¸ªè¿™æ ·çš„é›†åˆï¼Œè¿™æ„å‘³ç€å¯ä»¥æœ‰æ•°åä¸ªè¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">å¹¶ç›´æ¥åœ¨æ–¹æ³•ä¸­æè¿°è¿™äº›è¯·æ±‚å°±æ˜¯è¿™æ ·ã€‚</font><font style="vertical-align: inherit;">æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„æ˜ å°„å™¨ï¼Œå¹¶å°†æ‰€æœ‰è¿™äº›è¯·æ±‚æ”¾åœ¨æ­¤å¤„ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CountryRecordMapper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">RecordMapper</span>&lt;<span class="hljs-title">CountriesRecord</span>, <span class="hljs-title">Country</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CityRepository cityRepository;<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">map</span><span class="hljs-params">(CountriesRecord record)</span> </span>{<font></font>
        Country country = record.into(Country.class);<font></font>
        country.setCities(cityRepository.findAll(Cities.CITIES.COUNTRY_ID.eq(country.getId())));<font></font>
        <span class="hljs-keyword">return</span> country;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æŸ¥è¯¢å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">findWithCustomMapper</span><span class="hljs-params">(Long id)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.selectFrom(Countries.COUNTRIES)<font></font>
                .where(Countries.COUNTRIES.ID.eq(id))<font></font>
                .fetchAny()<font></font>
                .map(r -&gt; countryRecordMapper.map((CountriesRecord) r));<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒæ›´åŠ ç®€æ´ï¼Œå¹¶ä¸”ä¸åŒ…å«å…¶ä»–é€»è¾‘ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥½çš„ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å°†Recordæ˜ å°„åˆ°å®ä½“ï¼Œä½†æ˜¯å¦‚ä½•å¾®è°ƒRecordä¸­å®ä½“çš„æ˜ å°„å‘¢ï¼Ÿ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä»¥ä¸‹è®¾è®¡ï¼š</font></font><br>
<br>
<pre><code class="java hljs">.set(dsl.newRecord(Countries.COUNTRIES, country))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å·²ç»å¾ˆå¥½äº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦ä¸“é—¨ç»˜åˆ¶ä¸€ä¸ªå­—æ®µæ€ä¹ˆåŠï¼Ÿ</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨é‚£é‡Œæœ‰LocalDateTimeï¼Œè€Œè¯¸å¦‚Timestampä¹‹ç±»çš„PostgreSQLç”Ÿæˆå™¨ç”Ÿæˆäº†OffsetDateTimeã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å­—æ®µå°†ä¸ä¼šè¢«æ˜ å°„ï¼Œä¹Ÿä¸ä¼šè®°å½•åœ¨æ•°æ®åº“ä¸­ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†éœ€è¦å¦ä¸€ä¸ªæ˜ å°„å™¨æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä½†æ–¹å‘ç›¸åã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œå¯¹äºæ¯ä¸ªæ˜ å°„å™¨ï¼Œæˆ‘ä»¬éƒ½æ²¡æœ‰æ˜ å°„å™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»–è¢«ç§°ä¸ºã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å†™ä»–çš„ç»§æ‰¿äººã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CountryRecordUnmapper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">RecordUnmapper</span>&lt;<span class="hljs-title">Country</span>, <span class="hljs-title">CountriesRecord</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DSLContext dsl;<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> CountriesRecord <span class="hljs-title">unmap</span><span class="hljs-params">(Country country)</span> <span class="hljs-keyword">throws</span> MappingException </span>{<font></font>
        CountriesRecord record = dsl.newRecord(Countries.COUNTRIES, country);<font></font>
        record.setPopulation(-<span class="hljs-number">1</span>);
        <span class="hljs-keyword">return</span> record;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ’å…¥åŠå…¶åº”ç”¨ç¨‹åºå°†å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">public</span> Country <span class="hljs-title">insertWithUnmapper</span><span class="hljs-params">(Country country)</span> </span>{
        <span class="hljs-keyword">return</span> dsl.insertInto(Countries.COUNTRIES)<font></font>
                .set(countryRecordUnmapper.unmap(country))<font></font>
                .returning()<font></font>
                .fetchOptional()<font></font>
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> DataAccessException(<span class="hljs-string">"Error inserting entity: "</span> + country.getId()))<font></font>
                .into(Country.class);<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä¹Ÿç›¸å½“ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®ºä¸ç»“è®º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ›´å–œæ¬¢ä¼‘çœ ã€‚</font><font style="vertical-align: inherit;">å¯¹äº90ï¼…ä»¥ä¸Šçš„åº”ç”¨ç¨‹åºï¼Œå¯èƒ½æ›´åˆç†ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ï¼ˆè¯»è€…ï¼‰æƒ³è¦æ§åˆ¶æ¯ä¸ªè¯·æ±‚ï¼Œåˆ™JOOQæˆ–å…¶ä»–ç±»ä¼¼çš„åº“æ›´é€‚åˆæ‚¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€å¦‚æ—¢å¾€ï¼Œæˆ‘å‘å¸ƒäº†åŸ¹è®­é¡¹ç›®ã€‚</font><font style="vertical-align: inherit;">ä»–èººåœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN488504/index.html">æˆ‘ä»¬åœ¨Zabbixä¸­è¿æ¥ç”Ÿäº§æ—¥å†</a></li>
<li><a href="../zh-CN488514/index.html">Android Remote Debugger-è¿œç¨‹è°ƒè¯•Androidåº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN488516/index.html">å…¨é¢çš„iframeå¹¿å‘Šä»£ç æŒ‡å—</a></li>
<li><a href="../zh-CN488518/index.html">ç”µå­ä¹¦ONYX BOOX Livingstoneå’Œäºšé©¬é€ŠKindle Paperwhiteçš„æ¯”è¾ƒè¯„è®ºï¼ˆ2018ï¼‰</a></li>
<li><a href="../zh-CN488520/index.html">loopå­å’ŒèŠ±ä½“ã€‚2</a></li>
<li><a href="../zh-CN488528/index.html">åœ¨Androidå¹³å°ä¸Šä½¿ç”¨PKCSï¼ƒ11åŠ å¯†ä»¤ç‰Œæœºåˆ¶</a></li>
<li><a href="../zh-CN488530/index.html">ä»€ä¹ˆæ˜¯ååº”æ€§ï¼Ÿ</a></li>
<li><a href="../zh-CN488534/index.html">DIYç´«å¤–çº¿ç¯400-405 nmï¼Œç”¨äº3Då…‰èšåˆç‰©æ¨¡å‹çš„èšåˆ</a></li>
<li><a href="../zh-CN488536/index.html">åœ¨å°†Docker-in-Dockerç”¨äºCIæˆ–æµ‹è¯•ç¯å¢ƒä¹‹å‰ï¼Œè¯·ä»”ç»†è€ƒè™‘ã€‚</a></li>
<li><a href="../zh-CN488540/index.html">ĞŸÑƒÑˆĞºĞ° Ğ“Ğ°ÑƒÑÑĞ°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>