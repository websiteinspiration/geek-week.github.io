<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍💼 🐾 🤙🏼 Erstellen Sie Ihre eigene CRUD-API unter Express und MySQL: Teil eins ♦️ 👆🏽 🛏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo alle zusammen. Im Vorgriff auf den Start des Kurses „Fullstack JavaScript Developer“ möchten wir ein kleines Material teilen, das von unserem fr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erstellen Sie Ihre eigene CRUD-API unter Express und MySQL: Teil eins</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/491408/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo alle zusammen. Im Vorgriff auf den Start des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kurses „Fullstack JavaScript Developer“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> möchten wir ein kleines Material teilen, das von unserem freiberuflichen Autor geschrieben wurde.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/9w/az/vb/9wazvb3h8u0o1gjvijjntbhrkgk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Express ist eines der beliebtesten Webframeworks, das Routing, Mittelgewichte und ein Vorlagensystem unterstützt. Ein Backend auf Node.js ohne Express im Jahr 2020 zu erstellen, ist eine ziemlich seltsame Aktivität, da Express ein De-facto-Framework zum Erstellen einer Webanwendung auf Node.js ist.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heute werden wir versuchen, eine einfache CRUD-API unter Verwendung der MySQL-Datenbank zu erstellen. </font><font style="vertical-align: inherit;">Ein erfahrener Node.js-Leser wird fragen, wo sich MongoDB befindet, mit dem Node.js normalerweise zusammen verwendet wird. Ich möchte jedoch sofort sagen, dass dieser Artikel eher für PHP-Entwickler gedacht ist, die Node.js ein wenig berühren und den Übergang zu einem neuen Ökosystem abmildern möchten Wir werden MySQL verwenden. </font><font style="vertical-align: inherit;">Wir erstellen eine API für eine einfache Todo-Anwendung, falls jemand eine Verbindung zu seiner Aufgabe herstellen möchte (und es spielt keine Rolle, ob sie mit React geschrieben wurde oder nicht), fügen Sie ein wenig zurück und spielen Sie damit.</font></font><br>
<a name="habracut"></a><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Architektur" und das Wesentliche unserer Anwendung</font></font></h5><br>
<img src="https://habrastorage.org/webt/jh/jh/si/jhjhsi1hno_tuosqmjuft3algig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserer Anwendung ist es möglich, Todo zu erstellen, zu empfangen, zu aktualisieren und zu löschen. </font><font style="vertical-align: inherit;">Im Allgemeinen verfügen wir nur über einen minimalen Satz von CRUD-Funktionen (Read Read Update Delete erstellen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende werden wir die Anwendung mit der Anwendung auf React kombinieren und alles testen. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst gebe ich die Struktur der Anwendungsdateien an: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i_/ad/nq/i_adnqzj03nofwn7xqkgjki-ono.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Nächstes gebe ich eine Tabelle mit Aktionen und Methoden an, die in unserer Anwendung enthalten sind:</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methoden</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Url</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktionen</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erhalten</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alle Fälle bekommen</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erhalten</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote / 2</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID mit Nummer 2 bekommen</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Post</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hinzufügen eines neuen Falls</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote / 3 </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer mit id = 3 aktualisieren</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LÖSCHEN </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote / 3 </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer mit ID = 3 löschen</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LÖSCHEN </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Angebote </font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entfernen Sie alle Benutzer</font></font></th>
</tr>
</tbody>
</table></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erstellen Ihrer Node.js-Anwendung </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie zu Ihrem Lieblingsverzeichnis, starten Sie das Terminal und erstellen Sie Ihre Anwendung. </font><font style="vertical-align: inherit;">Übrigens geht aus dem Titel wahrscheinlich hervor, dass Node.js bereits installiert sein sollte. </font><font style="vertical-align: inherit;">Wenn Sie dies noch nicht getan haben, kann </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dies einfach nicht über</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von hier </font><font style="vertical-align: inherit;">heruntergeladen </font><font style="vertical-align: inherit;">werden.</font></font><br>
<br>
<pre><code class="plaintext hljs">    $ mkdir CRUD_API<font></font>
    $ cd CRUD_API<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Als nächstes müssen Sie unsere Anwendung mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm init</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initialisieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">weil </font><font style="vertical-align: inherit;">Unsere Anwendung ist eher eine Test- und Schulungsanwendung. Ich werde einen Befehl verwenden, der alle Standarddaten ausfüllt, um keine Zeit mit kleinen Details zu verschwenden:</font></font><br>
<br>
<pre><code class="plaintext hljs"> npm init -y
 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn dies </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Fall ist, können Sie </font><font style="vertical-align: inherit;">mit Ihren Händen </font><font style="vertical-align: inherit;">die Daten in die Daten ändern, die Sie benötigen: das Github-Repository, Tags, Autor usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann müssen wir alle Pakete platzieren, die erforderlich sind, damit die Anwendung funktioniert:</font></font><br>
<br>
<pre><code class="plaintext hljs">  npm i express mysql body-parser --save
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Ihre Entwicklung später an github senden möchten, sollten Sie eine versteckte Datei erstellen, um </font></font><code>.gitignore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht die schwersten node_modules zu ziehen </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und sich</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> selbst zu </font><strike><font style="vertical-align: inherit;">blamieren</font></strike><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir schreiben:</font></font><br>
<br>
<pre><code class="plaintext hljs">    touch .gitignore <font></font>
    code .gitignore <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir geben dort ein </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, später in dieser Datei können Sie die Namen der Ordner und Dateien eingeben, die Sie später auf dem Remote-Server sehen möchten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Grundlegende Express-Einrichtung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie im Stammordner des Projekts eine Datei </font></font><code>server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);
    <span class="hljs-keyword">const</span> bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">"body-parser"</span>);<font></font>
    <font></font>
    <span class="hljs-keyword">const</span> app = express();<font></font>
    <font></font>
    <span class="hljs-comment">//     json</span><font></font>
    app.use(bodyParser.json());<font></font>
    <font></font>
    <span class="hljs-comment">//    : application/x-www-form-urlencoded</span>
    app.use(bodyParser.urlencoded({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">true</span> }));<font></font>
    <font></font>
    <span class="hljs-comment">//   response - request</span>
    app.get(<span class="hljs-string">"/"</span>, (req, res) =&gt; {<font></font>
      res.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"    "</span> });<font></font>
    });<font></font>
    <font></font>
    <span class="hljs-comment">//  ,   </span>
    app.listen(<span class="hljs-number">3001</span>, () =&gt; {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"   3001 "</span>);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können wir den Server starten mit:</font></font><br>
<br>
<pre><code class="plaintext hljs">node server.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Wir benötigen Express, um unsere API zu erstellen, und das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Body-Parser-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket </font><font style="vertical-align: inherit;">hilft uns, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anforderungen zu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> analysieren </font><font style="vertical-align: inherit;">und eine </font></font><code>req.body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu </font><font style="vertical-align: inherit;">erstellen </font><font style="vertical-align: inherit;">, die für das Routing nützlich ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt kann unser Server Folgendes tun:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erstellen Sie mit app.use () eine Express-App, die Body-Parser zu einem Midlever macht.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir haben eine einfache Möglichkeit, nur um die Anwendung zu testen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überwachen Sie Port 3001 auf alle eingehenden Änderungen</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst funktioniert unsere Anwendung, dann können Sie die Datenbank erstellen.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie Ihre MySQL-Datentabelle</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe wirklich, dass der Leser dieses Artikels kein Problem damit hat, MySQL und MySQLWorkBranch selbst herunterzuladen und zu installieren. </font><font style="vertical-align: inherit;">Als Nächstes erstellen Sie selbst ein Schema (DB) mit dem Namen, den Sie am besten mögen (in meinem Fall TODO), wählen dann die Blitzanforderung aus und kopieren / geben den folgenden Befehl ein:</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`todo`</span> (
        <span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> PRIMARY <span class="hljs-keyword">KEY</span> AUTO_INCREMENT,
        <span class="hljs-built_in">text</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
      ) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserer Datenbank ist alles auf ein Minimum beschränkt: nur die ID und der Text des Falls selbst. </font><font style="vertical-align: inherit;">Um jedoch eine weitere Spalte hinzuzufügen, in der beispielsweise die Dringlichkeit Ihres Falls beschrieben werden kann, hoffe ich, dass dies keine Probleme verursacht.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konfiguration &amp; Verbindung mit unserer Datenbank</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns die Verbindung zur Datenbank herstellen und konfigurieren. </font><font style="vertical-align: inherit;">Wir erstellen einen neuen App-Ordner direkt in unserem Stammordner und dort erstellen wir eine Datei </font></font><code>db.config.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Ordner </font></font><code>config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit ungefähr demselben Inhalt, der von Ihren Einstellungen in MySQLWorkBranch abhängt. </font><font style="vertical-align: inherit;">In meinem Fall sieht die Datei folgendermaßen aus:</font></font><br>
<br>
<pre><code class="javascript hljs">  <span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">HOST</span>: <span class="hljs-string">"localhost"</span>,
    <span class="hljs-attr">USER</span>: <span class="hljs-string">"pavel"</span>,
    <span class="hljs-attr">PASSWORD</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">DB</span>: <span class="hljs-string">"TODO"</span><font></font>
  };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie anschließend einen Ordner zur Beschreibung unserer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">App- / Modusmodelle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in dem wir dann ein Modell erstellen:</font></font><br>
<br>
<pre><code class="plaintext hljs">  const mysql = require("mysql");<font></font>
  const dbConfig = require("../config/db.config.js");<font></font>
  <font></font>
  //      <font></font>
  const connection = mysql.createConnection({<font></font>
    host: dbConfig.HOST,<font></font>
    user: dbConfig.USER,<font></font>
    password: dbConfig.PASSWORD,<font></font>
    database: dbConfig.DB<font></font>
  });<font></font>
  <font></font>
  //      <font></font>
  connection.connect(err =&gt; {<font></font>
    if (err) throw error;<font></font>
    console.log("    ");<font></font>
  });<font></font>
<font></font>
  module.exports = connection;<font></font>
   //  <font></font>
</code></pre><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modell erstellen </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 In dem Ordner </font></font><code>model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erstellen wir eine Datei namens </font></font><code>deal.model.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn Sie eine Frage haben, was ein Modell im Allgemeinen ist, sollten Sie einen Artikel wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lesen </font><font style="vertical-align: inherit;">und sich mit dem MVC-Entwurfsmuster vertraut machen. </font><font style="vertical-align: inherit;">Ich werde einen Konstruktor für ein Deal-Objekt erstellen und die Verbindung für die folgenden CRUD-Funktionen verwenden:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gründung eines neuen Geschäfts</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fall anhand der ID finden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alle Fälle bekommen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Möglichkeit, unseren Fall anhand der ID zu aktualisieren</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Löschen Sie einen Fall mit der ID</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vollständige Löschung aller Fälle</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Insgesamt müssen wir folgende Dinge tun:</font></font><br>
<br>
<pre><code class="javascript hljs">  <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">const</span> Deal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">deal</span>) </span>{
    <span class="hljs-keyword">this</span>.text = deal.text;<font></font>
  };<font></font>
  <span class="hljs-comment">//    ,        CRUD,      :</span>
  Deal.create = <span class="hljs-function">(<span class="hljs-params">newDeal, result</span>) =&gt;</span> {<font></font>
    sql.query(<span class="hljs-string">"INSERT INTO TODO SET ?"</span>, newDeal, (err, res) =&gt; {
      <span class="hljs-comment">//   SQL</span>
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"error: "</span>, err);<font></font>
        result(err, <span class="hljs-literal">null</span>);
        <span class="hljs-comment">//   ,     </span>
        <span class="hljs-keyword">return</span>;<font></font>
      }<font></font>
  <font></font>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">" "</span>, { <span class="hljs-attr">id</span>: res.insertId, ...newDeal });<font></font>
      result(<span class="hljs-literal">null</span>, { <span class="hljs-attr">id</span>: res.insertId, ...newDeal });<font></font>
    });<font></font>
  };<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde den Rest des Codes in den Spoiler einfügen, da ich keinen Grund sehe, alles mitzubringen, da das Codemuster dort tatsächlich wiederholt wird und sich nur die SQL-Befehle und -Argumente ändern:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Rest des Codes</font></font></b><div class="spoiler_text"> Deal.findById = (dealId, result) =&gt; {<br>
 sql.query(`SELECT * FROM TODO WHERE id = ${dealId}`, (err, res) =&gt; {<br>
 if (err) {<br>
 console.log(«error: », err);<br>
 result(err, null);<br>
 return;<br>
 }<br>
 <br>
 if (res.length) {<br>
 console.log(« : », res[0]);<br>
 result(null, res[0]);<br>
 return;<br>
 }<br>
 <br>
 //     <br>
 result({ kind: «not_found» }, null);<br>
 });<br>
 };<br>
 <br>
 Deal.getAll = result =&gt; {<br>
 sql.query(«SELECT * FROM TODO», (err, res) =&gt; {<br>
 if (err) {<br>
 console.log(«error: », err);<br>
 result(null, err);<br>
 return;<br>
 }<br>
 <br>
 console.log(«deals: », res);<br>
 result(null, res);<br>
 });<br>
 };<br>
 <br>
 Deal.updateById = (id, deal, result) =&gt; {<br>
 sql.query(<br>
 «UPDATE TODO SET text =? WHERE id = ?»,<br>
 [deal.text, id],<br>
 (err, res) =&gt; {<br>
 if (err) {<br>
 console.log(«error: », err);<br>
 result(null, err);<br>
 return;<br>
 }<br>
 <br>
 if (res.affectedRows == 0) {<br>
 result({ kind: «not_found» }, null);<br>
 return;<br>
 }<br>
 <br>
 console.log(«  », { id: id, ...deal });<br>
 result(null, { id: id, ...deal });<br>
 }<br>
 );<br>
 };<br>
 <br>
 Deal.remove = (id, result) =&gt; {<br>
 sql.query(«DELETE FROM TODO WHERE id = ?», id, (err, res) =&gt; {<br>
 if (err) {<br>
 console.log(«error: », err);<br>
 result(null, err);<br>
 return;<br>
 }<br>
 <br>
 if (res.affectedRows == 0) {<br>
 //       id<br>
 result({ kind: «not_found» }, null);<br>
 return;<br>
 }<br>
 console.log(«   », id);<br>
 result(null, res);<br>
 });<br>
 };<br>
 <br>
 Deal.removeAll = result =&gt; {<br>
 sql.query(«DELETE FROM TODO», (err, res) =&gt; {<br>
 if (err) {<br>
 console.log(«error: », err);<br>
 result(null, err);<br>
 return;<br>
 }<br>
 <br>
 console.log(`deleted ${res.affectedRows} deals`);<br>
 result(null, res);<br>
 });<br>
 };<br>
 <br>
 </div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist alles für jetzt. </font><font style="vertical-align: inherit;">Der nächste Teil dieses Artikels nähert sich, in dem wir die Rückseite fertig schreiben und mit dem Testen beginnen. </font><font style="vertical-align: inherit;">Und traditionell ein paar nützliche Links:</font></font><br>
<br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen der Arbeit und des internen Geräts express.js</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundlegende MySQL-Befehle</font></font></a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ein bisschen über die HTTP-Anforderungs- / Antwortschleife</font></font></a> </li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ein bisschen über Pfeilfunktionen, wenn Sie ein absoluter Anfänger sind</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491384/index.html">Informationssicherheit Automatisierte Plattform für die Reaktion auf Vorfälle</a></li>
<li><a href="../de491388/index.html">Geh weg von jQuery nach Svelte</a></li>
<li><a href="../de491398/index.html">Tests und Vergleiche von WS2813, WS2812B, WS2815 und ähnlichen digitalen LED-Streifen</a></li>
<li><a href="../de491404/index.html">Das Böse im Dienste des Guten: Die 3D-gedruckte Supervillain-Maske schützt Kinder vor verschmutzter Luft</a></li>
<li><a href="../de491406/index.html">STM32 Teil 3: Erstes Projekt</a></li>
<li><a href="../de491412/index.html">Salesforce-Zertifizierungshandbuch</a></li>
<li><a href="../de491416/index.html">Eine Auswahl unterhaltsamer statistischer Fakten # 5</a></li>
<li><a href="../de491422/index.html">Nur Freiwillige sind einen Schritt nach vorne</a></li>
<li><a href="../de491426/index.html">Jinja2 in der C ++ - Welt, Teil drei. "Jetzt bist du in Conan"</a></li>
<li><a href="../de491428/index.html">Slurm Agile. Drei Tage Verantwortung, Offenheit, Mut und Respekt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>