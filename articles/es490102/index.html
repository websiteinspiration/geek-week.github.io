<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏻 🐚 Ⓜ️ wc a D: 712 caracteres sin una sola rama ⌨️ 🛀🏾 🧒🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Después de leer " Batir con un programa de 80 líneas en Haskell", que encontré en Hacker News , decidí que D podría ser mejor. Y escribí wc en D. 
 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>wc a D: 712 caracteres sin una sola rama</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490102/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Después de leer " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Batir con un programa de 80 líneas en Haskell",</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que encontré en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , decidí que D podría ser mejor. </font><font style="vertical-align: inherit;">Y escribí wc en D. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note.per. </font><font style="vertical-align: inherit;">Sugerí traducir el artículo anterior</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xd34df00d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero prefirió hacer basado en su </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Ganar con veinte líneas de Haskell: Escribiendo su Wc"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y ahora los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artículos </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se multiplican</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como repeticiones de "monedas acuñadas".</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programa</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consta de un archivo: 34 líneas y 712 caracteres.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Código fuente</font></font></b><div class="spoiler_text"><pre><code class="swift hljs"><span class="hljs-keyword">import</span> std.stdio : writefln, File;
<span class="hljs-keyword">import</span> std.algorithm : map, fold, splitter;
<span class="hljs-keyword">import</span> std.range : walkLength;
<span class="hljs-keyword">import</span> std.typecons : Yes;
<span class="hljs-keyword">import</span> std.uni : byCodePoint;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Line</span> </span>{<font></font>
	size_t chars;<font></font>
	size_t words;<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Output</span> </span>{<font></font>
	size_t lines;<font></font>
	size_t words;<font></font>
	size_t chars;<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Output</span> combine(<span class="hljs-type">Output</span> a, <span class="hljs-type">Line</span> b) pure nothrow {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Output</span>(a.lines + <span class="hljs-number">1</span>, a.words + b.words, a.chars + b.chars);<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Line</span> toLine(char[] l) pure {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Line</span>(l.byCodePoint.walkLength, l.splitter.walkLength);<font></font>
}<font></font>
<font></font>
void main(string[] args) {<font></font>
	auto f = <span class="hljs-type">File</span>(args[<span class="hljs-number">1</span>]);
	<span class="hljs-type">Output</span> o = f<font></font>
		.byLine(<span class="hljs-type">Yes</span>.keepTerminator)<font></font>
		.<span class="hljs-built_in">map</span>!(l =&gt; toLine(l))<font></font>
		.fold!(combine)(<span class="hljs-type">Output</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<font></font>
<font></font>
	writefln!<span class="hljs-string">"%u %u %u %s"</span>(o.lines, o.words, o.chars, args[<span class="hljs-number">1</span>]);<font></font>
}</code></pre><br>
</div></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, usa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phobos, la biblioteca estándar D</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero ¿por qué no? </font><font style="vertical-align: inherit;">Phobos es hermoso y viene con todos los compiladores D. El programa en sí no contiene ninguna declaración if. </font><font style="vertical-align: inherit;">Y en la implementación de wc en Haskell, se usan varios si. </font><font style="vertical-align: inherit;">El programa D, además del principal, contiene tres funciones más pequeñas. </font><font style="vertical-align: inherit;">Podría poner fácilmente toda la funcionalidad en una cadena de rango, pero probablemente superaría los 80 caracteres por línea. </font><font style="vertical-align: inherit;">Este es el principio básico del estilo de código.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actuación</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Es wc en D más rápido que coreutils wc? </font><font style="vertical-align: inherit;">No, pero me llevó 15 minutos escribir mi versión (tuve que buscar walkLength porque olvidé el nombre de la función).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo de datos</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">líneas</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">re</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">46</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">906</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,5 ms ± 1,9 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,9 ms ± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">862</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64k</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,7 ms ± 2,0 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,8 ms ± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,7 millones</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">96 millones</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">658.6ms ± 24.5ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226,4 ms ± 29,5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.102 s ± 0.022 s</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12,1 millones</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">671 millones</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,4 s ± 0,058 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1 s ± 0.039 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,4 s ± 0,085 s</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memoria:</font></font><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo de datos</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">re</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2052K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7228K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7708K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2112K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7512K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7616K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2288K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42620K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7712K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2360K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50860K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7736K</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WC en Haskell más rápido? </font><font style="vertical-align: inherit;">Para archivos grandes, sin duda, pero utiliza subprocesos múltiples. </font><font style="vertical-align: inherit;">Para archivos pequeños, GNU coreutils aún gana. </font><font style="vertical-align: inherit;">En esta etapa, lo más probable es que mi versión esté limitada por IO y, en cualquier caso, es bastante rápida. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No argumentaré que un idioma es más rápido que otro. </font><font style="vertical-align: inherit;">Si pasa tiempo optimizando el micro punto de referencia, lo más probable es que gane. </font><font style="vertical-align: inherit;">Pero no en la vida real. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero argumentaré que la programación funcional en D casi alcanza al FP en Haskell.</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un poco sobre el rango en D</font></font></h3><br>
<img src="https://habrastorage.org/webt/gp/qe/oo/gpqeookkvehf2hdsowdegomcqai.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El rango es una abstracción que se puede iterar sin tocar la colección subyacente (si existe). </font><font style="vertical-align: inherit;">Técnicamente, el rango puede ser una estructura o clase que implementa una o más interfaces de rango. </font><font style="vertical-align: inherit;">La forma más simple, InputRange, requiere una función</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y dos miembros o propiedades </font></font><br>
<br>
<pre><code class="cpp hljs">T front;
<span class="hljs-keyword">bool</span> empty;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T es un tipo genérico de elemento cuyo rango se repite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los rangos D son tipos específicos. </font><font style="vertical-align: inherit;">Cuando el rango cae en la instrucción foreach, el compilador realiza una pequeña modificación.</font></font><br>
<br>
<pre><code class="cpp hljs">foreach (e; range) { ... }</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
se convierte en </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> __r = range; !__r.empty; __r.popFront()) {
    <span class="hljs-keyword">auto</span> e = __r.front;<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
auto e = calcula el tipo y es equivalente a T e =. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con esto en mente, es fácil crear un rango que pueda ser utilizado por foreach.</font></font><br>
<br>
<pre><code class="java hljs">struct Iota {
	<span class="hljs-keyword">int</span> front;
	<span class="hljs-keyword">int</span> end;<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.front == <span class="hljs-keyword">this</span>.end;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{<font></font>
		++<span class="hljs-keyword">this</span>.front;<font></font>
	}<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-keyword">import</span> std.stdio;<font></font>
	foreach(it; Iota(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iota es un ejemplo muy simple de rango. </font><font style="vertical-align: inherit;">Funciona como un generador, sin tener la colección subyacente. </font><font style="vertical-align: inherit;">Se itera a través de enteros de principio a fin en incrementos de uno. </font><font style="vertical-align: inherit;">Este fragmento revela un poco de sintaxis D.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El atributo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ property le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permite usar la función </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vacía</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la misma manera que una variable miembro (llamando a una función sin paréntesis). El atributo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al final significa que no estamos modificando los datos de instancia para los que llamamos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vacío</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La prueba de unidad incorporada imprime números del 0 al 10. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra característica pequeña es la falta de un constructor explícito. La estructura Iota tiene dos variables miembro int. En la declaración foreach en la prueba, creamos una instancia de Iota como si tuviera un constructor que aceptara dos entradas. Este es un literal estructural. Cuando el compilador D ve esto, pero la estructura no tiene un constructor correspondiente, entonces de acuerdo con el orden de declaración de variables, los miembros de la estructura se asignarán int.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La relación entre los tres miembros es simple. </font><font style="vertical-align: inherit;">Si vacío es falso, se garantiza que front devolverá un nuevo elemento después de la iteración después de llamar a popFront. </font><font style="vertical-align: inherit;">Después de llamar a popFront, el valor vacío podría cambiar. </font><font style="vertical-align: inherit;">Si esto es cierto, significa que no hay más elementos para iterar y las llamadas al frente adicionales no son válidas. </font><font style="vertical-align: inherit;">De acuerdo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con la documentación de InputRange</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el frente se puede calcular correctamente si y solo si el vacío devuelve o devolvería falso.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">front se puede calcular varias veces sin llamar a popFront o al rango mutante o datos subyacentes, y da el mismo resultado para cada cálculo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usar expresiones foreach, o bucles, no es muy funcional. </font><font style="vertical-align: inherit;">Supongamos que queremos filtrar todos los números impares para Iota. </font><font style="vertical-align: inherit;">Podríamos poner un if dentro de un bloque foreach, pero eso solo lo empeoraría. </font><font style="vertical-align: inherit;">Sería mejor si tuviéramos un rango que tome un rango y un predicado que decida si un elemento es adecuado o no.</font></font><br>
<br>
<pre><code class="java hljs">struct Filter {<font></font>
	Iota input;<font></font>
	<span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate</span>;<font></font>
<font></font>
	<span class="hljs-keyword">this</span>(Iota input, <span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate) </span>{
		<span class="hljs-keyword">this</span>.input = input;
		<span class="hljs-keyword">this</span>.predicate = predicate;
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testAndIterate</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">while</span>(!<span class="hljs-keyword">this</span>.input.empty<font></font>
				&amp;&amp; !<span class="hljs-keyword">this</span>.predicate(<span class="hljs-keyword">this</span>.input.front))<font></font>
		{<font></font>
			<span class="hljs-keyword">this</span>.input.popFront();<font></font>
		}<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">this</span>.input.popFront();
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">front</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.front;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.empty;<font></font>
	}<font></font>
}<font></font>
<font></font>
<span class="hljs-function">bool <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	foreach(it; Filter(Iota(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>), &amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El filtro es nuevamente muy simple: se necesitan Iota y un puntero de función. </font><font style="vertical-align: inherit;">Al construir el filtro, llamamos a testAndIterate, que toma los elementos de Iota hasta que esté vacío o el predicado devuelva falso. </font><font style="vertical-align: inherit;">La idea es que el predicado decida qué filtrar y qué dejar. </font><font style="vertical-align: inherit;">Las propiedades frontal y vacía simplemente se traducen a Iota. </font><font style="vertical-align: inherit;">Lo único que realmente hace el trabajo es popFront. </font><font style="vertical-align: inherit;">Devuelve el elemento actual y llama a testAndIterate. </font><font style="vertical-align: inherit;">Eso es todo. </font><font style="vertical-align: inherit;">Esta es una implementación de filtro.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, testAndIterate tiene un ciclo while, pero reescribirlo usando recursión, en mi opinión, es simplemente estúpido. Lo que hace que D sea genial es que puedes usar el método apropiado para cada tarea. La programación funcional es buena y, a menudo, hace alarde, pero a veces no lo es. Si se necesita un pequeño ensamblador en línea o más agradable, úselo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Llamar a Filtro todavía no se ve muy bien. </font><font style="vertical-align: inherit;">Suponiendo que está acostumbrado a leer de izquierda a derecha, Filter aparece antes de Iota, incluso si se ejecuta después de Iota. </font><font style="vertical-align: inherit;">D no proporciona una declaración de canalización, pero utiliza la sintaxis de llamada de función unificada (UFCS). </font><font style="vertical-align: inherit;">Si una expresión se puede convertir implícitamente en el primer parámetro de una función, entonces la función se puede llamar como si fuera una función miembro de esta expresión. </font><font style="vertical-align: inherit;">Esto es bastante complicado, entiendo. </font><font style="vertical-align: inherit;">Un ejemplo ayudará:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-built_in">string</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a ~ <span class="hljs-string">"World"</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-built_in">string</span> a = foo(<span class="hljs-string">"Hello "</span>);
	<span class="hljs-built_in">string</span> b = <span class="hljs-string">"Hello "</span>.foo();<font></font>
	assert(a == b);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El ejemplo anterior muestra dos llamadas a la función foo. </font><font style="vertical-align: inherit;">Como implica afirmar, ambas llamadas son equivalentes. </font><font style="vertical-align: inherit;">¿Qué significa esto para nuestro ejemplo de filtro Iota? </font><font style="vertical-align: inherit;">UFCS nos permite reescribir la prueba unitaria de esta manera:</font></font><br>
<br>
<pre><code class="swift hljs">unittest {<font></font>
	foreach(it; <span class="hljs-type">Iota</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>).<span class="hljs-type">Filter</span>(&amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La implementación del mapa / transformación para el rango ahora debería ser accesible para todos los lectores. </font><font style="vertical-align: inherit;">Por supuesto, un filtro puede hacerse más abstracto usando plantillas, pero estos son solo detalles, nada conceptualmente nuevo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, hay diferentes tipos de rango, por ejemplo, bidireccional. </font><font style="vertical-align: inherit;">Adivina qué oportunidades te da esto. </font><font style="vertical-align: inherit;">Un consejo rápido: hay dos primitivas nuevas en el rango bidireccional llamadas back y popBack. </font><font style="vertical-align: inherit;">Existen otros tipos de rango, pero después de comprender el rango de entrada que se muestra arriba dos veces, casi todos los reconocen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PD: Para mayor claridad, no implemente su propio filtro, mapa o pliegue; </font><font style="vertical-align: inherit;">La biblioteca estándar Phobos D tiene todo lo que necesita. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eche un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vistazo a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">std.algorithm</font></a><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std.range</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre el Autor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Robert Schadeck obtuvo una maestría en ciencias de la computación de la Universidad de Oldenburg. </font><font style="vertical-align: inherit;">Su tesis de maestría se tituló "DMCD - Compilador D multiproceso distribuido con almacenamiento en caché", donde trabajó en la creación de un compilador D desde cero. </font><font style="vertical-align: inherit;">Fue un estudiante graduado en ciencias de la computación en 2012-2018. </font><font style="vertical-align: inherit;">en la universidad de Oldenburg. </font><font style="vertical-align: inherit;">Su tesis doctoral se centra en los sistemas de quórum junto con los gráficos. </font><font style="vertical-align: inherit;">Desde 2018, se complace en utilizar D en su trabajo diario, trabajando para Symmetry Investments.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acerca de las inversiones en simetría</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetry Investments es una compañía de inversión global con oficinas en Hong Kong, Singapur y Londres. </font><font style="vertical-align: inherit;">Hemos estado haciendo negocios desde 2014 después de separarnos con éxito de un importante fondo de cobertura de Nueva York.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En Symmetry, nos esforzamos por asumir riesgos de manera razonable para crear valor para nuestros clientes, socios y empleados. Nos beneficiamos de nuestra capacidad de generar contratos de beneficio mutuo, en el sentido más amplio de la palabra. Win-Win es nuestro principio ético y estratégico fundamental. Al generar opciones de ganar-ganar, podemos crear soluciones únicas que combinan perspectivas que generalmente se perciben como incompatibles u opuestas, y que cubren todo lo mejor que cada una de las partes puede ofrecer. Estamos reintegrando el arbitraje de renta fija con estrategias macro globales. Inventamos y desarrollamos una tecnología que se centra en el potencial de la integración hombre-máquina. Creamos sistemas en los que las máquinas hacen lo que hacen mejor, apoyando a las personas enpara que hagan lo que hacen mejor. Creamos una meritocracia basada en la cooperación: una cultura en la que la contribución individual sirve tanto para objetivos personales como colectivos, y se recompensa en consecuencia. Valoramos tanto un sentido de propiedad como un espíritu de equipo de cooperación, autorrealización y comunidad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las personas de Symmetry Investments han sido miembros activos de la Comunidad D desde 2014. </font><font style="vertical-align: inherit;">Patrocinamos el desarrollo de excel-d, dpp, autowrap, libmir y otros proyectos. </font><font style="vertical-align: inherit;">Lanzamos Symmetry Autumn of Code en 2018 y alojamos DConf 2019 en Londres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aprox. </font><font style="vertical-align: inherit;">Como el traductor, como de costumbre, estaba borracho, no puedo garantizar la exactitud de algunos términos humanos, y no entiendo nada en la última sección. </font><font style="vertical-align: inherit;">Entonces envíe correcciones en comunicaciones personales.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es490088/index.html">Cómo continuar creando un mapa en UE4</a></li>
<li><a href="../es490092/index.html">Andrei Zaretsky, Alexander Trukhanov: "La tarifa fue suficiente para tomar café"</a></li>
<li><a href="../es490094/index.html">De vuelta a las raíces: manejamos una computadora directamente desde el MBR</a></li>
<li><a href="../es490096/index.html">Manera fácil de hacer un pequeño concentrador USB para Raspberry Pi</a></li>
<li><a href="../es490100/index.html">Desarrolle software para el alquiler descentralizado de scooters. ¿Quién dijo que sería fácil?</a></li>
<li><a href="../es490104/index.html">Visera inteligente de Bosch. Prueba de prototipo</a></li>
<li><a href="../es490110/index.html">De desarrollador a gerentes y viceversa</a></li>
<li><a href="../es490112/index.html">Монады как паттерн переиспользования кода</a></li>
<li><a href="../es490114/index.html">Yandex.Practicum - Analista de datos. Graduación</a></li>
<li><a href="../es490118/index.html">10 hechos más importantes sobre SERM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>