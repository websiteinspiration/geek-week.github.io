<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЩОЁЯП╝ ЁЯНО ЁЯУК рдЬрд┐рдВрджрд╛ рд░рдЦрдиреЗ рдХреЗ рд░рд╛рд╕реНрддреЗ рдкрд░ рд░реЗрдХ ЁЯеР ЁЯеД ЁЯеМ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдмрдврд╝рд╛рдирд╛ рдЕрдХреНрд╕рд░ рдЖрдзреБрдирд┐рдХ рдЖрдИрдЯреА рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдореЗрдВ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред рдЕрдзрд┐рдХрддрдо рдХреЛ рдирд┐рдЪреЛрдбрд╝реЗрдВ рдФрд░ рд╣рд░ рдХреАрдордд рдкрд░ рдЬреАрд╡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдЬрд┐рдВрджрд╛ рд░рдЦрдиреЗ рдХреЗ рд░рд╛рд╕реНрддреЗ рдкрд░ рд░реЗрдХ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495308/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдмрдврд╝рд╛рдирд╛ рдЕрдХреНрд╕рд░ рдЖрдзреБрдирд┐рдХ рдЖрдИрдЯреА рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдореЗрдВ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХрддрдо рдХреЛ рдирд┐рдЪреЛрдбрд╝реЗрдВ рдФрд░ рд╣рд░ рдХреАрдордд рдкрд░ рдЬреАрд╡рд┐рдд рд░рд╣реЗрдВ - рдХрд┐рд╕реА рднреА рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧрдВрднреАрд░ рдЪреБрдиреМрддреАред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЗрд╖реНрдЯрддрдо рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рдЦреЛрдЬ рдПрдХ рдЧреИрд░-рд░реЛрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрд▓реЗрдЦ рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдЬреЛ рдЕрддреНрдпрдзрд┐рдХ рднрд░реА рд╣реБрдИ http рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИрдВред</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдХрд╣рд╛рдиреА рдПрдХ рдЧрд▓рддреА рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред рдХрд┐рд╕реА рддрд░рд╣ рд╣рдордиреЗ рд▓реЛрдб рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛, рдЬрд┐рд╕рдХрд╛ рдореБрдЦреНрдп рддрддреНрд╡ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд▓рдШреБ http рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдерд╛ред </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдЯрдХреЛрд░ 2.2 рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд╣рдд рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ </font><font style="vertical-align: inherit;">, рдЬреЛ рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдПрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Net.Sockets.SocketException рдХреЛ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлреЗрдВрдХрддрд╛ рд╣реИ </font><em><font style="vertical-align: inherit;">: рдЙрдкрдпреЛрдЧ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкрддрд╛</font></em><font style="vertical-align: inherit;"> ред рдпрд╣ рдЬрд▓реНрджреА рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рдХрд┐ рдмрдВрджрд░рдЧрд╛рд╣реЛрдВ рдХреЗ рдкрд╛рд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдЦрд╛рд▓реА рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдирд╣реАрдВ рдерд╛, рдФрд░ рдХреБрдЫ рдмрд┐рдВрджреБ рдкрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдПрдХ рдирдпрд╛ рдЦреЛрд▓рдиреЗ рд╕реЗ рдордирд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЕрдм, рдпрджрд┐ рд╣рдо рдХреЛрдб рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╕рдорд╕реНрдпрд╛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HttpWebRequest</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font><font style="vertical-align: inherit;">рдФрд░ рдирд┐рд░реНрдорд╛рдг рдХреЗ </font><font style="vertical-align: inherit;">рд╕рд╛рде рдкреБрд░рд╛рдиреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рдереА </font><font style="vertical-align: inherit;">:</font></font></p><br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> request = WebRequest.CreateHttp(uri);
<span class="hljs-keyword">using</span>(<span class="hljs-keyword">var</span> resp = request.GetResponse()){ тАж }</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рд╕рдВрд╕рд╛рдзрди рдЬрд╛рд░реА рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдмрдВрджрд░рдЧрд╛рд╣ рдХреЛ рд╕рдордп рдкрд░ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрдЯрд╕реНрдЯреИрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдиреЗ TIME_WAIT рд░рд╛рдЬреНрдп рдореЗрдВ рдмрдВрджрд░рдЧрд╛рд╣реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рддреЗрдЬреА рд╕реЗ рд╡реГрджреНрдзрд┐ рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд░рд╛рдЬреНрдп рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрдиреЗрдХреНрд╢рди рдмрдВрдж рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ (рдФрд░ рд╕рдВрднрд╡рддрдГ рдЦреЛрдП рд╣реБрдП рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛)ред </font><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рдкреЛрд░реНрдЯ 1-2 рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рдорд╕реНрдпрд╛ рдХрдИ рд▓реЗрдЦ (рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=http://" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIME_WAIT рдХрддрд╛рд░ рдХреЗ рд╕рд╛рде рдХреЛрдИ рд╕рдорд╕реНрдпрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIME_WAIT рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЗрддрд┐рд╣рд╛рд╕</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рднреА, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЙрдЯрдиреЗрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "рдИрдорд╛рдирджрд╛рд░реА рд╕реЗ" рдХрдиреЗрдХреНрд╢рди рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдЖрдЧреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЯрд╛рдЗрдордЖрдЙрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЧрд▓рддреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реЛрддрд╛ рд╣реИред</font></font></p><br>
<h3 id="pochemu-tak-proishodit-i-kak-s-etim-borotsya"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХреНрдпреЛрдВ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЗрд╕рд╕реЗ рдХреИрд╕реЗ рдирд┐рдкрдЯрдирд╛ рд╣реИ</font></font></h3><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ </font></font><em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдВрджрд╛ рд░рдЦрдиреЗ рдХреА</font></font></a></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрд╛рдд рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ </font><font style="vertical-align: inherit;">ред рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЦреБрдж рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЗрдЦ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░реЗрдХ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдЬрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рд╣реИ, рдзреНрдпрд╛рди рд╕реЗ рдбреЗрд╡рд▓рдкрд░ рдХреЗ рдорд╛рд░реНрдЧ рдкрд░ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Msdn рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдиреБрд╕рд╛рд░ </font><font style="vertical-align: inherit;">, </font><em><font style="vertical-align: inherit;">HttpWebRequest</font></em><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font><font style="vertical-align: inherit;">рдХреА </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeepAlive</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрдкрддреНрддрд┐ </font><font style="vertical-align: inherit;">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ </font><em><font style="vertical-align: inherit;">рд╕рддреНрдп</font></em><font style="vertical-align: inherit;"> рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣реА рд╣реИ, рдпрд╣ рд╕рдм рд╕рдордп, </font><em><font style="vertical-align: inherit;">HttpWebRequest</font></em><font style="vertical-align: inherit;"> рдиреЗ рд╕рд░реНрд╡рд░ рдХреЛ "рдзреЛрдЦрд╛" рджрд┐рдпрд╛, рдЙрд╕реЗ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╡рд╣ рдЦреБрдж рдЗрд╕реЗ рддреЛрдбрд╝ рджреЗрдЧрд╛ред рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, </font><font style="vertical-align: inherit;">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде </font><em><font style="vertical-align: inherit;">HttpWebRequest</font></em><font style="vertical-align: inherit;"> рдиреЗ "рдХрдиреЗрдХреНрд╢рди: рд░рдЦрдиреЗ-рдЬреАрд╡рд┐рдд" рд╢реАрд░реНрд╖ рд▓реЗрдЦ рдирд╣реАрдВ рднреЗрдЬрд╛, рдмрд╕ рдпрд╣ рдореЛрдб </font><em><font style="vertical-align: inherit;">HTTP / 1.1</font></em><font style="vertical-align: inherit;"> рдорд╛рдирдХ рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдкрд╣рд▓реА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП KeepAlive рдХреЛ рдЬрдмрд░рджрд╕реНрддреА рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк HttpWebRequest.KeepAlive = false рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╣реЗрдбрд░ "рдХрдиреЗрдХреНрд╢рди: рдХрд░реАрдм" рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдЗрд╕рдиреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдмреЗрдВрдЪ рдкрд░ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ, nginx рдХреЛ рдПрдХ рд╕реНрдерд┐рд░ рдкреГрд╖реНрда рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:</font></font></p><br>
<pre><code class="cs hljs"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> request = WebRequest.CreateHttp(uri);<font></font>
  request.KeepAlive = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">var</span> resp = <span class="hljs-keyword">await</span> request.GetResponseAsync();
  <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> sr = <span class="hljs-keyword">new</span> StreamReader(resp.GetResponseStream()))<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> content = sr.ReadToEnd();<font></font>
  }<font></font>
}</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм рд╕рд░реНрд╡рд░ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ, рддреЛ рднрд╛рд░реА рд▓реЛрдб (рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 1000 рд╕реЗ рдЕрдзрд┐рдХ рдЕрдиреБрд░реЛрдз) рдХреЗ рддрд╣рдд, рдпрд╣ рдХреЛрдб рдлрд┐рд░ рд╕реЗ рдЙрд╕реА рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рдиреЗ рд▓рдЧрд╛ред </font><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдЕрдм рдкреЛрд░реНрдЯ CLOSE_WAIT, LAST_ACK рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдереЗред </font><font style="vertical-align: inherit;">рдпреЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рдкреВрд░реНрд╡-рдЕрдВрддрд┐рдо рд╕рдорд╛рдкрди рд░рд╛рдЬреНрдп рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдЧреНрд░рд╛рд╣рдХ рдХреНрд▓реЛрдЬрд░ рдХреЗ рд╕рд░реНрдЬрдХ рд╕реЗ рдкреБрд╖реНрдЯрд┐ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рддрд░рд╣ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реЗ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдирдП рдЦреБрд▓реЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде "рдЪреЛрдХ" рдХрд░рдиреЗ рд▓рдЧрддрд╛ рд╣реИред</font></font></p><br>
<h3 id="zakryvat-nelzya-pereispolzovat"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдВрдж рди рдХрд░реЗрдВ, рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</font></font></h3><br>
<p>,    ,   .      <em>keep-alive</em>    <em>HttpClient</em>.            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://docs.microsoft.com/ru-ru/dotnet/api/system.net.http." rel="nofollow"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="></a>.</p><br>
<p>    ,  ,   ?   keep-alive        nginx:</p><br>
<ul>
<li>keepalive_timeout тАУ   (  15)</li>
<li>keepalive_requests тАУ       (  100)</li>
</ul><br>
<p>    <em>netstat</em>  <em>wireshark</em>,            .   <em>keepalive_requests</em>    (&gt; 1000)  ,     .</p><br>
<h3 id="vyvod"></h3><br>
<p>  <strong> </strong> http    ,     .       .         ,       ,     <em>keep-alive</em>.  <em>keep-alive</em>          ,            .</p><br>
<p>     :</p><br>
<ul>
<li>RunHttpClient тАУ   HttpClient  "Connection: keep-alive" </li>
<li>RunHttpClientClosed тАУ   HttpClient  "Connection: closed"</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunWebRequestClosed - рд╡рд░реНрдЧ HttpWebRequest рдореЛрдб "рдХрдиреЗрдХреНрд╢рди: рдмрдВрдж" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ</font></font></li>
</ul><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nginx рд╕рд░реНрд╡рд░ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдкрджрдВрдбреЛрдВ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keepalive_timeout 60s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keepalive_requests 100000;</font></font></li>
</ul><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд░реАрдХрд╛</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрди</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рдЪрд╛рд░</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореАрди</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Runhttpclient</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">963.3 рдорд┐</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunWebRequestClosed</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,857.4 рдПрдордПрд╕</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunHttpClientClosed</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,612.4 рдПрдордПрд╕</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Runhttpclient</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,573.9 рдПрдордПрд╕</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunWebRequestClosed</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">37,947.4 рдПрдордПрд╕</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunHttpClientClosed</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16,112.9 рдПрдордПрд╕</font></font></td>
</tr>
</tbody>
</table></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi495294/index.html">рдПрдХ рдЕрдЬрдЧрд░ рдХреЗ рд▓рд┐рдП рдореИрдХреНрд░реЛрдЬрд╝ред рдпреИрдВрдбреЗрдХреНрд╕ рд░рд┐рдкреЛрд░реНрдЯ</a></li>
<li><a href="../hi495296/index.html">рдлреЛрд░реЗрдВрд╕рд┐рдХ, SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдФрд░ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдкреАрдбрд╝рд┐рдд рдмрд┐рд▓реНрд▓реА: рдСрдирд▓рд╛рдЗрди рд╕реНрдЯреЗрдЬ NeoQUEST-2020 рдХреЗ рдЯрд╛рд╕реНрдХ рдирдВрдмрд░ 3 рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</a></li>
<li><a href="../hi495298/index.html">рдореЛрдВрдЯреЗ рдХрд╛рд░реНрд▓реЛ рдХреНрд▓реЛрдЬрд░ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ</a></li>
<li><a href="../hi495302/index.html">рдСрдирд▓рд╛рдЗрди рд╕реНрдЯреЛрд░ рдореЗрдВ 4 рдорд╣реАрдиреЗ рдореЗрдВ рдмрд┐рдХреНрд░реА рдХреЛ 2.5 рдЧреБрдирд╛ рдХреИрд╕реЗ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛рдП - рдПрд╕рдИрдУ рдкрджреЛрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдорд▓рд╛</a></li>
<li><a href="../hi495304/index.html">рдЙрдирдХреЗ рдкреБрдирд░реНрд╕рдВрд░рдЪрдирд╛ рдХреЗ рдХрд╛рд░рдг рдорд╛рдирд╡ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдХрд╛рдпрд╛рдХрд▓реНрдк</a></li>
<li><a href="../hi495310/index.html">рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рд╡реЙрдХ-рдереНрд░реВ: рдмрд╛рдпреЛрдореЗрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рдорд▓реНрдЯреА-рдлреЙрд░реНрдореЗрдЯ</a></li>
<li><a href="../hi495312/index.html">рдкрд░рд┐рдзрд┐ рд╕реБрд░рдХреНрд╖рд╛ - рднрд╡рд┐рд╖реНрдп рдЕрдм рд╣реИ</a></li>
<li><a href="../hi495314/index.html">рдпрджрд┐ рдпрд╣ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдЖрддрд╛ рд╣реИ рддреЛ рдЧрд▓рдд рд╕реВрдЪрдирд╛ рдХреЛ рдХреИрд╕реЗ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП?</a></li>
<li><a href="../hi495330/index.html">рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛</a></li>
<li><a href="../hi495332/index.html">рдЪреМрдХрдбрд╝реА 9: рдПрд▓реЗрдЧреНрд░реЛ | рдЯрд╛рдЗрдкрдкреНрд░рддрд┐</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>