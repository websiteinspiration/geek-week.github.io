<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💜 🥔 👰🏾 STM32ファストスタート。パート2 HALでのHello World、Atollic TrueSTUDIOでのデバッグ 🙆🏻 👊🏻 👤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前回STM CubeMXを使用した新しいプロジェクトの作成をマスターしたとき、最初の部分はここにあります。
 
 怠惰すぎて再読できない人にとっては、空のプロジェクトが正常にアセンブルされたという結果に終わりました。
 
 
 
 この部分では、HALで最も簡単なHello Worldの例を記述し、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>STM32ファストスタート。パート2 HALでのHello World、Atollic TrueSTUDIOでのデバッグ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481436/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前回STM CubeMXを使用した新しいプロジェクトの作成をマスターしたとき、最初の部分は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここにあります。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
怠惰すぎて再読できない人にとっては、空のプロジェクトが正常にアセンブルされたという結果に終わりました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xu/oq/n_/xuoqn_ph-6skvfodoupmtub0jg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この部分では、HALで最も簡単なHello Worldの例を記述し、デバッガーを実行して使用する方法を確認し、プログラムが消費するメモリの量を調べます。この部分では、HALで記述します。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本として、前の部分で初期化されたのと同じ空のプロジェクトを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LEDを点滅させるには、次のアルゴリズムを順守する必要があります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイクロコントローラーのレッグの現在の状態と逆の状態を設定します。</font><font style="vertical-align: inherit;">つまり、0-セット1、1-セット0などがありました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイクロ秒数の間Nを待って、ステップ1に戻ります。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のステップを実行するために、どのLEDとその状態の反転がどのピンとポートに接続されているかをコンパイラに通知する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、LEDを接続した場所を見つけます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
main.cファイルには、ST社からの親切なコメントの直後に、main.hヘッダーファイルを接続するための行があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yi/wa/lk/yiwalkkgc4lydurug0jq1sze9dk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この行</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">右クリックして、Open Declarationアイテムを見つけます。これを</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xm/wo/-i/xmwo-i7wjz_a0alqjayeozngbu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリックすると、main.hに移動します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
宣言されたピンとポートの名前の場所。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/c3/vx/zqc3vxprbol_sfvqvxmk7ddn6mg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の部分で、PC13 LEDの出力を初期化するときに、ユーザーラベルフィールドに値を入力し、そこにCLOCK_LEDを入力したことを思い出してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトを生成するとき、STM32CubeMXは私たちの希望を考慮に入れ、抽象GPIO_PIN_13とGPIOCの代わりに、よりわかりやすいCLOCK_LED_PinとCLOCK_LED_GPIO_Portを介してLEDにアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで-何を管理するのか-わかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、GPIOの状態を反対に変更できる関数を探しています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、画面左側のプロジェクトツリーでファイルを見つけます。</font></font><br>
<br>
<pre><code class="plaintext hljs">Drivers -&gt; STM32F1xx_HAL_Driver -&gt; Inc -&gt; stm32f1xx_hal_gpio.h</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはたくさんのことをしていますが、我々は/ *エクスポート機能* /ブロックに行くの機能の説明を必要としています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはそこに機能を見つけます</font></font><br>
<br>
<pre><code class="plaintext hljs">void HAL_GPIO_TogglePin(GPIO_TypeDef *GPIOx, uint16_t GPIO_Pin);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはまさに私たちが必要とするものです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oz/2s/dt/oz2sdtylehcpjcezlkh1m_ku_re.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LEDが常に点滅するためには、メインプログラムループの本体のmainに関数の呼び出しを配置する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして瞬きを区別するために-HAL_Delay（500）関数を使用して遅延を追加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、遅延は500msになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/7w/yr/kd7wyrhrom3xaqhfdn1shvgdpvu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、HAL_Delay関数は、</font></font><br>
<br>
<pre><code class="plaintext hljs">Drivers -&gt; STM32F1xx_HAL_Driver -&gt; Inc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stm32f1xx_hal.hファイル内のみ。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、LEDを点滅させるには、2行のコードを書くだけで済みます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが正しく行われていれば、デバッガーを実行して、プログラムの実行方法を確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wt/kl/jm/wtkljm9yczdbqjgl3qogmbkexzm.png"><br>
<br>
<img src="https://habrastorage.org/webt/2i/5y/of/2i5yofnug7lsqn45tpyprohhg2q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F5およびF6ボタンを使用してプログラムコード内を移動できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、F6ボタンは関数呼び出しのみを実行し、F5ボタンを使用すると、呼び出された関数を入力して内部で何が行われるかを確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/ri/2s/liri2sqfgk_ha0a6ygqwqc4d9u4.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバッグ中にグリッチを検出したくない場合は、最適化をオフにすることをお勧めします。これは、メニューの[プロジェクト]-&gt; [プロパティ]で行います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最適化レベルの値は</font><font style="vertical-align: inherit;">[ </font><font style="vertical-align: inherit;">なし]（-O0）に設定する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z1/8w/ai/z18waicrgoc6t9s3ytb6mv22fig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバッグを停止し</font><font style="vertical-align: inherit;">た</font><font style="vertical-align: inherit;">後、コントローラーはコードを再起動して循環的に実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果はこのようなものになるはずです</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/ku/x7/gjkux7d4y-q_xdxjyqbrfhzfmpo.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要約する</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HALを使用すると、2行のコードを書くだけでこのタスクを実装できました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、作業を簡略化するために、</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xj/mw/fa/xjmwfaw-cwgg-7fdcchrxw9qvgw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.54 KBのRAMと4.69 KBのフラッシュ</font><font style="vertical-align: inherit;">メモリを支払う</font><font style="vertical-align: inherit;">必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最適化が無効になっていること、つまり「-O0」であることを思い出させてください</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この質問は、記事の以下の部分でのみ自信を持って回答できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元の記事はいつものように</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私のブログ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にあります</font><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja481420/index.html">15の最高で最大のアイコンライブラリ</a></li>
<li><a href="../ja481424/index.html">Angularのカスタムコントロール</a></li>
<li><a href="../ja481428/index.html">プログラマー向けのゲームFuncBall</a></li>
<li><a href="../ja481430/index.html">HACリストで科学ジャーナルを復元する方法</a></li>
<li><a href="../ja481432/index.html">Pythonプログラミング用の6つのコアライブラリ</a></li>
<li><a href="../ja481440/index.html">世界の端にある2つのポイント</a></li>
<li><a href="../ja481444/index.html">新しいAngularアプリの厳格なルール</a></li>
<li><a href="../ja481446/index.html">5Gセキュリティアーキテクチャの概要：NFV、キー、2つの認証</a></li>
<li><a href="../ja481450/index.html">Aikoでの食品の配送を自動化する方法</a></li>
<li><a href="../ja481452/index.html">ロシアの投資家はロンドンと香港の取引所で株式を購入できるようになる</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>