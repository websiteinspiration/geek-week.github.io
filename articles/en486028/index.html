<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ö ü§õüèº ü•´ Neural networks in the production of dentures üëâüèø ü•î üßü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Replacing a tooth with an implant or installing a crown is a painful and expensive procedure. One of the most difficult parts in the restoration is th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Neural networks in the production of dentures</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/486028/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Replacing a tooth with an implant or installing a crown is a painful and expensive procedure. One of the most difficult parts in the restoration is the design of the prosthesis in the CAD system, which dental technicians are engaged in. Each crown is individually designed for the patient and his jaw in 8-10 minutes. At the same time, each technician has his own subjective vision of what a good tooth crown is, and the quality assessment of the same crown for different specialists of the same level can vary from ‚Äúgood‚Äù to ‚Äúpossible and better‚Äù.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/XB8yyzVGUJE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, it is not surprising that in dentistry the goal was to remove the human factor and add automation. This can be done using neural networks. They have now advanced so much that they can recognize objects, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find criminals</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the crowd, draw pictures </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by sketch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and replace the faces of actors in films, for example, DiCaprio </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with Burunov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the movie The Great Gatsby. They also help to cope with teeth, and how it happened, Stanislav Shushkevich will tell.</font></font><br>
<a name="habracut"></a><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stanislav Shushkevich</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - works for Adalisk Service. This is the contractor for the largest US denture manufacturer. The tasks of the contractor include automation of the production of crowns, bridges, implants. Stanislav teaches deep neural networks. At </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saint HighLoad ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2019, Stanislav made a report in which he described in detail and in detail how the company uses deep training to automate input data classification, design generation and crown modeling automation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article is based on the transcript of his report, from it you will learn how to apply deep learning and design generation in the production of dentures, how to stabilize quality, automate various stages of production using neural networks, gradually reduce the human factor and reduce the average time by several times. which the dental technician spends on crowns and implants. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">The group, in which Stanislav works, collaborates with the Berkeley Institute (USA). </font><font style="vertical-align: inherit;">They worked together to develop deep neural networks to automate the design of dental implants. </font><font style="vertical-align: inherit;">Based on the results of this work, the researchers published a scientific </font></font></em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></em></a><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but the report is more interesting.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dental terminology</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To immerse you in the course of affairs, I will tell about dental terminology. A person has 32 teeth, but more often 28, because wisdom teeth often do not grow or grow sick and are removed. There is a continuous numbering from 1 to 32, but it is more convenient to divide the jaw into 4 numbered quadrants of 8 teeth. Therefore, we say that a person has 32 teeth - from 11 to 48. The first digit is the number of the quadrant, the second is the number of the tooth in the quadrant. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ah/vd/xk/ahvdxkfpml4wbsdiesoleczg9i4.jpeg"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard tooth numbering scheme.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
After mirror reflection, the teeth on the left side of the jaw are similar to the teeth on the right, but the upper ones are not similar to the lower ones. Therefore, when we say that we need to generate a tooth, we usually mean 16 teeth - 32 in half is just 16.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The shape of a person‚Äôs teeth cannot determine sex. Therefore, when excavation finds teeth, it is not clear whose they are: men or women. At the same time, you can understand from the jaws of the horse whether it is a mare or a horse - the horse has fangs, but the mare does not. Such "dental" facts always amuse me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The stump of the 36th tooth is marked in blue - the diseased tooth was sawn off, the stump remained. In English, the tooth stump is called "die." The edge of the stump is highlighted in red, it is called "margin". When the dentist puts the crown on the tooth, it is important that the edge of the crown almost coincides with the margin, with a margin for ‚Äúglue‚Äù, otherwise there will be an ugly step. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/w7/uu/kbw7uucdqd5a9ivmxvqsnbvg8ls.jpeg"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Three-dimensional scan of the impression of the lower jaw.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For us, the technician made a 3D model of a beautiful crown.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/js/hk/a3/jshka3sbl_vccqz08tr-ij0qsf4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grooves on top - anatomy of the crown. </font><font style="vertical-align: inherit;">They are located not randomly, but by their typical tooth number. </font><font style="vertical-align: inherit;">It can be described for a long time, but there is a primary anatomy, a secondary, orthodontic cross. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The jaw antagonist is suitable from above, and if the tooth is upper, the jaw is antagonist from below. </font><font style="vertical-align: inherit;">The upward direction, which is called the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">occlusal direction</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , is also important to us </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">When an ‚Äúocclusal snapshot of a tooth‚Äù appears in the text, it simply means a snapshot from above.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travel crowns</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How do dental crowns do? </font><font style="vertical-align: inherit;">Those who set themselves dental crowns roughly represent. </font><font style="vertical-align: inherit;">I will tell the rest of the general scheme. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dentist - Dental Technician - Dentist. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You come to the dentist, open your mouth, he says repair. </font><font style="vertical-align: inherit;">Files a tooth and gives a bite to the plate. </font><font style="vertical-align: inherit;">It looks like plasticine on a substrate - an imprint of the upper and lower jaw remains on it. </font><font style="vertical-align: inherit;">The dentist sends this cast to the laboratory to the dental technician. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A dental technician sits in a laboratory and never communicates with real patients. </font><font style="vertical-align: inherit;">He builds tooth models in a CAD / CAM system on a computer. </font><font style="vertical-align: inherit;">From the finished 3D model of the tooth, he makes a real restoration and sends it back to the dentist. </font><font style="vertical-align: inherit;">Further, the dentist is already installing the restoration in place.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our application of power is at the center of this scheme.</font></font></blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dentist - Dental Technician + ML - Dentist</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Now the dental technician works in a program that is similar to AutoCAD. </font><font style="vertical-align: inherit;">But ideally, he should do this: a case comes in the form of a mold, a technician scans it and receives a ready proposal for the crown. </font><font style="vertical-align: inherit;">Our ML group works with dental technicians and over the years has collected 5 million cases and 150 TB of data that are on Amazon - there are plenty to choose from. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The technician takes </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 minutes to</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prepare a 3D image of the crown </font><font style="vertical-align: inherit;">, while he thinks about many parameters:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">natural form;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">antagonist;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tight contacts;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">margin line;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jaw segmentation;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deep anatomy;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directions;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arch;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filling in papers and others.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameters</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The naturalness of the form</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is the first thing a dental technician thinks about - for me this is the most mysterious moment. When I show the technique of two teeth and he says which one is good, I ask why he decided so: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- I don‚Äôt know. I just see that this is a natural tooth, but it is not. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Are there any formal criteria? An automated design system needs formal metrics. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ‚ÄúI don't know any formal metrics.‚Äù I just see that this is a good tooth, and this one is bad.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This is called the "natural form." </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, the technician additionally takes care that the crown does not intersect with the antagonist and sits well on the "edge" of the stump, about tight contact with neighbors, sets directions and segments the jaw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several good solutions for any case. Different techniques for the same jaw will create several different good teeth. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why not make it simpler: take a regular tooth crown, ‚Äúplay around‚Äù with the shape of the geometric algorithm and insert it into the jaw? This geometric task is simple in imagination, but in practice it is not so simple. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variability</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the picture below are three images of crowns.</font></font><br>
<img src="https://habrastorage.org/webt/lo/f3/jv/lof3jvviytt491qtqdteot1edpq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first on the left is the perfect human tooth. On average, the gap between the antagonist and the tooth stump is so small that the crown is flattened. The distance between this tooth and the neighbor on the left was large enough, but it was necessary that the crown touched the neighboring tooth, so an influx appeared on the left. In the right figure everything seems normal, but the line of the ‚Äúedge‚Äù of the stump is not a circle, but a complex spatial figure. For geometric methods, all this is difficult due to the large variability of the crowns. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention to detail</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Another important detail is the characteristic size of the simulated features. </font><font style="vertical-align: inherit;">The size of the 36th tooth (from the bottom of the lower jaw) is approximately 8 mm, and 200 microns is the size of the anatomy only. </font><font style="vertical-align: inherit;">This means that if normal anatomy is needed, then a model accuracy of at least 100 microns is required. </font><font style="vertical-align: inherit;">It is cut approximately with an accuracy of 20 microns. </font><font style="vertical-align: inherit;">We divide 100 microns into 8 mm - we get an accuracy of about 1%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All this creates a problem - the technician spends a lot of time on many factors. </font><font style="vertical-align: inherit;">We decided to simplify its work and increase efficiency - more crowns per unit time. </font><font style="vertical-align: inherit;">We tried several options and chose neural networks, which simplified the work of the technician.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution methods</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CAD / CAM</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Each ‚Äúdental‚Äù company creates its own system. Glidewell Dental, Invisalign, Sirona - all have or are developing their own CAD / CAM systems. The systems look like AutoCAD or KOMPAS-3D: you have a standard object, you can pull, stroke, rotate it. Now, technicians work this way and spend 10 minutes to produce a normal crown. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ML - harmonic functions.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This is another way - relatively simple machine learning. For example, if you look at the crown from above, it will look like a circle with grooves, and then you can try to decompose it into harmonic functions. But we tried - with our conditions for accuracy, this does not work out. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, in the end, we turned to </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deep networks</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to generate three-dimensional objects. </font><font style="vertical-align: inherit;">I will tell two stories that are related to our choice. </font><font style="vertical-align: inherit;">The first is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propaedeutic</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is a training or educational story about jaw segmentation. </font><font style="vertical-align: inherit;">The second is about </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crown generation</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaw segmentation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segmentation of the jaw is a painting of each tooth and gum with its own color (for example, on an occlusal view). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mg/vw/n0/mgvwn0ocxq3vpcaa4wj7psvnwtu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segmentation is important. </font><font style="vertical-align: inherit;">For example, the jaw came in the form of a 3D model, and on it a sawn tooth stump. </font><font style="vertical-align: inherit;">In order for the program to understand where to put the tooth, it should at least be positioned relative to the stump. </font><font style="vertical-align: inherit;">In this case, a person usually sits and with a mouse clicks it and its neighbors, and only then does the program understand where to put the tooth. </font><font style="vertical-align: inherit;">With automatic segmentation, everything would be much more interesting - it would automatically indicate where to put the tooth.</font></font><br>
<blockquote>        .</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neural network training requires data. There are open datasets for segmenting faces, people's poses, letters - people enjoy attending conferences and sharing successes in training with each other. But finding a dataset for tooth segmentation is difficult. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are companies that have datasets with already segmented teeth. But they, of course, do not sell or give them away. This is the know-how and great value of every company. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortunately, we had a </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watershed</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geometric algorithm </font><font style="vertical-align: inherit;">, which I will discuss later. He can segment, but with an efficiency of 30% - normal segmentation in one out of three cases. We segmented the algorithm with 15 thousand cases, and then manually filtered. After filtering, 5 thousand good cases remained on which we trained SegNet.</font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. SegNet is the standard network for segmentation. A specific network is not so important. It is important what to do, in what sequence and where to get the data. </font></font></em><br>
<br>
<img src="https://habrastorage.org/webt/c4/vl/mk/c4vlmkvqyde_cc5fdrdjyotlrae.jpeg"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is how jaw segmentation with 12 teeth looks.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Everything seems to be fine - different beautiful colors, the teeth practically do not ‚Äúleak‚Äù. But it‚Äôs of little use to segment only those cases that we have already learned to segment geometrically. We would like to learn to segment all phase space. In the case of a strong correlation between the geometric and the neural network algorithm, the network will mainly segment only those cases that are already well segmented. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So the main question is: is there a correlation between what Watershed and SegNet are doing? To answer this question, you need to know how these algorithms work.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How Watershed and SegNet Work</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Watershed works on a 3D surface ‚Äî these are ‚Äúvalleys‚Äù separated by ridges with great spatial curvature. </font><font style="vertical-align: inherit;">When we move on a 3D surface, in some places there is a sharp bend, for example, where two teeth mate or one tooth enters the gum. </font><font style="vertical-align: inherit;">In these places ‚Äúridges‚Äù arise. </font><font style="vertical-align: inherit;">Watershed "pours water" and it covers the valleys, but does not cross the "ridges". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The algorithm does not work well where the spatial curvature is broken. </font><font style="vertical-align: inherit;">For example, there are two teeth with a common tangent. </font><font style="vertical-align: inherit;">They were scanned so that two teeth smoothly pass into each other. </font><font style="vertical-align: inherit;">The algorithm will paint two teeth with one color.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SegNet works like any segmented network. </font><font style="vertical-align: inherit;">He knows what can be approximately obtained inside - a segmented picture usually looks like 14 circles located in an arc, and around the gum. </font><font style="vertical-align: inherit;">SegNet is prone to errors: when the circles are irregular in shape, the patient has not 14 teeth, but 12 or the tooth falls out of the arch - the arc on which the teeth are located. </font><font style="vertical-align: inherit;">The picture shows just 12 teeth, it was hard, but the algorithm did it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that Watershed and SegNet do not correlate with each other, and everything is relatively normal.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subtotals</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimization is required for the end user</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We could spend a lot of time in advance to get rid of the correlation, think about it, take action. </font><font style="vertical-align: inherit;">But even without this, SegNet, when training on selected cases, yielded about 90% of the correct segmentations - a network of 9 out of 10 jaws segments perfectly. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual labor helps a lot. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You will find out your data and select what you need. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We pass to the main dish.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crown Generation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To generate the crown, we chose this scheme: we take the occlusal view and from it a monochrome map of depths - depth map. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6g/tz/wg/6gtzwgrvgzn1dxs7jadzcilp_aq.jpeg"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crown with deep anatomy (cross) and with secondary anatomy.</font></font></em><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data sources</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first source of data is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">natural teeth</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . There are many casts of the jaws, we now know how to segment them: we cut out natural teeth and train on them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We took them, but it turned out badly. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Natural teeth are too varied</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ordinary human teeth are not very beautiful, even among young people. I want the crown to be nicer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second data source is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ready-made crowns.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. We already have 5 million cases of 150 TB. They are stored in the Amazon cloud. Of the 5 million cases, we select those that have completed the techniques, and train on them. But it didn‚Äôt work out either. We carefully looked at our training set and found that from half to two-thirds of the finished crowns can be done better. This mainly concerned the depth of anatomy on the finished crowns - the grooves were not sufficiently expressed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This was an unpleasant discovery, because we took the results of specialists who should be imitated. But we already knew what to do in such cases.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We took 10 thousand cases and manually broke them into good and bad. </font><font style="vertical-align: inherit;">Received 5 thousand good on which you can learn. </font><font style="vertical-align: inherit;">But experimentally we knew that for training it takes from 10 to 15 thousand good cases. </font><font style="vertical-align: inherit;">To get them, you need to manually sort 30 thousand cases per tooth - this is too much. </font><font style="vertical-align: inherit;">Therefore, we trained a simple auxiliary network which showed teeth, and it separated the good from the bad. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/it/34/exit34h7wg7xdhniv-kbvebsecq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The figure shows that the three upper teeth have a deep anatomy - the cross is clearly visible, and on the lower depressions. </font><font style="vertical-align: inherit;">On the last (leftmost) there is no anatomy at all. </font><font style="vertical-align: inherit;">The technician ‚Äúlicked‚Äù this crown so that the anatomy disappeared. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the help of an auxiliary network, we can filter very large volumes, and receive 10-20 thousand cases per tooth.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generation Technical Details</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fines. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first thing that occurred to me was to take the generating network, show her the upper picture of the jaw with a stump of the tooth, require her to draw the lower one, and impose a fine L1. </font><font style="vertical-align: inherit;">But the theory says that it won‚Äôt work, and that‚Äôs why. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/lz/wa/ddlzwab6cs-3ler1n7bk9adipoy.jpeg"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The jaw with die above is with a sawed tooth, in the middle it is an antagonist, and the crown below, which should be created as a result of the network. </font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have already said that there are many good solutions for the same input. </font><font style="vertical-align: inherit;">If you simply impose a fine L1, then you will fine the network for the fact that it could not guess the image of the crown in the head of the technician at the moment when he designed it. </font><font style="vertical-align: inherit;">He could make such a crown, or he could make another, also good. </font><font style="vertical-align: inherit;">A fine for another good crown is not necessary.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L1's ‚Äúbare‚Äù penalty is a bad idea.</font></font></blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discriminator.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It‚Äôs a good idea to train a discriminator who says ‚ÄúGood‚Äù to all good crowns and ‚ÄúBad‚Äù to bad crowns. It will take into account the complex surface of good crowns (surface in the space of crowns). In addition, GAN, as it turned out, crushes high-frequency noise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our Loss is as follows: </font></font><code>Loss = D_GAN + L1 + AntagonistIntersectionPenalty</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>D_GAN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- takes into account the complex surface of possible good decisions. </font></font><code>AntagonistIntersectionPenalty</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">added so that the tooth does not intersect with the antagonist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important that L1 suddenly appears. </font><font style="vertical-align: inherit;">You just read that it should spoil something, but if you add it in a limited way, then it does not spoil. </font><font style="vertical-align: inherit;">The reason is that the GAN is quite unstable during training, and L1 reports that the tooth in any case looks like a white spot in the middle of the frame. </font><font style="vertical-align: inherit;">At the initial stage of training, it stabilizes - everything converges better, looks smooth and neat. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Technical Note </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We fought for a long time, trying to train one net for all back teeth or one net for a couple of teeth. </font><font style="vertical-align: inherit;">But we came to the conclusion that you need to train your network for every tooth, for every small localized piece of data. </font><font style="vertical-align: inherit;">We have such an opportunity.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One tooth - one network.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is important - this is your trade-off between the stability of the solution and the resources used. </font><font style="vertical-align: inherit;">If you spend an extra 200 MB of video memory, then (usually) nothing will happen. </font><font style="vertical-align: inherit;">But you will keep a separate network for each tooth and train it as needed.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subtotals</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We again used </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auxiliary networks</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manual labor</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sorted by hand, broke 10 thousand cases into ‚Äúgood and bad‚Äù;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the results of manual sorting we learned the auxiliary network;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bulk sifted unmarked cases.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hooray, we went into production!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After all that we did, we went into production. </font><font style="vertical-align: inherit;">This is not quite a real production - the Research &amp; Production group, but it creates 100 crowns per day. </font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">At the time of publication of the article, generating networks are already included in this product</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The group has been working since May - several thousand crowns were made by GANs. </font><font style="vertical-align: inherit;">A technician presses a button and a crown image is generated in 20 seconds. </font><font style="vertical-align: inherit;">The technician checks the correctness of the form, usually tightens the contacts, and sends it to a drink. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We received a substantial gain in time. </font><font style="vertical-align: inherit;">The crown is prepared in 8-10 minutes, and with the involvement of the GAN - in 4 minutes. </font><font style="vertical-align: inherit;">The GAN covers 80% of the cases - if the technician does not like what the GAN suggested, he models the crown with his hands and spends 8 minutes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The lessons</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimization for the end user</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the process, it‚Äôs useful to think about measures, metrics, loss function and correlations. But you did everything right if you brought the work to the end and got the expected result. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use of auxiliary networks. </font></font></strong><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual labor.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> There is a saying in ML: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Know your details." Using manual labor, you will find out what is in your data. Manual labor is usually rewarded because you ‚Äúfeed‚Äù your network with exactly what you need. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The balance of "quality - resources</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><strong><font style="vertical-align: inherit;">"</font></strong><font style="vertical-align: inherit;"> If possible, shift towards quality. Don't be greedy - add as many networks as you need.</font></font><br>
<br>
<blockquote>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Saint HighLoad++</a>. <b>6  7   -</b>              , ,    .         ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>,    Call for Papers  .     ,   -    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a>,      .</blockquote></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/en486028/">https://habr.com/ru/post/en486028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487582/index.html">Keine G√∂tter verbrennen T√∂pfe</a></li>
<li><a href="../de487584/index.html">Githabifizierung der Informationssicherheit</a></li>
<li><a href="../en486014/index.html">SLAC Tour: US Department of Energy National Accelerator Laboratory at Stanford</a></li>
<li><a href="../en486018/index.html">Session Survey Results</a></li>
<li><a href="../en486024/index.html">Really simple graphics in R for science and journalism</a></li>
<li><a href="../en486030/index.html">TL-SREET 55 5K LED Street Light Review</a></li>
<li><a href="../en486032/index.html">How to become a dialog designer</a></li>
<li><a href="../en486034/index.html">Quick entry to product management through Open source</a></li>
<li><a href="../en486036/index.html">Text sentiment analysis on Node.js</a></li>
<li><a href="../en486040/index.html">1. CheckFlow - fast and free comprehensive audit of internal network traffic using Flowmon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>