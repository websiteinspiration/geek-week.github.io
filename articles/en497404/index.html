<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôè üèØ üë¶üèª T + Conf 2019: Tarantool at Aeroflot, or MDM on the fly üò≥ ‚úåÔ∏è ü§≥üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we publish a transcript of the report of Nikolai Shevtsov and Rustam Kildiev with T + Conf 2019 " Tarantool in Aeroflot, or MDM (Master Data Man...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>T + Conf 2019: Tarantool at Aeroflot, or MDM on the fly</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/497404/"><img src="https://habrastorage.org/webt/tt/v8/vo/ttv8vohzeerxnvyinyfsi7wi1tw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today we publish a transcript of the report of Nikolai Shevtsov and Rustam Kildiev with T + Conf 2019 " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarantool in Aeroflot, or MDM (Master Data Management) on the fly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ." </font><font style="vertical-align: inherit;">From the report you will learn:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is MDM needed?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do i need real time?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Science is more than just a Jupyter Notebook.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pros of Tarantool.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why Lua is good at selling.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Information technology actively helps our company in attracting customers. Today, we are actively introducing a number of Big Data projects. These are marketing projects that help us in segmenting data and communicating information to customers, social research, dealing with complaints and appeals, and much more. Also, several projects are being implemented that help to increase the profitability and profitability of the business. For example, one of the projects is the analysis of available baggage on board in order to sell surplus on time, or to predict the failure of individual components and spare parts of aircraft for timely maintenance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is in the call handling platform that we actively use Tarantool, and a little more about it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main value of Big Data for us is the ability to analyze data. We are trying to collect all new sources of information related to Aeroflot in a single information field for further processing.</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c2/53c/34a/0c253c34a90c2d118b770ca120e63ba2.png"></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nikolay Shevtsov, Aeroflot. Project Manager in the Department of Information Systems.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
How do people usually buy a ticket? There is an idea about the trip, a person shares it with friends and relatives, in social networks and forums, and then buys a ticket on the site. There are many sources of information, and our task is to collect all of them and analyze them in order to understand the attitude of passengers to the service and the airline as a whole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of our projects is called the Call Platform. We collect all reviews, appeals and complaints from numerous sources. ‚ÄúPlatform‚Äù is our single collection window on the site or in the mobile application through which we receive information from users. We also collect Aeroflot related social media reviews.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Many Aeroflot divisions are involved in handling complaints and appeals: employees engaged in on-board services, in the departure area, in the arrival area, etc. Most complaints, about 2.5 thousand per day, come from arriving passengers who have any problems. Each complaint needs to be processed, classified and redirected to the appropriate department to a specific employee who can solve the passenger's problem. Identical complaints can be grouped to save time analyzing the situation and making a decision.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The aim of the project is to optimize the processing of applications and reduce the time for their processing. </font><font style="vertical-align: inherit;">To do this, it was necessary to create a system that, at the time of a complaint, automatically determines its topic and sends it to the appropriate department to the responsible employee. </font><font style="vertical-align: inherit;">In the process of processing a complaint, the system must find all available information on the client, up to his profile, planned future flights, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the start of the project, we considered several tools that could help us in this matter and eventually chose Tarantool. </font><font style="vertical-align: inherit;">Life has shown that this was the right choice: it allows you to comply with SLA requirements and at the same time scales well with increasing load.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementation</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aeroflot introduced a platform for handling complaints. </font><font style="vertical-align: inherit;">This is a repository of unstructured information, on the basis of which the analysis and synthesis of unique customer profiles is carried out.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b31/faa/6eb/b31faa6ebcbeb799116369a843ed6d96.jpg" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The information received upon requests must be processed and systematized. </font><font style="vertical-align: inherit;">Appeals are text that cannot be stored in a raw form, so the entire text is vectorized. </font><font style="vertical-align: inherit;">A search is made for a set of hits, a map of unique words and phrases is compiled, based on which the initial vector is calculated to convert all subsequent hits. </font><font style="vertical-align: inherit;">Initially, our data analysis specialists used classic tools - Python and Jupyter Notebook on a cluster or local laptop. </font><font style="vertical-align: inherit;">The vector has a dynamic size, which creates difficulties.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unlike many other tools, Tarantool is a complete application server. </font><font style="vertical-align: inherit;">We can use many libraries, such as SciLua, write logic in a regular programming language, etc. </font><font style="vertical-align: inherit;">Now we are vectorizing data using the SicLua library in real time directly in Tarantool. </font><font style="vertical-align: inherit;">Then, using the cosine distance method, the system searches for a similar vector for a three-month period. </font><font style="vertical-align: inherit;">As a result, we get either a double or similar calls for further processing. </font><font style="vertical-align: inherit;">In the search process, a lot of mathematical calculations are performed: in 3 months, approximately 100 thousand calls are processed from all available sources. </font><font style="vertical-align: inherit;">The average processing time is 120 ms.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9d/bac/534/e9dbac534af68444ed73e6c6b0c10aba.png"></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rustam Kildiev, CTO at Innodata.</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastructure</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our Tarantool database runs on four sixteen-core servers with a large amount of RAM. Thanks to the Vshard module, it was possible to implement a quick search with brute force. The data is divided into parts - buckets, so that query processing is parallelized. The system is easy to scale, just add a server. We have master-master replication implemented, although most DBMSs are now coming to that. Also, we do not need to add modules, there are no problems with administration.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our amount of data, if we count from RAM, is about 1 TB. </font><font style="vertical-align: inherit;">At the stage of starting, debugging and fixing errors in the project, problems arose. </font><font style="vertical-align: inherit;">Almost all tables contain 7-8 indexes, so the Tarantool database for 1 TB took us 20-40 minutes, which is unacceptable. </font><font style="vertical-align: inherit;">During startup, the system builds indexes and if you remove them, then loading will go much faster. </font><font style="vertical-align: inherit;">In this situation, the Hot-standby function helped us.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plans </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Both the customer and us, the performers, liked Tarantool. We considered other bases, but in the end we chose Tarantool. Firstly, we needed a very fast base. Secondly, it will have to work a lot with it, write logic, etc., so full-fledged Lua was an advantage for us. Thirdly, Tarantool immediately writes to disk and does not take snapshots, and this is good for us too, because although there are a lot of calls from customers, we cannot afford to lose even one. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tarantool has proven its usefulness in production, and we will load even more data into it, add business logic. Unlike other databases, it does not need to be constantly tuned and something changed. By the way, the conversion and loading of data into Tarantool from another system is automated and is performed daily.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the future, we plan to switch to Tarantool Enterprise, which will allow us to conveniently administer and configure several Tarantool instances. </font><font style="vertical-align: inherit;">There are still few specialists in this database, and the need for them is constantly growing. </font><font style="vertical-align: inherit;">Our qualifications are sometimes not enough. </font><font style="vertical-align: inherit;">In such cases, the Tarantool developers internal chat helps, in which you can ask for help. </font><font style="vertical-align: inherit;">This is not in any other system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also plan to upgrade to Tarantool2 and SQL. </font><font style="vertical-align: inherit;">There are many SQL experts in the labor market, so the transition will not be very difficult.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">findings </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main problem of this project was Lua. </font><font style="vertical-align: inherit;">Few developers know it, but they love it even less. </font><font style="vertical-align: inherit;">Initially, we wrote using another language, but due to the huge number of requests the system worked slowly. </font><font style="vertical-align: inherit;">Therefore, we copied everything with Lua for a long time and pain, but as a result, the system works clearly and quickly, with a small number of corrections and releases. </font><font style="vertical-align: inherit;">Lua is very close to machine code and is one of the fastest languages ‚Äã‚Äãfrom the C family. Although it is a small scripting language, it has all the necessary libraries, and we were able to transfer search, vectorization, cosine distance, etc. algorithms. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tarantool is very fault tolerant and works out of the box. </font><font style="vertical-align: inherit;">We conducted numerous experiments: turned off Tarantool, lifted, etc. </font><font style="vertical-align: inherit;">- everything works fine, and intermediate data is written to disk, so we do not lose data.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497392/index.html">How to grow from a student a software engineer?</a></li>
<li><a href="../en497394/index.html">Ten Resources with Computer Science Courses Available for Free in April</a></li>
<li><a href="../en497396/index.html">Colleagues: neither friend nor foe, but how?</a></li>
<li><a href="../en497398/index.html">AMD EPYC Rome 7x32 Server Processors - Record Single Core Performance</a></li>
<li><a href="../en497402/index.html">How to create a Python programming language?</a></li>
<li><a href="../en497408/index.html">How Russian polar explorers got cellular communications in Antarctica</a></li>
<li><a href="../en497412/index.html">Data Scientist: quarantined life memories and hope for the future</a></li>
<li><a href="../en497414/index.html">Network data processing on the fly</a></li>
<li><a href="../en497416/index.html">Touch Support in JavaScript</a></li>
<li><a href="../en497420/index.html">StegoPy - LSB Steganography Tool in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>