<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçå üéì üö¥üèΩ Was ist Windows PowerShell und was isst es? Teil 3: √úbergeben von Parametern an Skripte und Funktionen, Erstellen von Cmdlets üë®üèª‚Äçüè≠ ‚õàÔ∏è üîó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der zweite Teil der Serie befasste sich mit den Grundlagen der PowerShell-Programmiersprache. Jetzt lohnt es sich herauszufinden, wie der darauf gesch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Was ist Windows PowerShell und was isst es? Teil 3: √úbergeben von Parametern an Skripte und Funktionen, Erstellen von Cmdlets</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/493366/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zweite Teil der Serie</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befasste sich mit den Grundlagen der PowerShell-Programmiersprache. Jetzt lohnt es sich herauszufinden, wie der darauf geschriebene Code f√ºr Verwaltungsaufgaben verwendet werden kann. </font><font style="vertical-align: inherit;">Der naheliegendste Weg, dies zu tun, besteht darin, das Skript auszuf√ºhren. </font><font style="vertical-align: inherit;">Dar√ºber hinaus k√∂nnen Sie eigene Cmdlets erstellen.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhaltsverzeichnis:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positionsparameter </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param () -Block </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zus√§tzliche Parameterattribute </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úbergeben von Parametern durch die Pipeline </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionsk√∂rperstruktur </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attribut [CmdletBinding ()] und erweiterte Funktionen Skriptmodule </font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und Erstellen von Cmdlets</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positionsparameter</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Skripten und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen k√∂nnen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie Positionsparameter (Argumente) √ºbergeben, deren Werte in die integrierte Variable $ args geschrieben werden. </font><font style="vertical-align: inherit;">Dieses eindimensionale </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erfordert keine vorherige Deklaration und sein Umfang ist auf ein Skript oder eine Funktion beschr√§nkt. </font><font style="vertical-align: inherit;">F√ºhren Sie beispielsweise das einfachste Skript aus:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">":"</span> <span class="hljs-variable">$args</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/pv/ba/n8/pvban8oufym9ppbwb0jkgp_rwfq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Funktionen werden Positionsparameter auf die gleiche Weise verwendet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Print-Args</span></span> {
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 0:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">0</span>]
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 1:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">1</span>] <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Print-Args ‚ÄúZero‚Äù ‚ÄúOne‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass beim Aufrufen von Print-Args kein Komma zwischen die Parameter gesetzt wird: Es handelt sich nicht um ein Array, das an die Funktion √ºbergeben wird, sondern um einzelne Werte, die in das eindimensionale Array $ args geschrieben werden. Der Umfang wird durch den Funktionsk√∂rper begrenzt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/ur/o7/tfuro78h2bg7vhs405ymxd7ks-o.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der oben beschriebenen Methode k√∂nnen Sie eine beliebige Anzahl von Parametern an ein Skript oder eine Funktion √ºbergeben. Beim Aufrufen m√ºssen Sie jedoch die Reihenfolge ihrer Reihenfolge einhalten, und Sie k√∂nnen nur √ºber den Index des Arrays darauf zugreifen. Dies ist nicht immer praktisch.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param block ()</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Skripten und Funktionen ist es viel bequemer, benannte Parameter zu verwenden. </font><font style="vertical-align: inherit;">In einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fr√ºheren Artikel haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir √ºber eine M√∂glichkeit gesprochen, sie zu beschreiben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">(<span class="hljs-variable">$arg0</span>, ..., <span class="hljs-variable">$argN</span>)</span></span><font></font>
{<font></font>
       <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine √§hnliche Syntax ist Entwicklern bekannt, aber wenn eine Funktion aufgerufen wird, werden die Parameter (falls vorhanden) durch Leerzeichen getrennt und nicht in Klammern eingeschlossen - es entsteht eine gewisse Dissonanz. Dies ist die Besonderheit von Shell-Sprachen: F√ºr die Arbeit mit der Shell im interaktiven Modus sind Leerzeichen zwischen Werten viel praktischer. Der </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testaufruf ($ value0) ist</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ebenfalls korrekt, aber der Parameter ist in diesem Fall der gesamte Ausdruck in Klammern, d. H. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">($ value0)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anstelle von </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wenn Sie auf diese Weise mehrere Parameter √ºbergeben, funktionieren diese nicht. Als Ergebnis des Aufrufs von </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test ($ value0, $ value1)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erh√§lt </font><strong><font style="vertical-align: inherit;">die</font></strong><font style="vertical-align: inherit;"> Funktion nur eines - ein Array aus zwei Elementen mit den Werten </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value1</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Microsoft Corporation empfiehlt die Verwendung des Param () -Blocks. Diese Syntax ist universeller und erm√∂glicht es Ihnen, nicht nur Funktionsargumente, sondern auch Skriptparameter anzugeben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span> (
    <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$arg0</span> <span class="hljs-variable">$arg1</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/3o/yl/zy/3oylzy5_ukl893oyfcu54fejeaq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Hauptteil der Funktion sieht es so aus:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
     <span class="hljs-keyword">param</span> (
           <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
     )<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Argumentliste der Funktion klein ist, wird der Param () -Block nur das Design √ºberladen, aber in vielen F√§llen macht er den Code besser lesbar und ist unter anderem ein Element eines guten Programmierstils.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zus√§tzliche Parameterattribute</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Beschreibung von Funktionsargumenten oder Skriptparametern k√∂nnen deren zus√§tzliche Attribute festgelegt werden. </font><font style="vertical-align: inherit;">Das einfachste Beispiel ist eine Zwangsinstallation des Typs:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([int]<span class="hljs-variable">$arg0</span>)</span></span> {<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zum Typ Casting k√∂nnen Sie das Attribut [parameter ()] verwenden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Argument1</span>=<span class="hljs-type">value1</span>, <span class="hljs-type">Argument2</span>=<span class="hljs-type">value2</span>)]
    <span class="hljs-variable">$ParameterName</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit seiner Hilfe ist es einfach, den Parameter obligatorisch zu machen. </font><font style="vertical-align: inherit;">Achten Sie auf die gleichzeitige Verwendung mehrerer Attribute - in diesem Fall folgen sie aufeinander:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([parameter(Mandatory=<span class="hljs-variable">$true</span>)</span>][<span class="hljs-title">int</span>]$<span class="hljs-title">arg0</span>)</span> { <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
          <span class="hljs-keyword">parameter</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/km/2j/7a/km2j7agackddylgawcafzzho-fq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Position k√∂nnen Sie die Reihenfolge des Parameters angeben (standardm√§√üig entspricht sie der Reihenfolge der Deklaration):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>, <span class="hljs-type">Position</span>=<span class="hljs-number">0</span>)]<font></font>
                    [<span class="hljs-built_in">int</span>]
                    <span class="hljs-variable">$arg0</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">1</span>)]<font></font>
                    [<span class="hljs-built_in">string</span>]
                    <span class="hljs-variable">$arg1</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">2</span>)]<font></font>
                    [<span class="hljs-built_in">array</span>]
                    <span class="hljs-variable">$arg2</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Attribut [Parameter ()] enth√§lt andere Argumente, von denen eine vollst√§ndige Liste </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Website</font></a><font style="vertical-align: inherit;"> verf√ºgbar ist </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dort werden andere Attribute beschrieben, mit deren Hilfe Sie die √ºbergebenen Werte validieren, mit regul√§ren Ausdr√ºcken √ºberpr√ºfen usw. k√∂nnen. </font><font style="vertical-align: inherit;">Hier einige Beispiele: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Alias ‚Äã‚Äã()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> legt einen Alias ‚Äã‚Äãf√ºr den Parameter fest:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">alias</span>(<span class="hljs-string">"ARG"</span>,<span class="hljs-string">"ArgumentName"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Umwandlungsoperator [string []] bedeutet, dass der Parameterwert ein String-Array ist. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowNull ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erlaubt $ null als erforderlichen Parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowNull</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyString ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erlaubt eine leere Zeichenfolge als erforderlichen Parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyString</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyCollection ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erlaubt ein leeres Array als erforderlichen Parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyCollection</span>()]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ValidatePattern ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Validierung mit einem regul√§ren Ausdruck:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidatePattern</span>(<span class="hljs-string">"[0-9][0-9][0-9][0-9]"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ValidateLength ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºberpr√ºft die L√§nge eines Zeichenfolgenparameters:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidateLength</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter durch die Pipeline √ºbergeben</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ersten Artikel der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reihe haben wir √ºber die M√∂glichkeit gesprochen, Daten √ºber eine Pipeline an Cmdlets zu √ºbertragen. </font><font style="vertical-align: inherit;">In PowerShell geben Cmdlets und Funktionen Objekte oder Arrays von Objekten (Ergebnisse von Anweisungen) zur√ºck und empfangen sie auch an der Eingabe. </font><font style="vertical-align: inherit;">Um dies zu sehen, bereiten wir eines der Cmdlets mit Get-Help vor:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Stop-Process</span> <span class="hljs-literal">-Parameter</span> Name</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ci/fg/4_/cifg4_8pquaf9x684dyznzxff0m.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úber die Pipeline k√∂nnen Sie Parameterwerte akzeptieren, f√ºr die die entsprechenden Attribute festgelegt sind (ByValue und / oder ByPropertyName). </font><font style="vertical-align: inherit;">Im ersten Fall wird der Parameter mit einem √ºber die Pipeline empfangenen Objekt abgeglichen, sofern sein Typ dem erwarteten entspricht. </font><font style="vertical-align: inherit;">Im zweiten Parameter ist value die Eigenschaft des eingehenden Objekts, dessen Name dem Namen oder Alias ‚Äã‚Äãdieses Parameters entspricht. </font><font style="vertical-align: inherit;">Verwenden Sie zum Festlegen der Attribute [parameter ()] mit den booleschen Argumenten ValueFromPipeline und ValueFromPipelineByPropertyName, deren Standardwert $ false ist:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ValueFromPipelineByPropertyName wird normalerweise verwendet, wenn erforderlich, um mehrere Parameter zu √ºbergeben, damit keine Verwirrung entsteht. Das Argument kann gleichzeitig mit ValueFromPipeline verwendet werden: </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$Name</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ym/i4/go/ymi4gowjn0tz4dpkgzdl5wjxztu.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen k√∂nnen, k√∂nnen Skripte auch Parameter √ºber die Pipeline empfangen. Dennoch ist die praktische Anwendung der oben beschriebenen Attribute f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erweiterte Funktionen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wahrscheinlicher </font><font style="vertical-align: inherit;">, auf die weiter unten eingegangen wird.</font></font><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionsk√∂rperstruktur</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell kann eine Funktion drei optionale Codebl√∂cke enthalten, die in Anweisungsklammern eingeschlossen sind - Begin, Process und End. </font><font style="vertical-align: inherit;">Es sieht ungef√§hr so ‚Äã‚Äãaus:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
   <span class="hljs-keyword">param</span>()
   <span class="hljs-keyword">begin</span> {}
   <span class="hljs-keyword">process</span> {}
   <span class="hljs-keyword">end</span> {}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Begin-Block ist der erste, der einmal ausgef√ºhrt wird. Wenn die Parameter √ºber die Pipeline an die Funktion √ºbergeben werden, wird der Code ausgef√ºhrt, bevor das erste Objekt zur Verarbeitung eintrifft. Die Variablen $ _ und $ PSItem im Begin-Block enthalten in diesem Fall keine Werte. Wenn die Funktion mit explizit angegebenen Parametern aufgerufen wird, sind sie im Begin-Block verf√ºgbar, da nicht auf den Empfang von Objekten aus der Pipeline gewartet werden muss. Als n√§chstes wird der Prozessblock ausgef√ºhrt: Wenn die Parameter durch die Pipeline geleitet werden, wird er f√ºr jedes Objekt einzeln gestartet. Bei explizit angegebenen Parametern startet der Prozessblock nur einmal. Die Funktion endet mit einer einmaligen Ausf√ºhrung des Endblocks. Offensichtlich ist die Verwendung dieser Konstruktionen nur gerechtfertigt, wenn die Funktion Objekte aus der Pipeline empfangen kann:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">ValueFromPipeline</span>)]<font></font>
        [<span class="hljs-built_in">string</span>[]]
        <span class="hljs-variable">$Param1</span>,<font></font>
<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Param2</span><font></font>
    )<font></font>
<font></font>
    <span class="hljs-keyword">begin</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Begin"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">process</span> {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Process"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">end</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" End"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'eins', 'zwei', 'drei' | </font><font style="vertical-align: inherit;">test -Param2 'vier'</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aa/k5/fa/aak5fa8wzzrqxrzp4ixi-cybabw.png" alt="Bild"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[CmdletBinding ()] Attribut- und erweiterte Funktionen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie das Attribut [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CmdletBinding ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">, um "erweiterte" Funktionen (und streng genommen Skripte) zu erstellen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Insbesondere k√∂nnen Sie damit erweiterte Funktionen mit den Funktionen von in Visual Studio kompilierten bin√§ren Cmdlets definieren, bei denen es sich um Klassen von .NET Core-Klassen handelt. </font><font style="vertical-align: inherit;">Da dieses Attribut haupts√§chlich in Funktionen verwendet wird, werden wir bei ihnen aufh√∂ren:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> &lt;<span class="hljs-title">Name</span>&gt;</span><font></font>
{<font></font>
    [<span class="hljs-type">CmdletBinding</span>(<span class="hljs-type">ConfirmImpact</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">DefaultParameterSetName</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">HelpURI</span>=&lt;<span class="hljs-type">URI</span>&gt;,
    <span class="hljs-type">SupportsPaging</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">SupportsShouldProcess</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">PositionalBinding</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;)]<font></font>
<font></font>
    <span class="hljs-keyword">Param</span> ()<font></font>
<font></font>
    <span class="hljs-keyword">Begin</span>{}
    <span class="hljs-keyword">Process</span>{}
    <span class="hljs-keyword">End</span>{}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tats√§chlich initialisiert [CmdletBinding ()] eine neue Instanz der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CmdletBindingAttribute-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse, </font><font style="vertical-align: inherit;">indem ein Konstruktor </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aufgerufen</font></a><font style="vertical-align: inherit;"> wird, an den optionale Argumente √ºbergeben werden k√∂nnen. Ihre detaillierte Beschreibung finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Website</font></a><font style="vertical-align: inherit;"> . Mit dem CmdletBinding-Attribut k√∂nnen Sie zus√§tzliche Funktionen der erweiterten Funktion steuern: Hinzuf√ºgen von Unterst√ºtzung f√ºr -Confirm und -WhatIf (√ºber SupportsShouldProcess), -Force, -Verbose und -Debug sowie Deaktivieren der Positionsparameterbindung usw. Weiter werden wir die Verwendung spezieller Parameter analysieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Parameter </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Force wird</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwendet, um Anforderungen f√ºr verschiedene Operationen zu unterdr√ºcken. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Was, wenn</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wird ben√∂tigt, um den Start zu emulieren und Informationen √ºber die Folgen der Ausf√ºhrung einer Funktion (eines Befehls) ohne diesen Parameter anzuzeigen. Wird h√§ufig verwendet, wenn eine Funktion destruktive Aktionen ausf√ºhren kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remove-Item C: \ Windows \ notepad.exe -WhatIf </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ag/b9/cl/agb9cl6mbsaxqvrmwwl_fj1xjrm.png" alt="Bild"><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Confirm</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erfordert eine Best√§tigung und wird auch verwendet, wenn die Funktion destruktive Aktionen ausf√ºhren kann.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Delete-File</span></span> {<font></font>
[<span class="hljs-type">CmdletBinding</span>(
    <span class="hljs-type">ConfirmImpact</span> = <span class="hljs-string">'High'</span>,
    <span class="hljs-type">SupportsShouldProcess</span> = <span class="hljs-variable">$true</span><font></font>
)]<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$File</span>,<font></font>
        [<span class="hljs-type">switch</span>]<span class="hljs-variable">$Force</span><font></font>
    )<font></font>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$Force</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$PSCmdlet</span>.ShouldProcess(<span class="hljs-variable">$File</span>,<span class="hljs-string">"Delete file"</span>)) {
        <span class="hljs-built_in">Remove-Item</span> <span class="hljs-variable">$File</span><font></font>
    }<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/la/ie/oq/laieoqimwhyv-dtm_l5m0yp6xay.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um -WhatIf und / oder -Confirm zu verarbeiten, wird die ShouldProcess-Methode (SupportsShouldProcess = $ true) aufgerufen, die die Ausf√ºhrung des Befehls entweder auffordert oder emuliert. Um die Force-Verarbeitung zu implementieren, setzen wir sie zuerst in die IF-Bedingung. Zuerst wird der Ausdruck links vom Operator -or √ºberpr√ºft, und wenn er wahr ist, wird der Test gestoppt - die ShouldProcess-Methode wird nicht aufgerufen. Au√üerdem haben wir im Attribut [CmdletBinding ()] das ConfirmImpact-Argument angegeben, das den Einfluss des Codes auf das System bestimmt und den Parameterhandler -Confirm enth√§lt. Dieses Argument kann die folgenden Werte annehmen: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keine</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder nicht angegeben - Best√§tigungsmeldungen werden nicht angezeigt, selbst wenn der Parameter -Confirm √ºbergeben wird. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niedrig</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die Funktion wirkt sich geringf√ºgig auf das System aus und birgt kein signifikantes Risiko f√ºr Datenverlust.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mittlere</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mittlere Exposition mit geringem Risiko eines Datenverlusts infolge destruktiver Ma√ünahmen. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hoch</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Der Code birgt ein hohes Risiko f√ºr Datenverlust aufgrund destruktiver Aktionen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardm√§√üig wird f√ºr eine PowerShell-Sitzung die Belichtungsstufe als hoch angesehen. Der aktuelle Wert wird in der Variablen $ ConfirmPreference gespeichert. Wenn der Code die gleiche oder eine h√∂here Auswirkung auf das System hat, wird immer eine Best√§tigungsanforderung angezeigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Optionen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Verbose</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Debug</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird ben√∂tigt, um Debugging-Informationen anzuzeigen. </font><font style="vertical-align: inherit;">Ihre Verwendung wird als guter Programmierstil angesehen (Write-Host vergessen, dies ist in erweiterten Funktionen nicht erforderlich). </font><font style="vertical-align: inherit;">Der erste Parameter zeigt Informationen zum Fortschritt und der zweite detaillierte Debugging-Informationen an. </font><font style="vertical-align: inherit;">Es ist auch m√∂glich, auf die schrittweise Codeausf√ºhrung umzuschalten. </font><font style="vertical-align: inherit;">Das Verhalten von -Verbose und -Debug ist wie folgt definiert:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-Something</span></span> {
<span class="hljs-function">[<span class="hljs-type">CmdletBinding</span>()]</span>
    <span class="hljs-keyword">param</span>()
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Verbose) {<span class="hljs-variable">$VerbosePreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Debug) {<span class="hljs-variable">$DebugPreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-built_in">Write-Verbose</span> <span class="hljs-string">"Type some verbose information"</span>
    <span class="hljs-built_in">Write-Debug</span> <span class="hljs-string">"Type some debug information"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um mit speziellen Parametern zu arbeiten, haben wir die Variable $ PSBoundParameters verwendet. </font><font style="vertical-align: inherit;">Standardm√§√üig sind die Werte von $ VerbosePreference und $ DebugPreference gleich 'SilentlyContinue'. Selbst wenn die entsprechenden Parameter angegeben werden, werden Debugging-Informationen nicht angezeigt - sie m√ºssen in den Status 'Continue' √ºbertragen werden.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skriptmodule und Cmdlet-Erstellung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Erstellung eigener Cmdlets. In der Tat sind dies erweiterte Funktionen, die in der sogenannten beschrieben werden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skriptmodule</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Textdateien mit der Erweiterung .psm1. Sie werden in Verzeichnissen gespeichert, die in der Umgebungsvariablen PSModulePath definiert sind. Sie k√∂nnen die Pfade zu ihnen mit dem folgenden Befehl </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
anzeigen </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Get-ChildItem Env: \ PSModulePath | Format-Table -AutoSize </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Standardsatz sieht </font><font style="vertical-align: inherit;">ungef√§hr </font><font style="vertical-align: inherit;">so aus: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Benutzer \% Benutzername% \ Dokumente \ WindowsPowerShell \ Module </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Programme \ WindowsPowerShell \ Module </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Windows \ System32 \ WindowsPowerShell \ v1.0 \ Module</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie die Datei ModuleName.psm1 mit der erweiterten Funktion "Datei l√∂schen" aus dem vorherigen Abschnitt erstellt haben, m√ºssen Sie sie beispielsweise in] C: \ Benutzer \% Benutzername% \ Dokumente \ WindowsPowerShell \ Module \ Modulname speichern. Bitte beachten Sie, dass das Skriptmodul in einem separaten Unterverzeichnis gespeichert werden muss, dessen Name mit dem Basisnamen (ohne Erweiterung) der .psm1-Datei √ºbereinstimmt. Nach dem Ausf√ºhren des </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehls Import-Module ModuleName</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> steht dem Benutzer die Funktion Delete-File zur Verf√ºgung. Da sie erweitert ist, handelt es sich aus praktischer Sicht um dasselbe Cmdlet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/5d/fw/9j5dfwsxqzf3jeznbl_em53lnpi.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel haben wir die √úbergabe von Parametern an Funktionen und Skripte ausreichend detailliert untersucht. Der n√§chste Teil der Reihe konzentriert sich auf die objektorientierte Programmierung. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1: Windows PowerShell Essentials</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 4:   ,  <br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493348/index.html">Machen Sie "udalenka" wieder gro√üartig: Wie Sie das gesamte Unternehmen in 4 Schritten auf Remote-Arbeit √ºbertragen k√∂nnen</a></li>
<li><a href="../de493352/index.html">√úbertragen Sie Ihre Videos rund um die Uhr auf YouTube</a></li>
<li><a href="../de493356/index.html">Video @Databases Meetup: DBMS-Sicherheit, Tarantool in IoT, Greenplum f√ºr Big Data Analytics</a></li>
<li><a href="../de493360/index.html">Zwei Finger von Algol</a></li>
<li><a href="../de493362/index.html">Technischer Support "auf den Koffern". Wie wir ohne unn√∂tige Nerven aus der Ferne arbeiten und die Dienste erhalten, die wir aus der Ferne ben√∂tigen</a></li>
<li><a href="../de493374/index.html">Coronavirus - praktische Tipps und ein bisschen Theorie</a></li>
<li><a href="../de493376/index.html">The Big Initiative Theory - Russische Erfahrung in der digitalen Transformation von Industrieunternehmen</a></li>
<li><a href="../de493378/index.html">Steam hat Sie: Wie die digitale Verbreitung unsere Spiele wegnimmt</a></li>
<li><a href="../de493380/index.html">Julia und Quantencomputer</a></li>
<li><a href="../de493382/index.html">.NET Core Windows Forms Designer-Updates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>