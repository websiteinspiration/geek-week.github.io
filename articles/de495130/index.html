<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍣 👨🏾‍🤝‍👨🏼 👩🏻‍🚒 Sortieren in Scala - ein Beispiel für Katzen 👍🏾 🙆🏾 😩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! Ich bringe eine russische Übersetzung meines Artikels über Medium: Sorting in Scala - ein Beispiel für einen Katzenladen - vor Gericht . D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sortieren in Scala - ein Beispiel für Katzen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495130/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr! </font><font style="vertical-align: inherit;">Ich bringe eine russische Übersetzung meines Artikels über Medium: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sorting in Scala - ein Beispiel für einen Katzenladen - vor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gericht </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der Artikel richtet sich an Leser, die die Syntax der Scala-Sprache kennen und sich mit den grundlegenden Werkzeugen der Standardbibliothek auskennen.</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trotz der Tatsache, dass sowohl Java als auch Scala die JVM als Laufzeitplattform verwenden, hat Scala dank einer signifikanten Anpassung der Konzepte der funktionalen Programmierung und einer umfangreichen Standardbibliothek als viel ausdrucksstärkere Sprache an Bekanntheit gewonnen. </font><font style="vertical-align: inherit;">In diesem Artikel werde ich ein Beispiel für diese Ausdruckskraft betrachten und versuchen, mir vorzustellen, wie sich ein kleiner Teil der Codebasis und der entsprechenden Anforderungen im Laufe der Zeit entwickeln kann.</font></font></p><br>
<h2 id="pervonachalnaya-postanovka-zadachi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erste Erklärung des Problems</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sich vor, wir haben einen Katzenladen zur Verfügung (weil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Katzen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das beliebteste Tier im Scala-Ökosystem sind). </font><font style="vertical-align: inherit;">Aufgrund der Besonderheiten, Informationen über zum Verkauf angebotene Katzen zu erhalten, stammen die Informationen in einigen Fällen nicht aus der Datenbank und müssen manuell sortiert werden, bevor eine HTTP-Antwort an den Kunden gesendet oder auf andere Weise verarbeitet wird. </font><font style="vertical-align: inherit;">Das Hauptobjekt des Themenbereichs ist natürlich, </font></font><code>Cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dass zu Beginn nur drei Felder primitiver Typen vorhanden sind. </font><font style="vertical-align: inherit;">Ziel ist es, eine API zum Sortieren von Katzensammlungen zu entwickeln, die die folgenden Anforderungen erfüllt:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Sortierreihenfolge kann für jedes der Felder festgelegt werden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Sortierreihenfolge darf für keines der Felder definiert werden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Sortierung muss für Felder mit einer undefinierten Sortierreihenfolge stabil sein</font></font></li>
<li>       (..    <code>age</code>       <code>name</code>)</li>
</ul><br>
<h2 id="pervaya-iteraciya"> </h2><br>
<pre><code class="scala hljs"><span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span>(<span class="hljs-params">age: <span class="hljs-type">Int</span>,
               name: <span class="hljs-type">String</span>,
               available: <span class="hljs-type">Boolean</span></span>)</span></code></pre><br>
<p>    ,       ,     .  , <code>scala.Ordering</code>     <code>Tuple3</code>,       <code>Ordering</code>    3,        <code>Cat</code>.</p><br>
<p>  ,   <code>Tuple3</code>   ,           .  ,        —      <code>Tuple1</code>, <code>Tuple2</code>, <code>Tuple3</code>,         <code>Ordering</code>,     .     9  (3     3 ),    .</p><br>
<p> ,   API      ,  " "  .  ,   3 :   (),   ( )  "" (  ).          (ADT):</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">sealed</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">SortOrder</span> </span>{<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Keep</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Asc</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Desc</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span>
}</code></pre><br>
<p>        <code>Ordering</code>.  <code>SortOrder</code>   ,    ,        ,       :</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> common.<span class="hljs-type">OrderingUtil</span>
<span class="hljs-keyword">import</span> iteration1.<span class="hljs-type">SortOrder</span>.{<span class="hljs-type">Asc</span>, <span class="hljs-type">Desc</span>, <span class="hljs-type">Keep</span>}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">syntax</span> </span>{<font></font>
<font></font>
  <span class="hljs-keyword">implicit</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderSyntax</span>(<span class="hljs-params">val order: <span class="hljs-type">SortOrder</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">AnyVal</span> </span>{<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span></span>[<span class="hljs-type">A</span>](ordering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>] =<font></font>
      order <span class="hljs-keyword">match</span> {
        <span class="hljs-keyword">case</span> <span class="hljs-type">Keep</span> =&gt; <span class="hljs-type">OrderingUtil</span>.identity
        <span class="hljs-keyword">case</span> <span class="hljs-type">Asc</span> =&gt; ordering
        <span class="hljs-keyword">case</span> <span class="hljs-type">Desc</span> =&gt; ordering.reverse<font></font>
      }<font></font>
  }<font></font>
}</code></pre><br>
<p><code>OrderingUtil.identity</code> —  ,        <code>A</code>,   .   : <code>Ordering.by(_ =&gt; 0)</code>.</p><br>
<p>,    ,     <code>Ordering[Cat]</code>.      <code>CatOrdering</code>:</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> iteration1.syntax._<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CatOrdering</span> </span>{<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">of</span></span>(idOrder: <span class="hljs-type">SortOrder</span>,<font></font>
         nameOrder: <span class="hljs-type">SortOrder</span>,<font></font>
         availableOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =
    <span class="hljs-type">Ordering</span>
      .<span class="hljs-type">Tuple3</span>(idOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">Int</span>), nameOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>), availableOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">Boolean</span>))<font></font>
      .on[<span class="hljs-type">Cat</span>](cat =&gt; (cat.age, cat.name, cat.available))<font></font>
}</code></pre><br>
<p>     (<code>Ordering[Cat]</code>)       <code>CatOrdering.of</code>:</p><br>
<pre><code class="scala hljs"><span class="hljs-type">CatOrdering</span>.of(<span class="hljs-type">SortOrder</span>.<span class="hljs-type">Asc</span>, <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Keep</span>, <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Desc</span>)</code></pre><br>
<p>     ,        ScalaTest  ScalaCheck    property-based .     ,        .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>.</p><br>
<h2 id="vtoraya-iteraciya"> </h2><br>
<p>         <code>Cat</code>   <strong></strong> .</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span>(<span class="hljs-params">age: <span class="hljs-type">Int</span>,
               name: <span class="hljs-type">String</span>,
               available: <span class="hljs-type">Boolean</span>,
               owner: <span class="hljs-type">Option</span>[<span class="hljs-type">String</span>]</span>)</span></code></pre><br>
<p>      ,     —   (     <code>null</code>!), ,    ,     ,  .  ,   4      :</p><br>
<ol>
<li> ,     ()</li>
<li> ,    </li>
<li> ,    </li>
<li> ,     ( )</li>
</ol><br>
<p>       (1  4)     <code>scala.Ordering.Option</code>,  2    .  <code>SortOrder</code>       ,     :</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">sealed</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">SortOrder</span> </span>{<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Asc</span>(<span class="hljs-params">emptyFirst: <span class="hljs-type">Boolean</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Desc</span>(<span class="hljs-params">emptyFirst: <span class="hljs-type">Boolean</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Keep</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SortOrder</span></span><font></font>
<font></font>
  <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Asc</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyFirst</span></span>: <span class="hljs-type">Asc</span> = <span class="hljs-type">Asc</span>(emptyFirst = <span class="hljs-literal">true</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyLast</span></span>: <span class="hljs-type">Asc</span> = <span class="hljs-type">Asc</span>(emptyFirst = <span class="hljs-literal">false</span>)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Desc</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyFirst</span></span>: <span class="hljs-type">Desc</span> = <span class="hljs-type">Desc</span>(emptyFirst = <span class="hljs-literal">true</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyLast</span></span>: <span class="hljs-type">Desc</span> = <span class="hljs-type">Desc</span>(emptyFirst = <span class="hljs-literal">false</span>)<font></font>
  }<font></font>
}</code></pre><br>
<p>       <code>SortOrder</code>.  <code>optional</code>  <code>Ordering[Option[A]]</code>   <code>A</code>,        ,   <code>SortOrder</code>.  , ,  <code>Ordering[Option[A]]</code>        <code>apply</code>,      <code>Ordering[Option[A]]</code>,      .       ,  <code>A</code>  <code>apply</code>    <code>Option</code>.         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><code>  &lt;:&lt;</code></a>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">   StackOverflow</a> ( Dotty <code>Not</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">    </a>).</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> common.<span class="hljs-type">OrderingUtil</span>
<span class="hljs-keyword">import</span> iteration2.sort_order.<span class="hljs-type">SortOrder</span>._<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">syntax</span> </span>{<font></font>
<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">OptionOrdering</span> </span>{<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span></span>[<span class="hljs-type">A</span>](rootOrdering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>],<font></font>
                 emptyFirst: <span class="hljs-type">Boolean</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]] =
      <span class="hljs-keyword">if</span> (emptyFirst)
        <span class="hljs-type">OptionOrdering</span>.emptyFirst(rootOrdering)
      <span class="hljs-keyword">else</span>
        <span class="hljs-type">OptionOrdering</span>.emptyLast(rootOrdering)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyFirst</span></span>[<span class="hljs-type">A</span>](rootOrdering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]] =<font></font>
      (x: <span class="hljs-type">Option</span>[<span class="hljs-type">A</span>], y: <span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]) =&gt; (x, y) <span class="hljs-keyword">match</span> {
        <span class="hljs-keyword">case</span> (<span class="hljs-type">None</span>, <span class="hljs-type">None</span>) =&gt; <span class="hljs-number">0</span>
        <span class="hljs-keyword">case</span> (<span class="hljs-type">None</span>, _) =&gt; <span class="hljs-number">-1</span>
        <span class="hljs-keyword">case</span> (_, <span class="hljs-type">None</span>) =&gt; <span class="hljs-number">1</span>
        <span class="hljs-keyword">case</span> (<span class="hljs-type">Some</span>(a), <span class="hljs-type">Some</span>(b)) =&gt; rootOrdering.compare(a, b)<font></font>
      }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">emptyLast</span></span>[<span class="hljs-type">A</span>](rootOrdering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]] =<font></font>
      (x: <span class="hljs-type">Option</span>[<span class="hljs-type">A</span>], y: <span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]) =&gt; (x, y) <span class="hljs-keyword">match</span> {
        <span class="hljs-keyword">case</span> (<span class="hljs-type">None</span>, <span class="hljs-type">None</span>) =&gt; <span class="hljs-number">0</span>
        <span class="hljs-keyword">case</span> (<span class="hljs-type">None</span>, _) =&gt; <span class="hljs-number">1</span>
        <span class="hljs-keyword">case</span> (_, <span class="hljs-type">None</span>) =&gt; <span class="hljs-number">-1</span>
        <span class="hljs-keyword">case</span> (<span class="hljs-type">Some</span>(a), <span class="hljs-type">Some</span>(b)) =&gt; rootOrdering.compare(a, b)<font></font>
      }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">implicit</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderSyntax</span>(<span class="hljs-params">val order: <span class="hljs-type">SortOrder</span></span>) <span class="hljs-keyword">extends</span> <span class="hljs-title">AnyVal</span> </span>{<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">optional</span></span>[<span class="hljs-type">A</span>](ordering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Option</span>[<span class="hljs-type">A</span>]] =<font></font>
      order <span class="hljs-keyword">match</span> {
        <span class="hljs-keyword">case</span> <span class="hljs-type">Keep</span> =&gt; <span class="hljs-type">OrderingUtil</span>.identity
        <span class="hljs-keyword">case</span> <span class="hljs-type">Asc</span>(emptyFirst) =&gt; <span class="hljs-type">OptionOrdering</span>(ordering, emptyFirst)
        <span class="hljs-keyword">case</span> <span class="hljs-type">Desc</span>(emptyFirst) =&gt; <span class="hljs-type">OptionOrdering</span>(ordering.reverse, emptyFirst)<font></font>
      }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply</span></span>[<span class="hljs-type">A</span>](ordering: <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">A</span>] =<font></font>
      order <span class="hljs-keyword">match</span> {
        <span class="hljs-keyword">case</span> <span class="hljs-type">Keep</span> =&gt; <span class="hljs-type">OrderingUtil</span>.identity
        <span class="hljs-keyword">case</span> <span class="hljs-type">Asc</span>(_) =&gt; ordering
        <span class="hljs-keyword">case</span> <span class="hljs-type">Desc</span>(_) =&gt; ordering.reverse<font></font>
      }<font></font>
  }<font></font>
}</code></pre><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> iteration2.sort_order.<span class="hljs-type">SortOrder</span>
<span class="hljs-keyword">import</span> iteration2.sort_order.syntax._<font></font>
<font></font>
<span class="hljs-keyword">import</span> scala.<span class="hljs-type">Ordering</span>.{<span class="hljs-type">Boolean</span> =&gt; <span class="hljs-type">BooleanO</span>, <span class="hljs-type">Int</span> =&gt; <span class="hljs-type">IntO</span>, <span class="hljs-type">String</span> =&gt; <span class="hljs-type">StringO</span>}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CatOrdering</span> </span>{<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(idOrder: <span class="hljs-type">SortOrder</span>,<font></font>
                 nameOrder: <span class="hljs-type">SortOrder</span>,<font></font>
                 availableOrder: <span class="hljs-type">SortOrder</span>,<font></font>
                 ownerOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] = {
    <span class="hljs-type">Ordering</span>
      .<span class="hljs-type">Tuple4</span>(idOrder(<span class="hljs-type">IntO</span>), nameOrder(<span class="hljs-type">StringO</span>), availableOrder(<span class="hljs-type">BooleanO</span>), ownerOrder.optional(<span class="hljs-type">StringO</span>))<font></font>
      .on[<span class="hljs-type">Cat</span>](cat =&gt; (cat.age, cat.name, cat.available, cat.owner))<font></font>
  }<font></font>
}</code></pre><br>
<p>  <code>Ordering[Cat]</code>  .  ,            . </p><br>
<pre><code class="scala hljs"><span class="hljs-type">CatOrdering</span>.toOrdering(
  <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Asc</span>.emptyFirst, 
  <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Asc</span>.emptyFirst, 
  <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Asc</span>.emptyFirst,
  <span class="hljs-type">SortOrder</span>.<span class="hljs-type">Asc</span>.emptyFirst<font></font>
)</code></pre><br>
<p>  ,   <code>Option</code>,           .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>.</p><br>
<h3 id="tretya-iteraciya"> </h3><br>
<p>           .   ,   :</p><br>
<ol>
<li>     .</li>
<li>  -     ,        <code>SortOrder.Keep</code>.</li>
<li>   <code>Cat</code>  9.      <code>Tuple10</code>     .</li>
</ol><br>
<p> -       .        ,    <code>Cat</code>    10 .      , ,          .  ,      ,    <code>SortOrder</code>        .       .</p><br>
<p>    ,        ,    .               <code>Cat</code>.           ( №1)      ( №2),                 ( №3).      (<code>SortOrder</code>          ):</p><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> java.time.<span class="hljs-type">LocalDate</span><font></font>
<font></font>
<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span>(<span class="hljs-params">age: <span class="hljs-type">Int</span>,
               name: <span class="hljs-type">String</span>,
               available: <span class="hljs-type">Boolean</span>,
               owner: <span class="hljs-type">Option</span>[<span class="hljs-type">String</span>],
               breed: <span class="hljs-type">String</span>,
               furColor: <span class="hljs-type">String</span>,
               eyeColor: <span class="hljs-type">String</span>,
               registrationId: <span class="hljs-type">String</span>,
               lastHealthCheck: <span class="hljs-type">Option</span>[<span class="hljs-type">LocalDate</span>],
               urgentSell: <span class="hljs-type">Boolean</span></span>)</span></code></pre><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> java.time.<span class="hljs-type">LocalDate</span><font></font>
<font></font>
<span class="hljs-keyword">import</span> iteration3.sort_order.<span class="hljs-type">SortOrder</span>
<span class="hljs-keyword">import</span> iteration3.sort_order.syntax._<font></font>
<font></font>
<span class="hljs-keyword">import</span> scala.<span class="hljs-type">Ordering</span>._<font></font>
<font></font>
<span class="hljs-keyword">sealed</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">CatField</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CatField</span> </span>{<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Age</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">Int</span>).on(_.age)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Name</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.name)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Available</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">Boolean</span>).on(_.available)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Owner</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder.optional(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.owner)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Breed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.breed)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">FurColor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.furColor)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">EyeColor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.eyeColor)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">RegistrationId</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">String</span>).on(_.registrationId)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">LastHealthCheck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder.optional(<span class="hljs-type">Ordering</span>.by[<span class="hljs-type">LocalDate</span>, <span class="hljs-type">Long</span>](_.toEpochDay)).on(_.lastHealthCheck)<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">UrgentSell</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CatField</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toOrdering</span></span>(sortOrder: <span class="hljs-type">SortOrder</span>): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =<font></font>
      sortOrder(<span class="hljs-type">Ordering</span>.<span class="hljs-type">Boolean</span>).on(_.urgentSell)<font></font>
  }<font></font>
}</code></pre><br>
<pre><code class="scala hljs"><span class="hljs-keyword">import</span> common.<span class="hljs-type">OrderingUtil</span>
<span class="hljs-keyword">import</span> iteration3.sort_order.<span class="hljs-type">SortOrder</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">CatOrdering</span> </span>{<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">byFields</span></span>(fields: <span class="hljs-type">Seq</span>[(<span class="hljs-type">CatField</span>, <span class="hljs-type">SortOrder</span>)]): <span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>] =
    <span class="hljs-keyword">if</span> (fields.isEmpty) <span class="hljs-type">OrderingUtil</span>.identity[<span class="hljs-type">Cat</span>]
    <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">val</span> (head, headOrder) = fields.head
      <span class="hljs-keyword">val</span> (res, _) = fields.tail.foldLeft[(<span class="hljs-type">Ordering</span>[<span class="hljs-type">Cat</span>], <span class="hljs-type">Set</span>[<span class="hljs-type">CatField</span>])]((head.toOrdering(headOrder), <span class="hljs-type">Set</span>())) {
        <span class="hljs-keyword">case</span> (acc@(_, presentFields), (field, _)) <span class="hljs-keyword">if</span> presentFields.contains(field) =&gt;<font></font>
          acc<font></font>
<font></font>
        <span class="hljs-keyword">case</span> ((ordering, presentFields), (field, order)) =&gt;<font></font>
          (ordering.orElse(field.toOrdering(order)), presentFields + field)<font></font>
      }<font></font>
      res<font></font>
    }<font></font>
}</code></pre><br>
<p>      <code>orElse</code>,    ,        .      <code>thenComparing</code>  <code>Comparator</code>   Java.       <code>Ordering</code>,     <code>Comparator</code>   .   , <code>orElse</code>       Scala,      <code>orElseBy</code>.</p><br>
<p> , ,   <code>byFields</code>           ,    . ,      <code>OrderingUtil.identity</code>,     .              " ",  <code>foldLeft</code>,       .</p><br>
<p>      <code>SortOrder.Keep</code>,  ,     ,        .   ,    ,    .          HTTP    ,       .</p><br>
<p>      . ,             ,       ,    .        (     )     ,   ,       .  ,   ,      ,  ,     ,   .</p><br>
<p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>.</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obwohl die endgültige Implementierung in anderen Programmiersprachen ähnlich aussehen mag, scheint mir Scala einen guten Kompromiss zwischen Typensicherheit und Verständlichkeit und Lesbarkeit des Codes zu bieten. </font><font style="vertical-align: inherit;">Ich hoffe, dass diese Veröffentlichung dazu beigetragen hat, das Sortieren von Sammlungen in Scala besser zu verstehen, oder Ideen vorgeschlagen hat, die in Code angewendet werden können, der nicht in direktem Zusammenhang steht </font></font><code>Ordering</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der gesamte Beispielcode ist in </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">diesem Github-Repository</font></a><font style="vertical-align: inherit;"> verfügbar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495116/index.html">Wie man alles von Nano bis Makro versteckt: Wissenschaftler haben die allgemeinen Prinzipien der "Theorie der Unsichtbarkeit" entwickelt.</a></li>
<li><a href="../de495118/index.html">Probleme bei der Verwendung von Doctrine ODM in Daemon-Prozessen</a></li>
<li><a href="../de495120/index.html">Es ist Zeit, die OpenBSD-Sicherheit zu überdenken</a></li>
<li><a href="../de495124/index.html">Wie man ein Macbook stiehlt</a></li>
<li><a href="../de495128/index.html">Gibt es ein menschliches Gesichts-VPN?</a></li>
<li><a href="../de495138/index.html">Wie werden sich Gesellschaft und Technologie nach dem Coronavirus verändern? Expertenmeinungen</a></li>
<li><a href="../de495140/index.html">Top 10 Memes des letzten Jahrzehnts</a></li>
<li><a href="../de495146/index.html">Unterbrechungsfreie Stromversorgung von Einkaufszentren oder Shopping Must On On</a></li>
<li><a href="../de495148/index.html">Dell XPS 13 7390 "2 in 1": ein leichter Metalltransformator mit hellem Bildschirm und Intel Ice Lake</a></li>
<li><a href="../de495150/index.html">Docker und VMWare Workstation auf demselben Windows-Computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>