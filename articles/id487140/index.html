<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🤝‍👨🏻 📢 ✋🏾 Menyimpan logika bisnis di Swift Combine. Bagian 1 🙎🏻 👯 🖖🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Menggabungkan Data Berorientasi
 
 
 
 
 Terjemahan artikel disiapkan khusus untuk siswa dari kursus lanjutan "Pengembang iOS" .
 
 
 
 
 Dalam seri p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Menyimpan logika bisnis di Swift Combine. Bagian 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/487140/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggabungkan Data Berorientasi</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/-6/vr/fp/-6vrfp7fsjumtkug45wzkpu8mde.png"><br>
<br>
<hr><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terjemahan artikel disiapkan khusus untuk siswa dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kursus lanjutan "Pengembang iOS"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
</b><br>
<hr><br>
<img src="https://habrastorage.org/webt/hp/0d/0q/hp0d0qfoty-seoe-uqpjd-oqsrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seri posting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sebelumnya </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> kami berhasil membangun platform di atas SwiftUI, yang dengannya Anda dapat dengan bebas mengamati urutan nilai yang melewati </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penerbit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Combine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menciptakan serangkaian contoh menunjukkan beberapa Menggabungkan operator default yang mampu memodifikasi dan mengubah nilai-nilai dalam urutan seperti </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">filter</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">map</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">drop</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">scan</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Selain itu, kami telah menghadirkan beberapa operator yang menghubungkan ( </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zip</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CombineLatest</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) atau menyatukan ( </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Merge</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Append</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) urutan.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada titik ini, beberapa dari Anda mungkin bosan karena harus mengatur dan memelihara begitu banyak kode untuk setiap contoh (setidaknya saya sudah lelah). Lihat berapa banyak dari mereka yang ada di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori combin-magic-swiftui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder tutorial? Masing-masing contoh adalah representasi dari SwiftUI. Masing-masing dari mereka hanya mentransfer satu atau beberapa penerbit ke </font></font><code>StreamView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan </font></font><code>StreamView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menandatangani penerbit di klik tombol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, saya harus dapat membuat daftar penerbit di program startup dan menggunakan kembali secara terprogram </font></font><code>StreamView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seperti pada tangkapan layar di bawah ini. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uw/vz/nw/uwvznw3n6nj58-kch_x5vnqhtdc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, masalah dengan solusi ini adalah skalabilitas, saat Anda harus membuat banyak penerbit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi saya untuk masalah ini adalah entah bagaimana menyimpan penerbit ini. </font><font style="vertical-align: inherit;">Jika saya bisa membuat serialisasi entah bagaimana caranya, saya bisa menyimpannya. </font><font style="vertical-align: inherit;">Jika saya berhasil menyimpannya, saya tidak hanya dapat memodifikasinya tanpa mengubah kode, tetapi saya juga dapat membaginya dengan perangkat lain yang mendukung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyimpanan dan transfer operator Gabungkan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lihat tujuan kita di sini secara lebih spesifik. </font><font style="vertical-align: inherit;">Karena kami memiliki daftar aliran dan operator dalam format </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kami ingin dapat menyimpannya dalam segala jenis penyimpanan - misalnya, pada hard disk atau dalam database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, kami juga harus dapat mengkonversi data yang disimpan kembali ke penerbit, tetapi selain itu, kami ingin dapat bertukar, mentransfer, dan mendistribusikan penerbit ini dengan operator dari satu tempat ke tempat lain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah kami membuat struktur seperti itu, seperti yang Anda duga, dalam lingkungan terdistribusi, layanan terpusat dapat mulai mengelola logika komputasi untuk sekelompok klien.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/0d/0q/hp0d0qfoty-seoe-uqpjd-oqsrk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Struktur yang Dapat Dikodekan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi bagaimana kita melakukan ini? </font><font style="vertical-align: inherit;">Kami akan mulai dengan mengembangkan struktur yang serializable dan deserializable. </font><font style="vertical-align: inherit;">Protokol Swift </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Codable</a> </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan kita melakukan ini melalui </font></font><code>JSONEncoder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>JSONDecoder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Selain itu, struktur harus benar mewakili data dan perilaku untuk unit nilai terkecil dalam aliran, hingga rantai operator yang kompleks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum beralih untuk memahami komponen apa yang diperlukan untuk struktur yang akan kita buat, mari kita ingat aliran utama yang kita buat di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seri posting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sebelumnya </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aliran angka</font></font></h3><br>
<img src="https://habrastorage.org/webt/hg/n3/_f/hgn3_fnhmyzj7vggg4s3s2gd-xi.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah aliran termudah; </font><font style="vertical-align: inherit;">Namun, jika Anda melihat lebih dalam, Anda akan melihat bahwa ini bukan hanya urutan array. </font><font style="vertical-align: inherit;">Setiap blok bundar memiliki operator penundaan sendiri ( </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), yang menentukan waktu aktual kapan harus dikirim. </font><font style="vertical-align: inherit;">Setiap nilai dalam Combine terlihat seperti ini:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-type">Just</span>(value).delay(<span class="hljs-keyword">for</span>: .seconds(<span class="hljs-number">1</span>), scheduler: <span class="hljs-type">DispatchQueue</span>.main)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan secara umum, semuanya terlihat seperti ini:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> val1 = <span class="hljs-type">Just</span>(<span class="hljs-number">1</span>).delay(<span class="hljs-keyword">for</span>: .seconds(<span class="hljs-number">1</span>), scheduler:   <span class="hljs-type">DispatchQueue</span>.main)
<span class="hljs-keyword">let</span> val2 = <span class="hljs-type">Just</span>(<span class="hljs-number">2</span>).delay(<span class="hljs-keyword">for</span>: .seconds(<span class="hljs-number">1</span>), scheduler: <span class="hljs-type">DispatchQueue</span>.main)
<span class="hljs-keyword">let</span> val3 = ....
<span class="hljs-keyword">let</span> val4 = ....
<span class="hljs-keyword">let</span> publisher = val1.append(val2).append(val3).append(val4)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap nilai ditunda selama sedetik, dan pernyataan yang sama ditambahkan ke nilai berikutnya </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, kami belajar dua hal dari pengamatan kami.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aliran bukanlah unit terkecil dalam struktur. </font><font style="vertical-align: inherit;">Yang terkecil adalah nilai stream.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap nilai stream dapat memiliki operator tanpa batas yang mengontrol kapan dan nilai apa yang dikirimkan.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat StreamItem Anda</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena nilai stream dan operatornya adalah unit terkecil, kami mulai dengan membuat strukturnya. </font><font style="vertical-align: inherit;">Mari kita panggil dia </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StreamItem</span>&lt;<span class="hljs-title">T</span>: <span class="hljs-title">Codable</span>&gt;: <span class="hljs-title">Codable</span> </span>{
 <span class="hljs-keyword">let</span> value: <span class="hljs-type">T</span>
 <span class="hljs-keyword">var</span> operators: [<span class="hljs-type">Operator</span>]<font></font>
}</code></pre><br>
<code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termasuk nilai stream dan array operator. </font><font style="vertical-align: inherit;">Menurut persyaratan kami, kami ingin dapat menyimpan semuanya dalam struktur sehingga keduanya </font></font><code>value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mematuhi protokol </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nilai streaming harus universal untuk mengakomodasi semua jenis nilai.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat StreamModel Anda</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan membahas struktur untuk operator nanti. </font><font style="vertical-align: inherit;">Mari kita hubungkan array </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke </font></font><code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StreamModel</span>&lt;<span class="hljs-title">T</span>: <span class="hljs-title">Codable</span>&gt;: <span class="hljs-title">Codable</span>, <span class="hljs-title">Identifiable</span> </span>{
 <span class="hljs-keyword">var</span> id: <span class="hljs-type">UUID</span>
 <span class="hljs-keyword">var</span> name: <span class="hljs-type">String?</span>
 <span class="hljs-keyword">var</span> description: <span class="hljs-type">String?</span>
 <span class="hljs-keyword">var</span> stream: [<span class="hljs-type">StreamItem</span>&lt;<span class="hljs-type">T</span>&gt;]<font></font>
}</code></pre><br>
<code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berisi larik </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s. </font></font><code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga memiliki properti pengidentifikasi, nama, dan deskripsi. </font><font style="vertical-align: inherit;">Sekali lagi, semua yang ada di </font></font><code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalamnya harus dapat dikodekan untuk penyimpanan dan distribusi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat struktur operator</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang kami sebutkan sebelumnya, operator </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat mengubah waktu transmisi </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Operator</span> </span>{
 <span class="hljs-keyword">case</span> delay(seconds: <span class="hljs-type">Double</span>)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menganggap operator </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai enumerasi ( </font></font><code>enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dengan satu nilai terkait untuk menyimpan waktu tunda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, enumerasi </font></font><code>Operator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga harus cocok </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang mencakup pengkodean dan dekode nilai terkait. </font><font style="vertical-align: inherit;">Lihat implementasi penuh di bawah ini.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Operator</span> </span>{
    <span class="hljs-keyword">case</span> delay(seconds: <span class="hljs-type">Double</span>)<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">Operator</span>: <span class="hljs-title">Codable</span> </span>{<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">CodingKeys</span>: <span class="hljs-title">CodingKey</span> </span>{
        <span class="hljs-keyword">case</span> delay<font></font>
    }<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">DelayParameters</span>: <span class="hljs-title">Codable</span> </span>{
        <span class="hljs-keyword">let</span> seconds: <span class="hljs-type">Double</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">CodingError</span>: <span class="hljs-title">Error</span> </span>{ <span class="hljs-keyword">case</span> decoding(<span class="hljs-type">String</span>) }<font></font>
<font></font>
    <span class="hljs-keyword">init</span>(from decoder: <span class="hljs-type">Decoder</span>) <span class="hljs-keyword">throws</span> {
        <span class="hljs-keyword">let</span> container = <span class="hljs-keyword">try</span> decoder.container(keyedBy: <span class="hljs-type">CodingKeys</span>.<span class="hljs-keyword">self</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> delayParameters = <span class="hljs-keyword">try</span>? container.decodeIfPresent(<span class="hljs-type">DelayParameters</span>.<span class="hljs-keyword">self</span>, forKey: .delay) {
            <span class="hljs-keyword">self</span> = .delay(seconds: delayParameters.seconds)
            <span class="hljs-keyword">return</span><font></font>
        }<font></font>
        <span class="hljs-keyword">throw</span> <span class="hljs-type">CodingError</span>.decoding(<span class="hljs-string">"Decoding Failed. \(dump(container))"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">encode</span><span class="hljs-params">(to encoder: Encoder)</span></span> <span class="hljs-keyword">throws</span> {
        <span class="hljs-keyword">var</span> container = encoder.container(keyedBy: <span class="hljs-type">CodingKeys</span>.<span class="hljs-keyword">self</span>)
        <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
        <span class="hljs-keyword">case</span> .delay(<span class="hljs-keyword">let</span> seconds):
            <span class="hljs-keyword">try</span> container.encode(<span class="hljs-type">DelayParameters</span>(seconds: seconds), forKey: .delay)<font></font>
        }<font></font>
    }<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami sekarang memiliki struktur yang baik untuk mewakili aliran sekuensial ini, yang menghasilkan nilai dari 1 hingga 4 dengan interval penundaan kedua. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
l</font></font><pre><code class="swift hljs">et streamA = (<span class="hljs-number">1</span>...<span class="hljs-number">4</span>).<span class="hljs-built_in">map</span> { <span class="hljs-type">StreamItem</span>(value: $<span class="hljs-number">0</span>,<font></font>
operators: [.delay(seconds: <span class="hljs-number">1</span>)]) }
<span class="hljs-keyword">let</span> serialStreamA = <span class="hljs-type">StreamModel</span>(id: <span class="hljs-type">UUID</span>(), name: <span class="hljs-string">"Serial Stream A"</span>,<font></font>
description: <span class="hljs-literal">nil</span>, stream: streamA)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubah StreamModel menjadi Publisher</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita telah membuat turunan dari aliran; </font><font style="vertical-align: inherit;">namun, jika kami tidak mengubahnya menjadi penerbit, semuanya akan menjadi tidak berarti. </font><font style="vertical-align: inherit;">Mari mencoba. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, setiap model operator mengacu pada operator Combine yang sebenarnya, yang harus ditambahkan ke penerbit ini dan dikembalikan ke penerbit yang dioperasikan.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">Operator</span> </span>{
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">applyPublisher</span>&lt;T&gt;<span class="hljs-params">(<span class="hljs-number">_</span> publisher: AnyPublisher&lt;T, Never&gt;)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Never</span>&gt; {
  <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
    <span class="hljs-keyword">case</span> .delay(<span class="hljs-keyword">let</span> seconds):
    <span class="hljs-keyword">return</span> publisher.delay(<span class="hljs-keyword">for</span>: .seconds(seconds), scheduler: <span class="hljs-type">DispatchQueue</span>.main).eraseToAnyPublisher()<font></font>
  }<font></font>
 }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat ini hanya ada satu jenis operator - </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami akan menambahkan lebih banyak seiring berjalannya waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat mulai menggunakan penerbit untuk semua orang </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">StreamItem</span> </span>{
 <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">toPublisher</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Never</span>&gt; {
   <span class="hljs-keyword">var</span> publisher: <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Never</span>&gt; =
                  <span class="hljs-type">Just</span>(value).eraseToAnyPublisher()
   <span class="hljs-keyword">self</span>.operators.forEach {<font></font>
      publisher = $<span class="hljs-number">0</span>.applyPublisher(publisher)<font></font>
   }<font></font>
  <span class="hljs-keyword">return</span> publisher<font></font>
}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mulai dengan nilai </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Just</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menggeneralisasikannya menggunakan metode </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eraseToAnyPublisher</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan kemudian menggunakan penerbit dari semua operator terkait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tingkat </font></font><code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami mendapatkan penerbit dari seluruh aliran.</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">StreamModel</span> </span>{
 <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">toPublisher</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Never</span>&gt; {
   <span class="hljs-keyword">let</span> intervalPublishers =
        <span class="hljs-keyword">self</span>.stream.<span class="hljs-built_in">map</span> { $<span class="hljs-number">0</span>.toPublisher() }
   <span class="hljs-keyword">var</span> publisher: <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Never</span>&gt;?
   <span class="hljs-keyword">for</span> intervalPublisher <span class="hljs-keyword">in</span> intervalPublishers {
     <span class="hljs-keyword">if</span> publisher == <span class="hljs-literal">nil</span> {<font></font>
       publisher = intervalPublisher<font></font>
       <span class="hljs-keyword">continue</span><font></font>
     }<font></font>
     publisher =<font></font>
        publisher?.append(intervalPublisher).eraseToAnyPublisher()<font></font>
   }<font></font>
   <span class="hljs-keyword">return</span> publisher ?? <span class="hljs-type">Empty</span>().eraseToAnyPublisher()<font></font>
 }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda menebaknya dengan benar: kami menggunakan metode ini </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">append</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk menggabungkan penerbit.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisasi, pengeditan, dan sekali lagi visualisasi aliran</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita cukup mendekode penerbit, mentransfer dan membuat StreamView (lihat bagaimana kami melakukannya di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posting sebelumnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Dan yang tak kalah pentingnya: sekarang kita cukup mengedit </font></font><code>StreamModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menambahkan yang lain </font></font><code>StreamItem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nilai baru dan bahkan membagikan model ini dengan perangkat lain melalui Internet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lihat demo di bawah ini. </font><font style="vertical-align: inherit;">Sekarang kita dapat membuat perubahan ke aliran tanpa mengubah kode.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4w/sk/um/4wskumt1ae-bbp9nty5_ageekjy.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bab selanjutnya: Filter Serialisasi / Deserialisasi dan Operator Peta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian selanjutnya, kita akan menambahkan lebih banyak operator ke enumerasi operator dan mulai menerapkannya pada level utas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sampai nanti, Anda dapat menemukan kode sumber di sini di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori kombinasi-sihir-swifui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder taman bermain-gabungan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menunggu komentar Anda dan diundang ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">webinar terbuka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan topik "Aplikasi-iOS di SwiftUI menggunakan Kotlin Mobile Multiplatform".</font></font><br>
</b></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487124/index.html">Wawancara dengan Borey Yangel tentang drive mandiri Yandex dan kisah penciptaan Alice</a></li>
<li><a href="../id487126/index.html">Bagaimana tim pengembangan perusahaan menggunakan GitLab dan Mattermost ChatOps untuk mempercepat pengembangan</a></li>
<li><a href="../id487132/index.html">Bagaimana kami memindahkan ke SAAS tim yang terdiri dari beberapa ratus orang</a></li>
<li><a href="../id487136/index.html">Kode Bersih untuk TypeScript - Bagian 3</a></li>
<li><a href="../id487138/index.html">Teori grafik dalam pembelajaran mesin untuk yang terkecil</a></li>
<li><a href="../id487144/index.html">Uji kamera panorama Jabra Panacast dengan sudut pandang 180 ° (video)</a></li>
<li><a href="../id487146/index.html">ResizeObserver - alat tangguh baru untuk bekerja dengan kemampuan beradaptasi</a></li>
<li><a href="../id487154/index.html">Eksplorasi Journey permainan shader pasir</a></li>
<li><a href="../id487162/index.html">Apakah pengusaha dan perusahaan modern membutuhkan privasi?</a></li>
<li><a href="../id487168/index.html">Tales Interface Kakek Toxic "Sampah Instrumental" (s1 e2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>