<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö∂üèæ üàπ üòí How We Hacked a Smart Factory üëºüèª üîî üíÖüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", , . Attacks on smart manufacturing systems , . 
 
  
 The complexity of intelligent manufacturing systems is so great that it is difficult to give t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How We Hacked a Smart Factory</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/506196/"><img src="https://habrastorage.org/webt/zs/qs/rq/zsqsrqomvgsk6g8vu5pdtevg-ve.png" alt="image"><br>
<br>
<i>          ,        ,      .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Attacks on smart manufacturing systems</a>       ,        . </i><br>
<br>
<h3> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The complexity of intelligent manufacturing systems is so great that it is difficult to give them an exact formal definition. Today, the concept of a reference production infrastructure does not exist even as a concept. However, with increasing complexity, the number of threats also increases, and the perimeter expands, which can be affected by cybercriminals who pursue various goals. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Without trying to grasp the immensity, we decided to focus on one instance of the intellectual production system, which includes both hardware and software components in the form of control software, development and monitoring tools.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/r0/2l/kc/r02lkcgfvkdattidxwm4qawrcmm.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Industry 4.0 Lab is the subject of our study. </font><font style="vertical-align: inherit;">Source (hereinafter, unless otherwise indicated): Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The object of our study was the Industry 4.0 Lab, created by Fiesto on the basis of the Technical University of Milan (Politecnico di Milano). </font><font style="vertical-align: inherit;">It includes seven stations, programmable logic devices and human-machine interfaces of Siemens, as well as physical drives (drills, presses), temperature and pressure sensors, conveyor belts and the industrial robot Mitsubishi Melfa. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/a8/bh/nn/a8bhnnthkzvluhprtaqvcbv_zi4.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Block diagram Industry 4.0 Lab</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Research Areas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the ‚Äúsmart‚Äù production system, we distinguish the following areas that </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sensitive to security: </font><b><font style="vertical-align: inherit;">- Industrial software, which comes in the form of add-ons, extensions, or stand-alone applications.</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We have made sure that this software can become a powerful attack vector that has not been seriously considered until now. If the software delivery platforms - application stores, extension directories, etc. - are not properly protected, they turn into a hotbed of malware through which critical endpoints will be infected, for example, engineering workstations from which attacks can spread to production workshops and gain a foothold on the equipment, having introduced itself in the form of machine code through a vulnerability in the firmware of an industrial robot. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Custom IIoT devices</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This area is becoming increasingly popular in leading enterprises, as it allows engineers to run fully customizable automation logic at the production site. This distinguishes these devices from more traditional PLCs. However, this flexibility has another side, which requires changes in the security management model: instead of trusting one software developer, for devices you have to manage a rather complicated and confusing chain of trust, which includes developers of third-party libraries that were used by enterprise engineers, and also all libraries on which these components depend.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considering that recently compromise of software libraries and developer accounts in software repositories is used quite often by cybercriminals, we consider it necessary to single out this risk as a vector that will have an increasing impact on the threat landscape. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Human Machine Interfaces (HMI)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This is a central component of the ecosystem of intelligent production. HMIs provide cybercriminals with a wide attack surface, since in most cases they are ordinary computers with a significant number of interfaces, and their OS and software are rarely updated. This means that they remain software vulnerabilities that can be compared with the wide open doors for cybercriminals. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Production management systems</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the most sensitive endpoint for a smart enterprise because it acts as an intermediary between the production hall and the rest of the corporate network, for example, the ERP system. Production management systems contain complex automation logic and interact with one or more databases. Introducing incorrect changes to these databases can cause the release of marriage or even damage to the executive mechanisms, if the boundaries of safe modes are not specified in the system. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/47/v-/xl/47v-xlzirzeokazzhogrpphabmc.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data-Software Relationships in the Context of a Smart Manufacturing System </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Programmable Manufacturing Machines</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Industrial robots often have processing power that is redundant for simple physical movements representing their basic functionality. </font><font style="vertical-align: inherit;">The ability to perform general-purpose computing tasks with their help can be used by attackers to hide malicious logic from modern solutions for protecting endpoints, since they are not intended to verify the firmware code of industrial systems.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the human factor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We deliberately excluded from the consideration the influence of people on safety, since social engineering is beyond the scope of this study. </font><font style="vertical-align: inherit;">At the same time, we examined how technology can be abused in order to influence operator decisions using various tricks of the user interface, but we did not analyze how effective the impact of such methods would be. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the most underestimated in terms of danger vectors of attacks on industrial systems is the impact through malicious software and add-ons. </font><font style="vertical-align: inherit;">Consider these attacks in more detail. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/fy/fz/pofyfzajovfzayqhgis6akzifla.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Software vectors and targets of attacks on industrial systems</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attack through malicious industrial software add-ons</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using tool software and development environments specific to industrial automation, an attacker can gain access to targeted jobs for engineers, steal their secrets and inject Trojan code into each program they develop. The result is software for machines and robots, ‚Äúcharged‚Äù with the necessary attacking functionality. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not only Google, Apple and Microsoft have their own application registry. Industrial software developers also use their own application registries, from which engineers can download add-ons that extend the functionality of their development environments. Unfortunately, some of the popular industrial software directories contain vulnerabilities that allow you to load unverified extensions into it.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ps/xi/qz/psxiqzbkcpt73xufdkehgbei-wu.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vulnerability of the ABB extension catalog led to the fact that extensions for RobotStudio became available in the development environment immediately after loading, before the verification and approval stage When</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
examining application directories, we found the following serious problems that could potentially lead to serious consequences:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weak verification process, more similar to its absence;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lack of a ‚Äúsandbox‚Äù for executing add-ons downloaded from the catalog;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the availability of add-ons downloaded to the catalog before they are checked and approved; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lack of code integrity checking;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use unencrypted network connections.</font></font></li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Weak verification process.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The ABB add-ons directory does not have a verification process for developers. Anyone can register and download add-ons, and, as we have seen, strict verification of the downloaded files is also not performed. One of our partners downloaded the harmless add-on without any problems, the description of which contained the following text: </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prepared and downloaded to make sure that there is a manual check procedure in this application directory, (...) to check if anyone can upload to this software catalog that does not perform any useful actions.</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The add-on was easily approved, and for 10 days 18 users downloaded it for some reason.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v3/rd/s1/v3rds1ucuxmwxodvi8fpni2szf0.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After downloading and automatic installation, the RobotStudio add-on can do anything with the workstation </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- No sandbox</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We wrote and downloaded the harmless add-on to the ABB directory and made sure that it can do anything on the workstation, including bypassing the file system, setting up network connections and Executing http requests to send data to the management server. Such a wealth of opportunities gives attackers many opportunities, especially considering the following problem. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/t0/-v/8q/t0-v8qsgy5jxc8kk80bd6o4paxy.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A freshly loaded extension module is not displayed in the application catalog via a browser, however, it is already available for installation through the built-in RobotStudio interface. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Availability of add-ons prior to approval</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After uploading to the directory, the add-on should theoretically pass a test before being approved and made available for download. However, due to an error, unapproved extensions can be downloaded through RobotStudio's built-in development environment directory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We notified ABB of the problem, and the company fixed this vulnerability, however, theoretically, it allowed remote attackers to infect RobotStudio users computers by downloading a malicious setting bypassing the verification process. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Lack of code signature verification</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ABB application catalog is not the only source of potentially harmful add-ons. We found similar problems in Kuka.Sim, the engineering software for robots and CNC machines.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kuka.Sim is used to design and test developed programs before installing them directly in a robot or intelligent machine. For this, digital models of various machine tools and robots are used - digital twins. Each such twin consists of a three-dimensional model and source code that determines its physical behavior. By changing the code, you can change the behavior of the model. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It turned out that eCatalog - a repository of digital models of various intelligent industrial installations and robots for Kuka.Sim - does not check the integrity of published files, which are ordinary ZIP archives. Thus, the user has no way to verify the authenticity of the model, but an attacker can easily add malicious functionality to the archive. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Unencrypted network traffic</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The interaction between the Kuka.Sim client and the catalog of digital models occurs via http, that is, the traffic is transmitted in the clear, which allows for a man-in-the-middle attack, replacing or intercepting model files. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If a programmer creates his program on the basis of a malicious modification of a digital model, it may turn out that it works without problems in a virtual environment, but at the same time the real equipment crashes or leads to the release of the marriage.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion: countermeasures against future threats</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our study, we consider threats that will become a reality in the near future, since there are all technical prerequisites for this. </font><font style="vertical-align: inherit;">We believe that they can be prevented by performing the following measures:</font></font><br>
<br>
<ul>
<li>       ,          ‚Äî   ,           ;</li>
<li>           ¬´¬ª  : ,   ,   IoT,           ‚Äî          ;       ;</li>
<li>          ,       ¬´  ¬ª; </li>
<li>         ,     ‚Äî  , ,          ,   ‚Äî      ‚Äî         .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506176/index.html">Creaform 3D Scanner Overview</a></li>
<li><a href="../en506178/index.html">Trends Changing the Future of Software Testing: Expert Opinion</a></li>
<li><a href="../en506180/index.html">How to choose the right power for your UPS. We analyze the example of Eaton</a></li>
<li><a href="../en506188/index.html">400-line custom grammar parser</a></li>
<li><a href="../en506190/index.html">How to subtract a series of time intervals and try the Bentley-Ottmann algorithm</a></li>
<li><a href="../en506204/index.html">Abstract data type. Part 2: Data Management</a></li>
<li><a href="../en506206/index.html">ICQ New: bot breeding guide</a></li>
<li><a href="../en506208/index.html">Russian scientists have created the most heat-resistant material in the world</a></li>
<li><a href="../en506218/index.html">–ú–µ–≥–∞—Ñ–æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –º–æ–π HTTP —Ç—Ä–∞—Ñ–∏–∫ –≤ 2020 –≥–æ–¥—É, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–∫–ª–∞–º—É, –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–ø—Ä–µ—Ç–æ–≤ –Ω–∞ —ç—Ç–æ</a></li>
<li><a href="../en506222/index.html">Checklists: try not to miss the details</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>