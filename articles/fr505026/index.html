<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚Ü©Ô∏è ü§òüèª üïï Contr√¥lez un appareil externe dans la voiture √† l'aide des boutons sur le volant ‚úàÔ∏è üõåüèª üòì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. 
 
 Parfois, il devient n√©cessaire de contr√¥ler un appareil externe dans la voiture, par exemple un magn√©toscope ou un treuil. Dans ce...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Contr√¥lez un appareil externe dans la voiture √† l'aide des boutons sur le volant</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505026/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour √† tous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, il devient n√©cessaire de contr√¥ler un appareil externe dans la voiture, par exemple un magn√©toscope ou un treuil. Dans ce cas, g√©n√©ralement, des boutons suppl√©mentaires sont install√©s. Mais parfois, je veux faire une installation cach√©e, de sorte que l'int√©rieur de la voiture reste inchang√©. Nous le ferons aujourd'hui, en tant que voiture, il y aura une VW Polo Sedan avec une unit√© de surveillance Vega MTX install√©e, et en tant que charge, il y aura un bouton d'urgence. Assurons-nous que tout en maintenant le bouton "ok" sur le volant, le "voyant d'urgence" clignote 3 fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous la coupe, un grand nombre de photos et de vid√©os.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois, on m'a demand√© de faire un bouton de remerciement sur une Renault Kaptur 2012. En cliquant sur ce bouton, la voiture devrait clignoter 3 fois ¬´gang d'urgence¬ª. Cette voiture avait un joystick de colonne de direction analogique. J'ai connect√© l'un des boutons du joystick de la colonne de direction √† un relais temporis√© qui a donn√© une impulsion de 3 secondes au bouton du gang d'urgence. Plus tard, le propri√©taire a tr√®s bien parl√© de la nouvelle fonction de sa voiture et j'ai d√©cid√© d'essayer de la r√©p√©ter sur ma Polo Sedan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement √† Renault Kaptur, je n'ai pas de boutons analogiques, mais le signal de tous les boutons du volant se trouve dans le bus CAN. Comme bouton, le bouton ¬´ok¬ª sur le volant de la voiture a √©t√© s√©lectionn√©. Dans ma configuration, ce bouton n'est presque jamais utilis√©. Jusqu'√† pr√©sent, j'ai trouv√© qu'avec lui, vous pouvez r√©gler le fonctionnement du "limiteur" lorsque le signal sonore retentit lorsque vous d√©passez la vitesse d√©finie. Dans tous les autres cas, cliquer sur ce bouton ne fait rien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il √©tait possible de mettre en ≈ìuvre nos plans √† l'aide d'√©lectronique maison, mais j'avais d√©j√† une unit√© t√©l√©matique Vega MTX dans ma voiture, il a donc √©t√© d√©cid√© d'essayer de mettre en ≈ìuvre cette fonctionnalit√© en l'utilisant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Appuyez sur ce bouton dans le bus CAN, situ√© derri√®re la radio. J'ai d√©crit en d√©tail la recherche de tels capteurs dans</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">son article pr√©c√©dent sur le d√©cryptage du bus CAN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, les donn√©es ont √©t√© trouv√©es √† 5BF. Lorsque vous cliquez sur le bouton "ok" dans l'octet z√©ro, le chiffre 40 appara√Æt au format d√©cimal. Lorsque les boutons ne sont pas press√©s, l'octet z√©ro sera 0. Il sera n√©cessaire de faire un capteur dans lequel ces changements seront affich√©s. Dans mon cas, c'est un bouton sur le volant. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/2b/wi/j72bwiuv_uhzh2kbt9crf7pb6tc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant comment contr√¥ler le bouton du gang d'urgence. Malheureusement, Polo Sedan ne peut pas contr√¥ler le gang d'urgence via le bus CAN, vous devrez donc le g√©rer par analogie. Pour ce faire, vous devrez √©tirer le fil du fil blanc-bleu du connecteur du bouton de gang d'urgence. Si un signal de masse est appliqu√© √† ce fil avec une impulsion √† court terme, le groupe d'urgence s'allume. De m√™me, il s'√©teint.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Servir le "sol" utilisera la sortie num√©rique Vega MTX. Ici, nous avons 4 sorties num√©riques, nous utiliserons la troisi√®me sortie (fil bleu). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uz/-o/ae/uz-oaegurh5p-8r1fczln8hiyrw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez maintenant d√©finir les algorithmes selon lesquels le bouton fonctionnera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, je ne veux pas que le gang d'urgence s'allume imm√©diatement en appuyant sur le bouton ok, je veux qu'il s'allume apr√®s avoir appuy√© sur le bouton pendant une seconde. Je le fais pour me prot√©ger contre un appui accidentel et pour sauvegarder la fonctionnalit√© de ce bouton. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, vous devez d√©sactiver le gang d'urgence apr√®s 3 clignotements. 3 flashs "gang d'urgence" en 2 secondes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour entrer tous ces algorithmes, allez dans les param√®tres Vega MTX, puis allez dans l'onglet "Scripts". Ici, vous pouvez d√©finir les conditions dans lesquelles toutes les actions sont effectu√©es. Pour la mise en ≈ìuvre, j'ai d√ª utiliser 3 sc√©narios.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, les sc√©narios ne sont pas destin√©s √† de telles op√©rations, j'ai donc d√ª exp√©rimenter longtemps jusqu'√† ce que le r√©sultat souhait√© soit obtenu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dm/np/tb/dmnptb-c9bmonjlmutgpskje2fs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier sc√©nario sert √† cr√©er un retard par seconde apr√®s avoir cliqu√© sur le bouton ¬´ok¬ª. Cela fonctionne si dans le capteur CAN la valeur devient 40 et la sortie num√©rique externe 1 est 0.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0n/2-/gh/0n2-gh3y6v3d9w4p8v-wpaflbdw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, je vais expliquer les sorties num√©riques externes. Si la t√¢che n√©cessite plus de 4 sorties num√©riques, un module externe suppl√©mentaire peut √™tre connect√© au Vega MTX, qui aura 15 sorties num√©riques et bien d'autres entr√©es et sorties. Puisque nous n'avons pas cette unit√© externe, nous pouvons utiliser ces sorties comme variables, en mettant 0 ou 1 l√† (on ou off). Par d√©faut, toutes les sorties sont d√©sactiv√©es. La sortie num√©rique externe 1 sera une variable qui indique qu'une seconde s'est √©coul√©e depuis que vous avez appuy√© sur le bouton ok. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre script devrait se lire comme ceci: maintenant le bouton ok est press√©, et il est press√© pendant moins d'une seconde. Si ces conditions co√Øncident, l'action est ex√©cut√©e: la sortie num√©rique externe 1 est d√©sactiv√©e pendant 1 seconde. Cela signifie qu'il passe √† l'√©tat ¬´off¬ª, mais apr√®s une seconde, il passe √† l'√©tat ¬´on¬ª.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/la/qw/v_/laqwv_wowjb0zzhvkkm9eiijnro.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant au deuxi√®me sc√©nario. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/al/xc/gwalxcku5ectsxnsikszjeqkncu.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement au premier sc√©nario, il fonctionnera avec le capteur ¬´Boutons sur le volant¬ª √©gal √† 40 et avec une entr√©e num√©rique externe √©gale √† 1. Autrement dit, le bouton ¬´ok¬ª est enfonc√© et la sortie num√©rique externe 1 est 1. Et la sortie num√©rique externe deviendra 1 seulement apr√®s une seconde apr√®s avoir d√©clench√© le premier sc√©nario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant analyser ce qui se passe apr√®s le d√©clenchement du deuxi√®me sc√©nario. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-n/vw/mp/-nvwmpbzqfua5nwiizr2llgqgyo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, une impulsion de 1 seconde est donn√©e √† la sortie num√©rique 3, √† laquelle la sortie du bouton de groupe d'urgence est connect√©e, nous l'activons ainsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, nous devons r√©initialiser 0 sortie num√©rique externe 1. Par cons√©quent, nous activons la sortie num√©rique externe 1 pendant 1 seconde. Autrement dit, 1 seconde apr√®s le d√©clenchement du script, la sortie num√©rique externe 1 deviendra 0.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le dernier √©l√©ment, nous transf√©rons 2 secondes 15 √† la position 0. Apr√®s 2 secondes apr√®s le d√©clenchement du script, la sortie num√©rique externe 15 sera 1. La sortie num√©rique externe 15 est utilis√©e comme variable, que la lumi√®re de secours a √©t√© allum√©e √† l'aide du bouton sur le volant. 2 secondes est le temps pendant lequel la voiture clignote 3 fois ¬´gang d'urgence¬ª. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, le dernier sc√©nario, qui devrait envoyer une impulsion, pour d√©sactiver le gang d'urgence. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/g1/or/vyg1orbca6pqu-u3ufjcjr20ism.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sc√©nario fonctionne lorsque la sortie num√©rique externe 15 devient 1, c'est-√†-dire 2 secondes apr√®s le d√©clenchement du deuxi√®me sc√©nario. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0m/ke/8n/0mke8ngoswhi9jn9ject-paeftw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le d√©clenchement du troisi√®me script, nous envoyons une impulsion pour d√©sactiver le groupe d'urgence et remettons la sortie num√©rique externe 15 √† z√©ro (arr√™t).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci termine le travail avec les scripts, enregistre le r√©sultat dans Vega MTX et v√©rifie le fonctionnement de l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, vous pouvez contr√¥ler n'importe quel appareil √† l'aide du bus CAN de la voiture. </font><font style="vertical-align: inherit;">La gestion ne se limite pas aux boutons sur le volant. </font><font style="vertical-align: inherit;">Par exemple, vous pouvez configurer l'appareil pour qu'il s'allume en fonction de la vitesse du v√©hicule, en ouvrant une fen√™tre ou une porte, en d√©marrant le moteur, en fonction de la vitesse du moteur, de la temp√©rature du moteur, etc. </font><font style="vertical-align: inherit;">Vous pouvez verrouiller les portes √† une certaine vitesse (si le fabricant n'a pas fourni une telle opportunit√©), allumer l'appareil photo lorsque vous ouvrez la fen√™tre et de nombreuses autres options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce qui pr√©c√®de est au format vid√©o, et il existe √©galement un exemple d'activation des feux de secours lors de la marche arri√®re.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/70KNs2freow" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr504988/index.html">Entretien avec un analyste - Denis Sobolev, chef de produit, responsable de l'analyse B2B Skyeng</a></li>
<li><a href="../fr504996/index.html">BazarBackdoor: nouveau point d'entr√©e pour les syst√®mes d'entreprise</a></li>
<li><a href="../fr505016/index.html">Cours d'√©ducation gratuits: Administration</a></li>
<li><a href="../fr505018/index.html">Comment fonctionne le s√©l√©nium: √©pisodes 1 √† 2</a></li>
<li><a href="../fr505024/index.html">YouTrack maintenant avec une base de connaissances</a></li>
<li><a href="../fr505034/index.html">Test de vieillissement des LED</a></li>
<li><a href="../fr505036/index.html">Tutoriel Avalonia: Impl√©mentation MVVM √©tape par √©tape avec des exemples</a></li>
<li><a href="../fr505046/index.html">Qu'est-ce que le contenu de premi√®re classe et le pub rock ont ‚Äã‚Äãen commun? L'histoire de ¬´l'√©chec¬ª d'un projet qui a men√© au succ√®s</a></li>
<li><a href="../fr505052/index.html">Test rapide de Motionia.js et Consoleimg.js</a></li>
<li><a href="../fr505060/index.html">Ins√©rer un tableau numpy dans la base de donn√©es MySQL via Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>