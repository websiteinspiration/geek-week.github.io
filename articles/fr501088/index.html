<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖ üÜó üí∞ Pr√©cisez-le. Rapport Yandex üë©üèø‚ÄçüöÄ üë©üèΩ‚Äçüåæ üë©üèΩ‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une bonne sp√©cification API aide les clients √† l'utiliser. Il y a quelques mois chez Big Pytup, le d√©veloppeur Yandex Alexander Bryazginbryazginnna fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pr√©cisez-le. Rapport Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/501088/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une bonne sp√©cification API aide les clients √† l'utiliser. </font><font style="vertical-align: inherit;">Il y a quelques mois chez Big Pytup, le d√©veloppeur Yandex Alexander Bryazgin</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bryazginnn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a fait une pr√©sentation sur quoi la sp√©cification de l'API REST est bas√©e sur un exemple d'OpenAPI + Swagger et pourquoi un tel bundle est n√©cessaire. </font><font style="vertical-align: inherit;">√Ä partir du synopsis, vous pouvez d√©couvrir comment nous avons foir√© la g√©n√©ration automatique de la sp√©cification dans le service fini, quelles biblioth√®ques nous ont √©t√© utiles et quel type de r√©glage est autour de la sp√©cification OpenAPI.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/A9Ij-qJOLjM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Bonjour √† tous, mon nom est Alexander. </font><font style="vertical-align: inherit;">Je voudrais vous parler des sp√©cifications.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/3_/p0/1a/3_p01asrvx6y_ynsx1g3j5lxz8y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus pr√©cis√©ment, je voudrais aborder plusieurs sujets. </font><font style="vertical-align: inherit;">Tout d'abord, quelles sont les sp√©cifications en utilisant l'exemple des sp√©cifications de l'API REST. </font><font style="vertical-align: inherit;">De plus - comme nous avons acc√©l√©r√© la g√©n√©ration des sp√©cifications dans notre service. </font><font style="vertical-align: inherit;">Et √† la fin, du bon c√¥t√© - quels outils, r√©glage, pour utiliser les r√©sultats de notre g√©n√©ration de sp√©cifications, en utilisant un exemple d'une telle sp√©cification comme OpenAPI et Swagger UI.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sp√©cifications de l'API REST</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelles sont les sp√©cifications et qu'est-ce que j'entends par l√† dans mon rapport? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/qb/sf/huqbsf_ym4m_kdnwny0cl-o1h24.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, c'est l'Interface Description Language, un langage pour d√©crire les interfaces, une description qui correspond √† un format sp√©cifique. </font><font style="vertical-align: inherit;">Il peut √™tre analys√© automatiquement, car il a un format strict et des sp√©cificit√©s telles qu'il ne d√©pend pas de la langue elle-m√™me dans laquelle l'interface est impl√©ment√©e. </font><font style="vertical-align: inherit;">Autrement dit, disons que vous avez un serveur Web Python, pour le langage de description d'interface, cela n'a pas d'importance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe de nombreuses langues pour sp√©cifier les sp√©cifications. </font><font style="vertical-align: inherit;">Ce sont des sp√©cifications pour REST, RPC, GraphQL, etc. Aujourd'hui, nous allons nous attarder sur la sp√©cification REST.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openapi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons des sp√©cifications en utilisant l'exemple OpenAPI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bp/2z/k_/bp2zk_scdpvupmqvq9pdfhe00ym.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, comprenons ce qu'est OpenAPI. </font><font style="vertical-align: inherit;">Il s'agit du m√™me langage pour d√©crire les sp√©cifications. </font><font style="vertical-align: inherit;">En soi, il s'agit d'un fichier - au format YAML, JSON ou XML, qui l'aime le plus - avec une description de l'interface, des poign√©es des points de terminaison et des sch√©mas.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swagger</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quand on parle d'OpenAPI, on ne peut pas dire de Swagger. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dn/q7/gj/dnq7gjawouaidqmvvpc1bqt1-vq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swagger est essentiellement une interface utilisateur OpenAPI qui vous permet de visualiser magnifiquement vos sp√©cifications. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i5/mq/gm/i5mqgmitqhnsiwmarq7bsv4iyra.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans Swagger, comme dans OpenAPI, il y a une description des points de terminaison qui se trouvent dans votre sp√©cification. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qh/ru/3k/qhru3kukegnvaui-3n--ulcfmn8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une description de l'autorisation dans votre API. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/6w/pv/xf6wpvuh_kampioguvbuwasohha.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe une description des mod√®les ou des circuits avec lesquels vous manipulez dans votre API - par exemple, acceptez-les pour entr√©e ou renvoyez-les pour sortie. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/er/ho/7o/erho7oaraobdmskbvtwnkzcfo40.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a une description des exemples et des demandes et r√©ponses attendues de votre API. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g1/tk/qf/g1tkqfq19vi3bkcfbdvnp1gtqre.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, dans votre Swagger, du fait qu'il s'agit d'une interface utilisateur et qu'il s'ex√©cute dans votre navigateur, vous pouvez en temps r√©el ex√©cuter des requ√™tes vers votre API ici et maintenant. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/st/km/ps/stkmpsq0mevhyvxyxb0wncgp9li.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien depuis la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec tout cela, vous pouvez jouer sur un banc d'essai pr√©par√© par l'√©quipe Swagger. C'est petstore.swagger.io. Il y a un exemple de sp√©cification, soulev√© par Swagger. Vous pouvez acc√©der au vrai backend et toucher. Recommander. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/xa/at/umxaatwequxmejnq8vcu-teyctm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, nous disons: OpenAPI, Swagger, sp√©cification. Mais pourquoi tout cela est n√©cessaire pour une personne qui √©crit, disons, un backend? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, les sp√©cifications sont souvent utilis√©es lors de la phase de conception de notre API. Autrement dit, les gens normaux, √©tant arriv√©s √† la t√¢che d'√©crire un backend, commencent par d√©crire ce qu'ils veulent mettre en ≈ìuvre. Autrement dit, ils commencent √† concevoir leur API, une liste de points de terminaison qu'ils souhaitent impl√©menter, une liste de sch√©mas √† manipuler, des param√®tres, etc. Dans ce cas, les sp√©cifications et les outils autour des sp√©cifications sont tr√®s pratiques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, il existe un cas populaire. </font><font style="vertical-align: inherit;">Pour ce que nous avons fait glisser la sp√©cification vers nous en service? </font><font style="vertical-align: inherit;">Ceci est la documentation. </font><font style="vertical-align: inherit;">La disponibilit√© des sp√©cifications vous donne une si bonne occasion de d√©crire votre API et de partager ces informations avec quelqu'un: soit avec les fournisseurs frontaux de votre √©quipe, soit avec des clients externes qui souhaitent s'int√©grer avec vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, √©tant donn√© que la sp√©cification est √©crite dans un certain format strict, elle peut √™tre automatiquement trait√©e, c'est-√†-dire engag√©e dans l'introspection de l'API. </font><font style="vertical-align: inherit;">Et en plus, vous pouvez attraper de nombreux outils qui peuvent vous faciliter la vie. </font><font style="vertical-align: inherit;">Je vous le dirai plus pr√©cis√©ment et plus en d√©tail plus tard.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment nous pr√©parons OpenAPI</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©cid√© pourquoi nous avions besoin de tout cela. Parlons de la fa√ßon dont nous avons bousill√© la g√©n√©ration de sp√©cifications dans notre service. Tout d'abord, un peu de contexte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w4/hj/gi/w4hjgi6vmhrhx68hkvza41qehrw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque nous sommes arriv√©s √† l'id√©e de r√©duire la sp√©cification, nous avons fait fausse route lorsque nous avons √©crit le projet, dans le sens d'un prototype avec une sp√©cification. Nous avons d√©j√† soulev√© un backend, il volait d√©j√† avec nous, et nous voulions partager la sp√©cification comme moyen de documentation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et notre backend √©tait soudainement en Python. Nous avons utilis√© Falcon comme cadre, marshmallow comme outil de s√©rialisation et de d√©s√©rialisation des donn√©es et webargs comme outil de validation. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w4/hj/gi/w4hjgi6vmhrhx68hkvza41qehrw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant l'extrait le plus simple de l'animalerie que j'ai mentionn√© plus t√¥t, nous imaginerons √† quoi pourrait ressembler notre service √† l'√©tape o√π nous voulions g√©n√©rer une sp√©cification.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre service, il y aurait une paire simplifi√©e de sch√©mas: le type de notre animal de compagnie, c'est-√†-dire la cat√©gorie et, en fait, les animaux eux-m√™mes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eu/ks/li/euksliz1yyqgyc8r6fdemxvyg9m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, nous d√©cririons plusieurs sch√©mas sur Marshmallow. De plus, nous pr√©parerions quelques stylos afin, par exemple, de vous inscrire et de recevoir nos favoris. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/hf/ag/gehfag2dcnp0te3s38lcq9_a0eg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et, en fait, ils d√©criraient l'application elle-m√™me, ce qui augmenterait le point final pour la cr√©ation et la r√©ception d'animaux domestiques. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xy/46/4t/xy464tkcd9zijove5dxpdwgahqe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voil√† √† quoi cela ressemblerait. Service assez simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©fl√©chissons aux options dont nous disposons pour cr√©er une configuration OpenAPI. L'option la plus simple et la plus na√Øve, comme je l'ai dit plus t√¥t, n'est qu'un fichier. Pourquoi ne faisons-nous pas ce fichier avec nos mains? Nous savons quelles donn√©es d'entr√©e nous avons, nous avons des points de terminaison. Cela semble √©vident, il suffit de prendre et d'√©crire.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rp/2m/vm/rp2mvmq8ugglyeu45yia-3a2fuc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais tout d'abord, nous sommes des programmeurs. Nous n'aimons rien faire de nos mains. Nous voulons que quelque chose de standard soit g√©n√©r√© pour nous. Deuxi√®mement, si nous prenions tout en charge √† la main, nous devrons certainement prendre en charge les modifications d'API, ainsi qu'un fichier qui se trouve ailleurs. Comme tout service, notre produit est volatile, tout comme les sp√©cifications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, nous sommes arriv√©s √† la conclusion que nous voulons g√©n√©rer une configuration OpenAPI. Compte tenu de notre pile technologique, nous avons trouv√© une biblioth√®que comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apispec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Apispec est une biblioth√®que de fabricants, c'est-√†-dire les auteurs de Marshmallow et Webargs. Ensemble, ils constituent un vaste √©cosyst√®me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons comment vous pouvez utiliser apispec sur notre pile pour lui apprendre √† g√©n√©rer une sp√©cification pour nous.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tq/l2/xr/tql2xr9l9bxlpssq3y6nnupgld4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avions une ressource et un gestionnaire sp√©cifique pour la m√©thode get de cette ressource. Il a une sorte de corps. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6d/ls/6c/6dls6cd5xma9pvhckxnxudotg9w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour enseigner l'apispec, pour lui faire savoir ce que nous faisons dans notre stylo, nous ajoutons quelque chose au docstring. Nous y ajoutons une description compr√©hensible pour l'homme. Dans notre cas, ceci est un exemple de r√©ponses: parfois cela arrive, notre stylo r√©pond avec deux cents, et dans le corps de notre r√©ponse il y a JSON avec un sch√©ma, Pet data model. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cg/iu/gi/cgiugib1tipdvdpny7dk1jj25do.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/9g/bi/7h/9gbi7hsxekrvswxcpwhgvmackoi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant l'exemple d'une post-requ√™te, nous d√©crivons: en plus du fait qu'il y a une r√©ponse 201 dans laquelle nous renvoyons Pet, il y a aussi le corps attendu de la requ√™te qui nous vient. Et √† l'int√©rieur de cette demande, nous attendons JSON, et nous attendons √† ce que ce JSON soit au format Pet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dr/is/3t/dris3tronnmqrjhgneplaqzouni.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons ajout√© des docstrings, puis nous devons apprendre √† g√©n√©rer une sp√©cification. Pour ce faire, nous √©crivons une sorte de script, un bouton rouge et apprenons √† apispec √† g√©n√©rer une sp√©cification pour nous. Nous d√©clarons un objet apispec, √† partir duquel nous d√©crivons quelques m√©tadonn√©es de notre service, puis √©crivons simplement le fichier, la sp√©cification g√©n√©r√©e au format YAML. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons ce qui a √©t√© g√©n√©r√© pour cette √©norme application dans ce fichier. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ka/m2/yw/kam2ywt0vofxyenimp2aqpn8dmu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, dans ce fichier, il y aura une description de la version dans laquelle la sp√©cification a √©t√© g√©n√©r√©e. Ceci est important pour que tous ceux qui interpr√®tent cette sp√©cification comprennent le format √† interpr√©ter. Les sp√©cifications varient d'une version √† l'autre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, il y a une description de notre service. Ce titre, cette version, peut-√™tre y aura-t-il une description, si vous le souhaitez, puis une liste de serveurs vers lesquels vous pourrez vous rendre, tirer les stylos, voir et toucher notre backend. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/cn/bi/uicnbixldrhetobxeixo4-rfqlu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, les sch√©mas de donn√©es que nous manipulons y poussent, avec une description des types, des exemples de remplissage de ces donn√©es et quelques r√®gles. Ce sont peut-√™tre des valeurs extr√™mes, peut-√™tre les param√®tres de liaison. Vous voyez ici une liste des attributs requis. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2j/ig/td/2jigtdwc9ln_m4d5c40ytq3b1sq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des sch√©mas, la description des points de terminaison eux-m√™mes s'y d√©veloppe. Dans ce cas, la description de chaque m√©thode germe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bu/9p/ce/bu9pce82nchhnzbyssgqhduzseg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant la m√©thode get, nous obtenons une description de ce que nous faisons avec la m√©thode get.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/lj/eh/kiljehsuttdb1uqsusabn0kkwwe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et exactement la description que nous avons mise dans les docstrings du point de terminaison correspondant a germ√© sur le post. </font><font style="vertical-align: inherit;">Autrement dit, nous avons d√©j√† re√ßu une sorte de fichier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'allons-nous en faire maintenant? </font><font style="vertical-align: inherit;">Quelle est l'utilit√©? </font><font style="vertical-align: inherit;">Tout d'abord, vous, en tant que propri√©taires du backend, pouvez d√©j√† donner √† tous ces clients potentiels qui iront dans vos stylos, donner cette sp√©cification. </font><font style="vertical-align: inherit;">Et cela aidera les gars √† s'int√©grer. </font><font style="vertical-align: inherit;">C'est-√†-dire que le fichier que nous avons g√©n√©r√© ne vous fait pas vous arracher les yeux. </font><font style="vertical-align: inherit;">C'est assez lisible. </font><font style="vertical-align: inherit;">Il peut √™tre vu √† travers les yeux et analys√© d'une mani√®re ou d'une autre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais c'est aussi difficile. </font><font style="vertical-align: inherit;">Voyons quels autres outils sont l√† pour vous simplifier la vie et quel type de r√©glage est autour de la sp√©cification g√©n√©r√©e.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brioches</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis nous arrivons √† l'√©tape suivante, o√π nous parlerons de ce qui est une bo√Æte √† outils utile autour des sp√©cifications en utilisant l'exemple OpenAPI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ru/kk/mw/rukkmw8jlzqgxmnubf3ndxn-ckw.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien de la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le premier outil dont je voudrais parler est Swagger-UI. Ci-apr√®s, je fournirai des liens vers une ressource Web o√π vous pouvez piquer l'outil correspondant, dans ce cas SwaggerHub, ou vers la commande pour lancer le document correspondant √† l'aide de Docker. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous aimons tous Docker. Docker vous aide √† ne pas mettre JavaScript ou Java sur le local. Prenez-le, ex√©cutez-le avec une seule commande, et tout fonctionne pour vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, Swagger-UI est, en fait, un utilitaire qui vous permet d'afficher magnifiquement vos sp√©cifications. Comme je l'ai dit plus t√¥t, ceux-ci s'ex√©cutent localement √† l'aide de Docker, peut-√™tre Swagger.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez afficher ou partager sur les param√®tres r√©gionaux en ex√©cutant la sp√©cification dans Swagger sur votre mat√©riel. Et envoyez en outre tous vos utilisateurs potentiels √† cette sp√©cification. Elle est d√©j√† beaucoup plus compr√©hensible, belle. Directement dedans, vous pouvez ex√©cuter l'ex√©cution des requ√™tes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oo/t2/ko/oot2kocvjaeri2wdtdybfzsbnno.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien depuis la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En plus de Swagger-UI, il existe un outil Swagger-editor pratique. Vous pouvez l'utiliser sur le Web, vous pouvez le r√©cup√©rer sur une locale ou sur n'importe quelle machine √† √©crire. Il vous permet de modifier les sp√©cifications en temps r√©el et de voir son affichage ici. C'est-√†-dire que c'est un outil tr√®s pratique au stade de, disons, la conception d'une API, lorsque vous n'avez pas g√©n√©r√© de sp√©cification et que vous souhaitez en quelque sorte faire une farce ou d√©crire votre backend sans avoir de backend r√©el ou g√©n√©r√©.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/js/zo/j7jszonnqgfdxiyucziggnbr2kk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, le merveilleux outil Prism. Je voudrais m'y attarder plus en d√©tail. Prism est un utilitaire de Spotlight. Il vous permet, avec la sp√©cification, d'√©lever le faux serveur, qui fonctionnera selon la sp√©cification que vous lui avez donn√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, dans ce cas, nous voyons le lancement de Prism en plus de la sp√©cification, que j'ai vol√© juste sous le magasin Swagger. Nous voyons que Prism a trouv√© tous les points finaux qui sont sp√©cifi√©s dans la sp√©cification, et a dit qu'ils les d√©rangent honn√™tement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de ressentir ce que Prism peut faire.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wk/q4/il/wkq4ilyu29eoustye1c6zpbfleo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous trouvons le stylo, essayons de le tirer et soudain nous voyons que Prism nous dit: d√©sol√©, erreur 401. Nous allons dans la sp√©cification et voyons qu'en fait ce stylo est cach√© derri√®re l'autorisation. La section de s√©curit√© y est clairement d√©crite. Dans ce document, nous voyons que la m√©thode d'autorisation est OAuth, et nous comprenons: en fait, Prism attendait une sorte de donn√©es d'autorisation de notre part. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/a9/8l/hra98lo9j-n1wboqvztd2rtzh2a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de lui transf√©rer les donn√©es d'autorisation selon le format qu'il attend. Il est clair que le jeton est en quelque sorte a√©rien, pour Prism, peu importe ce qu'il est par essence. Le format est important pour lui. Autrement dit, s'il attend OAuth, il attend les donn√©es d'autorisation dans un format sp√©cifique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous branlons avec autorisation et voyons d√©j√† la 400e erreur. Nous regardons ce que nous avons dans la sp√©cification. Dans la sp√©cification, nous voyons que nous n'avons pas pass√© certains attributs requis. Passons-les. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3u/24/k2/3u24k2uo0vk6pp9hru3vteaclso.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attribut magique est le statut. Il est, en fait, donn√© selon la sp√©cification ENUM. Si nous avions transf√©r√© un statut qui n'est pas inclus dans cet ENUM, nous aurions obtenu quatre points. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous avons pass√© le statut valide et nous voyons que le backend a r√©pondu avec un xml compl√®tement valide avec les donn√©es. Les donn√©es de ce fichier XML sont d√©sormais uniquement renvoy√©es √† partir de l'exemple sp√©cifi√© dans la sp√©cification. Autrement dit, dans la sp√©cification pour chaque champ, il existe une section comme exemple, o√π vous pouvez sp√©cifier un exemple de donn√©es qui peuvent √™tre retourn√©es. Ici, Prism vient de les ramener.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/od/sd/6w/odsd6whlpmsf1vuwm_rdtgjadhk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais en plus du fait que vous pouvez tirer le stylo et vous attendre √† ce qu'il y en ait deux cents honn√™tes, il est possible de dire Prism - renvoyez-moi un code de r√©ponse sp√©cifique. Habituellement, dans la sp√©cification, nous d√©crivons les diff√©rents comportements de notre stylo, et avec des donn√©es valides, ils ne correspondent pas toujours √† deux cents. Ils peuvent rechercher, par exemple, la pr√©sence d'ID dans la base de donn√©es, pour voir qu'un tel ID n'existe pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce cas, nous d√©clarons un certain code, disons le 400e ou le 422e, √† qui vous voulez. Autrement dit, avec une entr√©e valide, il n'y a pas toujours une sortie valide. Par cons√©quent, dans la sp√©cification, nous d√©crivons diff√©rentes options de r√©ponse. Et nous pouvons clairement dire en secouant le stylo Prism: cette fois j'attends que vous me r√©pondiez, disons, la 404√®me erreur. Disons que c'est un cas o√π je tire la poign√©e avec un ID, mais il n'y a pas un tel ID.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ys/wg/lt/yswgltoo-e7vyjv5mesvlkvolji.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©sumer, quelles sont les fonctionnalit√©s en g√©n√©ral, en plus de celles que j'ai d√©j√† mentionn√©es? Encore une fois, il s'agit d'un faux serveur que vous pouvez r√©cup√©rer. Il r√©pondra selon le cahier des charges, validera les demandes d'autorisation. Il validera √©galement les donn√©es que vous lui avez envoy√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de valider la demande, il g√©n√©rera des r√©ponses. Dans le cas le plus simple, comme je l'ai dit, cela g√©n√®re des r√©ponses par l'exemple. Il existe une deuxi√®me option - lorsque vous la demandez explicitement: veuillez g√©n√©rer des r√©ponses dynamiques. Une strat√©gie dynamique signifie que, selon le type, par exemple, int, elle g√©n√©rera des milliers, des milliards ou autre chose. Ou pour la cha√Æne, un hachage √©trange et incompr√©hensible.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aussi, lorsque j'ai dit lors de la premi√®re ex√©cution que vous pouvez g√©n√©rer des donn√©es, nous nous sommes demand√©: ce serait cool si Prism s'int√©grait avec faker. Ceux qui ont utilis√© le simulateur Python savent probablement √† quel point c'est cool quand vous voulez verrouiller certaines donn√©es ou √©muler des donn√©es dans la base de donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, Prism est √©crit en JavaScript. JavaScript a √©galement Faker.js, et Prism a une int√©gration automatique avec faker. Vous pouvez sp√©cifier explicitement dans votre sp√©cification les types de donn√©es faker que votre stylo fournira. Autrement dit, OpenAPI prend en charge un syst√®me de plug-in qui vous permet d'√©tendre vos sp√©cifications afin qu'OpenAPI et l'analyseur lui-m√™me ne s'en soucient pas. Mais s'il existe des plugins qui analysent vos sp√©cifications, ils peuvent utiliser des champs suppl√©mentaires.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, Prism vous propose d'utiliser le champ optionnel du plugin X-faker. Tr√®s confortablement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, sous l'ast√©risque, j'ai indiqu√© que les rappels peuvent √™tre d√©crits dans OpenAPI. Il s'agit du sch√©ma d'interaction lorsque vous enregistrez un rappel sur un certain stylet et attendez qu'apr√®s cela, vous recevrez un rappel sp√©cifique sur l'URL que vous avez enregistr√©e. Donc, Prism et il savent se mouiller. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'int√©ressant: le prisme peut √™tre √©lev√© non seulement en mode maquette, mais aussi en mode proxy. Vous venez de mettre ce proxy devant votre vrai backend, et toutes les demandes qui passent par Prism et reviennent, Prism validera selon les sp√©cifications.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si certaines donn√©es - disons, entr√©e ou sortie, demande ou r√©ponse - divergent, il l'√©crira dans le journal. Il le fait de mani√®re assez transparente, cela n'affecte pas le comportement r√©el. En g√©n√©ral, la documentation indique qu'elle peut √™tre facilement augment√©e en production. Honn√™tement, je ne l'ai pas essay√© moi-m√™me. Il y a s√ªrement une sorte de frais g√©n√©raux, mais je ne peux toujours pas en parler. Vous pouvez sentir, essayer et dire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, gr√¢ce √† ce que j'ai d√©j√† dit, il est possible de forcer certaines demandes. Autrement dit, venez sur le faux serveur et dites: Je veux un exemple ou un type de r√©ponse sp√©cifique. Nous avons d√©j√† parl√© du type de r√©ponse. Toujours dans la sp√©cification OpenAPI, il est possible de sp√©cifier plusieurs options de r√©ponse et de les nommer explicitement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, vous pouvez venir dire Prism: cette fois je veux un exemple pr√©cis, la prochaine fois je veux un autre exemple. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lu/ks/3i/luks3i81suk0tx_npozzbwrgpmi.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien de la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√Ä propos de Prism parl√©. Maintenant √† propos de Postman. Je l'aime tellement. Ainsi, Postman a une int√©gration pr√™te √† l'emploi avec OpenAPI. Vous pouvez litt√©ralement importer la sp√©cification OpenAPI en seulement deux clics sur les boutons. Et il cr√©era une collection de demandes selon vos sp√©cifications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En m√™me temps, il pr√©-pr√©parera tous les param√®tres de requ√™te, tous les param√®tres de corps, tout l'environnement et l'autorisation. Il vous suffit de terminer les donn√©es avec de vrais identifiants ou autre chose, des jetons d'autorisation. Tr√®s confortablement.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/_n/it/hv_nit8modo3fisqvijmuemcwzq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons de Postman plus loin. Nous avons parl√© de Prism, il a des fonctionnalit√©s - validation des requ√™tes. En fait, il existe un utilitaire distinct qui vous permet de sucer sans piti√© votre backend vraiment en cours d'ex√©cution et de voir s'il fonctionne vraiment selon les sp√©cifications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dredd analyse la sp√©cification. Il prend, tire tous les stylos et regarde ce qui lui est retourn√©. En g√©n√©ral, dredd peut √™tre trait√© comme une infrastructure pour √©crire des tests, car toutes ses requ√™tes peuvent √™tre compl√©t√©es par ses hooks. Autrement dit, √† partir de la bo√Æte, vous pouvez commencer √† dredd tel quel, comme je l'ai lanc√© ici.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou vous pouvez ex√©cuter dredd en lui passant un ensemble de crochets qui fonctionnent r√©ellement dans l'id√©ologie d'un test r√©gulier. Il y a quelque chose qui monte √† l'ensemble des tests, il y a des hooks qui tournent avant le test, apr√®s le test, toute l'infrastructure. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p1/0s/7w/p10s7w3s_sj3l5yvjoyzhssvnjq.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien de la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ensuite, je veux parler plus en d√©tail d'un tel outil de Swagger lui-m√™me comme Swagger-codegen. En fait, c'est un peu comme un couteau suisse. Pour commencer, quel genre de pens√©es les gars ont-ils eu quand ils ont √©crit cet instrument. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habituellement, lorsque quelqu'un doit s'int√©grer √† un backend, vous d√©crivez rarement une demande http ici, √† un certain stade, dans la logique m√©tier. Le plus souvent, vous encapsulez le travail avec un backend sp√©cifique dans une entit√©, dans le client.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, les gars ont eu l'id√©e que, ayant une sp√©cification, nous pouvons tr√®s clairement d√©crire et pr√©dire √† quoi ressemblerait le client pour ce backend. Et les gars ont fait un g√©n√©rateur de clients. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/mp/bs/xxmpbsw0ksdzbh2yb6vrvbrxylw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de d√©marrer la g√©n√©ration du client conform√©ment aux sp√©cifications de l'animalerie. Nous verrons que ce g√©n√©rateur a √©t√© g√©n√©r√© par le client Swagger lui-m√™me, dans lequel se trouve le client Python lui-m√™me. Ici, dans la ligne de lancement, vous pouvez clairement voir que je g√©n√®re un client en Python. En fait, il prend en charge un grand nombre de langues. Qu'est-ce qui est important ici? Les pionniers appr√©cieront JavaScript, les hipsters appr√©cieront Go. Tout ce que vous voulez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, en plus du client en Python, il a g√©n√©r√© quelques documents et test√© des dossiers magiques. Nous en parlerons plus tard plus en d√©tail. Et beaucoup de sucre pour que vous puissiez envelopper ce client dans une biblioth√®que pr√™te √† l'emploi. Il y a gitignore, il y a des fichiers CI, disons pour Travis, il y a du sucre pour git. Il existe des exigences, setup.py et tox.ini. Autrement dit, tout ce qui vous aide simplement √† prendre, valider et envoyer ce client est d√©j√† sous la forme d'une biblioth√®que qui peut √™tre r√©utilis√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons de plus pr√®s ce qu'il a g√©n√©r√© chez le client.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xy/rl/sv/xyrlsvzq6lsyg1ujajxjfpqcdgu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le client, il a g√©n√©r√©, en plus de certains fichiers auxiliaires, deux r√©pertoires tr√®s importants api et mod√®les. Dans les mod√®les, nous avons ces mod√®les de donn√©es que nous manipulons. Chaque mod√®le est simplement une classe Python h√©rit√©e de l'objet avec __init__, qui prend toutes sortes de param√®tres pour ce sch√©ma, et des getters et setters qui changent l'√©tat de l'objet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lk/zo/ib/lkzoibgytyj3yh883ypi3tlrlqs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus du mod√®le, des entit√©s telles que PetApi y sont √©galement apparues - ce ne sont que des wrappers clients sur le groupe de points de terminaison, que OpenAPI regroupe soit par balises soit par points de terminaison. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ce client a tous les stylos que vous pouvez contracter, transmettant des donn√©es r√©elles. Ensuite, ils s'envoleront vers un backend.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8x/9s/ju/8x9sju8tcpqdmm6ymz40sbaiarc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce qui est impl√©ment√© √† partir de ce client g√©n√©r√©? De l'int√©ressant - l'approche contractuelle. Parlons plus de lui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'approche contractuelle de la programmation sugg√®re que lorsque vous impl√©mentez l'interaction entre le client et le serveur, vous d√©finissez en fait toujours certaines r√®gles, des contrats, qu'il s'agisse de donn√©es que le client donne au serveur ou de donn√©es que le serveur donne au client.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'approche contractuelle vous recommande de v√©rifier √† chaque fois en temps r√©el la conformit√© de vos donn√©es et de votre interaction avec le contrat. Si ce contrat est un sch√©ma des donn√©es que nous transmettons, et ne r√©pond pas √† nos attentes, n'est pas satisfait, alors vous devez le dire, montrer l'erreur ici et maintenant. N'allez pas au vrai backend, n'attendez pas de quatre points, mais dites tout de suite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou un autre cas: nous sommes all√©s au backend, avons re√ßu des donn√©es, mais elles ne correspondent pas √† ce que nous attendions. Supposons que certains champs que nous nous attendions √† voir remplis deviennent vides. Nous en parlerons ici et maintenant, et non pas lorsque nous laisserons quelque part sur la pile d'appels quelque part dans la for√™t et ne d√©couvrirons pas pourquoi quelque chose est tomb√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, Swagger-codegen g√©n√®re des clients et des mod√®les selon l'approche contractuelle. Il vous permet de dire en temps r√©el: oui, je veux que le client en ex√©cution v√©rifie toutes les donn√©es pour la conformit√© avec les contrats. Et si le contrat n'est pas satisfait, il le dira imm√©diatement. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wd/cv/cf/wdcvcfmelgbc911cza5jnwuxc4c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons g√©n√©r√© une sorte de pit-client avec une approche contractuelle, mais en plus de cela, Swagger-codegen a g√©n√©r√© des talons de documentation pour nous. En fait, ils sont assez simples, mais ils peuvent tous √™tre tordus pour chaque mod√®le. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4n/xb/hx/4nxbhxsvwigzwulp0o-cgvggx0c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swagger-codegen a √©galement g√©n√©r√© une sorte de talons de test. Tout pour que vous puissiez d√©ployer le code g√©n√©r√© avec un minimum d'effort et l'ex√©cuter avec des tests, avec une int√©gration continue, sous la forme d'une biblioth√®que avec un git, avec toutes les cloches et les sifflets.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/ab/zy/jzabzyk84w7w8mhuxfyvfl5wc7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revoyons-le bri√®vement. Nous avons examin√© un seul cas - un moyen de g√©n√©rer des clients pour l'API. De l'importante} approche contractuelle. Je voudrais dire: lorsque j'ai g√©n√©r√© un client pour une v√©ritable animalerie selon leurs sp√©cifications et que je suis vraiment all√© dans son backend, cette approche contractuelle a soudainement saisi les donn√©es invalides qui ont √©t√© retourn√©es par l'animalerie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, j'ai pens√© - ils sont un peu √©tranges. Ils ont eux-m√™mes g√©n√©r√© la sp√©cification et le backend ne fonctionne pas correctement pour eux. Mais il me semble qu'ils l'ont fait expr√®s pour que nous puissions voir la puissance de l'approche contractuelle. Il n'y avait pas beaucoup de donn√©es et elles √©taient clairement g√©n√©r√©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aussi dans la g√©n√©ration de clients et dans une autre g√©n√©ration, vous pouvez utiliser vos propres mod√®les. Autrement dit, si vous souhaitez g√©n√©rer un client dans un certain format, vous pouvez enregistrer et pr√©parer votre mod√®le et g√©n√©rer des clients comme vous le souhaitez. Si vous faites le tour et g√©n√©rez des int√©grations tous les jours, cela pourrait vous plaire beaucoup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez √©galement configurer ces clients et √©crire l'importation de vos mod√®les, plut√¥t que ceux g√©n√©r√©s par Swagger-codegen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de g√©n√©rer des clients pour l'API, vous pouvez transmettre la sp√©cification au g√©n√©rateur et g√©n√©rer les stubs du serveur lui-m√™me. C'est tr√®s √©trange. Autrement dit, vous g√©n√©rez une sorte de backend qui fonctionne soi-disant conform√©ment aux sp√©cifications. Il est clair qu'il n'y a aucune logique commerciale l√†-bas. Mais peut-√™tre que ce sera pratique comme une sorte d'√©chafaudage, c'est-√†-dire pr√©parer un projet avec lequel vous pouvez d√©j√† faire quelque chose. Je ne l'ai pas utilis√©, mais je recommande d'y jeter un coup d'≈ìil - peut-√™tre trouverez-vous quelque chose d'utile pour vous-m√™me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre autres, il vous permet de g√©n√©rer de la documentation au format HTML et Confluence si quelqu'un l'utilise. Les exemples que je voulais montrer pour OpenAPI se sont √©galement arr√™t√©s l√†. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bw/mm/7o/bwmm7osu5o5m_nozsic84gevl68.jpeg"><br>
<b><sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous ces outils sont disponibles sur les deux liens ci-dessous sur la diapositive: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openapi.tools</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/APIs-guru/awesome-openapi3</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Je veux montrer les groupes de r√©glages autour de la sp√©cification OpenAPI. En fait, il existe de nombreux outils. Ce ne sont que des groupes, c'est-√†-dire des types d'outils que vous pouvez utiliser.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'important ici est un convertisseur d'une sp√©cification √† une autre. Autrement dit, vous pouvez g√©n√©rer l'API Blueprint ou tout ce que vous voulez √† partir de la sp√©cification OpenAPI, et vice versa. Il existe une biblioth√®que pour la simulation, pour la documentation. Autrement dit, tout ce dont j'ai parl√© se refl√©tera dans ces groupes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe √©galement un lien que vous pouvez suivre. Assurez-vous d'aller chercher.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ga/7c/l9/ga7cl9jxvn0wzptbyrde_l-fjuc.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lien depuis la diapositive</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outre les outils autour d'OpenAPI, il existe des outils autour de Swagger. </font><font style="vertical-align: inherit;">Il y a SwaggerHub et Swagger Inspector. </font><font style="vertical-align: inherit;">Ils sont surlign√©s en bleu car il s'agit d'une bo√Æte √† outils Web. </font><font style="vertical-align: inherit;">Vous pouvez vous y rendre directement et utiliser en tant que service le SwaggerHub et Swagger Inspector, qui sont en fait une superposition des biblioth√®ques suivantes: Swagger-editor, Swagger-codegen, Swagger-UI. </font><font style="vertical-align: inherit;">Tout ce que nous venons de discuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les biblioth√®ques sont jaunes, elles sont open source, comme nous l'avons vu. </font><font style="vertical-align: inherit;">Il existe sur GitHub, se pr√©sente sous la forme de Docker. </font><font style="vertical-align: inherit;">Utilisation.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br>
<img src="https://habrastorage.org/webt/7s/sf/jq/7ssfjqj01gdiek3-9wspmzovjsy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De quoi avons-nous discut√© aujourd'hui? Sp√©cification de l'API REST utilisant OpenAPI et Swagger comme exemples. Je tiens √† souligner que OpenAPI n'est qu'une fa√ßon de d√©crire la sp√©cification. Beaucoup d'entre eux. Parmi les plus int√©ressants, voir √©galement l'API Blueprint. Peut-√™tre que quelqu'un d'autre aimera quelque chose. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1a/0f/gp/1a0fgp8uuikaes5v4un8tam6z9s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©galement regard√© Swagger. En substance, comme nous l'avons d√©j√† dit, ce n'est qu'une belle interface utilisateur autour de la sp√©cification, qui vous permet de la regarder et de l'explorer de mani√®re pratique. En fait, ces outils sont √©galement nombreux, allant des populaires ReDoc et Sphinx, et se terminant, en fait, Markdown. Autrement dit, vous pouvez g√©n√©rer Markdown √† partir d'OpenAPI, et il sera magnifiquement affich√© dans tous les GitHub, GitLab - o√π vous le souhaitez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©galement examin√© un exemple de notre pile technologique sur la fa√ßon dont nous g√©n√©rons maintenant la sp√©cification. Mais comme vous l'avez remarqu√©, cela est assez compliqu√© et peu pratique, car nous dupliquons en fait la logique m√©tier et les docstrings. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gx/er/qc/gxerqcbvgjayoxqbschiwlldcow.jpeg"><br>
<b><sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liens de la diapositive: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FastAPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAFRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rororo</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
D'int√©ressant, je vous conseille de regarder FastAPI. </font><font style="vertical-align: inherit;">Styopa </font><font style="vertical-align: inherit;">vous en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dira</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus √† ce sujet aujourd'hui </font><font style="vertical-align: inherit;">. FastAPI vous aide √† g√©n√©rer une sp√©cification pr√™te √† l'emploi. Vous n'y pouvez penser √† rien du tout. √âcrivez simplement le code et obtenez les sp√©cifications finales.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux autres cadres: SAFRS et rororo. Les noms, bien s√ªr, sont magiques. Ils fonctionnent un peu sur un mod√®le diff√©rent, ne vous font pas penser √† la sp√©cification et ne l'obtiennent que comme un effet secondaire. Au contraire, vous avez une sp√©cification qui pilote les gestionnaires. Il s'agit, en gros, d'un d√©veloppement ax√© sur les sp√©cifications. Ils n'ont pas autant d'√©toiles que FastAPI, mais il me semble qu'ils m√©ritent attention, jetez un ≈ìil. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bg/wy/u2/bgwyu2t0-lmkl0137h_yawj4cuk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, nous avons discut√© du type d'utilit√© autour de la sp√©cification en utilisant les exemples d'OpenAPI et de Swagger. Pour tous les points que je fais des liens, regardez bien, il y a beaucoup de choses int√©ressantes: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- OpenAPI / Swagger </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">swagger.io/docs/specification/about</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Exemple sur falcon + marshmallow + apispec </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/marshmallow-code/apispec</font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/tiangolo/fastapi</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- OpenAPI / Swagger </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">petits pains </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openapi.tools </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">swagger.io/tools swagger.io/tools/open-source/open-source-integrations </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/APIs-guru/awesome-openapi3</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Que dois - </font><font style="vertical-align: inherit;">je √©tait le message du rapport? </font><font style="vertical-align: inherit;">Les gars, la r√©daction de sp√©cifications n'est pas une sorte de bureaucratie. </font><font style="vertical-align: inherit;">Et ce n'est pas aussi difficile que cela puisse para√Ætre √† premi√®re vue, mais plut√¥t simple et fournit de nombreux outils utiles, vous ouvre de grandes opportunit√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âcrivez les sp√©cifications. </font><font style="vertical-align: inherit;">Recommander. </font><font style="vertical-align: inherit;">Merci beaucoup.</font></font><br>
<br>
<hr><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les codes et liens sont disponibles dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©sentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501064/index.html">Au vol du navire exp√©rimental chinois. Infographies et collages.</a></li>
<li><a href="../fr501068/index.html">Deepfakes et Deep Media: un nouveau champ de bataille pour la s√©curit√©</a></li>
<li><a href="../fr501076/index.html">Mois supprim√©. Nous r√©sumons et partageons les hacks de vie des dirigeants des groupes de travail des Jet Infosystems</a></li>
<li><a href="../fr501084/index.html">Services observables √† Angular</a></li>
<li><a href="../fr501086/index.html">Summ3r de h4ck 2020. Tutoriel d'√©t√© sur la s√©curit√© num√©rique</a></li>
<li><a href="../fr501090/index.html">K8S Multicluster Journey</a></li>
<li><a href="../fr501092/index.html">√Ä propos de la recherche de juin prometteur et "udalenka". Exp√©rience du responsable du support technique de Redmadrobot</a></li>
<li><a href="../fr501098/index.html">Solutions de batteries intelligentes SmartLi pour onduleurs modulaires</a></li>
<li><a href="../fr501106/index.html">Le simulateur de mots anglais le plus simple utilisant Python et Balabolka</a></li>
<li><a href="../fr501108/index.html">Historique du multiprocesseur Nvidia Streaming</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>