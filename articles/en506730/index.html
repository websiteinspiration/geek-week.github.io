<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¥üèΩ ‚ò∫Ô∏è üéÖüèæ Snort or Suricata. Part 1: choose a free IDS / IPS to protect the corporate network üç¨ üë®üèø‚Äçü§ù‚Äçüë®üèº üëâüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once upon a time, an ordinary firewall and antivirus programs were enough to protect the local network, but against the attacks of modern hackers and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Snort or Suricata. Part 1: choose a free IDS / IPS to protect the corporate network</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/506730/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Once upon a time, an ordinary firewall and antivirus programs were enough to protect the local network, but against the attacks of modern hackers and the recent malware that has bred recently, such a set is no longer effective enough. Good-old firewall only analyzes packet headers, skipping or blocking them according to a set of formal rules. He does not know anything about the contents of packages, and therefore he cannot recognize the externally legitimate actions of attackers. Anti-virus programs do not always catch malware, so the administrator is faced with the task of monitoring abnormal activity and timely isolation of infected hosts.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/b9/xb/teb9xbfmq-eyrzd8amgyfwt1dow.jpeg"></div></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are many ways to protect the company's IT infrastructure. </font><font style="vertical-align: inherit;">Today we‚Äôll talk about open source intrusion detection and warning systems, which can be implemented without buying expensive equipment and software licenses.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDS / IPS classification</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDS (Intrusion Detection System) - designed to record suspicious activities on the network or on a separate computer system. </font><font style="vertical-align: inherit;">She keeps event logs and notifies the employee responsible for information security about them. </font><font style="vertical-align: inherit;">The following elements can be distinguished as part of IDS:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensors for viewing network traffic, various logs, etc.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an analysis subsystem that detects signs of harmful effects in the data obtained;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">storage for the accumulation of primary events and analysis results;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">management console.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, IDSs were classified by location: they could be focused on protecting individual nodes (host-based or Host Intrusion Detection System - HIDS) or protect the entire corporate network (network-based or Network Intrusion Detection System - NIDS). It is worth mentioning the so-called APIDS (Application protocol-based IDS): they monitor a limited set of application-level protocols to detect specific attacks and do not do deep analysis of network packets. Such products are usually reminiscent of proxies and are used to protect specific services: a web server and web applications (for example, written in PHP), a database server, etc. A typical representative of this class is mod_security for the Apache web server.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We are more interested in universal NIDS that support a wide range of communication protocols and Deep Packet Inspection technologies. They monitor all passing traffic, starting from the data link layer, and identify a wide range of network attacks, as well as attempts to unauthorized access to information. Often, such systems are distinguished by a distributed architecture and can interact with various active network equipment. Note that many modern NIDS are hybrid and combine several approaches. Depending on the configuration and settings, they can solve various tasks - for example, protecting one node or the entire network. In addition, the anti-virus packages took over the IDS functions for workstations,which, due to the spread of information-theft-stealing Trojans, have turned into multifunctional firewalls, which also solve the problems of recognizing and blocking suspicious traffic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, IDS could only detect the actions of malware, the operation of port scanners, or, say, violations of corporate security policies by users. </font><font style="vertical-align: inherit;">When a certain event occurred, they notified the administrator, but pretty quickly it became clear that simply recognizing the attack was not enough - it needs to be blocked. </font><font style="vertical-align: inherit;">So IDS transformed into IPS (Intrusion Prevention Systems) - intrusion prevention systems that can interact with firewalls.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detection methods</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modern solutions for detecting and preventing intrusions use various methods for determining malicious activity, which can be divided into three categories. </font><font style="vertical-align: inherit;">This gives us another option for classifying systems:</font></font><br>
<br>
<ul>
<li> IDS/IPS                 .        ,      ;</li>
<li>  IDS    .         (    )      .               ;</li>
<li>   IDS   : if  then .          ‚Äî      .             .&nbsp;</li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDS Development History</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The era of rapid development of the Internet and corporate networks began in the 90s of the last century, but experts were puzzled a bit earlier with advanced network security technologies. </font><font style="vertical-align: inherit;">In 1986, Dorothy Denning and Peter Neumann published the IDES (Intrusion detection expert system) model, which became the basis of most modern intrusion detection systems. </font><font style="vertical-align: inherit;">She used an expert system to determine known types of attacks, as well as statistical methods and user / system profiles. </font><font style="vertical-align: inherit;">IDES ran on Sun workstations, checking network traffic and application data. </font><font style="vertical-align: inherit;">In 1993, NIDES (Next-generation Intrusion Detection Expert System) was released, a new-generation intrusion detection expert system.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on the work of Denning and Neumann, in 1988, the MIDAS (Multics intrusion detection and alerting system) expert system using P-BEST and LISP appeared. At the same time, the Haystack system based on statistical methods was created. Another W&amp;S statistical anomaly detector (Wisdom &amp; Sense) was developed a year later at Los Alamos National Laboratory. Industry development was fast. For example, in 1990, the TIM (Time-based inductive machine) system already implemented anomaly detection using inductive training on sequential user patterns (Common LISP language). NSM (Network Security Monitor) for anomaly detection compared access matrices, and the ISOA (Information Security Officer's Assistant) supported various detection strategies: statistical methods,profile verification and expert system. The ComputerWatch system created at AT&amp;T Bell Labs used statistical methods and rules for verification, and the developers of the University of California received the first distributed IDS prototype back in 1991 - the DIDS (Distributed intrusion detection system) was also an expert system.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, IDS were proprietary, but already in 1998, the National Laboratory. </font><font style="vertical-align: inherit;">Lawrence at Berkeley released Bro (she was renamed Zeek in 2018), an open source system that uses its own rule language to analyze libpcap data. </font><font style="vertical-align: inherit;">In November of the same year, the APE packet sniffer using libpcap appeared, which was renamed Snort a month later, and later became a full-fledged IDS / IPS. </font><font style="vertical-align: inherit;">At the same time, numerous proprietary solutions began to appear.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snort and Suricata</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Many companies favor free, open source IDS / IPS. For a long time, the standard solution was already considered by us Snort, but now Suricata has replaced it. Consider their advantages and disadvantages in more detail. Snort combines the benefits of a signature method with real-time anomaly detection. Suricata also allows you to use other methods besides recognition of attacks by signatures. The system was created by a group of developers who separated from the Snort project and supports IPS functions starting from version 1.4, and in Snort the ability to prevent intrusions appeared later.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main difference between the two popular products is that Suricata has the ability to use GPUs for computing in IDS mode, as well as the more advanced IPS. </font><font style="vertical-align: inherit;">The system was originally designed for multithreading, while Snort is a single-threaded product. </font><font style="vertical-align: inherit;">Due to its long history and inherited code, it does not optimally use multiprocessor / multi-core hardware platforms, while Suricata on ordinary general-purpose computers allows it to process traffic up to 10 Gb / s. </font><font style="vertical-align: inherit;">The similarities and differences between the two systems can be discussed for a long time, but although the Suricata engine is faster, for not too wide channels this does not matter.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deployment options</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPS must be placed so that the system can monitor the network segments it controls. Most often this is a dedicated computer, one interface of which is connected after the border devices and ‚Äúlooks‚Äù through them into insecure public networks (Internet). Another IPS interface is connected to the input of the protected segment so that all traffic passes through the system and is analyzed. In more complex cases, there can be several protected segments: for example, in corporate networks, a demilitarized zone (DMZ) with Internet-accessible services is often allocated.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/jt/jg/gmjtjgzjcjgpqfe3jxhq9t4oeha.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such IPS can prevent attempts to scan ports or hacking by means of password cracking, exploitation of vulnerabilities in the mail server, web server or in scripts, as well as other types of external attacks. If the computers on the local network are infected with malware, IDS will not allow them to contact external botnet servers. More serious protection of the internal network will most likely require a complex configuration with a distributed system and expensive managed switches capable of mirroring traffic for an IDS interface connected to one of the ports.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Often, corporate networks are subject to distributed denial of service (DDoS) attacks. Although modern IDSs can deal with them, the deployment option above will hardly help here. The system recognizes malicious activity and blocks spurious traffic, but for this, packets must go through an external Internet connection and get to its network interface. Depending on the intensity of the attack, the data channel may not cope with the load and the goal of the attackers will be achieved. For such cases, we recommend deploying IDS on a virtual server with a knownly more efficient Internet connection. You can connect the VPS to the local network through a VPN, and then you need to configure through it the routing of all external traffic.Then in the case of a DDoS attack, you won‚Äôt have to drive packets through a connection to the provider, they will be blocked on the external host.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u-/k5/8-/u-k58-rpse-gqzsrg14lltja2co.jpeg" alt="image"><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem of choice</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Identifying a leader among free systems is very difficult. </font><font style="vertical-align: inherit;">The choice of IDS / IPS is determined by the network topology, the necessary protection functions, as well as the administrator‚Äôs personal preferences and his desire to tinker with the settings. </font><font style="vertical-align: inherit;">Snort has a longer history and is better documented, although Suricata information is also easy to find on the net. </font><font style="vertical-align: inherit;">In any case, to master the system, you will have to make some efforts, which will eventually pay off - commercial hardware and software-hardware IDS / IPS are quite expensive and do not always fit into the budget. </font><font style="vertical-align: inherit;">Sorry for the time spent is not worth it, because a good admin always improves skills at the expense of the employer. </font><font style="vertical-align: inherit;">In this situation, everyone benefits. </font><font style="vertical-align: inherit;">In the next article, we will look at some of the Suricata deployment options and, in practice, compare a more modern system with the classic IDS / IPS Snort.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/gu/ab/cg/guabcgmwuqoopx1ar80sjpz6keq.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/de/0y/l-/de0yl-6ppopvisr_a80b4yuhjj8.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506706/index.html">The performance of modern Java when working with large amounts of data, part 1</a></li>
<li><a href="../en506708/index.html">VPN / Mikrotik two-factor authentication - simple and scalable</a></li>
<li><a href="../en506710/index.html">Manage multiple address books in the Zimbra Collaboration Suite Open-Source Edition</a></li>
<li><a href="../en506716/index.html">Multithreaded Linear List: Element Existence Problem, Productivity Improvement, and STL Relation</a></li>
<li><a href="../en506726/index.html">Experience in using Rutoken technology for registration and authorization of users in the system (part 2)</a></li>
<li><a href="../en506732/index.html">Organization-wide reuse of UI components</a></li>
<li><a href="../en506734/index.html">Transient calculations in electrical networks</a></li>
<li><a href="../en506736/index.html">How many methods should be in a class?</a></li>
<li><a href="../en506740/index.html">How to use Microsoft SQL for reports in Power BI. On the example of Mindbox</a></li>
<li><a href="../en506742/index.html">Why the center of the pixel should be at (0.5; 0.5)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>