<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è© üò∫ üî¶ Intercepter-NG 2.5 released for Android üìº üåë üçÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yes, Intercepter is still alive! And after a long lull, I am pleased to introduce a new version. 
 
 Initially, the task was to comb the interface, fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Intercepter-NG 2.5 released for Android</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497304/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yes, Intercepter is still alive! </font><font style="vertical-align: inherit;">And after a long lull, I am pleased to introduce a new version. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, the task was to comb the interface, fix errors, introduce some innovations and test performance on new versions of Android. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What came of it - under the cut.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/4af/5e6/265/4af5e62655834b11b118b9f277b9057d.jpg" alt="image"></div> <a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So. </font><font style="vertical-align: inherit;">Improved application appearance and usability. </font><font style="vertical-align: inherit;">The displayed information is delimited by colors, text is resized by gestures, you can switch between tabs using swipes, and a vibration response is also added. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Routing rules and iptables are automatically saved before starting work and restored at completion.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To avoid unnecessary expectations at the time of launch, the result of the previous scan for the current network is displayed. </font><font style="vertical-align: inherit;">Also, a quick pre-scan is done at startup - to eliminate the need for re-scanning, as was required in previous versions. </font><font style="vertical-align: inherit;">The scanning process has been improved, a new way to resolve names has been added. </font><font style="vertical-align: inherit;">Added function to automatically save names. </font><font style="vertical-align: inherit;">If during the scan it was not possible to determine the name of the device, it will be taken from the cache.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7z/b5/qr/7zb5qr6ybru1u1hgrwkhojweuno.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A diagnostic button has been added to the settings. In case of problems, the displayed information can facilitate the search for a solution. In particular, SELinux status is checked. Intercepter automatically switches setenforce to 0 during startup, so if Enforcing is in the diagnostics, it means we don‚Äôt turn it off on this system and you should not wait for proper operation. This situation occurs, for example, on stock firmware from Samsung. It is solved by installing third-party ROMs, for example LineageOS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The new Intercepter runs on all architectures starting with Android 4.4. The main testing was conducted on Android 9 and 10, there should not be any differences in the work on earlier versions. No additional installation of BusyBox and SuperSU required. Enough Magisk or other built-in root-managers. Libpcap has been updated to version 1.9.1. Starting with Android 8.1, to obtain the SSID of the network (it is displayed on the initial screen), you must provide access to location data. You can not provide them, this does not affect the functionality of the program. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Improved SSLStrip code, added HSTS spoofing.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6m/dc/0g/6mdc0gveytkqmxy2gggqhg_ipb8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The existing port scanner has been converted into a simplified X-Scan from the original version for Windows. A check for SSL is applied to open ports, then the service banner is displayed (if available) and the port is checked for belonging to the HTTP protocol. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If so, information from various HTTP headers is output. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If port 445 is open, an attempt is made to read the OS version through an SMB request. Additionally, a check is launched for the presence of the EternalBlue vulnerability.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/ay/vv/ghayvvc_kj8tu_d3mtdn-8-vymw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now I want to talk about a new functionality that can grow into something really big if the community actively supports the idea. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By performing a regular ARP scan, we get a pair of IP: MAC. By the MAC address we can determine the manufacturer of the network card, through the ICMP request we can get the TTL value and determine, in general terms, the type of operating system: Windows (128), Unix (64) or something more rare - Cisco IOS (255) . If the tested device has open TCP ports, then we can get the TCP Window Size and already separate Windows XP from Windows 7 or Linux from FreeBSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was according to this scheme that the operating system was determined in previous versions of Intercepter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In an attempt to expand the possibilities of determining the OS, I turned to passive fingerprinting, which for many years simply ignored. The most relevant application with a relatively fresh base is Satori. Both Satori and p0f (another well-known tool) work in exactly the same way as described above, only in addition to two marker values, a number of other IP and TCP header fields are analyzed, as well as TCP options, their value and sequence. The resulting fingerprint is a line of the following form: 64240: 128: 1: 52: M1460, N, W8, N, N, S: T. This is a fingerprint for Windows 10, which is also relevant for Windows 7.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having carefully examined the entire fingerprint database for the TCP protocol, it became clear that using it can really improve the accuracy of determining the OS, but the initial expectations did not materialize, because many prints are suitable for several versions of operating systems, so it is extremely difficult to make a choice among a number of options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, such fingerprint systems were created as a universal way to determine the OS, applicable to traffic from different networks, including global ones, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where such a parameter as the MAC address is not significant. But Intercepter works strictly in an Ethernet environment, where each device is directly accessible and has a unique MAC.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we add the first 3 bytes of the MAC address to the TCP fingerprint, we get an almost unique record that allows us to determine with a high degree of accuracy not so much the operating system as the device model! </font><font style="vertical-align: inherit;">At a minimum, this applies to smartphones, tablets, and other office network devices such as routers, printers, and so on. </font><font style="vertical-align: inherit;">This way we significantly increase the benefits of using network fingerprints. </font><font style="vertical-align: inherit;">The only difficulty is to collect the database of records ...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/h7/r2/gi/h7r2gia4ygorbjgriyieifxp8ly.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem is solved in several ways:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A button has been added to the Intercepter settings that generates a fingerprint for your device, just copy it and send it to me by mail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main thing is to make sure that the randomization of the MAC address is disabled, otherwise the fingerprint will be completely useless. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pros</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : does not require special gestures. </font></font><br>
<s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cons</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : it only imprints Android devices with root privileges.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-scan. </font><font style="vertical-align: inherit;">If there is at least one open port, upon completion of the scan, a fingerprint is displayed for the device under investigation, which is automatically copied to the clipboard. </font><font style="vertical-align: inherit;">If you have the opportunity to find out the OS version and / or device model - sign the fingerprint and send it to e-mail. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pros</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : additional information displayed in this mode can help determine the model of the device and form an imprint, even if you do not know what is in front of you. </font></font><br>
<s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cons</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : low coverage, one print per scan.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.</font></font></h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intercepter-NG 1.0+. I released a small update by adding fingerprint output on Smart Scan. There are various corrections and improvements to the previous version 1.0, including the checker on EternalBlue added to X-Scan, the oui database has been updated. Remember to install npcap. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pros</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : allows you to get fingerprints for a large number of devices on the network at a time. </font></font><br>
<s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cons</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : a limited list of the most common ports is scanned. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An example of a complete fingerprint: CC2DE0; 14480: 64: 1: 60: M1460, S, T, N, W5: ZAT = Linux 3.x; MikroTik RB750Gr3 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the initial stage, fingerprints are required even from conventional computer systems that do not have a specific model. It is necessary to replenish the so-called generic fingerprints that combine the family of operating systems of different versions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This database will be useful not only for use in Intercepter, it will also become useful for any other project that deals with traffic analysis, for example NetworkMiner, used in computer forensics. Existing bases for passive OS detection by TCP fingerprints are very outdated or have an insufficient number of entries. There is nmap, which is updated one way or another, but nmap is about active scanning, a completely different story ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intercepter offers a convenient and quick way to collect fingerprints without requiring deep knowledge in IT - start scanning, copy the fingerprint - sign it, send it. Piece of cake. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I give the instrument, and what to do next is up to you ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Many are interested in the fate of the main Windows version. </font><font style="vertical-align: inherit;">A full-fledged update will certainly be released, but when - it is still unknown. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I thank AndraxBoy and other w3bsit3-dns.com users for their help in testing. </font><font style="vertical-align: inherit;">Special thanks to Magomed Magomadov and Alexander Dmitrenko. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Questions, wishes and prints can be sent to intercepter.mail@gmail.com. </font><font style="vertical-align: inherit;">For fingerprints, you must specify the Fingerprint theme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Site: sniff.su </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mirror: github.com/intercepter-ng/mirror </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mail: intercepter.mail@gmail.com </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Twitter: twitter.com/IntercepterNG </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Forum: intercepterng.boards.net </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Blog: intercepter-ng.blogspot.ru</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497288/index.html">Decorative ceiling light Feron AL5000</a></li>
<li><a href="../en497290/index.html">Improving performance using uop cache on Sandy Bridge +</a></li>
<li><a href="../en497292/index.html">Technology Stack Shiro Games</a></li>
<li><a href="../en497296/index.html">Popular errors in English among IT professionals. Part 2: Pronunciation</a></li>
<li><a href="../en497302/index.html">Autonomous navigation of a mobile robot</a></li>
<li><a href="../en497306/index.html">DLL spoofing (DLL hijacking)</a></li>
<li><a href="../en497308/index.html">Can artificial intelligence do art?</a></li>
<li><a href="../en497310/index.html">Bipolar morphological networks: a neuron without multiplication</a></li>
<li><a href="../en497312/index.html">Question about CAN FD</a></li>
<li><a href="../en497314/index.html">How deep the Challenger Abyss is: measuring depth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>