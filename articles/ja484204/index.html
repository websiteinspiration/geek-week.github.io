<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎸 👨🏻‍🚒 💳 FTCODEファイルレスランサムウェアがアカウントを盗む 🕍 🏵️ 🌛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2013年、ソフォスはPowerShellで作成された暗号化ウイルスに感染した事例を報告しました。攻撃はロシアのユーザーを狙っていました。ファイルを暗号化した後、.FTCODE拡張子がファイルに追加され、ランサムウェアに名前が付けられました。悪意のあるコードは、メッセージに添付されたHTAファイル内...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>FTCODEファイルレスランサムウェアがアカウントを盗む</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/484204/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2013年、ソフォス</font><font style="vertical-align: inherit;">はPowerShellで作成された暗号化ウイルスに感染した事例を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">報告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しました。攻撃はロシアのユーザーを狙っていました。ファイルを暗号化した後、.FTCODE拡張子がファイルに追加され、ランサムウェアに名前が付けられました。悪意のあるコードは、メッセージに添付されたHTAファイル内のスパムメーリングプロセス中に配布されました。暗号化後、ランサムウェアは、身代金を作成してファイルを復号化する方法についてロシア語で指示を残しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数年後の2019年の秋に、このランサムウェアへの感染に関する新しい記述が現れました。攻撃者は、イタリアやその他の国で使用されているPEC認定のメールサービスのユーザーを対象としたフィッシングキャンペーンを実行しました。被害者は文書が添付されたメールを受け取りました。ドキュメント内には、悪意のあるコードをダウンロードするマクロが含まれていました。暗号化に加えて、ランサムウェアはJasperLoaderブートローダーをインストールしました。このトロイの木馬は、さまざまなマルウェアを配信するために使用できます。たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gootkitバンキング型トロイの木馬の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被害者をコンピュータにダウンロードする既知のケースがあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10月中旬、ランサムウェアバージョンが登場し、被害者のコンピュータからユーザーアカウントとパスワードを盗む機能が追加されました。</font><font style="vertical-align: inherit;">これらは、デフォルトの設定でインストールされた一般的なブラウザおよび電子メールクライアントから抽出されます。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellは、マルウェアの開発によく使用されます。これは、この言語のインタープリターが7番目のバージョン以降のWindowsオペレーティングシステムにデフォルトで含まれているためです。</font><font style="vertical-align: inherit;">さらに、PowerShellを使用すると、被害者のコンピューターのファイルに保存せずに悪意のあるコードを実行できます。</font><font style="vertical-align: inherit;">Positive Technologiesには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらの脅威に関する</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ウェビナーエントリ</font></a><font style="vertical-align: inherit;">があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ペイロード配信</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、</font></font><code>nuove_tariffe_2020_8_af11773ee02ec47fd5291895f25948e7.vbs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShellインタープリタープロセスを開始</font><font style="vertical-align: inherit;">するスクリプトが実行され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5u/ie/f1/5uief1ddg1rxtxdmvjkgbl_rdo4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図1.ペイロードのダウンロード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
インタープリターには、画像</font></font><code>hxxps://static[.]nexilia[.]it/nextquotidiano/2019/01/autostrade-aumenti-tariffe-2019[.]jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（図2）</font><font style="vertical-align: inherit;">をダウンロード</font><font style="vertical-align: inherit;">して一時ファイルのディレクトリーにtariffe.jpgとして保存</font><font style="vertical-align: inherit;">するコマンドを含む行が送信され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/da/da/zqdadas1q0kuggjbgu3cdtse7l4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2.ユーザーの注意をそらすために使用されるtariffe.jpg画像</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次にこの画像が開かれ、ディスクに書き込むことなく、Invoke Expressionを使用してインターネットからランサムウェアがダウンロードされます。以前の感染事例とは異なり、マルウェアの本体はBase64アルゴリズムを使用して拡散エンコードされます。ペイロードの配信には、ドメイン「バンド[。] Positivelifeology [。] Com」（図3）と「mobi [。] Confessyoursins [。] Mobi」が使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r_/il/o2/r_ilo2q-4l4fv9xmmkfhjfmvlhm.png"><br>
<br>
<i> 3.     </i><br>
<br>
<h2>   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、ランサムウェアの新しいバージョンには、一般的なブラウザーや電子メールクライアント、つまりInternet Explorer、Mozilla Firefox、Chrome、Outlook、Mozilla Thunderbirdからユーザーアカウントとパスワードを盗むためのモジュールがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、chooseArchコマンドの開始が、HTTPプロトコルからのPOSTリクエストを使用して、ドメイン「surv [。] Surviveandthriveparenting [。] Com」を持つ攻撃者のサーバーに送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ku/t4/0o/kut40oxihapmtesv_ujgsnfhgca.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図4.資格情報を盗むためのモジュール実行の開始に関する信号 </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この段階で生成されるトラフィックは、guid = temp_ddddddddddddという形式の行に特徴があり、その後にコマンドまたは盗まれたデータが続きます（図5）。この行には、各ランサムウェアサンプルに固有のGUIDが含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/4l/nm/j04lnmqpfdfdvl2bumkea-5ct4g.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図5.スタイラーがネットワーク通信に使用するコード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、被害者のユーザー名とパスワードが抽出され、base64アルゴリズムでエンコードされて攻撃者に送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b6/hz/rr/b6hzrrtfbwuczswxtpku7_nklxw.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図6.ユーザーアカウントを送信するためのコード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以下は、HTTP POSTリクエストによって送信された盗まれたデータを含むトラフィックのスニペットです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pg/er/xu/pgerxup1h7yqkgas6zpuso8ib1o.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図7.盗まれたデータ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
資格情報が送信された後、HTTPプロトコルのPOST要求を使用するスティラーは、その作業の完了を通知します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o9/_-/d5/o9_-d5po8k-fsie_nrdxbhtf9xo.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図8.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font><i><font style="vertical-align: inherit;">盗難の成功のシグナル</font></i></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JasperLoaderブートローダーをインストールする </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいバージョンのランサムウェアは、さまざまなマルウェアの配布に使用できるJasperLoaderブートローダー（図9）を引き続きダウンロードしてインストールします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/nn/rl/pnnnrldz7ma-msbspwscri1asoa.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図9. JasperLoaderコードを含むトラフィックスニペット</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ダウンロードしたブートローダーはファイルC：\ Users \ Public \ Libraries \ WindowsIndexingService.vbsに保存され、WindowsApplicationServiceとしてスケジュールされたWindowsタスクに追加され、WindowsApplicationService.lnkを使用して起動します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0q/0q/mf/0q0qmfurppd1r9sypk0ua00p8lw.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図10.ブートローダーのインストール</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ暗号化</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FTCODEは、ユーザーの資格情報を盗み、ブートローダーをインストールするだけでなく、被害者のコンピューター上のファイルを暗号化します。この段階は、環境の準備から始まります。ランサムウェアはファイルC：\ Users \ Public \ OracleKit \ quanto00.tmpを使用して、最後に実行された時刻を保存します。したがって、システム内のこのファイルの存在とその作成時間がチェックされます。システムにファイルが存在し、ファイルの作成から30分以内に経過した場合、プロセスは終了します（図11）。この事実はワクチンとして使用することができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/rz/yo/8vrzyokqb-vts1mpobpg6flwz_4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図11.ランサムウェアの最後の起動からの時間の確認</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次に、ファイルC：\ Users \ Public \ OracleKit \ w00log03.tmpから識別子が読み取られます。ファイルが見つからない場合は、新しい識別子が作成されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/vs/lx/mtvslxvh6bhj12ytarnkwun9k-w.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図12.被害者IDの準備  </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_h/5h/ht/_h5hhtbdw2gyekhhzel4hlzihfq.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図13.被害者ID</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランサムウェアは、さらにファイルを暗号化するための重要な情報を生成します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xg/90/ym/xg90ymcdoolmjctuehwfolyvch4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図14.暗号化のための鍵情報の生成</font></font><br>
</i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コードからわかるように、被害者のデータを回復するために必要な情報は、HTTPプロトコルのPOSTリクエストによって、food [。] Kkphd [。] Comドメインのノードに送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4w/eu/4p/4weu4prjhroi75epyzfisln1hnw.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図15.暗号化（復号化）のためにキー情報を送信する機能</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
したがって、被害者のファイルを暗号化するためのソルトを含むトラフィックを傍受できれば、攻撃者にお金を送金することなく、すべてのファイルを自分で復元できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/is/sz/vpissz3rqb_i9pnwdc5l3ks6p8i.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図16.傍受された主要な情報</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
暗号化では、RijndaelアルゴリズムがCBCモードで使用され、BXCODE INIT行に基づく初期化ベクトルと、BXCODEから取得したキーがシステムパスワードと以前に生成されたソルトをハッキングします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f6/hx/pa/f6hxpaufekdovbfrghxw1wii2xq.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図17.暗号化機能</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルの暗号化を開始</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">直前に、「開始」信号がHTTP POST要求で送信されます。暗号化プロセス中に、ソースファイルのコンテンツのサイズが40,960バイトを超える場合、ファイルはこのサイズに切り捨てられます。ランサムウェアの以前のバージョンのように、拡張子は.FTCODEではなくファイルに追加されますが、以前にランダムに生成され、extパラメータの値として攻撃者のサーバーに送信されたものです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/wx/8y/urwx8yhk31o8ysx6wpmtqkx11rm.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図18.暗号化されたファイル</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、HTTPプロトコルのPOSTリクエストが、「完了」信号と暗号化されたファイルの数とともに送信されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/1y/an/yt1yanqnitpxxhdvbj2mrutslty.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図19.暗号化機能のメインコード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
被害者のコンピューターで暗号化されているファイル拡張子の完全なリスト：</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .sql」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .mp4」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .7z」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .rar」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .m4a」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .wma」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .avi」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .wmv」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .csv」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .d3dbsp」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .zip」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .sie」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .sum」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .ibank」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .t13」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .t12」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .qdf」</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .gdb」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .tax」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .pkpass」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .bc6」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .bc7」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .bkp」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .qic」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .bkf」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .sidn」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .sidd」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .mddata」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .itl」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .itdb」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .icxs」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .hvpl」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .hplg」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .hkdb」</font></font></td>
<td>"*.mdbackup"</td>
<td>"*.syncdb"</td>
</tr>
<tr>
<td>"*.gho"</td>
<td>"*.cas"</td>
<td>"*.svg"</td>
<td>"*.map"</td>
<td>"*.wmo"</td>
<td>"*.itm"</td>
</tr>
<tr>
<td>"*.sb"</td>
<td>"*.fos"</td>
<td>"*.mov"</td>
<td>"*.vdf"</td>
<td>"*.ztmp"</td>
<td>"*.sis"</td>
</tr>
<tr>
<td>"*.sid"</td>
<td>"*.ncf"</td>
<td>"*.menu"</td>
<td>"*.layout"</td>
<td>"*.dmp"</td>
<td>"*.blob"</td>
</tr>
<tr>
<td>"*.esm"</td>
<td>"*.vcf"</td>
<td>"*.vtf"</td>
<td>"*.dazip"</td>
<td>"*.fpk"</td>
<td>"*.mlx"</td>
</tr>
<tr>
<td>"*.kf"</td>
<td>"*.iwd"</td>
<td>"*.vpk"</td>
<td>"*.tor"</td>
<td>"*.psk"</td>
<td>"*.rim"</td>
</tr>
<tr>
<td>"*.w3x"</td>
<td>"*.fsh"</td>
<td>"*.ntl"</td>
<td>"*.arch00"</td>
<td>"*.lvl"</td>
<td>"*.snx"</td>
</tr>
<tr>
<td>"*.cfr"</td>
<td>"*.ff"</td>
<td>"*.vpp_pc"</td>
<td>"*.lrf"</td>
<td>"*.m2"</td>
<td>"*.mcmeta"</td>
</tr>
<tr>
<td>"*.vfs0"</td>
<td>"*.mpqge"</td>
<td>"*.kdb"</td>
<td>"*.db0"</td>
<td>"*.dba"</td>
<td>"*.rofl"</td>
</tr>
<tr>
<td>"*.hkx"</td>
<td>"*.bar"</td>
<td>"*.upk"</td>
<td>"*.das"</td>
<td>"*.iwi"</td>
<td>"*.litemod"</td>
</tr>
<tr>
<td>"*.asset"</td>
<td>"*.forge"</td>
<td>"*.ltx"</td>
<td>"*.bsa"</td>
<td>"*.apk"</td>
<td>"*.re4"</td>
</tr>
<tr>
<td>"*.sav"</td>
<td>"*.lbf"</td>
<td>"*.slm"</td>
<td>"*.bik"</td>
<td>"*.epk"</td>
<td>"*.rgss3a"</td>
</tr>
<tr>
<td>"*.pak"</td>
<td>"*.big"</td>
<td>"*wallet"</td>
<td>"*.wotreplay"</td>
<td>"*.xxx"</td>
<td>"*.desc"</td>
</tr>
<tr>
<td>"*.py"</td>
<td>"*.m3u"</td>
<td>"*.flv"</td>
<td>"*.js"</td>
<td>"*.css"</td>
<td>"*.rb"</td>
</tr>
<tr>
<td>"*.png"</td>
<td>"*.jpeg"</td>
<td>"*.txt"</td>
<td>"*.p7c"</td>
<td>"*.p7b"</td>
<td>"*.p12"</td>
</tr>
<tr>
<td>"*.pfx"</td>
<td>"*.pem"</td>
<td>"*.crt"</td>
<td>"*.cer"</td>
<td>"*.der"</td>
<td>"*.x3f"</td>
</tr>
<tr>
<td>"*.srw"</td>
<td>"*.pef"</td>
<td>"*.ptx"</td>
<td>"*.r3d"</td>
<td>"*.rw2"</td>
<td>"*.rwl"</td>
</tr>
<tr>
<td>"*.raw"</td>
<td>"*.raf"</td>
<td>"*.orf"</td>
<td>"*.nrw"</td>
<td>"*.mrwref"</td>
<td>"*.mef"</td>
</tr>
<tr>
<td>"*.erf"</td>
<td>"*.kdc"</td>
<td>"*.dcr"</td>
<td>"*.cr2"</td>
<td>"*.crw"</td>
<td>"*.bay"</td>
</tr>
<tr>
<td>"*.sr2"</td>
<td>"*.srf"</td>
<td>"*.arw"</td>
<td>"*.3fr"</td>
<td>"*.dng"</td>
<td>"*.jpe"</td>
</tr>
<tr>
<td>"*.jpg"</td>
<td>"*.cdr"</td>
<td>"*.indd"</td>
<td>"*.ai"</td>
<td>"*.eps"</td>
<td>"*.pdf"</td>
</tr>
<tr>
<td>"*.pdd"</td>
<td>"*.psd"</td>
<td>"*.dbf"</td>
<td>"*.mdf"</td>
<td>"*.wb2"</td>
<td>"*.rtf"</td>
</tr>
<tr>
<td>"*.wpd"</td>
<td>"*.dxg"</td>
<td>"*.xf"</td>
<td>"*.dwg"</td>
<td>"*.pst"</td>
<td>"*.accdb"</td>
</tr>
<tr>
<td>"*.mdb"</td>
<td>"*.pptm"</td>
<td>"*.pptx"</td>
<td>"*.ppt"</td>
<td>"*.xlk"</td>
<td>"*.xlsb"</td>
</tr>
<tr>
<td>"*.xlsm"</td>
<td>"*.xlsx"</td>
<td>"*.xls"</td>
<td>"*.wps"</td>
<td>"*.docm"</td>
<td>"*.docx"</td>
</tr>
<tr>
<td>"*.doc"</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .odb」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .odc」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .odm」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .odp」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .ods」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「* .odt」</font></font></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
被害者のコンピュータ上のファイルを暗号化した後、テキストファイルREAD_ME_NOW.htmが作成されます。これは、ファイルの内容を復元するために必要なことを説明しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/i_/ww/bhi_wwack8cwwvejqpusumifqwk.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図20.被害者に対する攻撃者の攻撃</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ご覧のよう</font><i><font style="vertical-align: inherit;">に、被害者</font></i><font style="vertical-align: inherit;">ごとに、ファイルC：\ Users \ Public \ OracleKit \ w00log03.tmpの識別子を含む一意のリンクが作成されます。リンクが破損または削除されている場合、暗号化されたデータを回復できないリスクがあります。</font><font style="vertical-align: inherit;">Torブラウザのこのリンクは、ファイルを解読して身代金を要求するためのフォームを備えたページを提供します。</font><font style="vertical-align: inherit;">最初の買い戻しは500ドルで、時間の経過とともに増加します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i4/vm/ck/i4vmckinooy1121vpehr80h5u9e.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図21.引き換えリクエスト</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シャットダウン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
被害者のファイルが暗号化された後、FTCODEは暗号化されたファイルの復元に使用できるデータを削除します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/md/f1/ld/mdf1ldzmb81axiwawxguksit21a.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図22.データの削除</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このマルウェアは、VBSコード形式のブートローダーとPowerShellコード形式のペイロードで構成されています。</font><font style="vertical-align: inherit;">JPEG画像は、感染を隠すために使用されます。</font><font style="vertical-align: inherit;">マルウェアの機能は、有名なJasperLoaderブートローダーのインストール、身代金目的の被害者のファイルの暗号化、および人気のあるブラウザーやメールクライアントからのすべてのアカウントとパスワードの盗難です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考慮された脅威は、PT NADネットワークトラフィック分析システムによってFTCODEとして検出されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、PT NADはネットワークトラフィックを保存します。これは、このランサムウェアの被害者のファイルを解読するのに役立ちます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IOC</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6bac6d1650d79c19d2326719950017a8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bf4b8926c121c228aff646b258a4541e </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[。] [。] Com positivelifeology band </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[。] [。] Confessyoursins mobi mobi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[。] [。] Com surviveandthriveparenting surv </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[。] [。] Com kkphd Food </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Author</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Dmitry</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja484192/index.html">Tarantool Cartridgeへのアプリケーションのデプロイが簡単で簡単（パート2）</a></li>
<li><a href="../ja484194/index.html">子供のKubernetes</a></li>
<li><a href="../ja484196/index.html">マイクからのJSサウンドまたは音声コメントの録音</a></li>
<li><a href="../ja484198/index.html">コインの裏側：テスラ株の成長で誰が勝って負けたのか</a></li>
<li><a href="../ja484200/index.html">それらを達成するための目標を設定する方法</a></li>
<li><a href="../ja484206/index.html">Dartでのミックスインの使用</a></li>
<li><a href="../ja484208/index.html">プログラムのソースコードの静的分析における機械学習の使用</a></li>
<li><a href="../ja484212/index.html">カルマのための無料のもの-消費の原理を変えるベラルーシのスタートアップの物語</a></li>
<li><a href="../ja484214/index.html">TensorFlowのテンソル</a></li>
<li><a href="../ja484216/index.html">ロシアでの2番目のZabbix会議：登録と重要な日付</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>