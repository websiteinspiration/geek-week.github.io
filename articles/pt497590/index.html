<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏼 👂🏼 🏂🏾 Lidamos com o algoritmo de colapso da função de onda 🔷 😺 👩‍❤️‍💋‍👩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Desde o advento de DeBroglie e Tessera, fui solicitado muitas vezes a explicar como eles funcionam. Gerar pode parecer mágica, mas as regras por trás ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Lidamos com o algoritmo de colapso da função de onda</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/497590/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/0p/3h/m9/0p3hm9jziz_gbzi9tajbo2p_s3a.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde o advento de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeBroglie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fui solicitado muitas vezes a explicar como eles funcionam. </font><font style="vertical-align: inherit;">Gerar pode parecer mágica, mas as regras por trás disso são realmente simples.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, qual é o algoritmo Wave Function Collapse (WFC)? </font><font style="vertical-align: inherit;">Foi desenvolvido por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Gumin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para criar imagens "lado a lado" com base em uma configuração simples ou amostras de imagens. </font><font style="vertical-align: inherit;">O algoritmo pode fazer muito: veja os exemplos fornecidos por Maxim e Twitter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , assista a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este vídeo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A variedade é incrível.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seu navegador não suporta vídeo HTML5.</font></font><source src="https://www.boristhebrave.com/wp-content/uploads/2020/04/platformer.webm" type="video/webm"></video></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim no README explicou brevemente o trabalho do WFC, mas parece-me que esse problema exige uma divulgação mais detalhada, desde o básico. Como o algoritmo está relacionado à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programação de restrições</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a maior parte do artigo é dedicada a </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explicar o conceito de programação em restrições e, no final, retornaremos ao WFC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A programação restrita é uma maneira de instruir os computadores. Diferentemente da programação imperativa, quando você especifica uma lista de funções explícitas, ou programação funcional, quando você especifica funções matemáticas, aqui você fornece ao computador uma descrição estrita do problema e ele usa os algoritmos internos para encontrar uma solução. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este guia descreve vários conceitos, não métodos e código. </font><font style="vertical-align: inherit;">Se você estiver mais interessado na implementação, poderá usar minha biblioteca de código-fonte WFC ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Embora seja melhor iniciar o estudo com a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementação do Maxim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se você usa o Unity, pode comprar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , esta é a minha ferramenta para aplicar o WFC neste mecanismo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mini sudoku</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uma tarefa ilustrativa, peguei um mini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudoku</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este é um quebra-cabeça que se parece com uma grade 4 × 4 com números em algumas células.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/079/ce5/2d2079ce585502dbe9329e0a34cfbed8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objetivo é preencher cada célula vazia com um número de 1 a 4, de acordo com as regras:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada número de 1 a 4 deve estar presente em cada linha em uma única cópia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada número de 1 a 4 deve estar presente em cada coluna em uma única cópia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada número de 1 a 4 deve estar presente em cada quadrado de canto 2 × 2 em uma única cópia. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acordo com essas regras, a solução será a seguinte:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9e/ebf/927/d9eebf92740912d10aaaf6e63db189f3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode ter resolvido facilmente esse quebra-cabeça. </font><font style="vertical-align: inherit;">Mas estamos interessados ​​em como um computador pode fazer isso. </font><font style="vertical-align: inherit;">O problema pode ser dividido em duas partes: uma descrição das condições do computador e, em seguida, uma solução usando o algoritmo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descrição das condições</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalmente, uma linguagem de programação com restrições é usada para isso. Existem várias dessas linguagens e seus princípios de ação são semelhantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, definimos as </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variáveis</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aqui eles não são os mesmos da programação convencional. No contexto de um solucionador de problemas, uma variável é um valor desconhecido que deve ser resolvido para resolver um problema. No nosso exemplo de Sudoku, criaremos variáveis ​​para todas as células vazias. Por conveniência, você também pode criar variáveis ​​para células preenchidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, para cada variável, definimos um </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">domínio</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : um conjunto de valores possíveis. No nosso sudoku, para cada célula vazia, o domínio será {1, 2, 3, 4}. E para uma célula na qual 1 já foi inserido, o domínio será {1}. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por fim, definimos as </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restrições</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: regras que vinculam nossas variáveis. </font><font style="vertical-align: inherit;">Na maioria das linguagens de programação, já existe uma função com restrições </font></font><code>all_distinct(..)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que precisa passar valores únicos. </font><font style="vertical-align: inherit;">Portanto, as regras do Sudoku podem ser traduzidas em 12 restrições </font></font><code>all_distinct</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- uma para cada linha e coluna, bem como para quadrados de canto 2 × 2. </font><font style="vertical-align: inherit;">Precisamos de apenas um tipo de restrição para resolver esse problema; no entanto, os solucionadores de problemas para atender às restrições geralmente vêm com uma grande biblioteca de diferentes tipos de restrições para descrever seu problema. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : na prática, as linguagens de programação suportam matrizes com restrições, portanto, existem maneiras mais precisas de formular esta tarefa. </font><font style="vertical-align: inherit;">Existem muitos artigos na rede sobre como resolver o sudoku.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritmos para resolver problemas de satisfação de restrições</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem várias técnicas de solução diferentes. </font><font style="vertical-align: inherit;">Mas vou considerar o mais simples deles para demonstrar a você o princípio de seu trabalho. </font><font style="vertical-align: inherit;">Os domínios para cada célula são mostrados aqui:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/192/dd5/6d7/192dd56d7c6fad65e9d0ff0cd672b8b8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos esses são valores possíveis em domínios variáveis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora pegue a primeira limitação. </font><font style="vertical-align: inherit;">Requer que todos os valores na linha superior sejam exclusivos. </font><font style="vertical-align: inherit;">Em uma célula, o valor 4 já está inscrito; portanto, em outras células da série, esse valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">não</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode </font><i><font style="vertical-align: inherit;">ser</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nós o removemos dos domínios dessas células.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea5/f37/ab8/ea5f37ab81c6fe4e923999a01d9c5b81.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repita esse processo com todas as 12 restrições. </font><font style="vertical-align: inherit;">Isso é chamado </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propagação de restrições</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque as informações são distribuídas de uma variável para outra por meio de restrições.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c06/08e/1fa/c0608e1fa9d933b28269217ae9678831.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E veja, temos variáveis, nos domínios dos quais resta um valor. </font><font style="vertical-align: inherit;">Essas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser as soluções corretas para essas variáveis.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02e/074/d2c/02e074d2cdcde1220efade75f26d7234.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que podemos obter ainda mais benefícios com a distribuição de restrições: as novas unidades vermelhas indicam que teremos ainda mais variáveis ​​com um único domínio, e isso também contribuirá para a distribuição. </font><font style="vertical-align: inherit;">Repita o procedimento até que o quebra-cabeça seja resolvido.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f78/94d/b63/f7894db63f3238fab4cf689941bd9d69.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nós complicamos a tarefa</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, nem todos os quebra-cabeças lógicos podem ser resolvidos tão rapidamente. </font><font style="vertical-align: inherit;">Aqui está um grande sudoku, que funciona da mesma maneira, exceto que agora temos 9 valores diferentes, 9 linhas, 9 colunas e 9 quadrados 3 × 3.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd2/97d/434/fd297d4345a2593633a88bbf0bf26764.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tentarmos aplicar a técnica acima, ficaremos presos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/481/f68/a82/481f68a826b65b43441ddae08821f1ba.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora todas as restrições são comuns, mas ainda existem variáveis ​​indefinidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma pessoa decidirá isso, mas um algoritmo de computador não poderá. Os manuais para pessoas dizem que agora precisamos procurar conclusões lógicas cada vez mais complicadas. Mas não precisamos de um algoritmo de computador para fazer isso, porque é difícil, mas precisamos de um </font><font style="vertical-align: inherit;">algoritmo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">universal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que possa funcionar com qualquer conjunto de restrições, e não apenas de acordo com as regras do sudoku. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, os computadores fazem a coisa mais estúpida: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eles assumem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Primeiro, registramos o estado atual do quebra-cabeça. Depois, selecionamos uma variável arbitrária e a definimos como um dos valores possíveis. Digamos que atribuímos o valor 1 à célula central.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora podemos espalhar um pouco mais as restrições. </font><font style="vertical-align: inherit;">Aqui está o que eu consegui para a coluna central:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f8b/176/f83/f8b176f83864aad8a4907714b7d0b790.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os valores azuis são as conclusões que tiramos após a suposição. </font><font style="vertical-align: inherit;">Como você pode ver, algo aconteceu. </font><font style="vertical-align: inherit;">Colocamos mais algumas variáveis, mas observamos a célula superior média. </font><font style="vertical-align: inherit;">Está vazio: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em seu domínio não há valores possíveis que</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> satisfaçam as restrições (não pode haver 5, porque esse valor já existe no mesmo quadrado 3 × 3 e todos os outros números já estão nesta coluna). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se obtivermos uma variável com um domínio vazio, isso significa que não podemos atribuir nenhum valor a ela. </font><font style="vertical-align: inherit;">Ou seja, o quebra-cabeça não pode ser resolvido. </font><font style="vertical-align: inherit;">Acontece que </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nossa suposição foi errada</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diante de tal contradição, realizamos o processo de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">busca de retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(retrocesso). Primeiro, restauramos o estado que estava antes de nossa suposição. Em seguida, removemos do domínio o valor que usamos como suposição - ele não pode mais ser a resposta correta.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1f/6b5/684/b1f6b5684064aab0ed2c355774b3d7aa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muito trabalho foi feito, mas eles avançaram. No entanto, mesmo após a exclusão de 1 da célula central, ainda estamos em um ponto morto. É hora de fazer uma suposição novamente, e novamente, e novamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não há muitas ações algorítmicas aqui. Sempre que não podemos distribuir restrições, assumimos e seguimos em frente. E como você pode ficar preso várias vezes antes de encontrar uma contradição, acumulará vários estados e suposições salvos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com cada iteração com um retorno, você reduz o domínio em pelo menos uma variável, para que, apesar de inúmeras reversões, o algoritmo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acabe por</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> concluir o trabalho.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este tópico é muito mais extenso do que eu descrevo. </font><font style="vertical-align: inherit;">Na prática, otimizações como a escolha de premissas, o entendimento de quando distribuir e quando tirar conclusões lógicas mais complexas podem ter um enorme impacto na execução do programa. </font><font style="vertical-align: inherit;">E como os problemas com restrições, em regra, crescem exponencialmente, você pode obter uma resposta amanhã ou depois de 5000 anos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voltamos ao colapso da função de onda</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O colapso da função de onda é uma tarefa complicada, com uma limitação: existem milhares de soluções possíveis. Se fizermos suposições aleatoriamente, em vez de um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solucionador,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> obteremos um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ao mesmo tempo, ainda cumprirá todas as restrições fornecidas, ou seja, será muito mais gerenciável do que a maioria dos outros geradores de procedimentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tarefa do algoritmo WFC é preencher células com blocos para que as imagens nos blocos sejam combinadas entre si. Dentro da terminologia usada acima, cada bloco é um valor, cada célula é uma variável e as regras para colocar blocos são restrições.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim, o autor do WFC, descobriu que, com uma escolha razoável de blocos e uma randomização apropriada, você raramente precisa usar o retorno, portanto esse procedimento não pode ser implementado. </font><font style="vertical-align: inherit;">Assim, a essência do WFC é a seguinte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma matriz booleana é criada para cada célula, que representa o domínio dessa variável. </font><font style="vertical-align: inherit;">Os domínios contêm um registro por bloco e todos eles são inicializados com um valor </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um bloco entra em um domínio se seu valor for igual </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao mesmo tempo, existem células nas quais os domínios contêm vários elementos:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleção de uma célula aleatória usando o método heurístico de "menor entropia".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecione um bloco aleatório no domínio da célula e remova todos os outros blocos de lá.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A atualização dos domínios de outras células com base nessas novas informações é a disseminação da restrição de células. </font><font style="vertical-align: inherit;">Isso deve ser feito repetidamente, pois as alterações nas células podem ter consequências adicionais.</font></font></li>
</ul></li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : meus termos são diferentes dos termos de Maxim. </font><font style="vertical-align: inherit;">Ele chama o conjunto de domínios de onda, e escolher um ladrilho aleatório é uma observação. </font><font style="vertical-align: inherit;">Ou seja, uma analogia é desenhada com a mecânica quântica. </font><font style="vertical-align: inherit;">Mas a comparação é superficial, então vamos ignorá-la. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem muitas adições aos princípios acima que adicionam graça e desempenho ao algoritmo. </font><font style="vertical-align: inherit;">Mas vamos primeiro olhar para as etapas descritas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Digamos que precisamos preencher uma grade 3 por 3 com quatro tipos de blocos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/749/647/d6b/749647d6ba27126a9e7769a479cd79a5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As limitações são: as cores dos ladrilhos adjacentes devem coincidir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no exemplo do Sudoku, ilustrarei o conteúdo dos domínios com imagens monocromáticas. </font><font style="vertical-align: inherit;">Quando houver apenas um elemento no domínio, aumentarei em tamanho e mostrarei em cores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, em cada célula, blocos de qualquer tipo podem ser localizados:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/780/406/ba9/780406ba92fd3d6cd89234b1aa2b8431.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute o loop WFC principal. </font><font style="vertical-align: inherit;">Selecione aleatoriamente uma célula, por exemplo, no canto superior esquerdo. </font><font style="vertical-align: inherit;">Agora selecione um bloco no domínio e exclua todos os outros.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6b/053/8a4/c6b0538a47c9355d22fe75fada7252cc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distribua as restrições. </font><font style="vertical-align: inherit;">A única regra se aplica aos blocos adjacentes, portanto, precisamos atualizar duas células:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/90e/a7f/440/90ea7f440d0b3805b324a4bbaef6a7e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos atualizar outros blocos devido aos domínios cada vez menores? </font><font style="vertical-align: inherit;">Sim! </font><font style="vertical-align: inherit;">Embora não tenhamos certeza sobre a escolha do primeiro bloco, vemos que as opções restantes levam à direita. </font><font style="vertical-align: inherit;">Ou seja, alguns tipos de ladrilhos não podem ser colocados no canto superior direito. </font><font style="vertical-align: inherit;">A mesma coisa com o canto inferior esquerdo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4dc/4f3/d07/4dc4f3d070fe3268639e9fc3e2877661.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como não podemos mais distribuir as restrições, repetimos o ciclo principal: seleção de células, seleção e distribuição de blocos. </font><font style="vertical-align: inherit;">Desta vez, pegamos a célula do meio superior:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b58/44c/01a/b5844c01a98770f203587dd46d02a3df.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro ciclo: pegue a célula do meio esquerda. </font><font style="vertical-align: inherit;">Após a proliferação de restrições para a célula central, um possível valor permanece.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/066/f76/a13/066f76a13cda6b5e275a371b3561c02a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, você entende a ideia. </font><font style="vertical-align: inherit;">Você pode preencher o resto das células você mesmo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você quiser experimentar um </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemplo interativo mais complexo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , recomendo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menor entropia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao escolher a próxima célula a ser preenchida, algumas opções serão preferíveis. </font><font style="vertical-align: inherit;">Se você escolher aleatoriamente de qualquer lugar da grade, poderá ocorrer uma situação em que ao mesmo tempo você terá áreas diferentes da grade preenchidas. </font><font style="vertical-align: inherit;">Isso pode causar problemas: dependendo dos ladrilhos disponíveis, as áreas preenchidas não podem ser unidas. </font><font style="vertical-align: inherit;">Portanto, é melhor escolher células com menor probabilidade de levar a esses problemas no futuro. </font><font style="vertical-align: inherit;">Em outras palavras, você precisa obter células com o menor número possível de valores no domínio (mas não menos que dois valores):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Provavelmente, eles estarão ao lado das células já preenchidas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se os deixarmos para o futuro, poderão surgir dificuldades, porque os valores disponíveis já são poucos.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A abordagem de domínio menor funciona bem se todos os blocos forem igualmente prováveis. </font><font style="vertical-align: inherit;">Mas se você escolher entre uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distribuição aleatória ponderada</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , precisará considerar outra coisa. </font><font style="vertical-align: inherit;">Maxima recomenda “entropia mínima”, ou seja, escolha uma célula que minimize:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>&amp;#x2014;</mo><mo>&amp;#x2211;</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.41ex" height="3.634ex" viewBox="0 -1024.6 10940.2 1564.8" role="img" focusable="false" style="vertical-align: -1.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6E" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-74" x="1067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-72" x="1428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6F" x="1880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="2365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-79" x="2869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-3D" x="3644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-2014" x="4422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJSZ2-2211" x="5589" y="0"></use><g transform="translate(7201,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6C" x="8048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6F" x="8347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-67" x="8832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-28" x="9313" y="0"></use><g transform="translate(9702,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-29" x="10550" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>—</mo><mo>∑</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">entropy = — \sum p_{i}log(p_{i})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este é um somatório de blocos no domínio em que </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">p_{i}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - probabilidade para esse bloco.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computação eficiente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora eu não queira entrar em detalhes, no entanto, existem duas otimizações que me permitem aumentar a velocidade tanto que não podem ser ignoradas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como nossa única regra está relacionada a blocos adjacentes, só podemos verificar as restrições que podem fornecer resultados diferentes dos anteriores. Ou seja, ao atualizar uma célula, a adicionamos à fila de células que aguardam uma decisão. Em seguida, removemos uma célula da fila, sempre verificando suas células adjacentes. Se essas verificações levarem à renovação de outras células, elas também cairão na fila. Repetindo esse procedimento até que a fila esteja vazia, garantimos que verifiquemos todas as restrições. Mas não as verificamos até que o domínio de pelo menos uma célula associada a essas restrições seja alterado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, para verificar a restrição de adjacência, precisamos responder à pergunta: “Dados os blocos no domínio da célula A, quais blocos são possíveis no domínio da célula B se as células forem adjacentes?” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Às vezes, essa pergunta é chamada de "suporte" da célula A. Para um determinado bloco "b" no domínio B, é fácil calcular os ciclos dos blocos no domínio A. Se A tiver pelo menos um bloco que pode ser colocado ao lado de "b", então "b" ainda adequado, pelo menos para o par de peças em questão. Se em A não houver esse bloco, não será possível colocar o bloco "b" no domínio B, e podemos descartá-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os loops facilitam a implementação disso no código, mas funcionarão extremamente lentamente. </font><font style="vertical-align: inherit;">E se armazenarmos informações em uma estrutura de dados adicional, poderemos responder rapidamente à pergunta conforme necessário. </font><font style="vertical-align: inherit;">Os novos dados são uma matriz grande com entradas para cada lado de cada célula e cada bloco. </font><font style="vertical-align: inherit;">No nosso exemplo, existem 9 células, cada uma com 4 lados e 4 tipos de blocos. </font><font style="vertical-align: inherit;">Então, precisamos de 9 * 4 * 4 registros. </font><font style="vertical-align: inherit;">Salvaremos os contadores de suporte na matriz: para cada célula / bloco / lado, contamos o número de blocos no domínio da célula adjacente que pode ser colocado próximo ao bloco em questão. </font><font style="vertical-align: inherit;">Se o contador cair para zero, esse bloco não poderá ser colocado, porque ninguém poderá ficar adjacente a ele.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extensões de algoritmo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o WFC se baseia em um entendimento mais geral dos problemas restritos, existem muitas maneiras de estender o algoritmo alterando as restrições usadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das mudanças óbvias é que ninguém nos obriga a usar células quadradas. O WFC funciona muito bem em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">células hexagonais, em três dimensões</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">superfícies</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ainda mais </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">incomuns</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98f/35a/0b9/98f35a0b9ccd9fd4fce689cd7f911d64.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/848/881/d32/848881d3216ac003a312c1fc8cfd56ea.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/497/0d2/706/4970d270636d7203d3e8e1e4bcb4befd.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode introduzir restrições adicionais: consertar determinados blocos ou criar "módulos" a partir de várias células. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A introdução de restrições adicionais pode desempenhar um papel muito importante do ponto de vista prático. </font><font style="vertical-align: inherit;">Como o WFC limita apenas blocos adjacentes, raramente gera grandes estruturas que fornecem um alto nível de homogeneidade e parecem incomuns. </font><font style="vertical-align: inherit;">Esse algoritmo funciona melhor na escolha de blocos, mas para trabalhar com algumas estruturas grandes, é melhor usar uma técnica diferente ou introduzir outras restrições. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outro artigo,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falei sobre como você pode obter os melhores resultados do WFC.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobreposição de WFC</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das extensões interessantes do algoritmo é o WFC "sobreposto". Nos exemplos acima, a principal limitação estava relacionada a pares de peças adjacentes. Isso é suficiente para garantir a conexão das linhas e criar estruturas simples como cavernas, salas etc. Mas, ao mesmo tempo, muita informação é perdida. Se precisarmos, digamos, que os ladrilhos vermelhos estejam sempre localizados ao lado do azul, mas nunca foram adjacentes a eles, será difícil expressar isso apenas em termos de contiguidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim propôs o conceito de sobreposição de WFC: substituímos a restrição de adjacência por uma nova restrição que afeta vários blocos ao mesmo tempo. Por exemplo, para que na saída cada grupo de células 3 × 3 corresponda a um grupo 3 × 3 de uma amostra de grade. Os padrões presentes na amostra serão repetidos repetidamente em diferentes variações na saída:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42d/72b/b76/42d72bb7631b24f33858756ade67fa55.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa restrição é muito mais sensível que as restrições de adjacência "simples". </font><font style="vertical-align: inherit;">E, como depende de uma amostra, é muito adequado para resolver algum tipo de tarefa artística. </font><font style="vertical-align: inherit;">Até agora, não encontrei nada tão interessante. </font><font style="vertical-align: inherit;">Talvez a razão seja que esse algoritmo seja mais difícil de implementar, ou funcione mais devagar, ou às vezes reproduza muito bem a amostra original, o que causa a perda de algum tipo de naturalidade e naturalidade.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual é o próximo?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A solução de problemas com restrições é um campo amplo e em desenvolvimento ativo da ciência da computação, e eu apenas o toquei. </font><font style="vertical-align: inherit;">O WFC - como qualquer outro algoritmo de geração de procedimentos para resolver problemas restritos - ainda é novo. </font><font style="vertical-align: inherit;">Eu recomendo a leitura de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r / proceduralgeneration</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@exutumno</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@osksta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ter uma idéia dos casos de uso recentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você também pode ler meu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo sobre o WFC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , experimentar minha </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioteca de código-fonte aberto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ferramenta Unity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Não se esqueça dos meus outros artigos sobre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geração de procedimentos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt497578/index.html">A AMD está comprometida em conquistar uma parcela significativa do mercado de data centers</a></li>
<li><a href="../pt497580/index.html">Quarentena dura é muito, muito ruim</a></li>
<li><a href="../pt497582/index.html">Habr ocupa o primeiro lugar no ranking de direitos digitais dos usuários</a></li>
<li><a href="../pt497584/index.html">Auto quantificado: como os Madrobots trouxeram escalas inteligentes Picooc para a Rússia</a></li>
<li><a href="../pt497588/index.html">Spring Security - um exemplo de aplicativo da Web de autorização OAuth2 por meio do BitBucket</a></li>
<li><a href="../pt497594/index.html">Armazenamento de dados externos: do tempo do IBM 1311 até os dias atuais. Parte 1</a></li>
<li><a href="../pt497596/index.html">Viva PHP</a></li>
<li><a href="../pt497602/index.html">Você se considera um signor? Quem voce esta brincando</a></li>
<li><a href="../pt497606/index.html">Sistema de rega automática para jardim para Home Assistant, ESP8266 e MiFlora</a></li>
<li><a href="../pt497608/index.html">Como os sistemas de análise de tráfego detectam táticas de hackers por MITRE ATT & CK, parte 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>