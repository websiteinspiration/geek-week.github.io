<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèº üëÇüèº üèÇüèæ Lidamos com o algoritmo de colapso da fun√ß√£o de onda üî∑ üò∫ üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Desde o advento de DeBroglie e Tessera, fui solicitado muitas vezes a explicar como eles funcionam. Gerar pode parecer m√°gica, mas as regras por tr√°s ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Lidamos com o algoritmo de colapso da fun√ß√£o de onda</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/497590/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/0p/3h/m9/0p3hm9jziz_gbzi9tajbo2p_s3a.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde o advento de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeBroglie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fui solicitado muitas vezes a explicar como eles funcionam. </font><font style="vertical-align: inherit;">Gerar pode parecer m√°gica, mas as regras por tr√°s disso s√£o realmente simples.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, qual √© o algoritmo Wave Function Collapse (WFC)? </font><font style="vertical-align: inherit;">Foi desenvolvido por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Gumin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para criar imagens "lado a lado" com base em uma configura√ß√£o simples ou amostras de imagens. </font><font style="vertical-align: inherit;">O algoritmo pode fazer muito: veja os exemplos fornecidos por Maxim e Twitter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , assista a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este v√≠deo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A variedade √© incr√≠vel.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seu navegador n√£o suporta v√≠deo HTML5.</font></font><source src="https://www.boristhebrave.com/wp-content/uploads/2020/04/platformer.webm" type="video/webm"></video></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim no README explicou brevemente o trabalho do WFC, mas parece-me que esse problema exige uma divulga√ß√£o mais detalhada, desde o b√°sico. Como o algoritmo est√° relacionado √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programa√ß√£o de restri√ß√µes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a maior parte do artigo √© dedicada a </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explicar o conceito de programa√ß√£o em restri√ß√µes e, no final, retornaremos ao WFC</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A programa√ß√£o restrita √© uma maneira de instruir os computadores. Diferentemente da programa√ß√£o imperativa, quando voc√™ especifica uma lista de fun√ß√µes expl√≠citas, ou programa√ß√£o funcional, quando voc√™ especifica fun√ß√µes matem√°ticas, aqui voc√™ fornece ao computador uma descri√ß√£o estrita do problema e ele usa os algoritmos internos para encontrar uma solu√ß√£o. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este guia descreve v√°rios conceitos, n√£o m√©todos e c√≥digo. </font><font style="vertical-align: inherit;">Se voc√™ estiver mais interessado na implementa√ß√£o, poder√° usar minha biblioteca de c√≥digo-fonte WFC ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documenta√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Embora seja melhor iniciar o estudo com a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementa√ß√£o do Maxim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se voc√™ usa o Unity, pode comprar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tessera</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , esta √© a minha ferramenta para aplicar o WFC neste mecanismo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mini sudoku</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uma tarefa ilustrativa, peguei um mini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudoku</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este √© um quebra-cabe√ßa que se parece com uma grade 4 √ó 4 com n√∫meros em algumas c√©lulas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/079/ce5/2d2079ce585502dbe9329e0a34cfbed8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objetivo √© preencher cada c√©lula vazia com um n√∫mero de 1 a 4, de acordo com as regras:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada n√∫mero de 1 a 4 deve estar presente em cada linha em uma √∫nica c√≥pia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada n√∫mero de 1 a 4 deve estar presente em cada coluna em uma √∫nica c√≥pia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada n√∫mero de 1 a 4 deve estar presente em cada quadrado de canto 2 √ó 2 em uma √∫nica c√≥pia. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acordo com essas regras, a solu√ß√£o ser√° a seguinte:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9e/ebf/927/d9eebf92740912d10aaaf6e63db189f3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode ter resolvido facilmente esse quebra-cabe√ßa. </font><font style="vertical-align: inherit;">Mas estamos interessados ‚Äã‚Äãem como um computador pode fazer isso. </font><font style="vertical-align: inherit;">O problema pode ser dividido em duas partes: uma descri√ß√£o das condi√ß√µes do computador e, em seguida, uma solu√ß√£o usando o algoritmo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o das condi√ß√µes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalmente, uma linguagem de programa√ß√£o com restri√ß√µes √© usada para isso. Existem v√°rias dessas linguagens e seus princ√≠pios de a√ß√£o s√£o semelhantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, definimos as </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°veis</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aqui eles n√£o s√£o os mesmos da programa√ß√£o convencional. No contexto de um solucionador de problemas, uma vari√°vel √© um valor desconhecido que deve ser resolvido para resolver um problema. No nosso exemplo de Sudoku, criaremos vari√°veis ‚Äã‚Äãpara todas as c√©lulas vazias. Por conveni√™ncia, voc√™ tamb√©m pode criar vari√°veis ‚Äã‚Äãpara c√©lulas preenchidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, para cada vari√°vel, definimos um </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dom√≠nio</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : um conjunto de valores poss√≠veis. No nosso sudoku, para cada c√©lula vazia, o dom√≠nio ser√° {1, 2, 3, 4}. E para uma c√©lula na qual 1 j√° foi inserido, o dom√≠nio ser√° {1}. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por fim, definimos as </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restri√ß√µes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: regras que vinculam nossas vari√°veis. </font><font style="vertical-align: inherit;">Na maioria das linguagens de programa√ß√£o, j√° existe uma fun√ß√£o com restri√ß√µes </font></font><code>all_distinct(..)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que precisa passar valores √∫nicos. </font><font style="vertical-align: inherit;">Portanto, as regras do Sudoku podem ser traduzidas em 12 restri√ß√µes </font></font><code>all_distinct</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- uma para cada linha e coluna, bem como para quadrados de canto 2 √ó 2. </font><font style="vertical-align: inherit;">Precisamos de apenas um tipo de restri√ß√£o para resolver esse problema; no entanto, os solucionadores de problemas para atender √†s restri√ß√µes geralmente v√™m com uma grande biblioteca de diferentes tipos de restri√ß√µes para descrever seu problema. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : na pr√°tica, as linguagens de programa√ß√£o suportam matrizes com restri√ß√µes, portanto, existem maneiras mais precisas de formular esta tarefa. </font><font style="vertical-align: inherit;">Existem muitos artigos na rede sobre como resolver o sudoku.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritmos para resolver problemas de satisfa√ß√£o de restri√ß√µes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem v√°rias t√©cnicas de solu√ß√£o diferentes. </font><font style="vertical-align: inherit;">Mas vou considerar o mais simples deles para demonstrar a voc√™ o princ√≠pio de seu trabalho. </font><font style="vertical-align: inherit;">Os dom√≠nios para cada c√©lula s√£o mostrados aqui:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/192/dd5/6d7/192dd56d7c6fad65e9d0ff0cd672b8b8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos esses s√£o valores poss√≠veis em dom√≠nios vari√°veis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora pegue a primeira limita√ß√£o. </font><font style="vertical-align: inherit;">Requer que todos os valores na linha superior sejam exclusivos. </font><font style="vertical-align: inherit;">Em uma c√©lula, o valor 4 j√° est√° inscrito; portanto, em outras c√©lulas da s√©rie, esse valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode </font><i><font style="vertical-align: inherit;">ser</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">N√≥s o removemos dos dom√≠nios dessas c√©lulas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea5/f37/ab8/ea5f37ab81c6fe4e923999a01d9c5b81.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repita esse processo com todas as 12 restri√ß√µes. </font><font style="vertical-align: inherit;">Isso √© chamado </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propaga√ß√£o de restri√ß√µes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque as informa√ß√µes s√£o distribu√≠das de uma vari√°vel para outra por meio de restri√ß√µes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c06/08e/1fa/c0608e1fa9d933b28269217ae9678831.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E veja, temos vari√°veis, nos dom√≠nios dos quais resta um valor. </font><font style="vertical-align: inherit;">Essas </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser as solu√ß√µes corretas para essas vari√°veis.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02e/074/d2c/02e074d2cdcde1220efade75f26d7234.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que podemos obter ainda mais benef√≠cios com a distribui√ß√£o de restri√ß√µes: as novas unidades vermelhas indicam que teremos ainda mais vari√°veis ‚Äã‚Äãcom um √∫nico dom√≠nio, e isso tamb√©m contribuir√° para a distribui√ß√£o. </font><font style="vertical-align: inherit;">Repita o procedimento at√© que o quebra-cabe√ßa seja resolvido.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f78/94d/b63/f7894db63f3238fab4cf689941bd9d69.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√≥s complicamos a tarefa</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, nem todos os quebra-cabe√ßas l√≥gicos podem ser resolvidos t√£o rapidamente. </font><font style="vertical-align: inherit;">Aqui est√° um grande sudoku, que funciona da mesma maneira, exceto que agora temos 9 valores diferentes, 9 linhas, 9 colunas e 9 quadrados 3 √ó 3.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd2/97d/434/fd297d4345a2593633a88bbf0bf26764.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tentarmos aplicar a t√©cnica acima, ficaremos presos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/481/f68/a82/481f68a826b65b43441ddae08821f1ba.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora todas as restri√ß√µes s√£o comuns, mas ainda existem vari√°veis ‚Äã‚Äãindefinidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma pessoa decidir√° isso, mas um algoritmo de computador n√£o poder√°. Os manuais para pessoas dizem que agora precisamos procurar conclus√µes l√≥gicas cada vez mais complicadas. Mas n√£o precisamos de um algoritmo de computador para fazer isso, porque √© dif√≠cil, mas precisamos de um </font><font style="vertical-align: inherit;">algoritmo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">universal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que possa funcionar com qualquer conjunto de restri√ß√µes, e n√£o apenas de acordo com as regras do sudoku. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, os computadores fazem a coisa mais est√∫pida: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eles assumem</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Primeiro, registramos o estado atual do quebra-cabe√ßa. Depois, selecionamos uma vari√°vel arbitr√°ria e a definimos como um dos valores poss√≠veis. Digamos que atribu√≠mos o valor 1 √† c√©lula central.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora podemos espalhar um pouco mais as restri√ß√µes. </font><font style="vertical-align: inherit;">Aqui est√° o que eu consegui para a coluna central:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f8b/176/f83/f8b176f83864aad8a4907714b7d0b790.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os valores azuis s√£o as conclus√µes que tiramos ap√≥s a suposi√ß√£o. </font><font style="vertical-align: inherit;">Como voc√™ pode ver, algo aconteceu. </font><font style="vertical-align: inherit;">Colocamos mais algumas vari√°veis, mas observamos a c√©lula superior m√©dia. </font><font style="vertical-align: inherit;">Est√° vazio: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em seu dom√≠nio n√£o h√° valores poss√≠veis que</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> satisfa√ßam as restri√ß√µes (n√£o pode haver 5, porque esse valor j√° existe no mesmo quadrado 3 √ó 3 e todos os outros n√∫meros j√° est√£o nesta coluna). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se obtivermos uma vari√°vel com um dom√≠nio vazio, isso significa que n√£o podemos atribuir nenhum valor a ela. </font><font style="vertical-align: inherit;">Ou seja, o quebra-cabe√ßa n√£o pode ser resolvido. </font><font style="vertical-align: inherit;">Acontece que </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nossa suposi√ß√£o foi errada</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diante de tal contradi√ß√£o, realizamos o processo de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">busca de retorno</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(retrocesso). Primeiro, restauramos o estado que estava antes de nossa suposi√ß√£o. Em seguida, removemos do dom√≠nio o valor que usamos como suposi√ß√£o - ele n√£o pode mais ser a resposta correta.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1f/6b5/684/b1f6b5684064aab0ed2c355774b3d7aa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muito trabalho foi feito, mas eles avan√ßaram. No entanto, mesmo ap√≥s a exclus√£o de 1 da c√©lula central, ainda estamos em um ponto morto. √â hora de fazer uma suposi√ß√£o novamente, e novamente, e novamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o h√° muitas a√ß√µes algor√≠tmicas aqui. Sempre que n√£o podemos distribuir restri√ß√µes, assumimos e seguimos em frente. E como voc√™ pode ficar preso v√°rias vezes antes de encontrar uma contradi√ß√£o, acumular√° v√°rios estados e suposi√ß√µes salvos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com cada itera√ß√£o com um retorno, voc√™ reduz o dom√≠nio em pelo menos uma vari√°vel, para que, apesar de in√∫meras revers√µes, o algoritmo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acabe por</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> concluir o trabalho.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este t√≥pico √© muito mais extenso do que eu descrevo. </font><font style="vertical-align: inherit;">Na pr√°tica, otimiza√ß√µes como a escolha de premissas, o entendimento de quando distribuir e quando tirar conclus√µes l√≥gicas mais complexas podem ter um enorme impacto na execu√ß√£o do programa. </font><font style="vertical-align: inherit;">E como os problemas com restri√ß√µes, em regra, crescem exponencialmente, voc√™ pode obter uma resposta amanh√£ ou depois de 5000 anos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voltamos ao colapso da fun√ß√£o de onda</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O colapso da fun√ß√£o de onda √© uma tarefa complicada, com uma limita√ß√£o: existem milhares de solu√ß√µes poss√≠veis. Se fizermos suposi√ß√µes aleatoriamente, em vez de um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solucionador,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> obteremos um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ao mesmo tempo, ainda cumprir√° todas as restri√ß√µes fornecidas, ou seja, ser√° muito mais gerenci√°vel do que a maioria dos outros geradores de procedimentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tarefa do algoritmo WFC √© preencher c√©lulas com blocos para que as imagens nos blocos sejam combinadas entre si. Dentro da terminologia usada acima, cada bloco √© um valor, cada c√©lula √© uma vari√°vel e as regras para colocar blocos s√£o restri√ß√µes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim, o autor do WFC, descobriu que, com uma escolha razo√°vel de blocos e uma randomiza√ß√£o apropriada, voc√™ raramente precisa usar o retorno, portanto esse procedimento n√£o pode ser implementado. </font><font style="vertical-align: inherit;">Assim, a ess√™ncia do WFC √© a seguinte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma matriz booleana √© criada para cada c√©lula, que representa o dom√≠nio dessa vari√°vel. </font><font style="vertical-align: inherit;">Os dom√≠nios cont√™m um registro por bloco e todos eles s√£o inicializados com um valor </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um bloco entra em um dom√≠nio se seu valor for igual </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao mesmo tempo, existem c√©lulas nas quais os dom√≠nios cont√™m v√°rios elementos:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sele√ß√£o de uma c√©lula aleat√≥ria usando o m√©todo heur√≠stico de "menor entropia".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selecione um bloco aleat√≥rio no dom√≠nio da c√©lula e remova todos os outros blocos de l√°.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A atualiza√ß√£o dos dom√≠nios de outras c√©lulas com base nessas novas informa√ß√µes √© a dissemina√ß√£o da restri√ß√£o de c√©lulas. </font><font style="vertical-align: inherit;">Isso deve ser feito repetidamente, pois as altera√ß√µes nas c√©lulas podem ter consequ√™ncias adicionais.</font></font></li>
</ul></li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : meus termos s√£o diferentes dos termos de Maxim. </font><font style="vertical-align: inherit;">Ele chama o conjunto de dom√≠nios de onda, e escolher um ladrilho aleat√≥rio √© uma observa√ß√£o. </font><font style="vertical-align: inherit;">Ou seja, uma analogia √© desenhada com a mec√¢nica qu√¢ntica. </font><font style="vertical-align: inherit;">Mas a compara√ß√£o √© superficial, ent√£o vamos ignor√°-la. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem muitas adi√ß√µes aos princ√≠pios acima que adicionam gra√ßa e desempenho ao algoritmo. </font><font style="vertical-align: inherit;">Mas vamos primeiro olhar para as etapas descritas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Digamos que precisamos preencher uma grade 3 por 3 com quatro tipos de blocos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/749/647/d6b/749647d6ba27126a9e7769a479cd79a5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As limita√ß√µes s√£o: as cores dos ladrilhos adjacentes devem coincidir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no exemplo do Sudoku, ilustrarei o conte√∫do dos dom√≠nios com imagens monocrom√°ticas. </font><font style="vertical-align: inherit;">Quando houver apenas um elemento no dom√≠nio, aumentarei em tamanho e mostrarei em cores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, em cada c√©lula, blocos de qualquer tipo podem ser localizados:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/780/406/ba9/780406ba92fd3d6cd89234b1aa2b8431.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute o loop WFC principal. </font><font style="vertical-align: inherit;">Selecione aleatoriamente uma c√©lula, por exemplo, no canto superior esquerdo. </font><font style="vertical-align: inherit;">Agora selecione um bloco no dom√≠nio e exclua todos os outros.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6b/053/8a4/c6b0538a47c9355d22fe75fada7252cc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Distribua as restri√ß√µes. </font><font style="vertical-align: inherit;">A √∫nica regra se aplica aos blocos adjacentes, portanto, precisamos atualizar duas c√©lulas:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/90e/a7f/440/90ea7f440d0b3805b324a4bbaef6a7e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos atualizar outros blocos devido aos dom√≠nios cada vez menores? </font><font style="vertical-align: inherit;">Sim! </font><font style="vertical-align: inherit;">Embora n√£o tenhamos certeza sobre a escolha do primeiro bloco, vemos que as op√ß√µes restantes levam √† direita. </font><font style="vertical-align: inherit;">Ou seja, alguns tipos de ladrilhos n√£o podem ser colocados no canto superior direito. </font><font style="vertical-align: inherit;">A mesma coisa com o canto inferior esquerdo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4dc/4f3/d07/4dc4f3d070fe3268639e9fc3e2877661.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como n√£o podemos mais distribuir as restri√ß√µes, repetimos o ciclo principal: sele√ß√£o de c√©lulas, sele√ß√£o e distribui√ß√£o de blocos. </font><font style="vertical-align: inherit;">Desta vez, pegamos a c√©lula do meio superior:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b58/44c/01a/b5844c01a98770f203587dd46d02a3df.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro ciclo: pegue a c√©lula do meio esquerda. </font><font style="vertical-align: inherit;">Ap√≥s a prolifera√ß√£o de restri√ß√µes para a c√©lula central, um poss√≠vel valor permanece.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/066/f76/a13/066f76a13cda6b5e275a371b3561c02a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, voc√™ entende a ideia. </font><font style="vertical-align: inherit;">Voc√™ pode preencher o resto das c√©lulas voc√™ mesmo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ quiser experimentar um </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemplo interativo mais complexo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , recomendo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menor entropia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao escolher a pr√≥xima c√©lula a ser preenchida, algumas op√ß√µes ser√£o prefer√≠veis. </font><font style="vertical-align: inherit;">Se voc√™ escolher aleatoriamente de qualquer lugar da grade, poder√° ocorrer uma situa√ß√£o em que ao mesmo tempo voc√™ ter√° √°reas diferentes da grade preenchidas. </font><font style="vertical-align: inherit;">Isso pode causar problemas: dependendo dos ladrilhos dispon√≠veis, as √°reas preenchidas n√£o podem ser unidas. </font><font style="vertical-align: inherit;">Portanto, √© melhor escolher c√©lulas com menor probabilidade de levar a esses problemas no futuro. </font><font style="vertical-align: inherit;">Em outras palavras, voc√™ precisa obter c√©lulas com o menor n√∫mero poss√≠vel de valores no dom√≠nio (mas n√£o menos que dois valores):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Provavelmente, eles estar√£o ao lado das c√©lulas j√° preenchidas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se os deixarmos para o futuro, poder√£o surgir dificuldades, porque os valores dispon√≠veis j√° s√£o poucos.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A abordagem de dom√≠nio menor funciona bem se todos os blocos forem igualmente prov√°veis. </font><font style="vertical-align: inherit;">Mas se voc√™ escolher entre uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distribui√ß√£o aleat√≥ria ponderada</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , precisar√° considerar outra coisa. </font><font style="vertical-align: inherit;">Maxima recomenda ‚Äúentropia m√≠nima‚Äù, ou seja, escolha uma c√©lula que minimize:</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>&amp;#x2014;</mo><mo>&amp;#x2211;</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.41ex" height="3.634ex" viewBox="0 -1024.6 10940.2 1564.8" role="img" focusable="false" style="vertical-align: -1.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6E" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-74" x="1067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-72" x="1428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6F" x="1880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="2365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-79" x="2869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-3D" x="3644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-2014" x="4422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJSZ2-2211" x="5589" y="0"></use><g transform="translate(7201,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6C" x="8048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-6F" x="8347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-67" x="8832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-28" x="9313" y="0"></use><g transform="translate(9702,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMAIN-29" x="10550" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>e</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>‚Äî</mo><mo>‚àë</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">entropy = ‚Äî \sum p_{i}log(p_{i})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um somat√≥rio de blocos no dom√≠nio em que </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.884ex" viewBox="-38.5 -540.2 886.3 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/mailru/blog/497590/&amp;usg=ALkJrhi_HLc1PJRqyZEWLQusbthhiTEDlQ#MJMATHI-69" x="712" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">p_{i}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - probabilidade para esse bloco.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computa√ß√£o eficiente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora eu n√£o queira entrar em detalhes, no entanto, existem duas otimiza√ß√µes que me permitem aumentar a velocidade tanto que n√£o podem ser ignoradas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como nossa √∫nica regra est√° relacionada a blocos adjacentes, s√≥ podemos verificar as restri√ß√µes que podem fornecer resultados diferentes dos anteriores. Ou seja, ao atualizar uma c√©lula, a adicionamos √† fila de c√©lulas que aguardam uma decis√£o. Em seguida, removemos uma c√©lula da fila, sempre verificando suas c√©lulas adjacentes. Se essas verifica√ß√µes levarem √† renova√ß√£o de outras c√©lulas, elas tamb√©m cair√£o na fila. Repetindo esse procedimento at√© que a fila esteja vazia, garantimos que verifiquemos todas as restri√ß√µes. Mas n√£o as verificamos at√© que o dom√≠nio de pelo menos uma c√©lula associada a essas restri√ß√µes seja alterado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, para verificar a restri√ß√£o de adjac√™ncia, precisamos responder √† pergunta: ‚ÄúDados os blocos no dom√≠nio da c√©lula A, quais blocos s√£o poss√≠veis no dom√≠nio da c√©lula B se as c√©lulas forem adjacentes?‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Äs vezes, essa pergunta √© chamada de "suporte" da c√©lula A. Para um determinado bloco "b" no dom√≠nio B, √© f√°cil calcular os ciclos dos blocos no dom√≠nio A. Se A tiver pelo menos um bloco que pode ser colocado ao lado de "b", ent√£o "b" ainda adequado, pelo menos para o par de pe√ßas em quest√£o. Se em A n√£o houver esse bloco, n√£o ser√° poss√≠vel colocar o bloco "b" no dom√≠nio B, e podemos descart√°-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os loops facilitam a implementa√ß√£o disso no c√≥digo, mas funcionar√£o extremamente lentamente. </font><font style="vertical-align: inherit;">E se armazenarmos informa√ß√µes em uma estrutura de dados adicional, poderemos responder rapidamente √† pergunta conforme necess√°rio. </font><font style="vertical-align: inherit;">Os novos dados s√£o uma matriz grande com entradas para cada lado de cada c√©lula e cada bloco. </font><font style="vertical-align: inherit;">No nosso exemplo, existem 9 c√©lulas, cada uma com 4 lados e 4 tipos de blocos. </font><font style="vertical-align: inherit;">Ent√£o, precisamos de 9 * 4 * 4 registros. </font><font style="vertical-align: inherit;">Salvaremos os contadores de suporte na matriz: para cada c√©lula / bloco / lado, contamos o n√∫mero de blocos no dom√≠nio da c√©lula adjacente que pode ser colocado pr√≥ximo ao bloco em quest√£o. </font><font style="vertical-align: inherit;">Se o contador cair para zero, esse bloco n√£o poder√° ser colocado, porque ningu√©m poder√° ficar adjacente a ele.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extens√µes de algoritmo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o WFC se baseia em um entendimento mais geral dos problemas restritos, existem muitas maneiras de estender o algoritmo alterando as restri√ß√µes usadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das mudan√ßas √≥bvias √© que ningu√©m nos obriga a usar c√©lulas quadradas. O WFC funciona muito bem em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√©lulas hexagonais, em tr√™s dimens√µes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">superf√≠cies</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ainda mais </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">incomuns</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98f/35a/0b9/98f35a0b9ccd9fd4fce689cd7f911d64.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/848/881/d32/848881d3216ac003a312c1fc8cfd56ea.png" width="300"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/497/0d2/706/4970d270636d7203d3e8e1e4bcb4befd.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode introduzir restri√ß√µes adicionais: consertar determinados blocos ou criar "m√≥dulos" a partir de v√°rias c√©lulas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A introdu√ß√£o de restri√ß√µes adicionais pode desempenhar um papel muito importante do ponto de vista pr√°tico. </font><font style="vertical-align: inherit;">Como o WFC limita apenas blocos adjacentes, raramente gera grandes estruturas que fornecem um alto n√≠vel de homogeneidade e parecem incomuns. </font><font style="vertical-align: inherit;">Esse algoritmo funciona melhor na escolha de blocos, mas para trabalhar com algumas estruturas grandes, √© melhor usar uma t√©cnica diferente ou introduzir outras restri√ß√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">outro artigo,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falei sobre como voc√™ pode obter os melhores resultados do WFC.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobreposi√ß√£o de WFC</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das extens√µes interessantes do algoritmo √© o WFC "sobreposto". Nos exemplos acima, a principal limita√ß√£o estava relacionada a pares de pe√ßas adjacentes. Isso √© suficiente para garantir a conex√£o das linhas e criar estruturas simples como cavernas, salas etc. Mas, ao mesmo tempo, muita informa√ß√£o √© perdida. Se precisarmos, digamos, que os ladrilhos vermelhos estejam sempre localizados ao lado do azul, mas nunca foram adjacentes a eles, ser√° dif√≠cil expressar isso apenas em termos de contiguidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maxim prop√¥s o conceito de sobreposi√ß√£o de WFC: substitu√≠mos a restri√ß√£o de adjac√™ncia por uma nova restri√ß√£o que afeta v√°rios blocos ao mesmo tempo. Por exemplo, para que na sa√≠da cada grupo de c√©lulas 3 √ó 3 corresponda a um grupo 3 √ó 3 de uma amostra de grade. Os padr√µes presentes na amostra ser√£o repetidos repetidamente em diferentes varia√ß√µes na sa√≠da:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42d/72b/b76/42d72bb7631b24f33858756ade67fa55.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa restri√ß√£o √© muito mais sens√≠vel que as restri√ß√µes de adjac√™ncia "simples". </font><font style="vertical-align: inherit;">E, como depende de uma amostra, √© muito adequado para resolver algum tipo de tarefa art√≠stica. </font><font style="vertical-align: inherit;">At√© agora, n√£o encontrei nada t√£o interessante. </font><font style="vertical-align: inherit;">Talvez a raz√£o seja que esse algoritmo seja mais dif√≠cil de implementar, ou funcione mais devagar, ou √†s vezes reproduza muito bem a amostra original, o que causa a perda de algum tipo de naturalidade e naturalidade.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual √© o pr√≥ximo?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A solu√ß√£o de problemas com restri√ß√µes √© um campo amplo e em desenvolvimento ativo da ci√™ncia da computa√ß√£o, e eu apenas o toquei. </font><font style="vertical-align: inherit;">O WFC - como qualquer outro algoritmo de gera√ß√£o de procedimentos para resolver problemas restritos - ainda √© novo. </font><font style="vertical-align: inherit;">Eu recomendo a leitura de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r / proceduralgeneration</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#wavefunctioncollapse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@exutumno</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@osksta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ter uma id√©ia dos casos de uso recentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode ler meu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo sobre o WFC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , experimentar minha </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioteca de c√≥digo-fonte aberto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ferramenta Unity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">N√£o se esque√ßa dos meus outros artigos sobre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gera√ß√£o de procedimentos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt497578/index.html">A AMD est√° comprometida em conquistar uma parcela significativa do mercado de data centers</a></li>
<li><a href="../pt497580/index.html">Quarentena dura √© muito, muito ruim</a></li>
<li><a href="../pt497582/index.html">Habr ocupa o primeiro lugar no ranking de direitos digitais dos usu√°rios</a></li>
<li><a href="../pt497584/index.html">Auto quantificado: como os Madrobots trouxeram escalas inteligentes Picooc para a R√∫ssia</a></li>
<li><a href="../pt497588/index.html">Spring Security - um exemplo de aplicativo da Web de autoriza√ß√£o OAuth2 por meio do BitBucket</a></li>
<li><a href="../pt497594/index.html">Armazenamento de dados externos: do tempo do IBM 1311 at√© os dias atuais. Parte 1</a></li>
<li><a href="../pt497596/index.html">Viva PHP</a></li>
<li><a href="../pt497602/index.html">Voc√™ se considera um signor? Quem voce esta brincando</a></li>
<li><a href="../pt497606/index.html">Sistema de rega autom√°tica para jardim para Home Assistant, ESP8266 e MiFlora</a></li>
<li><a href="../pt497608/index.html">Como os sistemas de an√°lise de tr√°fego detectam t√°ticas de hackers por MITRE ATT & CK, parte 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>