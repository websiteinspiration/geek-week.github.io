<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìñ üî™ ü§¥ Consul + iptables =: 3 ‚õ∞Ô∏è ‚ôãÔ∏è üôåüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En 2010, Wargaming avait 50 serveurs et un mod√®le de r√©seau simple: backend, frontend et firewall. Le nombre de serveurs a augment√©, le mod√®le est dev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Consul + iptables =: 3</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/486842/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En 2010, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wargaming</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avait 50 serveurs et un mod√®le de r√©seau simple: backend, frontend et firewall. Le nombre de serveurs a augment√©, le mod√®le est devenu plus compliqu√©: staging, VLAN isol√©s avec ACL, puis VPN avec VRF, VLAN avec ACL vers L2, VRF depuis ACL vers L3. La t√™te tourne? Plus sera plus amusant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque les serveurs ont commenc√© √† fonctionner 16 000 sans larmes avec autant de segments h√©t√©rog√®nes, cela est devenu impossible. Par cons√©quent, ils ont trouv√© une solution diff√©rente. Nous avons pris la pile Netfilter, y avons ajout√© Consul comme source de donn√©es et nous avons obtenu un pare-feu distribu√© rapidement. Ils ont remplac√© l'ACL sur les routeurs et utilis√© comme pare-feu externe et interne. Pour la gestion dynamique des outils, nous avons d√©velopp√© le syst√®me BEFW, utilis√© partout: du contr√¥le de l'acc√®s des utilisateurs au r√©seau d'√©picerie √† l'isolement des segments du r√©seau les uns des autres.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/od/wg/bd/odwgbdlxcjww7ln1u_btv23hyvq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment tout cela fonctionne et pourquoi vous devriez examiner de plus pr√®s ce syst√®me, explique </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ivan Agarkov</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annmuor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) - le chef du groupe de s√©curit√© des infrastructures de l'unit√© de maintenance du centre de d√©veloppement de l'entreprise de Minsk. </font><font style="vertical-align: inherit;">Ivan est un fan de SELinux, aime Perl, √©crit du code. </font><font style="vertical-align: inherit;">En tant que chef du groupe IB, il travaille r√©guli√®rement avec les journaux, les sauvegardes et la R&amp;D pour prot√©ger Wargaming contre les pirates et assurer le fonctionnement de tous les serveurs de jeux de l'entreprise.</font></font><br>
<a name="habracut"></a><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/4zP67uYnsR4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©f√©rence historique</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de dire comment nous l'avons fait, je vais vous dire comment nous en sommes arriv√©s l√† et pourquoi c'√©tait n√©cessaire. Pour ce faire, nous avons transf√©r√© il y a 9 ans: 2010, seul le World of Tanks est apparu. Wargaming avait environ 50 serveurs. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e6/qf/6h/e6qf6hugl_efcmn73qn16mcyeoc.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphique de croissance des serveurs de l'entreprise.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avions un mod√®le de r√©seau. Pour l'√©poque, c'√©tait optimal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/zw/vj/bizwvjhrfphzbrhme6v1avzjxag.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mod√®le de r√©seau en 2010.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√Ä l'avant, il y a des m√©chants qui veulent nous briser, mais il y a un pare-feu. Il n'y a pas de pare-feu sur le backend, mais il y a 50 serveurs l√†-bas, nous les connaissons tous. Tout fonctionne bien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant 4 ans, le parc de serveurs a augment√© 100 fois, jusqu'√† 5000. Les premiers r√©seaux isol√©s sont apparus - des √©tapes: ils ne peuvent pas entrer en production, et souvent des choses qui pouvaient √™tre dangereuses y tournaient. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/6e/ba/z06ebavv-r6yu7fuhy2zvvhsnw0.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mod√®le de r√©seau en 2014.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par inertie, tous les m√™mes morceaux de fer ont √©t√© utilis√©s et tout le travail a √©t√© effectu√© sur des VLAN isol√©s: les ACL sont √©crites sur le VLAN qui autorisent ou interdisent toute connexion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2016, le nombre de serveurs a atteint 8000. Wargaming a absorb√© d'autres studios, d'autres r√©seaux d'affiliation sont apparus. Ils semblent √™tre les n√¥tres, mais pas tout √† fait: les VLAN ne fonctionnent souvent pas pour les partenaires, vous devez utiliser un VPN avec VRF, l'isolement devient plus compliqu√©. Un m√©lange d'isolats d'ACL s'est d√©velopp√©. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w-/zj/ej/w-zjej3fr8frinvbg4z1thbwdre.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mod√®le de r√©seau en 2016.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Au d√©but de 2018, le parc de voitures √©tait pass√© √† 16 000. Il y avait 6 segments, et le reste nous ne comptions pas, y compris ceux ferm√©s, dans lesquels les donn√©es financi√®res √©taient stock√©es. Il existe des r√©seaux de conteneurs (Kubernetes), DevOps, des r√©seaux cloud connect√©s via VPN, par exemple, √† partir de l'IVS. Il y avait beaucoup de r√®gles - √ßa faisait mal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iv/zf/cd/ivzfcdz9lzxsiugegpfthzwubik.png"><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mod√®le de r√©seau et m√©thodes d'isolement en 2018.</font></font></em><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'isolement, nous avons utilis√©: VLAN avec ACL sur L2, VRF avec ACL sur L3, VPN et bien plus encore. </font><font style="vertical-align: inherit;">Trop.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probl√®mes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout le monde vit avec des ACL et des VLAN. </font><font style="vertical-align: inherit;">Qu'est-ce qui ne va g√©n√©ralement pas? </font><font style="vertical-align: inherit;">Harold, cachant la douleur, r√©pondra √† cette question. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y2/hi/tl/y2hitlbrqlvcbm6rjg59tzaaqxw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y avait beaucoup de probl√®mes, mais il y en avait cinq √©normes.</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Augmentation g√©om√©trique des prix pour les nouvelles r√®gles</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Chaque nouvelle r√®gle a √©t√© ajout√©e plus longtemps que la pr√©c√©dente, car il fallait d'abord voir s'il existait d√©j√† une telle r√®gle.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de pare-feu √† l'int√©rieur des segments</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Les segments √©taient en quelque sorte s√©par√©s les uns des autres, √† l'int√©rieur il n'y a d√©j√† pas assez de ressources.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les r√®gles sont appliqu√©es depuis longtemps. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les op√©rateurs de r√®gles locaux peuvent √©crire en une heure. </font><font style="vertical-align: inherit;">Global a pris plusieurs jours.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Difficult√©s avec l'audit des r√®gles</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Plus pr√©cis√©ment, ce n'√©tait pas possible. </font><font style="vertical-align: inherit;">Les premi√®res r√®gles ont √©t√© √©crites en 2010, et la plupart de leurs auteurs ne travaillaient plus pour l'entreprise.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faible niveau de contr√¥le sur l'infrastructure</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">C'est le principal probl√®me - nous ne savions pas bien ce qui se passait avec nous.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici √† quoi ressemblait l'ing√©nieur r√©seau en 2018 lorsqu'il a entendu: ¬´Nous avons besoin de plus de listes de contr√¥le d'acc√®s¬ª.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hh/rl/_i/hhrl_ig_xefe7lps5yrz_liioam.png" width="350"></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©but 2018, il a √©t√© d√©cid√© de faire quelque chose. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le prix de l'int√©gration est en constante augmentation.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le point de d√©part √©tait que les grands centres de donn√©es ne prenaient plus en charge les VLAN et ACL isol√©s, car la m√©moire des appareils √©tait √©puis√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solution: supprimer le facteur humain et automatiser la fourniture d'acc√®s au maximum. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nouvelles r√®gles s'appliquent depuis longtemps.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solution: acc√©l√©rer l'application des r√®gles, les rendre r√©parties et parall√®les. Pour ce faire, vous avez besoin d'un syst√®me distribu√© afin que les r√®gles soient livr√©es seules, sans rsync ou SFTP pour mille syst√®mes. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'absence de pare-feu √† l'int√©rieur des segments.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le pare-feu √† l'int√©rieur des segments a commenc√© √† voler vers nous lorsque diff√©rents services sont apparus au sein du m√™me r√©seau. Solution: utilisez un pare-feu bas√© sur l'h√¥te. Presque partout o√π nous avons Linux, et iptables sont partout, ce n'est pas un probl√®me. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Difficult√©s avec l'audit des r√®gles.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solution: conservez toutes les r√®gles en un seul endroit pour examen et gestion, afin que nous puissions tout auditer. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faible niveau de contr√¥le sur l'infrastructure.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solution: faites l'inventaire de tous les services et acc√®s entre eux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit plus d'un processus administratif que technique. </font><font style="vertical-align: inherit;">Parfois, nous avons 200 √† 300 nouvelles versions par semaine, en particulier pendant les promotions et les jours f√©ri√©s. </font><font style="vertical-align: inherit;">Cependant, cela ne concerne qu'une seule √©quipe de nos DevOps. </font><font style="vertical-align: inherit;">Avec autant de versions, il est impossible de voir quel type de ports, IP et int√©gration sont n√©cessaires. </font><font style="vertical-align: inherit;">Par cons√©quent, nous avions besoin de responsables de service sp√©cialement form√©s qui ont interview√© les √©quipes: ¬´Qu'y a-t-il et pourquoi l'avez-vous soulev√©?¬ª </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s tout ce que nous avons lanc√©, l'ing√©nieur r√©seau en 2019 a commenc√© √† ressembler √† ceci.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yv/fx/qi/yvfxqisjbogjxfy6czj0p6xmvuw.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consul</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©cid√© de mettre tout ce que nous avons trouv√© avec l'aide des gestionnaires de services dans Consul et √† partir de l√†, nous √©cririons des r√®gles iptables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment avons-nous d√©cid√© de faire cela?</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous collectons tous les services, r√©seaux et utilisateurs.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faisons des r√®gles iptables bas√©es sur eux.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisez le contr√¥le.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PROFIT.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consul n'est pas une API distante; il peut fonctionner sur tous les n≈ìuds et √©crire sur iptables. </font><font style="vertical-align: inherit;">Il ne reste plus qu'√† trouver des commandes automatiques qui nettoieront l'exc√©dent, et la plupart des probl√®mes seront r√©solus! </font><font style="vertical-align: inherit;">Nous finaliserons le reste dans le processus.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi consul?</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien √©tabli.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En 2014-15, nous l'avons utilis√© comme backend pour Vault, dans lequel nous stockons les mots de passe. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne perd pas de donn√©es</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pendant l'utilisation, Consul n'a pas perdu de donn√©es dans aucun accident. C'est un √©norme avantage pour le syst√®me de gestion de pare-feu. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les communications P2P acc√©l√®rent la propagation du changement</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Avec le P2P, tous les changements arrivent rapidement, pas besoin d'attendre des heures. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API REST pratique.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous avons √©galement consid√©r√© Apache ZooKeeper, mais il ne dispose pas d'une API REST, vous devrez mettre des b√©quilles. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il fonctionne comme un magasin de cl√©s (KV) et comme un r√©pertoire (Service Discovery)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vous pouvez imm√©diatement stocker des services, des catalogues, des centres de donn√©es. C'est pratique non seulement pour nous, mais aussi pour les √©quipes voisines, car lorsque nous construisons un service mondial, nous pensons grand.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcrit en Go, qui fait partie de la pile Wargaming. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous aimons ce langage, nous avons de nombreux d√©veloppeurs Go. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me ACL puissant. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans Consul, vous pouvez utiliser les listes de contr√¥le d'acc√®s pour g√©rer qui et quoi √©crire. </font><font style="vertical-align: inherit;">Nous garantissons que les r√®gles du pare-feu ne chevaucheront rien d'autre et nous n'aurons aucun probl√®me avec cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le consul a ses inconv√©nients.</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'est pas √©volutif dans le centre de donn√©es, si vous ne disposez pas d'une version commerciale. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est mis √† l'√©chelle uniquement par la f√©d√©ration.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tr√®s d√©pendant de la qualit√© du r√©seau et de la charge du serveur. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consul ne fonctionnera pas normalement comme serveur sur un serveur occup√© s'il y a des retards dans le r√©seau, par exemple, une vitesse in√©gale. </font><font style="vertical-align: inherit;">Cela est d√ª aux connexions P2P et aux mod√®les de distribution de mise √† jour.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Difficult√©s avec la surveillance de l'accessibilit√©</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans le statut de consul peut dire que tout va bien, mais il est mort depuis longtemps.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons r√©solu la plupart de ces probl√®mes pendant le fonctionnement du Consul, nous l'avons donc choisi. </font><font style="vertical-align: inherit;">La soci√©t√© a des plans pour un backend alternatif, mais nous avons appris √† g√©rer les probl√®mes et vivons toujours avec Consul.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctionnement du consul</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le centre de donn√©es conditionnel, nous installons des serveurs - de trois √† cinq. </font><font style="vertical-align: inherit;">Un ou deux serveurs ne fonctionneront pas: ils ne pourront pas organiser un quorum et d√©cider qui a raison, qui a tort, lorsque les donn√©es ne correspondent pas. </font><font style="vertical-align: inherit;">Plus de cinq n'a aucun sens, les performances chuteront. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/bb/ms/ljbbms9ipssmvl-pooll-judvgs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les clients se connectent dans n'importe quel ordre aux serveurs: les m√™mes agents, uniquement avec un drapeau </font></font><code>server = false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jx/ku/ub/jxkuubjet3kolzk07yqq0qkak8m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, les clients re√ßoivent une liste de connexions P2P et √©tablissent des connexions entre eux. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/st/ca/owstcacfv-iuaz42vdlyk1cmes8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au niveau mondial, nous interconnectons plusieurs centres de donn√©es. </font><font style="vertical-align: inherit;">Ils connectent √©galement le P2P et communiquent. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gx/5r/s5/gx5rs5yetwzbe63odrgx6ppfnm4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque nous voulons collecter des donn√©es dans un autre centre de donn√©es, la demande va de serveur en serveur. </font><font style="vertical-align: inherit;">Un tel sch√©ma est appel√© </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocole Serf</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le protocole Serf, comme Consul, est d√©velopp√© par HashiCorp.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelques faits importants sur le consul</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le consul poss√®de une documentation d√©crivant son travail. </font><font style="vertical-align: inherit;">Je ne donnerai que des faits s√©lectionn√©s qui valent la peine d'√™tre connus. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les serveurs du consul s√©lectionnent les ma√Ætres parmi les √©lecteurs</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Consul s√©lectionne l'assistant dans la liste des serveurs de chaque centre de donn√©es et toutes les demandes ne lui sont adress√©es, quel que soit le nombre de serveurs. </font><font style="vertical-align: inherit;">Suspendre l'assistant ne conduit pas √† une r√©√©lection. </font><font style="vertical-align: inherit;">Si l'assistant n'est pas s√©lectionn√©, les demandes ne sont trait√©es par personne.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voulez-vous une mise √† l'√©chelle horizontale? </font><font style="vertical-align: inherit;">D√©sol√©, mais non.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une demande adress√©e √† un autre centre de donn√©es passe de ma√Ætre √† ma√Ætre, quel que soit le serveur auquel elle est adress√©e. </font><font style="vertical-align: inherit;">Le ma√Ætre s√©lectionn√© re√ßoit 100% de la charge, √† l'exception de la charge sur les demandes de transfert. </font><font style="vertical-align: inherit;">Tous les serveurs du centre de donn√©es ont une copie √† jour des donn√©es, mais une seule r√©ponse.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seule fa√ßon de mettre √† l'√©chelle est d'activer le mode p√©rim√© sur le client.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En mode p√©rim√©, vous pouvez r√©pondre sans quorum. Il s'agit d'un mode dans lequel nous refusons la coh√©rence des donn√©es, mais nous lisons un peu plus vite que d'habitude et n'importe quel serveur r√©pond. Naturellement, l'enregistrement se fait uniquement via le master. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consul ne copie pas les donn√©es entre les centres de donn√©es</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lors de la collecte de f√©d√©ration, chaque serveur n'aura que ses propres donn√©es. Pour les autres, il se tourne toujours vers quelqu'un d'autre. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'atomicit√© des op√©rations n'est pas garantie en dehors de la transaction</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . N'oubliez pas que non seulement vous pouvez changer quelque chose. Si vous le souhaitez diff√©remment, effectuez une transaction avec un verrou. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les op√©rations de blocage ne garantissent pas le blocage</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La demande va de ma√Ætre √† ma√Ætre, et non directement, il n'y a donc aucune garantie que le verrou fonctionne lorsque vous verrouillez, par exemple, dans un autre centre de donn√©es.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les ACL ne garantissent pas non plus l'acc√®s (dans de nombreux cas)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . L'ACL peut ne pas fonctionner car elle est stock√©e dans un centre de donn√©es de la f√©d√©ration - dans le centre de donn√©es ACL (DC principal). Si le contr√¥leur de domaine ne vous r√©pond pas, l'ACL ne fonctionnera pas. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un assistant en vol stationnaire g√®le toute la f√©d√©ration</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par exemple, dans la f√©d√©ration, il y a 10 centres de donn√©es, et dans l'un il y a un mauvais r√©seau et un ma√Ætre tombe. Tous ceux qui communiquent avec lui sont coinc√©s dans un cercle: une demande est faite, il n'y a pas de r√©ponse, le fil se bloque. Il ne sera pas possible de savoir quand cela se produira, dans une heure ou deux, toute la f√©d√©ration tombera. Vous ne pouvez rien y faire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le statut, le quorum et les √©lections sont trait√©s dans un fil distinct. </font><font style="vertical-align: inherit;">La res√©lection ne se produira pas, le statut ne montrera rien. </font><font style="vertical-align: inherit;">Vous pensez avoir un consul vivant, demandez-vous, et rien ne se passe - il n'y a pas de r√©ponse. </font><font style="vertical-align: inherit;">De plus, le statut montre que tout va bien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©t√© confront√©s √† ce probl√®me, nous avons d√ª reconstruire des parties sp√©cifiques des centres de donn√©es afin de l'√©viter. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La version commerciale de Consul Enterprise ne pr√©sente pas certains des inconv√©nients ci-dessus</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il a de nombreuses fonctions utiles: vote, distribution, mise √† l'√©chelle. </font><font style="vertical-align: inherit;">Il n'y a qu'un ¬´mais¬ª - un syst√®me de licence pour un syst√®me distribu√© co√ªte tr√®s cher. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Life hack: </font></font><code>rm -rf /var/lib/consul</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- un rem√®de contre toutes les maladies de l'agent. </font><font style="vertical-align: inherit;">Si quelque chose ne fonctionne pas pour vous, supprimez simplement vos donn√©es et t√©l√©chargez-les √† partir de la copie. </font><font style="vertical-align: inherit;">Tr√®s probablement, Consul fonctionnera.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befw</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons maintenant de ce que nous avons ajout√© au Consul. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEFW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un acronyme pour </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bed and</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ack </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nd </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the F</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the ire of </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the W</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> all. </font><font style="vertical-align: inherit;">Il √©tait n√©cessaire de nommer le produit d'une mani√®re ou d'une autre lorsque j'ai cr√©√© le r√©f√©rentiel afin d'y mettre les premi√®res validations de test. </font><font style="vertical-align: inherit;">Ce nom reste.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mod√®les de r√®gles</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les r√®gles sont √©crites dans la syntaxe iptables.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-N BEFW</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-P BAISSE D'ENTR√âE</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-A INPUT -m √©tat - √©tat RELATED, ESTABLISHED -j ACCEPT</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-A ENTR√âE -i lo -j ACCEPTER</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-A ENTR√âE -j BEFW</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons tous √† la cha√Æne BEFW, sauf </font></font><code>ESTABLISHED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>RELATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et √† l'h√¥te local. </font><font style="vertical-align: inherit;">Le mod√®le peut √™tre n'importe quoi, ce n'est qu'un exemple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä quoi sert BEFW?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prestations de service</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons un service, il a toujours un port, le n≈ìud sur lequel il fonctionne. </font><font style="vertical-align: inherit;">Depuis notre n≈ìud, nous pouvons demander localement √† l'agent et savoir que nous avons une sorte de service. </font><font style="vertical-align: inherit;">Vous pouvez √©galement mettre des balises. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/lc/7n/fmlc7n4h4rmyqbeemb7lcn6lzco.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout service en cours d'ex√©cution et enregistr√© aupr√®s de Consul devient une r√®gle iptables. </font><font style="vertical-align: inherit;">Nous avons SSH - port ouvert 22. Le script bash est simple: curl et iptables, rien d'autre n'est n√©cessaire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les clients</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment ouvrir l'acc√®s non √† tout le monde, mais de mani√®re s√©lective? </font><font style="vertical-align: inherit;">Par le nom du service, ajoutez des listes IP au r√©f√©rentiel KV. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pg/y4/nu/pgy4nufltcqaimdqv7ncfpntix0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous voulons que tous les membres du dixi√®me r√©seau puissent acc√©der au service SSH_TCP_22. </font><font style="vertical-align: inherit;">Ajouter un petit champ TTL? </font><font style="vertical-align: inherit;">et maintenant nous avons des autorisations temporaires, par exemple, pour une journ√©e.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acc√®s</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connectons les services et les clients: nous avons un service, pour chaque stockage KV est pr√™t. </font><font style="vertical-align: inherit;">Maintenant, nous donnons acc√®s non pas √† tout le monde, mais de mani√®re s√©lective.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f1/yo/vn/f1yovnkwz7qddj1sw267obg3gvk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Groupes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si chaque fois que nous √©crivons des milliers d'adresses IP pour les acc√®s, nous nous fatiguerons. </font><font style="vertical-align: inherit;">Imaginons des regroupements - un sous-ensemble distinct en KV. </font><font style="vertical-align: inherit;">Nous l'appellerons Alias ‚Äã‚Äã(ou groupes) et nous y stockerons des groupes selon le m√™me principe. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/un/um/vzunum6qz9s9fs8odlwiwlz6vsc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connect: maintenant, nous pouvons ouvrir SSH non pas sp√©cifiquement sur P2P, mais sur un groupe entier ou plusieurs groupes. </font><font style="vertical-align: inherit;">De m√™me, il existe TTL - vous pouvez ajouter au groupe et supprimer temporairement du groupe.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ao/2w/as/ao2was0eioehjrwnn1ypgh4zj5w.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'int√©gration</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre probl√®me est le facteur humain et l'automatisation. Jusqu'√† pr√©sent, nous l'avons r√©solu comme √ßa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8g/pv/j0/8gpvj0liyxy64mamjpwr8nbn4xc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous travaillons avec Puppet et y transf√©rons tout ce qui concerne le syst√®me (code d'application). Puppetdb (PostgreSQL standard) stocke une liste de services qui y sont ex√©cut√©s, vous pouvez les trouver par type de ressource. Vous pouvez y trouver qui va o√π. Nous avons √©galement un syst√®me de demande d'extraction et de fusion pour cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons √©crit befw-sync, la solution la plus simple qui facilite le transfert de donn√©es. Tout d'abord, les cookies de synchronisation vont √† puppetdb. L'API HTTP y est configur√©e: nous demandons quels services nous avons, ce qui doit √™tre fait. Ensuite, ils font une demande au consul.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y a-t-il int√©gration? </font><font style="vertical-align: inherit;">Oui: ils ont √©crit les r√®gles, autoris√©s √† accepter la Pull Request. </font><font style="vertical-align: inherit;">Besoin d'un port ou ajouter un h√¥te √† un groupe? </font><font style="vertical-align: inherit;">Pull Request, review - no more "Trouvez 200 autres ACL et essayez de faire quelque chose."</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimisation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le ping localhost avec une cha√Æne de r√®gles vide prend 0,075 ms. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_j/6p/ce/_j6pceeghhejvrabuazobzgbfmw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez 10 000 iptables √† cette cha√Æne. </font><font style="vertical-align: inherit;">En cons√©quence, le ping augmentera de 5 fois: iptables est compl√®tement lin√©aire, le traitement de chaque adresse prend un certain temps. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/er/v9/ic/erv9ic34w6oqhoy7aekpfimpys4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le pare-feu, dans lequel nous migrons des milliers d'ACL, nous avons de nombreuses r√®gles, ce qui introduit un retard. </font><font style="vertical-align: inherit;">Pour les protocoles de jeu, c'est mauvais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais si nous mettons </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 000 adresses en ipset, le</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ping diminuera m√™me. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_l/zb/qs/_lzbqsckkctv-01v3vu-irjhvcq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est que le ¬´O¬ª (complexit√© de l'algorithme) pour l'ipset est toujours 1, quel que soit le nombre de r√®gles. </font><font style="vertical-align: inherit;">Certes, il y a une limitation - il ne peut pas y avoir plus de 65535 r√®gles. Pour l'instant, nous vivons avec ceci: vous pouvez les combiner, les d√©velopper, cr√©er deux ipsets en un.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espace de rangement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La suite logique du processus d'it√©ration est le stockage des informations client pour le service dans l'ipset. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x0/up/dv/x0updv72n35faryycb_ntjmpqik.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant le m√™me SSH, et nous n'√©crivons pas imm√©diatement 100 IP, mais nous d√©finissons le nom de l'ipset avec lequel communiquer et la r√®gle suivante </font></font><code>DROP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez refaire la r√®gle ¬´Qui n'est pas ici, c'est DROP¬ª, mais plus clairement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous avons des r√®gles et des ensembles. </font><font style="vertical-align: inherit;">La t√¢che principale consiste √† cr√©er un ensemble avant d'√©crire la r√®gle, car sinon iptables n'√©crira pas la r√®gle.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sch√©ma g√©n√©ral</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous la forme d'un diagramme, tout ce que j'ai dit ressemble √† ceci. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9w/qa/i-/9wqai-52aq3i3onq1dovwbfzpfc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Engagez-vous √† Puppet, tout est envoy√© √† l'h√¥te, les services sont ici, l'ipset est l√†, et celui qui n'est pas enregistr√© l√†-bas n'est pas autoris√©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autoriser et refuser</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour sauver rapidement le monde ou d√©sactiver rapidement quelqu'un, au d√©but de toutes les cha√Ænes, nous avons cr√©√© deux ipsets: </font></font><code>rules_allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>rules_deny</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Comment √ßa fonctionne? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, quelqu'un avec des robots cr√©e une charge sur notre site Web. </font><font style="vertical-align: inherit;">Auparavant, il √©tait n√©cessaire de trouver son adresse IP dans les journaux, de la r√©f√©rer aux ing√©nieurs r√©seau afin qu'ils puissent trouver la source du trafic et l'interdire. </font><font style="vertical-align: inherit;">Maintenant, √ßa a l'air diff√©rent. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/a6/so/xq/a6soxqdkwf8qokucl-ztjs6xdde.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous exp√©dions au consul, attendez 2,5 s et vous avez termin√©. </font><font style="vertical-align: inherit;">√âtant donn√© que Consul distribue rapidement via le P2P, il fonctionne partout, partout dans le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois que j'ai en quelque sorte compl√®tement arr√™t√© WOT, j'ai fait une erreur avec le pare-feu. </font></font><code>rules_allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Ceci est notre assurance contre de tels cas. </font><font style="vertical-align: inherit;">Si nous avons fait une erreur avec le pare-feu quelque part, quelque chose est bloqu√© quelque part, nous pouvons toujours envoyer un conditionnel </font></font><code>0.0/0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour tout lever rapidement. </font><font style="vertical-align: inherit;">Ensuite, nous allons tout r√©parer avec nos mains.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autres ensembles</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez ajouter d'autres ensembles dans l'espace </font></font><code>$IPSETS$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/md/hv/jf/mdhvjfb8t36heje-udbnw5fly0m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi? </font><font style="vertical-align: inherit;">Parfois, quelqu'un a besoin d'un ipset, par exemple, pour √©muler la d√©connexion d'une partie du cluster. </font><font style="vertical-align: inherit;">Tout le monde peut apporter des sets, les appeler et ils seront pris au Consul. </font><font style="vertical-align: inherit;">En m√™me temps, les ensembles peuvent √† la fois participer aux r√®gles iptables et √™tre comme une √©quipe </font></font><code>NOOP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: la coh√©rence sera prise en charge par le d√©mon.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisateurs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auparavant, c'√©tait comme √ßa: un utilisateur connect√© √† un r√©seau et re√ßu des param√®tres via un domaine. </font><font style="vertical-align: inherit;">Jusqu'√† la prochaine g√©n√©ration de pare-feu, Cisco n'√©tait pas en mesure de comprendre o√π se trouve l'utilisateur et o√π se trouve l'IP. </font><font style="vertical-align: inherit;">Par cons√©quent, l'acc√®s a √©t√© accord√© uniquement via des machines de nom d'h√¥te. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'avons-nous fait? </font><font style="vertical-align: inherit;">Coinc√© au moment de la r√©ception de l'adresse. </font><font style="vertical-align: inherit;">Il s'agit g√©n√©ralement de dot1x, Wi-Fi ou VPN - tout passe par RADIUS. </font><font style="vertical-align: inherit;">Pour chaque utilisateur, cr√©ez un groupe par nom d'utilisateur et mettez-y une IP avec TTL, qui est √©gale √† son dhcp.lease - d√®s son expiration, la r√®gle dispara√Ætra. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/ps/ad/tfpsad3jh-egdfn_uehr3yvmcao.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous pouvons ouvrir l'acc√®s aux services, ainsi qu'√† d'autres groupes, par nom d'utilisateur. </font><font style="vertical-align: inherit;">Nous nous sommes d√©barrass√©s de la douleur du nom d'h√¥te lors de leur changement et avons supprim√© la charge des ing√©nieurs r√©seau car ils n'avaient plus besoin de Cisco. </font><font style="vertical-align: inherit;">D√©sormais, les ing√©nieurs eux-m√™mes prescrivent l'acc√®s √† leurs serveurs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isolation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En parall√®le, nous avons commenc√© √† d√©monter l'isolation. </font><font style="vertical-align: inherit;">Les responsables de service ont fait un inventaire et nous avons analys√© tous nos r√©seaux. </font><font style="vertical-align: inherit;">Nous les d√©composons dans les m√™mes groupes, et sur les serveurs n√©cessaires les groupes ont √©t√© ajout√©s, par exemple, √† refuser. </font><font style="vertical-align: inherit;">D√©sormais, le m√™me isolement interm√©diaire entre dans les r√®gles de la production, mais pas dans la production elle-m√™me. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/9g/ed/fd9gedlbs2_9gyyg-5lwm_fp75m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sch√©ma fonctionne rapidement et simplement: supprimez toutes les ACL des serveurs, d√©chargez le mat√©riel, r√©duisez le nombre de VLAN isol√©s.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contr√¥le d'int√©grit√©</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auparavant, un d√©clencheur sp√©cial fonctionnait pour nous, qui nous informait lorsque quelqu'un changeait la r√®gle de pare-feu avec ses mains. </font><font style="vertical-align: inherit;">J'ai √©crit un √©norme v√©rificateur de r√®gles de pare-feu, c'√©tait difficile. </font><font style="vertical-align: inherit;">D√©sormais, l'int√©grit√© contr√¥le BEFW. </font><font style="vertical-align: inherit;">Il s'assure avec z√®le que les r√®gles qu'il √©tablit ne changent pas. </font><font style="vertical-align: inherit;">Si quelqu'un change les r√®gles du pare-feu, il retournera tout. </font><font style="vertical-align: inherit;">¬´J'ai rapidement lev√© une procuration ici pour travailler √† domicile¬ª - il n'y a plus de telles options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEFW contr√¥le l'ipset √† partir des services et de la liste dans befw.conf, les r√®gles de service dans la cha√Æne BEFW. </font><font style="vertical-align: inherit;">Mais ne suit pas d'autres cha√Ænes et r√®gles et autres ipsets.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protection contre les accidents</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEFW enregistre toujours le dernier √©tat r√©ussi directement dans la structure binaire de state.bin. En cas de probl√®me, il revient toujours √† cet √©tat.bin. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2z/fe/ru/2zferuy2qiohwpa6odt1s0d642g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit de l'assurance instable du Consul lorsqu'il n'a pas envoy√© de donn√©es ou que quelqu'un a fait une erreur et a utilis√© des r√®gles qui n'ont pas pu √™tre appliqu√©es. Pour ne pas nous retrouver sans pare-feu, BEFW reviendra au dernier √©tat si une erreur se produit √† un moment donn√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les situations critiques, c'est la garantie que nous resterons avec un pare-feu fonctionnel. Nous ouvrons tous les r√©seaux gris dans l'espoir que l'administrateur viendra le r√©parer. Un jour, je le retirerai dans les configs, mais maintenant nous n'avons que trois r√©seaux gris: 10/8, 172/12 et 192.168 / 16. En tant que membre de notre Consul, c'est une caract√©ristique importante qui aide √† se d√©velopper davantage.</font></font><br>
<br>
<em>:      -  BEFW.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> GitHub</a>.</em><br>
<br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais vous parler des bugs rencontr√©s. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ipset add set 0.0.0.0/0.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Que se passe-t-il si vous ajoutez √† l'ipset 0.0.0.0/0? Toutes les adresses IP seront-elles ajout√©es? L'acc√®s √† Internet sera-t-il ouvert? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non, nous obtenons un bug qui nous a co√ªt√© deux heures d'indisponibilit√©. De plus, le bug ne fonctionne plus depuis 2016, il se trouve dans RedHat Bugzilla sous le num√©ro # 1297092, mais nous l'avons trouv√© par accident - d'apr√®s le rapport du d√©veloppeur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, BEFW a une r√®gle stricte, qui </font></font><code>0.0.0.0/0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se transforme en deux adresses: </font></font><code>0.0.0.0/1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>128.0.0.0/1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ipset restore set &lt;fichier.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Que fait l'ipset lorsque vous le dites </font></font><code>restore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Pensez-vous que cela fonctionne exactement comme iptables? R√©cup√©rer des donn√©es? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rien de tel - il fait une fusion, et les anciennes adresses ne disparaissent pas, vous ne fermez pas l'acc√®s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons trouv√© un bogue lorsque nous avons test√© l'isolement. Maintenant, il y a un syst√®me assez compliqu√© - au lieu d'√™tre </font></font><code>restore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ex√©cut√© </font></font><code>create temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors </font></font><code>restore flush temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>restore temp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. √Ä la fin du swap: pour l'atomicit√©, car si vous effectuez d'abord </font></font><code>flush</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et √† ce moment un paquet arrive, il sera jet√© et quelque chose ira mal. Il y a donc un peu de magie noire. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consul kv get -datacenter = autre.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comme je l'ai dit, nous pensons que nous demandons des donn√©es, mais nous obtiendrons soit des donn√©es, soit une erreur. Nous pouvons le faire par le biais du consul localement, mais dans ce cas, l'un et l'autre se bloqueront. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le client Consul local est un wrapper sur l'API HTTP. Mais il se bloque et ne r√©pond ni √† Ctrl + C, ni √† Ctrl + Z, quoi qu'il arrive, seulement</font></font><code>kill -9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la console adjacente. </font><font style="vertical-align: inherit;">Nous sommes tomb√©s sur cela lorsque nous construisions un grand cluster. </font><font style="vertical-align: inherit;">Mais nous n'avons toujours pas de solution, nous nous pr√©parons √† corriger cette erreur dans Consul. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le chef du consul ne r√©pond pas. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notre ma√Ætre dans le centre de donn√©es ne r√©pond pas, nous pensons: "Probablement, l'algorithme de re-s√©lection fonctionnera maintenant?" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Non, cela ne fonctionnera pas, et le suivi ne montrera rien: le consul dira qu'il y a un indice d'engagement, un leader a √©t√© trouv√©, tout va bien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment combattons-nous cela? </font></font><code>service consul restart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en cron toutes les heures. </font><font style="vertical-align: inherit;">Si vous avez 50 serveurs - ce n'est pas grave. </font><font style="vertical-align: inherit;">Quand il y en aura 16 000, vous comprendrez comment cela fonctionne.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, nous avons obtenu les avantages suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couverture √† 100% de toutes les machines Linux.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La vitesse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lib√©r√© l'esclavage des ing√©nieurs du fer et des r√©seaux</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe des possibilit√©s d'int√©gration presque infinies: m√™me avec Kubernetes, m√™me avec Ansible, m√™me avec Python.</font></font></li>
</ul><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inconv√©nients</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Consul, avec qui nous vivons maintenant, et un prix d'erreur tr√®s √©lev√©. </font><font style="vertical-align: inherit;">√Ä titre d'exemple, une fois √† 18 heures (heures de grande √©coute en Russie), j'ai statu√© quelque chose sur les listes de r√©seaux. </font><font style="vertical-align: inherit;">Nous construisions l'isolation au BEFW √† ce moment-l√†. </font><font style="vertical-align: inherit;">Je me suis tromp√© quelque part, semble-t-il, j'ai indiqu√© le mauvais masque, mais tout est tomb√© en deux secondes. </font><font style="vertical-align: inherit;">La surveillance s'allume, l'officier de garde entre: ¬´Tout nous appartient!¬ª </font><font style="vertical-align: inherit;">Le chef du d√©partement est devenu gris quand il a expliqu√© √† l'entreprise pourquoi cela s'√©tait produit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le prix de l'erreur est si √©lev√© que nous avons trouv√© notre propre proc√©dure compliqu√©e de prophylaxie. </font><font style="vertical-align: inherit;">Si vous l'impl√©mentez sur une grande production, vous n'avez pas besoin de donner un jeton ma√Ætre sur Consul √† tout le monde. </font><font style="vertical-align: inherit;">√áa va mal finir. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Co√ªt.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai √©crit le code pendant 400 heures seulement. </font><font style="vertical-align: inherit;">Pour soutenir mon √©quipe de 4 personnes passe 10 heures par mois. </font><font style="vertical-align: inherit;">Compar√© au prix de tout pare-feu nouvelle g√©n√©ration, il est gratuit. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des plans. </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le plan √† long terme est la recherche de transports alternatifs en √©change ou en compl√©ment du Consul. </font><font style="vertical-align: inherit;">Ce sera peut-√™tre Kafka ou quelque chose comme √ßa. </font><font style="vertical-align: inherit;">Mais dans les ann√©es √† venir, nous vivrons sur Consul. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plans imm√©diats: int√©gration avec Fail2ban, avec surveillance, avec nftables, √©ventuellement avec d'autres distributions, m√©triques, surveillance avanc√©e, optimisation. </font><font style="vertical-align: inherit;">Le support de Kubernetes est √©galement quelque part dans les plans, car en ce moment nous avons plusieurs clusters et d√©sir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre des plans:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rechercher des anomalies de trafic;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gestion de la carte du r√©seau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise en charge de Kubernetes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assemblage de packages pour tous les syst√®mes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interface Web</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous travaillons constamment sur l'extension de la configuration, l'augmentation des m√©triques et l'optimisation. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rejoignez le projet. </font><font style="vertical-align: inherit;">Le projet s'est av√©r√© √™tre cool, mais, malheureusement, il s'agit toujours d'un projet d'une seule personne. </font><font style="vertical-align: inherit;">Venez sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et essayez de faire quelque chose: engager, tester, offrir quelque chose, donner votre √©valuation.</font></font></i><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En attendant, nous nous pr√©parons pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saint HighLoad ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui se tiendra les 6 et 7 avril √† Saint-P√©tersbourg, et nous invitons les d√©veloppeurs de syst√®mes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√†</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> forte charge </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">√† demander un rapport</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Conf√©renciers exp√©riment√©s savent d√©j√† quoi faire, et nous recommandons que les </font><font style="vertical-align: inherit;">nouveaux arrivants √† des </font><font style="vertical-align: inherit;">discours au moins </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">essayer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Participer √† la conf√©rence en tant qu'orateur pr√©sente plusieurs avantages. </font><font style="vertical-align: inherit;">Lequel, vous pouvez lire, par exemple, √† la fin de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cet article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr486822/index.html">[Par les quais] Flutter. Partie 4. Pour les d√©veloppeurs Web</a></li>
<li><a href="../fr486824/index.html">Mauvais conseils lorsque vous travaillez avec ANTLR</a></li>
<li><a href="../fr486826/index.html">Cr√©ation d'un Viberbot √† part enti√®re sur Django 2 et l'API Viber REST. Premi√®re partie - Webhook</a></li>
<li><a href="../fr486828/index.html">Food Design Digest, janvier 2020</a></li>
<li><a href="../fr486832/index.html">Combien d'ann√©es vont la ta√Øga - ne comprends pas</a></li>
<li><a href="../fr486844/index.html">L'√©volution du traitement des webhooks Facebook: de z√©ro √† 25 000 par seconde</a></li>
<li><a href="../fr486850/index.html">Nouveau si√®ge r√©serv√© - comme un h√¥tel capsule</a></li>
<li><a href="../fr486858/index.html">Cr√©ation d'un Viberbot √† part enti√®re. Deuxi√®me partie - premier contact ou "conversion_started"</a></li>
<li><a href="../fr486860/index.html">ATX12VO - Manger d'une nouvelle fa√ßon</a></li>
<li><a href="../fr486862/index.html">5 raisons pour lesquelles le Motion Design vous aide √† vous connecter avec les gens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>