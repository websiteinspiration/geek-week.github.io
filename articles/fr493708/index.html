<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôéüèª üëêüèº üòñ Anatomie de ma grappe Kubernetes maison üå∂Ô∏è ü¶ñ ü•õ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a un an, j'ai r√©alis√© que je voulais cr√©er mon propre cluster Kubernetes. Je suis d√©veloppeur de logiciels. Habituellement, j'utilise soit un clu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Anatomie de ma grappe Kubernetes maison</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/493708/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a un an, j'ai r√©alis√© que je voulais cr√©er mon propre cluster Kubernetes. Je suis d√©veloppeur de logiciels. Habituellement, j'utilise soit un cluster local √† n≈ìud unique, soit un cluster distant √† n≈ìuds multiples pour tester mes projets. Lorsque je travaille avec un cluster √† n≈ìud unique, je compte g√©n√©ralement sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minikube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bien qu'il existe d'autres solutions, comme le projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peuvent √©muler la pr√©sence de plusieurs n≈ìuds dans un cluster. La prise en charge de plusieurs n≈ìuds </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut appara√Ætre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans Minikube.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, je voudrais avoir √† ma disposition les capacit√©s des deux environnements ci-dessus. Autrement dit, pour que j'aie un cluster compos√© de plusieurs n≈ìuds, et pour que travailler avec ces clusters n'implique pas de retards r√©seau typiques pour interagir avec des environnements distants. </font><font style="vertical-align: inherit;">
De nombreux didacticiels ont d√©j√† √©t√© √©crits sur la cr√©ation de clusters multi-n≈ìuds Kubernetes √† l'aide d' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">ordinateurs √† carte unique</font></a><font style="vertical-align: inherit;"> . Beaucoup de ces manuels utilisent le Raspberry Pi comme SBC. Voyant cela, j'ai d√©cid√© de suivre la voie de la moindre r√©sistance et j'ai √©galement choisi cet ordinateur. La plate-forme Raspberry Pi s'est impos√©e comme une solution peu co√ªteuse et abordable.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/il/ui/ts/iluits7z2ihfycqlskr35gzsstg.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est √† noter que le choix de cette plateforme pr√©voit certains compromis. </font><font style="vertical-align: inherit;">Par exemple, Broadcom et la Fondation Raspberry Pi n'ont pas accord√© de licence pour les extensions cryptographiques ARMv8 (cela est n√©cessaire pour l'acc√©l√©ration mat√©rielle de la prise en charge AES). </font><font style="vertical-align: inherit;">Une autre solution controvers√©e est l'utilisation de cartes microSD sous la forme d'un support de stockage standard √† partir duquel le syst√®me d'exploitation est charg√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En analysant les directives existantes pour la cr√©ation de clusters sur des ordinateurs √† carte unique, je n'en ai trouv√© aucun d√©crivant une solution qui r√©ponde √† mes besoins. </font><font style="vertical-align: inherit;">Je vais commencer l'histoire du cluster que j'ai cr√©√© avec eux.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exigences</font></font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le cluster doit √™tre enferm√© dans un bo√Ætier s√©par√©, qui peut √™tre facilement d√©plac√©, ouvert et entretenu, en travaillant avec des modules s√©par√©s du syst√®me;</font></font></li>
<li>            ,         .         ,        ,        .   ,      .   ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>.</li>
<li>       ,      .</li>
<li>      , ,  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Derri√®re ces exigences, il y a un objectif non √©vident, c'est que j'avais besoin de ma fille de quatre ans pour travailler avec le cluster. </font><font style="vertical-align: inherit;">J'esp√®re qu'il deviendra pour elle une sorte de guide d'√©tude qui l'aidera √† se familiariser avec les ordinateurs, les shells de commande et les terminaux.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accessoires</font></font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©tail</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La source</font></font></b></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kit de d√©marrage Pico 5 Raspberry PI 5S</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">picocluster.com</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordinateurs √† carte unique: 2 Raspberry Pi 4B (4 Go) 3 Raspberry Pi 3B +</font></font></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 cartes microSD 32 Go classe 10 / A1&nbsp;</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raspberrypi.org</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√¢bles Ethernet: 2 0,25 m cat. 83 0,15 m cat. 7, S / FTP</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1attack.de</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√¢bles USB PortaPow 20AWG2 C√¢ble USB-C3 c√¢ble micro-USB</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">portablepowersupplies.co.uk</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âcran tactile officiel Raspberry Pi 7 ‚Ä≥</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raspberrypi.org</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alimentation Dehner Elektronik STD-12090 12V / DC 9A 108W</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dehner.net</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertisseur DC-Buck 12V √† 5V 15A</font></font></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">droking.com</font></font></a></td>
</tr>
<tr>
<td> Heschen 12V 25A SPST 2-Pin ON/OFF</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">heschen.com</a></td>
</tr>
<tr>
<td> Noctua NF-A4x20 5V PWM</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">noctua.at</a></td>
</tr>
<tr>
<td>  , (15A, 30V)  4 ,    MOSFET PSMN011-30YLC</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ebay.com</a></td>
</tr>
<tr>
<td>2  M.2 NVMe  USB 3.0,   JMS58</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">amazon.com</a></td>
</tr>
<tr>
<td>2  Samsung SSD 970 EVO Plus M.2 PCIe NVMe 500 Go</td>
<td></td>
</tr>
<tr>
<td>2   USB 3.0 (  ,  )  6‚Ä≥/152mm</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">usbfirewire.com</a></td>
</tr>
<tr>
<td>2  USB 3.0- Delock, Male-Female ( 270¬∞)</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">delock.com</a></td>
</tr>
<tr>
<td>  Adafruit  Raspberry Pi 24‚Ä≥/610mm</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">adafruit.com</a></td>
</tr>
<tr>
<td>  Adafruit (DSI  CSI)  Raspberry Pi&nbsp;</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">adafruit.com</a></td>
</tr>
<tr>
<td>  Wago  221</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wago.com</a></td>
</tr>
<tr>
<td>  Lapp Unitronic 300mm/1200mm 2x0.14mm¬≤</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lappgroup.com</a></td>
</tr>
<tr>
<td> Lemo FGG.0B.302.CLAD42  EGG.0B.302.CLL</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lemo.com</a></td>
</tr>
<tr>
<td>     DuPont Female-Female</td>
<td></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bo√Ætier PicoCluster est de petite taille et tr√®s facile √† utiliser. Dans le kit de d√©marrage que j'ai command√©, j'ai utilis√© uniquement le ch√¢ssis, y compris les loquets et les racks, ainsi que le commutateur Gigabit Ethernet √† 8 ports. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je comprends qu'il serait pr√©f√©rable que PicoCluster vende une version de son kit sans aucun composant √©lectrique. Une autre alternative √† ce kit a √©t√© le d√©veloppement de son propre bo√Ætier. Cela n√©cessiterait cependant plus de temps. Il faudrait que je cr√©e des dessins vectoriels, je devrais avoir recours aux services de d√©coupe laser dans une entreprise proposant des feuilles acryliques, id√©alement des feuilles avec un rev√™tement qui dissipe les d√©charges √©lectrostatiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours du travail, je suis tomb√© sur des avertissements concernant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une tension insuffisante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et a d√©couvert que le probl√®me √©tait d√ª aux c√¢bles micro-USB fournis avec le bo√Ætier. De plus, avec le bo√Ætier, il y avait un convertisseur abaisseur DC-DC 12V √† 5V, 30W, que j'ai remplac√© par un plus puissant. Je l'ai fait pour des raisons que j'examinerai ci-dessous dans la section sur l'alimentation du syst√®me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment o√π j'ai commenc√© √† travailler sur ce projet, je n'avais pas pr√©vu d'utiliser les cartes Raspberry Pi 4 sorties en 2019. Cela explique que j'ai encore trois cartes Raspberry Pi 3 qui agissent comme des n≈ìuds de travail. J'ai √©chang√© deux autres cartes de ce type contre Raspberry Pi 4. Elles sont utilis√©es pour les n≈ìuds qui ont besoin de plus de ressources. Il s'agit du n≈ìud principal et du n≈ìud de travail, qui, entre autres, est utilis√© pour cr√©er des sauvegardes de donn√©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peu de temps apr√®s la sortie du Raspberry Pi 4, PicoCluster a lanc√© un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nouveau ch√¢ssis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sp√©cialement con√ßu pour ces cartes. Il comprend une alimentation puissante, deux ventilateurs et un interrupteur d'alimentation. Certes, ce bo√Ætier est plus grand que le mien, et les fans se r√©v√©leront certainement plus bruyants que le Noctua NF-A4x20. La vitesse de rotation de ce ventilateur peut √™tre contr√¥l√©e √† l'aide de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modulation de largeur d'impulsion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (PWM), en tenant compte des r√©sultats des mesures de temp√©rature effectu√©es sur les cartes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter que le SoC Broadcom BCM2837 (Raspberry Pi 3) et le SoC BCM2711 (Raspberry Pi 4) ont des temporisateurs mat√©riels capables de g√©n√©rer des signaux PWM. En cons√©quence, il est tr√®s simple d'√©mettre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des signaux d'entr√©e de commande</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attendu par Noctua NF-A4x20 PWM sans surcharger le processeur. </font><font style="vertical-align: inherit;">De plus, le ventilateur est √† peine audible lorsqu'il fonctionne √† la moiti√© de la vitesse qu'il prend en charge (environ 2500 tr / min). </font><font style="vertical-align: inherit;">Cela s'est av√©r√© suffisant pour maintenir la temp√©rature du syst√®me en dessous de 45 ¬∞ C / 113 ¬∞ F sous une charge normale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nouveau bo√Ætier comprend une alimentation √©lectrique int√©gr√©e. </font><font style="vertical-align: inherit;">De plus, il est plus cher que celui que j'ai choisi. </font><font style="vertical-align: inherit;">Toutes ces caract√©ristiques de cet √©tui sont la raison pour laquelle je choisirais le kit Pico 5S m√™me si j'ai achet√© l'√©tui maintenant. </font><font style="vertical-align: inherit;">Il faudrait faire plus d'efforts pour y penser, mais ce qui s'est finalement av√©r√© me semble meilleur que ce qui se serait pass√© si j'avais choisi un autre b√¢timent. </font><font style="vertical-align: inherit;">En g√©n√©ral, cela en vaut la peine et le temps.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembl√©e</font></font></font></h2><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Panneau avant</font></font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c4c/69a/bae/c4c69abaec8489276a0ae015fcc88f93.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneau</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
avant Le</font><i><font color="#999999"><font style="vertical-align: inherit;"> panneau</font></font></i><font style="vertical-align: inherit;"> avant a une ouverture pour acc√©der aux cartes microSD. C'est pratique, m√™me si je pr√©vois d'organiser le d√©marrage du syst√®me √† l'aide du</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©marrage de stockage de masse USB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Je pr√©vois de le faire juste apr√®s que le Raspberry Pi 4 supporte pleinement ce mode de d√©marrage. Le trou permet √©galement d'organiser la circulation de l'air dans le bo√Ætier. Dans ce cas, deux disques SSD sont situ√©s directement en face du ventilateur, ce qui permet de maintenir leur temp√©rature de fonctionnement optimale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les indicateurs d'activit√© et de puissance des cartes sont clairement visibles, ce qui vous permet d'√©valuer l'√©tat du cluster en un coup d'≈ìil. Les indicateurs d'activit√© du commutateur Ethernet sont √©galement visibles.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ada/9df/3c3/ada9df3c359aa12ccfe557460738e672.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le panneau sup√©rieur du bo√Ætier sans √©cran L'</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√©cran peut √™tre facilement d√©plac√© pour le rapprocher du clavier ou pour donner acc√®s au panneau sup√©rieur lors de l'ouverture du bo√Ætier.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Panneau gauche</font></font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/0af/849/bb50af8494c2c3a3df84832943addf92.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneau gauche</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sur le panneau gauche du bo√Ætier se trouvent les ports GPIO des cartes. </font><font style="vertical-align: inherit;">L'un des c√¢bles relie l'unit√© principale au ventilateur - pour l'organisation du contr√¥le PWM de sa vitesse de rotation. </font><font style="vertical-align: inherit;">Un autre c√¢ble relie le n≈ìud principal au module de carte de circuit imprim√©, qui est utilis√© pour activer et d√©sactiver les n≈ìuds de travail. </font><font style="vertical-align: inherit;">Quatre c√¢bles relient chacun des n≈ìuds de travail au n≈ìud principal. </font><font style="vertical-align: inherit;">Il utilise des broches GPIO avec un niveau actif √©lev√© lorsqu'il est d√©sactiv√©. </font><font style="vertical-align: inherit;">Cela permet au n≈ìud principal de couper l'alimentation du n≈ìud de travail en toute s√©curit√© une fois la s√©quence d'actions ex√©cut√©e √† la fin de son fonctionnement.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/157/16e/984/15716e984e6204e35758d85c63fa87db.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le module utilis√© pour connecter le ventilateur au n≈ìud principal</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dans le coin sup√©rieur gauche se trouve un petit module con√ßu pour connecter le connecteur du ventilateur Noctua √† 4 broches au n≈ìud principal du Raspberry Pi. </font><font style="vertical-align: inherit;">Le connecteur GPIO correspondant, gr√¢ce au support mat√©riel pour la g√©n√©ration de signaux PWM, est configur√© pour contr√¥ler la vitesse du ventilateur. </font><font style="vertical-align: inherit;">La vitesse est choisie en fonction de l'analyse de la temp√©rature des planches, dont les informations sont r√©guli√®rement collect√©es √† l'aide de SSH. </font><font style="vertical-align: inherit;">L'unit√© principale, en outre, √† des fins de surveillance, lit la vitesse du ventilateur.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç panneau arri√®re</font></font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ad/7ab/516/9ad7ab516db66c36391208b50f254db0.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneau</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
arri√®re Le panneau arri√®re du ch√¢ssis cache les c√¢bles. Le fait que tout ressemble √† cela peut √™tre consid√©r√© comme la cons√©quence d'une approche astucieuse de l'organisation modulaire de mon projet. Il √©tait difficile de trouver des c√¢bles de qualit√©. Surtout - des c√¢bles USB 3.0 courts avec des fiches incurv√©es. C√¢bles - c'est le plus grand groupe d'√©l√©ments mobiles dans mon syst√®me, ils doivent r√©pondre √† certaines caract√©ristiques m√©caniques et √©lectriques. Ils se sont av√©r√©s √™tre la principale source de probl√®mes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai eu l'id√©e d'utiliser un seul c√¢ble en spirale afin de le remplacer par un c√¢ble √† bande DSI, avec lequel un √©cran est connect√© au syst√®me. Ensuite, le c√¢ble en spirale relierait l'√©cran au cluster et lui fournirait de l'√©nergie. Mais je n'ai pas pu trouver de connecteur DSI appropri√©. Je me suis abstenu de cette aventure et du fait que je n'√©tais pas attir√© par la perspective de souder 17 fils de 0,14 mm¬≤. J'ai utilis√© une rallonge de c√¢ble DSI et appliqu√© un c√¢ble d'alimentation micro-USB en spirale √† 2 fils. Cela m'a donn√© la possibilit√© de d√©placer et d'√©teindre facilement l'√©cran sans ouvrir le bo√Ætier.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b04/a96/1a4/b04a961a4401c18d4a44864fb11ecde8.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentative infructueuse de disposition des c√¢bles</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Voici une tentative infructueuse d'utiliser le syst√®me pour organiser l'entr√©e des c√¢bles dans le bo√Ætier con√ßu pour les c√¢bles d'extension USB 3.0. </font><font style="vertical-align: inherit;">Malgr√© d'innombrables tentatives pour acheminer correctement les c√¢bles, j'ai syst√©matiquement rencontr√© des erreurs d'E / S lors des transferts de donn√©es. </font><font style="vertical-align: inherit;">Ils √©taient probablement caus√©s par le fait qu'ils √©taient trop √©tir√©s lors de la pose des c√¢bles, ou par le fait que cela compromettait la connexion fiable des c√¢bles aux connecteurs.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Panneau droit</font></font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/136/038/7ab/1360387abdbf37fa749782ec3df5b8ca.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneau droit</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sur le c√¥t√© droit du bo√Ætier, vous pouvez voir le commutateur Ethernet √† 8 ports.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conception du syst√®me</font></font></font></h2><br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Nourriture</font></font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eed/93b/b85/eed93bb85e71ca00a19f343d39fd706c.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bo√Ætier avec panneau avant ouvert,</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
j'ai d√ª d√©cider quelle alimentation utiliser. </font><font style="vertical-align: inherit;">En particulier, quelle puissance en watts il doit prendre en charge pour r√©pondre aux besoins du cluster. </font><font style="vertical-align: inherit;">C'est un peu une question sur ce qui a pr√©c√©d√© - un poulet ou un ≈ìuf, car les mesures ne peuvent pas √™tre faites avant que l'alimentation soit appliqu√©e √† la grappe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin d'obtenir une estimation approximative de la puissance, je me suis tourn√© vers la</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> documentation officielle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui contient des informations sur la puissance du Raspberry Pi, ainsi que les sp√©cifications des autres composants. </font><font style="vertical-align: inherit;">Cela m'a donn√© les chiffres approximatifs suivants bas√©s sur la consommation d'√©nergie moyenne.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fa/097/c9b/8fa097c9b1f40c9003bcf75b31d6c672.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais que s'est-il pass√© apr√®s avoir pris en compte les valeurs maximales de consommation d'√©nergie de la documentation.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cec/3fc/424/cec3fc4241a30a788ff793edbf27cc86.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'√©tait beaucoup plus √©lev√© que la puissance fournie par ces alimentations que je pouvais trouver qui produisaient 5V, car les composants "basse puissance" avaient besoin d'un courant de 10A. Cela a exclu la possibilit√© d'utiliser une seule alimentation 5V. Dans le m√™me temps, les alimentations 12V sont tr√®s courantes, ce qui peut fournir le niveau d'alimentation n√©cessaire. Par cons√©quent, je choisi l'alimentation Elektronik Dehner STD-12090 12V / DC 9A 108W et connect√©e √† un </font><font style="vertical-align: inherit;">12 V √† 5 V 75 W </font><font style="vertical-align: inherit;">DC / DC </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">converter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, j'avais une autre option, qui consistait √† utiliser cinq convertisseurs moins puissants - un pour chaque carte Raspberry Pi, mais cela compliquerait grandement la conception du cluster.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c86/e1a/95f/c86e1a95febd0d64ea0ee5f9bbafe28a.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patch bord A</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
bord du patch 4 broches sur la base du MOSFET PSMN011-30YLC est install√© dans la partie inf√©rieure du ch√¢ssis. Il est utilis√© pour activer et d√©sactiver les n≈ìuds de travail. Il est √©tiquet√© 15A, 30V, donc il r√©siste bien m√™me avec la charge cr√©√©e par quatre Raspberry Pi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai mesur√© la puissance moyenne et maximale consomm√©e par le cluster. Les r√©sultats de mesure sont approximativement coh√©rents avec ces calculs approximatifs que j'ai faits plus t√¥t. La diff√©rence entre les valeurs attendues et r√©elles peut √™tre expliqu√©e par les caract√©ristiques de la configuration du syst√®me et les caract√©ristiques du test. En particulier, j'ai d√©sactiv√© le Wi-Fi et le Bluetooth sur mon Raspberry Pi, ils fonctionnent √©galement sans afficher d'image sur le moniteur. Cela peut expliquer le fait qu'en r√©alit√©, les valeurs se sont av√©r√©es inf√©rieures.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© que l'alimentation de 108 W est beaucoup plus puissante que ce qui est n√©cessaire pour le cluster. </font><font style="vertical-align: inherit;">Cependant, le fait que je dispose d'une telle alimentation signifie que je peux √©tendre les capacit√©s du syst√®me. </font><font style="vertical-align: inherit;">Par exemple, remplacez Raspberry Pi 3 par Raspberry Pi 4.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Stockage de donn√©es</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des nouvelles fonctionnalit√©s int√©ressantes du Raspberry Pi 4 est la pr√©sence sur la carte de deux ports USB 3.0 connect√©s au SoC BCM2711 √† l'aide d'une connexion PCIe extr√™mement rapide. Gr√¢ce √† cela, on peut esp√©rer atteindre des d√©bits de donn√©es tr√®s √©lev√©s. J'ai d√©cid√© d'utiliser ces ports USB 3.0 pour connecter des SSD √† l'aide des adaptateurs M.2 NVMe √† USB 3.0. Cependant, il s'est av√©r√© qu'il √©tait tr√®s difficile de trouver de tels adaptateurs. J'ai na√Øvement sugg√©r√© que tous les adaptateurs fonctionneraient pour moi. En cons√©quence, j'ai achet√© le premier adaptateur de ce type sans v√©rifier sa compatibilit√© avec le Raspberry Pi 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai heureusement rencontr√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√©l√©chargez le guide de t√©l√©chargement du Raspberry Pi 4, puis achetez l'adaptateur recommand√© Shinestar M.2 NVMe vers USB 3.0. </font><font style="vertical-align: inherit;">Il √©tait presque de la m√™me taille que le M.2 NVMe 2280 (22 mm de large et 80 mm de long), ce qui est id√©al pour le bo√Ætier Pico 5S. </font><font style="vertical-align: inherit;">J'ai utilis√© l'adaptateur pour connecter le Samsung SSD 970 EVO Plus M.2 PCIe NVMe 500 Go au Raspberry Pi.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/92e/5a5/1e9/92e5a51e924bcfe0c77ef14278917734.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adaptateur M.2 NVMe vers USB 3.0</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Apr√®s avoir tout install√© et configur√©, j'ai d√©cid√© de tester rapidement le lecteur et de conna√Ætre la vitesse de transfert des donn√©es. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai copi√© un gros fichier du SSD sur mon ordinateur portable en utilisant</font></font><code>scp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<code>$ scp pi@master:&lt;source&gt; &lt;destination&gt;<br>
100% 1181MB 39.0MB/s 00:30</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le r√©sultat de 39 Mb / s m'a d√©√ßu. Ces chiffres sont loin de ceux n√©cessaires pour charger compl√®tement le commutateur Gigabit Ethernet. J'ai commenc√© √† rechercher un √©ventuel goulot d'√©tranglement dans le syst√®me et j'ai r√©alis√© que lors du transfert de fichiers, l'un des c≈ìurs du processeur est toujours charg√© √† 100%. Apr√®s avoir d√©couvert que le processeur √©tait le goulot d'√©tranglement dans le transfert de donn√©es, j'ai rapidement d√©couvert que le Raspberry Pi 4 n'avait pas de support mat√©riel AES, car Broadcom et la Raspberry Pi Foundation ne conc√©daient pas de licences d'extensions cryptographiques ARMv8. Fait int√©ressant, le processeur est le goulot d'√©tranglement du syst√®me sur le Raspberry Pi 4, tandis que les goulots d'√©tranglement du Raspberry Pi 3 √©taient USB 2.0 et les interfaces r√©seau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un nouveau test utilisant </font></font><code>netcat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dans les m√™mes conditions, a donn√© de bien meilleurs r√©sultats √† 104 Mb / s:</font></font><br>
<br>
<pre><code class="bash hljs">$ nc -l 6000 |dd bs=1m of=&lt;destination&gt; &amp; ssh pi@master <span class="hljs-string">"dd bs=1M if=&lt;source&gt; | nc -q 0 <span class="hljs-subst">$(hostname -I | awk '{print $1}')</span> 6000"</span><font></font>
[1] 71300 71301<font></font>
1181+1 records <span class="hljs-keyword">in</span><font></font>
1181+1 records out<font></font>
1238558304 bytes (1.2 GB, 1.2 GiB) copied, 11.8632 s, 104 MB/s<font></font>
0+740624 records <span class="hljs-keyword">in</span><font></font>
0+740624 records out<font></font>
1238558304 bytes transferred <span class="hljs-keyword">in</span> 14.212518 secs (87145593 bytes/sec)<font></font>
[1]&nbsp; + 71300 <span class="hljs-keyword">done</span> &nbsp; &nbsp; &nbsp; nc -l 6000 |<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;71301 <span class="hljs-keyword">done</span> &nbsp; &nbsp; &nbsp; dd bs=1m of=&lt;destination&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir trait√© le premier disque SSD, j'ai connect√© le deuxi√®me m√™me disque √† une autre carte Raspberry Pi 4. Je vais utiliser ce disque pour sauvegarder le premier en utilisant quelque chose comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restic</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, je pr√©vois d'utiliser des SSD pour organiser le d√©marrage √† l'aide du d√©marrage de stockage de masse USB imm√©diatement apr√®s que le Raspberry Pi 4 prend pleinement en charge cette m√©thode de d√©marrage. </font><font style="vertical-align: inherit;">Il, par rapport au t√©l√©chargement √† partir de microSD, promet une vitesse plus √©lev√©e et un niveau de performance plus stable.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logiciel</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis programmeur, j'ai donc pens√© qu'il serait plus facile pour moi de traiter la partie logicielle du cluster que d'autres questions. </font><font style="vertical-align: inherit;">Les r√©sultats du merveilleux travail sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> effectu√© par l'√©quipe Rancher </font><font style="vertical-align: inherit;">m'ont certainement aid√© ici </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Je n'entrerai pas dans les d√©tails particuliers sur la configuration d'un cluster Kubernetes sur un Raspberry Pi utilisant k3s ici. </font><font style="vertical-align: inherit;">Pour ceux qui sont int√©ress√©s, je peux recommander de consulter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> guide. </font><font style="vertical-align: inherit;">Voici les principaux points √† configurer sur lesquels je voudrais m'attarder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©marrer, sur chaque n≈ìud, activez </font></font><code>cgroups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo sed -i <span class="hljs-string">'$ s/$/ cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory/'</span> /boot/cmdline.txt<font></font>
$ sudo reboot<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez ensuite k3s sur le n≈ìud principal:</font></font><br>
<br>
<pre><code class="bash hljs">$ curl -sfL https://get.k3s.io | sh -s - --write-kubeconfig-mode 644
<span class="hljs-comment">#   </span><font></font>
$ sudo systemctl status k3s<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons maintenant un jeton autorisant la connexion des n≈ìuds de travail au n≈ìud principal:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cat /var/lib/rancher/k3s/server/node-token
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite - installez k3s sur chaque n≈ìud de travail:</font></font><br>
<br>
<pre><code class="bash hljs">$ curl -sfL https://get.k3s.io | K3S_URL=<span class="hljs-string">"https://&lt;MASTER_IP&gt;:6443"</span> K3S_TOKEN=<span class="hljs-string">"&lt;NODE_TOKEN&gt;"</span> sh -
<span class="hljs-comment">#   </span><font></font>
$ sudo systemctl status k3s-agent<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous pr√©voyez d'utiliser le registre interne d'images de conteneur, qui est install√© par d√©faut, vous devrez peut-√™tre le configurer d'une mani√®re sp√©ciale, en proc√©dant ainsi afin de permettre le </font></font><code>containerd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chargement des images </font><font style="vertical-align: inherit;">√† </font><font style="vertical-align: inherit;">partir de celui-ci:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo sh -c <span class="hljs-string">'REGISTRY=$(kubectl get svc -n kube-system registry -o jsonpath={.spec.clusterIP}); \
cat &lt;&lt;EOT &gt;&gt; /etc/rancher/k3s/registries.yaml
mirrors:
&nbsp;&nbsp;"$REGISTRY":
&nbsp;&nbsp;&nbsp;&nbsp;endpoint:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- "http://$REGISTRY"
EOT'</span><font></font>
$ sudo service k3s restart<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plans futurs</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce document, je n'ai pas divulgu√© certains sujets importants qui m√©ritent une analyse suffisamment approfondie. </font><font style="vertical-align: inherit;">Par exemple, les √©l√©ments suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion logicielle de l'alimentation des n≈ìuds de travail et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise √† l'√©chelle automatique des clusters</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation d'un ventilateur PWM et r√©glage de sa vitesse en tenant compte des indicateurs de temp√©rature du syst√®me.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pi-Hole</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur Kubernetes √† l'aide de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MetalLB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'√©crirai peut-√™tre plus √† ce sujet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, je pr√©vois de continuer √† travailler sur le cluster en proc√©dant comme suit:</font></font><br>
<br>
<ul>
<li>  SSD-   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">USB mass storage boot</a>.</li>
<li>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Restic</a>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je suis s√ªr que lorsque j'ai parl√© de mon exp√©rience dans la cr√©ation du cluster domestique Kubernetes, j'ai beaucoup oubli√©. </font><font style="vertical-align: inherit;">Je suis programmeur et je suis habitu√© √† une r√©partition assez h√©t√©rog√®ne de grandes t√¢ches en petits cas. </font><font style="vertical-align: inherit;">L'exp√©rience a montr√© que le mat√©riel est beaucoup moins tol√©rant que le logiciel en ce qui concerne les essais et les erreurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, plus j'en apprends, plus l'admiration en moi est caus√©e par les technologies mat√©rielles et logicielles modernes. </font><font style="vertical-align: inherit;">Cela m'√©tonne de voir comment l'ing√©niosit√© d'une personne a pu combiner des ph√©nom√®nes √©lectriques et des langages de programmation, ce qui en fait quelque chose qui peut √™tre consid√©r√© comme un exemple de la fa√ßon dont la conscience contr√¥le la mati√®re. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chers lecteurs! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avez-vous essay√© de faire quelque chose de similaire √† ce que l'auteur de cet article a d√©crit?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493696/index.html">Acc√©l√©ration du sous-syst√®me de disque Kemu Qemu sous Linux</a></li>
<li><a href="../fr493700/index.html">Utilisation de logiciels malveillants dans Azure pour acc√©der aux locataires Microsoft 365</a></li>
<li><a href="../fr493702/index.html">Transition massive vers le travail √† distance: probl√®mes techniques et menaces pour la s√©curit√©</a></li>
<li><a href="../fr493704/index.html">Utiliser TypeScript en JavaScript sans √©crire TypeScript</a></li>
<li><a href="../fr493706/index.html">Connaissez votre ennemi: cr√©ez une porte d√©rob√©e Node.js</a></li>
<li><a href="../fr493712/index.html">Nouvelles fonctionnalit√©s TypeScript pour une convivialit√© am√©lior√©e</a></li>
<li><a href="../fr493714/index.html">Fiches de s√©curit√©: Nodejs</a></li>
<li><a href="../fr493716/index.html">Inf√©rence de type avec TypeScript en utilisant la construction as const et le mot cl√© infer</a></li>
<li><a href="../fr493718/index.html">Discussion: utilitaires UNIX standard que peu ont utilis√©s et utilisent actuellement</a></li>
<li><a href="../fr493720/index.html">La temp√™te parfaite: comment la technologie change l'industrie des services alimentaires</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>