<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥‚Äç‚ò†Ô∏è üê≤ üìò Sicherer Zugang zu einem Smart Home ohne √∂ffentliche IP (Teil 1) üõ∞Ô∏è üõãÔ∏è üë©üèæ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung
 Es ist schwierig, einen umfangreichen Titel zu w√§hlen, der die Bedeutung widerspiegelt, daher werde ich sofort die Aufgabe beschreiben, di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sicherer Zugang zu einem Smart Home ohne √∂ffentliche IP (Teil 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504716/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist schwierig, einen umfangreichen Titel zu w√§hlen, der die Bedeutung widerspiegelt, daher werde ich sofort die Aufgabe beschreiben, die ich mir selbst gestellt habe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt ein "Smart Home". </font><font style="vertical-align: inherit;">In meinem Fall ist dies ein l√ºfterloser Heimserver mit ioBroker, obwohl dies nicht wichtig ist. </font><font style="vertical-align: inherit;">Zus√§tzlich zu den Haushaltsgegenst√§nden m√∂chte ich Sensoren von au√üen daran anschlie√üen (z. B. an einem ESP32 aus einem entfernten Gew√§chshaus). </font><font style="vertical-align: inherit;">Ich habe mich dazu entschlossen, dies √ºber mqtt zu tun. </font><font style="vertical-align: inherit;">Zugriff auf die Schnittstelle √ºber das Internet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das √úbliche. </font><font style="vertical-align: inherit;">Aber es gibt Nuancen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Anbieter hat keine M√∂glichkeit, mir eine √∂ffentliche IP-Adresse zu geben. </font><font style="vertical-align: inherit;">Und es gibt keine anderen Anbieter.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich bin nicht gerne an bestimmte Cloud-Dienste gebunden. </font><font style="vertical-align: inherit;">Ein externer Dienst kann ebenfalls geschlossen werden (da gbridge k√ºrzlich eine Benachrichtigung gesendet hat). </font><font style="vertical-align: inherit;">Und nur im Fehlerfall ist nicht klar, was zu tun ist. </font><font style="vertical-align: inherit;">Ich bevorzuge meine eigene, die √ºbertragen werden kann und mit wenig Blut wiederholt wird, wenn etwas passiert.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheit ist wichtig. </font><font style="vertical-align: inherit;">Keine Paranoia, sondern ioBroker ins Internet stellen, vor allem angesichts der Tatsache, dass mehrere Dienste ausgestellt sind (Flot ...). </font><font style="vertical-align: inherit;">Nicht wirklich.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weiter m√∂chte ich nicht sofort das Ergebnis zeigen, sondern den Prozess. </font><font style="vertical-align: inherit;">Wie es ging, wie Wunschliste transformiert wurde, Entscheidungen ge√§ndert. </font><font style="vertical-align: inherit;">Es ist m√∂glich, dass einige Punkte korrekter / effizienter gel√∂st werden k√∂nnen (ich bin kein Systemadministrator, kein Entwickler). </font><font style="vertical-align: inherit;">Oder vielleicht geht jemand nicht so weit und nutzt eine Zwischenl√∂sung, die ich zum Beispiel f√ºr mich nicht sicher oder bequem fand. </font><font style="vertical-align: inherit;">Eigentlich ist das, was in diesem Teil beschrieben wird, eine ziemlich funktionierende Option, aber f√ºr mich ist es "mittelschwer".</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffentliche Adresse f√ºr mqtt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu Hause leuchtet die √∂ffentliche IP auf dem Router nicht (ich spreche nicht von fest, dies kann durch Dyndns und Analoga gel√∂st werden), n√§mlich der Anbieter gibt 10.x.x.x ohne Optionen. </font><font style="vertical-align: inherit;">Sie m√ºssen also einen kleinen VPS mieten und einen Probros daraus machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am einfachsten ist es, durch ssh zu tunneln. </font><font style="vertical-align: inherit;">Auf dem Heimserver (ich werde es iob.xxx.xx nennen) f√ºhre ich Folgendes aus:</font></font><br>
<br>
<pre><code class="plaintext hljs">ssh -N -T -R pub.xxx.xx:1883:127.0.0.1:1883 a@iob.xxx.xx </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie eine Verbindung zu Port 1883 des externen Servers pub.xxx.xx herstellen, befinden Sie sich in Wirklichkeit auf Ihrem Heim-iob: 1883, w√§hrend der mqtt-Container (Moskito) ausgef√ºhrt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich ist es notwendig, dass dies automatisch startet, die Verbindung wird nach einem Fehler wiederhergestellt. </font><font style="vertical-align: inherit;">Deshalb habe ich autossh verwendet und es als Service entworfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/etc/systemd/system/ssh_mqtt.service:</font></font><br>
<br>
<pre><code class="plaintext hljs">[Unit]<font></font>
Description=SSH Tunnel mqtt<font></font>
After=network.target<font></font>
<font></font>
[Service]<font></font>
Environment="AUTOSSH_GATETIME=0"<font></font>
ExecStart=autossh -M 0 -o "ServerAliveInterval 30" -o "ServerAliveCountMax 3" -NR pub.xxx.xx:1883:127.0.0.1:1883 -i /home/a/.ssh/id_rsa a@pub.xxx.xx<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Arten von systemctl aktivieren / neu starten usw. Ich werde nicht beschreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider wurde ich trotz Autossh von st√§ndigen Einfrierungen heimgesucht. Daher entschied ich, dass keine Entit√§ten erstellt werden m√ºssen, und entschied mich f√ºr das √ºbliche ssh: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/etc/systemd/system/ssh_mqtt.service:</font></font><br>
<br>
<pre><code class="plaintext hljs">[Unit]<font></font>
Description=SSH Tunnel mqtt<font></font>
After=network.target<font></font>
<font></font>
[Service]<font></font>
Restart=always<font></font>
RestartSec=20<font></font>
User=anri<font></font>
ExecStart=/bin/ssh -N -T -R pub.xxx.xx:1883:127.0.0.1:1883 -i /home/a/.ssh/id_rsa a@pub.xxx.xx<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Folge stellte sich √ºbrigens heraus, dass dieser Anbieter so schr√§g ist. Nun, oder der g√ºnstigste Preis f√ºr 45 Rubel / Monat funktioniert so schief f√ºr ihn. Die Sitzung h√§ngt regelm√§√üig, auch wenn sie einfach √ºber ssh (MobaXterm) verbunden ist. Am Ende bestellte ich mir einen VPS von einem anderen (55 Rubel / Monat) und die Probleme mit dem Einfrieren verschwanden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úbrigens habe ich mir selbst ausgesucht, wo ich VPS nicht nur auf der Grundlage des Preises, sondern auch unter Ber√ºcksichtigung von Ping (10-20 ms) einsetzen soll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen ist diese Option ganz normal, insbesondere wenn man bedenkt, dass ich sp√§ter eine Internetverbindung ausschlie√ülich zu Port 8883 √ºber TLS hergestellt habe. Jene. Das Passwort f√ºr Moskito wurde verschl√ºsselt √ºbertragen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anschlie√üend werden Kundenzertifikate obligatorisch. </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Auf TLS-Ebene m√ºssen Sie zun√§chst ein Client-Zertifikat vorlegen und sich dann mit dem in mosquito angegebenen Kennwortnamen anmelden. </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Es ist nicht so einfach, zur Phase der Passwortsuche zu gelangen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend habe ich zuerst das Serverzertifikat von LetsEncrypt verwendet und dann aufgrund der Notwendigkeit von Clientzertifikaten auf Selbstsignierung umgestellt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da ich dabei auch an der Software f√ºr ESP32 gearbeitet habe, habe ich festgestellt (oder dachte nur, ich erinnere mich nicht mehr), dass bei Problemen mit der VPN-Verbindung der Akku viel schneller verbraucht wird. </font><font style="vertical-align: inherit;">W√§hrend des normalen Betriebs l√§uft der Zyklus ab: Aufwachen, die Sensoren mit Strom versorgen, eine Verbindung zum WLAN herstellen, eine Verbindung mit dem mqtt-Server herstellen, die Sensorwerte lesen, sobald sie bereit sind, auf mqtt √ºbertragen, die Sensoren ausschalten, 10 Minuten in den Tiefschlaf gehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalerweise dauert ein solcher Zyklus ungef√§hr 4 Sekunden. </font><font style="vertical-align: inherit;">1,5-2 Sekunden - Verbindung zu WiFi, eine zus√§tzliche Sekunde aufgrund des √úbergangs zu mqtt √ºber TLS. </font><font style="vertical-align: inherit;">Es passt zu Ihnen f√ºr 4 Sekunden, trotzdem brauchen die Sensoren Zeit, um aufzuwachen. </font><font style="vertical-align: inherit;">Aber was soll ich tun, wenn das VPN ausf√§llt (es war deutlich sichtbar, als der Autossh abfiel)? </font><font style="vertical-align: inherit;">Nat√ºrlich habe ich so eingerichtet, dass das System nach 20 Sekunden sowieso einschlafen w√ºrde. </font><font style="vertical-align: inherit;">Aber 20 Sekunden statt 4 sind sehr auff√§llig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen habe ich beschlossen, dass es besser ist, den mqtt-Server auf einem externen VPS zu belassen. </font><font style="vertical-align: inherit;">Jetzt, da alles wie eine Uhr funktioniert, bin ich mir nicht sicher, ob dies notwendig ist. </font><font style="vertical-align: inherit;">Aber ich sehe keinen Sinn darin, es wieder herzustellen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffentliche Adresse f√ºr Vis</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vis ist ein beliebtes Visualisierungssystem bei ioBroker. Sie konnten sich nicht die M√ºhe machen, es selbst auf https zu konfigurieren und ebenfalls nur den Port weiterzuleiten. Dar√ºber hinaus kann sie auf Anwendungsebene nach einem Passwort fragen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist aber nicht cool. Besonders wenn man bedenkt, dass es f√ºr die Arbeit zus√§tzliche Dienste verbindet. Angenommen, ich zeichne Diagramme im Flot, relativ gesehen verbinde ich mich mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vis.xxx.xx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8082 / vis / index.html, aber im Inneren befinden sich Links zu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vis.xxx.xxx-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diagrammen </font><font style="vertical-align: inherit;">: 8082 / flot / index.html. Irgendwann stellte sich heraus, dass beim Herstellen einer Verbindung zu / vis ein Kennwort abgefragt wird und auf die Grafikoberfl√§che ohne Kennwort zugegriffen werden kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einigen Momenten war es im Allgemeinen seltsam - ich wurde auf vis autorisiert, ich sehe die Grafik, aber unten rechts befindet sich ein durchscheinendes Fenster ‚ÄûKeine Verbindung zum Server‚Äú. Dieser CSS-Block wurde neu geschrieben, um ihn auszublenden. Sobald ich jedoch anfing, mit Frame zwischen Diagrammen auf demselben Bildschirm zu wechseln, stellte sich heraus, dass meine √úberlappung auf dem Display im Frame nicht funktionierte. (Wie sich sp√§ter herausstellte, sollte es so sein). Ich schalte die Autorisierung aus - alles ist in Ordnung, kein Fluchen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also habe ich mich f√ºr denselben externen Server entschieden, um nginx im Reverse-Proxy-Modus zu erh√∂hen. Und schon autorisieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úber den Browser hat es funktioniert. Die native Anwendung iobroker.vis vom Play Market konnte sich jedoch nicht auf diese Weise anmelden. Und ich wollte es benutzen. Dies ist zwar eigentlich ein Browser im Fenster, aber es hat eine Reihe von netten Funktionen. Nehmen wir an, Sie stellen den Ma√üstab ein (93% im vertikalen Modus) und das Bild passt. Auf einem anderen Ger√§t mit einer anderen Bildschirmaufl√∂sung w√§hlen Sie einfach den Koeffizienten aus und fertig. Und im Browser m√ºssen Sie jedes Mal anpassen ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Okay, denke ich. Ich werde der URL anstelle des Passworts einen kniffligen Code hinzuf√ºgen. Typ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vis.xxx.xx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8082 / &lt;lange Sequenz&gt; /vis/index.html. Oft wird ein solcher Trick angewendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fast verdient. Aber mit Pannen zeigte das Graben, dass diese Webanwendung nicht richtig geschrieben wurde. Viele Links darin sind nicht relativ, sondern von der Wurzel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Okay, ich habe mehrere Links gefunden, die ich f√ºr sie geschrieben habe. Sie sagen, wenn der Referrer solchen Code enth√§lt, vertraue immer noch, schreibe die URL neu usw. </font><font style="vertical-align: inherit;">Aber sie kamen allm√§hlich ans Licht. </font><font style="vertical-align: inherit;">Also habe ich entschieden, dass dies schief und falsch ist und ein anderer Ansatz erforderlich ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich beschloss, ein wenig Zugangsuniversalit√§t zu opfern. Lassen Sie mich von meinem Laptop oder Smartphone aus zugreifen. Aber von den Ger√§ten anderer Leute ist das Internetcaf√© nicht notwendig, ich werde es schaffen. Dann k√∂nnen Sie einen kleinen Client einrichten, der das VPN installiert. Und darin ist weder SSL noch Autorisierung erforderlich. Gleichzeitig m√ºssen Sie die Links nicht wiederholen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einfachste Weg f√ºr mich war Zerotier. F√ºr mein Betriebssystem (Windows, Android, Linux) gibt es Clients. Und es gibt sogar fertige im Docker. Ja. Ich f√ºhre alles in Docker aus, √ºber die Funktionen davon sp√§ter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie installieren den Client, geben einen eindeutigen Code f√ºr Ihr Netzwerk ein und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">best√§tigen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ihn </font><font style="vertical-align: inherit;">in der Weboberfl√§che auf </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">my.zerotier.com. Legen Sie</font></a><font style="vertical-align: inherit;"> bei Bedarf eine statische Adresse in Ihrem pers√∂nlichen privaten Netzwerk fest (a la 10.20.30.0), und fertig. Alle verbundenen Clients sehen sich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das einzige, mit dem ich mich ein bisschen befassen musste, war "wie man von einem Ger√§t in Ihrem Heim-WLAN aus eine Verbindung zu einem Remote-Server herstellt, ohne den Client zu starten". Nun, mein Heimserver ist bereits ein Client, auch wenn er sich selbst weiterleitet. Es stellte sich heraus, dass alles einfach ist. Das Heimnetzwerk 192.168.x.0 sollte auf my.zerotier.com im Abschnitt Verwaltete Routen registriert sein und als Gateway angeben. Dies ist nat√ºrlich mein Heimserver. Nun, konfigurieren Sie im WiFi-Netzwerk die Route entsprechend (auf dem WiFi-Router statisch 10.20.30.0 auf dem Heimserver). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie einen Zerotier-Client verbinden, k√∂nnen Sie einen anderen DNS-Server angeben. Jene. Ich habe den Client verbunden, und der Dom√§nenname wird nicht in eine √∂ffentliche, sondern in eine private Adresse aufgel√∂st, da DNS jetzt auf den Heimserver verweist, auf dem dnsmasq f√ºr einzelne IP-Eintr√§ge aus dem privaten Zerotier-Netzwerk aktiviert ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sogar Zerotier war mit der effektiven Wahl einer Verbindungsroute zufrieden. </font><font style="vertical-align: inherit;">Wenn ich einen Zerotier-Client in Heim-WLAN aktiviere, dauert das Pingen an den Heimcomputer (dessen von Zerotier ausgegebene IP-Adresse) die gleichen Millisekunden wie ohne Client (nur √ºber WLAN). </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Die Verbindung zur Cloud wird erst im ersten Moment hergestellt. </font><font style="vertical-align: inherit;">Der weitere Verkehrsaustausch erfolgt direkt und nicht √ºber die Cloud. </font><font style="vertical-align: inherit;">Wenn Sie beispielsweise OpenVPN auf VPS installieren, wurde derselbe Datenverkehr vom Client zum VPS und dann zur√ºck zum gleichen WiFi-Netzwerk zum Heimserver ausgef√ºhrt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Prinzip gibt es sogar einen Chip f√ºr Ihre Mond-Server. </font><font style="vertical-align: inherit;">Fast in einem vom Internet abgeschnittenen Netzwerk soll all diese Wirtschaft eingesetzt werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist das Ergebnis?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP32 sendet seine Daten an den auf dem VPS bereitgestellten mqtt-Server. √úber TLS ist ein Client-Zertifikat erforderlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein VPN √ºber Zerotier wird mit dem Heimserver installiert. Sonoff rfBridge kommuniziert mit der Tasmota-Firmware √ºber diesen Heimserver von mqtt bis VPS. Es gibt keine M√∂glichkeit, TLS mit einem Client-Zertifikat festzulegen. Deshalb ist der √ºbliche MQTT f√ºr 1883 konfiguriert. Schlie√ülich verschl√ºsselt der Heimserver diesen Datenverkehr mit Zerotier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, ich verbinde mich direkt vom Heimnetzwerk und vom Internet aus mit vis, indem ich den Zerotier-Client aktiviere. Sie k√∂nnen es √ºberhaupt nicht ausschalten, das funktioniert auch. Aber nur manchmal brauche ich andere VPN-Clients (zB zum "ILV-verboten"). Zwei VPNs auf einem Smartphone wurden nicht sofort Freunde, aber ich verstand nicht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist sehr einfach. </font><font style="vertical-align: inherit;">Aber der Wurm verschluckte die Seele. </font><font style="vertical-align: inherit;">Ich habe zwar keinen Kernreaktor, aber pl√∂tzlich? </font><font style="vertical-align: inherit;">Es gab einen Fall, in dem sie TeamViewer (ein Unternehmen, nicht speziell Client-Software) brachen und durch sie Zugriff auf viele Konten erhielten. </font><font style="vertical-align: inherit;">Und im Allgemeinen habe ich ganz am Anfang geschrieben, dass ich alles liebe, was mir geh√∂rt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im n√§chsten Schritt wechselte ich von Zerotier zu OpenVPN. </font><font style="vertical-align: inherit;">Alles ist in meinen H√§nden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der einzige "Au√üerirdische" ist der VPS des Anbieters. </font><font style="vertical-align: inherit;">Nun, ich starte speziell alles in Docker-Containern, um mich sofort bewegen zu k√∂nnen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich w√ºsste, wie viel ich mit OpenVPN zu tun haben w√ºrde, w√ºrde ich es vielleicht nicht tun. </font><font style="vertical-align: inherit;">Fairerweise - die Hauptprobleme waren genau wegen der Container.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im n√§chsten Artikel werde ich √ºber OpenVPN und die Konfigurationsfunktionen in meinen Bedingungen (Container, Routing anderer Ger√§te aus dem Heimnetzwerk) sprechen. Es wird mehr Konfigurationen, technische Details und Schwierigkeiten geben. Aber sofort begann der zweite Teil nicht ohne dies zu schreiben. Es w√§re nicht klar, warum solche Perversionen √ºberhaupt notwendig sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und f√ºr alle F√§lle eine Frage f√ºr diejenigen, die wissen: Obwohl ich ein VPS und ein kleines (512 MB RAM) habe, wird es weniger als 1% verwendet. Docker-Statistiken: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/fp/ka/8vfpkabqind44rkwfcycs7b7ais.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und ich hatte die Idee, alles wie einen Container auf einem Google Cloud Run, Amazon Fargate oder √§hnlichem zu starten. Die Bereitstellung eines Servers mit allen Arten von fail2ban √ºber ansible ist kein Problem. Installieren Sie auch Docker. Aber warum, wenn Sie nur einen kleinen Teil seiner Ressourcen ben√∂tigen? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach meinen Berechnungen w√ºrde mich das gleiche Fargate jedoch um ein Vielfaches kosten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht habe ich etwas nicht verstanden? </font><font style="vertical-align: inherit;">Es w√§re also interessant, einen kleinen Container nur f√ºr die Weiterleitung des Hafens nach Hause zu haben und nicht einen ganzen VPS. </font><font style="vertical-align: inherit;">Das gibt es nicht?</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de504706/index.html">Automatische Wi-Fi-Energieverwaltung</a></li>
<li><a href="../de504708/index.html">Ausstellung des Sectigo-Zertifikats nach dem 30. Mai 2020 und L√∂sungsmethode</a></li>
<li><a href="../de504710/index.html">FOSS News Nr. 18 - eine √úberpr√ºfung der kostenlosen und Open Source-Nachrichten f√ºr den 25. bis 31. Mai 2020</a></li>
<li><a href="../de504712/index.html">Warum verwende ich SharedViewModel nicht f√ºr Fragmente?</a></li>
<li><a href="../de504714/index.html">Gehen Sie Software-Messwerkzeuge</a></li>
<li><a href="../de504718/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 417 (25. - 31. Mai 2020)</a></li>
<li><a href="../de504720/index.html">Die schnellste Template Engine f√ºr PHP</a></li>
<li><a href="../de504722/index.html">HLS in MP4 mit ffmpeg in einem Browser</a></li>
<li><a href="../de504724/index.html">Verbindungismus</a></li>
<li><a href="../de504726/index.html">4 Vereinbarungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>