<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüîß üßúüèº ü•Ö ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ™ÿ¨ÿ± ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ ÿπŸÑŸâ Nuxt.js 2 ÿ™ÿ¨ŸàŸÑ ÿßŸÑÿ¨ÿ≤ÿ° 3 üåü ü§±üèº ‚ìÇÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ŸÉŸÖÿß ŸàÿπÿØŸÜÿß ÿå ŸÜÿ≥ÿ™ŸÖÿ±.
 

ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ¨ÿ≤ÿ°:
 

- ÿ•ŸÜÿ¥ÿßÿ° ŸÉÿ™ŸÑ ÿßŸÑÿ®ÿ∂ÿßÿ¶ÿπ "Ÿäÿ¥ÿ™ÿ±ŸàŸÜ ÿ£Ÿäÿ∂Ÿãÿß ŸÖÿπ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨" Ÿà "ÿ≥ŸÑÿπ ŸÖÿ´Ÿäÿ±ÿ© ŸÑŸÑÿßŸáÿ™ŸÖÿßŸÖ"
- ÿ•ŸÜÿ¥ÿßÿ° ÿ±ŸÖÿ≤ ÿ≥ŸÑÿ© ŸÖÿπ ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
- ÿ±ÿ®ÿ∑ ŸÜ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ™ÿ¨ÿ± ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ ÿπŸÑŸâ Nuxt.js 2 ÿ™ÿ¨ŸàŸÑ ÿßŸÑÿ¨ÿ≤ÿ° 3</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491190/"><p><img src="https://habrastorage.org/webt/bz/t1/ds/bzt1dsg3xirl4vj059ehw0wzhs4.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ŸÉŸÖÿß ŸàÿπÿØŸÜÿß ÿå ŸÜÿ≥ÿ™ŸÖÿ±.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ¨ÿ≤ÿ°:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ•ŸÜÿ¥ÿßÿ° ŸÉÿ™ŸÑ ÿßŸÑÿ®ÿ∂ÿßÿ¶ÿπ "Ÿäÿ¥ÿ™ÿ±ŸàŸÜ ÿ£Ÿäÿ∂Ÿãÿß ŸÖÿπ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨" Ÿà "ÿ≥ŸÑÿπ ŸÖÿ´Ÿäÿ±ÿ© ŸÑŸÑÿßŸáÿ™ŸÖÿßŸÖ"</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ•ŸÜÿ¥ÿßÿ° ÿ±ŸÖÿ≤ ÿ≥ŸÑÿ© ŸÖÿπ ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ±ÿ®ÿ∑ ŸÜÿßŸÅÿ∞ÿ© ŸÖÿ¥ÿ±Ÿàÿ∑ÿ© ÿ®ÿßŸÑÿ®ÿ∂ÿßÿ¶ÿπ ŸÅŸä ÿßŸÑÿ≥ŸÑÿ©</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ•ÿπÿßÿØÿ© ŸÉÿ™ÿßÿ®ÿ© ŸÉŸÑ ŸÖŸÜÿ∑ŸÇ ÿßŸÑŸÖÿ™ÿ¨ÿ±</font></font><a name="habracut"></a></li>
</ul><br>
<h3 id="sozdadim-bloki-tovarov-tipa-s-etim-tovarom-takzhe-pokupayut"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ŸÑŸÜŸÇŸÖ ÿ®ÿ•ŸÜÿ¥ÿßÿ° ŸÉÿ™ŸÑ ÿßŸÑÿ®ÿ∂ÿßÿ¶ÿπ ŸÖŸÜ ÿßŸÑŸÜŸàÿπ: "Ÿäÿ¥ÿ™ÿ±ŸàŸÜ ÿ£Ÿäÿ∂Ÿãÿß ŸÖÿπ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨"</font></font></h3><br>
<p>       Nuxt.        .     -       ,   ?</p><br>
<p>     <strong>AlsoBuyList </strong>      <strong>asyncData</strong>,        .       ,   html       ,    asyncData   <strong>mounted</strong> (          ).</p><br>
<p>    True SSR,        asyncData  .   ,          ,          . , , ,    SSR. </p><br>
<p>   .</p><br>
<p>  Vuex   :</p><br>
<div class="spoiler"><b class="spoiler_title">index.js</b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">// function for Mock API</span>
<span class="hljs-keyword">const</span> sleep = <span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> setTimeout(r, m))
<span class="hljs-keyword">const</span> sampleSize = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash.samplesize'</span>)
<span class="hljs-keyword">const</span> categories = [<font></font>
  {<font></font>
    <span class="hljs-attr">id</span>: <span class="hljs-string">'cats'</span>,
    <span class="hljs-attr">cTitle</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cSlug</span>: <span class="hljs-string">'cats'</span>,
    <span class="hljs-attr">cMetaDescription</span>: <span class="hljs-string">' '</span>,
    <span class="hljs-attr">cDesc</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cImage</span>: <span class="hljs-string">'https://source.unsplash.com/300x300/?cat,cats'</span>,
    <span class="hljs-attr">products</span>: []<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">id</span>: <span class="hljs-string">'dogs'</span>,
    <span class="hljs-attr">cTitle</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cSlug</span>: <span class="hljs-string">'dogs'</span>,
    <span class="hljs-attr">cMetaDescription</span>: <span class="hljs-string">' '</span>,
    <span class="hljs-attr">cDesc</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cImage</span>: <span class="hljs-string">'https://source.unsplash.com/300x300/?dog,dogs'</span>,
    <span class="hljs-attr">products</span>: []<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">id</span>: <span class="hljs-string">'wolfs'</span>,
    <span class="hljs-attr">cTitle</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cSlug</span>: <span class="hljs-string">'wolfs'</span>,
    <span class="hljs-attr">cMetaDescription</span>: <span class="hljs-string">' '</span>,
    <span class="hljs-attr">cDesc</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cImage</span>: <span class="hljs-string">'https://source.unsplash.com/300x300/?wolf'</span>,
    <span class="hljs-attr">products</span>: []<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">id</span>: <span class="hljs-string">'bulls'</span>,
    <span class="hljs-attr">cTitle</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cName</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cSlug</span>: <span class="hljs-string">'bulls'</span>,
    <span class="hljs-attr">cMetaDescription</span>: <span class="hljs-string">' '</span>,
    <span class="hljs-attr">cDesc</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">cImage</span>: <span class="hljs-string">'https://source.unsplash.com/300x300/?bull'</span>,
    <span class="hljs-attr">products</span>: []<font></font>
  }<font></font>
]<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getProductsByIds</span> (<span class="hljs-params">products, productsImages, ids</span>) </span>{
  <span class="hljs-keyword">const</span> innerProducts = products.filter(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.id === ids.find(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> p.id === id))
  <span class="hljs-keyword">if</span> (!innerProducts) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
  <span class="hljs-keyword">return</span> innerProducts.map(<span class="hljs-function"><span class="hljs-params">pr</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {<font></font>
      ...pr,<font></font>
      <span class="hljs-attr">images</span>: productsImages.find(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> img.id === pr.id).urls,
      <span class="hljs-attr">category</span>: categories.find(<span class="hljs-function"><span class="hljs-params">cat</span> =&gt;</span> cat.id === pr.category_id)<font></font>
    }<font></font>
  })<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getProduct</span> (<span class="hljs-params">products, productsImages, productSlug</span>) </span>{
  <span class="hljs-keyword">const</span> innerProduct = products.find(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.pSlug === productSlug)
  <span class="hljs-keyword">if</span> (!innerProduct) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
  <span class="hljs-keyword">return</span> {<font></font>
    ...innerProduct,<font></font>
    <span class="hljs-attr">images</span>: productsImages.find(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> img.id === innerProduct.id).urls,
    <span class="hljs-attr">category</span>: categories.find(<span class="hljs-function"><span class="hljs-params">cat</span> =&gt;</span> cat.id === innerProduct.category_id)<font></font>
  }<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addProductsToCategory</span> (<span class="hljs-params">products, productsImages, category</span>) </span>{
  <span class="hljs-keyword">const</span> categoryInner = { ...category, <span class="hljs-attr">products</span>: [] }<font></font>
  products.map(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (p.category_id === category.id) {<font></font>
      categoryInner.products.push({<font></font>
        <span class="hljs-attr">id</span>: p.id,
        <span class="hljs-attr">pName</span>: p.pName,
        <span class="hljs-attr">pSlug</span>: p.pSlug,
        <span class="hljs-attr">pPrice</span>: p.pPrice,
        <span class="hljs-attr">image</span>: productsImages.find(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> img.id === p.id).urls<font></font>
      })<font></font>
    }<font></font>
  })<font></font>
  <span class="hljs-keyword">return</span> categoryInner<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBreadcrumbs</span> (<span class="hljs-params">pageType, route, data</span>) </span>{
  <span class="hljs-keyword">const</span> crumbs = []<font></font>
  crumbs.push({<font></font>
    <span class="hljs-attr">title</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/'</span><font></font>
  })<font></font>
  <span class="hljs-keyword">switch</span> (pageType) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'category'</span>:<font></font>
      crumbs.push({<font></font>
        <span class="hljs-attr">title</span>: data.cName,
        <span class="hljs-attr">url</span>: <span class="hljs-string">`/category/<span class="hljs-subst">${data.cSlug}</span>`</span><font></font>
      })<font></font>
      <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'product'</span>:<font></font>
      crumbs.push({<font></font>
        <span class="hljs-attr">title</span>: data.category.cName,
        <span class="hljs-attr">url</span>: <span class="hljs-string">`/category/<span class="hljs-subst">${data.category.cSlug}</span>`</span><font></font>
      })<font></font>
      crumbs.push({<font></font>
        <span class="hljs-attr">title</span>: data.pName,
        <span class="hljs-attr">url</span>: <span class="hljs-string">`/product/<span class="hljs-subst">${data.pSlug}</span>`</span><font></font>
      })<font></font>
<font></font>
      <span class="hljs-keyword">break</span><font></font>
<font></font>
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">break</span><font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> crumbs<font></font>
}<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> state = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
  <span class="hljs-attr">categoriesList</span>: [],
  <span class="hljs-attr">currentCategory</span>: {},
  <span class="hljs-attr">currentProduct</span>: {
    <span class="hljs-attr">alsoBuyProducts</span>: [],
    <span class="hljs-attr">interestingProducts</span>: []<font></font>
  },<font></font>
  <span class="hljs-attr">bredcrumbs</span>: []<font></font>
})<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mutations = {<font></font>
  SET_CATEGORIES_LIST (state, categories) {<font></font>
    state.categoriesList = categories<font></font>
  },<font></font>
  SET_CURRENT_CATEGORY (state, category) {<font></font>
    state.currentCategory = category<font></font>
  },<font></font>
  SET_CURRENT_PRODUCT (state, product) {<font></font>
    state.currentProduct = product<font></font>
  },<font></font>
  SET_BREADCRUMBS (state, crumbs) {<font></font>
    state.bredcrumbs = crumbs<font></font>
  },<font></font>
  RESET_BREADCRUMBS (state) {<font></font>
    state.bredcrumbs = []<font></font>
  },<font></font>
  GET_PRODUCTS_BY_IDS () {}<font></font>
}<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> actions = {
  <span class="hljs-keyword">async</span> getProductsListByIds ({ commit }) {
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">const</span> [products, productsImages] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(<font></font>
      [<font></font>
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>),
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>)<font></font>
      ]<font></font>
<font></font>
    )<font></font>
    commit(<span class="hljs-string">'GET_PRODUCTS_BY_IDS'</span>)
    <span class="hljs-keyword">const</span> idsArray = (sampleSize(products, <span class="hljs-number">5</span>)).map(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.id)
    <span class="hljs-keyword">return</span> getProductsByIds(products, productsImages, idsArray)<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> setBreadcrumbs ({ commit }, data) {
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_BREADCRUMBS'</span>, data)<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> getCategoriesList ({ commit }) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
      <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_CATEGORIES_LIST'</span>, categories)<font></font>
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-built_in">console</span>.log(err)
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'  ,  '</span>)<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> getCurrentCategory ({ commit, dispatch }, { route }) {
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">const</span> category = categories.find(<span class="hljs-function">(<span class="hljs-params">cat</span>) =&gt;</span> cat.cSlug === route.params.CategorySlug)
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">const</span> [products, productsImages] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(<font></font>
      [<font></font>
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>),
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>)<font></font>
      ]<font></font>
    )<font></font>
    <span class="hljs-keyword">const</span> crubms = getBreadcrumbs(<span class="hljs-string">'category'</span>, route, category)
    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'setBreadcrumbs'</span>, crubms)<font></font>
<font></font>
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_CURRENT_CATEGORY'</span>, addProductsToCategory(products, productsImages, category))<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> getCurrentProduct ({ commit, dispatch }, { route }) {
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">const</span> productSlug = route.params.ProductSlug
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">const</span> [products, productsImages, alsoBuyProducts, interestingProducts] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(<font></font>
      [<font></font>
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>),
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>),<font></font>
        dispatch(<span class="hljs-string">'getProductsListByIds'</span>),<font></font>
        dispatch(<span class="hljs-string">'getProductsListByIds'</span>)<font></font>
      ]<font></font>
<font></font>
    )<font></font>
    <span class="hljs-keyword">const</span> product = getProduct(products, productsImages, productSlug)
    <span class="hljs-keyword">const</span> crubms = getBreadcrumbs(<span class="hljs-string">'product'</span>, route, product)
    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'setBreadcrumbs'</span>, crubms)
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_CURRENT_PRODUCT'</span>, { ...product, alsoBuyProducts, interestingProducts })<font></font>
  }<font></font>
<font></font>
}<font></font>
</code></pre></div></div><br>
<p><strong>getProductsByIds</strong>    api <br>
<strong>getProductsListByIds</strong> action     .       5 </p><br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">const</span> productSlug = route.params.ProductSlug
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">const</span> [products, productsImages, alsoBuyProducts, interestingProducts] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(<font></font>
      [<font></font>
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>),
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>),<font></font>
        dispatch(<span class="hljs-string">'getProductsListByIds'</span>),<font></font>
        dispatch(<span class="hljs-string">'getProductsListByIds'</span>)<font></font>
      ]<font></font>
<font></font>
    )<font></font>
    <span class="hljs-keyword">const</span> product = getProduct(products, productsImages, productSlug)
    <span class="hljs-keyword">const</span> crubms = getBreadcrumbs(<span class="hljs-string">'product'</span>, route, product)<font></font>
    dispatch(<span class="hljs-string">'setBreadcrumbs'</span>, crubms)<font></font>
    commit(<span class="hljs-string">'SET_CURRENT_PRODUCT'</span>, { ...product, alsoBuyProducts, interestingProducts })</code></pre><br>
<p>         .           <strong>alsoBuyProducts</strong> <strong>interestingProducts</strong>     . </p><br>
<p>             actions,   .       :</p><br>
<pre><code class="javascript hljs">        <span class="hljs-keyword">const</span> products = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>)
        <span class="hljs-keyword">const</span> productsImages = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>)
        <span class="hljs-keyword">const</span> alsoBuyProducts = <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'getProductsListByIds'</span>)
        <span class="hljs-keyword">const</span> interestingProducts = <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'getProductsListByIds'</span>)</code></pre><br>
<p>          .</p><br>
<p>         :</p><br>
<p><img src="https://habrastorage.org/webt/kw/xy/lm/kwxylmtd0b22ypzha-u82steboy.png"></p><br>
<p>  ,    </p><br>
<pre><code class="html hljs xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">:products</span>=<span class="hljs-string">"product.alsoBuyProducts"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">:products</span>=<span class="hljs-string">"product.interestingProducts"</span> /&gt;</span></code></pre><br>
<p>   <strong>ProductsList </strong></p><br>
<div class="spoiler"><b class="spoiler_title">ProductsList.vue</b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.wrapper"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"product in products"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"product.id"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"`/product/${product.pSlug}`"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ product.pName }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
          <span class="hljs-attr">v-lazy</span>=<span class="hljs-string">"product.images.imgL"</span>
          <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.image"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span> {{ product.pPrice }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BuyButton</span> <span class="hljs-attr">:product</span>=<span class="hljs-string">"product"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> BuyButton <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/components/common/BuyButton'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    BuyButton
  },
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">products</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">Array</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> []
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">module</span>&gt;</span><font></font>
.wrapper {<font></font>
  display: flex;<font></font>
  flex-wrap: wrap;<font></font>
  &gt; div {<font></font>
    margin: 1em;<font></font>
<font></font>
  }<font></font>
  p {<font></font>
    max-width: 270px;<font></font>
    height: 35px;<font></font>
  }<font></font>
}<font></font>
.image {<font></font>
  width: 300px;<font></font>
  height: 300px;<font></font>
  object-fit: cover;<font></font>
}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div><br>
<p>       .   :</p><br>
<p><img src="https://habrastorage.org/webt/bd/8f/iw/bd8fiwbqfc0h-i-bbcirv-3-9ji.png"></p><br>
<h2 id="vy-gotovy-k-nastoyaschemu-hardkoru">    ?</h2><br>
<p> ,     client-side only,     (    ).      ( ) , .</p><br>
<p>             24 !</p><br>
<p>   :</p><br>
<ol>
<li>   id       ,     .</li>
<li> action,     id    -   (, ,   .).</li>
<li> getter,        -.</li>
<li> vuex store  localstorage    ,         api   .</li>
<li> 100500   .</li>
<li>       ,           &lt;client-only&gt;,      DOM   (   ).</li>
</ol><br>
<h3 id="teper-o-realizacii">  </h3><br>
<p>    2 :</p><br>
<ul>
<li> <strong>products</strong>    { qty, productId, order }</li>
<li> <strong>metaProducts</strong>        api (, ,   .)</li>
</ul><br>
<p>         ,    1          .     getter.    computed  ,        . </p><br>
<p>  </p><br>
<pre><code class="javascript hljs">  getProductsInCart: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> products = []<font></font>
    state.products.map(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> metaProduct = state.metaProducts.find(<span class="hljs-function"><span class="hljs-params">mp</span> =&gt;</span> mp.id === p.productId)
      <span class="hljs-keyword">if</span> (metaProduct) {<font></font>
        products.push({ ...p, <span class="hljs-attr">meta</span>: metaProduct })<font></font>
      }<font></font>
    })<font></font>
    <span class="hljs-keyword">return</span> products.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.order - b.order)<font></font>
  }</code></pre><br>
<p>       .       -,     </p><br>
<pre><code class="javascript hljs">{ ...p, <span class="hljs-attr">meta</span>: metaProduct }</code></pre><br>
<p> <strong>p</strong>  { qty, productId, order },  <strong>const products</strong></p><br>
<p>        products,    <strong>order</strong>  .</p><br>
<p>   ,    <strong>merge</strong>.   ,     api  ,      <strong>products</strong>.   ,    ,       ,     .       ,           -. </p><br>
<p> , ,  -    api,    merge  .     .</p><br>
<h3 id="pishem-mutations"> mutations</h3><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mutations = {<font></font>
  ADD_PRODUCT (state, productId) {<font></font>
    <span class="hljs-comment">// if cart doesn't have product add it</span>
    <span class="hljs-keyword">if</span> (!state.products.find(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> productId === p.productId)) {<font></font>
      state.products = [...state.products, { <span class="hljs-attr">productId</span>: productId, <span class="hljs-attr">qty</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">order</span>: findMax(state.products, <span class="hljs-string">'order'</span>) + <span class="hljs-number">1</span> }]<font></font>
    }<font></font>
  },<font></font>
  REMOVE_PRODUCT (state, productId) {<font></font>
    state.products = <span class="hljs-built_in">Array</span>.from(state.products.filter(<span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId !== productId))<font></font>
  },<font></font>
  SET_PRODUCT_QTY (state, { productId, qty }) {<font></font>
    state.products = [<font></font>
      ...state.products.filter(<span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId !== productId),<font></font>
      { ...state.products.find(<span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId === productId), qty }<font></font>
    ]<font></font>
  },<font></font>
  SET_PRODUCTS_BY_IDS (state, products) {<font></font>
    state.metaProducts = products<font></font>
  }<font></font>
<font></font>
}</code></pre><br>
<p><strong>ADD_PRODUCT</strong> ‚Äî ,    ,    <strong>qty = 1 </strong> (        1 .)       <strong>+ 1</strong>.</p><br>
<p>       </p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> findMax = <span class="hljs-function">(<span class="hljs-params">array, field</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!array || array.lenght === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(...array.map(<span class="hljs-function"><span class="hljs-params">o</span> =&gt;</span> o[field]), <span class="hljs-number">0</span>)<font></font>
}</code></pre><br>
<p>       ,         .<br>
<strong>REMOVE_PRODUCT</strong> ‚Äî  <br>
<strong>SET_PRODUCT_QTY </strong> ‚Äî     <br>
<strong>SET_PRODUCTS_BY_IDS </strong> ‚Äî  -</p><br>
<h3 id="pishem-actions"> actions</h3><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> actions = {
  <span class="hljs-keyword">async</span> setProductsListByIds ({ commit, state }) {
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">const</span> [products, productsImages] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(<font></font>
      [<font></font>
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products.json'</span>),
        <span class="hljs-keyword">this</span>.$axios.$get(<span class="hljs-string">'/mock/products-images.json'</span>)<font></font>
      ]<font></font>
<font></font>
    )<font></font>
    <span class="hljs-keyword">const</span> productsIds = state.products.map(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.productId)
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_PRODUCTS_BY_IDS'</span>, mock.getProductsByIds(products, productsImages, productsIds))<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> addProduct ({ commit, dispatch }, productId) {
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'ADD_PRODUCT'</span>, productId)
    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'setProductsListByIds'</span>)<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> removeProduct ({ commit, dispatch }, productId) {
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'REMOVE_PRODUCT'</span>, productId)
    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'setProductsListByIds'</span>)<font></font>
  },<font></font>
  <span class="hljs-keyword">async</span> setProductQuantity ({ commit, dispatch }, { productId, qty }) {
    <span class="hljs-comment">// simulate api work</span>
    <span class="hljs-keyword">await</span> sleep(<span class="hljs-number">50</span>)
    <span class="hljs-keyword">await</span> commit(<span class="hljs-string">'SET_PRODUCT_QTY'</span>, { productId, qty })
    <span class="hljs-keyword">await</span> dispatch(<span class="hljs-string">'setProductsListByIds'</span>)<font></font>
  }<font></font>
<font></font>
}</code></pre><br>
<p>      <strong>await dispatch('setProductsListByIds')</strong>    -  api.</p><br>
<p>     ,    api      ,       ,  ,     .      ,        ,      .</p><br>
<h3 id="sozdayom-modalnoe-okno">  </h3><br>
<p>   vue-modal.js</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> VModal <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-js-modal'</span><font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> (context, inject) =&gt; {<font></font>
  Vue.use(VModal)<font></font>
}<font></font>
</code></pre><br>
<p>        <strong>nuxt.config.js</strong></p><br>
<pre><code class="javascript hljs">{ <span class="hljs-attr">src</span>: <span class="hljs-string">'~~/plugins/vue-modal.js'</span>, <span class="hljs-attr">mode</span>: <span class="hljs-string">'client'</span> },</code></pre><br>
<h4 id="sozdayom-komponent"> </h4><br>
<p><strong>mode: 'client' </strong>   ,        </p><br>
<p>  components/modals   CastomerCartModal.vue</p><br>
<div class="spoiler"><b class="spoiler_title">CastomerCartModal.vue</b><div class="spoiler_text"><pre><code class="javascript hljs">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">client-only</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">modal</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"customer-cart"</span>
        <span class="hljs-attr">transition</span>=<span class="hljs-string">"pop-out"</span>
        <span class="hljs-attr">height</span>=<span class="hljs-string">"95%"</span>
        <span class="hljs-attr">width</span>=<span class="hljs-string">"95%"</span>
        <span class="hljs-attr">:max-width</span>=<span class="hljs-string">"960"</span>
        <span class="hljs-attr">:adaptive</span>=<span class="hljs-string">"true"</span>
        <span class="hljs-attr">:scrollable</span>=<span class="hljs-string">"true"</span>
        <span class="hljs-attr">:pivot-y</span>=<span class="hljs-string">"0.5"</span>
        <span class="hljs-attr">:reset</span>=<span class="hljs-string">"true"</span>
        <span class="hljs-attr">classes</span>=<span class="hljs-string">"v--modal-customer-cart"</span>
        @<span class="hljs-attr">before-open</span>=<span class="hljs-string">"beforeOpen"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-wrapper content-padding"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">" header-block"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"h1-header"</span>&gt;</span>
              Cart
            <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$modal.hide('customer-cart')"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">CloseOrDeleteButton</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getProductsInCart.length === 0"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">""</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
                ,      :)
            <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-else</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"wrapper"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getAddedProduct"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"added-product "</span>&gt;</span>
                  You've added
                <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">class</span>=<span class="hljs-string">""</span> <span class="hljs-attr">:products-from-cart</span>=<span class="hljs-string">"getAddedProduct"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getProducts.length &gt; 0"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"added-product "</span>&gt;</span>
                  Previously added products
                <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"products"</span> <span class="hljs-attr">:products-from-cart</span>=<span class="hljs-string">"getProducts"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Total: {{ getAmount | round }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bottom"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"button color-grey close-button"</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"$modal.hide('customer-cart')"</span>&gt;</span>
                Close
              <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"amount-block"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span>
                  <span class="hljs-attr">to</span>=<span class="hljs-string">"/checkout"</span>
                  <span class="hljs-attr">class</span>=<span class="hljs-string">"button color-primary checkout-button"</span>
                &gt;</span>
                  To checkout
                <span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">modal</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">client-only</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
&lt;/template&gt;<font></font>
<font></font>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { mapGetters } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>
<span class="hljs-keyword">import</span> ProductsList <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/components/cart/ProductsList.vue'</span>
<span class="hljs-keyword">import</span> CloseOrDeleteButton <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/components/common/input/CloseOrDeleteButton.vue'</span>
<span class="hljs-keyword">import</span> round <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/mixins/round.js'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    ProductsList,
    CloseOrDeleteButton
  },
  <span class="hljs-attr">mixins</span>: [round],
  data () {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">addedProduct</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">defaults</span>: {
        <span class="hljs-attr">addedProduct</span>: <span class="hljs-literal">null</span>
      }
    }
  },

  <span class="hljs-attr">computed</span>: {
    ...mapGetters({
      <span class="hljs-attr">getProductsInCart</span>: <span class="hljs-string">'cart/getProductsInCart'</span>
    }),
    getAddedProduct () {
      <span class="hljs-keyword">const</span> product = <span class="hljs-keyword">this</span>.getProductsInCart.find(
        <span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId === <span class="hljs-keyword">this</span>.addedProduct
      )
      <span class="hljs-keyword">if</span> (product) {
        <span class="hljs-keyword">return</span> [product]
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
      }
    },
    getAmount () {
      <span class="hljs-keyword">let</span> amount = <span class="hljs-number">0</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getProductsInCart &amp;&amp; <span class="hljs-keyword">this</span>.getProductsInCart.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.getProductsInCart.forEach(<span class="hljs-function"><span class="hljs-params">product</span> =&gt;</span> {
          amount +=
            <span class="hljs-built_in">parseFloat</span>(product.meta.pPrice) *
            <span class="hljs-built_in">parseInt</span>(product.qty)
        })
        <span class="hljs-keyword">return</span> amount
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
      }
    },
    getProducts () {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.addedProduct) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getProductsInCart.filter(
          <span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId !== <span class="hljs-keyword">this</span>.addedProduct
        )
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getProductsInCart
      }
    }

  },

  <span class="hljs-attr">watch</span>: {
    <span class="hljs-attr">$route</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$modal.hide(<span class="hljs-string">'customer-cart'</span>)
    },
    <span class="hljs-attr">getProductsInCart</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">newVal, oldVal</span>) </span>{
      <span class="hljs-keyword">if</span> (oldVal.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getProductsInCart.length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">this</span>.$modal.hide(<span class="hljs-string">'customer-cart'</span>)
        }
      }
    }
  },
  <span class="hljs-attr">methods</span>: {
    beforeOpen (event) {
      <span class="hljs-keyword">if</span> (!event.params) {
        event.params = {}
      }
      <span class="hljs-keyword">if</span> (event.params.addedProduct) {
        <span class="hljs-keyword">this</span>.addedProduct = event.params.addedProduct
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.addedProduct = <span class="hljs-keyword">this</span>.defaults.addedProduct
      }
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span>
.submit-error {
  font-weight: 500;
  color: #de0d0d;
  // font-weight: 300;
  font-size: 0.7em;
}
.modal-wrapper {
  // border: 3px solid $accent-border-color;
  background: #fff;
  overflow-y: scroll;
  // margin-top: 20px;
  height: 100%;

  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.bottom {
  flex-shrink: 0;
  margin-bottom: 30px;
  display: flex;
  justify-content: flex-start;
  // align-items: flex-start;
  flex-direction: column;
  margin-top: 16px;
  @media screen and (min-width: 1024px) {
    justify-content: space-between;
    flex-direction: row;
    align-items: flex-end;
    padding-bottom: 50px;
  }
  .close-button {
    display: none;
  @media screen and (min-width: 1024px) {
      display: block;
    }
  }
  .amount-block {
    .checkout-button {
      margin-top: 5px;
      width: 100%;
      display: flex;
        @media screen and (min-width: 640px) {
        width: auto;
      }
    }
  }

  button.bttn-material-flat {
    font-size: 1rem;
  @media screen and (min-width: 1024px) {
      font-size: 1.4rem;
    }
  }
}
p.added-product {
  font-size: 1.6rem;
  margin-bottom: 1rem;
}

.wrapper {
  // height: 100%;
  flex-grow: 1;
  position: relative;
}
.header-block {
  flex-shrink: 0;
  // padding: 10px 20px;
  margin-top: 20px;
  // background: #f8fafb;
  // font-size: 1.6rem;
  position: relative;
  margin-bottom: 1rem;
  .close {
    position: absolute;
    right: 12px;
    top: 0;
  }
}

.pop-out-enter-active,
.pop-out-leave-active {
  transition: all 0.5s;
}
.pop-out-enter,
.pop-out-leave-active {
  opacity: 0;
  transform: translateY(24px);
}
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre></div></div><br>
<p>    . </p><br>
<p>    <strong>&lt;client-only&gt;</strong>,  Vue      .</p><br>
<h4 id="modal">modal</h4><br>
<ul>
<li><strong>name="customer-cart"</strong>      ,  /     (       )</li>
<li><strong>:adaptive="true"</strong>     95%,          (   ,   95%)</li>
<li><strong>:scrollable="true" </strong>  body     .</li>
<li><strong>:pivot-y="0.5"</strong>    </li>
<li><strong>:reset="true"</strong>       (   )</li>
<li><strong>classes="v--modal-customer-cart"</strong>   </li>
<li><strong>@before-open="beforeOpen"</strong>         (   )</li>
</ul><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$modal.hide('customer-cart')"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">CloseOrDeleteButton</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><br>
<p><strong>CloseOrDeleteButton </strong>   svg  (     .<br>
<strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">click</a>="$modal.hide('customer-cart')"</strong>     ,      </p><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getAddedProduct"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"added-product "</span>&gt;</span><font></font>
    You've added<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">class</span>=<span class="hljs-string">""</span> <span class="hljs-attr">:products-from-cart</span>=<span class="hljs-string">"getAddedProduct"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"getProducts.length &gt; 0"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"added-product "</span>&gt;</span><font></font>
    Previously added products<font></font>
  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ProductsList</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"products"</span> <span class="hljs-attr">:products-from-cart</span>=<span class="hljs-string">"getProducts"</span> /&gt;</span></code></pre><br>
<p><strong>ProductsList </strong>      ,     .<br>
     , ,     ,       <strong>You've added</strong>,       <strong>Previously added products</strong>.         (    ,   ,  <strong>getAddedProduct</strong>  <strong>null</strong>          .</p><br>
<p><strong>getAddedProduct</strong>  <strong>getProducts</strong> ‚Äî   ,      <strong>addedProduct</strong>     .</p><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Total: {{ getAmount | round }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><br>
<p>   | ()    ,     round (     )   .</p><br>
<p>         <strong>mixins\round.js</strong></p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">filters</span>: {<font></font>
    round (num) {<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round((num + <span class="hljs-built_in">Number</span>.EPSILON) * <span class="hljs-number">100</span>) / <span class="hljs-number">100</span><font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
<p>      </p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> round <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/mixins/round.js'</span><font></font>
...<font></font>
mixins: [round]</code></pre><br>
<p>        , </p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">this</span>.$modal.show(<span class="hljs-string">'customer-cart'</span>, { <span class="hljs-attr">addedProduct</span>: <span class="hljs-keyword">this</span>.product.id })</code></pre><br>
<p>       <strong>beforeOpen</strong></p><br>
<pre><code class="javascript hljs">  methods: {<font></font>
    beforeOpen (event) {<font></font>
      <span class="hljs-keyword">if</span> (!event.params) {<font></font>
        event.params = {}<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (event.params.addedProduct) {
        <span class="hljs-keyword">this</span>.addedProduct = event.params.addedProduct<font></font>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.addedProduct = <span class="hljs-keyword">this</span>.defaults.addedProduct<font></font>
      }<font></font>
    }<font></font>
  }</code></pre><br>
<p> ,       <strong>data()</strong></p><br>
<pre><code class="javascript hljs">  data () {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">addedProduct</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">defaults</span>: {
        <span class="hljs-attr">addedProduct</span>: <span class="hljs-literal">null</span><font></font>
      }<font></font>
    }<font></font>
  },</code></pre><br>
<p>        store.</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { mapGetters } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span><font></font>
...<font></font>
  computed: {<font></font>
    ...mapGetters({<font></font>
      <span class="hljs-attr">getProductsInCart</span>: <span class="hljs-string">'cart/getProductsInCart'</span><font></font>
    }),<font></font>
...</code></pre><br>
<p>      actions     .</p><br>
<p>-     ""     (   ,         )    <strong>getProductsInCart</strong> ,    .</p><br>
<pre><code class="javascript hljs">    getAddedProduct () {
      <span class="hljs-keyword">const</span> product = <span class="hljs-keyword">this</span>.getProductsInCart.find(
        <span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId === <span class="hljs-keyword">this</span>.addedProduct<font></font>
      )<font></font>
      <span class="hljs-keyword">if</span> (product) {
        <span class="hljs-keyword">return</span> [product]<font></font>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><font></font>
      }<font></font>
    },<font></font>
    getProducts () {<font></font>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.addedProduct) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getProductsInCart.filter(
          <span class="hljs-function"><span class="hljs-params">prod</span> =&gt;</span> prod.productId !== <span class="hljs-keyword">this</span>.addedProduct<font></font>
        )<font></font>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getProductsInCart<font></font>
      }<font></font>
    }</code></pre><br>
<p>    - ,       (     ).   :</p><br>
<pre><code class="javascript hljs">  watch: {
    <span class="hljs-attr">$route</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">this</span>.$modal.hide(<span class="hljs-string">'customer-cart'</span>)<font></font>
    }</code></pre><br>
<p>     <strong>route</strong>  .</p><br>
<p>       ,     ,    .</p><br>
<pre><code class="javascript hljs">  watch: {<font></font>
...<font></font>
    getProductsInCart: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">newVal, oldVal</span>) </span>{
      <span class="hljs-keyword">if</span> (oldVal.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getProductsInCart.length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">this</span>.$modal.hide(<span class="hljs-string">'customer-cart'</span>)<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
...</code></pre><br>
<h3 id="sozdayom-productslist"> ProductsList</h3><br>
<p>    :</p><br>
<ul>
<li> </li>
<li>   ( debounce     ,       )</li>
<li> </li>
</ul><br>
<div class="spoiler"><b class="spoiler_title">ProductsList.vue</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"productsFromCart.length &gt; 0"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.wrapper"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">v-for</span>=<span class="hljs-string">"product in productsFromCart"</span>
      <span class="hljs-attr">:key</span>=<span class="hljs-string">"product.productId"</span>
      <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.product"</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CloseOrDeleteButton</span>
          <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.remove"</span>
          <span class="hljs-attr">button-type</span>=<span class="hljs-string">"delete"</span>
          @<span class="hljs-attr">click.native</span>=<span class="hljs-string">"onRemoveClickHandler(product)"</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"`/product/${product.meta.pSlug}`"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
            <span class="hljs-attr">v-lazy</span>=<span class="hljs-string">"product.meta.images.imgL"</span>
            <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.image"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">nuxt-link</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.pName"</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"`/product/${product.meta.pSlug}`"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ product.meta.pName }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">nuxt-link</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Price: <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ product.meta.pPrice }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Quantity:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">:value</span>=<span class="hljs-string">"product.qty"</span>
            <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.input"</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">:min</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">:max</span>=<span class="hljs-string">"1000"</span>
            @<span class="hljs-attr">change.prevent</span>=<span class="hljs-string">"onQuantityChangeHandler($event, product)"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Amount:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ (product.meta.pPrice * product.qty) | round }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> CloseOrDeleteButton <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/components/common/input/CloseOrDeleteButton.vue'</span>
<span class="hljs-keyword">import</span> round <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/mixins/round'</span>
<span class="hljs-keyword">import</span> { mapActions } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>
<span class="hljs-keyword">import</span> debounce <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash.debounce'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    CloseOrDeleteButton
  },
  <span class="hljs-attr">mixins</span>: [round],
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">productsFromCart</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">Array</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> []
    }
  },
  <span class="hljs-attr">methods</span>: {
    ...mapActions({
      <span class="hljs-attr">setProductQuantity</span>: <span class="hljs-string">'cart/setProductQuantity'</span>,
      <span class="hljs-attr">removeProduct</span>: <span class="hljs-string">'cart/removeProduct'</span>
    }),
    onRemoveClickHandler (product) {
      <span class="hljs-keyword">this</span>.removeProduct(product.productId)
    },
    <span class="hljs-attr">onQuantityChangeHandler</span>: debounce(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onQuantityChangeHandler</span> (<span class="hljs-params">e, product</span>) </span>{
      <span class="hljs-keyword">const</span> qty = e.target.value
      <span class="hljs-keyword">this</span>.setProductQuantity({ <span class="hljs-attr">productId</span>: product.productId, qty })
    }, <span class="hljs-number">400</span>)

  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">module</span>&gt;</span><font></font>
.input {<font></font>
  height: 20px;<font></font>
}<font></font>
    .remove {<font></font>
      top: -15px;<font></font>
      position: absolute;<font></font>
      left: -30px;<font></font>
      z-index: 1;<font></font>
    }<font></font>
.wrapper {<font></font>
  display: flex;<font></font>
  flex-wrap: wrap;<font></font>
  flex-direction: column;<font></font>
  .product {<font></font>
    position: relative;<font></font>
    margin: 1em;<font></font>
    display: flex;<font></font>
    flex-direction: row;<font></font>
<font></font>
    * {<font></font>
      margin-right: 10px;<font></font>
    }<font></font>
    .pName {<font></font>
      width: 150px;<font></font>
    }<font></font>
  }<font></font>
<font></font>
  p {<font></font>
    max-width: 270px;<font></font>
    height: 35px;<font></font>
  }<font></font>
}<font></font>
.image {<font></font>
  width: 75px;<font></font>
  height: 75px;<font></font>
  object-fit: cover;<font></font>
}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div><br>
<p>   2 actions     </p><br>
<pre><code class="javascript hljs">    ...mapActions({
      <span class="hljs-attr">setProductQuantity</span>: <span class="hljs-string">'cart/setProductQuantity'</span>,
      <span class="hljs-attr">removeProduct</span>: <span class="hljs-string">'cart/removeProduct'</span>
    }),</code></pre><br>
<p>     </p><br>
<pre><code class="javascript hljs">    onQuantityChangeHandler: debounce(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onQuantityChangeHandler</span> (<span class="hljs-params">e, product</span>) </span>{
      <span class="hljs-keyword">const</span> qty = e.target.value
      <span class="hljs-keyword">this</span>.setProductQuantity({ <span class="hljs-attr">productId</span>: product.productId, qty })<font></font>
    }, <span class="hljs-number">400</span>)</code></pre><br>
<p>    <strong>e.target.value</strong>   <strong>setProductQuantity</strong>.       <strong>debounce</strong>,      lodash </p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> debounce <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash.debounce'</span></code></pre><br>
<p>      <strong>round</strong>       <strong>CloseOrDeleteButton</strong></p><br>
<p>  :</p><br>
<div class="spoiler"><b class="spoiler_title">CloseOrDeleteButton.vue</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"svg-icon-block"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">SvgClose</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{'svg-icon-close': buttonType === 'close', 'svg-icon-delete': buttonType === 'delete'}"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> SvgClose <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/assets/svg/baseline-close-24px.svg?inline'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    SvgClose
  },
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">buttonType</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-string">'close'</span>
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><font></font>
.svg-icon-delete {<font></font>
  // background: #ddd;<font></font>
  fill: #ffb2a9;<font></font>
  border: 3px solid #ffb2a9;<font></font>
  transition: all .3s ease;<font></font>
    width: 20px;<font></font>
  height: 20px;<font></font>
  &amp;:hover {<font></font>
    // background: #ddd;<font></font>
    fill: #fb3f4c;<font></font>
    border-color: #fb3f4c;<font></font>
  }<font></font>
    @media (--mobile) {<font></font>
    width: 20px;<font></font>
    height: 20px;<font></font>
    border-width: 3px;<font></font>
  }<font></font>
}<font></font>
.svg-icon-close {<font></font>
  background: hsl(0, 0%, 60%);<font></font>
  fill: #fff;<font></font>
  border: 8px solid hsl(0, 0%, 60%);<font></font>
    width: 20px;<font></font>
  height: 20px;<font></font>
  &amp;:hover {<font></font>
    background: hsl(0, 0%, 33%);<font></font>
    fill: #fff;<font></font>
    border-color :hsl(0, 0%, 33%);<font></font>
  }<font></font>
}<font></font>
.svg-icon-block {<font></font>
  display: block;<font></font>
  cursor: pointer;<font></font>
}<font></font>
svg {<font></font>
  border-radius: 100%;<font></font>
  opacity: 0.7;<font></font>
  line-height: 0;<font></font>
<font></font>
  box-sizing: content-box;<font></font>
  // // noselect<font></font>
  // -webkit-user-select: none; /* webkit (safari, chrome) browsers */<font></font>
  // -moz-user-select: none; /* mozilla browsers */<font></font>
  // -khtml-user-select: none; /* webkit (konqueror) browsers */<font></font>
  // -ms-user-select: none; /* IE10+ */<font></font>
<font></font>
}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div><br>
<p>,    ‚Äî      svg</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> SvgClose <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/assets/svg/baseline-close-24px.svg?inline'</span></code></pre><br>
<p><strong>?inline</strong> ,      svg   ,       html     (      svg).</p><br>
<h3 id="v-itoge"> </h3><br>
<p><img src="https://habrastorage.org/webt/9c/_k/vo/9c_kvoonhk1jp8ergjwgz3socqw.png"></p><br>
<p>    .      (  2    ,      LocalStorage).</p><br>
<h3 id="dobavim-ikonku-korziny">  </h3><br>
<p> </p><br>
<div class="spoiler"><b class="spoiler_title">components\header\CartButton.vue</b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.block"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">client-only</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span>
        <span class="hljs-attr">:href</span>=<span class="hljs-string">"'#'"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.cartButton"</span>
        <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"!productsQuantity &gt; 0 "</span>
        @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">"onClickHandler"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"productsQuantity &gt; 0"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.quantity"</span>&gt;</span><font></font>
          {{ productsQuantity }}<font></font>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CartSvg</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"$style.svg1"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">client-only</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { mapState } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>
<span class="hljs-keyword">import</span> CartSvg <span class="hljs-keyword">from</span> <span class="hljs-string">'~~/assets/svg/shopping-cart.svg?inline'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: {
    CartSvg
  },
  <span class="hljs-attr">computed</span>: {
    ...mapState({
      <span class="hljs-attr">products</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.cart.products
    }),
    productsQuantity () {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.products) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.products.length
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    }
  },
  <span class="hljs-attr">methods</span>: {
    onClickHandler () {
      <span class="hljs-keyword">this</span>.$modal.show(<span class="hljs-string">'customer-cart'</span>)
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">module</span>&gt;</span><font></font>
.block {<font></font>
  position: relative;<font></font>
}<font></font>
.cartButton {<font></font>
  position: relative;<font></font>
  display: flex;<font></font>
  flex-direction: row;<font></font>
  justify-content: center;<font></font>
  align-items: center;<font></font>
  width: 68px;<font></font>
  height: 72px;<font></font>
  text-align: center;<font></font>
  transition: all 0.3s ease-in-out;<font></font>
}<font></font>
.svg1 {<font></font>
  margin-right: 3px;<font></font>
  width: 40px;<font></font>
  fill: #000;<font></font>
  // noselect<font></font>
  -webkit-user-select: none; /* webkit (safari, chrome) browsers */<font></font>
  -moz-user-select: none; /* mozilla browsers */<font></font>
  -khtml-user-select: none; /* webkit (konqueror) browsers */<font></font>
  -ms-user-select: none; /* IE10+ */<font></font>
}<font></font>
.quantity {<font></font>
    position: absolute;<font></font>
    right: 5px;<font></font>
    top: 5px;<font></font>
    border-radius: 50px;<font></font>
    background-color: #fb3f4c;<font></font>
    width: 20px;<font></font>
    color: #fff;<font></font>
    height: 20px;<font></font>
    text-align: center;<font></font>
    line-height: 20px;<font></font>
    font-size: .8rem;<font></font>
    font-weight: 600;<font></font>
  // noselect<font></font>
  -webkit-user-select: none; /* webkit (safari, chrome) browsers */<font></font>
  -moz-user-select: none; /* mozilla browsers */<font></font>
  -khtml-user-select: none; /* webkit (konqueror) browsers */<font></font>
  -ms-user-select: none; /* IE10+ */<font></font>
}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div><br>
<p>     Header. </p><br>
<p>         ( -)      ,  </p><br>
<pre><code class="javascript hljs">    ...mapState({
      <span class="hljs-attr">products</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.cart.products<font></font>
    }),</code></pre><br>
<p> ,           .</p><br>
<p>  <br>
<img src="https://habrastorage.org/webt/ln/2r/yw/ln2rywtf74mqq-isiwaguwmvgx0.png"></p><br>
<h3 id="itogi"></h3><br>
<ul>
<li><strong> </strong>:  Github <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>.</li>
<li><strong> </strong>: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">1 </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">2 </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">3 </a></li>
</ul><br>
<p>       Nuxt.<br>
   ,      ,  .<br>
       -.<br>
         ,     .     (  )      .</p><br>
<h3 id="posleslovie"></h3><br>
<p>        ,  ,         ,   .</p><br>
<p>  !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar491176/index.html">5 ÿπŸÑÿßŸÖÿßÿ™ ÿπŸÑŸâ ÿ®Ÿäÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨</a></li>
<li><a href="../ar491180/index.html">ŸÉŸäŸÅ Ÿäÿ≥ÿßÿπÿØ Estimate ŸÅŸä ÿ£ÿ™ŸÖÿ™ÿ© ÿπŸÖŸÑŸäÿ© ÿßŸÑÿ™ŸÇŸäŸäŸÖ ŸàŸÖÿπÿ±ŸÅÿ© ÿ™ŸÉŸÑŸÅÿ© ŸÖÿ¥ÿ±Ÿàÿπ ÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™</a></li>
<li><a href="../ar491182/index.html">ÿ£ÿ™ŸÖÿ™ÿ© ÿßŸÑŸÖŸÜÿ≤ŸÑ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ ŸÅŸä ŸÖÿ®ŸÜŸâ ÿ¨ÿØŸäÿØ. ÿßÿ≥ÿ™ŸÖÿ±ÿßÿ±</a></li>
<li><a href="../ar491186/index.html">5 ÿ∑ÿ±ŸÇ ŸÑŸÅÿ¥ŸÑ ÿ™ŸÜŸÅŸäÿ∞ DDD</a></li>
<li><a href="../ar491188/index.html">ŸÖÿß Ÿäÿ¨ÿ® ÿ£ŸÜ Ÿäÿπÿ±ŸÅŸá ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿÆŸÑŸÅŸäÿ©</a></li>
<li><a href="../ar491192/index.html">ŸÅŸäÿ¨ŸÖŸäÿ±Ÿà. ÿπŸÖŸÑ ŸÖŸÉŸàŸëŸÜ ÿ•ÿ∂ÿßŸÅŸä ŸÑŸÄ Figma (ŸàŸÇŸÑŸäŸÑÿßŸã ŸÑŸÄ Miro)</a></li>
<li><a href="../ar491194/index.html">Ÿàÿ±ÿßÿ´ÿ© ÿßŸÑŸÖŸÜÿ¥ÿ£. ÿßŸÑÿ™ÿ±ŸÉŸäÿ® ÿßŸÑÿ≥ŸÉÿßŸÜŸä</a></li>
<li><a href="../ar491198/index.html">ÿ≥ÿ™ ŸÜÿµÿßÿ¶ÿ≠ ŸÑÿµŸÜÿπ ÿßŸÑÿ®ÿ±ŸÜÿßŸÖÿ¨ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä ÿßŸÑŸÖŸÜÿßÿ≥ÿ® ŸÑŸÑÿπÿ®ÿ©</a></li>
<li><a href="../ar491200/index.html">ÿ™ŸàŸÇŸäÿ™ Ÿàÿ∏ŸäŸÅÿ© ŸÑŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿµŸÜÿßÿπŸä Simatic S7-1200</a></li>
<li><a href="../ar491202/index.html">ÿßŸÑŸÖŸáŸÜÿØÿ≥ŸäŸÜ ŸÖŸÇÿßÿ®ŸÑ ÿßŸÑŸÖÿµŸÖŸÖŸäŸÜ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>