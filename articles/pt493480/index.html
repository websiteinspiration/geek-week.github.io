<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👷 🧑🏿 👩🏼 Arquitetura para iniciantes ou por que você não precisa inserir uma bandeira no homem-espada 🍤 👨🏾‍🎤 👨🏾‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anotação:
 
 

1. Um exemplo da implementação de novas funcionalidades na classe adicionando um "sinalizador".
2. Efeitos.
3. Abordagem alternativa e ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arquitetura para iniciantes ou por que você não precisa inserir uma bandeira no homem-espada</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493480/"><img src="https://habrastorage.org/webt/9s/96/tv/9s96tvz6feehvgoiz_gmwdoktl8.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anotação:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um exemplo da implementação de novas funcionalidades na classe adicionando um "sinalizador".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efeitos.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abordagem alternativa e comparação de resultados.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como evitar a situação: "Excesso arquitetônico"?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O momento em que chega a hora de mudar tudo.</font></font></li>
</ol></blockquote><br>
<a name="habracut"></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de começar, algumas notas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta é uma história sobre arquitetura de software - no sentido que o tio Bob usa. </font><font style="vertical-align: inherit;">Sim esse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos os personagens, seus nomes e códigos no artigo são fictícios, quaisquer coincidências com a realidade são aleatórias.</font></font></li>
</ul></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que eu seja um programador-programador comum em um projeto. </font><font style="vertical-align: inherit;">O projeto é um jogo no qual um único herói (também conhecido como herói) segue uma linha perfeitamente horizontal da esquerda para a direita. </font><font style="vertical-align: inherit;">Monstros interferem nessa jornada maravilhosa. </font><font style="vertical-align: inherit;">Sob o comando do usuário, o Herói os corta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com uma espada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no repolho e não sopra no bigode. </font><font style="vertical-align: inherit;">O projeto já possui 100 mil linhas e "você precisa de mais </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas de</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recursos!" </font><font style="vertical-align: inherit;">Vamos olhar para o nosso herói:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//   1</span><font></font>
    }<font></font>
    <span class="hljs-comment">//   </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha também que o líder da minha equipe pessoal, Vasily, também possa sair de férias. </font><font style="vertical-align: inherit;">De repente. </font><font style="vertical-align: inherit;">Quem teria pensado? </font><font style="vertical-align: inherit;">Além disso, a situação se desenvolve como padrão: uma Coruja chega e precisa urgentemente, ontem, de tornar possível escolher antes do início do jogo: jogar para o Herói com um taco ou com uma espada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve ser muito rápido. </font><font style="vertical-align: inherit;">E sim, é claro, ele próprio foi programador por mais de anos do que eu posso andar, então ele sabe que a tarefa é de cinco minutos. </font><font style="vertical-align: inherit;">Mas assim seja, faça uma estimativa de 2 horas. </font><font style="vertical-align: inherit;">Você só precisa adicionar uma caixa de seleção e if-chik. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: if-chik no valor @! ^% $ # @ ^% &amp; @! 11 $ its # $% @ ^% &amp;! @ !!! </font><font style="vertical-align: inherit;">em &amp;! ^% # $ ^%! 1 if-chic! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meus pensamentos: “Ha! </font><font style="vertical-align: inherit;">Duas horas! </font><font style="vertical-align: inherit;">Feito! ":</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">WeaponTypes</span> </span>{
        <span class="hljs-keyword">case</span> sword:
        <span class="hljs-keyword">case</span> club:<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-keyword">var</span> weaponType: <span class="hljs-type">WeaponTypes?</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> weaponType = weaponType <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">assertionFailure</span>()
            <span class="hljs-keyword">return</span>	<font></font>
        }<font></font>
        <span class="hljs-comment">//  : switch  Swift  if- -    !</span>
        <span class="hljs-keyword">switch</span> (weaponType) {
            <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//     </span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-comment">//  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você descobriu na minha decisão, então: infelizmente: tenho duas notícias para você:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como se fosse bom: nós dois entregamos. </font><font style="vertical-align: inherit;">Nós entregamos - a partir da palavra agregar valor ou da palavra código engraçado (através de lágrimas).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E o ruim: sem Vasily, o projeto kapets.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então o que aconteceu? </font><font style="vertical-align: inherit;">Parece até agora nada. </font><font style="vertical-align: inherit;">Mas vamos ver o que acontece a seguir (enquanto fazemos todo o possível para manter Vasily de férias). </font><font style="vertical-align: inherit;">E então haverá o seguinte: o departamento de controle de qualidade prestará atenção ao peso do nosso herói. </font><font style="vertical-align: inherit;">E não, isso não ocorre porque o Herói precisa seguir uma dieta, mas eis o porquê:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + swordWeight<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu esqueci de corrigir o cálculo do peso. </font><font style="vertical-align: inherit;">Bem, você pensa, erro, com quem não acontece ?! </font><font style="vertical-align: inherit;">Slap-bloop, fuck-tibidoch, pronto:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">//   guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + clubWeight<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas rapidamente consertou! </font><font style="vertical-align: inherit;">O herói agora está pulando, levando em consideração o peso, mas. </font><font style="vertical-align: inherit;">Trabalho orientado a resultados! </font><font style="vertical-align: inherit;">Não é para você olhar para umbigos, astronautas arquitetônicos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, sério, então ele corrigiu um pouco mais. </font><font style="vertical-align: inherit;">Na lista de feitiços, eu tinha que fazer isso:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//   guard let weaponType </span>
    <span class="hljs-comment">// ,   let spellsWithoutWeapon: [Spells]</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword:
            <span class="hljs-comment">//  let swordSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + swordSpells
	<span class="hljs-keyword">case</span> .club:
            <span class="hljs-comment">//  let clubSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + clubSpells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E então Petya veio e quebrou tudo. </font><font style="vertical-align: inherit;">Bem, a verdade é que temos um mês de junho no projeto. </font><font style="vertical-align: inherit;">Desatento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele só precisava adicionar o conceito de "Nível de Arma" às fórmulas para calcular a força do golpe e o peso do Herói. </font><font style="vertical-align: inherit;">E Petya perdeu um dos quatro casos. </font><font style="vertical-align: inherit;">Mas nada! </font><font style="vertical-align: inherit;">Corrigi tudo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//guard let weaponType</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//        weaponGrade</span>
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//        weaponGrade</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">// guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight / grade
	<span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + pow(clubWeight, <span class="hljs-number">1</span> / grade)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//     , ! </span>
    <span class="hljs-comment">// ,     .    ,    ,   .   !</span>
}</code></pre><br>
<img src="https://habrastorage.org/webt/aw/ev/fo/awevfo6jjlysv_8l9wq-dl9npkw.png" height="80" width="80" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escusado será dizer que, quando (de repente!) Foi necessário adicionar um arco / atualizar fórmulas, novamente houve casos esquecidos, bugs e isso foi tudo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que deu errado? </font><font style="vertical-align: inherit;">Onde eu estava errado, e o que (exceto os companheiros) Vasily disse quando ele voltou das férias? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui você não pode ler mais a história, mas, por exemplo, pensar sobre o eterno, sobre arquitetura. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E com aqueles que ainda decidiram ler, continuamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, vamos olhar para os clássicos:</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otimização prematura é a raiz de todo o mal!</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ... não é isso. </font><font style="vertical-align: inherit;">Aqui está a coisa: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas linguagens OOP (como Swift, por exemplo), existem três maneiras principais de estender os recursos de uma classe:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira maneira é "ingênua". </font><font style="vertical-align: inherit;">Nós apenas o vimos. </font><font style="vertical-align: inherit;">Adicionando uma caixa de seleção. </font><font style="vertical-align: inherit;">Adicionando responsabilidade. </font><font style="vertical-align: inherit;">Aula de inchaço.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A segunda maneira é herança. </font><font style="vertical-align: inherit;">Todo mundo conhece um mecanismo poderoso para reutilizar código. </font><font style="vertical-align: inherit;">Pode-se, por exemplo:</font></font><br>
 <ul>
<li><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herda o novo Herói com o Arco e o Herói de Dubina do Herói (que está segurando uma espada, mas isso não está refletido no nome da classe do Herói agora). </font><font style="vertical-align: inherit;">E então, nos herdeiros, substitua os métodos alterados. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este caminho é muito ruim (apenas confie em mim).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Torne a classe base (ou protocolo) um Herói e remova todos os recursos associados a um tipo específico de arma como herdeiro </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: Herói com uma </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
espada: Herói, </font><font style="vertical-align: inherit;">Herói com um </font><font style="vertical-align: inherit;">arco: Herói, Herói com </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dubina: Herói. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso é melhor, mas os próprios nomes dessas classes nos olham de alguma maneira descontentes, ferozmente e ao mesmo tempo tristes e perplexos. </font><font style="vertical-align: inherit;">Se eles não olharem para alguém assim, tentarei escrever outro artigo, onde, além do chato herói masculino, eles serão ...</font></font><img src="https://habrastorage.org/webt/7i/7w/l7/7i7wl7kxg1ol1mmtplsfv-h7i4w.png" height="80" width="80"></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A terceira maneira é a separação de responsabilidades através da injeção de dependência. </font><font style="vertical-align: inherit;">Pode ser uma dependência fechada por um protocolo ou um fechamento (como se estivesse fechada por uma assinatura), qualquer que seja. </font><font style="vertical-align: inherit;">O principal é que a implementação de novas responsabilidades saia da classe principal.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como isso pode parecer no nosso caso? </font><font style="vertical-align: inherit;">Por exemplo, assim (decisão de Vasily):</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-keyword">let</span> weapon: <span class="hljs-type">Weapon</span> <span class="hljs-comment">//   , ..    </span><font></font>
<font></font>
    <span class="hljs-keyword">init</span> (<span class="hljs-number">_</span> weapon: <span class="hljs-type">Weapon</span>) { <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">self</span>.weapon = weapon<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {<font></font>
        weapon.strike()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + weapon.weight<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> spellsWithoutWeapon + weapon.spells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que você precisa ser assim? </font><font style="vertical-align: inherit;">Ninjutsu - protocolo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {<span class="hljs-keyword">get</span>}
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {<span class="hljs-keyword">get</span>}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo de implementação de protocolo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>: <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da mesma forma, as aulas de espada são escritas para: Club, Bow, Pike, etc. </font><font style="vertical-align: inherit;">“É fácil ver” (c) que na nova arquitetura todo o código que se aplica a cada tipo específico de arma está agrupado na classe correspondente e não é espalhado de acordo com o Herói, juntamente com outros tipos de armas. </font><font style="vertical-align: inherit;">Isso facilita a leitura e a compreensão do Herói e de qualquer arma específica. </font><font style="vertical-align: inherit;">Além disso, devido aos requisitos do protocolo imposto, é muito mais fácil rastrear todos os métodos que precisam ser implementados ao adicionar um novo tipo de arma ou ao adicionar um novo recurso a uma arma (por exemplo, uma arma pode ter um método de cálculo de preço). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui você pode ver que a injeção de dependência complicou a criação de objetos da classe Hero. </font><font style="vertical-align: inherit;">O que costumava ser feito de maneira simples:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> lastHero = <span class="hljs-type">Hero</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora ele se transformou em um conjunto de instruções que serão duplicadas sempre que for necessário criar um Herói. </font><font style="vertical-align: inherit;">No entanto, Vasily cuidou disso:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSwordsman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> { <span class="hljs-comment">// ,  static -  </span>
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Sword</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeClubman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> {
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Club</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É claro que Vasily teve que suar para espalhar a pilha que foi </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empilhada,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> projetada por Petya (e eu). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, olhando para a última solução, o seguinte pensamento pode surgir:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, acabou, normas. </font><font style="vertical-align: inherit;">É conveniente ler e expandir, mas todas essas fábricas / protocolos / dependências são um monte de despesas gerais? </font><font style="vertical-align: inherit;">Um código que não fornece nada em termos de recursos, mas existe apenas para organizar o código. </font><font style="vertical-align: inherit;">"Código para organizar o código", mgm. </font><font style="vertical-align: inherit;">É realmente necessário cercar este jardim sempre e em qualquer lugar?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma resposta honesta para a primeira pergunta seria:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sim, essa é uma sobrecarga para os recursos que as empresas amam tanto. </font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E para a pergunta "quando?" </font><font style="vertical-align: inherit;">seção de respostas:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A filosofia do homem-espada ou "quando você teve que governar?"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No começo era um homem de espada. </font><font style="vertical-align: inherit;">No sistema dos sentidos do código antigo, isso era bastante normal. </font><font style="vertical-align: inherit;">Desde que houvesse um herói e uma arma, não havia necessidade de distinguir entre eles - mesmo assim, não havia mais nada para o herói. </font><font style="vertical-align: inherit;">E o código monolítico confirmou esse fato com seu texto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espadachim - nem parece tão ruim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E a que as primeiras edições “ingênuas” levaram? </font><font style="vertical-align: inherit;">A que a adição do if-chik levou? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicionar um if-chic levou a ... um mutante! </font><font style="vertical-align: inherit;">Mutante, isto é, </font><font style="vertical-align: inherit;">objeto mutável que pode alternar entre um "humano" e "humano Dubin". </font><font style="vertical-align: inherit;">Ao mesmo tempo, se você cometer um pequeno erro na implementação do mutante, o estado de "medulaína humana" surge. </font><font style="vertical-align: inherit;">Não faça assim! </font><font style="vertical-align: inherit;">Não há necessidade de "Dubin humano". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É necessário:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homem + dependência da espada (necessidade de espada);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homem + dependência de um clube (necessidade de um clube).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nem todo vício é mau! </font><font style="vertical-align: inherit;">Esse vício em álcool é mau e o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é bom. </font><font style="vertical-align: inherit;">Sim, até a dependência do objeto é melhor que o "Dubin humano"! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando a mutação aconteceu? </font><font style="vertical-align: inherit;">A transformação em mutante ocorreu quando a bandeira foi adicionada: o código monolítico permaneceu monolítico, mas quando a bandeira foi alterada (mutada), o comportamento do mesmo objeto começou a mudar significativamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vasily destacaria dois estágios da mutação:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando uma bandeira e o primeiro "se" (ou "alternar" ou outro mecanismo de ramificação) à bandeira. </font><font style="vertical-align: inherit;">A situação é ameaçadora, mas suportável: o herói é derramado com lixo radioativo, mas ele o supera.</font></font></li>
<li>     «if»   ,     . .    —   . ,    -  - .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, na situação considerada, para evitar a ocorrência de dívida técnica, faz sentido construir a arquitetura antes de passar pela primeira etapa, na pior das hipóteses, para a segunda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que exatamente Vasily fez para tratar um mutante? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do ponto de vista técnico - protocolo fechado de dependência de injeção usado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da responsabilidade filosófica - compartilhada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as características do trabalho da classe, que podem ser trocadas entre si (o que significa que são alternativas umas às outras), foram removidas do Herói, dependendo. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma nova </font><font style="vertical-align: inherit;">funcionalidade </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alternativa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a implementação do trabalho da espada, a implementação do trabalho do clube - após sua aparência se tornou diferente uma da outra e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é diferente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do resto</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nenhum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> código de herói </font><i><font style="vertical-align: inherit;">alternativo</font></i><font style="vertical-align: inherit;"> . </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Então, já no código "ingênuo",</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> novo</font><font style="vertical-align: inherit;">parecia</font><font style="vertical-align: inherit;">diferente em seu comportamento alternativo da parte não contestada do Herói. </font><font style="vertical-align: inherit;">Assim, no código "ingênuo", apareceu uma descrição implícita de novas</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades comerciais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : uma espada e um taco</font><font style="vertical-align: inherit;">, espalhados de acordo com o Herói</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para facilitar a operação com novas</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades comerciais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tornou-se necessário distingui-las como</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades de código</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> separadas</font><font style="vertical-align: inherit;">com seus próprios</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nomes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Portanto, houve uma divisão de responsabilidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS TL; DR;</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veja a bandeira?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seja um homem, droga! </font><font style="vertical-align: inherit;">Apague isso!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injeção de dependência</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lucro! 11</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493458/index.html">Liberte seu Android - Alaverdi</a></li>
<li><a href="../pt493462/index.html">Banho ultrassonico. Parte 2</a></li>
<li><a href="../pt493468/index.html">Não tenha medo de respirar profundamente</a></li>
<li><a href="../pt493470/index.html">Cientistas encontram novos planetas pequenos fora de Netuno</a></li>
<li><a href="../pt493478/index.html">Corte a caixa - floresta do procedimento. Torrefação AS-REP, DCSync e ataques Pass-The-Hash</a></li>
<li><a href="../pt493482/index.html">Conheça a tartaruga cibernética, o antecessor do Roomba</a></li>
<li><a href="../pt493484/index.html">Seu C # já está "funcional", apenas deixe.</a></li>
<li><a href="../pt493486/index.html">As startups automotivas mais interessantes 2019-2020</a></li>
<li><a href="../pt493488/index.html">Unidade + git = amizade: parte 1 conjunto de cavalheiros</a></li>
<li><a href="../pt493496/index.html">ReactJS. Aviso: Não é possível executar uma atualização do estado React em um componente desmontado. Este é um no-op, mas indica um memorando</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>