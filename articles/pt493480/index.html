<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∑ üßëüèø üë©üèº Arquitetura para iniciantes ou por que voc√™ n√£o precisa inserir uma bandeira no homem-espada üç§ üë®üèæ‚Äçüé§ üë®üèæ‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anota√ß√£o:
 
 

1. Um exemplo da implementa√ß√£o de novas funcionalidades na classe adicionando um "sinalizador".
2. Efeitos.
3. Abordagem alternativa e ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Arquitetura para iniciantes ou por que voc√™ n√£o precisa inserir uma bandeira no homem-espada</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493480/"><img src="https://habrastorage.org/webt/9s/96/tv/9s96tvz6feehvgoiz_gmwdoktl8.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anota√ß√£o:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um exemplo da implementa√ß√£o de novas funcionalidades na classe adicionando um "sinalizador".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efeitos.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abordagem alternativa e compara√ß√£o de resultados.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como evitar a situa√ß√£o: "Excesso arquitet√¥nico"?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O momento em que chega a hora de mudar tudo.</font></font></li>
</ol></blockquote><br>
<a name="habracut"></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de come√ßar, algumas notas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta √© uma hist√≥ria sobre arquitetura de software - no sentido que o tio Bob usa. </font><font style="vertical-align: inherit;">Sim esse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos os personagens, seus nomes e c√≥digos no artigo s√£o fict√≠cios, quaisquer coincid√™ncias com a realidade s√£o aleat√≥rias.</font></font></li>
</ul></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que eu seja um programador-programador comum em um projeto. </font><font style="vertical-align: inherit;">O projeto √© um jogo no qual um √∫nico her√≥i (tamb√©m conhecido como her√≥i) segue uma linha perfeitamente horizontal da esquerda para a direita. </font><font style="vertical-align: inherit;">Monstros interferem nessa jornada maravilhosa. </font><font style="vertical-align: inherit;">Sob o comando do usu√°rio, o Her√≥i os corta </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com uma espada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no repolho e n√£o sopra no bigode. </font><font style="vertical-align: inherit;">O projeto j√° possui 100 mil linhas e "voc√™ precisa de mais </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linhas de</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recursos!" </font><font style="vertical-align: inherit;">Vamos olhar para o nosso her√≥i:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//   1</span><font></font>
    }<font></font>
    <span class="hljs-comment">//   </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha tamb√©m que o l√≠der da minha equipe pessoal, Vasily, tamb√©m possa sair de f√©rias. </font><font style="vertical-align: inherit;">De repente. </font><font style="vertical-align: inherit;">Quem teria pensado? </font><font style="vertical-align: inherit;">Al√©m disso, a situa√ß√£o se desenvolve como padr√£o: uma Coruja chega e precisa urgentemente, ontem, de tornar poss√≠vel escolher antes do in√≠cio do jogo: jogar para o Her√≥i com um taco ou com uma espada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve ser muito r√°pido. </font><font style="vertical-align: inherit;">E sim, √© claro, ele pr√≥prio foi programador por mais de anos do que eu posso andar, ent√£o ele sabe que a tarefa √© de cinco minutos. </font><font style="vertical-align: inherit;">Mas assim seja, fa√ßa uma estimativa de 2 horas. </font><font style="vertical-align: inherit;">Voc√™ s√≥ precisa adicionar uma caixa de sele√ß√£o e if-chik. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: if-chik no valor @! ^% $ # @ ^% &amp; @! 11 $ its # $% @ ^% &amp;! @ !!! </font><font style="vertical-align: inherit;">em &amp;! ^% # $ ^%! 1 if-chic! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meus pensamentos: ‚ÄúHa! </font><font style="vertical-align: inherit;">Duas horas! </font><font style="vertical-align: inherit;">Feito! ":</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">WeaponTypes</span> </span>{
        <span class="hljs-keyword">case</span> sword:
        <span class="hljs-keyword">case</span> club:<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-keyword">var</span> weaponType: <span class="hljs-type">WeaponTypes?</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> weaponType = weaponType <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">assertionFailure</span>()
            <span class="hljs-keyword">return</span>	<font></font>
        }<font></font>
        <span class="hljs-comment">//  : switch  Swift  if- -    !</span>
        <span class="hljs-keyword">switch</span> (weaponType) {
            <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//     </span>
            <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//     </span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-comment">//  </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ descobriu na minha decis√£o, ent√£o: infelizmente: tenho duas not√≠cias para voc√™:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como se fosse bom: n√≥s dois entregamos. </font><font style="vertical-align: inherit;">N√≥s entregamos - a partir da palavra agregar valor ou da palavra c√≥digo engra√ßado (atrav√©s de l√°grimas).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E o ruim: sem Vasily, o projeto kapets.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o o que aconteceu? </font><font style="vertical-align: inherit;">Parece at√© agora nada. </font><font style="vertical-align: inherit;">Mas vamos ver o que acontece a seguir (enquanto fazemos todo o poss√≠vel para manter Vasily de f√©rias). </font><font style="vertical-align: inherit;">E ent√£o haver√° o seguinte: o departamento de controle de qualidade prestar√° aten√ß√£o ao peso do nosso her√≥i. </font><font style="vertical-align: inherit;">E n√£o, isso n√£o ocorre porque o Her√≥i precisa seguir uma dieta, mas eis o porqu√™:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + swordWeight<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu esqueci de corrigir o c√°lculo do peso. </font><font style="vertical-align: inherit;">Bem, voc√™ pensa, erro, com quem n√£o acontece ?! </font><font style="vertical-align: inherit;">Slap-bloop, fuck-tibidoch, pronto:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">//   guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + clubWeight<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas rapidamente consertou! </font><font style="vertical-align: inherit;">O her√≥i agora est√° pulando, levando em considera√ß√£o o peso, mas. </font><font style="vertical-align: inherit;">Trabalho orientado a resultados! </font><font style="vertical-align: inherit;">N√£o √© para voc√™ olhar para umbigos, astronautas arquitet√¥nicos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, s√©rio, ent√£o ele corrigiu um pouco mais. </font><font style="vertical-align: inherit;">Na lista de feiti√ßos, eu tinha que fazer isso:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//   guard let weaponType </span>
    <span class="hljs-comment">// ,   let spellsWithoutWeapon: [Spells]</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword:
            <span class="hljs-comment">//  let swordSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + swordSpells
	<span class="hljs-keyword">case</span> .club:
            <span class="hljs-comment">//  let clubSpells: [Spells]</span>
            <span class="hljs-keyword">return</span> spellsWithoutWeapon + clubSpells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E ent√£o Petya veio e quebrou tudo. </font><font style="vertical-align: inherit;">Bem, a verdade √© que temos um m√™s de junho no projeto. </font><font style="vertical-align: inherit;">Desatento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele s√≥ precisava adicionar o conceito de "N√≠vel de Arma" √†s f√≥rmulas para calcular a for√ßa do golpe e o peso do Her√≥i. </font><font style="vertical-align: inherit;">E Petya perdeu um dos quatro casos. </font><font style="vertical-align: inherit;">Mas nada! </font><font style="vertical-align: inherit;">Corrigi tudo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//guard let weaponType</span>
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-comment">//        weaponGrade</span>
        <span class="hljs-keyword">case</span> .club:  <span class="hljs-comment">//        weaponGrade</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
    <span class="hljs-comment">// guard let weaponType</span>
    <span class="hljs-keyword">let</span> weightWithoutWeapon = meatbagWeight + pantsWeight + helmetWeight
    <span class="hljs-keyword">switch</span> (weaponType) {
        <span class="hljs-keyword">case</span> .sword: <span class="hljs-keyword">return</span> weightWithoutWeapon + swordWeight / grade
	<span class="hljs-keyword">case</span> .club:  <span class="hljs-keyword">return</span> weightWithoutWeapon + pow(clubWeight, <span class="hljs-number">1</span> / grade)<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
    <span class="hljs-comment">//     , ! </span>
    <span class="hljs-comment">// ,     .    ,    ,   .   !</span>
}</code></pre><br>
<img src="https://habrastorage.org/webt/aw/ev/fo/awevfo6jjlysv_8l9wq-dl9npkw.png" height="80" width="80" align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escusado ser√° dizer que, quando (de repente!) Foi necess√°rio adicionar um arco / atualizar f√≥rmulas, novamente houve casos esquecidos, bugs e isso foi tudo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que deu errado? </font><font style="vertical-align: inherit;">Onde eu estava errado, e o que (exceto os companheiros) Vasily disse quando ele voltou das f√©rias? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui voc√™ n√£o pode ler mais a hist√≥ria, mas, por exemplo, pensar sobre o eterno, sobre arquitetura. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E com aqueles que ainda decidiram ler, continuamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, vamos olhar para os cl√°ssicos:</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otimiza√ß√£o prematura √© a raiz de todo o mal!</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ... n√£o √© isso. </font><font style="vertical-align: inherit;">Aqui est√° a coisa: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas linguagens OOP (como Swift, por exemplo), existem tr√™s maneiras principais de estender os recursos de uma classe:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira maneira √© "ing√™nua". </font><font style="vertical-align: inherit;">N√≥s apenas o vimos. </font><font style="vertical-align: inherit;">Adicionando uma caixa de sele√ß√£o. </font><font style="vertical-align: inherit;">Adicionando responsabilidade. </font><font style="vertical-align: inherit;">Aula de incha√ßo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A segunda maneira √© heran√ßa. </font><font style="vertical-align: inherit;">Todo mundo conhece um mecanismo poderoso para reutilizar c√≥digo. </font><font style="vertical-align: inherit;">Pode-se, por exemplo:</font></font><br>
 <ul>
<li><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herda o novo Her√≥i com o Arco e o Her√≥i de Dubina do Her√≥i (que est√° segurando uma espada, mas isso n√£o est√° refletido no nome da classe do Her√≥i agora). </font><font style="vertical-align: inherit;">E ent√£o, nos herdeiros, substitua os m√©todos alterados. </font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este caminho √© muito ruim (apenas confie em mim).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Torne a classe base (ou protocolo) um Her√≥i e remova todos os recursos associados a um tipo espec√≠fico de arma como herdeiro </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: Her√≥i com uma </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
espada: Her√≥i, </font><font style="vertical-align: inherit;">Her√≥i com um </font><font style="vertical-align: inherit;">arco: Her√≥i, Her√≥i com </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dubina: Her√≥i. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© melhor, mas os pr√≥prios nomes dessas classes nos olham de alguma maneira descontentes, ferozmente e ao mesmo tempo tristes e perplexos. </font><font style="vertical-align: inherit;">Se eles n√£o olharem para algu√©m assim, tentarei escrever outro artigo, onde, al√©m do chato her√≥i masculino, eles ser√£o ...</font></font><img src="https://habrastorage.org/webt/7i/7w/l7/7i7wl7kxg1ol1mmtplsfv-h7i4w.png" height="80" width="80"></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A terceira maneira √© a separa√ß√£o de responsabilidades atrav√©s da inje√ß√£o de depend√™ncia. </font><font style="vertical-align: inherit;">Pode ser uma depend√™ncia fechada por um protocolo ou um fechamento (como se estivesse fechada por uma assinatura), qualquer que seja. </font><font style="vertical-align: inherit;">O principal √© que a implementa√ß√£o de novas responsabilidades saia da classe principal.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como isso pode parecer no nosso caso? </font><font style="vertical-align: inherit;">Por exemplo, assim (decis√£o de Vasily):</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> </span>{
    <span class="hljs-keyword">let</span> weapon: <span class="hljs-type">Weapon</span> <span class="hljs-comment">//   , ..    </span><font></font>
<font></font>
    <span class="hljs-keyword">init</span> (<span class="hljs-number">_</span> weapon: <span class="hljs-type">Weapon</span>) { <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">self</span>.weapon = weapon<font></font>
    }<font></font>
	<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {<font></font>
        weapon.strike()<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-keyword">return</span> meatbagWeight + pantsWeight + helmetWeight + weapon.weight<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">//   </span>
        <span class="hljs-keyword">return</span> spellsWithoutWeapon + weapon.spells<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que voc√™ precisa ser assim? </font><font style="vertical-align: inherit;">Ninjutsu - protocolo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {<span class="hljs-keyword">get</span>}
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {<span class="hljs-keyword">get</span>}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo de implementa√ß√£o de protocolo:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>: <span class="hljs-title">Weapon</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">strike</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> weight: <span class="hljs-type">Stone</span> {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">var</span> spells: [<span class="hljs-type">Spells</span>] {
        <span class="hljs-comment">// ,     Hero  switch   .sword</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da mesma forma, as aulas de espada s√£o escritas para: Club, Bow, Pike, etc. </font><font style="vertical-align: inherit;">‚Äú√â f√°cil ver‚Äù (c) que na nova arquitetura todo o c√≥digo que se aplica a cada tipo espec√≠fico de arma est√° agrupado na classe correspondente e n√£o √© espalhado de acordo com o Her√≥i, juntamente com outros tipos de armas. </font><font style="vertical-align: inherit;">Isso facilita a leitura e a compreens√£o do Her√≥i e de qualquer arma espec√≠fica. </font><font style="vertical-align: inherit;">Al√©m disso, devido aos requisitos do protocolo imposto, √© muito mais f√°cil rastrear todos os m√©todos que precisam ser implementados ao adicionar um novo tipo de arma ou ao adicionar um novo recurso a uma arma (por exemplo, uma arma pode ter um m√©todo de c√°lculo de pre√ßo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui voc√™ pode ver que a inje√ß√£o de depend√™ncia complicou a cria√ß√£o de objetos da classe Hero. </font><font style="vertical-align: inherit;">O que costumava ser feito de maneira simples:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> lastHero = <span class="hljs-type">Hero</span>()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora ele se transformou em um conjunto de instru√ß√µes que ser√£o duplicadas sempre que for necess√°rio criar um Her√≥i. </font><font style="vertical-align: inherit;">No entanto, Vasily cuidou disso:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroFactory</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeSwordsman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> { <span class="hljs-comment">// ,  static -  </span>
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Sword</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makeClubman</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Hero</span> {
        <span class="hljs-keyword">let</span> weapon = <span class="hljs-type">Club</span>(<span class="hljs-comment">/*  */</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-type">Hero</span>(weapon)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â claro que Vasily teve que suar para espalhar a pilha que foi </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empilhada,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> projetada por Petya (e eu). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, olhando para a √∫ltima solu√ß√£o, o seguinte pensamento pode surgir:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, acabou, normas. </font><font style="vertical-align: inherit;">√â conveniente ler e expandir, mas todas essas f√°bricas / protocolos / depend√™ncias s√£o um monte de despesas gerais? </font><font style="vertical-align: inherit;">Um c√≥digo que n√£o fornece nada em termos de recursos, mas existe apenas para organizar o c√≥digo. </font><font style="vertical-align: inherit;">"C√≥digo para organizar o c√≥digo", mgm. </font><font style="vertical-align: inherit;">√â realmente necess√°rio cercar este jardim sempre e em qualquer lugar?</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma resposta honesta para a primeira pergunta seria:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sim, essa √© uma sobrecarga para os recursos que as empresas amam tanto. </font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E para a pergunta "quando?" </font><font style="vertical-align: inherit;">se√ß√£o de respostas:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A filosofia do homem-espada ou "quando voc√™ teve que governar?"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No come√ßo era um homem de espada. </font><font style="vertical-align: inherit;">No sistema dos sentidos do c√≥digo antigo, isso era bastante normal. </font><font style="vertical-align: inherit;">Desde que houvesse um her√≥i e uma arma, n√£o havia necessidade de distinguir entre eles - mesmo assim, n√£o havia mais nada para o her√≥i. </font><font style="vertical-align: inherit;">E o c√≥digo monol√≠tico confirmou esse fato com seu texto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espadachim - nem parece t√£o ruim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E a que as primeiras edi√ß√µes ‚Äúing√™nuas‚Äù levaram? </font><font style="vertical-align: inherit;">A que a adi√ß√£o do if-chik levou? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicionar um if-chic levou a ... um mutante! </font><font style="vertical-align: inherit;">Mutante, isto √©, </font><font style="vertical-align: inherit;">objeto mut√°vel que pode alternar entre um "humano" e "humano Dubin". </font><font style="vertical-align: inherit;">Ao mesmo tempo, se voc√™ cometer um pequeno erro na implementa√ß√£o do mutante, o estado de "medula√≠na humana" surge. </font><font style="vertical-align: inherit;">N√£o fa√ßa assim! </font><font style="vertical-align: inherit;">N√£o h√° necessidade de "Dubin humano". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homem + depend√™ncia da espada (necessidade de espada);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homem + depend√™ncia de um clube (necessidade de um clube).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nem todo v√≠cio √© mau! </font><font style="vertical-align: inherit;">Esse v√≠cio em √°lcool √© mau e o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© bom. </font><font style="vertical-align: inherit;">Sim, at√© a depend√™ncia do objeto √© melhor que o "Dubin humano"! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando a muta√ß√£o aconteceu? </font><font style="vertical-align: inherit;">A transforma√ß√£o em mutante ocorreu quando a bandeira foi adicionada: o c√≥digo monol√≠tico permaneceu monol√≠tico, mas quando a bandeira foi alterada (mutada), o comportamento do mesmo objeto come√ßou a mudar significativamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vasily destacaria dois est√°gios da muta√ß√£o:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando uma bandeira e o primeiro "se" (ou "alternar" ou outro mecanismo de ramifica√ß√£o) √† bandeira. </font><font style="vertical-align: inherit;">A situa√ß√£o √© amea√ßadora, mas suport√°vel: o her√≥i √© derramado com lixo radioativo, mas ele o supera.</font></font></li>
<li>     ¬´if¬ª   ,     . .    ‚Äî   . ,    -  - .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, na situa√ß√£o considerada, para evitar a ocorr√™ncia de d√≠vida t√©cnica, faz sentido construir a arquitetura antes de passar pela primeira etapa, na pior das hip√≥teses, para a segunda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que exatamente Vasily fez para tratar um mutante? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do ponto de vista t√©cnico - protocolo fechado de depend√™ncia de inje√ß√£o usado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da responsabilidade filos√≥fica - compartilhada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as caracter√≠sticas do trabalho da classe, que podem ser trocadas entre si (o que significa que s√£o alternativas umas √†s outras), foram removidas do Her√≥i, dependendo. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma nova </font><font style="vertical-align: inherit;">funcionalidade </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alternativa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a implementa√ß√£o do trabalho da espada, a implementa√ß√£o do trabalho do clube - ap√≥s sua apar√™ncia se tornou diferente uma da outra e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© diferente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do resto</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nenhum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c√≥digo de her√≥i </font><i><font style="vertical-align: inherit;">alternativo</font></i><font style="vertical-align: inherit;"> . </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o, j√° no c√≥digo "ing√™nuo",</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> novo</font><font style="vertical-align: inherit;">parecia</font><font style="vertical-align: inherit;">diferente em seu comportamento alternativo da parte n√£o contestada do Her√≥i. </font><font style="vertical-align: inherit;">Assim, no c√≥digo "ing√™nuo", apareceu uma descri√ß√£o impl√≠cita de novas</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades comerciais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : uma espada e um taco</font><font style="vertical-align: inherit;">, espalhados de acordo com o Her√≥i</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para facilitar a opera√ß√£o com novas</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades comerciais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tornou-se necess√°rio distingui-las como</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entidades de c√≥digo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> separadas</font><font style="vertical-align: inherit;">com seus pr√≥prios</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nomes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Portanto, houve uma divis√£o de responsabilidade. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS TL; DR;</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veja a bandeira?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seja um homem, droga! </font><font style="vertical-align: inherit;">Apague isso!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inje√ß√£o de depend√™ncia</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lucro! 11</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493458/index.html">Liberte seu Android - Alaverdi</a></li>
<li><a href="../pt493462/index.html">Banho ultrassonico. Parte 2</a></li>
<li><a href="../pt493468/index.html">N√£o tenha medo de respirar profundamente</a></li>
<li><a href="../pt493470/index.html">Cientistas encontram novos planetas pequenos fora de Netuno</a></li>
<li><a href="../pt493478/index.html">Corte a caixa - floresta do procedimento. Torrefa√ß√£o AS-REP, DCSync e ataques Pass-The-Hash</a></li>
<li><a href="../pt493482/index.html">Conhe√ßa a tartaruga cibern√©tica, o antecessor do Roomba</a></li>
<li><a href="../pt493484/index.html">Seu C # j√° est√° "funcional", apenas deixe.</a></li>
<li><a href="../pt493486/index.html">As startups automotivas mais interessantes 2019-2020</a></li>
<li><a href="../pt493488/index.html">Unidade + git = amizade: parte 1 conjunto de cavalheiros</a></li>
<li><a href="../pt493496/index.html">ReactJS. Aviso: N√£o √© poss√≠vel executar uma atualiza√ß√£o do estado React em um componente desmontado. Este √© um no-op, mas indica um memorando</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>