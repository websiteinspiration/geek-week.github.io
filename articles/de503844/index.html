<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧕🏼 🙏🏼 ➿ Beschleunigen Sie das Rendern von MatTables in wenigen Schritten 🛀🏼 🐛 👕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es kommt häufig vor, dass der größte Teil der Anwendung aus verschiedenen Listen und Tabellen besteht. Um das Rad nicht jedes Mal neu zu erfinden, hab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Beschleunigen Sie das Rendern von MatTables in wenigen Schritten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503844/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es kommt häufig vor, dass der größte Teil der Anwendung aus verschiedenen Listen und Tabellen besteht. </font><font style="vertical-align: inherit;">Um das Rad nicht jedes Mal neu zu erfinden, habe ich, wie viele, oft </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angular Material-Tabellen verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Später wuchsen diese Tabellen, sowohl Textdaten als auch verschachtelte Elemente wurden in Zellen platziert. </font><font style="vertical-align: inherit;">All dies wächst und wird zu einer guten Belastung für den Computer des Benutzers. </font><font style="vertical-align: inherit;">Und das gefällt natürlich niemandem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In meinem letzten Heimprojekt gab es eine Tabelle, deren Zellen größtenteils mit verschiedenen Feldern gefüllt waren (man könnte sogar sagen, dass es sich um eine große Form handelte). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Rendern dauerte ungefähr 8 Sekunden (40 x 40 Tabelle). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie können Sie MatTable für große Listen optimieren?</font></font><br>
<br>
<img src="https://mohamed-sabry.com/wp-content/uploads/2019/02/performance.jpg" alt="Bild"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testfall</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um anderen bei der Bewältigung dieses Problems zu helfen, habe ich eine kleine Testanwendung geschrieben. Dieselbe MatTable-Tabelle mit fünf Spalten (die erste ist die ID des Elements, der Rest sind reguläre MatFormField-Textfelder). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fk/rc/4u/fkrc4uph55ayejqbdqbnitwb-nu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass es sich um eine einfache Tabelle handelt, aber selbst das Rendern von 100 dauert nicht länger als 2 Sekunden (Oh, dieses Material und seine "Top" -Leistung). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x2/dl/vm/x2dlvmlcvsotvdikpcoebafj4ia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Rendern selbst dauerte in diesem Fall nur (860 ms), die Seite blieb jedoch 2,2 Sekunden lang stehen und der Benutzer war verärgert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir, eine Tabelle mit 300 Zeilen zu rendern. </font><font style="vertical-align: inherit;">Und die Trommel rollen, wir warten ein bisschen und wir sehen, dass fast 10 Sekunden für das Scripten und Rendern insgesamt aufgewendet wurden. </font><font style="vertical-align: inherit;">Das heißt, wenn der Benutzer eine solche Tabelle in 300 Zeilen anzeigen möchte, friert seine Seite 10 Sekunden lang ein. </font><font style="vertical-align: inherit;">Das ist sehr beängstigend und erstaunlich (eigentlich nicht). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2b/y4/z7/2by4z7zeyqjjcl1vmst-x1rm_ge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich habe ich immer noch versucht, die Zeit zu messen, die zum Zeichnen von 1000 Elementen benötigt wird, aber mein erbärmlicher i7 konnte es nicht aushalten und die Seite fiel ständig ab. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden später versuchen, dies mit der bereits angewendeten Lösung zu tun.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lösung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher kann jeder mit browserbasierten Dienstprogrammen Messungen durchführen, aber es gibt keine Lösung für dieses Problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wurde zu dieser Entscheidung geführt, indem ich über das Wesentliche des Problems nachdachte.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein korrektes Verständnis des Problems ist bereits mindestens die Hälfte seiner Lösung.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich denke, jeder versteht, dass dies geschieht, weil die Tabellendaten zuerst von Skripten verarbeitet und dann in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem Stück</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausgespuckt werden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Genau deshalb sehen wir wiederum eine charakteristische Federung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Problem gefunden. </font><font style="vertical-align: inherit;">Jetzt bleibt herauszufinden, wie man es löst. </font><font style="vertical-align: inherit;">Die allererste Lösung, die mir in den Sinn kommt, ist die einfachste. </font><font style="vertical-align: inherit;">Wenn das Problem darin besteht, alle Daten gleichzeitig zu verarbeiten, müssen Sie die Tabelle veranlassen, die Daten in Teilen zu verarbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wie geht das? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns überlegen, was wir dafür sofort haben. </font><font style="vertical-align: inherit;">Das erste, was mir in den Sinn kommt, ist die Track By-Funktion. </font><font style="vertical-align: inherit;">Beim Ändern der Datenquelle wird nicht die gesamte Tabelle neu gerendert, sondern nur die Änderungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen wir diese Funktion unserer Tabelle hinzu:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">mat-table</span> [<span class="hljs-attr">trackBy</span>]=<span class="hljs-string">"trackByFn"</span> [<span class="hljs-attr">dataSource</span>]=<span class="hljs-string">"commonDataSource"</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, aber wir haben keine solche Bedingung, dass sich die Tabellendaten irgendwie ändern, und darum geht es in der Konversation jetzt nicht. </font><font style="vertical-align: inherit;">Was aber, wenn wir Pipe schreiben, das beim Initialisieren der Datenquelle die Daten bricht und sie stapelweise an die Tabelle weitergibt? </font><font style="vertical-align: inherit;">Die trackBy-Funktion hilft wiederum dabei, einen vollständigen Renderer zu vermeiden.</font></font><br>
<br>
<pre><code class="javascript hljs">@Pipe({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'splitSchedule'</span><font></font>
})<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SplitPipe</span> <span class="hljs-title">implements</span> <span class="hljs-title">PipeTransform</span> </span>{<font></font>
  public transform(value: any, <span class="hljs-attr">takeBy</span>: number = <span class="hljs-number">4</span>, <span class="hljs-attr">throttleTime</span>: number = <span class="hljs-number">40</span>): Observable&lt;<span class="hljs-built_in">Array</span>&lt;any&gt;&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.isArray(value)<font></font>
      ? <span class="hljs-keyword">this</span>.getSplittedThread(value, takeBy, throttleTime)<font></font>
      : <span class="hljs-keyword">of</span>(value);<font></font>
  }<font></font>
<font></font>
  private getSplittedThread(data: <span class="hljs-built_in">Array</span>&lt;any&gt;, takeBy: number, <span class="hljs-attr">throttleTime</span>: number): Observable&lt;<span class="hljs-built_in">Array</span>&lt;any&gt;&gt; {
    <span class="hljs-keyword">const</span> repeatNumber = <span class="hljs-built_in">Math</span>.ceil(data.length / takeBy);
    <span class="hljs-keyword">return</span> timer(<span class="hljs-number">0</span>, throttleTime).pipe(<font></font>
      map(<span class="hljs-function">(<span class="hljs-params">current</span>) =&gt;</span> data.slice(<span class="hljs-number">0</span>, takeBy * ++current)),<font></font>
      take(repeatNumber)<font></font>
    );<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein so kleiner Code, mit dem Ihre Hardware so große Tabellen rendern kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenden Sie diese Pipe auf unsere Datenquelle an.</font></font><br>
<br>
<pre><code class="xml hljs">
<span class="hljs-tag">&lt;<span class="hljs-name">mat-table</span> [<span class="hljs-attr">trackBy</span>]=<span class="hljs-string">"trackByFn"</span>
           [<span class="hljs-attr">dataSource</span>]=<span class="hljs-string">"commonDataSource | splitSchedule | async"</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir nun, Messungen vorzunehmen. </font><font style="vertical-align: inherit;">Rendern Sie 100, 300 und 1000 Elemente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k9/ge/dy/k9gedy95dj4dxjuwc1_oe6dr2fc.png"><br>
<br>
<img src="https://habrastorage.org/webt/-m/gw/sk/-mgwskq0o-c_hlgms6e0jzo0tjw.png"><br>
<br>
<img src="https://habrastorage.org/webt/ep/fh/id/epfhidruvwampy1yxgrusej__sc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und was sehen wir? </font><font style="vertical-align: inherit;">Was wirklich Erfolg ist, ist nicht das, was wir erwartet haben:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 300 Elemente werden 1 Sekunde schneller gerendert </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1000 in 11 Sekunden gerendert und der Tab ist nicht gestorben </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und 100 Elemente werden im Allgemeinen 150 ms länger gerendert </font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber beeilen Sie sich nicht, um Schlussfolgerungen zu ziehen. Schauen wir uns zunächst das Verhalten der Seite in beiden Fällen an. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/l0/bv/wil0bvryq-7p4webmepcdnmg9cs.gif"><br>
 <br>
<img src="https://habrastorage.org/webt/4a/ho/pm/4ahopmeahip3lcxghuq7li6v4ju.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, friert die Seite im Normalfall einige Sekunden lang ein und der Benutzer kann in diesem Moment nichts tun, während die Verwendung unserer Pipe mit einem Link zu trackBy dem Benutzer eine fast sofortige Tabelleninitialisierung ermöglicht und keine Beschwerden bei der Verwendung der Anwendung verursacht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoffe dieser Artikel hilft jemandem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Quellcode für die Testanwendung befindet sich auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack Blitz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503830/index.html">Amazon hat ein großes Obdachlosenheim eröffnet</a></li>
<li><a href="../de503832/index.html">PostgreSQL-Rezepte: Mustach Template Engine</a></li>
<li><a href="../de503836/index.html">Vor- und Nachteile von Technologien zur Kommentarmoderation (+ Umfrage)</a></li>
<li><a href="../de503838/index.html">ACLcheck - Dienstprogramm zur Überprüfung der Cisco IOS-Zugriffsliste</a></li>
<li><a href="../de503842/index.html">Gehirnprothese: Synchronisation künstlicher und biologischer neuronaler Netze</a></li>
<li><a href="../de503846/index.html">Flash: "Ob er wieder stirbt, ist unbekannt, aber die Blumen verschwinden ..."</a></li>
<li><a href="../de503848/index.html">Wir laden Sie zu kostenlosen Webinaren zum SLS-Druck auf Sinterit 26.05 und 3D-Scannern Shining 28.05 ein</a></li>
<li><a href="../de503854/index.html">Verwenden Sie SIL maximal</a></li>
<li><a href="../de503858/index.html">Das Buch "Terraform: Infrastruktur auf Codeebene"</a></li>
<li><a href="../de503860/index.html">Einrichten der neuronalen Netzwerkumgebung Maske R-CNN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>