<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏼 ✈️ ✊ Penganalisa PVS-Studio RunUO memeriksa 🌃 🗺️ 🤳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini dikhususkan untuk memeriksa proyek RunUO menggunakan analisa statis PVS-Studio. RunUO adalah emulator perangkat lunak server untuk Ultima ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Penganalisa PVS-Studio RunUO memeriksa</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/487106/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/pk/vz/nb/pkvznbl6d22oijuluuu2xfoztcs.png" alt="Gambar 1"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artikel ini dikhususkan untuk memeriksa proyek RunUO menggunakan analisa statis PVS-Studio. </font><font style="vertical-align: inherit;">RunUO adalah emulator perangkat lunak server untuk Ultima Online, sebuah game yang pernah memenangkan hati banyak penggemar MMORPG.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunUO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah emulator perangkat lunak server untuk MMORPG Ultima Online. Tujuan dari proyek ini adalah untuk menciptakan perangkat lunak yang stabil yang akan dapat bersaing dengan server resmi EA Games. RunUO dibuat kembali pada tahun 2002, tetapi tidak kehilangan relevansi dan aktif digunakan sampai hari ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan dari verifikasi proyek adalah untuk mempopulerkan topik analisis statis. Kami memeriksa berbagai proyek - permainan ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), perpustakaan ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), messenger ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), browser ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan banyak lagi ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) untuk menarik perhatian audiens yang beragam. Dengan artikel-artikel ini, kami mencoba menarik perhatian pada pentingnya menggunakan analisis statis dalam pengembangan. Analisis statis membuat kode lebih dapat diandalkan dan lebih aman. Juga, dengan penggunaan regulernya, Anda dapat menemukan dan menghilangkan kesalahan pada tahap paling awal. Ini menghemat waktu dan usaha pengembang, karena tidak ada yang mau menghabiskan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 jam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mencari kesalahan yang dapat ditemukan oleh penganalisa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga membantu komunitas open-source. </font><font style="vertical-align: inherit;">Melalui artikel dengan kesalahan ditemukan, kami berkontribusi pada pengembangan open-source. </font><font style="vertical-align: inherit;">Namun, dalam artikel kami tidak menganalisis semua peringatan. </font><font style="vertical-align: inherit;">Beberapa peringatan sepertinya terlalu membosankan bagi kami untuk masuk ke artikel, beberapa ternyata positif palsu, dll. </font><font style="vertical-align: inherit;">Karenanya, kami siap memberikan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lisensi gratis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk proyek sumber terbuka. </font><font style="vertical-align: inherit;">Terlebih lagi, apa yang menurut kami membosankan untuk artikel tersebut mungkin terlihat cukup menarik bagi pengembang proyek yang sedang diuji, karena pengembang proyek masih lebih menyadari masalah mana yang paling kritis.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Potongan kode yang menarik perhatian saat memeriksa laporan penganalisa</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3010 Nilai balik fungsi 'Intern' harus digunakan. </font><font style="vertical-align: inherit;">BasePaintedMask.cs 49</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">Intern</span>(<span class="hljs-params"> <span class="hljs-keyword">string</span> str </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( str == <span class="hljs-literal">null</span> )
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( str.Length == <span class="hljs-number">0</span> )
    <span class="hljs-keyword">return</span> String.Empty;<font></font>
<font></font>
  <span class="hljs-keyword">return</span> String.Intern( str );<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BasePaintedMask</span>(<span class="hljs-params"> <span class="hljs-keyword">string</span> staffer, <span class="hljs-keyword">int</span> itemid </span>)
                            : <span class="hljs-title">base</span>(<span class="hljs-params"> itemid + Utility.Random( <span class="hljs-number">2</span> </span>) )</span><font></font>
{<font></font>
  m_Staffer = staffer;<font></font>
<font></font>
  Utility.Intern( m_Staffer );<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nilai pengembalian metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intern ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak diperhitungkan di mana pun, seperti yang ditunjukkan oleh penganalisa. </font><font style="vertical-align: inherit;">Mungkin ini adalah bug atau kode redundan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3017 Pola terdeteksi: (item adalah BasePotion) || </font><font style="vertical-align: inherit;">((item adalah BasePotion) &amp;&amp; ...). </font><font style="vertical-align: inherit;">Ekspresi berlebihan atau mengandung kesalahan logis. </font><font style="vertical-align: inherit;">Cleanup.cs 137</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsBuggable</span>(<span class="hljs-params"> Item item </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( item <span class="hljs-keyword">is</span> Fists )
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span> ( item <span class="hljs-keyword">is</span> ICommodity || item <span class="hljs-keyword">is</span> Multis.BaseBoat<font></font>
    || item <span class="hljs-keyword">is</span> Fish || item <span class="hljs-keyword">is</span> BigFish<font></font>
    || item <span class="hljs-keyword">is</span> BasePotion || item <span class="hljs-keyword">is</span> Food || item <span class="hljs-keyword">is</span> CookableFood<font></font>
    || item <span class="hljs-keyword">is</span> SpecialFishingNet || item <span class="hljs-keyword">is</span> BaseMagicFish<font></font>
    || item <span class="hljs-keyword">is</span> Shoes || item <span class="hljs-keyword">is</span> Sandals<font></font>
    || item <span class="hljs-keyword">is</span> Boots || item <span class="hljs-keyword">is</span> ThighBoots<font></font>
    || item <span class="hljs-keyword">is</span> TreasureMap || item <span class="hljs-keyword">is</span> MessageInABottle<font></font>
    || item <span class="hljs-keyword">is</span> BaseArmor || item <span class="hljs-keyword">is</span> BaseWeapon<font></font>
    || item <span class="hljs-keyword">is</span> BaseClothing<font></font>
    || ( item <span class="hljs-keyword">is</span> BaseJewel &amp;&amp; Core.AOS )<font></font>
    || ( item <span class="hljs-keyword">is</span> BasePotion &amp;&amp; Core.ML )<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada subekspresi yang dapat disederhanakan. </font><font style="vertical-align: inherit;">Saya akan menuliskannya agar lebih jelas:</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (item <span class="hljs-keyword">is</span> BasePotion || ( item <span class="hljs-keyword">is</span> BasePotion &amp;&amp; Core.ML ))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item BasePotion = true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka kondisi benar, meskipun </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Core.ML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item BasePotion = false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka kondisi salah, sekali lagi terlepas dari nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Core.ML</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kode seperti itu paling sering hanya mubazir, namun, ada situasi yang lebih buruk ketika programmer membuat kesalahan dan menulis variabel yang salah dalam sub-ekspresi kedua. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3031 Pemeriksaan berlebihan dapat disederhanakan. </font><font style="vertical-align: inherit;">'||' </font><font style="vertical-align: inherit;">Operator dikelilingi oleh ekspresi berlawanan 'bPlayerOnly' dan '! bPlayerOnly'. </font><font style="vertical-align: inherit;">BaseCreature.cs 3005</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">double</span> <span class="hljs-title">GetFightModeRanking</span>(<span class="hljs-params"> Mobile m,
                                           FightMode acqType,
                                           <span class="hljs-keyword">bool</span> bPlayerOnly </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( ( bPlayerOnly &amp;&amp; m.Player ) ||  !bPlayerOnly )<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode ini bisa jadi berlebihan atau salah. </font><font style="vertical-align: inherit;">Masalahnya adalah bahwa di kedua sisi '||' </font><font style="vertical-align: inherit;">berbeda dalam arti subekspresi. </font><font style="vertical-align: inherit;">Jika kita memotongnya seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> ( m.Player || !bPlayerOnly )</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
maka tidak ada yang akan berubah. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3001 Ada sub-ekspresi yang identik 'akta adalah SmallBrickHouseDeed' di kiri dan di kanan '||' </font><font style="vertical-align: inherit;">operator. </font><font style="vertical-align: inherit;">RealEstateBroker.cs 132</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">ComputePriceFor</span>(<span class="hljs-params"> HouseDeed deed </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">int</span> price = <span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span> ( deed <span class="hljs-keyword">is</span> SmallBrickHouseDeed ||    <span class="hljs-comment">// &lt;=</span>
       deed <span class="hljs-keyword">is</span> StonePlasterHouseDeed ||<font></font>
       deed <span class="hljs-keyword">is</span> FieldStoneHouseDeed ||<font></font>
       deed <span class="hljs-keyword">is</span> SmallBrickHouseDeed ||    <span class="hljs-comment">// &lt;=</span>
       deed <span class="hljs-keyword">is</span> WoodHouseDeed ||<font></font>
       deed <span class="hljs-keyword">is</span> WoodPlasterHouseDeed ||<font></font>
       deed <span class="hljs-keyword">is</span> ThatchedRoofCottageDeed )<font></font>
      ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya pikir tidak ada gunanya menjelaskan apa pun di sini, kode berikutnya atau yang salah, atau berlebihan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3067 Ada kemungkinan bahwa blok 'lain' dilupakan atau dikomentari, sehingga mengubah logika operasi program. </font><font style="vertical-align: inherit;">BaseHouse.cs 1558</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetLockdown</span>(<span class="hljs-params"> Item i, <span class="hljs-keyword">bool</span> locked, <span class="hljs-keyword">bool</span> checkContains </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( m_LockDowns == <span class="hljs-literal">null</span> )
    <span class="hljs-keyword">return</span>;<font></font>
<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> Mondain's Legacy</span>
  <span class="hljs-keyword">if</span> ( i <span class="hljs-keyword">is</span> BaseAddonContainer )<font></font>
    i.Movable = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">else</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
  i.Movable = !locked;<font></font>
  i.IsLockedDown = locked;<font></font>
<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan yang cukup langka. </font><font style="vertical-align: inherit;">Penganalisis menemukan bahwa pemformatan kode mencurigakan setelah arahan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#endregion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menjadi </font><i><font style="vertical-align: inherit;">mencurigakan. </font></i><font style="vertical-align: inherit;">Jika Anda tidak membaca kode, itu terlihat seperti garis</font></font><br>
<br>
<pre><code class="cs hljs">i.Movable = !locked;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
akan dieksekusi dalam hal apa pun, terlepas dari variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mungkin kurung kurawal dilupakan di sini ... Secara umum, pengembang harus memeriksa kode ini. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3043 Logika operasional kode tidak sesuai dengan pemformatannya. </font><font style="vertical-align: inherit;">Pernyataan itu menjorok ke kanan, tetapi selalu dieksekusi. </font><font style="vertical-align: inherit;">Ada kemungkinan kurung keriting hilang. </font><font style="vertical-align: inherit;">Gempa bumi.cs 57</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnCast</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( Core.AOS )<font></font>
  {<font></font>
    damage = m.Hits / <span class="hljs-number">2</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> ( !m.Player )<font></font>
      damage = Math.Max( Math.Min( damage, <span class="hljs-number">100</span> ), <span class="hljs-number">15</span> );<font></font>
      damage += Utility.RandomMinMax( <span class="hljs-number">0</span>, <span class="hljs-number">15</span> );            <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kurung kurawal mungkin tidak ada dalam kode ini. </font><font style="vertical-align: inherit;">Kesimpulan ini dapat dibuat karena format kode yang aneh di tubuh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if (! M.Player)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3083 Doa yang tidak aman dari acara 'ServerStarted', NullReferenceException dimungkinkan. </font><font style="vertical-align: inherit;">Pertimbangkan menugaskan acara ke variabel lokal sebelum menjalankannya. </font><font style="vertical-align: inherit;">EventSink.cs 921</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InvokeServerStarted</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> ( ServerStarted != <span class="hljs-literal">null</span> )<font></font>
    ServerStarted();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode ini menggunakan panggilan yang berpotensi tidak aman ke event </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">handler RefreshStarted</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seperti yang ditunjukkan oleh penganalisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kenapa itu berbahaya? Bayangkan situasi ini. Acara </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerStarted</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hanya memiliki satu pelanggan. Dan pada saat antara memeriksa null dan langsung memanggil event handler </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerStarted ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di utas lain, berhenti berlangganan dibuat dari acara ini. Ini akan melempar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara termudah untuk mencegah situasi ini adalah menyediakan panggilan acara aman menggunakan Operator '?':</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">InvokeServerStarted</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ServerStarted?.Invoke();<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3054 Penguncian ganda yang berpotensi tidak aman. Gunakan variabel yang mudah menguap atau sinkronisasi primitif untuk menghindari hal ini. Item.cs 1624</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> Packet m_RemovePacket;<font></font>
....<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">object</span> _rpl = <span class="hljs-keyword">new</span> <span class="hljs-keyword">object</span>();
<span class="hljs-keyword">public</span> Packet RemovePacket<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (m_RemovePacket == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">lock</span> (_rpl)<font></font>
      {<font></font>
        <span class="hljs-keyword">if</span> (m_RemovePacket == <span class="hljs-literal">null</span>)<font></font>
        {<font></font>
          m_RemovePacket = <span class="hljs-keyword">new</span> RemoveItem(<span class="hljs-keyword">this</span>);<font></font>
          m_RemovePacket.SetStatic();<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> m_RemovePacket;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan penganalisis dikaitkan dengan penggunaan pola penguncian ganda yang tidak aman. Seperti yang dapat Anda lihat dari kode di atas, kunci periksa ganda diterapkan untuk menerapkan pola generatif - Loners. Ketika kami mencoba untuk mendapatkan turunan dari kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan </font><font style="vertical-align: inherit;">mengakses properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pengambil rajin memeriksa bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk persamaan ke nol. Jika centang lolos, maka kita masuk ke tubuh pernyataan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kunci</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket diinisialisasi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Situasi menarik muncul pada saat ketika utas utama telah menginisialisasi variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> melalui konstruktor, tetapi belum disebut metode</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SetStatic ().</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Secara teoritis, utas lain dapat mengakses properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada saat yang sangat tidak nyaman. Memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk kesetaraan ke nol tidak akan lagi gagal, dan utas panggilan akan menerima tautan ke objek yang tidak siap digunakan sepenuhnya. Untuk mengatasi masalah ini, </font><font style="vertical-align: inherit;">Anda bisa membuat variabel antara kelas </font><i><font style="vertical-align: inherit;">Paket</font></i><font style="vertical-align: inherit;"> di badan pernyataan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kunci</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , menginisialisasi melalui panggilan konstruktor dan metode </font><i><font style="vertical-align: inherit;">SetStatic (),</font></i><font style="vertical-align: inherit;"> dan kemudian menetapkannya ke variabel </font><i><font style="vertical-align: inherit;">m_RemovePacket</font></i><font style="vertical-align: inherit;"> . Dalam hal ini, isi pernyataan </font><i><font style="vertical-align: inherit;">kunci</font></i><font style="vertical-align: inherit;"> mungkin terlihat seperti ini:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">lock</span> (_rpl)<font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (m_RemovePacket == <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
    Packet instance = <span class="hljs-keyword">new</span> RemoveItem(<span class="hljs-keyword">this</span>);<font></font>
    instance.SetStatic();<font></font>
    m_RemovePacket = instance;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalahnya tampaknya sudah diperbaiki dan kode akan berfungsi seperti yang diharapkan. Tapi ini tidak benar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada satu hal lagi: penganalisis tidak hanya menyarankan menggunakan kata kunci yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mudah menguap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam versi rilis program, kompiler dapat melakukan optimasi dan menyusun ulang baris panggilan ke metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SetStatic ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan menetapkan variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dari sudut pandang kompiler, semantik program tidak akan dilanggar). Dan kita kembali lagi ke titik yang sama di mana kita mulai - kemungkinan mendapatkan variabel </font><i><font style="vertical-align: inherit;">m_RemovePacket yang</font></i><font style="vertical-align: inherit;"> tidak diinisialisasi</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tidak mungkin untuk mengatakan dengan tepat kapan penyusunan ulang ini dapat terjadi, dan apakah itu akan terjadi sama sekali: dapat dipengaruhi oleh versi CLR, arsitektur prosesor yang digunakan, dll. Masih layak dilindungi dari skenario seperti itu, dan salah satu solusi (namun, bukan yang paling produktif) adalah dengan menggunakan kata kunci yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mudah menguap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Variabel yang akan dideklarasikan dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengubah volatil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak akan dikenakan permutasi selama optimisasi oleh kompiler. Kode yang akhirnya diperbaiki mungkin terlihat seperti ini:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Packet m_RemovePacket;<font></font>
....<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">object</span> _rpl = <span class="hljs-keyword">new</span> <span class="hljs-keyword">object</span>();
<span class="hljs-keyword">public</span> Packet RemovePacket<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (m_RemovePacket == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">lock</span> (_rpl)<font></font>
      {<font></font>
        <span class="hljs-keyword">if</span> (m_RemovePacket == <span class="hljs-literal">null</span>)<font></font>
        {<font></font>
          Packet instance = <span class="hljs-keyword">new</span> RemoveItem(<span class="hljs-keyword">this</span>);<font></font>
          instance.SetStatic();<font></font>
          m_RemovePacket = instance;<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> m_RemovePacket;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kadang-kadang menggunakan </font><font style="vertical-align: inherit;">bidang yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mudah menguap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin tidak diinginkan karena overhead mengakses bidang tersebut. Kami tidak akan membahas topik ini secara terperinci, hanya mencatat bahwa dalam contoh yang sedang dipertimbangkan, catatan bidang atom hanya diperlukan sekali (ketika properti pertama kali diakses), namun, menyatakan bidang sebagai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volatil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan menyebabkan kompiler melakukan pembacaan dan penulisan atomnya yang mungkin tidak optimal dalam hal kinerja. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, pendekatan lain untuk memperbaiki peringatan penganalisis ini untuk menghindari overhead tambahan dari mendeklarasikan </font><font style="vertical-align: inherit;">bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volatil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah dengan menggunakan tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;T&gt; Malas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mendukung bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_RemovePacket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alih-alih penguncian periksa ganda. </font><font style="vertical-align: inherit;">Dalam hal ini, badan pengambil dapat diganti dengan metode initializer, yang akan diteruskan ke konstruktor dari instance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;T&gt; Malas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> Lazy&lt;Packet&gt; m_RemovePacket = <span class="hljs-keyword">new</span> Lazy&lt;Packet&gt;(() =&gt;<font></font>
  {<font></font>
    Packet instance = <span class="hljs-keyword">new</span> RemoveItem(<span class="hljs-keyword">this</span>);<font></font>
    instance.SetStatic();<font></font>
    <span class="hljs-keyword">return</span> instance;<font></font>
  }, LazyThreadSafetyMode.ExecutionAndPublication);<font></font>
<font></font>
....<font></font>
<span class="hljs-keyword">public</span> Packet RemovePacket<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> m_RemovePacket.Value;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode initializer akan dipanggil sekali, ketika jenis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diakses untuk pertama kalinya, </font><font style="vertical-align: inherit;">dan keamanan streaming jika mengakses properti dari beberapa utas pada saat yang sama akan dijamin oleh tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malas &lt;T&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (mode keselamatan ulir dikendalikan oleh parameter kedua konstruktor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3131 Ekspresi 'bertarget' diperiksa untuk kompatibilitas dengan tipe 'IAxe', tetapi dilemparkan ke tipe 'Item'. </font><font style="vertical-align: inherit;">HarvestTarget.cs 61</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnTarget</span>(<span class="hljs-params"> Mobile <span class="hljs-keyword">from</span>, <span class="hljs-keyword">object</span> targeted </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( m_System <span class="hljs-keyword">is</span> Lumberjacking &amp;&amp;<font></font>
            targeted <span class="hljs-keyword">is</span> IAxe &amp;&amp; m_Tool <span class="hljs-keyword">is</span> BaseAxe )<font></font>
  {<font></font>
    IAxe obj = (IAxe)targeted;<font></font>
    Item item = (Item)targeted;<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variabel yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditargetkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperiksa untuk milik tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IAxe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi </font><font style="vertical-align: inherit;">tidak ada yang memeriksa </font><font style="vertical-align: inherit;">milik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Item</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seperti yang dilaporkan analis. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3070 Variabel tidak diinisialisasi 'Nol' digunakan saat menginisialisasi variabel 'm_LastMobile'. Serial.cs 29</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> Serial : IComparable, IComparable&lt;Serial&gt;<font></font>
{<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> m_Serial;<font></font>
<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Serial m_LastMobile = Zero;                <span class="hljs-comment">// &lt;=</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Serial m_LastItem = <span class="hljs-number">0x40000000</span>;<font></font>
<font></font>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Serial LastMobile { .... }
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Serial LastItem { .... }<font></font>
<font></font>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Serial MinusOne = <span class="hljs-keyword">new</span> Serial( <span class="hljs-number">-1</span> );
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Serial Zero = <span class="hljs-keyword">new</span> Serial( <span class="hljs-number">0</span> );     <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Serial</span>(<span class="hljs-params"> <span class="hljs-keyword">int</span> serial </span>)</span><font></font>
  {<font></font>
    m_Serial = serial;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, tidak ada kesalahan, bagaimanapun, menulis ini tidak terlalu baik. Karena penugasan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_LastMobile dengan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zero yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak diinisialisasi </font><font style="vertical-align: inherit;">, struktur akan dibuat dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konstruktor default </font><i><font style="vertical-align: inherit;">()</font></i><font style="vertical-align: inherit;"> , yang akan mengarah ke inisialisasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_Serial = 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dan ini, pada gilirannya, sama dengan memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serial baru (0)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bahkan, para pengembang beruntung bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jika seharusnya ada nilai lain, ini akan menyebabkan kesalahan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3063 Bagian dari ekspresi kondisional selalu benar jika dievaluasi: m_Serial &lt;= 0x7FFFFFFF. Serial.cs 83</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> IsItem<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> ( m_Serial &gt;= <span class="hljs-number">0x40000000</span> &amp;&amp; m_Serial &lt;= <span class="hljs-number">0x7FFFFFFF</span> );<font></font>
  }<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x7FFFFFFF</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah nilai maksimum yang mungkin dimiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int32</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Oleh karena itu, berapapun nilai variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_Serial miliki</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dalam hal apa pun akan kurang dari atau sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x7FFFFFFF</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3004 Pernyataan 'then' setara dengan pernyataan 'else'. </font><font style="vertical-align: inherit;">Serialization.cs 1571</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteDeltaTime</span>(<span class="hljs-params"> DateTime <span class="hljs-keyword">value</span> </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">try</span> <font></font>
  { <font></font>
    d = <span class="hljs-keyword">new</span> TimeSpan( ticks-now ); <font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> <font></font>
  {<font></font>
    <span class="hljs-keyword">if</span>( ticks &lt; now ) <font></font>
      d = TimeSpan.MaxValue; <font></font>
    <span class="hljs-keyword">else</span> <font></font>
      d = TimeSpan.MaxValue;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penganalisa memperingatkan tentang sepotong kode yang mencurigakan di mana cabang benar dan salah dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sepenuhnya bertepatan. </font><font style="vertical-align: inherit;">Mungkin salah satu cabang harus memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TimeSpan.MinValue. </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode yang sama ditemukan di beberapa tempat: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V3004 Pernyataan 'lalu' setara dengan pernyataan 'lain'. </font><font style="vertical-align: inherit;">Item.cs 2103</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Serialize</span>(<span class="hljs-params"> GenericWriter writer </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <font></font>
  <span class="hljs-keyword">if</span>( ticks &lt; now ) <font></font>
    d = TimeSpan.MaxValue; <font></font>
  <span class="hljs-keyword">else</span> <font></font>
    d = TimeSpan.MaxValue;<font></font>
  <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V3004 Pernyataan 'lalu' setara dengan pernyataan 'lain'. </font><font style="vertical-align: inherit;">Serialization.cs 383</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteDeltaTime</span>(<span class="hljs-params"> DateTime <span class="hljs-keyword">value</span> </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <font></font>
  <span class="hljs-keyword">if</span>( ticks &lt; now ) <font></font>
    d = TimeSpan.MaxValue; <font></font>
  <span class="hljs-keyword">else</span> <font></font>
    d = TimeSpan.MaxValue;<font></font>
  <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menggunakan "Ini" karena suatu alasan, sangat mungkin bahwa, di antara hal-hal lain, itu tidak dapat dilakukan tanpa copy-paste, fragmen kode ini terlihat sangat menyakitkan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3051 Tipe cetakan yang berlebihan. </font><font style="vertical-align: inherit;">Objek sudah dari jenis 'Item'. </font><font style="vertical-align: inherit;">Mobile.cs 11237</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> Item Talisman<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> FindItemOnLayer( Layer.Talisman ) <span class="hljs-keyword">as</span> Item;<font></font>
  }<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> Item <span class="hljs-title">FindItemOnLayer</span>(<span class="hljs-params"> Layer layer </span>)</span><font></font>
{<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peringatan analisa ini dapat diperoleh jika ada penggunaan berlebihan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operator </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tidak ada kesalahan dalam bagian kode ini, tetapi juga tidak masuk akal untuk melemparkan objek ke tipenya sendiri. </font><font style="vertical-align: inherit;">Peringatan </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3148 Memberikan nilai 'null' potensial dari 'toSet' ke tipe nilai dapat menyebabkan NullReferenceException. </font><font style="vertical-align: inherit;">Properties.cs 502</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">ConstructFromString</span>(<span class="hljs-params"> .... </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">object</span> toSet;
  <span class="hljs-keyword">bool</span> isSerial = IsSerial( type );<font></font>
<font></font>
  <span class="hljs-keyword">if</span> ( isSerial ) <span class="hljs-comment">// mutate into int32</span>
    type = m_NumericTypes[<span class="hljs-number">4</span>];<font></font>
<font></font>
  ....<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">value</span> == <span class="hljs-literal">null</span> )<font></font>
  {<font></font>
    toSet = <span class="hljs-literal">null</span>;<font></font>
  }<font></font>
  ....<font></font>
<font></font>
  <span class="hljs-keyword">if</span> ( isSerial ) <span class="hljs-comment">// mutate back</span><font></font>
    toSet = (Serial)((Int32)toSet);<font></font>
<font></font>
  constructed = toSet;<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian ini kode, kita tertarik dalam kasus ketika variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kemudian variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toSet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> juga </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Selanjutnya, jika variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isSerial == true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toSet dilemparkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int32</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan mengarah ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NRE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat memperbaiki kode ini dengan menambahkan, misalnya, 0 secara default:</font></font><br>
<br>
<pre><code class="cs hljs">toSet = (Serial)((Int32)(toSet ?? <span class="hljs-number">0</span>));</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3031 Pemeriksaan berlebihan dapat disederhanakan. </font><font style="vertical-align: inherit;">'||' </font><font style="vertical-align: inherit;">operator dikelilingi oleh ekspresi berlawanan 'paket == null' dan 'paket! = null'. </font><font style="vertical-align: inherit;">BODBuyGump.cs 64</font></font><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnResponse</span>(<span class="hljs-params">Server.Network.NetState sender, RelayInfo info</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> ( (pack == <span class="hljs-literal">null</span>) ||<font></font>
       ((pack != <span class="hljs-literal">null</span>) &amp;&amp;<font></font>
        (!pack.CheckHold(<font></font>
                m_From,<font></font>
                item,<font></font>
                <span class="hljs-literal">true</span>,
                <span class="hljs-literal">true</span>,
                <span class="hljs-number">0</span>,<font></font>
                item.PileWeight + item.TotalWeight)) ) )<font></font>
  {<font></font>
    pv.SayTo(m_From, <span class="hljs-number">503204</span>);<font></font>
    m_From.SendGump(<span class="hljs-keyword">new</span> BOBGump(m_From, m_Book, m_Page, <span class="hljs-literal">null</span>));<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode ini dapat disederhanakan, seperti yang dilaporkan oleh analisa: </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> ((pack == <span class="hljs-literal">null</span>) || ((pack != <span class="hljs-literal">null</span>) &amp;&amp; (!pack.CheckHold(....))))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sebelah kiri dan kanan operator '||' </font><font style="vertical-align: inherit;">ada ungkapan yang berseberangan dalam makna. </font><font style="vertical-align: inherit;">Di sini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cek </font><i><font style="vertical-align: inherit;">! = Null</font></i><font style="vertical-align: inherit;"> adalah redundan, karena sebelum itu kondisi yang berlawanan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperiksa </font><font style="vertical-align: inherit;">, dan ekspresi ini dipisahkan oleh operator '||'. </font><font style="vertical-align: inherit;">Baris ini dapat disingkat sebagai berikut:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">if</span> (pack == <span class="hljs-literal">null</span> || !pack.CheckHold(....))</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3080 Kemungkinan null dereference. </font><font style="vertical-align: inherit;">Pertimbangkan untuk memeriksa 'pemenang'. </font><font style="vertical-align: inherit;">CTF.cs 1302</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Finish_Callback</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  CTFTeamInfo winner = ( teams.Count &gt; <span class="hljs-number">0</span> ? teams[<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span> );<font></font>
<font></font>
  .... <font></font>
<font></font>
  m_Context.Finish( m_Context.Participants[winner.TeamID] <span class="hljs-keyword">as</span> Participant );<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mengatakan </font><i><font style="vertical-align: inherit;">teams.Count</font></i><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pemenang = nol.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dan selanjutnya dalam kode, properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">winner.TeamID diakses</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tanpa memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan menghasilkan akses dengan referensi nol. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3041 Ungkapan itu secara implisit dilemparkan dari tipe 'int' ke tipe 'double'. Pertimbangkan untuk menggunakan pemeran tipe eksplisit untuk menghindari hilangnya bagian fraksional. Contoh: double A = (double) (X) / Y; StormsEye.cs 87</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Gain</span>(<span class="hljs-params"> Mobile <span class="hljs-keyword">from</span>, Skill skill </span>)</span> <font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">from</span>.Player &amp;&amp; <font></font>
     ( skills.Total / skills.Cap ) &gt;= Utility.RandomDouble())<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fragmen kode ini berisi operasi membagi variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">skills.Total</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">skills.Cap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang bertipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan hasilnya kemudian secara implisit dikonversi menjadi tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seperti yang dilaporkan oleh analisa. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3085 Nama bidang 'typeofObject' dalam tipe bersarang bersifat mendua. Tipe luar berisi bidang statis dengan nama yang identik. PropsGump.cs 744</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Type typeofObject = <span class="hljs-keyword">typeof</span>( <span class="hljs-keyword">object</span> );<font></font>
....<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GroupComparer</span> : <span class="hljs-title">IComparer</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Type typeofObject = <span class="hljs-keyword">typeof</span>( Object );<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeofObject</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
variabel dibuat di bagian kode ini di kelas bersarang </font><font style="vertical-align: inherit;">. Masalahnya adalah bahwa di kelas luar ada variabel dengan nama yang sama, dan kesalahan dapat terjadi karena ini. Lebih baik tidak membiarkan ini untuk mengurangi kemungkinan kesalahan seperti itu karena kurangnya perhatian. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3140 Accessor properti menggunakan bidang dukungan yang berbeda. WallBanner.cs 77</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> m_IsRewardItem;<font></font>
<font></font>
[<span class="hljs-meta">CommandProperty( AccessLevel.GameMaster )</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> IsRewardItem<font></font>
{<font></font>
  <span class="hljs-keyword">get</span>{ <span class="hljs-keyword">return</span> m_IsRewardItem; }
  <span class="hljs-keyword">set</span>{ m_IsRewardItem = <span class="hljs-keyword">value</span>; InvalidateProperties(); }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> m_East;<font></font>
<font></font>
[<span class="hljs-meta">CommandProperty( AccessLevel.GameMaster )</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> East<font></font>
{<font></font>
  <span class="hljs-keyword">get</span>{ <span class="hljs-keyword">return</span> m_East; }
  <span class="hljs-keyword">set</span>{ m_IsRewardItem = <span class="hljs-keyword">value</span>; InvalidateProperties(); }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan di sini ada kesalahan yang muncul akibat copy-paste. Metode akses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">set</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">East</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah untuk menetapkan nilai untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_East</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bukan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_IsRewardItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Peringatan </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio:</font></font></b> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3012 Operator '?:', Terlepas dari ekspresi kondisionalnya, selalu mengembalikan satu dan nilai yang sama: 0xe7f. TreasureChestLevel2.cs 52 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V3012 Operator '?:', Terlepas dari ekspresi kondisionalnya, selalu mengembalikan satu dan nilai yang sama: 0xe77. TreasureChestLevel2.cs 57</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetChestAppearance</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">bool</span> UseFirstItemId = Utility.RandomBool();<font></font>
<font></font>
  <span class="hljs-keyword">switch</span>( Utility.RandomList( <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span> ) )<font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<span class="hljs-comment">// Keg</span>
      <span class="hljs-keyword">this</span>.ItemID = ( UseFirstItemId ? <span class="hljs-number">0xe7f</span> : <span class="hljs-number">0xe7f</span> );
      <span class="hljs-keyword">this</span>.GumpID = <span class="hljs-number">0x3e</span>;
      <span class="hljs-keyword">break</span>;<font></font>
<font></font>
    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<span class="hljs-comment">// Barrel</span>
      <span class="hljs-keyword">this</span>.ItemID = ( UseFirstItemId ? <span class="hljs-number">0xe77</span> : <span class="hljs-number">0xe77</span> );
      <span class="hljs-keyword">this</span>.GumpID = <span class="hljs-number">0x3e</span>;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa jenis ilusi pilihan :) Terlepas dari nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UseFirstItemId</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.ItemID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan baik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xe7f</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam kasus pertama, atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xe77</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di kedua. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V3066 Kemungkinan urutan argumen yang salah diteruskan ke metode 'OnSwing': 'bek' dan 'penyerang'. </font><font style="vertical-align: inherit;">BaseWeapon.cs 1188</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">AbsorbDamageAOS</span>(<span class="hljs-params"> Mobile attacker,
                                    Mobile defender,
                                    <span class="hljs-keyword">int</span> damage </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> ( weapon != <span class="hljs-literal">null</span> )<font></font>
  {<font></font>
    defender.FixedParticles(<span class="hljs-number">0x3779</span>,
                            <span class="hljs-number">1</span>,
                            <span class="hljs-number">15</span>,
                            <span class="hljs-number">0x158B</span>,
                            <span class="hljs-number">0x0</span>,
                            <span class="hljs-number">0x3</span>,<font></font>
                            EffectLayer.Waist);<font></font>
    weapon.OnSwing( defender, attacker );<font></font>
  }<font></font>
  ....<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> TimeSpan <span class="hljs-title">OnSwing</span>(<span class="hljs-params"> Mobile attacker, Mobile defender </span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">return</span> OnSwing( attacker, defender, <span class="hljs-number">1.0</span> );<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya mencurigakan bagi penganalisa bahwa metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnSwing ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diberikan argumen dalam urutan terbalik. </font><font style="vertical-align: inherit;">Mungkin ini karena kesalahan. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perempatan V3092 dimungkinkan dalam ekspresi bersyarat. </font><font style="vertical-align: inherit;">Contoh: if (A&gt; 0 &amp;&amp; A &lt;5) {...} lain jika (A&gt; 3 &amp;&amp; A &lt;9) {...}. </font><font style="vertical-align: inherit;">HouseFoundation.cs 1883</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsFixture</span>(<span class="hljs-params"> <span class="hljs-keyword">int</span> itemID </span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( itemID &gt;= <span class="hljs-number">0x319C</span> &amp;&amp; itemID &lt; <span class="hljs-number">0x31B0</span> ) 
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// ML doors</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( itemID == <span class="hljs-number">0x2D46</span> ||<font></font>
           itemID == <span class="hljs-number">0x2D48</span> ||<font></font>
           itemID == <span class="hljs-number">0x2FE2</span> ||<font></font>
           itemID == <span class="hljs-number">0x2FE4</span> )
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( itemID &gt;= <span class="hljs-number">0x2D63</span> &amp;&amp; itemID &lt; <span class="hljs-number">0x2D70</span> )
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( itemID &gt;= <span class="hljs-number">0x319C</span> &amp;&amp; itemID &lt; <span class="hljs-number">0x31AF</span> ) 
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rentang diuji dalam kondisi berpotongan. </font><font style="vertical-align: inherit;">Ini tampak mencurigakan bagi penganalisa. </font><font style="vertical-align: inherit;">Meskipun kode ini berfungsi dengan benar, masih ada baiknya Anda memperbaikinya. </font><font style="vertical-align: inherit;">Bayangkan sebuah situasi di mana kita perlu menulis ulang tubuh yang terakhir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> demikian sehingga, jika kondisinya benar, metode mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan, katakanlah, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x319C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , metode masih akan mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini, pada gilirannya, akan menyebabkan hilangnya waktu untuk mencari kesalahan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RunUO telah dibuat sejak lama, banyak pekerjaan telah dilakukan, namun, dengan menggunakan contoh proyek ini Anda dapat melihat manfaat dari menggunakan analisis statis pada proyek-proyek dengan sejarah. </font><font style="vertical-align: inherit;">Penganalisa untuk 543 ribu baris kode proyek mengeluarkan sekitar 500 peringatan (tidak termasuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tingkat</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendah), yang sebagian besar tidak muncul dalam artikel karena keseragamannya. </font><font style="vertical-align: inherit;">Untuk berkenalan dengan hasil analisis secara lebih rinci, saya sarankan menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lisensi gratis untuk proyek sumber terbuka</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Ekaterina Nikiforova. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RunUO Check oleh PVS-Studio Analyzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id487106/">https://habr.com/ru/post/id487106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487092/index.html">Memodelkan proses bisnis sebagai bagian dari proyek implementasi sistem ERP</a></li>
<li><a href="../id487094/index.html">Acara pemrosesan ulang yang diterima dari Kafka</a></li>
<li><a href="../id487096/index.html">Cuplikan. Cara membuat proses bekerja dengan dokumentasi lebih mudah</a></li>
<li><a href="../id487098/index.html">Draw with ants: gambar prosedural menggunakan algoritma optimisasi koloni semut</a></li>
<li><a href="../id487100/index.html">Struktur data abadi yang mutakhir</a></li>
<li><a href="../id487108/index.html">Profil Gamer Seluler: Penelitian MyTracker</a></li>
<li><a href="../id487110/index.html">BURUK SRE. Eksperimen lengkap dengan pakar dari Booking.com dan Google.com</a></li>
<li><a href="../id487112/index.html">Edge of Madness: Lingkaran Dasar</a></li>
<li><a href="../id487116/index.html">Mengapa Perselisihan Bermigrasi dari Pergi ke Karat</a></li>
<li><a href="../id487118/index.html">Loki - mengumpulkan log menggunakan pendekatan Prometheus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>