<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏻 🎂 🧑🏽‍🤝‍🧑🏼 AWS Lambda in Action in Java 11. Going Serverless to Production 👨‍👩‍👧‍👦 😍 🙋🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a guide on how to quickly and painlessly start using AWS Lambda with a simple example. Suitable for both a developer who did not work ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>AWS Lambda in Action in Java 11. Going Serverless to Production</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/486648/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This article is a guide on how to quickly and painlessly start using AWS Lambda with a simple example. </font><font style="vertical-align: inherit;">Suitable for both a developer who did not work with Lambda at all, and who knew Cloud to evaluate another vision for developing Serverless applications.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bd/y8/lu/bdy8luzeox9qq09msokx8yzoba4.jpeg" alt="image"><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hello everyone. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My name is Alexander Gruzdev, I am Java Team Lead at DINS. For more than two years, I have been working closely with the AWS infrastructure and have experience both in writing applications for AWS and in deploying these very applications. In my work I had to use ElasticBeanstalk, ECS, Fargate, EKS, and, of course, AWS Lambda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each of these services is good in its own way, and within the framework of this article I will not urge to use only AWS Lambda as a replacement for all other options. I just want to show how easy it is to start using Lambda, and in what cases you will get the benefits of using it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Everyone, from developers to managers, wants a clear process for delivering changes to customers. </font><font style="vertical-align: inherit;">The more transparent this path and the less effort is required, the more profitable. </font><font style="vertical-align: inherit;">Most often, developers and testers do not want to know where the application will be deployed, which piece of hardware to choose, in which region you want to put replicas, etc. </font><font style="vertical-align: inherit;">In the following diagram, you can see “aaS” class of services (as a service), where AWS Lambda represents the FaaS category.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z8/nj/wl/z8njwlqjrgatljwptthtqe9ealu.png" alt="image"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FaaS in a Nutshell</font></font></b>
                        <div class="spoiler_text">FaaS ,            .     ,  , CRUD   C, R, U, D     Create   Read.      ,   —  .<br>
</div>
                    </div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idea</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To demonstrate what the development of a Serverless solution is, I decided to take a rather banal example. </font><font style="vertical-align: inherit;">I think you have seen Contact Us feedback form on many sites, where you can leave your mail or phone and ask a question to be answered later. </font><font style="vertical-align: inherit;">The screen below, the form is not super, but the subject of this article is not material design. </font></font><br>
<img src="https://habrastorage.org/webt/gv/5g/iv/gv5givju7glj8vftkb1cdhupdiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By filling out this form, a potential customer will be waiting for a call or letter from you. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the technical side you need:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">save data from the form to the database;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send a letter to an agent who will answer the question;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perhaps write another service where the agent will mark the work done on the basis of the same database (not included in the scope of the article).</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The implementation of the idea is available on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first thing that comes to mind during implementation is what we need:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">machine under back, front, images, etc.,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">car with base</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">machine with email service.</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/webt/9a/7h/83/9a7h83iyieeicpht4-bcwy8l-ja.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The back and base, in a good way, need to be replicated, but suppose we do this for our mini-store and the load on this form is minimal. </font><font style="vertical-align: inherit;">Therefore, all these machines can be combined into one and deployed in a single set. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But since we are considering Serverless, let's build the architecture entirely on serverless components. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No matter how promising Serverless may sound, we all understand that the servers are still here, they just disappeared from your field of vision. </font><font style="vertical-align: inherit;">And now that cloud work that you could do the chores that you could do on your own. </font><font style="vertical-align: inherit;">But let's try to use only such serverless components: </font></font><br>
<img src="https://habrastorage.org/webt/mf/iw/6i/mfiw6if-6nlss4pl-brkgxenxuc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The diagram shows a very clear separation of the functionality of each component.</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda is the main component that contains code / logic,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S3 is responsible for storing static resources and JS scripts,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CloudFront - for caching mechanisms and multi-regional support,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SES - email service,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DynamoDB - the base for storing data from the form (from whom, what question, where to send the answer),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gateway API - HTTP API for our lambda,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route53 - needed if you want to add a beautiful domain name.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not all of these components will be used in our next guide, just so as not to stretch the article. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Route53 and CloudFront are fairly simple components that you can read about separately. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A little spoilers that will give us such a solution:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are moving away from supporting EC2 machines, no debugging via ssh,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Easy configuration: configure throttling / caching / accesses in one click,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supports access policies: restrict rights and give access,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logging / monitoring out of the box,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pay only for used resources / requests.</font></font></li>
</ul><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo</font></font></h1><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Training</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To begin developing our Serverless solution, you must meet the following requirements:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Active AWS Account</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aws-cli</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam-cli</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jdk 11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradle</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After installing all of the above tools, you need to configure your aws-cli for remote access to AWS. </font><font style="vertical-align: inherit;">Follow the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instructions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This will require creating a new user and unloading his Access Key and Secret Key.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project assembly</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Create a project from a template</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Open the directory for the future project and from it launch SAM CLI. </font><font style="vertical-align: inherit;">Follow the instructions: </font></font><br>
<img src="https://habrastorage.org/webt/kn/gu/7f/kngu7fr3q_h_7t7bq-ygr7baccs.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note: Depending on the SAM-CLI version, the commands may be slightly different, but they all remain intuitive. </font><font style="vertical-align: inherit;">Just choose the ones most similar to those that were used above. </font><font style="vertical-align: inherit;">You can also choose a different build tool if Gradle is not suitable for you. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The project "Hello, World!" </font><font style="vertical-align: inherit;">ready. </font><font style="vertical-align: inherit;">Now you can work on the name of the project and packages, dependencies and source code.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Let's deal with addictions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add the following dependencies to build.gradle:</font></font><br>
<pre><code class="javascript hljs">dependencies {
    <span class="hljs-comment">// AWS</span>
    implementation group: <span class="hljs-string">'com.amazonaws.serverless'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-serverless-java-container-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.4'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.2.0'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-ses'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-java-sdk-dynamodb'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.11.670'</span>
    implementation group: <span class="hljs-string">'com.amazonaws'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'aws-lambda-java-log4j2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'1.1.0'</span><font></font>
<font></font>
    <span class="hljs-comment">// Utils</span>
    implementation group: <span class="hljs-string">'com.fasterxml.jackson.core'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'jackson-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.10.0'</span>
    implementation group: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'commons-io'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.6'</span><font></font>
<font></font>
    <span class="hljs-comment">// Test</span>
    testImplementation group: <span class="hljs-string">'org.mockito'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'mockito-core'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'3.1.0'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-api-mockito2'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'org.powermock'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'powermock-module-junit4'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0.4'</span>
    testImplementation group: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'junit'</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">'4.12'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main ones are the AWS SDK. </font><font style="vertical-align: inherit;">They will allow you to work with specific services, such as SES, DynamoDB, etc.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. We write a lambda</font></font></h3><br>
<ul>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We change the template request and response classes for RequestHandler to AwsProxyRequest and ContactUsProxyResponse.</font></font></b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">RequestHandler</span>&lt;<span class="hljs-title">AwsProxyRequest</span>, <span class="hljs-title">ContactUsProxyResponse</span>&gt;
...
<span class="hljs-title">public</span> <span class="hljs-title">ContactUsProxyResponse</span> <span class="hljs-title">handleRequest</span>(<span class="hljs-title">AwsProxyRequest</span> <span class="hljs-title">request</span>, <span class="hljs-title">Context</span> <span class="hljs-title">context</span>) </span></code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">  AwsClientFactory   AWS SDK-.</b>
                        <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment">/**
 * Just an util class for an eager initialization of sdk clients.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AwsClientFactory</span> </span>{<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOG = LogManager.getLogger(AwsClientFactory.class);<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AmazonSimpleEmailService sesClient;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DynamoDB dynamoDB;<font></font>
<font></font>
    /**<font></font>
     * AWS regions should be env variables <span class="hljs-keyword">if</span> you want to generalize the solution.<font></font>
     */<font></font>
    AwsClientFactory() {<font></font>
        LOG.debug("AWS clients factory initialization.");<font></font>
        sesClient = AmazonSimpleEmailServiceClient.builder().withRegion(Regions.EU_WEST_1).build();<font></font>
        AmazonDynamoDB dynamoDBClient = AmazonDynamoDBClientBuilder.standard().withRegion(Regions.EU_WEST_1).build();<font></font>
        dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(dynamoDBClient);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">DynamoDB <span class="hljs-title">getDynamoDB</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> dynamoDB;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">AmazonSimpleEmailService <span class="hljs-title">getSesClient</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sesClient;<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    ObjectMapper   .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ObjectMapper OBJECT_MAPPER = <span class="hljs-keyword">new</span> ObjectMapper();
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AwsClientFactory AWS_CLIENT_FACTORY = <span class="hljs-keyword">new</span> AwsClientFactory();
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
 <span class="hljs-function"><span class="hljs-keyword">private</span> SendEmailResult <span class="hljs-title">sendEmail</span><span class="hljs-params">(ContactUsRequest contactUsRequest)</span> </span>{<font></font>
        String emailTemplate = getEmailTemplate();<font></font>
        String email = fillTemplate(emailTemplate, contactUsRequest);<font></font>
<font></font>
        SendEmailRequest sendEmailRequest =<font></font>
                <span class="hljs-keyword">new</span> SendEmailRequest(<font></font>
                        System.getenv(<span class="hljs-string">"SENDER_EMAIL"</span>),
                        <span class="hljs-keyword">new</span> Destination(List.of(System.getenv(<span class="hljs-string">"RECIPIENT_EMAIL"</span>))),
                        <span class="hljs-keyword">new</span> Message()<font></font>
                                .withSubject(<font></font>
                                        <span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(contactUsRequest.getSubject()))<font></font>
                                .withBody(<span class="hljs-keyword">new</span> Body()<font></font>
                                        .withHtml(<span class="hljs-keyword">new</span> Content()<font></font>
                                                .withCharset(UTF_8.name())<font></font>
                                                .withData(email))));<font></font>
        LOG.info(<span class="hljs-string">"Email template is ready"</span>);
        <span class="hljs-keyword">return</span> AWS_CLIENT_FACTORY.getSesClient().sendEmail(sendEmailRequest);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">fillTemplate</span><span class="hljs-params">(String emailTemplate, ContactUsRequest contactUsRequest)</span> </span>{
        <span class="hljs-keyword">return</span> String.format(<font></font>
                emailTemplate,<font></font>
                contactUsRequest.getUsername(),<font></font>
                contactUsRequest.getEmail(),<font></font>
                contactUsRequest.getPhone(),<font></font>
                contactUsRequest.getQuestion());<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getEmailTemplate</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> IOUtils.toString(<font></font>
                    Objects.requireNonNull(<span class="hljs-keyword">this</span>.getClass().getClassLoader()<font></font>
                                               .getResourceAsStream(<span class="hljs-string">"email_template.html"</span>)),<font></font>
                    UTF_8);<font></font>
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Loading an email template failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addEmailDetailsToDb</span><span class="hljs-params">(ContactUsRequest contactUsRequest, SendEmailResult sendEmailResult)</span> </span>{<font></font>
        AWS_CLIENT_FACTORY.getDynamoDB().getTable(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                          .putItem(<span class="hljs-keyword">new</span> Item()<font></font>
                                  .withPrimaryKey(<span class="hljs-string">"Id"</span>, sendEmailResult.getMessageId())<font></font>
                                  .withString(<span class="hljs-string">"Subject"</span>, contactUsRequest.getSubject())<font></font>
                                  .withString(<span class="hljs-string">"Username"</span>, contactUsRequest.getUsername())<font></font>
                                  .withString(<span class="hljs-string">"Phone"</span>, contactUsRequest.getPhone())<font></font>
                                  .withString(<span class="hljs-string">"Email"</span>, contactUsRequest.getEmail())<font></font>
                                  .withString(<span class="hljs-string">"Question"</span>, contactUsRequest.getQuestion()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         .</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-function"><span class="hljs-keyword">private</span> ContactUsProxyResponse <span class="hljs-title">buildResponse</span><span class="hljs-params">(<span class="hljs-keyword">int</span> statusCode, String body)</span> </span>{<font></font>
        ContactUsProxyResponse awsProxyResponse =<font></font>
                <span class="hljs-keyword">new</span> ContactUsProxyResponse();<font></font>
        awsProxyResponse.setStatusCode(statusCode);<font></font>
        awsProxyResponse.setBody(getBodyAsString(body));<font></font>
        awsProxyResponse.addHeader(CONTENT_TYPE, ContentType.APPLICATION_JSON.toString());<font></font>
        awsProxyResponse.addHeader(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>);
        <span class="hljs-keyword">return</span> awsProxyResponse;<font></font>
}<font></font>
<font></font>
 <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getBodyAsString</span><span class="hljs-params">(String body)</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> OBJECT_MAPPER.writeValueAsString(<span class="hljs-keyword">new</span> ContactUsResponseBody(body));<font></font>
        } <span class="hljs-keyword">catch</span> (JsonProcessingException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">"Writing ContactUsResponseBody as string failed."</span>, e);<font></font>
        }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    .      «// WARMING UP».</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
<li><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">         handleRequest()</b>
                        <div class="spoiler_text"><pre><code class="java hljs">
<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ContactUsProxyResponse <span class="hljs-title">handleRequest</span><span class="hljs-params">(AwsProxyRequest request, Context context)</span> </span>{<font></font>
        LOG.info(<span class="hljs-string">"Request was received"</span>);<font></font>
        LOG.debug(getAsPrettyString(request));<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (Optional.ofNullable(request.getMultiValueHeaders()).map(headers -&gt; headers.containsKey(<span class="hljs-string">"X-WARM-UP"</span>)).orElse(FALSE)) {<font></font>
            LOG.info(<span class="hljs-string">"Lambda was warmed up"</span>);
            <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">201</span>, <span class="hljs-string">"Lambda was warmed up. V1"</span>);<font></font>
        }<font></font>
<font></font>
        ContactUsRequest contactUsRequest = getContactUsRequest(request);<font></font>
<font></font>
        SendEmailResult sendEmailResult = sendEmail(contactUsRequest);<font></font>
        LOG.info(<span class="hljs-string">"Email was sent"</span>);<font></font>
<font></font>
        addEmailDetailsToDb(contactUsRequest, sendEmailResult);<font></font>
        LOG.info(<span class="hljs-string">"DB is updated"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> buildResponse(<span class="hljs-number">200</span>,<font></font>
                String.format(<span class="hljs-string">"Message %s has been sent successfully."</span>, sendEmailResult.getMessageId()));<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The basic logic is quite simple, so I do not think it is worth describing it in detail. There are several points worth paying attention to. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first is logging. One of the arguments of the Context lambda method contains a lot of auxiliary information, as well as a logger. Therefore, you can not create a separate logger, but use the provided lambda context. To do this, it is enough to call before use:</font></font><br>
<blockquote><code>LambdaLogger logger = context.getLogger(); </code></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second point is warming up. Since creating an executable environment for a lambda is lazy, starting the JVM, loading the classpath and executing the code takes some time. The first call may take several seconds, which is not good if you write different synchronous APIs. For such cases, you yourself can tell AWS that you need to keep several lambda instances on alert. But this requires someone to call a lambda. If we do this with the basic version of the code, then, in fact, we will send a letter and write some inaccurate data to the database.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To avoid this, we can add some kind of request processing to distinguish the real request from the warm-up request. For example, we can add a special header to the request. In our case, the “X-WARM-UP” header will be used with any value - to understand that this is a warm-up request and we only need to return some kind of response without executing business logic.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The last thing I would like to draw attention to is the use of static variables. </font><font style="vertical-align: inherit;">This does not make the stateful lambda instance in our case, it simply allows reusing existing and initialized objects. </font><font style="vertical-align: inherit;">If the objects that you want to initialize statically change during the execution of the code, try to think again whether this will interfere with the operation of subsequent calls to the lambda. </font><font style="vertical-align: inherit;">Also, if these objects use environment variables during initialization, you should not make them static.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. We write tests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lambda code can be covered by the same types of tests that you use in most cases. </font><font style="vertical-align: inherit;">But to keep the article from growing even further, I’ll cover testing Serverless applications in the next article on AWS Lambda testing and on-premises development. </font><font style="vertical-align: inherit;">Although unit tests are already available in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. We write a template of SAM resources</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After we wrote and tested our lambda locally, we need to write a SAM-template to deploy all these resources in AWS.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A bit about SAM</font></font></b>
                        <div class="spoiler_text">Serverless Application Model –     serverless .  ,      CloudFormation DSL,     –   Lambda, Gateway, DynamoDB  . . <br>
SAM, CloudFormation, Terraform –   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">IaC-</a>. SAM     Serverless-,   Terraform        . <br>
 Terraform   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    DINS</a>.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually, let's look at what resources we need to declare in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM-template</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS :: Serverless :: Function</font></font></b></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The main features are already filled in for us if we used SAM init to create the project. </font><font style="vertical-align: inherit;">But here is how they look in my example:</font></font><br>
<pre><code class="plaintext hljs">CodeUri: contact-us-function<font></font>
Handler: com.gralll.sam.App::handleRequest<font></font>
Runtime: java8<font></font>
MemorySize: 256<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here I think everything is clear enough. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeUri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the directory with our </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lambda </font><font style="vertical-align: inherit;">- the full path to the </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Runtime</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">- what the </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lambda is written </font><i><font style="vertical-align: inherit;">on</font></i><font style="vertical-align: inherit;"> - speaks for itself </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speaking of memory</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : up to 3GB of RAM is available in the lambda, which corresponds to a resource of 2 CPUs. That is, you cannot adjust the CPU separately, only increasing / decreasing the amount of memory.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The next block is needed to select the deployment method.</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoPublishAlias</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - allows you to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add an alias</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to each new deployed version </font><font style="vertical-align: inherit;">. This is necessary in order to implement canary deployment. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canary10Percent10Minutes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a type of deployment that will allow you to hold simultaneously two versions of the lambda: the old and the new, but only redirect 10% of the traffic to the new one. If in ten minutes there are no problems, the rest of the traffic will also be redirected to the new version. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can read more about using advanced features </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the SAM page</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next are the environment variables that will be used from the code. After that, another block for lambda:</font></font><br>
<pre><code class="plaintext hljs">Events:<font></font>
  ContactUs:<font></font>
    Type: Api<font></font>
    Properties:<font></font>
      Path: /contact<font></font>
      Method: post<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In it, we must describe the triggers for calling a lambda. In our case, these will be </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Gateway requests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a rather simplified form of describing the API, but it’s enough for the newly created Gateway API to redirect all </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POST / contact</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requests </font><font style="vertical-align: inherit;">to our lambda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, we need to describe the security aspects. Out of the box, the created lambda will not have access to either the database or the email service. So we need to explicitly prescribe what will be allowed. There are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">several ways</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to give access inside AWS. We will use Resource-Based Policies:</font></font><br>
<pre><code class="plaintext hljs">Policies:<font></font>
  - AWSLambdaExecute<font></font>
  - Version: '2012-10-17'<font></font>
    Statement:<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - ses:SendEmail<font></font>
          - ses:SendRawEmail<font></font>
        Resource: 'arn:aws:ses:eu-west-1:548476639829:identity/aleksandrgruzdev11@gmail.com'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:List*<font></font>
        Resource: '*'<font></font>
      - Effect: Allow<font></font>
        Action:<font></font>
          - dynamodb:Get*<font></font>
          - dynamodb:PutItem<font></font>
          - dynamodb:DescribeTable<font></font>
        Resource: 'arn:aws:dynamodb:*:*:table/ContactUsTable'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that for the database table we specified a specific name, therefore, we will need to create a table with the same name. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regarding SES: you see my email address. In your case, it must be your own confirmed address. How to do this, see </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Right after that, you can find the Identity ARN of this resource by clicking on the created address and replace it with the email in the example above. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They sort of figured out the lambda. Now let's move on to the database. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS :: Serverless :: SimpleTable</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For our tasks, we will create only one </font><b><i><font style="vertical-align: inherit;">ContactUsTable</font></i></b><font style="vertical-align: inherit;"> table:</font></font><br>
<pre><code class="plaintext hljs">ContactUsTable:<font></font>
  Type: AWS::Serverless::SimpleTable<font></font>
  Properties:<font></font>
    PrimaryKey:<font></font>
      Name: Id<font></font>
      Type: String<font></font>
    TableName: ContactUsTable<font></font>
    ProvisionedThroughput:<font></font>
      ReadCapacityUnits: 2<font></font>
      WriteCapacityUnits: 2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of the required fields - only Id, and also indicate ReadCapacityUnits and WriteCapacityUnits. </font><font style="vertical-align: inherit;">We will not dwell in detail on what values ​​to choose, since this is also a rather extensive topic. </font><font style="vertical-align: inherit;">You can read it </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">For a test application, small values ​​of the order of 1-2 are also sufficient. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Globals</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
General parameters can be taken out in this block if, for example, you declare several resources of type Function or API.</font></font><br>
<pre><code class="plaintext hljs">Globals:<font></font>
  Function:<font></font>
    Timeout: 15<font></font>
  Api:<font></font>
    Cors:<font></font>
      AllowOrigin: "'*'"<font></font>
      AllowHeaders: "'Content-Type,X-WARM-UP,X-Amz-Date,Authorization,X-Api-Key'"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I used it to set a timeout for the function and some Cors settings to call the Gateway API later from my static page with ContactUs form. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outputs</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This block allows you to dynamically define some variables in the global AWS CloudFormation context.</font></font><br>
<pre><code class="plaintext hljs">Outputs:<font></font>
  ContactUsApi:<font></font>
    Description: "API Gateway endpoint URL for Prod stage for ContactUs function"<font></font>
    Value: !Sub "https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/contact/"<font></font>
  ContactUsFunction:<font></font>
    Description: "ContactUs Lambda Function ARN"<font></font>
    Value: !GetAtt ContactUsFunction.Arn<font></font>
  ContactUsFunctionIamRole:<font></font>
    Description: "Implicit IAM Role created for ContactUs function"<font></font>
    Value: !GetAtt ContactUsFunctionRole.Arn<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we declared a ContactUsApi variable, which will be set to a value, as the public address of our created API endpoint. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since we are using </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {ServerlessRestApi}</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , AWS will insert the unique identifier of our new Gateway API into the string. As a result, any application that has access to CloudFormation will be able to get this address - thereby you can not hardcode the URL of your services. Well, another plus is that it is very convenient to see the list of outputs - some meta information about your stack. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A complete list of functions and what parameters you can use can be found </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameters</font></font></i></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In addition to all of the above, you can add a </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Parameters</font></a><font style="vertical-align: inherit;"> block</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">These options will help make the template more versatile. </font><font style="vertical-align: inherit;">In any other block of the template, you can make references to these parameters, thereby not hardcode some values. </font><font style="vertical-align: inherit;">For example, in my template it can be emails, SES ARN, amount of memory, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's the whole template. </font><font style="vertical-align: inherit;">No one forbids adding a couple more resources nearby, for example, an S3 bucket, any other CloudFormation resource, or a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">custom resource</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in general </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. We proceed to the deployment</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to assemble our project, we will use not Gradle, but SAM.</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assembly</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam build<font></font>
Building resource <span class="hljs-string">'ContactUsFunction'</span><font></font>
Running JavaGradleWorkflow:GradleBuild<font></font>
Running JavaGradleWorkflow:CopyArtifacts<font></font>
<font></font>
Build Succeeded<font></font>
<font></font>
Built Artifacts  : .aws-sam\build<font></font>
Built Template   : .aws-sam\build\template.yaml<font></font>
<font></font>
Commands you can use next<font></font>
=========================<font></font>
[*] Invoke Function: sam <span class="hljs-built_in">local</span> invoke<font></font>
[*] Deploy: sam deploy –guided<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Running the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command from the root of the project will automatically collect </font><font style="vertical-align: inherit;">all the necessary files </font><font style="vertical-align: inherit;">into the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.aws-sam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> folder: classes, dependencies, SAM template. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, you need to create an S3 bucket, where SAM subsequently uploads all the collected artifacts. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This can be done either through the browser-based AWS console, or with the command</font></font><br>
<blockquote><code>aws s3 mb s3://bucket-name</code></blockquote><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note: all buckets are created in a global context, and it is rummaged between all accounts. </font><font style="vertical-align: inherit;">So you can’t create a bucket if someone has already created it in your account. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the bucket is ready, execute the command:</font></font><br>
<blockquote><code>sam package --output-template-file packaged.yaml --s3-bucket &lt;YOUR_BACKET&gt;</code></blockquote><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Package result</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam package --output-template-file packaged.yaml --s3-bucket contact-us-sam-app<font></font>
Uploading to ea0c122c06a50d9676fbf9000a80a3bf  9212768 / 9212768.0  (100.00%)<font></font>
<font></font>
Successfully packaged artifacts and wrote output template to file packaged.yaml.<font></font>
Execute the following <span class="hljs-built_in">command</span> to deploy the packaged template<font></font>
sam deploy --template-file F:\aws\projects\contact-us-sam-app\packaged.yaml --stack-name &lt;YOUR STACK NAME&gt;<font></font>
</code></pre></div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I pointed my contact-us-sam-app bucket, and SAM uploaded all the resources to the specified location. </font><font style="vertical-align: inherit;">Next, SAM already tells you a command to create a stack with resources, and thereby embed your decision. </font><font style="vertical-align: inherit;">We execute the command, having a little finalized:</font></font><br>
<blockquote><code>sam deploy --template-file packaged.yaml --region eu-west-1 --capabilities CAPABILITY_IAM --stack-name contact-us-sam-app </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, I added </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--capabilities CAPABILITY_IAM</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This will enable CloudFormation to create IAM resources. </font><font style="vertical-align: inherit;">Otherwise, you will receive an InsufficientCapabilities error when creating. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following is the log of the work of this command (the picture is clickable). </font><font style="vertical-align: inherit;">Details such as the status of each resource and the values ​​of outputs became available only in one of the latest versions of SAM CLI.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/nv/7p/4z/nv7p4zreqati1wd8c8vy3ubuzcm.png"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Check the status of CloudFormation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can wait for the deployment to complete in the console until a message appears stating that the stack has been deployed (the deploy command logs in the previous paragraph):</font></font><br>
<blockquote><code>Successfully created/updated stack - contact-us-sam-app in eu-west-1</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in our case, you will see this message only after ten minutes due to canary deployment mode. Therefore, it’s easier to open a browser console and watch the stack there. </font></font><br>
<img src="https://habrastorage.org/webt/97/ki/k8/97kik8apukwxsvqwyvsd_wtmaqo.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After some time, the status will change to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE_COMPLETE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which will mean successful completion. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Events</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tab, </font><font style="vertical-align: inherit;">you can see the status of all resources. If your stack flops, this is where you can find detailed error messages. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, this: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE_FAILED</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - if you incorrectly configure the Gateway API in the template.</font></font><br>
<img src="https://habrastorage.org/webt/ce/mh/aq/cemhaqtl6uvdmlvnr0bsvrbokok.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the Resources tab, you can find all created resources. </font><font style="vertical-align: inherit;">Do not be surprised at their quantity. </font><font style="vertical-align: inherit;">Although we only declared a function and a database table in the SAM template, CloudFormation created many other resources for us. </font><font style="vertical-align: inherit;">If you look at their Type, you can understand what service they belong to. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For Api Gateway, it was implicitly created:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApiDeployment</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerlessRestApiProdStage</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also for lambda several additional objects were created. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now open </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and find the URL of our API. </font><font style="vertical-align: inherit;">Copy it, it will come in handy soon.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. HTML ContactUs Form</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you remember, I decided to make a ContactUs form, and now we need to somehow make it available not only on the local machine. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As for the form itself, for example, I decided to take the simplest HTML form and added Gateway API calls through ajax. </font></font><br>
<img src="https://habrastorage.org/webt/ps/e-/4h/pse-4hta3mojfuamij0dhj3bmyg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the form itself, I added a couple of buttons for debugging and simplifying the filling: </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - substitutes, as expected, the default parameters specified inside HTML.</font></font><br>
<pre><code class="javascript hljs">$(<span class="hljs-string">"#url-input"</span>).val(<span class="hljs-string">"https://4ykskscuq0.execute-api.eu-west-1.amazonaws.com/Prod/contact"</span>);<font></font>
$(<span class="hljs-string">"#name-input"</span>).val(<span class="hljs-string">"Mike"</span>);<font></font>
$(<span class="hljs-string">"#email-input"</span>).val(<span class="hljs-string">"Mike@somemail.com"</span>);<font></font>
$(<span class="hljs-string">"#phone-input"</span>).val(<span class="hljs-string">"+79999999999"</span>);<font></font>
$(<span class="hljs-string">"#description-input"</span>).val(<span class="hljs-string">"How much does it cost?"</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you intend to use this functionality, change url-input to the path to your Gateway API, which you copied from </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hosting</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create a new S3 bucket.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We load the HTML file into the bucket by choosing the option to make the file public.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We go into the bucket where we uploaded the file.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go to Properties, then turn on Static website hosting and see your new publicly available Endpoint.</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Health Check</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standard request</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now you can follow the link to your form, click Set default and Send. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This way you will make a request that will go through the Gateway API to AWS Lambda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you configured everything correctly after a while you will receive a message like:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Successful: Message 0102016f28b06243-ae897a1e-b805-406b-9987-019f21547682-000000 has been sent successfully.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This means that the message was delivered successfully. Check your mailbox that you specified in the SAM template. If you have not changed the template, then the letter will be in this format: </font></font><br>
<img src="https://habrastorage.org/webt/0z/wy/sv/0zwysv5ytv3uzn9fb9az7bsa6lg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also open DynamoDB and make sure that a new entry has appeared. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Features of a cold start</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I think you noticed that the message about the successful sending came after a fairly long time. This is due to the fact that the AWS Lambda service, having received a processing request, began to raise the instance of your Java application, and this includes lifting the container with the operating system and JRE, loading the classpath, initializing all the variables, and only after that is the start of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">handleRequest ( )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is called a cold start.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Try filling out and submitting the form again. This time the answer came almost instantly, right? If more than 20-30 minutes have elapsed between the first and second requests, the result may vary. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What is the reason for this? And with the fact that AWS Lambda caches already used containers with lambdas for their reuse. This reduces the initialization time of the entire context for starting the method. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is no clear correlation for how long lambdas are cached depending on whatsoever, but some people experimentally found that this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directly depends on the chosen value of RAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. That is, a lambda with 128MB of memory will be available longer than with 3GB. Perhaps there are other parameters, for example, the average load on the region in which your lambdas are executed, but this is inaccurate. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, experiment yourself and plan the caching time if you use synchronous requests. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warming Up</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As an additional option, you can use lambda heating. In the code, I added an </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-WAMP-UP header</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> check </font><font style="vertical-align: inherit;">. If there is one, the lambda simply returns a response without executing any business logic, but the container will be ready for subsequent calls. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can call your lambda yourself, for example, by the crown timer, using CloudWatch. This will help if you do not want your customers to join Cold Start.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the HTML form, you can find the WarmUp mode button, which adds this special header to the request. </font><font style="vertical-align: inherit;">You can verify that neither sending a letter nor writing to the database occurs, but the response from the lambda arrives, and the subsequent call to the real request will not take much time.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summarizing</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
During the article, we went through all the main stages from application design to its release in the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so-called production</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope that those people who have already heard about Serverless and AWS Lambda, but who did not have practical experience, will be able to use this guide and be able to feel that this gives significant advantages in the speed of deployment of some software solutions and not only that. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benefits</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
For myself, I have identified the most valuable advantages:</font></font><br>
<ul>
<li>     Free Tier      ,     ,       .</li>
<li>           1-2 .        /.</li>
<li>  ,          ,         .</li>
<li>  Serverless      .   ,  —  .   SAM          AWS. AWS    ,         ,   .</li>
<li>      Lambda ,     .</li>
<li>   Serverless    , , .          ELK/Promethes/Grafana      .</li>
<li>   ,             API.          API Key,   IAM ,                      .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Well, probably the most basic thing is Serverless. </font><font style="vertical-align: inherit;">There is no need to think about which EC2 instance you need to pay for, how to configure access to it, how to configure alerts in the event of an application crash, configure auto-scaling, etc.</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disadvantages</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Unfortunately, this does not mean that now you can take this solution and use it as part of an enterprise system instead of your favorite microservices in the cuber. </font><font style="vertical-align: inherit;">Very often, you need to dig deeper to determine a more suitable solution in a particular case. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And I also have comments that you should pay attention to when choosing Lambda:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cold start. </font><font style="vertical-align: inherit;">Especially significant when using synchronous queries, and languages ​​such as Java or C #. </font><font style="vertical-align: inherit;">The problem is moderately solved by warming up, but it is better to think about such a solution in advance and compare the cost and possible benefits</font></font></li>
<li>    .       3GB  ,    2   ,    ,     - Fargate,       ,     .</li>
<li>          API,       ,           .</li>
<li>    /   1-2     Serverless,                .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you already have the infrastructure for developing microservices and CI / CD in Coober, it will again be problematic to argue (especially for managers) the need to support another CI / CD process.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Well, where without testing. </font><font style="vertical-align: inherit;">And to test the lambda for throughput is quite difficult, because it is still different from the usual perfarmance testing, and many factors must be taken into account.</font></font></li>
</ul><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usage</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In general, the use of AWS Lambda and other Serverless services fits very well with the principles of async and event-driven development. </font><font style="vertical-align: inherit;">And it is by using asynchronous processing that optimal results can be achieved both in terms of performance and cost. </font><font style="vertical-align: inherit;">Here is a list of solutions in which Serveress solutions will play a significant role:</font></font><br>
<img src="https://habrastorage.org/webt/i6/ov/y6/i6ovy6ha2pszsiui5jvyewbf-dk.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the article turned out to be quite extensive, and I do not want to inflate it even more, I will most likely prepare a sequel in which I will show how to conduct development more efficiently using all the features of the AWS console, SAM framework, and even IntelljIDEA. </font><font style="vertical-align: inherit;">Well, since I omitted the testing part, I’ll try to describe this aspect of development in more detail. </font><font style="vertical-align: inherit;">Also, if you have any wishes what to add to the next article, or questions, feel free to write in the comments or in private messages. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Added: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda in Action. </font><font style="vertical-align: inherit;">Part 2</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Some important and useful links from the article:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub Project</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download AWS-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download SAM-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS-CLI Configuration</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastructure as code</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experience using Terraform</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of SAM resources</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda Function Aliases</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advanced lambda deployment</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM Api Resource Configuration</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">AWS IAM   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">       SES</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> Read/Write capacity  DynamoDB </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">SAM/CloudFormation  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> Parameters   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  CloudFormation </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">      </a></li>
</ul></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486634/index.html">MSVC Backend updates in Visual Studio 2019 version 16.3 and 16.4</a></li>
<li><a href="../en486638/index.html">Blazor WebAssembly 3.2.0 Preview 1 is now available</a></li>
<li><a href="../en486640/index.html">The digest of interesting materials for the mobile developer # 331 (January 27 - February 2)</a></li>
<li><a href="../en486644/index.html">DIY antenna in 5 minutes</a></li>
<li><a href="../en486646/index.html">Get away from jQuery to Svelte, no pain</a></li>
<li><a href="../en486650/index.html">Dynamic memory in hard real-time systems</a></li>
<li><a href="../en486652/index.html">“Criticism of pure reason” for programmers</a></li>
<li><a href="../en486654/index.html">Motion sensor and alarm and video registration connection in Home Assistant on Raspberry pi</a></li>
<li><a href="../en486656/index.html">How to add new characters to Unicode</a></li>
<li><a href="../en486658/index.html">Moxy Strategy plugin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>