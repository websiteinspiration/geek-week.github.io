<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ú üë≠ ‚ù§Ô∏è Rechecking Newton Game Dynamics with PVS-Studio static analyzer ‚öúÔ∏è üÖøÔ∏è ü§≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, on the Internet, I discovered the physics engine Newton Game Dynamics. Knowing that such projects usually have a large amount of complex cod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Rechecking Newton Game Dynamics with PVS-Studio static analyzer</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/498180/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/uy/ni/sz/uynisz7isgxhs8jv2xqvrxxlyyg.png" alt="Picture 1"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recently, on the Internet, I discovered the physics engine Newton Game Dynamics. </font><font style="vertical-align: inherit;">Knowing that such projects usually have a large amount of complex code, I thought it would be interesting to check it with the PVS-Studio static analyzer. </font><font style="vertical-align: inherit;">My enthusiasm was further spurred by the fact that my colleague Andrei Karpov already tested this project in 2014, which means it is also a good opportunity to demonstrate the development of our analyzer over the past six years. </font><font style="vertical-align: inherit;">It is also worth noting that at the time of writing, the latest release of Newton Game Dynamics is dated February 27, 2020, that is, this project is also actively developing for the past 6 years. </font><font style="vertical-align: inherit;">Thus, I hope that in addition to our team, this article will be of interest to the developers of the engine, who will be able to get rid of some bugs and fix their code.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer output</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 2014, PVS-Studio issued:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48 first level alerts;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">79 second level;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">261 third level.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For 2020, however:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">124 first level warnings;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">272 second level;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">787 of the third level (among which there are also interesting ones).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are much more interesting warnings than in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrey‚Äôs article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but we‚Äôll </font><font style="vertical-align: inherit;">study them in more detail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description of warnings</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning N1</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
V519 The 'tmp [i] [2]' variable is assigned values ‚Äã‚Äãtwice successively. </font><font style="vertical-align: inherit;">Perhaps this is a mistake. </font><font style="vertical-align: inherit;">Check lines: 468, 469. dgCollisionConvexHull.cpp 469</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dgCollisionConvexHull::Create</span> <span class="hljs-params">(dgInt32 count,....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-function">dgStack&lt;dgVector&gt; <span class="hljs-title">tmp</span><span class="hljs-params">(<span class="hljs-number">3</span> * count)</span></span>;
  <span class="hljs-keyword">for</span> (dgInt32 i = <span class="hljs-number">0</span>; i &lt; count; i ++) <font></font>
  {<font></font>
    tmp[i][<span class="hljs-number">0</span>] = dgFloat32 (buffer[i*<span class="hljs-number">3</span> + <span class="hljs-number">0</span>]);<font></font>
    tmp[i][<span class="hljs-number">1</span>] = dgFloat32 (buffer[i*<span class="hljs-number">3</span> + <span class="hljs-number">1</span>]);<font></font>
    tmp[i][<span class="hljs-number">2</span>] = dgFloat32 (buffer[i*<span class="hljs-number">3</span> + <span class="hljs-number">2</span>]);<font></font>
    tmp[i][<span class="hljs-number">2</span>] = dgFloat32 (<span class="hljs-number">0.0f</span>);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The array element </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tmp [i] [2] is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initialized twice in a row. Most often, such a code speaks of copy-paste. You can fix this by removing unnecessary initialization if it is not needed, or by replacing the array index with a subsequent one ‚Äî this already depends on the value of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">count</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">. Further, I would like to describe another warning </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V519</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which Andrei does not have in the article, but has our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error database</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V519 The 'damp' object is assigned values ‚Äã‚Äãtwice successively. Perhaps this is a mistake. physics dgbody.cpp 404</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dgBody::AddBuoyancyForce</span> <span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  damp = (m_omega % m_omega) * dgFloat32 (<span class="hljs-number">10.0f</span>) *<font></font>
        fluidAngularViscousity; <font></font>
  damp = GetMax (GetMin ((m_omega % m_omega) * <font></font>
       dgFloat32 (<span class="hljs-number">1000.0f</span>) * <font></font>
       fluidAngularViscousity, dgFloat32(<span class="hljs-number">0.25f</span>)), <font></font>
       dgFloat32(<span class="hljs-number">2.0f</span>));<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I admit, I did not find this error in the analyzer log. Also, I did not find the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AddBuoyancyForce</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dgbody.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is normal: if new examples of errors found using the warnings of our analyzer are an indicator of the development of PVS-Studio, then the absence of errors found earlier in the project is an indicator of the development of the project. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A small offtopic</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I can‚Äôt pretend to say that the following code fragments contain errors or do not work as expected by the programmer, but they behave rather suspiciously. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The analyzer issued two warnings for this code fragment: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V621 Consider inspecting the 'for' operator. It's possible that the loop will be executed incorrectly or won't be executed at all. MultiBodyCar.cpp 942</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V654 The condition 'i &lt;count' of loop is always false. </font><font style="vertical-align: inherit;">MultiBodyCar.cpp 942</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MultibodyBodyCar</span><span class="hljs-params">(DemoEntityManager* <span class="hljs-keyword">const</span> scene)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> count = <span class="hljs-number">10</span>;<font></font>
  count = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) <font></font>
  {<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; count; j++) <font></font>
    {<font></font>
      <span class="hljs-function">dMatrix <span class="hljs-title">offset</span><span class="hljs-params">(location)</span></span>;<font></font>
      offset.m_posit += dVector (j * <span class="hljs-number">5.0f</span> + <span class="hljs-number">4.0f</span>, <span class="hljs-number">0.0f</span>, i * <span class="hljs-number">5.0f</span>, <span class="hljs-number">0.0f</span>);
      <span class="hljs-comment">//manager-&gt;CreateSportCar(offset, viperModel.GetData());</span><font></font>
      manager-&gt;CreateOffRoadCar(offset, monsterTruck.GetData());<font></font>
    }<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhaps this code is used for debugging, then turning off the loop seems like a normal move. </font><font style="vertical-align: inherit;">Several other similar points were also discovered: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V519 The 'ret' variable is assigned values ‚Äã‚Äãtwice successively. </font><font style="vertical-align: inherit;">Perhaps this is a mistake. Check lines: 325, 326. dString.cpp 326</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dString::LoadFile</span> <span class="hljs-params">(FILE* <span class="hljs-keyword">const</span> file)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">size_t</span> ret = fread(m_string, <span class="hljs-number">1</span>, size, file);<font></font>
  ret = <span class="hljs-number">0</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V519 The 'ret' variable is assigned values ‚Äã‚Äãtwice successively.Perhaps this is a mistake. </font><font style="vertical-align: inherit;">Check lines: 1222, 1223. DemoEntityManager.cpp 1223</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DemoEntityManager::DeserializeFile</span> <span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">size_t</span> ret = fread(buffer, size, <span class="hljs-number">1</span>, (FILE*) serializeHandle);<font></font>
  ret = <span class="hljs-number">0</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V560 A part of conditional expression is always true: (count &lt;10). </font><font style="vertical-align: inherit;">dMathDefines.h 726</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dCholeskyWithRegularizer</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (!pass &amp;&amp; (count &lt; <span class="hljs-number">10</span>))<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
} </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V654 The condition 'ptr! = Edge' of loop is always false. </font><font style="vertical-align: inherit;">dgPolyhedra.cpp 1571</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dgPolyhedra::Triangulate</span> <span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  ptr = edge;<font></font>
  ....<font></font>
  <span class="hljs-keyword">while</span> (ptr != edge);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V763 Parameter 'count' is always rewritten in function body before being used. </font><font style="vertical-align: inherit;">ConvexCast.cpp 31</font></font><br>
<br>
<pre><code class="cpp hljs">StupidComplexOfConvexShapes (...., <span class="hljs-keyword">int</span> count)<font></font>
{<font></font>
  count = <span class="hljs-number">40</span>;
  <span class="hljs-comment">//count = 1;</span><font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V547 Expression 'axisCount' is always false. </font><font style="vertical-align: inherit;">MultiBodyCar.cpp 650</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">UpdateDriverInput</span><span class="hljs-params">(dVehicle* <span class="hljs-keyword">const</span> vehicle, dFloat timestep)</span> 
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> axisCount = scene-&gt;GetJoystickAxis(axis);<font></font>
  axisCount = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (axisCount)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Probably, many will say that when making such a change in the code stored in the public domain, you must at least write a comment. </font><font style="vertical-align: inherit;">Well, I agree. </font><font style="vertical-align: inherit;">Some things that could be painlessly used in a pet project, in my opinion, are unacceptable in the code that a large number of people will use. </font><font style="vertical-align: inherit;">However, the choice is up to the authors. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning N2</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
V769 The 'result' pointer in the 'result + i' expression equals nullptr. </font><font style="vertical-align: inherit;">The resulting value is senseless and it should not be used. </font><font style="vertical-align: inherit;">win32_monitor.c 286</font></font><br>
<br>
<pre><code class="cpp hljs">GLFWvidmode* _glfwPlatformGetVideoModes(_GLFWmonitor* monitor, <span class="hljs-keyword">int</span>* count)<font></font>
{<font></font>
  GLFWvidmode* result = <span class="hljs-literal">NULL</span>;<font></font>
  ....<font></font>
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>;  i &lt; *count;  i++)<font></font>
    {<font></font>
    <span class="hljs-keyword">if</span> (_glfwCompareVideoModes(result + i, &amp;mode) == <span class="hljs-number">0</span>)
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem is that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">result has</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not changed since initialization. </font><font style="vertical-align: inherit;">The resulting pointer will not make sense, it can not be used. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning N3, N4, N5</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
V778 Two similar code fragments were found. </font><font style="vertical-align: inherit;">Perhaps, this is a typo and 'm_colorChannel' variable should be used instead of 'm_binormalChannel'. </font><font style="vertical-align: inherit;">dgMeshEffect1.cpp 1887</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dgMeshEffect::EndBuildFace</span> <span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (m_attrib.m_binormalChannel.m_count) &lt;=<font></font>
  {<font></font>
    attibutes.m_binormalChannel.<font></font>
      PushBack(m_attrib.m_binormalChannel[m_constructionIndex + i]);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (m_attrib.m_binormalChannel.m_count) &lt;= <font></font>
  {<font></font>
    attibutes.m_colorChannel.<font></font>
      PushBack(m_attrib.m_colorChannel[m_constructionIndex + i]);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that the programmer has copied two conditions. </font><font style="vertical-align: inherit;">The second one should look like this:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (m_attrib.m_colorChannel.m_count) &lt;= <font></font>
{<font></font>
  attibutes.m_colorChannel.<font></font>
  PushBack(m_attrib.m_colorChannel[m_constructionIndex + i]);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another very similar error was also found: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V524 It is odd that the body of 'EnabledAxis1' function is fully equivalent to the body of 'EnabledAxis0' function. </font><font style="vertical-align: inherit;">dCustomDoubleHingeActuator.cpp 88</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dCustomDoubleHingeActuator::EnabledAxis0</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> state)</span>
</span>{<font></font>
  m_axis0Enable = state;  &lt;=<font></font>
}<font></font>
<span class="hljs-keyword">void</span> dCustomDoubleHingeActuator::EnabledAxis1(<span class="hljs-keyword">bool</span> state)<font></font>
{<font></font>
  m_axis0Enable = state;  &lt;=<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here the code should be fixed like this:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dCustomDoubleHingeActuator::EnabledAxis1</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> state)</span>
</span>{<font></font>
  m_axis1Enable = state;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another copy-paste: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V525 The code contains the collection of similar blocks. </font><font style="vertical-align: inherit;">Check items 'm_x', 'm_y', 'm_y' in lines 73, 74, 75. dWoodFracture.cpp 73</font></font><br>
<br>
<pre><code class="cpp hljs">WoodVoronoidEffect(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i ++) <font></font>
  {<font></font>
    dFloat x = dGaussianRandom(size.m_x * <span class="hljs-number">0.1f</span>);<font></font>
    dFloat y = dGaussianRandom(size.m_y * <span class="hljs-number">0.1f</span>);  &lt;=<font></font>
    dFloat z = dGaussianRandom(size.m_y * <span class="hljs-number">0.1f</span>);  &lt;=<font></font>
  ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most likely, the initialization of the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should look like this:</font></font><br>
<br>
<pre><code class="cpp hljs">dFloat z = dGaussianRandom(size.m_z * <span class="hljs-number">0.1f</span>); </code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warnings N6, N7</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In Newton Game Dynamics, as in almost any large C or C ++ project, there were some warnings about unsafe work with pointers. </font><font style="vertical-align: inherit;">Such errors are often very difficult to find and debug; they cause program crashes; in general, they are very dangerous and unpredictable. </font><font style="vertical-align: inherit;">Fortunately, our analyzer is able to detect many of these errors. </font><font style="vertical-align: inherit;">It seems obvious that it‚Äôs better to write a check once and not take a steam bath, than spend a lot of time reproducing the problem, finding the problem spot in the code and debugging it. </font><font style="vertical-align: inherit;">Here are some of the warnings: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V522 There might be dereferencing of a potential null pointer 'face'. </font><font style="vertical-align: inherit;">dgContactSolver.cpp 351</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">DG_INLINE dgMinkFace* <span class="hljs-title">dgContactSolver::AddFace</span><span class="hljs-params">(dgInt32 v0,dgInt32 v1,
                                               dgInt32 v2)</span>
</span>{<font></font>
  dgMinkFace* <span class="hljs-keyword">const</span> face = NewFace();<font></font>
  face-&gt;m_mark = <span class="hljs-number">0</span>; <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The definition of the NewFace function is small, so I will give it in full:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">DG_INLINE dgMinkFace* <span class="hljs-title">dgContactSolver::NewFace</span><span class="hljs-params">()</span>
</span>{<font></font>
  dgMinkFace* face = (dgMinkFace*)m_freeFace;<font></font>
  <span class="hljs-keyword">if</span> (m_freeFace) <font></font>
  {<font></font>
    m_freeFace = m_freeFace-&gt;m_next;<font></font>
  } <span class="hljs-keyword">else</span> <font></font>
  {<font></font>
    face = &amp;m_facePool[m_faceIndex];<font></font>
    m_faceIndex++;<font></font>
    <span class="hljs-keyword">if</span> (m_faceIndex &gt;= DG_CONVEX_MINK_MAX_FACES) <font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
    }<font></font>
  }<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _DEBUG</span>
    <span class="hljs-built_in">memset</span>(face, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> (dgMinkFace));
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-keyword">return</span> face;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the functions of the exit points </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewFace</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> returns </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , if returned null pointer dereferencing occur and there will be an undefined behavior of the program. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is also a similar warning to a more dangerous piece of code: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V522 There might be dereferencing of a potential null pointer 'perimeter'. </font><font style="vertical-align: inherit;">dgPolyhedra.cpp 2541</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dgPolyhedra::PolygonizeFace</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  dgEdge* <span class="hljs-keyword">const</span> perimeter = flatFace.AddHalfEdge<font></font>
                           (edge1-&gt;m_next-&gt;m_incidentVertex,<font></font>
                            edge1-&gt;m_incidentVertex);<font></font>
  perimeter-&gt;m_twin = edge1;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the definition of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AddHalfEdge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">dgEdge* <span class="hljs-title">dgPolyhedra::AddHalfEdge</span> <span class="hljs-params">(dgInt32 v0, dgInt32 v1)</span>
</span>{
  <span class="hljs-keyword">if</span> (v0 != v1) <font></font>
  {<font></font>
    <span class="hljs-function">dgPairKey <span class="hljs-title">pairKey</span> <span class="hljs-params">(v0, v1)</span></span>;
    <span class="hljs-function">dgEdge <span class="hljs-title">tmpEdge</span> <span class="hljs-params">(v0, <span class="hljs-number">-1</span>)</span></span>;<font></font>
    dgTreeNode* node = Insert (tmpEdge, pairKey.GetVal()); <font></font>
    <span class="hljs-keyword">return</span> node ? &amp;node-&gt;GetInfo() : <span class="hljs-literal">NULL</span>;<font></font>
  } <span class="hljs-keyword">else</span> <font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the return value at two points of the function's three possible exit points. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In total, I received 48 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V522</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> warnings </font><font style="vertical-align: inherit;">. For the most part, they are of the same type, so I don‚Äôt see any reason to describe any more in the framework of this article. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning N8</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
V668 There is no sense in testing the 'pBits' pointer against null, as the memory was allocated using the 'new' operator. The exception will be generated in the case of memory allocation error. TargaToOpenGl.cpp 166</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">char</span>* <span class="hljs-keyword">const</span> pBits = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span> [width * height * <span class="hljs-number">4</span>];
<span class="hljs-keyword">if</span>(pBits == <span class="hljs-literal">NULL</span>) <font></font>
{<font></font>
  fclose(pFile);<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The analyzer detected a situation where the value of the pointer returned by the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operator </font><font style="vertical-align: inherit;">is compared to zero. </font><font style="vertical-align: inherit;">As a rule, this means that the program, if it is impossible to allocate memory, will behave differently than the programmer expects. </font><font style="vertical-align: inherit;">If the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operator </font><font style="vertical-align: inherit;">could not allocate memory, then, according to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> language </font><i><font style="vertical-align: inherit;">standard</font></i><font style="vertical-align: inherit;"> , an exception </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: bad_alloc () is thrown. </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, the condition will never be fulfilled. </font><font style="vertical-align: inherit;">This is clearly not the behavior the programmer was counting on. </font><font style="vertical-align: inherit;">He planned to close the file in case of a memory allocation error. </font><font style="vertical-align: inherit;">This will not happen and a resource leak will occur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warnings N9, N10, N11</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V764 Possible incorrect order of arguments passed to 'CreateWheel' function: 'height' and 'radius'. </font><font style="vertical-align: inherit;">StandardJoints.cpp 791</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V764 Possible incorrect order of arguments passed to 'CreateWheel' function: 'height' and 'radius'. </font><font style="vertical-align: inherit;">StandardJoints.cpp 833</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V764 Possible incorrect order of arguments passed to 'CreateWheel' function: 'height' and 'radius'. </font><font style="vertical-align: inherit;">StandardJoints.cpp 884</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is how the function calls look:</font></font><br>
<br>
<pre><code class="cpp hljs">NewtonBody* <span class="hljs-keyword">const</span> wheel = CreateWheel (scene, origin, height, radius);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is how the function declaration looks:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> NewtonBody* <span class="hljs-title">CreateWheel</span> <span class="hljs-params">(DemoEntityManager* <span class="hljs-keyword">const</span> scene,
  <span class="hljs-keyword">const</span> dVector&amp; location, dFloat radius, dFloat height)</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This diagnostics suggests that when calling functions, perhaps the arguments were mixed up. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warnings N12, N13</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The analyzer issued warnings for two similar methods with different names: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V621 Consider inspecting the 'for' operator. It's possible that the loop will be executed incorrectly or won't be executed at all. dgCollisionUserMesh.cpp 161 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V621 Consider inspecting the 'for' operator. It's possible that the loop will be executed incorrectly or won't be executed at all. dgCollisionUserMesh.cpp 236</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dgCollisionUserMesh::GetCollidingFacesContinue</span>
    <span class="hljs-params">(dgPolygonMeshDesc* <span class="hljs-keyword">const</span> data)</span> <span class="hljs-keyword">const</span>
</span>{<font></font>
  ....<font></font>
  data-&gt;m_faceCount = <span class="hljs-number">0</span>; &lt;=<font></font>
  data-&gt;m_userData = m_userData;<font></font>
  data-&gt;m_separationDistance = dgFloat32(<span class="hljs-number">0.0f</span>);<font></font>
  m_collideCallback(&amp;data-&gt;m_p0, <span class="hljs-literal">NULL</span>);<font></font>
  dgInt32 faceCount0 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 faceIndexCount0 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 faceIndexCount1 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 stride = data-&gt;m_vertexStrideInBytes / <span class="hljs-keyword">sizeof</span>(dgFloat32);<font></font>
  dgFloat32* <span class="hljs-keyword">const</span> vertex = data-&gt;m_vertex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> address = data-&gt;m_meshData.m_globalFaceIndexStart;<font></font>
  dgFloat32* <span class="hljs-keyword">const</span> hitDistance = data-&gt;m_meshData.m_globalHitDistance;
  <span class="hljs-keyword">const</span> dgInt32* <span class="hljs-keyword">const</span> srcIndices = data-&gt;m_faceVertexIndex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> dstIndices = data-&gt;m_globalFaceVertexIndex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> faceIndexCountArray = data-&gt;m_faceIndexCount;
  <span class="hljs-keyword">for</span> (dgInt32 i = <span class="hljs-number">0</span>; (i &lt; data-&gt;m_faceCount)&amp;&amp;<font></font>
       (faceIndexCount0 &lt; (DG_MAX_COLLIDING_INDICES - <span class="hljs-number">32</span>));<font></font>
       i++)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dgCollisionUserMesh::GetCollidingFacesDescrete</span>
    <span class="hljs-params">(dgPolygonMeshDesc* <span class="hljs-keyword">const</span> data)</span> <span class="hljs-keyword">const</span>
</span>{<font></font>
  ....<font></font>
  data-&gt;m_faceCount = <span class="hljs-number">0</span>; &lt;=  <font></font>
  data-&gt;m_userData = m_userData;<font></font>
  data-&gt;m_separationDistance = dgFloat32(<span class="hljs-number">0.0f</span>);<font></font>
  m_collideCallback(&amp;data-&gt;m_p0, <span class="hljs-literal">NULL</span>);<font></font>
  dgInt32 faceCount0 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 faceIndexCount0 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 faceIndexCount1 = <span class="hljs-number">0</span>;<font></font>
  dgInt32 stride = data-&gt;m_vertexStrideInBytes / <span class="hljs-keyword">sizeof</span>(dgFloat32);<font></font>
  dgFloat32* <span class="hljs-keyword">const</span> vertex = data-&gt;m_vertex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> address = data-&gt;m_meshData.m_globalFaceIndexStart;<font></font>
  dgFloat32* <span class="hljs-keyword">const</span> hitDistance = data-&gt;m_meshData.m_globalHitDistance;
  <span class="hljs-keyword">const</span> dgInt32* <span class="hljs-keyword">const</span> srcIndices = data-&gt;m_faceVertexIndex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> dstIndices = data-&gt;m_globalFaceVertexIndex;<font></font>
  dgInt32* <span class="hljs-keyword">const</span> faceIndexCountArray = data-&gt;m_faceIndexCount;
  <span class="hljs-keyword">for</span> (dgInt32 i = <span class="hljs-number">0</span>; (i &lt; data-&gt;m_faceCount)&amp;&amp;<font></font>
       (faceIndexCount0 &lt; (DG_MAX_COLLIDING_INDICES - <span class="hljs-number">32</span>));<font></font>
       i++)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem in this part of the condition is: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i &lt;data-&gt; m_faceCount.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Since </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data-&gt; m_faceCount is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> assigned 0, this loop will not be executed even once. Probably, when writing this piece of code, the programmer forgot to reinitialize the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_faceCount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> field </font><font style="vertical-align: inherit;">, and then simply copied the method body. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning N14, N15</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The analyzer issued two warnings for similar lines of code in succession: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V630 The '_alloca' function is used to allocate memory for an array of objects which are classes containing constructors. dgSkeletonContainer.cpp 1341 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V630 The '_alloca' function is used to allocate memory for an array of objects which are classes containing constructors. dgSkeletonContainer.cpp 1342</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alloca _alloca</span><font></font>
....<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dAlloca(type,size) (type*) alloca ((size) * sizeof (type))</span><font></font>
....<font></font>
dgSpatialMatrix::dgSpatialMatrix();<font></font>
dgSpatialMatrix::dgSpatialMatrix(dgFloat32 val);<font></font>
....<font></font>
dgSpatialMatrix* <span class="hljs-keyword">const</span> bodyMassArray = dgAlloca(dgSpatialMatrix,<font></font>
                                                m_nodeCount);<font></font>
dgSpatialMatrix* <span class="hljs-keyword">const</span> jointMassArray = dgAlloca(dgSpatialMatrix,<font></font>
                                                 m_nodeCount); </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The problem with this code fragment is that they work with allocated memory as an array of objects that have a constructor or destructor. With this allocation of memory for the class, the constructor will not be called. When freeing memory, the destructor will not be called. This is extremely suspicious. Such code can lead to work with uninitialized variables and other errors. In addition, compared to the approach using </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">malloc / free</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , such code is bad in that if you try to allocate more memory than the machine can provide, you will not receive a clear error message. Instead, you get a segmentation error when you try to access this memory. Here are some more analyzer messages:</font></font><br>
<ul>
<li>V630 The '_alloca' function is used to allocate memory for an array of objects which are classes containing constructors. dVehicleSolver.cpp 498</li>
<li>V630 The '_alloca' function is used to allocate memory for an array of objects which are classes containing constructors. dVehicleSolver.cpp 499</li>
<li>V630 The '_alloca' function is used to allocate memory for an array of objects which are classes containing constructors. dVehicleSolver.cpp 1144</li>
<li>   10  .</li>
</ul><br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, PVS-Studio failed again, during the verification, new interesting errors were discovered. </font><font style="vertical-align: inherit;">And this means that the analyzer does its job well, allowing us to make the world around us a little more perfect. </font><font style="vertical-align: inherit;">In order to try the PVS-Studio static analyzer on your project, you can click on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to share this article with an English-speaking audience, then please use the link to the translation: Vladislav Stolyarov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A Second Check of Newton Game Dynamics with PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en498164/index.html">Product Strategies for Transition Costs</a></li>
<li><a href="../en498168/index.html">New neural network architectures</a></li>
<li><a href="../en498172/index.html">Java Digest for April 21</a></li>
<li><a href="../en498174/index.html">How to stop worrying and start believing in A / B tests</a></li>
<li><a href="../en498178/index.html">We work from home: photo spread</a></li>
<li><a href="../en498186/index.html">Services based on neural networks for designers</a></li>
<li><a href="../en498188/index.html">Probability Theories: Preparing for an Interview and Solving ‚ÄúParadoxes‚Äù</a></li>
<li><a href="../en498192/index.html">Steroid Cosmetic Bag: XD Design Urban Bumbag Review</a></li>
<li><a href="../en498194/index.html">Service Locator - Dispelling Myths</a></li>
<li><a href="../en498196/index.html">FunCorp is looking for QA engineers: go through an interview and receive an offer on the same day</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>