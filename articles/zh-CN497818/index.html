<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🏫 🌘 🌨️ 使用Citrix通过GPU远程访问VM 📎 👩🏽‍🎨 👼🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本指南详细介绍了准备使用Citrix提供的技术对虚拟桌面进行远程访问时必须执行的步骤。
 
 对于最近熟悉桌面虚拟化技术的用户来说，它将很有用，因为它是由约10份手册汇编而成的有用命令的集合，经授权，这些手册中的许多可在Citrix，Nvidia，Microsoft网站上找到。
 
 此实现包含使用...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>使用Citrix通过GPU远程访问VM</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497818/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本指南详细介绍了准备使用Citrix提供的技术对虚拟桌面进行远程访问时必须执行的步骤。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于最近熟悉桌面虚拟化技术的用户来说，它将很有用，因为它是由约10份手册汇编而成的有用命令的集合，经授权，这些手册中的许多可在Citrix，Nvidia，Microsoft网站上找到。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此实现包含使用Nvidia Tesla M60图形加速器和Centos 7操作系统准备对虚拟机（VM）进行远程访问的步骤。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所以，让我们开始吧。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备用于托管虚拟机的管理程序</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何下载和安装XenServer 7.4？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何将XenServer添加到Citrix XenCenter？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何下载并安装Nvidia驱动程序？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何更改Nvidia Tesla M60模式？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何挂载存储？</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></h3><br><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Citrix</font></a><font style="vertical-align: inherit;">网站上授权后即可</font><font style="vertical-align: inherit;">
使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载链接</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
让我们以常规方式将XenServer.iso安装在配备4倍NVIDIA Tesla M60的服务器上。就我而言，iso是通过IPMI安装的。对于Dell服务器，BMC是通过IDRAC管理的。安装步骤几乎与安装类似Linux的操作系统相同。</font><font style="vertical-align: inherit;">
我的XenServer c GPU地址为192.168.1.100 </font><font style="vertical-align: inherit;">
。在要管理虚拟机管理程序和虚拟机的本地计算机上安装XenCenter.msi。单击“服务器”选项卡，然后单击“添加”，在其中添加具有GPU和XenServer的服务器。输入在XenServer安装期间指定的用户名和密码root。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/eb/p2/kr/ebp2kr2edt_ktpzrhsimmkaofbi.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/yy/qv/qw/yyqvqwxcbnxhwkj0ho3brs1lqom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在XenCenter中，单击添加的虚拟机监控程序的名称后，“控制台”选项卡将可用。</font><font style="vertical-align: inherit;">在菜单中，选择“远程服务配置”并启用SSH授权-“启用/禁用远程Shell”。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nvidia驱动程序</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我会</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制住</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情绪，并说在使用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">vGPU的</font></a><font style="vertical-align: inherit;">所有时间里，我从未</font><font style="vertical-align: inherit;">第一次</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">访问过nvid.nvidia.com</font></a><font style="vertical-align: inherit;">网站</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果授权不起作用，则建议使用Internet Explorer。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从vGPU下载zip以及GPUMode更改实用工具：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-gpumodeswitch-2020-01.zip </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/ia/ny/sjianylmppn9as35nnxtrwj-bhw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们遵循这些版本。</font><font style="vertical-align: inherit;">下载的档案的名称显示了将来可以在虚拟机上安装的合适NVIDIA驱动程序的版本。</font><font style="vertical-align: inherit;">就我而言，是390.72。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将zip-s放在XenServer上并解压缩。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更改GPU模式并安装vGPU驱动程序</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> NVIDIA-gpumodeswitch-2020-01<font></font>
$ gpumodeswitch --listgpumodes<font></font>
$ gpumodeswitch --gpumode graphics<font></font>
$ <span class="hljs-built_in">cd</span> ../NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81<font></font>
$ yum install NVIDIA-vGPU-xenserver-7.4-390.72.x86_64.rpm<font></font>
$ reboot</code></pre><br>
<img src="https://habrastorage.org/webt/qg/0m/lx/qg0mlxigfdyfvxvfpoijuh-sisa.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">挂载存储</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在网络上的任何计算机上使用NFS设置共享目录。</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install epel-release<font></font>
$ yum install nfs-utils libnfs-utils<font></font>
$ systemctl <span class="hljs-built_in">enable</span> rpcbind<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-server<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-lock<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-idmap<font></font>
$ systemctl start rpcbind<font></font>
$ systemctl start nfs-server<font></font>
$ systemctl start nfs-lock<font></font>
$ systemctl start nfs-idmap<font></font>
$ firewall-cmd --permanent --zone=public --add-service=nfs<font></font>
$ firewall-cmd --permanent --zone=public --add-service=mountd<font></font>
$ firewall-cmd --permanent --zone=public --add-service=rpc-bind<font></font>
$ firewall-cmd --reload<font></font>
$ mkdir -p /nfs/store1<font></font>
$ chmod -R 777 /nfs/store1<font></font>
$ touch /nfs/store1/forcheck<font></font>
$ cat /etc/exports<font></font>
  ...<font></font>
  /nfs/store1 192.168.1.0/24(rw,async,crossmnt,no_root_squash,no_all_squash,no_subtree_check)<font></font>
$ systemctl restart nfs-server</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在XenCenter中，选择XenServer，然后在“存储”选项卡上选择“新SR”。</font><font style="vertical-align: inherit;">指定存储类型-NFS ISO。</font><font style="vertical-align: inherit;">该路径必须指向NFS共享目录。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于Centos 7的Citrix Master Image</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何使用Centos 7创建虚拟机？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何准备虚拟机创建目录？</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Centos 7的图像</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用XenCenter，我们将创建带有GPU的虚拟机。</font><font style="vertical-align: inherit;">在“ VM”选项卡中，单击“ New VM”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/fs/9g/etfs9g7biwgmswos8eazlinr_ba.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们选择必要的参数：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM模板-其他安装媒体</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名称-模板</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从ISO库安装-Centos 7（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），从已安装的NFS ISO存储中选择。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vCPU数量-4个</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拓扑-1个插槽，每个插槽具有4个内核</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内存-30 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU类型-GRID M60-4Q </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此虚拟磁盘-80 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建后，虚拟机将出现在左侧的垂直列表中。</font><font style="vertical-align: inherit;">单击它，然后转到“控制台”选项卡。</font><font style="vertical-align: inherit;">我们将等待Centos 7安装程序加载并完成必要的步骤，以使用GNOME shell安装操作系统。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影像准备</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我花了很多时间用Centos 7准备图像。</font><font style="vertical-align: inherit;">这产生了一组脚本，这些脚本有助于Linux的初始设置，并允许您使用Citrix Machine Creation Services（MCS）创建虚拟机目录。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装在ws-ad上的DHCP服务器将IP地址192.168.1.129分配给了新的虚拟机。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下是基本设置。</font></font><br>
<br>
<pre><code class="bash hljs">$ hostnamectl <span class="hljs-built_in">set</span>-hostname template<font></font>
$ yum install -y epel-release<font></font>
$ yum install -y lsb mc gcc<font></font>
$ firewall-cmd --permanent --zone=dmz --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=external --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --add-service=ssh<font></font>
$ firewall-cmd --complete-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在XenCenter的“控制台”选项卡中，将guest-tools.iso挂载到虚拟机的DVD驱动器中，然后安装XenTools for Linux。</font></font><br>
<br>
<pre><code class="bash hljs">$ mount /dev/cdrom /mnt<font></font>
$ /mnt/Linux/install.sh<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置XenServer时，我们使用了从NVIDIA网站下载的NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip存档，该存档除了包含XenServer的NVIDIA驱动程序之外，还包含vGPU客户端所需的NVIDIA驱动程序。</font><font style="vertical-align: inherit;">下载并安装在虚拟机上。</font></font><br>
<br>
<pre><code class="bash hljs">$ cat /etc/default/grub<font></font>
  GRUB_TIMEOUT=5<font></font>
  GRUB_DISTRIBUTOR=<span class="hljs-string">"<span class="hljs-subst">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span><font></font>
  GRUB_DEFAULT=saved<font></font>
  GRUB_DISABLE_SUBMENU=<span class="hljs-literal">true</span>
  GRUB_TERMINAL_OUTPUT=<span class="hljs-string">"console"</span>
  GRUB_CMDLINE_LINUX=<span class="hljs-string">"rhgb quiet modprobe.blacklist=nouveau"</span>
  GRUB_DISABLE_RECOVERY=<span class="hljs-string">"true"</span><font></font>
$ grub2-mkconfig -o /boot/grub2/grub.cfg<font></font>
$ wget http://vault.centos.org/7.6.1810/os/x86_64/Packages/kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ yum install kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ reboot<font></font>
$ init 3<font></font>
$ NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81/NVIDIA-Linux-x86_64-390.75-grid.run<font></font>
$ cat /etc/nvidia/gridd.conf<font></font>
  ServerAddress=192.168.1.111<font></font>
  ServerPort=7070<font></font>
  FeatureType=1<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载适用于Centos 7的Linux Virtual Delivery Agent 1811（VDA）</font><font style="vertical-align: inherit;">。在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Citrix</font></a><font style="vertical-align: inherit;">网站上获得授权后</font><font style="vertical-align: inherit;">，即可使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux VDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的下载链接</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">$ yum install -y LinuxVDA-1811.el7_x.rpm<font></font>
$ cat /var/xdl/mcs/mcs.conf<font></font>
  <span class="hljs-comment">#!/bin/bash</span><font></font>
  dns1=192.168.1.110<font></font>
  NTP_SERVER=some.ntp.ru<font></font>
  AD_INTEGRATION=winbind<font></font>
  SUPPORT_DDC_AS_CNAME=N<font></font>
  VDA_PORT=80<font></font>
  REGISTER_SERVICE=Y<font></font>
  ADD_FIREWALL_RULES=Y<font></font>
  HDX_3D_PRO=Y<font></font>
  VDI_MODE=Y<font></font>
  SITE_NAME=domain.ru<font></font>
  LDAP_LIST=ws-ad.domain.ru<font></font>
  SEARCH_BASE=DC=domain,DC=ru<font></font>
  START_SERVICE=Y<font></font>
$ /opt/Citrix/VDA/sbin/deploymcs.sh<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"exclude=kernel* xorg*"</span> &gt;&gt; /etc/yum.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Citrix Studio中，创建计算机目录和交付组。</font><font style="vertical-align: inherit;">在此之前，您必须安装和配置Windows Server。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server与域控制器</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何下载和安装Windows Server 2016？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何安装Windows Server组件？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何配置Active Directory，DHCP和DNS？</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于具有Windows Server的虚拟机（VM）不需要GPU，因此我们将使用没有GPU的服务器作为系统管理程序。与上面的描述类似，安装另一个XenServer来托管系统虚拟机。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
之后，为具有Active Directory的Windows Server创建虚拟机。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站下载Windows Server 2016 </font><font style="vertical-align: inherit;">。最好使用Internet Explorer跟踪链接。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用XenCenter，我们将创建一个虚拟机。在“ VM”选项卡中，单击“ New VM”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们选择必要的参数：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM模板-Windows Server 2016（64位）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名称-ws-ad.domain.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从ISO库</font><font style="vertical-align: inherit;">-WindowsServer2016.iso </font><font style="vertical-align: inherit;">安装，从已安装的NFS ISO存储中选择。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vCPU数量-4</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拓扑-1个插槽，每个插槽4个内核</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内存-20 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU类型-无</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此虚拟磁盘-100 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建后，虚拟机将出现在左侧的垂直列表中。单击它，然后转到“控制台”选项卡。等待Windows Server安装程序加载并完成安装操作系统所需的步骤。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在XenTools VM中安装。右键单击VM，然后单击“安装Citrix VM Tools ...”。之后，将挂载您需要运行和安装XenTools的映像。在安装结束时，将需要重新启动VM。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配置网络适配器：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP地址- 192.168.1.110 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
面膜- 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网关- 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果未激活Windows Server，则激活。</font><font style="vertical-align: inherit;">可以在下载图像的同一位置获取密钥。</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置计算机名称。</font><font style="vertical-align: inherit;">就我而言，这是ws-ad。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组件安装</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在服务器管理器中，选择“添加角色和功能”。</font><font style="vertical-align: inherit;">请注意DHCP服务器，DNC服务器和Active Directory域服务的安装。</font><font style="vertical-align: inherit;">选中“自动重新加载”框。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/5c/mk/r25cmkhjpon52zta-7ysbpffyig.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置活动Directoy</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重新引导VM后，单击“将此服务器提升到域控制器级别”，然后添加新的domain.ru林。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DHCP服务器设置</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在服务器管理器的顶部面板上，单击感叹号以保存安装DHCP服务器时的更改。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们继续进行DHCP服务器设置。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wf/t6/pg/wft6pgjw4_lxdcvqa0rkphy4hhe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建一个新区域192.168.1.120-130。</font><font style="vertical-align: inherit;">我们不会改变其余的。</font><font style="vertical-align: inherit;">选择“立即配置DHCP设置”，然后输入ws-ad IP地址（192.168.1.110）作为网关和DNS，这将从目录中的虚拟机网络适配器的设置中指定。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS服务器设置</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们继续进行DNS服务器设置。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sg/pc/kc/sgpckcwrrfz4z-6jy5pf0ibbnbo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们为domain.ru域中的所有DNS服务器创建一个直接查看的新区域-主区域。</font><font style="vertical-align: inherit;">请勿更改其他任何内容。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过选择相同的选项来创建新的反向查找区域。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在DNS服务器的属性中的“高级”选项卡中，选中“禁用递归”复选框。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个测试用户</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们转到“ Active Directory管理中心”，</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4s/si/tp4ssidqmpefwnpa1excc5oexii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在右侧的“用户”部分中，单击“创建”。</font><font style="vertical-align: inherit;">输入名称（例如测试），然后单击下面的“确定”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/vd/pm/b-vdpmjw8osh9g0tor-ab0jl4sg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将选择创建的用户，然后在右侧的垂直菜单中选择“重置密码”。</font><font style="vertical-align: inherit;">保留选中标记“下次登录系统时要求更改密码”。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server和Citrix Delivery Controller</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何下载和安装Windows Server 2016？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何下载和安装Citrix Delivery Controller？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何安装和配置Citrix License Manager？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何安装和配置NVIDIA License Manager？</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于具有Windows Server的虚拟机（VM）不需要GPU，因此我们将使用没有GPU的服务器作为系统管理程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站下载Windows Server 2016 </font><font style="vertical-align: inherit;">。最好使用Internet Explorer跟踪链接。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用XenCenter，我们将创建一个虚拟机。在“ VM”选项卡中，单击“ New VM”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们选择必要的参数：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM模板-Windows Server 2016（64位）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名称-ws-dc </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从ISO库安装</font><font style="vertical-align: inherit;">-WindowsServer2016.iso </font><font style="vertical-align: inherit;">，从安装的NFS ISO存储中选择。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vCPU数量-4个</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
拓扑-1个插槽，每个插槽具有4个内核</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内存-20 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU类型-无- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此虚拟磁盘-100 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网络</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建后，虚拟机将出现在左侧的垂直列表中。单击它，然后转到“控制台”选项卡。我们将等待Windows Server安装程序加载并完成安装操作系统的必要步骤。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在XenTools VM中安装。右键单击VM，然后单击“安装Citrix VM Tools ...”。之后，将挂载您需要运行和安装XenTools的映像。安装结束时，需要重新启动VM。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配置网络适配器：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP地址- 192.168.1.111 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
面膜- 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
网关- 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果Windows服务器没有被激活，我们会激活它。可以在下载图像的同一位置获取密钥。</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置计算机名称。</font><font style="vertical-align: inherit;">就我而言，这是ws-dc。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将虚拟机添加到域domen.ru，重新启动并以域管理员帐户DOMEN \ Administrator登录。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix交付控制器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在ws-dc.domain.com上下载Citrix Virtual Apps and Desktops 1811。</font><font style="vertical-align: inherit;">登录</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Citrix</font></a><font style="vertical-align: inherit;">网站后，即可使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Virtual Apps and Desktops</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载链接</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
挂载下载的iso并运行。</font><font style="vertical-align: inherit;">选择Citrix Virtual Apps and Desktops 7。</font><font style="vertical-align: inherit;">接下来，点击“开始使用”。</font><font style="vertical-align: inherit;">可能需要重新启动。</font><font style="vertical-align: inherit;">
就我而言，选择以下组件进行安装就足够了：</font><font style="vertical-align: inherit;">
Delivery Controller </font><font style="vertical-align: inherit;">
Studio </font><font style="vertical-align: inherit;">
许可证服务器</font><font style="vertical-align: inherit;">
StoreFront </font><font style="vertical-align: inherit;">
不要更改其他任何内容，然后单击“安装”。</font><font style="vertical-align: inherit;">需要多次重启，然后才能继续安装。</font><font style="vertical-align: inherit;">
安装完成后，将立即启动Citrix Studio（Citrix服务器场管理环境）。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/wy/--/ikwy--onnx7q_qlpdy8jjrn9_qi.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/po/-l/x5/po-lx5nd34-fuw7gibvgajcg42w.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4q/_x/tp4q_xeo9tdviobu4zaannj-vfk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix网站设置</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择三个部分的第一部分-站点设置。</font><font style="vertical-align: inherit;">设置时，指定站点名称-域。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“连接”部分中，我们指定用于连接虚拟机监控程序和GPU的数据：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
连接地址</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-192.168.1.100</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
用户名- </font><font style="vertical-align: inherit;">超级</font><font style="vertical-align: inherit;">用户</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
密码-yourpassword </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
连接名称-m60 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
商店管理-使用虚拟机监控程序本地存储。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这些资源的名称-m60。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择网络。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择一个GPU类型和组-GRID M60-4Q。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调整Citrix计算机目录</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置第二部分-机器目录时，选择单会话OS（Desktop OS）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主映像-选择准备好的虚拟机映像以及Citrix Virtual Apps and Desktops的版本-1811。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择目录中的虚拟机数量，例如4。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们指出命名虚拟机的方案，在我的情况下为桌面##。</font><font style="vertical-align: inherit;">在这种情况下，将创建4个名称为desktop01-04的VM。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
机器目录名称-m60。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
机器目录说明-m60。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在创建具有四个VM的计算机目录后，可以在左侧的XenCenter垂直列表中找到它们。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">思杰交付集团</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第三部分从选择应授予访问权限的VM数量开始。</font><font style="vertical-align: inherit;">我将指出全部四个。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“桌面”部分中，单击“添加”以添加我们将提供访问权限的VM组。</font><font style="vertical-align: inherit;">显示名称-m60。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
交货组名称-m60。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置了三个主要部分之后，Citrix Studio的主窗口将如下所示：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/s3/up/kbs3up5h_utcj8db_caznbwgo_i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix许可证管理器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过您的个人帐户在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站上下载许可证文件</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在左侧的垂直列表中，选择“所有许可工具（旧版）”。转到选项卡“激活和分配许可证”。选择Citrix VDA许可证，然后单击继续。指定我们的Delivery Controllera的名称-ws-dc.domain.ru和许可证数量-4.单击“继续”。将生成的许可证文件下载到ws-dc.domain.ru。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-f/6o/tg/-f6otgoimp8n0qh_xdcrfvf5hew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Citrix Studio的左垂直列表中，选择“许可”部分。在右侧垂直列表中，单击“许可证管理控制台”。在打开的浏览器窗口中，输入域用户DOMEN \ Administrator的授权数据。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Citrix Licensing Manager中，转到“安装许可证”选项卡。要添加许可证文件，请选择“使用下载的许可证文件”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/sy/rz/bosyrz3sj4ysmjs0vlwfhcp36ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Citrix组件的安装涉及使用多个虚拟机，一个组件-一个虚拟机。</font><font style="vertical-align: inherit;">就我而言，所有Citrix系统服务都在同一VM中运行。</font><font style="vertical-align: inherit;">在这方面，我注意到一个错误，对于我而言，更正该错误特别困难。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果在重新启动ws-dc之后存在其他性质的问题，那么我建议您首先检查正在运行的服务。</font><font style="vertical-align: inherit;">以下是在VM重新引导后应自动启动的Citrix服务的列表：</font></font><br>
<br>
<pre><code class="plaintext hljs">SQL Server (SQLEXPRESS)<font></font>
Citrix Configuration Service<font></font>
Citrix Delegated Administration Service<font></font>
Citrix Analytics<font></font>
Citrix Broker Service<font></font>
Citrix Configuration Logging Service<font></font>
Citrix AD Identity Service<font></font>
Citrix Host Service<font></font>
Citrix App Library<font></font>
Citrix Machine Creation Service<font></font>
Citrix Monitor Service<font></font>
Citrix Storefront Service<font></font>
Citrix Trust Service<font></font>
Citrix Environment Test Service<font></font>
Citrix Orchestration Service<font></font>
FlexNet License Server -nvidia</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我在单个VM上安装各种Citrix服务时遇到了一个问题。</font><font style="vertical-align: inherit;">重新启动后，并非所有服务都会启动。</font><font style="vertical-align: inherit;">懒惰一个接一个地启动了整个链条。</font><font style="vertical-align: inherit;">该解决方案经过艰苦的谷歌搜索，因此将其引入此处-应在注册表中更改两个参数：</font></font><br>
<br>
<pre><code class="bash hljs">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control<font></font>
Name : ServicesPipeTimeout<font></font>
Value :240000<font></font>
<font></font>
Name : WaitToKillServiceTimeout<font></font>
Value : 20000</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nvidia许可证管理器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过您在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的个人帐户下载Windows版NVIDIA许可证管理器</font><font style="vertical-align: inherit;">。最好使用Internet Explorer。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/hb/ih/auhbihphsv81hapm3cpgpxjbcmi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将其安装在ws-dc上。为此，您首先需要安装</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JAVA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并添加环境变量JAVA_HOME。之后，您可以运行setup.exe来安装NVIDIA License Manager。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nv/bd/wu/nvbdwuyf4xtx-fsqqpa2qwzunke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们创建一个服务器，在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">站点上的个人帐户中生成并下载许可证文件</font><font style="vertical-align: inherit;">。让我们传输ws-dc的许可证文件。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/ui/zb/r-uizbl706_p1w35j27fk0lv2wu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用浏览器，我们登录NVIDIA许可证管理器Web界面（可在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：8080 / licserver上找到）并添加许可证文件。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ut/oc/viutocj16sitn-q_diao-oehmfa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以在“许可的客户端”部分中查看使用vGPU的活动会话。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">远程访问Citrix计算机目录</font></font></h2><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何安装Citrix Receiver？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如何连接到虚拟桌面？</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在运行正常的计算机上，打开浏览器（在我的情况下为Chrome），然后转到Citrix StoreWeb的网络界面地址</font></font><br>
<br>
<pre><code class="bash hljs">http://192.168.1.111/Citrix/StoreWeb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果尚未安装Citrix Recever，则单击“发现Receiver”。我们会</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/iv/nh/riivnhuygym-oivw0iaq0hghr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仔细阅读许可协议，下载并安装Citrix Receiver。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/9b/cd/r39bcddyu-e57s9tpk6gj-o19vg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装后，返回浏览器并单击“继续”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/vw/dg/iavwdgrxnyukfifcb03b0gvbyf4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，在Chrome浏览器中打开一个通知，单击“打开Citrix Receiver Launcher应用程序”。 ，然后单击“再次检测”或“已安装”。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7o/hs/bx/7ohsbxmdogzv7tvdwji5xwa1xam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于第一个连接，我们将使用测试用户测试的数据。</font><font style="vertical-align: inherit;">将临时密码更改为永久密码。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/as/9k/l0/as9kl0vlibg4fmhts2rjgrsupvw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
授权后，转到“应用程序”选项卡并选择“ M60” </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/fb/md/j9fbmdbevvo42-2su76ifsaisnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目录</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">下载扩展名为.ica的建议文件。</font><font style="vertical-align: inherit;">双击它之后，在带有Centos 7桌面的Desktop Veiwer中打开一个窗口</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/70/3p/n2703pzygelapwl6ixj7n5wcgfm.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN497808/index.html">3D自己做。第2部分：三维</a></li>
<li><a href="../zh-CN497810/index.html">PVS Studio.VS。GCC 10的统计分析</a></li>
<li><a href="../zh-CN497812/index.html">麻省理工学院的科学家正在开发一种可以至少部分控制自己梦想的设备</a></li>
<li><a href="../zh-CN497814/index.html">接受不可避免的五个阶段，或者我们如何开发用于自动配置的程序</a></li>
<li><a href="../zh-CN497816/index.html">俄罗斯铁路将别人的车票发给我</a></li>
<li><a href="../zh-CN497820/index.html">对它们的不正确逆问题的统计正则化。Turchin（第1部分）</a></li>
<li><a href="../zh-CN497822/index.html">瓶中的男人</a></li>
<li><a href="../zh-CN497826/index.html">如何使用OPSI快速捕获世界或管理Windows计算机网络</a></li>
<li><a href="../zh-CN497828/index.html">2合1：具有安全保护功能的加密</a></li>
<li><a href="../zh-CN497830/index.html">OWASP莫斯科2020/1记录</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>