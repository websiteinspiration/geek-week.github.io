<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♐️ 👨🏻 😵 C＃8およびnullの有効性。これをどうやって生きるの 🥡 🏜️ 🧗🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは！C＃8に関するIan Griffithsの基本的な本をリリースする計画があることを言及する時が来ました：
 
 
 その間、彼のブログで、著者はnull可能性、null気づき、null認識などの新しい現象の複雑さを考慮した2つの関連記事を公​​開しています。1つの見出しの下で両方の記事を...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C＃8およびnullの有効性。これをどうやって生きるの</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/501520/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！</font><font style="vertical-align: inherit;">C＃8に関するIan Griffithsの</font><font style="vertical-align: inherit;">基本的な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をリリースする計画があることを言及する時が来ました</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/iw/to/l-/iwtol-20o3gyqy1ppgnewp68giw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その間、彼の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブログで、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者は</font><font style="vertical-align: inherit;">null可能性、null気づき、null認識などの新しい現象の複雑さを考慮した</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関連</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を公​​開</font><font style="vertical-align: inherit;">しています。</font><font style="vertical-align: inherit;">1つの見出しの下で両方の記事を翻訳し、それらについて議論することをお勧めします。</font></font><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C＃8.0で最も野心的な新機能は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null許容参照</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この新機能の目的は、コンピューター科学者のトニーホアーがかつて彼の「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10億ドルの間違い</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」と呼んでいた危険なものからの損傷を取り除く</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">こと</font></a><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">C＃にはキーワードがあります</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（同等のものは他の多くの言語で見られます）、そしてこのキーワードのルーツは、Hoarが参加した言語であるAlgol Wに遡ることができます。この古代の言語（1966年に登場）では、特定の型のインスタンスを参照する変数は、現在この変数がどこでも参照されていないことを示す特別な意味を受け取る可能性があります。この機会は非常に広く借りられており、今日、多くの専門家（Hoar自身を含む）は、これがかつてないほどの高額なソフトウェアエラーの最大の原因となっていると信じています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゼロを仮定することの何が問題になっていますか？リンクがゼロを指す可能性がある世界では、コード内でリンクが使用されている場合は常にこれを考慮する必要があります。そうしないと、実行時に拒否されるリスクがあります。時にはそれはあまり負担にならない;変数を</font></font><code>new</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宣言するのと同じ場所で</font><font style="vertical-align: inherit;">式を使用</font><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">変数を初期化</font><font style="vertical-align: inherit;">すると、この変数はゼロに等しくないことがわかります。しかし、そのような単純な例でさえ、いくつかの認知的負荷がつきものです。C＃8のリリース前は、この値に変換できるものを実行しているかどうかコンパイラーは通知できませんでした</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。しかし、コードのさまざまな断片をつなぎ始めるとすぐに、そのようなことを確実に判断することがはるかに難しくなり</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">今読んでいるこのプロパティが返す可能性はどのくらいあり</font><font style="vertical-align: inherit;">ますか？送信は許可されていますか</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その方法に？どのような状況で、呼び出しているメソッドがこの引数をで</font></font><code>out</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はなく</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、別の値に</font><font style="vertical-align: inherit;">設定することを確認でき</font><font style="vertical-align: inherit;">ますか？さらに、問題はそのようなものをチェックすることを覚えていることに限定されるものではありません。ゼロになったときに何をすべきかは完全には明らかではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C＃の数値型では、そのような問題はありません。いくつかの数値を入力として受け取り、結果として数値を返す関数を作成する場合、送信された値が実際に数値であるかどうか、およびそれらの間で何かが混同される可能性があるかどうかを気にする必要はありません。そのような関数を呼び出すとき、数値の代わりに何かを返すことができるかどうかを考える必要はありません。このようなイベントの発生がオプションとして興味がない場合：この場合、タイプのパラメーターまたは結果を宣言できます。</font></font><code>int?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、この特定のケースでは、null値の送信または戻りを本当に許可することを示しています。したがって、数値型、およびより一般的な意味では重要な型の場合、許容誤差ゼロは常に、オプションとして自発的に行われることの1つでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参照タイプについては、C＃8.0より前は、ゼロの許容範囲がデフォルトで設定されているだけでなく、無効にすることもできませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、下位互換性の理由から、C＃8.0でもゼロ有効性はデフォルトで機能し続けます。この領域の新しい言語関数は、明示的に要求するまで無効のままであるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、この新しい機能を有効にするとすぐに、すべてが変更されます。これをアクティブにする最も簡単な方法は</font></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、要素内</font><font style="vertical-align: inherit;">に追加すること</font><font style="vertical-align: inherit;">です。</font></font><code>&lt;PropertyGroup&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたのファイルで</font></font><code>.csproj</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 （より細かい制御も利用できることに注意してください。本当に必要な場合は、動作を</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各行で個別に</font><font style="vertical-align: inherit;">許可するように構成できます</font><font style="vertical-align: inherit;">。しかし、この機能をすべてのプロジェクトに含めることを最近決定したとき、それは規模でアクティブになることが判明しました一度に1つのプロジェクトが実行可能なタスクです。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C＃8.0で許可されているリンクが</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全にアクティブになると、状況が変化します。デフォルトでは、重要なタイプとまったく同じように、反対を指定しない場合にのみ、リンクがnullを許可しないと見なされます（構文も同じです。整数値をオプションにしたい場合は、int？を記述できます。文字列へのリンクが必要な場合は、string？を記述します。</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは非常に重要な変更であり、まず、その重要性のために、この新しい機能はデフォルトで無効になっています。 Microsoftはこの言語機能を別の方法で設計した可能性があります。デフォルトのリンクをnullのままにして、許可されていないことを確認するように指定できる新しい構文を導入できます</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。おそらく、これはこの可能性を探るときに基準を下げますが、実際にはC＃コードの膨大な量のリンクのほとんどがを指すように設計されていないため、このような解決策は正しくありません</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゼロは例外ではなく規則であると想定しているため、この新しい言語機能を有効にすると、nullの防止が新しいデフォルトになります。これは、元の機能名「nullable参照」にも反映されています。リンクが</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＃1.0を</font><font style="vertical-align: inherit;">指す可能性があることを考えると、名前は奇妙</font><font style="vertical-align: inherit;">です。しかし、開発者は、今ではnullの仮定が明示的に要求される必要のあるもののカテゴリーに入るということを強調することを選択しました。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C＃8.0 </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、この機能を段階的に導入できるため、</font><font style="vertical-align: inherit;">寛容なリンクの導入プロセスがスムーズ</font><font style="vertical-align: inherit;">になります。イエスかノーかの選択をする必要はありません。これは</font></font><code>async/await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、C＃5.0で追加され</font><font style="vertical-align: inherit;">た機能とはかなり異なります</font><font style="vertical-align: inherit;">。C＃5.0は、拡散する傾向がありました。実際、非同期操作では、呼び出し元は</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、したがって、この呼び出し元を呼び出すコード</font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、スタックの最上部で</font><font style="vertical-align: inherit;">なければなりません</font><font style="vertical-align: inherit;">。幸いなことに、許可するタイプ</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は構成が異なります。それらは選択的かつ段階的に実装できます。必要に応じて、ファイルを1つずつ、または1行ずつ操作できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
許可するタイプの最も重要な側面</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（それらへの移行が簡素化されたことに感謝します）、デフォルトでは無効になっています。そうしないと、ほとんどの開発者はC＃8.0の使用を拒否します。これは、このような移行により、ほとんどすべてのコードベースで警告が発生するためです。ただし、同じ理由で、この新機能を使用するための開始しきい値はかなり高く感じられます。新機能がそのような劇的な変更を行い、デフォルトで無効になっている場合、おそらくそれを台無しにしたくないでしょうが、それに切り替えることに関連する問題があります。常に不必要な手間がかかります。しかし、この機能は非常に貴重なので、これは残念です。ユーザーがあなたのためにそれを行う前に、コードのバグを見つけるのに役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、許可するタイプの導入を検討している場合</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、この機能を段階的に導入できることに注意してください。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告のみ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
単純なオン/オフ後のプロジェクト全体の最も大まかな制御レベルは、注釈に関係なく警告をアクティブにする機能です。たとえば</font><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Corvus.ContentHandling</font></a><font style="vertical-align: inherit;">リポジトリ</font><font style="vertical-align: inherit;">で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corvus.ContentHandling.Json</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のゼロ仮定を完全に有効に</font><font style="vertical-align: inherit;">して、プロジェクトファイルのプロパティのグループに</font><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">すると、現在の状態では、コンパイラからの20の警告がすぐに表示されます。ただし、代わりに使用すると、</font><font style="vertical-align: inherit;">警告が1つだけ表示されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>&lt;Nullablegt;enable&lt;/Nullablegt;</code><font style="vertical-align: inherit;"></font><code>&lt;Nullablegt;warnings&lt;/Nullablegt;</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちょっと待って！警告が少なく表示されるのはなぜですか？最後に、ここで警告を求めました。この質問への答えは完全に明白ではありません。実際には、一部の変数と式は</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullに気づかない</font><font style="vertical-align: inherit;">場合があり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null中立性</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
C＃はnullの有効性の2つの解釈をサポートしています。第1に、参照型の変数は</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を許可するかどうかを</font><font style="vertical-align: inherit;">宣言できます。</font><font style="vertical-align: inherit;">第2に、コンパイラーは可能な限り、この変数が</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードの特定の場所にある</font><font style="vertical-align: inherit;">かどうかを論理的に結論付け</font><font style="vertical-align: inherit;">ます。この記事では、最初のさまざまな許容性のみを扱います</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまり、変数の静的型について（実際、これは変数とパラメーター、およびそれらに近いフィールドにのみ当てはまります。静的および論理的に推論可能な許容性は</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、C＃の各式に対して決定されます。）実際、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その第一の</font><font style="vertical-align: inherit;">許容性</font><font style="vertical-align: inherit;">、私たちが検討しているのは型システムの拡張です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、型のnull許容性のみに焦点を当てると、想定されるほど一貫性のある状況にならないことがわかります。これは、「null valid」と「invalid」の単なる対比ではありません</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」実際、さらに2つの可能性があります。ジェネリック医薬品が入手可能であるため必須である「不明」のカテゴリがあります。無制限の型パラメーターがある場合、その有効性</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について</font><font style="vertical-align: inherit;">何も見つけることはできません。</font><font style="vertical-align: inherit;">適切な一般化されたメソッドまたは型を使用するコードは、それらの引数を許可または禁止に置き換えることができ</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。制限を追加することもできますが、一般化されたタイプまたはメソッドの範囲が狭くなるため、このような制限は望ましくありません。したがって、いくつかの無制限の型パラメーターの変数または式の場合</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ゼロの（非）有効性は不明でなければなりません。おそらく、どちらの場合でも、許容性の問題</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらは個別に決定されますが、型引数に依存するため、汎用コードに表示されるオプションはわかりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後者のカテゴリは「ニュートラル」と呼ばれます。 「中立性」の原則により、すべてがC＃8.0の登場前に機能しました。これは、ヌル可能リンクで機能する機能をアクティブ化しない場合に機能します。 （基本的に、これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遡及性の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例です</font><font style="vertical-align: inherit;">。ヌルニュートラルの考え方は、リンクのヌル有効性をアクティブにする前にコードの自然な状態としてC＃8.0で最初に導入されましたが、C＃設計者は、このプロパティがC＃に実際には無関係であることはないと主張しました。）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、「中立性」の意味を説明する必要がないかもしれません。C＃が常に機能しているのはこの脈であるので、あなた自身がすべてを理解しています...おそらくこれは少し不誠実です。だから聞いてください：許容性がわかっている世界では</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-eutral式の</font><font style="vertical-align: inherit;">最も重要な特性は</font><font style="vertical-align: inherit;">、nullの受け入れ可能性について警告を出さないことです。許可される</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">としてnull中立式を割り当てることはできますが、許可することはでき</font><font style="vertical-align: inherit;">ません。</font></font><code>Null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ニュートラル変数（およびプロパティ、フィールドなど）では、コンパイラーが「可能</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」または「不可能</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font><font style="vertical-align: inherit;">と見なした式を割り当てることができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、警告をオンにするだけでは、新しい警告はそれほど多くありません。すべてのコードは無効化された有効性アノテーションのコンテキスト内に留まる</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、すべての変数、パラメーター、フィールド、およびプロパティは</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュートラルになります</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、これらを考慮に入れるエンティティと組み合わせて使用​​しようとしても、警告は表示されません</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、なぜ警告が表示されるのですか？一般的な理由は、受け入れられない方法で友達を作ろうとしたため、考慮に入れられた2つのコードが原因</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。たとえば、寛容なリンクが完全に含まれ</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ているライブラリがあり、このライブラリに次のように深く考案されたクラスがあるとします。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NullableAwareClass</span><font></font>
	{<font></font>
	    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span>? GetNullable() =&gt; DateTime.Now.Hour &gt; <span class="hljs-number">12</span> ? <span class="hljs-literal">null</span> : <span class="hljs-string">"morning"</span>;<font></font>
	<font></font>
<font></font>
	    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">RequireNonNull</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> s</span>)</span> =&gt; s.Length;<font></font>
	}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、別のプロジェクトでは、nullの有効性の警告がアクティブ化されているコンテキストでこのコードを記述できますが、対応する注釈は無効になっています。 </font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">UseString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> x</span>)</span> =&gt; NullableAwareClass.RequireNonNull(x);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nullの有効性に関する注釈は無効になっているため、</font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font><font style="vertical-align: inherit;">のパラメーター</font><font style="vertical-align: inherit;">は</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中立です。</font><font style="vertical-align: inherit;">これは、コンパイラがこのコードが正しいかどうかを判断できないことを意味します。</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュートラルな式が考慮に入れられる式と混合</font><font style="vertical-align: inherit;">されている場合にコンパイラーが警告を発行した場合、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらの警告のかなりの部分が疑わしいと見なされる可能性があるため、警告は発行されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このラッパーを使用して、コードが有効性を考慮するという事実を実際に隠しました</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、次のように書くことができます。</font></font><br>
<br>
<pre><code class="cs hljs">	<span class="hljs-keyword">int</span> x = UseString(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイラーは何</font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返す</font><font style="vertical-align: inherit;">こと</font><font style="vertical-align: inherit;">ができる</font><font style="vertical-align: inherit;">かを知ってい</font><font style="vertical-align: inherit;">ます</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、私はnull中立パラメーターでメソッドを呼び出したので、プログラムはこれが正しいか間違っているかを知りません。</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-neutralラッパー</font><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">、コンパイラーを武装解除しましたが、ここでは問題は発生しません。ただし、これら2つの方法を直接組み合わせた場合、すべてが異なります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> y = NullableAwareClass.RequireNonNull(NullableAwareClass.GetNullable());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで私は結果を渡す</font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">右へ</font></font><code>RequireNonNull</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 nullの仮定が有効になっているコンテキストでこれを実行しようとすると、対応する注釈のコンテキストをオンまたはオフにしたかどうかに関係なく、コンパイラーが警告を生成します。この特定のケースでは、参照型の宣言がないため、注釈のコンテキストは重要ではありません。 nullの仮定に関する警告を有効にし、対応する注釈を無効にすると、すべての宣言が</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中立になりますが、すべての式がそのようになるわけではありません。したがって、結果</font></font><code>GetNullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はnull </font><font style="vertical-align: inherit;">であること</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">わかり</font><font style="vertical-align: inherit;">ます。したがって、警告が表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要約：許可無効の注釈のコンテキスト内のすべての宣言以来</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">されています</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-中立、ほとんどの式は</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中立である</font><font style="vertical-align: inherit;">ため、警告はあまり表示されません</font><font style="vertical-align: inherit;">。しかし、コンパイラーは</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、式が一部のnullに依存しない中間手段を通過しない場合でも</font><font style="vertical-align: inherit;">、仮定</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">関連するエラーをキャッチでき</font><font style="vertical-align: inherit;">ます。さらに、この場合の最大の利点は、次のように</font></font><code>.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、を</font><font style="vertical-align: inherit;">使用して潜在的なnull値を逆参照する試みに関連するエラーを検出すること</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">int</span> z = NullableAwareClass.GetNullable().Length;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードが適切に設計されている場合は、この種のエラーが多数発生することはありません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクト全体の段階的なアノテーション</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最初のステップを実行した後-警告をアクティブにするだけで、ファイルごとにアノテーションの段階的なアクティブ化に進むことができます。それらをプロジェクト全体にすぐに含め、どのファイルに警告が表示されるかを確認してから、警告が比較的少ないファイルを選択すると便利です。ここでも、プロジェクト全体のレベルでオフにして、選択したファイルの上部に書き込みます</font></font><code>#nullable enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これにより、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル全体</font><font style="vertical-align: inherit;">の仮定</font><font style="vertical-align: inherit;">（警告と注釈の両方）</font><font style="vertical-align: inherit;">が完全に有効になり</font><font style="vertical-align: inherit;">ます（別のディレクティブを使用して再度オフにしない限り）。</font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）次に、ファイル全体を調べて、nullである可能性が高いすべてのエンティティに許可</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（つまり、追加</font></font><code>?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">注釈が付けられていることを</font><font style="vertical-align: inherit;">確認し、残っている場合はこのファイルの警告に対処します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての警告を排除するために必要なのは、必要な注釈をすべて追加することだけです。逆も可能です。1つのファイルに有効性についてきちんと注釈を付けると、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それを使用する他のファイルに他の警告が表示されています。原則として、そのような警告はそれほど多くなく、すぐに修正する時間があります。しかし、このステップの後に何らかの理由で警告に溺れてしまった場合でも、いくつかの解決策があります。まず、選択をキャンセルし、このファイルをそのままにして、別のファイルを取得することができます。 2番目に、最も問題を引き起こしていると思われるメンバーの注釈を選択的にオフにすることができます。 （</font></font><code>#nullable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font><font style="vertical-align: inherit;">ディレクティブ</font><font style="vertical-align: inherit;">は何度でも使用できるため、必要に応じて、1行ずつでもnull有効性の設定を制御できます。）おそらく、ほとんどのプロジェクトですでにnull有効性をアクティブにしていて、後でこのファイルに戻った場合、表示が少なくなります。初めてよりも警告。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような単純な方法で問題を解決できない場合があります。</font><font style="vertical-align: inherit;">したがって、シリアル化に関連する特定のシナリオ（たとえば、Json.NETまたはEntity Frameworkを使用する場合）では、作業がより困難になる場合があります。</font><font style="vertical-align: inherit;">この問題は別の記事に値すると思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想定とのリンク</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">により、コードの表現力が向上し、ユーザーがエラーにぶつかる前にコンパイラーがエラーをキャッチする可能性が高まります。</font><font style="vertical-align: inherit;">したがって、可能であればこの機能を含めることをお勧めします。</font><font style="vertical-align: inherit;">そして、それを選択的に含めると、その利点がより速く感じられるようになります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja501502/index.html">新しいラボのデジタル合成がHarris Bookを継続し、FPGAビデオゲームの作成を支援</a></li>
<li><a href="../ja501506/index.html">GDIリークと運の重要性について</a></li>
<li><a href="../ja501508/index.html">いまいましい古いCRM</a></li>
<li><a href="../ja501510/index.html">Ruby on Railsフレームワークを使用したFullstack開発の新しい外観</a></li>
<li><a href="../ja501516/index.html">掃除機を消しましょう！アレクセイ・レソフスキー</a></li>
<li><a href="../ja501522/index.html">無料のスキルボックスウェビナー：PHP、Unity、Unreal Engineでゲームを書く</a></li>
<li><a href="../ja501524/index.html">地球と生物の電磁界を同期させる秘訣</a></li>
<li><a href="../ja501526/index.html">なぜカナダ英語は「汚い」と見なされ、キアヌ・リーブスはそれと何をしなければならないのですか？</a></li>
<li><a href="../ja501528/index.html">「Bash and cybersecurity：attack、Defense and analysis from the Linux command line」という本</a></li>
<li><a href="../ja501534/index.html">今COVID-19で発疹もあります</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>