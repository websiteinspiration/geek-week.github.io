<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тП▒я╕П ЁЯМ╣ ЁЯФТ NSI рдкреНрд░рдгрд╛рд▓реА рд╢рд░реАрд░ рд░рдЪрдирд╛ рд╡рд┐рдЬреНрдЮрд╛рди ЁЯСиЁЯП╜тАНЁЯТ╗ ЁЯСйЁЯП╝тАНЁЯТ╝ тЬМя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рд▓реЗрдЦ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдШрдЯрдирд╛рдУрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, 
 рдФрд░ рдЗрд╕рдореЗрдВ рд╕рднреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдХрд╛рд▓реНрдкрдирд┐рдХ рдирд╣реАрдВ рд╣реИрдВред (рд╕реА)
 
 рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдореИрдВ рдпрд╣ рдиреЛрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ рд▓реЗрдЦ рд╕рд╛рдЗрдХрд┐рд▓ рдХреЗ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NSI рдкреНрд░рдгрд╛рд▓реА рд╢рд░реАрд░ рд░рдЪрдирд╛ рд╡рд┐рдЬреНрдЮрд╛рди</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492414/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд▓реЗрдЦ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдШрдЯрдирд╛рдУрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 рдФрд░ рдЗрд╕рдореЗрдВ рд╕рднреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдХрд╛рд▓реНрдкрдирд┐рдХ рдирд╣реАрдВ рд╣реИрдВред (рд╕реА)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдореИрдВ рдпрд╣ рдиреЛрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ рд▓реЗрдЦ рд╕рд╛рдЗрдХрд┐рд▓ рдХреЗ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рд╡рд┐рдХрд╛рд╕ рдХреА рд╕рдВрд╕реНрдХреГрддрд┐ рдореЗрдВ рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдЕрд╕реНрддрд┐рддреНрд╡ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╡реЗ рд╣рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджрд┐рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдЙрдирдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдкрд░реНрдпрд╛рдкреНрдд рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВ рдХрд┐ рд╕рдВрджрд░реНрдн рдЬрд╛рдирдХрд╛рд░реА (NSI) рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдмрд▓реНрдХрд┐ рдЗрд╕рдХреА рд╕реЗрд╡рд╛ рдореЗрдВ рд╣реИред рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдкреНрд▓реЗрдЯ рдЦреАрдВрдЪрдиреЗ рдХреА рдорд╛рдирдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрд╣реБрдд рдЬрд▓реНрдж рдмреИрд╕рд╛рдЦреА рдпрд╛ рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓реА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд╕рд╛рде рдмрдврд╝рдиреЗ рд▓рдЧрддреА рд╣реИред</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреЛ, рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рд╣реА рддрд╕реНрд╡реАрд░ рдирд┐рдХрд▓реА - рдкреНрд░рдгрд╛рд▓реА рджрд╕ рд╕рд╛рд▓ рд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рддрдХ рдЙрддреНрдкрд╛рджрдХ рдкрд░ рд░рд╣реА рд╣реИ, рдЙрд╕реА рд╕рд┐рджреНрдзрд╛рдВрдд рдкрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рд╣рдо рдЗрд╕реЗ рдЦреАрдВрдЪрддреЗ рд╣реИрдВ рдФрд░ рдЪрд╛рд▓реВ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдХрдИ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд▓реЗрдХрд┐рди рдлрд┐рд░ рдШрдВрдЯреЗ рдПрдХреНрд╕ рдЖрдпрд╛, рдЬрдм рдирдП рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЬреЛрдбрд╝реЗ рдХреЛ рдЕрдзрд┐рдХ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рдЧрдпрд╛ рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рднреА (рдкреБрд░рд╛рдиреЗ рд▓реЛрдЧреЛрдВ рд╕рд╣рд┐рдд) рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рд╕рдореВрд╣ рдФрд░ рд╕рднреА рдкрд╛рдБрдЪ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рд╡рд┐рднрд┐рдиреНрди рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдХреНрд░реЙрд╕реНрдЯреИрдм рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрд░реНрдерд╛рддреН, рдкреНрд░рддреНрдпреЗрдХ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рддрд╛рд▓рд┐рдХрд╛ рдкрд░ рдПрдХ рд╕реНрдерд┐рд░ рдХреЗ рд╕рд╛рдеред рдФрд░ рдЕрдЧрд░ рдПрдХ рдФрд░ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдмрджрд▓реЗрдВред рдФрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЦреЗрддреЛрдВ рдХреЛ рднрд░рд╛ рдЬрд╛рддрд╛ рд╣реИред рддреЛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реА рд╕рдорд╕реНрдпрд╛ рдпрд╣</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣реИ </font><font style="vertical-align: inherit;">,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рднрд┐рдиреНрди рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдХреИрд╕реЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдирдХреЗ рд╕рд╛рде рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдХрд╛рдо рдХрд░ рд╕рдХреЗрдВ рдФрд░ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдмрджрд▓ рди рд╕рдХреЗрдВ рдпрджрд┐ рдПрдХ рдФрд░ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдПрдХ рдЕрджреНрднреБрдд рд╡рд┐рдЪрд╛рд░, рд╣рдо рдПрдХ рдЕрд▓рдЧ рд▓реЗрдмрд▓ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рдХрд┐ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрдХреЗрдд рдХреЗ рд╕рд╛рде рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдЕрдореВрд░реНрдд рдЕрд╡рдзрд╛рд░рдгрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рд╢реЗрд╖ рдЧреЛрд▓рд┐рдпрд╛рдВ рдЙрдирдХреЗ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреЛ рд╡рд┐рджреЗрд╢реА рдХреБрдВрдЬреА рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреА рд╣реИрдВред рдЗрд╕ рдЦреБрд╢реА рдХреА рд▓рд╣рд░ рдкрд░, рд╣рдо рдПрдХ рд╕реЗ рдмрдирд╛рдИ рдЧрдИ рдкреНрд▓реЗрдЯ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рднрд░рддреЗ рд╣реИрдВ рдФрд░ рджреВрд╕рд░реЗ рдХреЗ рд▓рд┐рдП рднреА рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдХреБрдЫ рдЧрд▓рдд рд╣реЛ рдЧрдпрд╛, рдкреНрд░рд╛рдердорд┐рдХ рдХреБрдВрдЬреА рдкреНрд░рддрд┐рдмрдВрдз рдиреЗ рдХрд╛рдо рдХрд┐рдпрд╛, рдпрд╣ рдХреНрдпреЛрдВ рд╣реЛрдЧрд╛? рдФрд░ рдЗрд╕ рддрдереНрдп рдХреЗ рд▓рд┐рдП рдХрд┐ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдЕрд╢рд╛рдВрдд рдпреБрд╡рд╛рдУрдВ рдХреА рднреЛрд░ рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд▓реЗрдЯ рдХреЗ рдЕрдкрдиреЗ рдЕрдиреБрдХреНрд░рдо рдереЗред рдмреЗрд╢рдХ, рд╕рдордп рдХреЗ рд╕рд╛рде рдпрд╣ рдЕрдкрдорд╛рди рд╕рд╣реА рд╣реЛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдкреБрд░рд╛рдиреА рдЪрд╛рдмрд┐рдпрд╛рдБ рдЕрднреА рднреА рдмрдиреА рд╣реБрдИ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдиреНрд╣реЛрдВрдиреЗ рдЕрдиреНрдп рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╡рд┐рджреЗрд╢реА рдХреБрдВрдЬрд┐рдпреЛрдВ рдкрд░ рдЬрдбрд╝реЗрдВ рдмрд┐рдЫрд╛рдИрдВред рд╣рдо </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдХреЛ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдареАрдХ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдПрдВрдб-рдЯреВ-рдПрдВрдб рдирдВрдмрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрдкрдХрд░рдг рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд╛ рд╡рд╣рд╛рдБ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реБрдИред рдХреНрдпреЛрдВрдХрд┐ рдирд╡реАрдирддрдо рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЙрдкрдХрд░рдг рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдирдХреА рд╕рдВрдЦреНрдпрд╛ рдкрд░рд┐рд╡рд░реНрддрдирд╢реАрд▓ рд╣реИ, рдФрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ рдХрдИ рдорд╛рди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рддреЛ рдПрдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреАрд╕рд░реА рд╕рдорд╕реНрдпрд╛</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рдХрдЯ рд╣реЛрддреА рд╣реИ </font><font style="vertical-align: inherit;">, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд░реНрдерд╛рддреН, рдПрдХ рд░рд┐рдХреЙрд░реНрдб рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдПрдХ рдЪрд░ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдЗрд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЧреНрд░рд╛рд╣рдХ рдЕрд▓рд░реНрдЯ рдкрд░ рд╣реИ, рд╡рд╣ рд╣рдореЗрд╢рд╛ рдХреБрдЫ рдирдпрд╛ рддреИрдпрд╛рд░ рдХрд░рддрд╛ рд╣реИред рдФрд░ рдлрд┐рд░ рдорд╛рдВрдЧ рдЖрддреА рд╣реИ - рд╕рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрддреНрдкрд╛рдж рдХрд╛ рдирд╛рдо рдПрдХ рдерд╛, рдФрд░ рдлрд┐рд░ рдЗрд╕рдХрд╛ рдирд╛рдо рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рд╡рд┐рднрд┐рдиреНрди рддрд┐рдерд┐рдпреЛрдВ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЖрдкрдХреЛ рд╡рд░реНрддрдорд╛рди рдирд╛рдо рджрд┐рдЦрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реНрд╡рдпрдВ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдЖрдк рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗред рдФрд░ рдЕрдЧрд░ рд╡рд┐рдХрд╛рд╕ рд╡рд┐рднрд╛рдЧ рдореЗрдВ рдХреЛрдИ рдФрд░ рд╣реИ рдЬреЛ рдкрд░реАрдХреНрд╖рдг рдЕрд╡рдзрд┐ рд╕реЗ рдЧреБрдЬрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рд╕рдм рдХреБрдЫ рдЪреЙрдХрд▓реЗрдЯ рдореЗрдВ рдХрд╡рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдпрд╣ рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рдм рдХреБрдЫ рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ - рдПрдХ рдкреВрд░реНрдг рдЯреВрдЯрдиреЗ рдХреЗ рд╕рд╛рде, рдФрд░ рдлрд┐рд░ рдЖрдкрдХреЛ рдЕрднреА рднреА рдРрд╕рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рд╡рд╣рд╛рдВ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдХрд╛рд▓рдХреНрд░рдо рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рджреЛрд╣рд░рд╛рддреЗ рд╣реБрдП рдкреНрд▓реЗрдЯреЗрдВ рдмрдирд╛рддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдЗрди рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рдмрдирд╛рдиреЗ рд╕реЗ, рд╣рдо рдЕрдкрдиреЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдП</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ </font><b><font style="vertical-align: inherit;">рдЪреМрдереА рд╕рдорд╕реНрдпрд╛</font></b><font style="vertical-align: inherit;"> рднреА рдкреИрджрд╛ </font><b><font style="vertical-align: inherit;">рдХрд░рддреЗ</font></b><font style="vertical-align: inherit;"> рд╣реИрдВ </font><font style="vertical-align: inherit;">,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдХреЛрдб рдореЗрдВ, рддрд┐рдерд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдХрд┐рд╕реА рдХреЛ рдореБрдЦреНрдп рддрд╛рд▓рд┐рдХрд╛ рдпрд╛ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рдПрдХ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦреИрд░, рд╣рдо рдЕрдЪреНрдЫреЗ рдлреЙрд▓реЛрд╡рд░реНрд╕ рд╣реИрдВ, рд╣рдордиреЗ рдЗрд╕реЗ рднреА рдЬреАрддрд╛))) рдЕрдм, рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдордЧ рд╕реЗ рдЪрд╛рдп рдкреАрддреЗ рд╣реБрдП, рдЖрдк рдЕрдиреНрдп рд╕рд╣рдпреЛрдЧрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЪрд░реНрдЪрд╛ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдХреНрдпрд╛ рд╣рд▓ рдХрд░рдирд╛ рдерд╛, рдФрд░ рдЖрдк рд╕рдордЭрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдврд╝ рд░рд╣реА рд╣реИред рдЪрд░реНрдЪрд╛ рдПрдХ рд╣реА рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рд╢реНрди рдЙрдард╛рддреА рд╣реИред рдореИрдВ рдПрдХ рдЖрд░рдХреНрд╖рдг рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рд╕рдВрд╕реНрдХрд░рдг рдХреБрдЫ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдРрддрд┐рд╣рд╛рд╕рд┐рдХрддрд╛ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдлрд┐рдЯ рдмреИрдарддрд╛ рд╣реИред рдРрддрд┐рд╣рд╛рд╕рд┐рдХрддрд╛ рдореЗрдВ, рдпрд╣ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреА рддрд╛рд░реАрдЦ рдореЗрдВ рдПрдХ рдирд╛рдо рдирд╣реАрдВ рдерд╛, рдФрд░ рдЗрд╕ рддрд╛рд░реАрдЦ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░, рджреВрд╕рд░рд╛ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдФрд░ рд╕рдВрд╕реНрдХрд░рдгрдХрд░рдг рдореЗрдВ, рдпрд╣ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдкрд╣рд▓реА рдмрд╛рд░ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдХреБрдЫ рдШрдВрдЯреЛрдВ рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рд╕рдордЭрд╛ рдФрд░ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдЖрдкрдХреЛ рдЗрд╕ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд╕рднреА рд░рд╛рдЬреНрдпреЛрдВ рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдХреЗрд╡рд▓ рдПрдХ рджрд┐рди рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдереЛрдбрд╝реА рджреЗрд░ рдХреЗ рд▓рд┐рдП рдХреБрдЪрд▓ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред рдФрд░ рджреВрд╕рд░реА рдмрд╛рдд, рддрд╕рд▓реАрдо рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдРрд╕реЗ рдирд┐рд╢рд╛рди рдХреА рдЬрд░реВрд░рдд рд╣реЛрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЛрдВрдиреЗ рдореВрд▓реНрдп рд╕реВрдЪреА рдореЗрдВ рднрд░рд╛, рдПрдХ рдЧрд▓рддреА рдХреА, рдЗрд╕ рддрд░рд╣ рдХреЗ рдореВрд▓реНрдп рдкрд░ рд╕рд╛рдорд╛рди рдмреЗрдЪрдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ, рдФрд░ рдлрд┐рд░ рд╕рд╣реА рдХрд┐рдпрд╛ рдЧрдпрд╛,рд▓реЗрдХрд┐рди рджрд┐рди рдХреЗ рдЕрдВрдд рдореЗрдВ рдПрдХ рдЕрд╕рдВрддреБрд▓рди рдерд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдРрд╕реА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдгрдп рдиреЗ рдореБрдЭреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдкрд░реЗрд╢рд╛рди рдХрд┐рдпрд╛, рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рднреА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдореИрдВ рд╣реЛрд▓реАрд╡рд░ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рд╕рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди рдореЗрд░реЗ рд▓рд┐рдП рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рд╣реИ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдЪрд╡реАрдВ рд╕рдорд╕реНрдпрд╛</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд░реНрдерд╛рддреН рд░рд┐рдХреЙрд░реНрдб рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рднрдВрдбрд╛рд░рдг</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП, рдЙрдкрд░реЛрдХреНрдд рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рд╣рдо рдЕрдкрдиреЗ рд╕рд╛рдордиреЗ рдкрд╛рдВрдЪ рд╡рдЬрдирджрд╛рд░ рд░реЗрдХ рджреЗрдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рдПрдХ рдРрд╕реА рд░рдгрдиреАрддрд┐ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдирд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рдЗрдзрд░-рдЙрдзрд░ рдЬрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рди рдХрд┐ рдЙрди рдкрд░ рдХрджрдо рд░рдЦреЗред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдПрдХ рд╣реА рд░реЗрдХ рдкрд░ рдХрд┐рддрдирд╛ рдХрджрдо рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЪрд▓реЛ рдлреЗрдВрдХрддреЗ рд╣реИрдВ рдФрд░ рдирдП рдЦрд░реАрджрддреЗ рд╣реИрдВ</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдкреНрд░рдгрд╛рд▓реА рдХреЛ рдЦрд░реЛрдВрдЪ рд╕реЗ рдбрд┐рдЬрд╛рдЗрди рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдирд╛, рдХреЛрдИ рднреА рдЗрд╕рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рдорд╛рд░реНрдЧ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП рдпрд╣ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддрд╛ рдХрд┐ рдХрд┐рд╕ рд╕реНрддрд░ рдкрд░ рдЗрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛, рдЬреИрд╕рд╛ рдХрд┐ рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде рд╡рд░реНрдгрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдпрд╣ рддреБрд░рдВрдд рдПрдХ рд╕рд╛рд░ рдЗрдХрд╛рдИ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ рдЬреЛ рд╕рднреА NSI рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдПрдХ рд╣реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдХреЗ рдкреНрд░рдХрд╛рд░ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_type (<font></font>
    nsi_type_id     <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span>            <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">descr</span>           <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>),<font></font>
    table_name      <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_type_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_type_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi (<font></font>
    nsi_id      <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_type_id <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">descr</span>       <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>),<font></font>
    create_date <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    modif_date  <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    begin_date  <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_nsi_type_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_type_id) <span class="hljs-keyword">REFERENCES</span> nsi_type (nsi_type_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_uk <span class="hljs-keyword">UNIQUE</span>(nsi_type_id, nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SEQUENCE</span> nsi_seq
  <span class="hljs-keyword">MINVALUE</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">INCREMENT</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">CACHE</span> <span class="hljs-number">20</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕реЗ рд╣реА рдирдИ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИрдВ nsi_type рд╕рд┐рд╕реНрдЯрдо рддрд╛рд▓рд┐рдХрд╛ рдкреЙрдкреБрд▓реЗрдЯреЗрдб рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">Nsi рддрд╛рд▓рд┐рдХрд╛ рдХреБрдВрдЬрд┐рдпрд╛рдБ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдлрд╝реАрд▓реНрдб рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрд╕реА рд╕рдордп, рд╣рдо рдЕрдкрдирд╛ рд╕реНрд╡рдпрдВ рдХрд╛ рдЕрдиреБрдХреНрд░рдо рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рддрд░рд╣ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдХреЛ рдмрдВрдж рдХрд░рддреЗ рд╣реИрдВ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреБрдирд┐рдпрд╛рджреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдпреБрдХреНрдд рдПрдХ рдкреИрдХреЗрдЬ рднреА рдмрдирд╛рдПрдВрдЧреЗ рдФрд░ рдзреАрд░реЗ-рдзреАрд░реЗ рдЗрд╕реЗ рднрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">NONEDITIONABLE</span> <span class="hljs-keyword">PACKAGE</span> <span class="hljs-keyword">BODY</span> pkg_nsi
<span class="hljs-keyword">IS</span><font></font>
<font></font>
    <span class="hljs-comment">/*      
    *  @param p_table_name VARCHAR2 -  
    *  @return nsi.nsi_type_id%TYPE -    nsi_type
    */</span>
    <span class="hljs-keyword">FUNCTION</span> get_type_id(p_table_name <span class="hljs-keyword">IN</span> <span class="hljs-built_in">VARCHAR2</span>) 
    <span class="hljs-keyword">RETURN</span> nsi_type.nsi_type_id%<span class="hljs-keyword">TYPE</span>
    <span class="hljs-keyword">AS</span>
       v_type_id 	nsi_type.nsi_type_id%<span class="hljs-keyword">TYPE</span>; 
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> nsi_type_id <span class="hljs-keyword">INTO</span> v_type_id 
        <span class="hljs-keyword">FROM</span> nsi_type
        <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">LOWER</span>(table_name)) = <span class="hljs-keyword">TRIM</span>(<span class="hljs-keyword">LOWER</span>(p_table_name));<font></font>
<font></font>
        RETURN v_type_id;<font></font>
    <span class="hljs-keyword">END</span> get_type_id;<font></font>
<font></font>
    <span class="hljs-comment">/*   id  nsi_seq
    *  @return nsi.nsi_id%TYPE - id  nsi_seq
    */</span><font></font>
    FUNCTION get_nsi_id <font></font>
    RETURN nsi.nsi_id%TYPE<font></font>
    AS<font></font>
       v_id 	nsi.nsi_id%TYPE; <font></font>
    <span class="hljs-keyword">BEGIN</span>    
        <span class="hljs-keyword">SELECT</span> nsi_seq.NEXTVAL <span class="hljs-keyword">INTO</span> v_id <span class="hljs-keyword">FROM</span> DUAL;<font></font>
        RETURN v_id;<font></font>
    <span class="hljs-keyword">END</span> get_nsi_id;<font></font>
<font></font>
    <span class="hljs-comment">/*      
    *  @param p_nsi_type_id nsi_type.nsi_type_id%TYPE -    nsi_type 
    *  @return nsi_type.table_name%TYPE -  
    */</span><font></font>
    FUNCTION get_table_name(p_nsi_type_id IN nsi_type.nsi_type_id%TYPE) <font></font>
    RETURN nsi_type.table_name%TYPE<font></font>
    AS<font></font>
       v_table_name nsi_type.table_name%TYPE; <font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> table_name <span class="hljs-keyword">INTO</span> v_table_name 
        <span class="hljs-keyword">FROM</span> nsi_type
        <span class="hljs-keyword">WHERE</span> nsi_type_id = p_nsi_type_id;<font></font>
<font></font>
        RETURN v_table_name;<font></font>
    <span class="hljs-keyword">END</span> get_table_name;<font></font>
<font></font>
    <span class="hljs-comment">/*        nsi
    *  @param p_nsi_id nsi.nsi_id%TYPE -   
    *  @param p_nsi_type_id nsi_type.nsi_type_id%TYPE -   
    *  @return nsi.descr%TYPE - 
    */</span><font></font>
    FUNCTION get_nsi_descr (<font></font>
        p_nsi_id        IN nsi.nsi_id%TYPE,<font></font>
        p_nsi_type_id   IN nsi.nsi_type_id%TYPE) <font></font>
    RETURN nsi.descr%TYPE<font></font>
    AS<font></font>
       v_nsi_descr  nsi.descr%TYPE; <font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">descr</span> 
          <span class="hljs-keyword">INTO</span> v_nsi_descr 
          <span class="hljs-keyword">FROM</span> nsi
         <span class="hljs-keyword">WHERE</span> nsi_id = p_nsi_id
           <span class="hljs-keyword">AND</span> nsi_type_id = p_nsi_type_id;<font></font>
<font></font>
        RETURN v_nsi_descr;<font></font>
    <span class="hljs-keyword">END</span> get_nsi_descr;<font></font>
...<font></font>
<span class="hljs-keyword">END</span> pkg_nsi;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рддрдХ, рдЖрд╡рд╢реНрдпрдХ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реИрдВред </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рд▓рд┐рдП рдХрд╛рд░реНрдп рд╕рдВрдЧрдардиреЛрдВ рдХреА рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдмрдирд╛рдирд╛ рд╣реИ, рдЬрд╣рд╛рдВ, рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рдХреЛрдИ рднреА рдХрдВрдкрдиреА рддреГрддреАрдп-рдкрдХреНрд╖ рд╕рдВрдЧрдардиреЛрдВ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рддреА рд╣реИ - рдпреЗ рдЖрдкреВрд░реНрддрд┐рдХрд░реНрддрд╛, рдЧреНрд░рд╛рд╣рдХ рдФрд░ рднрд╛рдЧреАрджрд╛рд░ рд╣реИрдВред </font><font style="vertical-align: inherit;">рддреБрд░рдВрдд рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рдХрд╛рд░ рдХреЛ nsi_type рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ рдФрд░ nsi_organization рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_organization (<font></font>
    nsi_id      <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span>        <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    full_name   <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    inn         <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">12</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_organization_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_organization_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_type (nsi_type_id, <span class="hljs-keyword">name</span>, <span class="hljs-keyword">descr</span>, table_name) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">11</span>, <span class="hljs-string">''</span>, <span class="hljs-string">' , , , '</span>, <span class="hljs-string">'nsi_organization'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдмрд╣реБрдд рджреЗрд░ рд╣реЛ рдЬрд╛рдП, рдЖрдкрдХреЛ "рдкрд╛рдВрдЪ" рдирдВрдмрд░ рдХреЗ рд╕рд╛рде рд░реЗрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдпрд╛рдж рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдо рд╕рдВрдЧрдардиреЛрдВ рдХреА рдмрдирд╛рдИ рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдЬреЛрдбрд╝рдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдШрдЯрдирд╛ рдХрд╣реАрдВ рди рдХрд╣реАрдВ рддрдп рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_log (<font></font>
    nsi_log_id        <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_id            <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    table_name        <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>),<font></font>
    oper_num          <span class="hljs-built_in">NUMBER</span>,
    <span class="hljs-keyword">descr</span>             <span class="hljs-keyword">CLOB</span>,<font></font>
    create_date       <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_log_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_log_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_log_oper_num_ch <span class="hljs-keyword">CHECK</span> (oper_num <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>))<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_log <span class="hljs-keyword">IS</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.nsi_log_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.table_name <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.oper_num <span class="hljs-keyword">IS</span> <span class="hljs-string">'  (1 -  , 2 -  , 3 -  , 4 -  , 5 -  , 6 -  , 7 -   ).'</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.descr <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_log.create_date <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдкреИрдХреЗрдЬ рдореЗрдВ рдПрдХ рд▓реЙрдЧрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рднреА рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">--  CHECK nsi_log_oper_num_ch</span><font></font>
    NSI_LOG_OPERNUM_INSERT          NUMBER := 1;<font></font>
    NSI_LOG_OPERNUM_UPDATE          NUMBER := 2;<font></font>
    NSI_LOG_OPERNUM_DELETE          NUMBER := 3;<font></font>
    NSI_LOG_OPERNUM_ATTR_INSERT     NUMBER := 4;<font></font>
    NSI_LOG_OPERNUM_ATTR_UPDATE     NUMBER := 5;<font></font>
    NSI_LOG_OPERNUM_ATTR_DELETE     NUMBER := 6;<font></font>
    NSI_LOG_OPERNUM_HISTORY_PUSH    NUMBER := 7;<font></font>
<font></font>
    <span class="hljs-comment">/*    .
    *  @param p_nsi_id nsi.nsi_id%TYPE - 
    *  @param p_nsi_type_id nsi_type.nsi_type_id%TYPE -  
    *  @param p_oper_num NUMBER -  
    *  @param p_descr VARCHAR2 - 
    */</span><font></font>
    PROCEDURE log_oper (<font></font>
        p_nsi_id        IN nsi.nsi_id%TYPE,<font></font>
        p_nsi_type_id   IN nsi_type.nsi_type_id%TYPE,<font></font>
        p_oper_num      IN NUMBER,<font></font>
        p_descr         IN VARCHAR2)<font></font>
    AS<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_log <font></font>
        (nsi_log_id, nsi_id, table_name, oper_num, <span class="hljs-keyword">descr</span>, create_date)
        <span class="hljs-keyword">VALUES</span> 
        (get_nsi_id(), p_nsi_id, get_table_name(p_nsi_type_id), p_oper_num, p_descr, <span class="hljs-keyword">Sysdate</span>);
    <span class="hljs-keyword">END</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдВрдЪрд╡реАрдВ рд╕рдорд╕реНрдпрд╛ рд╣рд▓ рд╣реЛ рдЧрдИ рд╣реИ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЕрдм рдХрд┐рд╕реА рднреА NSI рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рд╣реБрдЖред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╡рд╣рд╛рдВ рдПрдХ рд╕рдВрдЧрдарди рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_organization (nsi_id, <span class="hljs-keyword">name</span>, full_name, inn)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">' "  "'</span>, <span class="hljs-string">'  "  "'</span>, <span class="hljs-string">'11223344'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ рд╣рдо nsi_organization_nsi_fk рд╕реНрдерд┐рд░рд╛рдВрдХ рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╕рднреА рд▓реБрдХрдЕрдк рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рдЯреНрд░рд┐рдЧрд░реНрд╕ рдХреЗ рдЖрд╡рд╢реНрдпрдХ рд╢реЛрдзрди рд╕реЗ рд╕реБрд╕рдЬреНрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_organization_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_organization <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_organization'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_descr := 'name = ''' || :NEW.name || ''', full_name = ''' || :NEW.full_name || ''', inn = ''' || :NEW.inn || ''' ';<font></font>
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);<font></font>
<span class="hljs-keyword">END</span>;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_organization_trg_update 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">ON</span> nsi_organization <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_organization'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">UPDATE</span> nsi
       <span class="hljs-keyword">SET</span> modif_date = Trunc(<span class="hljs-keyword">Sysdate</span>)
     <span class="hljs-keyword">WHERE</span> nsi_id = :NEW.nsi_id
       <span class="hljs-keyword">AND</span> nsi_type_id = v_type_id;<font></font>
    <font></font>
    v_log_descr := 'name = ''' || :NEW.name || ''', full_name = ''' || :NEW.full_name || ''', inn = ''' || :NEW.inn || ''' ';<font></font>
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);<font></font>
<span class="hljs-keyword">END</span>;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_organization_trg_delete 
<span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> nsi_organization <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_organization'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> nsi
    <span class="hljs-keyword">WHERE</span> nsi_id = :OLD.nsi_id
      <span class="hljs-keyword">AND</span> nsi_type_id = v_type_id;<font></font>
    <font></font>
    v_log_descr := 'name = ''' || :OLD.name || ''', full_name = ''' || :OLD.full_name || ''', inn = ''' || :OLD.inn || ''' ';<font></font>
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);<font></font>
<span class="hljs-keyword">END</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдм рд░рд┐рдХреЙрд░реНрдб рдЬреЛрдбрд╝рдирд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд┐рдирд╛ рдХрд╛рдо рдХрд░реЗрдЧрд╛ (рдХреБрдВрдЬреА рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ)ред </font><font style="vertical-align: inherit;">рдЙрд╕реА рд╕рдордп, рдкрд╣рд▓рд╛ рд░рд┐рдХреЙрд░реНрдб nsi рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛, рдФрд░ рдпрд╣ рдШрдЯрдирд╛ рд▓реЙрдЧрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рднреА рджрд░реНрдЬ рдХреА рдЬрд╛рдПрдЧреАред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_organization (<span class="hljs-keyword">name</span>, full_name, inn)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">' "  "'</span>, <span class="hljs-string">'  "  "'</span>, <span class="hljs-string">'11223344'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдЕрднреА рдХреЗ рд▓рд┐рдП, рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдиреЗ рдХреА рдХреЗрд╡рд▓ рдЕрддрд┐рд░рд┐рдХреНрдд рд▓рд╛рдЧрддреЛрдВ рдХреЛ рдиреЛрдЯрд┐рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдПрдХрд▓ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рд▓рд╛рдн рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рдЪреМрдереА рд╕рдорд╕реНрдпрд╛ рдХреЛ рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ - рд╣рдореЗрдВ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рдбреЗрдЯрд╛ рдХреА рдРрддрд┐рд╣рд╛рд╕рд┐рдХрддрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рддрд┐рдерд┐ рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_history (<font></font>
    nsi_history_id  <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_id          <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_type_id     <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">version</span>         <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">content</span>         <span class="hljs-keyword">CLOB</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    note            <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>),<font></font>
    begin_date      <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    end_date        <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,     
    <span class="hljs-keyword">CONSTRAINT</span> nsi_history_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_history_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_history_nsi_type_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_type_id) <span class="hljs-keyword">REFERENCES</span> nsi_type (nsi_type_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_history_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_history_content_json_chk <span class="hljs-keyword">CHECK</span> (<span class="hljs-keyword">content</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">JSON</span>)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_history <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.nsi_history_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.nsi_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.version <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.content <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.note <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.begin_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_history.end_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pkg_nsi рдкреИрдХреЗрдЬ рдореЗрдВ, рд╣рдо рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕рд╣реЗрдЬрдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рд░рд┐рдХреЙрд░реНрдб рдХреЛ json рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рдкреИрдХреЗрдЬ рдореЗрдВ рдкреНрд░реЗрд╖рд┐рдд рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП json рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рд╣реЛрдЧрд╛ред</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">/*     json
    *  @param p_query VARCHAR2 - 
    *  @return CLOB -  json
    */</span><font></font>
    FUNCTION get_json(p_query IN VARCHAR2) <font></font>
    RETURN CLOB<font></font>
    AS<font></font>
      v_theCursor       integer default dbms_sql.open_cursor;<font></font>
      v_columnValue     varchar2(4000);<font></font>
      v_status          integer;<font></font>
      v_descTbl         dbms_sql.desc_tab;<font></font>
      v_colCnt          number;<font></font>
      v_res             clob;<font></font>
    <span class="hljs-keyword">BEGIN</span><font></font>
        dbms_sql.parse(v_theCursor, p_query, dbms_sql.native);<font></font>
        dbms_sql.describe_columns( v_theCursor, v_colCnt, v_descTbl);<font></font>
<font></font>
        FOR i IN 1 .. v_colCnt LOOP<font></font>
            dbms_sql.define_column(v_theCursor, i, v_columnValue, 4000);<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;<font></font>
      <font></font>
        v_status := dbms_sql.execute(v_theCursor);<font></font>
        WHILE ( dbms_sql.fetch_rows(v_theCursor) &gt; 0 ) LOOP<font></font>
            FOR i IN 1 .. v_colCnt LOOP<font></font>
                dbms_sql.column_value( v_theCursor, i, v_columnValue );<font></font>
                IF i &gt; 1 THEN<font></font>
                    v_res := v_res || ', ';<font></font>
                <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
                v_res := v_res || '"' || v_descTbl(i).col_name || '" : "' || <span class="hljs-keyword">replace</span>(v_columnValue, <span class="hljs-string">'"'</span>, <span class="hljs-string">'\"'</span>) || <span class="hljs-string">'"'</span>;
            <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;<font></font>
            <font></font>
            <span class="hljs-comment">--   ,     ,   </span>
            <span class="hljs-comment">--     </span><font></font>
            EXIT;<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;<font></font>
        <font></font>
        RETURN '{' || v_res || '}';<font></font>
      <font></font>
    exception<font></font>
        when others then dbms_sql.close_cursor( v_theCursor ); RAISE;<font></font>
    <span class="hljs-keyword">END</span> get_json;<font></font>
<font></font>
    <span class="hljs-comment">/*       .
    *  @param p_nsi_id nsi.nsi_id%TYPE - 
    *  @param p_nsi_type_id nsi_type.nsi_type_id%TYPE -  
    *  @param p_end_date nsi_history.end_date%TYPE -     
    *  @param p_note nsi_history.note%TYPE -     
    */</span><font></font>
    PROCEDURE nsi_history_push (<font></font>
        p_nsi_id        IN nsi.nsi_id%TYPE,<font></font>
        p_nsi_type_id   IN nsi_type.nsi_type_id%TYPE,<font></font>
        p_end_date      IN nsi_history.end_date%TYPE,<font></font>
        p_note          IN nsi_history.note%TYPE)<font></font>
    AS<font></font>
        v_table_name VARCHAR2(50);<font></font>
        v_content CLOB;<font></font>
        v_max_ver NUMBER;<font></font>
        v_begin_date DATE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">IF</span> (p_end_date <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">THEN</span><font></font>
            RAISE_APPLICATION_ERROR (NSI_ERROR_CODE, <font></font>
                <span class="hljs-string">'[nsi_history_push]     .'</span>); 
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
<font></font>
        IF (Trunc(p_end_date) &gt; Trunc(Sysdate) ) THEN<font></font>
            RAISE_APPLICATION_ERROR (NSI_ERROR_CODE, <font></font>
                '[nsi_history_push]       .'); <font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">SELECT</span> begin_date <span class="hljs-keyword">INTO</span> v_begin_date
          <span class="hljs-keyword">FROM</span> nsi
         <span class="hljs-keyword">WHERE</span> nsi_id = p_nsi_id
           <span class="hljs-keyword">AND</span> nsi_type_id = p_nsi_type_id;<font></font>
<font></font>
        IF (Trunc(p_end_date) &lt; Trunc(v_begin_date) ) THEN<font></font>
            RAISE_APPLICATION_ERROR (NSI_ERROR_CODE, <font></font>
                '[nsi_history_push]            .'); <font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
        <font></font>
        v_table_name := get_table_name(p_nsi_type_id);<font></font>
        v_content := get_json ('<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">' || v_table_name || '</span> <span class="hljs-keyword">where</span> nsi_id=<span class="hljs-string">' || p_nsi_id);
        
        SELECT MAX(version) INTO v_max_ver
          FROM nsi_history
         WHERE nsi_id = p_nsi_id
           AND nsi_type_id = p_nsi_type_id;
          
        IF (v_max_ver IS NULL) THEN
            v_max_ver := 0;
        END IF;

        v_max_ver := v_max_ver + 1;
        
        UPDATE nsi
           SET begin_date = Trunc(p_end_date) + 1
         WHERE nsi_id = p_nsi_id
           AND nsi_type_id = p_nsi_type_id;
           
        INSERT INTO nsi_history
        (nsi_history_id, nsi_id, nsi_type_id, version, content, note, begin_date, end_date)
        VALUES (get_nsi_id, p_nsi_id, p_nsi_type_id, v_max_ver, v_content, p_note, v_begin_date, Trunc(p_end_date));
        
        log_oper(p_nsi_id, p_nsi_type_id, NSI_LOG_OPERNUM_HISTORY_PUSH, v_content);
    END nsi_history_push; 
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдХреЛрдИ рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдЪреНрдЫрд╛ рд╣реИ, рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рдЙрдкрдпреЛрдЧреА рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рд╛рдорд╛рдиреНрдпреАрдХрд░рдг рд╕реЗ рдЖрдпрд╛ рд╣реИ))) рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЬ рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдлрд╝рдВрдХреНрд╢рди рдЬреЛрдбрд╝реЗрдВред </font><font style="vertical-align: inherit;">рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдлрд╝реАрд▓реНрдб рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдкреНрд░рдХрд╛рд░ рдореЗрдВ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">--     nsi_organization     nsi</span><font></font>
    TYPE nsi_organization_rec IS RECORD(<font></font>
        nsi_id          nsi_organization.nsi_id%TYPE, <font></font>
        name            nsi_organization.name%TYPE,<font></font>
        full_name       nsi_organization.full_name%TYPE,<font></font>
        inn             nsi_organization.inn%TYPE,<font></font>
        nsi_type_id     nsi.nsi_type_id%TYPE, <font></font>
        create_date     nsi.create_date%TYPE,<font></font>
        modif_date      nsi.create_date%TYPE,<font></font>
        version         nsi_history.version%TYPE,<font></font>
        begin_date      nsi.begin_date%TYPE,<font></font>
        end_date        nsi_history.end_date%TYPE<font></font>
    );<font></font>
    TYPE nsi_organization_list IS TABLE OF nsi_organization_rec;<font></font>
<font></font>
    <span class="hljs-comment">/*  ,    .
    *     ,    .
    *  @param p_date DATE - ,      
    *  @return nsi_organization_table -    nsi_organization_rec
    */</span><font></font>
    FUNCTION nsi_organization_table(p_date IN DATE := null) <font></font>
    RETURN nsi_organization_list PIPELINED<font></font>
    AS<font></font>
        v_date date;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_date := Trunc(<span class="hljs-keyword">Sysdate</span>);<font></font>
        IF p_date IS NOT NULL THEN<font></font>
            v_date := Trunc(p_date);<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
<font></font>
        FOR rec IN (<font></font>
            <span class="hljs-keyword">SELECT</span> <font></font>
                o.nsi_id, o.name, o.full_name, o.inn,<font></font>
                n.nsi_type_id, n.create_date, n.modif_date, <font></font>
                <span class="hljs-number">0</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">version</span>, n.begin_date, <span class="hljs-keyword">to_date</span>(<span class="hljs-literal">null</span>) <span class="hljs-keyword">AS</span> end_date
            <span class="hljs-keyword">FROM</span> 
                nsi_organization o <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi n
                <span class="hljs-keyword">ON</span> (o.nsi_id = n.nsi_id)
            <span class="hljs-keyword">WHERE</span> <font></font>
                n.begin_date &lt;= v_date<font></font>
            <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
            <span class="hljs-keyword">SELECT</span> <font></font>
                n.nsi_id, <font></font>
                json_value(h.content, <span class="hljs-string">'$.NAME'</span>) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <font></font>
                json_value(h.content, <span class="hljs-string">'$.FULL_NAME'</span>) <span class="hljs-keyword">AS</span> full_name,<font></font>
                json_value(h.content, <span class="hljs-string">'$.INN'</span>) <span class="hljs-keyword">AS</span> inn, <font></font>
                n.nsi_type_id, n.create_date, n.modif_date, <font></font>
                h.version, h.begin_date, h.end_date<font></font>
            <span class="hljs-keyword">FROM</span> 
                nsi_history h <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi n
                <span class="hljs-keyword">ON</span> (h.nsi_id = n.nsi_id <span class="hljs-keyword">AND</span> h.nsi_type_id = n.nsi_type_id)
            <span class="hljs-keyword">WHERE</span> <font></font>
                    h.begin_date &lt;= v_date<font></font>
                <span class="hljs-keyword">AND</span> h.end_date &gt;= v_date<font></font>
        ) <span class="hljs-keyword">LOOP</span>
            <span class="hljs-keyword">PIPE</span> <span class="hljs-keyword">ROW</span> (rec);
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
    <span class="hljs-keyword">END</span> nsi_organization_table;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ nsi_organization рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рд╣реИред </font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> nsi <span class="hljs-keyword">where</span> nsi_id=<span class="hljs-number">1</span>;
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
"NSI_ID"	"NSI_TYPE_ID"	"DESCR"	"CREATE_DATE"	"MODIF_DATE"	"BEGIN_DATE"<font></font>
1	1	" ""  """	11.03.20	11.03.20	11.03.20<font></font>
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-keyword">begin</span>
<span class="hljs-comment">--       ,      </span>
    pkg_nsi.nsi_history_push(<span class="hljs-number">202</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">sysdate</span>, <span class="hljs-string">' '</span>);
<span class="hljs-keyword">end</span>;
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> nsi_history;
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
"NSI_HISTORY_ID"	"NSI_ID"	"NSI_TYPE_ID"	"VERSION"	"CONTENT"	"NOTE"	"BEGIN_DATE"	"END_DATE"<font></font>
205	1	1	1	"{""NSI_ID"" : ""1"", ""NAME"" : "" \""  \"""", ""FULL_NAME"" : ""  \""  \"""", ""INN"" : ""11223344""}"	" "	11.03.20	11.03.20<font></font>
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-comment">--      </span>
<span class="hljs-comment">--       ,         </span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> nsi <span class="hljs-keyword">where</span> nsi_id=<span class="hljs-number">1</span>;
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
"NSI_ID"	"NSI_TYPE_ID"	"DESCR"	"CREATE_DATE"	"MODIF_DATE"	"BEGIN_DATE"<font></font>
1	1	" ""  """	11.03.20	11.03.20	12.03.20<font></font>
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-comment">--        </span>
<span class="hljs-comment">--     inn, version, begin_date, end_date</span>
<span class="hljs-comment">--       0</span>
<span class="hljs-keyword">update</span> nsi_organization <span class="hljs-keyword">set</span> inn=<span class="hljs-string">'99887766'</span> <span class="hljs-keyword">where</span> nsi_id=<span class="hljs-number">1</span>;<font></font>
<font></font>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span>(pkg_nsi.nsi_organization_table(<span class="hljs-keyword">sysdate</span>));
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
"NSI_ID"	"NAME"	"FULL_NAME"	"INN"	"NSI_TYPE_ID"	"CREATE_DATE"	"MODIF_DATE"	"VERSION"	"BEGIN_DATE"	"END_DATE"<font></font>
1	" ""  """	"  ""  """	"11223344"	1	11.03.20	11.03.20	1	11.03.20	11.03.20<font></font>
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">table</span>(pkg_nsi.nsi_organization_table(<span class="hljs-keyword">sysdate</span>+<span class="hljs-number">1</span>));
<span class="hljs-comment">---------------------------------------------------------------------------------------</span><font></font>
"NSI_ID"	"NAME"	"FULL_NAME"	"INN"	"NSI_TYPE_ID"	"CREATE_DATE"	"MODIF_DATE"	"VERSION"	"BEGIN_DATE"	"END_DATE"<font></font>
1	" ""  """	"  ""  """	"99887766"	1	11.03.20	11.03.20	0	12.03.20	<font></font>
<span class="hljs-comment">---------------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nsi_organization_table рдлрд╝рдВрдХреНрд╢рди рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдорд╛рд░реА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдВрдд </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдЪрд╛рд░ рддрдХ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЧреЗ рдмрдврд╝реЛред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреАрдХреГрдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рд╢реБрд░реВрдЖрдд рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рд▓рд╛рдн рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдХрд┐рд╕реА рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдХрд┐рд╕реА рднреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рддрдВрддреНрд░ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдореЗрдВ рд╣реИ, рдЬрд┐рд╕реЗ рдИрдПрд╡реА-рдкреИрдЯрд░реНрди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╣рдо рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">--  CHECK nsi_attribute_type_ch</span><font></font>
    NSI_ATTRIBUTE_TYPE_STRING   NUMBER := 1;<font></font>
    NSI_ATTRIBUTE_TYPE_INT      NUMBER := 2;<font></font>
    NSI_ATTRIBUTE_TYPE_DOUBLE   NUMBER := 3;<font></font>
    NSI_ATTRIBUTE_TYPE_DATE     NUMBER := 4;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_attribute_type (<font></font>
    nsi_attribute_type_id   <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    value_type              <span class="hljs-built_in">NUMBER</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">descr</span>                   <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_type_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_attribute_type_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_type_ch <span class="hljs-keyword">CHECK</span> (value_type <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_type_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_attribute_type_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_attribute_type <span class="hljs-keyword">IS</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute_type.nsi_attribute_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute_type.value_type <span class="hljs-keyword">IS</span> <span class="hljs-string">'  (1 - , 2 - , 3 - , 4 - )'</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute_type.descr <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_attribute (<font></font>
    nsi_attribute_id        <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_attribute_type_id   <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_id                  <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_type_id             <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    value_1                 <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">100</span>),<font></font>
    value_2_3               <span class="hljs-built_in">NUMBER</span>,<font></font>
    value_4                 <span class="hljs-built_in">DATE</span>,<font></font>
    begin_date              <span class="hljs-built_in">DATE</span>,<font></font>
    end_date                <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_attribute_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_type_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_attribute_type_id) <span class="hljs-keyword">REFERENCES</span> nsi_attribute_type (nsi_attribute_type_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_attribute_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id, nsi_type_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id, nsi_type_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_attribute <span class="hljs-keyword">IS</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.nsi_attribute_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.nsi_attribute_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.nsi_type_id <span class="hljs-keyword">is</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.value_1 <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.value_2_3 <span class="hljs-keyword">IS</span> <span class="hljs-string">'    '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.value_4 <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.begin_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'   '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_attribute.end_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'   '</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╣реБрдд рдмрд╛рд░, рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЙрдЪрд┐рдд рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдирдИ рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдПрдВрдЧреЗ рдФрд░, рд╕рдВрдЧрдардиреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдирддрд╛ рд╕реЗ, рдЯреНрд░рд┐рдЧрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдЪрдпрди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рдХрд╛рд░ рдЬреЛрдбрд╝реЗрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_person (<font></font>
    nsi_id   <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    surname         <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span>            <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    patronymic      <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    birthday        <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_person_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_person_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_person <span class="hljs-keyword">IS</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_person.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_person.surname <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_person.name <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_person.patronymic <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_person.birthday <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_person_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_person <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
    v_log_query VARCHAR(4000);<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_person'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_query := '<span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.surname || '''</span> <span class="hljs-keyword">AS</span> surname, <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :NEW.patronymic || '''</span> <span class="hljs-keyword">AS</span> patronymic, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">''' || :NEW.birthday || '''</span>, <span class="hljs-string">''</span>dd.mm.yy<span class="hljs-string">''</span>) <span class="hljs-keyword">AS</span> birthday <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_person_trg_update 
BEFORE UPDATE ON nsi_person FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_person<span class="hljs-string">');

    UPDATE nsi
       SET modif_date = Trunc(Sysdate)
     WHERE nsi_id = :NEW.nsi_id
       AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.surname || '''</span> <span class="hljs-keyword">AS</span> surname, <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :NEW.patronymic || '''</span> <span class="hljs-keyword">AS</span> patronymic, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">''' || :NEW.birthday || '''</span>, <span class="hljs-string">''</span>dd.mm.yy<span class="hljs-string">''</span>) <span class="hljs-keyword">AS</span> birthday <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_person_trg_delete 
AFTER DELETE ON nsi_person FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_person<span class="hljs-string">');

    DELETE FROM nsi_history 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi_attribute 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.surname || '''</span> <span class="hljs-keyword">AS</span> surname, <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :OLD.patronymic || '''</span> <span class="hljs-keyword">AS</span> patronymic, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">''' || :OLD.birthday || '''</span>, <span class="hljs-string">''</span>dd.mm.yy<span class="hljs-string">''</span>) <span class="hljs-keyword">AS</span> birthday <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);
END;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде pkg_nsi рдкреИрдХреЗрдЬ рдХреЗ рдкреВрд░рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛ рд╣реБрдЖ рд╣реИред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-comment">--     nsi_person     nsi</span><font></font>
    TYPE nsi_person_rec IS RECORD(<font></font>
        nsi_id          nsi_person.nsi_id%TYPE, <font></font>
        surname         nsi_person.surname%TYPE,<font></font>
        name            nsi_person.name%TYPE,<font></font>
        patronymic      nsi_person.patronymic%TYPE,<font></font>
        birthday        nsi_person.birthday%TYPE,<font></font>
        nsi_type_id     nsi.nsi_type_id%TYPE, <font></font>
        create_date     nsi.create_date%TYPE,<font></font>
        modif_date      nsi.create_date%TYPE,<font></font>
        version         nsi_history.version%TYPE,<font></font>
        begin_date      nsi.begin_date%TYPE,<font></font>
        end_date        nsi_history.end_date%TYPE<font></font>
    );<font></font>
    TYPE nsi_person_list IS TABLE OF nsi_person_rec;<font></font>
<font></font>
    <span class="hljs-comment">/*  ,    .
    *     ,    .
    *  @param p_date DATE - ,      
    *  @return nsi_person_table -    nsi_person_rec
    */</span><font></font>
    FUNCTION nsi_person_table(p_date IN DATE := null) <font></font>
    RETURN nsi_person_list PIPELINED<font></font>
    AS<font></font>
        v_date date;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_date := Trunc(<span class="hljs-keyword">Sysdate</span>);<font></font>
        IF p_date IS NOT NULL THEN<font></font>
            v_date := Trunc(p_date);<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
<font></font>
        FOR rec IN (<font></font>
            <span class="hljs-keyword">SELECT</span> <font></font>
                p.nsi_id, p.surname, p.name, p.patronymic, p.birthday, <font></font>
                n.nsi_type_id, n.create_date, n.modif_date, <font></font>
                <span class="hljs-number">0</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">version</span>, n.begin_date, <span class="hljs-keyword">to_date</span>(<span class="hljs-literal">null</span>) <span class="hljs-keyword">AS</span> end_date
            <span class="hljs-keyword">FROM</span> 
                nsi_person p <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi n
                <span class="hljs-keyword">ON</span> (p.nsi_id = n.nsi_id)
            <span class="hljs-keyword">WHERE</span> <font></font>
                n.begin_date &lt;= v_date<font></font>
            <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
            <span class="hljs-keyword">SELECT</span> <font></font>
                n.nsi_id, <font></font>
                json_value(h.content, <span class="hljs-string">'$.SURNAME'</span>) <span class="hljs-keyword">AS</span> surname, <font></font>
                json_value(h.content, <span class="hljs-string">'$.NAME'</span>) <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>,<font></font>
                json_value(h.content, <span class="hljs-string">'$.PATRONYMIC'</span>) <span class="hljs-keyword">AS</span> patronymic,
                <span class="hljs-keyword">to_date</span>(json_value(h.content, <span class="hljs-string">'$.BIRTHDAY'</span>)) <span class="hljs-keyword">AS</span> birthday,<font></font>
                n.nsi_type_id, n.create_date, n.modif_date, <font></font>
                h.version, h.begin_date, h.end_date<font></font>
            <span class="hljs-keyword">FROM</span> 
                nsi_history h <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi n
                <span class="hljs-keyword">ON</span> (h.nsi_id = n.nsi_id <span class="hljs-keyword">AND</span> h.nsi_type_id = n.nsi_type_id)
            <span class="hljs-keyword">WHERE</span> <font></font>
                    h.begin_date &lt;= v_date<font></font>
                <span class="hljs-keyword">AND</span> h.end_date &gt;= v_date<font></font>
        ) <span class="hljs-keyword">LOOP</span>
            <span class="hljs-keyword">PIPE</span> <span class="hljs-keyword">ROW</span> (rec);
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
    <span class="hljs-keyword">END</span> nsi_person_table;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдХрд┐рд╕реА рдХреЛ рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_person<font></font>
(surname, <span class="hljs-keyword">name</span>, patronymic, birthday)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">'22.12.70'</span>, <span class="hljs-string">'dd.mm.yy'</span>));
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдВрдЧ рд╡рд╛рд▓реЗ рдЖрдиреБрд╡рдВрд╢рд┐рдХ рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдмрдирд╛рдПрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute_type (nsi_attribute_type_id, value_type, <span class="hljs-keyword">descr</span>) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'  . '</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute_type (nsi_attribute_type_id, value_type, <span class="hljs-keyword">descr</span>) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'  . '</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute_type (nsi_attribute_type_id, value_type, <span class="hljs-keyword">descr</span>) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'  . '</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pkg_nsi рдкреИрдХреЗрдЬ рдореЗрдВ рд╣рдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">/*   id      .
    *  @param p_nsi_attribute_type_id nsi_attribute_type.nsi_attribute_type_id%TYPE -  
    *  @param p_value_type nsi_attribute_type.value_type%TYPE -  
    *  @param p_descr nsi_attribute_type.descr%TYPE -  
    */</span><font></font>
    PROCEDURE get_attribute_type (<font></font>
        p_nsi_attribute_type_id IN nsi_attribute_type.nsi_attribute_type_id%TYPE,<font></font>
        p_value_type            OUT nsi_attribute_type.value_type%TYPE,<font></font>
        p_descr                 OUT nsi_attribute_type.descr%TYPE)<font></font>
    AS<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> value_type, <span class="hljs-keyword">descr</span>
          <span class="hljs-keyword">INTO</span> p_value_type, p_descr
          <span class="hljs-keyword">FROM</span> nsi_attribute_type
         <span class="hljs-keyword">WHERE</span> nsi_attribute_type_id = p_nsi_attribute_type_id;
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*   .
    *  @param p_nsi_attribute_type_id nsi_attribute.nsi_attribute_type_id%TYPE -  
    *  @param p_nsi_id nsi_attribute.nsi_id%TYPE - 
    *  @param p_nsi_type_id nsi_attribute.nsi_type_id%TYPE -  
    *  @param p_value_1 nsi_attribute.value_1%TYPE -   
    *  @param p_value_2_3 nsi_attribute.value_2_3%TYPE -   
    *  @param p_value_4 nsi_attribute.value_4%TYPE -   
    *  @param p_begin_date nsi_attribute.begin_date%TYPE -    
    *  @param p_end_date nsi_attribute.end_date%TYPE -    
    */</span><font></font>
    PROCEDURE nsi_attribute_insert (<font></font>
        p_nsi_attribute_type_id IN nsi_attribute.nsi_attribute_type_id%TYPE,<font></font>
        p_nsi_id                IN nsi_attribute.nsi_id%TYPE,<font></font>
        p_nsi_type_id           IN nsi_attribute.nsi_type_id%TYPE,<font></font>
        p_value_1               IN nsi_attribute.value_1%TYPE,<font></font>
        p_value_2_3             IN nsi_attribute.value_2_3%TYPE,<font></font>
        p_value_4               IN nsi_attribute.value_4%TYPE,<font></font>
        p_begin_date            IN nsi_attribute.begin_date%TYPE,<font></font>
        p_end_date              IN nsi_attribute.end_date%TYPE)<font></font>
    AS<font></font>
        v_id            NUMBER;<font></font>
        v_log_descr     nsi_log.descr%TYPE;<font></font>
        v_value_type    nsi_attribute_type.value_type%TYPE;<font></font>
        v_descr         nsi_attribute_type.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span><font></font>
        v_id := get_nsi_id;<font></font>
        get_attribute_type(p_nsi_attribute_type_id, v_value_type, v_descr);<font></font>
<font></font>
        IF (v_value_type = NSI_ATTRIBUTE_TYPE_STRING) THEN<font></font>
            <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute <font></font>
                (nsi_attribute_id, nsi_attribute_type_id, nsi_id, nsi_type_id, <font></font>
                 value_1, value_2_3, value_4, begin_date, end_date)<font></font>
            <span class="hljs-keyword">VALUES</span> (v_id, p_nsi_attribute_type_id, p_nsi_id, p_nsi_type_id,<font></font>
                    p_value_1, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, p_begin_date, p_end_date);<font></font>
                    <font></font>
            v_log_descr := p_value_1;<font></font>
                    <font></font>
        ELSIF (v_value_type IN (NSI_ATTRIBUTE_TYPE_INT, NSI_ATTRIBUTE_TYPE_DOUBLE)) THEN<font></font>
            <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute <font></font>
                (nsi_attribute_id, nsi_attribute_type_id, nsi_id, nsi_type_id, <font></font>
                 value_1, value_2_3, value_4, begin_date, end_date)<font></font>
            <span class="hljs-keyword">VALUES</span> (v_id, p_nsi_attribute_type_id, p_nsi_id, p_nsi_type_id,
                    <span class="hljs-literal">null</span>, p_value_2_3, <span class="hljs-literal">null</span>, p_begin_date, p_end_date);<font></font>
                    <font></font>
            v_log_descr := p_value_2_3;<font></font>
                    <font></font>
        ELSE<font></font>
            <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_attribute <font></font>
                (nsi_attribute_id, nsi_attribute_type_id, nsi_id, nsi_type_id, <font></font>
                 value_1, value_2_3, value_4, begin_date, end_date)<font></font>
            <span class="hljs-keyword">VALUES</span> (v_id, p_nsi_attribute_type_id, p_nsi_id, p_nsi_type_id,
                    <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, p_value_4, p_begin_date, p_end_date);<font></font>
                    <font></font>
            v_log_descr := p_value_4;<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
        <font></font>
        v_log_descr := '[' || get_nsi_descr(p_nsi_id, p_nsi_type_id) || '] ' ||<font></font>
                       ' : ' || v_descr || <font></font>
                       ' : ' || v_log_descr || <font></font>
                       ' : ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper(p_nsi_id, p_nsi_type_id, NSI_LOG_OPERNUM_ATTR_INSERT, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
    <span class="hljs-comment">/*      .
    *  @param p_nsi_attribute_id nsi_attribute.nsi_attribute_id%TYPE -  
    *  @param p_value_1 nsi_attribute.value_1%TYPE -   
    *  @param p_value_2_3 nsi_attribute.value_2_3%TYPE -   
    *  @param p_value_4 nsi_attribute.value_4%TYPE -   
    */</span><font></font>
    PROCEDURE nsi_attribute_value (<font></font>
        p_nsi_attribute_id      IN nsi_attribute.nsi_attribute_id%TYPE,<font></font>
        p_value_1               IN nsi_attribute.value_1%TYPE,<font></font>
        p_value_2_3             IN nsi_attribute.value_2_3%TYPE,<font></font>
        p_value_4               IN nsi_attribute.value_4%TYPE)<font></font>
    AS<font></font>
        v_nsi_id            nsi.nsi_id%TYPE;<font></font>
        v_nsi_type_id       nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr         nsi_log.descr%TYPE;<font></font>
        v_value_type        nsi_attribute_type.value_type%TYPE;<font></font>
        v_descr             nsi_attribute_type.descr%TYPE;<font></font>
        v_nsi_attribute_type_id  nsi_attribute.nsi_attribute_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> nsi_attribute_type_id, nsi_id, nsi_type_id
          <span class="hljs-keyword">INTO</span> v_nsi_attribute_type_id, v_nsi_id, v_nsi_type_id
          <span class="hljs-keyword">FROM</span> nsi_attribute
          <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
          <font></font>
        get_attribute_type(v_nsi_attribute_type_id, v_value_type, v_descr);<font></font>
        <font></font>
        IF (v_value_type = NSI_ATTRIBUTE_TYPE_STRING) THEN<font></font>
            <span class="hljs-keyword">UPDATE</span> nsi_attribute
               <span class="hljs-keyword">SET</span> value_1 = p_value_1,<font></font>
                   value_2_3 = <span class="hljs-literal">null</span>,<font></font>
                   value_4 = <span class="hljs-literal">null</span>
            <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
<font></font>
            v_log_descr := p_value_1;<font></font>
                    <font></font>
        ELSIF (v_value_type IN (NSI_ATTRIBUTE_TYPE_INT, NSI_ATTRIBUTE_TYPE_DOUBLE)) THEN<font></font>
            <span class="hljs-keyword">UPDATE</span> nsi_attribute
               <span class="hljs-keyword">SET</span> value_1 = <span class="hljs-literal">null</span>,<font></font>
                   value_2_3 = p_value_2_3,<font></font>
                   value_4 = <span class="hljs-literal">null</span>
            <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
<font></font>
            v_log_descr := p_value_2_3;<font></font>
                    <font></font>
        ELSE<font></font>
            <span class="hljs-keyword">UPDATE</span> nsi_attribute
               <span class="hljs-keyword">SET</span> value_1 = <span class="hljs-literal">null</span>,<font></font>
                   value_2_3 = <span class="hljs-literal">null</span>,<font></font>
                   value_4 = p_value_4<font></font>
            <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
<font></font>
            v_log_descr := p_value_4;<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_nsi_id, v_nsi_type_id) || '] ' ||<font></font>
                       ' : ' || v_descr || <font></font>
                       '  : ' || v_log_descr;<font></font>
        log_oper(v_nsi_id, v_nsi_type_id, NSI_LOG_OPERNUM_ATTR_UPDATE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
    <span class="hljs-comment">/*     .
    *  @param p_nsi_attribute_id nsi_attribute.nsi_attribute_id%TYPE -  
    *  @param p_begin_date nsi_attribute.begin_date%TYPE -    
    *  @param p_end_date nsi_attribute.end_date%TYPE -    
    */</span><font></font>
    PROCEDURE nsi_attribute_period (<font></font>
        p_nsi_attribute_id  IN nsi_attribute.nsi_attribute_id%TYPE,<font></font>
        p_begin_date        IN nsi_attribute.begin_date%TYPE,<font></font>
        p_end_date          IN nsi_attribute.end_date%TYPE)<font></font>
    AS<font></font>
        v_nsi_id        nsi.nsi_id%TYPE;<font></font>
        v_nsi_type_id   nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr     nsi_log.descr%TYPE;<font></font>
        v_value_type    nsi_attribute_type.value_type%TYPE;<font></font>
        v_descr         nsi_attribute_type.descr%TYPE;<font></font>
        v_nsi_attribute_type_id nsi_attribute.nsi_attribute_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> nsi_id, nsi_type_id, nsi_attribute_type_id
          <span class="hljs-keyword">INTO</span> v_nsi_id, v_nsi_type_id, v_nsi_attribute_type_id
          <span class="hljs-keyword">FROM</span> nsi_attribute
         <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
    <font></font>
        get_attribute_type(v_nsi_attribute_type_id, v_value_type, v_descr);<font></font>
        <font></font>
        <span class="hljs-keyword">UPDATE</span> nsi_attribute
           <span class="hljs-keyword">SET</span> begin_date = p_begin_date,<font></font>
               end_date = p_end_date<font></font>
         <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_nsi_id, v_nsi_type_id) || '] ' ||<font></font>
                       ' : ' || v_descr || <font></font>
                       '  : ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper(v_nsi_id, v_nsi_type_id, NSI_LOG_OPERNUM_ATTR_UPDATE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
    <span class="hljs-comment">/*   .
    *  @param p_nsi_attribute_id nsi_person.nsi_attribute_id%TYPE - id  nsi_attribute
    */</span><font></font>
    PROCEDURE nsi_attribute_delete (p_nsi_attribute_id nsi_attribute.nsi_attribute_id%TYPE)<font></font>
    AS<font></font>
        v_nsi_id        nsi.nsi_id%TYPE;<font></font>
        v_nsi_type_id   nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr     nsi_log.descr%TYPE;<font></font>
        v_value_type    nsi_attribute_type.value_type%TYPE;<font></font>
        v_descr         nsi_attribute_type.descr%TYPE;<font></font>
        v_nsi_attribute_type_id nsi_attribute.nsi_attribute_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">SELECT</span> nsi_id, nsi_type_id, nsi_attribute_type_id
          <span class="hljs-keyword">INTO</span> v_nsi_id, v_nsi_type_id, v_nsi_attribute_type_id
          <span class="hljs-keyword">FROM</span> nsi_attribute
         <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
    <font></font>
        get_attribute_type(v_nsi_attribute_type_id, v_value_type, v_descr);<font></font>
        <font></font>
        <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> nsi_attribute
        <span class="hljs-keyword">WHERE</span> nsi_attribute_id = p_nsi_attribute_id;<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_nsi_id, v_nsi_type_id) || '] ' ||<font></font>
                       ' : ' || v_descr;<font></font>
        log_oper(v_nsi_id, v_nsi_type_id, NSI_LOG_OPERNUM_ATTR_DELETE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЙрдкрдпреБрдХреНрдд рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">begin</span>
    pkg_nsi.nsi_attribute_insert(<span class="hljs-number">1</span>, <span class="hljs-number">225</span>, <span class="hljs-number">6</span>, <span class="hljs-string">''</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">sysdate</span>, <span class="hljs-literal">null</span>);<font></font>
    pkg_nsi.nsi_attribute_insert(2, 225, 6, '', null, null, sysdate, null);<font></font>
    pkg_nsi.nsi_attribute_insert(3, 225, 6, '', null, null, sysdate, null);<font></font>
<span class="hljs-keyword">end</span>;<font></font>
<font></font>
<span class="hljs-comment">--      ,      ,  </span>
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span><font></font>
"NSI_ATTRIBUTE_ID"	"NSI_ATTRIBUTE_TYPE_ID"	"NSI_ID"	"NSI_TYPE_ID"	"VALUE_1"	"VALUE_2_3"	"VALUE_4"	"BEGIN_DATE"	"END_DATE"<font></font>
230	1	225	6	""			11.03.20	<font></font>
232	2	225	6	""			11.03.20	<font></font>
234	3	225	6	""			11.03.20	<font></font>
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-keyword">begin</span>
    pkg_nsi.nsi_attribute_value(<span class="hljs-number">230</span>, <span class="hljs-string">''</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
<span class="hljs-keyword">end</span>;
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span><font></font>
"NSI_ATTRIBUTE_ID"	"NSI_ATTRIBUTE_TYPE_ID"	"NSI_ID"	"NSI_TYPE_ID"	"VALUE_1"	"VALUE_2_3"	"VALUE_4"	"BEGIN_DATE"	"END_DATE"<font></font>
230	1	225	6	""			11.03.20<font></font>
232	2	225	6	""			11.03.20	<font></font>
234	3	225	6	""			11.03.20	<font></font>
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-comment">--       </span>
<span class="hljs-keyword">begin</span>
    pkg_nsi.nsi_attribute_period(<span class="hljs-number">230</span>, <span class="hljs-keyword">sysdate</span><span class="hljs-number">-1</span>, <span class="hljs-literal">null</span>);<font></font>
    pkg_nsi.nsi_attribute_period(232, sysdate-1, null);<font></font>
    pkg_nsi.nsi_attribute_period(234, sysdate-1, null);<font></font>
<span class="hljs-keyword">end</span>;
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span><font></font>
"NSI_ATTRIBUTE_ID"	"NSI_ATTRIBUTE_TYPE_ID"	"NSI_ID"	"NSI_TYPE_ID"	"VALUE_1"	"VALUE_2_3"	"VALUE_4"	"BEGIN_DATE"	"END_DATE"<font></font>
230	1	225	6	""			10.03.20	<font></font>
232	2	225	6	""			10.03.20	<font></font>
234	3	225	6	""			10.03.20	<font></font>
<span class="hljs-comment">--------------------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреАрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд░рд╛ рджреЗрдВрдЧреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдирдПрд╕рдЖрдИ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рд╕рдВрджрд░реНрдн рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдирдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмрдбрд╝реЗ рд╕рдВрдЧрдардиреЛрдВ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЗрдХрд╛рдЗрдпрд╛рдБ, рд╢рд╛рдЦрд╛рдПрдБ, рд╡рд┐рднрд╛рдЧ рдЖрджрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рдкреЗрдбрд╝ рдХреА рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрдИ рдФрд░ рд╕рдВрдЧрдарди рдмрдирд╛рдПрдБрдЧреЗ рдЬреЛ рдореМрдЬреВрджрд╛ "рд╣реЙрд░реНрдиреНрд╕ рдПрдВрдб рд╣реЛрд╡реНрд╕" рдХреЗ рдЕрдзреАрдирд╕реНрде рд╣реЛрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_organization (<span class="hljs-keyword">name</span>, full_name, inn)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'   '</span>, <span class="hljs-string">'   '</span>, <span class="hljs-string">'1111111111'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_organization (<span class="hljs-keyword">name</span>, full_name, inn)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'   '</span>, <span class="hljs-string">'   '</span>, <span class="hljs-string">'2222222222'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_organization (<span class="hljs-keyword">name</span>, full_name, inn)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'   '</span>, <span class="hljs-string">'   '</span>, <span class="hljs-string">'3333333333'</span>);<font></font>
<font></font>
<span class="hljs-comment">----------------------------------------------------------------------------</span><font></font>
281	1	   	13.03.20	13.03.20	13.03.20<font></font>
283	1	   	13.03.20	13.03.20	13.03.20<font></font>
285	1	   	13.03.20	13.03.20	13.03.20<font></font>
1	1	 "  "	11.03.20	13.03.20	12.03.20<font></font>
<span class="hljs-comment">----------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдпрд╣ рджрд┐рдЦрд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдпреЗ рд╕рдВрдЧрдарди рдЖрдкрд╕ рдореЗрдВ рдХрд┐рд╕ рд╕рдВрдмрдВрдз рдореЗрдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ рдкреЗрдбрд╝ рдХреА рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЕрд╡рдзрд┐ рдХреЗ рд╕рдВрдХреЗрдд рдХреЗ рд╕рд╛рде рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рдм рдХреБрдЫ рд╕рдордп рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдЕрдзреАрди рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_structure (<font></font>
    nsi_structure_id    <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_parent_structure_id <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>),<font></font>
    nsi_id              <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_type_id         <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    ordnum              <span class="hljs-built_in">NUMBER</span>,<font></font>
    begin_date          <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    end_date            <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_structure_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_structure_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_parent_struct_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_parent_structure_id) <span class="hljs-keyword">REFERENCES</span> nsi_structure (nsi_structure_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_struct_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id, nsi_type_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id, nsi_type_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_structure <span class="hljs-keyword">IS</span> <span class="hljs-string">'.   '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.nsi_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.nsi_parent_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.nsi_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.ordnum <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.begin_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_structure.end_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рдЖрдкрдХреЛ pkg_nsi рдкреИрдХреЗрдЬ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдЖрдк рд╡рд┐рднрд┐рдиреНрди рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХреЗрдВред </font></font><br>
<br>
<pre><code class="sql hljs">    <span class="hljs-comment">/*   .
    *  @param p_nsi_parent_structure_id nsi_structure.nsi_parent_structure_id%TYPE -  
    *  @param p_nsi_id nsi_structure.nsi_id%TYPE - 
    *  @param p_nsi_type_id nsi_structure.nsi_type_id%TYPE -  
    *  @param p_ordnum nsi_structure.ordnum%TYPE -  
    *  @param p_begin_date nsi_structure.begin_date%TYPE -    
    *  @param p_end_date nsi_structure.end_date%TYPE -    
    */</span><font></font>
    FUNCTION nsi_structure_insert (<font></font>
        p_nsi_parent_structure_id   IN nsi_structure.nsi_parent_structure_id%TYPE,<font></font>
        p_nsi_id                    IN nsi_structure.nsi_id%TYPE,<font></font>
        p_nsi_type_id               IN nsi_structure.nsi_type_id%TYPE,<font></font>
        p_ordnum                    IN nsi_structure.ordnum%TYPE,<font></font>
        p_begin_date                IN nsi_structure.begin_date%TYPE, <font></font>
        p_end_date                  IN nsi_structure.end_date%TYPE)<font></font>
    RETURN nsi_structure.nsi_structure_id%TYPE<font></font>
    AS<font></font>
        v_id        NUMBER;<font></font>
        v_log_descr nsi_log.descr%TYPE;<font></font>
        v_type_id 	nsi.nsi_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span><font></font>
        v_id := get_nsi_id;<font></font>
        v_type_id := get_type_id('nsi_structure');<font></font>
<font></font>
        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_structure (<font></font>
            nsi_structure_id, nsi_parent_structure_id,<font></font>
            nsi_id, nsi_type_id, ordnum, begin_date, end_date)<font></font>
        <span class="hljs-keyword">VALUES</span> (<font></font>
            v_id, p_nsi_parent_structure_id, <font></font>
            p_nsi_id, p_nsi_type_id, p_ordnum, Trunc(p_begin_date), Trunc(p_end_date));<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(p_nsi_id, p_nsi_type_id) || '] ';<font></font>
        v_log_descr := v_log_descr || ' ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper (v_id, v_type_id, NSI_LOG_OPERNUM_INSERT, v_log_descr);<font></font>
        <font></font>
        RETURN v_id;<font></font>
    <span class="hljs-keyword">END</span> nsi_structure_insert;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*     .
    *  @param p_nsi_structure_id nsi_structure.nsi_structure_id%TYPE -  nsi_structure
    *  @param p_ordnum nsi_structure.ordnum%TYPE -  
    */</span><font></font>
    PROCEDURE nsi_structure_ordnum (<font></font>
        p_nsi_structure_id  IN nsi_structure.nsi_structure_id%TYPE,<font></font>
        p_ordnum            IN nsi_structure.ordnum%TYPE)<font></font>
    AS<font></font>
        v_nsi_id 		    nsi_structure.nsi_id%TYPE;<font></font>
        v_nsi_type_id 	    nsi_structure.nsi_type_id%TYPE;<font></font>
        v_type_id 	        nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr         nsi_log.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_type_id := get_type_id(<span class="hljs-string">'nsi_structure'</span>);<font></font>
        <font></font>
        <span class="hljs-keyword">SELECT</span> nsi_id, nsi_type_id
          <span class="hljs-keyword">INTO</span> v_nsi_id, v_nsi_type_id
          <span class="hljs-keyword">FROM</span> nsi_structure
         <span class="hljs-keyword">WHERE</span> nsi_structure_id = p_nsi_structure_id;<font></font>
<font></font>
        <span class="hljs-keyword">UPDATE</span> nsi_structure
           <span class="hljs-keyword">SET</span> ordnum = p_ordnum 
         <span class="hljs-keyword">WHERE</span> nsi_structure_id = p_nsi_structure_id;<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_nsi_id, v_nsi_type_id) || '] ';<font></font>
        v_log_descr := v_log_descr || ' ' || p_ordnum;<font></font>
        log_oper (p_nsi_structure_id, v_type_id, NSI_LOG_OPERNUM_UPDATE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*     .
    *  @param p_nsi_structure_id nsi_structure.nsi_structure_id%TYPE -  nsi_structure
    *  @param p_begin_date nsi_structure.begin_date%TYPE -   
    *  @param p_end_date nsi_structure.end_date%TYPE -   
    */</span><font></font>
    PROCEDURE nsi_structure_period (<font></font>
        p_nsi_structure_id  IN nsi_structure.nsi_structure_id%TYPE,<font></font>
        p_begin_date        IN nsi_structure.begin_date%TYPE, <font></font>
        p_end_date          IN nsi_structure.end_date%TYPE)<font></font>
    AS<font></font>
        v_nsi_id 		    nsi_structure.nsi_id%TYPE;<font></font>
        v_nsi_type_id 	    nsi_structure.nsi_type_id%TYPE;<font></font>
        v_type_id 	        nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr         nsi_log.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_type_id := get_type_id(<span class="hljs-string">'nsi_structure'</span>);<font></font>
        <font></font>
        <span class="hljs-keyword">SELECT</span> nsi_id, nsi_type_id
          <span class="hljs-keyword">INTO</span> v_nsi_id, v_nsi_type_id
          <span class="hljs-keyword">FROM</span> nsi_structure
         <span class="hljs-keyword">WHERE</span> nsi_structure_id = p_nsi_structure_id;<font></font>
<font></font>
        <span class="hljs-keyword">UPDATE</span> nsi_structure
           <span class="hljs-keyword">SET</span> begin_date = Trunc(p_begin_date),<font></font>
               end_date = Trunc(p_end_date) <font></font>
         <span class="hljs-keyword">WHERE</span> nsi_structure_id = p_nsi_structure_id;<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_nsi_id, v_nsi_type_id) || '] ';<font></font>
        v_log_descr := v_log_descr || ' ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper (p_nsi_structure_id, v_type_id, NSI_LOG_OPERNUM_UPDATE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*   .
    *  @param p_nsi_structure_id nsi_structure.nsi_structure_id%TYPE -  nsi_structure
    */</span><font></font>
    PROCEDURE nsi_structure_delete (p_nsi_structure_id IN nsi_structure.nsi_structure_id%TYPE)<font></font>
    AS<font></font>
        v_type_id 	nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr nsi_log.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_structure'</span>);<font></font>
        <font></font>
        FOR rec IN (<font></font>
            <span class="hljs-keyword">SELECT</span> nsi_structure_id, nsi_parent_structure_id,<font></font>
                    nsi_id, nsi_type_id, ordnum, begin_date, end_date<font></font>
            <span class="hljs-keyword">FROM</span> nsi_structure
            <span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> nsi_structure_id = p_nsi_structure_id
            <span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">PRIOR</span> nsi_structure_id = nsi_parent_structure_id<font></font>
        )<font></font>
        <span class="hljs-keyword">LOOP</span>
            v_log_descr := <span class="hljs-string">'['</span> || pkg_nsi.get_nsi_descr(rec.nsi_id, rec.nsi_type_id) || <span class="hljs-string">'] '</span>;<font></font>
            v_log_descr := v_log_descr || ' ' || rec.begin_date || ' - ' || rec.end_date;<font></font>
            pkg_nsi.log_oper (rec.nsi_structure_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> nsi_structure
        <span class="hljs-keyword">WHERE</span> nsi_structure_id = p_nsi_structure_id;
    <span class="hljs-keyword">END</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрд░рд╣ рдХреЗ рдЙрдкрдХрд░рдг рдХреЗ рдЖрдЧрдорди рдХреЗ рдмрд╛рдж, рдХреЛрдИ рднреА рд╕рдВрдЧрдардиреЛрдВ рдХреЗ рдмреАрдЪ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрдмрдВрдз рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">declare</span>
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">number</span>;<font></font>
    root_id number;<font></font>
<span class="hljs-keyword">begin</span>
    root_id := pkg_nsi.nsi_structure_insert(<span class="hljs-literal">null</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">'13.02.20'</span>, <span class="hljs-string">'dd.mm.yy'</span>), <span class="hljs-literal">null</span>);<font></font>
    id := pkg_nsi.nsi_structure_insert(root_id, 281, 1, null, to_date('13.02.20', 'dd.mm.yy'), to_date('15.02.20', 'dd.mm.yy'));<font></font>
    id := pkg_nsi.nsi_structure_insert(root_id, 283, 1, null, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    id := pkg_nsi.nsi_structure_insert(id, 285, 1, null, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
<span class="hljs-keyword">end</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> nsi_structure
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (nsi_parent_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id);
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
316		1	1		13.02.20	<font></font>
318	316	281	1		13.02.20	15.02.20<font></font>
320	316	283	1		13.02.20	<font></font>
322	320	285	1		13.02.20	<font></font>
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-comment">--      </span>
<span class="hljs-keyword">begin</span>
    pkg_nsi.nsi_structure_ordnum(<span class="hljs-number">320</span>, <span class="hljs-number">1</span>);<font></font>
    pkg_nsi.nsi_structure_ordnum(318, 2);<font></font>
<span class="hljs-keyword">end</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> nsi_structure
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (nsi_parent_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">SIBLINGS</span> <span class="hljs-keyword">BY</span> ordnum;
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
316		1	1		13.02.20	<font></font>
320	316	283	1	1	13.02.20	<font></font>
322	320	285	1		13.02.20	<font></font>
318	316	281	1	2	13.02.20	15.02.20<font></font>
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
<font></font>
<span class="hljs-comment">--    </span>
<span class="hljs-keyword">begin</span>
    pkg_nsi.nsi_structure_period(<span class="hljs-number">320</span>, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">'14.02.20'</span>, <span class="hljs-string">'dd.mm.yy'</span>), <span class="hljs-keyword">to_date</span>(<span class="hljs-string">'14.02.20'</span>, <span class="hljs-string">'dd.mm.yy'</span>));
<span class="hljs-keyword">end</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> nsi_structure
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (nsi_parent_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">SIBLINGS</span> <span class="hljs-keyword">BY</span> ordnum;
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
316		1	1		13.02.20	<font></font>
320	316	283	1	1	14.02.20	14.02.20<font></font>
322	320	285	1		13.02.20	<font></font>
318	316	281	1	2	13.02.20	15.02.20<font></font>
<span class="hljs-comment">-----------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрд░рдЪрдирд╛ рд╕реЗ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рд░ рдмрд╛рд░ рдЬрдм рд╡реЗ рдЕрдкрдиреЗ рд░рд┐рд╢реНрддреЛрдВ рдХреЛ рдмреЛрдЭрд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрдЧрдардиреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЕрдкрдиреЗ рдЬреАрд╡рди рдХреЛ рдереЛрдбрд╝рд╛ рд╕рд░рд▓ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">VIEW</span> V_NSI_ORGANIZATION <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> <font></font>
    s.nsi_structure_id, s.nsi_parent_structure_id,<font></font>
    s.ordnum, s.begin_date, s.end_date,<font></font>
    s.nsi_id, s.nsi_type_id, o.name, o.full_name, o.inn<font></font>
<span class="hljs-keyword">FROM</span> nsi_structure s <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi_organization o
    <span class="hljs-keyword">ON</span> (s.nsi_id = o.nsi_id)
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (nsi_parent_structure_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">SIBLINGS</span> <span class="hljs-keyword">BY</span> ordnum;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> v_nsi_organization;
<span class="hljs-comment">-----------------------------------------------------------------------------------</span><font></font>
316			13.02.20		1	1	 "  "	  "  "	99887766<font></font>
320	316	1	14.02.20	14.02.20	283	1	   	   	2222222222<font></font>
322	320		13.02.20		285	1	   	   	3333333333<font></font>
318	316	2	13.02.20	15.02.20	281	1	   	   	1111111111<font></font>
<span class="hljs-comment">-----------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдПрдХ рдкреЗрдбрд╝ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЕрджреНрднреБрдд рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рдкреЗрдбрд╝ рдХреЗ рд╕рднреА рдиреЛрдбреНрд╕ рдПрдХ рдЗрдХрд╛рдИ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ, рдФрд░ рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзреЛрдВ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХрд╛ рдПрд╣рд╕рд╛рд╕ рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рднреА рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрд░рдЪрдирд╛ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрджрд░реНрдн рдкреБрд╕реНрддрдХ рд╕реЗ рдмрдВрдзреА рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рд╕рдВрдкреВрд░реНрдг рдПрдирдПрд╕рдЖрдИ рдкреНрд░рдгрд╛рд▓реА рдкрд░ рдХрд╛рдо рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рд░рд╛рдЬреНрдп рд╕рд┐рд╡рд┐рд▓ рд╕реЗрд╡рд╛ рдХреЗ рдкрджреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЧ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдВрдЧреЗ рдФрд░ рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛ рдХреЗ рдкрджреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_classifier (<font></font>
    nsi_id      <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    code        <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">10</span>),
    <span class="hljs-keyword">name</span>        <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_classifier_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_classifier_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_classifier <span class="hljs-keyword">IS</span> <span class="hljs-string">'. '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_classifier.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_classifier.code <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_classifier.name <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_classifier_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_classifier <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
    v_log_query VARCHAR(4000);<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_classifier'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_query := '<span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :NEW.code || '''</span> <span class="hljs-keyword">AS</span> code <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_classifier_trg_update 
BEFORE UPDATE ON nsi_classifier FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_classifier<span class="hljs-string">');

    UPDATE nsi
       SET modif_date = Trunc(Sysdate)
     WHERE nsi_id = :NEW.nsi_id
       AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :NEW.code || '''</span> <span class="hljs-keyword">AS</span> code <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_classifier_trg_delete 
AFTER DELETE ON nsi_classifier FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_classifier<span class="hljs-string">');

    DELETE FROM nsi_history 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi_attribute 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :OLD.code || '''</span> <span class="hljs-keyword">AS</span> code <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);
END;
</span></code></pre><br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_post_group (<font></font>
    nsi_id   <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span>     <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_group_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_group_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_post_group <span class="hljs-keyword">is</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post_group.nsi_id <span class="hljs-keyword">is</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post_group.name <span class="hljs-keyword">is</span> <span class="hljs-string">''</span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_post_group_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_post_group <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
    v_log_query VARCHAR(4000);<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_post_group'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_query := '<span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_group_trg_update 
BEFORE UPDATE ON nsi_post_group FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post_group<span class="hljs-string">');

    UPDATE nsi
       SET modif_date = Trunc(Sysdate)
     WHERE nsi_id = :NEW.nsi_id
       AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_group_trg_delete 
AFTER DELETE ON nsi_post_group FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post_group<span class="hljs-string">');

    DELETE FROM nsi_history 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi_attribute 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);
END;
</span></code></pre><br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_post_category (<font></font>
    nsi_id   <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span>     <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_category_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_category_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_post_category <span class="hljs-keyword">is</span> <span class="hljs-string">'.  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post_category.nsi_id <span class="hljs-keyword">is</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post_category.name <span class="hljs-keyword">is</span> <span class="hljs-string">''</span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_post_category_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_post_category <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
    v_log_query VARCHAR(4000);<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_post_category'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_query := '<span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_category_trg_update 
BEFORE UPDATE ON nsi_post_category FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post_category<span class="hljs-string">');

    UPDATE nsi
       SET modif_date = Trunc(Sysdate)
     WHERE nsi_id = :NEW.nsi_id
       AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :NEW.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_category_trg_delete 
AFTER DELETE ON nsi_post_category FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post_category<span class="hljs-string">');

    DELETE FROM nsi_history 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi_attribute 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);
END;
</span></code></pre><br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_post (<font></font>
    nsi_id          <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    code_OKPDTR     <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">10</span>),
    <span class="hljs-keyword">name</span>            <span class="hljs-built_in">VARCHAR2</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_post_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_post <span class="hljs-keyword">IS</span> <span class="hljs-string">'. '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post.nsi_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post.code_OKPDTR <span class="hljs-keyword">IS</span> <span class="hljs-string">' '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_post.name <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> nsi_post_trg_insert 
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> nsi_post <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
    v_type_id 	nsi.nsi_type_id%<span class="hljs-keyword">TYPE</span>;<font></font>
    v_log_descr nsi_log.descr%TYPE;<font></font>
    v_log_query VARCHAR(4000);<font></font>
<span class="hljs-keyword">BEGIN</span>
    v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_post'</span>);<font></font>
    :NEW.nsi_id := pkg_nsi.get_nsi_id();<font></font>
<font></font>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi (nsi_id, nsi_type_id, <span class="hljs-keyword">descr</span>, create_date, modif_date, begin_date)
    <span class="hljs-keyword">VALUES</span> (:NEW.nsi_id, v_type_id, :NEW.name, Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>), Trunc(<span class="hljs-keyword">Sysdate</span>));<font></font>
    <font></font>
    v_log_query := '<span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :OLD.code_OKPDTR || '''</span> <span class="hljs-keyword">AS</span> code_OKPDTR <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_INSERT, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_trg_update 
BEFORE UPDATE ON nsi_post FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post<span class="hljs-string">');

    UPDATE nsi
       SET modif_date = Trunc(Sysdate)
     WHERE nsi_id = :NEW.nsi_id
       AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :OLD.code_OKPDTR || '''</span> <span class="hljs-keyword">AS</span> code_OKPDTR <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:NEW.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_UPDATE, v_log_descr);
END;

CREATE OR REPLACE TRIGGER nsi_post_trg_delete 
AFTER DELETE ON nsi_post FOR EACH ROW
DECLARE
    v_type_id 	nsi.nsi_type_id%TYPE;
    v_log_descr nsi_log.descr%TYPE;
    v_log_query VARCHAR(4000);
BEGIN
    v_type_id := pkg_nsi.get_type_id('</span>nsi_post<span class="hljs-string">');

    DELETE FROM nsi_history 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi_attribute 
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;

    DELETE FROM nsi
    WHERE nsi_id = :OLD.nsi_id
      AND nsi_type_id = v_type_id;
    
    v_log_query := '</span><span class="hljs-keyword">SELECT</span> <span class="hljs-string">''' || :OLD.name || '''</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">name</span>, <span class="hljs-string">''' || :OLD.code_OKPDTR || '''</span> <span class="hljs-keyword">AS</span> code_OKPDTR <span class="hljs-keyword">FROM</span> DUAL<span class="hljs-string">';
    v_log_descr := pkg_nsi.get_json(v_log_query);
    pkg_nsi.log_oper (:OLD.nsi_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);
END;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░ рднрд░рдиреЗ рдФрд░ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИред</font></font><br>
<pre><code class="sql hljs"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_classifier (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'  '</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_classifier (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'  '</span>);<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_group (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_group (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_group (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_group (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_group (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_category (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_category (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">' ()'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_category (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post_category (<span class="hljs-keyword">name</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">' '</span>);<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'24742'</span>, <span class="hljs-string">' '</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'26480'</span>, <span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'23509'</span>, <span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'20419'</span>, <span class="hljs-string">' '</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'26541'</span>, <span class="hljs-string">''</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_post (code_OKPDTR, <span class="hljs-keyword">name</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'26544'</span>, <span class="hljs-string">' 2 '</span>);<font></font>
<font></font>
<span class="hljs-keyword">commit</span>;<font></font>
<font></font>
<span class="hljs-keyword">declare</span>
    post_id <span class="hljs-built_in">number</span>;<font></font>
    classif_id number;<font></font>
    categ_id number;<font></font>
    group_id number;<font></font>
<span class="hljs-keyword">begin</span>
    <span class="hljs-comment">--   </span>
    classif_id := pkg_nsi.nsi_structure_insert(<span class="hljs-literal">null</span>, <span class="hljs-number">331</span>, <span class="hljs-number">5</span>, <span class="hljs-literal">null</span>, <span class="hljs-keyword">to_date</span>(<span class="hljs-string">'13.02.20'</span>, <span class="hljs-string">'dd.mm.yy'</span>), <span class="hljs-literal">null</span>);
    <span class="hljs-comment">-- </span><font></font>
    categ_id := pkg_nsi.nsi_structure_insert(classif_id, 347, 4, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 355, 3, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 357, 3, 2, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">--  </span><font></font>
    post_id := pkg_nsi.nsi_structure_insert(group_id, 335, 2, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 359, 3, 3, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">--  ()</span><font></font>
    categ_id := pkg_nsi.nsi_structure_insert(classif_id, 349, 4, 2, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 355, 3, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 357, 3, 2, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 359, 3, 3, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    post_id := pkg_nsi.nsi_structure_insert(group_id, 337, 2, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    categ_id := pkg_nsi.nsi_structure_insert(classif_id, 351, 4, 3, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 355, 3, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 357, 3, 2, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 359, 3, 3, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">--  </span><font></font>
    post_id := pkg_nsi.nsi_structure_insert(group_id, 341, 2, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 361, 3, 4, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">--  </span><font></font>
    categ_id := pkg_nsi.nsi_structure_insert(classif_id, 353, 4, 4, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 357, 3, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 359, 3, 2, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 361, 3, 3, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">-- </span><font></font>
    group_id := pkg_nsi.nsi_structure_insert(categ_id, 363, 3, 4, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
    <span class="hljs-comment">--  2 </span><font></font>
    post_id := pkg_nsi.nsi_structure_insert(group_id, 345, 2, 1, to_date('13.02.20', 'dd.mm.yy'), null);<font></font>
<font></font>
<span class="hljs-keyword">commit</span>;
<span class="hljs-keyword">end</span>;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> nsi_structure s
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (nsi_id = <span class="hljs-number">331</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">SIBLINGS</span> <span class="hljs-keyword">BY</span> ordnum;
<span class="hljs-comment">----------------------------------------------------------------------------------</span><font></font>
"NSI_STRUCTURE_ID"	"NSI_PARENT_STRUCTURE_ID"	"NSI_ID"	"NSI_TYPE_ID"	"ORDNUM"	"BEGIN_DATE"	"END_DATE"<font></font>
385		331	5		13.02.20	<font></font>
387	385	347	4	1	13.02.20	<font></font>
389	387	355	3	1	13.02.20	<font></font>
391	387	357	3	2	13.02.20	<font></font>
393	391	335	2	1	13.02.20	<font></font>
395	387	359	3	3	13.02.20	<font></font>
397	385	349	4	2	13.02.20	<font></font>
399	397	355	3	1	13.02.20	<font></font>
401	397	357	3	2	13.02.20	<font></font>
403	397	359	3	3	13.02.20	<font></font>
405	403	337	2	1	13.02.20	<font></font>
407	385	351	4	3	13.02.20	<font></font>
409	407	355	3	1	13.02.20	<font></font>
411	407	357	3	2	13.02.20	<font></font>
413	407	359	3	3	13.02.20	<font></font>
415	413	341	2	1	13.02.20	<font></font>
417	407	361	3	4	13.02.20	<font></font>
419	385	353	4	4	13.02.20	<font></font>
421	419	357	3	1	13.02.20	<font></font>
423	419	359	3	2	13.02.20	<font></font>
425	419	361	3	3	13.02.20	<font></font>
427	419	363	3	4	13.02.20	<font></font>
429	427	345	2	1	13.02.20	<font></font>
<span class="hljs-comment">----------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдУрд╣, рдпрд╣ рдХрд┐рддрдирд╛ рдкрдардиреАрдп рд╣реИ!</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">VIEW</span> V_NSI_CLASSIFIRE_GGS <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> <font></font>
    s.nsi_structure_id, s.nsi_parent_structure_id,<font></font>
    s.ordnum, s.begin_date, s.end_date,<font></font>
    n.nsi_id, n.nsi_type_id, n.descr<font></font>
<span class="hljs-keyword">FROM</span> nsi_structure s <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> nsi n
    <span class="hljs-keyword">ON</span> (s.nsi_id = n.nsi_id)
<span class="hljs-keyword">START</span> <span class="hljs-keyword">WITH</span> (s.nsi_id = <span class="hljs-number">331</span>)
<span class="hljs-keyword">CONNECT</span> <span class="hljs-keyword">BY</span> (nsi_parent_structure_id = <span class="hljs-keyword">PRIOR</span> nsi_structure_id)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">SIBLINGS</span> <span class="hljs-keyword">BY</span> ordnum;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> V_NSI_CLASSIFIRE_GGS ;
<span class="hljs-comment">----------------------------------------------------------------------------------</span><font></font>
"NSI_STRUCTURE_ID"	"NSI_PARENT_STRUCTURE_ID"	"NSI_ID"	"NSI_TYPE_ID"	"ORDNUM"	"BEGIN_DATE"	"END_DATE"<font></font>
385			13.02.20		331	5	  <font></font>
387	385	1	13.02.20		347	4	<font></font>
389	387	1	13.02.20		355	3	<font></font>
391	387	2	13.02.20		357	3	<font></font>
393	391	1	13.02.20		335	2	 <font></font>
395	387	3	13.02.20		359	3	<font></font>
397	385	2	13.02.20		349	4	 ()<font></font>
399	397	1	13.02.20		355	3	<font></font>
401	397	2	13.02.20		357	3	<font></font>
403	397	3	13.02.20		359	3	<font></font>
405	403	1	13.02.20		337	2	<font></font>
407	385	3	13.02.20		351	4	<font></font>
409	407	1	13.02.20		355	3	<font></font>
411	407	2	13.02.20		357	3	<font></font>
413	407	3	13.02.20		359	3	<font></font>
415	413	1	13.02.20		341	2	 <font></font>
417	407	4	13.02.20		361	3	<font></font>
419	385	4	13.02.20		353	4	 <font></font>
421	419	1	13.02.20		357	3	<font></font>
423	419	2	13.02.20		359	3	<font></font>
425	419	3	13.02.20		361	3	<font></font>
427	419	4	13.02.20		363	3	<font></font>
429	427	1	13.02.20		345	2	 2 <font></font>
<span class="hljs-comment">----------------------------------------------------------------------------------</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдирд╣реАрдВ рднреВрд▓рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рд╕рдорд╛рд╡реЗрд╢рди рд╕рдВрдмрдВрдз (рд╡реГрдХреНрд╖ рдПрдХ рд╕рд╣рд┐рдд) рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рдЪреМрд░рд╛рд╣реЗ рдХрд╛ рд╕рдВрдмрдВрдз рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдХреНрд░реЙрд╕-рдЯреЗрдмрд▓ред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рдордп рдЪреМрд░рд╛рд╣реЗ рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╢рд░реНрдд рдЬреЛрдбрд╝рддрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> nsi_cross (<font></font>
    nsi_cross_id        <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_main_id         <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_main_type_id    <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_detail_id       <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    nsi_detail_type_id  <span class="hljs-built_in">NUMBER</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    begin_date          <span class="hljs-built_in">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
    end_date            <span class="hljs-built_in">DATE</span>,
    <span class="hljs-keyword">CONSTRAINT</span> nsi_cross_pk PRIMARY <span class="hljs-keyword">KEY</span> (nsi_cross_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_cross_main_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_main_type_id, nsi_main_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_type_id, nsi_id),
    <span class="hljs-keyword">CONSTRAINT</span> nsi_cross_detail_nsi_fk <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (nsi_detail_type_id, nsi_detail_id) <span class="hljs-keyword">REFERENCES</span> nsi (nsi_type_id, nsi_id)<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> nsi_cross <span class="hljs-keyword">IS</span> <span class="hljs-string">'. - '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.nsi_cross_id <span class="hljs-keyword">IS</span> <span class="hljs-string">''</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.nsi_main_id <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.nsi_main_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">'   '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.nsi_detail_id <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.nsi_detail_type_id <span class="hljs-keyword">IS</span> <span class="hljs-string">'   '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.begin_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;
<span class="hljs-keyword">COMMENT</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> nsi_cross.end_date <span class="hljs-keyword">IS</span> <span class="hljs-string">'  '</span>;<font></font>
<font></font>
    <span class="hljs-comment">/*        -.
    *  @param p_nsi_main_id nsi_cross.nsi_main_id%TYPE -   
    *  @param p_nsi_main_type_id nsi_cross.nsi_main_type_id%TYPE -    
    *  @param p_nsi_detail_id nsi_cross.nsi_detail_id%TYPE -   
    *  @param p_nsi_detail_type_id nsi_cross.nsi_detail_type_id%TYPE -    
    *  @param p_begin_date DATE -    
    *  @param p_end_date DATE -    
    */</span><font></font>
    PROCEDURE nsi_cross_check_period (<font></font>
        p_nsi_cross_id          IN nsi_cross.nsi_cross_id%TYPE,<font></font>
        p_begin_date            IN nsi_cross.begin_date%TYPE, <font></font>
        p_end_date              IN nsi_cross.end_date%TYPE)<font></font>
    AS<font></font>
        v_cnt NUMBER;<font></font>
        v_nsi_main_id           nsi_cross.nsi_main_id%TYPE;<font></font>
        v_nsi_main_type_id      nsi_cross.nsi_main_type_id%TYPE;<font></font>
        v_nsi_detail_id         nsi_cross.nsi_detail_id%TYPE;<font></font>
        v_nsi_detail_type_id    nsi_cross.nsi_detail_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">IF</span> (p_end_date <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">AND</span> (Trunc(p_begin_date) &gt; Trunc(p_end_date)) <span class="hljs-keyword">THEN</span><font></font>
            RAISE_APPLICATION_ERROR (NSI_ERROR_CODE, <font></font>
                <span class="hljs-string">'[nsi_cross_check_period]         '</span> || Trunc(p_begin_date) || <span class="hljs-string">' - '</span> || Trunc(p_end_date)); 
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MIN</span>(nsi_main_id), <span class="hljs-keyword">MIN</span>(nsi_main_type_id),
               <span class="hljs-keyword">MIN</span>(nsi_detail_id), <span class="hljs-keyword">MIN</span>(nsi_detail_type_id) 
          <span class="hljs-keyword">INTO</span> v_nsi_main_id, v_nsi_main_type_id,<font></font>
               v_nsi_detail_id, v_nsi_detail_type_id <font></font>
          <span class="hljs-keyword">FROM</span> nsi_cross
         <span class="hljs-keyword">WHERE</span> nsi_cross_id = p_nsi_cross_id;<font></font>
         <font></font>
        v_cnt := 0;<font></font>
        <font></font>
        IF (v_nsi_main_id IS NOT NULL) THEN<font></font>
        <font></font>
            IF (p_end_date IS NOT NULL) THEN<font></font>
                <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*)
                  <span class="hljs-keyword">INTO</span> v_cnt
                  <span class="hljs-keyword">FROM</span> nsi_cross
                 <span class="hljs-keyword">WHERE</span> nsi_main_id = v_nsi_main_id
                   <span class="hljs-keyword">AND</span> nsi_main_type_id = v_nsi_main_type_id
                   <span class="hljs-keyword">AND</span> nsi_detail_id = v_nsi_detail_id
                   <span class="hljs-keyword">AND</span> nsi_detail_type_id = v_nsi_detail_type_id
                   <span class="hljs-keyword">AND</span> nsi_cross_id &lt;&gt; p_nsi_cross_id
                   <span class="hljs-keyword">AND</span> begin_date &lt;= Trunc(p_end_date)
                   <span class="hljs-keyword">AND</span> ((end_date <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">OR</span> (end_date &gt;= Trunc(p_end_date)));<font></font>
            ELSE<font></font>
                <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*)
                  <span class="hljs-keyword">INTO</span> v_cnt
                  <span class="hljs-keyword">FROM</span> nsi_cross
                 <span class="hljs-keyword">WHERE</span> nsi_main_id = v_nsi_main_id
                   <span class="hljs-keyword">AND</span> nsi_main_type_id = v_nsi_main_type_id
                   <span class="hljs-keyword">AND</span> nsi_detail_id = v_nsi_detail_id
                   <span class="hljs-keyword">AND</span> nsi_detail_type_id = v_nsi_detail_type_id
                   <span class="hljs-keyword">AND</span> nsi_cross_id &lt;&gt; p_nsi_cross_id
                   <span class="hljs-keyword">AND</span> ((<font></font>
                        (end_date <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">AND</span> (end_date &gt;= Trunc(p_begin_date))<font></font>
                        ) <span class="hljs-keyword">OR</span> (end_date <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>)<font></font>
                        );<font></font>
            <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;<font></font>
<font></font>
        IF (v_cnt &gt; 0) THEN<font></font>
            RAISE_APPLICATION_ERROR (NSI_ERROR_CODE, <font></font>
                '[nsi_cross_check_period]     ' || p_begin_date || ' - ' || p_end_date);    <font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*   .
    *  @param p_nsi_main_id nsi_cross.nsi_main_id%TYPE -   
    *  @param p_nsi_main_type_id nsi_cross.nsi_main_type_id%TYPE -    
    *  @param p_nsi_detail_id nsi_cross.nsi_detail_id%TYPE -   
    *  @param p_nsi_detail_type_id nsi_cross.nsi_detail_type_id%TYPE -    
    *  @param p_begin_date DATE -    
    *  @param p_end_date DATE -    
    */</span><font></font>
    PROCEDURE nsi_cross_insert (<font></font>
        p_nsi_main_id           IN nsi_cross.nsi_main_id%TYPE,<font></font>
        p_nsi_main_type_id      IN nsi_cross.nsi_main_type_id%TYPE,<font></font>
        p_nsi_detail_id         IN nsi_cross.nsi_detail_id%TYPE,<font></font>
        p_nsi_detail_type_id    IN nsi_cross.nsi_detail_type_id%TYPE,<font></font>
        p_begin_date            IN nsi_cross.begin_date%TYPE, <font></font>
        p_end_date              IN nsi_cross.end_date%TYPE)<font></font>
    AS<font></font>
        v_id        NUMBER;<font></font>
        v_log_descr nsi_log.descr%TYPE;<font></font>
        v_type_id 	nsi.nsi_type_id%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span><font></font>
        v_id := get_nsi_id;<font></font>
        v_type_id := get_type_id('nsi_cross');<font></font>
<font></font>
        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> nsi_cross (<font></font>
            nsi_cross_id, nsi_main_id, nsi_main_type_id,<font></font>
            nsi_detail_id, nsi_detail_type_id, <font></font>
            begin_date, end_date)<font></font>
        <span class="hljs-keyword">VALUES</span> (<font></font>
            v_id, p_nsi_main_id, p_nsi_main_type_id,<font></font>
            p_nsi_detail_id, p_nsi_detail_type_id, <font></font>
            Trunc(p_begin_date), Trunc(p_end_date));<font></font>
<font></font>
        nsi_cross_check_period (v_id, p_begin_date, p_end_date);<font></font>
<font></font>
        v_log_descr := '[' || get_nsi_descr(p_nsi_main_id, p_nsi_main_type_id) || ' &lt;=&gt; ' || get_nsi_descr(p_nsi_detail_id, p_nsi_detail_type_id) || '] ';<font></font>
        v_log_descr := v_log_descr || ' ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper (v_id, v_type_id, NSI_LOG_OPERNUM_INSERT, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span> nsi_cross_insert;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*     .
    *  @param p_nsi_cross_id nsi_cross.nsi_cross_id%TYPE -  nsi_cross
    *  @param p_begin_date nsi_cross.begin_date%TYPE -   
    *  @param p_end_date nsi_cross.end_date%TYPE -   
    */</span><font></font>
    PROCEDURE nsi_cross_period (<font></font>
        p_nsi_cross_id  IN nsi_cross.nsi_cross_id%TYPE,<font></font>
        p_begin_date    IN nsi_cross.begin_date%TYPE, <font></font>
        p_end_date      IN nsi_cross.end_date%TYPE)<font></font>
    AS<font></font>
        v_main_id 		    nsi_cross.nsi_main_id%TYPE;<font></font>
        v_main_type_id 	    nsi_cross.nsi_main_type_id%TYPE;<font></font>
        v_detail_id 		nsi_cross.nsi_detail_id%TYPE;<font></font>
        v_detail_type_id 	nsi_cross.nsi_detail_type_id%TYPE;<font></font>
        v_type_id 	        nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr         nsi_log.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_type_id := get_type_id(<span class="hljs-string">'nsi_cross'</span>);<font></font>
        <font></font>
        <span class="hljs-keyword">SELECT</span> nsi_main_id, nsi_main_type_id,<font></font>
               nsi_detail_id, nsi_detail_type_id<font></font>
          <span class="hljs-keyword">INTO</span> v_main_id, v_main_type_id,<font></font>
               v_detail_id, v_detail_type_id<font></font>
          <span class="hljs-keyword">FROM</span> nsi_cross
         <span class="hljs-keyword">WHERE</span> nsi_cross_id = p_nsi_cross_id;<font></font>
<font></font>
        nsi_cross_check_period (p_nsi_cross_id, p_begin_date, p_end_date);<font></font>
<font></font>
        <span class="hljs-keyword">UPDATE</span> nsi_cross
           <span class="hljs-keyword">SET</span> begin_date = Trunc(p_begin_date),<font></font>
               end_date = Trunc(p_end_date) <font></font>
         <span class="hljs-keyword">WHERE</span> nsi_cross_id = p_nsi_cross_id;<font></font>
         <font></font>
        v_log_descr := '[' || get_nsi_descr(v_main_id, v_main_type_id) || ' &lt;=&gt; ' || get_nsi_descr(v_detail_id, v_detail_type_id) || '] ';<font></font>
        v_log_descr := v_log_descr || ' ' || p_begin_date || ' - ' || p_end_date;<font></font>
        log_oper (p_nsi_cross_id, v_type_id, NSI_LOG_OPERNUM_UPDATE, v_log_descr);<font></font>
    <span class="hljs-keyword">END</span>;<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">/*   .
    *  @param p_nsi_cross_id nsi_cross.nsi_cross_id%TYPE -  nsi_cross
    */</span><font></font>
    PROCEDURE nsi_cross_delete (p_nsi_cross_id IN nsi_cross.nsi_cross_id%TYPE)<font></font>
    AS<font></font>
        v_type_id 	nsi.nsi_type_id%TYPE;<font></font>
        v_log_descr nsi_log.descr%TYPE;<font></font>
    <span class="hljs-keyword">BEGIN</span>
        v_type_id := pkg_nsi.get_type_id(<span class="hljs-string">'nsi_cross'</span>);<font></font>
        <font></font>
        FOR rec IN (<font></font>
            <span class="hljs-keyword">SELECT</span> nsi_cross_id, nsi_main_id, nsi_main_type_id,<font></font>
                    nsi_detail_id, nsi_detail_type_id,<font></font>
                    begin_date, end_date<font></font>
            <span class="hljs-keyword">FROM</span> nsi_cross
            <span class="hljs-keyword">WHERE</span> nsi_cross_id = p_nsi_cross_id<font></font>
        )<font></font>
        <span class="hljs-keyword">LOOP</span>
            v_log_descr := <span class="hljs-string">'['</span> || pkg_nsi.get_nsi_descr(rec.nsi_main_id, rec.nsi_main_type_id) || <span class="hljs-string">' &lt;=&gt; '</span> || pkg_nsi.get_nsi_descr(rec.nsi_detail_id, rec.nsi_detail_type_id) || <span class="hljs-string">'] '</span>;<font></font>
            v_log_descr := v_log_descr || ' ' || rec.begin_date || ' - ' || rec.end_date;<font></font>
            pkg_nsi.log_oper (rec.nsi_cross_id, v_type_id, pkg_nsi.NSI_LOG_OPERNUM_DELETE, v_log_descr);<font></font>
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> nsi_cross
        <span class="hljs-keyword">WHERE</span> nsi_cross_id = p_nsi_cross_id;
    <span class="hljs-keyword">END</span>;
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣реА рд╣реИ, рдЕрдм рд╣рдо рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗ рд╕рд╛рде рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдордиреЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реА рд╕рдорд╕реНрдпрд╛</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ </font><b><font style="vertical-align: inherit;">рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рд╣реИ</font></b><font style="vertical-align: inherit;"> ред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рдЖрдк рдЗрд╕ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рдмрд╣реБрдд рд╕реА рдЪреАрдЬреЗрдВ рд╕рдВрд▓рдЧреНрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдореИрдВрдиреЗ рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХрд╛рд░реНрдп рдкреВрд░рд╛ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рдФрд░ рдмрд╛рдХреА рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЪрд░реНрдЪрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд╛рдордЧреНрд░реА рдУрд░реЗрдХрд▓ рд╕рдВрд╕реНрдХрд░рдг 18 рд╕реА рдкрд░ рддреИрдпрд╛рд░ рдХреА рдЧрдИ рдереА, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЬреЗрдиреНрд╕ рдлреЙрд░реНрдореЗрдЯ рдХреЗ рд▓рд┐рдП рдореВрд▓ рд╕рдорд░реНрдерди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрд╕реНрдХрд░рдг 12 рдореЗрдВ рдореМрдЬреВрдж рд╣реИред рдпрд╣рд╛рдВ </font><font style="vertical-align: inherit;">рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЧреНрд░рд╣ рдХрд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi492390/index.html">рдмреНрд░реЗрдХ рдкрд░ рдпреБрджреНрдзред рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рдореВрд▓ рдореЗрдВ рдШрдЯрдХ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдЕрдиреБрдХреВрд▓рди</a></li>
<li><a href="../hi492398/index.html">рд╣рдо рд░рд┐рдореЛрдЯ рдбрд┐рд╡рд╛рдЗрд╕, рдкреЙрдбрдХрд╛рд╕реНрдЯрд┐рдВрдЧ, рд╡реАрдбрд┐рдпреЛ рдФрд░ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi492404/index.html">рд╕реНрдкрдВрджрди + рдЕрд░реБрдбрд┐рдиреЛ рдиреИрдиреЛ 33 рдмреАрдПрд▓рдИ рднрд╛рд╡рдирд╛ = рдмрд╣реБрдд рд╕рд░рд▓ рдмреАрдПрд▓рдИ рд╕реЗрдВрд╕рд░</a></li>
<li><a href="../hi492406/index.html">рдЧреАрдХ рдХреЗ рд▓рд┐рдП рдкреЙрдбрдХрд╛рд╕реНрдЯ: рдкрд░рд┐рдпреЛрдЬрдирд╛ рдкреНрд░рдмрдВрдзрди, рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдЬреАрдЯреАрдбреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд┐рджреНрдз рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдПрдХ рдЬреЛрдбрд╝реЗ</a></li>
<li><a href="../hi492408/index.html">рдпреИрдВрдбреЗрдХреНрд╕ рдбреЗрд╕реНрдХрдЯреЙрдк рдЙрдкрд╕реНрдерд┐рддрд┐ рдЧрд┐рд░ рдЧрдИ рд╣реИ: 2019 рдореЗрдВ рдХреНрдпрд╛ рд╣реБрдЖ рдФрд░ 2020 рдореЗрдВ рдпрд╣ рдХреИрд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрдЧрд╛</a></li>
<li><a href="../hi492420/index.html">рд╡реАрдЪреИрдЯ рдпрд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╡реНрдпрд╛рдкрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧред рдПрдХ рдбреЗрд╡рд▓рдкрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ</a></li>
<li><a href="../hi492422/index.html">рдПрд╕реНрдХреЛрдмрд╛рд░ рдлреЛрд▓реНрдб 2 - рдж рд╕реНрдХреИрдо рдХрдВрдЯреАрдиреНрдпреВрдЬрд╝</a></li>
<li><a href="../hi492424/index.html">рдХреЛрдгреАрдп: рд╕рджрд╕реНрдпрддрд╛ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛</a></li>
<li><a href="../hi492426/index.html">рд╕реВрдЪрдирд╛ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХреА рдЦрд╛рдиреЛрдВ рдХреЛ рдХреИрд╕реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ</a></li>
<li><a href="../hi492432/index.html">FastText: рдХреЛрдб рдиреБрд╕реНрдЦрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>