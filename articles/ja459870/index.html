<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌴 👨‍🏫 🙇🏾 FのModel-View-Updateアーキテクチャの例＃ 👨🏻‍⚖️ 👊🏽 🐆</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JSでの実装のために、ReactでのReduxが気に入らなかった人はいますか？ 
 

リデューサーの不器用なスイッチケースは好きではありませんでした。パターンマッチングがより便利な言語があり、タイプはイベントとモデルのモデリングに適しています。たとえば、F＃です。
 この記事は、エルミッシュのメッ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>FのModel-View-Updateアーキテクチャの例＃</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459870/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSでの実装のために、ReactでのReduxが気に入らなかった人はいますか？ </font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リデューサーの不器用なスイッチケースは好きではありませんでした。パターンマッチングがより便利な言語があり、タイプはイベントとモデルのモデリングに適しています。</font><font style="vertical-align: inherit;">たとえば、F＃です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エルミッシュの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージングデバイスの説明です</font><font style="vertical-align: inherit;">。</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このアーキテクチャで記述されたコンソールアプリケーションの例を示します。その例を使用すると、このアプローチの使用方法が明確になり、エルミッシュアーキテクチャを理解できます。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は、詩を読むための簡単なコンソールアプリケーションを作成しました。シードには、コンソールに表示される作者ごとに1つずつ、いくつかの詩があります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウには4行のテキストしか含まれていません。「上」および「下」ボタンを押すと、詩をスクロールできます。デジタルボタンはテキストの色を変更します。ボタンを左右に動かすと、アクションの履歴を移動できます。たとえば、ユーザーはプーシキンの詩を読んだり、イェセニンの詩に切り替えたり、変更したりできます。テキストの色、そして色があまり良くなくてイェセニンはそれが気に入らないと思って、左矢印をダブルクリックして、プーシキンを読み終えたところに戻った。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この奇跡は次のようになります。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/3h/2j/lh/3h2jlh-zewzgiozosfdxax-re4m.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装を検討してください。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのオプションを検討した場合、ユーザーができることはボタンを押すことだけであることは明らかです。ボタンを押すことで、ユーザーが何を望んでいるのかを判断でき、ユーザーが望むことができます。</font></font></p><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者を変更</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">色を変える</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクロール（上/下）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前/次のバージョンに移動</font></font></li>
</ol><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーはバージョンに戻ることができるはずなので、ユーザーのアクションを修正し</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てモデル</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><strong><font style="vertical-align: inherit;">覚えて</font></strong><font style="vertical-align: inherit;">おく必要があります。その</font><font style="vertical-align: inherit;">結果、考えられるすべてのメッセージは次のように説明されます。</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span> =</span>
        | <span class="hljs-type">ConsoleEvent</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ConsoleKey</span>
        | <span class="hljs-type">ChangeAuthor</span> <span class="hljs-keyword">of</span> <span class="hljs-type">Author</span>
        | <span class="hljs-type">ChangeColor</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ConsoleColor</span>
        | <span class="hljs-type">ChangePosition</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ChangePosition</span>
        | <span class="hljs-type">ChangeVersion</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ChangeVersion</span>
        | <span class="hljs-type">RememberModel</span>
        | <span class="hljs-type">WaitUserAction</span>
        | <span class="hljs-type">Exit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ChangeVersion</span> =</span>
        | <span class="hljs-type">Back</span>
        | <span class="hljs-type">Forward</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ChangePosition</span> =</span>
        | <span class="hljs-type">Up</span>
        | <span class="hljs-type">Down</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Author</span> =</span>
        | <span class="hljs-type">Pushkin</span>
        | <span class="hljs-type">Lermontov</span>
        | <span class="hljs-type">Blok</span>
        | <span class="hljs-type">Esenin</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Poem</span> = <span class="hljs-type">Poem</span> of string</span></code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルでは、現在コンソールに表示されているテキストに関する情報、ユーザーアクションの履歴、および表示する必要があるモデルを知るためにユーザーがロールバックするアクションの数を格納する必要があります。</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Model</span> =</span><font></font>
        {<font></font>
            viewTextInfo: <span class="hljs-type">ViewTextInfo</span><font></font>
            countVersionBack: int<font></font>
            history: <span class="hljs-type">ViewTextInfo</span> list<font></font>
        }<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ViewTextInfo</span> =</span><font></font>
        {<font></font>
            text: string;<font></font>
            formatText: string;<font></font>
            countLines: int;<font></font>
            positionY: int;<font></font>
            color: <span class="hljs-type">ConsoleColor</span>
        }</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エルミッシュアーキテクチャ-model-view-update、モデルはすでに検討されているので、次に進みます。</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> <span class="hljs-type">SnowAndUserActionView</span> (model: <span class="hljs-type">Model</span>) (dispatch: <span class="hljs-type">Msg</span> -&gt; unit) =
       <span class="hljs-keyword">let</span> { formatText = ft; color = clr } = model.viewTextInfo;<font></font>
       clearConsoleAndPrintTextWithColor ft clr<font></font>
       <span class="hljs-keyword">let</span> key = <span class="hljs-type">Console</span>.<span class="hljs-type">ReadKey</span>().<span class="hljs-type">Key</span>;
       <span class="hljs-type">Msg</span>.<span class="hljs-type">ConsoleEvent</span> key |&gt; dispatch<font></font>
<font></font>
<span class="hljs-title">let</span> clearConsoleAndPrintTextWithColor (text: string) (color: <span class="hljs-type">ConsoleColor</span>) =
       <span class="hljs-type">Console</span>.<span class="hljs-type">Clear</span>();
       <span class="hljs-type">Console</span>.<span class="hljs-type">WriteLine</span>()
       <span class="hljs-type">Console</span>.<span class="hljs-type">ForegroundColor</span> &lt;- color
       <span class="hljs-type">Console</span>.<span class="hljs-type">WriteLine</span>(text)</code></pre><br>
<p>   ,     <em>viewTextInfo</em>,   ,       <em>update</em>.<br>
  ,      <em>dispatch</em>,      .</p><br>
<p><em>Update</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> update (msg: <span class="hljs-type">Msg</span>) (model: <span class="hljs-type">Model</span>) =<font></font>
        match msg with<font></font>
        | <span class="hljs-type">ConsoleEvent</span> key -&gt; model, updateConsoleEvent key<font></font>
        | <span class="hljs-type">ChangeAuthor</span> author -&gt; updateChangeAuthor model author<font></font>
        | <span class="hljs-type">ChangeColor</span> color -&gt; updateChangeColor model color<font></font>
        | <span class="hljs-type">ChangePosition</span> position -&gt; updateChangePosition model position<font></font>
        | <span class="hljs-type">ChangeVersion</span> version -&gt; updateChangeVersion model version<font></font>
        | <span class="hljs-type">RememberModel</span> -&gt; updateAddEvent model<font></font>
        | <span class="hljs-type">WaitUserAction</span> -&gt; model, []</code></pre><br>
<p>    <em>msg </em>     .</p><br>
<p> <em>update</em>   ,    ,   —   <em>WaitUserAction</em> —       .</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateConsoleEvent (key: <span class="hljs-type">ConsoleKey</span>) =
       <span class="hljs-keyword">let</span> msg =<font></font>
        match key with<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D1</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Red</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D2</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Green</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D3</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Blue</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D4</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Black</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D5</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Cyan</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">LeftArrow</span> -&gt; <span class="hljs-type">ChangeVersion</span> <span class="hljs-type">Back</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">RightArrow</span> -&gt; <span class="hljs-type">ChangeVersion</span> <span class="hljs-type">Forward</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">P</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Pushkin</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">E</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Esenin</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">B</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Blok</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">L</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Lermontov</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">UpArrow</span> -&gt; <span class="hljs-type">ChangePosition</span> <span class="hljs-type">Up</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">DownArrow</span> -&gt; <span class="hljs-type">ChangePosition</span> <span class="hljs-type">Down</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">X</span> -&gt; <span class="hljs-type">Exit</span><font></font>
<font></font>
        | _ -&gt; <span class="hljs-type">WaitUserAction</span>
       msg |&gt; <span class="hljs-type">Cmd</span>.ofMsg</code></pre><br>
<p> ,  ,  <em>countVersionBack</em>    0,  ,        ,     ,           <em>history</em>. </p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateChangeAuthor (model: <span class="hljs-type">Model</span>) (author: <span class="hljs-type">Author</span>) =
        <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> updatedText) = seed.[author]
        <span class="hljs-keyword">let</span> updatedFormatText = getlines updatedText <span class="hljs-number">0</span> <span class="hljs-number">3</span>
        <span class="hljs-keyword">let</span> updatedCountLines = (splitStr updatedText).<span class="hljs-type">Length</span>
        <span class="hljs-keyword">let</span> updatedViewTextInfo =<font></font>
            {model.viewTextInfo<font></font>
             with text = updatedText;<font></font>
              formatText = updatedFormatText;<font></font>
              countLines = updatedCountLines }<font></font>
<font></font>
        { model<font></font>
          with viewTextInfo = updatedViewTextInfo;<font></font>
           countVersionBack = <span class="hljs-number">0</span> },
        <span class="hljs-type">Cmd</span>.ofMsg <span class="hljs-type">RememberModel</span>
</code></pre><br>
<p>    <em>RememberModel</em>,  ,  <em>history</em>,   .</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateModelHistory model =<font></font>
        { model with history = model.history @ [ model.viewTextInfo ] },<font></font>
        <span class="hljs-type">Cmd</span>.ofMsg <span class="hljs-type">WaitUserAction</span></code></pre><br>
<p> <em>update'</em>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,    .</p><br>
<p>   ,      :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><em> </em>run<em>       </em>Messages<em>     ,    </em></p><br>
<pre><code class="haskell hljs">[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true)&gt;]
<span class="hljs-title">let</span> ``    `` (authors: <span class="hljs-type">Author</span> list) =
    <span class="hljs-keyword">let</span> state = (createProgram (authors |&gt; <span class="hljs-type">List</span>.map <span class="hljs-type">ChangeAuthor</span>) |&gt; run)<font></font>
    match (authors |&gt; <span class="hljs-type">List</span>.tryLast) with<font></font>
    | <span class="hljs-type">Some</span> s -&gt;
        <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> text) = seed.[s]<font></font>
        state.viewTextInfo.text = text<font></font>
    | <span class="hljs-type">None</span> -&gt; true<font></font>
<font></font>
[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true)&gt;]
<span class="hljs-title">let</span> ``    `` changeColorMsg =
    <span class="hljs-keyword">let</span> state = (createProgram (changeColorMsg|&gt;<span class="hljs-type">List</span>.map <span class="hljs-type">ChangeColor</span>)|&gt; run)<font></font>
    match (changeColorMsg |&gt; <span class="hljs-type">List</span>.tryLast) with<font></font>
    | <span class="hljs-type">Some</span> s -&gt; state.viewTextInfo.color = s<font></font>
    | <span class="hljs-type">None</span> -&gt; true<font></font>
<font></font>
[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true,<span class="hljs-type">Arbitrary</span>=[|typeof&lt;<span class="hljs-type">ChangeColorAuthorPosition</span>&gt;|])&gt;]
<span class="hljs-title">let</span> ``        `` msgs =
      <span class="hljs-keyword">let</span> tryLastSomeList list = list |&gt; <span class="hljs-type">List</span>.filter (<span class="hljs-type">Option</span>.isSome)<font></font>
                                      |&gt; <span class="hljs-type">List</span>.map (<span class="hljs-type">Option</span>.get)<font></font>
                                      |&gt; <span class="hljs-type">List</span>.tryLast
      <span class="hljs-keyword">let</span> lastAuthor = msgs<font></font>
                       |&gt; <span class="hljs-type">List</span>.map (fun x -&gt; match x with<font></font>
                                             | <span class="hljs-type">ChangeAuthor</span> a -&gt; <span class="hljs-type">Some</span> a<font></font>
                                             | _ -&gt; <span class="hljs-type">None</span>)<font></font>
                       |&gt; tryLastSomeList<font></font>
      <span class="hljs-keyword">let</span> lastColor = msgs<font></font>
                       |&gt; <span class="hljs-type">List</span>.map (fun x -&gt; match x with<font></font>
                                            | <span class="hljs-type">ChangeColor</span> a -&gt; <span class="hljs-type">Some</span> a<font></font>
                                            | _ -&gt; <span class="hljs-type">None</span>)<font></font>
                       |&gt; tryLastSomeList<font></font>
      <span class="hljs-keyword">let</span> state = (createProgram msgs |&gt; run)
      <span class="hljs-keyword">let</span> colorTest =<font></font>
          match lastColor with<font></font>
          | <span class="hljs-type">Some</span> s -&gt; state.viewTextInfo.color = s<font></font>
          | <span class="hljs-type">None</span> -&gt; true
      <span class="hljs-keyword">let</span> authorTest =<font></font>
          match lastAuthor with<font></font>
          | <span class="hljs-type">Some</span> s -&gt;
              <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> t) = seed.[s];<font></font>
              state.viewTextInfo.text = t<font></font>
          | <span class="hljs-type">None</span> -&gt; true<font></font>
      authorTest &amp;&amp; colorTest<font></font>
</code></pre></div></div><br>
<p>    FsCheck,     .</p><br>
<p>   ,   Elmish        (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> )</a>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Dispatch</span>&lt;'msg&gt; = 'msg -&gt; unit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Sub</span>&lt;'msg&gt; = <span class="hljs-type">Dispatch</span>&lt;'msg&gt; -&gt; unit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Cmd</span>&lt;'msg&gt; = <span class="hljs-type">Sub</span>&lt;'msg&gt; list</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Program</span>&lt;'model, 'msg, 'view&gt; =</span><font></font>
        {<font></font>
          init: unit -&gt;'model * <span class="hljs-type">Cmd</span>&lt;'msg&gt;<font></font>
          update: 'msg -&gt; 'model -&gt; ('model * <span class="hljs-type">Cmd</span>&lt;'msg&gt;)<font></font>
          setState: 'model -&gt; 'msg -&gt; <span class="hljs-type">Dispatch</span>&lt;'msg&gt; -&gt; unit<font></font>
         }<font></font>
<font></font>
<span class="hljs-title">let</span> runWith&lt;'arg, 'model, 'msg, 'view&gt; (program: <span class="hljs-type">Program</span>&lt;'model, 'msg, 'view&gt;) =
    <span class="hljs-keyword">let</span> (initModel, initCmd) = program.init() //<span class="hljs-number">1</span>
    <span class="hljs-keyword">let</span> mutable state = initModel //<span class="hljs-number">2</span>
    <span class="hljs-keyword">let</span> mutable reentered = false //<span class="hljs-number">3</span>
    <span class="hljs-keyword">let</span> buffer = <span class="hljs-type">RingBuffer</span> <span class="hljs-number">10</span> //<span class="hljs-number">4</span> <font></font>
<font></font>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">rec</span> dispatch msg =
        <span class="hljs-keyword">let</span> mutable nextMsg = <span class="hljs-type">Some</span> msg; //<span class="hljs-number">5</span>
        <span class="hljs-keyword">if</span> reentered  //<span class="hljs-number">6</span>
         <span class="hljs-keyword">then</span> buffer.<span class="hljs-type">Push</span> msg //<span class="hljs-number">7</span>
         <span class="hljs-keyword">else</span> 
             while <span class="hljs-type">Option</span>.isSome nextMsg <span class="hljs-keyword">do</span> // <span class="hljs-number">8</span>
                 reentered &lt;- true // <span class="hljs-number">9</span>
                 <span class="hljs-keyword">let</span> (model, cmd) = program.update nextMsg.<span class="hljs-type">Value</span> state // <span class="hljs-number">9</span>
                 program.setState model nextMsg.<span class="hljs-type">Value</span> dispatch // <span class="hljs-number">10</span>
                 <span class="hljs-type">Cmd</span>.exec dispatch cmd |&gt; ignore  //<span class="hljs-number">11</span>
                 state &lt;- model; // <span class="hljs-number">12</span>
                 nextMsg &lt;- buffer.<span class="hljs-type">Pop</span>() // <span class="hljs-number">13</span>
                 reentered &lt;- false; // <span class="hljs-number">14</span><font></font>
<font></font>
    <span class="hljs-type">Cmd</span>.exec dispatch initCmd |&gt; ignore // <span class="hljs-number">15</span>
    state //<span class="hljs-number">16</span><font></font>
<font></font>
<span class="hljs-title">let</span> run program = runWith program</code></pre><br>
<p> <em>Dispath&lt;'msg&gt;</em>   dispatch    <em>view</em>,   <em>Message</em>   <em>unit</em><br>
<em>Sub&lt;'msg&gt;</em> —  ,  <em>dispatch</em>   <em>unit</em>,    <em>Sub</em>,   <em>ofMsg</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> ofMsg&lt;'msg&gt; (msg: 'msg): <span class="hljs-type">Cmd</span>&lt;'msg&gt; =<font></font>
        [ fun (dispatch: <span class="hljs-type">Dispatch</span>&lt;'msg&gt;) -&gt; dispatch msg ]</code></pre><br>
<p>  <em>ofMsg</em>, ,  <em>Cmd.ofMsg RememberModel</em>    <em>updateChangeAuthor</em>,           <em>update</em><br>
<em>Cmd&lt;'msg&gt;</em> —  <em>Sub&lt;'msg&gt;</em></p><br>
<p>   <em>Program</em>,  generic ,   ,   <em>view</em>,      -   <em>view</em>,   Elmish.React view  F#  DOM .</p><br>
<p> <em>init </em> —    elmish,        ,      <em>Cmd.ofMsg RememberModel</em><br>
<em>Update </em> —   <em>update</em>,     .</p><br>
<p><em>SetState </em> —   Elmish     <em>dispatch </em>  <em>view</em>,     msg,   <em>view </em>   ,      ,     .</p><br>
<p> <em>runWith</em>,  ,   <em>init</em>,     ,   2,3    ,  —     <em>state</em>,    <em>dispatch</em>.</p><br>
<p> 4   <em>buffer </em> —     ,   —  (    <em>RingBuffer</em>,  ,     ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">github</a>)</p><br>
<p>     <em>dispatch</em>,   ,    <em>view</em>,      <em>if</em>   6     ,  <em>reented</em>  <em>true</em>,    ,      ,      <em>buffer</em>.</p><br>
<p>  9   <em>update</em>,        (     <em>RememberModel</em>)<br>
  10  ,  <em>SetState</em>  :</p><br>
<p><img src="https://habrastorage.org/webt/3v/2c/3l/3v2c3li4ffe4paffy46f98nadle.png"></p><br>
<p>  ,     <em>view</em><br>
  ,    ,    <em>Console.ReadLine </em>  ,     <em>RememberModel,ChangeColor</em> (   ,   )         ,     .</p><br>
<p>      <em>OnlyShowView</em>,    .<br>
E   RememberModel     <em>WaitUserAction</em>,     <em>ShowAndUserActionView</em>,      ,   ,         <em>dispatch</em>,      <em>buffer</em>(  <em>reenvited</em>= <em>false</em>)</p><br>
<p>    ,    <em>update</em>,    ,        <em>reented</em>  false. 11   ,       push    <em>buffer</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> exec&lt;'msg&gt; (dispatch: <span class="hljs-type">Dispatch</span>&lt;'msg&gt;) (cmd: <span class="hljs-type">Cmd</span>&lt;'msg&gt;) =<font></font>
        cmd |&gt; <span class="hljs-type">List</span>.map (fun sub -&gt; sub dispatch)</code></pre><br>
<p>  ,   <em>update</em>,   <em>dispatch</em>,        <em>buffer</em>.</p><br>
<p> 12   ,       <em>reented </em> false,  <em>buffer </em>    ,        <em>dispatch </em>     <em>view</em>,   .     ,   ,    ,       dispatch  10 ,       ,   <em>dispatch </em> callback'a       .</p><br>
<p>      <em>dispatch</em>,  15      16  <em>state</em>.</p><br>
<p>    ,  <em>buffer</em>  .    <em>runWith </em>  ,     .</p><br>
<p><em>Program</em>   ,  <em>createProgram </em>  ,       <em>SetState </em>   :<br>
<img src="https://habrastorage.org/webt/jc/tz/4u/jctz4uefscbzhubowwwfa9zltr8.png"></p><br>
<p>        —    update,    <em>setState</em>,    ,   ,    ,       -   <em>Console.ReadKey</em> (  <em>view</em>)</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エルミッシュと同様のシステムがどのように機能するかを説明できたと思います。かなり多くのエルミッシュ機能が残されてい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このトピックに興味がある場合は、その</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ウェブサイトをご覧になる</font></a><font style="vertical-align: inherit;">ことをお勧めします</font><font style="vertical-align: inherit;">。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ご清聴ありがとうございました！</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja459852/index.html">銀行のモバイルアプリケーションで宝くじライブラリを使用する方法</a></li>
<li><a href="../ja459858/index.html">Android向けの最新のマルウェアCerberusの探索</a></li>
<li><a href="../ja459860/index.html">gitlab-ciでの統合テストのためのClickHouseの構成</a></li>
<li><a href="../ja459862/index.html">Berkeley DB STLインターフェイス</a></li>
<li><a href="../ja459866/index.html">pwnable.kr 02による問題解決-衝突。ハッシュ衝突</a></li>
<li><a href="../ja459872/index.html">パットンジェフ。ユーザーストーリー。アジャイルソフトウェア開発の芸術</a></li>
<li><a href="../ja459874/index.html">あなたは何かを隠す必要があります</a></li>
<li><a href="../ja459878/index.html">ページの読み込みを高速化するための7つのCSS最適化のヒント</a></li>
<li><a href="../ja459880/index.html">LinuxでFirefoxを構成する</a></li>
<li><a href="../ja459882/index.html">「デフォルト」の音楽：プレーヤーやパソコンで見つけられるトラック</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>