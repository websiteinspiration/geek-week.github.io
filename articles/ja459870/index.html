<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ´ ğŸ‘¨â€ğŸ« ğŸ™‡ğŸ¾ Fã®Model-View-Updateã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾‹ï¼ƒ ğŸ‘¨ğŸ»â€âš–ï¸ ğŸ‘ŠğŸ½ ğŸ†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JSã§ã®å®Ÿè£…ã®ãŸã‚ã«ã€Reactã§ã®ReduxãŒæ°—ã«å…¥ã‚‰ãªã‹ã£ãŸäººã¯ã„ã¾ã™ã‹ï¼Ÿ 
 

ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã®ä¸å™¨ç”¨ãªã‚¹ã‚¤ãƒƒãƒã‚±ãƒ¼ã‚¹ã¯å¥½ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãŒã‚ˆã‚Šä¾¿åˆ©ãªè¨€èªãŒã‚ã‚Šã€ã‚¿ã‚¤ãƒ—ã¯ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒ¢ãƒ‡ãƒ«ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«é©ã—ã¦ã„ã¾ã™ã€‚ãŸã¨ãˆã°ã€Fï¼ƒã§ã™ã€‚
 ã“ã®è¨˜äº‹ã¯ã€ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥ã®ãƒ¡ãƒƒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fã®Model-View-Updateã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾‹ï¼ƒ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459870/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSã§ã®å®Ÿè£…ã®ãŸã‚ã«ã€Reactã§ã®ReduxãŒæ°—ã«å…¥ã‚‰ãªã‹ã£ãŸäººã¯ã„ã¾ã™ã‹ï¼Ÿ </font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã®ä¸å™¨ç”¨ãªã‚¹ã‚¤ãƒƒãƒã‚±ãƒ¼ã‚¹ã¯å¥½ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ãŒã‚ˆã‚Šä¾¿åˆ©ãªè¨€èªãŒã‚ã‚Šã€ã‚¿ã‚¤ãƒ—ã¯ã‚¤ãƒ™ãƒ³ãƒˆã¨ãƒ¢ãƒ‡ãƒ«ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«é©ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€Fï¼ƒã§ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®è¨˜äº‹ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ã®èª¬æ˜ã§ã™</font><font style="vertical-align: inherit;">ã€‚</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§è¨˜è¿°ã•ã‚ŒãŸã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚ãã®ä¾‹ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®ä½¿ç”¨æ–¹æ³•ãŒæ˜ç¢ºã«ãªã‚Šã€ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç†è§£ã§ãã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ã¯ã€è©©ã‚’èª­ã‚€ãŸã‚ã®ç°¡å˜ãªã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ã‚·ãƒ¼ãƒ‰ã«ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ä½œè€…ã”ã¨ã«1ã¤ãšã¤ã€ã„ãã¤ã‹ã®è©©ãŒã‚ã‚Šã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ã¯4è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã—ã‹å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã€Œä¸Šã€ãŠã‚ˆã³ã€Œä¸‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€è©©ã‚’ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã¾ã™ã€‚ãƒ‡ã‚¸ã‚¿ãƒ«ãƒœã‚¿ãƒ³ã¯ãƒ†ã‚­ã‚¹ãƒˆã®è‰²ã‚’å¤‰æ›´ã—ã¾ã™ã€‚ãƒœã‚¿ãƒ³ã‚’å·¦å³ã«å‹•ã‹ã™ã¨ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å±¥æ­´ã‚’ç§»å‹•ã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ—ãƒ¼ã‚·ã‚­ãƒ³ã®è©©ã‚’èª­ã‚“ã ã‚Šã€ã‚¤ã‚§ã‚»ãƒ‹ãƒ³ã®è©©ã«åˆ‡ã‚Šæ›¿ãˆãŸã‚Šã€å¤‰æ›´ã—ãŸã‚Šã§ãã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã®è‰²ã€ãã—ã¦è‰²ãŒã‚ã¾ã‚Šè‰¯ããªãã¦ã‚¤ã‚§ã‚»ãƒ‹ãƒ³ã¯ãã‚ŒãŒæ°—ã«å…¥ã‚‰ãªã„ã¨æ€ã£ã¦ã€å·¦çŸ¢å°ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãƒ—ãƒ¼ã‚·ã‚­ãƒ³ã‚’èª­ã¿çµ‚ãˆãŸã¨ã“ã‚ã«æˆ»ã£ãŸã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®å¥‡è·¡ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/3h/2j/lh/3h2jlh-zewzgiozosfdxax-re4m.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè£…ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¤œè¨ã—ãŸå ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã§ãã‚‹ã“ã¨ã¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã“ã¨ã ã‘ã§ã‚ã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ã§ã™ã€‚ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½•ã‚’æœ›ã‚“ã§ã„ã‚‹ã®ã‹ã‚’åˆ¤æ–­ã§ãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæœ›ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></p><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‘—è€…ã‚’å¤‰æ›´</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è‰²ã‚’å¤‰ãˆã‚‹</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆä¸Š/ä¸‹ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰/æ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ç§»å‹•</font></font></li>
</ol><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã‚‹ã“ã¨ãŒã§ãã‚‹ã¯ãšãªã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿®æ­£ã—</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦ãƒ¢ãƒ‡ãƒ«</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><strong><font style="vertical-align: inherit;">è¦šãˆã¦</font></strong><font style="vertical-align: inherit;">ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®</font><font style="vertical-align: inherit;">çµæœã€è€ƒãˆã‚‰ã‚Œã‚‹ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ¬¡ã®ã‚ˆã†ã«èª¬æ˜ã•ã‚Œã¾ã™ã€‚</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span> =</span>
        | <span class="hljs-type">ConsoleEvent</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ConsoleKey</span>
        | <span class="hljs-type">ChangeAuthor</span> <span class="hljs-keyword">of</span> <span class="hljs-type">Author</span>
        | <span class="hljs-type">ChangeColor</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ConsoleColor</span>
        | <span class="hljs-type">ChangePosition</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ChangePosition</span>
        | <span class="hljs-type">ChangeVersion</span> <span class="hljs-keyword">of</span> <span class="hljs-type">ChangeVersion</span>
        | <span class="hljs-type">RememberModel</span>
        | <span class="hljs-type">WaitUserAction</span>
        | <span class="hljs-type">Exit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ChangeVersion</span> =</span>
        | <span class="hljs-type">Back</span>
        | <span class="hljs-type">Forward</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ChangePosition</span> =</span>
        | <span class="hljs-type">Up</span>
        | <span class="hljs-type">Down</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Author</span> =</span>
        | <span class="hljs-type">Pushkin</span>
        | <span class="hljs-type">Lermontov</span>
        | <span class="hljs-type">Blok</span>
        | <span class="hljs-type">Esenin</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Poem</span> = <span class="hljs-type">Poem</span> of string</span></code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€ç¾åœ¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã«é–¢ã™ã‚‹æƒ…å ±ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å±¥æ­´ã€ãŠã‚ˆã³è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’çŸ¥ã‚‹ãŸã‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ•°ã‚’æ ¼ç´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Model</span> =</span><font></font>
        {<font></font>
            viewTextInfo: <span class="hljs-type">ViewTextInfo</span><font></font>
            countVersionBack: int<font></font>
            history: <span class="hljs-type">ViewTextInfo</span> list<font></font>
        }<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">ViewTextInfo</span> =</span><font></font>
        {<font></font>
            text: string;<font></font>
            formatText: string;<font></font>
            countLines: int;<font></font>
            positionY: int;<font></font>
            color: <span class="hljs-type">ConsoleColor</span>
        }</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£-model-view-updateã€ãƒ¢ãƒ‡ãƒ«ã¯ã™ã§ã«æ¤œè¨ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€æ¬¡ã«é€²ã¿ã¾ã™ã€‚</font></font></p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> <span class="hljs-type">SnowAndUserActionView</span> (model: <span class="hljs-type">Model</span>) (dispatch: <span class="hljs-type">Msg</span> -&gt; unit) =
       <span class="hljs-keyword">let</span> { formatText = ft; color = clr } = model.viewTextInfo;<font></font>
       clearConsoleAndPrintTextWithColor ft clr<font></font>
       <span class="hljs-keyword">let</span> key = <span class="hljs-type">Console</span>.<span class="hljs-type">ReadKey</span>().<span class="hljs-type">Key</span>;
       <span class="hljs-type">Msg</span>.<span class="hljs-type">ConsoleEvent</span> key |&gt; dispatch<font></font>
<font></font>
<span class="hljs-title">let</span> clearConsoleAndPrintTextWithColor (text: string) (color: <span class="hljs-type">ConsoleColor</span>) =
       <span class="hljs-type">Console</span>.<span class="hljs-type">Clear</span>();
       <span class="hljs-type">Console</span>.<span class="hljs-type">WriteLine</span>()
       <span class="hljs-type">Console</span>.<span class="hljs-type">ForegroundColor</span> &lt;- color
       <span class="hljs-type">Console</span>.<span class="hljs-type">WriteLine</span>(text)</code></pre><br>
<p>   ,     <em>viewTextInfo</em>,   ,       <em>update</em>.<br>
  ,      <em>dispatch</em>,      .</p><br>
<p><em>Update</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> update (msg: <span class="hljs-type">Msg</span>) (model: <span class="hljs-type">Model</span>) =<font></font>
        match msg with<font></font>
        | <span class="hljs-type">ConsoleEvent</span> key -&gt; model, updateConsoleEvent key<font></font>
        | <span class="hljs-type">ChangeAuthor</span> author -&gt; updateChangeAuthor model author<font></font>
        | <span class="hljs-type">ChangeColor</span> color -&gt; updateChangeColor model color<font></font>
        | <span class="hljs-type">ChangePosition</span> position -&gt; updateChangePosition model position<font></font>
        | <span class="hljs-type">ChangeVersion</span> version -&gt; updateChangeVersion model version<font></font>
        | <span class="hljs-type">RememberModel</span> -&gt; updateAddEvent model<font></font>
        | <span class="hljs-type">WaitUserAction</span> -&gt; model, []</code></pre><br>
<p>    <em>msg </em>     .</p><br>
<p> <em>update</em>   ,    ,   â€”   <em>WaitUserAction</em> â€”       .</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateConsoleEvent (key: <span class="hljs-type">ConsoleKey</span>) =
       <span class="hljs-keyword">let</span> msg =<font></font>
        match key with<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D1</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Red</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D2</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Green</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D3</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Blue</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D4</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Black</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">D5</span> -&gt; <span class="hljs-type">ChangeColor</span> <span class="hljs-type">ConsoleColor</span>.<span class="hljs-type">Cyan</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">LeftArrow</span> -&gt; <span class="hljs-type">ChangeVersion</span> <span class="hljs-type">Back</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">RightArrow</span> -&gt; <span class="hljs-type">ChangeVersion</span> <span class="hljs-type">Forward</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">P</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Pushkin</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">E</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Esenin</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">B</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Blok</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">L</span> -&gt; <span class="hljs-type">ChangeAuthor</span> <span class="hljs-type">Author</span>.<span class="hljs-type">Lermontov</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">UpArrow</span> -&gt; <span class="hljs-type">ChangePosition</span> <span class="hljs-type">Up</span>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">DownArrow</span> -&gt; <span class="hljs-type">ChangePosition</span> <span class="hljs-type">Down</span><font></font>
<font></font>
        | <span class="hljs-type">ConsoleKey</span>.<span class="hljs-type">X</span> -&gt; <span class="hljs-type">Exit</span><font></font>
<font></font>
        | _ -&gt; <span class="hljs-type">WaitUserAction</span>
       msg |&gt; <span class="hljs-type">Cmd</span>.ofMsg</code></pre><br>
<p> ,  ,  <em>countVersionBack</em>    0,  ,        ,     ,           <em>history</em>. </p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateChangeAuthor (model: <span class="hljs-type">Model</span>) (author: <span class="hljs-type">Author</span>) =
        <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> updatedText) = seed.[author]
        <span class="hljs-keyword">let</span> updatedFormatText = getlines updatedText <span class="hljs-number">0</span> <span class="hljs-number">3</span>
        <span class="hljs-keyword">let</span> updatedCountLines = (splitStr updatedText).<span class="hljs-type">Length</span>
        <span class="hljs-keyword">let</span> updatedViewTextInfo =<font></font>
            {model.viewTextInfo<font></font>
             with text = updatedText;<font></font>
              formatText = updatedFormatText;<font></font>
              countLines = updatedCountLines }<font></font>
<font></font>
        { model<font></font>
          with viewTextInfo = updatedViewTextInfo;<font></font>
           countVersionBack = <span class="hljs-number">0</span> },
        <span class="hljs-type">Cmd</span>.ofMsg <span class="hljs-type">RememberModel</span>
</code></pre><br>
<p>    <em>RememberModel</em>,  ,  <em>history</em>,   .</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> updateModelHistory model =<font></font>
        { model with history = model.history @ [ model.viewTextInfo ] },<font></font>
        <span class="hljs-type">Cmd</span>.ofMsg <span class="hljs-type">WaitUserAction</span></code></pre><br>
<p> <em>update'</em>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,    .</p><br>
<p>   ,      :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><em> </em>run<em>       </em>Messages<em>     ,    </em></p><br>
<pre><code class="haskell hljs">[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true)&gt;]
<span class="hljs-title">let</span> ``    `` (authors: <span class="hljs-type">Author</span> list) =
    <span class="hljs-keyword">let</span> state = (createProgram (authors |&gt; <span class="hljs-type">List</span>.map <span class="hljs-type">ChangeAuthor</span>) |&gt; run)<font></font>
    match (authors |&gt; <span class="hljs-type">List</span>.tryLast) with<font></font>
    | <span class="hljs-type">Some</span> s -&gt;
        <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> text) = seed.[s]<font></font>
        state.viewTextInfo.text = text<font></font>
    | <span class="hljs-type">None</span> -&gt; true<font></font>
<font></font>
[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true)&gt;]
<span class="hljs-title">let</span> ``    `` changeColorMsg =
    <span class="hljs-keyword">let</span> state = (createProgram (changeColorMsg|&gt;<span class="hljs-type">List</span>.map <span class="hljs-type">ChangeColor</span>)|&gt; run)<font></font>
    match (changeColorMsg |&gt; <span class="hljs-type">List</span>.tryLast) with<font></font>
    | <span class="hljs-type">Some</span> s -&gt; state.viewTextInfo.color = s<font></font>
    | <span class="hljs-type">None</span> -&gt; true<font></font>
<font></font>
[&lt;<span class="hljs-type">Property</span>(<span class="hljs-type">Verbose</span>=true,<span class="hljs-type">Arbitrary</span>=[|typeof&lt;<span class="hljs-type">ChangeColorAuthorPosition</span>&gt;|])&gt;]
<span class="hljs-title">let</span> ``        `` msgs =
      <span class="hljs-keyword">let</span> tryLastSomeList list = list |&gt; <span class="hljs-type">List</span>.filter (<span class="hljs-type">Option</span>.isSome)<font></font>
                                      |&gt; <span class="hljs-type">List</span>.map (<span class="hljs-type">Option</span>.get)<font></font>
                                      |&gt; <span class="hljs-type">List</span>.tryLast
      <span class="hljs-keyword">let</span> lastAuthor = msgs<font></font>
                       |&gt; <span class="hljs-type">List</span>.map (fun x -&gt; match x with<font></font>
                                             | <span class="hljs-type">ChangeAuthor</span> a -&gt; <span class="hljs-type">Some</span> a<font></font>
                                             | _ -&gt; <span class="hljs-type">None</span>)<font></font>
                       |&gt; tryLastSomeList<font></font>
      <span class="hljs-keyword">let</span> lastColor = msgs<font></font>
                       |&gt; <span class="hljs-type">List</span>.map (fun x -&gt; match x with<font></font>
                                            | <span class="hljs-type">ChangeColor</span> a -&gt; <span class="hljs-type">Some</span> a<font></font>
                                            | _ -&gt; <span class="hljs-type">None</span>)<font></font>
                       |&gt; tryLastSomeList<font></font>
      <span class="hljs-keyword">let</span> state = (createProgram msgs |&gt; run)
      <span class="hljs-keyword">let</span> colorTest =<font></font>
          match lastColor with<font></font>
          | <span class="hljs-type">Some</span> s -&gt; state.viewTextInfo.color = s<font></font>
          | <span class="hljs-type">None</span> -&gt; true
      <span class="hljs-keyword">let</span> authorTest =<font></font>
          match lastAuthor with<font></font>
          | <span class="hljs-type">Some</span> s -&gt;
              <span class="hljs-keyword">let</span> (<span class="hljs-type">Poem</span> t) = seed.[s];<font></font>
              state.viewTextInfo.text = t<font></font>
          | <span class="hljs-type">None</span> -&gt; true<font></font>
      authorTest &amp;&amp; colorTest<font></font>
</code></pre></div></div><br>
<p>    FsCheck,     .</p><br>
<p>   ,   Elmish        (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> )</a>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Dispatch</span>&lt;'msg&gt; = 'msg -&gt; unit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Sub</span>&lt;'msg&gt; = <span class="hljs-type">Dispatch</span>&lt;'msg&gt; -&gt; unit</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Cmd</span>&lt;'msg&gt; = <span class="hljs-type">Sub</span>&lt;'msg&gt; list</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Program</span>&lt;'model, 'msg, 'view&gt; =</span><font></font>
        {<font></font>
          init: unit -&gt;'model * <span class="hljs-type">Cmd</span>&lt;'msg&gt;<font></font>
          update: 'msg -&gt; 'model -&gt; ('model * <span class="hljs-type">Cmd</span>&lt;'msg&gt;)<font></font>
          setState: 'model -&gt; 'msg -&gt; <span class="hljs-type">Dispatch</span>&lt;'msg&gt; -&gt; unit<font></font>
         }<font></font>
<font></font>
<span class="hljs-title">let</span> runWith&lt;'arg, 'model, 'msg, 'view&gt; (program: <span class="hljs-type">Program</span>&lt;'model, 'msg, 'view&gt;) =
    <span class="hljs-keyword">let</span> (initModel, initCmd) = program.init() //<span class="hljs-number">1</span>
    <span class="hljs-keyword">let</span> mutable state = initModel //<span class="hljs-number">2</span>
    <span class="hljs-keyword">let</span> mutable reentered = false //<span class="hljs-number">3</span>
    <span class="hljs-keyword">let</span> buffer = <span class="hljs-type">RingBuffer</span> <span class="hljs-number">10</span> //<span class="hljs-number">4</span> <font></font>
<font></font>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">rec</span> dispatch msg =
        <span class="hljs-keyword">let</span> mutable nextMsg = <span class="hljs-type">Some</span> msg; //<span class="hljs-number">5</span>
        <span class="hljs-keyword">if</span> reentered  //<span class="hljs-number">6</span>
         <span class="hljs-keyword">then</span> buffer.<span class="hljs-type">Push</span> msg //<span class="hljs-number">7</span>
         <span class="hljs-keyword">else</span> 
             while <span class="hljs-type">Option</span>.isSome nextMsg <span class="hljs-keyword">do</span> // <span class="hljs-number">8</span>
                 reentered &lt;- true // <span class="hljs-number">9</span>
                 <span class="hljs-keyword">let</span> (model, cmd) = program.update nextMsg.<span class="hljs-type">Value</span> state // <span class="hljs-number">9</span>
                 program.setState model nextMsg.<span class="hljs-type">Value</span> dispatch // <span class="hljs-number">10</span>
                 <span class="hljs-type">Cmd</span>.exec dispatch cmd |&gt; ignore  //<span class="hljs-number">11</span>
                 state &lt;- model; // <span class="hljs-number">12</span>
                 nextMsg &lt;- buffer.<span class="hljs-type">Pop</span>() // <span class="hljs-number">13</span>
                 reentered &lt;- false; // <span class="hljs-number">14</span><font></font>
<font></font>
    <span class="hljs-type">Cmd</span>.exec dispatch initCmd |&gt; ignore // <span class="hljs-number">15</span>
    state //<span class="hljs-number">16</span><font></font>
<font></font>
<span class="hljs-title">let</span> run program = runWith program</code></pre><br>
<p> <em>Dispath&lt;'msg&gt;</em>   dispatch    <em>view</em>,   <em>Message</em>   <em>unit</em><br>
<em>Sub&lt;'msg&gt;</em> â€”  ,  <em>dispatch</em>   <em>unit</em>,    <em>Sub</em>,   <em>ofMsg</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> ofMsg&lt;'msg&gt; (msg: 'msg): <span class="hljs-type">Cmd</span>&lt;'msg&gt; =<font></font>
        [ fun (dispatch: <span class="hljs-type">Dispatch</span>&lt;'msg&gt;) -&gt; dispatch msg ]</code></pre><br>
<p>  <em>ofMsg</em>, ,  <em>Cmd.ofMsg RememberModel</em>    <em>updateChangeAuthor</em>,           <em>update</em><br>
<em>Cmd&lt;'msg&gt;</em> â€”  <em>Sub&lt;'msg&gt;</em></p><br>
<p>   <em>Program</em>,  generic ,   ,   <em>view</em>,      -   <em>view</em>,   Elmish.React view  F#  DOM .</p><br>
<p> <em>init </em> â€”    elmish,        ,      <em>Cmd.ofMsg RememberModel</em><br>
<em>Update </em> â€”   <em>update</em>,     .</p><br>
<p><em>SetState </em> â€”   Elmish     <em>dispatch </em>  <em>view</em>,     msg,   <em>view </em>   ,      ,     .</p><br>
<p> <em>runWith</em>,  ,   <em>init</em>,     ,   2,3    ,  â€”     <em>state</em>,    <em>dispatch</em>.</p><br>
<p> 4   <em>buffer </em> â€”     ,   â€”  (    <em>RingBuffer</em>,  ,     ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">github</a>)</p><br>
<p>     <em>dispatch</em>,   ,    <em>view</em>,      <em>if</em>   6     ,  <em>reented</em>  <em>true</em>,    ,      ,      <em>buffer</em>.</p><br>
<p>  9   <em>update</em>,        (     <em>RememberModel</em>)<br>
  10  ,  <em>SetState</em>  :</p><br>
<p><img src="https://habrastorage.org/webt/3v/2c/3l/3v2c3li4ffe4paffy46f98nadle.png"></p><br>
<p>  ,     <em>view</em><br>
  ,    ,    <em>Console.ReadLine </em>  ,     <em>RememberModel,ChangeColor</em> (   ,   )         ,     .</p><br>
<p>      <em>OnlyShowView</em>,    .<br>
E   RememberModel     <em>WaitUserAction</em>,     <em>ShowAndUserActionView</em>,      ,   ,         <em>dispatch</em>,      <em>buffer</em>(  <em>reenvited</em>= <em>false</em>)</p><br>
<p>    ,    <em>update</em>,    ,        <em>reented</em>  false. 11   ,       push    <em>buffer</em>:</p><br>
<pre><code class="haskell hljs"><span class="hljs-title">let</span> exec&lt;'msg&gt; (dispatch: <span class="hljs-type">Dispatch</span>&lt;'msg&gt;) (cmd: <span class="hljs-type">Cmd</span>&lt;'msg&gt;) =<font></font>
        cmd |&gt; <span class="hljs-type">List</span>.map (fun sub -&gt; sub dispatch)</code></pre><br>
<p>  ,   <em>update</em>,   <em>dispatch</em>,        <em>buffer</em>.</p><br>
<p> 12   ,       <em>reented </em> false,  <em>buffer </em>    ,        <em>dispatch </em>     <em>view</em>,   .     ,   ,    ,       dispatch  10 ,       ,   <em>dispatch </em> callback'a       .</p><br>
<p>      <em>dispatch</em>,  15      16  <em>state</em>.</p><br>
<p>    ,  <em>buffer</em>  .    <em>runWith </em>  ,     .</p><br>
<p><em>Program</em>   ,  <em>createProgram </em>  ,       <em>SetState </em>   :<br>
<img src="https://habrastorage.org/webt/jc/tz/4u/jctz4uefscbzhubowwwfa9zltr8.png"></p><br>
<p>        â€”    update,    <em>setState</em>,    ,   ,    ,       -   <em>Console.ReadKey</em> (  <em>view</em>)</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥ã¨åŒæ§˜ã®ã‚·ã‚¹ãƒ†ãƒ ãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’èª¬æ˜ã§ããŸã¨æ€ã„ã¾ã™ã€‚ã‹ãªã‚Šå¤šãã®ã‚¨ãƒ«ãƒŸãƒƒã‚·ãƒ¥æ©Ÿèƒ½ãŒæ®‹ã•ã‚Œã¦ã„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã«èˆˆå‘³ãŒã‚ã‚‹å ´åˆã¯ã€ãã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚’ã”è¦§ã«ãªã‚‹</font></a><font style="vertical-align: inherit;">ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja459852/index.html">éŠ€è¡Œã®ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å®ãã˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja459858/index.html">Androidå‘ã‘ã®æœ€æ–°ã®ãƒãƒ«ã‚¦ã‚§ã‚¢Cerberusã®æ¢ç´¢</a></li>
<li><a href="../ja459860/index.html">gitlab-ciã§ã®çµ±åˆãƒ†ã‚¹ãƒˆã®ãŸã‚ã®ClickHouseã®æ§‹æˆ</a></li>
<li><a href="../ja459862/index.html">Berkeley DB STLã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</a></li>
<li><a href="../ja459866/index.html">pwnable.kr 02ã«ã‚ˆã‚‹å•é¡Œè§£æ±º-è¡çªã€‚ãƒãƒƒã‚·ãƒ¥è¡çª</a></li>
<li><a href="../ja459872/index.html">ãƒ‘ãƒƒãƒˆãƒ³ã‚¸ã‚§ãƒ•ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®èŠ¸è¡“</a></li>
<li><a href="../ja459874/index.html">ã‚ãªãŸã¯ä½•ã‹ã‚’éš ã™å¿…è¦ãŒã‚ã‚Šã¾ã™</a></li>
<li><a href="../ja459878/index.html">ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’é«˜é€ŸåŒ–ã™ã‚‹ãŸã‚ã®7ã¤ã®CSSæœ€é©åŒ–ã®ãƒ’ãƒ³ãƒˆ</a></li>
<li><a href="../ja459880/index.html">Linuxã§Firefoxã‚’æ§‹æˆã™ã‚‹</a></li>
<li><a href="../ja459882/index.html">ã€Œãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€ã®éŸ³æ¥½ï¼šãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã‚„ãƒ‘ã‚½ã‚³ãƒ³ã§è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ãƒˆãƒ©ãƒƒã‚¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>