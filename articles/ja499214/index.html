<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏤 👨‍💼 🐈 Hyperledger Fabric 1.4をAWSにデプロイする 🏂🏻 💜 🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabricは、Linux Foundationのオープンソースブロックチェーンプラットフォームです。これを使用して、ブロックチェーンアプリケーションを作成し、ブロックチェーン内のデータへのアクセスと権限を制御できます。プライベートブロックチェーンネットワークを作成する場合、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hyperledger Fabric 1.4をAWSにデプロイする</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabricは、Linux Foundationのオープンソースブロックチェーンプラットフォームです。これを使用して、ブロックチェーンアプリケーションを作成し、ブロックチェーン内のデータへのアクセスと権限を制御できます。プライベートブロックチェーンネットワークを作成する場合、または各サイドが表示できるトランザクションに制限を設定する場合は、ハイパーレジャーファブリックを使用する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabricのドキュメントでは、Dockerを使用して1台のマシンでブロックチェーンネットワークを作成することは十分に計画されており、各ネットワークメンバーは個別のコンテナーです。ただし、複数の物理マシンまたは仮想マシンでネットワークをセットアップするプロセスについては説明していません。これについては、この記事で説明します。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのブロックチェーンアプリケーションは、学校や就学前の子供の医療データを保存するためのサービスです。</font><font style="vertical-align: inherit;">データは変更しないでください。</font><font style="vertical-align: inherit;">それらは、ワクチン接種と特定の医師との患者の同意に関する情報の形で提示されます。</font><font style="vertical-align: inherit;">ネットワークには、Parents（両親の利益を代表する組織）、Hospital（小児科医の両親が子供たちの世話をするための契約を結ぶことができる病院）、Kindergarten（健康レポートと予防接種を要求できる幼稚園）のメンバーが含まれますまたは病院で別の子供）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazonが管理するブロックチェーン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWSにはAmazon Managed Blockchainサービスがあります。</font><font style="vertical-align: inherit;">AWSコンソールのユーザーインターフェイスを使用してブロックチェーンネットワークをデプロイできます。</font><font style="vertical-align: inherit;">しかし、Amazonマネージドブロックチェーンでの作業経験があったため、商用プロジェクトでサービスを使用するという考えを断念する必要がありました。</font><font style="vertical-align: inherit;">これにはいくつかの理由がありました。</font><font style="vertical-align: inherit;">主なものは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabric 1.2のバージョンのみがAmazon Managed Blockchainで利用可能であり、この記事の執筆時点では、エンタープライズブロックチェーンネットワークの構築にはバージョン1.4が使用されています。</font><font style="vertical-align: inherit;">また、Node.js SDKツールの最新バージョンを使用することもできません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AmazonマネージドブロックチェーンはCouchDBデータベースをサポートしていないため、保存されたデータのインデックスを作成するアプリケーションを作成することは困難です。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Hyperledger Fabricフレームワークを使用してネットワークを構築するには、仮想サーバーまたは物理サーバーを使用する方が良いと私たちは考えています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリチャネルについて</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabricには「チャネル」という概念があります。</font><font style="vertical-align: inherit;">チャネルは、機密トランザクションを実行するためのサブネットです。</font><font style="vertical-align: inherit;">このアプリケーションには2つのチャネルがあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Parentshospital」。</font><font style="vertical-align: inherit;">これは、親と病院組織のメンバー間のトランザクションを対象としています。医療記録の作成と変更、小児科医との契約の作成、および小児科医の契約の署名です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Parentshospitalk幼稚園」</font><font style="vertical-align: inherit;">このチャネル内では、Parents and Hospitalのメンバーが幼稚園のメンバーとやり取りします。</font><font style="vertical-align: inherit;">また、医療記録のデータに基づいてレポートが生成されます。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作業環境</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Docker Swarmを使用してブロックチェーンネットワークをデプロイします。これは、ホストクラスターをデプロイするためのネイティブDockerシステムです。 Docker（特にDocker Swarm）を使用したことがない場合は、まずこの製品と、Docker Swarmを使用してコンテナーをオーケストレーションする方法を確認してください。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントには、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同様にこれらのツールでの作業の基本を説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワーク全体がAWS EC2サーバーに配置されます。</font><font style="vertical-align: inherit;">ブロックチェーンネットワーク内の情報はCouchDBに保存されます。</font><font style="vertical-align: inherit;">Hyperledger FabricはLevelDBデータベースもサポートしますが、CouchDBは後者とは異なり、ドキュメントコレクション内の任意の基準で検索できます。</font><font style="vertical-align: inherit;">また、すべての組織とそのユーザーのネットワーク識別子を管理するためのモジュール式コンポーネントであるファブリック認証局を使用します。</font><font style="vertical-align: inherit;">ネットワーク参加者の登録と証明書の発行を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4つのEC2サーバーがあります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文者、MySQL DB（医療記録に適用されないアプリケーション情報を保存するため）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親組織（Peer0、Peer1）、CouchDB、Fabric-CA、CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">病院組織（Peer0、Peer1）、CouchDB、Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼稚園組織（Peer0、Peer1）、CouchDB、Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWSでのEC2サーバーの作成</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機能するにはt2.mediumサービスが必要です。</font><font style="vertical-align: inherit;">このタイプのEC2サーバーには、必要なすべてのソフトウェアをインストールし、Hyperledger Fabricツールを操作するのに十分なコンピューティング能力があります。</font><font style="vertical-align: inherit;">[セキュリティグループの構成]で、[すべてのトラフィック]と[送信元]を0.0.0.0/0、:: / 0に設定します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図1。</font><font style="vertical-align: inherit;">AWSパネルでセキュリティグループを設定します。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4つのEC2サーバーを取得しました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然、EC2サーバーへの独自のパスがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2。</font><font style="vertical-align: inherit;">EC2サーバーの運用用に準備されています。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EC2サーバーへの必須ソフトウェアのインストール</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、各EC2サーバーにDockerとGitをインストールする必要があります。</font><font style="vertical-align: inherit;">便宜上、ターミナルで4つのタブを開きます。</font><font style="vertical-align: inherit;">SSH経由で各EC2サービスに行きましょう：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナル1：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナル2：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナル3：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナル4：</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各ターミナルで、次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、DockerとGitがインストールされました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通信網</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リポジトリからネットワークの要素を複製する必要があります。</font><font style="vertical-align: inherit;">これを行うには、各ターミナルでコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ネットワーク参加者間の関係を規制するリポジトリからスマートコントラクトを複製する必要があります。</font><font style="vertical-align: inherit;">スマートコントラクトはGolang言語で記述されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4つのサーバーのそれぞれで次の手順を実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のターミナルでは、組織をネットワークに接続するためのチャネル構成ファイルと証明書を生成する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、channel-artifactsフォルダーとcrypto-configフォルダーを、ネットワークの親ディレクトリのpoc-networkフォルダーにある他の3つのホストにコピーします。</font><font style="vertical-align: inherit;">注：組織をEC2サーバーにコピーするときは、他の組織の作業に関連するcrypto-config / peerOrganizationsフォルダーからサードパーティの証明書を削除する必要があります。</font><font style="vertical-align: inherit;">たとえば、Parentsホストにコピーするときは、parents.poc-network.comフォルダーをこのフォルダーに残して、hospital.poc-network.comとkindergarten.poc-network.comを削除する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker Swarmスタックの作成</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なる組織に属し、異なるEC2サーバー上にあるコンテナーが相互にアクセスできるようにするには、それらをスタックに結合する必要があります。</font><font style="vertical-align: inherit;">ファイルネットワーク/ poc-network / docker-compose-general.yamlを見てみましょう。</font><font style="vertical-align: inherit;">これには、サービスの構成が含まれ、特定のサービス（キー</font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">がデプロイされるホストを示し</font><font style="vertical-align: inherit;">、エイリアス（キー</font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">が示されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のターミナルでswarmを初期化する必要があります：</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタックに別のEC2サーバーを接続するためのトークンが表示されます。</font><font style="vertical-align: inherit;">ような何か：</font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、残りのターミナルで実行できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールにメッセージが表示されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのホストすべてがSwarmに接続されたら、次のコマンドを実行して、最初のホストのターミナルでそれらを確認できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3。</font><font style="vertical-align: inherit;">Docker Swarm内のサーバーのリスト。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
network / poc-networkフォルダーには、各ホストのホスト名を指定する必要がある.env.templateファイルがあります</font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。.envファイルを生成するには、。/ 3_env_gen.shファイルを実行する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ドライバーでネットワークを作成します</font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swarmを実行して、docker-compose-general.yamlファイルに基づいてスタックを作成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドでは、環境変数も設定します。環境変数は、.envファイルに記述されており、ネットワークが正しく機能するために必要です。</font><font style="vertical-align: inherit;">最初のターミナルで</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンド</font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実行でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">すべてのEC2インスタンスで実行されているすべてのサービスのリストが表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図4。</font><font style="vertical-align: inherit;">すべてのEC2サーバーで実行されていたすべてのサービスのリスト。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルにスクリーンショットと同じものが表示される場合は、すべて問題ありません。</font><font style="vertical-align: inherit;">次に、ネットワークを実行します。</font><font style="vertical-align: inherit;">2番目のターミナルで、CLIコンテナーを入力する必要があります（結局、このコンテナーは2番目のホストにデプロイされます）。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナ名は、ターミナルでコマンドを実行することで確認できます</font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナーでは、4_create_channels.shファイルからすべてのコマンドを実行し、コマンドを1つずつターミナルにコピーします。</font><font style="vertical-align: inherit;">binフォルダーには、ネットワークを作成するためのバイナリーがあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアチャネルの作成-チャネルを作成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアチャネル参加-ピアをチャネルに参加させます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアチャネルの更新-構成の更新。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアチェーンコードインストール-コードコードをインストールします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピアチェーンコードのインスタンス化-指定したチェーンコードをネットワークにデプロイします。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、コマンドを実行してコンテナを離れることができます</font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護者の帰国申請書</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のホストにアプリケーションをインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJSとgcc-c ++（コンパイラー）もインストールする必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々はまた、次の認証データとadminerを通じて当社のデータベースに入力できます</font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ここで、</font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースが保存されている最初のEC2サーバのアドレスである）</font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースへの私たちのAPIアプリケーションを接続することも必要です。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーに正しい値を割り当てます</font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私たちのバックアプリケーションはマイグレーションとシードを準備しました。</font><font style="vertical-align: inherit;">あなたはそれらを実行する必要があります：</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テーブルがデータベースに表示されます。</font><font style="vertical-align: inherit;">組織の表には、両親、病院、幼稚園という3つの行が組織とともに表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に証明書を生成するときに、最初のホストで各組織のネットワークに接続するためのファイルを受け取りました。</font><font style="vertical-align: inherit;">connection-parents.jsonファイルを最初のホストから2番目のホストにコピーします。</font><font style="vertical-align: inherit;">これを行うに</font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、私たち</font><font style="vertical-align: inherit;">が配置さ</font><font style="vertical-align: inherit;">れているフォルダーから別のターミナルを開き</font><font style="vertical-align: inherit;">、コマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（現在のホストの値）を</font><font style="vertical-align: inherit;">
修正</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のターミナルでアプリケーションを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
userGenerator.shファイルで</font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">変数に</font><font style="vertical-align: inherit;">正しい値を</font><font style="vertical-align: inherit;">割り当てます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Parents組織のユーザーを作成するスクリプトを実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトを実行して医療記録を生成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのカードがブロックチェーンに作成され、SQLデータベースのカードテーブルにも書き込まれます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">病院バックアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のバックアプリケーションと同様に、ファイルを3番目のホストのネットワークに接続するために配置する必要があります。</font><font style="vertical-align: inherit;">これを行うには、5番目のターミナルで次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを3番目のホストに複製します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJSとgcc-c ++（コンパイラー）をインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（現在のホストの値）を</font><font style="vertical-align: inherit;">
修正</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のターミナルでアプリケーションを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
userGenerator.shファイルで</font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">変数に</font><font style="vertical-align: inherit;">正しい値を</font><font style="vertical-align: inherit;">割り当てます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、病院組織のユーザーを作成するスクリプトを実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、データベースのUsersテーブルに2番目のユーザーができました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼稚園バックアプリ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のバックアプリケーションと同様に、ファイルを3番目のホストのネットワークに接続するために配置する必要があります。</font><font style="vertical-align: inherit;">これを行うには、5番目のターミナルで次のコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを3番目のホストに複製します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJSとGcc-c ++（コンパイラー）をインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">constants.js（現在のホストの値）を</font><font style="vertical-align: inherit;">
修正</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のターミナルでアプリケーションを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
userGenerator.shファイルで</font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">変数に</font><font style="vertical-align: inherit;">正しい値を</font><font style="vertical-align: inherit;">割り当てます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、病院組織のユーザーを作成するスクリプトを実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、データベースのUsersテーブルに3番目のユーザーができました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目、3番目、4番目のEC2サーバーにwkhtmltopdfをインストールする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックアプリケーションはwkhtmltopdfライブラリを使用して、子供の健康状態に関するPDFレポートを生成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
libpngをインストールする必要があります-PNG形式のラスターグラフィックを操作するための公式ライブラリです。</font><font style="vertical-align: inherit;">ライブラリはプラットフォームに依存せず、C言語で記述された関数で構成されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のチームは、QtWebKitレンダリングエンジンを使用してHTMLをPDFおよびさまざまな画像形式にレンダリングするためのオープンソースLGPLv3ライブラリであるwkhtmltoxをインストールします。</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドの2番目のブロックは、libpng15ライブラリをダウンロードしてデプロイします。</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイラーをインストールするには、コマンドの3番目のブロックが必要です。</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LibTIFFをインストールする必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストできます：</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、PDFドキュメントを生成して表示できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node SDKについて少し</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabricネットワークを操作するためのNodeJSツールは、パッケージ「fabric-ca-client -v 1.4.0」および「fabric-network」v 1.4.0の形式で提供されます。</font><font style="vertical-align: inherit;">Node SDKを使用してネットワークと対話するバックエンドアプリケーションのすべてのサービスは、プロジェクトのルートにあるServicesフォルダーにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのツールとその方法については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式ドキュメントをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションビジネスプロセス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このアプリケーションでのネットワークメンバーの相互作用について説明します。</font><font style="vertical-align: inherit;">すべてのプロセスはUMLダイアグラムで記述されます。</font><font style="vertical-align: inherit;">それぞれについて詳しく見ていきましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図5。アプリケーションのビジネスプロセスのグラフィカルな説明。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
したがって、ネットワークにはいくつかの組織があります。保護者、病院、幼稚園です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
保護者のメンバーは、2人の子供のために電子健康記録を作成します。このデータは、ブロックチェーンネットワークに保存（および補足）されます。次に、親は小児科医との合意のリクエストを送信し、小児科医は子供が成人になるまで観察します（図</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、医師との合意のリクエスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
病院組織のメンバーが契約に署名します（図では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医師が契約に署名します</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、親は子供を登録するためのリクエストと共に幼稚園にリクエストを送信します（図では</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、幼稚園が子供を受け取るためのリクエスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図6。</font><font style="vertical-align: inherit;">保護者のアカウントで利用可能な教育機関のリストが記載されたページ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幼稚園は、新しい要求のリストで要求を確認します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図7。</font><font style="vertical-align: inherit;">教育機関の個人アカウントへの入学申請のリストがあるページ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
子供の入院を決定する前に、幼稚園は彼の満足な健康状態を確認する必要があります。</font><font style="vertical-align: inherit;">これを行うために、幼稚園はこの子が観察されているクリニックにリクエストを送信します（図では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子の健康レポートのリクエスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">小児科医へのリクエストは、庭園への​​入場のリクエストが「承諾済み」タブに移動した後に自動的に実行されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図8。</font><font style="vertical-align: inherit;">教育機関の個人アカウントへの入学が承認された申請のリストが記載されたページ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小児科医はリクエストを見て、子供の健康に関するデータを含むレポートを生成します（図では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子供の健康レポートの作成</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図9。</font><font style="vertical-align: inherit;">病院の個人アカウントで子供の健康状態に関するレポートを作成するためのアプリケーションのリストがあるページ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
親は、小児科医がレポートを作成したことを確認します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図10。</font><font style="vertical-align: inherit;">お子様の健康状態に関するレポートのステータスを表示する、保護者の個人アカウントのページ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そして、レポートを表示およびダウンロードするために就学前教育機関へのアクセスを許可することを決定します（図で- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポートの表示を許可します</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図11。</font><font style="vertical-align: inherit;">生成された医療レポートを表示できる教育機関を選択するためのポップアップウィンドウ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
保護者が[確認]をクリック：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図12。</font><font style="vertical-align: inherit;">選択した教育機関が医療レポートを表示する許可を受け取ったという通知。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
教育機関のアプリケーションのレポートのリストに、レポートが生成され、PDF形式で表示およびダウンロードできるという情報が表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図13。</font><font style="vertical-align: inherit;">承認されたアプリケーションに沿って、レポートをPDF形式でダウンロードするためのリンク。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、コンピュータの新しいタブに表示されるレポートです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図14。</font><font style="vertical-align: inherit;">病院の従業員が作成した健康レポート。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医療記録の作成と小児科医との契約、契約書への署名</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションは個別のEC2サーバーへのネットワークの配置を示すように設計されているため、準備されたスクリプトからいくつかのコマンドを実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のEC2サーバー：</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前にデータベースに接続しました。</font><font style="vertical-align: inherit;">コマンドを実行すると、カードテーブルに2つのエントリが表示されます。</font><font style="vertical-align: inherit;">また、これらの2人の子供の医療データに関する情報がブロックチェーンに記録されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このEC2サーバーから、子供を観察する小児科医との合意を作成する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、この同意書は、組織Hospitalのために作成したユーザーが署名する必要があります。</font><font style="vertical-align: inherit;">2番目のホストからコマンドを実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの契約は医師によって署名されており、私たちは申請に取り組み続けることができます。</font><font style="vertical-align: inherit;">次に、2番目、3番目、4番目のEC2サーバーにフロントエンドアプリケーションをインストールする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS：ユーザー、カード、契約、署名契約を生成するためのすべてのコマンドは、〜/ back / generatorsフォルダーにあります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">親フロントエンドアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のホスト（Parents組織が配置されている場所）で実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
.envファイルを作成し、フロントエンドアプリケーションを配置するホスト名を指定します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係を確立する必要があります：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、アプリケーションをビルドして、ポート8080で実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのアプリケーションは次の</font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場所で</font><font style="vertical-align: inherit;">入手できます：</font><font style="vertical-align: inherit;">ここ</font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、アプリケーションが配置されている2番目のEC2サーバーのアドレスです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログイン：</font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワード：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがフロントエンドの外観です。</font><font style="vertical-align: inherit;">ここでは、ターミナルから作成した医療カードに関する情報が表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図15。</font><font style="vertical-align: inherit;">親の個人アカウントにある子供の医療記録に関する情報。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">病院のフロントエンドアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のホスト（病院組織が配置されている場所）で実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
.envファイルを作成し、フロントエンドアプリケーションを配置するホスト名を指定します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係を確立する必要があります：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、アプリケーションをビルドして、ポート8080で実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのアプリケーションは、次の</font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場所で</font><font style="vertical-align: inherit;">入手でき</font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。は、3番目のEC2サーバーのアドレスです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログイン：</font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワード：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幼稚園のフロントエンドアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のホスト（幼稚園組織がある場所）で実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
.envファイルを作成し、フロントエンドアプリケーションを配置するホスト名を指定します。</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係を確立する必要があります：</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、アプリケーションをビルドして、ポート8080で実行する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのアプリケーションは、次の</font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場所で</font><font style="vertical-align: inherit;">入手でき</font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。は、4番目のEC2サーバーのアドレスです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログイン：</font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワード：</font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複数の仮想サーバーまたは物理サーバーにブロックチェーンアプリケーションのネットワークをデプロイする方法を検討しました。</font><font style="vertical-align: inherit;">この記事は、ブロックチェーンテクノロジーの基本に精通し、スマートコントラクトが何であるかを理解し、Hyperledger Fabricフレームワークとその標準のファブリックサンプルアプリケーションに少なくとも表面的に精通していることを保証するように設計されています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja499202/index.html">Opium.Fill-プログラマの目による配色の標準化</a></li>
<li><a href="../ja499206/index.html">仮想アシスタント。プログラミングなしでチャットボットを作成する</a></li>
<li><a href="../ja499208/index.html">4月27日から5月3日までのモスクワでのデジタルイベント</a></li>
<li><a href="../ja499210/index.html">4月27日から5月3日までのサンクトペテルブルクでのデジタルイベント</a></li>
<li><a href="../ja499212/index.html">IBMウィークリーセミナー-2020年4月</a></li>
<li><a href="../ja499216/index.html">システムレベルでの設計。パート2.詳細なアーキテクチャ</a></li>
<li><a href="../ja499220/index.html">コロナウイルスによる開発者のリモートサイトへの転送により、GoogleおよびMicrosoftの生産性が向上しました</a></li>
<li><a href="../ja499224/index.html">正しい学習を始める時が来ました</a></li>
<li><a href="../ja499226/index.html">パンデミックなし：暗号通貨についての映画を1000ドルで作成し、米国で最高の映画配給を獲得する方法</a></li>
<li><a href="../ja499230/index.html">健康な内容のワームを育てる方法：1910年のマニュアルを解析する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>