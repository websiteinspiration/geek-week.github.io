<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§Ωüèª üî≥ üë®‚Äçüé® Como criar um modelo de transporte multi-agente üë®üèæ‚Äçüîß üåÖ üïé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! 
 
 Imagine que temos a tarefa de construir uma nova estrada. Voc√™ pode construir uma estrada com duas faixas em cada dire√ß√£o, mas e se isso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como criar um modelo de transporte multi-agente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494596/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ol√° Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine que temos a tarefa de construir uma nova estrada. Voc√™ pode construir uma estrada com duas faixas em cada dire√ß√£o, mas e se isso n√£o for suficiente? Ou, pelo contr√°rio, acontece que uma faixa seria suficiente, mas para a implementa√ß√£o do projeto era necess√°rio comprar muitos terrenos? Nos dois casos, a decis√£o ser√° ineficaz. Para minimizar esses riscos, os planejadores de transporte recorrem √† modelagem computacional para obter ajuda. Este artigo √© uma breve digress√£o para o mundo da modelagem multiagente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/k0/kj/bqk0kjbb814y7q7twu1uvqk3yf4.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando o modelo, que √© uma c√≥pia do sistema de transporte real, √© poss√≠vel estimar a taxa de transfer√™ncia necess√°ria em cada trecho da estrada projetada, experimentar diferentes op√ß√µes de rastreamento ou, por exemplo, estimar o per√≠odo de retorno de um projeto, se for uma estrada com ped√°gio na estrutura de uma parceria p√∫blico-privada. Mas outras tarefas importantes podem ser resolvidas: como organizar as melhores rotas de transporte p√∫blico e calcular a receita potencial dos operadores, como avaliar a presen√ßa de uma escassez de vagas em uma √°rea espec√≠fica e muitas outras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mais interessante √© que qualquer pessoa pode construir um modelo semelhante na era do software livre! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das ferramentas de modelagem multiagente mais comuns √© o c√≥digo aberto.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim (Simula√ß√£o de Transporte Multi-Agente)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O MATSim simula o comportamento de agentes individuais. Um agente √© uma representa√ß√£o por computador de um indiv√≠duo no mundo real. Cada um desses agentes possui um plano di√°rio, com base no qual ele se move de uma atividade para outra (por exemplo, casa-trabalho-casa, casa-instituto-trabalho-casa, casa-loja-trabalho-trabalho-casa-2 etc.), criando portanto, a demanda por infraestrutura rodovi√°ria. Uma representa√ß√£o esquem√°tica do plano di√°rio √© mais ou menos assim:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/xt/m_/n6xtm_ps8u0stk6f8doybvsxzq8.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar planos realistas de agentes que refletir√£o o comportamento real das pessoas durante o dia, s√£o levados em considera√ß√£o o n√∫mero total de residentes de agentes, seus reassentamentos, locais de trabalho, estudo, localiza√ß√£o de lojas, shopping centers, esta√ß√µes de trem e outros locais de atividade. Para validar a demanda, o modelo tamb√©m √© calibrado com base em pesquisas de campo: reconhecimento e c√°lculo dos fluxos de c√¢meras de vigil√¢ncia e drones usando uma rede neural ou, por exemplo, medi√ß√µes manuais de intensidade nas estradas.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/t-/ke/0xt-kelsnwf39k3mmu2saye2zky.gif" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante a simula√ß√£o, os agentes s√£o distribu√≠dos pela rede, imitando o comportamento realista das pessoas: implementando seu plano, os carros ocupam um lugar na estrada e nos estacionamentos, os usu√°rios de transportes p√∫blicos tomam lugares no √¥nibus e tamb√©m interagem entre si e, se muitos agentes selecionam uma estrada por vez, engarrafamentos e congestionamentos s√£o criados. Tudo √© como no mundo real! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a conclus√£o da simula√ß√£o, √© feita uma avalia√ß√£o do cumprimento dos planos di√°rios dos agentes, chamados de pontua√ß√£o. O agente adquire unidades de servi√ßo p√∫blico no processo de atividade e as perde durante o movimento. Consequentemente, os agentes presos em um engarrafamento perdem mais unidades de servi√ßos p√∫blicos do que os agentes que se deslocam pelas estradas livres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s cada itera√ß√£o, alguns agentes reconstroem seu plano com base em informa√ß√µes sobre a carga da rede rodovi√°ria de maneira a melhorar seu desempenho: os agentes podem alterar a hora de partida, o modo de transporte ou a rota. </font><font style="vertical-align: inherit;">Os demais agentes seguem seus planos anteriores, que s√£o armazenados na mem√≥ria do programa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Idealmente, ap√≥s a simula√ß√£o, um equil√≠brio de Nash deve ser alcan√ßado - isto √©, uma situa√ß√£o em que nenhum agente pode melhorar sua posi√ß√£o sem piorar a posi√ß√£o de outros agentes. </font><font style="vertical-align: inherit;">Geralmente, essa √© a situa√ß√£o que se desenvolve ao longo do tempo nas estradas da cidade, dada a repensa√ß√£o di√°ria da experi√™ncia do dia anterior por seus moradores. </font><font style="vertical-align: inherit;">Para isso, s√£o realizadas pelo menos 200 itera√ß√µes no quadro de um cen√°rio. </font><font style="vertical-align: inherit;">Todo o ciclo de trabalho do MATSim √© mais ou menos assim:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/zv/ds/mrzvds3njmsli5hbkiqvzhnuoju.png" alt="imagem"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Da teoria √† pr√°tica! </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para executar o primeiro cen√°rio, precisamos do Intellij IDEA (ou Eclipse) com Java 1.8 integrado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abrimos o IDE, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clonamos o reposit√≥rio MATSim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no github e nosso primeiro cen√°rio est√° pronto para ser executado! </font><font style="vertical-align: inherit;">T√£o simples. </font><font style="vertical-align: inherit;">Mas vamos primeiro ver quais arquivos de entrada usamos. </font><font style="vertical-align: inherit;">Para a simula√ß√£o mais simples, existem tr√™s deles: rede, planos, configura√ß√£o.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O arquivo de rede √© a rede na qual os agentes se movem. </font><font style="vertical-align: inherit;">Consiste em n√≥s e n√≥s / links. </font><font style="vertical-align: inherit;">Cada link possui atributos diferentes: tipo, comprimento do segmento, taxa de transfer√™ncia, velocidade m√°xima, n√∫mero de faixas, tr√°fego unidirecional, modos de transporte permitidos, etc. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_n/5p/rx/_n5prxnenyiuei82fndy2uekigy.jpeg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Criar uma grade da cidade manualmente √© dif√≠cil, impratic√°vel e ineficiente. </font><font style="vertical-align: inherit;">Por exemplo, nossa grade de S√£o Petersburgo consiste em 26 mil n√≥s e 46 mil links. </font><font style="vertical-align: inherit;">Mas h√° boas not√≠cias. </font><font style="vertical-align: inherit;">A grade pode ser convertida do OpenStreetMap e editada usando o JOSM, que tamb√©m √© de c√≥digo aberto.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planos</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O arquivo de planos √© uma representa√ß√£o estruturada dos planos di√°rios dos agentes. </font><font style="vertical-align: inherit;">No cen√°rio inicial, temos 100 agentes que saem de carro (mode = ‚Äùcar‚Äù) pela manh√£ (end_time = ‚Äù05:59‚Äù) de casa (tipo = ‚Äùh‚Äù, link = ‚Äù1‚Äù) para trabalhar (tipo = "W", link = "20"), ap√≥s o qual, ap√≥s algum tempo (dur = "02:30"), eles retornam para casa.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8g/vh/sp/8gvhsph0hfmjwzpfspy0liqv7xo.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Config</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, no arquivo de configura√ß√£o, todas as configura√ß√µes necess√°rias s√£o definidas para executar o script. </font><font style="vertical-align: inherit;">O MATSim consiste em m√≥dulos que voc√™ pode personalizar, adicionar ou remover conforme necess√°rio. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muitas das configura√ß√µes no arquivo de configura√ß√£o s√£o intuitivas, mas voc√™ tamb√©m pode sempre pesquisar as chamadas. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Livro MATSim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Agora vamos considerar apenas dois m√≥dulos.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No m√≥dulo planCalcScore, os par√¢metros de pontua√ß√£o s√£o definidos: por exemplo, para chegadas tardias, o agente recebe uma multa de 18 unidades. </font><font style="vertical-align: inherit;">utilidade por hora (respectivamente, atrasar-se por 10 minutos equivale a perder 3 unidades de utilidade); </font><font style="vertical-align: inherit;">o desempenho de alguma atividade (por exemplo, desempenho) traz 6 unidades utilit√°rias por hora e dirigir um carro custa as mesmas 6 unidades utilit√°rias por hora.Para encontrar par√¢metros de pontua√ß√£o realistas, as pesquisas de opini√£o costumam ser usadas para analisar o "custo" tempo.‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
no m√≥dulo de estrat√©gia, os par√¢metros de re-planejamento s√£o configurados, por exemplo, qual a percentagem de agentes (ModuleProbability) vai tentar a nova rota (redirecionar) durante a pr√≥xima itera√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/jf/yo/dcjfyoldbtrsg_zgrydyrrkc6ce.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, o objetivo da simula√ß√£o √© ajudar o get agente do ponto a ao ponto B com o menor custo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execu√ß√£o de script</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hora de abrir o RunMatsim runner e executar nosso primeiro script! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os resultados da simula√ß√£o estar√£o na pasta de sa√≠da na raiz do projeto. Os principais arquivos de visualiza√ß√£o s√£o rede e eventos. O arquivo de eventos cont√©m informa√ß√µes por segundo sobre todas as a√ß√µes de cada agente; portanto, com base nesse arquivo, voc√™ pode restaurar a imagem completa do movimento de todos os agentes. Voc√™ pode visualizar os resultados usando a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Via</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resultados mais representativos, aumentarei o n√∫mero de agentes para 500. √â assim que a distribui√ß√£o de 500 agentes se parece ap√≥s a primeira itera√ß√£o ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/by/o3/zk/byo3zk14bt0yj1y7od2sth35nok.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No in√≠cio da itera√ß√£o, os agentes calcularam o caminho mais curto usando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dijkstra</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, a intensidade do tr√°fego em uma se√ß√£o da rede excedeu sua taxa de transfer√™ncia, um congestionamento se formou. </font><font style="vertical-align: inherit;">Mas e se voc√™ lhes der a oportunidade de tentar rotas diferentes? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7l/_j/5_/7l_j5_q_n2g3roivtbnht8iwqfq.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s 200 itera√ß√µes (~ 5 minutos), os agentes foram redistribu√≠dos pela rede, o n√≠vel de carga do link agora n√£o excede 0,5 e o tempo m√©dio de viagem para todos os agentes diminuiu 14% (5 minutos). </font><font style="vertical-align: inherit;">Viva, superamos a corti√ßa! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ah, se fosse assim t√£o simples! </font><font style="vertical-align: inherit;">Na realidade, os sistemas de transporte s√£o muito mais complicados. </font><font style="vertical-align: inherit;">Nos artigos a seguir, vou contar como participei do desenvolvimento de modelos de S√£o Petersburgo e outras cidades e como resolvemos problemas pr√°ticos em casos reais. </font><font style="vertical-align: inherit;">Scientia potentia est! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/v-/t0/cjv-t0plurhha0_szf4vhthcubo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Postado por Andrey Kolomatsky, analista de transporte da OTSLab.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt494580/index.html">Fractais na areia, ou mais de tr√™s n√£o recolhem</a></li>
<li><a href="../pt494582/index.html">A Microsoft n√£o emitir√° mais certificados MCSE / MCSD / MCSA</a></li>
<li><a href="../pt494586/index.html">Programa√ß√£o funcional como exemplo de trabalho com matrizes da teoria da √°lgebra linear</a></li>
<li><a href="../pt494590/index.html">Coronav√≠rus - a apoteose do p√¢nico</a></li>
<li><a href="../pt494592/index.html">Laser de vapor de mangan√™s caseiro</a></li>
<li><a href="../pt494598/index.html">Pesquisadores de Stanford desenvolveram um exoesqueleto para correr</a></li>
<li><a href="../pt494600/index.html">Criando um bot simples do Discord usando a biblioteca discord.py</a></li>
<li><a href="../pt494604/index.html">Caixa de esteriliza√ß√£o UV para reutiliza√ß√£o de m√°scaras descart√°veis</a></li>
<li><a href="../pt494606/index.html">Como observar a lua e os planetas</a></li>
<li><a href="../pt494608/index.html">Preparando-se para Ludum Dare</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>