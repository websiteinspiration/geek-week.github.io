<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôáüèº üë®üèº‚Äç‚öïÔ∏è üà∑Ô∏è How parking sensors work and how to trick him üßúüèæ üóª ü¶å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One fine day ... Why am I lying? The day when my Russian-Chinese parking sensors installed by the previous owner died was not so beautiful. Something ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How parking sensors work and how to trick him</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487626/"><img src="https://habrastorage.org/webt/ql/xd/et/qlxdet7xjqebjp5t40yxluivlo8.png" alt="image" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One fine day ... Why am I lying? The day when my Russian-Chinese parking sensors installed by the previous owner died was not so beautiful. Something needs to be done, but what? Buy another finished product on any online platform? Not interested. On the network, and on the hub, there is a sufficient amount of materials </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the reverse of the protocol for communicating the block with the indicator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on creating your own parking sensors on Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . And you can go one of these ways. But this is not what the soul desired. And she wanted something more full-time, close in execution to automotive electronics.</font></font><br>
<a name="habracut"></a><br clear="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is no secret to anyone that the performance and circuitry of automotive electronics is somewhat different from household electronics, as is its electronic components. I wanted something like this, "real." On this day, the idea arose to introduce a conditionally native parking sensors. At least parking sensors, which were put on cars at the factory or at least on the way from the factory to the end user. And since I have a Toyota now, and a middle-aged Toyota is usually Denso electronics, it was decided to collect parking sensors on what official and not-so-dealers set up to create "new" Toyota cars. Once it was a factory set of additional equipment, the installation and operation of which is fairly well documented by the manufacturer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The choice fell on the Denso 188100-2410 block, as the most common. I already knew that the block requires six sensors (4 angular and 2 rear), but I was not going to put 2 angular front ones and realized that the block would violently resist the absence of the front pair (the corresponding errors were described in the documentation). But what seemed easier? How can he detect the lack of sensors? Yes, except for the load resistance, I thought, it‚Äôs okay - throw him the resistors for emulation. And the search for the kit began.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some time passed and the set of the unit, wiring and sensors was evenly laid out on the floor of the workshop, all the connections were made, here it is - a joyful moment of the first inclusion. </font><font style="vertical-align: inherit;">And, quite expectedly, he swears at the lack of sensors. </font><font style="vertical-align: inherit;">Instead of missing sensors, I throw in resistors with the thought, "Well, what can he do there, except to measure the current consumption." </font><font style="vertical-align: inherit;">But different reasonable values ‚Äã‚Äãof resistors do not affect the unit, and it continues to vote on the absence of sensors. </font><font style="vertical-align: inherit;">Nezhdanchik. </font><font style="vertical-align: inherit;">Quick googling did not give an answer to my questions, which was the reason for writing this article.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How parking sensors work</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I think the general idea is completely obvious to anyone with a technical background. The unit generates a packet of pulses whose frequency is in the ultrasonic range. Well, in order not to shock with the sounds of people around, and developers, as a rule, do not think about bats, dolphins and other more advanced organisms. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g_/dt/fo/g_dtfogwkpy9u_0chvh0klmpqpk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since there are several sensors and the distance for each of them is estimated separately so as not to catch the reflections of the signals emitted by the neighboring sensors, the pulse packets for them are spaced in time. Only two front corner signals are shown. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e1/5l/2j/e15l2jjjqjlk6ymsqm0ocx9muxa.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After sending the pack, the unit waits for reflection and, guided by the propagation time, estimates the distance to the obstacle.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ql/xd/et/qlxdet7xjqebjp5t40yxluivlo8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The oscillogram shows a reflected burst of pulses 1 after approximately 1.3 ms, which at a speed of sound propagation of 330 m / s gives approximately 430 mm, that is, with acceptable accuracy it corresponds to twice the distance to the object under experimental conditions (about 20 cm per eye). </font><font style="vertical-align: inherit;">But what else is visible on this waveform? </font><font style="vertical-align: inherit;">If a sensor is connected, then immediately after the burst of pulses generated by the unit, there is an echo 2. And if the sensor is not connected, then the first waveform in the text shows that this local echo is absent. </font><font style="vertical-align: inherit;">As it turned out, it‚Äôs from this echo that the unit determines the presence and conditional health of the sensor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to trick him</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well now everything is clear and obvious, let's start. We need to form an echo of approximately known amplitude and approximately known duration. This should be done as simple as possible, cheaper, so that immediately through two channels, and so that there is no need for additional power (so that the connection completely repeats the native sensors). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here came to mind such a scheme (image clickable) on a couple of channels on one of the cheapest microcontrollers. </font><font style="vertical-align: inherit;">
In the diagram, it seems to me, everything is quite obvious and understandable, if someone has questions or suggestions, you are welcome to comment.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/h_/c_/ja/h_c_jaq3b8o1h33hmpwzpl8kova.png" alt="image"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Because it‚Äôs not comme il faut to put something on breadboards and wires into a car, and our Chinese friends (God grant them health and strength in the fight against the virus) make boards so easily, quickly, conveniently and inexpensively, it was designed and ordered, on one of the famous sites, the board. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u1/m-/85/u1m-85vv6edmtocobk-iacltiiu.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was quickly assembled from improvised materials and in the evening a simple firmware was written that implements echo generation through two channels. At this point, an attentive reader will ask: ‚ÄúBut what about the requirements for components and the performance of automotive electronics?‚Äù </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Yes, they are not respected, I made the most out of what was possible at home. Or not the maximum? Your opinion? What could be done better? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the result of the work of this "simulator":</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yk/yu/8j/ykyu8j9p7nfpjyy-bmxv0mojgno.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS The unit calmed down and no longer requires the missing sensors to be connected, and the whole set is waiting for the warm days for installation.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487610/index.html">RealWorld: aiohttp, Tortoise ORM</a></li>
<li><a href="../en487612/index.html">Easily add, delete and rename files and goals in CMake projects</a></li>
<li><a href="../en487616/index.html">Creating a custom item using an example table in C # for Windows Form</a></li>
<li><a href="../en487620/index.html">Problem solving with pwnable.kr 27 - tiny_easy. Understanding Stack Spraying</a></li>
<li><a href="../en487622/index.html">–ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö</a></li>
<li><a href="../en487628/index.html">Diagnosis of aging based on 9 hallmarks of aging signs</a></li>
<li><a href="../en487630/index.html">The Simplest Algorithm for Creating a Field Puzzle (Part 1)</a></li>
<li><a href="../en487632/index.html">‚ÄúColleagues, breathe more quietly‚Äù: why office noise drives us crazy - we discuss research</a></li>
<li><a href="../en487636/index.html">APIs for which it‚Äôs finally worth upgrading from Java 8. Part 2</a></li>
<li><a href="../en487638/index.html">HighLoad ++, Mikhail Tyulenev (MongoDB): Causal consistency: from theory to practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>