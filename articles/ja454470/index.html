<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😣 🛥️ 🧚🏾 実行前の生活。Yandexレポート 🏖️ 📖 🖇️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大規模なプロジェクトでは、アプリケーションのフロントエンドコードの違いによってエンドユーザーの変更を特定するタスクが発生する場合があります。Yandex.Market Nikita Sidorov @nickshevrの開発者は、Diffectorライブラリを使用してこの問題をどのように解決したか、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>実行前の生活。Yandexレポート</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/454470/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大規模なプロジェクトでは、アプリケーションのフロントエンドコードの違いによってエンドユーザーの変更を特定するタスクが発生する場合があります。</font><font style="vertical-align: inherit;">Yandex.Market Nikita Sidorov @nickshevrの開発者は、Diffectorライブラリを使用してこの問題をどのように解決したか、Node.jsアプリケーションでのモジュールグラフの構築と分析、およびコードが起動される前のコードの欠陥の発見について話しました。</font><font style="vertical-align: inherit;">
-今日、私はあなたとできるだけ率直であるよう努めます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/qw/uu/uy/qwuuuy_de8impvpifwc9qdflrka.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私はYandex.Marketで1年半ほど働いています。</font><font style="vertical-align: inherit;">私は同じ量のWebをやっていて、自分自身の変化に気づき始めました。それらにも気づくことができます。</font><font style="vertical-align: inherit;">私の平均的な髪の長さが増加し、ひげが現れ始めました。</font><font style="vertical-align: inherit;">そして、あなたが知っている、今日私は私の同僚を見ました：Sergei Berezhnoyで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veged</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Vova Grinenko </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タダトゥタ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そして私は気づきました-これは私が本当のフロントエンド開発者としてほぼ成熟したという事実の良い基準です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてこの母性に来て、私はあなたと人生について、私たち全員が参加している人生について話すことにしました。主に実行前の生活についてです。これから何が起こるかを説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/-_/bm/cy-_bmshiyn9hj20-9dbgekd7fo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人生はどうですか？もちろん、コードの寿命について。コードは私たちがすることです。思い出させてください、私はここであなたと誠実であると決めたので、最初のスライドはできるだけシンプルでした。私は真実、最初の段階を採用しました-養子縁組、そうですね、誰もこの公理に異議を唱えることはないでしょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p5/si/5n/p5si5n0oneks__xee8nrdwtfbt8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それを変更しなければならないことに気づきました。ある種の要件の受け入れとしましょう。すべてのコードは、タスクを見て、設定された要件を受け入れようとするという事実から始まります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kv/g0/qx/kvg0qxlxoatcyd7mtxhhcbhvsqa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、もちろん、書き込みの段階に入ります。つまり、コードを記述します。次に、テストでカバーし、その有効性を自分で確認します。その後、すでにアプリケーションがコード全体で機能するかどうかを確認します。その後、テスターに​​渡します-確認させてください。その後どう思いますか？思い出してください、実行前の人生。ランタイムはこれに従うと思いますか？実際、このようになります。そして、これはプレゼンテーションの間違いではありません。チェックのどの段階でも非常に頻繁に-そして私が示したよりもはるかに多くのことがあり得ます-再度書き込むためにgoto呼び出しが必要になる場合があります。そうですね、これはかなり大きな問題になる可能性があります。これにより、本番環境で一部の機能の配信が遅くなる可能性があります。また、チケットがハングアップするため、原則として、開発者としての作業が遅くなる可能性があります。そして、ここですべてが通過します。 N回のチェックにはさらにM回あります。その後、コードはブラウザでユーザーに到達します。しかし、これが私たちの目標です。私たちの目標は、ユーザーが実際に利用でき、実際にユーザーの利益のために機能するコードを記述することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日は最初の部分について話します。以前に起こったことについてですが、実際にはテストについてではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cd/lo/of/cdlooffg2v4i0j6gmel3c16g0r8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみにこんな感じです。私はトラッカーで順番を取り、自分のものを収集し、中央値をカウントしました。私のチケットは、チェックよりも開発がはるかに少ないことがわかりました。そして、ご存知のように、テストが長くなるほど、gotoが最初に表示されるか、最後に表示される可能性が高くなります。これはまったくしたくありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、注意してください。スライドには、開発（これは私たち、開発者が行っていることです）と検証（私たちはこれを行っていますが、テスターも行っています）という2つの単語があります。したがって、問題は実際にはテスターに​​関連しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/sc/qc/fmscqcprnl87tudqe7yqg1p9nky.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目標はかなり平凡です。一般的に、私は人生を単純化する必要があると言いたいです。私たちはすでにあなたとたくさん仕事をしています。目標はこのようなものですが、認める必要があります。それは一時的なものであるため、目標が依存する可能性のあるいくつかの基本的な基準を強調しておきましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、コードが少ないほど、それは私たちにとってより簡単になります。 CIチェックの速度が速ければ速いほど、私たちが正しいかどうかをすぐに認識できます。つまり、ローカルでは、通常は永久に開始されます。検証速度-これはテスターに​​直接適用されます。アプリケーションが大きく、全体をチェックする必要がある場合、これは膨大な時間です。リリース速度はこれすべてに依存します。すべてのチェックに合格し、コードが目的のものであることを理解するまで、リリースを含めることは不可能です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが話しているいくつかの問題を解決するために、プログラミング言語でモジュールの依存グラフを分析しましょう。そして、実際にそれを説明しましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cm/ry/c-/cmryc-ofgxh240_-rjepob2g3ui.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフは方向付けられています。方向のあるエッジがあります。グラフのノードには、話している言語のモジュールのみが含まれます。リブは特定の種類の結合です。通信にはいくつかのタイプがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7h/2a/ob/7h2aobcl3tntwcoton3qr5qmaoo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ささいな例を見てみましょう。ファイルAがあります。ここでは、ファイルBから何かがインポートされます。これがノード間の関係です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mn/xn/vb/mnxnvbajewbedo_drzafbppqnda.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
importをrequireに置き換えても同じことが起こります。実際、すべてがそれほど単純ではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fl/1x/ub/fl1xub0n5kpjz6nh3ais7trybk4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
依存関係のタイプについて話しているので、少なくとも2つのタイプを検討することをお勧めします-パイプラインを高速化するためと、グラフの走査を高速化するため依存モジュールだけでなく、依存モジュールも監視する必要があります。モジュールA-親、B-子を呼び出すことを提案します。リンクを常に二重リンクリストとして保持することをお勧めします。これはあなたの人生を簡素化します、私は事前にお知らせします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフをどうにかして説明したら、それをどのように作成するかについて合意しましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/ir/lf/oiirlfsr0tciu_thxadfismnutm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの方法があります。同じAST（抽象構文ツリー）または正規表現を使用した、お気に入りのプログラミング言語でのお気に入りのツール。ここでの利益は何ですか？ここであなたは誰にも縛られていませんが、同時にすべてを自分で実装する必要があります。それが別のCSSコレクターであるかどうかにかかわらず、使用するすべてのものとテクノロジーのすべてのタイプの接続を記述する必要があります。しかし、あなたにはいわば飛行の完全な自由があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、2番目のオプション、私はそれも少し宣伝します。これは、既にビルドシステムを構成しているほとんどの人のためのオプションです。事実、デフォルトでは、アセンブリシステムは設計に応じてグラフを収集します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/gk/wk/xcgkwkeunrz5vi_eri49mqub7c0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandexで最も人気のあるアセンブリシステムの1つを見てみましょう。これはWebpackです。ここでは、webpackの結果全体を別のファイルに収集する方法の例を示しました。このファイルは、私たちまたは他のアナライザーに送ることができます。彼はASTの助けを借りてそれを収集し、どんぐりライブラリを使用しています。何かが落ちたときに彼女に気づいたかもしれません。わたしは気付いた。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして利点は何ですか。実際のところ、ビルドシステムを説明するときに、絶対に正直にエントリを尋ねました。これらは、依存関係の巻き戻し元のファイルであり、バイパスの開始点です。もう一度録音する必要がないので、これは良いことです。さらに、webpackとbabel、およびこれらすべて、およびドングリを含む、それはまだ維持されていません。したがって、言語のあらゆる種類の新機能、すべての種類のバグ、その他すべてが、特に非常に大規模なチームを持っていない場合よりも早く修正されます。はい、たとえそれが大きくても、オープンソースほど大きくはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、これはプラスとマイナスの両方です。そんな両刃（両刃の剣）が得られるようなものです。実際には、このグラフはアセンブリ中に作成されます。これは良いことです。つまり、プロジェクトをアセンブルし、アセンブル結果をすぐに再利用できます。しかし、プロジェクトを組み立てたくないが、このグラフを取得したいだけの場合はどうでしょうか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして実際には、そのような大きなマイナスです。カスタムのものが接続されている場合、接続については後で詳しく説明しますが、ビルドシステムではこれを実行できません。または、Webpackプラグインなど、これを統合する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x0/c4/ye/x0c4yefpe8-w1hgcfeit-n50v8g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
具体的な例を考えてみましょう。 3つのファイルしかない投影でコマンドを実行し、この出力を取得しました。そして、これはモジュールと呼ばれる1つのキーだけを示しています。モジュールの依存関係グラフについて話しているだけなので、モジュールを見て、すべてが論理的です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d_/ky/58/d_ky58s8cbrozt6bzoohxfzvzea.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
かなり多くの情報ですが、すべてが必要なわけではありません。いくつかのポイントを残して、それらについて話し合いましょう。最初のモジュールを考えてみましょう。彼には名前があり、理由があります。その理由は、実際には「依存」モジュールとの接続にすぎないため、このモジュールを自分自身にインポートする人がいることがわかります。これは、グラフを作成するための基本データです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ld/of/e3/ldofe3q3cyna7bav1ltegf1zwyw.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、usedExportsとprovidedExportsにも注意してください。それらについては少し後で話します。しかし、これらも非常に重要なことです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ld/of/e3/ldofe3q3cyna7bav1ltegf1zwyw.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/me/db/80/medb80ytkohl1ee0ryh-zaoubak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、あなたの決定を説明するなら、モジュール間に存在する接続のタイプについて話す必要があります。つまり、もちろん、言語内にモジュールのシステムがあります。それがcjs-modulesでも、esm-modulesでもかまいません。さらに、ファイルシステム自体のレベルで、ファイルシステム内のファイル間の接続がある場合があることに同意する必要があります。これらは、ある種のフレームワークです。ある種のフレームワークは、パパの状態によって異なります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9k/cz/hv/9kczhv-gdxjdxwomdj7czjeuqxk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、そのような卑劣な例-Nodeのサーバー側を作成した場合、Configのような人気のあるnpmパッケージを目にすることがよくあります。これにより、構成を非常に便利に定義できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4d/94/oz/4d94ozf6xvfugnjkxvnsuylgnq4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを使用するには、NODE_PATHがあるconfigフォルダーを取得し、いくつかのJavaScriptファイルを指定する必要があります-異なる環境でそこにconfigを提示するだけです。</font><font style="vertical-align: inherit;">例として、指定されたデフォルト、開発および本番のパパを作成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mk/b8/ms/mkb8mse2x2bim9kv6ps4dwdkmg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして実際、設定全体は次のように機能します。</font><font style="vertical-align: inherit;">つまり、require（ 'config'）と記述すると、モジュール自体が読み込まれ、環境変数からモジュール名が取得されます。</font><font style="vertical-align: inherit;">ご存知のように、これらのファイルが何らかの形で使用されていることは明確ではありませんでした。直接インポート/要求がないため、webpackはそれを認識しません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/pr/wv/bkprwvhuxqslrha7tz5x7nddawo.jpeg"><br>
<h5><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スライドからリンク</font></font></a></sub></sup></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日は、依存性注入についても話しました。私はそんなに刺激を受けていませんでしたが、サポートのためにここにあるライブラリの1つを見ました。それはinversify JSと呼ばれています。ご覧のとおり、これはかなりカスタムな構文を提供します：lazyInject、nameProvider、そしてここにあります。そして、あなたは認めなければなりません、このモジュールがどの種類のプロバイダーがここに注入されるかは明らかではありません。そして、それが必要であり、それを理解する必要があります。つまり、繰り返しになりますが、ビルドシステムは解決されず、私たち自身で解決する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフを作成したとします。どこかに保存することから始めることをお勧めします。何ができるでしょうか？これにより、ある種のヒューリスティック分析を実行し、データサイエンスを少し実行して、タイムスライスに焦点を当てて実行することができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gx/uv/t1/gxuvt1vsmjz1rkihuwoc_t93nua.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アイデアは何ですか？実際、ここは直接データです。最近、Yandex.Marketに設計システムを実装しました。特に、この設計システムの一部としてコンポーネントライブラリを実装しました。そして、ここで見ることができます：インポートの数、ライブラリからの反応コンポーネント、一般コンポーネントを考慮します。そして、あなたはディレクトリで配布することができます。この場合、このような非モノのリポジトリーがあるため、platform.desktop、platform.touch、およびsrcがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの数字を見て、何を考えることができますか？ touchコマンドは、一般的なコンポーネントの使用を増加させていないように思われます。これは、コンポーネントがモバイルにとって悪い-不十分な製造、またはタッチコマンドが遅延していることを意味します。しかし、これは本当にそうでしょうか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u9/k_/gf/u9k_gfggsknyqnwdnmustdmsy1g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より長い期間、より長い時間で調べると、リリースごとにグラフを保存するだけで済みます。実際、すべてがタッチしても問題ないこと、インジケーターが増加していることがわかります。 srcの場合はさらに優れています。デスクトップの場合は、そうではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o4/k-/ro/o4k-ronqjbk7g6w_p3mmph2uywe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
聴衆からは、マネージャーに重要性を説明する方法についての質問がまだありました。これもライブラリのインポートの合計数です（時間別）。グラフィックスが嫌いなマネージャーは？このようなスケジュールを作成すると、ライブラリの使用が増加していることがわかります。つまり、これは少なくとも有用なことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のお気に入りのパーツの1つ。かなり簡単に説明します。これは、グラフの欠陥の検索です。本日は、2つのタイプの欠陥についてお話ししたいと思います。これは、モジュールの循環依存といくつかの未使用モジュール、つまりデッドコードの除去の問題です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pv/zz/kc/pvzzkcqb1xx6dk5ko7slsrz2iia.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
循環依存関係から始めましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2g/nx/u3/2gnxu3ruhrjtdjhhwfmeomypv-e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、すべてが非常に単純なようです。すでに有向グラフがあり、そこにループを見つけるだけです。なぜ私がこれについて話しているのかを説明します。実際、以前は主にNode.jsでサーバー側を記述しており、基本的にwebpack / babelは使用していませんでした。つまり、彼らはそのまま立ち上げた。そして必要がありました。インポートとrequireの違いを覚えている人はいますか？すべてが正しいです。コードの記述が不十分でも私が実際に書いた場合は、サーバーから、ユーザーからのリクエストがあった場合にのみモジュールが循環的に依存していること、または他のイベントが機能していることがわかります。それはかなりグローバルな問題です。ランタイムがわからなくなるまで。つまり、インポートの方がはるかに優れており、そのような問題は発生しません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ss/ly/az/sslyazi877vucvcpjj21kth7vle.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、好きなアルゴリズムを使用してください。ここでは、かなり単純なアルゴリズムを採用しました。インバウンドまたはアウトバウンドのいずれか1種類のエッジしかない頂点を見つける必要があります。そのような頂点がある場合は、それを削除してエッジを削除し、実際にこのプロセスを続行すると、このグラフに5サイクルのサイクルがあったことがわかり、証明されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同意します。コードで見た場合、つまり、2つまたは3つの長さのサイクルを見つけることができますが、より現実的ではなく、プロジェクトでは実際に7つのサイクルがありましたが、本番環境ではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/cz/kb/yjczkbpye4suwsuhgvmw-ku1azu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
未使用モジュールについて。ここでも、かなり簡単なアルゴリズムです。グラフで接続されているコンポーネントを強調表示し、エントリノードを含まないコンポーネントを探して見つける必要があります。この場合、これは接続性のこのコンポーネントであり、両方の頂点であることがわかります。両方のノードです。次に、entry.jsを呼び出します。実際、それが何と呼ばれていても、これはエントリアセンブリ構成で説明したとおりです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u3/g9/yo/u3g9yo0xtwjegnyxpe-gb1xpk_0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、別のアプローチがあります。グラフを収集しておらず、ビルドシステムしかない場合、それを行う最も安価な方法はどれですか。アセンブリ中にアセンブリに入ったすべてのファイルにマークを付けましょう。それらにタグを付け、多くを作成します。その後、プロジェクトにあるすべてのファイルを取得し、それらを差し引くだけです。これは非常に簡単な操作です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e2/yc/zn/e2yczn1scag0kmnvd97aqvdg_hc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、私はあなたに理論的なことを言っているだけではなく、刺激を受け、私のプロジェクトに参加し、これを行いました。そして注目！ node_modulesも削除しませんでした。これは、次のレビューの成長点として残しました。要するに、私は自分からインスピレーションを受けて、どうにかしてこのスライドを作成して再配置することにしました。とてもかっこいいので、このように見せてください！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
良い数字です、すべてがどのように良くなったか想像できますか？そして、デザイナーのようなステップに追い込まれ、これはフレームに追加したい成果だと思いました。そして、ご存知のように、私は立ち上がって、顔を出し、私はデザイナーではなく、実際にはウェブ開発者である可能性が高いことに気付きました。しかし、私は馬鹿ではありません。私はこのフレームを取り、私のサイトにSEOアミュレットを追加しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ji/14/nq/ji14nqwj-qsydqvw-ennrzkonqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンクでも使用できます。そして、あなたが私があなたをだましていると思わないように-私たちは今日率直です-私は本当にレビューを見ました。信じられると思います。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/0j/9v/j00j9vldpwzp39028m0uojaoxia.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、正直なところ、どうやらこんな感じでした。新しいハイポライブラリthanos-jsを見て、それを受け取り、プールリクエストを作成しました。秘密裏に、私にはリポジトリの管理者権限があります。そして、私はマスターを連れて混乱させました。お気に召しましたか？さて、あなたと私は率直です、そして実際、それはすべてこのように見えました。誰も知らない場合、thanos-jsは、コードの50％をランダムに削除するだけのライブラリです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nt/0g/q1/nt0gq16vrnioiabs2sgcyj51qve.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、とにかくそこでライブラリを使用しましたが、ライブラリの呼び方が異なります。これはディフレクターと呼ばれています。次に、それについて説明します。そして、ここで私はプールのリクエストがかなり重要であること、つまりコードの44千行を引いたものであることに注意したいと思います。つまり、私が話していることは実際に機能します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ue/2i/5w/ue2i5wil5tev67r5vcrzbjsyzmq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディフレクター実際、彼は未使用のモジュールの削除、グラフの欠陥の検索だけでなく、より重要な作業にも携わっています。私が最初に宣言したのは、開発者とテスターを支援することでした。次にそれについて話します。そしてそれはこのように機能します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バージョン管理システムを使用して、変更されたファイルのリストを取得します。すでにグラフが作成されています-ディフレクターが作成します。そして、そのような変更されたファイルごとに、エントリへのパスを探し、変更されたエントリにマークを付けます。エントリは、ユーザーに表示されるアプリケーションページに対応します。しかし、これはかなり論理的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これは私たちに何を与えますか？テスト用-アプリケーションのどのページが変更されたかがわかります。テスターに​​彼らだけがテストする価値があると伝えることができます。自動テストを実行するci-jobに、これらのページだけがテストに値することを伝えることもできます。開発者にとって、テスターがあなたに手紙を書いたり質問したりしないので、すべてがはるかに簡単です。「なぜテストする必要があるのですか？」</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/jr/se/wbjrsedhjgtn7xkmh7xzxurf5z4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディフレクターの動作の例を見てみましょう。ここには、pages.desktop / *という特定のディレクトリがあります。ページ自体のリストが含まれているだけです。また、ページはいくつかのファイルで記述されています。コントローラはページのサーバー側です。ビューはある種の反応部分です。そして、これは別のビルドシステムからのものです。ウェブパックだけでなくENBもあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/iq/dv/qo/iqdvqoq5yf4xpfpfqnl9ozxmwws.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、プロジェクト、空のファイルに変更を加えました。これは、diffectorが私に与えるものです。始めたばかりですが、diffectorはコマンドラインアプリケーションです。私はそれを起動しました、それは私がBindBonusPageと呼ばれる1つのページを変更したことを教えてくれます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vy/na/y3/vynay3b95xwzhuuawbjwz7jpbfm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、詳細モードで実行したり、より詳細なレポートを表示したり、少なくともこのような単純なケースで機能することを確認したりできます。ご覧のとおり、BindBonusPageのインデックスファイルとコントローラーが変更されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、他のものを変更するとどうなるか見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/rh/tl/ddrhtl_drtw2aqq5rt36r4ncqiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は何かを変えました。そして、ディフレクターは私が9ページを変えたと私に言った。そして、彼が本当に私を助けてくれないかのように、これはもう私を幸せにしません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ew/qh/ce/ewqhceogxq9z42d5zxl4yvfcyvy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理由を見てみましょうか？このページが変更されたと見なされた理由が表示されます。ご覧のとおり、同じことがここにあります。これは、uikitのテキストコンポーネントの一種です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/wd/ws/liwdwsd_ujkbc-abp18vcmceaim.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、差分を見てみましょう。私はそれを取り、単に型のコメントを変更しました。ただし、この場合、ディフレクターは正しく機能しませんでした。実際、これらの9ページすべてでテストを実行して回帰に追加することは価値がありませんでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zj/kf/uy/zjkfuy1ybdcht1hbuxktaznup2g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これは本当に問題です。プロジェクトによると、使用頻度の高いファイルがある場合、プロジェクトによると、ファイルを変更するとすべてのエントリが変更されます。つまり、すべてのアプリケーションページがテストスコープに分類され、効率は単純にゼロになります。それはそれが解決されるべき方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トリシャッシング。大多数の人がこの用語、および一般にそれが何で構成されるかを知っていることを願っています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/ep/ks/pbepksc2lwyezimbbytd6ngbujs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、この問題についてもう一度お話します。なんらかのファイルがあり、よく使用されます。例として-膝の上に作成されたi18n。キーが単純に格納されます。これを変更することで、実際には、グラフ内のコミュニケーションに関してアプリケーション全体を変更しました。しかし、実際には、いくつかのキーが使用されている場所のみを変更しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、どうやって私たちと一緒にそれを作るのですか？以前のモジュールがファイルシステム内の1つのファイルだった場合は、現在モジュールがあり、これらは実際、ファイル内のエクスポートです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zg/07/au/zg07aumxne59rvavifrhtxyi0p8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、どういうわけか。以前はこのようでしたが、今度はファイルBをエクスポートに分割し、export-2にはエッジさえないことがわかります。つまり、それさえも必要としません。これが、ESMの場合、ビルドシステムでトリチャッシングが機能する方法です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4o/io/d0/4oiod0-nkygafo_zp6ztfh2txju.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ここでは、すべてがバラ色であるわけではありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/th/ic/zz/thiczzasr1ggt87bgqy_ddhxlym.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードを検討してください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vp/sh/4o/vpsh4ozm_pfjbgakddnvri-bzey.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで値を変更するとしたら、実際にはこの定数だけでなく、静的クラスメソッドと、静的クラスメソッドを呼び出したクラスメソッドも変更します。つまり、タスクの2番目の部分では、ファイル自体の内部の依存関係を解決する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、ASTを使用してこれを試すことができますが、特にそのような場合、約250行のコードがあり、これが機能するという事実ではないことをお伝えします。しかし、実際には、依存関係を別の方法で逆にすることができます。そのため、これはかなり難しい作業です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yg/og/9p/ygog9p0lhvoiffbm6ilak-b7db8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ある種のGlobalContextとそれを変更する何らかの関数があると想像してください。ここで、変更機能が変更されると、実際に何が変更されたのかをどのように理解できますか？このモジュール、またはなんとかしてGlobalContextを変更するとき。しかし、それはとても難しいです。そのため、本格的なトリチャッシングは実装していません。ちなみに、このようなことを副作用といいます。たぶん、webpackを設定するときにそのようなフラグを見たので、そこでそれを指定できます。つまり、モジュールをwebpack sideEffects：trueに配置した場合、同じ状態になることはありません。しかし、これは保証されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ov/wn/ph/ovwnphvbkewixae0ypihcambj1k.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するために、私たちはまだ開発者を少しだけ蹴ることに決め、インタラクティブモードを導入しました。何を、なぜ説明します。差分を実行するだけでなく、完全なコンソールアプリケーションとして実行できるようになりました。ここでは、ご覧のとおり、インタラクティブに起動しました。そして、ここで彼は私に変更を示しました-すべては私のコードで行われました。そして彼が触れたページ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、私はここにアジェンダ、つまり、diff、expand、logを持っています。これに加えて、ここで、すでに説明した変更、つまりテキストの変更を確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tr/3s/qa/tr3sqaezwkxap8pdbrjuh-jjewe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにあります。 Dボタンで見ることができます、diffを参照してください。そして、すでに開発者自身も、たとえば、テキストを含める必要がないことを理解できます。実際、テキストコンポーネントを変更しても、ユーザーのコンテンツには影響しません。したがって、この変更リストから安全にオフにして、テストする必要のあるページ数を減らすことができます。つまり、8ページを取得して削除しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、実際には、いくつかのアプローチもあるかもしれません。これらの8ページそれぞれのテキストの変更を検討できます。しかし、これは大きな仕事です。想像してみてください。実際、正直な数字ではありません。より多くのそのようなページがあるかもしれません。テキストはよく使われます。そして、開発者にこれらの使用のそれぞれをマークすることを強制し、それがそれに影響するかどうかにかかわらず、これは実際、私がレポートの冒頭で宣言した問題への復帰です。したがって、そうすることにしました。私たちは専門家の分析の後でそれを残したので、2行目のみが変更自体に入ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして塩自体-私たちは何のためにディフレクターを使用しますか？開発者がコンソールで遊ぶためだけでなく、生活をより良くするためにも。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/rf/lf/pqrflfrep6fp0ffzhsntxw_lbm0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここにある種のエンティティ、つまりユーザーがアクセスできるアプリケーションのページの抽象化があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1k/qs/u4/1kqsu4cuurzk-8ib7n4sus4b8-g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはそのような関係について話し合い、アプリケーションページがエントリとどのように関係しているかについて話し合いました。 1つのアプリケーションページに複数のエントリがある場合があります。そして、このリンクはディフレクターを探しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3a/t4/gi/3at4giub3oqpahtey5yznumq1xy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の接続を検討する別の必要性。ページのテストケースがあります。この接続はケースストレージにあり、そこから取得できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rt/s1/nc/rts1ncwpwfo2gchhdglbx5ogevs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、エントリの変更に応じて、触れたテストケースを取得できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cz/6i/lr/cz6ilrthse-hs0awccmuxizen0g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはこのように動作します。ディフレクターを実行します。彼にはいくつかのタイプの報告があります。彼はいくつかのページが変更されたことを私たちに通知するという事実に加えて、テストケースのストアにリクエストを生成します。またはあなたの好きなように。ここで彼は言う：見て、BindBonusPageが変更されました。このページに関連付けられているすべてのテストケースを教えてください。これは手動回帰用です。自動テストの場合、実際には、リクエストを少し変更します。こんな感じです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ev/wx/va/evwxvahpj0honucu2yysxvtow6s.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/c5/9j/o6/c59jo6uyprhncjcrlnwevxrx4eu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで最も重要なことは、すべてをCIに移植することです。これは、チケットのコメントのスクリーンショットです。ここでも同じことです。特定のリクエストが送信され、テスターがチケットに来たときに確認し、チェックを開始します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7r/14/j9/7r14j90rvxqce-tuqobcjwrdewc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、昔はこんな感じでした。 43分はテストのみであり、Marketリポジトリへのすべてのコミットをコミットします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bz/-w/9r/bz-w9rnatawaxbqdjdlqws7ppki.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてそうでした。もちろん、常にというわけではありませんが、これは良い指標の1つです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fq/jw/gl/fqjwglsxt9v3qdpby861svprpve.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に言って、理想的な世界では、そのような仕事は特に起こらないはずです。重要なのは、ユーザーが実際にそこにアクセスできるファイルだけが含まれるようにバンドルを編成する必要があるということです。これは非常に困難な作業であり、まったく実行不可能であると理解していますが、その場合は、バンドルからそこにあるモジュールのリストを取得するだけで済みます。これらのモジュールが変更された場合、これは事実上、ユーザーにとって何かが変更されることを保証します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pk/oy/pg/pkoypg3-8saqxh-endw9soc-t-o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まとめます。</font><font style="vertical-align: inherit;">実際、私たちが話し合ったすべてのことは、大規模なチームにとって実用的なメリットがあります。</font><font style="vertical-align: inherit;">アプリケーションが2〜3人で開発されている場合、他の人のプールリクエストとコードの変更を簡単に監視でき、アプリケーションの接続方法を理解できます。</font><font style="vertical-align: inherit;">しかし、大規模なプロジェクトでは、1人の開発者がこれを行うのは困難です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、モジュールの依存関係グラフである静的分析を本当に使用したい場合は、ビルドシステムの出力を使用することから始めることをお勧めします。</font><font style="vertical-align: inherit;">開始するには、必要かどうかを理解してください。</font><font style="vertical-align: inherit;">集めたら-保管。</font><font style="vertical-align: inherit;">保存した場合-開発者の生活を分析して改善します。</font><font style="vertical-align: inherit;">感謝！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454456/index.html">Cisco 200-125 CCNA v3.0のトレーニング。7日目。FAQ</a></li>
<li><a href="../ja454458/index.html">変成テスト：この有望な手法について誰も知らない理由</a></li>
<li><a href="../ja454460/index.html">モバイル＃300開発者向けの興味深い資料のダイジェスト（5月27日-6月2日）</a></li>
<li><a href="../ja454462/index.html">フォト用紙なしのフォトグラム</a></li>
<li><a href="../ja454464/index.html">GeminiとStorybookに基づく視覚テストの開発</a></li>
<li><a href="../ja454472/index.html">シスコの最新のルーターパッチについて知っておくべきこと</a></li>
<li><a href="../ja454474/index.html">6月3日から9日までのモスクワでのデジタルイベント</a></li>
<li><a href="../ja454476/index.html">ベストプラクティスNode.js-プロジェクト構造のヒント</a></li>
<li><a href="../ja454478/index.html">Azure IoT Edge Tools（Preview）拡張機能が発表されました</a></li>
<li><a href="../ja454482/index.html">AI業界での苦いレッスン</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>