<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå§Ô∏è üí¶ üåÆ Fiches de s√©curit√©: Nodejs ü•ê üí§ üë®üèº‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beaucoup a d√©j√† √©t√© dit sur la popularit√© de NodeJS. L'augmentation du nombre d'applications est √©vidente - NodeJS est assez facile √† apprendre, poss√®...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fiches de s√©curit√©: Nodejs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acribia/blog/493714/"><img src="https://habrastorage.org/webt/bs/ml/lo/bsmllozt2li3jmn_6ec8vy4krdq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup a d√©j√† √©t√© dit sur la popularit√© de NodeJS. </font><font style="vertical-align: inherit;">L'augmentation du nombre d'applications est √©vidente - NodeJS est assez facile √† apprendre, poss√®de un grand nombre de biblioth√®ques, ainsi qu'un √©cosyst√®me en d√©veloppement dynamique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons pr√©par√© des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommandations pour les d√©veloppeurs NodeJS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bas√©es sur les feuilles de triche OWASP pour vous aider √† anticiper les probl√®mes de s√©curit√© lors du d√©veloppement d'applications. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les recommandations de s√©curit√© pour les applications NodeJS peuvent √™tre r√©parties dans les cat√©gories suivantes:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© lors du d√©veloppement d'applications;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© du serveur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© de la plateforme;</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© du d√©veloppement d'applications</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez l'enfer des rappels L'</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
utilisation des fonctions de rappel (rappels) est l'une des plus grandes forces de NodeJS, cependant lors de l'imbrication des rappels, vous pouvez facilement oublier de g√©rer l'erreur dans l'une des fonctions. </font><font style="vertical-align: inherit;">Une fa√ßon d'√©viter l'enfer de rappel est d'utiliser des promesses. </font><font style="vertical-align: inherit;">M√™me si le module que vous utilisez ne prend pas en charge l'utilisation des promesses, vous pouvez toujours utiliser Promise.promisifyAll (). </font><font style="vertical-align: inherit;">Mais m√™me en utilisant des promesses, il vaut la peine de faire attention √† la nidification. </font><font style="vertical-align: inherit;">Pour √©viter compl√®tement l'erreur d'enfer de rappel, respectez une cha√Æne de promesses ¬´plate¬ª. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'enfer de rappel:</font></font></i><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">function <span class="hljs-title">func1</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">500</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func2</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">100</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func3</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">900</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func4</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">3000</span>);<font></font>
}<font></font>
<font></font>
func1(<span class="hljs-string">"input1"</span>, function(err, result1){
   <span class="hljs-keyword">if</span>(err){
      <span class="hljs-comment">// error operations</span><font></font>
   }<font></font>
   <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">//some operations</span>
      func2(<span class="hljs-string">"input2"</span>, function(err, result2){
         <span class="hljs-keyword">if</span>(err){
            <span class="hljs-comment">//error operations</span><font></font>
         }<font></font>
         <span class="hljs-keyword">else</span>{
            <span class="hljs-comment">//some operations</span>
            func3(<span class="hljs-string">"input3"</span>, function(err, result3){
               <span class="hljs-keyword">if</span>(err){
                  <span class="hljs-comment">//error operations</span><font></font>
               }<font></font>
               <span class="hljs-keyword">else</span>{
                  <span class="hljs-comment">// some operations</span>
                  func4(<span class="hljs-string">"input 4"</span>, function(err, result4){
                     <span class="hljs-keyword">if</span>(err){
                        <span class="hljs-comment">// error operations</span><font></font>
                     }<font></font>
                     <span class="hljs-keyword">else</span> {
                        <span class="hljs-comment">// some operations</span><font></font>
                     }<font></font>
                  });<font></font>
               }<font></font>
            });<font></font>
         }<font></font>
      });<font></font>
   }<font></font>
});<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√™me code en utilisant des promesses de cha√Æne plate:</font></font></i><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">function <span class="hljs-title">func1</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">500</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func2</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">100</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func3</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">900</span>);<font></font>
}<font></font>
<span class="hljs-function">function <span class="hljs-title">func4</span><span class="hljs-params">(name, callback)</span> </span>{<font></font>
   setTimeout(function() {<font></font>
      <span class="hljs-comment">// operations</span>
   }, <span class="hljs-number">3000</span>);<font></font>
}<font></font>
<font></font>
func1(<span class="hljs-string">"input1"</span>)<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func2(<span class="hljs-string">"input2"</span>);<font></font>
   })<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func3(<span class="hljs-string">"input3"</span>);<font></font>
   })<font></font>
   .then(function (result){<font></font>
      <span class="hljs-keyword">return</span> func4(<span class="hljs-string">"input4"</span>);<font></font>
   })<font></font>
   .<span class="hljs-keyword">catch</span>(function (error) {
      <span class="hljs-comment">// error operations</span><font></font>
   });<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitez la taille de la demande. L'</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
analyse du corps de la </font><b><font style="vertical-align: inherit;">demande</font></b><font style="vertical-align: inherit;"> peut √™tre une op√©ration gourmande en ressources. Si vous ne limitez pas la taille de la demande, les attaquants pourront envoyer des demandes suffisamment volumineuses pouvant remplir tout l'espace disque ou √©puiser toutes les ressources du serveur, mais en m√™me temps, limiter la taille de la demande pour tous les cas peut √™tre incorrect, car il existe des demandes, telles que le t√©l√©chargement d'un fichier. Par cons√©quent, il est recommand√© de d√©finir des limites pour diff√©rents types de contenu. Par exemple, en utilisant le framework express, cela peut √™tre impl√©ment√© comme suit:</font></font><br>
<br>
<pre><code class="java hljs">app.use(express.urlencoded({ limit: <span class="hljs-string">"1kb"</span> }));<font></font>
app.use(express.json({ limit: <span class="hljs-string">"1kb"</span> }));<font></font>
app.use(express.multipart({ limit:<span class="hljs-string">"10mb"</span> }));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Il convient de noter qu'un attaquant peut modifier le type de contenu de la demande et contourner les restrictions, il est donc n√©cessaire de v√©rifier si le contenu de la demande correspond au type de contenu sp√©cifi√© dans l'en-t√™te de la demande. </font><font style="vertical-align: inherit;">Si la v√©rification du type de contenu affecte les performances, vous ne pouvez v√©rifier que certains types ou requ√™tes dont la taille est sup√©rieure √† une certaine taille. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne pas bloquer la boucle d'√©v√©nement</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un composant important du langage est la boucle d'√©v√©nement, qui vous permet simplement de changer le contexte d'ex√©cution sans attendre la fin de l'op√©ration. </font><font style="vertical-align: inherit;">Cependant, il existe des op√©rations de blocage dont l'ex√©cution NodeJS doit attendre avant de continuer avec le code. </font><font style="vertical-align: inherit;">Par exemple, la plupart des m√©thodes synchrones bloquent:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.unlinkSync(<span class="hljs-string">'/file.txt'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est recommand√© d'effectuer de telles op√©rations de mani√®re asynchrone:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.unlink(<span class="hljs-string">'/file.txt'</span>, (err) =&gt; {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Dans le m√™me temps, n'oubliez pas que le code restant apr√®s l'appel asynchrone sera ex√©cut√© sans attendre la fin de l'op√©ration pr√©c√©dente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, dans le code ci-dessous, le fichier sera supprim√© avant sa lecture, ce qui peut conduire √† une condition de concurrence critique.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.readFile(<span class="hljs-string">'/file.txt'</span>, (err, data) =&gt; {
  <span class="hljs-comment">// perform actions on file content</span><font></font>
});<font></font>
fs.unlinkSync(<span class="hljs-string">'/file.txt'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Pour √©viter cela, vous pouvez √©crire toutes les op√©rations dans une fonction non bloquante:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> fs = require(<span class="hljs-string">'fs'</span>);<font></font>
fs.readFile(<span class="hljs-string">'/file.txt'</span>, (err, data) =&gt; {
  <span class="hljs-comment">// perform actions on file content</span>
  fs.unlink(<span class="hljs-string">'/file.txt'</span>, (err) =&gt; {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;<font></font>
  });<font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rifier les champs de saisie La</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
v√©rification </font><b><font style="vertical-align: inherit;">des</font></b><font style="vertical-align: inherit;"> champs de </font><b><font style="vertical-align: inherit;">saisie</font></b><font style="vertical-align: inherit;"> est un √©l√©ment important de la s√©curit√© de toute application. Les erreurs de validation peuvent rendre votre application vuln√©rable imm√©diatement √† de nombreux types d'attaques: injection sql, xss, injection de commande et autres. Pour simplifier la validation des formulaires, vous pouvez utiliser des packages de validateur, mongo-express-sanitize. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âchapper aux donn√©es utilisateur</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'une des r√®gles qui vous aidera √† vous prot√©ger contre les attaques xss est de prot√©ger les donn√©es utilisateur. Vous pouvez utiliser la biblioth√®que escape-html ou node-esapi pour cela. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conserver les journaux</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En outre, cela aidera √† d√©boguer les erreurs, la journalisation peut √™tre utilis√©e pour r√©pondre aux incidents. Vous pouvez en savoir plus sur la n√©cessit√© de vous connecter </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici.</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Winston et Bunyan sont l'un des packages de journalisation NodeJS les plus populaires. </font><font style="vertical-align: inherit;">L'exemple ci-dessous montre comment utiliser Winston pour g√©n√©rer des journaux sur la console et le fichier:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> logger = <span class="hljs-keyword">new</span> (Winston.Logger) ({<font></font>
    transports: [<font></font>
        <span class="hljs-keyword">new</span> (winston.transports.Console)(),
        <span class="hljs-keyword">new</span> (winston.transports.File)({ filename: <span class="hljs-string">'application.log'</span> })<font></font>
    ],<font></font>
    level: <span class="hljs-string">'verbose'</span><font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contr√¥lez le cycle des √©v√©nements</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si votre serveur se trouve dans des conditions de trafic r√©seau intense, les utilisateurs peuvent rencontrer des difficult√©s avec la disponibilit√© de votre service. </font><font style="vertical-align: inherit;">Il s'agit essentiellement d'une attaque DoS. </font><font style="vertical-align: inherit;">Dans ce cas, vous pouvez suivre le temps de r√©ponse et, s'il d√©passe le temps sp√©cifi√©, envoyer un message au 503 Server Too Busy. </font><font style="vertical-align: inherit;">Le module toobusy-js peut vous aider. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple d'utilisation du module:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> toobusy = require(<span class="hljs-string">'toobusy-js'</span>);
<span class="hljs-keyword">var</span> express = require(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">var</span> app = express();<font></font>
app.use(function(req, res, next) {<font></font>
    <span class="hljs-keyword">if</span> (toobusy()) {
        <span class="hljs-comment">// log if you see necessary</span>
        res.send(<span class="hljs-number">503</span>, <span class="hljs-string">"Server Too Busy"</span>);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
    next();<font></font>
    }<font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prenez des pr√©cautions contre la force brutale.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L√† encore, les modules viennent √† la rescousse. </font><font style="vertical-align: inherit;">Par exemple, express-brute ou express-bouncer. </font><font style="vertical-align: inherit;">Exemple d'utilisation:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> bouncer = require(<span class="hljs-string">'express-bouncer'</span>);<font></font>
bouncer.whitelist.push(<span class="hljs-string">'127.0.0.1'</span>); <span class="hljs-comment">// whitelist an IP address</span>
<span class="hljs-comment">// give a custom error message</span><font></font>
bouncer.blocked = function (req, res, next, remaining) {<font></font>
    res.send(<span class="hljs-number">429</span>, <span class="hljs-string">"Too many requests have been made. Please wait "</span> + remaining/<span class="hljs-number">1000</span> + <span class="hljs-string">" seconds."</span>);<font></font>
};<font></font>
<span class="hljs-comment">// route to protect</span>
app.post(<span class="hljs-string">"/login"</span>, bouncer.block, function(req, res) {
    <span class="hljs-keyword">if</span> (LoginFailed){  }
    <span class="hljs-keyword">else</span> {<font></font>
        bouncer.reset( req );<font></font>
    }<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de CAPTCHA est une autre contre-mesure de force brute courante. </font><font style="vertical-align: inherit;">Un module fr√©quemment utilis√© pour aider √† impl√©menter CAPTCHA est svg-captcha. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utiliser des jetons CSRF</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'un des moyens les plus fiables de se prot√©ger contre les attaques CSRF consiste √† utiliser un jeton CSRF. </font><font style="vertical-align: inherit;">Le jeton doit √™tre g√©n√©r√© avec une entropie √©lev√©e, strictement v√©rifi√© et li√© √† la session de l'utilisateur. </font><font style="vertical-align: inherit;">Pour garantir le fonctionnement du token CSRF, vous pouvez utiliser le module csurf. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple d'utilisation:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> csrf = require(<span class="hljs-string">'csurf'</span>);<font></font>
csrfProtection = csrf({ cookie: <span class="hljs-keyword">true</span> });<font></font>
app.get(<span class="hljs-string">'/form'</span>, csrfProtection, function(req, res) {<font></font>
    res.render(<span class="hljs-string">'send'</span>, { csrfToken: req.csrfToken() })<font></font>
})<font></font>
app.post(<span class="hljs-string">'/process'</span>, parseForm, csrfProtection, function(req, res) {<font></font>
    res.send(<span class="hljs-string">'data is being processed'</span>);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas d'ajouter le jeton au champ cach√© de la page:</font></font><br>
<br>
<pre><code class="plaintext hljs">&lt;input type="hidden" name="_csrf" value="{{ csrfToken }}"&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez en savoir plus sur les jetons CSRF dans notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supprimez les routes inutiles. L'</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
application Web ne doit pas contenir de pages qui ne sont pas utilis√©es par les utilisateurs, car cela peut augmenter la surface d'attaque. Par cons√©quent, toutes les routes d'API inutilis√©es doivent √™tre d√©sactiv√©es. Vous devez particuli√®rement faire attention √† cette question si vous utilisez des frameworks Sails ou Feathers, car ils g√©n√®rent automatiquement des points de terminaison API. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prot√©gez-vous contre HPP (HTTP Parameter Pollution)</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Par d√©faut, express ajoute tous les param√®tres de la demande √† un tableau. OWASP recommande d'utiliser le module hpp, qui ignore toutes les valeurs des param√®tres de req.query et / ou req.body et s√©lectionne simplement la derni√®re valeur parmi celles en double.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> hpp = require(<span class="hljs-string">'hpp'</span>);<font></font>
app.use(hpp());<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surveillez les valeurs renvoy√©es.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Par exemple, la table utilisateur peut stocker des donn√©es importantes: mot de passe, adresse e-mail, date de naissance, etc. </font><font style="vertical-align: inherit;">Par cons√©quent, il est important de renvoyer uniquement les donn√©es n√©cessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple:</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-keyword">exports</span>.sanitizeUser = function(user) {
  <span class="hljs-keyword">return</span> {<font></font>
    id: user.id,<font></font>
    username: user.username,<font></font>
    fullName: user.fullName<font></font>
  };<font></font>
};<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez des descripteurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Utilisez des descripteurs pour d√©crire le comportement d'une propri√©t√© pour diverses op√©rations: inscriptible - s'il est possible de modifier la valeur d'une propri√©t√©, √©num√©rable - s'il est possible d'utiliser une propri√©t√© dans une boucle for..in, configurable - s'il est possible d'√©craser une propri√©t√©. </font><font style="vertical-align: inherit;">Il est recommand√© de faire attention aux propri√©t√©s r√©pertori√©es, car lors de la d√©finition de la propri√©t√© d'un objet, tous ces attributs sont d√©finis sur true par d√©faut. </font><font style="vertical-align: inherit;">Vous pouvez modifier la valeur des propri√©t√©s comme suit:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> o = {};<font></font>
Object.defineProperty(o, <span class="hljs-string">"a"</span>, {<font></font>
    writable: <span class="hljs-keyword">true</span>,<font></font>
    enumerable: <span class="hljs-keyword">true</span>,<font></font>
    configurable: <span class="hljs-keyword">true</span>,<font></font>
    value: <span class="hljs-string">"A"</span><font></font>
});<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utiliser les ACL</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Acl peut aider √† diff√©rencier l'acc√®s aux donn√©es en fonction des r√¥les. </font><font style="vertical-align: inherit;">Par exemple, l'ajout d'une autorisation ressemble √† ceci:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">// guest is allowed to view blogs</span>
acl.allow(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'blogs'</span>, <span class="hljs-string">'view'</span>)
<span class="hljs-comment">// allow function accepts arrays as any parameter</span>
acl.allow(<span class="hljs-string">'member'</span>, <span class="hljs-string">'blogs'</span>, [<span class="hljs-string">'edit'</span>, <span class="hljs-string">'view'</span>, <span class="hljs-string">'delete'</span>])
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catch uncaughtException</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Par d√©faut, en cas d'exception non intercept√©e, NodeJS l√®vera la trace de pile actuelle et terminera le thread d'ex√©cution. </font><font style="vertical-align: inherit;">Cependant, NodeJS vous permet de personnaliser ce comportement. </font><font style="vertical-align: inherit;">En cas d'exception non intercept√©e, un √©v√©nement uncaughtException est d√©clench√©, qui peut √™tre intercept√© √† l'aide de l'objet de processus:</font></font><br>
<br>
<pre><code class="java hljs">process.on(<span class="hljs-string">"uncaughtException"</span>, function(err) {
    <span class="hljs-comment">// clean up allocated resources</span>
    <span class="hljs-comment">// log necessary error details to log files</span>
    process.exit(); <span class="hljs-comment">// exit the process to avoid unknown state</span><font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de se rappeler que lorsqu'une exception uncaughtException se produit, il est n√©cessaire d'effacer toutes les ressources allou√©es (par exemple, les descripteurs de fichiers et les gestionnaires) avant de terminer le processus Z afin d'√©viter des erreurs impr√©vues. </font><font style="vertical-align: inherit;">Il est fortement d√©conseill√© que le programme continue de s'ex√©cuter si une exception uncaughtException se produit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, lors de l'affichage de messages d'erreur, l'utilisateur ne doit pas divulguer d'informations d√©taill√©es sur les erreurs, telles que la trace de la pile.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© du serveur</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©finissez des indicateurs pour les en-t√™tes lorsque vous travaillez avec des cookies.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Plusieurs indicateurs peuvent aider √† vous prot√©ger contre les attaques telles que xss et csrf: httpOnly, qui emp√™che l'acc√®s aux cookies via javascript; </font><font style="vertical-align: inherit;">S√©curis√© - permet d'envoyer des cookies uniquement via HTTPS et SameSite, ce qui d√©termine la capacit√© de transf√©rer des cookies vers une ressource tierce. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple d'utilisation:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> session = require(<span class="hljs-string">'express-session'</span>);<font></font>
app.use(session({<font></font>
    secret: <span class="hljs-string">'your-secret-key'</span>,<font></font>
    key: <span class="hljs-string">'cookieName'</span>,<font></font>
    cookie: { secure: <span class="hljs-keyword">true</span>, httpOnly: <span class="hljs-keyword">true</span>, path: <span class="hljs-string">'/user'</span>, sameSite: <span class="hljs-keyword">true</span>}<font></font>
}));<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©finir des en-t√™tes HTTP pour la s√©curit√©</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Les √©l√©ments suivants sont des en-t√™tes et des exemples de la fa√ßon de les connecter pour vous aider √† vous prot√©ger contre un certain nombre d'attaques courantes. </font><font style="vertical-align: inherit;">Les en-t√™tes sont d√©finis √† l'aide du module casque </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Strict-Transport-Security: HTTP Strict Transport Security (HSTS) indique au navigateur que l'application n'est accessible que via HTTPS</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hsts()); <span class="hljs-comment">// default configuration</span>
app.use(helmet.hsts(<span class="hljs-string">"&lt;max-age&gt;"</span>, <span class="hljs-string">"&lt;includeSubdomains&gt;"</span>)); <span class="hljs-comment">// custom configuration</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ X-Frame-Options: d√©termine si la page peut √™tre utilis√©e dans le cadre, l'iframe, l'incorporation ou l'objet</font></font><br>
<br>
<pre><code class="java hljs">app.use(hemlet.xframe()); <span class="hljs-comment">// default behavior (DENY)</span>
helmet.xframe(<span class="hljs-string">'sameorigin'</span>); <span class="hljs-comment">// SAMEORIGIN</span>
helmet.xframe(<span class="hljs-string">'allow-from'</span>, <span class="hljs-string">'http://alloweduri.com'</span>); <span class="hljs-comment">//ALLOW-FROM uri</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Protection X-XSS: permet au navigateur d'arr√™ter le chargement de la page s'il d√©tecte une attaque XSS r√©fl√©chie.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> xssFilter = require(<span class="hljs-string">'x-xss-protection'</span>);<font></font>
app.use(xssFilter());<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ X-Content-Type-Options: utilis√© pour emp√™cher les attaques utilisant des types MIME</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.noSniff());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Content-Security-Policy: emp√™che les attaques telles que XSS et les attaques par injection de donn√©es</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> csp = require(<span class="hljs-string">'helmet-csp'</span>)<font></font>
app.use(csp({<font></font>
   directives: {<font></font>
       defaultSrc: [<span class="hljs-string">"'self'"</span>],  <span class="hljs-comment">// default value for all directives that are absent</span>
       scriptSrc: [<span class="hljs-string">"'self'"</span>],   <span class="hljs-comment">// helps prevent XSS attacks</span>
       frameAncestors: [<span class="hljs-string">"'none'"</span>],  <span class="hljs-comment">// helps prevent Clickjacking attacks</span>
       imgSrc: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'http://imgexample.com'"</span>],<font></font>
       styleSrc: [<span class="hljs-string">"'none'"</span>]<font></font>
    }<font></font>
}))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Cache-Control et Pragma: pour g√©rer la mise en cache, cet en-t√™te en particulier peut √™tre utile pour les pages contenant des donn√©es sensibles. </font><font style="vertical-align: inherit;">Cependant, n'oubliez pas que la d√©sactivation de la mise en cache sur toutes les pages peut affecter les performances.</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.noCache());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ X-Download-Options: l'en-t√™te emp√™che Inter Explorer d'ex√©cuter les fichiers t√©l√©charg√©s</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.ieNoOpen());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Expect-CT: Transparence du certificat - un m√©canisme cr√©√© pour r√©soudre certains probl√®mes avec l'infrastructure de certificat SSL, cet en-t√™te indique au navigateur la n√©cessit√© d'une v√©rification de certificat suppl√©mentaire dans les journaux CT</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">var</span> expectCt = require(<span class="hljs-string">'expect-ct'</span>);<font></font>
app.use(expectCt({ maxAge: <span class="hljs-number">123</span> }));<font></font>
app.use(expectCt({ enforce: <span class="hljs-keyword">true</span>, maxAge: <span class="hljs-number">123</span> }));<font></font>
app.use(expectCt({ enforce: <span class="hljs-keyword">true</span>, maxAge: <span class="hljs-number">123</span>, reportUri: <span class="hljs-string">'http://example.com'</span>}));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ X-Powered-By: un en-t√™te facultatif utilis√© pour indiquer la technologie utilis√©e sur le serveur. </font><font style="vertical-align: inherit;">Vous pouvez masquer cet en-t√™te comme suit:</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hidePoweredBy());
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 De plus, vous pouvez modifier la valeur pour masquer des informations r√©elles sur les technologies que vous utilisez:</font></font><br>
<br>
<pre><code class="java hljs">app.use(helmet.hidePoweredBy({ setTo: <span class="hljs-string">'PHP 4.2.0'</span> }));
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©curit√© de la plateforme</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre √† jour vos packages La</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
s√©curit√© de votre application d√©pend de la s√©curit√© des packages que vous utilisez, il est donc important d'utiliser la derni√®re version du package. Pour vous assurer que le package que vous utilisez ne contient pas de vuln√©rabilit√©s connues, vous pouvez utiliser la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste sp√©ciale OWASP</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vous pouvez √©galement utiliser la biblioth√®que qui v√©rifie les packages pour les vuln√©rabilit√©s connues Retire.js. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'utilisez pas de fonctions dangereuses.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe des fonctions qu'il est recommand√© d'√©liminer dans la mesure du possible. Parmi ces fonctions se trouve eval (), qui ex√©cute une cha√Æne prise comme argument. En combinaison avec l'entr√©e utilisateur, l'utilisation de cette fonction peut entra√Æner des vuln√©rabilit√©s dans l'ex√©cution de code √† distance, car pour des raisons similaires, l'utilisation de child_process.exec est √©galement dangereuse, car la fonction transmet les arguments re√ßus √† bin / sh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, il existe un certain nombre de modules que vous devez utiliser avec prudence. Par exemple, le module fs pour travailler avec des fichiers. Si, d'une certaine mani√®re, l'entr√©e utilisateur g√©n√©r√©e est transmise √† une fonction, votre application peut devenir vuln√©rable √† l'inclusion d'un fichier local et d'une travers√©e de r√©pertoire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le module vm, qui fournit une API pour la compilation et l'ex√©cution de code sur une machine virtuelle V8, ne doit √™tre utilis√© que dans le bac √† sable. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici,</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous pouvez vous familiariser avec d'autres fonctions qui peuvent rendre votre application dangereuse. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soyez prudent en utilisant des expressions r√©guli√®res.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Une expression r√©guli√®re peut √™tre √©crite afin que vous puissiez arriver √† une situation o√π l'expression va cro√Ætre de fa√ßon exponentielle, ce qui peut conduire √† un d√©ni de service. Ces attaques sont appel√©es ReDoS. Il existe plusieurs outils pour v√©rifier si les expressions r√©guli√®res sont s√ªres, dont l'un est le d√©tecteur vuln-regex. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cutez linter p√©riodiquement</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant le d√©veloppement, il est difficile de garder √† l'esprit toutes les recommandations pour assurer la s√©curit√©, et s'il s'agit de d√©veloppement d'√©quipe, il n'est pas facile de se conformer aux r√®gles par tous les membres de l'√©quipe. √Ä ces fins, il existe des outils d'analyse statique de la s√©curit√©. De tels outils, sans ex√©cuter votre code, y recherchent des vuln√©rabilit√©s. De plus, les linters vous permettent d'ajouter des r√®gles personnalis√©es pour trouver des endroits dans le code qui peuvent √™tre vuln√©rables. Les linters les plus couramment utilis√©s sont ESLint et JSHint. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez le mode strict</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Javascript a un certain nombre de fonctions non s√©curis√©es et obsol√®tes qui ne devraient pas √™tre utilis√©es. Pour exclure la possibilit√© d'utiliser ces fonctions, un mode strict est √©galement fourni. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adh√©rer aux principes g√©n√©raux de s√©curit√©</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les recommandations d√©crites se concentrent sur NodeJS, mais n'oubliez pas les principes g√©n√©raux de s√©curit√© √† respecter quelle que soit la plateforme utilis√©e.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493702/index.html">Transition massive vers le travail √† distance: probl√®mes techniques et menaces pour la s√©curit√©</a></li>
<li><a href="../fr493704/index.html">Utiliser TypeScript en JavaScript sans √©crire TypeScript</a></li>
<li><a href="../fr493706/index.html">Connaissez votre ennemi: cr√©ez une porte d√©rob√©e Node.js</a></li>
<li><a href="../fr493708/index.html">Anatomie de ma grappe Kubernetes maison</a></li>
<li><a href="../fr493712/index.html">Nouvelles fonctionnalit√©s TypeScript pour une convivialit√© am√©lior√©e</a></li>
<li><a href="../fr493716/index.html">Inf√©rence de type avec TypeScript en utilisant la construction as const et le mot cl√© infer</a></li>
<li><a href="../fr493718/index.html">Discussion: utilitaires UNIX standard que peu ont utilis√©s et utilisent actuellement</a></li>
<li><a href="../fr493720/index.html">La temp√™te parfaite: comment la technologie change l'industrie des services alimentaires</a></li>
<li><a href="../fr493724/index.html">RPA | Robotisation des processus √† travers les yeux d'un analyste</a></li>
<li><a href="../fr493726/index.html">Complexe de d√©tection du tabagisme par photo ou vid√©o bas√© sur Intel NUC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>