<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💆🏽 ⬛️ ⛑️ Go的6种最佳安全做法 🚣🏾 📪 🙍🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文的翻译是专门为Golang Developer课程的学生准备的。
 
 
 
 
 近年来，Golang的知名度显着增加。诸如Docker，Kubernetes和Terraform之类的成功项目在这种编程语言上大举赌注。 Go最近已成为创建命令行工具的事实上的标准。在安全性方面，Go已根据其漏洞...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Go的6种最佳安全做法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/488724/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文的翻译是专门为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Golang Developer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课程的学生准备的</font><font style="vertical-align: inherit;">。</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/g3/jd/s7/g3jds7zwidxpwd-ubopyb-bjhle.png"><br>
<hr><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
近年来，Golang的知名度显着增加。诸如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和Terraform之</font><font style="vertical-align: inherit;">类的成功项目</font><font style="vertical-align: inherit;">在这种编程语言上大举赌注。 Go最近已成为创建命令行工具的事实上的标准。在安全性方面，Go已根据其漏洞报告成功进行了管理，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自2002年以来</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅拥有</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">一个CVE注册中心</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，没有漏洞并不意味着编程语言是高度安全的。如果不遵守某些规则，我们人类可能会创建不安全的应用程序。例如，了解</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">从OWASP编写安全代码</font></a><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们可以考虑使用Go时如何应用这些方法。</font><font style="vertical-align: inherit;">而这正是我这次要做的。</font><font style="vertical-align: inherit;">在本文中，我将向您展示在使用Go开发时要考虑的六种实践。</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.检查输入</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查用户输入不仅是出于功能目的，而且还有助于避免入侵者向我们发送可能损坏系统的侵入性数据的攻击。此外，您还可以帮助用户更放心地使用此工具，防止他们犯下愚蠢的常见错误。例如，您可以防止用户尝试一次删除多个条目。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要测试用户输入，可以使用本地的Go包（例如strconv）来处理将字符串转换为其他数据类型的过程。 Go还支持带有</font></font><code>regexp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于复杂检查的</font><font style="vertical-align: inherit;">正则表达式</font><font style="vertical-align: inherit;">。尽管Go倾向于使用本机库，但是还是有第三方程序包，例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用验证器，可以更轻松地对结构或单个字段启用验证。</font><font style="vertical-align: inherit;">例如，以下代码验证该结构</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含有效的电子邮件地址：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"fmt"</span><font></font>
<font></font>
	<span class="hljs-string">"gopkg.in/go-playground/validator.v9"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {<font></font>
	Email <span class="hljs-keyword">string</span> <span class="hljs-string">`json:"email" validate:"required,email"`</span>
	Name  <span class="hljs-keyword">string</span> <span class="hljs-string">`json:"name" validate:"required"`</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	v := validator.New()<font></font>
	a := User{<font></font>
		Email: <span class="hljs-string">"a"</span>,<font></font>
	}<font></font>
<font></font>
	err := v.Struct(a)<font></font>
<font></font>
	<span class="hljs-keyword">for</span> _, e := <span class="hljs-keyword">range</span> err.(validator.ValidationErrors) {<font></font>
		fmt.Println(e)<font></font>
	}<font></font>
}</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.使用HTML模板</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个常见的严重漏洞是跨站点脚本或XSS。主要漏洞是攻击者可以将恶意代码注入应用程序以修改输出。例如，有人可能将JavaScript代码作为URL中查询字符串的一部分发送。当应用程序返回用户值时，可以执行JavaScript代码。因此，作为开发人员，您应该意识到这种可能性，并清除用户输入的数据。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Go有一个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">html / template</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包，</font><font style="vertical-align: inherit;">用于对应用程序返回给用户的内容进行编码。因此，代替浏览器进行类似</font></font><code><code>&lt;</code>script<code>&gt;</code>alert(‘ !’);<code>&lt;</code>/script<code>&gt;</code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他会发出警告；</font><font style="vertical-align: inherit;">您可以对输入进行编码，应用程序会将输入作为在浏览器中打印的典型HTML代码进行处理。</font><font style="vertical-align: inherit;">返回HTML模板的HTTP服务器将如下所示：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"html/template"</span>
	<span class="hljs-string">"net/http"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {<font></font>
	param1 := r.URL.Query().Get(<span class="hljs-string">"param1"</span>)<font></font>
	tmpl := template.New(<span class="hljs-string">"hello"</span>)<font></font>
	tmpl, _ = tmpl.Parse(<span class="hljs-string">`{{define "T"}}{{.}}{{end}}`</span>)<font></font>
	tmpl.ExecuteTemplate(w, <span class="hljs-string">"T"</span>, param1)<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	http.HandleFunc(<span class="hljs-string">"/"</span>, handler)<font></font>
	http.ListenAndServe(<span class="hljs-string">":8080"</span>, <span class="hljs-literal">nil</span>)<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，在Go上开发Web应用程序时，可以使用第三方库。</font><font style="vertical-align: inherit;">例如，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gorilla Web工具箱</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中包括可帮助开发人员执行诸如编码Cookie身份验证值之类的库的库。</font><font style="vertical-align: inherit;">还有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nosurf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是一个HTTP软件包，可帮助防止跨站点请求伪造（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.保护自己免受SQL注入 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您已经进行了一段时间的开发，那么您可能会了解有关SQL注入的知识，它们仍然占据</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OWASP top中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的第一位</font><font style="vertical-align: inherit;">。但是，在使用Go时，您应考虑一些特定点。您需要做的第一件事是确保连接到数据库的用户具有有限的权限。如上一节所述，清理用户输入，或者转义特殊字符并使用</font><font style="vertical-align: inherit;">HTML模板包中</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTMLEscapeString</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数也是一种好习惯</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，您需要包括的最重要的代码是使用参数化查询。在Go中，您无需准备表达式（这是一条</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备语句</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">） 在连接;您在数据库中准备它。这是如何使用参数化查询的示例：</font></font><br>
<br>
<pre><code class="go hljs">customerName := r.URL.Query().Get(<span class="hljs-string">"name"</span>)<font></font>
db.Exec(<span class="hljs-string">"UPDATE creditcards SET name=? WHERE customerId=?"</span>, customerName, <span class="hljs-number">233</span>, <span class="hljs-number">90</span>)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果数据库引擎不支持使用准备好的表达式怎么办？</font><font style="vertical-align: inherit;">还是会影响查询性能呢？</font><font style="vertical-align: inherit;">好了，您可以使用db.Query（）函数，但首先请确保清理用户输入，如前几节所示。</font><font style="vertical-align: inherit;">也有第三方库，例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sqlmap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以防止SQL注入。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管我们竭尽全力，但有时漏洞会通过第三方泄漏或进入我们的应用程序。</font><font style="vertical-align: inherit;">为了保护Web应用程序免受诸如SQL注入之类的严重攻击，请考虑使用诸如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sqreen之</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类的应用程序安全管理平台</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.加密敏感信息</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
字符串难以读取（例如，以base-64格式显示）的事实并不意味着隐藏值是秘密的。您需要一种对攻击者无法轻松解码的信息进行加密的方法。您想要加密的典型信息是数据库密码，用户密码，甚至是社会保险号。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OWASP的有几个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建议，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在什么使用的加密算法，例如</font></font><code>bcrypt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>PDKDF2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Argon2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>scrypt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。幸运的是，有一个Go软件包，其中包括用于加密信息的可靠实现</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-crypto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。以下代码是一个示例用法</font></font><code>bcrypt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"database/sql"</span>
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"fmt"</span><font></font>
<font></font>
	<span class="hljs-string">"golang.org/x/crypto/bcrypt"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	ctx := context.Background()<font></font>
	email := []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"john.doe@somedomain.com"</span>)<font></font>
	password := []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"47;u5:B(95m72;Xq"</span>)<font></font>
<font></font>
	hashedPassword, err := bcrypt.GenerateFromPassword(password, bcrypt.DefaultCost)<font></font>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-built_in">panic</span>(err)<font></font>
	}<font></font>
<font></font>
	stmt, err := db.PrepareContext(ctx, <span class="hljs-string">"INSERT INTO accounts SET hash=?, email=?"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-built_in">panic</span>(err)<font></font>
	}<font></font>
	result, err := stmt.ExecContext(ctx, hashedPassword, email)<font></font>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-built_in">panic</span>(err)<font></font>
	}<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，在服务之间传输信息时，仍然需要谨慎。</font><font style="vertical-align: inherit;">您不希望以纯文本格式发送用户数据。</font><font style="vertical-align: inherit;">应用程序在保存之前是否对用户数据进行加密并不重要。</font><font style="vertical-align: inherit;">假设Internet上的某人可以收听您的流量并保留系统请求的日志。</font><font style="vertical-align: inherit;">攻击者可以使用此信息将其与其他系统的其他数据进行匹配。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.提供HTTPS连接</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当前，大多数浏览器都要求HTTPS可以在每个站点上运行。</font><font style="vertical-align: inherit;">例如，如果网站不使用HTTPS，Chrome会向您显示警告。</font><font style="vertical-align: inherit;">信息安全部门可以使用传输加密作为服务之间的通信策略。</font><font style="vertical-align: inherit;">也就是说，为了确保系统中传输连接的安全，不仅要侦听端口443上的应用程序。还需要使用适当的证书并使用HTTPS来防止攻击者将协议降级为HTTP。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是提供和使用HTTPS协议的Web应用程序的代码片段：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"crypto/tls"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net/http"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    mux := http.NewServeMux()<font></font>
    mux.HandleFunc(<span class="hljs-string">"/"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {<font></font>
        w.Header().Add(<span class="hljs-string">"Strict-Transport-Security"</span>, <span class="hljs-string">"max-age=63072000; includeSubDomains"</span>)<font></font>
        w.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"This is an example server.\n"</span>))<font></font>
    })<font></font>
    cfg := &amp;tls.Config{<font></font>
        MinVersion:               tls.VersionTLS12,<font></font>
        CurvePreferences:         []tls.CurveID{tls.CurveP521, tls.CurveP384, tls.CurveP256},<font></font>
        PreferServerCipherSuites: <span class="hljs-literal">true</span>,<font></font>
        CipherSuites: []<span class="hljs-keyword">uint16</span>{<font></font>
            tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,<font></font>
            tls.TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,<font></font>
            tls.TLS_RSA_WITH_AES_256_GCM_SHA384,<font></font>
            tls.TLS_RSA_WITH_AES_256_CBC_SHA,<font></font>
        },<font></font>
    }<font></font>
    srv := &amp;http.Server{<font></font>
        Addr:         <span class="hljs-string">":443"</span>,<font></font>
        Handler:      mux,<font></font>
        TLSConfig:    cfg,<font></font>
        TLSNextProto: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(*http.Server, *tls.Conn, http.Handler)</span>, 0),</span><font></font>
    }<font></font>
    log.Fatal(srv.ListenAndServeTLS(<span class="hljs-string">"tls.crt"</span>, <span class="hljs-string">"tls.key"</span>))<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请注意，应用程序将在端口443上侦听。下一行是提供HTTPS配置的行：</font></font><br>
<br>
<pre><code class="go hljs">w.Header().Add(<span class="hljs-string">"Strict-Transport-Security"</span>, <span class="hljs-string">"max-age=63072000; includeSubDomains"</span>)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还可以通过以下方式在TLS配置中指定服务器名称：</font></font><br>
<pre><code class="go hljs">config := &amp;tls.Config{ServerName: <span class="hljs-string">"yourSiteOrServiceName"</span>}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
始终建议您使用后端加密，即使您的Web应用程序仅用于内部通信也是如此。</font><font style="vertical-align: inherit;">想象一下，如果出于某种原因，攻击者可以监听您的内部流量。</font><font style="vertical-align: inherit;">只要有可能，最好始终为可能的未来攻击者提高标准。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.注意错误和日志。</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后但并非最不重要的是，在Go应用程序中进行错误处理和登录。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要成功解决生产问题，您需要正确配置应用程序。</font><font style="vertical-align: inherit;">您必须考虑显示给用户的错误。</font><font style="vertical-align: inherit;">您不希望用户知道到底出了什么问题。</font><font style="vertical-align: inherit;">攻击者可以使用此信息来确定您使用的服务和技术。</font><font style="vertical-align: inherit;">另外，您应该记住，尽管日志很棒，但是它们存储在某个地方。</font><font style="vertical-align: inherit;">而且，如果日志落入错误的人手中，则可以将它们用于将即将发生的攻击嵌入到系统中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，您需要学习或记住的第一件事是Go没有例外。</font><font style="vertical-align: inherit;">这意味着您需要以不同于其他语言的方式来处理错误。</font><font style="vertical-align: inherit;">该标准如下所示：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-comment">//  </span>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Go还提供了用于处理日志的内置库。</font><font style="vertical-align: inherit;">最简单的代码如下所示：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"log"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	log.Print(<span class="hljs-string">"Logging in Go!"</span>)<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，还有用于维护日志的第三方库。</font><font style="vertical-align: inherit;">其中一些是</font></font><code>logrus</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>glog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>loggo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是使用的一小段代码</font></font><code>logrus</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"os"</span><font></font>
<font></font>
	log <span class="hljs-string">"github.com/sirupsen/logrus"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	file, err := os.OpenFile(<span class="hljs-string">"info.log"</span>, os.O_CREATE|os.O_APPEND, <span class="hljs-number">0644</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
		log.Fatal(err)<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">defer</span> file.Close()<font></font>
<font></font>
	log.SetOutput(file)<font></font>
	log.SetFormatter(&amp;log.JSONFormatter{})<font></font>
	log.SetLevel(log.WarnLevel)<font></font>
<font></font>
	log.WithFields(log.Fields{<font></font>
		<span class="hljs-string">"animal"</span>: <span class="hljs-string">"walrus"</span>,
		<span class="hljs-string">"size"</span>:   <span class="hljs-number">10</span>,<font></font>
	}).Info(<span class="hljs-string">"A group of walrus emerges from the ocean"</span>)<font></font>
}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，请确保您应用了所有先前的建议，例如对日志中放入的数据进行加密和清理。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总有成长的空间</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这些准则是应针对Go应用程序的最低要求。</font><font style="vertical-align: inherit;">但是，如果您的应用程序是命令行工具，则不需要加密方法来进行传输。</font><font style="vertical-align: inherit;">但是其余的安全提示几乎适用于所有类型的应用程序。</font><font style="vertical-align: inherit;">如果您想了解更多，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OWASP上有专门针对Go</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">书，</font></a><font style="vertical-align: inherit;">其中涉及一些主题。</font><font style="vertical-align: inherit;">还有一个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储库，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中包含指向Go中的框架，库和其他安全工具的链接。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论最终要做什么，请记住，您可以始终提高应用程序的安全性。</font><font style="vertical-align: inherit;">攻击者将始终找到利用漏洞的新方法，因此请尝试不断致力于应用程序的安全性。</font></font><br>
<hr><br>
<i>     . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> — ,            ,           ,  .NET, Node.js  Java,     Docker.</i><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   .</a></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN488708/index.html">在Swift Combine中保存过滤逻辑。第2部分</a></li>
<li><a href="../zh-CN488712/index.html">Check Point WatchTower-通过智能手机管理NGFW</a></li>
<li><a href="../zh-CN488716/index.html">前端喀山mitap的资料：Phoenix LiveView，frontops，JSON：API</a></li>
<li><a href="../zh-CN488720/index.html">网页抓取 第1部分</a></li>
<li><a href="../zh-CN488722/index.html">安全周08：病毒再次出现</a></li>
<li><a href="../zh-CN488726/index.html">NIPTB Onega工程师的访谈-WorldSkills高科技的获奖者，有关工作，冠军和CAD</a></li>
<li><a href="../zh-CN488728/index.html">两种方法可以使石油价格高涨，或者通过袭击石油和天然气来影响股指</a></li>
<li><a href="../zh-CN488730/index.html">俄罗斯关于物联网，智能制造和智能城市的新标准</a></li>
<li><a href="../zh-CN488732/index.html">有才华的西蒙先生：独特的能力和3D打印如何改变生产流程</a></li>
<li><a href="../zh-CN488736/index.html">远程工作正在蓬勃发展</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>