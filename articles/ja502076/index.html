<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👲🏽 👩🏻‍💼 ♉️ トロリーロボット2.0。パート1. ROSに基づくホームロボットの自律ナビゲーション ⚱️ 🉑 💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="このプロジェクトは、その円の中でよく知られている別のプロジェクト-linorobot（linorobot.org）に基づいて構築されており、単純な素人が利用できるコンポーネントを使用しています。設定された目標：低コストのコンポーネントを使用して自宅でロボットの自律移動を実現し、指定された目的でミニP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>トロリーロボット2.0。パート1. ROSに基づくホームロボットの自律ナビゲーション</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502076/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このプロジェクトは、その円の中でよく知られている別のプロジェクト-linorobot（linorobot.org）に基づいて構築されており、単純な素人が利用できるコンポーネントを使用しています。</font><font style="vertical-align: inherit;">設定された目標：低コストのコンポーネントを使用して自宅でロボットの自律移動を実現し、指定された目的でミニPCのパフォーマンスを評価し、フルシチョフの狭いスペースで移動するようにナビゲーションスタックを構成します。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OGxB34-heds" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイクルの記事：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robot Cart 2.0。</font><font style="vertical-align: inherit;">パート3. ROSナビゲーションスタック内の、ちょっとしたmajordomo </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robot Cart 2.0。</font><font style="vertical-align: inherit;">パート2. rvizを使用した場合と使用しない場合の管理rviz </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Robot Cart 2.0の</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">美の要素 </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1. ROSに基づくホームロボットの自律ナビゲーション</font></font></a><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鉄</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソリッド内のコンポーネントのリストは次のとおりです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラズベリーパイ3b-2800 r .;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIDAR RPLIDAR A1-7500 P;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パワーブリッジl298n -2pcs-400 rub ;;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプAおよびBのエンコーダー付きホイールセット-2000 r。</font><font style="vertical-align: inherit;">（210rpm- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teenzy 3.2-2100 r ;;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imu 9250（9150または6050）-240 p。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10000mHのパワーバンク-1500 r。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3個のバッテリー18650およびホルダー-600 p。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">降圧コンバータDC-DC C 5V〜3.3V-20p。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合板、寄木細工の断片-？</font><font style="vertical-align: inherit;">こする。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計：17160ページ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* teenzyをarduino mega 2560（600 p。）に置き換えることでコストを削減でき、Kinect v.1（1000 p。）を置き換えることでLIDAR：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ec/vb/v4/ecvbv42ipnldzd5vhureodavsqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のKinectの最小の可視性（ブラインドエリア）は0.5 mであることに注意してください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">窮屈な状況でのナビゲーションに悪影響を与える可能性があり、かなりかさばります。</font><font style="vertical-align: inherit;">LIDARのブラインドゾーンは0.2 m未満です。Kinectv.2はラズベリー3bに適合しません（USB 3.0がありません）。</font><font style="vertical-align: inherit;">Arduino megaは、teenzyよりもサイズ（およびいくつかの特性）が劣っています。さらに、コードを少し修正し直す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、「デザイン」は次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ou/ru/x9/ourux9icibrxsh4ruai61e3wkx4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yg/bh/0h/ygbh0hlvz8juq6qi4e9tarrhznq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キネクトム付きのオプション：</font></font><br>
<img src="https://habrastorage.org/webt/zd/rx/sd/zdrxsdu2ucidfgl4pzmqfn6xpos.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ここには美しさはありませんが、それについては</font><font style="vertical-align: inherit;">触れ</font><font style="vertical-align: inherit;">ていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボット自体に加えて、ロボットの動作を視覚化するためのグラフィカルシェル（rviz、ガゼボ）を起動する外部PCを用意することが強く望まれます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロボット組立</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトのウェブサイト- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で詳細に描かれて</font><font style="vertical-align: inherit;">いるので、問題を引き起こすポイント</font><font style="vertical-align: inherit;">について詳しく説明し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">まず、ホイールセットのエンコーダは3.3Vで駆動され、5Vが適用されると完全に故障することを考慮する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
linorobotインストールスクリプトがubuntu 16.04、ubuntu 18.04に正常にインストールされました。</font><font style="vertical-align: inherit;">ROSバージョン：ROSキネティックまたはROSメロディック。</font><font style="vertical-align: inherit;">raspberry 3bでは、最初にスワップファイルを作成する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
十代の主なコードは途中です：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware/lib/config<font></font>
nano lino_base_config.h<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コマンドでそれに注ぎました：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware<font></font>
platformio run --target upload<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のコマンドのバンドルは非常に頻繁に使用されるため、エイリアスに追加することは理にかなっています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットの組み立てが難しいため、接続された接点をl298nからteenzyに正しく関連付けるのは面倒な場合があります。</font><font style="vertical-align: inherit;">非常に明確な接続図にもかかわらず、ホイールは異なる動作をする可能性があり、コードで正しいピン割り当てを選択して実験する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の場合、それはこのように判明しました：</font></font><br>
<br>
<pre><code class="bash hljs">/// ENCODER PINS
<span class="hljs-comment">#define MOTOR1_ENCODER_A 14</span>
<span class="hljs-comment">#define MOTOR1_ENCODER_B 15 </span><font></font>
<font></font>
<span class="hljs-comment">#define MOTOR2_ENCODER_A 11</span>
<span class="hljs-comment">#define MOTOR2_ENCODER_B 12 </span><font></font>
//MOTOR PINS<font></font>
<span class="hljs-comment">#ifdef USE_L298_DRIVER</span>
  <span class="hljs-comment">#define MOTOR_DRIVER L298</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR1_PWM 21</span>
  <span class="hljs-comment">#define MOTOR1_IN_A 1</span>
  <span class="hljs-comment">#define MOTOR1_IN_B 20</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR2_PWM 5</span>
  <span class="hljs-comment">#define MOTOR2_IN_A 8</span>
  <span class="hljs-comment">#define MOTOR2_IN_B 6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のポイントは、ロボットホイールの仕様を規定することです。</font></font><br>
<br>
<pre><code class="bash hljs">//define your robot<span class="hljs-string">' specs here
#define MAX_RPM 210               // motor'</span>s maximum RPM
<span class="hljs-comment">#define COUNTS_PER_REV 1365       // wheel encoder's no of ticks per rev</span>
<span class="hljs-comment">#define WHEEL_DIAMETER 0.065       // wheel's diameter in meters</span>
<span class="hljs-comment">#define PWM_BITS 8                // PWM Resolution of the microcontroller</span>
<span class="hljs-comment">#define LR_WHEELS_DISTANCE 0.235  // distance between left and right wheels</span>
<span class="hljs-comment">#define FR_WHEELS_DISTANCE 0.30   // distance between front and rear wheels. Ignore this if you're on 2WD/ACKERMANN</span>
<span class="hljs-comment">#define MAX_STEERING_ANGLE 0.415  // max steering angle. This only applies to Ackermann st</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RPMはホイール仕様にありますが、CPR（COUNTS_PER_REV）が計算値です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPR = PPR x 4.ホイールのPPR341。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPRは、仕様で表示するか、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roslaunch linorobot minimal.launchロボットで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを実行して</font><font style="vertical-align: inherit;">、ホイールを360度回転させる</font><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。 PPRは、ホイールの回転後に画面に表示される数値と等しくなります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/7z/ks/be7zksecqhlyuyv-e_dkxqdyrwe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR = abs（RECENT_COUNT-INITIAL_COUNT）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、CPR = 1364です。WHEEL_DIAMETERおよびLR_WHEELS_DISTANCEをメートル単位で設定する必要もあります。さらに、LR_WHEELS_DISTANCEは、ホイールの中心軸間の距離であり、端から端までの距離ではありません。ロボットが二輪、差動（全方向性ではない）の場合、他のインジケーターは無視できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題を引き起こす可能性のある3番目のポイント</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-IMUキャリブレーション</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これを行うには、指示に従って、ロボットを特定の位置に固定する必要があります。実行するときのヒントは、コードになります</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosrun imu_calibのdo_calibスクリプトを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/fj/9e/ggfj9eg71ilp0baj7rvshjl-fmw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
設定で完了imu_calib.yamlが生成されます後。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
imu設定のデフォルトファイルがあるにもかかわらず、キャリブレーションを実行することをお勧めします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*さらに、imuキャリブレーションはテレオップを介したロボットの移動方向に影響を与える可能性があることが判明しました（前後の移動は正しいものの、右ではなく左、およびその逆）。コード内のピンの再配置によって状況は解決されませんでした。 Imu自体が修正され、逆ブラケットで調整されました。ロボットベースの背面に固定。彼（imu）が再キャリブレーションなしでさらにフリップすると、問題が解決しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4番目のポイント</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-PIDキャリブレーション</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトのウェブサイトでは、調整を実装する方法の手順が詳細に説明されています- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、初心者がそれが何であり、それをどのように扱うかを理解するのは難しいでしょう。</font><font style="vertical-align: inherit;">一般的に、pidの調整は、ジャークや急ブレーキをかけずにロボットが均一に動くようにするために必要です。</font><font style="vertical-align: inherit;">これには3つのパラメーター（p、i、d）が関与します。</font><font style="vertical-align: inherit;">それらの値は、teenzyにアップロードされたメインコードに含まれています。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define K_P 2.0 // P constant angle</span>
<span class="hljs-comment">#define K_I 0.3 // I constant</span>
<span class="hljs-comment">#define K_D 0.1 // D constant</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットで実行して、それらを試すことができます。</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot minimal.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、外部PCの3つの異なる端末：</font></font><br>
<br>
<pre><code class="bash hljs">rosrun lino_pid pid_configure<font></font>
rosrun teleop_twist_keyboard teleop_twist_keyboard.py<font></font>
rqt<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライダーp、d、iをrqtターミナルで動かしてから、teleop_twist_keyboardターミナルでロボットを制御すると、teenzyで毎回新しいpidパラメーターを使用してコードをダウンロードしなくても、必要な結果を得ることができ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/9m/ef/qr9mefipf7mqz9vwqqyqkktkeug.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。 teenzyの意味はまったく異なる場合があります。</font><font style="vertical-align: inherit;">*チャートに集中することはできません。</font><font style="vertical-align: inherit;">視覚的に、そしてロボットがどのように移動しているかが理解されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値p = 1.0、d = 0.1、i = 0.1の設定から始めることをお勧めします。</font><font style="vertical-align: inherit;">私たちの場合、値は次のとおりです（実験的に取得）p = 2.0、i = 0.3、d = 0.1。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、これらの値をコードに設定し、teenzyに入力する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、コードで設定することを忘れないでください（DEBUG 1の代わりにDEBUG 0）：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define DEBUG 0</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オドメトリ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットの向きとそれに続くナビゲーションには、LIDARデータ、IMU、ホイールエンコーダーデータが使用されます。 imuキャリブレーションが正しく実行され、LIDARが正しくインストールされ、エンコーダーの値が正しい場合、オドメトリに問題はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オドメトリが正しいことを確認するには、teleopを介してロボットに少し乗って、odomトピックの値を確認する必要があります。これはプロジェクトページに記載されています- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、rvizのビジュアルシェルも確認してください。rvizの</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/td/si/rrtdsilkdlggf3ifjhk1uhl8bz0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのセルは1 mなので、ロボットがこのメーターをビジュアルエディターでも現物でも通過させることをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、移動距離はインジケーターwに表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/oj/l6/i1ojl6vg5jyugymjwgk-5cfsrlm.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これも1 mになる傾向があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボットの回転角度についても同様</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l0/uf/bv/l0ufbvhsko99na50frablnrvsc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* rvizとliveでは、ロボットは同じ角度で回転する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LIDARからのオドメトリは同様の方法で定義されます- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。LIDARから</font><font style="vertical-align: inherit;">最も近い壁までのライブとrvizの距離は一致している必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROSでは、変換-tfに特別な注意が払われます。</font><font style="vertical-align: inherit;">一般的に、この概念は、オブジェクトの空間内での相互の相関を表します。</font><font style="vertical-align: inherit;">オブジェクトが空中にぶら下がらないようにし、プログラムがそれらがどのように相対的に表示されるかを理解するために、tf設定に注意を払う必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトでは、すべてのtf接続はすでに相互に関連して構成されており、たとえば、LIDARの位置を示すなど、インジケーターを調整するだけで済みます。</font><font style="vertical-align: inherit;">これは、障害物が彼の直前ではなく、一定の距離でロボットの中心から離れたライダーの前で発生したことをロボットが理解するために必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
適切なディレクトリに移動しましょう：</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch<font></font>
nano bringup.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベース自体は床から0.065 mの距離にあります。</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_footprint_to_base_link"</span> args=<span class="hljs-string">"0 0 0.065 0 0 0  /base_footprint /base_link "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
laser.launchでは、ロボットベースの中心を基準にLIDARの位置を設定する必要があります。</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch/include<font></font>
nano laser.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の場合、LIDARはx軸に沿ってシフトします：-0.08、y：0.04、ベース（z軸）の上の「ライズ」：0.08m：</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf2_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_link_to_laser"</span>
args=<span class="hljs-string">"-0.08 0.04 0.08 0 0 0  /base_link /laser "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rvizでは、この位置を視覚的に確認できます。LIDAR </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1v/rz/gj/1vrzgjmhx-gf-jar7jxfbhcovte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
からそれほど遠くない間は、頻度を</font><font style="vertical-align: inherit;">調整</font><font style="vertical-align: inherit;">して、より多くのポイントを与えるようにします（デフォルトでは4kを与えます）。これは、マップの構築に役立ちます。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> linorobot/launch/include/lidar<font></font>
nano rplidar.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パラメータを追加：</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"scan_mode"</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Boost"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして変化 </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"angle_compensate"</span>    <span class="hljs-attr">type</span>=<span class="hljs-string">"bool"</span>   <span class="hljs-attr">value</span>=<span class="hljs-string">"false"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで8kが自由に使えるよう</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/u0/fq/zfu0fqd4d7nwmuv50am1qhwqxbm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
になりました。ロボットのライダー</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">物理的な場所も重要です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/46/mw/vq/46mwvqq3kj7nxpskvoadm7xe738.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2Dルームマップの作成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトのウェブサイトでは、2つのターミナルで起動してルームマップを作成することが提案されています。</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot bringup.launch<font></font>
roslaunch linorobot slam.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、実際には、プロジェクトにデフォルトで付属しているスラムが、ライダーモードが8kの場合は動作を拒否することが示されています</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/xa/a5/zexaa5f_1byvgcvvvkvcr7cowbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。4kモードでは、カードはあまり成功せず、非常にうるさいです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、別のスラム、ヘクタースラムを使用することをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストール方法は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストール後、マップを作成する手順は同じですが、roslaunch linorobot slam.launchの代わりにroslaunch my_hector_mapping my_launch.launchを実行します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マップはよりクリーンですが、特にマップの作成時にLIDARがミラーと衝突した場合は、不要なマップを削除する方が適切です。 ：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/zo/jv/cnzojvfwpkwgldoo3mylfwwh-yg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルームマップを保存することを忘れないでください：</font></font><br>
<br>
<pre><code class="bash hljs">rosrun map_server map_saver -f my-map
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*快適な夕暮れ時にマップをより適切に取得できます。これにより、予算のLIDARを最大限に活用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスはどうですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
raspberry pi 3b +機能するナビゲーション/コントロールノード（kinectを搭載したロボットのバージョン）：</font></font><br>
<img src="https://habrastorage.org/webt/p0/ap/af/p0apafbz39wjbhhwpsxvxmq60ni.gif"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダウンロードはそれほど深刻ではありませんが、ロボットに機能するカメラやその他のセンサーがないため、これを考慮する必要があると言えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つづく。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja502058/index.html">ララヴェル7</a></li>
<li><a href="../ja502062/index.html">誰がJavaを作成したか：James Goslingの主なもの</a></li>
<li><a href="../ja502068/index.html">コンピューターに110ボルト</a></li>
<li><a href="../ja502070/index.html">ペンタックスの歴史（記事とビデオ）</a></li>
<li><a href="../ja502072/index.html">JavaScriptとコンパスを使用したISSのドッキング</a></li>
<li><a href="../ja502080/index.html">かんばん方式：例PNZ No. 1、新興企業での測定研究プロセス</a></li>
<li><a href="../ja502084/index.html">操り人形師を介して負荷のある地域公共サービスのポータルを確認する</a></li>
<li><a href="../ja502086/index.html">ユーザーがバケットでのみ作業できるようにMinioを設定する</a></li>
<li><a href="../ja502088/index.html">過剰な時間と失われた時間の物語。py3によると</a></li>
<li><a href="../ja502092/index.html">ロシア連邦におけるデジタル信託サービスの技術的および規制上のサポート</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>