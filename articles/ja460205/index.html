<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’´ ğŸ’µ ğŸ˜ PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã«åŸºã¥ãæš—å·åŒ–ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€‚é›»å­ç½²åCadES-X Long Type 1ã®ä½œæˆã€‚ãƒ‘ãƒ¼ãƒˆ3 ğŸ¤¼ ğŸ˜£ ğŸŒœ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ™‚é–“ãŒçµŒéã—ãŸã¨ã—ã¦å§‹ã¾ã£ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€è¨¼æ˜æ›¸ãƒ“ãƒ¥ãƒ¼ã‚¢ã§ã®ä½œæ¥­ã®æ©Ÿèƒ½ã‚’è£œè¶³ã—ã€PKCSï¼ƒ11æš—å·ãƒˆãƒ¼ã‚¯ãƒ³ã®ã¨ãŠã‚Šã¨è³‡æ ¼è¨¼æ˜æ›¸ã®è¦æ±‚ï¼ˆPKCSï¼ƒ10ï¼‰ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠã§ã®ä½œæ¥­ã®æ©Ÿèƒ½ã‚’ã€è£œå……ã•ã‚Œã¦ã„ã¾ã™ã€‚
 
  ã—ãŸãŒã£ã¦ã€PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€cryptoar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã«åŸºã¥ãæš—å·åŒ–ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€‚é›»å­ç½²åCadES-X Long Type 1ã®ä½œæˆã€‚ãƒ‘ãƒ¼ãƒˆ3</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460205/"><img src="https://habrastorage.org/webt/ey/r3/0s/eyr30sd-wd9j3vp6bjq2x-5tusg.png" align="left" alt="ç”»åƒ"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ™‚é–“ãŒçµŒéã—ãŸã¨ã—ã¦å§‹ã¾ã£ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨¼æ˜æ›¸ãƒ“ãƒ¥ãƒ¼ã‚¢</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã®ä½œæ¥­ã®æ©Ÿèƒ½ã‚’è£œè¶³ã—ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCSï¼ƒ11</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æš—å·</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ãƒˆãƒ¼ã‚¯ãƒ³</font></font></a><font style="vertical-align: inherit;">ã®ã¨ãŠã‚Šã¨è³‡æ ¼è¨¼æ˜æ›¸ã®è¦æ±‚ï¼ˆPKCSï¼ƒ10ï¼‰ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠã§ã®ä½œæ¥­ã®æ©Ÿèƒ½ã‚’ã€è£œå……ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€cryptoarmpkcsãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒå¿…è¦ã§ã™ã€‚</font></font></b>
                        <div class="spoiler_text"><ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Linux32</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Linux64</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">OS X</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">WIN32</a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">WIN64</a></li>
</ul><br>
</div>
                    </div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cryptoarmpkcsãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã—ã€PKCS12ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/qa/nc/uf/qancufv7do8q1bi5bixaz0eul8q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’æ‰‹å…ƒ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ã«</font></font></a><font style="vertical-align: inherit;">ç½®ã„ã¦ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§å®Ÿè¡Œã§ãã‚‹ã“ã¨ã‚’æ˜ç¢ºã«ç¤ºã—ã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰æ¨©ã®è¨¼æ˜æ›¸ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã€ŒFriendlyNameã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å³å´ã«ã‚ã‚‹ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§ååˆ†ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3ç¨®é¡ã®é›»å­ç½²åCAdesã®1ã¤ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨¼æ˜æ›¸ã‚’ä¿å­˜ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¼ã‚¯ãƒ³ã«è¨¼æ˜æ›¸ã‚’ä¿å­˜ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¼ã‚¯ãƒ³ã«æ‰€æœ‰è€…ã®ç§˜å¯†éµã‚’ä¿å­˜ã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã®2ã¤ã®æ“ä½œã¯ã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒæ¥ç¶šã•ã‚Œã¦ã„ã‚‹å ´åˆã«ã®ã¿å¯èƒ½ã§ã™ï¼ˆPKCSï¼ƒ11ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒé¸æŠã•ã‚Œã€ãƒˆãƒ¼ã‚¯ãƒ³ãŒæ¥ç¶šã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚ã¾ãŸã€ã™ã¹ã¦ã®ãƒˆãƒ¼ã‚¯ãƒ³ã§ç§˜å¯†éµã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ã‘ã§ã¯ãªã„ã“ã¨ã«ã‚‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãŸã ã—</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€PKCSï¼ƒ11ã‚¯ãƒ©ã‚¦ãƒ‰ãƒˆãƒ¼ã‚¯ãƒ³</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’æ“ä½œã™ã‚‹å ´åˆã€ã“ã®æ“ä½œã¯é‡è¦ã§ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PKCSï¼ƒ11æš—å·åŒ–ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã¯ç•°ãªã‚Šã€PKCSï¼ƒ12ã‚»ã‚­ãƒ¥ã‚¢ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã¯æš—å·åŒ–ãƒã‚·ãƒ³ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è¨¼æ˜æ›¸ã¨ãã®ç§˜å¯†éµã‚’å®‰å…¨ãªå½¢å¼ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§æš—å·åŒ–ï¼‰ã§ä¿å­˜ã™ã‚‹ã ã‘ã§ã€æš—å·åŒ–æ“ä½œã¯å®Ÿè¡Œã—ã¾ã›ã‚“ã€‚ãƒ­ã‚·ã‚¢ã®æš—å·åŒ–ã«åŸºã¥ãå®‰å…¨ãªã‚³ãƒ³ãƒ†ãƒŠã®è¦ä»¶ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TK-26</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ã‚ˆã£ã¦</font><font style="vertical-align: inherit;">æ–‡æ›¸ã€ŒR 50.1.112-2016ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆã‚­ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠãƒ¼</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã€ã“ã‚Œã¯ã€2016å¹´11æœˆ23æ—¥ä»˜ã‘ã®é€£é‚¦æŠ€è¡“è¦åˆ¶ãŠã‚ˆã³è¨ˆé‡ã«é–¢ã™ã‚‹é€£é‚¦æ©Ÿé–¢ã®å‘½ä»¤No. 1753-Artã«ã‚ˆã£ã¦æ‰¿èªãŠã‚ˆã³æ–½è¡Œã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MS CSPæš—å·ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‹ã‚‰PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’å–å¾—ã™ã‚‹æ–¹æ³•</font><font style="vertical-align: inherit;">ã¯ã€Habrã«é–¢ã™ã‚‹è¨˜äº‹ã®1ã¤ã«è©³ã—ã</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èª¬æ˜ã•</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PKCSï¼ƒ12ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ä»¥å‰ã«ä½œæˆã—ãŸ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TclPKCS11</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«åŠ ãˆã¦ã€2ã¤ã®æ–°ã—ã„tclãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é–‹ç™ºã™ã‚‹</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;">å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸ</font></font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">TK-26ã®æ¨å¥¨äº‹é …ã‚’è€ƒæ…®ã—ãŸã€ãƒ­ã‚·ã‚¢ã®æš—å·åŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹æœ€åˆã®Lccãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lccãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚³ãƒãƒ³ãƒ‰ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment">// Digest commands</span>
<span class="hljs-comment">// gost3411_2012</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012"</span>, gost3411_2012_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_ctx_create"</span>, gost3411_2012_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_ctx_update"</span>, gost3411_2012_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_ctx_final"</span>, gost3411_2012_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_ctx_delete"</span>, gost3411_2012_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost3411_94</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94"</span>, gost3411_94_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_ctx_create"</span>, gost3411_94_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_ctx_update"</span>, gost3411_94_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_ctx_final"</span>, gost3411_94_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_ctx_delete"</span>, gost3411_94_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// sha1</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_sha1"</span>, sha1_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_sha1_ctx_create"</span>, sha1_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_sha1_ctx_update"</span>, sha1_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_sha1_ctx_final"</span>, sha1_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_sha1_ctx_delete"</span>, sha1_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// HMAC commands</span>
<span class="hljs-comment">// gost3411hmac</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_hmac"</span>, gost3411_2012_hmac_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_hmac_ctx_create"</span>, gost3411_2012_hmac_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_hmac_ctx_update"</span>, gost3411_2012_hmac_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_hmac_ctx_final"</span>, gost3411_2012_hmac_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_hmac_ctx_delete"</span>, gost3411_2012_hmac_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost3411_94_hmac</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_hmac"</span>, gost3411_94_hmac_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_hmac_ctx_create"</span>, gost3411_94_hmac_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_hmac_ctx_update"</span>, gost3411_94_hmac_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_hmac_ctx_final"</span>, gost3411_94_hmac_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_hmac_ctx_delete"</span>, gost3411_94_hmac_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// PKCS#5 commands</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_pkcs5"</span>, gost3411_2012_pkcs5_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_pkcs5"</span>, gost3411_94_pkcs5_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// PKCS#12 PBA</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_pkcs12_pba"</span>, gost3411_94_pkcs12_pba_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost3411_2012 KDF</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_256_kdf"</span>, gost3411_2012_256_kdf_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_256_kdf_tree"</span>, gost3411_2012_256_kdf_tree_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// PRF TLS</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_94_prf_tls"</span>, gost3411_94_prf_tls_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_256_prf_tls"</span>, gost3411_2012_256_prf_tls_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3411_2012_512_prf_tls"</span>, gost3411_2012_512_prf_tls_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost3410-2012 commands</span>
<span class="hljs-comment">// 256 bits</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_getGroupByOid"</span>, gost3410_2012_256_getGroupByOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_getGroupByDerOid"</span>, gost3410_2012_256_getGroupByDerOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_getGroupById"</span>, gost3410_2012_256_getGroupById_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_createPrivateKey"</span>, gost3410_2012_256_createPrivateKey_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_createPublicKey"</span>, gost3410_2012_256_createPublicKey_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_sign"</span>, gost3410_2012_256_sign_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_verify"</span>, gost3410_2012_256_verify_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_vko"</span>, gost3410_2012_256_vko_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_256_keg"</span>, gost3410_2012_256_keg_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// 512 bits</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_getGroupByOid"</span>, gost3410_2012_512_getGroupByOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_getGroupByDerOid"</span>, gost3410_2012_512_getGroupByDerOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_getGroupById"</span>, gost3410_2012_512_getGroupById_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_createPrivateKey"</span>, gost3410_2012_512_createPrivateKey_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_createPublicKey"</span>, gost3410_2012_512_createPublicKey_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_sign"</span>, gost3410_2012_512_sign_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_verify"</span>, gost3410_2012_512_verify_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_vko"</span>, gost3410_2012_512_vko_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2012_512_keg"</span>, gost3410_2012_512_keg_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost3410-2001-vko (with 3411-94)</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost3410_2001_vko"</span>, gost3410_2001_vko_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// Magma commands</span>
<span class="hljs-comment">// ECB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ecb_ctx_create"</span>, magma_ecb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ecb_ctx_update"</span>, magma_ecb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ecb_ctx_delete"</span>, magma_ecb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CBC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cbc_ctx_create"</span>, magma_cbc_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cbc_ctx_update"</span>, magma_cbc_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cbc_ctx_delete"</span>, magma_cbc_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CTR</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_ctx_create"</span>, magma_ctr_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_ctx_update"</span>, magma_ctr_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_ctx_delete"</span>, magma_ctr_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OFB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ofb_ctx_create"</span>, magma_ofb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ofb_ctx_update"</span>, magma_ofb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ofb_ctx_delete"</span>, magma_ofb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CFB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cfb_ctx_create"</span>, magma_cfb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cfb_ctx_update"</span>, magma_cfb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_cfb_ctx_delete"</span>, magma_cfb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OMAC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_ctx_create"</span>, magma_omac_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_ctx_update"</span>, magma_omac_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_ctx_final"</span>, magma_omac_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_ctx_delete"</span>, magma_omac_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CTR_ACPKM</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_acpkm_ctx_create"</span>, magma_ctr_acpkm_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_acpkm_ctx_update"</span>, magma_ctr_acpkm_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_ctr_acpkm_ctx_delete"</span>, magma_ctr_acpkm_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OMAC_ACPKM</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_acpkm_ctx_create"</span>, magma_omac_acpkm_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_acpkm_ctx_update"</span>, magma_omac_acpkm_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_acpkm_ctx_final"</span>, magma_omac_acpkm_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_omac_acpkm_ctx_delete"</span>, magma_omac_acpkm_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// key export/import</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_key_export"</span>, magma_key_export_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_magma_key_import"</span>, magma_key_import_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// Kuznyechik commands</span>
<span class="hljs-comment">// ECB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ecb_ctx_create"</span>, kuznyechik_ecb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ecb_ctx_update"</span>, kuznyechik_ecb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ecb_ctx_delete"</span>, kuznyechik_ecb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CBC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cbc_ctx_create"</span>, kuznyechik_cbc_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cbc_ctx_update"</span>, kuznyechik_cbc_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cbc_ctx_delete"</span>, kuznyechik_cbc_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CTR</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_ctx_create"</span>, kuznyechik_ctr_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_ctx_update"</span>, kuznyechik_ctr_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_ctx_delete"</span>, kuznyechik_ctr_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OFB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ofb_ctx_create"</span>, kuznyechik_ofb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ofb_ctx_update"</span>, kuznyechik_ofb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ofb_ctx_delete"</span>, kuznyechik_ofb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CFB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cfb_ctx_create"</span>, kuznyechik_cfb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cfb_ctx_update"</span>, kuznyechik_cfb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_cfb_ctx_delete"</span>, kuznyechik_cfb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OMAC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_ctx_create"</span>, kuznyechik_omac_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_ctx_update"</span>, kuznyechik_omac_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_ctx_final"</span>, kuznyechik_omac_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_ctx_delete"</span>, kuznyechik_omac_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CTR_ACPKM</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_acpkm_ctx_create"</span>, kuznyechik_ctr_acpkm_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_acpkm_ctx_update"</span>, kuznyechik_ctr_acpkm_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_ctr_acpkm_ctx_delete"</span>, kuznyechik_ctr_acpkm_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OMAC_ACPKM</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_acpkm_ctx_create"</span>, kuznyechik_omac_acpkm_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_acpkm_ctx_update"</span>, kuznyechik_omac_acpkm_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_acpkm_ctx_final"</span>, kuznyechik_omac_acpkm_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_omac_acpkm_ctx_delete"</span>, kuznyechik_omac_acpkm_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// key export/import</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_key_export"</span>, kuznyechik_key_export_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_kuznyechik_key_import"</span>, kuznyechik_key_import_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// gost28147 commands</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_getParamsByOid"</span>, gost28147_getParamsByOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_getParamsByDerOid"</span>, gost28147_getParamsByDerOid_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_getParamsById"</span>, gost28147_getParamsById_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// ECB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_ecb_ctx_create"</span>, gost28147_ecb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_ecb_ctx_update"</span>, gost28147_ecb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_ecb_ctx_delete"</span>, gost28147_ecb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CBC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cbc_ctx_create"</span>, gost28147_cbc_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cbc_ctx_update"</span>, gost28147_cbc_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cbc_ctx_delete"</span>, gost28147_cbc_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CNT</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cnt_ctx_create"</span>, gost28147_cnt_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cnt_ctx_update"</span>, gost28147_cnt_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cnt_ctx_delete"</span>, gost28147_cnt_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// CFB</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cfb_ctx_create"</span>, gost28147_cfb_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cfb_ctx_update"</span>, gost28147_cfb_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_cfb_ctx_delete"</span>, gost28147_cfb_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// OMAC</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_omac_ctx_create"</span>, gost28147_omac_ctx_create_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_omac_ctx_update"</span>, gost28147_omac_ctx_update_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_omac_ctx_final"</span>, gost28147_omac_ctx_final_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<font></font>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_omac_ctx_delete"</span>, gost28147_omac_ctx_delete_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
<span class="hljs-comment">// KDF</span>
Tcl_CreateObjCommand(interp, <span class="hljs-string">"lcc_gost28147_kdf"</span>, gost28147_kdf_Cmd, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);</code></pre></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã”è¦§ã®ã¨ãŠã‚Šã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã¯GOST R 34.10-2012ã¨GOST R 34.11-2012ã ã‘ã§ãªãã€æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ Grasshopperã¨Magmaã‚‚ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8u/qg/hk/8uqghkhec2x6wgcfitomv8nl7vu.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2ç•ªç›®ã®GostPfxãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€PKCSï¼ƒ11ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’è§£æã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€èªå®šã•ã‚ŒãŸæš—å·åŒ–æƒ…å ±ä¿è­·ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚ã“ã®ç´°å¿ƒã®æ³¨æ„ã‚’æ‰•ã£ãŸä½œæ¥­ã¯</font><font style="vertical-align: inherit;">ã€ç§ãŸã¡ã®å‡ºç‰ˆç‰©ã§ã‚ã‚‹V. Blazhnovã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šãã®ã‚¤ãƒ©ã‚¹ãƒˆ</font></font></font> </a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®è‘—è€…ã§ã‚ã‚‹åŒåƒšã‚„åŒå¿—ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œ</font><font style="vertical-align: inherit;">ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å®Ÿè£…ã«ã‚ˆã‚Šã€é›»å­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ä¾å­˜ã—ãªã„ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½œæˆã§ãã¾ã—ãŸã€‚ Tclã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã§PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’æ“ä½œã™ã‚‹ã¨ã€èˆˆå‘³æ·±ã„æ©Ÿèƒ½ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">openssl</font></font></a><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—ã¦ä½œæˆã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠãƒ¼</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ã‚·ã‚¢ã®æš—å·åŒ–ã®ã‚µãƒãƒ¼ãƒˆã«ã‚ˆã‚Šã€å³å¯†ã«DERã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ä½œæˆã•ã‚Œã€NSSãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ä½œæˆã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã¯ã€é•·ã•ãŒä¸æ˜ç¢ºãªã‚¿ã‚°ã‚’ä½¿ç”¨ã™ã‚‹BERã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ä½œæˆã•ã‚Œã¾ã™ï¼ˆã‚¿ã‚°ã®é•·ã•ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã¯0x80ãŒå«ã¾ã‚Œã¾ã™ï¼‰ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€æ¨™æº–ã®Tcl asnãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’è§£æã™ã‚‹ã¨ã€BERã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸasnæ§‹é€ ã‚’ç†è§£ã—ã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">    if {$length == 0x080} {<font></font>
        return -code error "Indefinite length BER encoding not yet supported"<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
asnãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åˆ†æã«ã‚ˆã‚Šã€:: asn :: asnGetLengthé–¢æ•°ã‚’ç½®ãæ›ãˆã‚‹ã ã‘ã§ååˆ†ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">package require asn<font></font>
#  <font></font>
rename ::asn::asnGetLength ::asn::asnGetLength.orig<font></font>
#  <font></font>
proc ::asn::asnGetLength {data_var length_var} {<font></font>
    upvar 1 $data_var data  $length_var length<font></font>
    asnGetByte data length<font></font>
    if {$length == 0x080} {<font></font>
#    <font></font>
# Indefinite length BER encoding yet supported<font></font>
	set lendata [string length $data]<font></font>
	set tvl 1<font></font>
	set length 0<font></font>
	set data1 $data<font></font>
	while {$tvl != 0} {<font></font>
	    ::asn::asnGetByte data1 peek_tag <font></font>
	    ::asn::asnPeekByte data1 peek_tag1<font></font>
#   <font></font>
	    if {$peek_tag == 0x00 &amp;&amp; $peek_tag1 == 0x00} {<font></font>
		incr tvl -1<font></font>
		::asn::asnGetByte data1 tag <font></font>
		incr length 2<font></font>
		continue<font></font>
	    }<font></font>
#   <font></font>
	    if {$peek_tag1 == 0x80} {<font></font>
		incr tvl<font></font>
		if {$tvl &gt; 0} {<font></font>
		    incr length 2<font></font>
		}<font></font>
		::asn::asnGetByte data1 tag <font></font>
	    } else {<font></font>
		set l1 [string length $data1]<font></font>
		::asn::asnGetLength data1 ll<font></font>
		set l2 [string length $data1]<font></font>
		set l3 [expr $l1 - $l2]<font></font>
		incr length $l3<font></font>
		incr length $ll<font></font>
		incr length<font></font>
		::asn::asnGetBytes data1 $ll strt<font></font>
	    }<font></font>
	}<font></font>
	return<font></font>
#        return -code error "Indefinite length BER encoding not yet supported"<font></font>
    }<font></font>
    if {$length &gt; 0x080} {<font></font>
    # The retrieved byte is a prefix value, and the integer in the<font></font>
    # lower nibble tells us how many bytes were used to encode the<font></font>
    # length data following immediately after this prefix.<font></font>
        set len_length [expr {$length &amp; 0x7f}]<font></font>
        if {[string length $data] &lt; $len_length} {<font></font>
            return -code error \<font></font>
		"length information invalid, not enough octets left" <font></font>
        }<font></font>
        asnGetBytes data $len_length lengthBytes<font></font>
        switch $len_length {<font></font>
            1 { binary scan $lengthBytes     cu length }<font></font>
            2 { binary scan $lengthBytes     Su length }<font></font>
            3 { binary scan \x00$lengthBytes Iu length }<font></font>
            4 { binary scan $lengthBytes     Iu length }<font></font>
            default {                <font></font>
                binary scan $lengthBytes H* hexstr<font></font>
		scan $hexstr %llx length<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
    return<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚ˆã†ãªãªã‚Šã™ã¾ã—ã«ã‚ˆã‚Šã€ä¸ç‰¹å®šã®é•·ã•ã®ã‚¿ã‚°ã‚’å‡¦ç†ã§ãã¾ã™ã€‚ </font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’è§£æã™ã‚‹ãŸã‚ã«ã€GostPfxãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä½œæˆã•ã‚Œã¾ã™ã€‚</font></font></b>
                        <div class="spoiler_text"><pre><code class="plaintext hljs"><font></font>
set OS [lindex $tcl_platform(os) 0]<font></font>
#   Lcc<font></font>
#   Lrnd<font></font>
<font></font>
namespace eval ::GostPfx {<font></font>
  namespace export pfxParse pfxMacDataParse pfxGetAuthSafeTbs pfxHmacVerify<font></font>
  namespace export pfxTbsParse pfxPbeDataParse pfxPbeKey pfxDataDecrypt<font></font>
  namespace export pfxIdentityDataParse pfxCertBagsParse pfxKeyBagsParse<font></font>
  namespace export pfxKeyBagDecrypt pfxKeyDataParse pfxDataEncrypt<font></font>
  namespace export pfxCreateSingleCertKey pfxGetSingleCertKey pfxCreateLocalKeyID <font></font>
  <font></font>
  variable INTEGER_TAG 2<font></font>
  variable OCTET_STRING_TAG 4<font></font>
  variable OBJECT_IDENTIFIER_TAG 6<font></font>
  variable SEQUENCE_TAG 16<font></font>
  variable SET_TAG 17<font></font>
  variable BMP_STRING_TAG 30 <font></font>
<font></font>
  variable oid_Gost_3411_94 "1 2 643 2 2 9"<font></font>
  variable oid_Gost3411_2012_512 "1 2 643 7 1 1 2 3"<font></font>
  variable oid_pkcs7_data "1 2 840 113549 1 7 1"<font></font>
  variable oid_pkcs7_encrypted_data "1 2 840 113549 1 7 6"<font></font>
  variable oid_pkcs5PBES2 "1 2 840 113549 1 5 13"<font></font>
  variable oid_pBKDF2 "1 2 840 113549 1 5 12"<font></font>
  variable oid_HMACgostR3411_94 "1 2 643 2 2 10"<font></font>
  variable oid_tc26_hmac_gost_3411_2012_512 "1 2 643 7 1 1 4 2"<font></font>
  variable oid_gost28147_89 "1 2 643 2 2 21"<font></font>
  variable oid_PKCS12CertificateBag "1 2 840 113549 1 12 10 1 3"<font></font>
  variable oid_PKCS9x509Certificate "1 2 840 113549 1 9 22 1"<font></font>
  variable oid_friendlyName "1 2 840 113549 1 9 20"<font></font>
  variable oid_localKeyID "1 2 840 113549 1 9 21"<font></font>
  variable oid_pkcs8ShroudedKeyBag "1 2 840 113549 1 12 10 1 2"<font></font>
  variable oid_tc26_gost_28147_89_param_A "1 2 643 7 1 2 5 1 1"<font></font>
  variable oid_GostR3410_2001 "1 2 643 2 2 19"<font></font>
  variable oid_GostR3411_94_with_GostR3410_2001 "1 2 643 2 2 3"<font></font>
  variable oid_tc26_gost3410_2012_256 "1 2 643 7 1 1 1 1"<font></font>
  variable oid_tc26_signwithdigest_gost3410_2012_256 "1 2 643 7 1 1 3 2"<font></font>
  variable oid_tc26_gost3410_2012_512 "1 2 643 7 1 1 1 2"<font></font>
  variable oid_tc26_signwithdigest_gost3410_2012_256 "1 2 643 7 1 1 3 3"<font></font>
  <font></font>
}<font></font>
proc reverse {args} {<font></font>
    set res [list]<font></font>
    if {[llength $args] == 1} {<font></font>
        set args [lindex $args 0]<font></font>
    }<font></font>
    foreach elem $args {<font></font>
        set res [linsert $res 0 $elem]<font></font>
    }<font></font>
    return $res<font></font>
}<font></font>
#-----------------------------------------------------------------------------<font></font>
# asnGetOctetString : Retrieve arbitrary string.<font></font>
#-----------------------------------------------------------------------------<font></font>
proc ::asn::asnGet24OctetString {data_var string_var} {<font></font>
    # Here we need the full decoder for length data.<font></font>
<font></font>
    upvar 1 $data_var data $string_var string<font></font>
    <font></font>
    asnGetByte data tag<font></font>
    if {$tag != 0x24} { <font></font>
        return -code error \<font></font>
            [format "Expected Octet String 24 (0x24), but got %02x" $tag]<font></font>
    }<font></font>
    asnGetLength data length<font></font>
    asnGetBytes  data $length temp<font></font>
    set string $temp<font></font>
    return<font></font>
}<font></font>
<font></font>
<font></font>
# indata =&gt; dict: authSafe macData digestAlg digestParamset hmac <font></font>
proc ::GostPfx::pfxParse {indata} {<font></font>
  variable INTEGER_TAG <font></font>
  variable SEQUENCE_TAG<font></font>
  <font></font>
  set data $indata<font></font>
  set dres [dict create]<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue<font></font>
    set tag_len [asn::asnPeekTag seqValue tag_var tag_type_var constr_var]<font></font>
<font></font>
    if {$tag_var == $INTEGER_TAG} {<font></font>
      asn::asnGetInteger seqValue version<font></font>
      dict set dres "version" $version<font></font>
    } else {<font></font>
      error "pfxParse: Invalid PFX DER structure 1 tag=$tag_var"<font></font>
    }    <font></font>
    set tag_len [asn::asnPeekTag seqValue tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue authSafe<font></font>
      dict set dres "authSafe" $authSafe<font></font>
    } else {<font></font>
      error "pfxParse: Invalid PFX DER structure 2"<font></font>
    }    <font></font>
    set tag_len [asn::asnPeekTag seqValue tag_var tag_type_var constr_var]<font></font>
    # Optional<font></font>
    if {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue macData<font></font>
      dict set dres "macData" $macData<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxParse: Invalid PFX DER structure 3"<font></font>
  }<font></font>
  return $dres<font></font>
}<font></font>
<font></font>
# macData =&gt; dict: salt iter <font></font>
proc ::GostPfx::pfxMacDataParse {macData} {<font></font>
  variable INTEGER_TAG <font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable SEQUENCE_TAG<font></font>
<font></font>
  set data $macData<font></font>
  set dres [dict create]<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue1<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue1 seqValue2<font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue2 digestAlg<font></font>
        dict set dres "digestAlg" $digestAlg<font></font>
      } else {<font></font>
        error "pfxMacDataParse: Invalid MAC data structure"<font></font>
      }  <font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      # Optional<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue2 digestParamset<font></font>
        dict set dres "digestParamset" $digestParamset<font></font>
      }<font></font>
    }<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $OCTET_STRING_TAG} {<font></font>
      asn::asnGetOctetString seqValue1 hmac<font></font>
      dict set dres "hmac" $hmac    <font></font>
    }  else {<font></font>
      error "pfxMacDataParse: Invalid MAC data structure"<font></font>
    }  <font></font>
  } else {<font></font>
    error "pfxMacDataParse: Invalid MAC data structure"<font></font>
  }  <font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $OCTET_STRING_TAG} {<font></font>
    asn::asnGetOctetString data salt<font></font>
    dict set dres "salt" $salt<font></font>
  } else {<font></font>
    error "pfxMacDataParse: Invalid MAC data structure"<font></font>
  }  <font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $INTEGER_TAG} {<font></font>
    asn::asnGetInteger data iter<font></font>
    dict set dres "iter" $iter<font></font>
  } else {<font></font>
    error "pfxMacDataParse: Invalid MAC data structure"<font></font>
  }    <font></font>
  return $dres <font></font>
}<font></font>
<font></font>
# authSafeData =&gt; tbs<font></font>
proc ::GostPfx::pfxGetAuthSafeTbs {authSafeData} {<font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG<font></font>
<font></font>
  set data $authSafeData<font></font>
  set tbs ""<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
    asn::asnGetObjectIdentifier data oid<font></font>
  } else {<font></font>
    error "pfxGetAuthSafeTbs: Invalid AuthSafe structure"<font></font>
  }<font></font>
<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_type_var == "CONTEXT"} {<font></font>
    asn::asnGetContext data contextNumber contextVar encoding_type<font></font>
    ::asn::asnPeekByte contextVar peek_tag <font></font>
    ::asn::asnPeekByte contextVar peek_tag1 1<font></font>
	if {$peek_tag == 0x24 &amp;&amp; $peek_tag1 == 0x80} {<font></font>
	    set contextVar1 $contextVar<font></font>
	    ::asn::asnGet24OctetString contextVar1 contextVar<font></font>
	    puts "pfxGetAuthSafeTbs=0x240x80"<font></font>
	}<font></font>
    set tag_len [asn::asnPeekTag contextVar tag_var tag_type_var constr_var]<font></font>
<font></font>
    if {$tag_var == $OCTET_STRING_TAG} {<font></font>
      asn::asnGetOctetString contextVar tbs<font></font>
    } else {<font></font>
      error "pfxGetAuthSafeTbs: Invalid AuthSafe structure"<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxGetAuthSafeTbs: Invalid AuthSafe structure"<font></font>
  }<font></font>
  return $tbs<font></font>
}<font></font>
<font></font>
#    PBA      UTF-16  BOM<font></font>
#      .<font></font>
#     unicode    <font></font>
#        .   <font></font>
proc ::GostPfx::passwordToUtf16 {password} {<font></font>
  binary scan [encoding convertto unicode $password] c* bytes<font></font>
  set bytes_len [llength $bytes]<font></font>
  for {set i 0} {$i &lt; $bytes_len} {incr i 2} {<font></font>
    set left [lindex $bytes $i]<font></font>
    set right [lindex $bytes [expr {$i+1}]]<font></font>
    lset bytes $i $right<font></font>
    lset bytes [expr {$i+1}] $left<font></font>
  }<font></font>
  lappend bytes 0 0<font></font>
  set out [binary format c* $bytes]<font></font>
  return $out<font></font>
}<font></font>
<font></font>
# returns 1 or 0<font></font>
proc ::GostPfx::pfxHmacVerify {tbs hmac password hmacDigestAlg hmacKeySalt hmacKeyIter} {<font></font>
  variable oid_Gost_3411_94 <font></font>
  variable oid_Gost3411_2012_512<font></font>
  <font></font>
  if {$hmacDigestAlg == $oid_Gost_3411_94} {  <font></font>
    set passwordUtf16 [passwordToUtf16 $password]<font></font>
    set hmacPbaKey [lcc_gost3411_94_pkcs12_pba $passwordUtf16 $hmacKeySalt $hmacKeyIter]<font></font>
    set hmacPba [lcc_gost3411_94_hmac $tbs $hmacPbaKey]<font></font>
    if {$hmacPba != $hmac} {<font></font>
      #     26 v 1.0  HMAC   -<font></font>
      set hmacPbaKey [string range [lcc_gost3411_94_pkcs5 $password $hmacKeySalt $hmacKeyIter 96] 64 95]<font></font>
      set hmacPba [lcc_gost3411_94_hmac $tbs $hmacPbaKey]<font></font>
      if {$hmacPba != $hmac} {<font></font>
        #puts "hmacPba != hmac"<font></font>
      } else {<font></font>
        #puts "TC 26 v 1.0 PBA HMAC OK"<font></font>
        return 1<font></font>
      }<font></font>
    } else {<font></font>
      #puts "Obsolete PBA HMAC OK"<font></font>
      return 1<font></font>
    }<font></font>
  } else {<font></font>
    if {$hmacDigestAlg == $oid_Gost3411_2012_512} {<font></font>
      set hmacPbaKey [string range [lcc_gost3411_2012_pkcs5 $password $hmacKeySalt $hmacKeyIter 96] 64 95]<font></font>
      set hmacPba [lcc_gost3411_2012_hmac 64 $tbs $hmacPbaKey]<font></font>
      if {$hmacPba != $hmac} {<font></font>
        #puts "hmacPba != hmac"<font></font>
      } else {<font></font>
        #puts "TC 26 v 2.0 PBA HMAC OK"<font></font>
        return 1<font></font>
      }<font></font>
    } else {<font></font>
      error "pfxHmacVerify: Unsupported digest algorithm: $hmacDigestAlg"<font></font>
    }<font></font>
  }<font></font>
  return 0<font></font>
}<font></font>
<font></font>
proc ::GostPfx::p7mParse {p7m} {<font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable SEQUENCE_TAG <font></font>
  variable INTEGER_TAG<font></font>
  variable oid_pkcs7_data <font></font>
<font></font>
    set seqValue2 $p7m<font></font>
    set dres [dict create]<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_type_var == "CONTEXT"} {<font></font>
            asn::asnGetContext seqValue2 contextNumber contextData encoding_type<font></font>
            set tag_len [asn::asnPeekTag contextData tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $SEQUENCE_TAG} {<font></font>
              asn::asnGetSequence contextData seqValue3<font></font>
              set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
              if {$tag_var == $INTEGER_TAG} {<font></font>
                asn::asnGetInteger seqValue3 version<font></font>
                set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                if {$tag_var == $SEQUENCE_TAG} {<font></font>
                  asn::asnGetSequence seqValue3 seqValue4<font></font>
                  set tag_len [asn::asnPeekTag seqValue4 tag_var tag_type_var constr_var]<font></font>
                  if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                    asn::asnGetObjectIdentifier seqValue4 oid2<font></font>
                    if {$oid2 == $oid_pkcs7_data} {<font></font>
                      set tag_len [asn::asnPeekTag seqValue4 tag_var tag_type_var constr_var]<font></font>
                      if {$tag_var == $SEQUENCE_TAG} {<font></font>
                        asn::asnGetSequence seqValue4 certsPbeData                  <font></font>
                        dict set dres "certsPbeData" $certsPbeData<font></font>
                        set tag_len [asn::asnPeekTag seqValue4 tag_var tag_type_var constr_var]<font></font>
                        if {$tag_type_var == "CONTEXT"} {<font></font>
			  ::asn::asnPeekByte seqValue4 peek_tag <font></font>
			  ::asn::asnPeekByte seqValue4 peek_tag1 1<font></font>
			  if {$peek_tag == 0xA0 &amp;&amp; $peek_tag1 == 0x80} {<font></font>
				set seqValue4_80 $seqValue4<font></font>
				set seqValue4 [string range $seqValue4_80 2 {end-2}]<font></font>
                        	asn::asnGetOctetString seqValue4 encrCerts <font></font>
			  } else {<font></font>
                            asn::asnGetContext seqValue4 contextNumber encrCerts encoding_type<font></font>
                          }<font></font>
                          dict set dres "encrCerts" $encrCerts<font></font>
                        } else {<font></font>
                          error "pfxTbsParse: Invalid encrypted certificates structure 1"<font></font>
                        }  <font></font>
                      } else {<font></font>
                        error "pfxTbsParse: Invalid encrypted certificates structure 2"<font></font>
                      }<font></font>
                    } else {<font></font>
                      error "pfxTbsParse: Invalid encrypted certificates structure 3"<font></font>
                    }<font></font>
                  } else {<font></font>
                    error "pfxTbsParse: Invalid encrypted certificates structure 4"<font></font>
                  }<font></font>
                } else {<font></font>
                  error "pfxTbsParse: Invalid encrypted certificates structure 5"<font></font>
                }<font></font>
              } else {<font></font>
                error "pfxTbsParse: Invalid encrypted certificates structure 6"<font></font>
              }<font></font>
            } else {<font></font>
              error "pfxTbsParse: Invalid encrypted certificates structure 7"<font></font>
            }<font></font>
          } else {<font></font>
              error "pfxTbsParse: Invalid encrypted certificates structure 8"<font></font>
    	  }<font></font>
    	  return $dres<font></font>
}<font></font>
<font></font>
proc ::GostPfx::p7dParse {p7d} {<font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable SEQUENCE_TAG <font></font>
  variable INTEGER_TAG<font></font>
  variable oid_pkcs7_data <font></font>
    set dres [dict create]<font></font>
<font></font>
    set seqValue2 $p7d<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_type_var == "CONTEXT"} {<font></font>
            asn::asnGetContext seqValue2 contextNumber contextData encoding_type<font></font>
##############<font></font>
	    ::asn::asnPeekByte contextData peek_tag <font></font>
	    ::asn::asnPeekByte contextData peek_tag1 1<font></font>
	    if {$peek_tag == 0x24 &amp;&amp; $peek_tag1 == 0x80} {<font></font>
		set contextVar1 $contextData<font></font>
		::asn::asnGet24OctetString contextVar1 contextData<font></font>
		puts "p7dParse=0x240x80"<font></font>
	    }<font></font>
#################<font></font>
            set tag_len [asn::asnPeekTag contextData tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $OCTET_STRING_TAG} {<font></font>
              asn::asnGetOctetString contextData keyBags<font></font>
              dict set dres "keyBags" $keyBags<font></font>
            } else {<font></font>
              error "pfxTbsParse: Invalid key bags structure 1"<font></font>
            }<font></font>
          } else {<font></font>
            error "pfxTbsParse: Invalid key bags structure 2"<font></font>
          }<font></font>
<font></font>
    	  return $dres<font></font>
}<font></font>
<font></font>
# tbs =&gt; dict: keyBags certsPbeData encrCerts<font></font>
proc ::GostPfx::pfxTbsParse {tbs} {<font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable SEQUENCE_TAG <font></font>
  variable INTEGER_TAG<font></font>
  variable oid_pkcs7_data <font></font>
  variable oid_pkcs7_encrypted_data<font></font>
  <font></font>
  set data $tbs<font></font>
  set dres [dict create]<font></font>
#  set dres [list]<font></font>
<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue1<font></font>
<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue1 seqValue2<font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue2 oid2<font></font>
<font></font>
        if {$oid2 == $oid_pkcs7_encrypted_data} {<font></font>
	  set dres [::GostPfx::p7mParse $seqValue2]<font></font>
        } elseif {$oid2 == $oid_pkcs7_data} {<font></font>
#    	    set gg [dict create]<font></font>
    	    set gg [list]<font></font>
	    set gg [::GostPfx::p7dParse $seqValue2]<font></font>
	    foreach {l l1} $gg {<font></font>
		dict set dres $l $l1<font></font>
	    }<font></font>
<font></font>
	} else {<font></font>
          error "pfxTbsParse: Invalid encrypted certificates structure 9 oid2=$oid2, oid_pkcs7_encrypted_data=$oid_pkcs7_encrypted_data"<font></font>
        }        <font></font>
      } else {<font></font>
        error "pfxTbsParse: Invalid encrypted certificates structure 10"<font></font>
      }<font></font>
    }<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue1 seqValue2<font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue2 oid2<font></font>
        if {$oid2 == $oid_pkcs7_data} {<font></font>
#    	    set gg [dict create]<font></font>
    	    set gg [list]<font></font>
	    set gg [::GostPfx::p7dParse $seqValue2]<font></font>
	    foreach {l l1} $gg {<font></font>
		dict set dres $l $l1<font></font>
	    }<font></font>
<font></font>
        } elseif {$oid2 == $oid_pkcs7_encrypted_data} {<font></font>
    	    set gg [list]<font></font>
	    set gg [::GostPfx::p7mParse $seqValue2]<font></font>
	    foreach {l l1} $gg {<font></font>
		dict set dres $l $l1<font></font>
	    }<font></font>
        } else {<font></font>
          error "pfxTbsParse: Invalid key bags structure 3"<font></font>
        }<font></font>
      } else {<font></font>
        error "pfxTbsParse: Invalid key bags structure 4"<font></font>
      }<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxTbsParse: Invalid TBS structure 5"<font></font>
  }<font></font>
  return $dres<font></font>
}<font></font>
<font></font>
# oid_pkcs5PBES2, ... =&gt; dict: hmacKeySalt hmacKeyIter hmacAlg digestParamset cipherAlg cipherIV cipherParamset<font></font>
proc ::GostPfx::pfxPbeDataParse {pbeData} {<font></font>
  variable OCTET_STRING_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable SEQUENCE_TAG <font></font>
  variable INTEGER_TAG<font></font>
  variable oid_pkcs5PBES2 <font></font>
  variable oid_pBKDF2<font></font>
  <font></font>
  set data $pbeData<font></font>
  set dres [dict create]<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
    asn::asnGetObjectIdentifier data oid1<font></font>
    if {$oid1 == $oid_pkcs5PBES2} {<font></font>
      set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $SEQUENCE_TAG} {<font></font>
        asn::asnGetSequence data seqValue1<font></font>
        set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
        if {$tag_var == $SEQUENCE_TAG} {<font></font>
          asn::asnGetSequence seqValue1 seqValue2<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
            asn::asnGetObjectIdentifier seqValue2 oid2<font></font>
            if {$oid2 == $oid_pBKDF2} {<font></font>
              set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
              if {$tag_var == $SEQUENCE_TAG} {<font></font>
                asn::asnGetSequence seqValue2 seqValue3<font></font>
                set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                 if {$tag_var == $OCTET_STRING_TAG} {<font></font>
                  asn::asnGetOctetString seqValue3 hmacKeySalt<font></font>
                  dict set dres "hmacKeySalt" $hmacKeySalt<font></font>
                  set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                  if {$tag_var == $INTEGER_TAG} {<font></font>
                    asn::asnGetInteger seqValue3 hmacKeyIter<font></font>
                    dict set dres "hmacKeyIter" $hmacKeyIter<font></font>
                    set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                    if {$tag_var == $SEQUENCE_TAG} {<font></font>
                      asn::asnGetSequence seqValue3 seqValue4<font></font>
                      set tag_len [asn::asnPeekTag seqValue4 tag_var tag_type_var constr_var]<font></font>
                      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                        asn::asnGetObjectIdentifier seqValue4 hmacAlg<font></font>
                        dict set dres "hmacAlg" $hmacAlg<font></font>
                        set tag_len [asn::asnPeekTag seqValue4 tag_var tag_type_var constr_var]<font></font>
                        if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                          asn::asnGetObjectIdentifier seqValue4 digestParamset<font></font>
                          dict set dres "digestParamset" $digestParamset<font></font>
                        } <font></font>
                      } else {<font></font>
                        error "pfxPbeDataParse: Invalid PBKDF2 HMAC algorithm structure"<font></font>
                      }<font></font>
                    } else {<font></font>
                      error "pfxPbeDataParse: Invalid PBKDF2 HMAC algorithm structure"<font></font>
                    }                    <font></font>
                  } else {<font></font>
                    error "pfxPbeDataParse: Invalid PBKDF2 iteration count structure"<font></font>
                  }<font></font>
                } else {<font></font>
                  error "pfxPbeDataParse: Invalid PBKDF2 salt structure"<font></font>
                }<font></font>
              } else {<font></font>
                error "pfxPbeDataParse: Invalid PBKDF2 structure"<font></font>
              }              <font></font>
            } else {<font></font>
              error "pfxPbeDataParse: Invalid PBKDF2 structure"<font></font>
            }<font></font>
          } else {<font></font>
            error "pfxPbeDataParse: Invalid PBKDF2 structure"<font></font>
          }  <font></font>
        }<font></font>
        set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
        if {$tag_var == $SEQUENCE_TAG} {<font></font>
          asn::asnGetSequence seqValue1 seqValue2<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
            asn::asnGetObjectIdentifier seqValue2 cipherAlg<font></font>
            dict set dres "cipherAlg" $cipherAlg<font></font>
            set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $SEQUENCE_TAG} {<font></font>
              asn::asnGetSequence seqValue2 seqValue3<font></font>
              set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
              if {$tag_var == $OCTET_STRING_TAG} {<font></font>
                asn::asnGetOctetString seqValue3 cipherIV<font></font>
                dict set dres "cipherIV" $cipherIV<font></font>
                set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                  asn::asnGetObjectIdentifier seqValue3 cipherParamset<font></font>
                  dict set dres "cipherParamset" $cipherParamset<font></font>
                }<font></font>
              } else {<font></font>
                error "pfxPbeDataParse: Invalid PBE cipher IV structure"<font></font>
              }<font></font>
            } else {<font></font>
              error "pfxPbeDataParse: Invalid PBE cipher params structure"<font></font>
            }<font></font>
          } else {<font></font>
            error "pfxPbeDataParse: Invalid PBE cipher algorithm structure"<font></font>
          }<font></font>
        } else {<font></font>
          error "pfxPbeDataParse: Invalid PBE cipher algorithm structure"<font></font>
        }        <font></font>
      } else {<font></font>
        error "pfxPbeDataParse: Invalid PBE structure" <font></font>
      }<font></font>
    } else {<font></font>
      error "pfxPbeDataParse: Invalid PBE structure" <font></font>
    }<font></font>
  } else {<font></font>
    error "pfxPbeDataParse: Invalid PBE structure" <font></font>
  }<font></font>
  return $dres<font></font>
}<font></font>
<font></font>
# generates cipher key<font></font>
proc ::GostPfx::pfxPbeKey {password hmacAlg hmacKeySalt hmacKeyIter} {<font></font>
  variable oid_HMACgostR3411_94 <font></font>
  variable oid_tc26_hmac_gost_3411_2012_512<font></font>
  <font></font>
  set key ""<font></font>
  if {$hmacAlg == $oid_HMACgostR3411_94} {<font></font>
    set key [lcc_gost3411_94_pkcs5 $password $hmacKeySalt $hmacKeyIter 32]<font></font>
  } else {<font></font>
    if {$hmacAlg == $oid_tc26_hmac_gost_3411_2012_512} {<font></font>
      set key [lcc_gost3411_2012_pkcs5 $password $hmacKeySalt $hmacKeyIter 32]<font></font>
    } else {<font></font>
      error "pfxPbeKey: Unsupported PKCS5 HMAC algorithm $hmacAlg"<font></font>
    }<font></font>
  }<font></font>
  return $key<font></font>
}<font></font>
<font></font>
# encrData =&gt; decrData<font></font>
proc ::GostPfx::pfxDataDecrypt {data alg paramset key iv} {<font></font>
  variable oid_gost28147_89<font></font>
puts "pfxDataDecrypt: paramset=$paramset"<font></font>
<font></font>
  set out ""<font></font>
  if {$alg == $oid_gost28147_89} {<font></font>
    set dotted_paramset [string map {" " "."} $paramset]<font></font>
    set par [lcc_gost28147_getParamsByOid $dotted_paramset]<font></font>
    if {$par &gt; 0} {<font></font>
      set ctx [lcc_gost28147_cfb_ctx_create $par 0 $key $iv]<font></font>
      if {$ctx &gt; 0} {<font></font>
        set out [lcc_gost28147_cfb_ctx_update $ctx $data]<font></font>
        lcc_gost28147_cfb_ctx_delete $ctx<font></font>
      } else {<font></font>
        error "pfxDataDecrypt: Invalid cipher key or IV"<font></font>
      }<font></font>
      lcc_handle_free $par<font></font>
    } else {<font></font>
      error "pfxDataDecrypt: Unsupported cipher paramset $paramset"<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxDataDecrypt: Unsupported cipher algorithm $alg"  <font></font>
  }<font></font>
  return $out<font></font>
} <font></font>
<font></font>
# plain data =&gt; encrData<font></font>
proc ::GostPfx::pfxDataEncrypt {data alg paramset key iv} {<font></font>
  variable oid_gost28147_89<font></font>
  <font></font>
  set out ""<font></font>
  if {$alg == $oid_gost28147_89} {<font></font>
    set dotted_paramset [string map {" " "."} $paramset]<font></font>
    set par [lcc_gost28147_getParamsByOid $dotted_paramset]<font></font>
    if {$par &gt; 0} {<font></font>
      set ctx [lcc_gost28147_cfb_ctx_create $par 1 $key $iv]<font></font>
      if {$ctx &gt; 0} {<font></font>
        set out [lcc_gost28147_cfb_ctx_update $ctx $data]<font></font>
        lcc_gost28147_cfb_ctx_delete $ctx<font></font>
      } else {<font></font>
        error "pfxDataEncrypt: Invalid cipher key or IV"<font></font>
      }<font></font>
      lcc_handle_free $par<font></font>
    } else {<font></font>
      error "pfxDataEncrypt: Unsupported cipher paramset $paramset"<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxDataEncrypt: Unsupported cipher algorithm $alg"  <font></font>
  }<font></font>
  return $out<font></font>
} <font></font>
<font></font>
# SET =&gt; dict: friendlyName localKeyID<font></font>
proc ::GostPfx::pfxIdentityDataParse {identityData} {<font></font>
  variable SEQUENCE_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable OCTET_STRING_TAG <font></font>
  variable SET_TAG <font></font>
  variable BMP_STRING_TAG<font></font>
  variable oid_friendlyName <font></font>
  variable oid_localKeyID<font></font>
  <font></font>
  set data $identityData<font></font>
  set dres [dict create]<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SET_TAG} {<font></font>
    asn::asnGetSet data set1<font></font>
    while {1} {<font></font>
      set tag_len [asn::asnPeekTag set1 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var != $SEQUENCE_TAG} {<font></font>
        break<font></font>
      }<font></font>
      asn::asnGetSequence set1 seqValue3<font></font>
      set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue3 oid3<font></font>
        set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
        if {$tag_var == $SET_TAG} {<font></font>
          asn::asnGetSet seqValue3 set2<font></font>
          set tag_len [asn::asnPeekTag set2 tag_var tag_type_var constr_var]<font></font>
          if {$oid3 == $oid_friendlyName} {<font></font>
            if {$tag_var == $BMP_STRING_TAG} {<font></font>
              asn::asnGetString set2 friendlyName<font></font>
              dict set dres "friendlyName" $friendlyName<font></font>
            } else {<font></font>
              error "pfxIdentityDataParse: friendlyName is not BMP STRING"<font></font>
            }<font></font>
          } else {<font></font>
            if {$oid3 == $oid_localKeyID} {<font></font>
              if {$tag_var == $OCTET_STRING_TAG} {<font></font>
                asn::asnGetOctetString set2 localKeyID<font></font>
                dict set dres "localKeyID" $localKeyID<font></font>
              }<font></font>
            } else {<font></font>
              error "pfxIdentityDataParse: localKeyID is not OCTET STRING"<font></font>
            }<font></font>
          }<font></font>
        } else {<font></font>
          error "pfxIdentityDataParse: Invalid structure"<font></font>
        }                <font></font>
      } else {<font></font>
        error "pfxIdentityDataParse: Invalid structure"<font></font>
      }<font></font>
    }<font></font>
  } else {<font></font>
    error "pfxIdentityDataParse: Invalid structure"<font></font>
  }<font></font>
  return $dres<font></font>
}<font></font>
<font></font>
# certBags =&gt; { {dict: certificat  friendlyName localKeyID} ...}<font></font>
proc ::GostPfx::pfxCertBagsParse {certBags} {<font></font>
  variable SEQUENCE_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable OCTET_STRING_TAG <font></font>
  variable SET_TAG <font></font>
  variable BMP_STRING_TAG<font></font>
  variable oid_PKCS12CertificateBag <font></font>
  variable oid_PKCS9x509Certificate <font></font>
  variable oid_friendlyName <font></font>
  variable oid_localKeyID<font></font>
  <font></font>
  set data $certBags<font></font>
  set lres {}<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue1<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    while {$tag_var == $SEQUENCE_TAG} {<font></font>
      asn::asnGetSequence seqValue1 seqValue2<font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue2 oid1<font></font>
        if {$oid1 == $oid_PKCS12CertificateBag} {<font></font>
          set dcert [dict create]<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_type_var == "CONTEXT"} {<font></font>
            asn::asnGetContext seqValue2 contextNumber context1 encoding_type<font></font>
            set tag_len [asn::asnPeekTag context1 tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $SEQUENCE_TAG} {<font></font>
              asn::asnGetSequence context1 seqValue3<font></font>
              set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
              if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                asn::asnGetObjectIdentifier seqValue3 oid2<font></font>
                if {$oid2 == $oid_PKCS9x509Certificate} {<font></font>
                  set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
                  if {$tag_type_var == "CONTEXT"} {<font></font>
                    asn::asnGetContext seqValue3 contextNumber context2 encoding_type<font></font>
                    set tag_len [asn::asnPeekTag context2 tag_var tag_type_var constr_var]<font></font>
                    if {$tag_var == $OCTET_STRING_TAG} {<font></font>
                      asn::asnGetOctetString context2 certificate<font></font>
            	      dict set dcert "certificate" $certificate<font></font>
                    } else {<font></font>
                      error "pfxCertBagsParse: Invalid structure 0"<font></font>
                    }                    <font></font>
                  } else {<font></font>
                    error "pfxCertBagsParse: Invalid structure 1"<font></font>
                  }<font></font>
                } else {<font></font>
                  error "pfxCertBagsParse: Invalid structure 2"<font></font>
                }<font></font>
              } else {<font></font>
                error "pfxCertBagsParse: Invalid structure 3"<font></font>
              }<font></font>
            } else {<font></font>
              error "pfxCertBagsParse: Invalid structure 4"<font></font>
            }           <font></font>
          } else {<font></font>
            error "pfxCertBagsParse: Invalid structure 5"<font></font>
          }<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          <font></font>
          set did [pfxIdentityDataParse $seqValue2]<font></font>
          if {[dict exists $did friendlyName]} {<font></font>
            dict set dcert "friendlyName" [dict get $did friendlyName]<font></font>
          }<font></font>
          if {[dict exists $did localKeyID]} {<font></font>
            dict set dcert "localKeyID" [dict get $did localKeyID]<font></font>
          }<font></font>
        } else {<font></font>
          error "pfxCertBagsParse: Invalid structure 6"<font></font>
        }<font></font>
      } else {<font></font>
        error "pfxCertBagsParse: Invalid structure 7"<font></font>
      }<font></font>
      lappend lres $dcert<font></font>
            <font></font>
      set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    }    <font></font>
  } else {<font></font>
    error "pfxCertBagsParse: Invalid structure 8"<font></font>
  }<font></font>
<font></font>
  return [reverse $lres]<font></font>
#  return $lres<font></font>
}<font></font>
<font></font>
# SEQUENCE, {SEQUENCE, oid_pkcs8ShroudedKeyBag, ...} =&gt; { {dict: keyBag friendlyName localKeyID} ... }<font></font>
proc ::GostPfx::pfxKeyBagsParse {keyBags} {<font></font>
  variable SEQUENCE_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable OCTET_STRING_TAG <font></font>
  variable SET_TAG<font></font>
  variable oid_pkcs8ShroudedKeyBag <font></font>
  <font></font>
  set data $keyBags<font></font>
  set lres {}<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue2<font></font>
    while {1} {<font></font>
      set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var != $SEQUENCE_TAG} {<font></font>
        break<font></font>
      }<font></font>
      asn::asnGetSequence seqValue2 seqValue3<font></font>
      set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
        asn::asnGetObjectIdentifier seqValue3 oid2<font></font>
        if {$oid2 == $oid_pkcs8ShroudedKeyBag} { <font></font>
          set dbag [dict create]<font></font>
          set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
          if {$tag_type_var == "CONTEXT"} {<font></font>
            asn::asnGetContext seqValue3 contextNumber context2 encoding_type<font></font>
            set tag_len [asn::asnPeekTag context2 tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $SEQUENCE_TAG} {<font></font>
              asn::asnGetSequence context2 keyBag<font></font>
              dict set dbag keyBag $keyBag                       <font></font>
            } else {<font></font>
              error "pfxKeyBagsParse: Invalid structure"<font></font>
            }                          <font></font>
          } else {<font></font>
            error "pfxKeyBagsParse: Invalid structure"<font></font>
          }    <font></font>
          set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
          if {$tag_var == $SET_TAG} {<font></font>
            set did [pfxIdentityDataParse $seqValue3]<font></font>
            if {[dict exists $did friendlyName]} {<font></font>
              dict set dbag friendlyName [dict get $did friendlyName]<font></font>
            }<font></font>
            if {[dict exists $did localKeyID]} {<font></font>
              dict set dbag localKeyID [dict get $did localKeyID]<font></font>
            }<font></font>
          }                   <font></font>
          lappend lres $dbag<font></font>
        } else {<font></font>
          error "pfxKeyBagsParse: Invalid structure"<font></font>
        }    <font></font>
      } else {<font></font>
        error "pfxKeyBagsParse: Invalid structure"<font></font>
      }    <font></font>
    }<font></font>
  } else {<font></font>
    error "pfxKeyBagsParse: Invalid structure"<font></font>
  }            <font></font>
  return $lres<font></font>
}<font></font>
<font></font>
# keyBag password =&gt; decrKey <font></font>
proc ::GostPfx::pfxKeyBagDecrypt {keyBag password} {<font></font>
  variable SEQUENCE_TAG<font></font>
  variable OCTET_STRING_TAG<font></font>
  <font></font>
  set decrKey ""<font></font>
  set data $keyBag<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data pbeData<font></font>
    set dpbe [pfxPbeDataParse $pbeData]<font></font>
    if {[dict exists $dpbe hmacKeySalt]} {<font></font>
      set hmacKeySalt [dict get $dpbe hmacKeySalt]<font></font>
    }<font></font>
    if {[dict exists $dpbe hmacKeyIter]} {<font></font>
      set hmacKeyIter [dict get $dpbe hmacKeyIter]<font></font>
    }<font></font>
    if {[dict exists $dpbe hmacAlg]} {<font></font>
      set hmacAlg [dict get $dpbe hmacAlg]<font></font>
    }<font></font>
    if {[dict exists $dpbe digestParamset]} {<font></font>
      set digestParamset [dict get $dpbe digestParamset]<font></font>
    }<font></font>
    if {[dict exists $dpbe cipherAlg]} {<font></font>
      set cipherAlg [dict get $dpbe cipherAlg]<font></font>
    }<font></font>
    if {[dict exists $dpbe cipherIV]} {<font></font>
      set cipherIV [dict get $dpbe cipherIV]<font></font>
    }<font></font>
    if {[dict exists $dpbe cipherParamset]} {<font></font>
      set cipherParamset [dict get $dpbe cipherParamset]<font></font>
    }<font></font>
    <font></font>
    set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $OCTET_STRING_TAG} {<font></font>
      asn::asnGetOctetString data encrKey <font></font>
    } else {<font></font>
      error "pfxKeyBagDecrypt: Invalid structure"<font></font>
    }<font></font>
    set cipherKey [pfxPbeKey $password $hmacAlg $hmacKeySalt $hmacKeyIter]<font></font>
    set decrKey [pfxDataDecrypt $encrKey $cipherAlg $cipherParamset $cipherKey $cipherIV]<font></font>
  } else {<font></font>
    error "pfxKeyBagDecrypt: Invalid structure"<font></font>
  }    <font></font>
  <font></font>
  return $decrKey<font></font>
}<font></font>
<font></font>
# decrKey =&gt; dict: version keyAlg gost3410Paramset gost3411Paramset keyValue<font></font>
proc ::GostPfx::pfxKeyDataParse {decrKey} {<font></font>
  variable SEQUENCE_TAG <font></font>
  variable INTEGER_TAG <font></font>
  variable OBJECT_IDENTIFIER_TAG <font></font>
  variable OCTET_STRING_TAG<font></font>
<font></font>
  set dKey [dict create]<font></font>
  set data $decrKey<font></font>
  set tag_len [asn::asnPeekTag data tag_var tag_type_var constr_var]<font></font>
  if {$tag_var == $SEQUENCE_TAG} {<font></font>
    asn::asnGetSequence data seqValue1<font></font>
    set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
    if {$tag_var == $INTEGER_TAG} {<font></font>
      asn::asnGetInteger seqValue1 version<font></font>
      dict set dKey version $version<font></font>
      set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $SEQUENCE_TAG} {<font></font>
        asn::asnGetSequence seqValue1 seqValue2<font></font>
        set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
        if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
          asn::asnGetObjectIdentifier seqValue2 keyAlg<font></font>
          dict set dKey keyAlg $keyAlg<font></font>
          set tag_len [asn::asnPeekTag seqValue2 tag_var tag_type_var constr_var]<font></font>
          if {$tag_var == $SEQUENCE_TAG} {<font></font>
            asn::asnGetSequence seqValue2 seqValue3<font></font>
            set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
            if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
              asn::asnGetObjectIdentifier seqValue3 gost3410Paramset<font></font>
              dict set dKey gost3410Paramset $gost3410Paramset<font></font>
              set tag_len [asn::asnPeekTag seqValue3 tag_var tag_type_var constr_var]<font></font>
              if {$tag_var == $OBJECT_IDENTIFIER_TAG} {<font></font>
                asn::asnGetObjectIdentifier seqValue3 gost3411Paramset<font></font>
                dict set dKey gost3411Paramset $gost3411Paramset<font></font>
              }<font></font>
            } else {<font></font>
              error "pfxKeyDataParse: Invalid key paramset structure"<font></font>
            }   <font></font>
          } else {<font></font>
            error "pfxKeyDataParse: Invalid key paramset structure"<font></font>
          }            <font></font>
        } else {<font></font>
          error "pfxKeyDataParse: Invalid key algorithm structure"<font></font>
        }          <font></font>
      } else {<font></font>
        error "pfxKeyDataParse: Invalid key algorithm structure"<font></font>
      }    <font></font>
      set tag_len [asn::asnPeekTag seqValue1 tag_var tag_type_var constr_var]<font></font>
      if {$tag_var == $OCTET_STRING_TAG} {<font></font>
        asn::asnGetOctetString seqValue1 octets1<font></font>
        set tag_len [asn::asnPeekTag octets1 tag_var tag_type_var constr_var]<font></font>
        if {$tag_var == $OCTET_STRING_TAG} {<font></font>
          asn::asnGetOctetString octets1 keyValue<font></font>
          dict set dKey keyValue $keyValue<font></font>
        } else {<font></font>
          error "pfxKeyDataParse: Invalid key value structure"<font></font>
        }<font></font>
      } else {<font></font>
        error "pfxKeyDataParse: Invalid key value structure"<font></font>
      }      <font></font>
    } else {<font></font>
      error "pfxKeyDataParse: Invalid key info structure"<font></font>
    }   <font></font>
  } else {<font></font>
    error "pfxKeyDataParse: Invalid key info structure"<font></font>
  }   <font></font>
  <font></font>
  return $dKey<font></font>
}<font></font>
<font></font>
# =&gt; dict: <font></font>
proc ::GostPfx::pfxGetSingleCertKey {indata password} {<font></font>
  <font></font>
  set dres [dict create]<font></font>
  <font></font>
  #puts "pfxParse"<font></font>
  set dpfx [pfxParse $indata]<font></font>
  if {[dict exists $dpfx authSafe]} {<font></font>
    set authSafe [dict get $dpfx authSafe]<font></font>
  }<font></font>
  if {[dict exists $dpfx macData]} {<font></font>
    set macData [dict get $dpfx macData]<font></font>
  }<font></font>
  <font></font>
  #puts "pfxMacDataParse"<font></font>
  set dhmac [pfxMacDataParse $macData]<font></font>
<font></font>
  if {[dict exists $dhmac salt]} {<font></font>
    set hmacKeySalt [dict get $dhmac salt]<font></font>
  }<font></font>
  if {[dict exists $dhmac iter]} {<font></font>
    set hmacKeyIter [dict get $dhmac iter]<font></font>
  }<font></font>
  if {[dict exists $dhmac digestAlg]} {<font></font>
    set hmacDigestAlg [dict get $dhmac digestAlg]<font></font>
  }<font></font>
  if {[dict exists $dhmac hmac]} {<font></font>
    set hmac [dict get $dhmac hmac]<font></font>
  }<font></font>
<font></font>
  #puts "pfxGetAuthSafeTbs"<font></font>
  set tbs [pfxGetAuthSafeTbs $authSafe]<font></font>
<font></font>
  #puts "pfxHmacVerify"<font></font>
  set hmac_ok [pfxHmacVerify $tbs $hmac $password $hmacDigestAlg $hmacKeySalt $hmacKeyIter]<font></font>
  if {$hmac_ok != 1} {<font></font>
    error "pfxGetSingleKeyCert: Check integrity: Invalid password or container corrupted!"<font></font>
  }<font></font>
<font></font>
  #puts "pfxTbsParse"<font></font>
  set dKeysCertsData [pfxTbsParse $tbs]<font></font>
  if {[dict exists $dKeysCertsData keyBags]} {<font></font>
    set keyBags [dict get $dKeysCertsData keyBags]<font></font>
  }<font></font>
  if {[dict exists $dKeysCertsData certsPbeData]} {<font></font>
    set certsPbeData [dict get $dKeysCertsData certsPbeData]<font></font>
  }<font></font>
  if {[dict exists $dKeysCertsData encrCerts]} {<font></font>
    set encrCerts [dict get $dKeysCertsData encrCerts]<font></font>
  }<font></font>
<font></font>
  #puts "pfxPbeDataParse"<font></font>
  set dCertsPbe [pfxPbeDataParse $certsPbeData]<font></font>
  if {[dict exists $dCertsPbe hmacKeySalt]} {<font></font>
    set hmacKeySalt [dict get $dCertsPbe hmacKeySalt]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe hmacKeyIter]} {<font></font>
    set hmacKeyIter [dict get $dCertsPbe hmacKeyIter]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe hmacAlg]} {<font></font>
    set hmacAlg [dict get $dCertsPbe hmacAlg]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe digestParamset]} {<font></font>
    set digestParamset [dict get $dCertsPbe digestParamset]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe cipherAlg]} {<font></font>
    set cipherAlg [dict get $dCertsPbe cipherAlg]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe cipherIV]} {<font></font>
    set cipherIV [dict get $dCertsPbe cipherIV]<font></font>
  }<font></font>
  if {[dict exists $dCertsPbe cipherParamset]} {<font></font>
    set cipherParamset [dict get $dCertsPbe cipherParamset]<font></font>
  }<font></font>
<font></font>
  #puts "pfxPbeKey"<font></font>
  set cipherKey [pfxPbeKey $password $hmacAlg $hmacKeySalt $hmacKeyIter]<font></font>
<font></font>
  #puts "pfxDataDecrypt"<font></font>
  set certBags [pfxDataDecrypt $encrCerts $cipherAlg $cipherParamset $cipherKey $cipherIV]<font></font>
<font></font>
  #puts "pfxCertBagsParse"<font></font>
  set lcerts [pfxCertBagsParse $certBags]<font></font>
<font></font>
  set dcert [lindex $lcerts 0]<font></font>
  if {[dict exists $dcert "certificate"]} {<font></font>
    set cert [dict get $dcert "certificate"]<font></font>
    dict set dRes certificate $cert<font></font>
  }<font></font>
  if {[dict exists $dcert "friendlyName"]} {<font></font>
    set cert_friendlyName [dict get $dcert "friendlyName"]<font></font>
  }<font></font>
  if {[dict exists $dcert "localKeyID"]} {<font></font>
    set cert_localKeyID [dict get $dcert "localKeyID"]<font></font>
  }<font></font>
<font></font>
  #puts "pfxKeyBagsParse" <font></font>
  set lKeyBags [pfxKeyBagsParse $keyBags]<font></font>
  set dKeyBag [lindex $lKeyBags 0]<font></font>
  if {[dict exists $dKeyBag keyBag]} {<font></font>
    set keyBag [dict get $dKeyBag keyBag]<font></font>
  }<font></font>
  if {[dict exists $dKeyBag friendlyName]} {<font></font>
    set key_friendlyName [dict get $dKeyBag friendlyName]<font></font>
    dict set dRes friendlyName $key_friendlyName<font></font>
    if {[info exists cert_friendlyName] &amp;&amp; ($cert_friendlyName != $key_friendlyName)} {<font></font>
      puts "pfxGetSingleKeyCert: Warning: certificate friendlyName: $cert_friendlyName is not equal to key friendlyName: $key_friendlyName"<font></font>
    }<font></font>
  }<font></font>
  if {[dict exists $dKeyBag localKeyID]} {<font></font>
    set key_localKeyID [dict get $dKeyBag localKeyID]<font></font>
    dict set dRes localKeyID $key_localKeyID<font></font>
    if {[info exists cert_localKeyID] &amp;&amp; ($cert_localKeyID != $key_localKeyID)} {<font></font>
      puts "pfxGetSingleKeyCert: Warning: certificate localKeyID is not equal to key localKeyID"<font></font>
    }<font></font>
  }<font></font>
<font></font>
  #puts "pfxKeyBagDecrypt"<font></font>
  set decrKey [pfxKeyBagDecrypt $keyBag $password]<font></font>
<font></font>
  #puts "pfxKeyDataParse"<font></font>
  set dKey [pfxKeyDataParse $decrKey]<font></font>
  if {[dict exists $dKey version]} {<font></font>
    set version [dict get $dKey version]<font></font>
  }<font></font>
  if {[dict exists $dKey keyAlg]} {<font></font>
    set keyAlg [dict get $dKey keyAlg]<font></font>
    dict set dRes keyAlg $keyAlg<font></font>
  }<font></font>
  if {[dict exists $dKey gost3410Paramset]} {<font></font>
    set gost3410Paramset [dict get $dKey gost3410Paramset]<font></font>
    dict set dRes gost3410Paramset $gost3410Paramset<font></font>
  }<font></font>
  if {[dict exists $dKey gost3411Paramset]} {<font></font>
    set gost3411Paramset [dict get $dKey gost3411Paramset]<font></font>
    dict set dRes gost3411Paramset $gost3411Paramset<font></font>
  }<font></font>
  if {[dict exists $dKey keyValue]} {<font></font>
    set keyValue [dict get $dKey keyValue]<font></font>
    dict set dRes keyValue $keyValue<font></font>
  }<font></font>
  <font></font>
  return $dRes<font></font>
}<font></font>
<font></font>
proc ::GostPfx::pfxCreateSingleCertKey {password certificate keyValue keyAlg gost3410Paramset gost3411Paramset friendlyName localKeyID} {<font></font>
  variable oid_Gost3411_2012_512 <font></font>
  variable oid_gost28147_89 <font></font>
  variable oid_tc26_gost_28147_89_param_A <font></font>
  variable oid_tc26_hmac_gost_3411_2012_512<font></font>
  variable oid_pkcs5PBES2 <font></font>
  variable oid_pBKDF2 <font></font>
  variable oid_friendlyName <font></font>
  variable oid_localKeyID <font></font>
  variable oid_pkcs8ShroudedKeyBag <font></font>
  variable oid_pkcs7_data <font></font>
  variable oid_pkcs7_encrypted_data<font></font>
  variable oid_PKCS12CertificateBag <font></font>
  variable oid_PKCS9x509Certificate<font></font>
  <font></font>
  set pfx ""<font></font>
  set ctx [lrnd_random_ctx_create ""]<font></font>
<font></font>
  # create identityData<font></font>
  set friendlyNameData [asn::asnSequence [asn::asnObjectIdentifier $oid_friendlyName] [asn::asnSet [asn::asnBMPString $friendlyName]]]<font></font>
  set localKeyIDData [asn::asnSequence [asn::asnObjectIdentifier $oid_localKeyID] [asn::asnSet [asn::asnOctetString $localKeyID]]]<font></font>
  set identityData [asn::asnSet $friendlyNameData $localKeyIDData]<font></font>
  <font></font>
  # create private key data<font></font>
  set oid3410Paramset [asn::asnObjectIdentifier $gost3410Paramset]<font></font>
  set oid3411Paramset [asn::asnObjectIdentifier $gost3411Paramset]<font></font>
  set paramsetSequence [asn::asnSequence $oid3410Paramset $oid3411Paramset]<font></font>
  set oidKeyAlg [asn::asnObjectIdentifier $keyAlg]<font></font>
  set keyAlgSequence [asn::asnSequence $oidKeyAlg $paramsetSequence]<font></font>
  set keyOctets [asn::asnOctetString [asn::asnOctetString $keyValue]]<font></font>
  set version [asn::asnInteger 0]<font></font>
  set keyData [asn::asnSequence $version $keyAlgSequence $keyOctets]<font></font>
  <font></font>
  # create private key cipherKey<font></font>
  set keySalt [lrnd_random_ctx_get_bytes $ctx 32]<font></font>
  set cipherKeyIter 2048<font></font>
  set hmacAlg $oid_tc26_hmac_gost_3411_2012_512<font></font>
  set keyCipherKey [pfxPbeKey $password $hmacAlg $keySalt $cipherKeyIter]<font></font>
  # create cipher algorithm and params<font></font>
  set cipherAlg $oid_gost28147_89<font></font>
  set cipherParamset $oid_tc26_gost_28147_89_param_A<font></font>
  set keyCipherIV [lrnd_random_ctx_get_bytes $ctx 8]<font></font>
  # encrypt private key data<font></font>
  set encrKey [pfxDataEncrypt $keyData $cipherAlg $cipherParamset $keyCipherKey $keyCipherIV]<font></font>
<font></font>
  # create private key PbeData<font></font>
  set keyCipherParams [asn::asnSequence [asn::asnOctetString $keyCipherIV] [asn::asnObjectIdentifier $cipherParamset]]<font></font>
  set keyCipherData [asn::asnSequence [asn::asnObjectIdentifier $cipherAlg] $keyCipherParams]<font></font>
  set hmacAlgData [asn::asnSequence [asn::asnObjectIdentifier $oid_tc26_hmac_gost_3411_2012_512] [asn::asnNull]]<font></font>
  set keyHmacData [asn::asnSequence [asn::asnOctetString $keySalt] [asn::asnInteger $cipherKeyIter] $hmacAlgData]<font></font>
  set keyPbkdf2Data [asn::asnSequence [asn::asnObjectIdentifier $oid_pBKDF2] $keyHmacData]<font></font>
  set keyPbeData [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs5PBES2] [asn::asnSequence $keyPbkdf2Data $keyCipherData]]<font></font>
  <font></font>
  # create keyBag<font></font>
  set keyBagContext [asn::asnContextConstr 0 [asn::asnSequence $keyPbeData [asn::asnOctetString $encrKey]]]<font></font>
  set keyBag [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs8ShroudedKeyBag] $keyBagContext $identityData]<font></font>
  # create keyBags<font></font>
  set keyBags [asn::asnOctetString [asn::asnSequence $keyBag]]<font></font>
  set keysData [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs7_data] [asn::asnContextConstr 0 $keyBags]]<font></font>
  <font></font>
  # create certificate cipherKey<font></font>
  set certSalt [lrnd_random_ctx_get_bytes $ctx 32]<font></font>
  set certCipherKey [pfxPbeKey $password $hmacAlg $certSalt $cipherKeyIter]<font></font>
  # create cipher algorithm and params<font></font>
  set certCipherIV [lrnd_random_ctx_get_bytes $ctx 8]<font></font>
  # create certPbeData<font></font>
  set certCipherParams [asn::asnSequence [asn::asnOctetString $certCipherIV] [asn::asnObjectIdentifier $cipherParamset]]<font></font>
  set certCipherData [asn::asnSequence [asn::asnObjectIdentifier $cipherAlg] $certCipherParams]<font></font>
  set certHmacData [asn::asnSequence [asn::asnOctetString $certSalt] [asn::asnInteger $cipherKeyIter] $hmacAlgData]<font></font>
  set certPbkdf2Data [asn::asnSequence [asn::asnObjectIdentifier $oid_pBKDF2] $certHmacData]<font></font>
  set certPbeData [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs5PBES2] [asn::asnSequence $certPbkdf2Data $certCipherData]]<font></font>
  # create certData<font></font>
  set certData [asn::asnSequence [asn::asnObjectIdentifier $oid_PKCS9x509Certificate] [asn::asnContextConstr 0 [asn::asnOctetString $certificate]]]<font></font>
  set certBag [asn::asnSequence [asn::asnObjectIdentifier $oid_PKCS12CertificateBag] [asn::asnContextConstr 0 $certData] $identityData]<font></font>
  # create certBags<font></font>
  set certBags [asn::asnSequence $certBag]<font></font>
  # encrypt certBags<font></font>
  set encrCertBags [pfxDataEncrypt $certBags $cipherAlg $cipherParamset $certCipherKey $certCipherIV]  <font></font>
  # create certsInfo (non-constructed context here!) <font></font>
  set certsContent [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs7_data] $certPbeData [asn::asnContext 0 $encrCertBags]]<font></font>
  set certsEncrData [asn::asnSequence [asn::asnInteger 0] $certsContent]<font></font>
  set certsData [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs7_encrypted_data] [asn::asnContextConstr 0 $certsEncrData]]<font></font>
  # create tbs<font></font>
  set tbs [asn::asnSequence $certsData $keysData]<font></font>
  # create hmacKey<font></font>
  set hmacKeySalt [lrnd_random_ctx_get_bytes $ctx 32]<font></font>
  set hmacPbaKey [string range [lcc_gost3411_2012_pkcs5 $password $hmacKeySalt $cipherKeyIter 96] 64 95]  <font></font>
  # create hmac<font></font>
  set hmacPba [lcc_gost3411_2012_hmac 64 $tbs $hmacPbaKey]<font></font>
  # create macData<font></font>
  set digestParams [asn::asnSequence [asn::asnObjectIdentifier $oid_Gost3411_2012_512] [asn::asnNull]]<font></font>
  set hmacData [asn::asnSequence $digestParams [asn::asnOctetString $hmacPba]]<font></font>
  set macData [asn::asnSequence $hmacData [asn::asnOctetString $hmacKeySalt] [asn::asnInteger $cipherKeyIter]]<font></font>
  # create pfx<font></font>
  set pfxData [asn::asnSequence [asn::asnObjectIdentifier $oid_pkcs7_data] [asn::asnContextConstr 0 [asn::asnOctetString $tbs]]]<font></font>
  set pfx [asn::asnSequence [asn::asnInteger 3] $pfxData $macData] <font></font>
  lrnd_random_ctx_delete $ctx<font></font>
  return $pfx<font></font>
}<font></font>
proc ::GostPfx::pfxCreateLocalKeyID {keyAlg gost3410Paramset privKeyValue} {<font></font>
  variable oid_GostR3410_2001<font></font>
  variable oid_GostR3411_94_with_GostR3410_2001<font></font>
  variable oid_tc26_gost3410_2012_256<font></font>
  variable oid_tc26_signwithdigest_gost3410_2012_256<font></font>
  variable oid_tc26_gost3410_2012_512<font></font>
  variable oid_tc26_signwithdigest_gost3410_2012_512<font></font>
  <font></font>
  set localKeyID ""  <font></font>
  if {($keyAlg == $oid_GostR3410_2001) || ($keyAlg == $oid_GostR3411_94_with_GostR3410_2001) || \<font></font>
  ($keyAlg == $oid_tc26_gost3410_2012_256) || ($keyAlg == $oid_tc26_signwithdigest_gost3410_2012_256)} {<font></font>
    set par_id [string map {" " "."} $gost3410Paramset]<font></font>
    set group [lcc_gost3410_2012_256_getGroupByOid $par_id]<font></font>
    if {$group &gt; 0} {<font></font>
      set pubKey [lcc_gost3410_2012_256_createPublicKey $group $privKeyValue]<font></font>
    } else {<font></font>
      error "pfxCreateLocalKeyID: Unsupported paramset $gost3410Paramset"<font></font>
    }<font></font>
  } else {<font></font>
    if {($keyAlg == $oid_tc26_gost3410_2012_512) || ($keyAlg == $oid_tc26_signwithdigest_gost3410_2012_512)} {<font></font>
      set par_id [string map { } {.} $gost3410Paramset]<font></font>
      set group [lcc_gost3410_2012_512_getGroupByOid $par_id]<font></font>
      if {$group &gt; 0} {<font></font>
        set pubKey [lcc_gost3410_2012_512_createPublicKey $group $privKeyValue]<font></font>
      } else {<font></font>
        error "pfxCreateLocalKeyID: Unsupported paramset $gost3410Paramset"<font></font>
      }<font></font>
    } else {<font></font>
      error "pfxCreateLocalKeyID: Unsupported algorithm: $keyAlg"<font></font>
    }<font></font>
  }<font></font>
  set octets [asn::asnOctetString $pubKey]<font></font>
  set localKeyID [lcc_sha1 $octets]    <font></font>
  return $localKeyID<font></font>
}<font></font>
package provide GostPfx 1.0.0</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã“ã§ã€crytoarmpkcsãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’èµ·å‹•ã—ã€PKCSï¼ƒ12ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…ˆ</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«</font><font style="vertical-align: inherit;">å–å¾—ã—ãŸå…¨èƒ½æ€§Habrè¨¼æ˜æ›¸ã‚’</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">å–å¾—</font></font></a><font style="vertical-align: inherit;">ã—ã€è¨¼æ˜æ›¸ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ek/nc/dm/ekncdmfvtc_cbsyg201gyirn6fm.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®æš—å·æƒ…å ±ä¿è­·ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã›ãšã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ç½²åã§ãã‚‹</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ã‚ˆã†</font></font></a><font style="vertical-align: inherit;">ã«ãªã‚Šã¾ã—</font><font style="vertical-align: inherit;">ãŸã€‚ä¸»ãªã“ã¨ã¯ã€è¨¼æ˜æ›¸ã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€è¨¼æ˜æ›¸å¤±åŠ¹ãƒªã‚¹ãƒˆã€OCSPå¿œç­”ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç½²åãƒ—ãƒ­ã‚»ã‚¹ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰ã«èª¬æ˜</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ãŸ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ã‚‚ã®</font></font></a><font style="vertical-align: inherit;">ã¨åŒã˜</font><font style="vertical-align: inherit;">ã§ã™</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pd/k7/v2/pdk7v2rpikvo5mx6bg2n1009kak.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€‚å—ä¿¡ã—ãŸç½²å</font><font style="vertical-align: inherit;">ã¯ã€å›½å®¶ã‚µãƒ¼ãƒ“ã‚¹ã¾ãŸã¯åˆ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã®Webã‚µã‚¤ãƒˆã§</font><font style="vertical-align: inherit;">ã‚‚å®‰å…¨ã«</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¢ºèª</font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font color="blue"><font style="vertical-align: inherit;">ã¾ã™</font></font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã§ã«è¿°ã¹ãŸã‚ˆã†ã«ã€ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰ã®è¨¼æ˜æ›¸ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒˆãƒ¼ã‚¯ãƒ³ã®ä¸¡æ–¹ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚ãƒˆãƒ¼ã‚¯ãƒ³ã®è¨¼æ˜æ›¸ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã¨ã€ãã®ç½²åãŒæ¤œè¨¼ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wr/cb/0f/wrcb0f3_t5gfzdtsu6qtuhhx50a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§˜å¯†éµã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_w/py/iw/_wpyiwsm0o8hyihj3a8a-alhbdo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ãƒˆãƒ¼ã‚¯ãƒ³ã§ç§˜å¯†éµã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ãã‚‹ã‚ã‘ã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ç§ãŸã¡ã®è¦³ç‚¹ã‹ã‚‰è¦‹ã‚‹ã¨ã€ã“ã®æ©Ÿèƒ½ã¯ä¸»ã«å€‹äººè¨¼æ˜æ›¸</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ã‚’PKCSï¼ƒ11ã‚¯ãƒ©ã‚¦ãƒ‰ãƒˆãƒ¼ã‚¯ãƒ³</font></font></a><font style="vertical-align: inherit;">ã«ä¿å­˜ã™ã‚‹ã¨ãã«å¿…è¦</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">
ã¾ãŸã€PKCSï¼ƒ11ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;">ä»¥å‰ã®è¨˜äº‹ã§</font></font></a><font style="vertical-align: inherit;">èª¬æ˜ã—ã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">
ãã—ã¦ã€ã»ã‚“ã®å°‘ã—æ®‹ã£ã¦ã„ã¾ã™ï¼ˆã¾ã [äºˆç´„]ãƒœã‚¿ãƒ³ãŒã‚ã‚Šã¾ã™ï¼‰-ã“ã‚Œã¯ã€å—ä¿¡è€…ã®è¨¼æ˜æ›¸ï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã‚­ãƒ¼ä¸Šï¼‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æš—å·åŒ–ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€æ¬¡å›ã¯ãã‚Œã«ã¤ã„ã¦ãŠè©±ã—ã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> <font color="blue"><font style="vertical-align: inherit;"></font></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font color="blue"><font style="vertical-align: inherit;"></font></font></a><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460187/index.html">ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹å‰ã«æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ã€‚</a></li>
<li><a href="../ja460191/index.html">ãƒ©ã‚¤ãƒ³ã‚’åœæ­¢ã™ã‚‹ã‹ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ãƒãƒ³ãƒ—ã§é€ã‚Šã¾ã™ã€‚</a></li>
<li><a href="../ja460193/index.html">NetXMSä¸Šã®Windowsã§ã®è¨¼æ˜æ›¸ã®æœ‰åŠ¹æœŸé™ã®ç›£è¦–</a></li>
<li><a href="../ja460195/index.html">å°ã•ãã€ã¯ã„ã€å‰Šé™¤ï¼šãƒŸãƒ‹ãƒãƒ¥ã‚¢ç·šå½¢ç²’å­åŠ é€Ÿå™¨ã€æ–°ã—ã„è¨˜éŒ²ã‚’æ¨¹ç«‹</a></li>
<li><a href="../ja460197/index.html">ç¾ä»£ã®å­ä¾›ã®æŠ€è¡“ã‚¯ãƒ©ãƒ–VSã‚½ãƒ“ã‚¨ãƒˆã‚¹ãƒ¼ãƒ„</a></li>
<li><a href="../ja460207/index.html">Linuxç®¡ç†è€…ãŒUbuntu 16.04ã§éŸ³æ¥½èªè­˜ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ã¦å…ç«¥åˆå”±å›£ã‚’ç®¡ç†ã—ãŸæ–¹æ³•ã€‚ãƒã‚¤ã‚¯ã¨ã‚³ãƒ¼ãƒ‰</a></li>
<li><a href="../ja460211/index.html">Intel Pohoiki Beach-800ä¸‡ã®ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã‚’æŒã¤ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ¢ãƒ¼ãƒ•ã‚£ãƒƒã‚¯ã‚·ã‚¹ãƒ†ãƒ </a></li>
<li><a href="../ja460213/index.html">ãƒã‚±ãƒƒãƒˆã‚’ã§ãã‚‹ã ã‘å®‰ãè³¼å…¥ã™ã‚‹æ–¹æ³•ã€ã¾ãŸã¯å‹•çš„ä¾¡æ ¼è¨­å®šã‚’ç›£è¦–ã—ã¦ãƒ’ãƒƒãƒˆã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja460215/index.html">ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ç§‘å­¦è€…ã¯ãƒ†ã‚¹ãƒˆçŸ¥è­˜ã®ç¯„å›²ã‚’æ‹¡å¤§ã—ã¾ã™</a></li>
<li><a href="../ja460221/index.html">åˆå¿ƒè€…ã®ITã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã§ã‚ã‚‹å ´åˆã«è³ªå•ã™ã‚‹æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>