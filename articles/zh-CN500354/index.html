<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♏️ 🤾🏼 🏽 在Google跟踪代码管理器中跟踪数据的新方法-服务器端标记 👨🏾‍🎓 🅱️ 🥇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本文中，我想告诉您有关Google跟踪代码管理器的一项新功能-服务器端标记-跟踪服务器端的数据。根据其开发人员的说法，此功能允许您通过限制对第三方脚本的访问来在服务器代码中隐藏业务逻辑，加快站点加载速度并改善用户数据保护。
 
 让我们仔细看看它是如何工作的。
 
 客户端跟踪和服务器端跟踪有什么...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>在Google跟踪代码管理器中跟踪数据的新方法-服务器端标记</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500354/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本文中，我想告诉您有关Google跟踪代码管理器的一项新功能-服务器端标记-跟踪服务器端的数据。</font><font style="vertical-align: inherit;">根据其开发人员的说法，此功能允许您通过限制对第三方脚本的访问来在服务器代码中隐藏业务逻辑，加快站点加载速度并改善用户数据保护。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们仔细看看它是如何工作的。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端跟踪和服务器端跟踪有什么区别</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现有的大多数标签管理器，分析系统和广告服务都是使用客户端跟踪方法（即在客户端）收集数据的。</font><font style="vertical-align: inherit;">怎么运行的？</font><font style="vertical-align: inherit;">有一个网站或安装了特定浏览器的应用程序，还有一个第三方服务，例如Google Analytics（分析）。</font><font style="vertical-align: inherit;">浏览器将请求直接发送到此服务，并在必要时接收响应。</font><font style="vertical-align: inherit;">也就是说，交互发生在两方之间：浏览器和第三方服务。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/4b/us/ds4bus_mvjfd8q1sk52m_0ysszy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在服务器端跟踪数据时（服务器端跟踪），添加了一个中间点。</font><font style="vertical-align: inherit;">对于Google跟踪代码管理器，它是一台云服务器。</font><font style="vertical-align: inherit;">该请求首先从客户端发送到云服务器，然后该服务器处理该请求并将其发送到第三方系统（Google Analytics（分析））。</font><font style="vertical-align: inherit;">也就是说，请求是由云服务器发出的，而不是客户端的浏览器。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gc/la/ng/gclang-u_bcky4xgjvcn3r0hsbi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们仔细看看这两种数据收集方法的主要优点和缺点。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端跟踪</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是从站点收集数据的最常用方法。</font><font style="vertical-align: inherit;">跟踪用户的浏览器的一侧可以让你收到饼干的数据，URL参数，参考源，用户设备的数据，IP地址等</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">优点</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是您所熟悉的所有标记管理器所使用的标准，也是大多数分析人员都习惯的标准。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端跟踪很容易配置。</font><font style="vertical-align: inherit;">许多系统提供了现成的代码片段，您只需要复制它们并将它们放置在站点页面上即可。</font></font></li>
<li> . ,   ,       Chrome      Google Tag Manager.</li>
<li>Client-Side Tracking,  ,   Server-Side Tracking,        .</li>
</ol><br>
<b></b><br>
<br>
<ol>
<li>         . ,          .</li>
<li>      ,     ,    .     ITP —    Safari   ,     cookie    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据的安全性低于服务器端跟踪。</font><font style="vertical-align: inherit;">因此，您不能以这种方式从站点传输机密信息，例如，电子邮件和用户电话号码或边距。</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器端跟踪</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器端跟踪是通常的客户端跟踪方法的替代方法，它使您可以解决广告拦截程序，敏感数据的传输和页面加载速度方面的问题。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好处</font></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发送请求并不取决于浏览器的版本或类型。</font><font style="vertical-align: inherit;">所有请求都在服务器端进行处理，因此广告拦截器，ITP，ETP或中断的连接不会影响数据质量。</font></font></li>
<li>    ,  ,  c     Google Analytics  ,       ,  ,   .</li>
<li>Server-Side Tracking             ,         .</li>
<li>         .  ,    ,       .  Server-Side Tracking     .</li>
</ol><br>
<b></b><br>
<br>
<ol>
<li>          .</li>
<li>   .         .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不适合从SPA或PWA页面收集信息。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并非所有系统都使用可用于服务器端跟踪的标签。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该方法不方便收集URL参数。</font><font style="vertical-align: inherit;">它们很容易在客户端收集，因为这些数据显示在浏览器中。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们来看一下Google跟踪代码管理器团队关注的服务器端跟踪的好处。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GTM服务器端跟踪：声称的好处</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器端跟踪使您可以通过将其移至后端来隐藏与第三方应用程序交互的站点的业务逻辑。也就是说，用户将无法访问用于传输数据的信息和逻辑。例如，您可以向GA发送诚实的保证金，并且在用户浏览器的客户端甚至不会有这样的变量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就数据移动而言，此方法更安全。您想要发送用于分析的信息，例如来自CRM，性别或与用户相关的其他内容的细分，现在不需要发送到浏览器。因此，这将不适用于浏览器中的其他JS脚本。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如前所述：假设您要获取GA中电话号码，性别或用户地址的哈希值。</font><font style="vertical-align: inherit;">要发送此信息，必须在DataLayer中使其可用。</font><font style="vertical-align: inherit;">来自DataLayer的信息可用于浏览器中加载的所有JavaScript。</font><font style="vertical-align: inherit;">这是常见的作用域，没有私有变量，例如与Python不同。</font><font style="vertical-align: inherit;">如果您通过后端传递此信息，则该信息在用户的JavaScript浏览器环境中不可用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了数据安全性之外，在服务器端跟踪的众多优势中，Google团队还强调了提高网站加载速度的机会。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何在Google跟踪代码管理器中尝试服务器端标记</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，由于这是一个访问受限的测试版，因此无法与您分享有关如何配置服务器端跟踪的说明。</font><font style="vertical-align: inherit;">要访问它，您需要填写并向Google提交</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">白名单表单</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
获得Google的许可和指示后，要配置服务器端跟踪，您将需要：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Cloud Platform帐户</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问您网站的域名注册商</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于该方法需要放置GTM容器，因此可以访问您网站上的发布内容</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OWOX BI的我们已经设法测试了新功能。简而言之，它是如何工作的，与使用Google跟踪代码管理器进行标准跟踪有什么区别。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端跟踪的工作方式</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：我们有一个网站或应用程序。我们将容器安装在GTM网站上并在其中配置标签。然后，容器将数据发送到GA。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ye/3a/8y/ye3a8yyjt0wzvmhxaqecjovjns8.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器端如何工作</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：我们有一个网站或应用程序。同样，我们将设置一个包含所有标签的GTM网络容器。接下来，我们在专用域上设置环境。为此环境设置一个容器。并且请求已经不直接通过Web容器从浏览器中离开，而是通过云服务器形式的中间链接离开：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zu/5a/mq/zu5amq-x80wajy58qkcwaraqhkm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Google Analytics（分析）资源的标准配置之后，数据开始收集到其中：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/ji/hd/hbjihdhbtna5you9mb-kkqrd_we.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用云服务器需要额外付费，具体取决于用户数量和站点上的请求。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我应该使用服务器端跟踪吗？</font><font style="vertical-align: inherit;">这个问题的答案取决于您要收集什么数据以及出于什么目的；</font><font style="vertical-align: inherit;">对您来说更重要的是节省时间和金钱的机会，或者将敏感数据传输到分析系统的能力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于该功能仍处于测试阶段，因此完全不宜使用它并禁用常规跟踪功能（并且无法正常使用）。</font><font style="vertical-align: inherit;">不过，您现在可以请求Google小组的访问权限，以测试服务器端跟踪并确定它是否对您的业务有用。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN500342/index.html">“委员会”，“ Habr”和Sports.ru具有哪些播客</a></li>
<li><a href="../zh-CN500344/index.html">带轮子的智能家居...爱丽丝。第2部分。</a></li>
<li><a href="../zh-CN500346/index.html">Kubernetes中的DNS问题。公开验尸</a></li>
<li><a href="../zh-CN500348/index.html">数学家认为COVID-19大流行，或者经典SEIRD模型不起作用的原因</a></li>
<li><a href="../zh-CN500352/index.html">如何在Facebook上实习并在伦敦获得报价？向Facebook工程师提问</a></li>
<li><a href="../zh-CN500356/index.html">通过WebRTC在设备之间直接文件传输</a></li>
<li><a href="../zh-CN500360/index.html">最佳SQL中难度面试问题</a></li>
<li><a href="../zh-CN500364/index.html">在Moodle和BigBlueButton上扩展学校学习门户</a></li>
<li><a href="../zh-CN500368/index.html">生成可预测的随机序列：一种不同的置换方法</a></li>
<li><a href="../zh-CN500370/index.html">面向2020年值得订阅的10个有用的英语播客</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>