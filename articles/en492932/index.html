<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏭 🚱 🥂 13 shell-based word processing tools 😔 🙃 👨‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Here is a fragment of a future book, Basic Tools and Practices for a Novice Software Developer, by Balthazar Ruberol and Etienne Broad . The book shou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>13 shell-based word processing tools</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/492932/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a fragment of a future book, Basic Tools and Practices for a Novice Software Developer, by Balthazar Ruberol and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etienne Broad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The book should help educate the younger generation of developers. </font><font style="vertical-align: inherit;">It will cover topics such as mastering the console, setting up and working efficiently in the command shell, managing versions of code using </font></font><code>git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL fundamentals, tools like </font></font><code>Make</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>jq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and regular expressions, basics of networking, as well as best practices for software development and collaboration. </font><font style="vertical-align: inherit;">The authors are currently working hard on this project and are inviting everyone to participate in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the mailing list</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cat</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tail</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wc</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cut</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paste</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sort</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fold</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Real examples</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deepening: for and xargs loops</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What's next</font></font></a></li>
</ul><a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shell Text Processing</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the reasons that make the command shell an invaluable tool is the large number of word processing commands and the ability to easily combine them into the pipeline, creating complex processing templates. </font><font style="vertical-align: inherit;">These commands make many tasks trivial for analyzing text and data, converting data between different formats, filtering strings, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When working with text data, the main principle is to break any complex problem into many smaller ones - and solve each of them using a specialized tool.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Make each program do one thing well - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Fundamentals of Unix Philosophy</font></font></a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The examples in this chapter may seem a little far-fetched at first glance, but this is done on purpose. </font><font style="vertical-align: inherit;">Each of the tools is designed to solve one small problem. </font><font style="vertical-align: inherit;">However, when combined, they become extremely powerful. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will look at some of the most common and useful text processing commands in the shell and demonstrate the real workflows that connect them together. </font><font style="vertical-align: inherit;">I suggest looking at the mana of these teams to see the full breadth of possibilities at your disposal.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example CSV file </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is available online</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">You can download it to check the material.</font></font></blockquote><br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command is </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used to compile a list of one or more files and display their contents on the screen.</font></font><br>
<br>
<pre><code class="plaintext hljs">$ cat Documents/readme<font></font>
Thanks again for reading this book!<font></font>
I hope you're following so far!<font></font>
<font></font>
$ cat Documents/computers<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.<font></font>
<font></font>
$ cat Documents/readme Documents/computers<font></font>
Thanks again for reading this book!<font></font>
I hope you are following so far!<font></font>
<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.</code></pre><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></h1><br>
<code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prints the first n lines in the file. </font><font style="vertical-align: inherit;">This can be very useful for looking into a file of unknown structure and format without filling up the entire console with a bunch of text.</font></font><br>
<br>
<pre><code class="bash hljs">$ head -n 2 metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name<font></font>
mysql.galera.wsrep_cluster_size,gauge,,node,,The current number of nodes <span class="hljs-keyword">in</span> the Galera cluster.,0,mysql,galera cluster size</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not specified, </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prints the first ten lines of the specified file or input stream.</font></font><br>
<br>
<a name="3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tail</font></font></h1><br>
<code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- an analogue </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, only it displays the last n lines in the file.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 1 metadata.csv<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to print all the lines located after the nth line (including it), you can use the argument </font></font><code>-n +n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n +42 metadata.csv<font></font>
mysql.replication.slaves_connected,gauge,,,,Number of slaves connected to a replication master.,0,mysql,slaves connected<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are 43 lines in our file, therefore it </font></font><code>tail -n +42</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">only outputs the 42nd and 43rd lines from it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the parameter is </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not specified, it </font></font><code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will output the last ten lines in the specified file or input stream. </font></font><br>
<br>
<code>tail -f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>tail --follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">display the last lines in the file and each new line as they are written to the file. </font><font style="vertical-align: inherit;">This is very useful for viewing activity in real time, for example, what is recorded in the web server logs, etc.</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wc</font></font></h1><br>
<code>wc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(word count) displays the number of characters ( </font></font><code>-c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), words ( </font></font><code>-w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) or lines ( </font></font><code>-l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) in the specified file or stream.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc -l metadata.csv<font></font>
43  metadata.csv<font></font>
$ wc -w metadata.csv<font></font>
405 metadata.csv<font></font>
$ wc -c metadata.csv<font></font>
5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, all of the above is displayed.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc metadata.csv<font></font>
43     405    5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If text data is pipelined or redirected to </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, only the counter is displayed.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat metadata.csv | wc<font></font>
43     405    5094<font></font>
$ cat metadata.csv | wc -l<font></font>
43<font></font>
$ wc -w &lt; metadata.csv<font></font>
405</code></pre><br>
<a name="5"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></h1><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- This is a Swiss knife filtering strings according to a given pattern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we can find all occurrences of the word </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in a file.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.mutex_spin_rounds,gauge,,event,second,The rate of mutex spin rounds.,0,mysql,mutex spin rounds<font></font>
mysql.innodb.mutex_spin_waits,gauge,,event,second,The rate of mutex spin waits.,0,mysql,mutex spin waits</code></pre><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can process either files specified as arguments or a stream of text passed to it </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Thus, we can concatenate several commands </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to further filter the text. </font><font style="vertical-align: inherit;">In the following example, we filter the lines in our file </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to find lines containing both </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv | grep OS<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's consider some options </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and their behavior. </font></font><br>
<br>
<code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performs inverse matching: filters strings that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do not</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> match the argument pattern.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -v gauge metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name</code></pre><br>
<code> grep -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performs case insensitive matching. </font><font style="vertical-align: inherit;">The following example </font></font><code>grep -i os</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">finds both </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -i os metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.os_log_fsyncs,gauge,,write,second,The rate of fsync writes to the <span class="hljs-built_in">log</span> file.,0,mysql,<span class="hljs-built_in">log</span> fsyncs</code></pre><br>
<code>grep -l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lists files containing a match.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -l mysql metadata.csv<font></font>
metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The team </font></font><code>grep -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">counts how many times a sample was found.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -c select metadata.csv<font></font>
3</code></pre><br>
<code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recursively searches for files in the current working directory and all its subdirectories.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r are ~/Documents<font></font>
/home/br/Documents/computers:Computers are not intelligent<font></font>
/home/br/Documents/readme:I hope you are following so far!</code></pre><br>
<code>grep -w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shows only matching whole words.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep follow ~/Documents/readme<font></font>
I hope you are following so far!<font></font>
$ grep -w follow ~/Documents/readme<font></font>
$</code></pre><br>
<a name="6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cut</font></font></h1><br>
<code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extracts part of the file (or, as usual, the input stream). </font><font style="vertical-align: inherit;">The command defines the field separator (which separates the columns) using the option </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the column numbers to retrieve using the option </font></font><code>-f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the following command retrieves the first column from the last five lines of our CSV file.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1<font></font>
mysql.performance.user_time<font></font>
mysql.replication.seconds_behind_master<font></font>
mysql.replication.slave_running<font></font>
mysql.replication.slaves_connected<font></font>
mysql.performance.queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since we are dealing with CSV, the columns are separated by a comma, and the option is responsible for extracting the first column </font></font><code>-f 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can select both the first and second columns using the option </font></font><code>-f 1,2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1,2<font></font>
mysql.performance.user_time,gauge<font></font>
mysql.replication.seconds_behind_master,gauge<font></font>
mysql.replication.slave_running,gauge<font></font>
mysql.replication.slaves_connected,gauge<font></font>
mysql.performance.queries,gauge</code></pre><br>
<a name="7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paste</font></font></h1><br>
<code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> merges together two different files into one multi-column file.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
$ cat prices<font></font>
1$<font></font>
1.99$<font></font>
1.50$<font></font>
2$/kg<font></font>
$ paste ingredients prices<font></font>
eggs    1$<font></font>
milk    1.99$<font></font>
butter  1.50$<font></font>
tomatoes    2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, it </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uses a tab delimiter, but it can be changed using the parameter </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste ingredients prices -d:<font></font>
eggs:1$<font></font>
milk:1.99$<font></font>
butter:1.50$<font></font>
tomatoes:2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another common use case </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;is to combine all the lines in a stream or file using the specified delimiter using a combination of </font></font><code>-s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste -s -d, ingredients<font></font>
eggs,milk,butter,tomatoes</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If a parameter is specified as an input file </font></font><code>-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then it will be read instead </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients | paste -s -d, -<font></font>
eggs,milk,butter,tomatoes</code></pre><br>
<a name="8"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sort</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actually sorts the data (in the specified file or input stream).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
salt<font></font>
$ sort ingredients<font></font>
butter<font></font>
eggs<font></font>
milk<font></font>
salt<font></font>
tomatoes</code></pre><br>
<code>sort -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performs reverse sorting.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort -r ingredients<font></font>
tomatoes<font></font>
salt<font></font>
milk<font></font>
eggs<font></font>
butter</code></pre><br>
<code>sort -n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sorts fields by their arithmetic value.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat numbers<font></font>
0<font></font>
2<font></font>
1<font></font>
10<font></font>
3<font></font>
$ sort numbers<font></font>
0<font></font>
1<font></font>
10<font></font>
2<font></font>
3<font></font>
$ sort -n numbers<font></font>
0<font></font>
1<font></font>
2<font></font>
3<font></font>
10</code></pre><br>
<a name="9"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></h1><br>
<code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detects and filters adjacent identical lines in the specified file or input stream.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat duplicates<font></font>
and one<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three<font></font>
$ uniq duplicates<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since it </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filters out only </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adjacent</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lines, duplicates may still remain in our data. </font><font style="vertical-align: inherit;">To filter all the same lines from a file, you must first sort its contents.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq<font></font>
and one<font></font>
and one, two, three<font></font>
and two</code></pre><br>
<code>uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the beginning of each line inserts the number of its occurrences.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -c<font></font>
   3 and one<font></font>
   1 and one, two, three<font></font>
   2 and two</code></pre><br>
<code>uniq -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Displays only unique strings.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -u<font></font>
and one, two, three</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is especially useful in combination with sorting, as the pipeline </font></font><code>| sort | uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to delete all duplicate lines in a file or stream.</font></font></blockquote><br>
<a name="10"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></h1><br>
<code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- This is a little more than just a word processing tool: in fact, it has </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a whole programming language</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">What is </font></font><code>awk</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">really</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> good is splitting files into columns, and it does it with special brilliance when spaces and tabs are mixed in files.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat -t multi-columns<font></font>
John Smith    Doctor^ITardis<font></font>
Sarah-James Smith^I    Companion^ILondon<font></font>
Rose Tyler   Companion^ILondon</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font></font><code>cat -t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">displays tabs as </font></font><code>^I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the columns are separated by either spaces or tabs, and not always by the same number of spaces. </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it is useless here because it works with only one separator character. </font><font style="vertical-align: inherit;">But </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it’s easy to deal with such a file. </font></font><br>
<br>
<code>awk '{ print $n }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">displays the nth column in the text.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat multi-columns | awk <span class="hljs-string">'{ print $1 }'</span><font></font>
John<font></font>
Sarah-James<font></font>
Rose<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $3 }'</span><font></font>
Doctor<font></font>
Companion<font></font>
Companion<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $1,$2 }'</span><font></font>
John Smith<font></font>
Sarah-James Smith<font></font>
Rose Tyler</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capable of much more, the output of the speakers is probably 99% of the use cases in my personal case.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font></font><code>{ print $NF }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">displays the last column in a row.</font></font></blockquote><br>
<a name="11"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></h1><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stands for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">translate</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This command replaces one character with another. </font><font style="vertical-align: inherit;">It works with either characters or </font><font style="vertical-align: inherit;">character </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such as lowercase, typed, spaces, alphanumeric, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On standard input, it </font></font><code>tr &lt;char1&gt; &lt;char2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">replaces all occurrences of &lt;char1&gt; with &lt;char2&gt;.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers are fast"</span> | tr a A<font></font>
computers Are fAst</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can translate character classes using notation </font></font><code>[:class:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A complete list of available classes is described on the man page </font></font><code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but some are demonstrated here. </font></font><br>
<br>
<code>[:space:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">represents all types of spaces, from simple spaces to tabs or newlines.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:space:]'</span> <span class="hljs-string">','</span>
computers,are,fast,%</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All characters, like spaces, are comma-separated. </font><font style="vertical-align: inherit;">Please note that the character </font></font><code>%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the end of the output indicates the absence of a terminating new line. </font><font style="vertical-align: inherit;">Indeed, this character is also converted to a comma. </font></font><br>
<br>
<code>[:lower:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">represents all lowercase characters, and </font></font><code>[:upper:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;all uppercase </font><font style="vertical-align: inherit;">characters </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Thus, the transformation between them becomes trivial.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:lower:]'</span> <span class="hljs-string">'[:upper:]'</span><font></font>
COMPUTERS ARE FAST<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"COMPUTERS ARE FAST"</span> | tr <span class="hljs-string">'[:upper:]'</span> <span class="hljs-string">'[:lower:]'</span>
computers are fast</code></pre><br>
<code>tr -c SET1 SET2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">converts any character </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> included in SET1 to characters in SET2. </font><font style="vertical-align: inherit;">In the following example, all characters except the indicated vowels are replaced with spaces.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr -c <span class="hljs-string">'[aeiouy]'</span> <span class="hljs-string">' '</span>
 o  u e   a e  a</code></pre><br>
<code>tr -d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deletes the specified characters, but does not replace them. </font><font style="vertical-align: inherit;">This is the equivalent </font></font><code>tr &lt;char&gt; ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers Are Fast"</span> | tr -d <span class="hljs-string">'[:lower:]'</span>
C A F</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can also replace character ranges, for example, all letters between </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or all numbers between 1 and 8, using notation </font></font><code>s-e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where </font></font><code>s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;is the starting character, and </font></font><code>e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;is the ending.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'a-e'</span> <span class="hljs-string">'x'</span><font></font>
xomputxrs xrx fxst<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"5uch l337 5p34k"</span> | tr <span class="hljs-string">'1-4'</span> <span class="hljs-string">'x'</span>
5uch lxx7 5pxxk</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>tr -s string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compresses all multiple occurrences of characters </font></font><code>string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in one single. </font><font style="vertical-align: inherit;">One of the most useful uses </font></font><code>tr -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is to replace multiple consecutive spaces with one.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers         are       fast"</span> | tr -s <span class="hljs-string">' '</span>
Computers are fast</code></pre><br>
<a name="12"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fold</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>fold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collapses all input lines to the specified width. </font><font style="vertical-align: inherit;">For example, it can be useful to make sure that the text fits on small displays. </font><font style="vertical-align: inherit;">So, </font></font><code>fold -w n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stacks strings of width n characters.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ~/Documents/readme | fold -w 16<font></font>
Thanks again <span class="hljs-keyword">for</span><font></font>
 reading this bo<font></font>
ok!<font></font>
I hope you<span class="hljs-string">'re fo
llowing so far!</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>fold -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will break lines only on space characters. </font><font style="vertical-align: inherit;">It can be combined with the previous one to limit the string to the specified number of characters.</font></font><br>
<br>
<pre><code class="bash hljs">Thanks again
<span class="hljs-keyword">for</span> reading<font></font>
this book!<font></font>
I hope you<span class="hljs-string">'re
following so
far!</span></code></pre><br>
<a name="13"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></h1><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is a non-interactive stream editor that is used to convert text in the input stream line by line. </font><font style="vertical-align: inherit;">As input, either a file or, or </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, at the output, either a file or </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Editor commands can include one or more </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addresses</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">function,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parameters</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Thus, the commands are as follows:</font></font><br>
<br>
<pre><code class="bash hljs">[address[,address]]<span class="hljs-keyword">function</span>[arguments]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although it </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performs many functions, we will only consider replacing text as one of the most common use cases.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text Replacement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The replacement command is </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as follows:</font></font><br>
<br>
<pre><code class="bash hljs">s/PATTERN/REPLACEMENT/[options]</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : replacing the first instance of a word in each line in a file:</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello<font></font>
hello hello<font></font>
hello world!<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/'</span><font></font>
Hey I just met you hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see that in the first line only the first instance is replaced </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">To replace </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> occurrences </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in all lines, you can use the option </font></font><code>g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(means </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">global</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to use any delimiters except </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which especially improves readability if there are slashes in the command arguments themselves.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s@hello@Hey I just met you@g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The address tells the editor on which line or range of lines to perform the substitution.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you hello<font></font>
hello world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you  world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The address </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicates replace </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on </font></font><code>Hey I just met you</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the first line. </font><font style="vertical-align: inherit;">We can specify the range of addresses in the notation </font></font><code>&lt;start&gt;,&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where it </font></font><code>&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be either the line number or </font></font><code>$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, that is, the last line in the file.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1,2s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,3s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,$s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, it </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produces the result in its own </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but can also edit the original file with the option </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">''</span> <span class="hljs-string">'s/hello/Bonjour/'</span> sed-data<font></font>
$ cat sed-data<font></font>
Bonjour hello<font></font>
Bonjour world<font></font>
hi</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">On Linux, just enough </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But on macOS, the behavior of the command is slightly different, so </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you need to add </font><font style="vertical-align: inherit;">right after </font></font><code>''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Real examples</font></font></h1><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSV filtering with grep and awk</font></font></h3><br>
<pre><code class="bash hljs">$ grep -w gauge metadata.csv | awk -F, <span class="hljs-string">'{ if ($4 == "query") { print $1, "per", $5 } }'</span><font></font>
mysql.performance.com_delete per second<font></font>
mysql.performance.com_delete_multi per second<font></font>
mysql.performance.com_insert per second<font></font>
mysql.performance.com_insert_select per second<font></font>
mysql.performance.com_replace_select per second<font></font>
mysql.performance.com_select per second<font></font>
mysql.performance.com_update per second<font></font>
mysql.performance.com_update_multi per second<font></font>
mysql.performance.questions per second<font></font>
mysql.performance.slow_queries per second<font></font>
mysql.performance.queries per second</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the file </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first filters the lines containing the word </font></font><code>gauge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then those with the </font></font><code>query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fourth column, and displays the metric name (1st column) with the corresponding value </font></font><code>per_unit_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(5th column).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Displays the IPv4 address associated with the network interface</font></font></h3><br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>ifconfig &lt;interface name&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">displays information on the specified network interface. </font><font style="vertical-align: inherit;">For instance:</font></font><br>
<br>
<pre><code class="bash hljs">en0: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<font></font>
    ether 19:64:92:de:20:ba<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255<font></font>
    nd6 options=201&lt;PERFORMNUD,DAD&gt;<font></font>
    media: autoselect<font></font>
    status: active</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then run </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for </font></font><code>inet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, that will produce two lines of correspondence.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then, using </font></font><code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exclude the line with </font></font><code>ipv6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6<font></font>
inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finally, with the help, we </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">request the second column in this row: this is the IPv4 address associated with our network interface </font></font><code>en0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">I was </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offered</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to replace with </font></font><code>grep inet | grep -v inet6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">such a reliable team </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | awk <span class="hljs-string">' $1 == "inet" { print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is shorter and specifically targeted to IPv4 with the condition </font></font><code>$1 == "inet"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retrieving a value from a configuration file</font></font></h3><br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d = -f2 | sed <span class="hljs-string">'s/ //g'</span>
/usr/bin/vim</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the git configuration file of the current user, look for the value </font></font><code>editor =</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, crop the character </font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, extract the second column and delete all the spaces around.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig<font></font>
     editor = /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2<font></font>
 /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2 | sed <span class="hljs-string">'s/ //'</span>
/usr/bin/vim</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extract IPs from a log file</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following real code looks for a message in the database log </font></font><code>Too many connections from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(followed by an IP address) and displays the ten main intruders.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
   10.11.112.108<font></font>
   10.11.111.70<font></font>
   10.11.97.57<font></font>
   10.11.109.72<font></font>
   10.11.116.156<font></font>
   10.11.100.221<font></font>
   10.11.96.242<font></font>
   10.11.81.68<font></font>
   10.11.99.112<font></font>
   10.11.107.120</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's see what this pipeline does. </font><font style="vertical-align: inherit;">First, what does the line in the log look like.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | head -n 1<font></font>
2020-01-01 08:02:37,617 [myid:1] - WARN  [NIOServerCxn.Factory:1.2.3.4/1.2.3.4:2181:NIOServerCnxnFactory@193] - Too many connections from /10.11.112.108 - max is 60</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It then </font></font><code>awk '{ print $12 }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extracts the IP address from the string.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span><font></font>
/10.11.112.108<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The command </font></font><code>sed 's@/@@'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deletes the initial slash.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span> | sed <span class="hljs-string">'s@/@@'</span><font></font>
10.11.112.108<font></font>
...</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">As we saw earlier, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can use any separator in. </font><font style="vertical-align: inherit;">Although it is usually used as a separator </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, here we are replacing exactly this character, which will slightly impair the readability of the substitution expression.</font></font><br>
<br>
<pre><code class="bash hljs">sed <span class="hljs-string">'s/\///'</span></code></pre></blockquote><br>
<code>sort | uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sorts IP addresses in lexicographical order, and then removes duplicates, adding the number of entries before each IP address.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c<font></font>
   1379 10.11.100.221<font></font>
   1213 10.11.103.168<font></font>
   1138 10.11.105.177<font></font>
    946 10.11.106.213<font></font>
   1211 10.11.106.4<font></font>
   1326 10.11.107.120<font></font>
   ...</code></pre><br>
<code>sort -rn | head -n 10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sorts the lines by the number of occurrences, numerically and in reverse order, so that the main violators are displayed first, of which 10 lines are displayed. </font><font style="vertical-align: inherit;">The last command </font></font><code>awk { print $2 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retrieves the IP addresses themselves.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
  10.11.112.108<font></font>
  10.11.111.70<font></font>
  10.11.97.57<font></font>
  10.11.109.72<font></font>
  10.11.116.156<font></font>
  10.11.100.221<font></font>
  10.11.96.242<font></font>
  10.11.81.68<font></font>
  10.11.99.112<font></font>
  10.11.107.120</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renaming a function in the source file</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine that we are working on a project and would like to rename the under-named function (or class, variable, etc.) in the source file. </font><font style="vertical-align: inherit;">You can do this with a command </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that replaces directly in the original file.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat izk/utils.py<font></font>
def bool_from_str(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/def bool_from_str/def is_affirmative/'</span> izk/utils.py<font></font>
$ cat izk/utils.py<font></font>
def is_affirmative(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">On macOS, </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use </font><font style="vertical-align: inherit;">instead </font></font><code>sed -i ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, we renamed the function only in the original file. </font><font style="vertical-align: inherit;">This will break the import </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in any other file as this function is no longer defined. </font><font style="vertical-align: inherit;">We need to find a way to rename </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">throughout our project. </font><font style="vertical-align: inherit;">This can be achieved using commands </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as well as loops </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or using </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a name="15"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deepening: cycles </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>xargs</code></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To replace all occurrences in our project </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you must first find them recursively with </font></font><code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r bool_from_str .<font></font>
./tests/test_utils.py:from izk.utils import bool_from_str<font></font>
./tests/test_utils.py:def test_bool_from_str(s, expected):<font></font>
./tests/test_utils.py:    assert bool_from_str(s) == expected<font></font>
./izk/utils.py:def bool_from_str(s):<font></font>
./izk/prompt.py:from .utils import bool_from_str<font></font>
./izk/prompt.py:                    default = bool_from_str(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since we are only interested in files with matches, you must also use the option </font></font><code>-l/--files-with-matches</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">-l, --files-with-matches<font></font>
        Only the names of files containing selected lines are written to standard out-<font></font>
        put.  grep will only search a file until a match has been found, making<font></font>
        searches potentially less expensive.  Pathnames are listed once per file<font></font>
        searched.  If the standard input is searched, the string ``(standard input)<span class="hljs-string">''</span>
        is written.</code></pre><br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str .<font></font>
./tests/test_utils.py<font></font>
./izk/utils.py<font></font>
./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then we can use the command </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to carry out actions from each line of the output (that is, all files containing the line </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str . | \<font></font>
  xargs -n 1 sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The option </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicates that each line in the output should execute a separate command </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then the following commands are executed:</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the command that you call with </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(in our case </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) supports multiple arguments, then you should discard the argument </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for performance.</font></font><br>
<br>
<pre><code class="bash hljs">grep -r --files-with-matches bool_from_str . | xargs sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This command will then execute</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py ./izk/utils.py ./izk/prompt.py</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note. </font><font style="vertical-align: inherit;">From the synopsis </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the man page, it can be seen that the team can take several arguments.</font></font><br>
<br>
<pre><code class="bash hljs">SYNOPSIS<font></font>
     sed [-Ealn] <span class="hljs-built_in">command</span> [file ...]<font></font>
     sed [-Ealn] [-e <span class="hljs-built_in">command</span>] [-f command_file] [-i extension] [file ...]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indeed, as we saw in the previous chapter, it </font></font><code>file ...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">means that several arguments are accepted, which are file names.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see that replacements are made for all occurrences </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r is_affirmative .<font></font>
./tests/test_utils.py:from izk.utils import is_affirmative<font></font>
./tests/test_utils.py:def test_is_affirmative(s, expected):<font></font>
./tests/test_utils.py:    assert is_affirmative(s) == expected<font></font>
./izk/utils.py:def is_affirmative(s):<font></font>
./izk/prompt.py:from .utils import is_affirmative<font></font>
./izk/prompt.py:                    default = is_affirmative(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As often happens, there are several ways to achieve the same result. </font><font style="vertical-align: inherit;">Instead, </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we could use loops </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to iterate over the lines in the list and take action on each item. </font><font style="vertical-align: inherit;">These loops have the following syntax:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> list; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">command</span> <span class="hljs-variable">$item</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we wrap our command </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>$()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then the shell will execute it in a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">subshell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the result of which will then be repeated in a loop </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> $(grep -r --files-with-matches bool_from_str .); <span class="hljs-keyword">do</span>
  sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> <span class="hljs-variable">$file</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This command will execute</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The loop syntax </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seems clearer to me than that </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but the latter can execute commands in parallel using parameters </font></font><code>-P n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the maximum number of parallel commands executed at the same time, which can give a performance gain.</font></font><br>
<br>
<a name="16"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All these tools open up a whole world of possibilities, as they allow you to extract and transform data, creating entire pipelines from teams that may never have been intended to work together. Each of them performs a relatively small function (sorting </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, combining </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, filters </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, editing </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cutting </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Any task that includes text can be reduced to a pipeline of smaller tasks, each of which performs a simple action and transfers its output to the next task. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, if we want to know how many unique IP addresses are in the log file, and so that these IP addresses always appear in the same column, then we can run the following sequence of commands:</font></font><br>
<br>
<ul>
<li><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strings that match the pattern of strings with IP addresses</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find the column with IP address, extract it with </font></font><code>awk</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sort the list of IP addresses using </font></font><code>sort</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eliminate adjacent duplicates with </font></font><code>uniq</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">count the number of lines (i.e. unique IP addresses) using </font></font><code>wc -l</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since there are many native and third-party word processing tools, there are also many ways to solve any problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The examples in this article were far-fetched, but I suggest you read the amazing article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Command-line tools can be 235 times faster than your Hadoop cluster”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to get an idea of ​​how useful and powerful these commands really are and what real problems they can decide.</font></font><br>
<br>
<a name="17"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What's next</font></font></h1><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Count the number of files and directories located in your home directory.</font></font><br>
</li>
<li>     .<br>
</li>
<li>,       .<br>
</li>
<li>    .         .</li>
</ol><br>
<hr><br>
<i>  «        » (Essential Tools and Practices for the Aspiring Software Developer)    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>            ,     .    ,    ,   ,       ,      <code>git</code>,  SQL,   <code>Make</code>, <code>jq</code>   ,   ,          .<br>
<br>
    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>!</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492910/index.html">Stepper motor control via Canny controller</a></li>
<li><a href="../en492914/index.html">How to protect remote employees, or Home Office Security</a></li>
<li><a href="../en492918/index.html">Pope: Ethics for AI and Unmanned Vehicles</a></li>
<li><a href="../en492920/index.html">Quarantine in the Czech Republic: an inside look</a></li>
<li><a href="../en492924/index.html">How to visualize and animate (geophysical) models. Informativeness of visualization</a></li>
<li><a href="../en492934/index.html">Difficulties in raising a voice assistant. The look of a linguist and developer</a></li>
<li><a href="../en492938/index.html">Portal of test environments, or Save our devops</a></li>
<li><a href="../en492940/index.html">Dive into Charles Proxy</a></li>
<li><a href="../en492942/index.html">Ontol (= most useful) about remote work [compilation of 100+ articles]</a></li>
<li><a href="../en492946/index.html">Coronavirus: how we deceive ourselves</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>