<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤳🏾 🦂 🙆🏿 Un milliard d'opérations dans la base de données en 0,3 seconde. Ne comparez pas OLTP avec OLAP, mais QuestDB avec PostgreSQL 👰🏼 👲🏼 💪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Très souvent, pour mes 15 années d'expérience en tant que développeur de logiciels et chef d'équipe, je rencontre la même chose. La programmation se t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Un milliard d'opérations dans la base de données en 0,3 seconde. Ne comparez pas OLTP avec OLAP, mais QuestDB avec PostgreSQL</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496206/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Très souvent, pour mes 15 années d'expérience en tant que développeur de logiciels et chef d'équipe, je rencontre la même chose. La programmation se transforme en religion - rarement quelqu'un essaie d'introduire une technologie basée sur un choix raisonnable, raisonnablement, en tenant compte des restrictions, de la portabilité, de l'évaluation du degré d'attachement au vendeur, du prix réel, des perspectives de la technologie et de la liberté de licence. Les développeurs vont à des conférences ou lisent des articles - commencez à faire du battage médiatique, et leurs directeurs et directeurs informatiques sont nourris non seulement avec des histoires d'un brillant avenir agile lors d'événements, de visionnaires divers, de ventes et de consultants. Et il s'avère que les technologies étaient dans le projet, ne tenant pas compte de la commodité du développement et de la mise en œuvre, des exigences non fonctionnelles du projet, mais parce qu'il est hype et que Google se sert lui-même,amazon recommande (bien que leurs postes vacants indiquent qu'ils ne l'utilisent pas souvent eux-mêmes) ou la décision la plus élevée a été prise par la direction de l'entreprise pour mettre en œuvre "this".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gw/5o/oc/gw5ooc3vrg7l1posp3i32i1r5ng.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le plaisir spécial est de choisir une base de données. Plus le volume d'informations stockées est important, plus la structure des données dans le projet et leurs changements / évolution sont complexes, plus les exigences en termes de temps de réponse ou de performances sont élevées, plus l'erreur de sélection au début des étapes ultérieures du projet est coûteuse.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai une idée pourquoi il en est ainsi - en un mot, le prototypage et la comparaison de différentes technologies sont «coûteux» (temps, licences, formation ou rétro-ingénierie) et il y a une tentation d'allumer des instincts anciens et de passer de la partie des preuves chronophages à amusant et simple, touchant l'abîme de l'irrationalité. Je l'ai fait aussi, et j'ai également vu comment les choses les plus ridicules se produisent chez moi et mes amis et pas seulement par décision de spécialistes techniques. Par conséquent, le choix d'un langage de programmation, de frameworks, de files d'attente de messages ou de fournisseurs de cloud peut également être fait sur la base de publications dans des réseaux, de rapports lors de conférences, de manuels de Gartner pour les gestionnaires ou de fortunetelling. C'est dommage que je ne puisse pas raconter beaucoup d'histoires de mon travail, parce que j'ai peur pour ma vie après ça ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce qui affecte le choix de la base de données</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De mon point de vue, lors du choix d'une base de données, je dois résoudre au moins les compromis suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traitement des transactions en temps réel ou traitement analytique en ligne</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">évolutif verticalement ou horizontalement</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le cas d'une base distribuée - cohérence des données / disponibilité / résistance de séparation (théorème CAP)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un schéma de données spécifique et des restrictions dans la base de données ou le stockage qui ne nécessitent pas de schéma de données</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modèle de données - valeur-clé, hiérarchique, graphique, document ou relationnel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une logique de traitement au plus proche des données ou de tous les traitements dans l'application</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">travailler principalement en RAM ou avec un sous-système de disque</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solution universelle ou spécialisée</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous utilisons l'expertise existante sur une base de données qui n'est pas particulièrement adaptée aux exigences du projet ou nous en développons une nouvelle dans une formation appropriée mais pas familière, «sang et sueur» (il en va de même non seulement pour le développement, mais aussi pour l'exploitation)</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intégré ou dans un autre processus / réseau</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hipster ou rétrograde</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Souvent, nous obtenons un «cadeau» pour la solution mise en œuvre:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langage de requête «étranger»</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la seule API native pour travailler avec la base de données, ce qui compliquera la transition vers d'autres bases de données (temps, effort d'équipe et budget du projet ont été dépensés)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indisponibilité de pilotes pour d'autres plates-formes / langues / systèmes d'exploitation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manque de codes sources, de descriptions du format des données sur le disque (ou interdiction des licences de reverse engineering, notamment Oracle avec le buggy Coherence)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">croissance des coûts de licence d'année en année</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propre écosystème et difficulté à trouver des spécialistes</font></font></li>
<li>    ,  , </li>
<li></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La mise à l'échelle horizontale des systèmes est assez complexe et nécessite l'expertise de l'équipe. Les développeurs expérimentés sont assez chers sur le marché, les applications distribuées sont plus difficiles à développer, déboguer et tester. Par conséquent, s'il est possible de changer le serveur pour un serveur plus puissant et la quantité de données autorisée par le système, ils le font souvent. Désormais, les serveurs peuvent contenir des téraoctets de RAM et des centaines de cœurs de processeur. Ainsi, comme jamais auparavant, il devient important d'utiliser toutes les ressources du serveur aussi efficacement que possible. Le coût des licences de base de données est également important, et si elles sont vendues par des cœurs de processeur, le budget d'exploitation, même avec une mise à l'échelle verticale, peut coûter autant qu'un programme spatial de superpuissance. Par conséquent, il est important de garder cela à l'esprit afin de ne pas être en mesure de faire évoluer les performances de la base de données en raison des licences.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est clair qu'avec l'aide du marketing, ils essaieront de vous convaincre que seule la solution d'une certaine entreprise résoudra tous vos problèmes (mais ils ne disent pas combien de nouveaux apparaîtront). Il n'y a pas de base de données idéale qui convienne à tout le monde et convient à tout.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, dans un avenir prévisible, nous continuerons à prendre en charge plusieurs bases de données différentes pour traiter les mêmes données pour différents types de requêtes dans différents systèmes. Pas de solutions pour Data Fabric sans mise en cache des données, Data Lake ne peut pas encore être comparé à des bases de données avec une architecture de masse parallèle en termes de performances et d'optimalité des requêtes. Les données transactionnelles seront toujours stockées dans PostgreSQL, Oracle, MS SQL Server, les requêtes analytiques dans Citus, Greenplum, Snowflake, Redshift, Vertica, Impala, Teradata et les marécages de données brutes dans HDFS / S3 / ADLS (Azure) seront gérés par Dremio , Redshift Spectrum, Apache Spark, Presto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais les solutions répertoriées ci-dessus sont mal adaptées à l'analyse de données de séries chronologiques avec un temps de réponse faible. </font><font style="vertical-align: inherit;">Selon sa popularité à travailler avec des données de séries chronologiques, il est maintenant dans les favoris d'InfluxDB. </font><font style="vertical-align: inherit;">Dans le créneau des bases de données en mémoire, kdb + et memSQL gardent leur place.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuestDB</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce qui peut opposer toutes ces solutions </font><font style="vertical-align: inherit;">open source </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuestDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec une licence Apache?</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une tentative de tirer le meilleur parti du matériel pour effectuer des requêtes analytiques - vectorisation des fonctions d'agrégation, travailler avec des données via des fichiers mappés en mémoire</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL comme langage des requêtes DML et des opérations DDL pour gérer la structure de la base de données</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prise en charge des tables de jointure spécifiques aux séries chronologiques DB</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prise en charge des fonctions de fenêtre et d'agrégation dans SQL</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la possibilité d'incorporer une base de données dans une application sur la JVM</font></font></li>
<li>        JVM,        ServiceLoader</li>
<li> Influx DB line protocol (ILP)  UDP  Telegraf.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">«What makes QuestDB faster than InfluxDB»</a></li>
<li> PostgreSql 11           PostgreSQL: JDBC, ODBC   psql <br>
</li>
<li>   web    -  REST endpoint  ,     SQL      json <br>
</li>
<li>       ,    <br>
</li>
<li>          zero-GC API,       .<br>
</li>
<li>                  (        )<br>
</li>
<li> 64  Windows, Linux, OSX, ARM Linux    FreeBSD<br>
</li>
<li>,    open source,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque cette base de données peut vous être utile - si vous développez des systèmes financiers sur la JVM avec une faible latence et que vous avez besoin d'une solution pour l'analyse de données en RAM. </font><font style="vertical-align: inherit;">En remplacement de kdb + en raison du coût des licences. </font><font style="vertical-align: inherit;">Si vous collectez des métriques selon le protocole Influx / Telegraf, mais les performances et la convivialité de travailler avec InfluxDB ne sont pas satisfaisantes. </font><font style="vertical-align: inherit;">Si votre projet s'exécute sur la JVM et que vous avez besoin d'une base de données intégrée pour stocker des métriques ou des données d'application qui sont uniquement ajoutées et non mises à jour. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nouvelle version 4.2.0 avec prise en charge des instructions SIMD a provoqué </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vague de commentaires </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sur Reddit</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour que les fans participent au concours de la connaissance du matériel moderne et de sa programmation efficace, je recommande de discuter avec l'auteur de la base de données (bluestreak01) dans les commentaires!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérations SIMD</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipe de projet a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">effectué un test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur des données synthétiques et a comparé QuestDB 4.2.0 avec kdb 4.0 pour agréger un milliard de valeurs, en exploitant les instructions SIMD des processeurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la plate-forme Intel 8850H: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/-z/vy/bh-zvyhql33d-ezkf9h0mudxia0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la </font><font style="vertical-align: inherit;">plate-forme </font><font style="vertical-align: inherit;">AMD Ryzen 3900X: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/f7/_d/baf7_d-6mpkifdhg8wiwtay2xle.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est clair que ce sont tous des tests dans un «vide», mais vous pouvez comparer vos données si votre projet utilise kdb et partager les résultats avec la communauté.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution de l'image de la base de données Docker</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base de données est publiée sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dockerhub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec chaque version. </font><font style="vertical-align: inherit;">Plus de détails sont décrits dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">projet</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtenez l'image QuestDB:</font></font><br>
<br>
<pre><code class="bash hljs">docker pull questdb/questdb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous lançons:</font></font><br>
<br>
<pre><code class="bash hljs">docker run --rm -it -p 9000:9000 -p 8812:8812 questdb/questdb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, vous pouvez vous connecter en utilisant le protocole PostgreSQL au port 8812, la console Web est disponible sur le port 9000.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accès jdbc</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon notre projet, nous ajoutons le pilote PostrgreSQL jdbc </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.postgresql: postgresql: 42.2.12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour ce test j'utilise </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mon module QuestDB pour les testcontainers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le test est disponible</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur github avec le script de build:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.DriverManager;
<span class="hljs-keyword">import</span> java.sql.ResultSet;
<span class="hljs-keyword">import</span> java.sql.Statement;<font></font>
<font></font>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.assertj.core.api.Assertions.*;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuestDbDriverTest</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">containerIsUpTestByJdbcInvocation</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
        <span class="hljs-keyword">try</span> (Connection connection = DriverManager.getConnection(<span class="hljs-string">"jdbc:tc:questdb:///?user=admin&amp;password=quest"</span>)){
            <span class="hljs-keyword">try</span> (Statement statement = connection.createStatement()){
                <span class="hljs-keyword">try</span> (ResultSet resultSet = statement.executeQuery(<span class="hljs-string">"select 42 from long_sequence(1)"</span>)){<font></font>
                    resultSet.next();<font></font>
                    assertThat(resultSet.getInt(<span class="hljs-number">1</span>)).isEqualTo(<span class="hljs-number">42</span>);<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exécution de docker entraîne une surcharge supplémentaire, et cela peut être évité en implémentant simplement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">org.questdb: core: jar: 4.2.0 en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tant que dépendance du projet et en exécutant io.questdb.ServerMain:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> io.questdb.ServerMain;
<span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;
<span class="hljs-keyword">import</span> org.junit.jupiter.api.io.TempDir;<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.nio.file.Path;
<span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.DriverManager;
<span class="hljs-keyword">import</span> java.sql.PreparedStatement;
<span class="hljs-keyword">import</span> java.sql.Statement;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuestDbJdbcTest</span> </span>{
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">embeddedServerStartTest</span><span class="hljs-params">(<span class="hljs-meta">@TempDir</span> Path tempDir)</span> <span class="hljs-keyword">throws</span> Exception</span>{<font></font>
        ServerMain.main(<span class="hljs-keyword">new</span> String[]{<span class="hljs-string">"-d"</span>, tempDir.toString()});
        <span class="hljs-keyword">try</span> (DriverManager.getConnection(<span class="hljs-string">"jdbc:postgresql://localhost:8812/"</span>, <span class="hljs-string">"admin"</span>, <span class="hljs-string">"quest"</span>)){
            <span class="hljs-keyword">try</span> (Statement statement = connection.createStatement()){
                <span class="hljs-keyword">try</span> (ResultSet resultSet = statement.executeQuery(<span class="hljs-string">"select 42 from long_sequence(1)"</span>)){<font></font>
                    resultSet.next();<font></font>
                    assertThat(resultSet.getInt(<span class="hljs-number">1</span>)).isEqualTo(<span class="hljs-number">42</span>);<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intégration dans une application Java</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais c'est le moyen le plus rapide de travailler avec la base de données à l'aide de l'API Java inprocess:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> io.questdb.cairo.CairoEngine;
<span class="hljs-keyword">import</span> io.questdb.cairo.DefaultCairoConfiguration;
<span class="hljs-keyword">import</span> io.questdb.griffin.CompiledQuery;
<span class="hljs-keyword">import</span> io.questdb.griffin.SqlCompiler;
<span class="hljs-keyword">import</span> io.questdb.griffin.SqlExecutionContextImpl;
<span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;
<span class="hljs-keyword">import</span> org.junit.jupiter.api.io.TempDir;<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.nio.file.Path;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TruncateExecuteTest</span> </span>{
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">truncate</span><span class="hljs-params">(<span class="hljs-meta">@TempDir</span> Path tempDir)</span> <span class="hljs-keyword">throws</span> Exception</span>{<font></font>
        SqlExecutionContextImpl executionContext = <span class="hljs-keyword">new</span> SqlExecutionContextImpl();<font></font>
        DefaultCairoConfiguration configuration = <span class="hljs-keyword">new</span> DefaultCairoConfiguration(tempDir.toAbsolutePath().toString());
        <span class="hljs-keyword">try</span> (CairoEngine engine = <span class="hljs-keyword">new</span> CairoEngine(configuration)) {
            <span class="hljs-keyword">try</span> (SqlCompiler compiler = <span class="hljs-keyword">new</span> SqlCompiler(engine)) {<font></font>
                CompiledQuery createTable = compiler.compile(<span class="hljs-string">"create table tr_table(id long,name string)"</span>, executionContext);<font></font>
                compiler.compile(<span class="hljs-string">"truncate table tr_table"</span>, executionContext);<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Console Web</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet comprend une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">console Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour interroger QuestDB </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5v/_w/bb/5v_wbbpw-roh7cbrv7jpivazvgc.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ET télécharger des données vers une base de données au format csv via un navigateur.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fw/ya/lu/fwyalug09h88tp3iyaeyotztxoo.gif"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avez-vous besoin d'une autre base de données?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce projet est jeune et manque encore de certaines caractéristiques de l'entreprise, mais il se développe assez rapidement et plusieurs contributeurs travaillent activement sur le projet. Je suis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuestDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> depuis août dernier et </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">j'ai</font></a><font style="vertical-align: inherit;"> développé quelques extensions pour ce projet ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdbc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">osquery</font></a><font style="vertical-align: inherit;"> ), et </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">j'ai</font></a><font style="vertical-align: inherit;"> également intégré </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce projet avec des conteneurs de test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Maintenant, j'essaie de résoudre mes problèmes actuels dans Dremio avec le téléchargement incrémentiel de données, le partitionnement des données et de longues transactions vers les sources de données en production en utilisant QuestDB, en le complétant avec des fonctions d'exportation de données. J'ai l'intention de partager mon expérience dans les publications suivantes. Cela me soudoie surtout que je peux déboguer mes fonctions et ma base de données sur la plateforme que je connais, écrire des tests unitaires qui s'exécutent à la vitesse de la lumière. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous décidez en tant que développeur expérimenté. Encore une fois, QuestDB ne remplace pas les bases de données OLTP - PostgreSQL, Oracle, MS SQL Server, DB2 ou même un remplacement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H2 pour les tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans la JVM. </font><font style="vertical-align: inherit;">Il s'agit d'une puissante base de données open source spécialisée prenant en charge les protocoles réseau PostgreSQL, Influx / Telegraf. </font><font style="vertical-align: inherit;">Si votre scénario d'utilisation correspond aux fonctionnalités qui y sont implémentées et au scénario principal d'utilisation d'une base de données de colonnes, alors le choix est justifié!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496188/index.html">Comment arrêter la frénésie de regarder des émissions de télévision et commencer à vivre</a></li>
<li><a href="../fr496190/index.html">À propos des verbes Phrasal-2</a></li>
<li><a href="../fr496192/index.html">Appeler les fonctions Rust depuis Go</a></li>
<li><a href="../fr496194/index.html">Sur la binarisation d'images tomographiques à structure fine</a></li>
<li><a href="../fr496204/index.html">Mise à jour du processus CI / CD: préparation et planification</a></li>
<li><a href="../fr496208/index.html">Comment JIT intègre notre code C # (heuristique)</a></li>
<li><a href="../fr496210/index.html">La biodiversité peut avoir évolué à partir du principe de jouer des ciseaux à papier</a></li>
<li><a href="../fr496212/index.html"># 04 - Et un octet entier ne suffit pas ... | Prenez BK par les cornes</a></li>
<li><a href="../fr496214/index.html">AdColony: 89% des éditeurs d'applications et de jeux mobiles utilisent des vidéos promotionnelles</a></li>
<li><a href="../fr496216/index.html">Magasin sombre: y pensez-vous déjà?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>