<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ë üíä üë®‚Äçüë®‚Äçüëß‚Äçüë¶ Pertanyaan wawancara kesulitan menengah SQL terbaik üíü üëàüèø üöµüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="70% pertama dari kursus SQL tampaknya cukup mudah. Kesulitan dimulai pada 30% sisanya.
 
 Dari 2015 hingga 2019, saya melakukan empat wawancara untuk ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pertanyaan wawancara kesulitan menengah SQL terbaik</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dcmiran/blog/500360/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">70% pertama dari kursus SQL tampaknya cukup mudah. Kesulitan dimulai pada 30% sisanya.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dari 2015 hingga 2019, saya melakukan empat wawancara untuk posisi analis data dan spesialis analisis data di lebih dari selusin perusahaan. Setelah wawancara yang gagal pada tahun 2017 - ketika saya bingung tentang pertanyaan SQL yang kompleks - saya mulai menyusun buku tugas dengan pertanyaan SQL dengan kompleksitas sedang dan tinggi untuk mempersiapkan persiapan wawancara yang lebih baik. Panduan ini sangat berguna dalam putaran terakhir wawancara pada tahun 2019. Selama setahun terakhir, saya berbagi panduan ini dengan beberapa teman, dan berkat waktu luang ekstra karena pandemi, saya memolesnya dan menyusun dokumen ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak tutorial SQL yang bagus untuk pemula. Favorit saya adalah</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kursus interaktif SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">dari Codecademy</font></a><font style="vertical-align: inherit;"> oleh Zi Chung Kao. </font><font style="vertical-align: inherit;">Namun pada kenyataannya, 70% pertama dari kursus SQL cukup sederhana, dan kesulitan sebenarnya dimulai pada 30% sisanya, yang tidak tercakup dalam panduan pemula. </font><font style="vertical-align: inherit;">Jadi, pada wawancara untuk analis data dan spesialis analisis data di perusahaan teknologi sering mengajukan pertanyaan tentang 30% ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anehnya, saya tidak menemukan sumber lengkap tentang masalah kesulitan sedang, jadi saya menyusun panduan ini.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berguna untuk wawancara, tetapi pada saat yang sama akan meningkatkan efektivitas Anda dalam pekerjaan Anda saat ini dan masa depan. </font><font style="vertical-align: inherit;">Secara pribadi, saya percaya bahwa beberapa templat SQL yang disebutkan juga berguna untuk sistem ETL yang menjalankan alat pelaporan dan fungsi analisis data untuk mengidentifikasi tren.</font></font><br>
<br>
<blockquote><h1><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kandungan</font></font></a></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">        SQL</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 2.   </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 3.     ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 2</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 3</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 4.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 5.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 6.   </a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 2.        ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 2</a></li>
</ul></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">     </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 1. </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 2.   ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> 2</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">‚Ññ 3.  </a></li>
</ul></li>
</ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda perlu memahami bahwa selama wawancara dengan analis data dan analis data, mereka tidak hanya bertanya tentang SQL. Topik umum lainnya termasuk diskusi tentang proyek-proyek sebelumnya, pengujian A / B, pengembangan metrik, dan masalah analitik terbuka. Sekitar tiga tahun yang lalu, Quora memposting </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tips</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wawancara untuk posisi analis produk di Facebook. Di sana, topik ini dibahas secara lebih rinci. Namun, jika meningkatkan pengetahuan Anda tentang SQL akan membantu Anda dalam wawancara Anda, maka panduan ini sepadan dengan waktu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di masa depan, saya dapat port kode dari panduan ini ke situs seperti </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk membuatnya lebih mudah untuk menulis pernyataan SQL - dan melihat hasil eksekusi kode secara real time. </font><font style="vertical-align: inherit;">Sebagai pilihan, tambahkan pertanyaan sebagai masalah ke platform untuk mempersiapkan wawancara </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeetCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sementara itu, saya hanya ingin menerbitkan dokumen ini sehingga orang sekarang dapat berkenalan dengan informasi ini.</font></font><br>
<br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asumsi dibuat dan cara menggunakan manual</font></font></h1><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asumsi tentang pengetahuan bahasa SQL:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diasumsikan bahwa Anda memiliki pengetahuan tentang SQL. </font><font style="vertical-align: inherit;">Anda mungkin sering menggunakannya di tempat kerja, tetapi ingin mengasah keterampilan Anda dalam topik seperti asosiasi diri dan fungsi jendela. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara menggunakan manual ini:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Karena papan atau notebook virtual sering digunakan dalam wawancara (tanpa menyusun kode), saya sarankan mengambil pensil dan kertas dan menuliskan solusi untuk setiap masalah, dan setelah menyelesaikan, bandingkan catatan Anda dengan jawabannya. </font><font style="vertical-align: inherit;">Atau jawab jawaban Anda dengan seorang teman yang akan bertindak sebagai pewawancara!</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesalahan sintaksis kecil tidak terlalu penting selama wawancara dengan papan tulis atau notepad. </font><font style="vertical-align: inherit;">Tetapi mereka dapat mengganggu pewawancara, jadi idealnya mencoba mengurangi jumlah mereka untuk memusatkan semua perhatian pada logika.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawaban yang diberikan belum tentu satu-satunya cara untuk menyelesaikan setiap masalah. </font><font style="vertical-align: inherit;">Jangan ragu untuk menulis komentar dengan solusi tambahan yang dapat Anda tambahkan ke panduan ini!</font></font></li>
</ul><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat untuk menyelesaikan tugas kompleks dalam wawancara SQL</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, kiat standar untuk semua wawancara pemrograman ...</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengarkan deskripsi masalah dengan seksama, ulangi esensi masalah kepada pewawancara</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merumuskan kasus batas untuk menunjukkan bahwa Anda benar-benar memahami masalah (mis., Garis yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak akan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disertakan dalam kueri SQL akhir yang akan Anda tulis)</font></font><br>
</li>
<li>(    )     ,     ‚Äî     :     ,             <br>
<ul>
<li>,      ,     </li>
</ul></li>
<li>  SQL,   ,     .      ,      .</li>
</ol><br>
<a name="3"></a><h1>   </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa masalah yang tercantum di sini diadaptasi dari entri blog Periscope lama (sebagian besar ditulis oleh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sean Cook</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sekitar 2014, meskipun kepengarangannya tampaknya telah dihapus dari materi setelah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SiSense bergabung dengan Periscope</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), serta dari diskusi tentang StackOverflow. </font><font style="vertical-align: inherit;">Jika perlu, sumber ditandai di awal setiap pertanyaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> juga merupakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilihan brainteasers yang baik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , masalah pelengkap dokumen ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa pertanyaan-pertanyaan ini bukan salinan harfiah dari pertanyaan-pertanyaan dari wawancara saya sendiri, dan itu tidak digunakan di perusahaan tempat saya bekerja atau bekerja.</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas Asosiasi Sendiri</font></font></h1><br>
<a name="5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1. Persentase perubahan bulan ke bulan</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seringkali berguna untuk mengetahui bagaimana metrik kunci berubah, misalnya, pemirsa bulanan pengguna aktif, dari bulan ke bulan. </font><font style="vertical-align: inherit;">Katakanlah kita memiliki tabel </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam formulir ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">tanggal |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tujuan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : menemukan perubahan persentase bulanan di pemirsa bulanan pengguna aktif (MAU). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi: </font></font></b><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Solusi ini, seperti blok kode lainnya dalam dokumen ini, berisi komentar tentang elemen sintaks SQL yang mungkin berbeda antara varian SQL yang berbeda, dan catatan lainnya)</font></font></i> <br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> mau <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
  <span class="hljs-keyword">SELECT</span> 
   <span class="hljs-comment">/* 
    *       
    *  , .&nbsp;.   ,    . 
    *    ,   
    *
    *  Postgres  DATE_TRUNC(),   
    *      SQL   
    * . https://www.postgresql.org/docs/9.0/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC
    */</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>) month_timestamp,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) mau
  <span class="hljs-keyword">FROM</span> <font></font>
    logins <font></font>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>)<font></font>
  )<font></font>
 <font></font>
 <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-comment">/*
    *    SELECT      . 
    * 
    *        ,   
    *    ,   , 
    *        ..
    */</span> <font></font>
    a.month_timestamp previous_month, <font></font>
    a.mau previous_mau, <font></font>
    b.month_timestamp current_month, <font></font>
    b.mau current_mau, <font></font>
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-number">100.0</span>*(b.mau - a.mau)/a.mau,<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> percent_change 
 <span class="hljs-keyword">FROM</span><font></font>
    mau a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    <span class="hljs-comment">/*
    *   `ON b.month_timestamp = a.month_timestamp + interval '1 month'` 
    */</span>
    mau b <span class="hljs-keyword">ON</span> a.month_timestamp = b.month_timestamp - <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span> </code></pre><br>
<a name="6"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 2. Menandai struktur pohon</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> misalkan Anda memiliki tabel </font></font><code>tree</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan dua kolom: yang pertama menunjukkan node, dan yang kedua node induk.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simpul orangtua</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4 3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5 NULL </font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menulis SQL sedemikian rupa sehingga kami menunjuk setiap node sebagai internal (root), root (root) atau end node / leaf (leaf), sehingga untuk nilai di atas Anda mendapatkan yang berikut:</font></font><br>
<br>
<pre><code class="sql hljs">node    label  <font></font>
1       Leaf<font></font>
2       Inner<font></font>
3       Inner<font></font>
4       Leaf<font></font>
5       Root</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Catatan: informasi lebih lanjut tentang terminologi struktur data seperti pohon dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Namun, tidak diperlukan untuk menyelesaikan masalah ini!) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi: </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fabian Hoffman mengusulkan solusi yang lebih umum ini pada 2 Mei 2020. </font><font style="vertical-align: inherit;">Terima kasih Fabian</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> join_table <span class="hljs-keyword">AS</span><font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> <font></font>
        cur.node, <font></font>
        cur.parent, <font></font>
        <span class="hljs-keyword">COUNT</span>(next.node) <span class="hljs-keyword">AS</span> num_children
    <span class="hljs-keyword">FROM</span> <font></font>
        tree cur<font></font>
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
        tree <span class="hljs-keyword">next</span> <span class="hljs-keyword">ON</span> (next.parent = cur.node)
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
        cur.node, <font></font>
        cur.parent<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span>
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Root"</span>
        <span class="hljs-keyword">WHEN</span> num_children = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Leaf"</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">"Inner"</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label
<span class="hljs-keyword">FROM</span> 
    join_table </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi alternatif, tanpa koneksi eksplisit: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> William Chardgin pada 2 Mei 2020 menarik perhatian pada kebutuhan akan kondisi </font></font><code>WHERE parent IS NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahwa solusi ini kembali </font></font><code>Leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai gantinya </font></font><code>NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">William terima kasih!</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Root'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> 
            (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Leaf'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Inner'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label 
 <span class="hljs-keyword">from</span> 
    tree</code></pre><br>
<a name="7"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Retensi pengguna per bulan (beberapa bagian)</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tugas ini diadaptasi dari artikel blog SiSense, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúMenggunakan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Self-Associations </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">untuk Menghitung Retensi,</font></a><font style="vertical-align: inherit;"> Aliran, dan Pengaktifan Kembali </font><font style="vertical-align: inherit;">. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">‚Äù</font></a></font><br>
<br>
<a name="8"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> misalkan kami memiliki statistik otorisasi pengguna di situs dalam tabel </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">tanggal |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tulis permintaan yang menerima jumlah pengguna yang ditahan per bulan. </font><font style="vertical-align: inherit;">Dalam kasus kami, parameter ini didefinisikan sebagai jumlah pengguna yang masuk ke sistem pada bulan ini dan bulan sebelumnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> a.user_id) retained_users 
 <span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                             <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    date_trunc(<span class="hljs-string">'month'</span>, a.date)</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tom Moertel menunjukkan bahwa pra-duplikasi user_id sebelum bergabung sendiri membuat solusi lebih efisien, dan menyarankan kode di bawah ini. </font><font style="vertical-align: inherit;">Terima kasih tom! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi alternatif:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> DistinctMonthlyUsers <span class="hljs-keyword">AS</span> (
  <span class="hljs-comment">/*
  *     ** , 
  *  
  */</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span>
      DATE_TRUNC(<span class="hljs-string">'MONTH'</span>, a.date) <span class="hljs-keyword">AS</span> month_timestamp,<font></font>
      user_id<font></font>
    <span class="hljs-keyword">FROM</span> logins<font></font>
  )<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
  CurrentMonth.month_timestamp month_timestamp,<font></font>
  <span class="hljs-keyword">COUNT</span>(PriorMonth.user_id) <span class="hljs-keyword">AS</span> retained_user_count
<span class="hljs-keyword">FROM</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> CurrentMonth
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> PriorMonth
  <span class="hljs-keyword">ON</span>
    CurrentMonth.month_timestamp = PriorMonth.month_timestamp + <span class="hljs-built_in">INTERVAL</span> <span class="hljs-string">'1 MONTH'</span>
    <span class="hljs-keyword">AND</span> 
    CurrentMonth.user_id = PriorMonth.user_id</code></pre><br>
<a name="9"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sekarang kami mengambil tugas sebelumnya menghitung jumlah pengguna yang ditahan per bulan - dan mengubahnya menjadi terbalik. </font><font style="vertical-align: inherit;">Kami akan menulis permintaan untuk menghitung pengguna yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">belum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kembali ke situs bulan ini. </font><font style="vertical-align: inherit;">Artinya, pengguna "hilang". </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> b.user_id) churned_users 
<span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                         <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
<span class="hljs-keyword">WHERE</span> 
    a.user_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa masalah ini juga dapat diatasi dengan </font></font><code>LEFT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>RIGHT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a name="10"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 3</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin tugas yang lebih sulit daripada yang akan ditawarkan pada wawancara nyata. </font><font style="vertical-align: inherit;">Pikirkan itu lebih seperti teka-teki - atau Anda dapat melewati dan melanjutkan ke tugas berikutnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : jadi kami melakukan pekerjaan dengan baik dari dua masalah sebelumnya. </font><font style="vertical-align: inherit;">Di bawah ketentuan tugas baru, kami sekarang memiliki tabel pengguna yang hilang </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jika pengguna aktif dalam sebulan terakhir, tetapi kemudian tidak aktif dalam hal ini, maka ia dimasukkan dalam tabel untuk bulan ini. </font><font style="vertical-align: inherit;">Begini tampilannya </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">month_date |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">12 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-01 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : sekarang Anda ingin melakukan analisis kohort, yaitu analisis totalitas pengguna aktif yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telah diaktifkan kembali di masa lalu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Buat tabel dengan pengguna ini. </font><font style="vertical-align: inherit;">Anda bisa menggunakan tabel </font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font><font style="vertical-align: inherit;">membuat kohort </font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Di Postgres, cap waktu saat ini dapat diakses melalui </font></font><code>current_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> user_login_data <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp,<font></font>
        a.user_id,<font></font>
        <span class="hljs-comment">/* 
        *   ,    SQL,   , 
        *      SELECT   HAVING.
        *       .  
        */</span> 
        <span class="hljs-keyword">MAX</span>(b.month_date) <span class="hljs-keyword">as</span> most_recent_churn, 
        <span class="hljs-keyword">MAX</span>(DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)) <span class="hljs-keyword">as</span> most_recent_active 
     <span class="hljs-keyword">FROM</span> <font></font>
        logins a<font></font>
     <span class="hljs-keyword">JOIN</span> <font></font>
        user_churns b <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = b.user_id <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; b.month_date 
     <span class="hljs-keyword">JOIN</span><font></font>
        logins c <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = c.user_id 
            <span class="hljs-keyword">AND</span> 
            DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)
     <span class="hljs-keyword">WHERE</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-keyword">current_timestamp</span>)
     <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date),<font></font>
        a.user_id<font></font>
     <span class="hljs-keyword">HAVING</span> 
        most_recent_churn &gt; most_recent_active</code></pre><br>
<a name="11"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 4. Meningkatkan total</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tugas ini diadaptasi dari artikel blog SiSense </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Cash Flow Modeling dalam SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> misalkan kita memiliki tabel </font></font><code>transactions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam bentuk ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">tanggal | </font><font style="vertical-align: inherit;">cash_flow |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ----------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di mana </font></font><code>cash_flow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pendapatan dikurangi biaya untuk setiap hari. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tujuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis permintaan untuk mendapatkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jumlah total</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arus kas setiap hari sedemikian rupa sehingga pada akhirnya Anda mendapatkan tabel dalam formulir ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">tanggal | </font><font style="vertical-align: inherit;">cumulative_cf |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-1100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">-1050 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    a.date <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(b.cash_flow) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions a<font></font>
<span class="hljs-keyword">JOIN</span> b <font></font>
    transactions b <span class="hljs-keyword">ON</span> a.date &gt;= b.date 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    a.date <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi alternatif menggunakan fungsi jendela (lebih efisien!):</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(cash_flow) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span>) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br>
<a name="12"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak. 5. Rata-Rata Bergerak</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tugas ini diadaptasi dari artikel blog SiSense </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Moving Averages di MySQL dan SQL Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> moving average dapat dihitung dengan berbagai cara. </font><font style="vertical-align: inherit;">Di sini kami menggunakan rata-rata sebelumnya. </font><font style="vertical-align: inherit;">Dengan demikian, metrik untuk hari ketujuh dalam sebulan akan menjadi rata-rata dari enam hari sebelumnya dan dirinya sendiri. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : misalkan kita memiliki tabel </font></font><code>signups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam bentuk ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">tanggal | </font><font style="vertical-align: inherit;">sign_ups |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-10-01 | </font><font style="vertical-align: inherit;">35 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : tulis permintaan untuk mendapatkan rata-rata bergerak harian pendaftaran 7 hari. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
  a.date, <font></font>
  <span class="hljs-keyword">AVG</span>(b.sign_ups) average_sign_ups 
<span class="hljs-keyword">FROM</span> <font></font>
  signups a <font></font>
<span class="hljs-keyword">JOIN</span> 
  signups b <span class="hljs-keyword">ON</span> a.date &lt;= b.date + <span class="hljs-built_in">interval</span> <span class="hljs-string">'6 days'</span> <span class="hljs-keyword">AND</span> a.date &gt;= b.date
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
  a.date</code></pre><br>
<a name="13"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak. 6. Beberapa kondisi koneksi</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tugas ini diadaptasi dari artikel blog SiSense, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Menganalisis Email Anda Menggunakan SQL"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> katakanlah tabel kami </font></font><code>emails</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berisi email yang dikirim dari alamat </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan diterima di dalamnya:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">subjek | </font><font style="vertical-align: inherit;">dari | </font><font style="vertical-align: inherit;">untuk | </font><font style="vertical-align: inherit;">timestamp |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ---- | ---------- | -------------- | -------------- | --- ------------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 12:45:03 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">Sur Besar | </font><font style="vertical-align: inherit;">sarah@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:30:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:35:04 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">Lari | </font><font style="vertical-align: inherit;">jill@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 08:12:45 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-03 14:02:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">Yosemite | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 15:01:05 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tulis permintaan untuk mendapatkan waktu respons untuk setiap huruf ( </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) yang dikirim ke </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jangan sertakan surat ke alamat lain. </font><font style="vertical-align: inherit;">Misalkan setiap utas memiliki tema yang unik. </font><font style="vertical-align: inherit;">Perlu diingat bahwa utas mungkin memiliki beberapa surat pulang-pergi antara </font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan penerima lainnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    a.id, <font></font>
    <span class="hljs-keyword">MIN</span>(b.timestamp) - a.timestamp <span class="hljs-keyword">as</span> time_to_respond 
<span class="hljs-keyword">FROM</span> <font></font>
    emails a <font></font>
<span class="hljs-keyword">JOIN</span><font></font>
    emails b <font></font>
        <span class="hljs-keyword">ON</span> <font></font>
            b.subject = a.subject <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.to = b.from<font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.from = b.to <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.timestamp &lt; b.timestamp <font></font>
 <span class="hljs-keyword">WHERE</span> 
    a.to = <span class="hljs-string">'zach@g.com'</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    a.id </code></pre><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas untuk fungsi jendela</font></font></h1><br>
<a name="15"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Cari pengenal dengan nilai maksimum</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Misalkan kita memiliki tabel </font></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan data tentang departemen dan gaji karyawan dalam format berikut:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">gaji |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : menulis permintaan untuk mendapatkan </font></font><code>empno</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gaji tertinggi. </font><font style="vertical-align: inherit;">Pastikan solusi Anda menangani kasus gaji yang sama! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> max_salary <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">MAX</span>(salary) max_salary
    <span class="hljs-keyword">FROM</span> <font></font>
        salaries<font></font>
    )<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
    s.empno<font></font>
<span class="hljs-keyword">FROM</span> <font></font>
    salaries s<font></font>
<span class="hljs-keyword">JOIN</span> 
    max_salary ms <span class="hljs-keyword">ON</span> s.salary = ms.max_salary</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi alternatif menggunakan </font></font><code>RANK()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> sal_rank <span class="hljs-keyword">AS</span> 
  (<span class="hljs-keyword">SELECT</span> <font></font>
    empno, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) rnk
  <span class="hljs-keyword">FROM</span> <font></font>
    salaries)<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
  empno<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  sal_rank<font></font>
<span class="hljs-keyword">WHERE</span> 
  rnk = <span class="hljs-number">1</span>;</code></pre><br>
<a name="16"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Nilai rata-rata dan peringkat dengan fungsi jendela (beberapa bagian)</font></font></h2><br>
<a name="17"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : misalkan kita memiliki tabel </font></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam format ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">gaji |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tulis kueri yang mengembalikan tabel yang sama, tetapi dengan kolom baru yang menunjukkan gaji rata-rata untuk departemen. </font><font style="vertical-align: inherit;">Kami akan mengharapkan tabel seperti ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">gaji | </font><font style="vertical-align: inherit;">avg_salary |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-comment">/*
    * AVG() is a Postgres command, but other SQL flavors like BigQuery use 
    * AVERAGE()
    */</span> 
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(salary),<span class="hljs-number">0</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname) avg_salary
<span class="hljs-keyword">FROM</span>
    salaries</code></pre><br>
<a name="18"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tulis kueri yang menambahkan kolom dengan posisi masing-masing karyawan di lembar waktu berdasarkan gajinya di departemennya, di mana karyawan dengan gaji tertinggi mendapat posisi 1. Kita akan mengharapkan tabel dalam formulir ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">gaji | </font><font style="vertical-align: inherit;">gaji_kini |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mengembangkan | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 personil | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 penjualan | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) salary_rank
 <span class="hljs-keyword">FROM</span>  
    salaries </code></pre><br>
<a name="19"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas-tugas lain dari kesulitan sedang dan tinggi</font></font></h1><br>
<a name="20"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1. Histogram</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Katakanlah kita memiliki tabel di </font></font><code>sessions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mana setiap baris mewakili sesi streaming video dengan panjang dalam detik:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">session_id | </font><font style="vertical-align: inherit;">length_seconds |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">453 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">27 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis kueri untuk menghitung jumlah sesi yang jatuh interval lima detik, yaitu, untuk fragmen di atas, hasilnya akan menjadi seperti ini:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">ember | </font><font style="vertical-align: inherit;">hitung |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">20-25 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">450-455 | </font><font style="vertical-align: inherit;">1 |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skor maksimum dihitung untuk label garis yang tepat ("5-10", dll.) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solusi:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> bin_label <span class="hljs-keyword">AS</span> 
(<span class="hljs-keyword">SELECT</span> <font></font>
    session_id, <font></font>
    <span class="hljs-keyword">FLOOR</span>(length_seconds/<span class="hljs-number">5</span>) <span class="hljs-keyword">as</span> bin_label 
 <span class="hljs-keyword">FROM</span><font></font>
    sessions <font></font>
 )<font></font>
 <span class="hljs-keyword">SELECT</span> 
    CONCATENTATE(<span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>), <span class="hljs-string">'-'</span>, <span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>+<span class="hljs-number">5</span>)) <span class="hljs-keyword">bucket</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> session_id) <span class="hljs-keyword">count</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    bin_label<font></font>
 <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    bin_label <span class="hljs-keyword">ASC</span> </code></pre><br>
<a name="21"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Sambungan silang (beberapa bagian)</font></font></h2><br>
<a name="22"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> katakanlah kita memiliki tabel di </font></font><code>state_streams</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mana nama negara dan jumlah total streaming dari hosting video ditunjukkan pada setiap baris:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">negara | </font><font style="vertical-align: inherit;">total_streams |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">34569 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">33999 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CA | </font><font style="vertical-align: inherit;">98324 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MA | </font><font style="vertical-align: inherit;">19345 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Faktanya, tabel agregat dari jenis ini biasanya memiliki kolom tanggal, tetapi kami akan mengecualikannya untuk tugas ini) </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis kueri untuk mendapatkan pasangan negara dengan jumlah utas total dalam ribuan dari satu sama lain. </font><font style="vertical-align: inherit;">Untuk cuplikan di atas, kami ingin melihat sesuatu seperti:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">state_a | </font><font style="vertical-align: inherit;">state_b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | --------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">SC |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">NC |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a<font></font>
 <span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> <font></font>
    state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai informasi, gabungan silang juga dapat ditulis tanpa secara spesifik menentukan gabungan:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br>
<a name="23"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini adalah pertanyaan bonus daripada templat SQL yang sangat penting. </font><font style="vertical-align: inherit;">Anda bisa melewatinya! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bagaimana saya bisa memodifikasi SQL dari solusi sebelumnya untuk menghapus duplikat? </font><font style="vertical-align: inherit;">Misalnya, contoh meja yang sama, untuk dikukus </font></font><code>NC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>SC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya ada satu kali, bukan dua. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &gt; b.state </code></pre><br>
<a name="24"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Perhitungan lanjutan</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tugas ini diadaptasi dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diskusi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada pertanyaan yang saya ajukan di StackOverflow (nama panggilan saya adalah zthomas.nc). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin tugas yang lebih sulit daripada yang akan ditawarkan pada wawancara nyata. </font><font style="vertical-align: inherit;">Pikirkan itu lebih seperti puzzle - atau Anda bisa melewatinya! </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> misalkan kita memiliki tabel </font></font><code>table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semacam ini, di mana </font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai yang berbeda dari suatu kelas dapat berhubungan </font><font style="vertical-align: inherit;">dengan pengguna yang sama </font></font><code>class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">pengguna | </font><font style="vertical-align: inherit;">kelas |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------ | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">a |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">a |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Misalkan hanya ada dua nilai yang mungkin untuk suatu kelas. </font><font style="vertical-align: inherit;">Tulis kueri untuk menghitung jumlah pengguna di setiap kelas. </font><font style="vertical-align: inherit;">Dalam hal ini, pengguna dengan kedua label </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus merujuk ke kelas </font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk sampel kami, kami mendapatkan hasil berikut:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">kelas | </font><font style="vertical-align: inherit;">hitung |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">b | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keputusan:</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> usr_b_sum <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) num_b
    <span class="hljs-keyword">FROM</span> 
        <span class="hljs-keyword">table</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        <span class="hljs-keyword">user</span><font></font>
), <font></font>
<font></font>
usr_class_label <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> num_b &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'b'</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'a'</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">class</span> 
    <span class="hljs-keyword">FROM</span> <font></font>
        usr_b_sum<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">class</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> <span class="hljs-keyword">user</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">FROM</span><font></font>
    usr_class_label<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi alternatif menggunakan instruksi </font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di operator </font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>UNION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"a"</span> <span class="hljs-keyword">class</span>,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) - <font></font>
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">UNION</span>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"b"</span> <span class="hljs-keyword">class</span>,<font></font>
    (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> </code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id500344/index.html">Rumah pintar di atas roda ... Alice. Bagian 2. ZIGBEE</a></li>
<li><a href="../id500346/index.html">Masalah dengan DNS di Kubernetes. Post-mortem publik</a></li>
<li><a href="../id500352/index.html">Bagaimana cara mendapatkan magang di Facebook dan mendapatkan tawaran di London? Ajukan Pertanyaan ke Insinyur Facebook</a></li>
<li><a href="../id500354/index.html">Cara baru untuk melacak data di Google Pengelola Tag - Penandaan Sisi Server</a></li>
<li><a href="../id500356/index.html">Transfer file langsung antar perangkat melalui WebRTC</a></li>
<li><a href="../id500364/index.html">Memperluas portal pembelajaran sekolah di Moodle dan BigBlueButton</a></li>
<li><a href="../id500368/index.html">Menghasilkan urutan acak yang dapat diprediksi: pendekatan permutasi yang berbeda</a></li>
<li><a href="../id500370/index.html">10 podcast berbahasa Inggris yang berguna untuk programmer yang layak berlangganan pada tahun 2020</a></li>
<li><a href="../id500378/index.html">Pencarian informasi yang efektif di tempat kerja</a></li>
<li><a href="../id500380/index.html">Memproses data pribadi dari jarak jauh: risiko dan kemungkinan konsekuensi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>