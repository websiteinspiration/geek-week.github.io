<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥• ğŸ¤·ğŸ½ ğŸ’ Google App Scriptã€Mikrotikã€Telegramã€VPNBookãŒã‚«ãƒ«ãƒ†ãƒƒãƒˆã®æ¼”å¥ã‚’é–‹å§‹ ğŸˆšï¸ ğŸ¤™ğŸ½ ğŸ™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä»Šæ—¥ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼šé€šå¸¸ã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒçµ‚ã‚ã£ãŸã‚‰ã€ä»–ã«ã©ã“ã«Google Appsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’é©ç”¨ã§ãã¾ã™ã‹ã€‚ç§ãŒçŸ¥ã‚‰ãªã„ã•ã¾ã–ã¾ãªè¨€èªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒã‚§ãƒ¼ãƒ³ã«ã‚ˆã‚‹VPNBookã§ã®ä½œæ¥­ã®è‡ªå‹•åŒ–ã€‚Nek-cURL by Mikrotikã€‚ã‚ã‚‹å ´æ‰€ã‚’ä»‹ã—ã¦é›»å ±ã‚’é€ä¿¡ã—ã€åˆ¥ã®å ´æ‰€ã«å­˜åœ¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Google App Scriptã€Mikrotikã€Telegramã€VPNBookãŒã‚«ãƒ«ãƒ†ãƒƒãƒˆã®æ¼”å¥ã‚’é–‹å§‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475856/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»Šæ—¥ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼šé€šå¸¸ã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒçµ‚ã‚ã£ãŸã‚‰ã€ä»–ã«ã©ã“ã«Google Appsã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’é©ç”¨ã§ãã¾ã™ã‹ã€‚</font><font style="vertical-align: inherit;">ç§ãŒçŸ¥ã‚‰ãªã„ã•ã¾ã–ã¾ãªè¨€èªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒã‚§ãƒ¼ãƒ³ã«ã‚ˆã‚‹VPNBookã§ã®ä½œæ¥­ã®è‡ªå‹•åŒ–ã€‚</font><font style="vertical-align: inherit;">Nek-cURL by Mikrotikã€‚</font><font style="vertical-align: inherit;">ã‚ã‚‹å ´æ‰€ã‚’ä»‹ã—ã¦é›»å ±ã‚’é€ä¿¡ã—ã€åˆ¥ã®å ´æ‰€ã«å­˜åœ¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€è‡ªå·±ç›£è¦–ãŒå¯èƒ½ã§ã™ã€‚</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ1.ç„¡é¡Œ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1å¹´å‰ã€</font><font style="vertical-align: inherit;">VPNBookã‚’ä»‹ã—ã¦ç„¡æ–™ã®VPNã‚¢ã‚¯ã‚»ã‚¹ã®ãŸã‚ã«Mikrotikãƒ«ãƒ¼ã‚¿ãƒ¼ã§è‡ªå‹•ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å–å¾—ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã€ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPNBookãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã»ã¼OCRã€‚PHP + Mikrotik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font><font style="vertical-align: inherit;">ã¨ã„ã†ãƒ¡ãƒ¢ã‚’æ›¸ãã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚ç‰©èªã®å§‹ã¾ã‚Šã¯ãã“ã«ã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œä»¥æ¥ã€å¤§é‡ã®æ°´ãŒæµã‚Œã€ãƒ­ã‚·ã‚¢ã§ã¯VPNBookã‚µã‚¤ãƒˆã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã—ãŸãŒã€å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒ–ãƒªãƒƒã‚¯VPNã‚µãƒ¼ãƒãƒ¼è‡ªä½“ã¯ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã„ã¾ã›ã‚“ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®PNGç”»åƒã‚’ãƒ†ã‚­ã‚¹ãƒˆæ–‡å­—åˆ—ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹PHPã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’é€šéã—ãªã„ã‚µãƒ¼ãƒãƒ¼ã§èµ·å‹•ã—ãŸã¨ãã«ã‚‚æ©Ÿèƒ½ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã—ã‹ã—ã€å°‘ã—å‰ã«ã€Google Apps Scriptï¼ˆGASï¼‰</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ¼ãƒ“ã‚¹ã®script.google.comã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ç§ã¯å¤–éƒ¨ã®Webã‚µãƒ¼ãƒãƒ¼ä¸Šã®PHPã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç ´æ£„ã—ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹GASã‚¹ã‚¯ãƒªãƒ—ãƒˆã§éƒ¨åˆ†çš„ã¾ãŸã¯å®Œå…¨ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã¨GASåˆ¶é™ã‚’ç†è§£ã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸãŒã€ç§ãŒã—ãŸã“ã¨ã¯ã™ã¹ã¦ç„¡æ–™ã®Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§æ©Ÿèƒ½ã—ã€ã¾ã ãŠé‡‘ã‚’è¦æ±‚ã—ã¦ã„ã¾ã›ã‚“ã€‚ Google Apps Scriptã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã™ã‚‹ç›®æ¨™ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ GASã¯JavaScriptè¨€èªã«åŸºã¥ã„ã¦ãŠã‚Šã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®JSãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ãŸã‚Šã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å…¬é–‹ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã€è¨±å¯ãªã—ã«èª°ã§ã‚‚åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç¾åœ¨ã®GASå®Ÿè£…ã®æ©Ÿèƒ½ã§ã¯ååˆ†ã§ã¯ãªã‹ã£ãŸã®ã§ã€å›é¿ã—ã¦å›é¿ç­–ã‚’æ¢ã™å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åˆã¯ã€PNGç”»åƒã®ãƒ—ãƒ­ã‚­ã‚·ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã®Webã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€VPNBook Webã‚µã‚¤ãƒˆï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯PNGã§å…¬é–‹ã•ã‚ŒãŸã“ã¨ã‚’æ€ã„å‡ºã—ã¾ã™ï¼‰ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”»åƒã‚’è¦æ±‚ã—ã€ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‘¼ã³å‡ºã—ã¦ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãã‚Œã‚’æä¾›ã™ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ­ãƒƒã‚¯ã‚’å›é¿ã™ã‚‹ãŸã‚ã®ãã®ã‚ˆã†ãªæ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">ã“ã“ã§ã€GASã®æœ€åˆã®åˆ¶é™ãŒæº€ãŸã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯MIMEç”»åƒ/ pngã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ãã¾ã›ã‚“ãŒã€ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã€JSONã€TEXTã€XMLãªã©ã®ã¿ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ã“ã‚Œã‚’å›é¿ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">PNGã‚’Base64ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆæ–‡å­—åˆ—ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã«åŒæ§˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">techslides.com/image-proxy-with-google-app-scripts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã®ã†ã¡ã®1ã¤ã‚’å˜ç´”åŒ–ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ç”»åƒã¯1ã¤ã ã‘å¿…è¦ã§ã€Base64æ–‡å­—åˆ—ã®ã¿ã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">çµæœã¯ã€1ã¤ã®doGeté–¢æ•°ï¼ˆå¿œç­”ã¨ã—ã¦æ–‡å­—åˆ—ã‚’è¿”ã™GETãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼‰ã®ã¿ã§æ§‹æˆã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doGet</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> response = UrlFetchApp.fetch(<span class="hljs-string">'https://www.vpnbook.com/password.php'</span>);
  <span class="hljs-keyword">var</span> b64 = Utilities.base64Encode(response.getContent());
  <span class="hljs-comment">//var data = 'data:'+type+';base64,'+b64;</span>
  <span class="hljs-keyword">return</span> ContentService.createTextOutput(b64);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼å‡ºåŠ›ã®ä¾‹ï¼š </font></font><br>
<br>
<pre><code class="plaintext hljs">iVBORw0KGgoAAAANSUhEUgAAAGQAAAANAQMAAABl11mFAAAABlBMVEX29vZMTExY89ZbAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAVUlEQVQImWNgIBrwSzCw/2ZgOADhSc5gYJCG8wxQedLdCcYFNXcgPHOZsxuSZxx7BuFZzsjdcJi34TBU5Y3cjc3IvM3McJ7kjNxtzDwwffwSIB7UTACt/h52C5DFqQAAAABJRU5ErkJggg==</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€PHPã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå‹•ä½œã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒªã‚½ãƒ¼ã‚¹ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã‚¾ãƒ¼ãƒ³å†…ã®ã‚µãƒ¼ãƒãƒ¼ã«é…ç½®ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€cURLå‘¼ã³å‡ºã—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå°‘ã—å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’é™¤ã„ã¦ã€å‰ã®è¨˜äº‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«éå¸¸ã«ä¼¼ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">cURLãŒHTTP / 1.1 302 Moved Temporarilyã‚’é€šéã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">GASãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€Webã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰å‹•çš„ãªä¸€æ™‚ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦Base64ãƒ‡ã‚³ãƒ¼ãƒ‰ï¼š</font></font><br>
<br>
<pre><code class="php hljs">$imgOCR = imagecreatefromstring(base64_decode($output));</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªä½“</font></font></b><div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">//  </span>
$wchar = <span class="hljs-number">9</span>;<font></font>
$hchar = <span class="hljs-number">13</span>;<font></font>
$strDict = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789 '</span>;<font></font>
$imgDict = imagecreatetruecolor(<span class="hljs-number">2</span> + strlen($strDict)* $wchar, $hchar);<font></font>
$bg = imagecolorallocate($imgDict, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF6</span>);<font></font>
$textcolor = imagecolorallocate($imgDict, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4C</span>);<font></font>
imagefill($imgDict, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, $bg);<font></font>
imagestring($imgDict, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, $strDict, $textcolor);<font></font>
<font></font>
<span class="hljs-comment">//  cURL</span><font></font>
$ch = curl_init();<font></font>
<span class="hljs-comment">//  url,     </span>
<span class="hljs-comment">//curl_setopt($ch, CURLOPT_URL, 'https://www.vpnbook.com/password.php');</span>
curl_setopt($ch, CURLOPT_URL, <span class="hljs-string">'https://script.google.com/macros/s/AKfycbwYPfaZobtjbFv0mSYI8U4NIXPh1Sft_DkGH8QKgg/exec'</span>);
<span class="hljs-comment">//  ,      string</span>
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);<font></font>
curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<font></font>
curl_setopt($ch, CURLOPT_BINARYTRANSFER, <span class="hljs-number">1</span>); <span class="hljs-comment">// also, this seems wise considering output is image.</span>
<span class="hljs-comment">//  </span><font></font>
$output = curl_exec($ch);<font></font>
<span class="hljs-comment">//  cURL</span><font></font>
curl_close($ch);<font></font>
<font></font>
<span class="hljs-comment">// echo $output;</span><font></font>
<font></font>
$imgOCR = imagecreatefromstring(base64_decode($output));<font></font>
<span class="hljs-comment">//$imgOCR = imageCreateFromPng('password.png');</span>
<span class="hljs-comment">//      10  . 2 + 10*9 = 92 &lt; 100</span>
$maxchar = floor((imagesx($imgOCR) - <span class="hljs-number">2</span>) / <span class="hljs-number">9</span>);<font></font>
$imgBox = imagecreatetruecolor($wchar, $hchar);<font></font>
$hashDict = <span class="hljs-keyword">Array</span>();<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">for</span> ($k = <span class="hljs-number">0</span>; $k &lt; strlen($strDict) ; $k++) {<font></font>
	imagecopy($imgBox, $imgDict, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> + $k * $wchar, <span class="hljs-number">0</span>, $wchar, $hchar);<font></font>
	$hashStr = <span class="hljs-string">""</span>;
	<span class="hljs-keyword">for</span>($y = <span class="hljs-number">0</span>; $y &lt; $hchar ; $y++)
		<span class="hljs-keyword">for</span>($x = <span class="hljs-number">0</span>; $x &lt; $wchar; $x++) $hashStr .= (imagecolorat($imgBox, $x, $y) != <span class="hljs-number">0xF6F6F6</span>)? <span class="hljs-string">'1'</span>: <span class="hljs-string">'0'</span>;<font></font>
	$hashDict[$hashStr] = $strDict[$k];<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//    </span>
<span class="hljs-keyword">for</span> ($k = <span class="hljs-number">0</span>; $k &lt; $maxchar ; $k++) {<font></font>
	imagecopy($imgBox, $imgOCR, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> + $k * $wchar, <span class="hljs-number">0</span>, $wchar, $hchar);<font></font>
	$hashStr = <span class="hljs-string">""</span>;
	<span class="hljs-keyword">for</span>($y = <span class="hljs-number">0</span>; $y &lt; $hchar ; $y++)
		<span class="hljs-keyword">for</span>($x = <span class="hljs-number">0</span>; $x &lt; $wchar; $x++) $hashStr .= (imagecolorat($imgBox, $x, $y) != <span class="hljs-number">0xF6F6F6</span>)? <span class="hljs-string">'1'</span>: <span class="hljs-string">'0'</span>;<font></font>
  $tempchar = $hashDict[$hashStr];<font></font>
  <span class="hljs-keyword">if</span> ($tempchar==<span class="hljs-string">'u'</span> || $tempchar==<span class="hljs-string">'y'</span>) <span class="hljs-comment">//   </span>
    $tempchar = (mt_rand(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))? <span class="hljs-string">'u'</span>: <span class="hljs-string">'y'</span>;
    <span class="hljs-comment">//$tempchar = (time() / 60 % 60 % 2)? 'u': 'y';</span>
  <span class="hljs-keyword">elseif</span> ($tempchar==<span class="hljs-string">' '</span>) <span class="hljs-keyword">break</span>;
	<span class="hljs-keyword">print</span>($tempchar);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/*
header('Content-type: image/png');
imagepng($imgDict);
*/</span><font></font>
<font></font>
<span class="hljs-comment">//var_dump($hashDict);</span><font></font>
imagedestroy($imgDict);<font></font>
imagedestroy($imgOCR);<font></font>
imagedestroy($imgBox);<font></font>
<span class="hljs-meta">?&gt;</span></code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®PHPã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€PNGãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã€ãƒ†ã‚­ã‚¹ãƒˆæ–‡å­—åˆ—ã¨ã—ã¦è¿”ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã•ã‚‰ã«ã€Mikrotikã«é–¢ã™ã‚‹éƒ¨åˆ†ã®æœ€åˆã®è¨˜äº‹ã¨åŒã˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ«ãƒ¼ã‚¿ã¯ãƒ•ã‚§ãƒƒãƒã‚’ä½¿ç”¨ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çµæœã¯ã€ãƒŸã‚¯ãƒ­ãƒ†ã‚£ã‚¯ã®å‰ã«ã‚ã‚‹2ã¤ã®ä¸­é–“ã‚µãƒ¼ãƒ“ã‚¹ã®ã“ã®ã‚ˆã†ãªä½œæ¥­è¨ˆç”»ã§ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ2ã€‚GASã‚’ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">PHPãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å–ã‚Šé™¤ã</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GASã®å®Ÿé¨“ä¸­ã«ã€GASã§æ›¸ãæ›ãˆã‚‹ã“ã¨ã«ã‚ˆã‚Šã€PHPã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ã‚’ç ´æ£„ã™ã‚‹ã¨ã„ã†ã‚¢ã‚¤ãƒ‡ã‚¢ãŒç”Ÿã¾ã‚Œã¾ã—ãŸã€‚ãã—ã¦ã€ã“ã“ã§å¤§ããªå•é¡ŒãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚Googleã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¯PNGå‡¦ç†é–¢æ•°ãŒã‚ã‚Šã¾ã›ã‚“ã€‚å®Ÿè¡Œã§ãã‚‹å”¯ä¸€ã®ã“ã¨ã¯ã€PNGã‚’ãƒã‚¤ãƒˆé…åˆ—ã«å¤‰æ›ã™ã‚‹ã“ã¨ã§ã™ã€‚ç”»åƒã®ä¸€éƒ¨ã¨ãƒ”ã‚¯ã‚»ãƒ«ã‚’æ“ä½œã™ã‚‹ã“ã¨ã«ã¤ã„ã¦ã¯ä½•ã®ç–‘å•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ PNGã‚’æ“ä½œã™ã‚‹ãŸã‚ã®JSãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¢ã—ã¦Githubã«ç™»ã£ãŸã¨ã“ã‚ã€PNG.jsã€UPNG.jsã€pngjsã®å¤šããŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚ PNGãƒ”ã‚¯ã‚»ãƒ«ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä»˜ãã®ç”»åƒï¼‰ã®1ãƒ“ãƒƒãƒˆè‰²æ·±åº¦ã‚’ã‚µãƒãƒ¼ãƒˆã—ãªã„ã‚‚ã®ã‚‚ã‚ã‚Šã¾ã™ã€‚å½¼ã‚‰ã¯ã€ã•ã¾ã–ã¾ãªzlibåœ§ç¸®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚ä¸€èˆ¬ã«ã€ã™ã¹ã¦ãŒå°‘ã—æ‰±ã„ã«â€‹â€‹ãã„ã‚ˆã†ã«æ€ã‚ã‚Œã€XYåº§æ¨™ã§ãƒ”ã‚¯ã‚»ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€è‡ªåˆ†ã®PNGç”»åƒã ã‘ã‚’ãƒ“ãƒƒãƒˆãƒãƒƒãƒ—ã«å¤‰æ›ã™ã‚‹ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã‚’è‡ªåˆ†ã§æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚æ¬¡ã«ã€PNGå½¢å¼ã§å®Œå…¨ã«æ²¡é ­ã—ã¾ã—ãŸã€‚16é€²ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã€èª­æ›¸åŸºæº–ã€ãƒãƒƒãƒˆä¸Šã®èª¬æ˜ã®å±±ã€‚ãã—ã¦æœ€å¾Œã«ã€ãƒ”ã‚¯ã‚»ãƒ«ã®é…åˆ—ã‚’å«ã‚€zlibãŒãƒ‘ãƒƒã‚¯ã•ã‚ŒãŸIDATãƒ•ã‚¡ã‚¤ãƒ«ã®PNGã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é­é‡ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
zlibã‚’è§£å‡ã™ã‚‹ãŸã‚ã®é–¢æ•°ãŒå¿…è¦ã§ã—ãŸãŒã€ã“ã‚Œã¯ã‚‚ã¡ã‚ã‚“GASã«ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚é©šã„ãŸã“ã¨ã«ã€gzip / ungzipã¨zip / unzipãŒã‚ã‚Šã¾ã™ãŒã€zlibã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ gzipï¼ˆPNGå½¢å¼ã®å¾Œã®2ç•ªç›®ã®ãƒ¬ãƒ™ãƒ«ã®ã‚¤ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ã«ã¤ã„ã¦èª­ã‚“ã å¾Œã€zlibåœ§ç¸®ã¯ã‚ã¡ã“ã¡ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ãŒã€IDATã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰gzipç–‘ä¼¼ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®å½¢å¼ã§ã€Œè‡ªè»¢è»Šã€ã‚’çµ„ã¿ç«‹ã¦ã‚‹ã“ã¨ã¯ã§ããªã„ã¨ã„ã†çµè«–ã«é”ã—ã¾ã—ãŸã€‚ãªãœãªã‚‰æœ‰åŠ¹ãªgzipã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’æ§‹ç¯‰ã™ã‚‹ã«ã¯ã€è§£å‡ã—ãŸãƒ‡ãƒ¼ã‚¿ã®é•·ã•ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è§£å‡ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯è§£å‡ã—ãªã„ã¨å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚çµå±€ã€ç§ã¯Githubã«ç›®ã‚’å‘ã‘ã¦ã€ç´ æ™´ã‚‰ã—ã„è§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã¾ã—ãŸï¼šGoogle Apps Scriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªç”¨ã®zlib.jsï¼ˆhttps://github.com/hinimub/zlib.js/blob/develop/README.en.mdï¼‰ã€‚ã“ã‚Œã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä»‹ã—ã¦GASãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«çµ±åˆã™ã‚‹ãŸã‚ã«ç‰¹åˆ¥ã«æº–å‚™ã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚ãã®å¾Œã€ãƒ‘ã‚ºãƒ«ã¯åæŸã—å§‹ã‚ã¾ã—ãŸã€‚ãƒ”ã‚¯ã‚»ãƒ«é…åˆ—ã®è§£å‡ã¨XYãƒ”ã‚¯ã‚»ãƒ«ã®åº§æ¨™ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’æ›¸ãè¾¼ã‚“ã å¾Œã€ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’PHPã‹ã‚‰GASã«è»¢é€ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è€ƒãˆã‚‰ã‚Œã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ–‡å­—ã®è¾æ›¸ã®ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å€‹åˆ¥ã«è¨ˆç®—ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆLabVIEWã§ã¯ã“ã‚“ã«ã¡ã¯ã€åŒåƒšï¼‰ã§è¡Œã£ãŸ1å›é™ã‚Šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚</font><font style="vertical-align: inherit;">ç”»åƒã®å„æ–‡å­—ã¯ã€8ãƒ“ãƒƒãƒˆï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãªã—ï¼‰x 10è¡Œã¨ã—ã¦å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">1æ–‡å­—ã®è¡Œã®8ãƒ”ã‚¯ã‚»ãƒ«ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã«ã¯ã€1ãƒã‚¤ãƒˆã§ååˆ†ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ”ã‚¯ã‚»ãƒ«ã®æ–‡å­—åˆ—ã‚’æ•´æ•°ï¼ˆãƒã‚¤ãƒˆï¼‰ã§æ ¼ç´ã—ã€æ–‡å­—å…¨ä½“ã‚’10ãƒã‚¤ãƒˆã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã¨ã—ã¦æ ¼ç´ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ–‡å­—ã”ã¨ã«10æ¡ã®16é€²æ•°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã«ã€GASãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ã¯PHPã®å…ƒç¥–ã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœã¯ã€GASã§å®Œå…¨ã«æ©Ÿèƒ½ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doGet</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">//var file = DriveApp.getFilesByName("password2.png").next();</span>
  <span class="hljs-comment">//var image = file.getBlob(); </span><font></font>
  <font></font>
  <span class="hljs-keyword">var</span> image = UrlFetchApp.fetch(<span class="hljs-string">'https://www.vpnbook.com/password.php'</span>).getBlob();
  <span class="hljs-keyword">var</span> imageString = image.getDataAsString();
  <span class="hljs-keyword">var</span> imageArray = image.getBytes().map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{ <span class="hljs-keyword">return</span> e &amp; <span class="hljs-number">0xff</span>; });
  <span class="hljs-comment">// imageArray = blobToUint8(imageArray);</span><font></font>
  <font></font>
  <span class="hljs-keyword">var</span> chunkIDATStart = imageString.indexOf(<span class="hljs-string">"IDAT"</span>) + <span class="hljs-number">4</span>; <span class="hljs-comment">//   IDAT</span>
  <span class="hljs-keyword">var</span> chunkIDATLen = bytesToUint32(imageArray, imageString.indexOf(<span class="hljs-string">"IDAT"</span>) - <span class="hljs-number">4</span>); <span class="hljs-comment">//   IDAT</span>
  <span class="hljs-keyword">var</span> IDATArray = imageArray.slice(chunkIDATStart, chunkIDATStart + chunkIDATLen)<font></font>
   <font></font>
  <span class="hljs-keyword">var</span> inflate = <span class="hljs-keyword">new</span> zlibjs.Inflate(IDATArray); <span class="hljs-comment">//  IDAT   zlib</span>
  <span class="hljs-keyword">var</span> plain = inflate.decompress();<font></font>
<font></font>
  <span class="hljs-keyword">const</span> Width = <span class="hljs-number">100</span>; <span class="hljs-comment">//  </span>
  <span class="hljs-keyword">const</span> Height = <span class="hljs-number">13</span>; <span class="hljs-comment">//  </span>
  <span class="hljs-keyword">const</span> wchar = <span class="hljs-number">9</span>; <span class="hljs-comment">//  </span>
  <span class="hljs-keyword">const</span> hchar = <span class="hljs-number">13</span>; <span class="hljs-comment">//  </span><font></font>
  <font></font>
  <span class="hljs-comment">//Logger.log(typeof(plain));</span>
  <span class="hljs-comment">//Logger.log(plain);</span><font></font>
  <font></font>
  rowlen = (Width / <span class="hljs-number">8</span>) &gt;&gt; <span class="hljs-number">0</span>; <span class="hljs-comment">//   ,   </span>
  <span class="hljs-keyword">if</span> ((Width - rowlen * <span class="hljs-number">8</span>) &gt; <span class="hljs-number">0</span>) { <span class="hljs-comment">//   </span>
    rowlen+=<span class="hljs-number">2</span>;  <span class="hljs-comment">// +1 filter byte at the beginning of each row.    PNG</span>
  } <span class="hljs-keyword">else</span> {<font></font>
    rowlen++;<font></font>
  }<font></font>
 <font></font>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getXY</span>(<span class="hljs-params">x, y</span>) </span>{ <span class="hljs-comment">//  : 0/1</span>
    <span class="hljs-keyword">var</span> xbyte = (x / <span class="hljs-number">8</span> &gt;&gt; <span class="hljs-number">0</span>); <span class="hljs-comment">//  ,  </span>
    <span class="hljs-comment">//Logger.log("xbyte: " + xbyte);</span>
    <span class="hljs-keyword">var</span> xbit = x - xbyte * <span class="hljs-number">8</span>; <span class="hljs-comment">//  ,   </span>
    <span class="hljs-comment">//Logger.log("xbit: " + xbit);</span>
    <span class="hljs-keyword">return</span> (plain[xbyte + <span class="hljs-number">1</span> + y * rowlen] &lt;&lt; xbit &amp; <span class="hljs-number">0x80</span>) &gt;&gt; <span class="hljs-number">7</span>;  <span class="hljs-comment">// +1 filter byte at the beginning of each row</span><font></font>
  }<font></font>
  <span class="hljs-comment">// Logger.log("getXY: " + getXY(4, 3));</span>
  <span class="hljs-comment">// - .        8  (  ) x 10 ,        (byte),      10  .</span>
  <span class="hljs-comment">//  10 hex   .</span>
  <span class="hljs-keyword">var</span> hashDict = {<span class="hljs-string">'183C66C3C3C3FFC3C3C3'</span>:<span class="hljs-string">'A'</span>,<span class="hljs-string">'FCC6C3C6FCC6C3C3C6FC'</span>:<span class="hljs-string">'B'</span>,<span class="hljs-string">'3E63C1C0C0C0C0C1633E'</span>:<span class="hljs-string">'C'</span>,<span class="hljs-string">'FCC6C3C3C3C3C3C3C6FC'</span>:<span class="hljs-string">'D'</span>, <span class="hljs-string">'FEC0C0C0FCC0C0C0C0FE'</span>:<span class="hljs-string">'E'</span>,<span class="hljs-string">'FFC0C0C0FCC0C0C0C0C0'</span>:<span class="hljs-string">'F'</span>,<span class="hljs-string">'3E63C0C0C0C7C3C3633E'</span>:<span class="hljs-string">'G'</span>,<span class="hljs-string">'C3C3C3C3FFC3C3C3C3C3'</span>:<span class="hljs-string">'H'</span>, <span class="hljs-string">'7E18181818181818187E'</span>:<span class="hljs-string">'I'</span>,<span class="hljs-string">'1E666666466C38'</span>:<span class="hljs-string">'J'</span>,<span class="hljs-string">'C3C6CCD8F0F0D8CCC6C3'</span>:<span class="hljs-string">'K'</span>,<span class="hljs-string">'C0C0C0C0C0C0C0C0C0FE'</span>:<span class="hljs-string">'L'</span>, <span class="hljs-string">'C3E7FFDBDBDBC3C3C3C3'</span>:<span class="hljs-string">'M'</span>,<span class="hljs-string">'C3E3F3F3DBDBCFC7C7C3'</span>:<span class="hljs-string">'N'</span>,<span class="hljs-string">'3C66C3C3C3C3C3C3663C'</span>:<span class="hljs-string">'O'</span>,<span class="hljs-string">'FEC3C3C3FEC0C0C0C0C0'</span>:<span class="hljs-string">'P'</span>, <span class="hljs-string">'3C66C3C3C3C3DBCF663D'</span>:<span class="hljs-string">'Q'</span>,<span class="hljs-string">'FEC3C3C3FEF8CCC6C3C3'</span>:<span class="hljs-string">'R'</span>,<span class="hljs-string">'7EC3C0C07E333C37E'</span>:<span class="hljs-string">'S'</span>,<span class="hljs-string">'FF181818181818181818'</span>:<span class="hljs-string">'T'</span>, <span class="hljs-string">'C3C3C3C3C3C3C3C3663C'</span>:<span class="hljs-string">'U'</span>,<span class="hljs-string">'C3C3C36666663C3C1818'</span>:<span class="hljs-string">'V'</span>,<span class="hljs-string">'C3C3C3C3DBDBDBFFE7C3'</span>:<span class="hljs-string">'W'</span>,<span class="hljs-string">'C3C3663C18183C66C3C3'</span>:<span class="hljs-string">'X'</span>, <span class="hljs-string">'C3C3663C181818181818'</span>:<span class="hljs-string">'Y'</span>,<span class="hljs-string">'FE66C183060C0C0FE'</span>:<span class="hljs-string">'Z'</span>,<span class="hljs-string">'0003E6337FC3C77B'</span>:<span class="hljs-string">'a'</span>,<span class="hljs-string">'C0C0C0DCE6C3C3C3E6DC'</span>:<span class="hljs-string">'b'</span>, <span class="hljs-string">'0003E63C0C0C0633E'</span>:<span class="hljs-string">'c'</span>,<span class="hljs-string">'3333B67C3C3C3673B'</span>:<span class="hljs-string">'d'</span>,<span class="hljs-string">'0003C66C3FFC0633E'</span>:<span class="hljs-string">'e'</span>,<span class="hljs-string">'1E33333030FC30303030'</span>:<span class="hljs-string">'f'</span>, <span class="hljs-string">'0007DC7C6C67CC07E'</span>:<span class="hljs-string">'g'</span>,<span class="hljs-string">'C0C0C0DCE6C3C3C3C3C3'</span>:<span class="hljs-string">'h'</span>,<span class="hljs-string">'181803818181818187E'</span>:<span class="hljs-string">'i'</span>,<span class="hljs-string">'660E66666C6'</span>:<span class="hljs-string">'j'</span>, <span class="hljs-string">'606060666C78786C6663'</span>:<span class="hljs-string">'k'</span>,<span class="hljs-string">'3818181818181818183C'</span>:<span class="hljs-string">'l'</span>,<span class="hljs-string">'000B6DBDBDBDBDBDB'</span>:<span class="hljs-string">'m'</span>,<span class="hljs-string">'000DCE6C3C3C3C3C3'</span>:<span class="hljs-string">'n'</span>, <span class="hljs-string">'0003C66C3C3C3663C'</span>:<span class="hljs-string">'o'</span>,<span class="hljs-string">'000DCE6C3C3C3E6DC'</span>:<span class="hljs-string">'p'</span>,<span class="hljs-string">'0003B67C3C3C3673B'</span>:<span class="hljs-string">'q'</span>,<span class="hljs-string">'000DE736060606060'</span>:<span class="hljs-string">'r'</span>, <span class="hljs-string">'0007EC3C07E3C37E'</span>:<span class="hljs-string">'s'</span>,<span class="hljs-string">'03030FC30303030331E'</span>:<span class="hljs-string">'t'</span>,<span class="hljs-string">'000C3C3C3C3C3673B'</span>:<span class="hljs-string">'u'</span>,<span class="hljs-string">'000C3C366663C3C18'</span>:<span class="hljs-string">'v'</span>, <span class="hljs-string">'000C3C3DBDBDBFF66'</span>:<span class="hljs-string">'w'</span>,<span class="hljs-string">'000C3663C183C66C3'</span>:<span class="hljs-string">'x'</span>,<span class="hljs-string">'000C3C3C3C3C3673B'</span>:<span class="hljs-string">'y'</span>,<span class="hljs-string">'0007E6C1830607E'</span>:<span class="hljs-string">'z'</span>, <span class="hljs-string">'183C66C3C3C3C3663C18'</span>:<span class="hljs-string">'0'</span>,<span class="hljs-string">'1838781818181818187E'</span>:<span class="hljs-string">'1'</span>,<span class="hljs-string">'3C66C336C183060FF'</span>:<span class="hljs-string">'2'</span>,<span class="hljs-string">'7CC6361C633C67C'</span>:<span class="hljs-string">'3'</span>, <span class="hljs-string">'6E1E3666C6FF666'</span>:<span class="hljs-string">'4'</span>,<span class="hljs-string">'FEC0C0DCE633C3663C'</span>:<span class="hljs-string">'5'</span>,<span class="hljs-string">'3C66C2C0DCE6C3C3663C'</span>:<span class="hljs-string">'6'</span>,<span class="hljs-string">'FF336C183060C0C0'</span>:<span class="hljs-string">'7'</span>, <span class="hljs-string">'3C66C3663C66C3C3663C'</span>:<span class="hljs-string">'8'</span>,<span class="hljs-string">'3C66C3C3673B343663C'</span>:<span class="hljs-string">'9'</span>,<span class="hljs-string">'0000000000'</span>:<span class="hljs-string">' '</span>};<font></font>
<font></font>
  <span class="hljs-comment">//      10  . 2 + 10*9 = 92 &lt; 100</span>
  <span class="hljs-keyword">const</span> maxchar = (Width - <span class="hljs-number">2</span>) / wchar &gt;&gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> password = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> charX = <span class="hljs-number">2</span>; charX &lt; maxchar * wchar + <span class="hljs-number">2</span>; charX+=wchar) { <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">var</span> hash = <span class="hljs-string">''</span>; <span class="hljs-comment">//  </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> charY = <span class="hljs-number">3</span>; charY &lt; hchar; charY++) { <span class="hljs-comment">//   Y-</span>
      <span class="hljs-keyword">var</span> charrow = <span class="hljs-number">0</span>; <span class="hljs-comment">//   -  8  </span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> charXbit = <span class="hljs-number">0</span>; charXbit &lt; <span class="hljs-number">8</span>; charXbit++) { <span class="hljs-comment">//   X-</span>
        charrow &lt;&lt;= <span class="hljs-number">1</span>;<font></font>
        charrow |= getXY(charX + charXbit, charY);<font></font>
      }<font></font>
      hash += charrow.toString(<span class="hljs-number">16</span>).toUpperCase();
      <span class="hljs-comment">//Logger.log("charrow: " + charrow.toString(2));</span>
      <span class="hljs-comment">//Logger.log("charrow: " + charrow.toString(16).toUpperCase());</span><font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> tempChar = hashDict[hash];
    <span class="hljs-keyword">if</span> (tempChar === <span class="hljs-string">'u'</span> || tempChar === <span class="hljs-string">'y'</span>) { <span class="hljs-comment">//    </span>
      tempChar = (<span class="hljs-built_in">Date</span>.now() % <span class="hljs-number">2</span>) ? <span class="hljs-string">'u'</span>: <span class="hljs-string">'y'</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (tempChar !== <span class="hljs-string">' '</span>) {<font></font>
      password += tempChar; <font></font>
      <span class="hljs-comment">// Logger.log("hash: " +  hash);</span>
      <span class="hljs-comment">// Logger.log("Char: " +  tempChar);</span><font></font>
    }<font></font>
  }<font></font>
  Logger.log(<span class="hljs-string">"password: "</span> +  password);
  <span class="hljs-keyword">return</span> ContentService.createTextOutput(password);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blobToUint8</span>(<span class="hljs-params">blob</span>) </span>{
  <span class="hljs-keyword">return</span> blob.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    <span class="hljs-keyword">return</span> e &amp; <span class="hljs-number">0xff</span>;<font></font>
  });<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bytesToUint32</span>(<span class="hljs-params">byteArray, start</span>) </span>{
    <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; start + <span class="hljs-number">4</span>; i++) {<font></font>
        value = (value * <span class="hljs-number">256</span>) + (byteArray[i] &amp; <span class="hljs-number">0xff</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> value;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">my2</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> file = DriveApp.getFilesByName(<span class="hljs-string">"password2.png"</span>).next();
  <span class="hljs-comment">// var file = DriveApp.getFilesByName("test.bin").next();</span>
  <span class="hljs-keyword">var</span> image = file.getBlob(); 
  <span class="hljs-comment">//var imageArray = image.getBytes();</span>
  <span class="hljs-comment">//var img = UrlFetchApp.fetch('http://example.com/image.png');</span>
  <span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> pngjs.PNGReader(image.getBytes());
  <span class="hljs-keyword">var</span> png = reader.parse(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, png</span>)</span>{
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;
	<span class="hljs-keyword">return</span> png;<font></font>
  });<font></font>
  Logger.log(png);<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯GETãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">Webã‚¢ãƒ—ãƒªã¨ã—ã¦å…¬é–‹ã•ã‚ŒãŸã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å¯¾ã—ã¦GETè¦æ±‚ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€å¿œç­”ã«ã¯ã€ãƒ‡ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ–‡å­—åˆ—ã®å½¢å¼ã§ã™ãã«å«ã¾ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ3. Mikrotikã¨ä¸€æ™‚çš„ã«ç§»å‹•302</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€å¤–éƒ¨ã®Webã‚¢ãƒ—ãƒªã‚µãƒ¼ãƒãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚Šã€ãƒ­ãƒƒã‚¯ã¨ã¯ç„¡é–¢ä¿‚ã«ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¿”ã—ã¾ã™ã€‚ãã—ã¦ã€ãã‚Œã¯RouterOS Mikrotikã®ãƒ•ã‚§ãƒƒãƒã‚³ãƒãƒ³ãƒ‰ã§ãã‚Œã‚’è¦æ±‚ã™ã‚‹ã‚ˆã‚Šç°¡å˜ãªã‚‚ã®ã¯ä½•ã‚‚ãªã„ã‚ˆã†ã§ã™ã€‚ã—ã‹ã—ã€ãã‚Œã‹ã‚‰ã¾ãŸåˆ¥ã®é©šããŒç§ã‚’å¾…ã£ã¦ã„ã¾ã—ãŸã€‚è¦æ±‚ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå¤‰æ›´ã•ã‚ŒãŸï¼‰ã«å¿œç­”ã—ã¦ã€ãƒ•ã‚§ãƒƒãƒã¯ã€Œ302 Moved Temporarilyã€ã‚’è¿”ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">[admin@MikroTik] /environment&gt; :put ([/tool fetch url=<span class="hljs-string">"https://script.google.com/macros/s/A.....A/exec"</span> http-method=get output=user as-value]-&gt;<span class="hljs-string">"data"</span>)<font></font>
failure: closing connection: &lt;302 Moved Temporarily <span class="hljs-string">"https://script.googleusercontent.com/macros/echo?user_content_key=....."</span>&gt; 173.194.222.138:443 (4)<font></font>
[admin@MikroTik] /environment&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã®å†’é ­ã§ã€ç§ã¯ã™ã§ã«ã“ã‚Œã«ã¤ã„ã¦æ›¸ãã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">Webã‚¢ãƒ—ãƒªã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ°¸ç¶šçš„ãªæ—¢çŸ¥ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€Googleã¯ä¸€æ™‚çš„ãªURLã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã€ä¸€æ™‚çš„ãªURLãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã¸ã®å¿œç­”ã‚’è¿”ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€PHP cURLã¨ã¯ç•°ãªã‚Šã€fetch RouterOSã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®å‡¦ç†æ–¹æ³•ã‚’èªè­˜ã›ãšã€ä»£ã‚ã‚Šã«å¤±æ•—ã‚’è¿”ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—forum.mikrotik.comã¯ã™ãã«ã¯å¯¾å¿œã—ã¾ã›ã‚“ã§ã—ãŸãŒã€å›é¿ç­–ãŒã‚ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">wrappingï¼šexecuteã«ã‚ˆã£ã¦åˆ¥ã®ã‚¿ã‚¹ã‚¯ã§éåŒæœŸå®Ÿè¡Œã‚’å‘¼ã³å‡ºã™ã“ã¨ã«ã‚ˆã‚Šã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã®æ¨™æº–ã®ãƒ•ã‚§ãƒƒãƒå‡ºåŠ›ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã®å¾Œã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLã‚’å–å¾—ã—ã¦ã€æ–°ã—ã„ã‚¢ãƒ‰ãƒ¬ã‚¹ã§å†ãƒ•ã‚§ãƒƒãƒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ä»¥ä¸‹ã§è¡Œã‚ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#  . Moved Temporarily 302.  fetch  gasfetchout.txt</span>
:<span class="hljs-built_in">local</span> jobid [:execute script={/tool fetch url=<span class="hljs-string">"https://script.google.com/macros/s/A.....A/exec"</span> output=user as-value} file=gasfetchout.txt]<font></font>
<font></font>
<span class="hljs-comment">#    ,    </span>
:<span class="hljs-keyword">while</span> ([:len [/system script job find .id=<span class="hljs-variable">$jobid</span> ]] &gt; 0) <span class="hljs-keyword">do</span>={ delay 1s }<font></font>
<font></font>
<span class="hljs-comment">#  gasfetchout.txt,  URL </span>
:<span class="hljs-built_in">local</span> fetchOut [/file get gasfetchout.txt contents]<font></font>
:<span class="hljs-built_in">local</span> startURL [:find <span class="hljs-variable">$fetchOut</span> <span class="hljs-string">"http"</span> -1]<font></font>
:<span class="hljs-built_in">local</span> endURL [:find <span class="hljs-variable">$fetchOut</span> <span class="hljs-string">"\"&gt; "</span> startURL]<font></font>
:<span class="hljs-built_in">local</span> moveURL [:pick <span class="hljs-variable">$fetchOut</span> <span class="hljs-variable">$startURL</span> <span class="hljs-variable">$endURL</span>]<font></font>
:global VPNBookPass2 ([/tool fetch url=<span class="hljs-variable">$moveURL</span> output=user as-value]-&gt;<span class="hljs-string">"data"</span>)</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€GAS Webã‚¢ãƒ—ãƒªã‚’æ“ä½œã™ã‚‹ãŸã‚ã®Mikrotikã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å…¨æ–‡ã§ã™ã€‚</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-comment"># VPNBookScript v4</span>
:<span class="hljs-built_in">local</span> VPNBookpIfName <span class="hljs-string">"pptp-out1"</span>
:<span class="hljs-built_in">local</span> VPNBookServerAddresses {<span class="hljs-string">"PL226.vpnbook.com"</span>;<span class="hljs-string">"de4.vpnbook.com"</span>;<span class="hljs-string">"us1.vpnbook.com"</span>;<span class="hljs-string">"us2.vpnbook.com"</span>;<span class="hljs-string">"fr1.vpnbook.com "</span>;<span class="hljs-string">"fr8.vpnbook.com "</span>;<span class="hljs-string">"ca222.vpnbook.com "</span>;<span class="hljs-string">"ca198.vpnbook.com"</span>}<font></font>
<font></font>
:<span class="hljs-built_in">local</span> VPNBookErr <span class="hljs-literal">false</span><font></font>
:global VPNBookPass<font></font>
:global VPNBookRun<font></font>
<font></font>
:global VPNBookServerIndex<font></font>
:<span class="hljs-keyword">if</span> ([:typeof <span class="hljs-variable">$VPNBookServerIndex</span>] != <span class="hljs-string">"num"</span>) <span class="hljs-keyword">do</span>={:<span class="hljs-built_in">set</span> VPNBookServerIndex 0}<font></font>
<font></font>
:<span class="hljs-keyword">if</span> ([/interface pptp-client get <span class="hljs-variable">$VPNBookpIfName</span> running]) <span class="hljs-keyword">do</span>={<font></font>
  :<span class="hljs-built_in">set</span> VPNBookRun <span class="hljs-literal">true</span>
} <span class="hljs-keyword">else</span> {<font></font>
  :<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$VPNBookRun</span>) <span class="hljs-keyword">do</span>={<font></font>
    :<span class="hljs-built_in">set</span> VPNBookServerIndex (<span class="hljs-variable">$VPNBookServerIndex</span> + 1)<font></font>
    :<span class="hljs-keyword">if</span> (<span class="hljs-variable">$VPNBookServerIndex</span>&gt;=[:len <span class="hljs-variable">$VPNBookServerAddresses</span>]) <span class="hljs-keyword">do</span>={:<span class="hljs-built_in">set</span> VPNBookServerIndex 0}<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    :<span class="hljs-built_in">set</span> VPNBookRun <span class="hljs-literal">false</span><font></font>
  }<font></font>
  :<span class="hljs-keyword">if</span> (![/interface pptp-client get <span class="hljs-variable">$VPNBookpIfName</span> disabled]) <span class="hljs-keyword">do</span>={/interface pptp-client <span class="hljs-built_in">set</span> <span class="hljs-variable">$VPNBookpIfName</span> disabled=yes}
<span class="hljs-comment">#  :do {:set VPNBookPass ([/tool fetch url="http://serv/vpnbookpass_googlescript.php" output=user as-value]-&gt;"data")} on-error={:set VPNBookErr true}</span>
  :<span class="hljs-keyword">do</span> {
<span class="hljs-comment"># First request with Moved Temporarily. Fetch out to gasfetchout.txt</span>
    :<span class="hljs-built_in">local</span> jobid [:execute script={/tool fetch url=<span class="hljs-string">"https://script.google.com/macros/s/A.....g/exec"</span> output=user as-value} file=gasfetchout.txt]
<span class="hljs-comment"># Wait end job</span>
    :<span class="hljs-keyword">while</span> ([:len [/system script job find .id=<span class="hljs-variable">$jobid</span> ]] &gt; 0) <span class="hljs-keyword">do</span>={ delay 1s }
<span class="hljs-comment"># parse new URL for second fetch</span>
    :<span class="hljs-built_in">local</span> fetchOut [/file get gasfetchout.txt contents]<font></font>
    :<span class="hljs-built_in">local</span> startURL [:find <span class="hljs-variable">$fetchOut</span> <span class="hljs-string">"http"</span> -1]<font></font>
    :<span class="hljs-built_in">local</span> endURL [:find <span class="hljs-variable">$fetchOut</span> <span class="hljs-string">"\"&gt; "</span> startURL]<font></font>
    :<span class="hljs-built_in">local</span> moveURL [:pick <span class="hljs-variable">$fetchOut</span> <span class="hljs-variable">$startURL</span> <span class="hljs-variable">$endURL</span>]<font></font>
    :<span class="hljs-built_in">set</span> VPNBookPass ([/tool fetch url=<span class="hljs-variable">$moveURL</span> output=user as-value]-&gt;<span class="hljs-string">"data"</span>)<font></font>
  } on-error={:<span class="hljs-built_in">set</span> VPNBookErr <span class="hljs-literal">true</span>}<font></font>
  :<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$VPNBookErr</span>) <span class="hljs-keyword">do</span>={<font></font>
    :<span class="hljs-keyword">if</span> ([/interface pptp-client get <span class="hljs-variable">$VPNBookpIfName</span> password] != <span class="hljs-variable">$VPNBookPass</span>) <span class="hljs-keyword">do</span>={/interface pptp-client <span class="hljs-built_in">set</span> <span class="hljs-variable">$VPNBookpIfName</span> password=<span class="hljs-variable">$VPNBookPass</span>}<font></font>
    :<span class="hljs-keyword">if</span> ([/interface pptp-client get <span class="hljs-variable">$VPNBookpIfName</span> connect-to] != <span class="hljs-variable">$VPNBookServerAddresses</span>-&gt;<span class="hljs-variable">$VPNBookServerIndex</span>) <span class="hljs-keyword">do</span>={/interface pptp-client <span class="hljs-built_in">set</span> <span class="hljs-variable">$VPNBookpIfName</span> connect-to=(<span class="hljs-variable">$VPNBookServerAddresses</span>-&gt;<span class="hljs-variable">$VPNBookServerIndex</span>)}<font></font>
    :<span class="hljs-built_in">log</span> info <span class="hljs-string">"VPNBook: Attempt to connect to: <span class="hljs-subst">$($VPNBookServerAddresses-&gt;$VPNBookServerIndex)</span>. Password: <span class="hljs-variable">$VPNBookPass</span>"</span>
    /interface pptp-client <span class="hljs-built_in">set</span> <span class="hljs-variable">$VPNBookpIfName</span> disabled=no<font></font>
  }<font></font>
}</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ4. Telegram GASãƒ—ãƒ­ã‚­ã‚·</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®éƒ¨åˆ†ã‚’ã€Telegramã‚µãƒ¼ãƒ“ã‚¹ã‚’Mikrotikã«çµ±åˆã™ã‚‹æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å……ã¦ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ã“ã“ã§GASã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ã€ãƒœãƒƒãƒˆãŒã‚µãƒ¼ãƒ“ã‚¹ã¨é€£æºã™ã‚‹api.telegram.orgã‚’å«ã‚€ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã¨ã„ã†ç¾å®ŸãŒãªã‘ã‚Œã°ã€ç´”ç²‹ã«å­¦è¡“çš„ãªé–¢å¿ƒäº‹ã«ãªã‚Šã¾ã™ã€‚ã“ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¯ã€PNGç”»åƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã“ã¨ã«ã¤ã„ã¦ã®è¨˜äº‹ã®æœ€åˆã«ã‚ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å ´åˆã€GAS Webã‚¢ãƒ—ãƒªã¯ã€Mikrtotikã‹ã‚‰api.telegram.orgã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã‚ˆã†ã«ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚åŸºæœ¬ã¨ã—ã¦ã€manzoorwanijkã®æ—¢æˆã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€WPTelegram Google Script </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gist.github.com/manzoorwanijk/ee9ed032caedf2bb0c83dea73bc9a28eã‚’ä½¿ç”¨ã—ã¾ã—ãŸ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€å¤šãã®Telegram APIãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ—ãƒ­ã‚­ã‚·ã§ãã¾ã™ï¼ˆã™ã¹ã¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚ argsã§ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å«ã‚€JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚æ¬¡ã«ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚</font></font><code>{"chat_id":"123","text":"HelloWorld"}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€RouterOS Mikrtotikã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ã¨ã„ã†ç§ã®ä»•äº‹ã®ãŸã‚ã«ã€å®Ÿè£…ã¯è¤‡é›‘ã«æ€ãˆã€ç§ã¯ãã‚Œã‚’ç°¡ç•¥åŒ–ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">æœ€çµ‚çš„ã«ã¯ã€ä¸€èˆ¬çš„ã«ã€ã•ã¾ã–ã¾ãªTelegram APIãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã„ãã¤ã‹ã®Webã‚¢ãƒ—ãƒªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨˜è¿°ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚ŒãŒsendMessageãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…ã§ã™ã€‚</font><font style="vertical-align: inherit;">å‘¼ã³å‡ºã•ã‚ŒãŸsendMessageãƒ¡ã‚½ãƒƒãƒ‰ã®åå‰ã€ã•ã‚‰ã«ã¯bot_tokenã¨chat_idã‚’requestHandleré–¢æ•°ã®æœ¬ä½“ã«åŸ‹ã‚è¾¼ã‚€ã“ã¨ã§ã€ã•ã‚‰ã«ç°¡ç´ åŒ–ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doGet</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> e !== <span class="hljs-string">'undefined'</span>){
    <span class="hljs-keyword">return</span> ContentService.createTextOutput(requestHandler(e));<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doPost</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> e !== <span class="hljs-string">'undefined'</span>){
    <span class="hljs-keyword">return</span> ContentService.createTextOutput(requestHandler(e));<font></font>
  }  <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestHandler</span>(<span class="hljs-params">e</span>)</span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> e.parameter.bot_token === <span class="hljs-string">'undefined'</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'Error! Bot token not provided'</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> e.parameter.method === <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'Error! Method name not provided'</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> e.parameter.chat_id === <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'Error! Chat id not provide'</span>;<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> e.parameter.text === <span class="hljs-string">'undefined'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'Error! Text not provide'</span>;<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">/* if(typeof e.parameter.args !== 'undefined'){
    var args = e.parameter.args;
    data.payload = JSON.parse(args);
  } */</span><font></font>
  <font></font>
  <span class="hljs-keyword">if</span> (e.parameter.method === <span class="hljs-string">'sendMessage'</span>) {
    <span class="hljs-keyword">var</span> data = {
      <span class="hljs-string">"method"</span>: <span class="hljs-string">"post"</span>,
      <span class="hljs-string">"muteHttpExceptions"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">payload</span> : <span class="hljs-string">'chat_id='</span> + e.parameter.chat_id + <span class="hljs-string">'&amp;text='</span> + e.parameter.text<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> UrlFetchApp.fetch(<span class="hljs-string">'https://api.telegram.org/bot'</span> + e.parameter.bot_token + <span class="hljs-string">'/'</span> + e.parameter.method, data).getContentText();<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’Webã‚¢ãƒ—ãƒªã§å…¬é–‹ã—ãŸå¾Œã€GETãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦æ¬¡ã®ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">https://script.google.com/macros/s/A.....A/exec?bot_token=3.....3&amp;method=sendMessage&amp;chat_id=2.....3&amp;text=testtext123</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã¯RouterOS POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">:<span class="hljs-keyword">do</span> {<font></font>
  /tool fetch url=(<span class="hljs-string">"https://script.google.com/macros/s/A.....A/exec"</span>) keep-result=no http-method=post http-data=(<span class="hljs-string">"bot_token=3.....3&amp;method=sendMessage&amp;chat_id=2.....3&amp;text=testtext123"</span>) <font></font>
} on-error={<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚ˆã†ã«ã€fetchã¸ã®æœ€åˆã®å‘¼ã³å‡ºã—ã§ä¾‹å¤–ã€ŒMoved Temporarily 302ã€ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã€on-errorãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ãªã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã“ã®æ™‚ç‚¹ã§åœæ­¢ã™ã‚‹ãŸã‚ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯do-on-errorã§ãƒ©ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">è»¢é€ã›ãšã«ãƒ•ã‚§ãƒƒãƒã‚’1å›å‘¼ã³å‡ºã™ã ã‘ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã§ãã‚‹ãŸã‚ã€ãƒ†ãƒ¬ã‚°ãƒ©ãƒ APIã‹ã‚‰è¿”ã•ã‚Œã‚‹JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä¸è¦ãªå ´åˆã¯ã€ãƒ•ã‚§ãƒƒãƒã‚’2å›å‘¼ã³å‡ºã™å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒˆ5.æœ€çµ‚</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Google Apps Scriptã¨ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã®æ¥ç‚¹ã«æŒã£ã¦ãã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚ãªãŸã¯ã‚‚ã£ã¨ãŸãã•ã‚“è€ƒãˆå‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€VPNBookï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã®è² è·ã‚’è»½æ¸›ã™ã‚‹ãŸã‚ã«ã€VPNBookãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¦æ±‚ã§å¿œç­”ã™ã‚‹Telegramãƒœãƒƒãƒˆã‚’GASã§è¨˜è¿°ã—ã¾ã™ã€‚ã“ã‚Œã¯ã™ã¹ã¦1ã¤ã®GASã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å«ã¾ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">GASã§ã¯ã€Mikrtotikã®ãƒ­ã‚®ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ§‹æˆã‚’è¨˜è¿°ã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ã€Googleãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã«é…ç½®ã•ã‚Œã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja475840/index.html">Badoo Jira APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼šPHPã®Jiraã®é­”æ³•</a></li>
<li><a href="../ja475842/index.html">SIPé›»è©±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³URLã¨URIã‚’ç½®ãæ›ãˆã‚‹ã‹ã€Webã‚½ã‚±ãƒƒãƒˆã‚’ä»‹ã—ã¦ç®¡ç†ã—ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja475848/index.html">Yandex.Marketæ¤œç´¢ã®ä»•çµ„ã¿ã¨ã€ã‚µãƒ¼ãƒãƒ¼ã®1ã¤ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãŸå ´åˆã®å‹•ä½œ</a></li>
<li><a href="../ja475850/index.html">ã¾ã çµŒé¨“ãŒãªã„å ´åˆã«ã€ITã§ã‚­ãƒ£ãƒªã‚¢ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja475854/index.html">JDBCãƒ—ãƒ¼ãƒ«ã¨åŠ¹ç‡çš„ãªãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ï¼š12æœˆ3æ—¥ã®ã‚µãƒ³ã‚¯ãƒˆãƒšãƒ†ãƒ«ãƒ–ãƒ«ã‚¯ã§ã®Java mitap</a></li>
<li><a href="../ja475858/index.html">é¢ç™½ã„æš—å·ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼šäººã®ãŸã‚ã®é‰±æ¥­ã®ç†±ã¨é‰±æ¥­ã®ãŸã‚ã®äººã®ç†±</a></li>
<li><a href="../ja475860/index.html">Apache NiFiã€‚11æœˆ28æ—¥Deworkacyãƒ¬ã‚¯ãƒãƒ£ãƒ¼ãƒ›ãƒ¼ãƒ«</a></li>
<li><a href="../ja475862/index.html">æ©Ÿæ¢°å­¦ç¿’ã‚’ãƒ“ã‚¸ãƒã‚¹ã«å°å…¥ã™ã‚‹ã“ã¨ã«ã¤ã„ã¦ã®æ‚ªã„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</a></li>
<li><a href="../ja475866/index.html">çŒ«ã€é£›è¡Œæ©Ÿã€ã‚ªãƒ•ã‚£ã‚¹ã€ã‚¹ãƒˆãƒ¬ã‚¹</a></li>
<li><a href="../ja475868/index.html">ã‚¹ãƒãƒ¼ãƒˆãƒ©ãƒ³ãƒ—</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>