<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🎓 🛴 👩🏼‍🤝‍👨🏾 Cloudflareが第10世代エッジサーバーにAMDプロセッサを選択 👨‍👨‍👧‍👧 👩🏿‍🤝‍👩🏼 😍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="10億を超える一意のIPアドレスが毎日Cloudflare Networkを通過します。 1秒あたり1,100万を超えるHTTPリクエストを処理します。インターネット人口の95％から100ミリ秒以内の距離にあります。当社のネットワークは90か国以上の200の都市にまたがっており、エンジニアリングチー...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cloudflareが第10世代エッジサーバーにAMDプロセッサを選択</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493108/"><img src="https://habrastorage.org/getpro/habr/post_images/536/952/a76/536952a764f14e82b44b8765e9c63737.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10億を超える一意のIPアドレスが毎日Cloudflare Networkを通過します。 1秒あたり1,100万を超えるHTTPリクエストを処理します。インターネット人口の95％から100ミリ秒以内の距離にあります。当社のネットワークは90か国以上の200の都市にまたがっており、エンジニアリングチームは非常に高速で信頼性の高いインフラストラクチャを構築しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは私たちの仕事に非常に誇りを持っています。作業がハードウェアに関連するCloudflareエンジニアは、サーバーとそのコンポーネントに精通しており、効率を最大化するための最適な機器を理解して選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当社のソフトウェアスタックは高負荷コンピューティングを処理し、CPU速度に大きく依存しているため、エンジニアはスタックのすべてのレベルでCloudflareの効率と信頼性を常に最適化する必要があります。</font><font style="vertical-align: inherit;">サーバー側では、最も簡単な方法は、CPUコアを追加して計算能力を高めることです。</font><font style="vertical-align: inherit;">サーバーに組み込むことができるコアが多いほど、データを処理できます。</font><font style="vertical-align: inherit;">当社の製品と顧客の多様性は時間とともに成長し、リクエストの増加によりサーバーは生産性を向上させる必要があるため、これは私たちにとって重要です。</font><font style="vertical-align: inherit;">彼らの生産性を高めるために、私たちは核の密度を増やす必要がありました-これはまさに私たちが達成した課題です。</font><font style="vertical-align: inherit;">以下に、コアの数を含む、2015年以降に展開しているサーバーのプロセッサデータの詳細を示します。</font></font><br>
<a name="habracut"></a><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">---</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6世代</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第7世代</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8世代</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9世代</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕事の始まり</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015年</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2016年</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2017年</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2018年</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon E5-2630 v4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インテルXeonシルバー4116</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Xeon Platinum 6162</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物理コア</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2×10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 85W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コアあたりのTDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.65 W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.50 W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.08W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.25 W</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2018年には、第9世代でサーバーあたりのコアの総数が大きく飛躍しました。</font><font style="vertical-align: inherit;">環境への影響は、第8世代と比較して33％削減されました。これにより、ラックあたりのボリュームとコンピューティング能力を向上させる機会が得られました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熱設計電力</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（TDP）</font><font style="vertical-align: inherit;">設計要件は</font><font style="vertical-align: inherit;">、当社のエネルギー効率も時間の経過とともに成長していることを強調するために言及されています。</font><font style="vertical-align: inherit;">この指標は私たちにとって重要です。まず、大気への炭素排出量を減らしたいです。</font><font style="vertical-align: inherit;">次に、データセンターのエネルギーを最大限に活用したいと考えています。</font><font style="vertical-align: inherit;">しかし、私たちは何のために努力しなければならないかを知っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの主な定義指標は、ワットあたりのリクエスト数です。コアを追加することで、1秒あたりのリクエスト数を増やすことができますが、エネルギー予算内に収める必要があります。私たちはデータセンターの電力インフラストラクチャによって制限されています。これは、選択したエネルギー分配モジュールとともに、各サーバーラックに一定の上限を与えます。サーバーをラックに追加すると、消費電力が増加します。ラックのエネルギー制限を超えて新しいラックを追加する必要がある場合、運用コストは劇的に増加します。同じエネルギー範囲に留まるように計算能力を高める必要があります。これにより、主要なメトリックである1ワットあたりのリクエスト数が増加します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご想像のとおり、私たちは設計段階でエネルギー消費を注意深く調査しました。</font><font style="vertical-align: inherit;">上の表は、より多くのエネルギーを消費するCPUの導入に時間を浪費してはならないことを示しています。コアあたりのTDPが現在の世代よりも高い場合、これはメトリック、ワットあたりのリクエスト数に悪影響を及ぼします。</font><font style="vertical-align: inherit;">私たちは、市場に出ているジェネレーションXのすぐに使えるシステムを注意深く検討し、決定を下しました。</font><font style="vertical-align: inherit;">Intel Xeon Platinum 6162コア48個とソケット2個の回路から、ソケット1個の48コアAMD EPYC 7642に移行します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/d3c/162/8f5/d3c1628f5dfb45681f0fb25abce76b3e.jpg"><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">---</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AMD</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xeonプラチナ6162</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPYC 7642</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイクロアーキテクチャ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Skylake」 </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 「Zen 2」</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード名</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「スカイレイクSP」</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ローマ」 </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセス技術</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14nm</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7nm</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コア</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 24</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">周波数</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.9 GHz</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 GHz</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L3キャッシュ/ソケット</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24 x 1.375MiB</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 x 16MiB</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリ/ソケット</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6チャネル、最大DDR4-2400</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8チャネル、最大DDR4-3200</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x 150W</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">225 W</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PCIe /ソケット</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48レーン</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128レーン</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISA</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86-64</font></font></td>
</tr>
</tbody></table></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕様から明らかなように、AMDのチップを使用すると、同じ数のコアをそのままにしてTDPを下げることができます。</font><font style="vertical-align: inherit;">第9世代では、コアあたりのTDPは6.25ワットで、第X世代では4.69ワットになります。</font><font style="vertical-align: inherit;">25％の減少。</font><font style="vertical-align: inherit;">周波数の増加と、おそらく単一のソケットを備えたより単純な回路により、AMDチップがビジネスにおいてより優れていることが証明されると考えられます。</font><font style="vertical-align: inherit;">AMDがどれだけ優れたパフォーマンスを発揮するかを理解するために、さまざまなテストとシミュレーションを行っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それまでの間、TDPはサーバーの設計とCPUの選択の初期段階で使用した製造元の仕様からの簡略化されたメトリックであることに注意してください。</font><font style="vertical-align: inherit;">Googleをすばやく検索すると、AMDとIntelがTDPの定義に対して異なるアプローチを持っていることが示されているため、この仕様は信頼できません。</font><font style="vertical-align: inherit;">CPUの実際の消費電力、さらに重要なのはサーバーの消費電力は、最終的な決定を行うときに実際に使用するものです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生態系の準備</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のプロセッサを選択する旅の初めに、ソフトウェアスタックとサービス（C、LuaJIT、Goで記述）に最適なさまざまなメーカーのさまざまなCPUを調査しました。速度を測定するための一連のツールについて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ブログの記事の1つで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既に詳しく説明してい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。この場合、同じセットを使用しました。これにより、妥当な時間内にCPUの有効性を評価でき、その後、エンジニアはプログラムを特定のプロセッサに適合させることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまな数のコア、ソケット、周波数でさまざまなプロセッサをテストしました。この記事では、AMD EPYC 7642を採用した理由について説明しているため、このブログのすべてのグラフィックスは、AMDプロセッサのパフォーマンスに焦点を当てています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9世代</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は、各プロセッサバリアントを備えた1つのサーバーの動作の測定値に対応します。つまり、Intelの2つの24コアプロセッサー、またはAMDの1つの48コアプロセッサー（2つのソケットを備えたIntel用サーバーと1つのAMD EPYC用サーバー）を使用したものです。</font><font style="vertical-align: inherit;">BIOSでは、稼働中のサーバーに対応するパラメーターを設定します。</font><font style="vertical-align: inherit;">AMDの場合は3.03 GHz、Intelの場合は2.5 GHzです。</font><font style="vertical-align: inherit;">非常に単純化して、同じ数のコアでAMDがIntelより21％優れた結果を示すことを期待しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/eb4/843/287/eb484328713741f6688d81c15a9c5920.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/598/82b/416/59882b416feabd9eea86ea9d99d1e1df.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDにとって有望に見えます。</font><font style="vertical-align: inherit;">公開鍵暗号で18％良く機能します。</font><font style="vertical-align: inherit;">対称鍵を使用すると、AES-128-GCM暗号化オプションでは失われますが、一般的には同等であることが示されています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">圧縮</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エッジサーバーでは、大量のデータを圧縮して帯域幅を節約し、コンテンツ配信の速度を向上させます。</font><font style="vertical-align: inherit;">zlibおよびbrotli Cライブラリを介してデータを渡します。</font><font style="vertical-align: inherit;">すべてのテストは、メモリ内のblog.cloudflare.com HTMLファイルで行われました。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/fdc/bf7/ae1/fdcbf7ae1109d02a45b2ca40fe353376.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ccc/427/983/ccc427983ceb85dbf63bab614850692f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDはgzipを使用したときに平均29％勝ちました。</font><font style="vertical-align: inherit;">brotliの場合、動的圧縮に使用する品質7のテストでの結果はさらに優れています。</font><font style="vertical-align: inherit;">brotli-9テストで急激な低下が発生しました。これは、Brotliが大量のメモリを消費し、キャッシュをオーバーフローしたことが原因です。</font><font style="vertical-align: inherit;">ただし、AMDは大差で勝利します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのサービスの多くはGoで書かれています。</font><font style="vertical-align: inherit;">次のグラフでは、文字列ライブラリを使用して、32 KB行でGo with RegExpの暗号化と圧縮率を再確認しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化に進む</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/78a/ab0/495/78aab0495309cefee6f30bac835ee961.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">圧縮する</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/f99/2cb/95d/f992cb95d4913a2d19808d4bd15b5b54.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/850/e7c/f55/850e7cf5586f693dd14d62f70510f681.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正規表現に行く</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/b58/798/6cb/b587986cbab94ca7087364a949f09aa4.png"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/444/e76/f72/444e76f72c1ec2e93c4cae0c5bd386f2.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列に行く</font></font></h3><br>
<img src="https://habrastorage.org/getpro/habr/post_images/3e9/984/19a/3e998419adb450f598e0f3d82de01aa1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDはGoを使用したすべてのテストで最高の結果を示していますが、ECDSA P256サインは38％遅れています。これは、Cで24％良い結果を示したことを考慮すると、奇妙で​​す。</font><font style="vertical-align: inherit;">何が起こっているのかを理解する価値があります。</font><font style="vertical-align: inherit;">しかし、一般に、AMDはあまり勝てませんが、それでも最良の結果を示します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルアジット</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スタックではLuaJITをよく使用します。</font><font style="vertical-align: inherit;">これはCloudflareのすべての部分を保持する接着剤です。</font><font style="vertical-align: inherit;">AMDがここで勝利したことをうれしく思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、テストはEPYC 7642が2つのXeon Platinum 6162よりも優れていることを示しています。AMDは、AES-128-GCMとGo OpenSSL ECDSA-P256 Signなどの2つのテストで負けますが、他のすべてのテストでは平均25％勝ります。 。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワークロードシミュレーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エクスプレステストの後、合成エッジがソフトウェアエッジスタックに適用される別のシミュレーションセットを介してサーバーを実行しました。ここでは、実際の作業で見つけることができるさまざまなタイプのクエリを使用して、スクリプトのワークロードをシミュレートします。リクエストは、データ量、HTTPまたはHTTPSプロトコル、WAF、ワーカーソースなど、さまざまな変数によって異なります。以下は、最も頻繁に検出されるタイプの要求に対する2つのCPUのスループットの比較です。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/594/dbb/4cf/594dbb4cf570a1c22ff666d592884ef7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図の結果は、Intelプロセッサーを搭載した第9世代のマシンの基本インジケーターで測定され、x軸に沿って1.0の値に正規化されています。</font><font style="vertical-align: inherit;">たとえば、HTTPS経由で10 KiBの単純なリクエストを取得すると、1秒あたりのリクエスト数の点でAMDがIntelの1.5倍優れていることがわかります。</font><font style="vertical-align: inherit;">AMDは、所定のテストでIntelよりも平均34％優れています。</font><font style="vertical-align: inherit;">AMD EPYC 7642のみのTDPが225 W、2つのIntelプロセッサ-300 Wであることを考えると、「ワットあたりの要求数」の観点から、AMDはIntelの2倍の結果を示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点で、第X世代の将来のCPUとして、AMD EPYC 7642の単一ソケットのオプションに明らかに傾倒していました。AMDEPYCサーバーが実際の作業でどのように動作するかを知ることに非常に興味があり、すぐにいくつかのサーバーをいくつかに送信しましたデータセンターから。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際の仕事</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、最初のことは、サーバーを実際の状態で作業できるように準備することでした。</font><font style="vertical-align: inherit;">当社のすべてのマシンは同じプロセスとサービスで動作するため、パフォーマンスを正しく比較する絶好の機会です。</font><font style="vertical-align: inherit;">ほとんどのデータセンターと同様に、数世代のサーバーが展開されており、各クラスにほぼ同じ世代のサーバーが含まれるようにサーバーをクラスターにまとめています。</font><font style="vertical-align: inherit;">場合によっては、これにより、使用率曲線がクラスター間で異なる可能性があります。</font><font style="vertical-align: inherit;">しかし、私たちと一緒ではありません。</font><font style="vertical-align: inherit;">当社のエンジニアはすべての世代のCPU使用率を最適化しているため、8つのコアが特定のマシンのCPUにあるか24あるかに関係なく、CPU使用率は通常、他のCPU使用率と変わりません。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9b9/ea2/a9b/9b9ea2a9b8b70ad4e6e8f3b4e72200a3.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフは、リサイクルの類似性に関するコメントを示しています。GenXサーバーでのAMD CPUの使用とGen 9サーバーでのIntelプロセッサーの使用に大きな違いはありません。つまり、テストサーバーとコアサーバーの両方に同等の負荷がかかります。いいよこれはサーバーの作業で達成したことであり、正直な比較のために必要です。次の2つのグラフは、サーバーレベルで1つのCPUコアとすべてのコアによって処理されたリクエストの数を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/075/8a6/91c/0758a691c0287281bd4c70bc1625d631.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クエリ</font></font></i><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0a2/c5d/206/0a2c5d206c83c98cc06b910118a03a17.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーへのサーバーのクエリ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDでは平均で23％多いリクエストが処理されることがわかります。悪くない、全く！ブログには、Gen 9のパフォーマンスを向上させる方法について頻繁に書いています。ここではコアの数は同じですが、AMDはより少ないエネルギーでより多くの作業を行っています。コア数とTDPの仕様からすぐに、AMDはより高いエネルギー効率でより高速を提供することがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、すでに述べたように、TDPは標準仕様ではなく、すべてのメーカーで同じというわけではないので、実際のエネルギー使用量を見てみましょう。 1秒あたりのリクエスト数と並行してサーバーのエネルギー消費を測定すると、次のグラフが得られます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/eac/f1a/a0f/eacf1aa0fcbee9f35c376bf52a7f37d1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1秒あたりの1ワットあたりのリクエスト数により、AMDプロセッサー上のGen Xサーバーは28％効率的です。 AMDのTDPが25％低いことを考えると、もっと多くを期待できたかもしれませんが、TDPはあいまいな特性であることを覚えておく必要があります。 AMDの実際のエネルギー消費量は、ベースをはるかに超える周波数で示されたTDPとほぼ一致していることがわかりました。インテルにはありません。これは、TDPがエネルギー消費量の信頼できる見積もりではないもう1つの理由です。当社のGen 9サーバーのIntel CPUはマルチコードシステムに統合されていますが、AMD CPUは標準の1Uフォームファクターサーバーで動作します。マルチノードサーバーはノードあたりの電力消費を抑えて高密度を実現する必要があるため、これはAMDには向いていません。ただし、ノードあたりのエネルギー消費量では、AMDは依然としてIntelよりも優れています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕様、テストシミュレーション、および実際の作業に関するほとんどの比較で、1P AMD EPYC 7642の構成は2P Intel Xeon 6162よりもはるかに優れていることが判明しました。状況によっては、AMDは36％優れた動作をすることができ、ハードウェアとプログラムを最適化することで、そのような改善は継続的に達成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AMDが勝ったことがわかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加のグラフは、NGINX操作の24時間の平均遅延とp99遅延を示しています。</font><font style="vertical-align: inherit;">AMDプロセスは平均で25％高速に実行されました。</font><font style="vertical-align: inherit;">p99では、時刻に応じて20〜50％速く実行されます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cloudflareのハードウェアおよびパフォーマンスエンジニアは、お客様に最適なサーバー構成を選択するために多くのテストと調査を行っています。私たちはここで働くのが好きです。なぜなら、そのような壮大なタスクを解決できるほか、サーバーレスエッジコンピューティングなどのサービスや、セキュリティの問題、特にMagic Transit、Argo Tunnel、DDoS保護などの一連のソリューションで問題を解決するのに役立つからです。 。 Cloudflareネットワーク内のすべてのサーバーは、信頼性の高い操作ができるように構成されており、次世代の各サーバーを前のサーバーよりも優れたものにするように常に努めています。 AMD EPYC 7642は、Gen X向けのプロセッサーの選択に関する質問への回答であると私たちは考えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cloudflare Workersサービスを使用して、開発者はアプリケーションを私たちのネットワークに展開し、世界中に展開しています。クラウドのセキュリティと信頼性に取り組みながら、コードの記述に集中できる機会をお客様に提供できることを誇りに思います。そして今日、私たちは彼らの仕事が第2世代AMD EPYCプロセッサを実行する私たちのGen X世代サーバーに展開されることをさらに嬉しく思います。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7de/304/54d/7de30454d5b87e7a32fceda1e3f7ca49.jpg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPYC 7642プロセッサ、コードネームは「ローマ」[ローマ]</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
AMDのEPYC 7642を使用して、速度を向上させ、ネットワークを新しい都市に拡大することができました。ローマは1日で建てられませんでしたが、すぐに多くの人に近づくでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
過去数年間、私たちはIntelやAMDの多くのx86チップ、およびARMのプロセッサで実験を行ってきました。</font><font style="vertical-align: inherit;">将来的には、これらのCPUメーカーが協力して、改善されたインターネットを一緒に構築できるようになることを期待しています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493096/index.html">iOSでダークテーマを追加する</a></li>
<li><a href="../ja493098/index.html">ASA VPNロードバランシングクラスターの導入</a></li>
<li><a href="../ja493100/index.html">簡単な方法を見つけることがスタートアップが積極的な成長を達成するのにどのように役立つか</a></li>
<li><a href="../ja493102/index.html">グローバルオートメーションのトレンド：RPA開発</a></li>
<li><a href="../ja493106/index.html">悪魔のダースはどれくらい新しいですか？</a></li>
<li><a href="../ja493110/index.html">リモート作業で委任する方法-チームリードなどのガイド</a></li>
<li><a href="../ja493112/index.html">3年ではなく6か月で新しいビジネスを始める方法</a></li>
<li><a href="../ja493114/index.html">データエンジニアによるデータの監視方法</a></li>
<li><a href="../ja493116/index.html">「より多くのインタラクティブ性！」または、TeamLead Conf 2020はいかがでしたか</a></li>
<li><a href="../ja493118/index.html">メモリタグ拡張機能の概要（Armv8.5-A）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>