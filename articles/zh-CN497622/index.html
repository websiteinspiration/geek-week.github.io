<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥓 🍪 👩🏻‍🏫 荧光图像中的自动COVID-19检测器 👩🏾‍🎨 🔕 👩🏼‍🤝‍👩🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本指南中，您将学习如何使用Keras，TensorFlow和深度学习在特殊选择的数据集中自动检测COVID-19。
 
 像现在世界上大多数人一样，我真诚地关心COVID-19。我注意到我开始不断分析自己的健康状况，并怀疑自己已经被感染。
 
 我越担心这一点，将真实症状与软骨病的痛苦组合表现得越...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>荧光图像中的自动COVID-19检测器</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本指南中，您将学习如何使用Keras，TensorFlow和深度学习在特殊选择的数据集中自动检测COVID-19。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
像现在世界上大多数人一样，我真诚地关心COVID-19。</font><font style="vertical-align: inherit;">我注意到我开始不断分析自己的健康状况，并怀疑自己已经被感染。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我越担心这一点，将真实症状与软骨病的痛苦组合表现得越痛苦：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我早上醒来，感到有点不知所措。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当我下床时，我的鼻子已经漏水了（尽管</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在知道</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">流鼻涕不是COVID-19的症状）。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当他到达浴室拿餐巾纸时，他还咳嗽了。</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
起初，我对此并不十分重视-我对花粉过敏，而且由于东海岸的温暖天气，今年初春天来了。我的过敏很可能刚爆发。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是症状并没有整日改善。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我坐在这里，在嘴里用温度计写这本手册。向下看时显示37.4°C。温度高于我通常的36.3°C。高于37.2°C的一切，我已经考虑过轻微发烧。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
咳嗽和有点发烧？可能是COVID-19，或者只是我的过敏。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
没有测试就不可能发现，正是这种“无知”使这种情况对于心理平衡如此危险。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于人们来说，没有什么比未知更可怕了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管有种种担忧，我还是试图以合理的方式摆脱它们。我已经三十多岁了，身体状况很好，我的免疫系统很强。我将隔离（以防万一），我会休息并恢复正常。 COVID-19不会在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的个人</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康</font><font style="vertical-align: inherit;">方面吓到我</font><font style="vertical-align: inherit;">（至少我一直对自己说这句话）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，我担心我的老年亲戚，包括那些患有慢性疾病的人以及在疗养院或医院里的人。它们很脆弱，如果我们由于这种感染而失去它们，那将是非常可悲的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了不袖手旁观，不屈服于虚弱（无论是过敏，COVID-19还是焦虑症），我决定尽我所能-</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过编写代码，进行实验以及教别人如何在实际的实际应用中使用计算机视觉和深度学习，为整个机器视觉和深度学习社区提供服务</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，老实说，这不是我写过的最科学的文章。</font><font style="vertical-align: inherit;">其实远非如此。</font><font style="vertical-align: inherit;">所使用的方法和数据集不值得发表。</font><font style="vertical-align: inherit;">但是它们可以成为想要帮助的人的起点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是我想尽我所能。</font><font style="vertical-align: inherit;">本文只是我在精神上克服困难并同时在类似情况下帮助他人的方式。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望你能理解我。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在今天的课程中，我们将执行以下操作：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将从收集的COXID-19呈阳性的患者的透视图中收集一组公开数据。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们收集一系列健康患者的荧光图。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将训练卷积神经网络，以从创建的集合中自动检测图像中的COVID-19。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将从教育的角度评估获得的结果。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
免责声明：我已经暗示过，但我会直言不讳。</font><font style="vertical-align: inherit;">本文中的方法和技术仅用于教育目的。</font><font style="vertical-align: inherit;">这不是真正的科学研究，也不会在期刊上发表。</font><font style="vertical-align: inherit;">本文适用于对（1）计算机视觉/深度学习感兴趣并希望使用实用方法学习的读者，以及（2）关注时事的读者。</font><font style="vertical-align: inherit;">求您以这种方式与您联系。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">荧光图上的COVID-19</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第一部分中，我们讨论如何在胸部X光片上检测到COVID-19。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后考虑我们的数据集。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，我将向您展示如何使用Keras和TensorFlow训练深度学习模型，以在我们的图像数据集中定义COVID-19。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的任务是激发您的灵感，并表明对计算机视觉/深度学习的研究，然后将其应用于医学领域，会对世界产生重大影响。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
简而言之：您不需要医学学位即可为医学做出贡献。与医生和医疗保健提供者紧密合作的深度学习专家可以解决复杂的问题，挽救生命，并使世界变得更美好。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望本指南能激发您这样做。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，尽管如此，科学期刊和专家评估系统</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">充斥着</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有可疑质量的COVID-19预测模型的资料。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请不要使用本文中的代码/模型，也不要将其发送到期刊或将其放在科学站点的公共领域中-您只会增加一些噪音。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
此外，如果您打算在自己的研究中使用本文（或Internet上的任何其他COVID-19文章），请确保检查</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRIPOD规则以创建预测报告模型</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可能知道，在医学中使用AI会带来</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常真实的后果</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。仅在与医学专家密切协商后才能发布或使用此类模型。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 1.来自患者的COXID-19呈阳性测试的荧光图示例。在Keras和TensorFlow的帮助下，可以训练分类器在此类图像中检测COVID-19，</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
目前很难找到</font><i><font color="gray"><font style="vertical-align: inherit;"> COVID-19</font></font></i><font style="vertical-align: inherit;">测试-</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它们只是不够</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">不能足够</font></a><font style="vertical-align: inherit;">快地进行，从而引起恐慌。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当出现恐慌时，一些邪恶的人会利用这一优势并</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出售假冒的测试套件COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，从而</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在社交网络和即时通讯工具上找到受害者</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
鉴于COVID-19测试套件的数量有限，您应该依靠其他诊断方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
医生通常依靠胸部X光检查（通常称为透视图）来诊断肺炎，肺炎，脓肿和/或淋巴结肿大。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19攻击呼吸道上皮，X射线有助于检查患者的肺部状况。大多数医院都安装了X射线机，因此在不使用特殊测试套件的情况下，使用荧光检查法测试COVID-19是合乎逻辑的。缺点是这样的分析需要放射学专家并且花费大量时间。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，开发自动化系统对于节省全球医疗专业人员的宝贵时间将非常有价值。</font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最近的一些出版物建议计算机断层扫描更适合诊断COVID-19，但是在本课程中，我们仅使用荧光检查。</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资料集</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">2.左侧为阳性样本（来自感染患者），右侧为阴性。</font><font style="vertical-align: inherit;">这些图像用于训练自动预测疾病存在的模型，</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我们的数据集由</font><font style="vertical-align: inherit;">蒙特利尔大学的研究生</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Joseph Cohen博士</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编辑</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">3月初，他开始收集COVID-19，MERS，SARS和SARS患者的荧光图，并将其发布</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在GitHub上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">存储库中</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们需要从存储库下载文件，</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并从其中选择指示行</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19的阳性结果。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">肺的类型“后-前”（PA）。</font><font style="vertical-align: inherit;">据我了解，这是“健康”图像中使用的图像类型。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19阳性病例共发现25片荧光图（图2，左）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于健康的患者，我使用了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuggle数据集（肺炎）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并选择了25位健康患者的图像（图2，右）。</font><font style="vertical-align: inherit;">该数据集有很多问题，即标签嘈杂/不正确，但是将对COVID-19自动检测器进行概念检查。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目结构</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我的网站的“下载”部分中，您可以输入您的电子邮件地址，并找到指向该项目的带有代码，脚本和其他文件的档案的链接。</font><font style="vertical-align: inherit;">解压缩文件，您将看到目录结构：</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [25 entries]<font></font>
│   └── normal [25 entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
荧光图位于目录中</font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中两个数据类分为目录</font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这两个脚本都是为了建立数据集而提供的，但是我们今天不再考虑它们。</font><font style="vertical-align: inherit;">相反，请考虑</font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教我们COVID-19检测器</font><font style="vertical-align: inherit;">的脚本</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实作</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们继续建立卷积神经网络。</font><font style="vertical-align: inherit;">打开文件</font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并粘贴以下代码：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该脚本使用了TensorFlow 2.0和Keras的许多深度学习库。</font><font style="vertical-align: inherit;">此外，我们使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，用于机器学习的标准Python库，</font><font style="vertical-align: inherit;">用于绘图的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font><font style="vertical-align: inherit;">用于加载和处理图像的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要安装TensorFlow 2.0（包括适当的scikit-learn，OpenCV和matplotlib库），请按照我对</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明进行操作</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们将分析命令行参数并初始化超参数：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
三个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行参数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：输入数据集的路径</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学习历史记录的退出时间表的可选路径。</font><font style="vertical-align: inherit;">除非另有说明，否则默认值为</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：输出模型的可选路径；</font><font style="vertical-align: inherit;">默认</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来的几行将初始化初始学习速度，时代数和数据包大小的超参数。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们准备下载和预处理荧光图：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了加载数据，我们捕获了目录中图像的所有路径</font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后每个</font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们从路径中检索类标签（</font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们对其进行加载</font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和预处理，将其转换为RGB并重新调整为224×224像素，以便为神经网络做好准备。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正在更新清单</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后将像素强度缩放到[0，1]范围，并将数据和标签转换为NumPy数组格式。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们执行直接编码</font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将数据分为若干组进行训练/测试：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接编码意味着将数据转换为以下格式：</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个编码的标签均由具有两个元素的数组组成：“热”（1）或“非”（0）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，以下几行将我们的数据分开，剩下的80％用于培训，而20％用于测试。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了确保模型是通用的，我们通过将图像设置为顺时针或逆时针随机旋转15°来执行数据扩充。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后三行初始化数据增强生成器对象。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在初始化我们的VGGNet模型并对其</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行微调</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前两行使用先前在ImageNet上训练的权重创建了VGG16网络的实例，而没有触及完全连接的层（FC）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，我们构建一个新的完全连接的图层，该图层由layer组成</font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并将其添加到VGG16之上。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后我们冻结</font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VGG16 </font><font style="vertical-align: inherit;">的权重</font><font style="vertical-align: inherit;">，因此</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练</font><font style="vertical-align: inherit;">FC层。这样就完成了设置。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们准备编译和训练用于COVID-19的深度学习模型：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一行编译神经网络，并带有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">降低学习速度</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和优化器</font><font style="vertical-align: inherit;">的选项</font></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">考虑到这是一个两类问题，我们使用损失</font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是交叉熵。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要开始学习过程，我们在Keras </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">方法</font></a><font style="vertical-align: inherit;">，将</font><font style="vertical-align: inherit;">荧光图</font><font style="vertical-align: inherit;">通过我们的数据增强对象。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们评估模型：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了进行评估，我们首先对测试集进行预测，并保留预测指标。</font><font style="vertical-align: inherit;">然后，我们使用scikit-learn创建并显示分类报告，其中包含此类辅助功能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们计算误差矩阵以进行进一步的统计评估：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，我们执行以下操作：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们生成了一个误差矩阵。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在它的帮助下，我们通过打印所有这些指标来计算准确性，敏感性和特异性。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了进行自我测试，我们生成了一张带有训练准确性和损失历史的图形，并将其输出到图形文件中：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，将分类器模型保存</font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到磁盘：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">侦探训练</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用上述源代码和脚本从归档文件下载所有文件后，打开控制台并运行以下命令来训练检测器：</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据荧光检查结果自动诊断COVID-19</font></font></h2><br>
<i><b>  :</b>      ,  «»   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从以上结果可以看出，我们的自动检测器对现有样本集的准确度约为90-92％。</font><font style="vertical-align: inherit;">该评级仅基于图像分析。</font><font style="vertical-align: inherit;">在训练期间，不再使用任何数据，包括地理位置，人口密度等</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。敏感性为100％，特异性为80％，这意味着：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">真正感染的患者在100％的病例中得到认可。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康的患者被认为是健康的，概率为80％。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如训练历史图所示，尽管</font><font style="vertical-align: inherit;">数据集</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常有限</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但我们的网络并没有</font><i><font style="vertical-align: inherit;">受到</font></i><font style="vertical-align: inherit;">太大的训练</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
绝对准确地识别COVID-19 </font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">能力非常强，尽管误报率有点令人担忧，因为许多健康的人将被送往与真正感染的患者隔离。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在医疗应用中，尤其是在传染性疾病的情况下，平衡敏感性和特异性非常困难。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于计算机视觉和医学的深入培训，您应该始终记住，我们的预测模型可能会产生非常实际的后果-错过诊断可能会丧生。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同样，收集这些结果仅出于教育目的。</font><font style="vertical-align: inherit;">本文及其所附结果仅供参考，不适合在科学期刊上发表，也不符合</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRIPOD建立预报报告模型的规则</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">局限性，改进和未来工作</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 4.当前，人工智能和深度学习专家缺乏有效训练图像上COVID-19自动检测系统（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像源</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的高质量数据</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
，创建此类系统的主要限制之一是数据。我们只是没有足够的（可靠）数据来训练COVID-19检测器。医院挤满了COVID-19患者，但是鉴于他们的权利和隐私，</font><font style="vertical-align: inherit;">及时收集高质量的医学图像</font><font style="vertical-align: inherit;">变得</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更加困难</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我想在接下来的12-18个月内这个问题将得到解决，但目前我们对自己所拥有的感到满意。我竭尽所能（考虑到我当前的心理和身体状况），为那些有兴趣在考虑到时间和资源限制的情况下，对使用计算机视觉和深度学习对抗COVID-19的人编写指南。但我必须提醒您，我不是医学专家。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
真正的COVID-19检测器必须经过训练有素的医学专家与有经验的深度学习从业人员携手进行严格的测试。当然，此处描述的方法不适合实际使用，仅用于教育目的。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，我们必须怀疑该模型实际上可以“学习”什么。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正如我所说</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上周</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Grad-CAM指南的指导</font></a><font style="vertical-align: inherit;">下，我们的模型完全有可能研究与COVID-19不相关的模式，而仅仅是两个数据集之间的差异（即有和没有COVID-19的患者之间）。为了确认结果，需要彻底的测试和专家协助。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，未来（也是最好的）检测器将是多峰的。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
现在我们</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑</font><font style="vertical-align: inherit;">图像（例如X射线）。最好的COVID-19自动检测器应使用多个数据源，而不仅限于图像，包括患者生命指标，人口密度，地理位置等。仅图像本身通常不足以实现此类应用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我希望本指南可以作为对使用计算机视觉和深度学习自动检测COVID-19感兴趣的任何人的起点。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一步是什么？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我通常会在博客文章的结尾给出一本书或一门课程的推荐，以便您可以了解有关使用计算机视觉和深度学习的更多信息。</font><font style="vertical-align: inherit;">出于对冠状病毒严重性的尊重，我不打算这样做-现在不是时间或地点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相反，我要说的是，我们现在处于一个非常可怕的时期。</font><font style="vertical-align: inherit;">像季节一样，一切都会过去，但是现在您需要蹲下并为寒冷的冬天做准备-最坏的情况可能还没有到来。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我收到了来自PyImageSearch读者的几封信，他们希望利用这段停机时间来研究计算机视觉和深度学习，而不是在家里疯了。</font><font style="vertical-align: inherit;">这是一个有用的想法。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">摘要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在本指南中，您学习了如何使用Keras和TensorFlow在荧光图上训练COVID-19自动检测器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目前还没有高质量的，经过同行评审的COVID-19图像数据集，因此我们必须使用已有的东西，即</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub上的Joseph Cohen的存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们从Cohen数据集中选择了25张图像，仅选择前后视图（PA）和确诊。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有Kaggle透视图像（肺炎）的数据集中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择25例健康患者的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">图像</font></a><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们使用Keras和TensorFlow训练了COVID-19检测器，该检测器在测试集上证明了90-92％的准确度，100％的灵敏度和80％的特异性（鉴于我们有限的数据集）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请记住，所描述的COVID-19检测器仅用于教育目的。</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN497612/index.html">关于市场看不见的手如何将我转移到遥远地方的故事</a></li>
<li><a href="../zh-CN497614/index.html">思想实验，悖论和逻辑边界//我们注定了＃2</a></li>
<li><a href="../zh-CN497616/index.html">亚历山大·马卡罗夫（Yii）关于开源，会议和Yii的访谈</a></li>
<li><a href="../zh-CN497618/index.html">实施高度安全的远程访问的概念</a></li>
<li><a href="../zh-CN497620/index.html">编写Chrome电报警报插件</a></li>
<li><a href="../zh-CN497624/index.html">数字银行校园-实习计划结果</a></li>
<li><a href="../zh-CN497628/index.html">如何在一个小脚本或一次拉取请求的历史上浪费大量时间</a></li>
<li><a href="../zh-CN497632/index.html">Web HighLoad-我们如何管理成千上万个域的流量</a></li>
<li><a href="../zh-CN497634/index.html">彩虹着色是数学家的最好朋友</a></li>
<li><a href="../zh-CN497636/index.html">缺乏计算能力如何影响世界大战中的海战</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>