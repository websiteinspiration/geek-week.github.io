<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍💻 🤢 🗂️ ELKの実用化。logstashを構成する 🉐 👦 👂🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 多数のさまざまなログを処理する必要に直面した次のシステムの導入。ELKを選択したツールとして。この記事では、このスタックの調整に関する経験について説明します。
 
 すべての可能性を説明するという目標は設定していませんが、実際的な問題の解決に集中していきたいと考えています。これは、十分な量...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ELKの実用化。logstashを構成する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451264/"><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多数のさまざまなログを処理する必要に直面した次のシステムの導入。</font><font style="vertical-align: inherit;">ELKを選択したツールとして。</font><font style="vertical-align: inherit;">この記事では、このスタックの調整に関する経験について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべての可能性を説明するという目標は設定していませんが、実際的な問題の解決に集中していきたいと考えています。</font><font style="vertical-align: inherit;">これは、十分な量のドキュメントと既製の画像が存在する場合、多くの落とし穴があり、少なくとも私たちはそれらを見つけたという事実が原因です。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
docker-composeを使用してスタックを拡張しました。</font><font style="vertical-align: inherit;">さらに、適切に作成されたdocker-compose.ymlがあったため、ほとんど問題なくスタックを上げることができました。</font><font style="vertical-align: inherit;">そして、勝利はもうすぐであるように見えました。今、私たちは私たちのニーズに合うように少しひねり、それだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、アプリケーションからログを受信して​​処理するようにシステムを調整する試みは、移動中に成功しませんでした。</font><font style="vertical-align: inherit;">したがって、各コンポーネントを個別に調べてから、それらの関係に戻ることが重要であると判断しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そこで、logstashから始めました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境、デプロイメント、コンテナーでのLogstashの起動</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デプロイにはdocker-composeを使用します。ここで説明する実験はMacOSとUbuntu 18.0.4で行われました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オリジナルのdocker-compose.ymlに登録されたlogstashイメージはdocker.elastic.co/logstash/logstash:6.3.2 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。実験に使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
logstashを実行するために、別のdocker-compose.ymlを作成しました。</font><font style="vertical-align: inherit;">もちろん、コマンドラインからイメージを起動することは可能でしたが、docker-composeからすべてが起動されるという特定の問題を解決しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定ファイルについて簡単に</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明からわかるように、logstashは1つのチャネルで実行できます。この場合、* .confファイルまたは複数のチャネルで実行する必要があります。この場合、pipelines.ymlファイルを転送する必要があります。これにより、ファイルにリンクされます。各チャネルの.conf。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは二番目の方法を選びました。私たちには、より普遍的でスケーラブルなように思えました。そのため、pipelines.ymlを作成し、各チャネルの.confファイルを配置するパイプラインディレクトリを作成しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナー内には、別の構成ファイル-logstash.ymlがあります。触れないでそのまま使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ディレクトリの構造：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/zd/49/cizd49eci9alvlbi1fwk8nyyaky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、入力を取得するためにポート5046のtcpであると想定し、出力にはstdoutを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、最初の実行のためのこのような単純な構成です。</font><font style="vertical-align: inherit;">最初のタスクは起動することなので。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから、私たちはこのdocker-compose.ymlを持っています</font></font><br>
<br>
<pre><code class="plaintext hljs">version: '3'<font></font>
<font></font>
networks:<font></font>
  elk:<font></font>
<font></font>
volumes:<font></font>
  elasticsearch:<font></font>
    driver: local<font></font>
<font></font>
services:<font></font>
<font></font>
  logstash:<font></font>
    container_name: logstash_one_channel<font></font>
    image: docker.elastic.co/logstash/logstash:6.3.2<font></font>
    networks:<font></font>
      	- elk<font></font>
    ports:<font></font>
      	- 5046:5046<font></font>
    volumes:<font></font>
      	- ./config/pipelines.yml:/usr/share/logstash/config/pipelines.yml:ro<font></font>
	- ./config/pipelines:/usr/share/logstash/config/pipelines:ro<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここには何が見えますか？</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークとボリュームは、元のdocker-compose.yml（スタック全体が起動されるもの）から取得されたものであり、全体像に大きな影響を与えることはないと思います。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker.elastic.co/logstash/logstash:6.3.2イメージから1つのlogstashサービスを作成し、logstash_one_channelという名前を付けます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテナー内のポート5046を同じ内部ポートに転送します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャネル設定ファイル./config/pipelines.ymlをコンテナ内のファイル/usr/share/logstash/config/pipelines.ymlにマッピングします。念のため、logstashがそれを取得して読み取り専用にします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / share / logstash / config / pipelinesディレクトリにあるチャネル設定のファイルがある./config/pipelinesディレクトリを表示し、それも読み取り専用にします。</font></font></li>
</ol> <br>
<img src="https://habrastorage.org/webt/5u/s3/dw/5us3dwu8forutzwmtlfnlcjt-ic.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pipelines.ymlファイル</font></font><br>
<br>
<pre><code class="plaintext hljs">- pipeline.id: HABR<font></font>
  pipeline.workers: 1<font></font>
  pipeline.batch.size: 1<font></font>
  path.config: "./config/pipelines/habr_pipeline.conf"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、HABR識別子を持つ1つのチャネルとその構成ファイルへのパスについて説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最後にファイル「./config/pipelines/habr_pipeline.conf」</font></font><br>
<br>
<pre><code class="plaintext hljs">input {<font></font>
  tcp {<font></font>
    port =&gt; "5046"<font></font>
   }<font></font>
  }<font></font>
filter {<font></font>
  mutate {<font></font>
    add_field =&gt; [ "habra_field", "Hello Habr" ]<font></font>
    }<font></font>
  }<font></font>
output {<font></font>
  stdout {<font></font>
      <font></font>
    }<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今のところ、彼の説明には触れません。実行してみましょう。</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose up
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が見えますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテナが起動しました。</font><font style="vertical-align: inherit;">その動作を確認できます：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'13123123123123123123123213123213'</span> | nc localhost 5046
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コンテナーのコンソールに答えが表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/oy/tz/ujoytzcsc_mmiagm05savxahnzm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、同時に次も表示されます</font></font><br>
<br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：28：59,790] </font></font><font color="«CC0000»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[エラー] [logstash.licensechecker.licensereader]ライセンスサーバーからライセンス情報を取得できません{：メッセージ=&gt; "Elasticsearch Unreachable：[http：// elasticsearch：9200 /]</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [Manticore :: ResolutionFailure] </font></font><br>
<br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elasticsearch</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”、... </font><font color="«#38B9C7»"><font style="vertical-align: inherit;">logstash_one_channel |</font></font><font style="vertical-align: inherit;"> [2019-04-29T11：28：59,894] [情報] [logstash.pipeline] </font></font><font color="green"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイプラインが正常に開始されました</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {：pipeline_id =&gt; "。Monitoring-logstash" ,: thread =&gt; "＃&lt;Thread：0x119abb86 run&gt;"} </font></font><br>
<br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：28：59,988] [INFO] [logstash.agent] Pipelines running {：count =&gt; 2 ,: running_pipelines =&gt; [：HABR ,: "。Monitoring-logstash"] ,:non_running_pipelines =&gt; []}</font></font><br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：29：00,015] </font></font><font color="«CC0000»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[エラー] [logstash.inputs.metrics] X-PackはLogstashにインストールされていますが、Elasticsearchにはインストールされていません。監視機能を使用するには、ElasticsearchにX-Packをインストールしてください。他の機能が利用できる場合があります。</font></font></font><br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：29：00,526] [情報] [logstash.agent] Logstash APIエンドポイントを正常に開始しました{：port =&gt; 9600} </font></font><br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：29：04,478] [情報] [logstash.outputs.elasticsearch]ヘルスチェックを実行して、Elasticsearch接続が機能しているかどうかを確認します{：healthcheck_url =&gt; http：// elasticsearch：9200 / ,: path =&gt; "/"} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
l </font></font><font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ogstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：29：04,487]</font></font><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[警告] [logstash.outputs.elasticsearch]停止したESインスタンスへの接続を復活させようとしましたが、エラーが発生しました。 {：url =&gt;“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elasticsearch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：9200 /” ,: error_type =&gt; LogStash ::出力:: ElasticSearch :: HttpClient :: Pool :: HostUnreachableError ,: error =&gt;「Elasticsearch Unreachable：[http：// elasticsearch：9200 / ] [Manticore :: ResolutionFailure] </font></font></font><br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elasticsearch </font></font></font><font style="vertical-align: inherit;"><font color="orange"><font style="vertical-align: inherit;">»} </font></font><font color="«#38B9C7»"><font style="vertical-align: inherit;">logstash_one_channel |</font></font><font style="vertical-align: inherit;"> [2019-04-29T11：29：04,704] [情報] [logstash.licensechecker.licensereader]ヘルスチェックを実行して、Elasticsearch接続が機能しているかどうかを確認します{：healthcheck_url =&gt; http：// elasticsearch：9200 / ,: path =&gt; "/"} </font></font><br>
<font color="«#38B9C7»"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstash_one_channel |</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [2019-04-29T11：29：04,710] </font></font><font color="orange"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[警告] [logstash.licensechecker.licensereader]停止したESインスタンスへの接続を復活させようとしましたが、エラーが発生しました。 {：url =&gt; "</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elasticsearch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：9200 / "、：error_type =&gt; LogStash ::出力:: ElasticSearch :: HttpClient ::プール:: HostUnreachableError ,: error =&gt;" Elasticsearch Unreachable：[http：// elasticsearch：9200 /] [Manticore :: ResolutionFailure ] elasticsearch»}</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
そして、私たちのログは常に忍び寄っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、パイプラインが正常に開始したことを示すメッセージを緑色で強調表示し、赤色-エラーメッセージと黄色</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -elasticsearch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">への接続試行に関するメッセージを表示しています</font><font style="vertical-align: inherit;">：9200。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、画像に含まれているlogstash.confにelasticsearchの可用性のチェックが含まれているために発生します。結局のところ、logstashはElkスタックの一部として機能すると想定し、分離しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕事はできるが便利ではない。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解決策は、XPACK_MONITORING_ENABLED環境変数を使用してこのチェックを無効にすることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
docker-compose.ymlを変更して、もう一度実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">version: '3'<font></font>
<font></font>
networks:<font></font>
  elk:<font></font>
<font></font>
volumes:<font></font>
  elasticsearch:<font></font>
    driver: local<font></font>
<font></font>
services:<font></font>
<font></font>
  logstash:<font></font>
    container_name: logstash_one_channel<font></font>
    image: docker.elastic.co/logstash/logstash:6.3.2<font></font>
    networks:<font></font>
      - elk<font></font>
    environment:<font></font>
      XPACK_MONITORING_ENABLED: "false"<font></font>
    ports:<font></font>
      - 5046:5046<font></font>
   volumes:<font></font>
      - ./config/pipelines.yml:/usr/share/logstash/config/pipelines.yml:ro<font></font>
      - ./config/pipelines:/usr/share/logstash/config/pipelines:ro<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、すべてが順調です。</font><font style="vertical-align: inherit;">コンテナは実験の準備ができています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコンソールにもう一度入力できます。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'13123123123123123123123213123213'</span> | nc localhost 5046
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして見る：</font></font><br>
<br>
<pre><code class="plaintext hljs">logstash_one_channel | {<font></font>
logstash_one_channel |         "message" =&gt; "13123123123123123123123213123213",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T11:43:44.582Z,<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |            "host" =&gt; "gateway",<font></font>
logstash_one_channel |            "port" =&gt; 49418<font></font>
logstash_one_channel | }<font></font>
</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのチャネル内で作業する</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、始めました。</font><font style="vertical-align: inherit;">これで、実際に時間をかけてlogstashを直接構成できます。</font><font style="vertical-align: inherit;">ここでは、pipelines.ymlファイルには触れません。1つのチャネルを使用して何が得られるかを見ていきます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チャネル設定ファイルを使用する一般的な原則は公式ガイドに詳しく記載されて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いる</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
と言う必要があります。ロシア語で読みたい場合は、この</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用しました</font><font style="vertical-align: inherit;">（ただし、クエリ構文が古いため、これを考慮する必要があります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力セクションから順に見ていきましょう。</font><font style="vertical-align: inherit;">tcpでの作業はすでに見てきました。</font><font style="vertical-align: inherit;">ここで他に何が興味深いでしょうか？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハートビートを使用してメッセージをテストする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動テストメッセージを生成する興味深い機会があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、入力セクションにheartbeanプラグインを含める必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">input {<font></font>
  heartbeat {<font></font>
    message =&gt; "HeartBeat!"<font></font>
   }<font></font>
  } <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オンにして、受信するには1分に1回開始してください </font></font><br>
<br>
<pre><code class="plaintext hljs">logstash_one_channel | {<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T13:52:04.567Z,<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |         "message" =&gt; "HeartBeat!",<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |            "host" =&gt; "a0667e5c57ec"<font></font>
logstash_one_channel | }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もっと頻繁に取得したいので、intervalパラメータを追加する必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、10秒ごとにメッセージを受信する方法です。</font></font><br>
<br>
<pre><code class="plaintext hljs">input {<font></font>
  heartbeat {<font></font>
    message =&gt; "HeartBeat!"<font></font>
    interval =&gt; 10<font></font>
   }<font></font>
  }<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルからデータを取得する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ファイルモードを確認することにしました。</font><font style="vertical-align: inherit;">ファイルで正常に動作する場合は、少なくともローカルで使用するためにエージェントが不要になる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明によれば、動作モードは、tail -fと同様である必要があります。</font><font style="vertical-align: inherit;">新しい行を読み取るか、オプションとしてファイル全体を読み取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、取得したいもの：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのログファイルに追加される行を取得します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかのログファイルに書き込まれたデータを受け取り、そこからのデータを共有したいと考えています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstashを再起動すると、このデータが再度受信されないことを確認したいと思います。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logstashが無効になっていて、データが引き続きファイルに書き込まれている場合、それを実行すると、このデータが取得されることを確認したいと思います。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験を行うには、docker-compose.ymlに別の行を追加して、ファイルを配置するディレクトリを開きます。</font></font><br>
<br>
<pre><code class="plaintext hljs">version: '3'<font></font>
<font></font>
networks:<font></font>
  elk:<font></font>
<font></font>
volumes:<font></font>
  elasticsearch:<font></font>
    driver: local<font></font>
<font></font>
services:<font></font>
<font></font>
  logstash:<font></font>
    container_name: logstash_one_channel<font></font>
    image: docker.elastic.co/logstash/logstash:6.3.2<font></font>
    networks:<font></font>
      - elk<font></font>
    environment:<font></font>
      XPACK_MONITORING_ENABLED: "false"<font></font>
    ports:<font></font>
      - 5046:5046<font></font>
   volumes:<font></font>
      - ./config/pipelines.yml:/usr/share/logstash/config/pipelines.yml:ro<font></font>
      - ./config/pipelines:/usr/share/logstash/config/pipelines:ro<font></font>
      - ./logs:/usr/share/logstash/input<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてhabr_pipeline.confの入力セクションを変更します</font></font><br>
<br>
<pre><code class="plaintext hljs">input {<font></font>
  file {<font></font>
    path =&gt; "/usr/share/logstash/input/*.log"<font></font>
   }<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
始めます：</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose up
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログファイルを作成して記録するには、次のコマンドを使用します。</font></font><br>
<br>
<pre><code class="bash hljs"> <span class="hljs-built_in">echo</span> <span class="hljs-string">'1'</span> &gt;&gt; logs/number1.log
</code></pre><br>
<pre><code class="plaintext hljs">{<font></font>
logstash_one_channel |            "host" =&gt; "ac2d4e3ef70f",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T14:28:53.876Z,<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |         "message" =&gt; "1",<font></font>
logstash_one_channel |            "path" =&gt; "/usr/share/logstash/input/number1.log"<font></font>
logstash_one_channel | }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
うん、うまくいくよ！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、pathフィールドが自動的に追加されたことがわかります。</font><font style="vertical-align: inherit;">そのため、将来的には、それによってレコードをフィルタリングすることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一度やってみましょう：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'2'</span> &gt;&gt; logs/number1.log
</code></pre><br>
<pre><code class="plaintext hljs">{<font></font>
logstash_one_channel |            "host" =&gt; "ac2d4e3ef70f",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T14:28:59.906Z,<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |         "message" =&gt; "2",<font></font>
logstash_one_channel |            "path" =&gt; "/usr/share/logstash/input/number1.log"<font></font>
logstash_one_channel | }<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、別のファイルに：</font></font><br>
<br>
<pre><code class="bash hljs"> <span class="hljs-built_in">echo</span> <span class="hljs-string">'1'</span> &gt;&gt; logs/number2.log
</code></pre><br>
<pre><code class="plaintext hljs">{<font></font>
logstash_one_channel |            "host" =&gt; "ac2d4e3ef70f",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T14:29:26.061Z,<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |         "message" =&gt; "1",<font></font>
logstash_one_channel |            "path" =&gt; "/usr/share/logstash/input/number2.log"<font></font>
logstash_one_channel | }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いいね！</font><font style="vertical-align: inherit;">ファイルが取得され、パスは正しく、すべて問題ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
logstashを停止して再始動します。</font><font style="vertical-align: inherit;">待とう。</font><font style="vertical-align: inherit;">沈黙。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">これらのレコードを再度受け取ることはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、最も大胆な実験。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
logstashを入れて実行します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'3'</span> &gt;&gt; logs/number2.log
<span class="hljs-built_in">echo</span> <span class="hljs-string">'4'</span> &gt;&gt; logs/number1.log
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再度logstashを実行して、次を参照してください。</font></font><br>
<br>
<pre><code class="plaintext hljs">logstash_one_channel | {<font></font>
logstash_one_channel |            "host" =&gt; "ac2d4e3ef70f",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |         "message" =&gt; "3",<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |            "path" =&gt; "/usr/share/logstash/input/number2.log",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T14:48:50.589Z<font></font>
logstash_one_channel | }<font></font>
logstash_one_channel | {<font></font>
logstash_one_channel |            "host" =&gt; "ac2d4e3ef70f",<font></font>
logstash_one_channel |     "habra_field" =&gt; "Hello Habr",<font></font>
logstash_one_channel |         "message" =&gt; "4",<font></font>
logstash_one_channel |        "@version" =&gt; "1",<font></font>
logstash_one_channel |            "path" =&gt; "/usr/share/logstash/input/number1.log",<font></font>
logstash_one_channel |      "@timestamp" =&gt; 2019-04-29T14:48:50.856Z<font></font>
logstash_one_channel | }<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
やったー！</font><font style="vertical-align: inherit;">すべてが拾われました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、次のことに注意する必要があります。</font><font style="vertical-align: inherit;">logstashを含むコンテナーが削除された場合（docker stop logstash_one_channel &amp;&amp; docker rm logstash_one_channel）、何も取得されません。</font><font style="vertical-align: inherit;">コンテナー内では、読み取られたファイル位置が保存されました。</font><font style="vertical-align: inherit;">ゼロから実行する場合、新しい行のみを受け入れます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既存のファイルを読み取る</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初めてlogstashを実行したが、すでにログがあり、それらを処理したいとします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記で使用した入力セクションでlogstashを実行すると、何も得られません。</font><font style="vertical-align: inherit;">改行のみがlogstashによって処理されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既存のファイルから行をプルアップするには、入力セクションに行を追加する必要があります。</font></font><br>
<br>
<pre><code class="plaintext hljs">input {<font></font>
  file {<font></font>
    start_position =&gt; "beginning"<font></font>
    path =&gt; "/usr/share/logstash/input/*.log"<font></font>
   }<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、ニュアンスがあります。これは、logstashがまだ認識していない新しいファイルにのみ影響します。</font><font style="vertical-align: inherit;">logstashの視野に入った同じファイルの場合、彼はすでにそれらのサイズを覚えていて、今ではそれらに新しいエントリのみを取り込みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力セクションの研究について詳しく見てみましょう。</font><font style="vertical-align: inherit;">さらに多くのオプションがありますが、私たちにとって、さらなる実験のためには、今のところそれで十分です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルーティングとデータ変換</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の問題を解決してみましょう。1つのチャネルからのメッセージがあり、それらのいくつかは情報メッセージであり、一部はエラーメッセージであるとします。</font><font style="vertical-align: inherit;">タグが異なります。</font><font style="vertical-align: inherit;">一部の情報、その他のエラー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらを出力で分離する必要があります。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">情報メッセージを1つのチャネルに書き込み、エラーメッセージを別のチャネルに書き込みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、入力セクションからフィルターして出力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フィルターセクションを使用して、ハッシュ（キーと値のペア）を取得した着信メッセージを分析します。</font><font style="vertical-align: inherit;">条件によって分解します。</font><font style="vertical-align: inherit;">そして、出力セクションで、メッセージを選択し、それぞれをチャネルに送信します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grokを使用してメッセージを解析する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テキスト文字列を解析してフィールドのセットを取得するために、フィルターセクションに特別なプラグイン-grokがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで詳細な説明をここに示すことを目的とせず（これについては</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式ドキュメント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を参照</font><font style="vertical-align: inherit;">）、簡単な例を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、入力行のフォーマットを決定する必要があります。私はそれらを次のように持っています：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 INFOメッセージ1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2エラーメッセージ2 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり識別子が最初に来て、次にINFO / ERROR、次にスペースのない単語です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
難しくはありませんが、それがどのように機能するかを理解するには十分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、フィルターセクションのgrokプラグインで、行を解析するためのパターンを定義する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs">filter {<font></font>
  grok {<font></font>
    match =&gt; { "message" =&gt; ["%{INT:message_id} %{LOGLEVEL:message_type} %{WORD:message_text}"] }<font></font>
   }<font></font>
  } <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは本質的に正規表現です。</font><font style="vertical-align: inherit;">INT、LOGLEVEL、WORDなどの既製のパターンが使用されます。</font><font style="vertical-align: inherit;">それらの説明と他のパターンを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で表示でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。今、このフィルターを通過すると、文字列は3つのフィールドのハッシュになります：message_id、message_type、message_text。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらは出力セクションに表示されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ifコマンドを使用した出力セクションでのメッセージのルーティング</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
覚えているように、出力セクションでは、メッセージを2つのストリームに分割します。一部-どのiNFOをコンソールに出力し、エラーが発生した場合はファイルに出力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの投稿をどのように分割しますか？問題の状態はすでに解決策を促しています-結局のところ、選択されたmessage_typeフィールドがあり、これはINFOとERRORの2つの値しか取ることができません。 ifステートメントを使用して選択を行うのは彼にとってです。</font></font><br>
<br>
<pre><code class="plaintext hljs">if [message_type] == "ERROR" {<font></font>
        #    <font></font>
       } else<font></font>
     {<font></font>
      #    stdout<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フィールドと演算子の操作の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">公式マニュアルの</font></a><font style="vertical-align: inherit;">このセクションにあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、実際の結論自体について。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールへの出力、ここではすべてが明確です-stdout {} </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ファイルへの出力-すべてをコンテナーから実行し、結果を書き込むファイルに外部からアクセスできるようにするため、このディレクトリをdocker-composeで開く必要があります。 yml。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルの出力セクションは次のようになります。</font></font><br>
<br>
<pre><code class="plaintext hljs"> output {<font></font>
  if [message_type] == "ERROR" {<font></font>
    file {<font></font>
          path =&gt; "/usr/share/logstash/output/test.log"<font></font>
          codec =&gt; line { format =&gt; "custom format: %{message}"}<font></font>
         }<font></font>
    } else<font></font>
     {stdout {<font></font>
             }<font></font>
     }<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
docker-compose.ymlで、出力に別のボリュームを追加します。</font></font><br>
<br>
<pre><code class="plaintext hljs">version: '3'<font></font>
<font></font>
networks:<font></font>
  elk:<font></font>
<font></font>
volumes:<font></font>
  elasticsearch:<font></font>
    driver: local<font></font>
<font></font>
services:<font></font>
<font></font>
  logstash:<font></font>
    container_name: logstash_one_channel<font></font>
    image: docker.elastic.co/logstash/logstash:6.3.2<font></font>
    networks:<font></font>
      - elk<font></font>
    environment:<font></font>
      XPACK_MONITORING_ENABLED: "false"<font></font>
    ports:<font></font>
      - 5046:5046<font></font>
   volumes:<font></font>
      - ./config/pipelines.yml:/usr/share/logstash/config/pipelines.yml:ro<font></font>
      - ./config/pipelines:/usr/share/logstash/config/pipelines:ro<font></font>
      - ./logs:/usr/share/logstash/input<font></font>
      - ./output:/usr/share/logstash/output<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
始めましょう。2つのフローに分かれています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja451254/index.html">カテゴリー：鉄のIaaSプロバイダーの開梱</a></li>
<li><a href="../ja451256/index.html">理想的なレポートシステムとは何ですか。会社で何が起こっているのかを理解することは現実的ですか？</a></li>
<li><a href="../ja451258/index.html">できればキャッチ・ミー。マネージャーの手紙</a></li>
<li><a href="../ja451260/index.html">ITMO大学の10のテーマ別イベント</a></li>
<li><a href="../ja451262/index.html">スタンフォードの科学者：耳に置かれたガジェットは脳の機能を監視することができます</a></li>
<li><a href="../ja451266/index.html">現代の三次元モデリング</a></li>
<li><a href="../ja451268/index.html">jug.msk.ruでカフカストリームIQについてビクターガモフ</a></li>
<li><a href="../ja451270/index.html">B =注意、または時間を作成する方法</a></li>
<li><a href="../ja451272/index.html">すでにドアをノックしている場合：デバイスの情報を保護する方法</a></li>
<li><a href="../ja451274/index.html">完璧な武器、視点の戦争、そして天井に到達する人間</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>