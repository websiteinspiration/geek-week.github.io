<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👩🏼 🌃 🧚🏽 Cómo TeamViewer almacena las contraseñas 👩🏿‍🤝‍👩🏽 😸 👩🏿‍🤝‍👩🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TeamViewer es un programa popular para acceso remoto al escritorio. Por lo tanto, es bastante interesante ver cómo almacena las contraseñas. En resume...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cómo TeamViewer almacena las contraseñas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/globalsign/blog/496226/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wf/27/n8/wf27n8w8o_y8gj1-btavtgpezry.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TeamViewer es un programa popular para acceso remoto al escritorio. Por lo tanto, es bastante interesante ver cómo almacena las contraseñas. En resumen, las contraseñas se cifran en el registro de Windows. Para el cifrado, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se utilizan el</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algoritmo AES-128-CBC y la clave secreta </font><b><font style="vertical-align: inherit;">0602000000a400005253413100040000</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este método de guardar contraseñas y la escalada de privilegios asociados se registraron oficialmente el 7 de febrero de 2020 como la vulnerabilidad </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-18988</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (se aplica a todas las versiones de TeamViewer hasta el 14/07/1965 inclusive).</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El especialista en seguridad novato que dio a conocer esta vulnerabilidad se topó con ella por accidente. Él </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que trabajó para el cliente y durante la copia de seguridad notó las claves de registro de TeamViewer, a las que se llamó </font></font><code>OptionsPasswordAES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>SecurityPasswordAES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posteriormente, se interesó en cuáles eran estas claves y cómo TeamViewer almacena las contraseñas en general. Los importó a un sistema nuevo en una máquina virtual y lanzó el escáner </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BulletPassView</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que recopila contraseñas en el sistema. El escáner proporcionó la contraseña de TeamViewer en texto claro.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/b9/sj/cd/b9sjcd_o_eap48qc-omonzznhvo.png"></div><br>
<font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanner BulletPassView</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Luego, utilizando el programa Cheat Engine (para hackear juegos en Windows), un especialista buscó esta contraseña en la RAM y la encontró nuevamente en texto plano. Más tarde resultó que esta vulnerabilidad ya se solucionó hace dos años como</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CVE-2018-14333</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego llegó el momento de verificar de dónde se extrae la clave en la memoria del cliente de TeamViewer: desde el servidor o desde el host local. Resultó que no hay tráfico de red, pero todavía hay una contraseña en la memoria. La ingeniería inversa del binario TeamViewer usando IDA Pro,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API Monitor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> procdump</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Frida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tomó varias semanas, pero no dio nada, aunque el tipo dominó varias herramientas nuevas en el camino, por lo que el proceso no se puede llamar inútil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante la búsqueda de información, resultó que bastantes personas ya se preguntaban cómo encontrar las claves AES para los juegos de Unity en los recursos. Resultó que este es un proceso muy simple, para el cual es suficiente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usar un depurador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Seis horas después, encontró un código de TeamViewer responsable del cifrado AES:</font></font><br>
<br>
<pre><code class="plaintext hljs">=================================================<font></font>
"ServerPasswordAES"=hex:88,44,d7,0a,b2,96,2a,3d,63,16,3c,ff,e4,15,04,fb<font></font>
=================================================<font></font>
Takes 8844d70ab2962a3d63163cffe41504fb into xmm0<font></font>
Takes 5B659253E5E873D26723B7D5EAC06E3B into xmm1<font></font>
pxor xmm0, xmm1<font></font>
movdqa xmmword ptr ds:[eax],xmm0<font></font>
[eax] = D3214559577E59EF04358B2A0ED56AC0<font></font>
<font></font>
movdqa xmm1,xmmword ptr ds:[esi] | [esi] = 25C8C8BD4298BB32A57EECBDBD045BBB<font></font>
movdqa xmm0,xmmword ptr ds:[eax] | [eax] = D3214559577E59EF04358B2A0ED56AC0<font></font>
aesdec xmm0,xmm1 | One round of an AES decryption, using Equivalent Inverse Cipher, 128-bit data (state) from xmm1 with 128-bit round key from xmm2/m128; store the result in xmm1.<font></font>
movdqa xmmword ptr ds:[eax],xmm0 | [eax] = 6F AA 98 76 DE 11 7D 8D 7E B6 EE 61 2D 3D 15 52<font></font>
movdqa xmm1,xmmword ptr ds:[esi+10] | [esi+10]=[008FDE10]=79 DC 78 A6 67 50 73 8F E7 E6 57 8F 18 7A B7 06<font></font>
add esi,20 |<font></font>
dec ecx | ecx = 3<font></font>
aesdec xmm0,xmm1 | do the actual decryption<font></font>
movdqa xmmword ptr ds:[eax],xmm0 | [eax]=[008FDC90]=E3 58 26 46 A7 37 12 40 85 1C C0 43 7D 1F 1E 30<font></font>
<font></font>
Three more rounds of aesdec then<font></font>
aesdeclast xmm0, xmm1 .| Last round of AES decryption, using Equivalent Inverse Cipher, 128-bit data (state) from xmm2 with a 128-bit round key from xmm3/m128; store the result in xmm1.<font></font>
<font></font>
008FDC90 01 00 01 00 67 24 4F 43 6E 67 62 F2 5E A8 D7 04 ....g$OCngbò^¨×.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este código toma algunos bytes del registro </font></font><code>ServerPasswordAES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y los descifra con la clave obtenida por XOR </font></font><code>esi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y un </font><font style="vertical-align: inherit;">valor prescrito </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El resultado es una clave </font></font><code>0602000000a400005253413100040000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y el valor de IV es igual </font></font><code>0100010067244F436E6762F25EA8D704</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En TeamViewer 14, el nuevo motor de secuencias de comandos le permite aumentar los privilegios al </font></font><code>NT AUTHORITY\SYSTEM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leer la contraseña de TeamViewer en el registro con derechos de usuario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, también puede descifrar algunas otras contraseñas buscando en Google [SecurityPasswordAES], [OptionsPasswordAES], [SecurityPasswordExported] o [PermanentPassword] con el parámetro de búsqueda [tipo de archivo: reg]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TeamViewer ha cerrado esta vulnerabilidad en versiones recientes. </font><font style="vertical-align: inherit;">Como el programa ahora cifra las contraseñas, aún no lo han descubierto.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es496212/index.html"># 04 - Y un byte completo no es suficiente ... | Toma a BK por los cuernos</a></li>
<li><a href="../es496214/index.html">AdColony: el 89% de los editores de aplicaciones y juegos móviles usan videos promocionales</a></li>
<li><a href="../es496216/index.html">Tienda oscura: ¿ya estás pensando en esto?</a></li>
<li><a href="../es496220/index.html">Proporcionar udalenku y no arruinar. Consejos del director de TI</a></li>
<li><a href="../es496224/index.html">Primer seminario web Slurm Evening School en Kubernetes: ¿Qué, dónde, cuándo y por qué?</a></li>
<li><a href="../es496228/index.html">Desembalaje de Huawei TaiShan 2280v2</a></li>
<li><a href="../es496232/index.html">Cómo mejorar la seguridad de la automatización industrial.</a></li>
<li><a href="../es496234/index.html">La razón principal por la que no Linux</a></li>
<li><a href="../es496238/index.html">Veintiocho pasos para sobrevivir y triunfar en la crisis</a></li>
<li><a href="../es496240/index.html">Product Discovery 101 para Product Manager</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>