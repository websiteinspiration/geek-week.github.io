<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëêüèø üàÅ üí™üèΩ Apple Mac and fancy devices. LTO, SAS, Fiber Channel, eSATA üòô üëµ üëá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic of this article is to connect external devices to the Mac via SAS, Fiber Channel (FC), eSATA interfaces. Immediately make a reservation that...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apple Mac and fancy devices. LTO, SAS, Fiber Channel, eSATA</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503178/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The topic of this article is to connect external devices to the Mac via SAS, Fiber Channel (FC), eSATA interfaces. Immediately make a reservation that for solving the problem of access to such devices, there is a healthy person's way: to assemble a cheap PC, stick an HBA SAS or FC controller card there (for example, the simplest LSI adapter), connect your devices to this controller, install any Linux on the PC and work from Mac through the network. But it is banal and uninteresting. We will go the way of hardcore and will connect our devices </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directly</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the Mac.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What we will need for this: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- a decent amount of money to buy new equipment, or good luck in auctions on eBay (where, with a little effort, you can buy the required equipment of previous generations 10 times cheaper than the price list); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- this article.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To work with magnetic tape (currently almost universally represented by the LTO format), you must have a tape drive (tape drive) or a tape library of the LTO standard. This is a rather expensive device for the initial purchase (from hundreds of thousands of rubles), but worth the sane money when buying a used one. Since LTO generations change approximately every two years, and compatibility is limited to two generations, the secondary market is sufficiently saturated with efficient devices of four years or more, i.e. the year before last and beyond. If you buy a new device for commercial purposes, then you yourself understand why you need it. If you want to buy for home and family, you can consider this option as a way of archiving information (since the media itself is very cheap per 1 gigabyte).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starting with the LTO-5 generation (and in part LTO-4), magnetic tape devices are connected to the computer via SAS or FC interface (usually there are two versions of each device). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the other hand, Apple kindly provides us in our Mac USB-C interface (working via USB, Thunderbolt 3 or DisplayPort protocols), sometimes an Ethernet interface, as well as proprietary Thunderbolt 3 adapters - Thunderbolt 2 and Thunderbolt - FireWire 800. A </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
hopeless situation? Not really. Fortunately, the Thunderbolt bus can operate in PCIe mode and provide the ability to connect PCIe cards in the same way as if they were installed directly inside the computer case. Due to this, any extensions to the Mac hardware configuration are possible, there would be an appropriate adapter and drivers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The conceptually simplest way to solve the problem is to use an external box for PCIe adapters with Thunderbolt (PCIe card expansion system) interface, in which you can install a controller (Host bus adapter, HBA) SAS or FC. For example, such boxes are produced by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sonnet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and several others. There is a nuance: not every controller is suitable for us, but only having a driver for macOS. There are only a few such boards, and the cheapest and most popular (for example, the same LSI) are not included in their number. Fortunately, Sonnet had the trouble of compiling </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PCIe card </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">compatibility</font></a><font style="vertical-align: inherit;"> chart for various OSs through the Thunderbolt interface.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another solution is to purchase a ready-made converter for the Thunderbolt-SAS or Thunderbolt-FC interface converter, which, in fact, is a ready-made assembly from the box and the controller. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATTO is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> best known in this area </font><font style="vertical-align: inherit;">, but products from other companies are also found. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that not all SAS and FC controllers are certified to comply with the LTO standard, as this alone costs money. Some manufacturers directly write that the operation of their controllers with tape drives is not provided. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To complete the picture, we note that the company mLogic produces a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">device</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which is an IBM LTO-8 drive in an external case, into which the SAS to Thunderbolt 3 converter is immediately integrated. This, however, is even more exotic than all of the above, especially by the standards of our area. I doubt that this device can even be legally imported into Russia (LTO drives contain cryptographic tools, and manufacturers such as IBM and HP, for this reason, receive FSB import permission for each model). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further, we will consider for example a specific set of equipment, the owner of which the author became as a result of several successful acquisitions, but the general principle should be maintained for all options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So we have the following equipment for working with tape:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Apple Mac mini 2018 computer with macOS 10.15 Catalina, which has USB-C ports with support for Thunderbolt 3; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Apple Thunderbolt 3 / Thunderbolt 2 adapter; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Apple Thunderbolt 2 cable; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- ATTO ThunderLink SH 1068 interface converter (2 * Thunderbolt / 2 * SAS-2); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- SAS cable SFF-8088 - SFF-8088; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- tape drive LTO-5 IBM TS2350; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- LTO-5 cartridges, cleaning cartridge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now, as they say, with all this garbage we will try to take off. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the latest version of the ThunderLink SH 1068 driver from the ATTO website (apparently, for our convenience, it is combined with the SH 2068 driver and is located in section 2068, which is written only inside the driver archive itself) and the ATTO configuration utility.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7b8/7a2/a61/7b87a2a613e003ad3929a7fe456145f4.gif" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The driver, of course, needs to be installed. </font><font style="vertical-align: inherit;">Before such actions, the author advises always to do a snapshot of the APFS file system of the boot disk with the command</font></font><br>
<br>
<pre><code class="bash hljs">tmutil localsnapshot</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or a backup copy of the boot disk, if there is HFS +. </font><font style="vertical-align: inherit;">You never know what. </font><font style="vertical-align: inherit;">Then it will be easy to roll back from a snapshot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further, an inexperienced, but prudent, mind will undoubtedly be inclined to carefully read the ATTO instructions for installing the driver and execute it. </font><font style="vertical-align: inherit;">The result is tadam! </font><font style="vertical-align: inherit;">- we get the operating system hanging at the boot stage. </font><font style="vertical-align: inherit;">Here we can use a snapshot from which you can recover by calling Time machine from the recovery partition, or you can manually erase a sick kext from the kernel extension catalog from the same recovery partition (the author generally does not recommend doing this).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Why it happens? </font><font style="vertical-align: inherit;">Because Apple took care of us. </font><font style="vertical-align: inherit;">In recent versions of macOS, it‚Äôs not easy to take and embed extraneous code into the boot process. </font><font style="vertical-align: inherit;">Good Apple programmers have blocked such destructive behavior. </font><font style="vertical-align: inherit;">More precisely, they blocked it by half when the driver wait is introduced, but the driver itself is not, so everything just hangs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What should a sophisticated mind do before installing a driver? </font><font style="vertical-align: inherit;">First, give the command:</font></font><br>
<br>
<pre><code class="bash hljs">csrutil status</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If in response to it we get:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System Integrity Protection status: enabled.</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
this means that good Apple programmers take care of us, so nothing will come of us until we turn off their wonderful protection. </font><font style="vertical-align: inherit;">To do this, we reboot into the recovery partition (‚åòR), call the terminal and give the command:</font></font><br>
<br>
<pre><code class="bash hljs">csrutil <span class="hljs-built_in">disable</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, we reboot into the working system, and then we install the driver, and at the same time the ATTO configuration utility (in principle, the configuration utility is needed only for diagnostics and is not required during normal operation). In the process, when asked, we confirm the ATTO authorization in the system settings. After installation, you can again reboot into the recovery partition and give the command</font></font><br>
<br>
<pre><code class="bash hljs">csrutil <span class="hljs-built_in">enable</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apple takes care of us again. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we have a driver-supported interface to external SAS devices (or FC, if FC converter was used). But how to work with the tape at a logical level? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As is known to an inexperienced but erudite mind, any Unix-compatible system supports tape drives at the kernel level and the main system utilities, which primarily include mt (tape management) and tar (an archiver with support for working with tape archives) . However, what will the sophisticated mind specify? Any Unix-compatible system </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">except macOS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Apple worried about us by removing support for tape devices from its code.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But is it really impossible to return this code by porting the standard open source open source utilities to macOS? The good news is that Tolis has already done this (a link to which I do not provide) in its Tolis Tape Tools product. The bad news is that the said company estimates the use of the results of its work at 399 US dollars. Estimates of this fact may be different, but the author personally is not prepared to pay someone 400 bucks for a code, for the most part written by completely different people and openly used since the 1970s, and therefore this issue is for the author considers closed. (By the way, there is a free </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IOSCSITape</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><font style="vertical-align: inherit;">on the same topic </font><font style="vertical-align: inherit;">on the github in a vague state </font><font style="vertical-align: inherit;">).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortunately, there is an IBM corporation in the world whose commercial appetites are of a completely different scale, and therefore do not appear in every little thing. In particular, she developed the open-source LTFS tape file system, which is also distributed for macOS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is a nuance in that different tape device manufacturers release their own versions of LTFS that support their devices. Since the author uses the IBM tape drive, LTFS was also installed by IBM. Third-party drives may need their own LTFS ports. And there is a universal openLTFS implementation on github and homebrew.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important for us that LTFS uses the media partition function, and therefore can work with devices and cartridges, starting with the LTO-5 generation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, in our case, we download the IBM Spectrum Archive Single Drive Edition product for macOS from the IBM website, which just includes the LTFS implementation. </font><font style="vertical-align: inherit;">Without any adventures, we install the product with our own installer. </font><font style="vertical-align: inherit;">In the process, he also installs the FUSE package, and in the system settings you will have to confirm the authorization of a smart programmer named Anatol Pomozov, on which in this case the whole IBM depends. </font><font style="vertical-align: inherit;">Respect and respect for this person. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is advisable to immediately write the line: /Library/Frameworks/LTFS.framework/Versions/Current/etc/ltfs.conf.local:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">option single-drive sync_type = time @ 1</font></font><br>
</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
specifying tape mounting by default with a reset of the recording buffer after 1 minute of inactivity (default 5 minutes). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/47b/ac4/46a/47bac446a112a11830c3df9ea44dbad1.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finally, everything is ready to connect. </font><font style="vertical-align: inherit;">We connect the chain: Mac - T3 / T2 adapter - Thunderbolt cable - ATTO converter - SAS cable - tape drive (the choice of several ports on the Mac, the converter and the drive is unimportant). </font><font style="vertical-align: inherit;">Turn on the power of the converter. </font><font style="vertical-align: inherit;">Turn on the power of the tape drive. </font><font style="vertical-align: inherit;">We are waiting for the initialization of the drive by its indication. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We give the command:</font></font><br>
<br>
<pre><code class="bash hljs">ltfs -o device_list</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hooray! </font><font style="vertical-align: inherit;">We get (in the usual diagnostic manner for IBM):</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">307 LTFS14000I LTFS starting, LTFS version 2.4.2.0 (10418), log level 2. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS14058I LTFS Format Specification version 2.4.0. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS14104I Launched by "ltfs -o device_list". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS14105I This binary is built for Mac OS X. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS14106I GCC version is 4.2.1 Compatible Apple Clang 4.1 ((tags / Apple / clang-421.11.66)). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS17087I Kernel version: Darwin Kernel Version 19.4.0: Wed Mar 4 22:28:40 PST 2020; </font><font style="vertical-align: inherit;">root: xnu-6153.101.6 ~ 15 / RELEASE_X86_64. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
307 LTFS17085I Plugin: Loading "iokit" tape backend. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tape Device list :. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Device Name = 0, Vendor ID = IBM, Product ID = ULT3580-TD5, Serial Number = **********, Product Name = [ULT3580-TD5].</font></font><br>
</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We insert the cartridge, wait for the download and format:</font></font><br>
<br>
<pre><code class="bash hljs">mkltfs -d 0 -nTest -r <span class="hljs-string">"size=10M/name=.DS_Store"</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, the -d parameter specifies the number of the drive (always zero if it is the only one, but you can‚Äôt omit this command), -n is the name of the tape (you can omit it), and the -r parameter requires the contents of .DS_Store files not to exceed the size 10 megabytes, in the index (i.e., intended for directories) section of the tape instead of the data section. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The mysterious life in the tape drive has gone. We are waiting for a couple of minutes, we get the answer:</font></font><br>
<br>
<blockquote>LTFS15000I Starting mkltfs, LTFS version 2.4.2.0 (10418), log level 2.<br>
LTFS15041I Launched by ¬´mkltfs -d 0 -nTest -r size=10M/name=.DS_Store¬ª.<br>
LTFS15042I This binary is built for Mac OS X.<br>
LTFS15043I GCC version is 4.2.1 Compatible Apple Clang 4.1 ((tags/Apple/clang-421.11.66)).<br>
LTFS17087I Kernel version: Darwin Kernel Version 19.4.0: Wed Mar 4 22:28:40 PST 2020; root:xnu-6153.101.6~15/RELEASE_X86_64.<br>
LTFS15003I Formatting device '0'.<br>
LTFS15004I LTFS volume blocksize: 524288.<br>
LTFS15005I Index partition placement policy: size=10M/name=.DS_Store.<br>
<br>
LTFS11337I Update index-dirty flag (1) ‚Äî NO_BARCODE (0x0x1021081e0).<br>
LTFS17085I Plugin: Loading ¬´iokit¬ª tape backend.<br>
LTFS30810I Opening a device through iokit driver (0).<br>
LTFS30814I Vendor ID is IBM.<br>
LTFS30815I Product ID is 'ULT3580-TD5 '.<br>
LTFS30816I Firmware revision is H976.<br>
LTFS30817I Drive serial is **********.<br>
LTFS17160I Maximum device block size is 1048576.<br>
LTFS11330I Loading cartridge.<br>
LTFS30854I Logical block protection is disabled.<br>
LTFS11332I Load successful.<br>
LTFS17157I Changing the drive setting to write-anywhere mode.<br>
LTFS15049I Checking the medium (mount).<br>
LTFS30854I Logical block protection is disabled.<br>
LTFS15010I Creating data partition b on SCSI partition 1.<br>
LTFS15011I Creating index partition a on SCSI partition 0.<br>
LTFS17165I Resetting the medium's capacity proportion.<br>
LTFS11097I Partitioning the medium.<br>
LTFS11100I Writing label to partition b.<br>
LTFS11278I Writing index to partition b.<br>
LTFS30808I READ_ATTR (0x8c) returns -20501.<br>
LTFS30865I READ_ATTR returns Invalid Field in CDB (-20501) 0.<br>
LTFS30836I Cannot read attribute (-20501).<br>
LTFS11336I The attribute does not exist. Ignore the expected error.<br>
LTFS17235I Writing index of NO_BARCODE to b (Reason: Format, 0 files) **********.<br>
LTFS17236I Wrote index of NO_BARCODE (b, **********).<br>
LTFS11337I Update index-dirty flag (0) ‚Äî NO_BARCODE (0x0x1021081e0).<br>
LTFS11100I Writing label to partition a.<br>
LTFS11278I Writing index to partition a.<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS30808I READ_ATTR (0x8c) returns -20501. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS30865I READ_ATTR returns Invalid Field in CDB (-20501) 0. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS30836I Cannot read attribute (-20501). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS11336I The attribute does not exist. </font><font style="vertical-align: inherit;">Ignore the expected error. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS17235I Writing index of NO_BARCODE to a (Reason: Format, 0 files) 9068025555. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS17236I Wrote index of NO_BARCODE (a, **********). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS15013I Volume UUID is: 3802a70d-bd9f-47a6-a999-eb74ffa67fc1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS15019I Volume capacity is 1425 GB. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS30854I Logical block protection is disabled. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LTFS15024I Medium formatted successfully.</font></font><br>
</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mount the formatted tape:</font></font><br>
<br>
<pre><code class="bash hljs">sudo mkdir /Volumes/LTFS<font></font>
sudo chmod 777 /Volumes/LTFS/<font></font>
sudo ltfs /Volumes/LTFS</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We get a couple more minutes of drive operation, diagnostics:</font></font><br>
<br>
<blockquote>307 LTFS14000I LTFS starting, LTFS version 2.4.2.0 (10418), log level 2.<br>
307 LTFS14058I LTFS Format Specification version 2.4.0.<br>
307 LTFS14104I Launched by ¬´ltfs /Volumes/LTFS/¬ª.<br>
307 LTFS14105I This binary is built for Mac OS X.<br>
307 LTFS14106I GCC version is 4.2.1 Compatible Apple Clang 4.1 ((tags/Apple/clang-421.11.66)).<br>
307 LTFS17087I Kernel version: Darwin Kernel Version 19.4.0: Wed Mar 4 22:28:40 PST 2020; root:xnu-6153.101.6~15/RELEASE_X86_64.<br>
307 LTFS14063I Sync type is ¬´time¬ª, Sync time is 60 sec.<br>
307 LTFS17085I Plugin: Loading ¬´iokit¬ª tape backend.<br>
307 LTFS17085I Plugin: Loading ¬´unified¬ª iosched backend.<br>
307 LTFS14095I Set the tape device write-anywhere mode to avoid cartridge ejection.<br>
307 LTFS30810I Opening a device through iokit driver (0).<br>
307 LTFS30814I Vendor ID is IBM.<br>
307 LTFS30815I Product ID is 'ULT3580-TD5 '.<br>
307 LTFS30816I Firmware revision is H976.<br>
307 LTFS30817I Drive serial is **********.<br>
307 LTFS17160I Maximum device block size is 1048576.<br>
307 LTFS11330I Loading cartridge.<br>
307 LTFS30854I Logical block protection is disabled.<br>
307 LTFS11332I Load successful.<br>
307 LTFS17157I Changing the drive setting to write-anywhere mode.<br>
307 LTFS11005I Mounting the volume.<br>
307 LTFS30854I Logical block protection is disabled.<br>
307 LTFS17227I Tape attribute: Vendor = IBM.<br>
307 LTFS17227I Tape attribute: Application Name = LTFS.<br>
307 LTFS17227I Tape attribute: Application Version = 2.4.2.0.<br>
307 LTFS17227I Tape attribute: Medium Label =.<br>
307 LTFS17228I Tape attribute: Text Localization ID = 0x81.<br>
307 LTFS17227I Tape attribute: Barcode =.<br>
307 LTFS17227I Tape attribute: Application Format Version = 2.4.0.<br>
307 LTFS17228I Tape attribute: Volume Lock Status = 0x00.<br>
307 LTFS17227I Tape attribute: Media Pool name =.<br>
307 LTFS14111I Initial setup completed successfully.<br>
307 LTFS14112I Invoke 'mount' command to check the result of final setup.<br>
307 LTFS14113I Specified mount point is listed if succeeded.<br>
</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And here she is, our tape on the desktop, called Test (ltfs)! The nameless tape will receive the name OSXFUSE Volume 0 (ltfs). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can work with her. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/06f/956/191/06f9561919067fcc4c631f390c8b4d1e.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually, you should keep in mind that it is advisable not to abuse the viewing of the contents of the tape directories in the windows of the finder, since this is an incredibly expensive operation for LTFS, but it is better to work with terminal commands, or just dump the backup directory in bulk to the tape, as shown in the window above. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the way, there is a specially written IBM utility ltfs_copy and its clones designed for more efficient copying between tape and disk, but so far the author has not been able to find them in the public domain during surface searches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can unmount the tape with the command:</font></font><br>
<br>
<pre><code class="bash hljs">umount /Volumes/LTFS</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or just throw it in the basket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actually, there are some kind of graphic shells for macOS in nature to facilitate these actions, but are we, after such perversions, afraid to type a few lines in the terminal? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a side effect, we get the opportunity to connect external eSATA drives via a SAS / 4 * eSATA cable.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f6f/47b/ca9/f6f47bca9d7ea9928136b4757bab2c0f.jpg" alt="image"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503156/index.html">Railway stations of Russia can be equipped with Russian thermal imagers; in appearance they are very similar to Chinese</a></li>
<li><a href="../en503158/index.html">Artificial intelligence paints a picture by itself, really by itself - without learning from examples of other paintings</a></li>
<li><a href="../en503164/index.html">Gambling advertising: Google policy brief</a></li>
<li><a href="../en503172/index.html">C #: Introducing Source Code Generators</a></li>
<li><a href="../en503176/index.html">Implementation of an algorithm for determining the width of an object using an ultrasonic rangefinder and encoders in RobotC language</a></li>
<li><a href="../en503182/index.html">"I am the first blind developer in my company." Part 1</a></li>
<li><a href="../en503184/index.html">We invite you to the online meeting Zabbix</a></li>
<li><a href="../en503192/index.html">oVirt in 2 hours. Part 4. Basic operations</a></li>
<li><a href="../en503194/index.html">ISA does not forgive mistakes</a></li>
<li><a href="../en503196/index.html">450 free courses from the Ivy League</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>