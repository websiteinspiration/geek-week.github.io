<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗿 🎸 😹 React Application Performance Profiling 🤴🏼 🏍️ 🕉️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日は、React Profiler APIを使用してReactコンポーネントをレンダリングするパフォーマンスの測定について説明します。新しい実験的なインタラクショントレーシングAPIを使用して、コンポーネントとのインタラクションも評価します。さらに、User Timing APIを使用して独自の測...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>React Application Performance Profiling</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/497988/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日は、React Profiler APIを使用してReactコンポーネントをレンダリングするパフォーマンスの測定について説明します。</font><font style="vertical-align: inherit;">新しい実験的なインタラクショントレーシングAPIを使用して、コンポーネントとのインタラクションも評価します。</font><font style="vertical-align: inherit;">さらに、User Timing APIを使用して独自の測定を行います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実験のプラットフォームとしてReact Movies Queueアプリケーションを使用します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ef/452/51a/5ef45251ae6a761a3fec98e14c4eefa1.jpg"></div></a><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React Movies Queueアプリ</font></font></font></i><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React Profiler API</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React Profiler APIは、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レンダリングパフォーマンスを測定するように設計されており、アプリケーションパフォーマンスのボトルネックを特定するのに役立ちます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { Fragment, unstable_Profiler <span class="hljs-keyword">as</span> Profiler} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンポーネント</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はコールバック</font></font><code>onRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をプロパティとして</font><font style="vertical-align: inherit;">受け入れ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">プロファイルツリーのコンポーネントが更新をコミットするたびに呼び出されます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> Movies = <span class="hljs-function">(<span class="hljs-params">{ movies, addToQueue }</span>) =&gt;</span> (<font></font>
&nbsp;&nbsp;&lt;Fragment&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;Profiler id="Movies" onRender={callback}&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストの目的で、コンポーネントのパーツのレンダリングに必要な時間を測定してみましょう</font></font><code>Movies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これがどのように見えるかです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/10a/9d0/3ec/10a9d03ece4b7636876ab9b72998dea1.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReactムービーキューアプリとReact開発者</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ツールキットコールバック</font></font><code>onRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><i><font color="#999999"><font style="vertical-align: inherit;">使用したムービーリサーチ</font></font></i><font style="vertical-align: inherit;">は、レンダリングされる内容とレンダリングにかかる​​時間を表すパラメーターを受け入れます。</font><font style="vertical-align: inherit;">これには以下が含まれます。</font></font><br>
<br>
<ul>
<li><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">変更がコミットさ</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れたコンポーネントツリーの</font><font style="vertical-align: inherit;">プロパティ</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><code>phase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：または</font></font><code>mount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ツリーがマウントされている場合）、または</font></font><code>update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ツリーが再レンダリングされた場合）。</font></font></li>
<li><code>actualDuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：修正された更新のレンダリングにかかった時間。</font></font></li>
<li><code>baseDuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：キャッシュなしでサブツリー全体をレンダリングするための推定時間。</font></font></li>
<li><code>startTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Reactがこの更新のレンダリングを開始した時間。</font></font></li>
<li><code>commitTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Reactがこの更新をコミットした時刻。</font></font></li>
<li><code>interactions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：このアップデートの多くの「相互作用」。</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> callback = <span class="hljs-function">(<span class="hljs-params">id, phase, actualTime, baseTime, startTime, commitTime</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${id}</span>'s <span class="hljs-subst">${phase}</span> phase:`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Actual time: <span class="hljs-subst">${actualTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Base time: <span class="hljs-subst">${baseTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Start time: <span class="hljs-subst">${startTime}</span>`</span>);
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Commit time: <span class="hljs-subst">${commitTime}</span>`</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページを読み込み、Chromeデベロッパーツールコンソールに移動します。</font><font style="vertical-align: inherit;">そこで次のように見えるはずです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cc8/baf/9c9/cc8baf9c9500419f587874bae69acf96.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者ツールでの結果のプロファイリング</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さらに、React開発者ツールを開いてブックマークに移動し、</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントのレンダリング時間に関する情報を視覚化できます。</font><font style="vertical-align: inherit;">以下は、フレームグラフの形でこの時間を視覚化したものです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c56/138/d61/c56138d6154866df33b45014966aa2cb.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React開発者ツールでのプロファイリング結果の操作</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ここでも</font></font><code>Ranked</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、データの順序付けされたビューを提供する</font><font style="vertical-align: inherit;">ビューモードを使用したいと思い</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">その結果、レンダリングに最も時間がかかるコンポーネントがリストの一番上に表示されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/224/324/1b6/2243241b6de115dbbd7c0a94270d3868.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランク付けされたモードでのプロファイリング結果の表示</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さらに、いくつかのコンポーネントを使用して、アプリケーションのさまざまな部分で測定を行うことができます</font></font><code>Profiler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, { Fragment, unstable_Profiler <span class="hljs-keyword">as</span> Profiler} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;<font></font>
<font></font>
render(<font></font>
&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Header"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{callback}</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Header</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"Movies"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{callback}</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">Movies</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">App</span>&gt;</span></span><font></font>
);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、コンポーネントとのユーザーの相互作用を分析する方法は？</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相互作用追跡API</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションインターフェースでのユーザーインタラクション（アイテムのクリックなど）を追跡できると便利です。</font><font style="vertical-align: inherit;">これにより、「このボタンをクリックしてからDOMを更新するのにどれくらいの時間がかかりましたか？」のような興味深い質問に対する答えを見つけることができます。</font><font style="vertical-align: inherit;">さいわい、Reactには、新しい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケジューラ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッケージのInteraction Tracing APIを使用して、アプリケーションとのユーザーインタラクションを分析する実験的なサポートがあります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このドキュメントは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読むことができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーとアプリケーションの相互作用に関する情報は、説明（「ユーザーが[カートに追加]ボタンをクリックした」など）とタイムスタンプとともに提供されます。</font><font style="vertical-align: inherit;">さらに、相互作用の分析を設定する場合、コールバックが使用され、1つまたは別の相互作用に対応するアクションが実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプリケーションには</font></font><code>Add Movie To Queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、アイコンが表示される</font><font style="vertical-align: inherit;">ボタン</font><font style="vertical-align: inherit;">があります</font></font><code>+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">視聴キューに映画を追加するのに役立ちます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/75c/af2/6f775caf25ad484e73ae70354752b879.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">視聴キューに映画を追加するためのボタン</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは、アプリケーションとのこのユーザー対話のステータス更新を監視するコードの例です。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { unstable_Profiler <span class="hljs-keyword">as</span> Profiler } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom"</span>;
<span class="hljs-keyword">import</span> { unstable_trace <span class="hljs-keyword">as</span> trace } <span class="hljs-keyword">from</span> <span class="hljs-string">"scheduler/tracing"</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{<font></font>
&nbsp;&nbsp;addMovieButtonClick = <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;trace(<span class="hljs-string">"Add To Movies Queue click"</span>, performance.now(), () =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">this</span>.setState({ <span class="hljs-attr">itemAddedToQueue</span>: <span class="hljs-literal">true</span> });<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;};<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
React開発者ツールに連絡することにより、この相互作用に関する情報を記録し、その期間を知ることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d93/fc1/ea0/d93fc1ea00661d926e2f9a183b32ebb7.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション要素とのユーザーインタラクションの分析</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Interaction Tracing APIを使用して、最初のコンポーネントのレンダリングに関する情報を収集することもできます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { unstable_trace <span class="hljs-keyword">as</span> trace } <span class="hljs-keyword">from</span> <span class="hljs-string">"scheduler/tracing"</span>;<font></font>
<font></font>
trace(<span class="hljs-string">"initial render"</span>, performance.now(), () =&gt; {<font></font>
&nbsp;&nbsp;&nbsp;ReactDom.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>));<font></font>
});<font></font>
</code></pre><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b3c/4ab/310/b3c4ab310fd105fc83697e4a7b5a61fb.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネント</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><i><font color="#999999"><font style="vertical-align: inherit;">最初のレンダリングの分析</font></font></i><font style="vertical-align: inherit;"> APIの作成者は、</font><font style="vertical-align: inherit;">その使用の</font><font style="vertical-align: inherit;">他の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示します。</font><font style="vertical-align: inherit;">たとえば、非同期タスクのプロファイリングを示しています。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操り人形師</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーション要素とのユーザーインタラクションのテストを自動化するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puppeteer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の使用が面白そう</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">これは、DevToolsプロトコルを使用するユーザーインターフェースなしでChromeブラウザを制御するように設計された高レベルAPIへのアクセスを提供するNode.jsライブラリです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人形遣いを使用する場合、開発者は、ヘルパーが設けられている</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></a> <code>tracing.start()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>tracing.stop()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">収集デベロッパーツールのパフォーマンス指標に設計します。</font><font style="vertical-align: inherit;">以下は、これらのメカニズムを使用して、関心のあるボタンをクリックしたときに何が起こるかについてのデータを収集する例です。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> puppeteer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'puppeteer'</span>);<font></font>
<font></font>
<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span> (</span>) =&gt;</span> {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.launch();
&nbsp;&nbsp;<span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.newPage();
&nbsp;&nbsp;<span class="hljs-keyword">const</span> navigationPromise = page.waitForNavigation();
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">'https://react-movies-queue.glitch.me/'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.setViewport({ <span class="hljs-attr">width</span>: <span class="hljs-number">1276</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">689</span> });
&nbsp;&nbsp;<span class="hljs-keyword">await</span> navigationPromise;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">const</span> addMovieToQueueBtn = <span class="hljs-string">'li:nth-child(3) &gt; .card &gt; .card__info &gt; div &gt; .button'</span>;
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.waitForSelector(addMovieToQueueBtn);<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-comment">//  ...</span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.tracing.start({ <span class="hljs-attr">path</span>: <span class="hljs-string">'profile.json'</span> });
&nbsp;&nbsp;<span class="hljs-comment">//   </span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.click(addMovieToQueueBtn);
&nbsp;&nbsp;<span class="hljs-comment">//  </span>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> page.tracing.stop();<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">await</span> browser.close();<font></font>
})()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、ファイル</font></font><code>profile.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者のツールバーに</font><font style="vertical-align: inherit;">ロードしたので</font><font style="vertical-align: inherit;">、ボタンのクリックによってトリガーされた関数呼び出しを確認できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ed/42f/623/3ed42f62350db7d110d4ba53c80973b6.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボタンをクリックした結果の</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
分析コンポーネントのパフォーマンス分析のトピックに興味がある場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資料を</font><font style="vertical-align: inherit;">ご覧ください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザータイミングAPI</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User Timing APIを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、開発者は非常に正確なタイムスタンプを使用してカスタムパフォーマンスメトリックを作成できます。</font><font style="vertical-align: inherit;">このメソッド</font></font><code>window.performance.mark()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、名前が割り当てられているタイムスタンプを作成します。</font><font style="vertical-align: inherit;">この方法で</font></font><code>window.performance.measure()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、2つの測定間の経過時間を調べることができます。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
performance.mark(<span class="hljs-string">'Movies:updateStart'</span>);
<span class="hljs-comment">//  </span><font></font>
<font></font>
<span class="hljs-comment">//     </span>
performance.mark(<span class="hljs-string">'Movies:updateEnd'</span>);<font></font>
<font></font>
<span class="hljs-comment">//        </span>
performance.measure(<span class="hljs-string">'moviesRender'</span>, <span class="hljs-string">'Movies:updateStart'</span>, <span class="hljs-string">'Movies:updateEnd'</span>);
</code></pre><br><font style="vertical-align: inherit;"></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chromeデベロッパーツール</font><font style="vertical-align: inherit;">
タブを使用してReactアプリケーションをプロファイリングする</font></font><code>Timing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、Reactコンポーネントに関する一時的な指標が入力され</font><font style="vertical-align: inherit;">たセクションが見つかり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">Reactは、レンダリング中に、User Timing APIを使用してこの情報を公開できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed0/f07/ebb/ed0f07ebb5939839c088bc5d56e4b330.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome開発者ツールの[パフォーマンス]タブ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
User Timings APIはReact DEVアセンブリから削除され、より正確なタイムスタンプを提供するReact Profiler APIに置き換えられています。</font><font style="vertical-align: inherit;">おそらく将来的には、このAPIのサポートは、User Timing Level 3仕様をサポートするブラウザーに対して行うことで返されるでしょう。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターネットでは、User Timing APIを使用して独自のメトリックを定義するReactサイトが見つかる可能性があります。</font><font style="vertical-align: inherit;">これには、たとえばReddit</font></font><code>Time to first post title visible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メトリックとSpotifyメトリックが含まれます</font></font><code>Time to playback ready</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/18a/28a/c19/18a28ac19bf3b14050cde0731cf09e71.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reactサイトで使用される特別なメトリック</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
User Timing APIツールによって作成されたメトリック</font><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">Chrome開発者ツールの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"> Lighthouse</font></a><font style="vertical-align: inherit;">パネルに</font><font style="vertical-align: inherit;">便利に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示さ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">ます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b1/b97/961/9b1b979616527fd88511ecbadcd0a260.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lighthouseパネルの指標</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Next.js</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の最新バージョンには、</font><font style="vertical-align: inherit;">さまざまなイベントを測定するためのカスタム指標とメカニズムが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含まれて</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">います。</font><font style="vertical-align: inherit;">以下を含みます：</font></font><br>
<br>
<ul>
<li><code>Next.js-hydration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：事前レンダリングされたマークアップを作業状態にするのに必要な時間。</font></font></li>
<li><code>Next.js-nav-to-render</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ナビゲーションの開始からレンダリングの開始までの時間。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのすべての測定値が領域に表示されます</font></font><code>Timings</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/248/8c5/ee9/2488c5ee9d6bd6ccf9da8e6c36436c26.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.jsメトリックの分析</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者ツールと灯台</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lighthouseと</font></font><code>Performance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chromeデベロッパーツールバーを使用して、読み込みプロセスとReactアプリケーションのパフォーマンスを深く分析できること</font><font style="vertical-align: inherit;">を思い出します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここでは、ユーザーによるページの認識に特に影響を与えるメトリックを見つけることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce2/5c7/2ee/ce25c72eedd5c79edd5dbc1a42685b10.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページパフォーマンスの分析</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reactを使用している人は</font><font style="vertical-align: inherit;">、ページが非対話型モードになっている時間までの情報を提供</font><font style="vertical-align: inherit;">する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total Blocking Time</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（TBT）</font><font style="vertical-align: inherit;">メトリックスなど、新しいメトリックスを自由に使えるという事実を好むかもしれません。</font><font style="vertical-align: inherit;">対話モードで確実に機能することができます（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対話時間</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。実験的競合モードを使用するアプリケーションのTBTインジケータ（「前」と「後」）は次のとおりです。これを使用すると、アプリケーションが実行されている環境の機能にアプリケーションが適応するのに役立ちます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b7/074/96d/9b707496d500da0883027da3a571a030.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TBTの変更</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これらのツールは</font><font style="vertical-align: inherit;">、アプリケーションのオンライン移行を遅らせ、完了するまでに長時間かかる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など、アプリケーションのパフォーマンスのボトルネックを分析するのに役立ち</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">たとえば、これは、ボタンを押したときのアプリケーションの反応速度の分析に関連する場合があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98b/3ac/803/98b3ac8031d84cdfb9765fde2f399a70.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、Lighthouse</font><i><font color="#999999"><font style="vertical-align: inherit;">アプリケーションの分析は、</font></font></i><font style="vertical-align: inherit;"> React開発者に多くの問題に関する多くの具体的なヒントを提供します。</font><font style="vertical-align: inherit;">以下は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lighthouse 6.0での</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析結果</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">ここで、[</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未使用のJavaScriptを削除]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションが開き</font><font style="vertical-align: inherit;">、を使用してインポートできるアプリケーションに読み込まれた未使用のJavaScriptコードについてレポートします</font></font><code>React.lazy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e3/9b2/f3a/1e39b2f3a323a74744ee16e68550c6c2.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lighthouseでの</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アプリケーションの</font><i><font color="#999999"><font style="vertical-align: inherit;">分析</font></font></i><font style="vertical-align: inherit;">アプリケーションは、ハードウェアでのテストに常に役立ちます。これは、エンドユーザーが利用できる可能性が最も高いハードウェアです。</font><font style="vertical-align: inherit;">このような場合、私はしばしば</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Webpagetest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RUM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CrUX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font><font style="vertical-align: inherit;">に依存し</font><font style="vertical-align: inherit;">ています。これにより、アプリケーションのパフォーマンスに関するより完全な情報を得ることができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reactアプリケーションのパフォーマンスをどのように調査しますか？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja497968/index.html">Web開発者向けリソース：APIとUI要素</a></li>
<li><a href="../ja497980/index.html">どのくらいの水が漏れていますか？ハスケルのムーンウォークで問題を解決します</a></li>
<li><a href="../ja497982/index.html">管理に対する機能的およびプロセス的アプローチ。どのように、そして何を管理すべきか？</a></li>
<li><a href="../ja497984/index.html">CloudflareでreCAPTCHAからhCaptchaに移行する</a></li>
<li><a href="../ja497986/index.html">Webページで使用されるすべてのメモリを監視する：performance.measureMemory（）</a></li>
<li><a href="../ja497990/index.html">PostgreSQL：C言語での拡張（関数）の開発</a></li>
<li><a href="../ja497994/index.html">言語力学エスケープ分析</a></li>
<li><a href="../ja497996/index.html">免疫力を強化したくない。または人体の両極端</a></li>
<li><a href="../ja498000/index.html">自分のゲームを開発する前に知っておきたいこと</a></li>
<li><a href="../ja498002/index.html">Z3のポケットガイド</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>