<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥣 ✂️ 🧑🏻‍🤝‍🧑🏻 DEFCONカンファレンス19.ボスはハッカーもExcelを愛しています 🔙 🧗 👱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="すべてを歓迎する！誰がスペイン語を話しますか？すごい！私たちのチーム、スペインのチームが午前中にフットボールのトーナメントに参加し、このトロフィーを受け取ったので、この賞を獲得しました。アルゼンチンと南アフリカにこの賞を獲得したことをお詫びします。プレゼンテーションにお越しいただきありがとうございま...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DEFCONカンファレンス19.ボスはハッカーもExcelを愛しています</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/480370/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを歓迎する！誰がスペイン語を話しますか？すごい！私たちのチーム、スペインのチームが午前中にフットボールのトーナメントに参加し、このトロフィーを受け取ったので、この賞を獲得しました。アルゼンチンと南アフリカにこの賞を獲得したことをお詫びします。プレゼンテーションにお越しいただきありがとうございます。まず、友達のフアンコリードを紹介します。私はケマアロンソです。私たちは小さなスペインの会社Informatica64で働いています。このトピックについての会話を始める前に、私の国を紹介したいと思います。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-b/tf/lf/-btflfdt73igrodvnmcaqlqwnra.jpeg"><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スペインはすべての真ん中にある小さな国であり、ヨーロッパ、アフリカ、南アメリカの間に位置しています。これが私たちの物語だからです。スペインに行ったことがなければ、そこに行くべきです。私はマドリード出身です。美しい街で、500年前の大帝国の首都でした。マドリードに来ると外国人のように感じることはありません。マドリードに来ればすでにマドリードにいるからです。セビリアの別の都市のフアニート。この都市は、スペインがアラブの国であった7世紀、アラブ帝国の首都でした。スライドにあるゴールデンタワーは、南アメリカからヨーロッパに持ち込まれた金でできています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セビリアはフラメンコ、フェスティバル、モニュメントで非常に有名です。このスライドでは、おそらく最大の建築記念碑の1つであるスペイン広場をご存知でしょう。アナキンスカイウォーカーがセビリアに恋したら、それもできるので、この記念碑を訪れる必要があります。私たちの国を訪問することを忘れないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トリアナ出身のフアニートはセビリアにある小さな独立共和国で、聖週間で非常に有名です。住民は非常に宗教的であり、何千人もの人々が現時点で宗教公演を行っているため、もちろんその後も飲んでいます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0l/-z/yr/0l-zyrakhusiqc5rltere9eegzs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、私たちはInformatica64で働いており、おそらくあなたの多くはFocaと呼ばれる私たちが開発したツールについて聞いたことがあるでしょう。これは、情報のハッキング、侵入テストなどに使用できる無料のツールです。明日は、8時にオンラインワークショップにこのプログラムの新しい3番目のバージョンを投稿する予定です。これにより、誰でもテストに参加できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日の講演のトピックは、CitrixとWindowsターミナルサービスを使用したリモートアプリケーションについてです。企業はそれらをクラウドに配置します。私たちのプレゼンテーションでは、FOCAを使用してデータ分析を自動化し、.ica拡張子とターミナルサービスファイルを使用してアプリケーションを使用する方法について説明します。これにより、攻撃者はPTRスキャン中およびExcelファイルを使用した悪意のある攻撃中に、内部ソフトウェア、内部ネットワークを識別し、情報を組み合わせることができます。最後に、リモートExcelアプリケーションのセキュリティポリシーのトリッキーな機能を利用します。これにより、ハッカーはマクロの制限を回避し、会社の機密情報を入手することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前は、このトピック、CitrixとWindowsターミナルサービスのトピックについて多くの作業を行っていましたが、これが重要であると信じています。ハッカーがこれらのツールを使用して会社のデータに侵入することがいかに簡単かを示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google経由のリモートアプリケーションやリモート接続を探している企業のエントリポイントを見つけるのは非常に簡単です。彼らは.rdpファイルを探しています。このようなアプリケーションを公開している約2000の場所、2000のサーバーを見つけることができます。リモートの「クラウド」アプリケーションを使用する政府のサイトを見つけることもできます。それらをクリックするだけで、何が起こるかを確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qi/ei/i3/qieii365itff3ffjrmf0g83fxm8.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/nk/ci/yv/nkciyvrjzb9glhjlv-14iiefiec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BINGでもほぼ同じことができます。ファイル拡張子修飾子を使用することはできませんが、.txtファイルタイプを使用して、見つかった何千ものリモートアプリケーションのすべてのファイルに現れる修飾子を検索できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのリモートアプリケーションで発見される場所のいくつかは政府のサイトです。スライドには、米国の.milドメインにある巡回命令管理システムが表示されています。これは軍のサイトです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xu/jl/sp/xujlsppljishj5vgipw2ybfarqc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサイトに基づいてデモを作成し、ジェフと話しましたが、今日彼が修正しましたが、その理由はわかりません。しかし、別の政府のサイトであるカリフォルニア州運輸省のサイトで実験を行う準備ができています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s0/oc/12/s0oc12svfjj0zjuplxoyyklvqci.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このページを読むだけで、下部に.ica拡張子を持つファイルであるリモートRouteCleaningアプリケーションが見つかり、リンクをクリックしてダウンロードできます。何が得られるか見てみましょう。私はあなたを保証します、それは5分前に働きました。成功しませんでしたが、心配はいりません。別のデモがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この環境では、後で説明するように、心配することがたくさんあり、すべてのアプリケーションのセキュリティを確保することは非常に困難です。レオナルドディカプリオとのこのスライドは、失敗したデモンストレーションについて言及しているため、意味がありません。もう一度申し訳ありませんが、5分前に本当に機能しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちがもう一度試すと主張しますか？わかりました。カリフォルニア州交通局にブラウザでもう一度入力します。いいえ、再び機能しません。彼らはそれを修正しました！しかし、私を信じてください、5分前にすべてがうまくいきました。まあ、心配しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
続けましょう。これらの構成ファイルの最大の問題は、その冗長性です。 .txtファイルを読み取るだけで、内部IPアドレスや暗号化されたユーザーパスワードなど、あらゆる種類の情報を見つけることができます。これらの暗号化されたパスワードを解読することはできますが、匿名アカウントまたはユーザーアカウントを使用してシステムにアクセスすることはできません。ここで言及されているのは内部ソフトウェアです。したがって、これらのファイルは、そのような攻撃を組織するための情報を収集する人々にとって、APTのような標的型サイバー攻撃に最適です。インターネットで.icaファイルを簡単に検索すると、Oracleのパスワードがテキストに含まれているファイルを簡単に検出できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vq/pt/n7/vqptn7pbh0m9bgc022sspzh3apk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このため、特別なことをする必要はありません。これらのファイルには十分な情報があります。</font><font style="vertical-align: inherit;">そのため、このタイプのファイルをFOCAツールに追加することにしました。FOCAツールは、情報の収集と会社のWebサイトの識別に使用されます。</font><font style="vertical-align: inherit;">あなたはすでにプログラムの新しいバージョンを見ています、それはこれらの種類のファイルを探していてそれらから情報を抽出しているそれらの人のために明日利用可能になるでしょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/0y/lu/ow0yluzqhm1bkua_m5t-t_t3rqy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の大きな問題は、拡張子が.txtのすべてのテキストファイルであるため、攻撃者が構成ファイルを自由に変更して、オペレーティングシステムの他の部分にアクセスできることです。</font><font style="vertical-align: inherit;">サーバーでエラーメッセージが生成される可能性があるため、Citrixを使用すると、このファイルまたはアプリケーションがサーバー上にないというメッセージが表示されます。</font><font style="vertical-align: inherit;">ハッカーは、コンピュータにインストールされているアプリケーションのリスト全体を入手することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルサービスでこれを行うのは非常に簡単です。リモートアプリケーションモードでは、-0コマンドはデスクトップ全体へのアクセスを許可し、-1コマンドはアプリケーションへのアクセスのみを許可します。 RDPプロトコルの番号が6未満のバージョンは、2008のターミナルサービスでは機能しませんが、代替シェルを作成します。たとえば、このファイルはOSに属しているため、「アクセスが拒否されました」などのさまざまなエラーメッセージが表示されます。ただし、このファイルにアクセスできないということは、サーバー上ではなくコンピューター上にあることを意味します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8u/hw/wo/8uhwwodvdr_9kmag9zu43rqliay.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポジティブなことは、Citrixでも同じことができることです。ここでは、1つの接続、別の接続、別の接続などを防ぐ保護機能がないため、キャプチャを入力する必要さえありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この手順は、CACA（「AS」）と呼ばれる私たちが作成したプログラムの助けを借りて最適化できます。これは、「Citrixコンピュータアプリケーション」というフレーズの略語です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7r/41/yj/7r41yjylksdddkk5welwudrcsri.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「AS」を開き、1つの.icaファイルを選択するだけで、メモ帳の側面に「超えない」、「計算する」、「脅威の数」などの設定のリストが表示されます。スタートボタンを押すと、CACA中にコーヒーを飲むことができます。あなたのために仕事をします。彼女はスナップショットを作成しながらアプリケーションを開こうとします。これにより、彼女は作業が終了したときにエラーメッセージを表示できます。したがって、このアプリケーションがサーバー上に存在するかどうかを確認できます。アプリケーションの非常に大きなリストを使用できます。一日の初めにパソコンで「カカ」を起動すると、一日の終わりに「カカ」のアプリ一覧が表示されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターミナルサービスで実行できるもう1つのことは、「ピアノの演奏」と呼ばれます。ターミナルサービスとCitrix、特にWindows 2008には多くのリンクがあり、％SystemRoot％、％ProgramFiles％、％SystemDrive％などの変数が多すぎ、キーボードショートカットが多すぎたり、ハッカーがシステムのこのような部分に到達できるようにする関数が多数あります。これは、システム管理者でも取得できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはWindows Server 2008を本当に気に入っています。WindowsServer 2008はすべてのことに役立つからです。 OSにないアプリケーションを要求すると、Windows Server 2008はエラーとヘルプボタンのあるウィンドウを表示します。そのような礼儀を利用してみませんか？そのため、[ヘルプ]ボタンをクリックすると、IEを開いたり、[ファイルを開く]パネルをアクティブにしたり、ある種のコマンドを実行したりするための多くのリンクが記載されたマニュアルが表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ry/b8/ln/ryb8lnxbvm02dfqlrrnlnclabny.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ピアノを弾く」では、多くのキーボードショートカットを使用して、オペレーティングシステムのさまざまな部分にアクセスできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/rn/zn/hjrnzn7fjeuw3tash6eh0jgylwc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらを使用すると、ますます新しいキーボードショートカットが得られます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/u1/-h/2eu1-hnxz9qbff_vnrd6enjfqcg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深い機能は、スティッキーキー機能です。 SHIFTキーを3〜4回続けて押すと、オペレーティングシステムにより、コントロールパネルでキーを固定する機能を設定するためのメニューが表示されます。したがって、スティッキーキーを使用してコントロールパネルにアクセスできない場合でも、[保存]をクリックするだけで、オペレーティングシステムのすべてのコントロールパネルを設定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CitrixのWebサイトからデモをお見せします。これはSitrix Webサイトですが、このページはサーバーの機能を示すことを目的としているため、デモは完全に合法です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/cu/sh/rrcushzvtok_bjrmerh4vaz09ea.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー名とパスワードを入力し、Citrix環境に入ります。ここには多くのアプリケーションがあります。プレゼンテーションのテーマはExcelであるため、Excelを使用します。それでは、アプリケーションに入ってExcelを実行してみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fm/qo/x9/fmqox9tkjjmjrezlkup3yfa3awy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムはクライアントコンポーネントをロードしています。すべて準備が整いました。IEを使用します。 Excelは機能しますが、インターネットの速度が遅いだけです。最後に、Windows Server 2008ウィンドウが表示され、リモートExcelに接続しています。非常にゆっくりと……誰かがこのネットワークに対して中間者攻撃を行ったら、これをやめてください（笑）。インターネットはどうなりましたか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常に、非常に遅い...まあ、最後に！エクセルをオープンしました！ご覧のように、会社の機密財務データが画面に表示されています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nm/pe/ko/nmpeko9r7mthcedds8pxcrsshtk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルはCitrix環境で保護する必要があります。環境変数を使用してルートディレクトリに接続してみましょう。ご覧のとおり、「マイドキュメント」ライブラリを開こうとすると、「アクセスが拒否されました」というメッセージが表示されますが、多くのトリックを実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのトリックの1つは、cmdコマンドのショートカットを作成してから実行することです...機能しません！彼らはそれを修正しました。怖くない、たくさんのコンソールがあります。 powershellのショートカットを作成して実行します。ご覧のとおり、うまくいきました！これで、必要なものすべてにアクセスできます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sd/oi/fy/sdoifyzdqaon5ui5zhoofnpa68i.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、オペレーティングシステムが日々複雑になり、サーバーで公開するアプリケーションも複雑になるため、私たちにとって非常に困難です。このように、ターミナルサービスに公開するすべてのアプリケーションは、オペレーティングシステムにアクセスする方法として機能します。さらに、各アプリケーションはアクセス権限を高める方法です。複雑なアプリケーションはそのような操作に最適であり、Excelは企業がリモートアプリケーションのサービスを通じて公開するような複雑なアプリケーションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは非常に強力なツールであり、上司はExcelを非常に気に入っています。面白いグラフやチャートをたくさん作成し、大量のデータを分析し、Excelをデータベースに接続し、データマイニングを実行し、その他多くのビジネスフレンドリーなことを行うことができるからです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xq/b3/_r/xqb3_rujerxhdixxlu6pmi4kdpe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、これをすべて行うには、Visual Basic環境が必要です。 ExcelからVisual Basicを削除することはできますが、完全に異なるアプリケーションになると同時に、Excelのままではなくなります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、Visual Basicの機能のおかげで、Excelは多くのことができるということです。これを示しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ターミナルサービスを備えたWindows 2008があり、この環境ではExcel 2007を公開しています。セキュリティポリシー、アプリケーションの制限付き使用のポリシーはほぼ同じであるため、Excel 2007を使用しています。 MS Office 2010と2007のセキュリティの主な違いはサンドボックスです。つまり、インターネット上の安全でないソースからダウンロードするファイルに関連しています。ただし、ファイルをコンピューターにダウンロードすると、マクロのグループセキュリティポリシーは同じになります。未署名のマクロとサードパーティのマクロを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、この環境では、マクロを使用してExcelを実行できます。デフォルトでは、セキュリティポリシーにより、ユーザーはマクロを有効にするかどうかを選択できます。ただし、リモートサーバーでExcelを起動する場合、この選択は追加オプションであり、Visual Basic for Applicationsはローカルコンピューターではなくサーバーで機能するため、デフォルトでマクロが有効になります。これは大きな違いです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3m/ue/h2/3mueh2avz1mkmipf9a9bh22asec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、パネルを作成します。セキュリティポリシーメッセージで、マクロを使用するこのオプションがユーザーによって選択されていることがわかります-このコンテンツの使用を許可するかどうか。もちろん、「許可」をクリックすると、会社の財務実績を示すグラフが表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oz/xh/nv/ozxhnvjau-hcrxlw4wsuqoo6ras.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプリケーションに対する態度で、たとえば実行中のプロセスを表示するなど、多くのことができます。 Windows Management Instrumentationを使用すると、コマンドを使用して結果を取得し、Excelファイルに表示できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このウィンドウを閉じて、プレゼンテーションに戻ります。このデモを見ると、リモート環境でExcelのセキュリティに注意する必要があることが明らかになります。システム管理者が最初に注意する必要があるのは、-cmd.exe、-powershell、-script、-cscriptなどの特別なコンソールをブロックすることです。しかし、コンソールが多すぎて、Windows Server 2008のバックアップでは、これらすべてのコントロールパネルのコピーが作成されます。コンソールが重複しているため、これは二重の問題を引き起こします。この環境では、すべてのコンソールが禁止されています。このため、ACL ACLとセキュリティポリシーを使用しましたが、別のオペレーティングシステムからでもコンソールを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアはStevensによって提唱され、Excelファイルにdllを埋め込むことができ、このdllは広く使用されているインタープリターであるとしています。したがって、DLLからインタープリターを呼び出すだけで、サーバーにアクセスできます。それでは、禁止されたコンソールを扱う2つ目のデモを見てみましょう。 Windows Server 2008に入り、禁止されているcmd.exeを実行しようとします。このコンソールは禁止されているため、何も機能しないことがわかります。このプログラムはグループのセキュリティポリシーによってブロックされているようです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、開こうとしているExcelファイルには、ReactOSの.dllと、レジストリエディターの.dllが含まれています。したがって、「コマンドライン」ボタンを押してコマンドラインを開き、Excelファイルで.dllを抽出して実行します。実際、ReactOSコマンドインタープリターを取得します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画面に表示されているのは、ReactOSコマンドインタープリターですが、これはWindows 2008のコマンドインタープリターとほとんど同じです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cq/ia/40/cqia40wgsqxbasnpjnqrvsvyrp4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、cmd.exeはExcelファイル内の.dllであり、タスクマネージャーではEXCEL.EXEアプリケーションしか表示できないため、タスクマネージャーでは表示されません。したがって、攻撃した会社は何も疑いません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_-/bt/qh/_-btqhcrqfh3jqqvxfvbxhrk7ws.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スライドに戻りましょう。最後のデモを表示した後、次のように言うことができます。つまり、コンピューターのすべてのマクロをオフにします。しかし、実際には、セキュリティポリシーに従って、Visual Basicを無効にすると、Excelだけでなく、すべてのオフィスアプリケーションでの使用が禁止されます。つまり、Word、PowerPoint、Accessなどに影響します。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Excel設定には4つのマクロセキュリティオプションがあります。マクロを使用しない、署名付きマクロのみを使用する、特定のケースごとにユーザーの裁量でマクロを使用する、すべてのマクロを使用する。ユーザーがハッカーの場合、3つのオプションを選択します。ここで、最初のオプションを選択したExcelのデモを表示します。マクロはまったく使用しないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リモート環境で公開されたExcelファイルを再び使用するため、Windows 2008に戻り、非アクティブなインターネット接続を終了します。次に、政治家に行き、「有効にする」チェックボックスを選択してセキュリティポリシーを有効にし、ドロップダウンメニューで3番目のパラメーター「すべてのマクロに警告なし、ただしすべてのマクロを禁止する」を選択します。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4c/vc/7x/4cvc7xfp4siqopcbiwimozjvvs4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、「適用」ボタンと「OK」ボタンをクリックし、パラメータが変更されるのを待って、クライアントに戻り、Excelファイルを開きます。これは私のお気に入りのトリックの1つです。なんとかドキュメントを開くと、すべてが禁止されているため、何も実行できないことがわかります。ドキュメントのセルをクリックすると、すべてが禁止されているため、何も機能しないことがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dq/rr/qz/dqrrqzbzztd8nxmyw71a03lb3qw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、Excelには1つの機能があります-信頼できる場所の信頼できる場所があります。信頼できる場所は、セキュリティポリシーが適用されないものであるため、その場所にドキュメントを保存するだけで済みます。そしてもちろん、信頼できる場所はユーザープロファイルにあります。ファイルの信頼できる場所は、ユーザーのコンピューターまたはサーバーコンピューターに置くことができます。これは重要ではありません。ドキュメントが信頼できる場所で開かれた場合、セキュリティポリシーは適用されません。そこで、Excelブックの新しいファイルを開いたときに表示される、最も信頼できる場所の1つにドキュメントを保存しましょう。次に、操作できなかったドキュメントを閉じ、保存されたコピーを信頼できる場所から開きます。ご覧のとおり、ドキュメントが開きました。すべてが機能します！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/95/gc/7r/95gc7rlc_t8cc15v4kyid8elxdo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、マクロなし-それはマクロなしを意味します！このデモからわかるように、解決策があります-信頼できるファイルの場所はまったくありません！おそらく、このデモを見た後、システム管理者はセキュリティのために信頼できる場所から署名されたマクロのみを使用する必要があると結論付けます。つまり、別のセキュリティオプションを使用します。さて、このテーマのデモを見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、このデモでは4つのオプションから選択します。 1つのオプション-すべてのマクロ、2-特定のケースごとに、3番目のオプション-マクロなし、4-デジタル署名されたマクロのみを使用します。もう一度グループセキュリティポリシータブに移動し、[デジタル署名されたマクロのみを信頼する]オプションを有効にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[適用]、[OK]をクリックして、セキュリティポリシーの変更を確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/qo/jy/oqqojyvfg8qzshzdop-xdteftu4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、デジタル署名されたExcelファイルがあり、この署名付きファイルは信頼できる場所からのものではないため、画面にセキュリティ警告が表示されました。 [不明なコンテンツから保護する]オプションはここでオンになっており、その上に[デジタル署名の詳細を表示する]リンクがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/9i/1o/ax9i1ohjtbjwjl1vnujzkhecj_u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このリンクをクリックすると、デジタル証明書が画面に表示されます。証明書アイコンをクリックしてさらに進むと、証明書のルートに移動し、証明書自体を表示できます。ええ、証明書インポートウィザードのインストールアシスタントさえあるので、この証明書をインストールできます！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、証明書をインストールすると、ページのメッセージが変更されます。「コンテンツを許可する」と「このソースからのすべてのドキュメントを信頼する」という2行が追加されます（聴衆からの拍手）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yo/kc/la/yokclairjf89fzunzom98aoi60s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションを使用すると、第三次世界大戦を開始できるため、これは非常に重要です。ドキュメントにデジタル証明書をインストールできるとします。これらの証明書の詳細には、取り消されたCRL証明書のリストへのリンクが含まれており、CRLリンクはHTTPおよびLDAPへのリンクにすることができ、HTTPリンクはSQLインジェクションなどの攻撃、つまりSQLコードの埋め込みに使用できます。したがって、CAをインストールし、デジタル署名付きのExcelファイルを会社に関係のある誰かに送信し、彼がそれを開いた場合、最終的に、ドキュメントはCRLに接続しようとします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、たとえば中国最高裁判所のWebサイトでSQLインジェクションの脆弱性を見つけた場合、DHSコンピューターの1つにそのようなコンピューターのユーザーにファイルを送信することにより、サードパーティのCA証明書をインストールできます。</font><font style="vertical-align: inherit;">あなたはFOCAを使用してそのようなコンピュータで働いている人を正確に知ることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i2/-z/ha/i2-zha056nrm8tanrrl-kr4ke2a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、戦争を開始するには、次のものが必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DHSコンピュータの脆弱性を見つける。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSにアクセスします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無関係なCAをExcelファイルに挿入する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRLに攻撃URLを作成して、たとえば中国を攻撃します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デジタル署名されたExcelファイルをDHSコンピューターに送信します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん冗談ですが、次のデモでは、リモートアプリケーションを使用してユーザーのコンピューターでこの手法を使用する方法の結果を確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t_/dr/cl/t_drcl0rnjimbjyxktz_9o375y8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、リモートアプリケーションを使用する場合、このような問題を回避するには、まず、リモートアプリケーションへの接続の信頼性を確認し、リモートソースから受信したすべてのドキュメントのセキュリティを確認する必要があります。 Excelファイルや、公開するその他のすべてのアプリケーションには、セキュリティ警告をまったく使用しないでください。誰も信用しないでください。ユーザープロファイルで信頼できるファイルの場所を使用しないでください。リモートユーザーとの共有アクセスを使用しないでください。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/yk/vd/uiykvdbo0vabx2pywa79tnnm2jy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TS Webアクセスターミナルサービスでもう1つ興味深いことがわかりました。ほとんどの管理者は、[TS Webアクセスに隠す]オプションを使用しています。</font><font style="vertical-align: inherit;">つまり、ターミナルサービスで公開されたリモートアプリケーションがある場合、このアプリケーションはHTTPパネルに表示されます。</font><font style="vertical-align: inherit;">しかし、このアプリケーションはまだ公開されているので、その名前を知っていれば、それに接続できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちと一緒にいてくれてありがとう！</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Xi0qUZCz6F0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">広告のビット:)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いつもご利用いただきありがとうございます。私たちの記事は好きですか？もっと面白い資料を見たいですか？私たちが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発した</font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エントリーレベルサーバーのユニークなアナログで</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ある</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">$ 4.99から</font></a><font style="vertical-align: inherit;">、注文またはお友達</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">への開発者向けクラウドベースVPSの開発者</font></a><font style="vertical-align: inherit;">への推奨によって私たちをサポートして</font><b><font style="vertical-align: inherit;">ください：</font></b></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS（KVM）E5-2697 v3（6コア）10GB DDR4 480GB SSD 1Gbpsの真実19ドルから、またはサーバーを分割する方法？</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプションは、RAID1およびRAID10、最大24コア、最大40GB DDR4で利用可能です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xdは、アムステルダムのEquinix Tier IVデータセンターで2倍安いですか？</font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">オランダでは</font></b><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">199ドルのIntel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV</font></a></b><font style="vertical-align: inherit;">が</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">2つ</font></a></b><font style="vertical-align: inherit;">だけあり</font><b><font style="vertical-align: inherit;">ます！</font></b></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デルR420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99から！</font></font></b></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">インフラストラクチャビルディングの構築方法</font></a><font style="vertical-align: inherit;">について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">お</font></a><font style="vertical-align: inherit;">読みください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Dell R730xd E5-2650 v4サーバーを使用するクラスcは、1ペニーで9,000ユーロかかりますか？</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja480356/index.html">あなたが会ったことがない有用なPythonのヒント</a></li>
<li><a href="../ja480358/index.html">ReactアプリケーションでのCSS-in-JSライブラリの隠れた価格</a></li>
<li><a href="../ja480362/index.html">ロシアのドイツ枯渇六フッ化ウランの冒険。パート1.歴史と濃縮技術</a></li>
<li><a href="../ja480364/index.html">依存性注入の形而上学</a></li>
<li><a href="../ja480368/index.html">C / C ++でメモリリークをキャッチする</a></li>
<li><a href="../ja480374/index.html">React RoboticsのDogBotは建設業界で革命を追求します</a></li>
<li><a href="../ja480376/index.html">コンピュータゲームから秘密のメッセージまで：ビニールリリースでイースターエッグについて話し合う</a></li>
<li><a href="../ja480378/index.html">データサイエンススキルを高めるための14のオープンソースプロジェクト（簡単、通常、難しい）</a></li>
<li><a href="../ja480386/index.html">バージョン管理システムでのネットワーク機器とそのストレージの自動バックアップ</a></li>
<li><a href="../ja480388/index.html">HACKTIVITY 2012カンファレンス。ビッグバン理論：強化されたセキュリティにおける侵入テストの進化。パート1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>