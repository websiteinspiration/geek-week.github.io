<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›· ğŸ‘©â€ğŸš’ ğŸ…¿ï¸ åœ¨Cï¼ƒä¸­ä»Excelå¿«é€Ÿè®¡ç®—å…¬å¼ ğŸ ğŸ¦” ğŸ‚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ‚¨å¤šä¹…æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·å¬åˆ°ä»–ä»¬å°†æ•°æ®å‘é€åˆ°Excelæˆ–è¦æ±‚æ‚¨ä»¥Excelå…¼å®¹æ ¼å¼å¯¼å…¥æˆ–ä¸Šä¼ çš„ä¿¡æ¯ï¼Ÿæˆ‘ç¡®ä¿¡åœ¨å¤§å¤šæ•°é¢†åŸŸï¼ŒExcelæ˜¯æœ€æµè¡Œï¼ŒåŠŸèƒ½æœ€å¼ºå¤§ä¸”åŒæ—¶åˆç®€å•ä¾¿æ·çš„å·¥å…·ä¹‹ä¸€ã€‚ä½†æ˜¯ï¼Œæœ€æ£˜æ‰‹çš„é—®é¢˜æ€»æ˜¯å°†æ­¤ç±»æ•°æ®ä¸å„ç§è‡ªåŠ¨åŒ–ç³»ç»Ÿé›†æˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬çš„å›¢é˜Ÿè¢«è¦æ±‚è€ƒè™‘ä½¿ç”¨è‡ªå®šä¹‰Excelæ–‡ä»¶ä¸­çš„è®¾ç½®æ‰§è¡Œæ•°æ®è®¡ç®—çš„å¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>åœ¨Cï¼ƒä¸­ä»Excelå¿«é€Ÿè®¡ç®—å…¬å¼</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/arcadia/blog/498032/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¤šä¹…æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·å¬åˆ°ä»–ä»¬å°†æ•°æ®å‘é€åˆ°Excelæˆ–è¦æ±‚æ‚¨ä»¥Excelå…¼å®¹æ ¼å¼å¯¼å…¥æˆ–ä¸Šä¼ çš„ä¿¡æ¯ï¼Ÿ</font><font style="vertical-align: inherit;">æˆ‘ç¡®ä¿¡åœ¨å¤§å¤šæ•°é¢†åŸŸï¼ŒExcelæ˜¯æœ€æµè¡Œï¼ŒåŠŸèƒ½æœ€å¼ºå¤§ä¸”åŒæ—¶åˆç®€å•ä¾¿æ·çš„å·¥å…·ä¹‹ä¸€ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œæœ€æ£˜æ‰‹çš„é—®é¢˜æ€»æ˜¯å°†æ­¤ç±»æ•°æ®ä¸å„ç§è‡ªåŠ¨åŒ–ç³»ç»Ÿé›†æˆåœ¨ä¸€èµ·ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬çš„å›¢é˜Ÿè¢«è¦æ±‚è€ƒè™‘ä½¿ç”¨è‡ªå®šä¹‰Excelæ–‡ä»¶ä¸­çš„è®¾ç½®æ‰§è¡Œæ•°æ®è®¡ç®—çš„å¯èƒ½æ€§ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/8g/to/wx/8gtowxbs0dnpmjvr59epns8b0sq.jpeg" alt="åœ¨Cï¼ƒä¸­ä»Excelå¿«é€Ÿè®¡ç®—å…¬å¼"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨éœ€è¦é€‰æ‹©ä¸€ç§ç”¨äºå¤„ç†Excelæ–‡ä»¶çš„é«˜æ•ˆåº“ï¼Œæˆ–è€…æ­£åœ¨å¯»æ‰¾ä¸€ç§ä½¿ç”¨æ–¹ä¾¿çš„å·¥å…·æ¥ç®¡ç†å’Œå¯è§†åŒ–å…¬å¼çš„å¤æ‚è´¢åŠ¡ï¼ˆä¸ä»…æ˜¯ï¼‰æ•°æ®è®¡ç®—è§£å†³æ–¹æ¡ˆï¼Œæ¬¢è¿ä½¿ç”¨ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç ”ç©¶å…¬å¸æ–°é¡¹ç›®çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªéå¸¸æœ‰è¶£çš„è§‚ç‚¹ï¼šâ€œå¼€å‘çš„è§£å†³æ–¹æ¡ˆåº”è¯¥èƒ½å¤Ÿåœ¨æ›´æ”¹é…ç½®æ—¶è®¡ç®—äº§å“ï¼ˆå³é˜³å°ï¼‰çš„æˆæœ¬ï¼Œå¹¶åœ¨ç•Œé¢ä¸Šç«‹å³æ˜¾ç¤ºæ–°æˆæœ¬ã€‚å¿…é¡»å…·æœ‰ä¸‹è½½å…·æœ‰æ‰€æœ‰è®¡ç®—åŠŸèƒ½å’Œç»„ä»¶ä»·æ ¼æ¸…å•çš„Excelæ–‡ä»¶çš„èƒ½åŠ›ã€‚â€å®¢æˆ·éœ€è¦å¼€å‘ä¸€ä¸ªé—¨æˆ·ç½‘ç«™ï¼Œä»¥æ ¹æ®å°ºå¯¸ï¼Œå½¢çŠ¶ï¼Œç»ç’ƒå’Œæ‰€ç”¨ææ–™çš„ç±»å‹ï¼Œç´§å›ºä»¶çš„ç±»å‹ä»¥åŠè®¸å¤šå…¶ä»–ç›¸å…³å‚æ•°ï¼ˆç”¨äºè®¡ç®—ç¡®åˆ‡çš„ç”Ÿäº§æˆæœ¬å’Œå¯é æ€§æŒ‡æ ‡ï¼‰æ¥è®¾è®¡é˜³å°çš„é…ç½®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯¹è¾“å…¥è¦æ±‚è¿›è¡Œäº†å½¢å¼åŒ–å¤„ç†ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°äº†è§£åœ¨ä½•ç§æƒ…å†µä¸‹éœ€è¦è§£å†³æ­¤é—®é¢˜ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ”¹é˜³å°å‚æ•°æ—¶ï¼Œå¯ä»¥åœ¨ç•Œé¢ä¸Šå¿«é€Ÿè®¡ç®—ä»·æ ¼ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿«é€Ÿè®¡ç®—è®¾è®¡æ•°æ®ï¼ŒåŒ…æ‹¬è®¸å¤šä¸åŒçš„é˜³å°é…ç½®å’Œå•ç‹¬çš„è¦çº¦ï¼Œç”±å•ç‹¬çš„è®¡ç®—æ–‡ä»¶æä¾›ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»é•¿è¿œæ¥çœ‹-ä½¿ç”¨å„ç§æ¶ˆè€—èµ„æºçš„æ“ä½œï¼ˆä¼˜åŒ–å‚æ•°çš„ä»»åŠ¡ç­‰ï¼‰è¿›è¡ŒåŠŸèƒ½å¼€å‘</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰è¿™äº›éƒ½åœ¨é€šè¿‡APIè¾“å‡ºçš„è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œå› ä¸º </font><font style="vertical-align: inherit;">æ‰€æœ‰å…¬å¼éƒ½æ˜¯å®¢æˆ·çš„çŸ¥è¯†äº§æƒï¼Œç¬¬ä¸‰æ–¹ä¸åº”çœ‹åˆ°ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å³°å€¼è¾“å…¥æ•°æ®æµï¼šç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é¢‘ç¹ï¼Œå¿«é€Ÿåœ°æ›´æ”¹å‚æ•°ä»¥é€‰æ‹©äº§å“é…ç½®ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¬èµ·æ¥å¾ˆä¸å¯»å¸¸ï¼Œè€Œä¸”å¾ˆè¯±äººï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº¤é’¥åŒ™è§£å†³æ–¹æ¡ˆå’Œæ•°æ®å‡†å¤‡</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§£å†³å¤æ‚é—®é¢˜çš„ä»»ä½•ç ”ç©¶éƒ½å§‹äºåœ¨StackOverflowï¼ŒGitHubå’Œè®¸å¤šå¯»æ±‚ç°æˆè§£å†³æ–¹æ¡ˆçš„è®ºå›ä¸Šå†²æµªã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€‰æ‹©äº†å‡ ç§ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œè¿™äº›è§£å†³æ–¹æ¡ˆæ”¯æŒä»Excelæ–‡ä»¶è¯»å–æ•°æ®ï¼Œå¹¶èƒ½å¤ŸåŸºäºåº“ä¸­æŒ‡å®šçš„å…¬å¼æ‰§è¡Œè®¡ç®—ã€‚</font><font style="vertical-align: inherit;">è¿™äº›åº“ä¸­æœ‰å®Œå…¨å…è´¹çš„è§£å†³æ–¹æ¡ˆå’Œå•†ä¸šå¼€å‘ã€‚&nbsp;</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾ä¹¦é¦†</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é“¾æ¥</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡çŒ®èµ„æ–™</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰§ç…§</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/JanKallman/EPPlus</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/JanKallman/EPPlus/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNUå›¾ä¹¦é¦†é€šç”¨å…¬å…±è®¸å¯è¯&nbsp;</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/EPPlusSoftware/EPPlus</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/EPPlusSoftware/EPPlus/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polyforméå•†ä¸šè®¸å¯è¯1.0.0ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.epplussoftware.com/LicenseOverview</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰&nbsp;</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éè¥åˆ©ç»„ç»‡</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/tonyqus/npoi</font></font></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/tonyqus/npoi/wiki</font></font></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apacheè®¸å¯2.0</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°–å¡”</font></font></strong></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.e-iceblue.com/Introduce/excel-for-net-introduce.html</a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.e-iceblue.com/Tutorials/Spire.XLS/Spire.XLS-Program-Guide/Spire.XLS-Program-Guide-Content.html</a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.e-iceblue.com/Tutorials/Licensing/License-Agreement.html</a>&nbsp;</td>
</tr>
<tr>
<td><strong>Excel Interop</strong><i>(Microsoft.Office.Interop.Excel)</i></td>
<td>n/a</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">docs.microsoft.com/ru-ru/dotnet/api/microsoft.office.interop.excel._workbook?view=excel-pia</a></td>
<td><i>  Excel     </i></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹ä¸€æ­¥æ˜¯ç¼–å†™è´Ÿè½½æµ‹è¯•å¹¶æµ‹é‡æ¯ä¸ªåº“çš„è¿è¡Œæ—¶é—´ã€‚ä¸ºæ­¤ï¼Œè¯·å‡†å¤‡æµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„Excelæ–‡ä»¶ï¼Œä¸ºè¾“å…¥å‚æ•°å®šä¹‰10ä¸ªå•å…ƒæ ¼ï¼Œå¹¶å®šä¹‰</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ä¸ª</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¬å¼</font><font style="vertical-align: inherit;">ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®°ä½è¿™ä¸€åˆ»</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ä»¥è·å¾—ä½¿ç”¨æ‰€æœ‰è¾“å…¥å‚æ•°çš„ç»“æœã€‚åœ¨å…¬å¼ä¸­ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨å„ç§è®¡ç®—å¤æ‚æ€§çš„æ‰€æœ‰å¯èƒ½çš„æ•°å­¦å‡½æ•°ï¼Œå¹¶ä»¥æ£˜æ‰‹çš„æ–¹å¼å°†å®ƒä»¬ç»„åˆã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› ä¸ºè¿™ä¹Ÿä¸é‡‘é’±ï¼ˆäº§å“çš„æˆæœ¬ï¼‰æœ‰å…³ï¼Œé‡è¦çš„æ˜¯è¦çœ‹ç»“æœçš„å‡†ç¡®æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨</font><strong><font style="vertical-align: inherit;">Excel Interop</font></strong><font style="vertical-align: inherit;">ä½œä¸ºå‚è€ƒè·å¾—çš„ç»“æœå€¼</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› ä¸ºä»¥è¿™ç§æ–¹å¼è·å¾—çš„æ•°æ®æ˜¯é€šè¿‡Excelæ ¸å¿ƒè®¡ç®—çš„ï¼Œç­‰äºå®¢æˆ·åœ¨å¼€å‘å…¬å¼å’Œæ‰‹åŠ¨è®¡ç®—æˆæœ¬æ—¶çœ‹åˆ°çš„å€¼ã€‚&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œä¸ºå‚è€ƒè¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨çº¯Cï¼ƒæ‰‹åŠ¨ç¼–å†™çš„æœ¬æœºä»£ç æ¥æ˜¾ç¤ºç”¨Excelç¼–å†™çš„ç›¸åŒå…¬å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¿»è¯‘çš„åˆå§‹æµ‹è¯•å…¬å¼ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">public double Execute(double[] p)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return Math.Pow(p[0] * p[8] / p[4] * Math.Sin(p[5]) * Math.Cos(p[2]) +<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Math.Abs(p[1] - (p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Math.Sqrt(p[0] * p[0] + p[1] * p[1]) / 2.0 * Math.PI, p[9]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å½¢æˆNæ¬¡è¿­ä»£çš„éšæœºè¾“å…¥æ•°æ®æµï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨10,000ä¸ªå‘é‡ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¼€å§‹å¯¹æ•´ä¸ªæµä¸Šè¾“å…¥å‚æ•°çš„æ¯ä¸ªå‘é‡è¿›è¡Œè®¡ç®—ï¼Œè·å–ç»“æœå¹¶æµ‹é‡åº“åˆå§‹åŒ–å’Œå¸¸è§„è®¡ç®—çš„æ—¶é—´ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¯”è¾ƒç»“æœçš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæŒ‡æ ‡-æ ‡å‡†åå·®å’Œå…·æœ‰ä¸€å®šç²¾åº¦æ­¥é•¿Îµçš„åŒ¹é…å€¼çš„ç™¾åˆ†æ¯”ã€‚å¦‚æœæ‚¨éšæœºç”Ÿæˆä¸€ä¸ªè¾“å…¥å€¼åˆ—è¡¨ï¼Œå°æ•°ç‚¹åæœ‰ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œåˆ™å¿…é¡»ç¡®å®šè¾“å…¥å‚æ•°çš„å‡†ç¡®æ€§-è¿™å°†ä½¿æ‚¨è·å¾—æ­£ç¡®çš„ç»“æœã€‚å¦åˆ™ï¼Œéšæœºæ•°å¯èƒ½å…·æœ‰æ•°é‡çº§çš„è¾ƒå¤§å·®å¼‚-è¿™ä¼šæå¤§åœ°å½±å“ç»“æœçš„å‡†ç¡®æ€§å¹¶å½±å“ç»“æœè¯¯å·®çš„ä¼°è®¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› ä¸ºæœ€åˆï¼Œæˆ‘ä»¬å‡è®¾éœ€è¦ä»¥ææ–™æˆæœ¬çš„æ’å®šå€¼ä»¥åŠæ¥è‡ªä¸åŒçŸ¥è¯†é¢†åŸŸçš„ä¸€äº›å¸¸æ•°è¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ¥å—æ‰€æœ‰è¾“å…¥å‚æ•°çš„å€¼éƒ½å°†ç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸‰ä½ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ä¸ºæ¯ä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªæœ‰æ•ˆçš„å€¼èŒƒå›´ï¼Œå¹¶ä»…ä½¿ç”¨å®ƒä»¬æ¥ç”Ÿæˆéšæœºå€¼ï¼Œä½†æ˜¯ç”±äºæµ‹è¯•å…¬å¼æ˜¯åœ¨æ²¡æœ‰ä»»ä½•æ•°å­¦å’Œç‰©ç†ä¾æ®çš„æƒ…å†µä¸‹éšæœºç¼–è¯‘çš„ï¼Œå› æ­¤ä¸å¯èƒ½åœ¨åˆç†çš„æ—¶é—´å†…ä¸ºæ‰€æœ‰10ä¸ªå‚æ•°è®¡ç®—å‡ºå¦‚æ­¤èŒƒå›´çš„å€¼ã€‚å› æ­¤ï¼Œåœ¨è®¡ç®—ä¸­æœ‰æ—¶å¯èƒ½ä¼šè·å¾—è®¡ç®—è¯¯å·®ã€‚åœ¨è®¡ç®—å‡†ç¡®æ€§æŒ‡æ ‡æ—¶ï¼Œæˆ‘ä»¬å·²ç»æ’é™¤äº†æ­¤ç±»è¾“å…¥æ•°æ®å‘é‡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå°†æ­¤ç±»é”™è¯¯è§†ä¸ºå•ç‹¬çš„ç‰¹å¾ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµ‹è¯•æ¶æ„&nbsp;</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºæ¯ä¸€ä¸ªå•ç‹¬çš„åº“ï¼Œå®ƒè‡ªå·±çš„ç±»å·²ç»åˆ›å»ºå®ç°æ¥å£</font></font><code>ITestExecutor </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå…¶åŒ…æ‹¬3ç§æ–¹æ³•- </font></font><code>SetUp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>Execute </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>TearDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">public interface ITestExecutor<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//      <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;void SetUp();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//   ,           <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;double Execute(double[] p);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;//    ,      <font></font>
&nbsp;&nbsp;&nbsp;&nbsp;void TearDown();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ–¹æ³•</font></font><code>SetUp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>TearDown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æµ‹è¯•åº“çš„è¿‡ç¨‹ä¸­ä»…ä½¿ç”¨ä¸€æ¬¡ï¼Œå¹¶ä¸”åœ¨å¯¹æ•´ä¸ªè¾“å…¥æ•°æ®é›†è¿›è¡Œæ—¶é—´è®¡ç®—æ—¶ä¸è€ƒè™‘è¿™äº›æ–¹æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæµ‹è¯•ç®—æ³•å½’ç»“ä¸ºä»¥ä¸‹å†…å®¹ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®å‡†å¤‡ï¼ˆæˆ‘ä»¬å½¢æˆç»™å®šç²¾åº¦çš„è¾“å…¥å‘é‡æµï¼‰ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºç»“æœæ•°æ®åˆ†é…å†…å­˜ï¼ˆæ¯ä¸ªåº“ä¸€ä¸ªç»“æœæ•°ç»„ï¼Œä¸€ä¸ªåŒ…å«é”™è¯¯æ•°é‡çš„æ•°ç»„ï¼‰ï¼›&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“çš„åˆå§‹åŒ–ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡å°†ç»“æœä¿å­˜åœ¨é¢„å…ˆå‡†å¤‡å¥½çš„æ•°ç»„ä¸­å¹¶è®°å½•æ‰§è¡Œæ—¶é—´æ¥è·å–æ¯ä¸ªåº“çš„è®¡ç®—ç»“æœï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨åº“ä»£ç å®Œæˆå·¥ä½œï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®åˆ†æï¼š</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥ç®—æ³•çš„å›¾å½¢è¡¨ç¤ºå¦‚ä¸‹ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/yg/e0/slyge0dloc1dednqql-hgga6um4.png" alt="Excelæ”¯æŒåº“çš„æ€§èƒ½å’Œå‡†ç¡®æ€§æµ‹è¯•çš„æµç¨‹å›¾"></div><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€æ¬¡è¿­ä»£çš„ç»“æœ</font></font></h1><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡æ•°</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æœº</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å’Œ</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éè¥åˆ©ç»„ç»‡</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°–å¡”</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exceläº’æ“ä½œ</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆå§‹åŒ–æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">266</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">632</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1653</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜ŸæœŸä¸‰ </font><font style="vertical-align: inherit;">1æ¬¡é€šè¿‡çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0002</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.4086</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6847</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.9782</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38.8423</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹³å‡ </font><font style="vertical-align: inherit;">åå·®</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000394</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000395</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000237</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,000631</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†ç¡®æ€§</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99.99ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99.92ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99.97ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99.84ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤±è¯¯</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.94ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.94ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.52ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.94ï¼…</font></font></td>
</tr>
</tbody></table></div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆå°†EPPlus 5å’ŒEPPlus 4çš„ç»“æœç»“åˆèµ·æ¥ï¼Ÿ</font></font></b>
                        <div class="spoiler_text">      EPPlus      .    ,       ,         .    ,         .     EPPlus 5     ,       .          ,      EPPlus,    .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æµ‹è¯•çš„ç¬¬ä¸€æ¬¡è¿­ä»£æ˜¾ç¤ºå‡ºè‰¯å¥½çš„ç»“æœï¼Œå…¶ä¸­åº“ä¸­çš„é¢†å¯¼ç«‹å³å¯è§ã€‚</font><font style="vertical-align: inherit;">ä»ä»¥ä¸Šæ•°æ®å¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æƒ…å†µä¸‹çš„ç»å¯¹é¢†å…ˆè€…æ˜¯EPPlusåº“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸æœ¬åœ°ä»£ç ç›¸æ¯”ï¼Œç»“æœå¹¶ä¸ä»¤äººå°è±¡æ·±åˆ»ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ç”Ÿæ´»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æ¥å¯ä»¥åœæ­¢çš„ï¼Œä½†æ˜¯åœ¨ä¸å®¢æˆ·äº¤è°ˆä¹‹åï¼Œæœ€åˆçš„ç–‘è™‘é€æ¸è”“å»¶ï¼šç»“æœå¤ªå¥½äº†ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zp/7s/ry/zp7sryxdmhkg5rp8xfhwf537kti.jpeg"></div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨Spireåº“çš„åŠŸèƒ½</font></font></b>
                        <div class="spoiler_text">     Spire  ,             InvalidCastException.      ,          Excel-    ,     ,      ,     .                    try...catch.       ,         .<br>
</div>
                    </div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€æ¬¡æµ‹è¯•é‡å¤</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šé¢ï¼Œæˆ‘è¯·æ‚¨æè¯·æ³¨æ„åœ¨å–å¾—ç»“æœä¸­èµ·é‡è¦ä½œç”¨çš„ä¸€ç‚¹ã€‚æˆ‘ä»¬æ€€ç–‘å®¢æˆ·çš„çœŸå®Excelæ–‡ä»¶ä¸­ä½¿ç”¨çš„å…¬å¼ä¸åŸå§‹æ•°æ®ç›¸å·®å¾ˆè¿œï¼Œå†…éƒ¨å­˜åœ¨è®¸å¤šä¾èµ–æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸æ€€ç–‘è¿™ä¼šä¸¥é‡å½±å“æŒ‡æ ‡ã€‚ä½†æ˜¯ï¼Œæœ€åˆï¼Œåœ¨ç¼–è¯‘æµ‹è¯•æ•°æ®æ—¶ï¼Œæˆ‘æ²¡æœ‰é¢„è§åˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”æ¥è‡ªå®¢æˆ·çš„æ•°æ®ï¼ˆè‡³å°‘åœ¨æœ€ç»ˆæ–‡ä»¶ä¸­ä½¿ç”¨äº†è‡³å°‘120ä¸ªè¾“å…¥å‚æ•°çš„ä¿¡æ¯ï¼‰æš—ç¤ºæˆ‘ä»¬éœ€è¦è€ƒè™‘å¹¶æ·»åŠ å…·æœ‰å•å…ƒæ ¼ä¹‹é—´ä¾å­˜å…³ç³»çš„å…¬å¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¼€å§‹ä¸ºä¸‹ä¸€æ¬¡æµ‹è¯•è¿­ä»£å‡†å¤‡æ–°æ•°æ®ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è¯¦ç»†ä»‹ç»10ä¸ªè¾“å…¥å‚æ•°å¹¶æ·»åŠ ä»…ä¾èµ–äºå‚æ•°å’Œ1ä¸ªèšåˆå…¬å¼çš„å¦å¤–4ä¸ªæ–°å…¬å¼ï¼Œè¯¥å…¬å¼åŸºäºè¿™å››ä¸ªå…·æœ‰å…¬å¼çš„å•å…ƒæ ¼ï¼Œå¹¶ä¸”è¿˜å°†ä¾èµ–äºè¾“å…¥æ•°æ®çš„å€¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”¨äºåç»­æµ‹è¯•çš„æ–°å…¬å¼ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">public double Execute(double[] p)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price1 = Math.Pow(p[0] * p[8] / p[4] * Math.Sin(p[5]) * Math.Cos(p[2]) +<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Math.Abs(p[1] - (p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* Math.Sqrt(p[0] * p[0] + p[1] * p[1]) / 2.0 * Math.PI, p[9]);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price2 = p[4] * p[5] * p[2] / Math.Max(1, Math.Abs(p[7]));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price3 = Math.Abs(p[7] - p[3]) * p[2];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price4 = Math.Sqrt(Math.Abs(p[1] * p[2] + p[3] * p[4] + p[5] * p[6]) + 1.0);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price5 = p[0] * Math.Cos(p[1]) + p[2] * Math.Sin(p[1]);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var sum = p[0] + p[1] + p[2] + p[3] + p[4] + p[5] + p[6] + p[7] + p[8] + p[9];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var price6 = sum / Math.Max(1, Math.Abs((p[0] + p[1] + p[2] + p[3]) / 4.0))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ sum / Math.Max(1, Math.Abs((p[4] + p[5] + p[6] + p[7] + p[8] + p[9]) / 6.0));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var pricingAverage = (price1 + price2 + price3 + price4 + price5 + price6) / 6.0;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return pricingAverage / Math.Max(1, Math.Abs(price1 + price2 + price3 + price4 + price5 + price6));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œç»“æœå…¬å¼å˜å¾—æ›´åŠ å¤æ‚ï¼Œè¿™è‡ªç„¶ä¼šå½±å“ç»“æœ-å¹¶éæ›´å¥½ã€‚</font><font style="vertical-align: inherit;">ç»“æœè¡¨å¦‚ä¸‹ï¼š</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡æ•°</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æœº</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 4 </font></font></strong><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus 5</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éè¥åˆ©ç»„ç»‡</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°–å¡”</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exceläº’æ“ä½œ</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆå§‹åŒ–æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">241</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">368</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">722</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1640</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜ŸæœŸä¸‰ </font><font style="vertical-align: inherit;">1æ¬¡é€šè¿‡çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0004</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.9174 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ+ 124ï¼…ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.8996 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ+ 177ï¼…ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.7647 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ+ 11ï¼…ï¼‰</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50.7194 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ+ 30ï¼…ï¼‰</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹³å‡ </font><font style="vertical-align: inherit;">åå·®</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,035884</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.000000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†ç¡®æ€§</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">98.79ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.00ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.00ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.00ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤±è¯¯</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.28ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
</tr>
</tbody></table></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xg/l5/ye/xgl5yefp3_meak1f4qzj1mctjsm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³¨æ„ï¼šå› ä¸º </font><font style="vertical-align: inherit;">Excel Interopå¤ªå¤§ï¼Œå¿…é¡»ä»å›¾è¡¨ä¸­æ’é™¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æƒ…å†µå·²å®Œå…¨ä¸é€‚åˆåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">æœ‰ç‚¹éš¾è¿‡ï¼Œå‚¨å¤‡å’–å•¡ï¼Œç„¶åæ·±å…¥ç ”ç©¶-ç›´æ¥è¿›å…¥ä»£ç ç”Ÿæˆã€‚&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nv/d_/kh/nvd_khyfluufkuwh64vikgafdpe.jpeg"></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç ç”Ÿæˆ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨çªç„¶ä»æœªé‡åˆ°è¿‡ç±»ä¼¼çš„ä»»åŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è¿›è¡Œä¸€æ¬¡ç®€çŸ­çš„æ¸¸è§ˆã€‚&nbsp;</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç ç”Ÿæˆ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ä¸€ç§é€šè¿‡åŸºäºè¾“å…¥æ•°æ®åŠ¨æ€ç”Ÿæˆæºä»£ç å¹¶éšåè¿›è¡Œç¼–è¯‘å’Œæ‰§è¡Œæ¥è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">åœ¨é¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿé™æ€ä»£ç ç”Ÿæˆï¼ˆä¾‹å¦‚ï¼Œæˆ‘å¯ä»¥å¼•ç”¨T4MVCçš„ç¤ºä¾‹ï¼ŒT4MVCåŸºäºç¼–å†™ä¸»åº”ç”¨ç¨‹åºä»£ç æ—¶å¯ä»¥ä½¿ç”¨çš„æ¨¡æ¿å’Œå…ƒæ•°æ®åˆ›å»ºæ–°ä»£ç ï¼‰ï¼Œä»¥åŠåœ¨è¿è¡Œæ—¶è¿è¡Œçš„åŠ¨æ€ä»£ç ã€‚&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ ¹æ®æºæ•°æ®ï¼ˆæ¥è‡ªExcelçš„å…¬å¼ï¼‰å½¢æˆä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¯¥å‡½æ•°æ ¹æ®è¾“å…¥å€¼çš„å‘é‡æ¥æ”¶ç»“æœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºæ­¤ï¼Œæ‚¨å¿…é¡»ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ–‡ä»¶ä¸­è¯»å–å…¬å¼ï¼›</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”¶é›†æ‰€æœ‰ä¾èµ–é¡¹ï¼›</font></font></li>
<li>       C#;</li>
<li>     ;</li>
<li>            ;</li>
<li>     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æä¾›çš„æ‰€æœ‰åº“å‡é€‚åˆé˜…è¯»å…¬å¼ï¼Œä½†æ˜¯äº‹å®è¯æ˜ï¼Œ</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“æ˜¯æ­¤ç±»åŠŸèƒ½æœ€æ–¹ä¾¿çš„æ¥å£</font><font style="vertical-align: inherit;">ã€‚åœ¨å¯¹è¯¥åº“çš„æºä»£ç è¿›è¡Œäº†ä¸€äº›ç¿»é˜…ä¹‹åï¼Œæˆ‘å‘ç°äº†ç”¨äºå½¢æˆæ ‡è®°åˆ—è¡¨å¹¶å°†å…¶è¿›ä¸€æ­¥è½¬æ¢ä¸ºè¡¨è¾¾å¼æ ‘çš„å…¬å…±ç±»ã€‚å®¾æœï¼Œæˆ‘æƒ³ï¼ç°æˆçš„è¡¨è¾¾å¼æ ‘æ˜¯ç†æƒ³çš„é€‰æ‹©ï¼Œåªéœ€éå†å®ƒå¹¶å½¢æˆæˆ‘ä»¬çš„Cï¼ƒä»£ç å³å¯ã€‚&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œå½“æˆ‘å¼€å§‹ç ”ç©¶ç”Ÿæˆçš„è¡¨è¾¾å¼æ ‘çš„èŠ‚ç‚¹æ—¶ï¼Œä¸€å¤§éº»çƒ¦åœ¨ç­‰ç€æˆ‘ã€‚æŸäº›èŠ‚ç‚¹ï¼ˆå°¤å…¶æ˜¯å¯¹Excelå‡½æ•°çš„è°ƒç”¨ï¼‰å°è£…äº†æœ‰å…³æ‰€ä½¿ç”¨çš„å‡½æ•°åŠå…¶è¾“å…¥å‚æ•°çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æœªæä¾›å¯¹æ­¤æ•°æ®çš„ä»»ä½•å¼€æ”¾å¼è®¿é—®ã€‚å› æ­¤ï¼Œå¿…é¡»æ¨è¿Ÿä½¿ç”¨å®Œæˆçš„è¡¨è¾¾å¼æ ‘ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¾€ä¸‹èµ°äº†ä¸€å±‚ï¼Œå°è¯•ä½¿ç”¨ä»¤ç‰Œåˆ—è¡¨ã€‚è¿™é‡Œçš„ä¸€åˆ‡éƒ½éå¸¸ç®€å•ï¼šæˆ‘ä»¬æ‹¥æœ‰å…·æœ‰ç±»å‹å’Œå€¼çš„ä»¤ç‰Œã€‚å› ä¸ºæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å½¢æˆä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†æ ‘æ ‡è®°è½¬æ¢ä¸ºCï¼ƒä¸­çš„ç­‰æ•ˆæ ‡è®°ã€‚è¿™ç§æ–¹æ³•çš„ä¸»è¦ç›®çš„æ˜¯ç»„ç»‡å…¼å®¹çš„åŠŸèƒ½ã€‚å¤§å¤šæ•°æ•°å­¦å‡½æ•°å·²ç»å…¼å®¹-ä¾‹å¦‚è®¡ç®—ä½™å¼¦ï¼Œæ­£å¼¦ï¼Œæ±‚æ ¹ï¼Œæ±‚å¹‚ã€‚ä½†æ˜¯èšåˆå‡½æ•°ï¼ˆä¾‹å¦‚æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œæ•°é‡ï¼‰éœ€è¦å®Œæˆã€‚ä¸»è¦åŒºåˆ«åœ¨äºï¼Œåœ¨Excelä¸­ï¼Œè¿™äº›å‡½æ•°ä½¿ç”¨ä¸€å®šèŒƒå›´çš„å€¼ã€‚ä¸ºäº†ç®€åŒ–åŸå‹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå°†å‚æ•°åˆ—è¡¨ä½œä¸ºè¾“å…¥çš„å‡½æ•°ï¼Œç„¶åå°†å€¼çš„èŒƒå›´æ‰©å±•ä¸ºçº¿æ€§åˆ—è¡¨ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»Excelè¯­æ³•æ­£ç¡®åœ°å…¼å®¹è½¬æ¢ä¸ºCï¼ƒè¯­æ³•ã€‚&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹æ˜¯å°†ä»¤ç‰Œåˆ—è¡¨ä»Excelå…¬å¼è½¬æ¢ä¸ºæœ‰æ•ˆCï¼ƒä»£ç çš„ä¸»è¦ä»£ç ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">private string TransformToSharpCode(string formula, ParsingContext parsingContext)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize basic compile components, e.g. lexer<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var lexer = new Lexer(parsingContext.Configuration.FunctionRepository, parsingContext.NameValueProvider);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// List of dependency variables that can be filled during formula transformation<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var variables = new Dictionary&lt;string, string&gt;();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;using (var scope = parsingContext.Scopes.NewScope(RangeAddress.Empty))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Take resulting code line<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var compiledResultCode = TransformToSharpCode(formula, parsingContext, scope, lexer, variables);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var output = new StringBuilder();<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Define dependency variables in reverse order.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach (var variableDefinition in variables.Reverse())<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.AppendLine($"var {variableDefinition.Key} = {variableDefinition.Value};");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Take the result<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.AppendLine($"return {compiledResultCode};");<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return output.ToString();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
}<font></font>
<font></font>
private string TransformToSharpCode(ICollection&lt;Token&gt; tokens, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var output = new StringBuilder();<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;foreach (Token token in tokens)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (token.TokenType)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Function:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(BuildFunctionName(token.Value));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.OpeningParenthesis:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append("(");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.ClosingParenthesis:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(")");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Comma:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(", ");<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.ExcelAddress:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var address = token.Value;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(TransformAddressToSharpCode(address, parsingContext, scope, lexer, variables));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Decimal:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Integer:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Boolean:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(token.Value);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case TokenType.Operator:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output.Append(token.Value);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return output.ToString();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è½¬æ¢ä¸­çš„ä¸‹ä¸€ä¸ªç»†å¾®å·®åˆ«æ˜¯ä½¿ç”¨Excelå¸¸é‡-å®ƒä»¬æ˜¯å‡½æ•°ï¼Œå› æ­¤åœ¨Cï¼ƒä¸­ï¼Œå®ƒä»¬ä¹Ÿå¿…é¡»åŒ…è£…åœ¨å‡½æ•°ä¸­ã€‚&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰©ä¸‹çš„åªæ˜¯è§£å†³ä¸€ä¸ªé—®é¢˜ï¼šå°†å•å…ƒæ ¼å¼•ç”¨è½¬æ¢ä¸ºå‚æ•°ã€‚åœ¨ä»¤ç‰ŒåŒ…å«æœ‰å…³è¯¥å•å…ƒæ ¼çš„ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é¦–å…ˆç¡®å®šè¯¥å•å…ƒæ ¼ä¸­å­˜å‚¨äº†ä»€ä¹ˆã€‚å¦‚æœè¿™æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œåˆ™é€’å½’æ‰©å±•å®ƒã€‚å¦‚æœç”¨Cï¼ƒ-analogé“¾æ¥æ›¿æ¢å¸¸é‡ï¼Œå½¢å¼ä¸º</font></font><code>p[row, column]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">åˆ™å¸¸é‡</font></font><code>p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥æ˜¯äºŒç»´æ•°ç»„æˆ–ç”¨äºæ­£ç¡®æ•°æ®æ˜ å°„çš„ç´¢å¼•è®¿é—®ç±»ã€‚å¯¹äºä¸€å®šèŒƒå›´çš„å•å…ƒæ ¼ï¼Œæˆ‘ä»¬æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œåªæ˜¯å°†èŒƒå›´é¢„å…ˆæ‰©å±•ä¸ºå•ä¸ªå•å…ƒæ ¼å¹¶åˆ†åˆ«è¿›è¡Œå¤„ç†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ç¿»è¯‘Excelå‡½æ•°æ—¶æ¶µç›–äº†ä¸»è¦åŠŸèƒ½ã€‚&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gw/kk/hz/gwkkhzpfeudqdzcbfsgsdzdtolo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹æ˜¯å°†é“¾æ¥åˆ°Excelç”µå­è¡¨æ ¼å•å…ƒæ ¼çš„ä»£ç è½¬æ¢ä¸ºæœ‰æ•ˆçš„Cï¼ƒä»£ç çš„ä»£ç ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">private string TransformAddressToSharpCode(string excelAddress, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Try to parse excel range of addresses<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Currently, reference to another worksheet in address string is not supported<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var rangeParts = excelAddress.Split(':');<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (rangeParts.Length == 1)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Unpack single excel address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return UnpackExcelAddress(excelAddress, parsingContext, scope, lexer, variables);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Parse excel range address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(rangeParts[0], out int startRowIndex, out int startColumnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(rangeParts[1], out int endRowIndex, out int endColumnIndex);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var rowDelta = endRowIndex - startRowIndex;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var columnDelta = endColumnIndex - startColumnIndex;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var allAccessors = new List&lt;string&gt;(Math.Abs(rowDelta * columnDelta));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// TODO This part of code doesn't support reverse-ordered range address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;for (var rowIndex = startRowIndex; rowIndex &lt;= endRowIndex; rowIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var columnIndex = startColumnIndex; columnIndex &lt;= endColumnIndex; columnIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Unpack single excel address<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allAccessors.Add(UnpackExcelAddress(rowIndex, columnIndex, parsingContext, scope, lexer, variables));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return string.Join(", ", allAccessors);<font></font>
}<font></font>
<font></font>
private string UnpackExcelAddress(string excelAddress, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ParseAddressToIndexes(excelAddress, out int rowIndex, out int columnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return UnpackExcelAddress(rowIndex, columnIndex, parsingContext, scope, lexer, variables);<font></font>
}<font></font>
<font></font>
private string UnpackExcelAddress(int rowIndex, int columnIndex, ParsingContext parsingContext, ParsingScope scope, ILexer lexer, Dictionary&lt;string, string&gt; variables)<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var formula = parsingContext.ExcelDataProvider.GetRangeFormula(_worksheet.Name, rowIndex, columnIndex);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (string.IsNullOrWhiteSpace(formula))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// When excel address doesn't contain information about any excel formula, we should just use external input data parameter provider.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $"p[{rowIndex},{columnIndex}]";<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// When formula is provided, try to identify that variable is not defined yet<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// TODO Worksheet name is not included in variable name, potentially that can cause conflicts<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Extracting and reusing calculations via local variables improves performance for 0.0045ms<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var cellVariableId = $"C{rowIndex}R{columnIndex}";<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;if (variables.ContainsKey(cellVariableId))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return cellVariableId;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// When variable does not exist, transform new formula and register that to variable scope<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;variables.Add(cellVariableId, TransformToSharpCode(formula, parsingContext, scope, lexer, variables));<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;return cellVariableId;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰©ä¸‹çš„åªæ˜¯å°†äº§ç”Ÿçš„è½¬æ¢åçš„ä»£ç åŒ…è£…åˆ°é™æ€å‡½æ•°ä¸­ï¼Œå°†ç¨‹åºé›†ä¸å…¼å®¹æ€§å‡½æ•°é“¾æ¥ï¼Œç„¶åç¼–è¯‘åŠ¨æ€ç¨‹åºé›†ã€‚</font><font style="vertical-align: inherit;">å°†å…¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè·å¾—æŒ‡å‘æˆ‘ä»¬å‡½æ•°çš„é“¾æ¥-æ‚¨å¯ä»¥ä½¿ç”¨å®ƒã€‚&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ç¼–å†™ç”¨äºæµ‹è¯•çš„åŒ…è£…å™¨ç±»ï¼Œå¹¶ä½¿ç”¨æ—¶é—´æµ‹é‡æ¥è¿è¡Œæµ‹è¯•ã€‚&nbsp;</font></font><br>
<br>
<pre><code class="plaintext hljs">public void SetUp()<font></font>
{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize excel package by EPPlus library<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_package = new ExcelPackage(new FileInfo(_fileName));<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_workbook = _package.Workbook;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_worksheet = _workbook.Worksheets[1];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_inputRange = new ExcelRange[10];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;for (int rowIndex = 0; rowIndex &lt; 10; rowIndex++)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_inputRange[rowIndex] = _worksheet.Cells[rowIndex + 1, 2];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Access to result cell and extract formula string<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_resultRange = _worksheet.Cells[11, 2];<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var formula = _resultRange.Formula;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Initialize parsing context and setup data provider<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var parsingContext = ParsingContext.Create();<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;parsingContext.ExcelDataProvider = new EpplusExcelDataProvider(_package);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Transform Excel formula to CSharp code<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;var sourceCode = TransformToSharpCode(formula, parsingContext);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;// Compile CSharp code to IL dynamic assembly via helper wrappers<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;_code = CodeGenerator.CreateCode&lt;double&gt;(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sourceCode,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new string[]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// List of used namespaces<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"System", // Required for Math functions<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ExcelCalculations.PerformanceTests" // Required for Excel function wrappers stored at ExcelCompiledFunctions static class<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new string[]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add reference to current compiled assembly, that is required to use Excel function wrappers located at ExcelCompiledFunctions static class<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"....\\bin\\Debug\\ExcelCalculations.PerformanceTests.exe"<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Notify that this source code should use parameter;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Use abstract p parameter - interface for values accessing.<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new CodeParameter("p", typeof(IExcelValueProvider))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæˆ‘ä»¬æœ‰äº†æ­¤è§£å†³æ–¹æ¡ˆçš„åŸå‹ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸º</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusCompiled Mark-I</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¿è¡Œæµ‹è¯•åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æœŸå¾…å·²ä¹…çš„ç»“æœã€‚åŠ é€Ÿåº¦å‡ ä¹æ˜¯300å€ã€‚å·²ç»ä¸é”™ï¼Œä½†æ˜¯ç”Ÿæˆçš„ä»£ç ä»ç„¶æ¯”æœ¬åœ°ä»£ç æ…¢16å€ã€‚ä¼šæ›´å¥½å—ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯çš„ä½ å¯ä»¥ï¼ç”±äºæˆ‘ä»¬å°†ç”¨å˜é‡å…¬å¼æ›¿æ¢æŒ‡å‘å…¶ä»–å•å…ƒæ ¼çš„æ‰€æœ‰é“¾æ¥ï¼Œå› æ­¤å°è¯•æ”¹å–„ç»“æœã€‚æˆ‘ä»¬çš„æµ‹è¯•åœ¨å…¬å¼ä¸­ä½¿ç”¨äº†ä¾èµ–å•å…ƒæ ¼ï¼Œå› æ­¤åœ¨ç¿»è¯‘å™¨çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬æ”¶åˆ°äº†å¯¹ç›¸åŒæ•°æ®çš„å¤šæ¬¡è®¡ç®—ã€‚å› æ­¤ï¼Œå†³å®šåœ¨è®¡ç®—ä¸­ä½¿ç”¨ä¸­é—´å˜é‡ã€‚ä½¿ç”¨ç”Ÿæˆçš„å› å˜é‡æ‰©å±•ä»£ç åï¼Œæ€§èƒ½æé«˜äº†2å€ã€‚è¿™ç§æ”¹è¿›ç§°ä¸º</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPluså·²ç¼–è¯‘ï¼ŒMark-II</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ¯”è¾ƒè¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾ä¹¦é¦†</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜ŸæœŸä¸‰ </font><font style="vertical-align: inherit;">æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coefã€‚</font><font style="vertical-align: inherit;">å‡é€Ÿ</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æœº</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.00004</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1ä¸ª</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusç¼–è¯‘ï¼ŒMark-II</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.003</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlusç¼–è¯‘ï¼ŒMark-I</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.0061</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åå…­</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EPPlus</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,2089</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3023</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™äº›æ¡ä»¶ä¸‹ä»¥åŠä¸ºä»»åŠ¡åˆ†é…çš„æ—¶é—´é™åˆ¶ä¸‹ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœä½¿æˆ‘ä»¬æ›´æ¥è¿‘æœ¬åœ°ä»£ç çš„æ€§èƒ½-ä¸åŸå§‹ç‰ˆæœ¬ç›¸æ¯”æœ‰8å€çš„æ»å-3028å€çš„å‡ ä¸ªæ•°é‡çº§çš„æ»åã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœæ‚¨åˆ é™¤æ—¶é—´é™åˆ¶ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½æ”¹å–„ç»“æœå¹¶å°½å¯èƒ½æ¥è¿‘æœ¬æœºä»£ç å—ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘çš„ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä¸å†æœ‰æ—¶é—´å®ç°è¿™äº›æŠ€æœ¯ã€‚</font><font style="vertical-align: inherit;">ä¹Ÿè®¸æˆ‘å°†ä¸ºæ­¤ä¸»é¢˜ä¸“é—¨æ’°å†™ä¸€ç¯‡æ–‡ç« ã€‚</font><font style="vertical-align: inherit;">ç›®å‰ï¼Œæˆ‘åªèƒ½è°ˆè®ºä¸»è¦æ€æƒ³å’Œé€‰é¡¹ï¼Œä»¥ç®€çŸ­æ‘˜è¦çš„å½¢å¼ç¼–å†™å®ƒä»¬ï¼Œè¿™äº›æ‘˜è¦å·²é€šè¿‡åå‘è½¬æ¢è¿›è¡Œäº†éªŒè¯ã€‚</font><font style="vertical-align: inherit;">åå‘è½¬æ¢æ˜¯æŒ‡åœ¨ç”Ÿæˆä»£ç çš„æ–¹å‘ä¸Šæ‰‹å·¥ç¼–å†™çš„æœ¬æœºä»£ç çš„é™çº§ã€‚</font><font style="vertical-align: inherit;">è¿™ç§æ–¹æ³•ä½¿æ‚¨å¯ä»¥è¶³å¤Ÿå¿«åœ°æ£€æŸ¥æŸäº›é—®é¢˜ï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­è¿›è¡Œé‡å¤§æ›´æ”¹ã€‚</font><font style="vertical-align: inherit;">å®ƒè¿˜å…è®¸æ‚¨å›ç­”åœ¨æŸäº›æƒ…å†µä¸‹æœ¬æœºä»£ç çš„æ€§èƒ½å°†å¦‚ä½•ä¸‹é™çš„é—®é¢˜ï¼Œè¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨ç›¸åçš„æ–¹å‘ä¸Šè‡ªåŠ¨æ”¹è¿›äº†ç”Ÿæˆçš„ä»£ç ï¼Œåˆ™å¯ä»¥åœ¨ç›¸ä¼¼ç³»æ•°çš„æƒ…å†µä¸‹è·å¾—æ€§èƒ½ä¸Šçš„æ”¹è¿›ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‘˜è¦</font></font></h2><br>
<ol>
<li>  ,                     ;</li>
<li>           inline      ;</li>
<li> -     Sum, Max, Min   ;</li>
<li>  Sum  inline     ;</li>
<li>   (         )    .</li>
</ol><br>
<h1></h1><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong></strong></td>
<td><strong>Native</strong></td>
<td><strong>EPPlus Compiled, Mark-II</strong></td>
<td><strong>EPPlus 4</strong><strong>EPPlus 5</strong></td>
<td><strong>NPOI</strong></td>
<td><strong>Spire</strong></td>
<td><strong>Excel Interop</strong></td>
</tr>
<tr>
<td><strong>  ()</strong></td>
<td>0</td>
<td>239</td>
<td>241</td>
<td>368</td>
<td>722</td>
<td>1640</td>
</tr>
<tr>
<td><strong>.   1  ()</strong></td>
<td>0,0004</td>
<td>0,003</td>
<td>0,9174</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,8996</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,7647</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50,7194</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹³å‡ </font><font style="vertical-align: inherit;">åå·®</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,035884</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†ç¡®æ€§</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">98.79ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100.0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é€‚ç”¨</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤±è¯¯</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,0ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.28ï¼…</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.3ï¼…</font></font></td>
</tr>
</tbody></table></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kd/py/vy/kdpyvy0-qfqtfbwgtvbwjo28coo.png" alt="åœ¨Cï¼ƒä¸­ä»Excelå¿«é€Ÿè®¡ç®—å…¬å¼"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ€»ç»“è¿™äº›æ­¥éª¤ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ç§å°†å…¬å¼ç›´æ¥ä»è‡ªå®šä¹‰Excelæ–‡æ¡£è½¬æ¢ä¸ºæœåŠ¡å™¨ä¸Šå·¥ä½œä»£ç çš„æœºåˆ¶ã€‚</font><font style="vertical-align: inherit;">è¿™ä½¿æ‚¨å¯ä»¥ä½¿ç”¨å°†Excelä¸ä»»ä½•ä¸šåŠ¡è§£å†³æ–¹æ¡ˆé›†æˆçš„éå‡¡çµæ´»æ€§ï¼Œè€Œä¸ä¼šå¤±å»å¤§é‡ç”¨æˆ·ä¹ æƒ¯ä½¿ç”¨çš„å¼ºå¤§ç”¨æˆ·ç•Œé¢ã€‚</font><font style="vertical-align: inherit;">åœ¨å¦‚æ­¤çŸ­çš„å¼€å‘å‘¨æœŸå†…ï¼Œæ˜¯å¦å¯ä»¥ä½¿ç”¨ä¸Excelä¸­ç›¸åŒçš„ç”¨äºåˆ†æå’Œå¯è§†åŒ–æ•°æ®çš„å·¥å…·é›†æ¥å¼€å‘è¿™ç§ä¾¿æ·çš„ç•Œé¢ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸æ‚¨å¿…é¡»å®ç°çš„Excelæ–‡æ¡£æœ€ä¸å¯»å¸¸ï¼Œæœ€æœ‰è¶£çš„é›†æˆæ˜¯ä»€ä¹ˆï¼Ÿ</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN498022/index.html">ï¼ƒ341ç§»åŠ¨å¼€å‘äººå‘˜çš„æœ‰è¶£ææ–™æ‘˜è¦ï¼ˆ4æœˆ13æ—¥è‡³19æ—¥ï¼‰</a></li>
<li><a href="../zh-CN498024/index.html">ä½¿ç”¨Houdiniå’ŒPythonå•å‡»é¼ æ ‡å³å¯æ„å»ºåŸå¸‚</a></li>
<li><a href="../zh-CN498026/index.html">FOSSæ–°é—»ç¬¬12å·-2020å¹´4æœˆ13æ—¥è‡³19æ—¥å…è´¹å’Œå¼€æºæ–°é—»çš„å›é¡¾</a></li>
<li><a href="../zh-CN498028/index.html">Python COVID-19å¤§æµè¡Œæ¨¡æ‹Ÿ</a></li>
<li><a href="../zh-CN498030/index.html">å¤‡ä»½ï¼šåœ¨å“ªé‡Œï¼Œå¦‚ä½•ä»¥åŠä¸ºä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN498034/index.html">ç°ä»£è®¾è®¡é£æœºçš„é˜²å¾¡èƒ½åŠ›æ¯”æ‚¨æƒ³è±¡çš„è¦å¥½ï¼Œå¯æŠµå¾¡ç”Ÿç‰©å¨èƒï¼ˆCOVID-19ï¼‰</a></li>
<li><a href="../zh-CN498036/index.html">é©¬å…‹Â·å®‰å¾·é‡Œæ£®ï¼ˆMark Andriessenï¼‰ï¼šç°åœ¨æ˜¯æ—¶å€™ä¸ºè‡ªå·±åˆ›é€ ï¼ˆæ˜¯æ—¶å€™å»ºé€ ï¼‰</a></li>
<li><a href="../zh-CN498038/index.html">ä¸Šå‘¨ç¬¬411æœŸï¼ˆ2020å¹´4æœˆ13æ—¥è‡³19æ—¥ï¼‰æ¥è‡ªå‰ç«¯ä¸–ç•Œçš„æ–°é²œææ–™æ‘˜è¦</a></li>
<li><a href="../zh-CN498042/index.html">è§£æï¼Œä¸éªŒè¯</a></li>
<li><a href="../zh-CN498046/index.html">ç ”ç©¶äººå‘˜æ­£åœ¨å¼€å‘ä¸€ç§å‡å°‘è®¡ç®—æœºè§†è§‰æ•°æ®é›†ä¸­åå·®çš„æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>