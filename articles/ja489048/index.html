<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥘 👩🏿‍🔧 👴 ログとクエリのトレースはベストプラクティスです。Yandexレポート 👨‍👩‍👧‍👧 👨🏼‍⚖️ 🖖🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yandex.Marketには大規模なマイクロサービスアーキテクチャがあります。マーケットのメインページのブラウザーリクエストにより、さまざまな人々によって開発されたさまざまなサービス（バックエンド）に多数の埋め込みリクエストが発生します。このようなシステムでは、リクエストが失敗した理由や、処理に長...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ログとクエリのトレースはベストプラクティスです。Yandexレポート</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/489048/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex.Marketには大規模なマイクロサービスアーキテクチャがあります。</font><font style="vertical-align: inherit;">マーケットのメインページのブラウザーリクエストにより、さまざまな人々によって開発されたさまざまなサービス（バックエンド）に多数の埋め込みリクエストが発生します。</font><font style="vertical-align: inherit;">このようなシステムでは、リクエストが失敗した理由や、処理に長い時間がかかった理由を理解するのが難しい場合があります。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_l1qP0DyBcA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナトリー・オストロフスキー </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メガトリア</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼のチームがこの問題をどのように解決したかを説明し、市場に固有のプラクティスを共有しますが、一般的にはあらゆる優れたサービスに関連しています。</font><font style="vertical-align: inherit;">彼のレポートは、かなり短い時間で新しい市場を展開した彼自身の経験に基づいています。</font><font style="vertical-align: inherit;">数年前から、Tolyaは市場でインターフェース開発チームを率いていましたが、現在は無人車両の方向に移動しています。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-私たちのすべての市場は一般的な原則に従って構築されています。これは1つの大きな単一システムです。しかし、フロントエンドについて話すと、ユーザーの観点からすると、アプリケーションは完全に異なります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/cx/bk/xfcxbk6d4xsoxdb3l7clfzw5yza.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に、フロントエンドは多くのバックエンドに行きます。これらのバックエンドは互いに似ている場合があります（同じアプリケーションの異なるインスタンス）。また、サービスに固有の場合もあります（特別請求）。このようなシステムの構造は、古典的なマイクロサービスアーキテクチャと考えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大規模なサービスには常に問題があり、正確に何が起こっているのかを理解することは困難です。または、たとえば、ユーザーで支払いエラーが発生したときに何が起こるか。昨日彼の場所で起こったとしましょう。今日私たちは何が起こったのかを理解する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b3/nz/p2/b3nzp2buowpixe2wnv1-r-ymj7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックエンド2は、特定の製品、特定の時間、または特定のユーザーのいずれかに対して「書き込む」ことができます。私たちはどんな状況にも対応できる必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pv/wu/-w/pvwu-wguspmalhce4hxtbvhqznu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちには多くのバックエンドがあり、私が言ったように、彼らは自分で歩くことができます。これがグラフの形で提示されると、かなり混乱するでしょう。実際には、何百ものマイクロサービスが存在する可能性があります。それらの間の接続がいくつあるか想像してみてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このトピックに飛び込むには多くのステップがあります。それぞれについて簡単に説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/nf/hq/qunfhq8cdqgbtqtmikv0maf1tpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、共通のリクエストマーキングシステムについて、バックエンドの同僚に同意します。後で見つけるのが簡単です。</font><font style="vertical-align: inherit;">次に、問題をすばやく再現できるようにする必要があります。</font><font style="vertical-align: inherit;">支払いエラーが発生したと仮定します-それがどのように発生し、どのバックエンドで発生したかをすばやく理解してください。</font><font style="vertical-align: inherit;">ログをファイルだけでなくデータベースにも保存して、集計を実行できるようにします。</font><font style="vertical-align: inherit;">そしてもちろん、プロセスの重要な部分はグラフとモニタリングです。</font><font style="vertical-align: inherit;">次に、順番に。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統一リクエスト識別システム</font></font></h2><br>
<img src="https://habrastorage.org/webt/1z/lc/cl/1zlccllwyct_nesu28sa4kh0za0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、サービスで何が起こっているかを理解するための最も簡単なツールの1つです。たとえば、フロントエンドが何らかのidリクエスト（図のrequestId変数）を生成し、それをバックエンドのすべてのエンドポイントにスローすることを同僚と同意します。そして、バックエンド自体は何も再発明しません。彼は到着したrequestIdを取得し、それをバックエンドへのリクエストでさらに転送します。同時に、彼はプレフィックスを指定できるため、同じrequestIdの中からこの特定のバックエンドを見つけることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/qo/sk/ohqoskth2c-8o9h2btju58-tg04.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ログを取得するときは、ログに、たとえば、バックエンドが500であると表示されていることを確認してください。2つのオプションがある場合があります。このリクエストIDを同僚に渡して、同僚がログで確認するか、自分で確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/cf/1m/pqcf1m-t3srhcoorgfwnnpohbqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのログには、何がいつ何が起こったかを理解するだけでなく、このリクエストのコンテキストを保持するためにも、このようなIDが付けられています。</font><font style="vertical-align: inherit;">これは非同期であり、後でログに何かを追加する場合があります。</font><font style="vertical-align: inherit;">そして、requestIdをかむと、それから何もうまくいきません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カール</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題を再現するには、cURLユーティリティを使用します。これは、httpおよびhttpsのネットワークリクエストを行うコンソールユーティリティです。 cURLはさらに多くの異なるプロトコルをサポートしますが、Web開発を行う場合、これがhttp（s）リクエストを処理するためのツールであると想定する方が簡単です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/mr/uh/75mruhc0hnm0q7qtllafjtnz8ak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cURLチームに慣れるには、任意のサイトにアクセスしてから、ネットワークにアクセスし、cURLの形式でリクエストをコピーします。結果は非常に大きな線</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jl/mn/fx/jlmnfxdobmhcqctl-uviygpzij8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
になります。それを理解しようとしても、心配する必要はありません。それを分解してみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j5/88/xz/j588xz0r-jh48xp1rphfqoljlvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、market.yandex.ruへのリクエストです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gv/6v/_d/gv6v_dz188tviqfjs5siyf9lt8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
User-Agentがここに追加されましたが、すでに多くのスペースを占めています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1j/a_/sd/1ja_sdx_in4dcwudr64xjdezf98.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、残りはクッキーです。 Yandexコードにはかなり多くのものが含まれています。シリアル化された形式では、それらは非常に手ごわい外観を持っています。実際、それら以外には何もありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、cURLは何に役立つのでしょうか。自分でコピーして実行した場合は、私と同じmarket.yandex.ruページが表示されます。実行されているコンピューターのみが異なります。もちろん、いくつかの副作用によりIPアドレスに違いが生じる可能性がありますが、一般的には同じ要求になります。同じシナリオを再現します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/gd/sg/lhgdsguqkolxs1vrjusxnshjnmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのようなcURLクエリを毎回発明しないようにするために、npm-package format-curlを使用できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/in/fk/yjinfkjpv0bgzbhfmi8shr7qyno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、関数が通常取るすべての要求パラメーターを受け取ります。つまり、この場合、ヘッダーとURLのみです。</font><font style="vertical-align: inherit;">しかし、彼はクエリ、ボディなどの方法も知っています。そして、出力はcURLリクエストを含む単なる文字列です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/4l/h8/xx4lh8tvvwmvzw1-aflbg7ophvq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、開発環境のすべてのログにはcURLリクエストも含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/iq/f6/wuiqf6p5bzxdgiom430q364yuw4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザーで直接バックエンドのcURLリクエストをログに記録して、ブラウザーコンソールを確認せずにバックエンドに移動する方法をすぐに確認することもできました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0o/l3/ay/0ol3ay03w7toau9tyabduyiu1-m.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cURLリクエストにはセッションCookieの転送が含まれることに注意してください-これは悪いことです。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Market.yandex.ruで私へのcURLリクエストを破棄した場合、私はあなたのマーケットとその他のYandexサービスにログインして入ることができます。</font><font style="vertical-align: inherit;">したがって、そのようなリクエストはどこにも保存せず、自分自身でテストベンチに記録するだけです-そのようなデータが漏洩することはありません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリックハウス</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、構造化ログについて説明します。ここでは、特定のClickHouseデータベースを念頭に置いていますが、任意のデータベースを選択できます。 ClickHouseは円柱状のDBMSであり、大量のデータから選択し、大量のデータを取り込む方が便利です。ログの大きな部分をそこに保存して、たとえば、10億レコードのなんらかの集約を作成できるという点で優れています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/yq/hx/rxyqhxvdpvjetfh9jmkw4hfkwvu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、ClickHouseの選択例はプレーンSQLです。ここでは、今日のステータスコードのリクエスト数を示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/5v/je/oi5vje-sgh204x5-w1fjywdjyk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、18万2,500と750になり、残りのステータスコードは、たとえば私たちにとって興味深いものではありません。しかし、これをどのように興味深い方法で使用できますか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/r6/gp/edr6gpqetfffuhjo6uc2hwznb4s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回答の総数の比率に対する200の比率は、サービスレベルインジケーターであると言えます。これは、ステータスコードの観点からアプリケーションがどのように機能するかという質問に答えます。単純ですが、彼はすでに何かについて話しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/vr/vq/y3vrvqez5ghx9umed2htpzgeurm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指標に基づいて、最初のSLIを作成できます。つまり、たとえば、要求の99％はOKである必要があります。ここで、SLIを実行したことを比較できます。それらが満たされていない場合は、最後の500件のリクエスト、または単に重要なもののいずれかを作成しようとした可能性があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hf/0i/vf/hf0ivf6posnoebmrwayqz4wni5c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、支払いエラーは私たちにとって重要ですが、この場合はゼロが返されます-幸運です:) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5c/0i/yh/5c0iyhrkfdxbgd0psywb7jvv8si.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログがこの便利な形式であり、SQL経由で取得できることを確認するにはどうすればよいですか？</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7b/7m/hx/7b7mhxhtlyos6qbomnnm2p6xcko.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは別の大きなレポートのトピックであり、すべてインフラストラクチャに依存します。</font><font style="vertical-align: inherit;">しかし、2つの方法があるようです。</font><font style="vertical-align: inherit;">最初に、メタデータをランタイムに直接、データベースに直接送信します。</font><font style="vertical-align: inherit;">別の方法で、2番目の方法で行います。ログファイルを追跡し、データベースまたは中間の場所でチャンクを送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはかなり多層的に機能します。特定のインスタンスからそのようなログのリモートストレージサーバーにログを送信します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストトレース</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「クエリトレース」の概念はありません。この用語はGoogleによって作成されました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/mc/cf/aumccfspkkp7eieqgesgk8awnn4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターネットで「クエリトレース」を検索すると、tracerouteコマンドが表示されます。おそらくこれはクエリトレースに似ています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w0/no/pv/w0nopvgiuihtlc2x8b7fdist7lm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールプログラムもあり、ここではウェブサイトbringly.ru（昨年の春に開発したサービス）で実行しました。それは、リクエストがバランサーに到達する前にどのようなマシンとサーバーを通過するかを理解するのに役立ちます。バランサーは、レイアウトまたは他の何かで応答します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9g/n9/ax/9gn9axljm2rabdxvowa3p8gsjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こちらがバランサーです。クエリトレースとは、これではなく、バランサー内で発生するすべてのこと、つまり、リクエストがnode.jsアプリケーション内でさらに生き残ることを意味します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/rh/rr/fhrhrr6j0ujdnvdivmn0dwobnlc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、水平時間が表示されるタイムラインと、リクエストの垂直シーケンスの形式で表示されます。この場合、製品カードへのリクエストがあり、これは承認のバックエンドへのリクエストであることがわかります。彼の決定後、3つの長い列ができました。これは、バスケット、製品カード、および類似の製品のメインバックエンドへのリクエストです。だから私たちは痕跡を持っています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m8/sl/4a/m8sl4atplnknyq_5wefl8b2wgw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、同じ承認リクエストが表示され、バックエンドが使用されました。この場合、バックエンドはデータベースへのクエリが連続しているため、最適な動作をしません。おそらく、そのようなクエリは最適化できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ru/ah/bz/ruahbzfg8qzvgzi1s2gbexvm0og.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、トレースの例を示します。バックエンドに移動しなかったが、すぐにステータス500が返されました。このようなトレースはどのように役立ちますか？</font><font style="vertical-align: inherit;">同僚の邪魔をする必要はありません。</font><font style="vertical-align: inherit;">このリクエストのIDがあるので、自分でログを見て、何が起こっているのかを把握できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/nm/0g/wqnm0gw9rgznoe7rswqshty_u1a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは反対の状況です。</font><font style="vertical-align: inherit;">バックエンドは何かがおかしいと言い、同時に正確に何が起こったのかをメタ情報に書き込んだ-ある種のスタックトレースが現れた。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/lb/ck/uclbck5ju2ri2l2qyhjxkwnvxpk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分を同じツールにする方法は？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで最も重要なのはデータベースです。</font><font style="vertical-align: inherit;">サービスでのいくつかのアクションのデータベースに最も単純な「INSERT INTO」がある場合、少なくともSQLを使用して必要なイベントを見つけることができます。</font><font style="vertical-align: inherit;">そして、必要に応じて、これへのインターフェースを作成できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは非常に興味深いトピックです。今日は詳しく説明しませんが、もちろん:) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mo/tc/5p/motc5p8irltrzn7aqlsffemkdza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロギングについて話しましょう。</font><font style="vertical-align: inherit;">多くのグラフがあり、何かを展開するときにそれらを調べます-そしてタイミングにはそのようなノイズがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/vn/ku/lovnkuij1s2d39nszmdwvwsde78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフは、何かが間違っていることを視覚的に確認するのに役立ちます。</font><font style="vertical-align: inherit;">そして、ログを見て、何が問題かを理解する必要があります。</font><font style="vertical-align: inherit;">この場合、リリース直後のサージは、少なくともそのようなリリースをすぐにロールバックする必要があることを意味します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モニタリング</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このトピックのさらに重要な部分とより深い没入度は、監視です。監視することで、まず、グラフの自動監視と、次に何かを監視するための自動化ルールを理解します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/1f/r9/wn1fr9r0fnzl-r4kbkgbj3pwz6w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1分あたりの応答の総数に対する500の比率を監視します。また、400のサービスの負荷の有無を監視し、各バックエンドのpingノブをプルするヘルスチェックノブを確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/be/ts/j0betsujurv192dkwhrvk_cvegk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、ワークステーションの近くの画面に含める監視ダッシュボードがあります。</font><font style="vertical-align: inherit;">そのため、どの "監視"監視かがすぐにわかります。</font><font style="vertical-align: inherit;">たとえば、これはメインエンドの1つで、フロントエンドとメインバックエンドが表示されています。</font><font style="vertical-align: inherit;">ここで、一部の監視がバックエンドで点灯していることがわかります。</font><font style="vertical-align: inherit;">これは、その時点で、このサービスの責任者がTelegramでメッセージを受信するか、場合によっては電話をかけることさえあることを意味します。これは監視設定によって異なります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単一のrequestIdは、複数のアプリケーションで構成されるサービスで問題をより簡単に見つけるのに役立ちます。</font><font style="vertical-align: inherit;">正しいcURLを使用すると、問題をより正確に再現し、たとえば自分でデータをバックエンドに送信する方法を確認できます。</font><font style="vertical-align: inherit;">構造化ログを使用すると、SLIを思い付くことができ、通常のテキストログよりも使いやすくなっています。</font><font style="vertical-align: inherit;">そして、チャートに従って、モニタリングを実行することを忘れないでください。</font><font style="vertical-align: inherit;">インフラストラクチャに興味がある場合は、Googleのサイト信頼性エンジニアリングの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">本を</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
読むことをお勧め</font><font style="vertical-align: inherit;">します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja489038/index.html">「Java Concurrency in Practice」という本</a></li>
<li><a href="../ja489040/index.html">Contact Center AI：会話中のサードパーティは問題ありません</a></li>
<li><a href="../ja489042/index.html">ストアのグランドオープン：コルーチンを使用したAndroidへのデータの読み込み</a></li>
<li><a href="../ja489044/index.html">テキストの物理学。パート1.シンボル</a></li>
<li><a href="../ja489046/index.html">自動運転GAZ66モンスタートラック1/16</a></li>
<li><a href="../ja489050/index.html">Windows対Sysmon</a></li>
<li><a href="../ja489058/index.html">PyTorchとSklearnを使用したニューラルネットワークのアンサンブル</a></li>
<li><a href="../ja489060/index.html">分析：高リスク投資と低リスク投資の違いは何ですか</a></li>
<li><a href="../ja489062/index.html">Pythonの驚異的な並列Apache Parquet I / Oパフォーマンス</a></li>
<li><a href="../ja489068/index.html">デジタル不死-エンジニアリングアプローチ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>