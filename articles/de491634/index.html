<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüé® üåä üê¨ Sch√ºtzen und Hacken der Xbox 360 (Teil 1) üñïüèæ üêÄ üë©üèª‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sie haben wahrscheinlich schon von der Xbox 360-Spielekonsole geh√∂rt und dass sie ‚Äûblinkt‚Äú. Mit "Firmware" ist hier eine Umgehung der integrierten Sch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sch√ºtzen und Hacken der Xbox 360 (Teil 1)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491634/"><img src="https://habrastorage.org/webt/f2/9c/up/f29cup58ppdbyrxpx6uwtfwce3m.png" alt="Bild" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie haben wahrscheinlich schon von der Xbox 360-Spielekonsole geh√∂rt und dass sie ‚Äûblinkt‚Äú. </font><font style="vertical-align: inherit;">Mit "Firmware" ist hier eine Umgehung der integrierten Schutzmechanismen zum Starten von Kopien von Spielen und propriet√§rer Software gemeint. </font><font style="vertical-align: inherit;">Und hier stellen sich Fragen! </font><font style="vertical-align: inherit;">Welche Mechanismen, wie kommen sie herum? </font><font style="vertical-align: inherit;">Was haben die Entwickler getan, wie haben sie es geschafft, das zu umgehen? </font><font style="vertical-align: inherit;">Tats√§chlich ist das Thema sehr umfangreich und interessant, insbesondere f√ºr die Xbox 360 - hier finden Sie Software-Schwachstellen, Hardware-Fehler und absolut magische Magie. </font><font style="vertical-align: inherit;">Interessant? </font><font style="vertical-align: inherit;">Vorbeikommen! </font><font style="vertical-align: inherit;">Im ersten Teil werden wir mit dem Hypervisor, den Laufwerken und der Firmware vertraut gemacht ...</font></font><br>
<br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treffen Sie das Thema</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Xbox 360-Spielekonsole wurde 2005 ver√∂ffentlicht und hat seitdem keine √Ñnderungen an den Eigenschaften von Eisen erfahren. </font><font style="vertical-align: inherit;">Die ganze Zeit, in der es ver√∂ffentlicht wurde, waren sie gleich:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,2 GHz PowerPC-CPU, / 3 Kerne</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">500 MHz GPU</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">512 MB RAM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SATA DVD-ROM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SATA-Festplatte (optional) </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, das Design hat sich im Laufe der Zeit ge√§ndert, die Nanometer haben abgenommen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/n2/7b/b8n27bxgr6hsm1kowq2-zhpi8fk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotzdem funktionierten alle Spiele auf allen ‚ÄûRevisionen‚Äú von Konsolen gleich gut - genau dies ist der Fall, wenn moderne Spiele auf Ger√§ten von 2005 ausgef√ºhrt werden k√∂nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Zeitpunkt der Ver√∂ffentlichung wurde lautstark erkl√§rt, dass die Konsole so sicher wie m√∂glich entwickelt wurde - benutzerdefinierte Chips mit Schutz auf Hardwareebene, und im Allgemeinen haben Hacker dies noch nicht gesehen:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In dieser Box wird es Sicherheitsstufen geben, die die Hacker-Community noch nie gesehen hat</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was haben sich die Entwickler ausgedacht? </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstens</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> haben sie alles getan, damit der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmcode des Systems nicht erhalten werden konnte</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In den Zentralprozessor wurde ein 32-KB-ROM mit einem Prim√§rlader (1BL) und einem 64-KB-SRAM eingebaut, in dem er ausgef√ºhrt wurde. </font><font style="vertical-align: inherit;">Es ist sehr, sehr schwierig, den Inhalt eines ROM von einem CPU-Chip zu erhalten:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tm/6g/db/tm6gdbdeo_4lkt5j5d4xb0-big4.png" width="320"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zweitens</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wurden spezielle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherungen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in denselben Prozessor eingesetzt </font><font style="vertical-align: inherit;">- gebrannte (buchst√§blich Hochspannungs-) Jumper, eine Art einmal programmierbarer Speicher. </font><font style="vertical-align: inherit;">Die Sicherungen enthalten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG-Schnittstellensperrbits</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bits, die den Zweck des Pr√§fixes bestimmen (Retail / Devkit / Testkit)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eindeutiger 128-Bit-Prozessorschl√ºssel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDV-Z√§hler (Lock-Down Value) zum Deaktivieren des Downgrades</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/j6/f4/zgj6f4zvgznhxrla5so6x06ofus.png" width="420"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, das Ausma√ü der Fusion ist begrenzt. Wenn Sie es schaffen, Ihre Konsole 80 Mal hintereinander zu aktualisieren, wird der CFLDV-Z√§hler beendet und ... Ich wei√ü nicht, ich habe nicht versucht, dies zu tun. Wahrscheinlich wird das Pr√§fix nicht mehr aktualisiert. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drittens</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> haben die Entwickler eine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertrauenskette</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implementiert </font><font style="vertical-align: inherit;">. Um die Authentizit√§t von Bootloadern zu √ºberpr√ºfen, wurde eine Kombination aus modernen (zu dieser Zeit) SHA-1- und RSA-2048-Algorithmen verwendet, die die M√∂glichkeit ausschloss, einen eigenen Code zu starten oder Bootloader nicht autorisiert zu √§ndern, selbst wenn Sie irgendwie alle Schl√ºssel von der Konsole erhalten und das System neu erstellen konnten .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/xy/hg/ydxyhgfla9rqqypwuojvglpxqqg.png" width="370"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Viertens</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beschlossen die Entwickler, das Prinzip "niemandem vertrauen" weiter zu verfolgen und ein spezielles Hardwaremodul </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum Schutz des Arbeitsspeichers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in dieselbe ungl√ºckliche CPU zu integrieren </font><font style="vertical-align: inherit;">! Mit seiner Hilfe wurden alle Bereiche mit Programmcode verschl√ºsselt und die Integrit√§ts√ºberwachung f√ºr die wichtigsten Bereiche (Hypervisor) aktiviert!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3f/z2/de/3fz2dejnzhzmqpmx-ayeyvanur8.png" width="420"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise verteidigten sich die Entwickler gegen DMA-Angriffe, wenn sie √ºber externe Ger√§te, die Zugriff auf RAM haben, den Systemprogrammcode im RAM √§ndern. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlie√ülich</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befasste sich der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hypervisor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit der Differenzierung von Rechten in Speicherbereiche </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nur er konnte die Seiten nat√ºrlich ausf√ºhrbar machen, bevor er die digitale Signatur √ºberpr√ºfte, so dass es unm√∂glich war, nicht signierten Code herunterzuladen oder etwas aus dem Datenbereich auszuf√ºhren, selbst durch eine Sicherheitsl√ºcke in einem Treiber oder Spiel (die Achse und die Spiele wurden mit Kernel-Rechten gestartet). . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen war das Xbox 360-Betriebssystem gut gesch√ºtzt, und daher wurde DVD-ROM als erster Angriffsvektor ausgew√§hlt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir starten ... Backups!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Xbox 360 wurde eine Dual-Layer-DVD als Hauptmedium f√ºr Spiele ausgew√§hlt. </font><font style="vertical-align: inherit;">Nat√ºrlich waren auch hier Abwehrmechanismen vorhanden:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Datenaustausch mit DVD-ROM wurde mit einem eindeutigen Schl√ºssel verschl√ºsselt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Am Anfang der CD befanden sich spezielle ‚ÄûSicherheitssektoren‚Äú, um die Lizenzierung zu best√§tigen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausf√ºhrbare Dateien auf der Festplatte wurden digital signiert</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dem Schutz des DVD-Laufwerks wurde jedoch viel weniger Aufmerksamkeit geschenkt als dem Hauptsystem. </font><font style="vertical-align: inherit;">Die Spielekonsole zeigte zu viel Vertrauen in das DVD-Laufwerk - es war die DVD-ROM, die die Lizenzierung der Disc bestimmte. </font><font style="vertical-align: inherit;">Dar√ºber hinaus wurde die Firmware im externen Speicher gespeichert und konnte vom Programmierer gelesen werden:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5a/o7/kl/5ao7klzogqyesre2uhamzj46bt4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen ver√∂ffentlichte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commodore4eva</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (c4eva) </font><font style="vertical-align: inherit;">am 14. Mai 2006 </font><font style="vertical-align: inherit;">die erste modifizierte Firmware f√ºr das TS-H943-Modell:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">README f√ºr die Firmware-Version</font></font></b>
                        <div class="spoiler_text"><blockquote> ‚Äî Xtreme firmware for TS-H943 Xbox 360<br>
 ‚Äî Here it is, the long awaited World first Xbox 360 backup firmware modification to boot all game backups!<br>
<br>
Features<br>
 ‚Äî Boots all Xtreme Xbox 360 backups<br>
Boots all Xtreme Xbox 1 backups<br>
Boots all Xbox 360 originals<br>
Boots all Xbox 1 originals on Xbox 360<br>
Xtreme0800 extraction firmware enables drive to function natively under Windows without any hardware conversion/adaptors<br>
Use on Xbox Live at own risk<br>
<br>
Technical details<br>
 ‚Äî Reads Xbox 360 security sector from PSN 04FB1F (Layer 0)<br>
Reads Xbox 1 security sector from PSN 605FF (Layer 0)<br>
Security sector must be extrated using Xtreme0800 360 firmware for Xbox360 games and Xbox 1 games<br>
Will not boot Xbox 1 backups made with Xbox1 605b 0800 firmware (maybe in future release)</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Firmware las Sicherheitssektoren aus festen Bereichen auf einer DVD und betrog die Konsole, sodass sie den Eindruck erweckte, dass eine lizenzierte Disc eingelegt wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig wurde die Firmware 0800 ver√∂ffentlicht, mit der Kopien von Spielen erstellt und Sicherheitssektoren gelesen werden k√∂nnen. </font><font style="vertical-align: inherit;">Das Xbox 360-Laufwerk, das mit einer solchen Firmware geflasht wurde, wurde auf dem Computer erkannt und konnte die Sektoren der Spiel-CD vollst√§ndig lesen.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">README zur Verwendung der 0800-Firmware</font></font></b>
                        <div class="spoiler_text"><blockquote>Extracting Security Sector<br>
 ‚Äî Ensure DVD drive has been flashed with Xtrm0800.bin firmware. Drive can now work under Windows.<br>
Insert original game disk into drive and wait for windows to detect disk change<br>
Run DVDinfoPro<br>
Enter the following four custom cdb commands:<br>
<br>
AD 00 FF 02 FD FF FE 00 08 00 01 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 03 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 05 C0<br>
AD 00 FF 02 FD FF FE 00 08 00 07 C0<br>
<br>
Then save hexadecimal display as bin file as SS.bin<br>
<br>
Creating a game backup<br>
 ‚Äî Ensure DVD drive has been flashed with Xtrm0800.bin firmware. Drive can now work under Windows.<br>
Extract Isobuilder.rar<br>
Insert original game disk into drive and wait for windows to detect disk change<br>
Run DVDinfoPro<br>
Enter the following custom cdb command to unlock drive: (game data visable)<br>
<br>
FF 08 01 01<br>
<br>
Run Isobuster<br>
Right click on DVD and select Extract From-To<br>
Click Length and enter number of LBAs as follows:<br>
 <br>
Xbox 1 Original Number of LBA to read 3431264 decimal<br>
or<br>
Xbox 360 Original Number of LBA to read 3567872 decimal<br>
Select User Data (2048 bytes/block)<br>
Click Start Extraction<br>
Enter filename as game.iso and click Save<br>
Upon read error dialogue box choose fill with blank zeros for sector and select use this selection for all errors<br>
Copy game.iso and ss.bin to the relevent isobuilder directory (Depending on Xbox 360 or Xbox 1 game)<br>
Run build360.bat (Xbox 360 game) or build.bat (xbox 1 game)<br>
Ensure your burner will set the booktype of DVD+R DL to DVDRom<br>
Burn with CloneCd and choose the image.dvd file</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderes Spiel k√∂nnte teilweise mit dem folgenden Trick kopiert werden:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legen Sie in eine Computer-DVD-ROM gew√∂hnliche Zweischicht-Disc</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warten Sie, bis es sich beruhigt und nicht mehr dreht</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffnen Sie mit einer B√ºroklammer das Fach und wechseln Sie das Laufwerk von der Xbox 360 zum Spiel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlie√üen Sie das Fach und erstellen Sie ein Disk-Image!</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Es funktionierte nicht bei allen DVD-ROM-Modellen.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Wichtigste ist, dass das Laufwerk ausschlie√ülich per Software mit speziellen ATA-Befehlen geflasht wurde. </font><font style="vertical-align: inherit;">Das Kit enthielt ein spezielles Programm zum Lesen der Original-Firmware und zum modifizierten Schreiben. </font><font style="vertical-align: inherit;">In der urspr√ºnglichen Firmware wurde der gesch√§tzte Schl√ºssel gespeichert, mit dem das Laufwerk an die Xbox 360 gebunden wurde:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s-/wx/yx/s-wxyxr4fyq6ljzpdzc29atqs_k.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Verlust des Schl√ºssels f√ºhrte dazu, dass selbst lizenzierte Festplatten nicht gestartet werden konnten. Einige schrieben den Schl√ºssel in ein Notizbuch und speicherten ihn, wo immer dies m√∂glich war. Dies war das am meisten gesch√§tzte Wissen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein separates Thema war die Panik √ºber das Online-Spiel. </font><font style="vertical-align: inherit;">Alle hatten Angst, dass Microsoft herausfinden w√ºrde, dass das Laufwerk ge√§ndert wurde, und die Konsole remote deaktivieren w√ºrde. </font><font style="vertical-align: inherit;">Einige haben sogar einen Hardware-Mod entwickelt, um zwischen werkseitiger und modifizierter Firmware zu wechseln:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/te/wn/mn/tewnmnkmlplgwxbqzvi188hrayk.jpeg" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie spielten auf der urspr√ºnglichen Firmware "in Lizenz" und trennten sie mit einer Verbindung zum Netzwerk sch√§ndlich √ºber das modifizierte Internetkabel. </font><font style="vertical-align: inherit;">√úbrigens war die Panik nicht umsonst, aber solche Mods waren v√∂llig umsonst, alles wurde protokolliert, ohne eine Verbindung zum Netzwerk herzustellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Genau einen Monat sp√§ter (15. Juni 2006) wurde die Firmware auf ein anderes Laufwerksmodell portiert, das zu diesem Zeitpunkt auf der Xbox 360 installiert war - Hitachi GDR3120L. </font><font style="vertical-align: inherit;">Er hatte auch ein externes Flash-Laufwerk mit Firmware:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-3/76/nu/-376nus9derd_0hbua6rsxwr3xm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Laufwerk war besser gesch√ºtzt:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Firmware wurde verschl√ºsselt im ROM gespeichert</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gab eine Integrit√§tskontrolle in der Firmware</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um die Firmware zu √ºberschreiben, musste man in einen speziellen ‚ÄûModus B‚Äú wechseln.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wenn die Forscher die ersten beiden Punkte selbst schafften, sollte das Kunstst√ºck der √úbersetzung in ‚ÄûModus B‚Äú von allen </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jungen</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Blinkern </font><font style="vertical-align: inherit;">wiederholt werden </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wurde vorgeschlagen, diese Aktion mit einer speziellen Bootdiskette unter Slax Linux oder durch Kurzschlie√üen der Kabel beim Start durchzuf√ºhren. </font><font style="vertical-align: inherit;">Die Kontakte 0 und 9 des Antriebsstromanschlusses mussten kurzgeschlossen werden. </font><font style="vertical-align: inherit;">Zum Beispiel mit Stiften!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wz/wu/rd/wzwurdo3ymtphwolno8mzc5zhew.png" width="350"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In beiden F√§llen wurde das Laufwerk nach solchen Missbr√§uchen in Windows als normales DVD-Laufwerk definiert, auf dem es aufgenommen, </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vergewaltigt</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font><font style="vertical-align: inherit;">zusammengef√ºgt wurde.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/n1/kg/lm/n1kglmch5iqrprr6g77nqks6fd4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der ersten Ver√∂ffentlichung wurden benutzerdefinierte Firmwares fertiggestellt, die Stabilit√§t verbessert und die Unterst√ºtzung f√ºr neue Spiele hinzugef√ºgt. Im Allgemeinen war alles wie gewohnt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft Antwort</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Entwickler zu den Vorw√ºrfen, dass die "unzerbrechliche" Konsole gehackt wurde, antworteten einfach:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das System wurde nicht gehackt, wir haben gerade gelernt, wie man Kopien von Spielen startet, wir arbeiten daran</font></font></blockquote><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">urspr√ºngliche Antwort</font></font></b>
                        <div class="spoiler_text"><blockquote>The core security system has not been broken. However, it is reported that the authentication protocol between the optical disc drive and the console may be attacked, which if accurate could allow people to play illegally copied games. Our security team is aware of this and we are investigating potential solutions to this issue. The Xbox 360 platform was designed to be updated, and we are prepared to respond appropriately should any unauthorized activity be identified.</blockquote></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was wurde wirklich getan, um die Situation zu korrigieren:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samsung TS-H943 wurde mit der ms28-Firmware ausgeliefert, die durch den bekannten ATA-Befehl nicht in den Firmware-Modus wechselte</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hitachi GDR3120L erschien mit den Firmware 0078 und 0079 und blinkte auch im Modus B nicht</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue BenQ-LiteOn VAD6038-Laufwerke werden angezeigt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ersten spitzen "Verbote" von Piraten auf Xbox Live begannen, Piraten war es verboten, f√ºr immer online zu spielen</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn mit dem Verbot (zu diesem Zeitpunkt) alles eindeutig und irreparabel war, fanden die Forscher bald die Antriebe heraus:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºr Hitachi wurde das Entsperren des Firmware-Modus √ºber eine spezielle Audio-Disc gefunden</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/yl/ub/roylub2mkued2crcyqyetarr6qw.png"></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samsung ms28 und BenQ VAD6038 sind √ºber kosteng√ºnstige SATA VIA 6421-Controller perfekt in den Firmware-Modus √ºbergegangen</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/in/ns/wk/innswkumj-p0xyc1587hl--lh0w.png" width="433"></div></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verlassen wir das Schlachtfeld f√ºr eine Weile mit der Firmware f√ºr Laufwerke. Es gab keine sehr interessante Zeit, in der Forscher versuchten, "Stealth" -Firmware zu erstellen, um nicht von Xbox Live gebannt zu werden. Passen Sie sich neuen Spielen mit neuen "Wellen" an - Systemaktualisierungsversionen und portieren Sie die Ergebnisse auf alles eine wachsende Auswahl an Firmware und Laufwerken. </font><font style="vertical-align: inherit;">Trotzdem wurde alles zusammengef√ºgt, die "Backups" wurden erfolgreich gestartet, die Xbox 360 wurde bei den Leuten immer beliebter ...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Achse brechen!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sich aus dem ersten Teil der Geschichte erinnern, verf√ºgte das Xbox 360-System √ºber einen Hypervisor, der alles und jeden kontrollierte. </font><font style="vertical-align: inherit;">Also. </font><font style="vertical-align: inherit;">In einer Version des Systems trat pl√∂tzlich eine Sicherheitsl√ºcke auf! </font><font style="vertical-align: inherit;">Wie genau die Forscher die Hypervisor-Codebeispiele erhalten haben, ist mir nicht sicher. </font><font style="vertical-align: inherit;">Tatsache ist jedoch, dass die Forscher Ende 2006 nicht signierten Code auf der Xbox 360 ver√∂ffentlicht haben. Anfang 2007 wurde die Sicherheitsanf√§lligkeit von den Entwicklern behoben:</font></font><br>
<blockquote>Timeline:<br>
 Oct 31, 2006 ‚Äî release of 4532 kernel, which is the first version containing the bug<br>
 Nov 16, 2006 ‚Äî proof of concept completed; unsigned code running in hypervisor context<br>
 Nov 30, 2006 ‚Äî release of 4548 kernel, bug still not fixed<br>
 Dec 15, 2006 ‚Äî first attempt to contact vendor to report bug<br>
 Dec 30, 2006 ‚Äî public demonstration<br>
 Jan 03, 2007 ‚Äî vendor contact established, full details disclosed<br>
 Jan 09, 2007 ‚Äî vendor releases patch<br>
 Feb 28, 2007 ‚Äî full public release</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Hypervisor hatte eine Funktion - im Gegensatz zum Rest des Codes wurde er nicht im virtuellen Adressraum ausgef√ºhrt, sondern im physischen (Real-Modus). Die Sendung wurde nicht verwendet, Anrufe wurden direkt get√§tigt (Adressen der Form 0x00000000'xxxxxx). Entweder wurde dies aus Gr√ºnden der Geschwindigkeit oder der Einfachheit halber durchgef√ºhrt ... Und hier war eine Funktion des Xbox 360-Adressraums: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zugriffsmodus auf den Speicher wurde durch seine physische Adresse bestimmt. Die wichtigsten Bits der Adresse hatten n√§mlich einen offiziellen Zweck. Beispielsweise bedeutete die Adresse 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'0000201C direkten Zugriff auf die Adresse 0x201C, und 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'0000201C bedeutete, dass Sie die Integrit√§t im </font><font style="vertical-align: inherit;">laufenden </font><font style="vertical-align: inherit;">Betrieb entschl√ºsseln und √ºberpr√ºfen m√ºssen, wenn Sie dieselbe physische Adresse 0x201C lesen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/t6/nz/dv/t6nzdvvz2hzrfkhx_2ti24hgey4.png" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend m√ºssen Sie sich auf Adressen wie 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx </font><font style="vertical-align: inherit;">beziehen, damit die Ausf√ºhrung mit aktivierter Verschl√ºsselung und aktiviertem Schutz ausgef√ºhrt werden </font><font style="vertical-align: inherit;">kann. Erst dann enthielt das Hardwaremodul Schutzmechanismen. Daher wurde auf Hardwareebene das gew√ºnschte Bit automatisch hinzugef√ºgt (das spezielle HRMOR-Register war daf√ºr verantwortlich - Hypervisor Real Mode Offset Register)! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Noch einmal - sobald der Hypervisor auf eine Adresse wie 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx zugreift, √§ndert die MMU diese Adresse automatisch in 0x00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00'xxxxxxxx, einschlie√ülich Verschl√ºsselung und Schutz! Versuche, den Code "direkt" aus dem physischen Speicher ohne Schutz und Verschl√ºsselung auszuf√ºhren, sind zum Scheitern verurteilt ... oder nicht? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns den anf√§lligen Code der Hypervisor-Version 4532 an:</font></font><br>
<blockquote><code>// %r0 ‚Äì   <br>
 13D8: cmplwi %r0, 0x61 //    ID<br>
 13DC: bge illegal_syscall //    0x61, ,  <br>
 ...<br>
 13F0: rldicr %r1, %r0, 2, 61 //     4<br>
 13F4: lwz %r4, syscall_table(%r1) //    <br>
 13F8: mtlr %r4 //     lr<br>
 ...<br>
 1414: blrl //   </code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sehen Sie den Gopher? Aber er ist! Der Befehl Cmplwi funktioniert mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32-Bit-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Werten, aber rldicr - mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64-Bit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! Das hei√üt, wir k√∂nnen den Wert 0x20000000'0000002A als Systemrufnummer angeben, er besteht den Test (da der untere 32-Bit-Teil kleiner als 0x61 ist), und als Ergebnis wird anstelle der Adresse 0x10EC die Adresse des Handlers von 0x80000000'000010EC √ºbernommen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann, wie sie sagen, pass auf deine H√§nde auf. Die h√∂chstwertigen Bits der Adresse sind nicht gleich Null, HRMOR wird </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht hinzugef√ºgt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! Und da der reale Adressraum 32-Bit ist, wird das von uns festgelegte 63-Bit einfach ignoriert. Wir haben den Hypervisor in den unverschl√ºsselten und unsicheren Speicher umgeleitet, indem wir einfach eine falsche Systemrufnummer √ºbermittelt haben!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q8/z8/hv/q8z8hv9wgxghllkyugudx1btvl4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber warten Sie, damit wir springen k√∂nnen, m√ºssen wir in der Lage sein, unsere Daten in den physischen Speicher zu schreiben. </font><font style="vertical-align: inherit;">Wie erreicht man das? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier kommt der zweite Faktor ins Spiel - die GPU auf der Xbox 360 war intelligent, sogar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intelligent. </font><font style="vertical-align: inherit;">Er unterst√ºtzte eine spezielle Shader-Anweisung, MemExport, zum Hochladen von Geometriedaten in den physischen Speicher. </font><font style="vertical-align: inherit;">Das hei√üt, Sie k√∂nnen den Shader kompilieren, auf der GPU ausf√ºhren und damit √ºberall etwas aufzeichnen! </font><font style="vertical-align: inherit;">Und am wichtigsten ist, dass die Shader nicht signiert wurden. Wenn Sie die Spiel-CD in irgendeiner Weise √§ndern, k√∂nnen Sie den Shader-Code problemlos ersetzen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vt/mm/wo/vtmmwojgxidc5w2rqddzefplfmo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Frage blieb offen. </font><font style="vertical-align: inherit;">Wie ersetze ich den Shader-Code auf der Spiel-CD? </font><font style="vertical-align: inherit;">Und hier war das Hacken des DVD-Laufwerks der Konsole sehr n√ºtzlich. </font><font style="vertical-align: inherit;">Wir haben einen Shader geschrieben, ihn im Image des Spiels ersetzt, auf einer CD aufgezeichnet und Linux gestartet!</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_k/at/nw/_katnwvzekryqwntrpu_irji5py.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, um es auszuf√ºhren, musste ich das Spiel jedes Mal starten, warten, bis der Exploit funktioniert, die Bootdiskette unter Linux stellen, aber das war zumindest etwas! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bereits erw√§hnt, hat Microsoft ein Systemupdate ver√∂ffentlicht, mit dem die Sicherheitsanf√§lligkeit des Hypervisors behoben wurde. </font><font style="vertical-align: inherit;">Aber was ist, wenn Sie einen anf√§lligen Kernel zur√ºckgeben?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Downgrade!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen wurde die Architektur der Xbox 360 vor Downgrade gesch√ºtzt. </font><font style="vertical-align: inherit;">In den Prozessor-Hardware-Sicherungen wurde jedes Mal, wenn das n√§chste Bit w√§hrend des Upgrades gebrannt wurde (Sperrwert, LDV erh√∂ht), und wenn diese LDV in den Sicherungen und im System nicht √ºbereinstimmte, wurde die Konsole einfach nicht gestartet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie die Xbox 360-Bootloader-Struktur, n√§mlich "Bootloader-Abschnitte":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/dh/9l/dwdh9lbenpvavf7gl6qeu8n_ks4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist ersichtlich, dass das Bild mehrere S√§tze von Bootloadern enth√§lt, von denen jeder einem LDV entspricht. In diesem Beispiel sind dies </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1888</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr LDV 0, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16767</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr LDV 3 und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16756</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr LDV 2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Aktualisierungen des Systems selbst wurden in den Abschnitten 6BL / 7BL aufgezeichnet und einfach als Patches auf den Basis- "Kern" 5BL </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1888</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "angewendet" </font><font style="vertical-align: inherit;">. Aber welcher Satz von Patches angewendet werden sollte, wurde gem√§√ü dem vorgeschriebenen LDV in den Sicherungen und Bootloader-Headern ausgew√§hlt! Und gerade bei 5BL konnte der Header mit einem gro√üen ABER ge√§ndert werden - der Header wurde mit der darin aufgezeichneten HMAC-SHA-1-Hash-Summe verglichen. Und es wurde von gew√∂hnlichen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºberpr√ºft </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie immer noch nicht verstehen, wohin die Dinge gehen, haben Sie hier einen Zeitangriff (Timing Attack) durchgef√ºhrt. Die Standardfunktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> schlie√üt den Vergleich unmittelbar nach der ersten Diskrepanz ab. Daher k√∂nnen Sie durch √Ñndern des ersten Bytes des Hashs und Erkennen der Laufzeit von memcmp den gew√ºnschten Wert ausw√§hlen (die √úberpr√ºfungszeit erh√∂ht sich damit). Wenn Sie weiter fortfahren, k√∂nnen Sie alle Bytes der Hash-Summe abrufen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Messung wurde der Debug-Bus POST_OUT verwendet. Es funktioniert wie ein PC. Zu verschiedenen Ladezeiten wird ein Einzelbyte-Wert angezeigt, anhand dessen Sie beurteilen k√∂nnen, wo der Prozessor gerade ausgef√ºhrt wird und welcher Fehler aufgetreten ist. Tats√§chlich sind dies 8 Punkte auf dem Motherboard, von denen jeder f√ºr einen bestimmten Wert verantwortlich ist:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/12/vk/s0/12vks0mejlztfsokeo1dkdjq_he.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie an diese Punkte gel√∂tet haben, k√∂nnen Sie einfach die Ausf√ºhrungszeit jeder Download-Phase messen und feststellen, ob ein Fehler aufgetreten ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der gesamte Prozess der Hash-Auswahl dauert ungef√§hr eine Stunde:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3d/am/0j/3dam0jhxheubnuc-mgfznhomhrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten wir ein Image, in dem das aktuelle LDV f√ºr den Kernel installiert ist, wodurch keine Patches angewendet werden und die √§lteste Version des 1888-Systems gestartet wird! </font><font style="vertical-align: inherit;">Von wo aus ist es bereits m√∂glich, auf die anf√§llige Version 4532 zu aktualisieren:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/_m/iz/sj_mizzzybdy41ia6wm30umwbt8.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/xi/b6/bzxib6g2blchf0dxcw6a2lethsu.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich hat Microsoft diese Sicherheitsanf√§lligkeit behoben, indem der allererste aktualisierte Bootloader (2BL, "CB") aktualisiert und die CBLDV-Sicherung gebrannt wurde, wodurch ein Downgrade erneut unm√∂glich wurde. </font><font style="vertical-align: inherit;">Jetzt wurde anstelle von memcmp die sichere Version mit derselben Laufzeit verwendet, unabh√§ngig von den Eingabewerten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG Hack!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber hier gaben die Forscher nicht auf und fanden eine L√ºcke. </font><font style="vertical-align: inherit;">Ja, so dass sich die Entwickler das gar nicht vorstellen konnten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im normalen Betriebsmodus der Konsole sind alle Bootloader in einer Kette miteinander verbunden. </font><font style="vertical-align: inherit;">Infolgedessen h√§ngt die Entschl√ºsselung jedes Bootloaders vom Datenbereich im Header des vorherigen Bootloaders ab (Pairing Data). </font><font style="vertical-align: inherit;">Dar√ºber hinaus h√§ngt die Verschl√ºsselung des Codes vom eindeutigen Prozessorschl√ºssel ab, sodass Sie kein Arbeitsimage erstellen und zusammenstellen k√∂nnen, ohne CPU_Key zu kennen. </font><font style="vertical-align: inherit;">Oder ist es m√∂glich? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Konsolenproduktionsphase (wenn der Prozessorschl√ºssel noch nicht in Sicherungen gebrannt wurde) wird ein spezieller Xbox 360-Startmodus verwendet, wenn das Pairing von Daten Null ist (Zero-Pairing). </font><font style="vertical-align: inherit;">Und ein solches Image (mit einem anf√§lligen Kernel!) Kann auf jeder Konsole ausgef√ºhrt werden, ohne den Prozessorschl√ºssel zu kennen!</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider wird es keinen vollst√§ndigen Start geben. Dieser Fehler wird folgenderma√üen aussehen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/db/zq/t-/dbzqt-_ppnq1xsfd0lntr7gdn14.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, das King Kong-Spiel kann nicht gestartet werden, der Exploit durch Shader kann nicht aktiviert werden ... Aber der anf√§llige Kernel startet bereits! </font><font style="vertical-align: inherit;">Vielleicht gibt es eine andere M√∂glichkeit, den RAM aufzuzeichnen? </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass es gibt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Anfang l√∂ten wir drei freie GPIOs der S√ºdkonsole der Konsole an die GPU-JTAG-Pins:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/54/ut/e5/54ute5q1civmpzgs6vx43kyjpr8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann √§ndern wir die Firmware der South Bridge (sie ist verschl√ºsselt, aber nicht signiert) und sammeln das Image mit dem anf√§lligen Kernel. </font><font style="vertical-align: inherit;">Dann passiert die Magie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beim Start klettert die S√ºdbr√ºcke der JTAG-GPU auf PCI Express und konfiguriert den NAND-Controller </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beim Lesen schreibt der NAND-Controller nun Daten in den von uns ben√∂tigten Speicherbereich</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Kern des Systems startet und informiert die S√ºdbr√ºcke dar√ºber, dass das System gestartet wurde</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die S√ºdbr√ºcke zieht den NAND-Controller, √ºberschreibt den RAM an der richtigen Stelle und nutzt die Schwachstelle des Hypervisors aus!</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Kontrolle wird auf unseren Code √ºbertragen. Tun Sie, was wir wollen</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kurz gesagt, sie haben alles genauso gemacht wie in King Kong Shader Exploit, aber cooler - es ist nicht n√∂tig, das Spiel zu starten und die Discs zu wechseln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Grundlage von JTAG Hack wurden modifizierte Versionen des Systems erstellt - XBReboot, Freeboot mit deaktivierter Signatur√ºberpr√ºfung, bei denen bereits Piraten herumliefen. Spiele k√∂nnen nicht nur von USB-Laufwerken und -Disketten gestartet werden, sondern auch √ºber das SMB-Protokoll direkt von einem Computer aus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fn/6k/0x/fn6k0xazskez18wwj8v1nnude-c.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wichtig ist, dass ein vollwertiger System-Hack denjenigen eine Chance gab, die den DVD-Schl√ºssel verloren hatten und nicht abspielen konnten. Mit dem Prozessorschl√ºssel war es nicht schwierig, den DVD-Schl√ºssel zu extrahieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich hat Microsoft hier die Sicherheitsanf√§lligkeit schnell geschlossen, 2BL erneut aktualisiert und den Wert von CBLDV erh√∂ht. Damit endete das Epos des anf√§lligen Hypervisors, und die Leute rannten los, um die Reste der "JTAG-kompatiblen" Konsolen in Gesch√§ften zu kaufen - jeder wollte problemlos mit USB-Sticks spielen. In Foren wurden Diskussionen dar√ºber gef√ºhrt, welche Bundles mit welchem ‚Äã‚ÄãVer√∂ffentlichungsdatum zum Hacken geeignet sind ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Thema √Ñnderungen am Xbox 360-System blieb fast zwei Jahre lang stehen, aber das Thema Firmware entwickelte sich weiter. Und gerade in der Firmware der LiteOn-Laufwerke brach der umfangreichste Kampf zwischen Forschern und Microsoft aus. Aber mehr dazu im n√§chsten Artikel :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GoogleTechTalks-Bericht</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">King Kong Hack </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timing Attack </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG / SMC Hack </font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360 Schutz und Hacking, Teil 1 Xbox 360 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutz und Hacking, Teil 2 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360 Schutz und Hacking, Teil 3</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS Wer sich f√ºr Details interessiert, werde alle Fragen zum Thema in den Kommentaren beantworten!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491622/index.html">Prognostizieren Sie Finanzkrisen mit Python</a></li>
<li><a href="../de491624/index.html">Erstellen eines Gliederungseffekts in der Unity Universal Render-Pipeline</a></li>
<li><a href="../de491628/index.html">Spelunky als Beispiel f√ºr gutes Spieldesign</a></li>
<li><a href="../de491630/index.html">Firefox Browser Extensions App (WebExtensions)</a></li>
<li><a href="../de491632/index.html">Digitale Unsterblichkeit - Synchrones Internet</a></li>
<li><a href="../de491636/index.html">GRASP-Vorlagen: Informationsexperte</a></li>
<li><a href="../de491638/index.html">Wolke 1C. Alles ist wolkenlos</a></li>
<li><a href="../de491640/index.html">Wird Big Data seine Versprechen halten?</a></li>
<li><a href="../de491642/index.html">Wie wir bei Alconost Videos machen und wie der Kunde daran teilnimmt</a></li>
<li><a href="../de491644/index.html">W√§hlen Sie ein Plugin f√ºr die Zwei-Faktor-Authentifizierung in Wordpress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>