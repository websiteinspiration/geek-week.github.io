<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ¼ ğŸ‘©â€ğŸ’¼ ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ Kubernetes ConfigMapsï¼šè¦çŸ¥é“çš„ç»†èŠ‚ ğŸŒ› ğŸ¤« ğŸ˜¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ³¨æ„ï¼šè¿™ä¸æ˜¯å®Œæ•´çš„æŒ‡å—æ–‡ç« ï¼Œè€Œæ˜¯å¯¹å·²ç»åœ¨Kubernetesä¸­ä½¿ç”¨ConfigMapæˆ–åªæ˜¯å‡†å¤‡å…¶åº”ç”¨ç¨‹åºä»¥ä¾›ä½¿ç”¨çš„é‚£äº›äººçš„æé†’/æç¤ºã€‚
 
 
 
 èƒŒæ™¯ï¼šä»rsyncåˆ°... Kubernetes
 ä¹‹å‰å‘ç”Ÿä»€ä¹ˆäº‹äº†ï¼Ÿåœ¨â€œç»å…¸ç®¡ç†â€æ—¶ä»£ï¼Œæœ€ç®€å•çš„ç‰ˆæœ¬æ˜¯å°†é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨åº”ç”¨ç¨‹åºçš„æ—è¾¹ï¼ˆå¦‚æœéœ€è¦ï¼Œä¹Ÿå¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kubernetes ConfigMapsï¼šè¦çŸ¥é“çš„ç»†èŠ‚</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/498970/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¿™ä¸æ˜¯å®Œæ•´çš„æŒ‡å—æ–‡ç« ï¼Œè€Œæ˜¯å¯¹å·²ç»åœ¨Kubernetesä¸­ä½¿ç”¨ConfigMapæˆ–åªæ˜¯å‡†å¤‡å…¶åº”ç”¨ç¨‹åºä»¥ä¾›ä½¿ç”¨çš„é‚£äº›äººçš„æé†’/æç¤ºã€‚</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/_h/ly/ln/_hlylnaruzb2_b5zhbjpinrdphy.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èƒŒæ™¯ï¼šä»rsyncåˆ°... Kubernetes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹å‰å‘ç”Ÿä»€ä¹ˆäº‹äº†ï¼Ÿåœ¨â€œç»å…¸ç®¡ç†â€æ—¶ä»£ï¼Œæœ€ç®€å•çš„ç‰ˆæœ¬æ˜¯å°†é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨åº”ç”¨ç¨‹åºçš„æ—è¾¹ï¼ˆå¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥æ”¾ç½®åœ¨å­˜å‚¨åº“ä¸­ï¼‰ã€‚å¾ˆç®€å•ï¼šæˆ‘ä»¬ä¸ºä»£ç å’Œé…ç½®ä¸€èµ·åˆ¶ä½œåŸºæœ¬äº¤ä»˜ï¼ˆCDï¼‰ã€‚ç”šè‡³æœ‰æ¡ä»¶çš„rsyncå®ç°éƒ½å¯ä»¥ç§°ä¸ºCDçš„é›å½¢ã€‚</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éšç€åŸºç¡€æ¶æ„çš„å‘å±•ï¼Œä¸åŒçš„ç¯å¢ƒï¼ˆå¼€å‘/é˜¶æ®µ/ç”Ÿäº§ï¼‰éœ€è¦ä¸åŒçš„é…ç½®ã€‚å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œäº†åŸ¹è®­ï¼Œä»¥äº†è§£ä½¿ç”¨å“ªä¸ªé…ç½®ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå¯åŠ¨å‚æ•°æˆ–ç¯å¢ƒä¸­è®¾ç½®çš„ç¯å¢ƒå˜é‡ä¼ é€’ã€‚éšç€è¿™æ ·æœ‰ç”¨çš„Chef / Puppet / Ansibleçš„å‡ºç°ï¼Œæ›´å¤šçš„CDå˜å¾—æ›´åŠ å¤æ‚ã€‚è§’è‰²å‡ºç°åœ¨æœåŠ¡å™¨ä¸Šï¼Œç¯å¢ƒä¸å†åœ¨ä¸åŒçš„åœ°æ–¹æè¿°-æˆ‘ä»¬æ¥åˆ°IaCï¼ˆå³ä»£ç åŸºç¡€æ¶æ„ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¯èƒ½çœ‹åˆ°Kubernetesæœ¬èº«çš„å…³é”®ä¼˜åŠ¿ï¼Œç”šè‡³éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºä½¿å…¶åœ¨è¿™ç§ç¯å¢ƒä¸‹å·¥ä½œï¼Œé‚£ä¹ˆè¿ç§»å°±å‘ç”Ÿäº†ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œæˆ‘æœŸæœ›åœ¨æ¶æ„çš„æ„é€ ä¸Šæœ‰ç»†å¾®çš„å·®åˆ«å’Œå·®å¼‚ï¼Œä½†æ˜¯å½“æˆ‘è®¾æ³•åº”ä»˜ä¸»è¦éƒ¨åˆ†æ—¶ï¼Œæˆ‘å¾—åˆ°äº†æœŸå¾…å·²ä¹…çš„åœ¨K8sä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ°è¾¾è¿™é‡Œåï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨åœ¨åº”ç”¨ç¨‹åºæ—è¾¹çš„å­˜å‚¨åº“ä¸­å‡†å¤‡çš„é…ç½®ï¼Œæˆ–è€…å°†ENVä¼ é€’ç»™å®¹å™¨ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œé™¤äº†è¿™äº›æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfigMaps</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™ä¸ªK8såŸè¯­å…è®¸æ‚¨åœ¨é…ç½®ä¸­ä½¿ç”¨Goæ¨¡æ¿ï¼Œå³ </font><font style="vertical-align: inherit;">å‘ˆç°å®ƒä»¬å°±åƒHTMLé¡µé¢ä¸€æ ·ï¼Œå¹¶åœ¨æ›´æ”¹é…ç½®æ—¶é‡æ–°åŠ è½½åº”ç”¨ç¨‹åºè€Œæ— éœ€é‡æ–°å¯åŠ¨ã€‚</font><font style="vertical-align: inherit;">æœ‰äº†ConfigMapï¼Œä¸å†éœ€è¦ä¸ºä¸åŒçš„ç¯å¢ƒä¿ç•™3ä¸ªä»¥ä¸Šçš„é…ç½®å¹¶è·Ÿè¸ªæ¯ä¸ªç¯å¢ƒçš„ç›¸å…³æ€§ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œå¯ä»¥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°ConfigMapçš„ä¸€èˆ¬ä»‹ç»</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»ä¸å®ƒä»¬åˆä½œçš„ä¸€äº›åŠŸèƒ½ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç®€å•çš„ConfigMap</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetesä¸­çš„é…ç½®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</font><font style="vertical-align: inherit;">ä»–ä»¬ä»æ¨¡æ¿ä¸­å¾—åˆ°äº†ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œè¿™æ˜¯ä»Helmå›¾è¡¨éƒ¨ç½²çš„åº”ç”¨ç¨‹åºçš„æ™®é€šConfigMapï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">apiVersion: v1<font></font>
kind: ConfigMap<font></font>
metadata:<font></font>
  name: app<font></font>
data:<font></font>
  config.json: |<font></font>
    {<font></font>
      "welcome": {{ pluck .Values.global.env .Values.welcome | quote }},<font></font>
      "name": {{ pluck .Values.global.env .Values.name | quote }}<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤„çš„å€¼æ›¿æ¢ä¸º</font></font><code>.Values.welcome</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å°†</font></font><code>.Values.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ–‡ä»¶ä¸­è·å–</font></font><code>values.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆç¡®åˆ‡åœ°æ¥è‡ª</font></font><code>values.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Ÿ</font><font style="vertical-align: inherit;">Goæ¨¡æ¿å¼•æ“å¦‚ä½•å·¥ä½œï¼Ÿ</font><font style="vertical-align: inherit;">æˆ‘ä»¬å·²ç»åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´è¯¦ç»†åœ°è®¨è®ºäº†è¿™äº›ç»†èŠ‚</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥å‘¼å«</font></font><code>pluck</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰åŠ©äºä»åœ°å›¾ä¸­é€‰æ‹©å¿…è¦çš„è·¯çº¿ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">$ cat .helm/values.yaml <font></font>
welcome:<font></font>
  production: "Hello"<font></font>
  test: "Hey"<font></font>
name:<font></font>
  production: "Bob"<font></font>
  test: "Mike"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œæ‚¨å¯ä»¥åŒæ—¶ä½¿ç”¨é…ç½®çš„ç‰¹å®šè¡Œå’Œæ•´ä¸ªç‰‡æ®µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼ŒConfigMapå¯èƒ½åƒè¿™æ ·ï¼š</font></font><br>
<br>
<pre><code class="json hljs">data:<font></font>
  config.json: |<font></font>
    {{ pluck .Values.global.env .Values.data | first | toJson | indent 4 }}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...ä»¥åŠ</font></font><code>values.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ä»¥ä¸‹å†…å®¹ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">data:<font></font>
  production:<font></font>
    welcome: "Hello"<font></font>
    name: "Bob"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œæ¶‰åŠçš„</font></font><code>global.env</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ç¯å¢ƒçš„åç§°ã€‚</font><font style="vertical-align: inherit;">åœ¨éƒ¨ç½²æœŸé—´æ›¿æ¢æ­¤å€¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å†…å®¹å‘ˆç°ConfigMapã€‚</font></font><code>first</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œéœ€è¦ï¼Œå› ä¸º </font></font><code>pluck</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå…ƒç´ åŒ…å«æ‰€éœ€çš„å€¼ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“æœ‰å¾ˆå¤šé…ç½®æ—¶</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€ä¸ªConfigMapå¯ä»¥åŒ…å«å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="json hljs">data:<font></font>
  config.json: |<font></font>
    {<font></font>
      <span class="hljs-attr">"welcome"</span>: {{ pluck .Values.global.env .Values.welcome | first | quote }},
      <span class="hljs-string">"name"</span>: {{ pluck .Values.global.env .Values.name | first | quote }}<font></font>
    }<font></font>
  database.yml: |<font></font>
    host: <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><font></font>
    db: app<font></font>
    user: app<font></font>
    password: app</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨ç”šè‡³å¯ä»¥åˆ†åˆ«æŒ‚è½½æ¯ä¸ªé…ç½®ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">        volumeMounts:<font></font>
        - name: app-conf<font></font>
          mountPath: /app/configfiles/config.json<font></font>
          subPath: config.json<font></font>
        - name: app-conf<font></font>
          mountPath: /app/configfiles/database.yml<font></font>
          subPath: database.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...æˆ–ä½¿ç”¨ç›®å½•ä¸€æ¬¡è·å–æ‰€æœ‰é…ç½®ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">        volumeMounts:<font></font>
        - name: app-conf<font></font>
          mountPath: /app/configfiles</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœåœ¨éƒ¨ç½²æœŸé—´æ›´æ”¹éƒ¨ç½²èµ„æºçš„æè¿°ï¼ŒKuberneteså°†åˆ›å»ºä¸€ä¸ªæ–°çš„ReplicaSetï¼Œå°†æ—§çš„ReplicaSetå‡å°‘åˆ°0ï¼Œå¹¶å°†æ–°çš„ReplicaSetå¢åŠ åˆ°æŒ‡å®šçš„å‰¯æœ¬æ•°ã€‚</font><font style="vertical-align: inherit;">ï¼ˆå¯¹äºéƒ¨ç½²ç­–ç•¥è€Œè¨€ç¡®å®å¦‚æ­¤</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>RollingUpdate</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ï¼‰</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤ç±»æ“ä½œå°†å¯¼è‡´ä½¿ç”¨æ–°çš„æè¿°é‡æ–°åˆ›å»ºPodã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼šæœ‰ä¸€ä¸ªå›¾åƒ</font></font><code>image:my-registry.example.com:v1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†å˜ä¸º- </font></font><code>image:my-registry.example.com:v2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œæˆ‘ä»¬å¯¹éƒ¨ç½²çš„æè¿°ä¸­æ‰€åšçš„æ›´æ”¹å®Œå…¨æ²¡æœ‰å…³ç³»ï¼šä¸»è¦çš„æ˜¯ï¼Œè¿™å¯¼è‡´é‡æ–°åˆ›å»ºäº†copySetï¼ˆä»¥åŠç»“æœæ˜¯podï¼‰ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºä¸­çš„é…ç½®æ–‡ä»¶çš„æ–°ç‰ˆæœ¬ä¼šè‡ªåŠ¨æŒ‚è½½ï¼Œä¸ä¼šæœ‰é—®é¢˜ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfigMapæ›´æ”¹å“åº”</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœConfigMapå‘ç”Ÿæ›´æ”¹ï¼Œåˆ™å¯ä»¥éµå¾ªå››ä¸ªäº‹ä»¶æ–¹æ¡ˆã€‚</font><font style="vertical-align: inherit;">è€ƒè™‘ä»–ä»¬ï¼š</font></font><br>
<br>
<ol>
<li> <b></b>:  ConfigMap,    subPath.<br>
<b></b>:       .</li>
<li> <b></b>:  ConfigMap,          pod.<br>
<b></b>:  pod     .</li>
<li> <b></b>:  ConfigMap    Deployment     -.<br>
<b></b>:   ,      ConfigMapâ€™,   Deployment,   pod  ,   â€”        .</li>
<li> <b></b>:  ConfigMap,   .<br>
<b></b>:    podâ€™   / podâ€™.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°åˆ†æã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœºæ™¯1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åª</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çº æ­£äº†ConfigMapå—ï¼Ÿ</font><font style="vertical-align: inherit;">è¯¥åº”ç”¨ç¨‹åºå°†ä¸ä¼šé‡æ–°å¯åŠ¨ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿›è¡Œå®‰è£…çš„æƒ…å†µä¸‹ï¼Œ</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é™¤éæ‰‹åŠ¨é‡å¯åŠèˆ±</font><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">å¦åˆ™ä¸ä¼šè¿›è¡Œä»»ä½•æ›´æ”¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼šKuberneteså°†ConfigMapæŒ‚è½½åˆ°ç‰¹å®šç‰ˆæœ¬èµ„æºçš„podä¸­ã€‚</font><font style="vertical-align: inherit;">ç”±äºå·²å®‰è£…</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå› æ­¤ä¸å†æä¾›å¯¹é…ç½®çš„å…¶ä»–â€œå½±å“â€ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ¡ˆ2</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸é‡æ–°åˆ›å»ºPodä¾¿æ— æ³•æ›´æ–°æ–‡ä»¶å—ï¼Ÿ</font><font style="vertical-align: inherit;">å¥½çš„ï¼Œæˆ‘ä»¬åœ¨Deploymentä¸­æœ‰6ä¸ªå‰¯æœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è½®æµæ‰‹åŠ¨è¿›è¡Œæ‰€æœ‰æ“ä½œ</font></font><code>delete pod</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œåœ¨åˆ›å»ºæ–°å®¹å™¨æ—¶ï¼Œå®ƒä»¬å°†â€œæ‹¾å–â€æ–°ç‰ˆæœ¬çš„ConfigMapã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æƒ…å†µ3</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒå€¦äº†æ‰‹åŠ¨æ‰§è¡Œæ­¤ç±»æ“ä½œï¼Ÿ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helmæç¤ºå’ŒæŠ€å·§ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æè¿°äº†æ­¤é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">kind: Deployment<font></font>
spec:<font></font>
  template:<font></font>
    metadata:<font></font>
      annotations:<font></font>
        checksum/config: {{ include (print $.Template.BasePath "/configmap.yaml") . | sha256sum }}<font></font>
[...]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œ</font></font><code>spec.template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»…å°†å‘ˆç°çš„æ³¨é‡Šé…ç½®</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å“ˆå¸Œå€¼å†™å…¥</font><font style="vertical-align: inherit;">podï¼ˆ</font><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">æ¨¡æ¿ä¸­</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³¨é‡Šæ˜¯ä»»æ„é”®å€¼å­—æ®µï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­å­˜å‚¨å€¼ã€‚</font><font style="vertical-align: inherit;">å¦‚æœå°†å®ƒä»¬æ³¨å†Œåˆ°</font></font><code>spec.template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†æ¥çš„Pod </font><font style="vertical-align: inherit;">æ¨¡æ¿ä¸­</font><font style="vertical-align: inherit;">ï¼Œåˆ™è¿™äº›å­—æ®µå°†å±äºReplicaSetå’ŒPodæœ¬èº«ã€‚</font><font style="vertical-align: inherit;">Kuberneteså°†æ³¨æ„åˆ°podæ¨¡æ¿å·²æ›´æ”¹ï¼ˆå› ä¸ºsha256é…ç½®å·²æ›´æ”¹ï¼‰å¹¶ä¸”å°†å¯åŠ¨</font></font><code>RollingUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå…¶ä¸­é™¤æ­¤æ³¨é‡Šå¤–æ²¡æœ‰å…¶ä»–æ›´æ”¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæˆ‘ä»¬ä¿å­˜äº†ç›¸åŒç‰ˆæœ¬çš„Deploymentçš„åº”ç”¨ç¨‹åºå’Œæè¿°ï¼Œå¹¶ä¸”å®é™…ä¸Šåªæ˜¯è§¦å‘äº†podçš„è‡ªåŠ¨é‡æ–°åˆ›å»º-ç±»ä¼¼äºæˆ‘ä»¬æ‰‹åŠ¨å®Œæˆæ“ä½œ</font></font><code>kubectl delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†å·²ç»â€œæ­£ç¡®â€åœ°è¿›è¡Œäº†æ“ä½œï¼šè‡ªåŠ¨å¹¶ä½¿ç”¨</font></font><code>RollingUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ¡ˆ4</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹Ÿè®¸åº”ç”¨ç¨‹åºå·²ç»çŸ¥é“å¦‚ä½•ç›‘è§†é…ç½®ä¸­çš„æ›´æ”¹å¹¶è‡ªåŠ¨é‡æ–°åŠ è½½ï¼Ÿ</font><font style="vertical-align: inherit;">è¿™æ˜¯ConfigMapsçš„ä¸€ä¸ªé‡è¦åŠŸèƒ½... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Kubernetesä¸­ï¼Œå¦‚æœä½¿ç”¨configè¿›è¡Œå®‰è£…</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™åœ¨é‡å¯podä¹‹å‰ï¼Œå®ƒä¸ä¼šè¢«æ›´æ–°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆè¯·å‚è§ä¸Šé¢è®¨è®ºçš„å‰ä¸‰ä¸ªæ–¹æ¡ˆï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœå°†ConfigMapæŒ‚è½½ä¸ºä¸å¸¦çš„ç›®å½•ï¼Œ</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ™å®¹å™¨å†…å°†å­˜åœ¨ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«æ›´æ–°çš„é…ç½®ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨podã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜æœ‰å…¶ä»–ä¸€äº›è¦è®°ä½çš„åŠŸèƒ½ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®¹å™¨å†…éƒ¨çš„æ­¤ç±»æ›´æ–°çš„é…ç½®æ–‡ä»¶ä¼šæœ‰æ‰€å»¶è¿Ÿã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ç”±äºæ–‡ä»¶æœªå®Œå…¨æŒ‚è½½ï¼Œè€Œæ˜¯Kuberneteså¯¹è±¡æŒ‚è½½ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡Œé¢çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚</font><font style="vertical-align: inherit;">èŒƒä¾‹</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ kubectl -n production <span class="hljs-built_in">exec</span> go-conf-example-6b4cb86569-22vqv -- ls -lha /app/configfiles <font></font>
total 20K    <font></font>
drwxr-xr-x    1 root     root        4.0K Mar  3 19:34 .<font></font>
drwxr-xr-x    1 app      app         4.0K Mar  3 19:34 ..<font></font>
-rw-r--r--    1 root     root          42 Mar  3 19:34 config.json<font></font>
-rw-r--r--    1 root     root          47 Mar  3 19:34 database.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ²¡æœ‰</font></font><code>subPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®å½•æŒ‚è½½æ—¶</font><font style="vertical-align: inherit;">ä¼šå‘ç”Ÿä»€ä¹ˆ</font><font style="vertical-align: inherit;">ï¼Ÿ</font></font><br>
<br>
<pre><code class="bash hljs">$ kubectl -n production <span class="hljs-built_in">exec</span> go-conf-example-67c768c6fc-ccpwl -- ls -lha /app/configfiles <font></font>
total 12K    <font></font>
drwxrwxrwx    3 root     root        4.0K Mar  3 19:40 .<font></font>
drwxr-xr-x    1 app      app         4.0K Mar  3 19:34 ..<font></font>
drwxr-xr-x    2 root     root        4.0K Mar  3 19:40 ..2020_03_03_16_40_36.675612011<font></font>
lrwxrwxrwx    1 root     root          31 Mar  3 19:40 ..data -&gt; ..2020_03_03_16_40_36.675612011<font></font>
lrwxrwxrwx    1 root     root          18 Mar  3 19:40 config.json -&gt; ..data/config.json<font></font>
lrwxrwxrwx    1 root     root          19 Mar  3 19:40 database.yml -&gt; ..data/database.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ–°é…ç½®ï¼ˆé€šè¿‡deployæˆ–</font></font><code>kubectl edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œç­‰å¾…2åˆ†é’Ÿï¼ˆapiserverç¼“å­˜æ—¶é—´ï¼‰ï¼Œç„¶åç§ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ kubectl -n production <span class="hljs-built_in">exec</span> go-conf-example-67c768c6fc-ccpwl -- ls -lha --color /app/configfiles <font></font>
total 12K    <font></font>
drwxrwxrwx    3 root     root        4.0K Mar  3 19:44 .<font></font>
drwxr-xr-x    1 app      app         4.0K Mar  3 19:34 ..<font></font>
drwxr-xr-x    2 root     root        4.0K Mar  3 19:44 ..2020_03_03_16_44_38.763148336<font></font>
lrwxrwxrwx    1 root     root          31 Mar  3 19:44 ..data -&gt; ..2020_03_03_16_44_38.763148336<font></font>
lrwxrwxrwx    1 root     root          18 Mar  3 19:40 config.json -&gt; ..data/config.json<font></font>
lrwxrwxrwx    1 root     root          19 Mar  3 19:40 database.yml -&gt; ..data/database.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯·æ³¨æ„Kubernetesåˆ›å»ºçš„ç›®å½•ä¸­æ›´æ”¹çš„æ—¶é—´æˆ³ã€‚</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜æ›´è¿½è¸ª</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•ç›‘è§†é…ç½®ä¸­çš„æ›´æ”¹ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä½¿ç”¨è¿™æ ·çš„Goåº”ç”¨ç¨‹åº</font></font></b>
                        <div class="spoiler_text"><pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"encoding/json"</span>
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"log"</span>
	<span class="hljs-string">"os"</span>
	<span class="hljs-string">"time"</span><font></font>
<font></font>
	<span class="hljs-string">"github.com/fsnotify/fsnotify"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">// Config fo our application</span>
<span class="hljs-keyword">type</span> Config <span class="hljs-keyword">struct</span> {<font></font>
	Welcome <span class="hljs-keyword">string</span> <span class="hljs-string">`json:"welcome"`</span>
	Name    <span class="hljs-keyword">string</span> <span class="hljs-string">`json:"name"`</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> (<font></font>
	globalConfig *Config<font></font>
)<font></font>
<font></font>
<span class="hljs-comment">// LoadConfig - load our config!</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LoadConfig</span><span class="hljs-params">(path <span class="hljs-keyword">string</span>)</span> <span class="hljs-params">(*Config, error)</span></span> {<font></font>
	configFile, err := os.Open(path)<font></font>
<font></font>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"Unable to read configuration file %s"</span>, path)<font></font>
	}<font></font>
<font></font>
	config := <span class="hljs-built_in">new</span>(Config)<font></font>
<font></font>
	decoder := json.NewDecoder(configFile)<font></font>
	err = decoder.Decode(&amp;config)<font></font>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"Unable to parse configuration file %s"</span>, path)<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">return</span> config, <span class="hljs-literal">nil</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// ConfigWatcher - watches config.json for changes</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ConfigWatcher</span><span class="hljs-params">()</span></span> {<font></font>
	watcher, err := fsnotify.NewWatcher()<font></font>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
		log.Fatal(err)<font></font>
	}<font></font>
	<span class="hljs-keyword">defer</span> watcher.Close()<font></font>
<font></font>
	done := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">bool</span>)
	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">for</span> {
			<span class="hljs-keyword">select</span> {
			<span class="hljs-keyword">case</span> event, ok := &lt;-watcher.Events:
				<span class="hljs-keyword">if</span> !ok {
					<span class="hljs-keyword">return</span><font></font>
				}<font></font>
				log.Println(<span class="hljs-string">"event:"</span>, event)
				<span class="hljs-keyword">if</span> event.Op&amp;fsnotify.Write == fsnotify.Write {<font></font>
					log.Println(<span class="hljs-string">"modified file:"</span>, event.Name)<font></font>
				}<font></font>
				globalConfig, _ = LoadConfig(<span class="hljs-string">"./configfiles/config.json"</span>)<font></font>
				log.Println(<span class="hljs-string">"config:"</span>, globalConfig)
			<span class="hljs-keyword">case</span> err, ok := &lt;-watcher.Errors:
				<span class="hljs-keyword">if</span> !ok {
					<span class="hljs-keyword">return</span><font></font>
				}<font></font>
				log.Println(<span class="hljs-string">"error:"</span>, err)<font></font>
			}<font></font>
		}<font></font>
	}()<font></font>
<font></font>
	err = watcher.Add(<span class="hljs-string">"./configfiles/config.json"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
		log.Fatal(err)<font></font>
	}<font></font>
	&lt;-done<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
	log.Println(<span class="hljs-string">"Start"</span>)<font></font>
	globalConfig, _ = LoadConfig(<span class="hljs-string">"./configfiles/config.json"</span>)
	<span class="hljs-keyword">go</span> ConfigWatcher()
	<span class="hljs-keyword">for</span> {<font></font>
		log.Println(<span class="hljs-string">"config:"</span>, globalConfig)<font></font>
		time.Sleep(<span class="hljs-number">30</span> * time.Second)<font></font>
	}<font></font>
}</code></pre></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...ä½¿ç”¨è¿™æ ·çš„é…ç½®æ·»åŠ å®ƒï¼š</font></font><br>
<br>
<pre><code class="json hljs">$ cat configfiles/config.json <font></font>
{<font></font>
  <span class="hljs-attr">"welcome"</span>: <span class="hljs-string">"Hello"</span>,
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Alice"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœè¿è¡Œï¼Œæ—¥å¿—å°†ä¸ºï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">2020/03/03 22:18:22 config: &amp;{Hello Alice}<font></font>
2020/03/03 22:18:52 config: &amp;{Hello Alice}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåº”ç”¨ç¨‹åºå®‰è£…åœ¨Kubernetesä¸­ï¼Œå¹¶å°†ConfigMapé…ç½®è€Œä¸æ˜¯æ˜ åƒä¸­çš„æ–‡ä»¶å®‰è£…åœ¨podä¸­ã€‚</font><font style="vertical-align: inherit;">åœ¨GitHubä¸Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·²</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡†å¤‡</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">äº†Helmå›¾è¡¨</font></a><font style="vertical-align: inherit;">çš„</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ç¤ºä¾‹</font></a><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">helm install -n habr-configmap --namespace habr-configmap ./habr-configmap --<span class="hljs-built_in">set</span> <span class="hljs-string">'name.production=Alice'</span> --<span class="hljs-built_in">set</span> <span class="hljs-string">'global.env=production'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶ä»…æ›´æ”¹ConfigMapï¼š</font></font><br>
<br>
<pre><code class="bash hljs">-  production: <span class="hljs-string">"Alice"</span>
+  production: <span class="hljs-string">"Bob"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œæ›´æ–°é›†ç¾¤ä¸­çš„Helmå›¾è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">helm upgrade habr-configmap ./habr-configmap --<span class="hljs-built_in">set</span> <span class="hljs-string">'name.production=Bob'</span> --<span class="hljs-built_in">set</span> <span class="hljs-string">'global.env=production'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº”ç”¨ç¨‹åºv1å’Œv2æ— æ³•é‡æ–°å¯åŠ¨ï¼Œå› ä¸º </font><font style="vertical-align: inherit;">å¯¹äºä»–ä»¬æ¥è¯´ï¼Œéƒ¨ç½²æ²¡æœ‰ä»»ä½•å˜åŒ–-ä»–ä»¬ä»ç„¶æ¬¢è¿Aliceã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v3åº”ç”¨ç¨‹åºé‡æ–°å¯åŠ¨ï¼Œé‡æ–°è¯»å–é…ç½®ï¼Œå¹¶å‘Bobè‡´æ„ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v4åº”ç”¨ç¨‹åºæœªé‡æ–°å¯åŠ¨ã€‚</font><font style="vertical-align: inherit;">ç”±äºConfigMapæ˜¯ä½œä¸ºç›®å½•æŒ‚è½½çš„ï¼Œå› æ­¤å¯ä»¥æ³¨æ„åˆ°é…ç½®ä¸­çš„æ›´æ”¹ï¼Œå¹¶ä¸”å¯ä»¥å³æ—¶æ›´æ”¹é…ç½®ï¼Œè€Œæ— éœ€é‡æ–°å¯åŠ¨Podã€‚</font><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œåº”ç”¨ç¨‹åºåœ¨æˆ‘ä»¬çš„ç®€å•ç¤ºä¾‹ä¸­æ³¨æ„åˆ°äº†æ›´æ”¹-è¯·å‚é˜…æ¥è‡ª</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsnotify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„äº‹ä»¶æ¶ˆæ¯</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">2020/03/03 22:19:15 event: "configfiles/config.json": CHMOD<font></font>
2020/03/03 22:19:15 config: &amp;{Hello Bob}<font></font>
2020/03/03 22:19:22 config: &amp;{Hello Bob}</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸ¥çœ‹å¦‚ä½•åœ¨æ›´æˆäººçš„é¡¹ç›®ï¼ˆä¹Ÿå°±æ˜¯â€œçœŸå®â€é¡¹ç›®ï¼‰ä¸­è§£å†³ç±»ä¼¼æƒ…å†µï¼ˆè·Ÿè¸ªConfigMapçš„æ›´æ”¹ï¼‰</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦ï¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜è®°å¾—æœ¬æ–‡ä¸­çš„æ‰€æœ‰ä¸Šè¿°å†…å®¹å¯¹äºKubernetesï¼ˆ</font></font><code>kind: Secret</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">ä¸­çš„Secret'ovä¹Ÿæ˜¯é€‚ç”¨çš„</font><font style="vertical-align: inherit;">ï¼šå®ƒä»¬ä¸ConfigMapå¦‚æ­¤ç›¸ä¼¼å¹¶éæ²¡æœ‰é“ç†â€¦â€¦</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥–é‡‘ï¼</font><font style="vertical-align: inherit;">ç¬¬ä¸‰æ–¹è§£å†³æ–¹æ¡ˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨å¯¹è·Ÿè¸ªé…ç½®ä¸­çš„æ›´æ”¹æ„Ÿå…´è¶£ï¼Œåˆ™å·²ç»æœ‰ç°æˆçš„å®ç”¨ç¨‹åºå¯ç”¨äºæ­¤ï¼š</font></font><br>
<br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jimmidyson / configmap-reload-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ–‡ä»¶å·²æ›´æ”¹ï¼Œåˆ™å‘é€HTTPè¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">å¼€å‘äººå‘˜è¿˜è®¡åˆ’æ•™SIGHUPå‘é€ï¼Œä½†æ˜¯ä»2019å¹´10æœˆå¼€å§‹ç¼ºä¹æäº¤ä½¿è¿™äº›è®¡åˆ’æˆä¸ºé—®é¢˜;</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stakater / Reloader-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›‘è§†ConfigMap / Secretså¹¶å¯¹å…¶å…³è”çš„èµ„æºæ‰§è¡Œæ»šåŠ¨å‡çº§ï¼ˆå¦‚å…¶ä½œè€…æ‰€è¯´ï¼‰ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨é™„å¸¦çš„ç°æœ‰åº”ç”¨ç¨‹åºçš„å®¹å™¨å¯åŠ¨æ­¤ç±»åº”ç”¨ç¨‹åºå°†å¾ˆæ–¹ä¾¿ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœæ‚¨çŸ¥é“Kubernetes / ConfigMapå’Œé…ç½®çš„åŠŸèƒ½ä¸æ˜¯``å®æ—¶''ï¼ˆé€šè¿‡</font></font><code>edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">ç¼–è¾‘</font><font style="vertical-align: inherit;">ï¼Œè€Œæ˜¯ä»…ä½œä¸ºéƒ¨ç½²çš„ä¸€éƒ¨åˆ†...é‚£ä¹ˆè¿™äº›å®ç”¨ç¨‹åºçš„åŠŸèƒ½ä¼¼ä¹æ˜¯å¤šä½™çš„ï¼Œå³ </font><font style="vertical-align: inherit;">å¤åˆ¶åŸºæœ¬åŠŸèƒ½ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®º</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éšç€Kubernetesä¸­ConfigMapçš„å‡ºç°ï¼Œé…ç½®è¿›å…¥äº†ä¸‹ä¸€è½®å¼€å‘ï¼šæ¨¡æ¿å¼•æ“çš„ä½¿ç”¨ä¸ºå®ƒä»¬å¸¦æ¥äº†ä¸HTMLé¡µé¢å‘ˆç°ç›¸å½“çš„çµæ´»æ€§ã€‚</font><font style="vertical-align: inherit;">å¹¸è¿çš„æ˜¯ï¼Œè¿™ç§å¤æ‚æ€§å¹¶æ²¡æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å–ä»£</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°æœ‰çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯æˆä¸ºå…¶</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¥å……</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œå¯¹äºè®¤ä¸ºæ–°åŠŸèƒ½å¤šä½™çš„ç®¡ç†å‘˜ï¼ˆç”šè‡³æ˜¯å¼€å‘äººå‘˜ï¼‰ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨å¥½çš„æ—§æ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºå·²ç»ä½¿ç”¨ConfigMapæˆ–ä»…æŸ¥çœ‹ConfigMapçš„ç”¨æˆ·ï¼Œæœ¬æ–‡ç®€è¦æ¦‚è¿°äº†å®ƒä»¬çš„æœ¬è´¨å’Œä½¿ç”¨çš„ç»†å¾®å·®åˆ«ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨å¯¹è¿™ä¸ªä¸»é¢˜æœ‰è‡ªå·±çš„æç¤ºå’ŒæŠ€å·§-æˆ‘ä¼šå¾ˆé«˜å…´åœ¨è¯„è®ºä¸­çœ‹åˆ°ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èšè‹¯ä¹™çƒ¯</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦è¯·å‚é˜…æˆ‘ä»¬çš„åšå®¢ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†åº”ç”¨ç¨‹åºç§»æ¤åˆ°Kubernetesæ—¶çš„æœ¬åœ°æ–‡ä»¶</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ï¼›</font></font></li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Kubernetes  Helm:    </a>Â»;</li>
<li> Â«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SSL-  Let's Encrypt  cert-manager  Kubernetes</a>Â».</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN498944/index.html">ç‹—ï¼Œè¿˜æ˜¯ä¸åšé•œå­çš„ç”µæŠ¥</a></li>
<li><a href="../zh-CN498948/index.html">é¾™çš„æ—¶é—´ã€‚ä¸éš¾é¢˜çš„è‡ªæˆ‘éš”ç¦»</a></li>
<li><a href="../zh-CN498952/index.html">æˆ‘ä»¬é‚€è¯·DINS JS EVENINGï¼šæˆ‘ä»¬æ­£åœ¨è°ˆè®ºé¢å‘æ–¹é¢çš„ç¼–ç¨‹å’ŒVuejs 3 composition APIæ¡†æ¶</a></li>
<li><a href="../zh-CN498958/index.html">é”™è¯¯ä¸æ˜¯UIAlertController</a></li>
<li><a href="../zh-CN498962/index.html">å…³äºå¤šä»»åŠ¡ï¼šå—æ§åˆ¶çš„çª—å£</a></li>
<li><a href="../zh-CN498974/index.html">å† çŠ¶ç—…æ¯’ï¼šä¸å®‰å…¨çš„å±é™©å¹»æƒ³</a></li>
<li><a href="../zh-CN498976/index.html">.NET 5.0é¢„è§ˆç‰ˆ3ç®€ä»‹</a></li>
<li><a href="../zh-CN498978/index.html">ä½¿ç”¨Graylogå’ŒNLogä»Cï¼ƒåº”ç”¨ç¨‹åºæ”¶é›†æ—¥å¿—ã€‚ä¸ªäººç»éªŒ</a></li>
<li><a href="../zh-CN498982/index.html">Dreamcastçš„è½¯ç›˜</a></li>
<li><a href="../zh-CN498984/index.html">éšå½¢å­¦æ ¡ï¼šéšå½¢æ¸¸æˆä¸­çš„5ç§å°å·¥å…·</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>