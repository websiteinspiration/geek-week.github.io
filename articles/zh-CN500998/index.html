<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>™️ 🤛🏼 🤘 卷积神经网络及其在iOS中的集成（第1部分） 🚣🏽 👨🏿‍🍳 ⏭️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="实施手段。
 
 各种机器学习算法已集成到许多高级编程语言中。其中最受欢迎和增长最快的是Python。
 
 TensorFlow是Google开发的用于机器学习的开放软件库，用于解决构建和训练神经网络以自动查找和分类图像的问题，从而实现人的感知质量。用于库的主要API是针对Python实现的。
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>卷积神经网络及其在iOS中的集成（第1部分）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500998/"><img src="https://habrastorage.org/webt/ob/i9/sq/obi9sqkryjcwn5txcjgdvc0fcoi.jpeg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实施手段。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
各种机器学习算法已集成到许多高级编程语言中。其中最受欢迎和增长最快的是Python。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow是Google开发的用于机器学习的开放软件库，用于解决构建和训练神经网络以自动查找和分类图像的问题，从而实现人的感知质量。用于库的主要API是针对Python实现的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keras是一个开放的神经网络库。它是TensorFlow和Theano框架的附加组件。它旨在通过深度学习网络进行操作，同时设计为紧凑，模块化和可扩展的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择了最新版本的Python 3.7.2作为解释器。开发环境是PyCharm社区。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据准备。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
在现代世界中，对于大多数AI任务而言，无需手动收集数据集，在注册后，有许多资源可以下载现成的数据集。选择了手语十位数的数据集（图1）。</font></font><br>
<img src="https://habrastorage.org/webt/_-/wd/e7/_-wde7b_bdaeuj-ge5tk6fkymxi.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图。1。 -手语中的数字。</font></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该算法将需要检测照片中是否存在手势，并使用0到9之间的数字对其进行分类。在构建神经网络的体系结构之前，您需要准备数据以对其进行训练。首先，下载手语数字数据集数据。第一个文件包含2063张黑白图片，并带有手语数字。图片的大小为64x64像素。第二个文件包含对应于图片的标签（矢量）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图片中的像素值已归一化，且处于（0,1）区间内。您可以立即使用它们进入神经网络，但是如果遵循标准化程序，将会获得最佳结果。执行后，将为每个像素矩阵满足规则：矩阵中的</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平均值为零。矩阵中</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 的色散为统一。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
照片被标准化并添加到新阵列中，以便与先前的数据进行后续组合（</font></font><br>
<img src="https://habrastorage.org/webt/ad/m6/wd/adm6wdbpvyip5kyp_4glxau1j50.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图</font><font style="vertical-align: inherit;">2）</font><font style="vertical-align: inherit;">图2。 -加载和处理图像的步骤。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">神经网络架构。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Network_sign_lang.py-描述神经网络的主项目文件。在脚本的开头，描述了神经网络的几个全局变量（图3）。</font></font><br>
<img src="https://habrastorage.org/webt/ug/wo/ll/ugwollmtjdgakxjrkjaycuq7bog.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图3。 -全局选项。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Batch_size-每次迭代馈入神经网络的图像数量。 Num_classes-模型将预测的类数。 Img_size-提供给输入层的图像的大小。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sklearn库中的train_test_split（）函数被导入到项目中，它将以80:20的比例将X和y数组拆分为训练样本和测试样本，并且还随机混合数据，以使它们不会按类别排序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后初始化模型（图4），添加Conv2D的第一层。输入来自Xtrain数组的图像，指示输出空间的大小-64，卷积核-4x4，卷积步长和ReLU层的激活函数。</font></font><br>
<img src="https://habrastorage.org/webt/7z/3p/jw/7z3pjw8oimjgvt7n4nde4jgivao.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图4。 - 神经网络</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于神经网络通常使用大量的训练数据，因此构造的模型易于重新训练。为了避免这种情况，使用了一种有效的正则化方法，例如Dropout。该层将排除所指示百分比的随机神经元，以使各层之间没有积压。数字0.5表示每批算法将排除一半的随机神经元。第二主层也类似于第一层-卷积。 （Conv2D）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来是池化层（MaxPooling2D）。它用作模型输出的另一个过滤器。由于在水平或垂直显示数字时，图像的含义不会改变，因此神经网络应将其平均分类。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平坦层用作通过算法获得的数据与具有预测的输出向量之间的链接。网络的最后一层是具有sofmax激活功能的密集层。此函数使您可以为每个类获取概率的归一化向量，其中概率之和等于1。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，您需要通过指定以下参数来编译创建的模型：度量，损失函数和优化器。作为一种度量，选择了准确性-正确分类的示例的百分比。损失函数是categorical_crossentropy。优化算法-亚当。在开始训练之前，添加了几个回调。 EarlyStopping-当神经网络的准确性随着学习时代的增长而停止增加时，停止学习神经网络。 ModelCheckpoint-将最佳模型权重保存到文件中以备后用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
神经网络的训练始于将有关其过程的数据保存到历史变量中。 Validation_split-采取训练数据的百分之十进行验证，这是另一种进行正则化的方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
训练样本的大小为1965个示例，测试样本为547个，验证样本为219个。训练过程完成后，将根据所获得的准确性对训练和测试数据的依赖关系来绘制图形（图5）。</font></font><br>
<img src="https://habrastorage.org/webt/ip/fj/0t/ipfj0t4yibt6ogcdlddvuuqbksu.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图5。 - 培训时间表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该图显示该模型是在第15个时代保存的（具有最高的准确性，并且Xtrain和Xtest之间的差距最小）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下一步是将生成的神经网络加载到另一个脚本中，以验证其功能。显示测试数据上指标的值（图6）。</font></font><br>
<img src="https://habrastorage.org/webt/yy/gk/pw/yygkpwatefnnhsps263xk54futk.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图6。 -检查模型的性能。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据度量的结果，我们可以得出结论，这些模型相差不大。</font><font style="vertical-align: inherit;">损失函数指数越低，算法的预测就越有把握。</font><font style="vertical-align: inherit;">该模型的准确性或逼真度显示正确分类的照片的百分比，这意味着它越高，神经网络越好。</font><font style="vertical-align: inherit;">因此，使用因早期停止教育而获得的第一个模型更为合乎逻辑。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于数据预处理和iOS应用程序中特定格式的神经网络的集成，我们将在下一部分中进行描述。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN500984/index.html">怪胎的苹果或快乐的无线电日，极客</a></li>
<li><a href="../zh-CN500986/index.html">数据中心的监控：我们如何将旧的BMS更改为新的BMS。第三部分</a></li>
<li><a href="../zh-CN500992/index.html">最佳IT公司的绩效管理如何</a></li>
<li><a href="../zh-CN500994/index.html">运行蚂蚁。跑</a></li>
<li><a href="../zh-CN500996/index.html">如何在六个月甚至更快的时间内成为一名DevOps工程师。第1部分。简介</a></li>
<li><a href="../zh-CN501000/index.html">通过为数据库创建客户端的示例在Go中生成代码</a></li>
<li><a href="../zh-CN501002/index.html">umka：新的静态类型脚本语言</a></li>
<li><a href="../zh-CN501004/index.html">做吧 工作</a></li>
<li><a href="../zh-CN501006/index.html">我们是STM32的朋友，在I2C总线上带有LCD显示屏1604（HAL库）</a></li>
<li><a href="../zh-CN501008/index.html">多米诺骨牌铺</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>