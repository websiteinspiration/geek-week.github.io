<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìü üë®üèæ‚Äç‚öñÔ∏è üïå Working with a database in Flask: from June to June üë©üèø‚ÄçüöÄ ü§¥üèæ üëÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was inspired to write this article by the desire to help the same newcomers to Python in general and to work with Flask in particular, as I myself. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Working with a database in Flask: from June to June</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500688/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I was inspired to write this article by the desire to help the same newcomers to Python in general and to work with Flask in particular, as I myself. </font><font style="vertical-align: inherit;">While working on the task of a holistic and understandable explanation in the style that we, newcomers, did not find, like. </font><font style="vertical-align: inherit;">I had to look for the information bit by bit. </font><font style="vertical-align: inherit;">There will be no pictures. </font><font style="vertical-align: inherit;">A purely technical article. </font><font style="vertical-align: inherit;">Experienced people will be grateful for comments and for tips on improving the code.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So let's get started. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I started learning Python right after the New Year. After four months, I realized that the theory, as well as training in fictional tasks that do not go into prod, you won‚Äôt especially learn, I decided to look for ‚Äúcombat‚Äù tasks. To do this, I asked my friends if they had any real tasks that needed to be programmed. One ‚Äúmy friend friend‚Äù asked me to implement a bot for Telegram (I miss the essence of the bot; it doesn‚Äôt matter - I needed to take any task that has a specific customer and implement it as the customer wants). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In search of a solution, it is natural that the first thing I started with is the well-known </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python Telegram Bot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyTelegramBotAPI frameworks.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. At first, as a beginner, it seemed to me just a find - it was possible especially without understanding the nuances of the code to quickly start ‚Äúsawing‚Äù the real bot. For a couple of days I came across the fact that I can‚Äôt create the functionality I need. It seems that he did everything according to the documentation, but it was not decided. Then I realized that I did not understand at all how the framework works ‚Äúunder the hood‚Äù and why something that should work doesn‚Äôt work for me; where and what commands should be called and with what methods. In general, I decided to put aside the framework and try to understand more deeply how the Telegram API itself works and how you can work with it directly, which will give me more control over the situation, and will also allow me to study more closely the whole kitchen of working with the API. It is possible that I will not return to using the Python Telegram Bot and pyTelegramBotAPI frameworks as unnecessary.Or maybe I‚Äôll come back to simplify my work on creating my own bike with Telegram API. But even if I return, I will understand much more about the work of these frameworks.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I had an unreviewed little course on Udemy just to create a bot for Telegram. At the time of this writing, this was the only Udemy course where a person would solve a problem without the Python Telegram Bot and pyTelegramBotAPI (I won‚Äôt give a link so that it would not be an advertisement). To solve it, he used Flask. Here, by the way, after going through a certain ‚Äúmilitary path‚Äù I had the opportunity to write down my course on this topic, although, of course, it is too early - I won‚Äôt bring any special value. But if you, a more experienced programmer reading this article, know a lot about this, then you can create your own course and I‚Äôll be happy to buy it from you for $ 10.99 (a typical ‚Äúdiscount‚Äù price for Udemy) to learn something new. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, from the course, I realized that Flask will allow me to make life easier for processing GET and POST requests.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since this article is specifically devoted to working with the database, I will talk about this. Although, all the time, it‚Äôs tempting to describe other subtleties, such as: transferring the connection settings to a ‚Äúsecret‚Äù file, receiving and processing data received from the Telegram API, how to receive webhooks from Telegram on a local computer without an ssl certificate. If you have interest, then let me know and I will write a separate article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
About 3-4 days of my June time it took me to understand that I needed to move away from the framework before I could confidently receive data from the Telegram, process the text (parsing), and depending on what the user wrote, send him the necessary commands, as well as buttons (including overwrite the message and change the buttons).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next step for me was to connect the database in order to store users who work with the bot in it, as well as data on their interaction in the bot as part of the task that confronted him. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first thing I did in Google was an article from Habr√© with a translation of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mega-textbook Miguel Grinberg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">original of his blog is here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fourth chapter deals with connecting to a database using Flask and SQLAlchemy ORM. Then I thought: ‚ÄúWow, how cool, now the problem is solved.‚Äù Oddly enough, but the file structure that the author suggested did not work for me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I did by analogy like his:</font></font><br>
<br>
<pre><code class="plaintext hljs">microblog\<font></font>
  venv\<font></font>
  app\<font></font>
    __init__.py<font></font>
    models.py<font></font>
  main.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In main.py, I do all the main work with the Telegram API. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In app \ models.py, I create classes for the database. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In app \ __ init__.py, everything was done as Miguel Grinberg wrote. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But for some reason, in main.py, they didn‚Äôt want to pull me from app import db, app. Spent about an hour searching for problems, solutions on the Internet. As a result, Oleg Molchanov came across a YouTube channel and his video ‚ÄúCreating a Blog on Flask (lessons) - Creating Posts (Models) and SQLAlchemy‚Äù. There I watched how he makes a connection to the database and tried to go this way (without putting the models.py file into the app directory, without creating __init__.py. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In general, now the structure of my project is simple to disgrace (and a little ugly, which confuses me, maybe in the future I‚Äôll understand how to improve the structure):</font></font><br>
<br>
<img src="http://dl4.joxi.net/drive/2020/05/04/0029/2062/1914894/94/247888a33f.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, I have app.py, models.py, main.py, app.sqlite (the rest of the files do not relate to the current topic). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In app.py I have this code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_sqlalchemy <span class="hljs-keyword">import</span> SQLAlchemy
<span class="hljs-keyword">from</span> flask_migrate <span class="hljs-keyword">import</span> Migrate
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> Config<font></font>
<font></font>
app = Flask(__name__)<font></font>
app.config.from_object(Config)<font></font>
db = SQLAlchemy(app)<font></font>
migrate = Migrate(app, db)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In models.py:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> app <span class="hljs-keyword">import</span> db</code></pre><br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Users</span>(<span class="hljs-params">db.Model</span>):</span>
    <span class="hljs-comment">#   </span>
    __tablename__ = <span class="hljs-string">'users'</span>
    id = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<font></font>
    username = db.Column(db.String(<span class="hljs-number">120</span>), index=<span class="hljs-literal">True</span>, unique=<span class="hljs-literal">True</span>)<font></font>
    last_name = db.Column(db.String(<span class="hljs-number">128</span>))<font></font>
    first_name = db.Column(db.String(<span class="hljs-number">128</span>))<font></font>
    created = db.Column(db.DateTime, default=datetime.now())<font></font>
    tasks = db.relationship(<span class="hljs-string">'Tasks'</span>, backref=<span class="hljs-string">'tasks'</span>)<font></font>
<font></font>
    <span class="hljs-comment">#     </span>
    <span class="hljs-comment"># def __init__(self, *args, **kwargs):</span>
    <span class="hljs-comment">#     super(Users, self).__init__(*args, **kwargs)</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, username, last_name, first_name</span>):</span><font></font>
        self.username = username<font></font>
        self.last_name = last_name<font></font>
        self.first_name = first_name<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;User {}&gt;'</span>.format(self.username)<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tasks</span>(<span class="hljs-params">db.Model</span>):</span>
    <span class="hljs-comment">#    </span>
    __tablename__ = <span class="hljs-string">'tasks'</span>
    id = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<font></font>
    owner_id = db.Column(db.Integer(), db.ForeignKey(<span class="hljs-string">'users.id'</span>))<font></font>
    name = db.Column(db.String(<span class="hljs-number">120</span>), index=<span class="hljs-literal">True</span>)<font></font>
    start = db.Column(db.Boolean, default=<span class="hljs-literal">False</span>)<font></font>
    finish = db.Column(db.Boolean, default=<span class="hljs-literal">False</span>)<font></font>
    created_on = db.Column(db.DateTime, default=datetime.now())<font></font>
    updated_on = db.Column(db.DateTime(), default=datetime.utcnow, onupdate=datetime.utcnow)<font></font>
<font></font>
    <span class="hljs-comment">#     </span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span><font></font>
        super(Tasks, self).__init__(*args, **kwargs)<font></font>
<font></font>
    <span class="hljs-comment"># def __init__(self, name, last_name, first_name):</span>
    <span class="hljs-comment">#     self.name = name</span>
    <span class="hljs-comment">#     self.last_name = last_name</span>
    <span class="hljs-comment">#     self.first_name = first_name</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;Tasks {}&gt;'</span>.format(self.name)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In config.py:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv<font></font>
load_dotenv()<font></font>
<font></font>
basedir = os.path.abspath(os.path.dirname(__file__))<font></font>
<font></font>
<font></font>
<span class="hljs-comment">#    </span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Config</span>(<span class="hljs-params">object</span>):</span>
    DEBUG = <span class="hljs-literal">True</span>
    SECRET_KEY = os.environ.get(<span class="hljs-string">'SECRET_KEY'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'you-will-never-guess'</span>
    <span class="hljs-comment"># SQLALCHEMY_DATABASE_URI = 'postgresql+psycopg2://{user}:{pw}@{url}/{db}'.format(user=os.environ.get('POSTGRES_USER'),</span>
    <span class="hljs-comment">#                                                                                 pw=os.environ.get('POSTGRES_PW'),</span>
    <span class="hljs-comment">#                                                                                 url=os.environ.get('POSTGRES_URL'),</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment">#                                                                                 db=os.environ.get('POSTGRES_DB'))</span>
    SQLALCHEMY_DATABASE_URI = (os.environ.get(<span class="hljs-string">'DATABASE_URL'</span>) <span class="hljs-keyword">or</span>
                               <span class="hljs-string">'sqlite:///'</span> + os.path.join(basedir, <span class="hljs-string">'app.sqlite'</span>)) + <span class="hljs-string">'?check_same_thread=False'</span>
    SQLALCHEMY_TRACK_MODIFICATIONS = <span class="hljs-literal">False</span>  <span class="hljs-comment"># silence the deprecation warning</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you already understood, from the settings I removed the direct values ‚Äã‚Äãfor the connection and rendered them in .env so that they would not shine on the prod or in SVN. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, app.db (where app.sqlite is now) was written to me in SQLALCHEMY_DATABASE_URI as the database. </font><font style="vertical-align: inherit;">Yes, yes, and wrote down, as indicated in the instructions Miguel Grinberg. </font><font style="vertical-align: inherit;">I hope you understand that you need to replace it with .sqlite. </font><font style="vertical-align: inherit;">Before that, I thought of an hour after painful attempts to run the code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can create databases and tables in sqlite by going to the debugging console (for example, in PyCharm I have Tools -&gt; Python or Debug Console:</font></font><br>
<br>
<img src="http://dl3.joxi.net/drive/2020/05/04/0029/2062/1914894/94/06a8154fab.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, we first connect the method we need in the desired file (I have it from models import db), and after successful connection, specify the db.create_all () command. After that, a database with all the necessary tables will be created. It‚Äôs worth knowing that if I make from app import db and run the db.create_all () command, the database file seems to be created, but it will be some kind of nonsense, not the database (I didn‚Äôt understand why). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When I solved this problem, I thought again that now there are no difficulties left. It remains only to write a function for main.py, which, under certain events, will write data from the Telegram to the database. Well, I connected from models import Users and in the right place called the function:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">try</span>:<font></font>
    find_user_in_db(username, first_name, last_name)<font></font>
<span class="hljs-keyword">except</span> NameError:<font></font>
    print(<span class="hljs-string">"user  "</span>)
<span class="hljs-keyword">except</span>:<font></font>
    print(<span class="hljs-string">"An exception occurred"</span>)</code></pre><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_users_to_db</span>(<span class="hljs-params">username, last_name, first_name</span>):</span>
    <span class="hljs-string">"""
        
    :return:
    """</span><font></font>
    data = Users(username, last_name, first_name)<font></font>
    db.session.add(data)<font></font>
    db.session.commit()</code></pre><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_user_in_db</span>(<span class="hljs-params">username, first_name, last_name</span>):</span>
    <span class="hljs-string">"""
               
    :param username:
    :param first_name:
    :param last_name:
    :return:
    """</span>
    user = db.session.query(Users).filter(Users.username == <span class="hljs-string">f'<span class="hljs-subst">{username}</span>'</span>).all()
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> user:<font></font>
        add_users_to_db(username, first_name, last_name)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the last function, first instead of user = db.session.query (Users) .filter (Users.username == f '{username}'). First_or_404 () stood Users.query.filter_by (username = '{username}'). first_or_404 (). Here I also spent about half an hour to understand that this query in the database does not work and does not receive any data, so the query to the database is not sent. Google prompted one little article in which people said that it is better to use db.session.query (Users). Why so, I xs, did not waste time analyzing. After that, the data began to be written to the database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This concludes this article because I described what I wanted to describe and solved the problem of connecting the database to Flask.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article is written only for the reason that we ‚ÄúJune‚Äù love when reading instructions. </font><font style="vertical-align: inherit;">I myself also tried to find instructions for connecting the database to Flask. </font><font style="vertical-align: inherit;">I did not find any complete instructions, so I had to make my way through the obstacles. </font><font style="vertical-align: inherit;">Well, I decided to describe my experience as the next one who will look for ready-made instructions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Who is looking for a directly ready-made solution, then I ask to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repository on GitHub</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PSS I will be glad if someone does a code review and gives their recommendations for improvement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you for the attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500668/index.html">Wireless motor control from Lego using Steam Controller</a></li>
<li><a href="../en500670/index.html">How we create our product. Part One, Research</a></li>
<li><a href="../en500672/index.html">Continuation of the stream for testers and not only</a></li>
<li><a href="../en500676/index.html">Announcement of an online workshop on test automation</a></li>
<li><a href="../en500678/index.html">ClickHouse for Advanced Users in Questions and Answers</a></li>
<li><a href="../en500692/index.html">3D game rendering: introduction</a></li>
<li><a href="../en500694/index.html">68 unsolicited tips</a></li>
<li><a href="../en500696/index.html">How running shoes are trying to adapt to the female foot</a></li>
<li><a href="../en500698/index.html">Evgeny Katyshev: ‚ÄúOpenStreetMap is not suitable for any information‚Äù</a></li>
<li><a href="../en500700/index.html">Support for TLS1.3 and expansion of your personal account: what has been done for the first quarter of 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>