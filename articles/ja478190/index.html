<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¤ ğŸ›¶ ğŸ‘’ å±é™ºãªstdã®è©±:: enable_shared_from_thisã€ã¾ãŸã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€-å ±å‘Š ğŸ¤·ğŸ¿ â˜®ï¸ ğŸ¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã®è¨˜äº‹ã§ã¯ã€ã€Œã‚¾ãƒ³ãƒ“ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ’é™¤ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®åˆ†æã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€æœ€åˆã®ãƒ‘ãƒ¼ãƒˆã§èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ï¼šå±é™ºãªstdã®ç‰©èª:: enable_shared_from_thisã€ã¾ãŸã¯ã€Œã‚¾ãƒ³ãƒ“ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚
 
 å‰æ›¸ã
 è¨˜äº‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒ–ãƒ©ãƒ³ãƒã®...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>å±é™ºãªstdã®è©±:: enable_shared_from_thisã€ã¾ãŸã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€-å ±å‘Š</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478190/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ã¯ã€ã€Œã‚¾ãƒ³ãƒ“ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ’é™¤ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®åˆ†æã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€æœ€åˆã®ãƒ‘ãƒ¼ãƒˆã§èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±é™ºãªstd</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ç‰©èª:: enable_shared_from_thisã€ã¾ãŸã¯ã€Œã‚¾ãƒ³ãƒ“ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰æ›¸ã</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰</font><font style="vertical-align: inherit;">ã¯ã€ãƒ–ãƒ©ãƒ³ãƒã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">å…¬é–‹ã•ã‚Œã¦</font><font style="vertical-align: inherit;">ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ã¯ã„ãã¤ã‹ã®C ++ 17ã®é©æ–°ã‚’ä½¿ç”¨ã—ã¾ã™-weak_from_thisï¼ˆï¼‰ã€initã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®ã‚ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®å ´åˆã€ãŠãã‚‰ãä»–ã®ä½•ã‹ã¯å°ã•ã„ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã®æœ€åˆã®éƒ¨åˆ†ã®ä¾‹ã§ã¯ã€å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã®ç™ºç”Ÿã®é€£é–ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é•·ã„ãƒ—ãƒ­ã‚»ã‚¹ã®éåŒæœŸï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰å®Ÿè¡Œã®ã‚¯ãƒ©ã‚¹ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥å€‹ã®å®Ÿè¡Œã‚¹ãƒ¬ãƒƒãƒ‰ï¼ˆstd :: threadï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’éåŒæœŸã«ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¾¿å®œä¸Šã€ãƒ—ãƒ­ã‚»ã‚¹ãŒæ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚¯ãƒ©ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç ´å£Šã•ã‚ŒãŸå ´åˆã«ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ—©æœŸã«çµ‚äº†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ã‚¹ãƒ¬ãƒƒãƒ‰ã«é€šçŸ¥ã™ã‚‹ãŸã‚ã®ã‚»ãƒãƒ•ã‚©ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿè¡Œã‚¹ãƒ¬ãƒƒãƒ‰ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æœ‰åŠ¹æ€§ã‚’ä¿è¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã¯ã€å¼·åŠ›ãªãƒªãƒ³ã‚¯shared_from_thisã®ã‚­ãƒ£ãƒ—ãƒãƒ£ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ¬ãƒƒãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚¯ãƒ©ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¾ªç’°ãƒªãƒ³ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®ã™ã¹ã¦ã®å¼·ã„å‚ç…§ã®ã‚ˆã‚Šé«˜ã„ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã‚‹ç ´å£Šã¯ã€ãã®ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å‘¼ã³å‡ºã—ã«ã¯ã¤ãªãŒã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">é–‹ç™ºè€…ã«ã¨ã£ã¦äºˆæœŸã›ãšã€RAIIã«å¾“ã£ã¦ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€”ä¸­ã§çµ‚äº†ã•ã›ã‚ˆã†ã¨ã—ã¦ã‚‚æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã‚¹ãƒ¬ãƒƒãƒ‰ã¯å¼•ãç¶šãæ©Ÿèƒ½ã—ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå¸¸ã«ï¼‰ãƒªã‚½ãƒ¼ã‚¹ã®æ¼å‡ºã‚’æ¤œå‡ºã™ã‚‹ã®ã¯å›°é›£ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœªå®šç¾©ã®å‹•ä½œï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ï¼‰;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é«˜ãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚¸ãƒƒã‚¯éšœå®³ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ï¼‰ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®çŠ¶æ³ã¯è§£ã‹ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ãŒæ˜ç™½ã€ã¾ãŸã¯å¼±ã„</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€Œã‚¾ãƒ³ãƒ“ã€ã®ä¸»è¦ãªè¦ç´ ã®1ã¤ã¯ã€å††å½¢ã®ãƒªãƒ³ã‚¯ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’é˜²ããŸã‚ã®æ¨™æº–çš„ãªæ‰‹æ³•ã¯ã€std :: weak_ptrã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã®è€ƒãˆæ–¹ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¦</font><b><font style="vertical-align: inherit;">ã„ã‚‹</font></b><font style="vertical-align: inherit;">ãƒ©ãƒ ãƒ€ã¯ã€shared_from_thisï¼ˆï¼‰ã§ã¯ãªãã€weak_from_thisï¼ˆï¼‰ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã®ã¿ã‚’å¤‰æ›´ã—ã€å¤§è¦æ¨¡ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¯è¡Œã„ã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplezomby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">auto</span> shis = whis.lock()) {
            <span class="hljs-keyword">if</span> (shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
                shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
                <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
            }<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N11SimpleZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¼ãƒ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿®æ­£ã•ã‚ŒãŸ</font><b><font style="vertical-align: inherit;">ã‚ˆã†ã§ã™</font></b><font style="vertical-align: inherit;"> -ã‚¾ãƒ³ãƒ“ã¯æ­£ã—ãåœæ­¢ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€ã‚»ãƒãƒ•ã‚©ã¯ä¸è¦ã«ãªã‚Šã¾ã—ãŸï¼ˆå®Ÿéš›ã«ã¯æ©Ÿèƒ½ã—ã¦ã„ã¾ã›ã‚“ã§ã—ãŸï¼‰ã€‚åœæ­¢ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ãƒ•ãƒ­ãƒ¼ã«é€šçŸ¥ã™ã‚‹æ©Ÿèƒ½ã‚’std :: shared_ptrã‚¢ãƒˆãƒŸãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã‚»ãƒãƒ•ã‚©ã®å”¯ä¸€ã®åˆ©ç‚¹ã¯ã€runOnceé–¢æ•°ã®ç¹°ã‚Šè¿”ã—å‘¼ã³å‡ºã—ã«å¯¾ã™ã‚‹ä¿è­·ã§ã™ãŒã€ãŸã¨ãˆã°ã€_listenerã®ãƒã‚§ãƒƒã‚¯ã«ã‚·ãƒ•ãƒˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ãƒãƒ•ã‚©ã‚’å‰Šé™¤ã—ãŸå¾Œï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">auto</span> shis = whis.lock()) {
            <span class="hljs-keyword">if</span> (shis-&gt;_listener) {<font></font>
                shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
                <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
            }<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€è©³ã—ãèª¿ã¹ã¦ã¿ã‚‹ã¨ã€ãƒ©ãƒ ãƒ€ã®æœ¬ä½“ã§ã¯ã€é•·ã„é–“ã€é•·ã„sleep_foræ“ä½œãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹é–“ã¯å¸¸ã«ã€å¼·ã„ãƒªãƒ³ã‚¯ãŒä¸å½“ã«ä¿æŒã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚ˆã†ãªä½•ã‹ãŒä¿®æ­£ã•ã‚Œã¦ã„ã¾ã™ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">auto</span> shis = whis.lock()) {
            <span class="hljs-keyword">if</span> (shis-&gt;_listener) {<font></font>
                shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));<font></font>
                shis.reset();<font></font>
                <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
            }<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã¯ã“ã®ã‚ˆã†ã«ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
                shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã¦ã€æ¬¡ã®ä¾‹ã«é€²ã¿ã¾ã™ã‹ï¼Ÿ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã©ã‚“ãªã«ï¼</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ãƒ¬ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã‚’ç¤ºã™æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯ã€ä¼ç¥¨ã‚’æ©Ÿå¯†æ€§ã®é«˜ã„å ´æ‰€ã«è»¢é€ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {
<span class="hljs-comment">/*!!!*/</span>         <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
                shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));<font></font>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
N11SimpleZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚ŒãŒèµ·ã“ã£ãŸã“ã¨ã§ã™ï¼š</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã‚¹ãƒ¬ãƒƒãƒ‰</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">runOnceã‚’å‘¼ã³å‡ºã™</font></font></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ©ãƒ ãƒ€é–¢æ•°ã®ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®å¼±ã„ãƒªãƒ³ã‚¯ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™</font></font></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã™ã‚‹ãƒ©ãƒ ãƒ€é–¢æ•°ã‚’é–‹å§‹ã—ã¾ã™</font></font></td>
<td></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµæœã‚’ç¢ºèªã—ãªãŒã‚‰ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®å¼·ã„å‚ç…§ã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¤œè¨¼ã¯æˆåŠŸã—ã¾ã—ãŸ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜ä¸€ã®å¤–éƒ¨ã‚¹ãƒˆãƒ­ãƒ³ã‚°ãƒªãƒ³ã‚¯ã‚’ç ´æ£„ã—ã¾ã™</font></font></td>
<td></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«é€ä¿¡ã—ã¾ã™-ãƒªã‚¹ãƒŠãƒ¼</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ã¯æ­¢ã¾ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ãã‚Œã§ã‚‚ã¾ã æ‰‹é…ã‚Œã§ã™ã€‚ç ´å£Šã•ã‚ŒãŸã‚¾ãƒ³ãƒ“ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ1ã¤ã‚ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿œã˜ã¦ã€ã“ã®å‹•ä½œã¯è¨±å®¹å¯èƒ½ã§ã‚ã‚‹ã‹ã€äºˆæœŸã—ãªã„ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãŒãƒªã‚¹ãƒŠãƒ¼ã«åˆ°ç€ã™ã‚‹ã®ãŒäºˆæœŸã—ãªã„ã®ã¯ãªãœã§ã™ã‹ï¼Ÿ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¾ãƒ³ãƒ“ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å”¯ä¸€ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½¼ãŒæœŸå¾…ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®åˆ°ç€ã«ã¯ã€ãŠãã‚‰ãã•ã‚‰ãªã‚‹å‡¦ç†ï¼ˆå¾©å·åŒ–ã€è§£æã€ç”»é¢ã¸ã®è¡¨ç¤ºãªã©ï¼‰ãŒå«ã¾ã‚Œã¾ã™ã€‚ã‚¾ãƒ³ãƒ“ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒç ´å£Šã•ã‚Œã‚‹ã¨ã€ã“ã®ã‚¿ã‚¤ãƒ—ã®ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚‚ç ´å£Šã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ç ´å£Šã•ã‚ŒãŸãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã«å‡¦ç†ã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ã‚’è»¢é€ã™ã‚‹ã¨ã€æœªå®šç¾©ã®å‹•ä½œãŒç™ºç”Ÿã™ã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ã‚¾ãƒ³ãƒ“ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€é«˜ãƒ¬ãƒ™ãƒ«ã®å¿œç­”ã‚’ç¤ºå”†ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><b><font style="vertical-align: inherit;">ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ãƒœã‚¿ãƒ³ã‚’</font></b><font style="vertical-align: inherit;">ã‚¯ãƒªãƒƒã‚¯ã—ãŸå¾Œã€</font><b><font style="vertical-align: inherit;">ã€Œ</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆåŠŸã—ã¾ã—ãŸã€</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå–œã¶ã“ã¨ã¯ã¾ãšã‚ã‚Šã¾ã›ã‚“</font><font style="vertical-align: inherit;">ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ†ãƒƒãƒ”ãƒ³ã‚°ã‚¾ãƒ³ãƒ“</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SteppingZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SteppingZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;resolveDnsName();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;connectTcp();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;establishSsl();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;sendHttpRequest();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;readHttpReply();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N13SteppingZomby5ZombyE::resolveDnsName started<br>
N13SteppingZomby5ZombyE::resolveDnsName finished<br>
N13SteppingZomby5ZombyE::connectTcp started<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N13SteppingZomby5ZombyE::connectTcp finished<br>
N13SteppingZomby5ZombyE::establishSsl started<br>
N13SteppingZomby5ZombyE::establishSsl finished<br>
N13SteppingZomby5ZombyE::sendHttpRequest started<br>
N13SteppingZomby5ZombyE::sendHttpRequest finished<br>
N13SteppingZomby5ZombyE::readHttpReply started<br>
N13SteppingZomby5ZombyE::readHttpReply finished<br>
N13SteppingZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼ˆä¸è¦ãªã‚»ãƒãƒ•ã‚©ãƒã‚§ãƒƒã‚¯ã‚’ã™ãã«å‰Šé™¤ã—ã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SteppingZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SteppingZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()](){
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
            shis-&gt;resolveDnsName();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
            shis-&gt;connectTcp();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
            shis-&gt;establishSsl();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
            shis-&gt;sendHttpRequest();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> shis = whis.lock(); shis &amp;&amp; shis-&gt;_listener) {<font></font>
            shis-&gt;readHttpReply();<font></font>
        }<font></font>
    });<font></font>
}</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N13SteppingZomby5ZombyE::resolveDnsName started<br>
N13SteppingZomby5ZombyE::resolveDnsName finished<br>
N13SteppingZomby5ZombyE::connectTcp started<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N13SteppingZomby5ZombyE::connectTcp finished<br>
N13SteppingZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SimpleZombyã®ä¾‹ã®ã‚ˆã†ã«ï¼š</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã©ã†ã‚„ã‚‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã‚’æ­¢ã‚ã‚‹ã“ã¨ãŒã§ããŸã‚ˆã†ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼·åŠ›ãªãƒªãƒ³ã‚¯ãŒé•·ã™ãã¾ã™-resolveDnsNameã€connectTcpã€EstablishSslã€sendHttpRequestã€readHttpReplyã®å„é–¢æ•°ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æœ‰åŠ¹ãªçŠ¶æ…‹ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç«¶åˆçŠ¶æ…‹ãŒå­˜åœ¨ã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–‹å§‹ã•ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—ã¯å¸¸ã«æœ€å¾Œã¾ã§å®Ÿè¡Œã•ã‚Œã€å¸¸ã«ãƒªã‚¹ãƒŠãƒ¼ã«çµæœã‚’é€ä¿¡ã—ã¾ã™ãŒ</font><font style="vertical-align: inherit;">ã€ã»ã¨ã‚“ã©ã®å ´åˆã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ†ãƒƒãƒ—</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®</font><b><font style="vertical-align: inherit;">ãƒã‚§ãƒ¼ãƒ³ã¯</font></b><font style="vertical-align: inherit;">ä¸Šä½ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã£ã¦ä¸­æ–­ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒ</font><b><font style="vertical-align: inherit;">ã‚ã‚Šã¾ã™</font></b><font style="vertical-align: inherit;"> -ãƒ¬ãƒ¼ã‚¹ã®å ´åˆã‚’é™¤ã„ã¦ã€å¤–éƒ¨ã®å¼·ã„ãƒªãƒ³ã‚¯ãŒç ´å£Šã•ã‚ŒãŸå¾Œã‚‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’é–‹å§‹ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã¨ã€å¼·åŠ›ãªãƒªãƒ³ã‚¯ã®ä¿æŒæ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¾ã™ãŒã€ç«¶åˆçŠ¶æ…‹ãŒå®Œå…¨ã«è§£æ¶ˆã•ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boozdedzomby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BoozdedZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"BoozdedZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()]() {
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_semaphore &amp;&amp; shis-&gt;_listener) {
            <span class="hljs-keyword">auto</span> handler = [shis](<span class="hljs-keyword">auto</span> errorCode) {
                <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; errorCode == boozd::azzio::io_context::error_code::no_error) {
                    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
                    buf &lt;&lt; <span class="hljs-string">"BoozdedZomby has got a fresh data: "</span>;
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span> &amp;elem; : shis-&gt;_buffer)<font></font>
                        buf &lt;&lt; elem &lt;&lt; <span class="hljs-string">' '</span>;<font></font>
                    buf &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
                    shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
                }<font></font>
            };<font></font>
            shis-&gt;_buffer.clear();<font></font>
            shis-&gt;_context.async_read(shis-&gt;_stream, shis-&gt;_buffer, handler);<font></font>
            shis-&gt;_context.run();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>BoozdedZomby has got a fresh data: 1144108930 101027544 1458777923 1115438165 74243042 <br>
BoozdedZomby has got a fresh data: 143542612 1131570933 <br>
BoozdedZomby has got a fresh data: 893351816 563613512 704877633 <br>
BoozdedZomby has got a fresh data: 1551901393 1399125485 1899894091 937186357 590357944 357571490 <br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
BoozdedZomby has got a fresh data: 1927702196 130060903 1083454666 2118797801 2035308228 824938981 <br>
BoozdedZomby has got a fresh data: 2020739063 1635339425 34075629 <br>
BoozdedZomby has got a fresh data: 2146319451 500782188 1269406752 884936716 892053144 <br>
BoozdedZomby has got a fresh data: 330111137 1723153177 1070477904 <br>
BoozdedZomby has got a fresh data: 343098142 280090412 589673557 889688008 2014119113 388471006 <br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BoozdedZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"BoozdedZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([whis = weak_from_this()]() {
        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">auto</span> shis = whis.lock()) {
            <span class="hljs-keyword">if</span> (shis-&gt;_semaphore &amp;&amp; shis-&gt;_listener) {
                <span class="hljs-keyword">auto</span> handler = [whis](<span class="hljs-keyword">auto</span> errorCode) {
                    <span class="hljs-keyword">auto</span> shis = whis.lock();
                    <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; errorCode == boozd::azzio::io_context::error_code::no_error) {
                        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
                        buf &lt;&lt; <span class="hljs-string">"BoozdedZomby has got a fresh data: "</span>;
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span> &amp;elem; : shis-&gt;_buffer)<font></font>
                            buf &lt;&lt; elem &lt;&lt; <span class="hljs-string">' '</span>;<font></font>
                        buf &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
                        shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
                    }<font></font>
                };<font></font>
                shis-&gt;_buffer.clear();<font></font>
                shis-&gt;_context.async_read(shis-&gt;_stream, shis-&gt;_buffer, handler);<font></font>
                shis-&gt;_context.run();<font></font>
            }<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>BoozdedZomby has got a fresh data: 1144108930 101027544 1458777923 1115438165 74243042 <br>
BoozdedZomby has got a fresh data: 143542612 1131570933 <br>
BoozdedZomby has got a fresh data: 893351816 563613512 704877633 <br>
BoozdedZomby has got a fresh data: 1551901393 1399125485 1899894091 937186357 590357944 357571490 <br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
BoozdedZomby has got a fresh data: 1927702196 130060903 1083454666 2118797801 2035308228 824938981 <br>
N12BoozdedZomby5ZombyE::~Zomby<br>
N5boozd5azzio10io_contextE::~io_context<br>
N5boozd5azzio13random_streamE::~random_stream<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ã‚¹ãƒ¬ãƒƒãƒ‰ã¯ã€é–¢æ•°boozd :: azzio :: io_context :: runï¼ˆï¼‰ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã€runï¼ˆï¼‰ã‹ã‚‰æˆ»ã‚‹ã¾ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã€ãƒãƒƒãƒ•ã‚¡ã€ãŠã‚ˆã³ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ã€ã‚¯ãƒ©ã‚¹ã®æœ‰åŠ¹ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§å‘¼ã³å‡ºã•ã‚Œã¾ã™-ã¤ã¾ã‚Šã€ãƒªã‚¹ãƒŠãƒ¼ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒã˜æ¬ é™¥ãŒã‚³ãƒ¼ãƒ‰ã«å­˜åœ¨ã—ã€ãã‚Œã‚‰ã¯ã‚ˆã‚Šé¡•è‘—ã«ãªã‚Šã¾ã™ã€‚BoozdedZombyã¯é–‹å§‹ã•ã‚ŒãŸæ“ä½œã‚’æœ€å¾Œã¾ã§å¤‰æ›´ã—ã€å¤–éƒ¨ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®ç¹°ã‚Šè¿”ã—ã®ã¿ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ©Ÿèƒ½ã—ãªã‹ã£ãŸã¨è¨€ãˆ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã®æ“ä½œã§ã¯ãªãã€ç¾åœ¨ã®æ“ä½œã‚’åœæ­¢ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼±ã„æ–¹æ³•ã«ã‚ˆã‚‹çµè«–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shared_from_thisã®ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¼ã‚’weak_from_thisã®ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¼ã«ç½®ãæ›ãˆã‚‹ã¨ã„ã†ç‚¹ã§ã®ã¿ã‚¾ãƒ³ãƒ“ã®ã¿ã®å¤‰æ›´ï¼š</font></font><br>
<br>
<ul>
<li>      (   ,    );</li>
<li>     (        ,      listener    -).</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ãŒæ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«ã¯ã€å¼·åŠ›ãªãƒªãƒ³ã‚¯ã‚’å°‘ãªãã¨ã‚‚çŸ­æ™‚é–“ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ç¾æ™‚ç‚¹ã§ã¯ã€ã™ã¹ã¦ã®å¤–éƒ¨ãƒªãƒ³ã‚¯ãŒç ´å£Šã•ã‚Œã¦ã‚‚åœæ­¢ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">å ´åˆã«ã‚ˆã£ã¦ã¯ã€å¼·åŠ›ãªãƒªãƒ³ã‚¯ãŒé•·æ™‚é–“ä¿æŒã•ã‚Œã‚‹ãŸã‚ã€ã“ã®æ–¹æ³•ã¯å®Ÿéš›ã«ã¯é©ç”¨ã§ããªããªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ‰åŠ¹æ€§ã¯ã€ä½œæ¥­ã‚’ç¶šè¡Œã™ã‚‹ãŸã‚ã®å”¯ä¸€ã®æ¡ä»¶ã¨ã—ã¦ã¯ã‚ã¾ã‚Šé©ã—ã¦ã„ã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒæ™‚ã«ã€ãƒ¬ãƒ¼ã‚¹ã®å•é¡Œã¯ã‚¾ãƒ³ãƒ“ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹æ–¹æ³•ã®é¸æŠã«é–¢é€£ã—ã¦ãŠã‚Šã€ã‚ˆã‚Šé©åˆ‡ãªè»¢é€æ–¹æ³•ã‚’é¸æŠã™ã‚‹ã¨ãã€ã¾ãŸã¯ã‚ˆã‚Šå¯›å®¹ãªå—ä¿¡è€…ã®å­˜åœ¨ä¸‹ã§è§£æ±ºã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼ˆã“ã®å•é¡Œã«æˆ»ã‚Šã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ­£ç›´ã€ã¾ãŸã¯use_count</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shared_from_this </font><b><font style="vertical-align: inherit;">ã‚’</font></b><font style="vertical-align: inherit;">å¼•ãç¶šãã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™ãŒã€åŒæ™‚ã«std :: shared_ptr :: use_countï¼ˆï¼‰ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªãœæ­£ç›´ãªã®ã‹ï¼Ÿ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
weak_from_thisã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è‡ªåˆ†ã®å¯¿å‘½ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ã‚’æ‹’å¦ã™ã‚‹ã‚ˆã†ãªéŒ¯è¦šãŒç”Ÿã˜ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯-è‡ªå·±æ¬ºçã¯ã‚ã‚Šã¾ã›ã‚“ã€ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã¾ã </font><font style="vertical-align: inherit;">ãã‚Œè‡ªèº«ã®å¯¿å‘½ã‚’</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¶å¾¡</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—åŒæ™‚ã«ã€å¤–éƒ¨ã®å¼·åŠ›ãªãƒªãƒ³ã‚¯ãŒãªã„çŠ¶æ³ã‚’æ¤œå‡ºã—ã¾ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplezomby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N11SimpleZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å¤‰æ›´ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ã€weakãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨æ­£ç¢ºã«ä¸€è‡´ã—ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ãƒãƒ•ã‚©ã¯çµ‚äº†æ¡ä»¶ã§å†—é•·ã«ãªã‚Šã¾ã—ãŸã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“ã¯åœæ­¢ã—ã¾ã—ãŸãŒã€ç«¶åˆçŠ¶æ…‹ãŒã‚ã‚Šã¾ã™ï¼ˆã‚¾ãƒ³ãƒ“ã‚¹ãƒˆãƒªãƒ¼ãƒ ã§ã®use_countï¼ˆï¼‰ãƒã‚§ãƒƒã‚¯ãŒæˆåŠŸã—ãŸå ´åˆã€æœ€å¾Œã®å¤–éƒ¨ãƒªãƒ³ã‚¯ãŒç ´æ£„ã•ã‚ŒãŸå¾Œã§ã‚‚ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã™ï¼‰ã€‚</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ†ãƒƒãƒ”ãƒ³ã‚°ã‚¾ãƒ³ãƒ“</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SteppingZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SteppingZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;resolveDnsName();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;connectTcp();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;establishSsl();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;sendHttpRequest();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;readHttpReply();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N13SteppingZomby5ZombyE::resolveDnsName started<br>
N13SteppingZomby5ZombyE::resolveDnsName finished<br>
N13SteppingZomby5ZombyE::connectTcp started<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N13SteppingZomby5ZombyE::connectTcp finished<br>
N13SteppingZomby5ZombyE::establishSsl started<br>
N13SteppingZomby5ZombyE::establishSsl finished<br>
N13SteppingZomby5ZombyE::sendHttpRequest started<br>
N13SteppingZomby5ZombyE::sendHttpRequest finished<br>
N13SteppingZomby5ZombyE::readHttpReply started<br>
N13SteppingZomby5ZombyE::readHttpReply finished<br>
N13SteppingZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SteppingZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SteppingZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;resolveDnsName();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;connectTcp();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;establishSsl();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;sendHttpRequest();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;readHttpReply();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>N13SteppingZomby5ZombyE::resolveDnsName started<br>
N13SteppingZomby5ZombyE::resolveDnsName finished<br>
N13SteppingZomby5ZombyE::connectTcp started<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N13SteppingZomby5ZombyE::connectTcp finished<br>
N13SteppingZomby5ZombyE::~Zomby<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ãŒå¼±ã„æ–¹æ³•ã®ã‚ˆã†ã§ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boozdedzomby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BoozdedZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"BoozdedZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()]() {
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_semaphore &amp;&amp; shis-&gt;_listener) {
            <span class="hljs-keyword">auto</span> handler = [shis](<span class="hljs-keyword">auto</span> errorCode) {
                <span class="hljs-keyword">if</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; errorCode == boozd::azzio::io_context::error_code::no_error) {
                    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
                    buf &lt;&lt; <span class="hljs-string">"BoozdedZomby has got a fresh data: "</span>;
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span> &amp;elem; : shis-&gt;_buffer)<font></font>
                        buf &lt;&lt; elem &lt;&lt; <span class="hljs-string">' '</span>;<font></font>
                    buf &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
                    shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
                }<font></font>
            };<font></font>
            shis-&gt;_buffer.clear();<font></font>
            shis-&gt;_context.async_read(shis-&gt;_stream, shis-&gt;_buffer, handler);<font></font>
            shis-&gt;_context.run();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>BoozdedZomby has got a fresh data: 1144108930 101027544 1458777923 1115438165 74243042 <br>
BoozdedZomby has got a fresh data: 143542612 1131570933 <br>
BoozdedZomby has got a fresh data: 893351816 563613512 704877633 <br>
BoozdedZomby has got a fresh data: 1551901393 1399125485 1899894091 937186357 590357944 357571490 <br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
BoozdedZomby has got a fresh data: 1927702196 130060903 1083454666 2118797801 2035308228 824938981 <br>
BoozdedZomby has got a fresh data: 2020739063 1635339425 34075629 <br>
BoozdedZomby has got a fresh data: 2146319451 500782188 1269406752 884936716 892053144 <br>
BoozdedZomby has got a fresh data: 330111137 1723153177 1070477904 <br>
BoozdedZomby has got a fresh data: 343098142 280090412 589673557 889688008 2014119113 388471006 <br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BoozdedZomby :: Zomby :: runOnce</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"BoozdedZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()]() {
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_semaphore &amp;&amp; shis-&gt;_listener) {
            <span class="hljs-keyword">auto</span> handler = [&amp;shis;](<span class="hljs-keyword">auto</span> errorCode) {
                <span class="hljs-keyword">if</span> (shis &amp;&amp; shis.use_count() &gt; <span class="hljs-number">1</span> &amp;&amp; shis-&gt;_listener &amp;&amp; errorCode == boozd::azzio::io_context::error_code::no_error) {
                    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
                    buf &lt;&lt; <span class="hljs-string">"BoozdedZomby has got a fresh data: "</span>;
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> <span class="hljs-keyword">const</span> &amp;elem; : shis-&gt;_buffer)<font></font>
                        buf &lt;&lt; elem &lt;&lt; <span class="hljs-string">' '</span>;<font></font>
                    buf &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
<font></font>
                    shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
                }<font></font>
            };<font></font>
            shis-&gt;_buffer.clear();<font></font>
            shis-&gt;_context.async_read(shis-&gt;_stream, shis-&gt;_buffer, handler);<font></font>
            shis-&gt;_context.run();<font></font>
        }<font></font>
    });<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>BoozdedZomby has got a fresh data: 1144108930 101027544 1458777923 1115438165 74243042 <br>
BoozdedZomby has got a fresh data: 143542612 1131570933 <br>
BoozdedZomby has got a fresh data: 893351816 563613512 704877633 <br>
BoozdedZomby has got a fresh data: 1551901393 1399125485 1899894091 937186357 590357944 357571490 <br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N12BoozdedZomby5ZombyE::~Zomby<br>
N5boozd5azzio10io_contextE::~io_context<br>
N5boozd5azzio13random_streamE::~random_stream<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€å¼±ã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æœ‰åŠ¹æ€§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¹ãƒŠãƒ¼ã«è»¢é€ã™ã‚‹ååˆ†ãªç†ç”±ã¨ã¯è¦‹ãªã•ã‚Œãšã€å°‘ãªãã¨ã‚‚1ã¤ã®å¤–éƒ¨ã®å¼·ã„ãƒªãƒ³ã‚¯ã®å­˜åœ¨ã‚‚å¿…è¦ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã¯ã€ç´°å¿ƒã®æ³¨æ„ã‚’æ‰•ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚¾ãƒ³ãƒ“å†…ã«è¿½åŠ ã®å¼·åŠ›ãªã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ã¯éå¸¸ã«èª¤ã‚Šã§ã™ï¼ˆç¾åœ¨ã€shisã¯å€¤ã§ã¯ãªãå‚ç…§ã«ã‚ˆã£ã¦ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã«ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼‰ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€ãƒã‚§ãƒƒã‚¯ã«é©ã—ãŸå ´æ‰€ã‚’é¸æŠã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç«¶åˆçŠ¶æ…‹ã¯ã¾ã å­˜åœ¨ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use_countãƒ¡ã‚½ãƒƒãƒ‰ã®å‡ºåŠ›</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shared_from_thisã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’ä¿å­˜ã—ãªãŒã‚‰ã€use_countãƒã‚§ãƒƒã‚¯ã‚’çµ‚äº†æ¡ä»¶ã«è¿½åŠ ã™ã‚‹ã¨ã€weakãƒ¡ã‚½ãƒƒãƒ‰ã¨æ¯”è¼ƒã—ã¦ç„¡åŠ¹ãªçŠ¶æ…‹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒªã‚¹ã‚¯ãŒè»½æ¸›ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">åŒæ™‚ã«ã€ã‚¾ãƒ³ãƒ“ãŒä¸Šä½ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã£ã¦ç ´å£Šã•ã‚ŒãŸå¾Œã‚‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¹ãƒŠãƒ¼ã«é€ä¿¡ã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
use_countãƒ¡ã‚½ãƒƒãƒ‰ã¨weakãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒ‡ãƒ¼ã‚¿è»¢é€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é©åˆ‡ã«èª¿æ•´ã—ã¦å®Ÿéš›ã«ä½¿ç”¨ã™ã‚‹ã®ã«é©ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®ã‚ˆã†ãªé©å¿œã¯æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€çµ‚çš„ãªãƒªã‚¹ãƒŠãƒ¼ã‹ã‚‰ã®ä¿¡é ¼ã§ãã‚‹åˆ‡æ–­ã‚’ä¿è¨¼ã™ã‚‹ã‚¾ãƒ³ãƒ“ãƒ—ãƒ­ã‚­ã‚·ãƒªã‚¹ãƒŠãƒ¼ã‚’æä¾›ã—ã¾ã™ï¼ˆãŸã ã—ã€ã“ã®æ–¹æ³•ã¯å˜ç´”ã§ã‚‚ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã§ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒªãƒã‚¸ãƒˆãƒªã®ä¾‹ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚fixes/ weak_with_ProxyListenerãƒ–ãƒ©ãƒ³ãƒï¼‰;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qt Signalsï¼†Slotsãªã©ã®è¤‡é›‘ãªã‚·ã‚¹ãƒ†ãƒ ã®ä½¿ç”¨ï¼ˆãŸã ã—ã€ã“ã“ã§ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ä»£ã‚ã‚Šã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å¹»æƒ³ã‚’å¾—ã‚‹ã®ã¯ç°¡å˜ã§ã™ï¼‰ã€‚</font></font></li>
<li>  event-driven    â€”        ,              . </li>
</ul><br>
<h2> ,  this</h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã®è€ƒãˆæ–¹ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> std :: shared_from_thisã‹ã‚‰ã®ç¶™æ‰¿</font><b><font style="vertical-align: inherit;">ã‚’</font></b><font style="vertical-align: inherit;">æ‹’å¦ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">è‡ªåˆ†ã®äººç”Ÿã®æ™‚é–“ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§æ±šã„ãƒˆãƒªãƒƒã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ©ãƒ ãƒ€é–¢æ•°ã¯ã“ã‚Œã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¹ãƒ¬ãƒƒãƒ‰ã®å­˜ç¶šæœŸé–“ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å­˜ç¶šæœŸé–“ã¨åŒæœŸã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã¯ã€std :: thread :: detachï¼ˆï¼‰ã®ä»£ã‚ã‚Šã«std :: thread :: joinï¼ˆï¼‰ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¾ãƒ³ãƒ“ãŒæº¶ã‘ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»£ã‚ã‚Šã«ã€ç–‘ä¼¼éåŒæœŸã‚¯ãƒ©ã‚¹ãŒç™ºç”Ÿã—ã¾ã™ã€‚ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’é™¤ã„ã¦ã€ãã®ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã§ã™ã€‚</font><font style="vertical-align: inherit;">ç ´å£Šã¯ç„¡æœŸé™ã«ç¶™ç¶šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™-éåŒæœŸã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä¸ãˆã‚ˆã†ã¨ã—ãŸãƒ—ãƒ­ã‚»ã‚¹ã®æœŸé–“ã®ã‚ªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚</font><font style="vertical-align: inherit;">å®Ÿéš›ã«ã¯ã€ãã‚Œã¯å˜ä½ã¾ãŸã¯æ•°åç§’ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€å¤–éƒ¨è¦å› ï¼ˆHTTPè¦æ±‚ã¸ã®å¿œç­”ã®ã‚µã‚¤ã‚ºã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‘ã‚±ãƒƒãƒˆæå¤±ãªã©ï¼‰ã«å¿œã˜ã¦å¯èƒ½ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager, <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Zomby&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.join();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([<span class="hljs-keyword">this</span>](){
        <span class="hljs-keyword">while</span> (_listener &amp;&amp; _semaphore) {<font></font>
            _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
N11SimpleZomby5ZombyE::~Zomby<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³¨æ„ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã“ã‚Œã¾ã§ã®ã¨ã“ã‚ã€ã‚¾ãƒ³ãƒ“ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ï¼ˆå®Ÿéš›ã«ã¯ã‚¾ãƒ³ãƒ“ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒï¼‰ãŒ</font><font style="vertical-align: inherit;">ã€Œ</font><font style="vertical-align: inherit;">ã‚¾ãƒ³ãƒ“</font><font style="vertical-align: inherit;">ãŒæ®ºã•ã‚ŒãŸã€ã®å‡ºåŠ›ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«å‘¼ã³å‡ºã•ã‚ŒãŸå”¯ä¸€ã®ä¾‹</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ãƒãƒ•ã‚©ã¯æœ€çµ‚çš„ã«æœ€åˆã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå½¹å‰²ã‚’æœãŸã—ã¾ã—ãŸãŒã€_listenerã®æ¤œè¨¼ã§ç½®ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’std :: shared_ptrã«æ’ä»–çš„ã«æ ¼ç´ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã€é™çš„é–¢æ•°createï¼ˆï¼‰ã‚’å‰Šé™¤ã—ã¦ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ã‚¯ãƒ©ã‚¹ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ç§»å‹•ã§ãã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã‚’ãƒ©ãƒ ãƒ€é–¢æ•°ã«å–ã‚Šè¾¼ã‚€ã«ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ãƒ¡ãƒ¢ãƒªã«ä¿æŒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚Common:: Managerã‹ã‚‰ç¶™æ‰¿ã•ã‚ŒãŸã‚³ãƒ”ãƒ¼ãŠã‚ˆã³ç§»å‹•ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã®ç¦æ­¢ã¯ä¾ç„¶ã¨ã—ã¦é‡è¦ã§ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å ´åˆã€SteppingZombyã¨BoozdedZombyã®å¤‰æ›´ã¯å®Œå…¨ã«ä¼¼ã¦ã„ã‚‹ãŸã‚ã€è¨˜äº‹ã«ãã‚Œã‚‰ã‚’å«ã‚ã¦ã‚‚æ„å‘³ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">èª°ã«ã¨ã£ã¦èˆˆå‘³æ·±ã„ã®ã‹-ãƒªãƒã‚¸ãƒˆãƒªã®ä¿®æ­£/ã“ã®ãƒ–ãƒ©ãƒ³ãƒã‚’è¦‹ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®æ–¹æ³•ã«ã‚ˆã‚‹çµè«–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’é™¤ãã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">GUIã‚¹ãƒ¬ãƒƒãƒ‰ã‚’æ•°ç§’é–“ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ãƒ—ãƒ­ã‚»ã‚¹ãŒãƒãƒ³ã‚°ã—ãŸã¨è¦‹ãªã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å½¢ã§ã¯ã€ã“ã®æ–¹æ³•ã¯å®Ÿéš›ã®ä½¿ç”¨ã«ã¯ã»ã¨ã‚“ã©é©ã—ã¦ã„ãªã„ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é©åˆ‡ãªãƒ¡ã‚½ãƒƒãƒ‰ã€ã¾ãŸã¯semaphore_done_right</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¾ã§ã«æ¤œè¨ã—ãŸã™ã¹ã¦ã®ä¾‹ã§ã€ã‚¯ãƒ©ã‚¹ã¯ã€åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒæ©Ÿèƒ½ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®ã‚¢ã‚°ãƒªã‚²ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã«ã‚ˆã‚Šã€å®Ÿè¡Œä¸­ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã®æœ‰åŠ¹æœŸé–“ã‚’è¶…ãˆã¦ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æœ‰åŠ¹æœŸé–“ã‚’ç¢ºä¿ã™ã‚‹å¿…è¦ãŒç”Ÿã˜ã¾ã—ãŸã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¯ã„ã€ã‚¯ãƒ©ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€ã“ã‚ŒãŒä¸€é€£ã®è¤‡é›‘ãªå•é¡Œã«ã¤ãªãŒã‚‰ãªã„å ´åˆã«é™ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã®è€ƒãˆæ–¹ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒ é–“ã®è²¬ä»»</font><b><font style="vertical-align: inherit;">ã®</font></b><font style="vertical-align: inherit;">æ­£ã—ã„åˆ†å‰²ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ãƒ©ã‚¹ã®ç¾©å‹™ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®é–‹å§‹ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚»ãƒãƒ•ã‚©ã‚’ç¦æ­¢çŠ¶æ…‹ã«å¤‰æ›ã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ã‚¸ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ãƒãƒ•ã‚©ãŒç„¡åŠ¹ãªçŠ¶æ…‹ã®ã¨ãã¯ã€ä½œæ¥­ã‚’ç¶šè¡Œã—ãªã„ã§ãã ã•ã„ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãé€šä¿¡ï¼ˆå…±æœ‰ã‚»ãƒãƒ•ã‚©ã‚’é™¤ãï¼‰ã€å­˜ç¶šæœŸé–“ã®è¦ä»¶ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ˆç‰¹ã«ã€åŸºã«ãªã‚‹ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‹ã‚‰ä¸Šã«ã‚ã‚‹ã‚¯ãƒ©ã‚¹ã¸ï¼‰ã€‚</font><font style="vertical-align: inherit;">ãƒ©ãƒ ãƒ€ã§ã®ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã¯ã‚ã‚Šã¾ã›ã‚“-ç”Ÿã®ãƒã‚¤ãƒ³ã‚¿ã®å½¢å¼ã¾ãŸã¯ã‚¹ãƒãƒ¼ãƒˆãªãƒã‚¤ãƒ³ã‚¿ã®å½¢å¼ã®ã„ãšã‚Œã‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
weakãƒ¡ã‚½ãƒƒãƒ‰ã¨use_countãƒ¡ã‚½ãƒƒãƒ‰ã§ç™ºç”Ÿã™ã‚‹ç«¶åˆã‚’æ’é™¤ã™ã‚‹ã«ã¯ã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ãŸåŒæœŸã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€ã‚»ãƒãƒ•ã‚©ã®å€¤ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚‹é–“ã¯mutexã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã€ãƒªã‚¹ãƒŠãƒ¼ã¸ã®ãƒ‡ãƒ¼ã‚¿è»¢é€æ“ä½œã®é–“ã¯åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã®çµ‚äº†ã‚’å¾…ãŸãšã«std :: thread :: detachï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ˆå¾Œã§ã“ã®è³ªå•ã«æˆ»ã‚Šã¾ã™ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã†ã ã£ãŸï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager, <span class="hljs-keyword">public</span> <span class="hljs-built_in">std</span>::enable_shared_from_this&lt;Zomby&gt;<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;<font></font>
    Semaphore _semaphore = <span class="hljs-literal">false</span>;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    _semaphore = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([shis = shared_from_this()](){
        <span class="hljs-keyword">while</span> (shis &amp;&amp; shis-&gt;_listener &amp;&amp; shis-&gt;_semaphore) {<font></font>
            shis-&gt;_listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">create</span><span class="hljs-params">()</span></span>;<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
    Zomby();<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-built_in">std</span>::mutex, <span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Semaphore&gt; _semaphore;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt; <span class="hljs-title">Zomby::create</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Zomby&gt;(<span class="hljs-keyword">new</span> Zomby());<font></font>
}<font></font>
<font></font>
Zomby::Zomby() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">std</span>::this_thread::get_id() != _thread.get_id()) {
            <span class="hljs-keyword">auto</span> guard = <span class="hljs-built_in">std</span>::lock_guard(_semaphore-&gt;first);<font></font>
            _semaphore-&gt;second = <span class="hljs-literal">false</span>;<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            _semaphore-&gt;second = <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.detach();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    <span class="hljs-comment">// two separate lines needed because of absence of std::mutex move c-tor</span>
    _semaphore = <span class="hljs-built_in">std</span>::make_shared&lt;Semaphore&gt;();<font></font>
    _semaphore-&gt;second = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([listener, semaphore = _semaphore](){
        <span class="hljs-keyword">while</span> (listener &amp;&amp; semaphore) {<font></font>
            {<font></font>
                <span class="hljs-keyword">auto</span> guard = <span class="hljs-built_in">std</span>::lock_guard(semaphore-&gt;first);
                <span class="hljs-keyword">if</span> (!semaphore-&gt;second) {
                    <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
                listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));<font></font>
            }<font></font>
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
N11SimpleZomby5ZombyE::~Zomby<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SteppingZombyã¨BoozdedZombyã®å¤‰æ›´ã¯é¡ä¼¼ã—ã¦ã„ã¾ã™ï¼ˆfixs / semaphore_done_rightãƒ–ãƒ©ãƒ³ãƒã‚’å‚ç…§ï¼‰-BoozdedZombyã‚¯ãƒ©ã‚¹ã®å®£è¨€ãŒSimpleZombyã‚¯ãƒ©ã‚¹ã®å®£è¨€ã¨ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«é¡ä¼¼ã—ã¦ãŠã‚Šã€SteppingZombyã«ã¯ã€ãƒ•ãƒªãƒ¼é–¢æ•°ã«å¤‰æ›ã§ãã‚‹è¿½åŠ ã®é™çš„é–¢æ•°ã®ã¿ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å®Ÿè¡Œæ™‚é–“ã¯å¤–éƒ¨è¦å› ã«ä¾å­˜ã—ãªããªã‚Šã¾ã—ãŸã€‚mutexã®ç«¶åˆã®ã¿ãŒã‚ã‚Šã€å‡¦ç†ã¸ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ã®éå¸¸ã«é«˜é€Ÿãªæ“ä½œã‚’ä¿è­·ã—ã¾ã—ãŸã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒŸãƒ¥ãƒ¼ãƒ†ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ãŸæ­£ç¢ºãªä½œæ¥­ã«ã‚ˆã‚Šã€ç«¶åˆçŠ¶æ…‹ã‚’å–ã‚Šé™¤ãã“ã¨ãŒã§ãã¾ã—ãŸ-ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå®Œäº†ã—ãŸå¾Œã€æ­£ã—ãè¨˜è¿°ã•ã‚ŒãŸãƒ©ãƒ ãƒ€é–¢æ•°ãŒãƒªã‚¹ãƒŠãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ãªã„ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚</font></font></li>
<li>   deadlock'          (       â€”   );</li>
<li>      std::shared_ptr  ,   create()        public- ;</li>
<li> copy-  move-,   Common::Manager,  ;</li>
<li>listener -     â€”       ,        ;</li>
<li>     ,     ,      ;</li>
<li>     detached-    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã®ç‚¹ã¯ã€æ¬¡ã®ç†ç”±ã§æ½œåœ¨çš„ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹é–¢æ•°ã‚’çµ‚äº†ã™ã‚‹æ¡ä»¶ã§ã‚¨ãƒ©ãƒ¼ã‚’ãƒã‚¹ã‚¯ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå®Œäº†ã™ã‚‹ã¾ã§ã€åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå­˜ç¶šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®å¾Œã€ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦èª¤ã£ã¦ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œã€åˆæœŸåŒ–è§£é™¤ã«å¤±æ•—ã—ã¾ã™ã€‚</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å¾Œã®ãƒ¡ã‚½ãƒƒãƒ‰ã€ã¾ãŸã¯semaphore_done_right_with_ThreadJoiner</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ãƒ¬ãƒƒãƒ‰ã®detachï¼ˆï¼‰ãŒå•é¡Œã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã¯ã€ãã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«å¯¾ã—ã¦ä½•ã‚‰ã‹ã®</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡¦ç½®ã‚’è¡Œã£ã¦ãã ã•ã„ï¼ˆå¤ã„ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå®Œäº†ã™ã‚‹ã®ã‚’éåŒæœŸçš„ã«å¾…æ©Ÿã™ã‚‹æ–°ã—ã„ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’é–‹å§‹ã—ã¾ã™</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢ï¼š</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è²»ã‚„ã•ã‚ŒãŸã‚¹ãƒ¬ãƒƒãƒ‰ã«è²¬ä»»ã‚’æŒã¤ã“ã¨ãŒã§ãã‚‹æ–°ã—ã„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆThreadJoinerï¼‰ãŒå¿…è¦ã§ã™ï¼ˆãŠãã‚‰ãã€ãã®ã‚ˆã†ãªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ã‚ˆã‚Šé©åˆ‡ãªåå‰ã¯ThreadSanitizerã§ã™ãŒã€ã™ã§ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã®ThreadJoinerã¯ã€std :: thread :: joinï¼ˆï¼‰ãŒè²¬ä»»ã‚’è² ã£ãŸã™ã¹ã¦ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«å¯¾ã—ã¦é †æ¬¡å‡¦ç†ã•ã‚Œã‚‹ã®ã‚’å¾…ã¡ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoinerãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€æ‹…å½“ã™ã‚‹ã™ã¹ã¦ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒå®Œäº†ã™ã‚‹ã¾ã§å®Ÿè¡Œã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŠ½è±¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoiner.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadJoiner</span>
{</span>
<span class="hljs-keyword">public</span>:<font></font>
    ThreadJoiner() = <span class="hljs-keyword">default</span>;<font></font>
    ThreadJoiner(<span class="hljs-keyword">const</span> ThreadJoiner&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoiner(ThreadJoiner&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoiner&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> ThreadJoiner&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoiner&amp; <span class="hljs-keyword">operator</span>=(ThreadJoiner&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
<font></font>
    <span class="hljs-keyword">virtual</span> ~ThreadJoiner() = <span class="hljs-keyword">default</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">join</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::thread&amp;&amp;)</span> </span>= <span class="hljs-number">0</span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç‰¹å®šã®éåŒæœŸå®Ÿè£…ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoinerAsync.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mutex&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;optional&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;condition_variable&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/ThreadJoiner.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadJoinerAsync</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> ThreadJoiner<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:<font></font>
    ThreadJoinerAsync();<font></font>
    ThreadJoinerAsync(<span class="hljs-keyword">const</span> ThreadJoinerAsync&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoinerAsync(ThreadJoinerAsync&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoinerAsync&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> ThreadJoinerAsync&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
    ThreadJoinerAsync&amp; <span class="hljs-keyword">operator</span>=(ThreadJoinerAsync&amp;&amp;) = <span class="hljs-keyword">delete</span>;<font></font>
<font></font>
    ~ThreadJoinerAsync() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">join</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::thread&amp;&amp;)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:
    <span class="hljs-keyword">using</span> Data = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">queue</span>&lt;<span class="hljs-built_in">std</span>::thread&gt;;
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::atomic&lt;<span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::mutex _mutex;<font></font>
    Data _data;<font></font>
    Semaphore _semaphore;<font></font>
    <span class="hljs-built_in">std</span>::condition_variable _cv;
    <span class="hljs-built_in">std</span>::thread _thread;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">threadFn</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoinerAsync.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"ThreadJoinerAsync.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {<font></font>
ThreadJoinerAsync::ThreadJoinerAsync()<font></font>
    : _semaphore(<span class="hljs-literal">true</span>)<font></font>
    , _thread(&amp;ThreadJoinerAsync::threadFn, <span class="hljs-keyword">this</span>)<font></font>
{<font></font>
}<font></font>
<font></font>
ThreadJoinerAsync::~ThreadJoinerAsync()<font></font>
{<font></font>
    _semaphore = <span class="hljs-literal">false</span>;<font></font>
    _cv.notify_one();<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _thread.join();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ThreadJoinerAsync::join</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::thread&amp;&amp; thread)</span>
</span>{<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> lock = <span class="hljs-built_in">std</span>::lock_guard(_mutex);<font></font>
        _data.push(<span class="hljs-built_in">std</span>::move(thread));<font></font>
    }<font></font>
<font></font>
    _cv.notify_one();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ThreadJoinerAsync::threadFn</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">auto</span> lock = <span class="hljs-built_in">std</span>::unique_lock(_mutex);<font></font>
        _cv.wait(lock, [<span class="hljs-keyword">this</span>](){ <span class="hljs-keyword">return</span> !_semaphore || !_data.empty(); });<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!_semaphore &amp;&amp; _data.empty()) {
            <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">auto</span> threadToJoin = <span class="hljs-built_in">std</span>::move(_data.front());<font></font>
        _data.pop();<font></font>
<font></font>
        lock.unlock();<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (threadToJoin.joinable()) {<font></font>
            threadToJoin.join();<font></font>
        }<font></font>
    }<font></font>
}<font></font>
} <span class="hljs-comment">// namespace Common</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SimpleZombyã§ThreadJoinerã‚’ä½¿ç”¨ã™ã‚‹ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.h</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;atomic&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Manager.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> Common {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadJoiner</span>;</span>
} <span class="hljs-comment">// namespace Common</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Zomby</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> Common::Manager<font></font>
{<font></font>
<span class="hljs-keyword">public</span>:<font></font>
    Zomby(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::ThreadJoiner&gt;);<font></font>
<font></font>
    ~Zomby() <span class="hljs-keyword">override</span>;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span> <span class="hljs-keyword">override</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">private</span>:<font></font>
<font></font>
    <span class="hljs-keyword">using</span> Semaphore = <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-built_in">std</span>::mutex, <span class="hljs-keyword">bool</span>&gt;;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; _listener;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Semaphore&gt; _semaphore;
    <span class="hljs-built_in">std</span>::thread _thread;
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::ThreadJoiner&gt; _joiner;<font></font>
};<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleZomby.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Listener.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/ThreadJoiner.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> SimpleZomby {<font></font>
Zomby::Zomby(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::ThreadJoiner&gt; joiner)<font></font>
    : _joiner(joiner)<font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (!_joiner) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"An empty joiner in SimpleZomby::Zomby::Zomby"</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
Zomby::~Zomby()<font></font>
{<font></font>
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">std</span>::this_thread::get_id() != _thread.get_id()) {
            <span class="hljs-keyword">auto</span> guard = <span class="hljs-built_in">std</span>::lock_guard(_semaphore-&gt;first);<font></font>
            _semaphore-&gt;second = <span class="hljs-literal">false</span>;<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            _semaphore-&gt;second = <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_thread.joinable()) {<font></font>
        _joiner-&gt;join(<span class="hljs-built_in">std</span>::move(_thread));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_listener) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-keyword">typeid</span>(*<span class="hljs-keyword">this</span>).name() &lt;&lt; <span class="hljs-string">"::"</span> &lt;&lt; __func__ &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
        _listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Zomby::runOnce</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Common::Listener&gt; listener)</span>
</span>{
    <span class="hljs-keyword">if</span> (_semaphore) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::runtime_error(<span class="hljs-string">"SimpleZomby::Zomby::runOnce() called twice"</span>);<font></font>
    }<font></font>
<font></font>
    _listener = listener;<font></font>
    <span class="hljs-comment">// two separate lines needed because of absence of std::mutex move c-tor</span>
    _semaphore = <span class="hljs-built_in">std</span>::make_shared&lt;Semaphore&gt;();<font></font>
    _semaphore-&gt;second = <span class="hljs-literal">true</span>;<font></font>
<font></font>
    _thread = <span class="hljs-built_in">std</span>::thread([listener, semaphore = _semaphore](){
        <span class="hljs-keyword">while</span> (listener &amp;&amp; semaphore) {<font></font>
            {<font></font>
                <span class="hljs-keyword">auto</span> guard = <span class="hljs-built_in">std</span>::lock_guard(semaphore-&gt;first);
                <span class="hljs-keyword">if</span> (!semaphore-&gt;second) {
                    <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
                listener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(<span class="hljs-string">"SimpleZomby is alive!\n"</span>));<font></font>
            }<font></font>
            <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::seconds(<span class="hljs-number">1</span>));<font></font>
        }<font></font>
    });<font></font>
}<font></font>
} <span class="hljs-comment">// namespace SimpleZomby</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cpp</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sstream&gt;</span></span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Impl/WriteToConsoleListener.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"Common/Impl/ThreadJoinerAsync.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"SimpleZomby/SimpleZomby.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> writeToConsoleListener = Common::WriteToConsoleListener::instance();
    <span class="hljs-keyword">auto</span> joiner = <span class="hljs-built_in">std</span>::make_shared&lt;Common::ThreadJoinerAsync&gt;();<font></font>
<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> simpleZomby = SimpleZomby::Zomby(joiner);<font></font>
        simpleZomby.runOnce(writeToConsoleListener);<font></font>
<font></font>
        <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">4500</span>));<font></font>
    } <span class="hljs-comment">// Zomby should be killed here</span><font></font>
<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">ostringstream</span> buf;<font></font>
        buf &lt;&lt; <span class="hljs-string">"============================================================\n"</span>
            &lt;&lt; <span class="hljs-string">"|                      Zomby was killed                    |\n"</span>
            &lt;&lt; <span class="hljs-string">"============================================================\n"</span>;
        <span class="hljs-keyword">if</span> (writeToConsoleListener) {<font></font>
            writeToConsoleListener-&gt;processData(<span class="hljs-built_in">std</span>::make_shared&lt;Common::Listener::Data&gt;(buf.str()));<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::this_thread::sleep_for(<span class="hljs-built_in">std</span>::chrono::milliseconds(<span class="hljs-number">5000</span>));<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</font></font></b><div class="spoiler_text"><blockquote>SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
SimpleZomby is alive!<br>
N11SimpleZomby5ZombyE::~Zomby<br>
============================================================<br>
| Zomby was killed |<br>
============================================================<br>
N6Common22WriteToConsoleListenerE::~WriteToConsoleListener<br>
</blockquote><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­¦å‘Šï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ThreadJoinerã‚³ãƒ¼ãƒ‰ã¯è¡¨é¢çš„ã«ãƒ†ã‚¹ãƒˆã•ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">å½¼ã‚’æœ¬ç•ªç’°å¢ƒã«ãƒ‰ãƒ©ãƒƒã‚°ã™ã‚‹ã“ã¨ã«ã—ãŸå ´åˆ-ãã‚Œã¯ç§ã®ã›ã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®æ–¹æ³•ã®åˆ©ç‚¹ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoinerãŒæ‹…å½“ã—ã¦ã„ãŸã™ã¹ã¦ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒæ­£ã—ãçµ‚äº†ã™ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰ã®çµ‚äº†çŠ¶æ…‹ã§ã®ã‚¨ãƒ©ãƒ¼æ¤œå‡ºãŒä¿è¨¼ã•ã‚Œã€ç„¡é™ã®å®Ÿè¡Œã«ã¤ãªãŒã‚Šã¾ã™-ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã¯å®Œäº†æ™‚ã«ãƒ•ãƒªãƒ¼ã‚ºã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThreadJoinerã¯ã€åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰ã®çµ‚äº†ã®çŠ¶æ…‹ã§ãã‚Œã»ã©é‡è¦ã§ãªã„ã‚¨ãƒ©ãƒ¼ï¼ˆã‚¹ãƒ¬ãƒƒãƒ‰ã®æœ‰é™ã®éåº¦ã®å®Ÿè¡Œæ™‚é–“ã«ã¤ãªãŒã‚‹ã‚¨ãƒ©ãƒ¼ï¼‰ã®è­˜åˆ¥ã‚’ç°¡ç´ åŒ–ã™ã‚‹è¨ºæ–­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§è£œè¶³ã§ãã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤‰æ›´SteppingZombyã¨BoozdedZombyã¯å®Œå…¨ã«é¡ä¼¼ã—ã¦ã„ã¾ã™ï¼ˆfixes / semaphore_done_right_with_ThreadJoinerãƒ–ãƒ©ãƒ³ãƒã‚’å‚ç…§ï¼‰ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¬å¼ãƒ–ãƒ¼ã‚¹ãƒˆã®ä¾‹ã«ã¤ã„ã¦ä¸€è¨€</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã®æœ€åˆã®éƒ¨åˆ†ã§ã¯ã€å…¬å¼ã®boostãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®2ã¤ã®ä¾‹ã‚’ç¤ºã—ã¦ã„</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://www.boost.org/doc/libs/master/libs/beast/example/http/client/async/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹Websocketã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä¾‹</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mainï¼ˆï¼‰ã§ioc.runï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ã¨ã€ã„ãšã‚Œã‹ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ã¾ã§åˆ¶å¾¡ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚§ãƒ¼ãƒ³å…¨ä½“ã®é–‹ç™ºã®æˆåŠŸã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¨ãƒ©ãƒ¼ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æç¤ºã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä¸Šæµã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã‚‹æ—©æœŸã®ç ´æ£„</font><b><font style="vertical-align: inherit;">ã¯</font></b><font style="vertical-align: inherit;">ä¸å¯èƒ½ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã ã‘ã§ã‚‚ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒ©ã‚¹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«é›†ç´„ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ååˆ†ãªå¯¿å‘½ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã©ã†ã‚„ã‚‰ã€ã“ã®æ–¹æ³•ã§å¤‰æ›´ã•ã‚ŒãŸå ´åˆã§ã‚‚ã€æç¤ºã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã¯æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã®shared_from_thisã®ä½¿ç”¨ã¯å†—é•·ã§ã‚ã‚Šã€ç”Ÿã®thisãƒã‚¤ãƒ³ã‚¿ã‚’å–å¾—ã™ã‚‹ã ã‘ã§ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã®ã¨ãã‹ã‚‰shared_from_thisã¯ã©ã“ã‹ã‚‰æ¥ãŸã®ã§ã™ã‹ï¼Ÿ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŠãã‚‰ãã€æ¥ç¶šã‚’ç ´æ£„ã—ã¦æ¥ç¶šã‚’åœæ­¢ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æä¾›ã™ã‚‹ã€ã‚ˆã‚Šç¾å®Ÿçš„ãªã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã®ã‚‚ã®ã§ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã‚‚ã¡ã‚ã‚“ã€è‡ªåˆ†è‡ªèº«ã®å¯¿å‘½ã‚’åˆ¶å¾¡ã§ããªã„ã“ã¨ã«ã‚ˆã‚Šã€æœªå®šç¾©ã®å‹•ä½œãŒç™ºç”Ÿã—ã¾ã—ãŸï¼ˆã€Œã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã€ã¨èª­ã¿ã¾ã™ï¼‰ã€‚</font><font style="vertical-align: inherit;">ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã¯ã‚¾ãƒ³ãƒ“ã¨äº¤æ›ã•ã‚Œã€ã‚¾ãƒ³ãƒ“ã¯ã‚³ãƒ”ãƒ¼è²¼ã‚Šä»˜ã‘æ¥­è€…ã«æç¤ºã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµè«–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç‰¹å®šã®ã‚‚ã®ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã¯ã€éåŒæœŸãƒ—ãƒ­ã‚»ã‚¹ã®çµæœãŒé€ä¿¡ã•ã‚Œã‚‹æ–¹æ³•ã‚’å«ã‚€ã€å…ƒã®ã‚³ãƒ¼ãƒ‰ã®æ©Ÿèƒ½ã‚’è€ƒæ…®ã«å…¥ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€ä¾‹ã‚’åˆ†æã—ãŸçµæœã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã©ã®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå•é¡Œã®åŸå› </font><font style="vertical-align: inherit;">ã¨ãªã£ã¦ã„ã‚‹ã‹</font><b><font style="vertical-align: inherit;">ãŒ</font></b><font style="vertical-align: inherit;">åˆ¤æ˜ã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜ä¸€è²¬ä»»ã®åŸå‰‡ã®é•å-ã‚¯ãƒ©ã‚¹ã«ã¯ã€éåŒæœŸã§å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã«åœæ­¢ã®å¿…è¦æ€§ã‚’é€šçŸ¥ã™ã‚‹æ©Ÿèƒ½ã¨ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ©Ÿèƒ½ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã‹ã‚‰ã€åŸºã«ãªã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‹ã‚‰ä¸Šã«ã‚ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¸ã®è¦ä»¶ãŒç™ºç”Ÿã—ã¾ã—ãŸ-éåŒæœŸãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æœ‰åŠ¹æ€§ã‚’ä¸€å®šæœŸé–“ä¿è¨¼ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€std :: enable_shared_from_thisæ‰‹æ³•ã‚’ä½¿ç”¨ã—ã¦ã€è‡ªèº«ã®å¯¿å‘½ã‚’åˆ¶å¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ã‚‚æ­£ã—ã„ã‚³ãƒ¼ãƒ‰ã¯</font><font style="vertical-align: inherit;">std :: enable_shared_from_this </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨</font><b><font style="vertical-align: inherit;">ã›ãš</font></b><font style="vertical-align: inherit;">ã«å–å¾—ã•ã‚Œã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŒã‚ãªãŸã«æœ›ã‚€ã“ã¨ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja478178/index.html">Windows Terminal Preview 0.7ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸ</a></li>
<li><a href="../ja478182/index.html">Intel Myriad Xãƒãƒƒãƒ—ã¨ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¨è«–ã«ãŠã‘ã‚‹ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£</a></li>
<li><a href="../ja478184/index.html">ãƒã‚¦ã‚¹ã®ä»£ã‚ã‚Šã®KDEæ¥ç¶šã€ã¾ãŸã¯æœ€åˆã®æ¥ç¶šã®è½ã¨ã—ç©´</a></li>
<li><a href="../ja478186/index.html">æ—¢è£½ã®ãƒ“ã‚¸ãƒã‚¹ã‚’åˆæ³•çš„ã«å¤±ã†æ–¹æ³•ã®ç‰©èª</a></li>
<li><a href="../ja478188/index.html">PowerShellã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæƒ…å ±ã‚’åé›†ã™ã‚‹</a></li>
<li><a href="../ja478192/index.html">å¤•æ—¥ã®ç¾ã—ã•ã®äºˆæ¸¬</a></li>
<li><a href="../ja478196/index.html">OpenStreetMap No. 487ã®ä¸–ç•Œã‹ã‚‰ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼ˆ11/12/2019-11/18/2019ï¼‰</a></li>
<li><a href="../ja478198/index.html">Raspberry Pi Apocalypse Survival Computer</a></li>
<li><a href="../ja478200/index.html">ä¸€èˆ¬çš„ãªã‚¹ã‚¯ãƒ©ãƒ è£½å“ã®æ‰€æœ‰è€…ã®é–“é•ã„</a></li>
<li><a href="../ja478202/index.html">è‹±å›½ã®ãƒ‡ã‚¸ã‚¿ãƒ«ã‚¿ãƒ¬ãƒ³ãƒˆãƒ“ã‚¶ï¼šå€‹äººçš„ãªçµŒé¨“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>