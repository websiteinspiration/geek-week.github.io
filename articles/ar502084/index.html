<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕧 🧞 🛠️ التحقق من بوابة الخدمات العامة الإقليمية تحت التحميل من خلال دمية 👨🏿‍🔧 🙌🏿 📶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحبا يا هابر! أنت أيضا تشاهد بفضول "ملحمة الغرب المتوحش الأمريكية بشأن توزيع قطع الأراضي - اذهب أولاً وألصق علمًا على الحصة" أو ربما تشارك في ذلك. بت...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>التحقق من بوابة الخدمات العامة الإقليمية تحت التحميل من خلال دمية</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502084/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مرحبا يا هابر! أنت أيضا تشاهد بفضول "ملحمة الغرب المتوحش الأمريكية بشأن توزيع قطع الأراضي - اذهب أولاً وألصق علمًا على الحصة" أو ربما تشارك في ذلك. بتعبير أدق في نسخته الحديثة - كن أول من يتقدم بطلب للحصول على الخدمات العامة من أجل الحصول على المال للأطفال أو الحصول على تصريح لمغادرة المنزل. بالنظر إلى كل هذا ، أود أن أشارك تجربة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فريقنا</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في الاختبار والمشاركة في إعداد بوابة خدمات إقليمية لتوفير خدمة "سجل الدرجة الأولى". إنه أيضًا مشابه جدًا لتأثير هابرا ، وأعتقد أنه كان قريبًا مما حدث قبل يومين مع البوابة الفيدرالية gosuslugi.ru ، ولكن على نطاق إقليمي.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد تجاوزنا هذا التحدي في خاباروفسك في يناير من هذا العام وشاركنا مؤخرًا في إعداد خدمة مماثلة لإصدار تصاريح الصيد في منطقة أخرى. فيما يلي تجربة صغيرة ستمنحك الفرصة لإلقاء نظرة على مسألة إعداد عمل بوابات الخدمات العامة الإقليمية لفترات الذروة من منظور آخر. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وللمبتدئين - صورة حافلة سوداء ، كان في الخدمة في المدرسة لمدة ثلاثة أيام على مدار الساعة ، حيث أكد مؤلف هذه الخطوط دوره بين والديه قبل ثلاث سنوات. على الأقل اجتمع آباؤنا معًا. مشاهدة في فصل الشتاء في خاباروفسك عند -30 درجة لا يزال من دواعي سروري.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o8/vh/rb/o8vhrboqvtrufnftfwxsxb1rgm4.png" alt="صورة"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في عملية التحضير لتسجيل الذروة في الصف الأول ، عملت عدة فرق ، لأنه </font><font style="vertical-align: inherit;">بطريقة أو بأخرى تشارك فيه: مشغل مركز البيانات ، المشغل ومطور نظام المعلومات للبوابة الإقليمية ، المشغل والمطور لنظام المعلومات التعليمية المتكامل ، الدعم الفني لمستخدمي البوابة الإقليمية. </font><font style="vertical-align: inherit;">نحن في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iondv</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> نقوم بالمهمة الأخيرة ، </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ونراقب</font></a><font style="vertical-align: inherit;"> بشكل مستقل صحة البوابة ودعم المستخدمين. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يتمثل دورنا في التحضير في تنظيم الاختبارات والتوصيات بشأن تكوينات التخزين المؤقت في nginx ، حسنًا ، قمنا أيضًا بإعداد تعليمات للمستخدمين الذين لديهم "السلوك" الموصى به.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالنسبة لأولئك الذين لا يعرفون مشكلة الكتابة في الصف الأول</font></font></b>
                        <div class="spoiler_text">         ,    .  .          ,     ,   -     (      ,   —      ),    ,  -     ,   ,            .  ,       ,      ,     –    ,        .           .<br>
<br>
     1-          ,    .           0:00 ,        10:00 26 . ,    –       .        10:00 ,       —    ,      - .<br>
<br>
            .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>    .   2017 .     .         ,    ,    .          .<br>
</div>
                    </div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">خدمة لمورد مطلوب كمهمة فنية</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إن المشكلة في خدمات مثل "الكتابة إلى الصف الأول" في المؤشر المتكامل للحمل (أو احتمال الاستعلامات) التي تميل إلى "وظيفة دلتا" (دالة، ، وظيفة Dirac) تظهر بوضوح على الرسوم البيانية في شكل قمم. في هذه اللحظة ، هناك زيادة متعددة في المكالمات في فترة زمنية قصيرة. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0l/uc/c6/0lucc67w9pr4uh2ig1swg5tgtq0.png" alt="إحصائيات دالة and وذروة الاستعلام"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تقول تجربتنا أن المهمة الرئيسية للتدريب ليست زيادة الموارد. تتمثل المهمة في تقليل العدد المحتمل للطلبات في الثانية ، وتمديدها لبعض الوقت ، وإعداد النظام للحمل المتبقي. في هذه الحالة ، من الضروري العثور على الاختناقات وتسريعها - وهذا سيعطي أكبر تأثير وفقًا لمبادئ نظرية الأنظمة المقيدة (مبادئ Goldratt). وإلا فإن عنق الزجاجة هو الذي سيفشل. يجب أن يعمل النظام بأكمله منه: مبدأ "حبل الطبل العازلة".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من المستحيل جسديًا سكب الحجم بالكامل في 10 دقائق من الساعة الرملية في دقيقة واحدة - من الواضح أنها ستنهار. </font><font style="vertical-align: inherit;">وبالمثل لتقديم الخدمات. </font><font style="vertical-align: inherit;">لا يفاجئ أحدًا - عندما يحين دور MFC والفضائح لتلقي الخدمات ، لكنه يفاجئ الجميع - لماذا سقطت البوابة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك أنماط مختلفة من سلوك التعامل مع الحمل من </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نظرية الانتظار</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يمكنك تعليق المستخدمين ، أي </font><font style="vertical-align: inherit;">زيادة قائمة الانتظار ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكنك ببساطة رفض خدمة أولئك الذين جاءوا لاحقًا ، على سبيل المثال ، حتى تتم معالجة الطلبات السابقة ؛</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكنك محاولة زيادة الإنتاجية إلى ما لا نهاية.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
النفعية في مكان ما بينهما. في الواقع ، بالنسبة لخدمة ذات موارد محدودة تقدمها منطقة أو دولة ، ليست السرعة فقط مهمة ، ولكن أولاً وقبل كل شيء ، الحفاظ على العدالة الاجتماعية - أي. شروط متساوية للجميع. في نفس الوقت - إذا لم يتلق المستخدم ما يحتاجه ، فإنه يبدأ في طلب جديد. في هذه الحالة ، تنمو الطلبات في حالة انهيار جليدي ، وتشكل </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نموذجًا للهجوم "</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تأثير كومة الكلب </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">"</font></a><font style="vertical-align: inherit;"> (تأثير كومة الكلاب ، تدافع ذاكرة التخزين المؤقت ، إصابة عاصفة ملكة جمال) - قام المستخدم بالفعل بإلغاء الطلب وبدء طلب جديد ، بينما لا يزال الطلب السابق في قائمة الانتظار ليتم معالجته.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تعزز هذه العملية حقيقة أن العائلات بأكملها تشارك في التقديم - يقوم الأب والأم بملء الطلبات في نفس الوقت ، وغالبًا ما يقدمون الطلبات عدة مرات من أجل الموثوقية. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، غالبًا ما يكون في العديد من علامات التبويب والعديد من المتصفحات. </font><font style="vertical-align: inherit;">لذلك ، عادة ما يكون من المنطقي أن يكون الحمل الأقصى المتوقع مضاعفًا مرتين أو ثلاث مرات ، من عدد أولئك الذين يتقدمون بالفعل للحصول على هذه الخدمات.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تراجع العدالة</font></font></b>
                        <div class="spoiler_text">,   «»,            .   ?  «»    ,    .   .     —        ,     .        « ».        .          .<br>
</div>
                    </div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تنظيم تقديم الخدمات</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسبنا العدد المتوقع للمتقدمين بناءً على مجموعة من البيانات حول إجمالي عدد الطلبات المقدمة العام الماضي وبيانات الدقيقة للمناطق الأخرى. </font><font style="vertical-align: inherit;">عادة ، تصل التطبيقات إلى الذروة في 5-10 دقائق ، بما في ذلك لأن البوابات لا تستجيب تقريبًا لأول ثلاث إلى خمس دقائق ، وبعد ذلك يملأ المستخدمون النموذج من 1 إلى 5 دقائق (لا تتفاجأ كثيرًا حتى بملئه من الهاتف في مثل هذه الظروف "العصبية") . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نموذج حساب تقريبي للتطبيقات الشرطية 1000 ساعة في الساعة على النحو التالي:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الذروة من 5 إلى 10 دقائق من البداية وسيتم إيداع 80 ٪ من الطلبات بموجب قاعدة باريتو</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تقليديا ، نحن نخطط 160 تطبيق في الدقيقة أو 3 تطبيقات في الثانية.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الواقع ، حدث التقديم الأول بعد دقيقة واحدة و 45 ثانية ، وبلغت ذروة الطلبات من 4 دقائق. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لتقليل الحمل على ESIA وعلى النظام من إنشاء جلسات التفويض ، اقترحت التعليمات أن يقوم المستخدمون بتسجيل الدخول مقدمًا وإطالة مدة الجلسة. </font><font style="vertical-align: inherit;">في الواقع ، تمت الموافقة على 50 ٪ في ساعة واحدة ، و 90 ٪ تقريبًا في نصف ساعة. </font><font style="vertical-align: inherit;">لقد صادفنا سابقًا أن المستخدمين بدأوا تسجيل الدخول إلى البوابة الإلكترونية قبل 10 دقائق من بدء الخدمة - وبدأ التفويض في العمل بشكل غير مستقر. </font><font style="vertical-align: inherit;">من الصعب تحديد السبب. </font><font style="vertical-align: inherit;">ربما يكون السبب هو أنه عندما يتم تنفيذ العمل الفني في موسكو ليلاً ، في خاباروفسك لدينا فقط بداية يوم العمل.</font></font><br>
 <br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">معتكف حول التعليمات والترتيبات التنظيمية</font></font></b>
                        <div class="spoiler_text">            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>.<br>
<br>
         ,    « »     . ..      .       ,   -   .. <br>
<br>
    ,        ,         ,    .        -        .      ,       ,      .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من المستحيل إزالة "وظيفة دلتا" عند إعادة تحميل النموذج في 00:00. الهدف الأساسي من هذا الإجراء هو ظهور الخدمة في وقت معين. ولكن يمكنك محاولة تقليل عدد طلبات المتصفح في جميع مسارات المستخدم المتوقعة ، وبالتالي ترك الحمل على النظام فقط من الطرق الضرورية - النموذج والأدلة الديناميكية وإرسال التطبيقات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إعدادات nginx نفسها قياسية إلى حد ما. هنا من المهم اختيار القيود التي يمكن أن يتحملها النظام. التقاطها - أي بدء وضع الطلبات في قائمة الانتظار عندما يتوقع أن يصل الخادم إلى حدود إمكاناته.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، والأهم من ذلك ، فرضنا التخزين المؤقت (proxy_cache) وزدنا عمر بيانات "انتهاء الصلاحية" في nginx لجميع المسارات الثابتة ، وحيثما أمكن ، الصفحات الديناميكية التي لا توجد فيها جلسات. بالمناسبة ، هذا خطأ شائع عند التخزين المؤقت - الكتابة إلى بيانات ذاكرة التخزين المؤقت (أحيانًا حتى الإحصائيات) التي يتم فيها حفظ جلسة شخص آخر ، وعادة ما يكون الإخراج هو حذف ملفات تعريف الارتباط هذه من الرؤوس إذا لم يتمكن الخادم من فصل أنواع البيانات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في متصفح المستخدم ، يبدو أن تحديث الصفحات من الملفات التي تم تنزيلها من القرص أو الذاكرة. ولكن حتى عندما يحصل عليها المستخدم من الخادم ، يتم أخذها من ذاكرة التخزين المؤقت nginx. الدلائل نفسها ، بالطبع ، مخبأة في النظام نفسه.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qi/oq/nv/qioqnv0ofdjd5e0ygculnetdta4.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أدى هذا إلى تقليل عدد الطلبات المحتملة من 89 طلبًا إلى 14 والحجم من 2.1 ميغابايت (بالنسبة إلى 1000 مستخدم قاموا بتحديث الصفحة ، هذه ذروة محتملة تبلغ 4-8 جيجابت / ثانية) إلى 38 كيلوبايت (نتذكر جميعًا حزمة الويب ، ولكن بالنسبة لمنصات الإدخال ، هذا ليس من السهل دائما القيام بذلك). وفقًا لنتائج المقطع ، كان لا يزال من الضروري تخزين ذاكرة التخزين المؤقت ليس فقط في النظام ، ولكن أيضًا في nginx بعض الدلائل من النموذج والمصنفات الديناميكية غير المستخدمة في وقت الذروة وفرض العمر الافتراضي لها. ومع زيادة التحميل ، من المنطقي عمومًا وضع الصفحة الثابتة الرئيسية بالكامل مع توجيه المستخدمين إلى الخدمة المطلوبة أو إنشاء مورد منفصل للخدمة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لتقليل الحمل على الإرسال ، تم تعطيل المسودات والتعبئة التلقائية للبيانات الخاصة بالطفل. لدى جميع المستخدمين سرعات إدخال بيانات مختلفة ، مما يلغي مظهر النموذج الجاهز تمامًا للإرسال ويتجنب وظيفة دلتا لإرسال التطبيقات - كل 1000 في دقيقة واحدة. في الوقت نفسه ، يتم الحفاظ على العدالة الاجتماعية ، على الرغم من ظهور الشكاوى بالطبع. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لن أصف التحسين الأمثل للنظام نفسه - أثناء اختبار الحمل ، تم تحديد الاختناقات - بشكل أساسي في استعلامات DBMS وتم تحسين الفهارس والاستعلامات نفسها. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ربما يكون التحسين الأكثر أهمية هو تبسيط النموذج. ما الذي يؤثر على السرعة أكثر عند تطبيقه في شكل؟</font></font><br>
<br>
<ul>
<li>   —   ,        ,      .    —       5-10 (   iPhone         )   5-       375 /  (1       10 ,     <code>application/x-www-form-urlencoded </code>–  20 ),  100      625 /.           100/      —        .   ,      «  ».    —     ?     ,     .    ,      ?</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أدلة متطورة. </font><font style="vertical-align: inherit;">عادة ما يتم زيادة الحمل باستخدام دليل عنوان FIAS أو CLADR. </font><font style="vertical-align: inherit;">المشاكل هنا بسبب الحجم - FIAS يأخذ ما يصل إلى 40 جيجابايت في قاعدة البيانات ويستغرق بعض الوقت للبحث عنها. </font><font style="vertical-align: inherit;">أعشار الثانية ، ولكن مضروبًا في 1000 طلب متزامن ، قم بتحميل أي نظام. </font><font style="vertical-align: inherit;">بدون تحضير خاص ، ربما في شكل خدمة ويب منفصلة وعلى مورد منفصل ، من الصعب تحمل الحمل - وبالتالي ، غالبًا ما يستخدمون حقل نص عادي للعنوان.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، دعنا ننتقل إلى الاختبارات.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اختبار الحمل قيد التحضير</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تم إجراء الاختبار من خلال الدمى عن طريق محاكاة إجراءات المستخدم في متصفح Crominium. </font><font style="vertical-align: inherit;">Yanedeks.tank و JMeter تخلصوا من الحماية ضد الهجمات ، لأنهم يولدون العديد من نفس النوع من الطلبات. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، تتوافق هذه الاختبارات بشكل ضعيف مع ملف تعريف الاستعلامات الحقيقية عند تغيير سلوك النظام تحت التحميل. </font><font style="vertical-align: inherit;">بالإضافة إلى ذلك ، تطلب ذاكرة التخزين المؤقت للخوادم ، ومن الصعب إعادة إنتاج جزء من العمليات فيها (على سبيل المثال ، التفويض). </font><font style="vertical-align: inherit;">بالمناسبة ، من إحدى ندوات </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devDV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لدينا عرض تقديمي مع عرض تقديمي حول استخدام العرائس للاختبار ، بما في ذلك </font><font style="vertical-align: inherit;">تحميل </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">رابط الفيديو</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بادئ ذي بدء ، قمنا بتجميع ملف تعريف سلوك المستخدم وقسمنا الإجراء إلى مراحل رئيسية:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إذن جماعي في ESIA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تحديث نموذج الخدمة لمرة واحدة ،</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> تغذية جماعية </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لكل مرحلة من المراحل قمنا باختبار منفصل. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في العام الماضي ، كانت هناك صعوبات في مرحلة التفويض في ESIA ، ولكن اختبارها على نطاق كامل أمر صعب. النظام خارجي ، يتم تشغيل الحماية ضد الهجمات والحظر على الترخيص. ومع ذلك ، من الممكن صياغة ملف تعريف للاختبار لاختبار اختناقات النظام قيد الاختبار بدقة - عادةً ما يكون هذا هو عدد الجلسات المصرح بها في وقت واحد وقيم التفويض المخطط لها في الدقيقة ، والتي يمكن تنظيمها بالتوصيات.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الاختبار ، يعد الغلاف مهمًا لتنظيم العديد من الخيوط ، نستخدم "مجموعة العرائس". ولكن عادةً ما يكون الأمر أكثر تعقيدًا للتعامل مع الاستثناءات وتغيير سلوك البوابة تحت الحمل - غالبًا ما يتم الكشف عن عناصر التخطيط التي تظهر مرتين. أو لا تظهر العناصر إذا لم يتم تحميل بعض البيانات كما هو متوقع. هذه كلها أخطاء سيرى المستخدمون ويعيدون تحميل الصفحة - مما يعني أنهم سينشئون حملًا إضافيًا. هناك طريقتان: تنفيذ معالجة الاستثناء في الاختبار. أو تعديل البوابة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الاختبار نفسه بسيط. يوجد أدناه جزء من النقر على زر "تسجيل الدخول" في بوابة الخدمات لإدخال البيانات في ESIA.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">await</span> page.waitForSelector(AUTH_AVAIL,{<span class="hljs-attr">timeout</span>:OPT_ELEM_WAIT_TIME});
<span class="hljs-keyword">const</span> needAuth = <span class="hljs-keyword">await</span> page.$(ELEM_AUTH_IN);
<span class="hljs-keyword">if</span> (!needAuth) <span class="hljs-keyword">throw</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`  `</span>));<font></font>
        <font></font>
<span class="hljs-keyword">await</span> page.waitForSelector(AUTH_BUT, OPT_ELEMENT_VISIBLE);
<span class="hljs-keyword">await</span> page.click(AUTH_BUT);
<span class="hljs-keyword">await</span> waitNewUrl(page, <span class="hljs-string">'https://esia.gosuslugi.ru/idp/rlogin?cc=bp'</span>, OPT_PAGE_WAIT_TIME);
<span class="hljs-keyword">await</span> page.waitForSelector(<span class="hljs-string">'#mobileOrEmail'</span>, OPT_ELEMENT_VISIBLE);
<span class="hljs-keyword">let</span> text = <span class="hljs-keyword">await</span> elemGetText(page, <span class="hljs-string">'#authnFrm &gt; div.login-slils-box &gt; div &gt; div.detected &gt; div.left &gt; div.this-user'</span>);
<span class="hljs-keyword">if</span> (text) <font></font>
   text = text.replace(<span class="hljs-regexp">/ -\(\)/g</span>, <span class="hljs-string">''</span>);        
<span class="hljs-keyword">if</span> (text &amp;&amp; text.indexOf(user) === <span class="hljs-number">-1</span>) {
  <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'div.click-to-another &gt; a'</span>);
  <span class="hljs-keyword">await</span> page.waitForSelector(<span class="hljs-string">'#authnFrm &gt; div.login-slils-box &gt; div &gt;'</span> +
                <span class="hljs-string">' div.detected &gt; div.left &gt; div.this-user'</span>, OPT_ELEMENT_INVISIBLE);<font></font>
}<font></font>
<span class="hljs-keyword">await</span> page.waitForSelector(<span class="hljs-string">'#password'</span>, OPT_ELEMENT_VISIBLE);
<span class="hljs-keyword">await</span> page.type(<span class="hljs-string">'#mobileOrEmail'</span>, user);
<span class="hljs-keyword">await</span> page.type(<span class="hljs-string">'#password'</span>, pwd);
<span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'#loginByPwdButton'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
التحقق من تحديث نموذج الطلب المعلق للمستخدمين "فتح السجل". اختبار إعادة التشغيل هو في الأساس خطوة واحدة ، ولكن من المهم التحقق من أنواع الأخطاء التي تم إرجاعها - الشبكة مشكلة ، خطأ nginx ، خطأ في الخادم ، وما إذا كان النموذج يفي بالمعايير. والصعوبة هي توليد أقصى حجم للطلبات في أقل وقت ولا تقع ضمن قيود الحماية (ومع ذلك ، أثناء الاختبارات يمكن تغييرها ، من ناحية أخرى ، فهي أيضًا فحص لإعدادات البنية التحتية للشبكة والخادم و WAF). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تتطلب هذه الاختبارات على الدمى الكثير من الموارد للعمل. في الواقع اتضح أنك تحتاج على الأقل إلى مركزين في المركز الأول للنظام الفرعي الأمامي وقناة واسعة جدًا. ولكن عند استئجارها في السحابة - هذا أمر معقول للغاية. استخدمنا Yandex.cloud.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الاختبار ، يتم تنفيذ التفويض أولاً في ESIA لكل دفق على حدة. </font><font style="vertical-align: inherit;">بعد ذلك ، يتم تشغيل متصفح منفصل لكل سلسلة رسائل ، وفي إطار مثيل واحد يتم تنفيذ عدد معين من التحديثات. </font><font style="vertical-align: inherit;">بعد ذلك ، يتم إعادة تشغيل المثيل. </font><font style="vertical-align: inherit;">قد يتضمن الشيك نفسه مسارًا نموذجيًا ، على سبيل المثال ، الصفحة الرئيسية ، وشكل الخدمة. </font><font style="vertical-align: inherit;">ولكن في كثير من الأحيان يكفي فقط تحديث الخدمة بالكامل والتحقق من الدليل الضروري الذي يمكن تقديم الخدمة فيه - كل ذلك كما هو الحال في التعليمات للمستخدمين. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oe/8w/vk/oe8wvknrrkkw1hn3vb4ke0oh8sw.png" alt="صورة"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
جزء من الاختبار لفتح الصفحة الرئيسية وتحديث الصفحة.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">await</span> page.setViewport(PUP_OPT);
  <span class="hljs-keyword">await</span> page.goto(BASE_URL);
  <span class="hljs-keyword">await</span> page.setCookie(...cookies[worker.id]);
  <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">`<span class="hljs-subst">${BASE_URL}</span>/nd/lk/form/dnv.htm`</span>);<font></font>
  rdyRefresh++;<font></font>
} <span class="hljs-keyword">catch</span> (err) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`#       <span class="hljs-subst">${data}</span>: <span class="hljs-subst">${err.message}</span>`</span>);<font></font>
  getErr++;<font></font>
  <span class="hljs-keyword">await</span> page.screenshot({<span class="hljs-attr">path</span>: filename});<font></font>
}<font></font>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; AMOUNT_REFRESH - <span class="hljs-number">1</span>; i++) {
  <span class="hljs-keyword">const</span> filenameIter = path.join(BASE_DIR, PIC_DIR, <span class="hljs-string">`<span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>.png`</span>);
   <span class="hljs-keyword">try</span> {
       <span class="hljs-keyword">await</span> page.reload({<span class="hljs-attr">waitUntil</span>: [<span class="hljs-string">"networkidle0"</span>, <span class="hljs-string">"domcontentloaded"</span>]});<font></font>
        rdyRefresh++;<font></font>
    } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">if</span> (!err.message.includes(<span class="hljs-string">'Navigation failed because browser'</span>)) {
           <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`#     <span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${err.message}</span>`</span>);<font></font>
           getErr++;<font></font>
           <span class="hljs-keyword">await</span> page.screenshot({<span class="hljs-attr">path</span>: filenameIter});<font></font>
        }<font></font>
   }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالنسبة للحمل عن طريق إرسال التطبيقات ، تم تنفيذ دورة التحقق بأكملها - مع إعادة تحميل النموذج والتحقق من إدخال جميع البيانات. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
شظية.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; AMOUNT_RESEND; i++) {
   <span class="hljs-keyword">const</span> filename = path.join(BASE_DIR, PIC_DIR, <span class="hljs-string">`<span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>.png`</span>);
  <span class="hljs-keyword">try</span> {
     <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">'https://uslugi27.ru/nd/lk/form/dnv.htm'</span>);<font></font>
  } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`#      1  <span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${err.message}</span>`</span>);
      <span class="hljs-keyword">await</span> page.screenshot({<span class="hljs-attr">path</span>: filename});<font></font>
      getErr++;<font></font>
      <span class="hljs-keyword">continue</span>;<font></font>
 }<font></font>
 <span class="hljs-keyword">try</span> {
     <span class="hljs-keyword">const</span> FORM_PREF = <span class="hljs-string">'#createForm &gt; div:nth-child(4) &gt; '</span>;
     <span class="hljs-keyword">await</span> clickDelayed(page,<span class="hljs-string">`<span class="hljs-subst">${FORM_PREF}</span>fieldset.petgroup.ungroupped-attrs &gt; div &gt; div:nth-child(4) &gt; div.col-md-9.attr-data`</span>);
<span class="hljs-comment">// &lt;…&gt;</span>
     <span class="hljs-keyword">await</span> page.type(<span class="hljs-string">`<span class="hljs-subst">${FORM_PREF}</span>fieldset:nth-child(2) &gt; div &gt; div:nth-child(1) &gt; div.col-md-9.attr-data &gt; input`</span>, <span class="hljs-string">''</span>);
<span class="hljs-comment">// &lt;…&gt;</span>
  } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`#      <span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${err.message}</span>`</span>);
      <span class="hljs-keyword">await</span> page.screenshot({<span class="hljs-attr">path</span>: filename});
     <span class="hljs-keyword">continue</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'#createForm &gt; div.col_100.controls &gt; button.btn.btn-primary.pull-right.next'</span>);
      <span class="hljs-keyword">await</span> clickDelayed(page,<span class="hljs-string">`#createForm &gt; div:nth-child(5) &gt; fieldset &gt; div &gt; div:nth-child(1) &gt; div &gt; div`</span>);
       <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'#createForm &gt; div:nth-child(5) &gt; fieldset &gt; div &gt; div:nth-child(2) &gt; div &gt; div'</span>);
       <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'#createForm &gt; div.col_100.controls &gt; button.btn.btn-success.pull-right.submit'</span>);<font></font>
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`#     <span class="hljs-subst">${data}</span>-<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${err.message}</span>`</span>);
    <span class="hljs-keyword">await</span> page.screenshot({<span class="hljs-attr">path</span>: filename});<font></font>
    sendErr++;<font></font>
    <span class="hljs-keyword">continue</span>;<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بالمناسبة ، يمكن تسريع الاختبار إذا قمت بإدخال جميع البيانات ليس من الدمى عن طريق بناء الصفحة. نوع الانتظار ، ولكن نقل هذا المنطق إلى المتصفح نفسه. ولكن بعد ذلك يزداد تعقيد التقاط الأخطاء. مثل ذلك</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#createForm &gt; div:nth-child(4) &gt; fieldset.petgroup.ungroupped-attrs &gt; div &gt; div:nth-child(4) &gt; div.col-md-9.attr-data'</span>).click();
 <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#createForm &gt; div:nth-child(4) &gt; fieldset:nth-child(2) &gt; div &gt; div:nth-child(1) &gt; div.col-md-9.attr-data &gt; input'</span>).value = <span class="hljs-string">''</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
خلال الاختبارات ، قدمنا ​​عدة آلاف من تفويضات ESIA وحوالي 16 ألف طلب تم إرسالها. كيف تم استعادة نظام معلومات تثقيفي منتج بعد مثل هذا العدد من التصريحات - حتى لا تسأل. هذه قصة مختلفة تمامًا. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
كانت النتيجة المرئية الرئيسية لهذه العملية هي أن وسائل الإعلام المحلية تشعر بالملل الآن في أيام التسجيل في الصف الأول. تركت الخدمة منطقة الإعلام. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في موازاة ذلك ، قمنا بعمل لوحة تحكم لمراقبة أداء النموذج استنادًا إلى Grafana: عدد التطبيقات ، وعدد المكالمات ، ومقاييس Yandex ، وما إلى ذلك. لكننا سنترك هذا الموضوع للمرة القادمة.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
حسنًا ، أود أن أهنئ كل من يرتبط بموضوع تحسين جودة تقديم خدمات الدولة والبلدية في شكل إلكتروني. </font><font style="vertical-align: inherit;">هذا العمل التحضيري اللانهائي لم يذهب سدى - بعد كل شيء ، في أبريل ومايو زاد عدد الطلبات المقدمة بشكل ملحوظ.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar502068/index.html">110 فولت على جهاز الكمبيوتر الخاص بك</a></li>
<li><a href="../ar502070/index.html">تاريخ بنتاكس (مقالة بالفيديو)</a></li>
<li><a href="../ar502072/index.html">إرساء ISS باستخدام JavaScript والبوصلة</a></li>
<li><a href="../ar502076/index.html">عربة الروبوت 2.0. الجزء 1. التنقل المستقل للروبوت المنزلي على أساس ROS</a></li>
<li><a href="../ar502080/index.html">طريقة كانبان: مثال PNZ رقم 1 ، عملية دراسة القياس في الشركات الناشئة</a></li>
<li><a href="../ar502086/index.html">إعداد Minio بحيث يمكن للمستخدم العمل فقط مع دلو له</a></li>
<li><a href="../ar502088/index.html">حكاية من الوقت الزائد والضياع. وفقًا لـ py3</a></li>
<li><a href="../ar502092/index.html">الدعم التكنولوجي والتنظيمي لخدمات الثقة الرقمية في الاتحاد الروسي</a></li>
<li><a href="../ar502098/index.html">كيف بنينا B2B</a></li>
<li><a href="../ar502102/index.html">AutoML رائع وقوي</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>