<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™Š ğŸ¥ˆ ğŸ•ºğŸ¾ Ù„Ø¹Ø¨Ø© Ø¢Ø±ÙƒÙŠØ¯ Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­: ÙƒÙŠÙ ØµÙ†Ø¹Ù†Ø§ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù„Ù‰ React + Redux âš¡ï¸ ğŸ˜– ğŸ„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ Ù‡Ø§Ø¨Ø±! ÙÙŠ ØªÙ„Ùƒ Ø§Ù„Ø³Ù†ÙˆØ§Øª ØºÙŠØ± Ø§Ù„Ø¨Ø¹ÙŠØ¯Ø© ØŒ ÙÙŠ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† ÙƒÙ„ÙŠØ© "Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬" ØŒ Ø£Ø­Ø¨Ø¨Øª Ø£Ù† Ø£Ø³Ø£Ù„ Ø²Ù…Ù„Ø§Ø¦ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø³Ø¤Ø§Ù„: "Ù„Ù…Ø§Ø°Ø§ Ø°Ù‡Ø¨Øª Ù‡Ù†Ø§ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©ØŸ" Ø¨Ø§Ù„Ø·Ø¨Ø¹ ØŒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Ù„Ø¹Ø¨Ø© Ø¢Ø±ÙƒÙŠØ¯ Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­: ÙƒÙŠÙ ØµÙ†Ø¹Ù†Ø§ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù„Ù‰ React + Redux</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/2gis/blog/498638/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ù…Ø±Ø­Ø¨Ø§ ÙŠØ§ Ù‡Ø§Ø¨Ø±! </font><font style="vertical-align: inherit;">ÙÙŠ ØªÙ„Ùƒ Ø§Ù„Ø³Ù†ÙˆØ§Øª ØºÙŠØ± Ø§Ù„Ø¨Ø¹ÙŠØ¯Ø© ØŒ ÙÙŠ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† ÙƒÙ„ÙŠØ© "Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬" ØŒ Ø£Ø­Ø¨Ø¨Øª Ø£Ù† Ø£Ø³Ø£Ù„ Ø²Ù…Ù„Ø§Ø¦ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø³Ø¤Ø§Ù„: "Ù„Ù…Ø§Ø°Ø§ Ø°Ù‡Ø¨Øª Ù‡Ù†Ø§ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©ØŸ" </font><font style="vertical-align: inherit;">Ø¨Ø§Ù„Ø·Ø¨Ø¹ ØŒ Ù„Ù… Ø£Ø­ØªÙØ¸ Ø¨Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ØŒ Ù„ÙƒÙ†Ù†ÙŠ Ø£ØªØ°ÙƒØ± Ø¹Ù„Ù‰ ÙˆØ¬Ù‡ Ø§Ù„ÙŠÙ‚ÙŠÙ†: Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù†ØµÙ Ø£Ø±Ø§Ø¯ÙˆØ§ ØµÙ†Ø¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨. </font><font style="vertical-align: inherit;">Ù…Ø¹Ø¸Ù… Ø£ÙˆÙ„Ø¦Ùƒ Ø§Ù„Ø°ÙŠÙ† Ø£Ø¬Ø§Ø¨ÙˆØ§ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ù„Ù… ÙŠÙƒÙˆÙ†ÙˆØ§ Ù…Ø³ØªØ¹Ø¯ÙŠÙ† Ù„ÙˆÙØ±Ø© Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† "Ø¹Ù„Ù…Ø§Ø¡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª" Ùˆ "Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¦ÙŠÙŠÙ†" Ø§Ù„Ø°ÙŠÙ† ØºÙ…Ø±Ù†Ø§ Ù…Ø¹Ù‡Ù… ÙÙŠ Ø£ÙˆÙ„ Ø¹Ø§Ù…ÙŠÙ† Ù…Ù† Ø¯Ø±Ø§Ø³ØªÙ†Ø§. </font><font style="vertical-align: inherit;">Ù„Ù… ÙŠÙ†Ø¬ Ø¬Ù…ÙŠØ¹ - Ø¨Ø­Ù„ÙˆÙ„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø®Ù…Ø³ Ø§Ù„Ù…ÙƒØªØ¸Ø© ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø«Ù„Ø§Ø«Ø© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ù…Ù†Ø° ÙˆÙ‚Øª Ù„ÙŠØ³ Ø¨Ø¨Ø¹ÙŠØ¯ ØŒ Ø£ØªÙŠØ­Øª Ø§Ù„ÙØ±ØµØ© Ù„ÙØ±ÙŠÙ‚Ù†Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ Ù„ØªØ¬Ø±Ø¨Ø© Ø£Ù†ÙØ³Ù‡Ù… ÙÙŠ Ø¯ÙˆØ± ØºØ§Ù…Ø¯ÙŠÙ. </font><font style="vertical-align: inherit;">Ø¨Ø§Ø®ØªØµØ§Ø± Ø´Ø¯ÙŠØ¯ ØŒ Ø§Ù„Ù…Ù‡Ù…Ø© Ù‡ÙŠ: Ø¥Ù†Ø´Ø§Ø¡ Ù„Ø¹Ø¨Ø© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø­Ù‚ÙŠÙ‚ÙŠØ© ØŒ Ø¨Ø­ÙŠØ« ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù„Ø¹Ø¨ ÙÙ‚Ø· Ø¹Ù† Ø·Ø±ÙŠÙ‚ ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­. </font><font style="vertical-align: inherit;">Ø­ØªÙ‰ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„. </font><font style="vertical-align: inherit;">Ø­ØªÙ‰ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„ÙˆÙŠØ¨.</font></font></p><br>
<p><img src="https://habrastorage.org/webt/fu/8-/se/fu8-seuqkglfv7tecp4q5u3hf_4.png"></p><br>
<p>       ,     ,    ,          â€” React + Redux,   Â« Â»,  ,  ,         .</p><a name="habracut"></a><br>
<h2 id="kak-vsyo-nachinalos">  </h2><br>
<p>        RnD   ,    : Â«   CodeFest â€”   .    â€”     Â».     ,  ,  ,  .             Gods in the sky. </p><br>
<p><img src="https://habrastorage.org/webt/l6/zv/br/l6zvbrmricb2lnvqrogi_d0hfme.png" alt="ØµÙˆØ±Ø© Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© CodeFest Ø¹Ù„Ù‰ VK / https://vk.com/codefest.  Ù…ØµØ¯Ø± Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§."><br>
<em>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CodeFest  </a>.</em></p><br>
<p>   <del>M</del>MO TPS   ,      ,          .  ,  ,   ,       .     CodeFest.   ,    .</p><br>
<h2 id="kak-vsyo-prodolzhalos">  </h2><br>
<p>   2     ,       ,     2      .        ,    ,            .</p><br>
<p> :    -,  â€”  ,   .  ,      N   ,   â€” 1 . ,  â€” 15 . ,  ,   16-.     ,     ,      :</p><br>
<ol>
<li>            30  .    CodeFest,       â€”     ,     Â«Â». ,  . </li>
<li>Â«Â» .   ,      :<br>
<ul>
<li>90  CPU;</li>
<li>120 ;</li>
<li>270 /c â€”    , 675 /c â€”     . </li>
</ul></li>
<li>             4,2 /c.    ,      .    â€”  UDP   WebRTC,       .       .</li>
<li>     . 2        ,         ,   ,   .  ,   -  Node.js    ,   . </li>
</ol><br>
<p>    , ,  (       ?),    ,  , ,       .        .</p><br>
<p>     ,        .          ,     Â«Â».        â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>.</p><br>
<h2 id="stek-tehnologiy-chto-i-pochemu"> :   </h2><br>
<p>    ,    ,     ,   .  ,  ,         5 ,    ,      40  .</p><br>
<p>    -.     ,           ,        â€”  .             React  Redux.   c 3D-,   ,    Gods in the sky,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">three.js</a>.</p><br>
<p> ,         .</p><br>
<h2 id="kak-organizovali-infrastrukturu">  </h2><br>
<p>      :</p><br>
<p><img src="https://habrastorage.org/webt/aj/qs/is/ajqsispjfubcnek60ow3-xnutvq.png"></p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>,        Node.js.    :</p><br>
<ul>
<li>    ,           -    (  ,      IE11);</li>
<li>      access-;</li>
<li>   html-    .</li>
</ul><br>
<p> SSR .     kubernetes       ,       .        ,    .    ,  , , ,       ( ).         .          Nginx.</p><br>
<h2 id="pro-organizaciyu-steyta">  </h2><br>
<p>      .    TS,    AppState,   :</p><br>
<pre><code class="javascript hljs">interface AppState {
    <span class="hljs-attr">gameState</span>: GameState;<font></font>
    gameObjects: GameObjects;<font></font>
    data: Data;<font></font>
    requests: RequestsState;<font></font>
}</code></pre><br>
<p> <code>requests</code> â€”    ,    â€” .    ,  â€”  . . </p><br>
<p> <code>data</code> â€”  ,         , ,  ,    Â«Â».  .</p><br>
<p> <code>GameState</code>     :</p><br>
<ol>
<li><p><code>stage: 'factoids' | 'citySelect' | 'flyShow' | 'game' | 'results';</code> â€”  .     : </p><br>
<ul>
<li>  ;</li>
<li> ;</li>
<li> ;</li>
<li> ;</li>
<li> .</li>
</ul><br>
</li>
<li><p><code>elapsedTime: number;</code> â€”   ,    ,      .</p><br>
</li>
</ol><br>
<p> ,  <code>factoids</code>  <code>flyShow</code>,      ,    â€”     <code>elapsedTime</code>.      0,     .       ,    .   ,     ,    ,      .      ,       .     â€¦  -      ,       .</p><br>
<p>, ,   :</p><br>
<pre><code class="javascript hljs">interface GameObjects {
    <span class="hljs-attr">user</span>: UserInGame;<font></font>
    gifts: { [id: string]: GiftInGame; };<font></font>
    boosts: { [id: string]: Boost; };<font></font>
    bombs: { [id: string]: Bomb; };<font></font>
}</code></pre><br>
<p>       ,    :  , ,   .       â€”       . </p><br>
<p>GameObjects â€”     .    ,  FPS  .           GPU   100   .  Redmi Note 7    40 FPS  (      ).       MI 5S  30 FPS,     20  ,      .</p><br>
<p> ,     .     .</p><br>
<h2 id="kak-my-zagnali-sebya-v-ugol">     </h2><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">-</a> Redux,     â€”       .      Redux      ,      .     ?           Redux,    .</p><br>
<p>   ,        .       ,          .       Â«Â» ( . behavior â€” ).   ,       . </p><br>
<p>       .     â€”   tick,            .      ,        .     tick   .      :</p><br>
<ul>
<li>  ,   ,   ,  . ,   ,    ,      .</li>
<li>  ( Redux-),    .<br>
,        Â«Â»  .</li>
<li> ,     gameObjects,      . ,    Â«Â»,         .</li>
</ul><br>
<p>   25      (  ).</p><br>
<p>      .      (  ),     React,         .  -           ,       Â«-  Â» ( ,  ,    ).</p><br>
<p><img src="https://habrastorage.org/webt/x8/oj/7v/x8oj7vakygewfuql_szihp3rp40.jpeg" alt="Ø¹Ø¶Ùˆ ÙØ±ÙŠÙ‚ Ø¢Ø®Ø± ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„ÙŠÙˆÙ….  Ø§Ù„ØµÙˆØ±Ø© Ù…Ø£Ø®ÙˆØ°Ø© Ù…Ù† pixabay.com"><br>
<em>      .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pixabay.com</a></em></p><br>
<p>  ,  FPS-          13.   ,   ,   -   MI 5S,    FPS- â€”    5-6,       .        .</p><br>
<p>  :  performance   â€”   ,  .     ,  ,      .</p><br>
<p>     FPS=30 , : </p><br>
<ul>
<li>Redux   <code>FPS * ~[ ] ~= 750</code>     ,   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    </a>.</li>
<li>Reactâ€™   <code>FPS * ~2 * ~[     ]</code>   .</li>
<li>three.js  ,     ,   WebGL   .    ,     .</li>
<li>    (..  150 )   4-6 , ..       . </li>
<li>CSS-     .</li>
<li>         ,       FPS  2-4  (     , Â«Â»     ). </li>
<li>          React.memo, -     ,      . </li>
</ul><br>
<p> React  :</p><br>
<ul>
<li><code>* ~2</code> ,            <code>connect</code>.  <code>connect</code> â€”  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">HOC</a>,  ,  .</li>
<li>       ,  React  â€“   (render pass),      CPU,  GPU. </li>
</ul><br>
<h2 id="sadim-pesca-na-dietu">   </h2><br>
<p> :    React.memo ,  ,    Â«Â»,     ,     DOM-,    . </p><br>
<p>  ,     React + Redux,         . </p><br>
<p><strong> Redux</strong></p><br>
<p>     Redux   â€”       .     ~1      ,       . ~1,      -    â€”   .     -,     ,   GameObjects   ,    :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setNextGameObjects</span>(<span class="hljs-params">payload: GameObjects</span>) </span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'SET_NEXT_GAME_OBJECTS'</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,<font></font>
        payload,<font></font>
    };<font></font>
}</code></pre><br>
<p>     GameObjects   :</p><br>
<ol>
<li>    ,      .    <code>SET_NEXT_GAME_OBJECTS</code>. </li>
<li>  ,    ,         GameObjects.     Redux  ,      - .         <code>SET_NEXT_GAME_OBJECTS</code>. </li>
</ol><br>
<p>      :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> state = store.getState().gameObjects;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> action <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.collectedActions) {<font></font>
    state = gameObjectsFakeStateReducer(state, action);<font></font>
}<font></font>
store.dispatch(setNextGameObjects(state));</code></pre><br>
<p>collectedActions â€” ,   .       â€”  ,  .</p><br>
<p>   â€”  ~25        10 :    ~2   .      ,   gameObjectsFakeStateReducer     .     25      .          ,      . </p><br>
<p>  ?     ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">perf-</a>.   3 :</p><br>
<ol>
<li>      ES2018,          ~50      &lt; ES2018 (,   Firefox â€”    ).    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">,    spread</a>.</li>
<li>      Object.assign         300 .</li>
<li>            500 ,   Â« Â»    .</li>
</ol><br>
<p> , , ,        â€”       ES2018,   .       Firefox.</p><br>
<p> â„–3  ,   â€¦ .         .</p><br>
<p>     Object.assign. <code>gameObjectsFakeStateReducer</code>  <code>gameObjectsFastStateReducer</code>,     - :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'PARTIAL_GIFT_STATE_PATCH'</span>:
        <span class="hljs-keyword">if</span> (!state.gifts[action.payload.id]) {
            <span class="hljs-keyword">return</span> state;<font></font>
        }<font></font>
        <span class="hljs-built_in">Object</span>.assign(state.gifts[action.payload.id], action.payload);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-comment">// case, default ...</span>
}</code></pre><br>
<p>? ,   .  ,     .           25   1   2-4 (    CPU).   :</p><br>
<p><img src="https://habrastorage.org/webt/ap/nk/wb/apnkwbrgdv7vqqisksup1hklpzg.png" alt="ØµÙˆØ±Ø©"></p><br>
<p>   Â«Â»   ,   ,    Redux         10        .  , -   ,    ,   connect          gameObjects.   ,     .</p><br>
<p><strong> React</strong></p><br>
<p>   React     .    â€”     DOM.    ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>,       â€” reselect, React.memo/React.PureComponent,   shouldComponentUpdate  .      .</p><br>
<p>     ,      ,       ~2,   â€”  5.     ,  React         , ..       DOM  .</p><br>
<p>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">batch</a>   React + Redux. ,    â€”          .  ,  ?</p><br>
<p>  ,       ,   connect     .      ,     .</p><br>
<p>  . ,   <code>&lt;ScoreBoard /&gt;</code>, </p><br>
<ol>
<li>  ;</li>
<li> ,  .<br>
<img src="https://habrastorage.org/webt/8p/zk/vw/8pzkvwx3nshmo2ys9ekmzcs7ekq.png"></li>
</ol><br>
<p>   React.PureComponent,    connect   mapStateToProps.      <code>elapsedTime</code>  <code>score</code>. <code>Score</code>  ,  <code>elapsedTime</code> â€”   .  <code>elapsedTime</code>  -    render.  ,       FPS,          shouldComponentUpdate.  HOCâ€™a connect   â€” shouldComponentUpdate   . </p><br>
<p> ,   Â«Â»      ,    : </p><br>
<ol>
<li>   shouldComponentUpdate,   <code>elapsedTime</code>     (      ).  ,        HOCâ€™a connect. </li>
<li> mapStateToProps   .   ,     ,        .          connectâ€™a.</li>
<li>     useSelector.   , ..    . , <em></em>,  ,   .</li>
<li>    â€”     connect,   â€”    .       ,   .       ScoreBoard    .</li>
</ol><br>
<p> â€” !  ScoreBoardâ€™a   connect,    ,     .        mapStateToProps  ,          .</p><br>
<p>       ,  connect.       ,          â€” -     -  canvas-,   three.js     (, ,  .).      render   ,   :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"map"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{s.map}</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{mapRef}</span> /&gt;</span></span>;</code></pre><br>
<p></p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"scene"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{s.scene}</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{sceneRef}</span> /&gt;</span></span>;</code></pre><br>
<p>      ,  DOM           â€”   .   ,     React <strong>  </strong>.     ,    componentDidUpdate,      .  ,  componentDidUpdate     :</p><br>
<pre><code class="javascript hljs">public componentDidUpdate() {
    <span class="hljs-keyword">const</span> { geoPos, orientedRotationQuanternion } = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">const</span> { map } = <span class="hljs-keyword">this</span>.state;<font></font>
    map.setQuat(orientedRotationQuanternion);<font></font>
    map.setCenter([geoPos[<span class="hljs-number">0</span>], geoPos[<span class="hljs-number">1</span>]], { <span class="hljs-attr">animate</span>: <span class="hljs-literal">false</span> });<font></font>
    map.setZoom(getMapZoomFromHeight(geoPos[<span class="hljs-number">2</span>]), { <span class="hljs-attr">animate</span>: <span class="hljs-literal">false</span> });<font></font>
}</code></pre><br>
<p>    ,  componentDidUpdate       .    :</p><br>
<ol>
<li>  connect.   ,   mapStateToProps;</li>
<li>   <code>public shouldComponentUpdate() { return false; }</code> â€”   Â«Â»   Â«Â»;</li>
<li>  Redux   (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>)   useStore   ;</li>
<li>     (<code>store.subscribe(() =&gt; { /* â€¦ */})</code>);</li>
<li>        ; </li>
<li>!</li>
</ol><br>
<p>  :</p><br>
<pre><code class="javascript hljs">store.subscribe(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> state = store.getState();
    <span class="hljs-keyword">const</span> { map } = <span class="hljs-keyword">this</span>.state;
    <span class="hljs-keyword">const</span> { geoPos, orientedRotationQuanternion } = state.gameObjects.user;<font></font>
<font></font>
    map.setQuat(orientedRotationQuanternion);<font></font>
    map.setCenter([geoPos[<span class="hljs-number">0</span>], geoPos[<span class="hljs-number">1</span>]], { <span class="hljs-attr">animate</span>: <span class="hljs-literal">false</span> });<font></font>
    map.setZoom(getMapZoomFromHeight(geoPos[<span class="hljs-number">2</span>]), { <span class="hljs-attr">animate</span>: <span class="hljs-literal">false</span> });<font></font>
}); </code></pre><br>
<p>    ,        ,    .</p><br>
<p>  ,     -  ,          .</p><br>
<p><img src="https://habrastorage.org/webt/py/df/-7/pydf-7ke4d8chrx8tx2ltywyfiq.png"><br>
<em>   .    â€” React Tree Reconcilation + Commit</em></p><br>
<p><img src="https://habrastorage.org/webt/ws/ki/et/wskiet93rpomj5e4yh67deqg_t4.png"><br>
<em>React Tree Reconcilation + Commit  </em></p><br>
<h2 id="zaklyuchenie"></h2><br>
<p> React + Redux    ,  :</p><br>
<ul>
<li>        ,    ,      ,   Â«Â»   React       ,   ;</li>
<li>        ;</li>
<li>     Â« Â»,      <strong> ,    </strong>;</li>
<li>    ,      .</li>
</ul><br>
<p>  ,       .  ,    .       ,        .    ?    . </p><br>
<p>   :</p><br>
<ol>
<li>  ,     ,      ,      ,    .            ,    . </li>
<li>,  Reactâ€™    30        .      :        .</li>
<li>    ,     .</li>
<li>    .         .             ,    . </li>
<li>        .</li>
<li>   Performance    â€”     .     CPU â€”      ,     Intel i9.</li>
<li>     -  :    12â€“20    â€“ .  ,   . </li>
<li>     ,   .        , ,         .      ,      .</li>
<li>   ,          ,     .   IE11    ,    .        70-  Edge  18- (  ).</li>
<li> WebGL           . -  ,   ,  -,   Firefox  linux,    .    .    â€”  .     -, .    ,     ,  Â«       Â»,     .</li>
</ol><br>
<p>,    :</p><br>
<ol>
<li>Firefox.  <em> </em> .  ,     WebGL,    â€”     spread. FPS  Firefox     ,   Chrome. ,     ,    .</li>
<li>IPhone.  Safari     IE6  220         .         ,    ,    .    ,    ,   .     .           â€”       - .</li>
<li>.   .        .    ,        ,       (, ,    ).  .</li>
<li> .       ,   ,      .   ,    ,      ,    Â«Â»       .</li>
<li>         (   ),     â€“     ,        .       .</li>
</ol><br>
<p>   ,      ,     .      iOS, Android  Web       .</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar498628/index.html">ÙƒÙŠÙÙŠØ© Ø¨Ù†Ø§Ø¡ Ù…Ø³Ø±Ø¹ ØµØ§Ø±ÙˆØ®ÙŠ Ù„Ù†ØµÙˆØµ PowerCLIÂ </a></li>
<li><a href="../ar498630/index.html">Ù…Ø­Ø§ÙƒØ§Ø© ÙÙŠØ²ÙŠØ§Ø¦ÙŠØ© Ù„Ù…Ø¦Ø§Øª Ø§Ù„Ø¢Ù„Ø§Ù Ù…Ù† Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª Ø¹Ù„Ù‰ Unity + DOTS</a></li>
<li><a href="../ar498632/index.html">Ø§Ù„Ø¨Ø¨ØªÙŠØ¯ Ù„Ù…Ù„Ø§Ø·Ùˆ Ø¬Ù…ÙŠÙ„</a></li>
<li><a href="../ar498634/index.html">11 Ø³Ø¤Ø§Ù„Ù‹Ø§ ØºØ¨ÙŠÙ‹Ø§ Ù„Ø¬Ø±Ø§Ø­ Ø§Ù„Ø¹Ø¸Ø§Ù… ÙˆÙ…Ø¯Ù„ÙƒÙ‹Ø§ Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆÙ„ÙŠØ³ ÙÙ‚Ø·</a></li>
<li><a href="../ar498636/index.html">ØªØ¸Ù„ÙŠÙ„ Ø¨Ø³ÙŠØ· Ù„Ø£Ø¶ÙˆØ§Ø¡ Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„Ø¶Ø¨Ø§Ø¨</a></li>
<li><a href="../ar498642/index.html">Geeek Club: ÙƒÙŠÙ Ø¬Ù…Ø¹Ù†Ø§ 137000 Ø¯ÙˆÙ„Ø§Ø± Ø¹Ù„Ù‰ Kickstarter Ù„Ù…ØµÙ…Ù… DIY PCB</a></li>
<li><a href="../ar498646/index.html">ÙƒÙŠÙ Ø³Ø§Ø¹Ø¯Ù†ÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø³ØªÙ‚Ù„ ÙÙŠ ÙØªØ­ ÙˆÙƒØ§Ù„ØªÙŠ Ø§Ù„Ø®Ø§ØµØ©</a></li>
<li><a href="../ar498652/index.html">ÙƒØ´Ù Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ø§Ø¹ØªØ±Ø§Ù ÙˆØ§Ù„Ø­ÙƒÙ…. Ø§Ù„Ø¬Ø²Ø¡ 2</a></li>
<li><a href="../ar498654/index.html">Ù…Ø§ Ù‡Ùˆ VPS / VDS ÙˆÙƒÙŠÙÙŠØ© Ø´Ø±Ø§Ø¦Ù‡. Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ø§</a></li>
<li><a href="../ar498656/index.html">Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø·Ø§Ø±ÙŠØ© ÙƒØ±ÙˆÙ†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>