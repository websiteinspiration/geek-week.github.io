<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔯 🙎🏻 👋🏼 静的ジェネレーターおよびGitHubページ上のサイトのCI / CDとしてのGitHubアクション 👰 👩🏼‍⚕️ 📻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habrは、（ベータ版）GitHubの機能であるアクションに関するトピックについて公開された記事がほとんどないことに少し驚いていました。 
 

この控えめな表現は、「ベータ版」ではありますが、機能がまだテスト中であるという事実によって説明できるようです。ただし、このツールはプライベートリポジトリで...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>静的ジェネレーターおよびGitHubページ上のサイトのCI / CDとしてのGitHubアクション</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474668/"><p><img src="https://habrastorage.org/webt/n5/yi/0w/n5yi0witxomvduoy-ncm1mfctwo.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habrは、（ベータ版）GitHubの機能であるアクションに関するトピックについて公開された記事がほとんどないことに少し驚いていました。 </font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この控えめな表現は、「ベータ版」ではありますが、機能がまだテスト中であるという事実によって説明できるようです。</font><font style="vertical-align: inherit;">ただし、このツールはプライベートリポジトリでこのツールを使用できる便利なベータ機能です。</font><font style="vertical-align: inherit;">この記事で説明するのは、このテクノロジを使用することです。</font></font></p><a name="habracut"></a><br>
<h1 id="predistoriya"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先史時代</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">順序どおりに始める場合は、個人用サイト「About Me」を保存するための迅速、便利、簡単、無料のオプションを検索する過程で、数泊して多くの記事を読む必要があったことをおそらく言及する必要があります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰かがホスティングを選択し、誰かがクラウドサーバーを選択し、これらすべての作業、相互作用、支払いを理解したくない人-静的サイトをリポジトリにアップロードしたいので、今ではGitHubとGitLabで実行できます。</font></font></p><br>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もちろん、これは皆の個人的な選択です。</font></font></em></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の最後の選択はGitHub Pagesを支持することでした。</font></font></p><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページについて</font></font></b><div class="spoiler_text"><p>   , <code>gh-pages</code> —            ,        .    GitHub’       .</p><br>
<p>     <code>gh-pages</code>,    —     <code>username.github.io</code>     <code>master</code> .</p><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>,    ,  GitHub           ,    <code>CNAME</code> c     DNS  -   GitHub.</p><br>
<p><em>,           ,     .</em></p></div></div><br>
<h1 id="vozniknovenie-problemy"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題の発生</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題は、静的ジェネレーターを使用する場合、追加で構成する必要があることでした。 </font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">松葉杖</font></font></del>              . ,       ,                        .</p><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>       .        ,       ,                 <em>(    )</em>. </p><br>
<p> ,       ,      GitHub    CI/CD,        .</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p>       ,             :</p><br>
<p>1)       ,      .        ,         ,        .  ,          ;</p><br>
<p>2)        ,   ,        GitHub Pages     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Jekyll</a>. ,          <em>(      )</em>.</p><br>
<p>      . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Pelican</a>    Python       Jekyll <em>(  )</em>.       ,           . </p><br>
<p>__</p></div></div><br>
<h1 id="postanovka-zadachi"> </h1><br>
<p>   —    (    ),          .       .         .</p><br>
<h2 id="instrumenty-dlya-resheniya">  </h2><br>
<p>      :</p><br>
<ul>
<li>GitHub Actions;</li>
<li>Python 3.7;</li>
<li>Pelican;</li>
<li>Git;</li>
<li>GitHub Pages.</li>
</ul><br>
<h1 id="reshenie-problemy"> </h1><br>
<p>,           Actions         . <em>         </em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> -</a><em>!</em></p><br>
<p><img src="https://habrastorage.org/webt/1r/wl/7r/1rwl7rpify7aeplohqqizaiknli.png"><br>
<em>    Github</em></p><br>
<p>  Actions-       <code>.github</code>    <code>workflows</code>.     ,       Actions   .</p><br>
<p><img src="https://habrastorage.org/webt/sj/bg/jw/sjbgjwz5huh8pw6x3lnkfj6iw-y.png"><br>
<em>   </em></p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">name: CI    #  :     Actions<font></font>
<font></font>
on: [push]  # ,     <font></font>
<font></font>
jobs:       # ,   <font></font>
  build:    # , ..<font></font>
<font></font>
    runs-on: ubuntu-latest      # ..     <font></font>
<font></font>
    steps:              #       <font></font>
    - uses: actions/checkout@v1     #     <font></font>
    - name: Run a one-line script   #    1<font></font>
      run: echo Hello, world!       #    1 (bash-    )<font></font>
    - name: Run a multi-line script   #    2<font></font>
      run: |                    #    2 ()<font></font>
        echo Add other actions to build,<font></font>
        echo test, and deploy your project.</code></pre></div></div><br>
<p>    :</p><br>
<p>0) <em>    “CI”.   .</em></p><br>
<p>1)     /,     ,          .</p><br>
<pre><code class="plaintext hljs">on:<font></font>
  push</code></pre><br>
<p>2)           ,   Ubuntu     .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>  ,           (     ).</p><br>
<pre><code class="plaintext hljs">  build:<font></font>
    runs-on: ubuntu-latest</code></pre><br>
<p>3)          .</p><br>
<p>3.1)      (  <code>checkout</code>):</p><br>
<pre><code class="plaintext hljs">- uses: actions/checkout@v1</code></pre><br>
<p>3.2)  Python:</p><br>
<pre><code class="plaintext hljs">    - name: Set up Python<font></font>
      uses: actions/setup-python@v1<font></font>
      with:<font></font>
        python-version: 3.7</code></pre><br>
<p>3.3)    :</p><br>
<pre><code class="plaintext hljs">    - name: Install dependencies<font></font>
      run: |<font></font>
          python -m pip install --upgrade pip<font></font>
          pip install -r requirements.txt</code></pre><br>
<p>3.4)        :</p><br>
<pre><code class="plaintext hljs">   - name: Make output folder<font></font>
      run: mkdir output</code></pre><br>
<p>4)  ,      ,                ,        :</p><br>
<pre><code class="plaintext hljs">   - name: Clone master branch<font></font>
      run: git clone "https://${{ secrets.ACCESS_TOKEN }}@github.com/${GITHUB_ACTOR}/${GITHUB_ACTOR}.github.io.git" --branch master --single-branch ./output</code></pre><br>
<p>    :</p><br>
<ul>
<li> <code>GITHUB_ACTOR</code> GitHub  ,    ,      ;</li>
<li> <code>secrets.ACCESS_TOKEN</code>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   Github’</a>,            <code>Secrets</code>   . <em> ,      ,      .      Secrets.</em></li>
</ul><br>
<p>5)     :</p><br>
<pre><code class="plaintext hljs">   - name: Generate static pages<font></font>
      run: pelican content -o output -s publishconf.py</code></pre><br>
<p>,  ,   ,      (<code>-o output</code>)   ,     (<code>-s publishconf.py</code>; <em>              Pelican</em>).</p><br>
<p><em>,      <code>output</code>    .</em></p><br>
<p>6)  git     :</p><br>
<pre><code class="plaintext hljs">    - name: Set git config and add changes<font></font>
      run: |<font></font>
          git config --global user.email "${GITHUB_ACTOR}@https://users.noreply.github.com/"<font></font>
          git config --global user.name "${GITHUB_ACTOR}"<font></font>
          git add --all<font></font>
      working-directory: ./output</code></pre><br>
<p><em>      ,             .          — <code>cd output</code>.</em></p><br>
<p>7)   ,       .     ,       bash (    <code>0</code>) —      -   .     <code>git diff-index --quiet --cached HEAD --</code>       <code>0</code>       ,  <code>1</code>   .      .  ,               ,          .</p><br>
<p><em>         .</em></p><br>
<pre><code class="plaintext hljs">   - name: Push and send notification<font></font>
      run: |<font></font>
          COMMIT_MESSAGE="Update pages on $(date +'%Y-%m-%d %H:%M:%S')"<font></font>
          git diff-index --quiet --cached HEAD -- &amp;&amp; echo "No changes!" &amp;&amp; exit 0 || echo $COMMIT_MESSAGE<font></font>
          # Only if repo have changes<font></font>
          git commit -m "${COMMIT_MESSAGE}"<font></font>
          git push https://${{ secrets.ACCESS_TOKEN }}@github.com/${GITHUB_ACTOR}/${GITHUB_ACTOR}.github.io.git master<font></font>
      working-directory: ./output</code></pre><br>
<h1 id="rezultat"></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その結果、このようなスクリプトを使用すると、静的なページの作成について考える必要がなくなります。</font><font style="vertical-align: inherit;">変更をプライベートリポジトリに直接追加することにより、どのシステムからでもgitで作業する場合でも、GitHubのウェブインターフェースを介してファイルを作成する場合でも、アクションはすべて自分で行います。</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールで予期しないスクリプトクラッシュが発生した場合は、通知が送信されます。</font></font></em></p><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全なコード</font></font></b><div class="spoiler_text"><p>   ,          ,       .</p><br>
<p><em>  Secrets           .</em></p><br>
<pre><code class="plaintext hljs">name: Push content to the user's GitHub pages repository<font></font>
<font></font>
on:<font></font>
  push<font></font>
<font></font>
jobs:<font></font>
  build:<font></font>
    runs-on: ubuntu-latest<font></font>
<font></font>
    steps:<font></font>
    - uses: actions/checkout@v1<font></font>
    - name: Set up Python<font></font>
      uses: actions/setup-python@v1<font></font>
      with:<font></font>
        python-version: 3.7<font></font>
    - name: Install dependencies<font></font>
      run: |<font></font>
          python -m pip install --upgrade pip<font></font>
          pip install -r requirements.txt<font></font>
    - name: Make output folder<font></font>
      run: mkdir output<font></font>
    - name: Clone master branch<font></font>
      run: git clone "https://${{ secrets.ACCESS_TOKEN }}@github.com/${GITHUB_ACTOR}/${GITHUB_ACTOR}.github.io.git" --branch master --single-branch ./output<font></font>
    - name: Generate static pages<font></font>
      run: pelican content -o output -s publishconf.py<font></font>
    - name: Set git config and add changes<font></font>
      run: |<font></font>
          git config --global user.email "${GITHUB_ACTOR}@https://users.noreply.github.com/"<font></font>
          git config --global user.name "${GITHUB_ACTOR}"<font></font>
          git add --all<font></font>
      working-directory: ./output<font></font>
    - name: Push and send notification<font></font>
      run: |<font></font>
          COMMIT_MESSAGE="Update pages on $(date +'%Y-%m-%d %H:%M:%S')"<font></font>
          git diff-index --quiet --cached HEAD -- &amp;&amp; echo "No changes!" &amp;&amp; exit 0 || echo $COMMIT_MESSAGE<font></font>
          git commit -m "${COMMIT_MESSAGE}"<font></font>
          git push https://${{ secrets.ACCESS_TOKEN }}@github.com/${GITHUB_ACTOR}/${GITHUB_ACTOR}.github.io.git master<font></font>
          curl "https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendMessage?text=$COMMIT_MESSAGE %0ALook at ${GITHUB_ACTOR}.github.io %0ARepository%3A github.com/${GITHUB_ACTOR}/${GITHUB_ACTOR}.github.io&amp;chat_id=${{ secrets.ADMIN_ID }}"<font></font>
      working-directory: ./output</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリーンショット</font></font></b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pu/3h/1f/pu3h1fvrcftcsps02q8s7fdtcws.png"><br>
<em>       Actions   </em></p><br>
<p><img src="https://habrastorage.org/webt/pi/nv/hr/pinvhrnwylox0oacazhjjuysx04.png"><br>
<em>      </em></p></div></div><br>
<h1 id="poleznye-ssylki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></h1><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクションの概要</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構文アクション</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリガーリスト</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仮想環境オプション</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Githubページ</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Static Generatorリスト</font></font></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja474656/index.html">Reversim MIPSとGolang-リバースの基本。r0ot-miで逆転するための問題を解決します。パート2</a></li>
<li><a href="../ja474658/index.html">手首の痛みとコンピューターマウス</a></li>
<li><a href="../ja474662/index.html">ベータテスト：開発者向けの開発-英語学習用プラットフォーム</a></li>
<li><a href="../ja474664/index.html">注意を高めるために、私たちの脳は集中力を高めませんが、情報フィルターを使用します</a></li>
<li><a href="../ja474666/index.html">Rustでプロジェクトを書き直さない方法</a></li>
<li><a href="../ja474672/index.html">React、JSX、WebモジュールなしのブラウザーでのESモジュール（動的を含む）のインポート</a></li>
<li><a href="../ja474674/index.html">マシンビジョンと医学</a></li>
<li><a href="../ja474676/index.html">GLES3およびWebGL2でのGPU上の数十万のユニークな粒子の相互作用アルゴリズム</a></li>
<li><a href="../ja474678/index.html">Khronos GroupがVulkanの例を使用して統合リポジトリを作成しました</a></li>
<li><a href="../ja474680/index.html">AIと2048。パート2：ミニマックス+アルファベータクリッピング</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>