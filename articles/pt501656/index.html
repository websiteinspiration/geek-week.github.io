<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêß üõ°Ô∏è ü•ù Desenvolvimento de uma biblioteca corporativa de componentes React. Abordagem multiplataforma ‚¨õÔ∏è üèåÔ∏è üë®üèæ‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo conta a hist√≥ria da implementa√ß√£o bem-sucedida do sistema de design na empresa de um dos maiores varejistas de bricolage. Os princ√≠pios e ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de uma biblioteca corporativa de componentes React. Abordagem multiplataforma</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/luxoft/blog/501656/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este artigo conta a hist√≥ria da implementa√ß√£o bem-sucedida do sistema de design na empresa de um dos maiores varejistas de bricolage. </font><font style="vertical-align: inherit;">Os princ√≠pios e abordagens do desenvolvimento de plataforma cruzada dos componentes da interface do usu√°rio usando as bibliotecas React e React Native s√£o descritos, bem como a solu√ß√£o para o problema de reutilizar c√≥digo entre projetos para diferentes plataformas.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, algumas palavras sobre como tudo come√ßou e por que surgiu a id√©ia de implementar um design de sistema. Tudo come√ßou com um aplicativo Android m√≥vel para vendedores nas lojas. O aplicativo √© constru√≠do na estrutura React-Native. A funcionalidade inicial foi representada por apenas alguns m√≥dulos, como procurar produtos no cat√°logo e cart√£o do produto, documento de vendas. A prop√≥sito, agora esse √© um aplicativo bastante poderoso que j√° substituiu amplamente a funcionalidade dos balc√µes de informa√ß√µes nas lojas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, foram lan√ßados projetos de aplicativos da Web para funcion√°rios do departamento de log√≠stica, bem como v√°rios configuradores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse est√°gio, apareceu um entendimento das abordagens gerais para o design desses aplicativos, bem como a presen√ßa de uma base de c√≥digo bastante grande. E era l√≥gico sistematizar o outro para reutiliza√ß√£o adicional.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para sistematizar a UI / UX, decidiu-se desenvolver um sistema de design. N√£o vou entrar em detalhes sobre o que √©. Na Internet, voc√™ pode encontrar muitos artigos sobre esse t√≥pico. Por exemplo, em Habr√©, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalho de Andrei Sundiev</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode ser recomendado para leitura </font><font style="vertical-align: inherit;">.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que projetar um sistema e quais s√£o suas vantagens? A primeira √© uma experi√™ncia comum e a sensa√ß√£o de usar produtos. Os usu√°rios obt√™m uma interface familiar, independentemente da aplica√ß√£o: os bot√µes parecem e funcionam como est√£o acostumados, o menu √© aberto no lugar certo e com a din√¢mica certa, os campos de entrada funcionam da maneira usual. A segunda vantagem √© a introdu√ß√£o de certos padr√µes e abordagens comuns, tanto do lado do design quanto do lado do desenvolvimento. Cada nova funcionalidade √© desenvolvida de acordo com c√¢nones e abordagens j√° estabelecidos. Desde os primeiros dias, os novos funcion√°rios recebem uma linha de trabalho clara. O pr√≥ximo √© reutilizar componentes e simplificar o desenvolvimento. N√£o h√° necessidade de "reinventar a roda" o tempo todo. Voc√™ pode criar interfaces a partir de blocos prontos com o resultado final esperado.Bem, em primeiro lugar, a principal vantagem para o cliente √© economizar dinheiro e tempo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, o que fizemos. De fato, criamos n√£o apenas uma biblioteca de componentes, mas toda uma estrutura de plataforma cruzada. A estrutura √© baseada em um esquema em lote. Temos 5 pacotes principais do NPM. √â o n√∫cleo da implanta√ß√£o de aplicativos da Web e Android multiplataforma. Pacotes de m√≥dulos, utilit√°rios e servi√ßos. E um pacote de componentes, que ser√° discutido mais adiante. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abaixo est√° o diagrama UML do pacote de componentes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/kn/xs/wiknxsuqj_n4jze72crt4c4u10g.jpeg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele inclui os componentes em si, alguns dos quais s√£o independentes (elementos), e alguns s√£o conectados entre si, bem como o n√∫cleo interno ou "sub-n√∫cleo".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos considerar em mais detalhes o que est√° inclu√≠do no "subn√∫cleo". A primeira √© a camada visual do design do sistema. Tudo aqui √© sobre paleta de cores, tipografia, sistema de indenta√ß√£o, grades, etc. O pr√≥ximo bloco s√£o os servi√ßos necess√°rios para o funcionamento dos componentes, como: ComponentsConfig (configura√ß√£o de componentes), StyleSet (discutirei esse conceito com mais detalhes posteriormente) e Device (um m√©todo para trabalhar com a API do dispositivo). E o terceiro bloco √© de todos os tipos de ajudantes (resolvedores, geradores de estilo etc.).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/7l/f6/fx7lf6zz7n8olddc2yuf7576s6a.jpeg" alt="imagem"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao desenvolver a biblioteca, usamos uma abordagem at√¥mica para o design de componentes. Tudo come√ßou com a cria√ß√£o de componentes ou elementos elementares. S√£o "part√≠culas" elementares que s√£o independentes uma da outra. Os principais s√£o View, Text, Image, Icon. A seguir est√£o os componentes mais complexos. Cada um deles usa um ou mais elementos para construir sua estrutura. Por exemplo, bot√µes, campos de entrada, sele√ß√µes etc. O pr√≥ximo n√≠vel √© padr√µes. Eles s√£o uma combina√ß√£o de componentes para resolver qualquer problema de interface do usu√°rio. Por exemplo, um formul√°rio de autoriza√ß√£o, um cabe√ßalho com par√¢metros e configura√ß√µes ou um cart√£o de produto projetado por um designer que pode ser usado em diferentes m√≥dulos. O √∫ltimo e mais dif√≠cil e ao mesmo tempo importante n√≠vel √© o chamado comportamento. Estes s√£o m√≥dulos prontos para uso,Implementar certa l√≥gica comercial e, possivelmente, incluindo o conjunto necess√°rio de solicita√ß√µes de back-end.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/00/jv/e3/00jve3iwyh64n0tifikfxtoz0v4.jpeg" alt="imagem"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, vamos seguir para a implementa√ß√£o da biblioteca de componentes. </font><font style="vertical-align: inherit;">Como mencionei antes, temos duas plataformas de destino - Web e Android (nativo de rea√ß√£o). </font><font style="vertical-align: inherit;">Se na web esses s√£o elementos familiares a todos os desenvolvedores da web, como div, span, img, header, etc., em react-native, esses s√£o os componentes View, Text, Image, Modal. </font><font style="vertical-align: inherit;">E a primeira coisa em que concordamos √© o nome dos componentes. </font><font style="vertical-align: inherit;">Decidimos usar um sistema no estilo react-native, como </font><font style="vertical-align: inherit;">em primeiro lugar, alguma base de componentes j√° foi implementada em projetos e, em segundo lugar, esses nomes s√£o os mais universais e compreens√≠veis para desenvolvedores nativos da Web e reativos. </font><font style="vertical-align: inherit;">Por exemplo, considere o componente Exibir. </font><font style="vertical-align: inherit;">O m√©todo do componente de renderiza√ß√£o condicional para a Web √© mais ou menos assim:</font></font><br>
<br>
<pre><code class="javascript hljs">render() {
	<span class="hljs-keyword">return</span>(
		<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> {<span class="hljs-attr">...props</span>}&gt;</span>
			{children}
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
	)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa. </font><font style="vertical-align: inherit;">sob o cap√¥, isso n√£o passa de um div com os adere√ßos e descendentes necess√°rios. </font><font style="vertical-align: inherit;">No react-native, a estrutura √© muito semelhante, apenas o componente View √© usado em vez de divs:</font></font><br>
<br>
<pre><code class="javascript hljs">render() {
	<span class="hljs-keyword">return</span>(
		<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> {<span class="hljs-attr">...props</span>}&gt;</span>
			{children}
		<span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span><font></font>
	)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surge a pergunta: como combinar isso em um componente e ao mesmo tempo dividir a renderiza√ß√£o? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â aqui que um padr√£o de rea√ß√£o chamado HOC ou componente de ordem superior vem para o resgate. </font><font style="vertical-align: inherit;">Se voc√™ tentar desenhar um diagrama UML desse padr√£o, obter√° algo como o seguinte:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/73/sz/tb/73sztbbrwdkvgknh3edlwk93gyo.jpeg" alt="imagem"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, cada componente consiste em um delegado chamado que recebe adere√ßos de fora e √© respons√°vel pela l√≥gica comum a ambas as plataformas, e duas partes da plataforma nas quais os m√©todos espec√≠ficos para cada plataforma j√° est√£o encapsulados e a renderiza√ß√£o mais importante. </font><font style="vertical-align: inherit;">Por exemplo, considere o c√≥digo de delega√ß√£o do bot√£o:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buttonDelegate</span>(<span class="hljs-params">ReactComponent: ComponentType&lt;Props&gt;</span>): <span class="hljs-title">ComponentType</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ButtonDelegate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{<font></font>
        <font></font>
        <span class="hljs-comment">// Button common methods</span><font></font>
<font></font>
        render() {<font></font>
           <span class="hljs-keyword">const</span> { onPress, onPressIn, onPressOut } = <span class="hljs-keyword">this</span>.props;
            <span class="hljs-keyword">const</span> delegate = {
                <span class="hljs-attr">buttonContent</span>: <span class="hljs-keyword">this</span>.buttonContent,
                <span class="hljs-attr">buttonSize</span>: <span class="hljs-keyword">this</span>.buttonSize,
                <span class="hljs-attr">iconSize</span>: <span class="hljs-keyword">this</span>.iconSize,
                <span class="hljs-attr">onClick</span>: onPress,
                <span class="hljs-attr">onMouseUp</span>: onPressIn,
                <span class="hljs-attr">onMouseDown</span>: onPressOut,
                <span class="hljs-attr">onPress</span>: <span class="hljs-keyword">this</span>.onPress,
                <span class="hljs-attr">textColor</span>: <span class="hljs-keyword">this</span>.textColor,<font></font>
            };<font></font>
            <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReactComponent</span> {<span class="hljs-attr">...this.props</span>} <span class="hljs-attr">delegate</span>=<span class="hljs-string">{delegate}</span> /&gt;</span></span>);<font></font>
        }<font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O delegado recebe como argumento a parte da plataforma do componente, implementa m√©todos comuns a ambas as plataformas e os passa para a parte da plataforma. </font><font style="vertical-align: inherit;">A parte da plataforma do pr√≥prio componente √© a seguinte:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">WebProps</span>, <span class="hljs-title">State</span>&gt; </span>{<font></font>
    <font></font>
   <span class="hljs-comment">// Web specific methods</span><font></font>
<font></font>
    render() {<font></font>
        <span class="hljs-keyword">const</span> { <span class="hljs-attr">delegate</span>: { onPress, buttonContent } } = <span class="hljs-keyword">this</span>.props;
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                <span class="hljs-attr">className</span>=<span class="hljs-string">{this.classes}</span>
                {<span class="hljs-attr">...buttonProps</span>}
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onPress}</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>
            &gt;</span>
                {buttonContent(this.spinner, this.iconText)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> buttonDelegate(Button);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° um m√©todo de renderiza√ß√£o com todos os seus recursos de plataforma. A funcionalidade geral do delegado vem na forma de um objeto atrav√©s do delegado props. Um exemplo da parte da plataforma de um bot√£o para uma implementa√ß√£o nativa de rea√ß√£o:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">NativeProps</span>, <span class="hljs-title">State</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-comment">// Native specific methods</span><font></font>
<font></font>
    render() {<font></font>
        <span class="hljs-keyword">const</span> { <span class="hljs-attr">delegate</span>: { onPress, buttonContent } } = <span class="hljs-keyword">this</span>.props;
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">styleSet</span>=<span class="hljs-string">{this.styles}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span>
                    {<span class="hljs-attr">...butonProps</span>}
                    <span class="hljs-attr">onPress</span>=<span class="hljs-string">{onPress}</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{this.touchableStyles}</span>
                    {<span class="hljs-attr">...touchableProps</span>}    
                &gt;</span>
                    {buttonContent(this.spinner, this.iconText)}
                <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> buttonDelegate(Button);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, a l√≥gica √© semelhante, mas componentes nativos de rea√ß√£o s√£o usados. Nas duas listagens, buttonDelegate √© um HOC com l√≥gica comum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com essa abordagem na implementa√ß√£o de componentes, surge a quest√£o da separa√ß√£o das pe√ßas da plataforma durante a montagem do projeto. √â necess√°rio garantir que o webpack usado por n√≥s em projetos para web colete apenas partes dos componentes destinados √† web, enquanto o bundler metro no react-native deve "ligar" suas partes da plataforma, sem prestar aten√ß√£o ao componente para web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver esse problema, eles usaram o recurso de agregador metro integrado, que permite especificar o prefixo da extens√£o do arquivo da plataforma. No nosso caso, o metro.config.js fica assim:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">resolver</span>: {
        <span class="hljs-attr">useWatchman</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">platforms</span>: [<span class="hljs-string">'native'</span>],<font></font>
    },<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, ao criar o pacote configur√°vel, o metro primeiro procura arquivos com a extens√£o native.js e, se n√£o estiver no diret√≥rio atual, anexa o arquivo √† extens√£o .js. Essa funcionalidade tornou poss√≠vel colocar as partes da plataforma dos componentes em arquivos separados: a parte da Web est√° localizada no arquivo .js, a parte react-native √© colocada no arquivo com a extens√£o .native.js. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, o webpack tem a mesma funcionalidade usando o NormalModuleReplacementPlugin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro objetivo da abordagem de plataforma cruzada era fornecer um mecanismo √∫nico para criar componentes de estilo. No caso de aplicativos da web, escolhemos o pr√©-processador sass, que finalmente √© compilado em css regular. Essa. para componentes da Web, usamos os familiares desenvolvedores do react className.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os componentes nativos do React s√£o estilizados por meio de estilos inline e adere√ßos. </font><font style="vertical-align: inherit;">Foi necess√°rio combinar essas duas abordagens, possibilitando o uso de classes de estilo para aplicativos Android. </font><font style="vertical-align: inherit;">Para esse prop√≥sito, foi introduzido o conceito de styleSet, que nada mais √© do que uma matriz de strings - nomes de classes:</font></font><br>
<br>
<pre><code class="javascript hljs">styleSet: <span class="hljs-built_in">Array</span>&lt;string&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, o servi√ßo StyleSet de mesmo nome foi implementado para react-native, o que permite registrar nomes de classes:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> StyleSet.define({
    <span class="hljs-string">'lmui-Button'</span>: {
        <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">6</span>,<font></font>
    },<font></font>
    <span class="hljs-string">'lmui-Button-buttonSize-md'</span>: {
        <span class="hljs-attr">paddingTop</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">paddingBottom</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">paddingLeft</span>: <span class="hljs-number">12</span>,
        <span class="hljs-attr">paddingRight</span>: <span class="hljs-number">12</span>,<font></font>
    },<font></font>
    <span class="hljs-string">'lmui-Button-buttonSize-lg'</span>: {
        <span class="hljs-attr">paddingTop</span>: <span class="hljs-number">8</span>,
        <span class="hljs-attr">paddingBottom</span>: <span class="hljs-number">8</span>,
        <span class="hljs-attr">paddingLeft</span>: <span class="hljs-number">16</span>,
        <span class="hljs-attr">paddingRight</span>: <span class="hljs-number">16</span>,<font></font>
    },<font></font>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para componentes web, styleSet √© uma matriz de nomes de classe css que s√£o ‚Äúcolados‚Äù usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classnames</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> biblioteca </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o projeto √© multiplataforma, √© √≥bvio que, com o crescimento da base de c√≥digo, o n√∫mero de depend√™ncias externas tamb√©m aumenta. Al√©m disso, as depend√™ncias s√£o diferentes para cada plataforma. Por exemplo, para componentes da Web, s√£o necess√°rias bibliotecas como loader de estilos, react-dom, nomes de classes, webpack etc. Para componentes nativos do react, um grande n√∫mero de suas bibliotecas "nativas" √© usado, por exemplo, o pr√≥prio nativo do react. Se um projeto no qual ela deve usar a biblioteca de componentes tiver apenas uma plataforma de destino, a instala√ß√£o de todas as depend√™ncias em outra plataforma ser√° irracional. Para resolver esse problema, usamos o gancho p√≥s-instala√ß√£o do pr√≥prio npm, no qual um script foi instalado para instalar depend√™ncias para a plataforma especificada. As pr√≥prias depend√™ncias foram registradas na se√ß√£o correspondente do package.json do pacote,e a plataforma de destino deve ser especificada no projeto package.json como uma matriz.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, essa abordagem revelou uma desvantagem, que posteriormente se transformou em v√°rios problemas durante a montagem no sistema de IC. A raiz do problema foi que, com o package-lock.json, o script especificado em postinstall n√£o instalou todas as depend√™ncias registradas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tive que procurar outra solu√ß√£o para esse problema. A solu√ß√£o foi simples. Foi aplicado um esquema de dois pacotes no qual todas as depend√™ncias da plataforma foram colocadas na se√ß√£o depend√™ncias do pacote de plataforma correspondente. Por exemplo, no caso da web, o pacote √© chamado components-web, no qual existe um √∫nico arquivo package.json. Ele cont√©m todas as depend√™ncias da plataforma web, bem como o pacote principal com componentes componentes. Essa abordagem nos permitiu manter a separa√ß√£o de depend√™ncias e preservar a funcionalidade do package-lock.json.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concluindo, darei um exemplo de c√≥digo JSX usando nossa biblioteca de componentes:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;View row&gt;
   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>
      <span class="hljs-attr">col-xs</span>=<span class="hljs-string">{12}</span>
      <span class="hljs-attr">col-md</span>=<span class="hljs-string">{8}</span>
      <span class="hljs-attr">col-lg</span>=<span class="hljs-string">{4}</span>
      <span class="hljs-attr">col-xl</span>=<span class="hljs-string">{4}</span>
      <span class="hljs-attr">middle-xs</span>
      <span class="hljs-attr">col-md-offset-3</span>
   /&gt;</span></span>
     <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">size</span>=<span class="hljs-string">‚Äùfs1‚Äù</span>&gt;</span>Sample text<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span><font></font>
   &lt;/View&gt;<font></font>
&lt;/View&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse snippet de c√≥digo √© multiplataforma e funciona da mesma maneira em um aplicativo de rea√ß√£o para a Web e em um aplicativo Android em nativo de rea√ß√£o. </font><font style="vertical-align: inherit;">Se necess√°rio, o mesmo c√≥digo pode ser "encerrado" no iOS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, a principal tarefa que nos confrontou foi resolvida - a reutiliza√ß√£o m√°xima das abordagens de design e a base de c√≥digo entre os v√°rios projetos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indique nos coment√°rios que perguntas sobre este t√≥pico foram interessantes de aprender no pr√≥ximo artigo.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt501646/index.html">Go, Vue e 3 dias para desenvolver: um sistema em tempo real para monitorar pacientes</a></li>
<li><a href="../pt501648/index.html">10 extens√µes para o VS Code, sem as quais n√£o posso programar</a></li>
<li><a href="../pt501650/index.html">O que h√° dentro de um arquivo .wasm? Apresentando wasm-decompile</a></li>
<li><a href="../pt501652/index.html">Nuxt como servidor fullstack: servidor API de front-end + back-end (parte 1)</a></li>
<li><a href="../pt501654/index.html">Crie processos de trabalho em um site remoto: recomenda√ß√µes pr√°ticas</a></li>
<li><a href="../pt501658/index.html">Como estabelecer um fluxo de trabalho "√† dist√¢ncia": 7 etapas pr√°ticas</a></li>
<li><a href="../pt501662/index.html">Por que Axure poderia dobrar Sketch e Figma, mas n√£o dobrou</a></li>
<li><a href="../pt501664/index.html">A videoconfer√™ncia agora √© um mercado e novas tecnologias. Longrid, parte dois</a></li>
<li><a href="../pt501668/index.html">Fornecer comunica√ß√µes de objetos e ferramentas em movimento para aumentar sua confiabilidade</a></li>
<li><a href="../pt501670/index.html">Quanto custa a vida ou US $ 2,1 milh√µes por inje√ß√£o: uma maravilhosa terapia gen√©tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>