<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👥 ➰ 🌼 Detect COVID-19 in X-rays with Keras, TensorFlow and Deep Learning 🥅 👉🏾 🚲</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the help of this guide, with the help of Keras, TensorFlow and deep learning, we will learn how to automatically determine COVID-19 from an x-ray...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detect COVID-19 in X-rays with Keras, TensorFlow and Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the help of this guide, with the help of Keras, TensorFlow and deep learning, we will learn how to automatically determine COVID-19 from an x-ray data set manually </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Like so many others, I am sincerely worried about COVID-19. </font><font style="vertical-align: inherit;">I noticed that I’m constantly analyzing my condition and wondering if I will catch the disease and when it will happen. </font><font style="vertical-align: inherit;">And the more I worry about it, the more it turns into a painful game of the mind, in which symptomatology is combined with hypochondria:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I woke up in the morning, feeling some soreness and weakness.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When I crawled out of bed, I found a runny nose (although it is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already known</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that a runny nose is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a symptom of COVID-19).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the time I got to the bathroom to get a paper scarf, I was already coughing.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first I didn’t pay much attention to it - I’m allergic to pollen, and due to the warm weather on the east coast of the United States, this spring was an early spring. </font><font style="vertical-align: inherit;">Most likely, these are allergic symptoms. </font><font style="vertical-align: inherit;">But during the day my condition did not improve. </font><font style="vertical-align: inherit;">I sit and write this manual with a thermometer in my mouth. </font><font style="vertical-align: inherit;">I look down and see 37.4 ° C. </font><font style="vertical-align: inherit;">My normal body temperature is slightly lower than others, at 36.3 ° C. </font><font style="vertical-align: inherit;">Everything above 37.2 ° C is already a little heat for me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cough and slight fever? </font><font style="vertical-align: inherit;">It could be COVID-19 ... or just my allergy. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is impossible to find out without testing, and it is precisely this “ignorance” that makes the situation so intimidating on a human level.</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UFO Care Minute</font></font></h3><br>
     COVID-19 —     ,   SARS-CoV-2 (2019-nCoV).        —    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite my fears, I try to think rationally. I am a little over 30, I am in great shape, and my immunity is strong. I’ll put myself in quarantine (just in case), rest and deal with everything. COVID-19 doesn’t scare me from the point of view of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> health (at least I’ll stand it for myself). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, I worry about my elderly relatives, including all those who have already been diagnosed with the disease, as well as those who are in nursing homes and hospitals. These people are vulnerable, and it will be terrible if they die due to COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instead of doing nothing and letting my ailment keep me at home (be it allergy, COVID-19 or my fears), I decided to do what I can:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I’ll write the code, conduct experiments and, using practical examples, teach others how to use computer vision and deep learning</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I must say right away that this is </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> most scientific article written by me. </font><font style="vertical-align: inherit;">She is not scientific at all. </font><font style="vertical-align: inherit;">The methods and datasets used are </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> worth publishing. </font><font style="vertical-align: inherit;">But they serve as a starting point for those who want at least </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">something to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> help. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I am worried about you and this community. </font><font style="vertical-align: inherit;">I want to help what I can: this article is my way to mentally cope with difficult times, while helping others in a similar situation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this guide you will learn:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to collect opensource-dataset of X-ray images of patients with detected COVID-19.</font></font></li>
<li>   «» (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I have already hinted at this, but now I will say directly. </font><font style="vertical-align: inherit;">The techniques described here are for educational purposes only. </font><font style="vertical-align: inherit;">This is </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not a</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rigorous scientific study; it will not be published in journals. </font><font style="vertical-align: inherit;">This article is for readers who are interested in computer vision and deep learning, who want to learn in practice, as well as for those who are inspired by current events. </font><font style="vertical-align: inherit;">I ask you to take all this into account. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the first part of the manual, we will discuss how to detect COVID-19 in lung x-rays. </font><font style="vertical-align: inherit;">Then we discuss the dataset itself. </font><font style="vertical-align: inherit;">And then I will show how to train the model using Keras and TensorFlow to predict COVID-19 in our images.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explanation</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This COVID-19 auto-detection article is written for educational purposes only. It </font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does not</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> describe a reliable and accurate diagnostic system COVID-19, has not been tested neither from a professional nor from an academic point of view.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
My goal is to inspire you and show how the study of computer vision and deep learning with the subsequent application of this knowledge in the medical field can have a big impact on the world. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you do not need a medical education to influence medicine</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Deep training practitioners today work closely with doctors and other doctors in solving complex problems, save lives and make the world a better place. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope my leadership inspires you to do so.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But considering all the above, researchers, magazine curators and the review system are already overloaded with works that describe COVID-19 forecasting models of dubious quality. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please do not send the code and model from this article to a journal or some scientific publication - you will only increase the chaos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, if you want to conduct research on the basis of this article (or any other publication about COVID-19), then stick to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRIPOD guide for describing predictive models.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As you understand, the use of artificial intelligence in the medical field can have very serious consequences. Publish and use such models only if you are a medical specialist or if you have been advised in detail by such specialists.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How can COVID-19 be detected in x-rays?</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 1:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Example X-ray of a patient diagnosed with COVID-19. </font><font style="vertical-align: inherit;">In these images, you can teach the classifier using Keras and TensorFlow to determine COVID-19. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testing for COVID-19 is now difficult - there are</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not enough tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but it is impossible to quickly produce them, which only increases panic. </font><font style="vertical-align: inherit;">And in a panic, there are scoundrels who are trying to cash in on others</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and sell fake tests on COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> finding themselves unsuspecting victims in social networks and instant messengers. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Given the limited number of tests, we need to rely on other diagnostic methods.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I decided to study X-rays, because doctors often use them and CT scans to diagnose pneumonia, pulmonary inflammation, abscesses and enlarged lymph nodes. Since the virus attacks the epithelial cells that line the respiratory tract, we can use X-rays to study the condition of the human lungs. And since X-ray machines are almost everywhere, using the images you can detect COVID-19 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> test kits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The disadvantages of the method include the need for radiologists, as well as a significant processing time. And time is especially expensive when people are sick all over the world. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And to save doctors time, you need to create an automatic analysis system</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note:</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the left are pictures of people with a positive result (infected), on the right - with a negative. </font><font style="vertical-align: inherit;">In these images, we will teach the model using TensorFlow and Keras to automatically predict the presence of COVID-19 (that is, a disease resulting from coronavirus). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The dataset of patient images used with COVID-19 used here was compiled under the supervision of</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a graduate student at the University of Montreal. </font><font style="vertical-align: inherit;">A few days ago, Cohen began collecting X-ray images of patients with COVID-19 and uploading them</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the GitHub repository. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There you will find examples of not only this disease, but also MERS, SARS and ARDS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create a dataset I:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parse the metadata.csv file from the repository.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selected all the lines:</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In total, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 shots</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> were obtained </font><strong><font style="vertical-align: inherit;">with positive results on COVID-19</font></strong><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">left</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now choose the pictures of healthy people.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
To do this, I took a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaggle's lung X-ray dataset (pneumonia)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and selected </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 healthy people images</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">right</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). This dataset has a number of drawbacks, including badly or incorrectly filled labels, but it is suitable as a starting point for testing the hypothesis of the COVID-19 detector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, I got </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 shots:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25 patients with COVID-19 and 25 healthy. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can download the dataset from the </font></font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In addition, I added Python scripts with which I generated the dataset, but in this article I did not consider them.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project structure</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the code and data. </font><font style="vertical-align: inherit;">Pull out the files from there, and you get the following directory structure:</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [<span class="hljs-number">25</span> entries]<font></font>
│   └── normal [<span class="hljs-number">25</span> entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Three directories, five files. </font><font style="vertical-align: inherit;">The dataset lies in the dataset / directory and is divided into two classes - covid / and normal /. </font><font style="vertical-align: inherit;">Below we look at the train_covid19.py script that trains our COVID-19 detector.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Training script implementation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's move on to fine-tuning the convolutional neural network, which will automatically diagnose COVID-19 using Keras, TensorFlow, and deep learning. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Open the train_covid19.py file and paste the following code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This script takes advantage of TensorFlow 2.0 and Keras libraries by selecting tensorflow.keras imports. </font><font style="vertical-align: inherit;">Also we use:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , this is a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de facto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python machine learning library,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for charting,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for uploading and preprocessing images in a dataset.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To learn how to install TensorFlow 2.0 (including scikit-learn, OpenCV and matplotlib), check out my tutorials for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we parse the arguments for the command line and initialize the hyperparameters:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our three </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">command line arguments</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 24-31</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) include:</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: path to the input dataset.</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: optional path to the exit schedule of learning history. </font><font style="vertical-align: inherit;">By default, the graph is called plot.png unless a different name is specified on the command line.</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: optional path to our output COVID-19 definition model. </font><font style="vertical-align: inherit;">By default, it is called covid19.model.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we initialize the initial learning frequency, the number of training eras, and the packet size hyperparameters ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 35-37</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, download and pre-process the x-rays:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To load the data, we take all the paths to the images in the --dataset directory ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">line 42</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), and then for each imagePath:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We extract from the path ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">line 49</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) the class label (covid or normal).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We load the image, convert it to RGB channels and reduce it to a size of 224x224 pixels to feed a convolutional neural network ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 53-55</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Updating lists of data and labels ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 58 and 59</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then we scale the pixel intensity into a range </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and convert the data and labels to the NumPy array format ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 63 and 64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we will perform one-hot-coding of our labels and divide the dataset into training and test sets:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unitary label coding is performed in </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 67-69</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : the data will be presented in this format:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each label encoded in this way consists of a two-element array, in which one of the elements is “hot” (1) and the second is “no” (0). In </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 73 and 74, the</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dataset is divided into two parts: 80% for training, 20% for testing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To generalize the model, we perform </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data expansion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (data augmentation), setting a random image rotation by 15 degrees clockwise or counter it. The extension generation object is initialized on </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 77-79</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now initialize the VGGNet model and prepare it for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fine tuning</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 83 and 84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , an instance of the VGG16 neural network is created with the weights obtained in advance on ImageNet without a fully connected layer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we will create a fully connected layer consisting of POOL =&gt; FC = SOFTMAX layers ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and place it on top of VGG16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">line 97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now freeze CONV-weights so that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">only a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fully connected layer is </font><font style="vertical-align: inherit;">trained </font><font style="vertical-align: inherit;">( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 101-102</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). This finishes tuning. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we are ready to compile and train our deep learning model:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 106-108</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compiled network </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attenuation speed training</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and optimizer Adam. Given that this is a two-class classification task, we use the loss function of binary cross-entropy (binary_crossentropy), not categorical cross-entropy (categorical crossentropy). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To start the training we call Keras-method </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fit_generator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and give him our X-rays through a data object extension ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 112-117</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's evaluate the model:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, we first perform forecasting based on the test suite and obtain forecast indices ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 121-125</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Then we will generate and display the classification report ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 128 and 129</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">using the scikit-learn utility </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's calculate the confusion matrix for future statistical estimation:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We are here:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generate a matrix of inaccuracies ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">line 133</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we use this matrix to determine the accuracy, sensitivity and specificity ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 135-137</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), and then we derive all these metrics ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lines 141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then, for subsequent analysis, we display in the form of a graph in a file the history of accuracy and loss changes:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And finally, we serialize the tf.keras classifier model to disk:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We train our detector with Keras and TensorFlow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the implementation of the train_covid19.py script, we can train the automatic detector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the source code, dataset and pre-trained model. </font><font style="vertical-align: inherit;">Open a terminal and run the command to train the detector:</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auto X-ray Diagnostics</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in this part we do not "solve" the problem of determining COVID-19. It is written in the context of the current situation and only for educational purposes. This is an example of the practical application of computer vision and deep learning, so that you get comfortable with different metrics, including the usual accuracy, sensitivity and specificity (and trade-offs that must be considered when working with medical data). I repeat, we </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do not solve the</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> problem of determining COVID-19.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, our automatic detector showed an accuracy of</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ~ 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on samples of</font><font style="vertical-align: inherit;">X-ray images</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alone</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No other information was used to train the model, including geographic location, population density, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also received</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensitivity of 100%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">specificity of 80%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which means:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of the patients </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (true positive cases), using the model, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we were able to accurately identify as “COVID-19 positive” in 100% of cases.</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of the patients who </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">did not have</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (true negative cases), using the model, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we were able to accurately identify as “COVID-19-negative” in only 80% of cases.</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As the training history graph shows, the neural network is not retrained, despite the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">very small</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> size of the training data:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 3:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This graph of accuracy and loss demonstrates that our model is not retrained.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
It’s great that we achieved 100% accuracy when detecting COVID-19. However, the situation with truly negative cases is embarrassing:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we do not want to attribute to “COVID-19-negative” those who are actually “COVID-19-positive”.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We least want to let sick patients go home, to families and friends, contributing to the further spread of the disease.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You also need to be</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> very careful</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the share of false-positive cases:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we do not want to mistakenly count someone as sick and quarantine him with other patients so that he gets infected from them</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finding a balance between sensitivity and specificity -</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an extremely difficult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> task, especially when it comes to medicine, and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especially</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> when it comes to rapidly spreading infectious diseases. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speaking about medical computer vision and deep learning, you should always remember that the work of our predictive models can have very serious consequences: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erroneous diagnoses can cost lives</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I repeat, the results in this article are presented </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for educational purposes only</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is not a journal publication, this data does not meet the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">TRIPOD</font></a><font style="vertical-align: inherit;"> criteria </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for the publication of forecast models.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitations, improvements and further work</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 4:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Today, AI and deep learning professionals lack quality COVID-19 data to effectively train automatic image recognition systems.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
One of the main limitations of the method described in this manual is data.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We do not have enough (reliable) data to train COVID-19 detectors.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Hospitals already have many case histories with this virus, but given privacy and human rights, it becomes even more difficult to quickly assemble a high-quality dataset from medical images. I believe that in the next 12-18 months we will have more quality data. But for now, you have to use what you have.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I tried (given my physical and mental condition) in the conditions of limited time and resources to write this guide for those who are interested in the use of computer vision and deep learning. But </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">let me</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> remind you that </font><strong><font style="vertical-align: inherit;">I am not a professional medic</font></strong><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to use the COVID-19 detector in real life, it has to be </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rigorously</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tested by real doctors working hand in hand with deep learning specialists. The method I described is not suitable for this. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moreover, one must be careful with what exactly the model “learns”.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As I wrote in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Grad-CAM manual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it is likely that the model will learn patterns that are not relevant to COVID-19, but only be able to distinguish between two data samples (i.e., positive and negative diagnoses). The results of our detector will need to be rigorously tested and checked by doctors. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally, future (and more advanced) detectors will be multimodal.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now we use only visual data (x-rays). Better detectors should use other data: patient vital indicators, population density, geographical location, etc. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visual data alone is usually not enough for such tasks</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For these reasons, I want to emphasize again: this guide only plays the role of training material - it cannot be considered as a reliable COVID-19 detector. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you think that you or someone close to COVID-19, then follow the recommendations of your healthcare system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope this guide has been helpful to you. </font><font style="vertical-align: inherit;">I also hope that it will be for someone a starting point in the search for methods of using computer vision and deep learning to automatically determine COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this guide, you learned how to use Keras, TensorFlow, and deep learning to create a COVID-19 automatic detector on an x-ray dataset. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today (yet) there are no high-quality and verified image datasets for this disease, so you have to work with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Joseph Cohen repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We took 25 images from his</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dataset </font><strong><font style="vertical-align: inherit;">,</font></strong><font style="vertical-align: inherit;"> limiting ourselves to the anteroposterior projection of positively diagnosed cases.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then we took 25 pictures of healthy people</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaggle Chest X-Ray Images (Pneumonia) dataset.</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then with the help of Keras and TensorFlow we trained the COVID-19 detector, which showed an </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accuracy of 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on our test sample, with a sensitivity of 100% and a specificity of 80% (on our small dataset). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remember that the detector described here is for educational purposes only (see Note in text). </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I wanted to inspire other people to use deep learning, to show that in combination with computer vision it can have a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big impact</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on our lives. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope you enjoyed it.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493596/index.html">The man who was in no hurry</a></li>
<li><a href="../en493598/index.html">Hide part of the phone number</a></li>
<li><a href="../en493604/index.html">Digital events in Moscow from March 23 to 29</a></li>
<li><a href="../en493606/index.html">The history of creating a cloud service flavored with cyberpunk</a></li>
<li><a href="../en493610/index.html">Programming a video layer in a Raspberry Pi using the DispmanX API</a></li>
<li><a href="../en493616/index.html">Pictures like boxes - what's inside? Report in Yandex</a></li>
<li><a href="../en493618/index.html">(Not) obvious OSINT on Twitter</a></li>
<li><a href="../en493620/index.html">Logistic curve. When will the epidemic end?</a></li>
<li><a href="../en493622/index.html">Writing a Retrowave to Angular</a></li>
<li><a href="../en493626/index.html">Selenoid - Hundreds of parallel UI tests easy and fast. Pavel Senin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>