<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👨🏻 🤹🏻 🤦🏿 アクティブリストア：災害復旧を高速化できますか？はるかに高速？ 🚶🏻 🕢 ▫️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="重要なデータのバックアップは良いです。しかし、作業をすぐに継続する必要があり、毎分が重要な場合はどうでしょうか。アクロニスでは、システムを起動するタスクを可能な限り迅速に解決することの可能性を確認することにしました。そして、これはアクティブリストアシリーズの最初の投稿で、イノポリス大学と一緒にプロジ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>アクティブリストア：災害復旧を高速化できますか？はるかに高速？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/477658/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要なデータのバックアップは良いです。しかし、作業をすぐに継続する必要があり、毎分が重要な場合はどうでしょうか。アクロニスでは、システムを起動するタスクを可能な限り迅速に解決することの可能性を確認することにしました。そして、これはアクティブリストアシリーズの最初の投稿で、イノポリス大学と一緒にプロジェクトをどのように開始したか、私たちが見つけたソリューション、そして現在取り組んでいることをお伝えします。詳細-カットの下。</font></font><br>
<br>
<img src="https://shydyrond.ru/backend/uploads/Kak%20uvelichit%27%20skorost%27%20raboty%20komp%27yutera/kak-uvelichit-skorost-raboty-kompyutera.jpg" alt="画像"><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こんにちは！私の名前はDaulet Tumbaevです。本日は、災害復旧を促進するシステムの開発における私の経験をお伝えしたいと思います。プロジェクトの全体的な開発パスについて話すために、少し遠くから始めましょう。私は現在アクロニスに勤務していますが、ソフトウェア開発管理の修士プログラム（MSIT-SE）を卒業したイノポリス大学も卒業しています。イノポリスは若い大学で、カリキュラムはさらに若いです。しかし、それは、カーネギーメロン大学（カーネギーメロン大学）のカリキュラムに基づいて構築されており、その成果として、産業プロジェクトなどのトピックがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
産業プロジェクトの目的は、学生を実際の開発に没頭させ、実践で得た知識を統合することです。</font><font style="vertical-align: inherit;">これを行うために、大学はYandex、Acronis、MTCなど数十社と協力しています（合計で、大学には2018年に144のパートナーがいました）。</font><font style="vertical-align: inherit;">協力の過程で、企業は大学に彼らの仕事の方向性を提供し、学生は彼らの興味と訓練のレベルで彼らに近いプロジェクトの1つを選びます。</font><font style="vertical-align: inherit;">ちょうど2年前、私はまだ「バリケードの向こう側」にいて、学生として別のアクロニスプロジェクトで働いていました。</font><font style="vertical-align: inherit;">しかし、今回は会社側の学生の技術コンサルタントになり、アクティブリストアプロジェクトをイノポリスに提案しました。</font><font style="vertical-align: inherit;">Active Restoreのアイデアは、Acronisのカーネルチームによって策定されましたが、ソリューションの開発はイノポリス大学で始まりました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクティブリストア-なぜこれが必要なのですか？</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
伝統的に、災害復旧は標準的なスキームに従って機能します。コンピュータに問題が発生した後、Acronis True ImageなどのバックアップシステムのWebインターフェイスに移動し、大きな「復元」ボタンをクリックします。次に、N分間待つ必要があります。その後、作業を​​続けることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lr/qz/at/lrqzata7ct47-wrmeeiqxvrnoq8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、RTO（リカバリー時間目標）としても知られるこの数値N、許容可能なリカバリー時間は、マシンのハードドライブのボリュームと接続速度（クラウドからのリカバリーが発生した場合）に依存して、非常に印象的である可能性があることです。他の多くの要因。</font><font style="vertical-align: inherit;">減らせますか？</font><font style="vertical-align: inherit;">はい、可能です。作業を再開するために、必ずしも完全なコンピュータディスクが必要なわけではありません。</font><font style="vertical-align: inherit;">同じ写真やビデオがデバイスの機能に影響を与えることはなく、後でバックグラウンドでプルアップできます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドライバーが必要...</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オペレーティングシステムは、完全に完成したディスクから開始することを想定しています。したがって、Windowsは一連のディスク整合性チェックを実行します。システムは、OSが検出することを期待している一部のファイルが存在しないか破損している場合、通常の起動を許可しません。この問題を解決するために、私たちが作成したいわゆるリダイレクタファイルをディスクに置くことにしました。これは、欠落または破損したファイルを置き換えますが、実際にはダミーです。そのようなリダイレクタを作成することは、実際にはコンテンツがないため、それほど長くはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようにさらに回復します。バックグラウンドプロセスでは、オペレーティングシステムの操作と並行して、「ダミー」にデータが入力されます。バックグラウンドリカバリプロセスでは、ディスクの負荷が考慮され、設定された制限を超えません。ただし、ユーザーまたはオペレーティングシステム自体が、まだ存在しないファイルを突然要求する場合があります。ここで、2番目の回復モードが登場します。要求されたファイルの優先度が最大に引き上げられ、リカバリプロセスによってファイルがディスクに緊急にアップロードされます。オペレーティングシステムは、少し遅れますが、目的のファイルを受信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは完璧な絵のように見えます。</font><font style="vertical-align: inherit;">ただし、現実の世界では、多くの落とし穴と潜在的なデッドロックがあります。</font><font style="vertical-align: inherit;">私たちはイノポリスの学部生とともに、この回復シナリオを調査し、RTOでの勝利を評価し、このアプローチが実装されるかどうかを理解することにしましたか？</font><font style="vertical-align: inherit;">実際、そのような市場での決定は、当時は存在していませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、サービスコンポーネントをInnopolisの人たちに譲ることを決心した場合、Acronisの内部では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミニフィルターファイルシステムドライバーの開発</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が始まりました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、Windowsカーネルチームによって行われました。</font><font style="vertical-align: inherit;">計画はこれでした：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSの起動の早い段階でドライバーを実行し、 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">運用中、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザースペース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が完全に準備できたら、サービスをダウンロードします</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービスは、ドライバーの要求を処理し、その後の作業を調整します。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/2a/vl/qf/2avlqfvl30ekh3xdix5xjwjggdu.jpeg"><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドライバーエンジニアリングの機微</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の同僚がこのサービスについて別の投稿で話す場合、このテキストではドライバー開発の複雑さを明らかにします。すでに開発されているドライバーミニフィルターには、システムが通常モードで起動したときと、システムで障害が発生して回復したときの2つの動作モードがあります。ユーザーライブラリとアプリケーション、つまりサービスをロードする前に、ドライバーは同じように動作します。彼はシステムが現在どの状態にあるのか知りません。その結果、作成、読み取り、書き込みがログに記録され、すべてのメタデータが記録されます。そして、サービスがオンラインのとき、ドライバーはこの情報をサービスに提供します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/x4/x0/0c/x4x00ccpfivzeboam8r6zdvx4re.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常の起動の場合、サービスは「Relax」信号をドライバーに送信し、ドライバーが「リラックス」してすべてのデータの不正なロギングを停止するようにします。この場合、ドライバはディスク上の変更のみをログに記録するように切り替え、それらをサービスに報告します。サービスは他のアクロニスツールを使用して、ユーザーが定義したメディア上のディスクバックアップを最新の状態に維持します。これは、クラウド、リモート、段階的、または夜間のバックアップです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/34/he/x1/34hex17zyywzzuv7rlivamn46e0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リカバリーモードがアクティブになっている場合、サービスはドライバーに「リカバリー」モードで動作する必要があることを通知します。システムは障害の直後に回復し、ディスク上のファイルを開く要求が出されるとすぐに、ミニフィルターはこの操作をインターセプトし、この要求自体を行い、ディスク上にそのようなファイルがあるかどうか、およびそれを開くことができるかどうかを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルがない場合、ミニフィルターはこの情報をサービスに転送します。これにより、ファイルリカバリの優先度が高くなります（今のところ、リカバリが進行中です）。このファイルは単にキューの先頭にジャンプすることがわかりました。その後、サービス自体（または他のアクロニスツール）がこのファイルを復元し、すべてが正常であることをドライバーに通知します。これで、オペレーティングシステムがファイルにアクセスでき、ドライバーはシステムからディスクに元の要求を「解放」します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リカバリーが不可能な場合、サービスはドライバーにバックアップにファイルがないことも通知します。</font><font style="vertical-align: inherit;">ミニフィルタードライバーはシステムリクエストをスキップするだけで、元のリクエスター（OS自体またはアプリケーション）は「ファイルが見つかりません」エラーを受け取ります。</font><font style="vertical-align: inherit;">ただし、ファイルが実際にはディスク上およびバックアップ内になかった場合、これは非常に正常です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yv/8w/qe/yv8wqetbjrg3kq2hkr2vosj8dve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ファイルやライブラリの読み取りはいくつかの段階で行われ、場合によってはリモートリソースにアクセスできるため、オペレーティングシステムの動作ははるかに遅くなります。</font><font style="vertical-align: inherit;">しかし、ユーザーは回復がまだ行われている間、できるだけ早く作業に入ることができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より低く、さらに低くする必要があります...</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロトタイプはその価値を証明しています。しかし、場合によってはデッドロックが依然として発生するため、先に進む必要があることもわかりました。たとえば、オペレーティングシステムは、いくつかのスレッドでさまざまなライブラリを要求する場合があり、それにより、サービス自体の閉鎖につながります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在取り組んでいる問題は、Active Restoreの速度を上げ、システムのセキュリティレベルを上げることです。システムがファイル全体を必要とせず、ファイルの一部のみが必要であるとします。このために、ディスクフィルタードライバーという別のドライバーが開発されました。ファイルではなくブロックレベルで機能します。操作の原理は似ています。通常の操作では、ドライバーは変更されたブロックをディスクに記録するだけで、リカバリモードでは、自分でブロックを読み取ろうとします。障害が発生した場合は、優先度を上げるようにサービスに要求します。ただし、システムの他の部分はすべて同じままです。たとえば、OSレベルのサービスは、他のドライバーと通信するために提供されていることを疑うこともありません。主なタスクは、OSが機能するために必要なデータを正確に提供することです。サービスがブロックレベルでどのように考えるかまだわからない場合に限り、この方向性には大幅な改善が必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のステップでは、ドライバーをより深く、より早く実行し、サービスではなくUEFIドライバーとネイティブWindowsアプリケーションのレベルまで下げました。</font><font style="vertical-align: inherit;">このため</font><font style="vertical-align: inherit;">に、OSが起動する前に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起動して終了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">UEFIブートドライバー</font></a><font style="vertical-align: inherit;">（またはDXEドライバー）</font><font style="vertical-align: inherit;">が開発されました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、UEFIドライバーの「履歴」、アセンブリとインストールの詳細、およびWindowsネイティブアプリケーションの詳細については、次の投稿で検討します。</font><font style="vertical-align: inherit;">だから私たちのブログを購読してください、そして今のところ私は仕事の次の段階についての物語を準備します。</font><font style="vertical-align: inherit;">コメントや提案をお待ちしています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja477644/index.html">UNIX v0からPDP-7への復元：バックルームの詳細</a></li>
<li><a href="../ja477646/index.html">数学者は方程式の一部を求めて数字を切り取る</a></li>
<li><a href="../ja477650/index.html">Stunnelを使用したGOST-2012アルゴリズムによるTLSトラフィックの暗号化</a></li>
<li><a href="../ja477654/index.html">Java 14で改善されたinstanceofオペレーターを試す</a></li>
<li><a href="../ja477656/index.html">それでも、なぜmakeが必要なのですか？</a></li>
<li><a href="../ja477662/index.html">FTDIブリッジ上のReddタイヤへのアクセス</a></li>
<li><a href="../ja477668/index.html">11月29日午後6時-devleads-mitap</a></li>
<li><a href="../ja477670/index.html">テストを自動化するもの</a></li>
<li><a href="../ja477672/index.html">チームメンバーの権利と義務：法的および文化的側面</a></li>
<li><a href="../ja477674/index.html">AIは愛を意味しますか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>