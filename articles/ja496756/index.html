<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬛️ 🧙🏿 🏕️ 実際のAWS Lambda。パート2：開発およびテストツールについて理解する 🚇 👩🏼‍🤝‍👨🏻 🌍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="このガイドは、サーバーレスアプリケーションの開発とテスト、および松葉杖と自転車をテストする際の操作に関する個人的な経験の結果です。サーバーレスアプリケーションの開発を始めたとき、手ですべてを理解する必要がありました。ローカルでの開発とテストのための明確なガイドや便利なツールはありませんでした。
 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>実際のAWS Lambda。パート2：開発およびテストツールについて理解する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/496756/"><img src="https://habrastorage.org/webt/7w/hp/bb/7whpbbwttpekzxdq4-7sgs28rio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドは、サーバーレスアプリケーションの開発とテスト、および松葉杖と自転車をテストする際の操作に関する個人的な経験の結果です。サーバーレスアプリケーションの開発を始めたとき、手ですべてを理解する必要がありました。ローカルでの開発とテストのための明確なガイドや便利なツールはありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、状況は変化しています。ツールが登場し始めていますが、使用するためのマニュアルを見つけるのは容易ではありません。この記事では、新しい機能を使用する方法を簡単な例で示します。あなたはそれを簡単に習得して、私が遭遇した「ラッキー」だった問題やバグを回避することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS、SAM-CLI、およびIntelljIDEAブラウザコンソールを使用して開発する方法を学びます。</font><font style="vertical-align: inherit;">テストについても話します。統合、E2E、ユニットテストです。</font><font style="vertical-align: inherit;">そして最後に、そのようなソリューションにかかる費用について説明します（ネタバレ：コストを大幅に節約できます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は、サーバーレスアプリケーションの開発を開始し、そのツールやアプローチにまだ慣れていない場合に役立ちます。</font></font><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何が議論される</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
みなさん、こんにちは！</font><font style="vertical-align: inherit;">私の名前はAlexander Gruzdevです。AWSLambdaに基づくサーバーレスソリューションの使用と開発に関する記事の2番目の部分を提示できることを嬉しく思います。</font><font style="vertical-align: inherit;">続編では、最初の部分からソリューションを開発およびテストする方法について説明します（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda in Action in Java11。私たちは「プロダクション」でサーバーレスにアクセスします</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回の記事の公開以降、テストアプリケーションは少し再設計されましたが、主な意味は変わりません。</font><font style="vertical-align: inherit;">これは、HTTPリクエストを介してフォームからGateway APIにデータを送信する簡単なContact Us HTMLフォームであり、処理リクエストをAWS Lambdaにプロキシします。</font><font style="vertical-align: inherit;">処理中、ラムダはDynamoDBテーブルにデータを書き込み、AWS SESを通じてレターを送信します。</font><font style="vertical-align: inherit;">コンポーネント図を以下に示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/zp/wd/aczpwdfofm_vp7xqrjdis2gsblu.png" alt="コンポーネント図"><br>
<br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></h1><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWSブラウザコンソールを使用した開発</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAM-CLIを使用した開発</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IntelljIDEAを使用した開発</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストのタイプ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーレスコスト</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></a></li>
</ol><br>
<br>
<a name="Part1"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. AWSブラウザーコンソールを使用した開発</font></font></h1><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWSコンソール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWSコンソールは、仮想EC2サーバー、IAMまたはAWS Lambdaロール/アクセスポリシー設定など、AWSサービスへのアクセスを提供します。継続的デリバリー/継続的デプロイメントシステムを介して再デプロイすることなく、リアルタイムで変更できるすべてのパラメーターがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、開発プロセスと一部の種類のテストが大幅にスピードアップします。</font><font style="vertical-align: inherit;">また、アプリケーションの起動および操作パラメーターを視覚的に制御するのにも役立ちます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIゲートウェイコンソール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールを使用すると、アプリケーションの現在の状態を監視し、環境を管理して、新しいバージョンを配信できます。</font><font style="vertical-align: inherit;">これを使用して環境の状態を確認する方法を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
お問い合わせアプリケーションの[リソース]タブのスクリーンショットで、この「マジック」コンソールがどのように見えるかを見てみましょう</font><font style="vertical-align: inherit;">
。スクリーンショットは、ゲートウェイAPIを介したクライアントからのリクエストがラムダに入る方法と、POSTメソッドによって/連絡先リソースが呼び出されたときにクライアントに応答が返される方法を示しています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/f7/fe/s2/f7fes2uz9qxcpj9dqmko6zuxalc.png" alt="ゲートウェイリソース"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドリクエスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">リクエスト</font></i><font style="vertical-align: inherit;">を処理する最初のステップ。</font><font style="vertical-align: inherit;">この例では、設定は含まれていませんが、たとえば、許可の設定が含まれている場合があります。</font></font><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合リクエスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とは、HTTPリクエストが特別な形式でラムダに送信されることを意味します。クライアントから送信されたすべての情報と、呼び出されたコンテキストに関する詳細が含まれます。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合応答</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、HTTPクライアントがラムダから直接応答を受信することを示しています。</font><font style="vertical-align: inherit;">したがって、ラムダでの応答本体の形成は、ご自身で行う必要があります。</font></font></li>
</ul><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロキシ統合を無効にする</font></font></b>
                        <div class="spoiler_text">     API Gateway  ,    <i>Use Lambda Proxy integration</i>   <i>Integration Request</i>.          . ,          ,     .<br>
<br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合リクエストサンプル</font></font></b>
                        <div class="spoiler_text">    SAM init      <i>events</i>,     ,      <i>Integration request</i>.    ,   AWS    ,     .         AWS Lambda.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TESTボタンを押して、アプリケーションが機能していることを確認します。</font><font style="vertical-align: inherit;">これにより、HTTPゲートウェイAPI呼び出しにアクセスできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のスクリーンショットでは、ラムダをウォームアップするリクエストを送信しました：</font><font style="vertical-align: inherit;">
リクエストへの応答に加えて、Gateway APIは詳細なログを表示します。</font><font style="vertical-align: inherit;">同様に、JSONリクエストの本文を次の形式で置き換えることにより、実際のリクエストを行うことができます。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ia/kf/ga/iakfgafb8t4-9aocr5o-e5dspy0.png" alt="ゲートウェイテスト要求"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<pre><code class="javascript hljs">{
    <span class="hljs-string">"subject"</span>: <span class="hljs-string">"Email subject"</span>,
    <span class="hljs-string">"question"</span>: <span class="hljs-string">"Your question…"</span>,
    <span class="hljs-string">"username"</span>: <span class="hljs-string">"Your name…"</span>,
    <span class="hljs-string">"phone"</span>: <span class="hljs-string">"Your phone…"</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"Your email…"</span><font></font>
} <font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、UIフォームやフロントエンドアプリケーションを使用せずにAPIを手動でテストできるため、フロントエンド開発とバックエンド開発を分離できます。</font><font style="vertical-align: inherit;">組み込みのコンソールの代わりに、Postmanまたはその他のHTTPクライアントを使用できます。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替としての郵便配達</font></font></b>
                        <div class="spoiler_text">   HTTP-     Postman.         .   ,   API Gateway       AWS ,              API. ,  ,       AWS .<br>
</div>
                    </div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラムダコンソール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストと開発では、ゲートウェイAPIを介したリクエストに加えて、AWS Lambdaブラウザコンソールを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画面はいくつかのブロックに分かれています：</font></font><br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Designer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は既存のトリガーとレイヤーを表示します。</font><font style="vertical-align: inherit;">私たちの場合、トリガーはAPI Gatewayです。</font><font style="vertical-align: inherit;">これをクリックすると、URL、ステージ、リソースパスなど、必要なすべての情報が開きます。</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エイリアス</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（特定のラムダエイリアスを選択するときに使用可能）を使用すると、ラムダのバージョンごとにトラフィックの分散を構成できます。</font><font style="vertical-align: inherit;">これについては次の段落で詳しく説明します。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png"></a></li>
<li><i>Function code</i> —        .      zip-  ,    .       ,   Function code      .         Python/NodeJs. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/1l/p1/0y/1lp10yo_zd7tcbcr7cyu-dyxtlw.png"></a></li>
<li><i>Environment variables.</i> ,      .  ,        ,     .    ,         . ,    ,        .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/hx/sg/z_/hxsgz_-adludvt4phrfgebnjqa4.png"></a></li>
<li><i>Tags</i> —  ,       , ,    ,    .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/qm/za/bt/qmzabtb2nt-yo9tedqlxluhop8e.png"></a></li>
<li><i>Execution role</i> —      (   ) ,      .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/bf/rk/3s/bfrk3sw8ig7rseuhnwr4mr8o8-c.png"></a></li>
<li><i>Basic settings</i> —         .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ds/lr/cj/dslrcjorhygk_bmfzlxp5ddxqz0.png"></a></li>
<li><i>Network</i>:      -  ,          VPC.    —   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  .</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/-i/lz/hm/-ilzhms_ty6b7i7pex7pc1dbcbw.png"></a></li>
<li><i>AWS X-Ray</i>   .           AWS-. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/pj/l6/qz/pjl6qzbt3133iqwonql03wd96qs.png"></a></li>
<li><i> Reserve concurrency</i>     ,                  .          .<br>
   Provisioned concurrency</li>
<li><i>Provisioned concurrency</i> —    .       ,          .     ,     —    .          Free Tier .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/mb/gt/sq/mbgtsqv1iueoy6js88rv4rusi7s.png"></a></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非同期呼び出しで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、非同期要求の特別な処理を構成できます。</font><font style="vertical-align: inherit;">エラーが発生した場合に行う呼び出しの繰り返し数と、リクエストがキューでハングする時間を示します。</font><font style="vertical-align: inherit;">オプションで、失敗した要求を処理するためのキューを指定できます。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/fp/g_/zi/fpg_ziuv-ouv4yeeejmxqlko-za.png"></a><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースプロキシ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、API Gateway + Lambdaの形式でプロキシを介してデータベースへのアクセスを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定できるようにする</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう1つの新機能です</font><font style="vertical-align: inherit;">。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/bp/f4/fw/bpf4fw1yjd0ayzsolj0vbhnjrfs.png"></a></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、このコンソールから開発する方法を見てみましょう。</font><font style="vertical-align: inherit;">パラメータの変更に加えて、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストイベント</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">構成</font></i><font style="vertical-align: inherit;">機能</font><font style="vertical-align: inherit;">を使用して、テストリクエストを作成できます。</font><font style="vertical-align: inherit;">かなり広範なリストが利用可能ですが、私はプロジェクトですでに添付したものを利用します。</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ContactUsリクエスト</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs">{
  <span class="hljs-string">"body"</span>: <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span>: <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"path"</span>: <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"isBase64Encoded"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"queryStringParameters"</span>: {
    <span class="hljs-string">"foo"</span>: <span class="hljs-string">"bar"</span><font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span>: {
    <span class="hljs-string">"proxy"</span>: <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"stageVariables"</span>: {
    <span class="hljs-string">"baz"</span>: <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"headers"</span>: {
    <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,
    <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, sdch"</span>,
    <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.8"</span>,
    <span class="hljs-string">"Cache-Control"</span>: <span class="hljs-string">"max-age=0"</span>,
    <span class="hljs-string">"CloudFront-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span>,
    <span class="hljs-string">"CloudFront-Is-Desktop-Viewer"</span>: <span class="hljs-string">"true"</span>,
    <span class="hljs-string">"CloudFront-Is-Mobile-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-SmartTV-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-Tablet-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Viewer-Country"</span>: <span class="hljs-string">"US"</span>,
    <span class="hljs-string">"Host"</span>: <span class="hljs-string">"1234567890.execute-api.us-east-1.amazonaws.com"</span>,
    <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"1"</span>,
    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
    <span class="hljs-string">"Via"</span>: <span class="hljs-string">"1.1 08f323deadbeefa7af34d5feb414ce27.cloudfront.net (CloudFront)"</span>,
    <span class="hljs-string">"X-Amz-Cf-Id"</span>: <span class="hljs-string">"cDehVQoZnx43VYQb9j2-nvCh-9z396Uhbp027Y2JvkCPNLmGJHqlaA=="</span>,
    <span class="hljs-string">"X-Forwarded-For"</span>: <span class="hljs-string">"127.0.0.1, 127.0.0.2"</span>,
    <span class="hljs-string">"X-Forwarded-Port"</span>: <span class="hljs-string">"443"</span>,
    <span class="hljs-string">"X-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span><font></font>
  },<font></font>
  <span class="hljs-string">"requestContext"</span>: {
    <span class="hljs-string">"accountId"</span>: <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"resourceId"</span>: <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"stage"</span>: <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"requestId"</span>: <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"requestTime"</span>: <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span>: <span class="hljs-number">1428582896000</span>,
    <span class="hljs-string">"identity"</span>: {
      <span class="hljs-string">"cognitoIdentityPoolId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accountId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoIdentityId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"caller"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accessKey"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"sourceIp"</span>: <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"cognitoAuthenticationType"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userArn"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userAgent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span>: <span class="hljs-literal">null</span><font></font>
    },<font></font>
    <span class="hljs-string">"path"</span>: <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"resourcePath"</span>: <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"apiId"</span>: <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"protocol"</span>: <span class="hljs-string">"HTTP/1.1"</span><font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リクエストを追加し</font><font style="vertical-align: inherit;">
たら</font><font style="vertical-align: inherit;">、[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]をクリックし</font><font style="vertical-align: inherit;">てラムダの結果を確認し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ラムダは、ステータスコードと応答本文を含むJSONを返します。</font><font style="vertical-align: inherit;">本文の値は、ゲートウェイAPIを呼び出したクライアントに直接送信されます。</font><font style="vertical-align: inherit;">さらに、スクリーンショットには、呼び出しの特性が含まれています。実行時間、支払われる実行時間、ラムダが消費したメモリの最大量です。</font><font style="vertical-align: inherit;">これらのメトリックに基づいて、ラムダが価格/応答率の要件に一致するように、最適なメモリ量を構成できます。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/oc/vw/w1/ocvww1tut1fhx0czz5ijzjnpvhg.png" alt="ゲートウェイリソース"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWSコンソールを使用したカナリアデプロイメントのテスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ラムダの新しいバージョンのデプロイに関連する1つの重要な点に触れましょう。</font><font style="vertical-align: inherit;">SAMテンプレートを作成するときに、そのようなパラメーターを指定しました。</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のパラメーターは、新しいバージョンのラムダに</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">live</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エイリアスを自動的に追加します</font><font style="vertical-align: inherit;">。</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エイリアスについて少し</font></font></b>
                        <div class="spoiler_text">     ,   .    ,         ,       API Gateway.      1, 2, 3   .    <i>LATEST</i>,     .     2  3   API Gateway (Stage   AWS),          Gateway-Lambda.  API Gateway      (ARN ),      <i>LATEST</i>. <br>
 <br>
 —    (  ), ,      ,    ARN .      ,         Stage  API Gateway      .  ,    API Gateway: dev, qa  prod       .<br>
<br>
         ,    ,      .       ,        .  , live,    .    live-    , , ,    ,       CloudWatch.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カナリアデプロイメントをテストするには、Gateway APIコンソールとLambdaコンソールの両方を使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、別の答えを返すようにラムダコードを変更する必要があります。</font><font style="vertical-align: inherit;">たとえば、ウォームアップ処理で、レスポンスにバージョン1ではなくバージョン2を指定すると、これがマーカーになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、ゲートウェイテストのAPI機能を使用して、WARM-UPリクエストを送信するときに10分以内に、応答の10％のみが応答本文にバージョン2を持つことを確認できます。</font><font style="vertical-align: inherit;">この後、バージョン2はリクエストの100％を返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲートウェイAPIコンソールに加えて、Lambdaコンソールを使用できます。ここで、必要なエイリアスを選択すると、制御可能なトラフィック分散ポリシーが表示されます。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png" alt="ラムダエイリアス"></a><br>
<br>
<br>
<a name="Part2"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. SAM-CLIを使用したローカル開発</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少し前に、ラムダを使用することの主な欠点の1つは、ローカルマシンでの開発とテストにおいて不便であると考えられていました。現在、状況は大きく変化しています。SAMフレームワークが登場しました。これにより、ソリューションの収集と展開が可能になるだけでなく、ローカル開発も簡素化されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、コンソールからラムダを直接呼び出すことができます。</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドは、SAMテンプレートのあるディレクトリから起動され、JSONファイルの内容を連絡先ラムダContactUsFunctionに転送します（これはテンプレートの論理名です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、SAMはこのコマンドを使用して、イメージ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lambci / lambda：java11をdocker</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><i><font style="vertical-align: inherit;">生成</font></i><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">、その中でコードを実行します。</font><font style="vertical-align: inherit;">SESなどのリモートサービスにアクセスするには、シークレット/アクセスキーを使用したAWS構成が使用されるため、最新の状態である必要があります。</font><font style="vertical-align: inherit;">もう1つの重要な点：ウォームアップモードのヘッダーを追加しない場合、実際のAWS SESおよびDynamoDBサービスが呼び出されます。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに通話記録</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction<font></font>
Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2 Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Request was received<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"protocol"</span> : <span class="hljs-string">"HTTP/1.1"</span>,
    <span class="hljs-string">"requestTime"</span> : <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span> : 1428582896000,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : { },
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"X-WARM-UP"</span> : [ <span class="hljs-string">"13"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : {
    <span class="hljs-string">"proxy"</span> : <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : {
    <span class="hljs-string">"baz"</span> : <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2?[0m<font></font>
?[32mREPORT RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2     Init Duration: 1984.55 ms       Duration: 42.22 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
{<span class="hljs-string">"statusCode"</span>:201,<span class="hljs-string">"multiValueHeaders"</span>:{<span class="hljs-string">"Access-Control-Allow-Origin"</span>:[<span class="hljs-string">"*"</span>]},<span class="hljs-string">"body"</span>:{<span class="hljs-string">"response"</span>:<span class="hljs-string">"Lambda was warmed up. V1"</span>},<span class="hljs-string">"isBase64Encoded"</span>:<span class="hljs-literal">false</span>}
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラムダログに加えて、JSON形式の通話ステータスと応答に関するサービス情報がコンソールに書き込まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラムダと同様に、ゲートウェイAPIはローカルで実行できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコマンドを実行します。</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> start-api
</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起動時のコンソールログ</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> start-api<font></font>
Mounting ContactUsFunction at http://127.0.0.1:3000/contact [POST, OPTIONS]<font></font>
You can now browse to the above endpoints to invoke your <span class="hljs-built_in">functions</span>. You <span class="hljs-keyword">do</span> not need to restart/reload SAM CLI <span class="hljs-keyword">while</span> working on your <span class="hljs-built_in">functions</span>, changes will be reflected instantly/automatically. You only need to restart SAM CLI <span class="hljs-keyword">if</span> you update your AWS SAM template<font></font>
2020-01-06 22:20:30  * Running on http://127.0.0.1:3000/ (Press CTRL+C to quit)<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーを起動した後、リクエストを実行できます。</font><font style="vertical-align: inherit;">Postmanを使用して、ラムダをウォームアップするリクエストを送信します。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/_e/hg/vs/_ehgvsftbjygwjcu3iiol-vky68.png"></a><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンソールには、</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: 27868750-3637-1f80-3d80-53a724da16ef Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Request was received<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\r\n  \"subject\": \"Question\",\r\n  \"question\": \"How much does it cost\",\r\n  \"username\": \"Alex\",\r\n  \"phone\": \"+79999999999\",\r\n  \"email\": \"alex@gmail.com\"\r\n}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"Prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"protocol"</span> : null,
    <span class="hljs-string">"requestTime"</span> : null,
    <span class="hljs-string">"requestTimeEpoch"</span> : 0,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : null,
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"Accept"</span> : [ <span class="hljs-string">"application/json"</span> ],
    <span class="hljs-string">"Accept-Encoding"</span> : [ <span class="hljs-string">"gzip, deflate, br"</span> ],
    <span class="hljs-string">"Accept-Language"</span> : [ <span class="hljs-string">"ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7"</span> ],
    <span class="hljs-string">"Cache-Control"</span> : [ <span class="hljs-string">"no-cache"</span> ],
    <span class="hljs-string">"Connection"</span> : [ <span class="hljs-string">"keep-alive"</span> ],
    <span class="hljs-string">"Content-Length"</span> : [ <span class="hljs-string">"150"</span> ],
    <span class="hljs-string">"Content-Type"</span> : [ <span class="hljs-string">"text/plain;charset=UTF-8"</span> ],
    <span class="hljs-string">"Host"</span> : [ <span class="hljs-string">"127.0.0.1:3000"</span> ],
    <span class="hljs-string">"Origin"</span> : [ <span class="hljs-string">"chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop"</span> ],
    <span class="hljs-string">"Postman-Token"</span> : [ <span class="hljs-string">"5cadaccd-6fae-5bc2-b4ef-63900a1725ff"</span> ],
    <span class="hljs-string">"Sec-Fetch-Mode"</span> : [ <span class="hljs-string">"cors"</span> ],
    <span class="hljs-string">"Sec-Fetch-Site"</span> : [ <span class="hljs-string">"cross-site"</span> ],
    <span class="hljs-string">"User-Agent"</span> : [ <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36"</span> ],
    <span class="hljs-string">"X-Forwarded-Port"</span> : [ <span class="hljs-string">"3000"</span> ],
    <span class="hljs-string">"X-Forwarded-Proto"</span> : [ <span class="hljs-string">"http"</span> ],
    <span class="hljs-string">"X-Warm-Up"</span> : [ <span class="hljs-string">"123"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : null,
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : null,
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: 27868750-3637-1f80-3d80-53a724da16ef?[0m<font></font>
?[32mREPORT RequestId: 27868750-3637-1f80-3d80-53a724da16ef     Init Duration: 1951.87 ms       Duration: 42.91 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
2020-01-06 22:28:11 127.0.0.1 - - [06/Jan/2020 22:28:11] <span class="hljs-string">"POST /contact HTTP/1.1"</span> 201 -
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ログは最適な方法でフォーマットされていません。</font><font style="vertical-align: inherit;">うまくいけば、これは将来修正されるでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要：ラムダコードを変更する場合、APIを再起動する必要はありません。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam buildコマンドで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラムダを再構築するだけで十分</font><font style="vertical-align: inherit;">です。</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バグについて少し</font></font></b>
                        <div class="spoiler_text">        Java-  <i>aws-serverless-java-container-core</i>,    :       502 .    :<br>
<pre><code class="bash hljs">Invalid API Gateway Response Keys: {<span class="hljs-string">'base64Encoded'</span>} <span class="hljs-keyword">in</span> {<span class="hljs-string">'statusCode'</span>: 200, <span class="hljs-string">'headers'</span>: {<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/plain'</span>}, <span class="hljs-string">'body'</span>: <span class="hljs-string">'Hello World'</span>, <span class="hljs-string">'base64Encoded'</span>: False} 
</code></pre><br>
  - ,   API Gateway    AWS       JsonProperty.     <i>'isBase64Encoded'</i>   <i>'base64Encoded'</i>, , ,    .   ,       Java- ContactUsProxyResponse  AwsProxyRequest.<br>
</div>
                    </div><br>
<br>
<a name="Part3"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. IDEAからの市内通話</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の段落で説明されているものはすべて、SAMツールの機能です。コマンドラインから制御され、任意のインターフェースに統合できます。これはまさにIntelljIDEA AWS Toolkitのプラグインで行われたことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプラグインは、IDEから直接ラムダを起動するための追加構成を追加します。これは、構成ウィンドウの外観です。</font><font style="vertical-align: inherit;">
ラムダの説明を含むテンプレートを選択するか、手動で設定を構成する必要があります。</font><font style="vertical-align: inherit;">
最初のケースでは、コンパイル用のメモリと言語の量がテンプレートから自動的に取得されます。 2番目のケースでは、RAMの量を自分で構成し、制限の概算を行うことができます。</font><font style="vertical-align: inherit;">
別のプラグインを使用すると、Javaコードエディタまたはyaml-templateのウィンドウから構成を直接実行できます。以下のスクリーンショット：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/2s/8u/xk/2s8uxk8n8gfza3p9z9ewugw-xge.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/8o/um/83/8oum83fe_tkz8suqmxzg-evjpaa.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/iw/ma/is/iwmais_steqx3sfhwstdxk7ncwa.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは、実際には、すべてです。</font><font style="vertical-align: inherit;">カスタマイズされた構成を実行することで、コンソールからの頻繁なラムダ呼び出しを自動化するだけです。</font><font style="vertical-align: inherit;">同意します、かなり快適ですか？</font></font><br>
<br>
<a name="Part4"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.テスト</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、ラムダのテストの種類について説明します。</font><font style="vertical-align: inherit;">この例ではJavaを使用しているため、テストには単体テストと統合テスト用のかなり標準的なツール（Junit 4、Mockito、PowerMockito）が含まれます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単体テスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラムダコードを単体テストでカバーするために、特定の知識は必要ありません。</font><font style="vertical-align: inherit;">標準のJavaプラクティスを適用するだけで十分です。クラスのすべての依存関係をロックし、リクエスト処理の考えられるすべてのケースをテストしてみてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのテストシナリオを追加するのではなく、2つのポジティブシナリオと2つのネガティブシナリオに限定しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のポジティブテストでは、X-WARM-UPヘッダーがある場合、DbServiceおよびEmailServiceにリクエストがないことを確認します。</font><font style="vertical-align: inherit;">2番目のケースは、要求が実際の場合にこれらのサービスが呼び出されることを確認します。</font><font style="vertical-align: inherit;">これらは最も単純なテストであり、チェックの一部を省略しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
否定的なシナリオは、クライアントまたはサーバーの処理エラーの場合の応答チェックです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合テスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合テストについては、DbServiceとDynamoDBテーブルでのその作業をチェックアウトすることにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Localstack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ツールを使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このソリューションは、Dockerコンテナーとして実行されるAWSサービスに無料のmokaを提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このソリューションをインストールするには、次のコマンドを実行するだけです。</font></font><br>
<pre><code class="bash hljs">pip install localstack<font></font>
localstack start<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker-composeファイルを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用することもでき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DynamoDBのみを生成するdocker-compose</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">version: <span class="hljs-string">'2.1'</span><font></font>
services:<font></font>
  localstack:<font></font>
    container_name: <span class="hljs-string">"<span class="hljs-variable">${LOCALSTACK_DOCKER_NAME-localstack_main}</span>"</span><font></font>
    image: localstack/localstack<font></font>
    ports:<font></font>
      - <span class="hljs-string">"4567-4599:4567-4599"</span>
      - <span class="hljs-string">"<span class="hljs-variable">${PORT_WEB_UI-8080}</span>:<span class="hljs-variable">${PORT_WEB_UI-8080}</span>"</span><font></font>
    environment:<font></font>
      - SERVICES=dynamodb<font></font>
      - DEBUG=<span class="hljs-variable">${DEBUG- }</span>
      - DATA_DIR=<span class="hljs-variable">${DATA_DIR- }</span>
      - PORT_WEB_UI=<span class="hljs-variable">${PORT_WEB_UI- }</span>
      - LAMBDA_EXECUTOR=<span class="hljs-variable">${LAMBDA_EXECUTOR- }</span>
      - KINESIS_ERROR_PROBABILITY=<span class="hljs-variable">${KINESIS_ERROR_PROBABILITY- }</span><font></font>
      - DOCKER_HOST=unix:///var/run/docker.sock<font></font>
    volumes:<font></font>
      - <span class="hljs-string">"<span class="hljs-variable">${TMPDIR:-/tmp/localstack}</span>:/tmp/localstack"</span>
      - <span class="hljs-string">"/var/run/docker.sock:/var/run/docker.sock"</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
startコマンドは、デフォルトで使用可能なすべてのAWSサービスを生成します。</font><font style="vertical-align: inherit;">DynamoDBを具体的に上げるには、環境変数を設定するだけです。</font></font><br>
<pre><code class="bash hljs"><span class="hljs-built_in">set</span> SERVICES=dynamodb
</code></pre><br>
<br><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">@LocalstackDockerProperties</font></i><font style="vertical-align: inherit;">構成を使用して必要なサービスを開始できる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Junit用の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
特別な</font><i><font style="vertical-align: inherit;">LocalstackTestRunner</font></i><font style="vertical-align: inherit;">があり</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
その結果、DbServiceのテストを作成すると、次のようになります。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストクラスを追加します。 </font></font><br>
<pre><code class="java hljs"><span class="hljs-meta">@RunWith(LocalstackTestRunner.class)</span>
<span class="hljs-meta">@LocalstackDockerProperties(services = { "dynamodb" })</span>
</code></pre> <br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルを作成する </font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@Before</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span><span class="hljs-params">()</span> </span>{<font></font>
    AmazonDynamoDB clientDynamoDB = TestUtils.getClientDynamoDB();<font></font>
    dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(clientDynamoDB);<font></font>
    dbService = <span class="hljs-keyword">new</span> DbService(dynamoDB);<font></font>
<font></font>
    dynamoDB.createTable(<font></font>
            <span class="hljs-keyword">new</span> CreateTableRequest()<font></font>
                    .withTableName(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                    .withKeySchema(<span class="hljs-keyword">new</span> KeySchemaElement(<span class="hljs-string">"Id"</span>, KeyType.HASH))<font></font>
                    .withAttributeDefinitions(<span class="hljs-keyword">new</span> AttributeDefinition(<span class="hljs-string">"Id"</span>, ScalarAttributeType.S))<font></font>
                    .withProvisionedThroughput(<span class="hljs-keyword">new</span> ProvisionedThroughput(<span class="hljs-number">10L</span>, <span class="hljs-number">10L</span>)));<font></font>
}<font></font>
                </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストシナリオについて説明します</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-comment">// given</span>
ContactUsRequest contactUsRequest = <span class="hljs-keyword">new</span> ContactUsRequest(<span class="hljs-string">"subject"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"+79991234545"</span>, <span class="hljs-string">"123@mail.ru"</span>, <span class="hljs-string">"Qeustion"</span>);<font></font>
<font></font>
<span class="hljs-comment">// when</span>
dbService.putContactUsRequest(<span class="hljs-string">"123"</span>, contactUsRequest);<font></font>
<font></font>
<span class="hljs-comment">// then</span>
Item item = dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).getItem(<span class="hljs-keyword">new</span> PrimaryKey(<span class="hljs-string">"Id"</span>, <span class="hljs-string">"123"</span>));<font></font>
assertEquals(contactUsRequest.getSubject(), item.get(<span class="hljs-string">"Subject"</span>));<font></font>
assertEquals(contactUsRequest.getUsername(), item.get(<span class="hljs-string">"Username"</span>));<font></font>
assertEquals(contactUsRequest.getPhone(), item.get(<span class="hljs-string">"Phone"</span>));<font></font>
assertEquals(contactUsRequest.getEmail(), item.get(<span class="hljs-string">"Email"</span>));<font></font>
assertEquals(contactUsRequest.getQuestion(), item.get(<span class="hljs-string">"Question"</span>));
              </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト後にテーブルを削除することを忘れないでください。</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@After</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tearDown</span><span class="hljs-params">()</span> </span>{<font></font>
    dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).delete();<font></font>
}<font></font>
               </code></pre><br>
 </div>
                    </div><br>
 </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、Localstackを使用して、これらのサービスの作業をエミュレートできるかなり広範囲のAWSモックを取得します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E2Eテスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E2Eシナリオをプレイするには、もちろんそのような機会がある場合は、特にテストを実行するためにAWSテストサービスを上げることをお勧めします。</font><font style="vertical-align: inherit;">これは、リソースがメインテンプレートのコピーとなるオプションのCloudFormationテンプレートを使用して実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストは、AWS-CLIを介してラムダを呼び出し、使用可能な任意のツールで結果を処理することで実行できます。</font><font style="vertical-align: inherit;">単体テストでも呼び出しを行うことができますが、mobを作成する必要はありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能試験</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンステストは別の記事または本に値するので、ここにすべての情報を記載することはしません。</font><font style="vertical-align: inherit;">要するに、ストレステストについて話すとき、ほとんどすべてのAWSサービスを使用することは無料ではないことを覚えておく必要があり、可能なコストを事前に見積もる準備をする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラムダに必要なリソースを評価する場合は、UIコンソールを使用して、いくつかのテスト呼び出しを行います。</font><font style="vertical-align: inherit;">次に、ありふれたロジックと数学を使用して、使用可能なリソースの量に応じてラムダのパフォーマンスがどの程度向上するかを評価します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CloudWatchを忘れないでください。</font><font style="vertical-align: inherit;">その助けを借りて、非常にわかりやすいダッシュボードを作成し、それらに基づいて、ラムダのパラメーターと購入可能な支出を決定できます。</font></font><br>
<br>
<a name="Part5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.サーバーレスソリューションのコスト</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのコールのコストだけでなく、着信/発信トラフィック、キャッシング、ロギング、モニタリングのコストも考慮する必要があるため、ソリューションの評価は常に特定のものです。</font><font style="vertical-align: inherit;">ラムダの使用を検討している場合は、サービスが処理する負荷を予測してみてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらが1回の呼び出しまたは数時間/日ごとに実行されるETLプロセスである場合、ラムダが報われる可能性が高くなります。</font><font style="vertical-align: inherit;">1秒間に複数のクエリの負荷を予測する場合は、正確な見積もりを行うようにしてください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下では、ラムダのコストの概算と最も安価なEC2サーバーを概算し、どの値が問題であるかを理解できるようにします：</font><font style="vertical-align: inherit;">
ラムダの次のパラメーターが計算に使用されました：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/p_/0w/ij/p_0wij6j_z2xop6dbt185485llc.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リードタイム：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 150ミリ秒</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価格：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1GB-sで0.00001667ドル</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリ：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 256 MB</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EC2 t2.nanoの場合：</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価格：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">月額4.75ドル</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリー：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 512 MB</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCPU：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大負荷：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1か月あたり5％CPU</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
EC2負荷データを取得</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">しまし</font></a><font style="vertical-align: inherit;">たが、これらの計算によると、指定されたサーバーは毎秒0.3リクエストの一定の負荷に耐えることができます。負荷が増加すると、応答時間が長くなり、このサーバーの効率が低下します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの計算はすべて非常に抽象的なものであり、多くの要因を考慮していません。前払いや多数のリクエストの割引、ラムダ実行時間などです。しかし、彼らは、1秒あたり1リクエスト未満の負荷で、ラムダのコストが最も安いEC2サーバーよりも安いことを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、複数のアプリケーションレプリカまたはエラスティックIPを保持する必要がある場合は、EC2の価格にALBの価格を追加することを忘れないでください。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/wc/md/grwcmd0t5swk3uwf-shmglewttu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーレスソリューションのテストとローカル開発は、同じマイクロサービスほど人気が​​ありません。</font><font style="vertical-align: inherit;">それにもかかわらず、ますます多くの人々がこれらのテクノロジーを研究して適用し、さまざまなオープンソース製品に改善と効率をもたらす機会を与えています。</font><font style="vertical-align: inherit;">このようなソリューションは、製品をできるだけ早くリリースする必要があり、インフラストラクチャ全体を構成する必要がない企業の生活を大幅に簡素化します。</font><font style="vertical-align: inherit;">しかし、すでに開発された製品であっても、サーバーレスデータベースまたはラムダのための場所があると思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はサーバーレスソリューションのテストの分野の専門家であるとは主張していませんが、私の個人的な前向きな経験に基づいて、この記事の主要なポイントを強調することにしました。</font><font style="vertical-align: inherit;">私はそれらが誰かに役立つことを願っています、そしておそらくあなたの何人かは私を補ったり、私を訂正したりできます。</font></font><br>
<br>
<a name="Part6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役立つリンク</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際のAWS Lambda。</font><font style="vertical-align: inherit;">パート1</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  GitHub</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Localstack Git </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> docker-compose   Localstack</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   EC2  AWS Lambda</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> SAM-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> SAM-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   AWS Lambda</a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja496742/index.html">オンライン教育サービスシステムにおける泥棒と売春婦の問題の1つの解決策について</a></li>
<li><a href="../ja496744/index.html">どのように財政を節約し、下落する市場に直面してお金を稼ぐか：構造的製品</a></li>
<li><a href="../ja496750/index.html">階層化、またはデータを信頼する方法を学ぶ</a></li>
<li><a href="../ja496752/index.html">エボラウイルスが感染データを処理する方法を教えてくれたので、彼の教訓をすべて忘れてしまいました</a></li>
<li><a href="../ja496754/index.html">OpenStreetMap No.506（2020年3月24日〜2020年3月3日）の世界からのニュース</a></li>
<li><a href="../ja496758/index.html">デジタル中世医療。COVID-19後のグローバルな技術転換</a></li>
<li><a href="../ja496760/index.html">ユーザーフロー：一般的なアプリケーションとサイトを作成する方法</a></li>
<li><a href="../ja496762/index.html">粒子ベースの表面侵食シミュレーション</a></li>
<li><a href="../ja496764/index.html">小さくても誇りに思う：DuckDuckGoと広告モンスター</a></li>
<li><a href="../ja496766/index.html">Azure Stack HCIとは何ですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>