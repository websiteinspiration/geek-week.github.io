<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßúüèø üôá üë®üèæ‚Äç‚úàÔ∏è Des images comme des bo√Ætes - que contient-il? Signaler dans Yandex üôåüèΩ üõÄüèª üàµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les photos et les vid√©os sont des ¬´bo√Ætes noires¬ª, √† l'int√©rieur desquelles il y a beaucoup d'int√©ressantes et d'incompr√©hensibles. Mais vous pouvez r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Des images comme des bo√Ætes - que contient-il? Signaler dans Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/493616/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les photos et les vid√©os sont des ¬´bo√Ætes noires¬ª, √† l'int√©rieur desquelles il y a beaucoup d'int√©ressantes et d'incompr√©hensibles. </font><font style="vertical-align: inherit;">Mais vous pouvez regarder √† l'int√©rieur de certains formats, tout changer et voir ce qui se passe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Polina Gurtovaya de la soci√©t√© Evil Martians a pris la parole lors de notre conf√©rence </font></font><nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I&nbsp; </font></font><img src="https://habrastorage.org/webt/jq/7k/7w/jq7k7wi7p_23g0_clzmrmlgri7y.jpeg" width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Frontend</font></font></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en f√©vrier. </font><font style="vertical-align: inherit;">Avec l'aide de l'exp√©rience, Polina a d√©couvert comment transformer des images simples en ¬´images efficaces¬ª avec des m√©triques. </font><font style="vertical-align: inherit;">Les outils qui peuvent le faire pour nous, Polina a examin√© plus pr√®s de la fin du rapport. </font><font style="vertical-align: inherit;">Le r√©sultat a √©t√© une grande excursion dans l'int√©rieur et les principes de fonctionnement de diff√©rents formats: du PNG et JPEG √† AV1 et exotique.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/CMlXUS6e46w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Bonjour √† tous. </font><font style="vertical-align: inherit;">Je m'appelle Polina, je suis le chef de file de la compagnie "Evil Martians".</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-√™tre connaissez-vous des Martiens de nos nombreuses sources ouvertes. Je te parlerai un peu de lui plus tard. Et je dois probablement dire que nous d√©veloppons toujours des produits, et pas seulement en sciant l'open source. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/cs/gx/ckcsgxe6gmebfvkdo2rux-lwwgy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le mat√©riel pour le rapport sera √† votre disposition via un merveilleux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le r√©f√©rentiel sur GitHub. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/km/90/d2/km90d2teg2yhoqpn4y7xs9x1ryq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons un peu d'optimisation. Lorsque nous traitons avec eux, le probl√®me est qu'ils fonctionnent bien si nous comprenons ce que nous faisons. Si on ne comprend pas, √ßa tourne mal. En ce qui concerne l'optimisation d'image, malheureusement, tout ici n'est vraiment pas vraiment cool. Nous n'optimiserons peut-√™tre pas du tout les images, puis il y aura des monstres de deux m√®tres sur la prod, tout est triste et triste.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous optimisons, que faisons-nous? Nous pensons: ici nous avons une image, c'est une sorte de bo√Æte noire myst√©rieuse, et le programme d'optimisation fait quelque chose avec cette image, une sorte de chamanisme noir. La qualit√© d'optimisation que nous obtenons est un peu douteuse. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4g/hr/bv/4ghrbv-nnuqbug7iz0qavj4frma.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardons un exemple. J'ai un chat au format PNG. Je pense que nous devons l'optimiser. Que suis-je en train de faire? Je cr√©e une version WebP et mets soigneusement les deux images dans une balise &lt;picture&gt;. Pensez-vous que j'ai bien fait ici ou non? Pourquoi y a-t-il si peu de mains? Je suis vraiment bien fait! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai tout fait correctement, mais la version WebP s'est av√©r√©e deux kilo-octets de plus que l'original. Ce n'est pas du tout ce que je voulais.‚Ä®</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/4r/hc/li4rhcov7blg4uquvq54dhmrrk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre optimisation, essayez le num√©ro 2. J'ai un petit conteneur sur la page et un gros, gros chat. Je veux mettre un gros chat dans un petit r√©cipient. Que suis-je en train de faire? Je fais un redimensionnement car il est stupide de conduire des octets sur le r√©seau si la taille de mon conteneur est petite. Bien s√ªr, je prends en compte le ratio de pixels de l'appareil de mon appareil. Pensez-vous que je vais bien ici ou non? J'ai fini! Et regardez ce que j'ai fait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'utilise la biblioth√®que libvips. Elle est tr√®s cool et populaire, et de mon √©norme chat l√©ger mais heureux j'ai eu un petit chat tr√®s lourd. Le sceau a augment√© de 2,5 fois (en octets) pendant le redimensionnement (en pixels) vers le bas. Cool, ouais?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rv/81/vf/rv81vftipmbdmz3opezzn42k6yw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, pour que cela ne nous arrive pas, que nous comprenions comment optimiser nos images pour notre t√¢che, et, en g√©n√©ral, pour que nous comprenions au moins ce qui se passe, regardons dans la bo√Æte et comprenons ce qu'il y a √† l'int√©rieur. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/8y/tn/ur8ytn4gri-ezcgsvsxsulwbc10.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par regarder un format aussi int√©ressant que PNG. Autour de chaque site, un petit peengshechka est cach√© quelque part. Cette fois. Par cons√©quent, ils doivent √™tre compris. Deuxi√®mement: PNG - format de compression sans perte. Cela signifie que nous garantissons une correspondance parfaite avec l'original en pixels, mais en m√™me temps, h√©las, nous sommes limit√©s par nature, nous ne pouvons pas compresser moins que la quantit√©.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-2/sp/r0/-2spr0e9x6o0qirw1n5fg__zkkk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peengeshka se replie dans un conteneur, comme n'importe quel format d'image. L'une des premi√®res choses que nous devons dire au programme s'il lit tout est ce qui se trouve √† l'int√©rieur. Si vous supposez que vos d√©codeurs d√©terminent les images par extension, ce n'est pas le cas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengashka rapporte qu'il s'agit de PNG, les huit premiers octets de son conteneur. Il dit ¬´PNG¬ª. De plus - encore une fois, cela est caract√©ristique de tout conteneur - vous avez une disposition des morceaux. Autrement dit, les informations sont regroup√©es en morceaux, elles sont en quelque sorte organis√©es. Comment - d√©finit le conteneur. En PNG, cela ressemble √† ceci: vous avez quatre octets qui sont responsables de la longueur et quatre octets qui sont responsables du type de bloc. Quels types - nous parlerons un peu plus tard. ‚Ä®</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le morceau a une longueur non nulle, il a une charge utile. De plus, il existe une somme de contr√¥le. Vous v√©rifiez si quelque chose y a √©t√© battu. Viennent ensuite les morceaux suivants. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tw/-1/49/tw-1499ut7u6w6fl6rhas8tyk3m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analyser non seulement un fichier PNG, mais presque n'importe lequel est assez facile. Prenez FileReader, c'est une API de navigateur. Nous lisons le fichier √† l'aide de FileReader. D√®s que nous lisons, nous coupons ce fichier en morceaux. Je ne donnerai pas ici le code de la fonction split to chunks, mais vous pouvez deviner qu'il existe une combinaison complexe de si et pour. ‚Ä®</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n7/bg/sb/n7bgsbtsscwv-prpt2atx7a18d4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, nous l'avons coup√©, nous verrons ce qui se passe. Nous avons plusieurs types de morceaux, et ils sont tr√®s, tr√®s caract√©ristiques de presque tous les formats. Le premier est appel√© IHDR. Il existe un certain nombre de morceaux appel√©s IDAT. Ces noms peuvent vous sembler un peu √©tranges, mais nous allons maintenant comprendre de quoi il s'agit. Quand tout se termine, nous voyons le morceau de fin.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y0/pc/b6/y0pcb6n_4f4uiuakytlvwzla3ao.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons de plus pr√®s l'int√©rieur des morceaux. L'IHDR est un m√©ta-morceau, et presque toutes les images ont un tel m√©ta-morceau. On l'appelle diff√©remment, on l'arrange diff√©remment, mais c'est tr√®s probablement. Sans cela, votre d√©compresseur - une chose qui vous montre peengeshki ou non peengeshki - ne peut rien vous montrer. Qu'est-ce qui se trouve dans ce morceau? Encore une fois, le contenu est typique de la plupart des formats. C'est la hauteur et la largeur. La hauteur et la largeur sont cousues dans votre dossier, cela vous vient. Ensuite, les indicateurs de panache typiques: bitDepth, colorType et entrelacement. ‚Ä®</font></font><br>
<img src="https://habrastorage.org/webt/cj/ry/k3/cjryk3bpfhzf--zu_vofzg1vdcc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de parler de la signification de ces drapeaux et de la raison pour laquelle ils sont si, tr√®s importants pour nous, voyons comment nous stockons les pixels dans les pangshes. Dans les peaneshs, les pixels sont stock√©s dans un bloc appel√© IDAT. Dans un bon sc√©nario, les pixels sont un certain nombre de nombres qui sont regroup√©s dans un bloc, et ce bloc est compress√© par l'algorithme de compression Deflate. Qui a utilis√© l'algorithme de compression Deflate? D'accord, √† quand remonte la derni√®re fois que vous avez zipp√© quelque chose? Savez-vous que Deflate est gzip? Je pense donc que beaucoup l'ont utilis√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais dans peengeshah, une autre chose int√©ressante appara√Æt qui est utilis√©e dans un grand nombre de formats, mais probablement dans tous. Ce gizmo est appel√© codage pr√©dictif. Le fait est que nos images ne sont pas des pixels al√©atoires. Ce qui est peint sur notre petite image est en quelque sorte li√© les uns aux autres. Il y a des zones sombres, des zones claires, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons d'exploiter ce fait, et au lieu de stocker la valeur de pixel dans ces cellules bleues, nous essayons de pr√©dire ces pixels sur la base des pr√©c√©dents. En PNG, ces pr√©dictions sont tr√®s simples et elles sont regroup√©es dans le tout premier octet avant la ligne avec les pixels. Une pr√©diction peut √™tre comme √ßa, par exemple, ne pr√©disons rien et mettons tout simplement tel quel. Ou, par exemple, nous pouvons dire ceci: mais ne gardons que la diff√©rence entre le pixel actuel et le pr√©c√©dent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez la m√™me couleur dans votre ligne, vous aurez tous les z√©ros, tout est parfaitement compress√©, c'est tr√®s cool.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/ut/zh/jqutzhlx2vsbyxrbpbuogts9vbq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais maintenant, parlons de ce que signifie r√©ellement un pixel. Un pixel appara√Æt dans un peengesh sous forme de nombre. En manipulant le nombre de nombres, vous pouvez compresser tr√®s, tr√®s √©troitement votre PNG - trois fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelles sont les options? Le premier est True Color et alpha. Nous avons trois canaux, trois couleurs, trois num√©ros par couleur. Plus un canal qui est responsable de la transparence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La taille de ce chiffre en bits est bitDepth, le m√™me indicateur que nous avons vu dans le bloc IHDR. Plus votre bitDepth est petit, plus le fichier est petit, mais moins vous pouvez lui pr√©senter de couleurs. Un nombre typique est 8. Combien √ßa co√ªte? √Ä mon avis, il y aura 16 millions avec quelque chose. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, la premi√®re optimisation que vous pouvez faire est de jeter les canaux alpha dans votre peengesh. Ce sera un colorType diff√©rent.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez optimiser encore mieux et utiliser un seul au lieu de quatre nombres. Mais le probl√®me est que votre peengeshka doit √™tre en noir et blanc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous ne voulez toujours qu'un seul num√©ro et laissez les couleurs, cela peut √©galement √™tre fait. Que se passe t-il ici? Vous prenez toutes les couleurs √† l'int√©rieur de votre peengeshka et les coupez en un morceau s√©par√©. Appelez cela une palette. Plus √† l'int√©rieur de l'√©chantillon, qui est responsable du pixel √† l'int√©rieur du bloc IDAT, vous stockez simplement l'index de cette palette. Si vous avez une capture d'√©cran sans arri√®re-plan complexe ou dessin, cette chose est parfaite. Elle serre peengeshki √† droite wow!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre chose importante √† dire est l'entrelacement. Qu'est-ce que l'entrelacement? C'est √† ce moment que vous exp√©diez votre peengeshka progressivement. Vous n'avez pas un peengeshka, mais plusieurs images. Chaque image est appel√©e num√©risation. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gq/u5/50/gqu550y52cqmqi9k14skfsy-bg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me temps, √† l'int√©rieur de la paengashka, vous triez les pixels de telle sorte que certains pixels soient arrach√©s des images, une image vient d'endroits sp√©ciaux. La partie suivante en est une autre et ainsi de suite. Une technique apparemment cool comme le JPEG progressif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais √ßa ressemble √† √ßa. Je ne sais pas si vous voulez que vos utilisateurs voient cela, bien que cela puisse √™tre utile pour votre t√¢che.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxi√®me probl√®me tr√®s grave du PNG entrelac√© est que d√®s que vous entrelacez votre peengeshka, la taille de votre peengeshka devient plus grande. Et plus faible, quelque part dans quelques kilo-octets, votre peengeshka de six kilo-octets augmentera si vous d√©sactivez Interlaced. Par cons√©quent, r√©fl√©chissez bien si vous le souhaitez ou non. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vg/p6/rq/vgp6rqgvogzln5frkfs5lmtcy4y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons parl√© uniquement de PNG, mais de cette chose, vous pouvez tirer des conclusions importantes et utiles. Premi√®re conclusion: la taille de votre fichier, vous ne le croirez pas, d√©pend de ce qui y est dessin√©. Le carr√© noir r√©tr√©cit mieux que le chat, je ne donnerai aucune recommandation ici. Deuxi√®mement, plus important: la taille de votre fichier d√©pend beaucoup de l'encodeur et de ses param√®tres que vous transf√©rez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voulez voir comment fonctionnent les horribles encodeurs, utilisez ceux du navigateur. Comment c'est fait? Prenez le fichier PNG, dessinez-le sur le canevas, puis cliquez sur Enregistrer sous et comparez ce qui s'est pass√© avec ce qui s'est pass√©. En g√©n√©ral, Chrome augmentera la taille de votre fichier de 2,5 fois, Firefox - de 1,6. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, cela d√©pend aussi toujours du format, c'est-√†-dire que non seulement PNG doit √™tre utilis√©. Comprenons pourquoi tout d√©pend du format et des options int√©ressantes que nous avons encore.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/z9/jd/dkz9jdpv9uy9ivtiqcl-f5nyzhk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, nous parlerons de la technologie des anciens, du JPEG. Vous ne pouvez bien s√ªr pas minimiser l'importance du JPEG. On les trouve partout. Ils sont tellement cool, bons et encore plus, les phoques en JPEG sont une histoire assez courante. Mais JPEG est une chose plut√¥t compliqu√©e, et elle est compliqu√©e du fait que JPEG est une compression avec perte. De plus, JPEG est toujours une compression avec perte. La qualit√© JPEG 100% se comprime toujours avec perte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment obtenir une compression avec perte? Tr√®s simple. Nous prenons une source, en supprimons les donn√©es, puis compressons sans perte. Autrement dit, plus une √©tape.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ct/k7/pb/ctk7pba6jjplst_3mcqx-4r5xno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons comment nous faisons des pertes dans nos JPEG. Donc, vous avez un chat d'une taille de 32 par 32. Pour que nous puissions faire le premier pas avec des pertes, nous devons changer nos canaux. Habituellement, nous parlons d'images en termes de RVB. Mais nous percevons les couleurs un peu complexes. Notre cerveau est g√©n√©ralement un gros probl√®me, bien qu'il nous aide beaucoup √† compresser le JPEG. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous percevons tr√®s bien le noir et le blanc. M√™me si vous regardez attentivement, vous remarquerez que les d√©tails de l'image en noir et blanc se distinguent mieux. Nous venons de mettre cette image en noir et blanc dans un canal s√©par√©. Cela s'appelle Y. En fait, la barre en Y. Nous ne faisons rien avec lui, nous le laissons tel quel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux autres canaux responsables de la couleur. Ce sont CB et CR. Avec ces cha√Ænes, nous pouvons d√©j√† nous amuser un peu. Ici, avec ces canaux, nous produisons une telle proc√©dure cool appel√©e Downsampling. Nous prenons et r√©duisons la r√©solution de ce canal. Pour JPEG, il est typique de diviser par deux. Autrement dit, vous obtenez trois photos - une originale et deux moiti√© autant. Hourra! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que faisons-nous ensuite? Nous ne compressons pas JPEG, pas comme un fichier entier. Nous le d√©composons en blocs et compressons davantage, nous commen√ßons d√©j√† des blocs. Les blocs en JPEG mesurent 8 x 8 et voient ce qui leur arrive. Regardons simplement le canal Y. CB et CR sont tous les m√™mes.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/zo/yg/gmzoyg2byoms9jzzncnxvauwiic.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, un bloc n'est pas une image, mais des chiffres. Nous devons faire des pertes en JPEG. Ce bloc mesure 8 x 8, 64 pixels, lequel jeter? Celui de gauche, celui de droite, celui du milieu? Pas clair. Mais il y a des math√©matiques sympas qui nous permettent de r√©soudre ce probl√®me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce calcul s'appelle - maintenant, ne vous inqui√©tez pas si quelqu'un se souvient du terrible pass√© institutionnel - la transformation discr√®te en cosinus. Ainsi, √† l'aide de cette transform√©e en cosinus discr√®te, vous pouvez convertir ces nombres dans votre bloc afin qu'ils soient importants et sans importance parmi eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Important: apr√®s la conversion, des nombres importants restent dans la partie sup√©rieure gauche du bloc. En bas √† droite restent des chiffres sans importance.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez faire votre perte JPEG. C'est aussi tr√®s facile √† faire. Cette astuce est appel√©e quantification. D√©sol√© si vous voulez dormir maintenant, mais c'est important, croyez-moi. Donc, cette quantification m√™me fonctionne d'une mani√®re assez simple. Vous prenez votre bloc et une plaque sp√©cialement con√ßue. Cette plaque est d√©termin√©e par votre programme d'encodeur. Ces nombres qui se sont av√©r√©s dans votre bloc, vous les divisez par ce terme de plaque par nombre et entier. Qu'obtenez-vous en cons√©quence? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que les nombres sont grands dans la partie inf√©rieure droite de la plaque, il n'y aura que des z√©ros.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cw/ak/a4/cwaka4z7wsiu0agcr4d6say3ddc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et en m√™me temps votre JPEG, votre bloc se compressera parfaitement. Vous aurez un petit nombre de chiffres que vous contournerez dans un zigzag si complexe, les z√©ros dispara√Ætront tous et, bravo, notre bloc est pr√™t pour la compression. Ensuite, nous avons juste besoin de le compresser avec un algorithme de compression sans perte. JPEG utilise le codage Huffman, quel qu'il soit. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/f9/lr/jvf9lrka6wigwi-l09lcfejpf6a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment est-il emball√© dans un conteneur? Les conteneurs JPEG ont l'air un peu stupides, j'en ai peur. Parce que vous voyez les deux premiers octets et que c'est probablement JPEG. Mais jusqu'√† pr√©sent, ce n'est pas clair.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez rechercher deux m√©ta-morceaux. Pourquoi deux? Parce que JPEG est un tr√®s large ensemble de normes diff√©rentes. Ce que nous appelons JPEG est, en r√®gle g√©n√©rale, appel√© JIFF. Il s'agit d'une extension sp√©ciale de la norme JPEG. Je ne continuerai pas plus loin - en g√©n√©ral, il y a deux m√©ta morceaux, croyez-moi. Ces m√©ta-morceaux contiennent des informations sur la largeur et la hauteur de votre fichier et la version de JPEG. Imaginez, JPEG a plus de versions! Et en plus, c'est du JPEG progressif? Ceci est un drapeau important. Il explique comment vos blocs seront distribu√©s plus loin.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si JPEG n'est pas progressif, de quoi avez-vous besoin pour d√©coder vos blocs? Qualit√© JPEG, cette m√™me plaque. L'assiette dans laquelle vous divisez vos blocs est de qualit√©. Mais JPEG a deux qualit√©s. La premi√®re qualit√© est responsable du canal Y, la seconde - pour les canaux CB et CR, c'est ce qui d√©termine la couleur. √âtant donn√© que nous avons mis la qualit√© dans un fichier et que nous avons tout compress√© avec un algorithme de compression sans perte, nous avons toujours besoin d'un dictionnaire Huffman Tables sp√©cial pour d√©velopper cela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Viennent ensuite vos blocs, puis votre JPEG est termin√©.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/qz/ap/hjqzaprqwxahztq8enqtwzq5cce.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, une histoire progressive. Tout est exactement pareil. Au tout d√©but, vous avez un m√©ta-morceau. Vient ensuite votre qualit√© sous la forme de 64 num√©ros, plus 64 num√©ros. Et puis juste les m√™mes blocs, mais juste un peu diff√©rents avec des nombres distribu√©s. Premi√®re partie des blocs, puis une autre partie, une autre partie et ainsi de suite. Lorsque vous recevez ces blocs, le navigateur dessine une approximation de votre JPEG, car, en fait, ces chiffres sont une approximation de votre fichier. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/uq/x3/qquqx3mnyg-nx0pn8a0lgmjufpa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä propos de JPEG, nous avons termin√©, vous pouvez expirer, tout va bien. Parlons d'une chose aussi int√©ressante que JPEG 2000. L'un de vous en production utilise-t-il JPEG 2000? D'accord, qui a d√©j√† entendu parler de √ßa? Et lequel d'entre vous a lu dans Lighthouse - ¬´utiliser des formats modernes¬ª?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, JPEG 2000 est un format int√©ressant int√©ressant, qui, premi√®rement, est plus efficace que JPEG. Deuxi√®mement, vous ne le croirez pas, dans certains cas, il est plus efficace que WebP, dont nous parlerons plus tard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il sait √™tre transparent, sait compresser sans perte. Juste le format parfait. Mais malheureusement, oui, cela ne fonctionne que dans Safari. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de mentionner que JPEG 2000 est con√ßu de mani√®re tr√®s complexe et fonctionne sur des math√©matiques int√©ressantes appel√©es transform√©e en ondelettes. Si vous √™tes soudainement int√©ress√©, google, et nous irons plus loin.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/b8/qw/lib8qwt1s_r7xowxervhr6yaay0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons soudainement parler de la vid√©o. L'ensemble de ce rapport concerne l'optimisation d'image et les images. Mais la vid√©o ici est tr√®s importante, vous verrez pourquoi maintenant. Quand on pense √† une vid√©o, le premier mot qui nous vient √† l'esprit est ¬´codec¬ª. La vid√©o doit √™tre encod√©e d'une mani√®re ou d'une autre, et pour montrer la vid√©o, nous devons la d√©coder. Si nous d√©codons le flux vid√©o, qu'obtenons-nous?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous avons un ensemble de cadres. Mais ne pensez pas √† ces cadres comme des images dans le GIF. Tout faux. Quelles trames d√©pendent beaucoup du codec. Mais dans le cas g√©n√©ral, vous pouvez supposer que vous avez une image cl√©. Vous pouvez retirer un chat de l‚Äôimage cl√© - en ce sens, toute image qui se trouve sur cette image cl√©. Et il y a des cadres d√©pendants. Il est impossible de faire sortir un chat du cadre d√©pendant, car le cadre d√©pendant stocke non seulement des informations non pas sur l'image, le cas √©ch√©ant, mais sur la fa√ßon dont les blocs du cadre pr√©c√©dent ou pr√©c√©dent se sont d√©plac√©s. Par cons√©quent, vous ne pouvez pas obtenir d'image pour une image d√©pendante avant d'avoir d√©cod√© un peu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce dont nous allons parler maintenant, c'est de la compression des images cl√©s et intra-images. Voici comment compresser une image √† l'int√©rieur d'une image cl√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardons un codec abstrait dans le vide et comparons-le avec JPEG. Jusqu'√† pr√©sent, il semble - pourquoi faire cela? Tout deviendra plus clair, croyez-moi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i9/vh/7y/i9vh7ygfkhjucwtefchjamthm3u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, nous r√©p√©tons la m√™me chose que nous faisons avec JPEG,. Vous prenez une photo, la divisez en canaux, effectuez un sous-√©chantillonnage en canaux. M√™me histoire ici. Ensuite, vous divisez cette image en blocs. Mais il existe d√©j√† des fonctionnalit√©s. Tout d'abord, la taille du bloc dans lequel vous p√©n√©trez d√©pend de votre codec. Et ces blocs peuvent √™tre tr√®s grands. Pour JPEG - 8 par 8. Pour les codecs vid√©o - il peut √™tre, par exemple, 128 par 128.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus loin. Si vous obtenez de tr√®s petits d√©tails sur votre image auxquels vous souhaitez pr√™ter attention, vous pouvez toujours subdiviser les blocs un peu, environ √† la taille 4 par 4. Comment vous cassez les blocs, cet algorithme de partitionnement d√©pend du codec. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et le plus r√©cent - la taille maximale des blocs, encore une fois, est sp√©cifique √† votre codec. Un codeur fait partie du codec, √† comprendre en terminologie. Ici, nous sommes toujours similaires au JPEG. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r0/la/y3/r0lay3m2i5yjdu-sx9by6lsyhpi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui ne ressemble pas au JPEG, c'est le codage pr√©dictif. Nous avons parl√© de lui en partie de peengeshki. La compression vid√©o intraframe est tellement cool et efficace √† cause de cela. Que se passe t-il ici?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons de pr√©dire les pixels de chaque bloc en fonction des pr√©c√©dents. Autrement dit, nous ne stockons pas les pixels sous forme brute, nous les pr√©disons. Les options de pr√©diction sont nombreuses. Dans un codec, nous pouvons utiliser diff√©rentes variantes de pr√©dictions. De plus, pour toutes sortes de codecs complexes de ces options, jusqu'√† 35, par exemple. Comment pouvez-vous faire cela. Regardons un exemple.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous avez le bloc. Vous dites: je veux y pr√©dire des pixels. Vous regardez vers la gauche, vous regardez vers le haut et vous vous souvenez de ce qui reste et du dessus. Ensuite, vous prenez toutes les valeurs de pixels que vous avez trouv√©es, faites la moyenne et remplissez-la avec un bloc, et dites: J'ai pr√©dit. Si vous avez devin√© √† droite, et au fait, sur la petite image o√π il y a des fl√®ches bleues, vous avez devin√© √† droite, alors vous √™tes g√©nial, vous n'avez rien d'autre √† faire. Mais, si vous ne l'avez pas devin√©, vous devez enregistrer la diff√©rence entre ce qui est r√©ellement et ce que vous avez pr√©dit. Cette diff√©rence se comprime beaucoup, beaucoup mieux que la valeur du pixel pur.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/mb/cg/dxmbcg7w-imsyuamimesxnxi3s0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, tout est exactement le m√™me qu'en JPEG. Vous transformerez le bloc r√©sultant. Mais la particularit√© de toutes sortes de codecs diff√©rents est que vous pouvez utiliser non pas DCT (transform√©e en cosinus discr√®te), mais autre chose. Ce qu'il faut utiliser d√©pend du codec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_k/sj/7x/_ksj7xbki-d-hjam59vm-ovudtk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puis √† nouveau les m√™mes plaques, mais contrairement au JPEG, vous pouvez utiliser plusieurs plaques pour l'ensemble de votre fichier, et vous pouvez utiliser plusieurs plaques diff√©rentes pour diff√©rents blocs. Imaginez - vous avez une personne, par exemple, contre le ciel. Peut-√™tre, puisque le ciel est bleu, vous n'avez pas besoin d'une qualit√© sp√©ciale l√†-bas, vous pouvez utiliser une qualit√© pour le ciel, une plaque. Et pour une personne qui a une texture, des v√™tements, utilisez une qualit√© diff√©rente, et cela se r√©v√®le cool et efficace.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ax/lh/mc/axlhmcjhw3u18r0v826se8n74me.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus r√©cent est ce que JPEG ne poss√®de pas et ce qui fait tr√®s, tr√®s peu d√©faut. C'est l'utilisation de filtres. Lorsque nous avons tous r√©colt√©, nous obtenons de tels artefacts d√©sagr√©ables apr√®s la compression. Si vous avez d√©j√† compress√© des JPEG en mauvaise qualit√©, vous devriez voir comment les JPEG se d√©sagr√®gent simplement en blocs terribles cauchemardesques. En g√©n√©ral, pour se d√©barrasser de ces artefacts, les codecs vid√©o utilisent une chose sp√©ciale. Ils appliquent des filtres et les bords de ces blocs se lissent. La technologie des anciens, qui nous permettait de faire de m√™me avec JPEG, √©tait telle. Vous prenez votre JPEG, le compressez tr√®s, tr√®s fort, puis le pliez comme ceci pour que rien ne soit visible. En g√©n√©ral, c'est √† peu pr√®s la m√™me chose, mais cela a d√©j√† √©t√© fait au niveau du codec. G√©nial.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eu/kn/oe/euknoewgg9xovgain172cbr03eu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, lorsque nous avons essay√© et que tout √©tait termin√©, nous devons maintenant compresser les blocs re√ßus sans perte. Nous avons serr√©, bien fait. L'algorithme de compression est similaire √† JPEG, mais toujours diff√©rent. Ici, il faut comprendre que la compression sans perte est limit√©e par la limite naturelle. Nous voulons vraiment nous en approcher, et la meilleure fa√ßon de s'en rapprocher est d'utiliser un algorithme appel√© codage arithm√©tique. Et il y a aussi toutes sortes de variations. Cela d√©pend √† nouveau de l'encodeur, mais supposons simplement qu'il existe une compression sans perte et env.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/li/9q/ej/li9qej4dyf4w1tqxuu0kdyma1pe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai longtemps voulu appeler ces codecs abstraits dans le vide par leurs noms propres. Une petite excursion historique. Que s'est-il pass√© en 20 ans? Je ne parle que des codecs vid√©o qui sont au moins en quelque sorte pris en charge sur le Web. H.264 est un codec qui prend en charge tout et tout le monde. Il s'agit de la solution par d√©faut pour toute la vid√©o. Apr√®s un certain temps, apr√®s quelques ann√©es, le codec vid√©o VP8 appara√Æt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici commencent des guerres sauvages, des holivars sur le sujet, lesquels de ces codecs sont les meilleurs. J'ai googl√© pendant tr√®s longtemps - il n'y a pas de r√©ponse. De grands articles scientifiques ont √©t√© √©crits √† ce sujet, mais en moyenne, si je dis la m√™me chose maintenant, une tomate volera en moi. Mais bon, ce sont les m√™mes. Moyenne. Alors pourquoi avons-nous besoin d'une seconde?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le second est n√©cessaire car il est gratuit. Si vous utilisez H.264, vous devez transporter de l'argent MPEG dans certaines circonstances. Pour VP8, vous n'avez pas besoin de transporter d'argent. C'est bon. Donc, image cl√© VP8 - c'est WebP. En effet, pourquoi devrions-nous inventer un nouveau format d'image? Nous prenons l'image cl√©, nous avons essay√© si fort, nous avons tout serr√©. Nous appelons tout cela un nouveau format d'images, et le tour est jou√©!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que se passe-t-il ensuite? Puis apr√®s un certain nombre d'ann√©es, deux codecs vid√©o plus sympas, de MPEG et de Google, apparaissent presque simultan√©ment. De Google - VP9, ‚Äã‚Äãde MPEG - H.265. √Ä c√¥t√© de H.265, il existe une nouvelle norme d'image appel√©e HEIF. Il n'est pas pris en charge par les navigateurs, pas du tout. Mais il est pris en charge par vos appareils Apple. La norme HEIF est incroyablement int√©ressante, car ce n'est qu'une abstraction de cette id√©e. Dans un conteneur HEIF, vous pouvez cr√©er une image cl√© √† partir de presque n'importe quel codec. Autrement dit, VP8 n'est pas un format moderne. Mais HEIF est moderne.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que se passe-t-il ensuite? Maintenant dans une tr√®s grande organisation, qui comprend Mozilla et Google, un codec vid√©o appel√© AV1 est en cours de sciage. L'organisation s'appelle Alliance for Open Media. La qualit√© de la vid√©o AV1 est plusieurs fois sup√©rieure √† tout ce qui √©tait auparavant. Il est libre, il est libre de droits, il est tr√®s cool. Nous avons un si beau conteneur HEIF. Il ne nous reste plus qu'√† y ins√©rer l'image cl√© AV1. Et c'est fait. Le nouveau format pour pousser l'image cl√© AV1 dans un conteneur HEIF s'appelle AVIF. C'est ce qui nous attend √† l'avenir. Peut-√™tre qu'un jour nous l'utiliserons nativement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais nous pouvons l'utiliser maintenant. Nous venons de mettre une image de la vid√©o sur la page et de dire: voila, vous avez une photo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/k0/cm/jqk0cmtzq6oafsae-uvllieobks.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment cela se fait-il dans webp? WebP est, comme je l'ai dit, une image cl√© VP8 emball√©e dans un conteneur appel√© riff. Il y a un tel en-t√™te dans le conteneur riff. L√†, ne le croyez pas, il est √©crit que c'est WebP. Qui en douterait. PNG dit que c'est PNG WebP, et le voil√†.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais WebP a une fonctionnalit√© int√©ressante: l'image cl√© VP8 peut se trouver √† l'int√©rieur, et c'est ce qu'on appelle g√©n√©ralement WebP. Mais l'image cl√© VP8 ne l'est peut-√™tre pas. En g√©n√©ral, WebP prend en charge la compression sans perte. WebP lossless est un format compl√®tement diff√©rent qui n'a rien √† voir avec VP8, compression avec perte, etc. Par cons√©quent, lorsque quelqu'un vous dit que WebP est plus efficace qu'autre chose, la premi√®re question √† se poser est de savoir WebP quelque chose? Parce que si nous parlons de compression sans perte, il y a une all√©e naturelle √† laquelle nous pouvons nous efforcer. Ces diff√©rences, "60% plus efficaces que ...", ne sont probablement pas sans perte, mais WebP avec pertes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, assez de th√©orie, j'en ai marre, regardons d√©j√† quelque chose. </font><b><sup><sub><font style="vertical-align: inherit;">Cliquable</font></sub></sup></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/y3/5q/ut/y35qutrwbylxwzjo_dj17alkys8.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par √ßa. Nous prenons une photo prise par un appareil photo professionnel. D√©coupez-en un morceau de 1000 par 1000 pixels. Incidemment, cela semble tr√®s cool sur le projecteur. Nous commen√ßons √† consid√©rer de petits d√©tails. Dans le m√™me temps, nous compressons cette pi√®ce pour obtenir exactement 15 kilo-octets. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Voir ce qui se passe. JPEG est tomb√© en blocs imm√©diatement. En effet, de faible qualit√©, on s'y attendait. </font><font style="vertical-align: inherit;">
Voici √† quoi ressemble WebP. Il est √©galement tomb√© en blocs, mais ces blocs ne sont pas si clairement visibles. Lorsque vous utilisez l'encodeur WebP et le contr√¥lez avec vos mains, vous pouvez contr√¥ler la puissance du filtre utilis√© dans WebP. Et si vous d√©vissez ce filtre plus fort, vous pouvez vous d√©barrasser d'un grand nombre d'artefacts de bloc. Par cons√©quent, purement th√©oriquement, ces blocs peuvent √©galement √™tre supprim√©s.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/9q/c_/jp/9qc_jpasvkhbwiz3zjpxhsgsgji.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici AV1. Admirons simplement en silence. Regardez comme il est cool. AV1 est pris en charge dans Firefox, dans Chrome, vous pouvez donc utiliser la vid√©o AV1 au lieu d'une image si vous le souhaitez. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Il y a un spoiler, en vain je l'ai ajout√©. La situation lorsque PNG bat WebP. Oui, PNG dans ce cas est plus efficace que WebP. C'est parce que j'ai utilis√© WebP avec perte. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Qu'est-ce que j'ai fait avec la peengeshka? J'ai fait le mode de couleur index√©, c'est-√†-dire que j'ai coup√© la palette, √† mon avis, √† 16 couleurs. C'est assez efficace pour une photo en noir et blanc. √áa s'est bien pass√©, √ßa s'est beaucoup contract√©. Pour le WebP avec perte de qualit√©, nous avons obtenu une taille plus grande. Cependant, pour sans perte, cela est pr√©vu, il est plus efficace que peengeshka. Nous avons gagn√©.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/z5/5e/bs/z55ebsmfycy45l6beelixuwfz2k.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/cl/yu/ua/clyuuarpr6mv6byxk2x_wlya7z4.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je r√©sume. Les pangshes encastr√©s tr√®s cool peuvent vaincre les formats de compression avec perte et ne pas vaincre WebP sans perte. Malheureusement, malheureusement. </font><b><sup><sub><font style="vertical-align: inherit;">Clickable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Peut-√™tre √™tes-vous tourment√© par la question: pourquoi faites-vous cela, savons-nous ce qu'est le SVG? Et je sais, mais pour certaines tailles, le PNG est plus efficace. Cette image s'av√®re plus efficace que SVG pour des tailles comme 200 par 200. Ensuite, SVG, bien s√ªr, gagne. </font><b><sup><sub><font style="vertical-align: inherit;">Cliquable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Maintenant, regardons Mike. Voici Mike. Ses dimensions sont de 3000 par 3000 pixels. JPEG vs WebP. Il √©tait √©vident ici que JPEG gagnait. Mais dans ce cas, j'ai obtenu environ six pour cent de victoire pour √† peu pr√®s la m√™me qualit√© visuelle. Ceci est une caract√©ristique de la photo et comment j'ai pr√©par√© cette photo. Vous pouvez alors me demander comment je l'ai fait.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/mk/br/bx/mkbrbxyyxxkfbft-22mssst0thk.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/io/5j/lq/io5jlqupl72tvqohsbyd0qqowmm.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/y2/0y/a_/y20ya_ybbu1hlmeqsp_b7ii3iv8.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliquable</font></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
, mais tout d√©pend beaucoup des param√®tres de l'encodeur. Si vous essayez tr√®s fort et d√©vissez les param√®tres de l'encodeur d'une mani√®re sp√©ciale, alors JPEG commencera √† vaincre WebP en taille pour la m√™me qualit√© visuelle. Je voudrais conclure que les chats r√©tr√©cissent mieux que JPEG, mais non. Ceci est juste un exemple de la fa√ßon dont vous pouvez le d√©visser comme vous le souhaitez si vous le souhaitez.</font><b><sup><sub><font style="vertical-align: inherit;"> Cliquable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Il s'agit d'une qualit√© tr√®s faible. JPEG tombe en blocs. Cela est particuli√®rement √©vident √† droite sur le projecteur - le nez est devenu bleu chez le chien, il est devenu carr√©. WebP n'est pas si malade. Tout semble √™tre cool et bon, mais le fait est que pour des qualit√©s tr√®s, tr√®s faibles, WebP donne environ deux, voire trois fois la taille du fichier que JPEG. Ici, vous devez √©galement r√©fl√©chir √† la qualit√© que vous souhaitez.</font><b><sup><sub><font style="vertical-align: inherit;"> Cliquable</font></sub></sup></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/3g/hr/06/3ghr06olqwqeom_ru2i0xvlki-u.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/9q/-f/xp/9q-fxpk1zj_xq3yjvdunqa2trrm.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est la comparaison la plus honn√™te. Il faut donc comparer, car H.264 et WebP sont similaires. Selon vous, qui a gagn√© ici? H.264. Mais pour √™tre honn√™te, l'exp√©rience n'√©tait pas enti√®rement propre. Dans le bon sens, √† la fois dans WebP et dans H.264, la trame vid√©o est √† peu pr√®s sans ambigu√Øt√©. </font><b><sup><sub><font style="vertical-align: inherit;">Cliquable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Mais avec AV1, tout est absolument clair. Trente pour cent gagnent sur la m√™me qualit√© visuelle. Hourra! </font><b><sup><sub><font style="vertical-align: inherit;">Cliquable</font></sub></sup></b><font style="vertical-align: inherit;"> 
Il est tr√®s important de comprendre quel type d'image vous mettez et comment tel ou tel format r√©pond √† la qualit√© de l'image. Ici, le chien au format WebP p√®se 79 kilo-octets en qualit√©, soit environ 75% contre 56 kilo-octets en JPEG. Pourquoi cela arrive-t-il?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/zn/yd/1u/znyd1unstrzgknbpbc_3w_flga0.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/gg/b9/pf/ggb9pfrw4c1vcjdjeb1g8qeyeum.jpeg"></a><br>
<b><sup><sub><font style="vertical-align: inherit;"></font></sub></sup></b><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parce que pas un seul codec vid√©o, pas un seul format ne peut compresser correctement le bruit. Si votre image pr√©sente de telles distorsions, points et autres choses, il est fort probable que vous ayez des probl√®mes de compression. Si vous pouvez prendre une autre photo et supprimer ce bruit, supprimez-le. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, les images sont une chose compliqu√©e. Peuvent-ils ralentir votre interface? Une question importante et bonne. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/ss/ux/wqssux2vgg3zjhog3chbctkuwxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©ponse: probablement pas. Pourquoi √ßa arrive? Parce que lorsque l'image est d√©cod√©e, elle se produit dans un flux s√©par√©. Mais il y a une exception - si vous dessinez quelque chose sur un canevas, vous devez vous rappeler que le d√©codage d'image se produira dans le flux principal et que les boutons ne peuvent pas √™tre press√©s √† ce moment.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/3-/x3/yb3-x3j8yz_y4lpg9i-zwlwhbjm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous voulez vraiment en faire une affaire, ouvrez Chrome, recherchez les threads de pixellisation correspondants et l'√©v√©nement Image Decode, vous le trouverez. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cz/hi/na/czhinaou_xikxzzjk8i_kzdvx3u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous √™tes tr√®s, tr√®s curieux, vous pouvez aller dans l'onglet de tra√ßage et y voir avec des d√©tails ce qui se passe lors du d√©codage d'une image.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outils d'optimisation </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La chose la plus importante est les outils d'optimisation. Nous savons maintenant √† peu pr√®s ce que nous voulons. Reste √† comprendre comment nous proc√©dons. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w5/o9/s1/w5o9s1vjdbzscsb_tr513umrqbu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'outil d'optimisation d'image le plus important est le concepteur, aussi √©trange que cela puisse para√Ætre. Seule cette merveilleuse personne sait quel probl√®me vous voulez r√©soudre avec lui. Nous n'ajoutons pas d'images aux pages afin de les optimiser au frais, mais pour impressionner les utilisateurs. Pour maintenir un √©quilibre entre le degr√© d'optimisation et l'exp√©rience utilisateur, utilisez un concepteur qui aide beaucoup. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dm/da/rj/dmdarj1ouin679hqaw075cozmiw.jpeg"><br>
<b><sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien de la diapositive Le</font></font></a></sub></sup></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
deuxi√®me outil est notre open source martien, dont j'ai promis de parler. Cette chose s'appelle imgproxy et r√©sout tous nos probl√®mes en g√©n√©ral. Sur mes projets, j'utilise uniquement imgproxy, cette chose peut faire presque tout ce que je veux.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/9a/fz/ex9afzkiiywmkkknxjrndj4svhs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment √ßa fonctionne? Avez-vous un souhait pour la photo. Vous voulez une image d'une certaine taille avec une certaine optimisation. Et quelque part loin, vous avez une image de toute r√©solution - peut-√™tre sur l'ordinateur local, ou peut-√™tre quelque part chez l'utilisateur ou en g√©n√©ral n'importe o√π. Il vous suffit de cr√©er une URL sp√©ciale et de demander √† imgproxy de redimensionner votre image. Il s'agit d'un tel service, il peut √™tre dans le cloud ou ailleurs. Autrement dit, vous aviez un √©norme chat, vous envoyez une URL sp√©ciale √† imgproxy. Il fait tout ce que vous voulez √† la vol√©e.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/de/9x/up/de9xupjotbsna-qdrecbjjixlz4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si cela ne semble pas clair, voyons √† quoi ressemble la demande d'imgproxy. Tout d'abord, vous devez indiquer o√π se trouve imgproxy. Deuxi√®mement, si vous ne voulez pas √™tre aspir√© de mani√®re agressive, l'URL que vous demandez serait bien de signer num√©riquement. Vous ne pouvez pas faire cela, c'est juste une mesure de protection suppl√©mentaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, si vous souhaitez redimensionner, passez directement dans l'url les param√®tres de redimensionnement. Si vous voulez optimiser - la m√™me chose. Il vous suffit de transf√©rer l'adresse d'origine de votre photo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iq/ij/zq/iqijzqvjy98twszsumxw5j-g_ds.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez des optimisations manuelles, il existe un vaste ensemble d'outils. Je ne vais pas tous les d√©crire maintenant. Le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mat√©riel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du rapport, que je vous enverrai, a tout.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sm/gb/1v/smgb1vvmd2kwmpgmtivk2var9dy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici le plus cool et utile. </font><font style="vertical-align: inherit;">Ces toutes les images ne sont pas si compliqu√©es. </font><font style="vertical-align: inherit;">Je pense que j'ai r√©ussi √† vous le transmettre. </font><font style="vertical-align: inherit;">Si vous √™tes int√©ress√©, prenez votre langage de programmation pr√©f√©r√© - probablement JavaScript, bien que loin d'√™tre un fait - et commencez √† tout r√©gler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez le faire dans un navigateur, veuillez. </font><font style="vertical-align: inherit;">Vous avez probablement besoin d'une liaison qui est probablement √©crite en plus ou en C. Mais qu'est-ce qui vous emp√™che de tout compiler dans WebAssembly? </font><font style="vertical-align: inherit;">Il y a une application sympa appel√©e Squoosh. </font><font style="vertical-align: inherit;">C'est exactement cela. </font><font style="vertical-align: inherit;">Vous aussi, essayez, ce sera cool. </font><font style="vertical-align: inherit;">J'aime vraiment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci √† tous pour votre attention. </font><font style="vertical-align: inherit;">Documents pour le rapport - par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©f√©rence</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493598/index.html">Masquer une partie du num√©ro de t√©l√©phone</a></li>
<li><a href="../fr493604/index.html">√âv√©nements num√©riques √† Moscou du 23 au 29 mars</a></li>
<li><a href="../fr493606/index.html">L'histoire de la cr√©ation d'un service cloud parfum√© au cyberpunk</a></li>
<li><a href="../fr493610/index.html">Programmation d'une couche vid√©o dans un Raspberry Pi √† l'aide de l'API DispmanX</a></li>
<li><a href="../fr493614/index.html">D√©tectez COVID-19 dans les rayons X avec Keras, TensorFlow et Deep Learning</a></li>
<li><a href="../fr493618/index.html">OSINT (pas) √©vident sur Twitter</a></li>
<li><a href="../fr493620/index.html">Courbe logistique. Quand l'√©pid√©mie prendra-t-elle fin?</a></li>
<li><a href="../fr493622/index.html">√âcrire un Retrowave sur Angular</a></li>
<li><a href="../fr493626/index.html">Selenoid - Des centaines de tests d'interface utilisateur parall√®les faciles et rapides. Pavel Senin</a></li>
<li><a href="../fr493630/index.html">Transfert des ports USB √† partir de Windows 10 pour le travail √† distance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>