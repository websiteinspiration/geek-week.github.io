<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游븿游 游뗸 游븿 PostgreSQL Antipatterns: una historia sobre el refinamiento iterativo de la b칰squeda por nombre u "Optimizaci칩n de ida y vuelta" 游늻 游니 游뱆游낖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Miles de gerentes de oficinas de ventas en todo el pa칤s registran decenas de miles de contactos en nuestro sistema CRM  todos los d칤as , hechos de com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PostgreSQL Antipatterns: una historia sobre el refinamiento iterativo de la b칰squeda por nombre u "Optimizaci칩n de ida y vuelta"</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tensor/blog/491162/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Miles de gerentes de oficinas de ventas en todo el pa칤s registran </font><b><font style="vertical-align: inherit;">decenas de miles de contactos</font></b><font style="vertical-align: inherit;"> en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuestro sistema CRM </font></font></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todos los d칤as</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hechos de comunicaci칩n con clientes potenciales o que ya trabajan con nosotros. Y para este cliente primero debe encontrar, y preferiblemente muy r치pidamente. Y esto sucede con mayor frecuencia por su nombre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, no es sorprendente que, una vez m치s analizando las solicitudes "pesadas" en una de las bases de datos m치s cargadas, nuestra propia </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuenta VLSI corporativa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , encontr칠 "en la parte superior" una </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicitud de b칰squeda "r치pida" por nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de tarjetas de empresa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem치s, una investigaci칩n adicional revel칩 un ejemplo interesante de </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimizaci칩n y luego degradaci칩n del rendimiento.</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solicitud en su posterior refinamiento por varios equipos, cada uno de los cuales actu칩 칰nicamente con buenas intenciones.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0: qu칠 quer칤a el usuario</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/du/k9/mg/duk9mgzeofw0ka5_lrg8lewch7k.png"></div><font color="#c0c0c0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[KDPV </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde aqu칤</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]</font></font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
쯈u칠 quiere decir usualmente el usuario cuando dice "b칰squeda r치pida" por nombre? </font><font style="vertical-align: inherit;">Casi nunca resulta ser una b칰squeda "honesta" en una subcadena de tipo </font></font><code>... LIKE '%%'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque entonces no solo </font><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">, sino </font><font style="vertical-align: inherit;">incluso, incluso </font><font style="vertical-align: inherit;">obtienen el resultado </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
El usuario implica a nivel de hogar que le proporcionar치 una </font><b><font style="vertical-align: inherit;">b칰squeda al comienzo de una palabra</font></b><font style="vertical-align: inherit;"> en el t칤tulo y mostrar치 m치s relevante lo que </font><b><font style="vertical-align: inherit;">comienza con el</font></b><font style="vertical-align: inherit;"> ingresado. </font><font style="vertical-align: inherit;">Y h치galo </font><b><font style="vertical-align: inherit;">casi instant치neamente</font></b><font style="vertical-align: inherit;"> , con entrada interlineal.</font></font><code>'<u></u>'</code><font style="vertical-align: inherit;"></font><code>' <u></u>'</code><font style="vertical-align: inherit;"></font><code>'<u></u>'</code><font style="vertical-align: inherit;"></font><code>'  <u></u>'</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1: limitar la tarea</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y a칰n m치s, una persona no ingresar치 espec칤ficamente </font></font><code>' '</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para que tenga que buscar cada prefijo de palabra. </font><font style="vertical-align: inherit;">No, es mucho m치s f치cil para el usuario responder a una pista r치pida para la 칰ltima palabra que "omitir" deliberadamente las anteriores; vea c칩mo funciona cualquier motor de b칰squeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, </font><font style="vertical-align: inherit;">formular </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correctamente los</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requisitos para una tarea es m치s de la mitad de la soluci칩n. </font><font style="vertical-align: inherit;">A veces, un an치lisis cuidadoso del caso de uso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede afectar significativamente el resultado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
쯈u칠 hace el desarrollador abstracto?</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0: motor de b칰squeda externo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh, buscar es dif칤cil, no quiero hacer nada en absoluto, 춰vamos a d치rselo a los devops! </font><font style="vertical-align: inherit;">Perm칤tanos desplegarnos un motor de b칰squeda externo en relaci칩n con la base de datos: Sphinx, ElasticSearch, ... Una </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
opci칩n que funciona, aunque consume mucho tiempo, en t칠rminos de sincronizaci칩n y velocidad de cambio. </font><font style="vertical-align: inherit;">Pero no en nuestro caso, ya que la b칰squeda se realiza para cada cliente solo en el marco de los datos de su cuenta. </font><font style="vertical-align: inherit;">Y los datos tienen una variabilidad bastante alta, y si el administrador ahora ha insertado la tarjeta </font></font><code>' '</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, despu칠s de 5-10 segundos ya puede recordar que olvid칩 indicar el correo electr칩nico all칤 y desea encontrarlo y corregirlo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, busquemos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"directamente en la base de datos"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Afortunadamente, PostgreSQL nos permite hacer esto, y no solo una opci칩n: las consideraremos.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1: subcadena "honesta"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos aferramos a la palabra "subcadena". </font><font style="vertical-align: inherit;">Pero exactamente para la b칰squeda de 칤ndice por subcadena (춰e incluso por expresiones regulares!) 춰Hay un excelente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m칩dulo pg_trgm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font><font style="vertical-align: inherit;">Solo entonces ser치 necesario ordenar correctamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tratemos de tomar un plato para simplificar el modelo:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> firms(
  <span class="hljs-keyword">id</span>
    <span class="hljs-built_in">serial</span>
      PRIMARY <span class="hljs-keyword">KEY</span>
, <span class="hljs-keyword">name</span>
    <span class="hljs-built_in">text</span>
);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Completamos all칤 7.8 millones de registros de organizaciones reales e indexamos:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> EXTENSION pg_trgm;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> firms <span class="hljs-keyword">USING</span> gin(<span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) gin_trgm_ops);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Busquemos las primeras 10 entradas para la b칰squeda entre l칤neas:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) ~ (<span class="hljs-string">'(^|\s)'</span> || <span class="hljs-string">''</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) ~ (<span class="hljs-string">'^'</span> || <span class="hljs-string">''</span>) <span class="hljs-keyword">DESC</span> <span class="hljs-comment">--  " "</span>
, <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-comment">--   </span>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;
</code></pre><br>
<img src="https://habrastorage.org/webt/0m/pk/su/0mpksuspk5xdasdj7mtg5ch4jvw.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[eche un vistazo a explicar.tensor.ru]</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bueno, eso es ... </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26 ms, 31 MB de</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> datos le칤dos y m치s de 1.700 registros filtrados, para 10 personas </font><font style="vertical-align: inherit;">La sobrecarga es demasiado alta, 쯘s posible ser de alguna manera m치s eficiente?</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2: b칰squeda de texto? </font><font style="vertical-align: inherit;">es FTS!</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, PostgreSQL proporciona un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mecanismo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muy poderoso </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">para la b칰squeda de texto completo</font></a><font style="vertical-align: inherit;"> (B칰squeda de texto completo), incluida la posibilidad de b칰squeda de prefijos. </font><font style="vertical-align: inherit;">춰Una gran opci칩n, incluso las extensiones no necesitan ser instaladas! </font><font style="vertical-align: inherit;">Intentemos:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> firms <span class="hljs-keyword">USING</span> gin(to_tsvector(<span class="hljs-string">'simple'</span>::regconfig, <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)));</code></pre><br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  to_tsvector(<span class="hljs-string">'simple'</span>::regconfig, <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)) @@ to_tsquery(<span class="hljs-string">'simple'</span>, <span class="hljs-string">':*'</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) ~ (<span class="hljs-string">'^'</span> || <span class="hljs-string">''</span>) <span class="hljs-keyword">DESC</span>
, <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br>
<img src="https://habrastorage.org/webt/wd/ln/tq/wdlntqgqo_zvb4sbhcq-wln_jrw.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[mire explicar.tensor.ru]</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Aqu칤 la paralelizaci칩n de la ejecuci칩n de consultas nos ayud칩 un poco, reduciendo el tiempo a la mitad a </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11 ms</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">S칤, y tuvimos que leer 1,5 veces menos, solo </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20 MB</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y aqu칤, cuanto m치s peque침o, mejor, porque cuanto mayor sea la cantidad que restamos, mayores ser치n las posibilidades de perder el cach칠, y cada p치gina adicional de datos le칤da del disco es un "freno" potencial para la solicitud.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3: 쮸칰n ME GUSTA?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La solicitud anterior es buena para todos, pero solo si la extrae cien mil veces al d칤a, se </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acumular치n 2 TB de</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> datos le칤dos. </font><font style="vertical-align: inherit;">En el mejor de los casos, desde la memoria, pero si no tienes suerte, desde el disco. </font><font style="vertical-align: inherit;">As칤 que tratemos de hacerlo m치s peque침o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recuerde que el usuario quiere ver </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primero "que comienza con ..."</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">춰As칤 que esto es en su forma pura una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b칰squeda de prefijo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con </font></font><code>text_pattern_ops</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! </font><font style="vertical-align: inherit;">Y solo si "no somos suficientes" hasta 10 registros requeridos, tendremos que leerlos usando la b칰squeda de FTS:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> firms(<span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) text_pattern_ops);</code></pre><br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">LIKE</span> (<span class="hljs-string">''</span> || <span class="hljs-string">'%'</span>)
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br>
<img src="https://habrastorage.org/webt/_7/e_/jx/_7e_jxpnkc7n97e9rj2rbbk2ukq.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[mire explicar.tensor.ru]</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Excelente rendimiento: 춰solo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">0.05 ms </font></a></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y un poco m치s de 100 KB de</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lectura! </font><font style="vertical-align: inherit;">Solo nos olvidamos de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ordenar por nombre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para que el usuario no se pierda en los resultados:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">LIKE</span> (<span class="hljs-string">''</span> || <span class="hljs-string">'%'</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br>
<img src="https://habrastorage.org/webt/ku/d4/r1/kud4r1oipobzbsljhvbavzd2ypa.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[mire explicar.tensor.ru]</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Oh, algo ya no es tan bonito: parece que hay un 칤ndice, pero la clasificaci칩n pasa volando ... Es, por supuesto, muchas veces m치s efectivo que la versi칩n anterior, pero ...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4: "modificar con un archivo"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hay un 칤ndice que le permite buscar por rango, y es normal usar la clasificaci칩n: </font><font style="vertical-align: inherit;">춰 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btree normal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> !</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> firms(<span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo una solicitud para ello deber치 "ensamblarse manualmente":</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) &gt;= <span class="hljs-string">''</span> <span class="hljs-keyword">AND</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) &lt;= (<span class="hljs-string">''</span> || <span class="hljs-keyword">chr</span>(<span class="hljs-number">65535</span>)) <span class="hljs-comment">--  UTF8,   - chr(255)</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
   <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br>
<img src="https://habrastorage.org/webt/eh/o3/-i/eho3-irvjqbcpgpmmp7fuheb9nm.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[mire explicar.tensor.ru] 춰</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Genial, tanto los trabajos de clasificaci칩n como el consumo de recursos siguen siendo "microsc칩picos", </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">miles de veces m치s eficientes que el FTS "puro"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font><font style="vertical-align: inherit;">Queda por recopilar en una sola solicitud:</font></font><br>
<br>
<pre><code class="sql hljs">(
  <span class="hljs-keyword">SELECT</span><font></font>
    *<font></font>
  <span class="hljs-keyword">FROM</span><font></font>
    firms<font></font>
  <span class="hljs-keyword">WHERE</span>
    <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) &gt;= <span class="hljs-string">''</span> <span class="hljs-keyword">AND</span>
    <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) &lt;= (<span class="hljs-string">''</span> || <span class="hljs-keyword">chr</span>(<span class="hljs-number">65535</span>)) <span class="hljs-comment">--  UTF8,    - chr(255)</span>
  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
     <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)
  <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span><font></font>
)<font></font>
<span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span><font></font>
(<font></font>
  <span class="hljs-keyword">SELECT</span><font></font>
    *<font></font>
  <span class="hljs-keyword">FROM</span><font></font>
    firms<font></font>
  <span class="hljs-keyword">WHERE</span>
    to_tsvector(<span class="hljs-string">'simple'</span>::regconfig, <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)) @@ to_tsquery(<span class="hljs-string">'simple'</span>, <span class="hljs-string">':*'</span>) <span class="hljs-keyword">AND</span>
    <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> (<span class="hljs-string">''</span> || <span class="hljs-string">'%'</span>) <span class="hljs-comment">-- " "    </span>
  <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) ~ (<span class="hljs-string">'^'</span> || <span class="hljs-string">''</span>) <span class="hljs-keyword">DESC</span> <span class="hljs-comment">--    ,     btree-</span>
  , <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>)
  <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span><font></font>
)<font></font>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observo que la segunda subconsulta </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ejecuta </font><b><font style="vertical-align: inherit;">si la primera devuelve menos del</font></b></font><code>LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n칰mero de filas </font><b><font style="vertical-align: inherit;">esperado por la</font></b><font style="vertical-align: inherit;"> 칰ltima </font><font style="vertical-align: inherit;">. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ya escrib칤</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre este m칠todo de optimizaci칩n de consultas </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces s칤, ahora tenemos btree y gin en la mesa al mismo tiempo, pero estad칤sticamente result칩 que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menos del 10% de las solicitudes llegan al segundo bloque</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es decir, con tales limitaciones t칤picas tan conocidas para la tarea, 춰pudimos reducir el consumo total de recursos del servidor en casi mil veces!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.5 *: prescindir del archivo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arriba se </font></font><code>LIKE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nos impidi칩 usar el tipo incorrecto. </font><font style="vertical-align: inherit;">Pero se puede "establecer en el camino verdadero" especificando la declaraci칩n USING:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El valor predeterminado es impl칤cito </font></font><code>ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Adem치s, puede especificar el nombre de un operador de clasificaci칩n espec칤fico en una oraci칩n </font></font><code>USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El operador de clasificaci칩n debe ser miembro menor o mayor que una determinada familia de operadores de 치rbol B. </font></font><code>ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generalmente equivalente </font></font><code>USING &lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>DESC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generalmente equivalente </font></font><code>USING &gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En nuestro caso, "menos" es </font></font><code>~&lt;~</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  firms<font></font>
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">LIKE</span> (<span class="hljs-string">''</span> || <span class="hljs-string">'%'</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>
  <span class="hljs-keyword">lower</span>(<span class="hljs-keyword">name</span>) <span class="hljs-keyword">USING</span> ~&lt;~
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>;</code></pre><br>
<img src="https://habrastorage.org/webt/s8/6r/4u/s86r4ujfiklgl9rqwn0fl7_g44i.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[mira explicar.tensor.ru]</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2: c칩mo "agriar" solicitudes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora dejamos nuestra solicitud de "insistir" durante medio a침o o un a침o, y con sorpresa lo volvemos a encontrar "en la parte superior" con indicadores del "bombeo" total diario de memoria ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffers hit compartido</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.5TB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, incluso m치s de lo que era originalmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No, por supuesto, nuestro negocio ha crecido y la carga ha aumentado, 춰pero no tanto! </font><font style="vertical-align: inherit;">Entonces algo est치 sucio aqu칤, vamos a resolverlo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1: el nacimiento de la paginaci칩n</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En alg칰n momento, otro equipo de desarrollo quer칤a hacer posible "saltar" al registro desde una b칰squeda r치pida de sub칤ndices con los mismos resultados, pero ampliados. </font><font style="vertical-align: inherit;">쯏 qu칠 registro sin navegaci칩n de p치gina? </font><font style="vertical-align: inherit;">춰A la mierda!</font></font><br>
<br>
<pre><code class="sql hljs">( ... LIMIT &lt;N&gt; + 10)<font></font>
UNION ALL<font></font>
( ... LIMIT &lt;N&gt; + 10)<font></font>
LIMIT 10 OFFSET &lt;N&gt;;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora era posible sin esfuerzo para el desarrollador mostrar el registro de resultados de b칰squeda con la carga de "p치gina de tipo". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, de hecho, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada p치gina de datos siguiente, se est치 leyendo m치s y m치s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (todo el tiempo anterior, que descartamos, m치s la "cola" deseada), es decir, este es un antipatr칩n inequ칤voco. </font><font style="vertical-align: inherit;">Y ser칤a m치s correcto comenzar la b칰squeda en la pr칩xima iteraci칩n desde la clave almacenada en la interfaz, pero al respecto, en otra ocasi칩n.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2: quiere ex칩tico</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En alg칰n momento, el desarrollador quer칤a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diversificar la selecci칩n resultante con datos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de otra tabla, para lo cual se envi칩 toda la solicitud anterior al CTE:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> q <span class="hljs-keyword">AS</span> (<font></font>
  ...<font></font>
  <span class="hljs-keyword">LIMIT</span> &lt;N&gt; + <span class="hljs-number">10</span><font></font>
)<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
  *<font></font>
, (<span class="hljs-keyword">SELECT</span> ...) sub_query <span class="hljs-comment">-- -    </span>
<span class="hljs-keyword">FROM</span><font></font>
  q<font></font>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span> <span class="hljs-keyword">OFFSET</span> &lt;N&gt;;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y a칰n as칤, no est치 mal, porque una subconsulta se calcula solo para 10 registros devueltos, si no ...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3: DISTINTO sin sentido y despiadado</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En alg칰n lugar del proceso de tal evoluci칩n, </font><b><font style="vertical-align: inherit;">se </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perdi칩</font></font><code>NOT LIKE</code><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una </font><b><font style="vertical-align: inherit;">condici칩n</font></b><font style="vertical-align: inherit;"> de la segunda subconsulta </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Est치 claro que despu칠s de eso </font></font><code>UNION ALL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comenc칠 a devolver </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algunos registros dos veces</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , primero encontrados al comienzo de la l칤nea, y luego nuevamente, al comienzo de la primera palabra de esta l칤nea. </font><font style="vertical-align: inherit;">En el l칤mite, todos los registros de la segunda subconsulta podr칤an coincidir con los registros de la primera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
쯈u칠 hace un desarrollador en lugar de buscar una raz칩n? .. 춰Sin dudas!</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duplicar el tama침o de las</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muestras originales</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ponga DISTINCT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para que obtengamos solo instancias individuales de cada fila</font></font></li>
</ul><br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> q <span class="hljs-keyword">AS</span> (<font></font>
  ( ... <span class="hljs-keyword">LIMIT</span> &lt;<span class="hljs-number">2</span> * N&gt; + <span class="hljs-number">10</span>)
  <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
  ( ... <span class="hljs-keyword">LIMIT</span> &lt;<span class="hljs-number">2</span> * N&gt; + <span class="hljs-number">10</span>)
  <span class="hljs-keyword">LIMIT</span> &lt;<span class="hljs-number">2</span> * N&gt; + <span class="hljs-number">10</span><font></font>
)<font></font>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span><font></font>
  *<font></font>
, (<span class="hljs-keyword">SELECT</span> ...) sub_query
<span class="hljs-keyword">FROM</span><font></font>
  q<font></font>
<span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span> <span class="hljs-keyword">OFFSET</span> &lt;N&gt;;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es decir, est치 claro que el resultado, al final, es exactamente el mismo, pero la posibilidad de "volar" a la segunda subconsulta CTE se ha vuelto mucho mayor, y sin esto, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">claramente se lee m치s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero esto no es lo m치s triste. </font><font style="vertical-align: inherit;">Como el desarrollador me pidi칩 que seleccionara, </font></font><b><code>DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no por espec칤fico, sino inmediatamente por todos los campos del</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registro, el campo sub_query, el resultado de la subconsulta, tambi칠n lleg칩 all칤 autom치ticamente. </font><font style="vertical-align: inherit;">Ahora, para la ejecuci칩n </font></font><code>DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, la base de datos ten칤a que ejecutar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no 10 subconsultas, 춰sino todas &lt;2 * N&gt; + 10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> !</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4: 춰cooperaci칩n sobre todo!</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, los desarrolladores vivieron, no se molestaron, porque en el registro fueron "parcheados" a valores significativos de N con una desaceleraci칩n cr칩nica en la recepci칩n de cada "p치gina" siguiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta que los desarrolladores de otro departamento acudieron a ellos y no quisieron utilizar un m칠todo tan conveniente </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para la b칰squeda iterativa</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , es decir, tomamos una pieza de alguna muestra, filtramos por condiciones adicionales, dibujamos el resultado, luego la siguiente pieza (que en nuestro caso se logra mediante aumentar N), y as칤 sucesivamente hasta que llenemos la pantalla. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, en el esp칠cimen capturado, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N alcanz칩 valores de casi 17K</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y en solo 24 horas, al menos 4K, tales solicitudes se ejecutaron "en la cadena". </font><font style="vertical-align: inherit;">El 칰ltimo de ellos ya escaneado audazmente</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 GB de memoria en cada iteraci칩n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br>
<br>
<h2></h2><br>
<img src="https://habrastorage.org/webt/zt/yx/ss/ztyxssr661ga_wndmpmqmvgtrq0.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es491138/index.html">Sat칠lite y torre de integraci칩n Ansible</a></li>
<li><a href="../es491146/index.html">UML para desarrolladores</a></li>
<li><a href="../es491150/index.html">C칩mo pirate칠 a los estafadores, o solo el interior de los paneles de phishing</a></li>
<li><a href="../es491154/index.html">B칰squeda de cursos: c칩mo construir una ruta de aprendizaje</a></li>
<li><a href="../es491156/index.html">Empat칤a medible: predicci칩n de simpat칤a por IRM cerebral</a></li>
<li><a href="../es491164/index.html">C칩mo programar un diploma para escribir. Gu칤a completa</a></li>
<li><a href="../es491170/index.html">C칩mo Amplifer usa Logux, una herramienta para la comunicaci칩n entre el cliente y el servidor</a></li>
<li><a href="../es491172/index.html">Cu치ndo un desarrollador front-end deber칤a cambiar de React a Vue, y cu치ndo complicar치 el desarrollo</a></li>
<li><a href="../es491174/index.html">No escriba lo mismo: c칩mo los componentes React reutilizados ayudar치n a los desarrolladores front-end a crear aplicaciones m치s r치pido</a></li>
<li><a href="../es491176/index.html">5 signos de un producto it para ser vendido</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>