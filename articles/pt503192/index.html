<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏾 🧑🏾‍🤝‍🧑🏻 ⛓️ oVirt em 2 horas. Parte 4. Operações Básicas 🤭 👩🏾 🗄️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje, examinamos várias operações básicas que o administrador do ambiente de virtualização precisará executar regularmente. O artigo é uma continuação...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt em 2 horas. Parte 4. Operações Básicas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503192/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hoje, examinamos várias operações básicas que o administrador do ambiente de virtualização precisará executar regularmente. </font><font style="vertical-align: inherit;">O artigo é uma continuação da série oVirt: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parte 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conteúdo</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma VM e modelo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migração de VM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (migração ao vivo);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migração de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> armazenamento (migração de armazenamento);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renomeie a VM e o disco</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizar oVirt-Host</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (hypervisor);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizar oVirt-Engine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (gerente);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VM de importação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de tarefas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artigos</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdução</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalação do gerenciador (mecanismo de ovirt) e hipervisores (hosts) </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurações adicionais</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operações Básicas - Estamos Aqui</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tradicionalmente, para obter detalhes sobre tarefas administrativas, bem-vindo à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao entrar no oVirt, você verá 2 portais:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portal de administração</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portal da VM</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O primeiro é destinado às tarefas administrativas e administrativas, o segundo - para clientes de máquinas, mas também pode ser usado pelo administrador - algumas funções são ainda mais convenientes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na parte superior da janela de cada coleção de objetos oVirt, há uma poderosa caixa de pesquisa, com avisos contextuais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como exemplo, selecionar hosts com problemas no painel de controle causa um filtro:</font></font><br>
<br>
<pre><code class="plaintext hljs">status = unassigned or status = maintenance or status = installing or status = reboot or status = preparingformaintenance or status = pendingapproval or status = connecting or status = installingos or status = kdumping</code></pre><br>
<a name="vm-pool"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criar VM e modelo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acho que você criou uma VM simples já na Parte 2, agora conheceremos outras entidades oVirt que estão diretamente relacionadas às máquinas virtuais - máquinas virtuais, modelos e pools. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um modelo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é uma cópia de uma máquina (geralmente pré-preparada) projetada para criar máquinas idênticas (clonagem). O modelo pode ter uma versão, é conveniente, porque não é necessário criar um novo modelo separado após cada atualização da máquina de referência. Mais detalhes na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um pool</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é um grupo de máquinas idênticas geradas a partir de um único modelo. Conveniente para VDI (infraestrutura de desktop virtual), quando dezenas ou centenas de usuários precisam fornecer um ambiente de trabalho idêntico e isso é feito literalmente em um piscar de olhos. Leia mais sobre pools na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos criar um modelo para o qual podemos clonar uma máquina criada anteriormente, mas, para demonstração, iremos para o outro lado - importe um modelo da coleção externa Glance Images: Storage -&gt; Domains -&gt; ovirt-image-repository (1), Import (2): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fx/gg/lt/fxggltgss5p9llxyplgghxmpbsg.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1 - Importação da imagem do Fedora 32.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Marcamos “Importar como Modelo” (3, Importar como Modelo), fornecemos um nome ao modelo (4). É altamente recomendável que o disco receba um nome amigável (5, Alias ​​do disco). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O andamento das tarefas é convenientemente monitorado na seção </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarefas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/p6/co/cjp6cor50gw2euzkgnf_vl-lc24.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 2 - Progresso na conclusão de tarefas no oVirt.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Após o upload bem-sucedido, o modelo é adicionado à lista. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cg/_n/o3/cg_no3kzfukaodkzouox0q2bt3q.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 3 - Modelos.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Com base no modelo carregado, crie um pool: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/qk/aj/fnqkajhsx4hrbzr_wc8jozs9zua.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4 - Criando um pool.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos para Compute -&gt; Pools (1), New (2), selecione o modelo Fedora32 (3), a versão - ultimas (4), atribua o nome "myPoolA- ??" (5) Ainda não tocamos nos campos Número de VM e VM pré-iniciada; retornaremos a eles na próxima etapa. Em seguida, ative as configurações avançadas (6) e prossiga para a configuração da Execução inicial. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/m5/dj/zxm5djt-ud05hne1hyahor2nluo.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 4 - Configure a inicialização inicial.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Porque da Glance Images, baixamos o Cloud Image, precisamos configurar a autenticação. Verifique se “Usar Cloud-Init / Sysprep” (1) está ativado, abra Autenticação (2), especifique o nome de usuário, por exemplo, raiz ou usuário (3). Para criar uma senha exclusiva para o pool, desative "Usar senha já configurada" (4) e digite sua senha (5). Clique em “OK” - o pool é criado, máquinas idênticas aparecem em Computação -&gt; Máquinas Virtuais (preste atenção ao ícone, é diferente de uma máquina que trabalha separadamente). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota sobre o nome da piscina. Como você notou, no final é "- ??". Isso inclui a numeração "normalizada" de máquinas (complementada por zeros - 01, 02, ..., 09, 10 etc.). Caso contrário, a numeração será um número natural sem alinhamento (1, 2, ..., 9, 10, ...)</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de continuar, vamos voltar às configurações do pool. </font><font style="vertical-align: inherit;">Observe que o campo "Número de VM" foi alterado para "Aumentar o número de VMs no pool em". </font><font style="vertical-align: inherit;">Nós especificamos 31 aqui e o número de máquinas no pool quase instantaneamente se torna 32. Agora, no campo "VM pré-iniciada", inserimos 16 - isso forçará o oVirt a manter o número especificado de máquinas pré-inicializadas e prontas para conectar os usuários. </font><font style="vertical-align: inherit;">É aqui que concluiremos sobre máquinas, modelos e pools e seguiremos para a migração. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ícones principais da VM:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unidade de rack - servidor;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitor - desktop;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 torres - servidor da piscina;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 monitores - área de trabalho da piscina;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rebobinar (rebobinar) - sem estado (a máquina redefine seu estado para seu estado original após o desligamento; todas as alterações são revertidas);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">triângulo no monitor laranja - a alteração solicitada na configuração requer uma reinicialização.</font></font></li>
</ul><br>
<a name="live-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migração de VM (migração ao vivo)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A migração do estado da máquina ligada é simples - clique com o botão direito do mouse em uma máquina ou em um grupo de máquinas. </font><font style="vertical-align: inherit;">O procedimento é semelhante ao do vMotion no vSphere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/ne/dz/zmnedzcid6vyhsgubvv95u6cnsy.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">5 - Inicie a migração. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computar -&gt; Máquina Virtual, selecione uma ou mais máquinas, Migrar. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/bp/9h/8vbp9hslgmoa_n_v3ltlmuxfknw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">6 - O processo de migração pode ser observado nos hosts (Computar -&gt; Hosts). </font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, não mais de 2 carros estão em movimento.</font></font><br>
<a name="storage-migration"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Migração de armazenamento</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas esse procedimento pode parecer incomum para o usuário do VMware vSphere, porque </font><font style="vertical-align: inherit;">as abordagens para armazenar imagens de disco e configurações de máquina em sistemas são diferentes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para transferir o armazenamento da VM, vá para os discos (Armazenamento -&gt; Discos) ou domínios (Armazenamento -&gt; Domínios -&gt; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{Nome do Domínio}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -&gt; Discos). </font><font style="vertical-align: inherit;">Selecione as unidades e pressione </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mover</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">É isso, as unidades são enviadas para outro armazenamento. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: devido à organização interna, há restrições para migrar o armazenamento e o conjunto de modelos. </font><font style="vertical-align: inherit;">A familiaridade com a migração de armazenamento é melhor realizada em uma máquina separada, fora do pool. </font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A cópia do disco é realizada nos mesmos menus do carregamento / descarregamento manual.</font></font><br>
<a name="rename"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renomear VM e disco</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alterar o nome de uma máquina ou modelo é muito simples - Edite e insira um novo nome. </font><font style="vertical-align: inherit;">Renomear um pool requer excluir suas máquinas e recriá-las, porque </font><font style="vertical-align: inherit;">com base nele, as VMs são geradas com os nomes e a configuração correspondentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Também é possível renomear um disco, mas o caminho é maior que </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e: Compute -&gt; Virtual Machine -&gt; {VM Name} -&gt; Disks -&gt; {VM Disk Alias} -&gt; Edit, Alias. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Identificadores de objetos internos são criados em UUIDs. </font><font style="vertical-align: inherit;">Ao renomear, na verdade alteramos os aliases. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seção trata da atualização, que é atualização (menor), não atualização (principal), quando o número da versão muda (esse é um procedimento mais complicado e não faz parte das tarefas diárias).</font></font><br>
<a name="update-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizar oVirt-Host (hypervisor)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As atualizações de host são mais simples que no vSphere, o gerenciador de atualizações no oVirt é integrado organicamente na plataforma e não requer configurações. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oficial de </font><font style="vertical-align: inherit;">atualização. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/we/j1/fjwej1ph06a03bqpfx2ye6ijeny.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 7 - Se houver atualizações, o gerente as reportará com um ícone de CD. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ww/vw/rn/wwvwrnz9q9hizaqo3mfndfihp_m.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 8 - Antes de iniciar a atualização, você precisa habilitar o modo de manutenção (Gerenciamento -&gt; Manutenção), ele iniciará automaticamente a migração da VM para outros hosts (consulte a Fig. 6) e se preparará para a atualização. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ol/ry/fw/olryfwdduor2j39tr47n8zlnpew.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 9 - O ícone da chave inglesa indica que o host está pronto para o serviço. </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ov/rt/ta/ovrttawkmmi6fkfp-wic5_mpy00.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 10 - Instalação -&gt; Atualização inicia o procedimento de atualização. </font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/8z/ch/7s/8zch7sdgo_plq5suw8yevk8nzz8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 11 - Podemos pedir ao gerente que dê ao host um comando para reiniciar após a atualização ser concluída, para que ela entre em vigor.</font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ze/dg/kb/zedgkbmmuxxm7kvy6qoxhh-bvza.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">12 - Após a reinicialização, colocamos o hipervisor fora de serviço (Gerenciamento -&gt; Ativar). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinamos todos os hosts e os atualizamos.</font></font><br>
<a name="update-engine"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizar oVirt-Engine (gerente)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No início, isso pode ser confuso, mas a atualização do gerente é realizada usando a configuração do mecanismo, com etapas adicionais, conforme descrito na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se possível, faça um archive ou uma captura instantânea da máquina, verifique se o último backup agendado foi bem-sucedido.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificamos e atualizamos pacotes de instalação:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-upgrade-check<font></font>
$ sudo update ovirt\*setup\*</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A parte principal da atualização é realizada pelo programa de configuração do mecanismo. </font><font style="vertical-align: inherit;">Ela fará uma série de perguntas de configuração, interrompe o serviço do ovirt-engine, baixa e instala pacotes atualizados, cria um arquivo morto e atualiza o banco de dados, aplica a configuração atualizada e inicia o serviço do ovirt-engine.</font></font><br>
 <br>
<pre><code class="bash hljs">$ sudo engine-setup</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Após a atualização bem-sucedida, receberemos a mensagem:</font></font><br>
 <br>
<pre><code class="plaintext hljs">Execution of setup completed successfully</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo de saída do script de configuração do mecanismo</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">$ sudo engine-setup</code></pre><br>
<pre><code class="plaintext hljs">[ INFO  ] Stage: Initializing<font></font>
[ INFO  ] Stage: Environment setup<font></font>
          Configuration files: ['/etc/ovirt-engine-setup.conf.d/10-packaging-jboss.conf', '/etc/ovirt-engine-setup.conf.d/10-packaging.conf', '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf']<font></font>
          Log file: /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
          Version: otopi-1.8.2 (otopi-1.8.2-1.el7)<font></font>
[ INFO  ] Stage: Environment packages setup<font></font>
[ INFO  ] Stage: Programs detection<font></font>
[ INFO  ] Stage: Environment setup (late)<font></font>
[ INFO  ] Stage: Environment customization<font></font>
         <font></font>
          --== PRODUCT OPTIONS ==--<font></font>
         <font></font>
         <font></font>
          --== PACKAGES ==--<font></font>
         <font></font>
[ INFO  ] Checking for product updates...<font></font>
          Setup needs to install or update the following packages:<font></font>
          [updated] ovirt-engine-4.3.5.5-1.el7.noarch will be updated<font></font>
...<font></font>
          [update] ovirt-engine-wildfly-overlay-17.0.1-1.el7.noarch is an update<font></font>
          Replying "No" will abort Setup. You can pass the option "--offline" to prevent installing or updating packages.<font></font>
          Do you wish to update them now? (Yes, No) [Yes]: <font></font>
[ INFO  ] Checking for an update for Setup...<font></font>
         <font></font>
          --== NETWORK CONFIGURATION ==--<font></font>
         <font></font>
          Setup can automatically configure the firewall on this system.<font></font>
          Note: automatic configuration of the firewall may overwrite current settings.<font></font>
          NOTICE: iptables is deprecated and will be removed in future releases<font></font>
          Do you want Setup to configure the firewall? (Yes, No) [Yes]: <font></font>
[ INFO  ] firewalld will be configured as firewall manager.<font></font>
         <font></font>
          --== DATABASE CONFIGURATION ==--<font></font>
         <font></font>
          The detected DWH database size is 439 MB.<font></font>
          Setup can backup the existing database. The time and space required for the database backup depend on its size. This process takes time, and in some cases (for instance, when the size is few GBs) may take several hours to complete.<font></font>
          If you choose to not back up the database, and Setup later fails for some reason, it will not be able to restore the database and all DWH data will be lost.<font></font>
          Would you like to backup the existing database before upgrading it? (Yes, No) [Yes]: <font></font>
          Perform full vacuum on the oVirt engine history<font></font>
          database ovirt_engine_history@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== OVIRT ENGINE CONFIGURATION ==--<font></font>
         <font></font>
          Perform full vacuum on the engine database engine@localhost?<font></font>
          This operation may take a while depending on this setup health and the<font></font>
          configuration of the db vacuum process.<font></font>
          See https://www.postgresql.org/docs/10/sql-vacuum.html<font></font>
          (Yes, No) [No]: <font></font>
         <font></font>
          --== STORAGE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== PKI CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== APACHE CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== SYSTEM CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== MISC CONFIGURATION ==--<font></font>
         <font></font>
         <font></font>
          --== END OF CONFIGURATION ==--<font></font>
         <font></font>
[ INFO  ] Stage: Setup validation<font></font>
          During execution engine service will be stopped (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning stale zombie tasks and commands<font></font>
         <font></font>
          --== CONFIGURATION PREVIEW ==--<font></font>
         <font></font>
          Default SAN wipe after delete           : False<font></font>
          Firewall manager                        : firewalld<font></font>
          Update Firewall                         : True<font></font>
          Host FQDN                               : ovirt.example.com<font></font>
          Upgrade packages                        : True<font></font>
          Set up Cinderlib integration            : False<font></font>
          Engine database secured connection      : False<font></font>
          Engine database user name               : engine<font></font>
          Engine database name                    : engine<font></font>
          Engine database host                    : localhost<font></font>
          Engine database port                    : 5432<font></font>
          Engine database host name validation    : False<font></font>
          Engine installation                     : True<font></font>
          PKI organization                        : JSC Open Lab<font></font>
          Set up ovirt-provider-ovn               : False<font></font>
          Configure WebSocket Proxy               : True<font></font>
          DWH installation                        : True<font></font>
          DWH database secured connection         : False<font></font>
          DWH database host                       : localhost<font></font>
          DWH database user name                  : ovirt_engine_history<font></font>
          DWH database name                       : ovirt_engine_history<font></font>
          Backup DWH database                     : True<font></font>
          DWH database port                       : 5432<font></font>
          DWH database host name validation       : False<font></font>
          Configure Image I/O Proxy               : True<font></font>
          Configure VMConsole Proxy               : True<font></font>
         <font></font>
          Please confirm installation settings (OK, Cancel) [OK]: <font></font>
[ INFO  ] Cleaning async tasks and compensations<font></font>
[ INFO  ] Unlocking existing entities<font></font>
[ INFO  ] Checking the Engine database consistency<font></font>
[ INFO  ] Stage: Transaction setup<font></font>
[ INFO  ] Stopping engine service<font></font>
[ INFO  ] Stopping ovirt-fence-kdump-listener service<font></font>
[ INFO  ] Stopping dwh service<font></font>
[ INFO  ] Stopping Image I/O Proxy service<font></font>
[ INFO  ] Stopping vmconsole-proxy service<font></font>
[ INFO  ] Stopping websocket-proxy service<font></font>
[ INFO  ] Stage: Misc configuration (early)<font></font>
[ INFO  ] Stage: Package installation<font></font>
[ INFO  ] Yum Status: Downloading Packages<font></font>
...<font></font>
[ INFO  ] Stage: Misc configuration<font></font>
[ INFO  ] Upgrading CA<font></font>
[ INFO  ] Not rewriting /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
[ INFO  ] Backing up database localhost:ovirt_engine_history to '/var/lib/ovirt-engine-dwh/backups/dwh-20200522233531.6LDItj.dump'.<font></font>
[ INFO  ] Creating/refreshing DWH database schema<font></font>
[ INFO  ] Configuring Image I/O Proxy<font></font>
[ INFO  ] Configuring WebSocket Proxy<font></font>
[ INFO  ] Backing up database localhost:engine to '/var/lib/ovirt-engine/backups/engine-20200522233538.LZCwME.dump'.<font></font>
[ INFO  ] Creating/refreshing Engine database schema<font></font>
[ INFO  ] Creating/refreshing Engine 'internal' domain database schema<font></font>
          Unregistering existing client registration info.<font></font>
[ INFO  ] Generating post install configuration file '/etc/ovirt-engine-setup.conf.d/20-setup-ovirt-post.conf'<font></font>
[ INFO  ] Stage: Transaction commit<font></font>
[ INFO  ] Stage: Closing up<font></font>
[ INFO  ] Starting engine service<font></font>
[ INFO  ] Starting dwh service<font></font>
[ INFO  ] Restarting ovirt-vmconsole proxy service<font></font>
         <font></font>
          --== SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Restarting httpd<font></font>
          Web access is enabled at:<font></font>
              http://ovirt.example.com:80/ovirt-engine<font></font>
              https://ovirt.example.com:443/ovirt-engine<font></font>
          SSH fingerprint: SHA256:JvilhbwRuMjBCJEjQVPlFQgk0aLaKz7Od0WzsZtx4j4<font></font>
          Did not update /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf because it was changed manually. You might want to compare it with /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf.new and edit as needed.<font></font>
         <font></font>
          --== END OF SUMMARY ==--<font></font>
         <font></font>
[ INFO  ] Stage: Clean up<font></font>
          Log file is located at /var/log/ovirt-engine/setup/ovirt-engine-setup-20200522232449-o97vyx.log<font></font>
[ INFO  ] Generating answer file '/var/lib/ovirt-engine/setup/answers/20200522233608-setup.conf'<font></font>
[ INFO  ] Stage: Pre-termination<font></font>
[ INFO  ] Stage: Termination<font></font>
[ INFO  ] Execution of setup completed successfully</code></pre></div>
                    </div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizamos o sistema operacional e outros pacotes adicionais:</font></font><br>
 <pre><code class="bash hljs">$ sudo yum update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Se necessário (atualizando o kernel ou seus componentes), reinicializamos a máquina.</font></font></li>
</ol><br>
<a name="import-vm"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar VM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode importar do VMware, Exportar Domínio (entidade especial oVirt para a troca de imagens entre o Data Center), Dispositivo virtual (OVA), XEN, KVM. </font><font style="vertical-align: inherit;">Todas as opções oficialmente suportadas:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A VM de importação do VMware ESXi / VSPHERE é executada no host + autenticação para o host em que o ESXi / VSPHERE é executado</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar VM KVM / Xen da Libvirt: o usuário especifica autenticação de URL + para o host em que a Libvirt é executada</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar VM KVM / Xen de um determinado caminho: O usuário especifica o caminho nfs / posix para a configuração e os discos da VM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar VM que foi exportada do VMware: O usuário especifica o caminho nfs / posix para o arquivo ova</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregar VM KVM / Xen: o usuário especifica arquivos da configuração e dos discos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregar VM que foi exportada do VMware: O usuário especifica o arquivo ova</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar VM da pasta: o usuário especifica o caminho para a pasta que contém VMs KVM / Xen ou VM exportadas do VMware</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos considerar duas opções - importar do vSphere e uma máquina independente com o KVM. </font><font style="vertical-align: inherit;">Para iniciar a importação de material em Compute -&gt; Virtual Machines, clique no botão para itens de menu adicionais (3 pontos verticais, veja a Fig. 13). </font><font style="vertical-align: inherit;">A máquina de origem deve estar desligada.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar máquinas do vCenter</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No assistente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonte de dados: VMware;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fornecedor externo: em Administração -&gt; Fornecedores, você pode configurar um modelo para operações frequentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCenter: nome ou endereço do servidor vCenter;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESXi: de qual hipervisor pegaremos o carro;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Ceter: caminho completo para o cluster;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster: contendo um cluster de hipervisor;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nome de usuário / senha: nome de usuário e senha para conectar-se ao vCenter;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifique o certificado SSL do servidor: ao usar certificados autoassinados, você terá que desativar a verificação deles.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/g9/0i/4b/g90i4btxfdhaz_ji-bntbutlaei.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">13 - Importar VMs do VMware vSphere.</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importar máquinas da KVM</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Detalhes sobre a importação do KVM na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, você deve habilitar a conexão com o KVM de fora, se isso não tiver sido configurado anteriormente.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permissão para exportar máquinas para a KVM</font></font></b>
                        <div class="spoiler_text">        ,      .       ! ,      ,        ,       .     , .,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">ArchLinux</a>.<br>
<br>
 ,   libvirtd<br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/sysconfig/libvirtd</code></pre><br>
 <br>
<br>
<pre><code class="plaintext hljs">LIBVIRTD_ARGS="--listen"</code></pre><br>
      <br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/libvirt/libvirtd.conf /etc/libvirt/libvirtd.conf.`date +%F`<font></font>
$ sudo vim /etc/libvirt/libvirtd.conf</code></pre><br>
  :<br>
<br>
<pre><code class="plaintext hljs">listen_tls = 0<font></font>
listen_tcp = 1<font></font>
listen_addr = "0.0.0.0"<font></font>
auth_tcp = "none"</code></pre><br>
     <br>
<br>
<pre><code class="plaintext hljs">log_outputs="3:syslog:libvirtd"</code></pre><br>
    libvirtd.    ,    libvirtd &gt; 0.6 (  libvirtd --version),   .<br>
<br>
<pre><code class="bash hljs">$ sudo service libvirtd restart</code></pre><br>
     tcp:16509.<br>
<br>
 CentOS 7     (  permanent):<br>
<br>
<pre><code class="bash hljs">$ sudo firewall-cmd --add-rich-rule=<span class="hljs-string">'rule family="ipv4" source address="172.17.71.32/30" port port="16509" protocol="tcp" accept'</span></code></pre><br>
 :<br>
<br>
<pre><code class="bash hljs">$ virsh -r -c <span class="hljs-string">'qemu+tcp://mgmt@kvm46.example.com/system'</span> list --all</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, a importação em si é muito simples: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computar -&gt; Máquinas Virtuais -&gt;: (menu adicional, 3 pontos verticais) -&gt; Importar -&gt; Origem (KVM via libvirt) -&gt; URI (qemu + tcp: //kvm46.example.com / system) -&gt; Exigir autenticação (Desativar) -&gt; Carregar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Marcamos as máquinas necessárias, selecionamos a política de alocação (Política de Alocação). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Política de alocação - O pré-alocado é preferido para volumes de armazenamento com detecção de zero de hardware, para volumes com alta E / S, volumes com alta ocupação, etc., caso contrário, o thin provisioning pode ser. De qualquer forma, analisamos a situação e a analisamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O “Clonar” marcado marca, mas não copia o carro. Por exemplo, um novo endereço MAC para a interface de rede será atribuído.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na guia Geral, é importante especificar o tipo correto de sistema operacional e, na guia Interfaces de rede, você pode especificar a rede desejada. </font><font style="vertical-align: inherit;">Em seguida, "importe" e, dependendo da velocidade do equipamento, obtemos a máquina importada. </font><font style="vertical-align: inherit;">Após a importação (ou antes), não esqueça de instalar o ovirt-guest-agent.</font></font><br>
<br>
<a name="task-mgmt"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de tarefas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando as tarefas congelam, começam as difíceis danças, algumas das quais tentarei abordar. </font><font style="vertical-align: inherit;">Com comportamento regular, pode-se observá-los na Fig. </font><font style="vertical-align: inherit;">2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a tarefa for executada mais ou menos normalmente, ferramentas regulares serão suficientes. </font><font style="vertical-align: inherit;">Com pimers e fotos você pode ver </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As tarefas são executadas no oVirt-host.</font></font><br>
<br>
<pre><code class="plaintext hljs">[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task getStatus taskID=&lt;TASKID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task stop taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Task clear taskID=&lt;TaskID&gt;<font></font>
[mgmt@ovirt-nodeNN] $ sudo vdsm-client Host getAllTasksInfo</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, o vdsm-client pode tentar reverter a tarefa, todos os métodos suportados:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vdsm-client Task -h</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Métodos da tarefa: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 método [arg = value] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getStatus Obtenha informações de status da tarefa. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 reverter a reversão de uma tarefa para restaurar o estado anterior do sistema. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 desmarque Descartar informações sobre uma tarefa concluída. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 getInfo Obtenha informações sobre uma tarefa. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 stop Interrompe uma tarefa em execução no momento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, os movimentos se tornam mais complicados se a tarefa não puder ser interrompida usando métodos padrão. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oficialmente, a ferramenta taskcleaner é usada para isso:</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo /usr/share/ovirt-engine/setup/dbutils/taskcleaner.sh --<span class="hljs-built_in">help</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para casos ainda mais graves, é necessária a edição direta do banco de dados. </font><font style="vertical-align: inherit;">Esse método deve ser utilizado apenas como último recurso, com novos arquivos do oVirt e das máquinas afetadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, conectamos a coleção de software</font></font><br>
<br>
<pre><code class="bash hljs">[mgmt@ovirt-engine] $ sudo scl <span class="hljs-built_in">enable</span> rh-postgresql10 <span class="hljs-string">"psql -d engine -U postgres"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, conecte-se ao banco de dados</font></font><br>
<br>
<pre><code class="plaintext hljs">su postgres<font></font>
psql -d engine -U postgres<font></font>
select * from job order by start_time desc;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E remoção direta - executando o procedimento DeleteJob para a tarefa problemática:</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('UUID_HERE');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo:</font></font><br>
<br>
<pre><code class="plaintext hljs">select DeleteJob('ed0127c7-b052-4ec2-a67c-8b3a65d55e19');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso é tudo por hoje, e espero que você nunca precise editar manualmente um banco de dados!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt503172/index.html">C #: Apresentando geradores de código-fonte</a></li>
<li><a href="../pt503176/index.html">Implementação de um algoritmo para determinar a largura de um objeto usando um rangefinder ultrassônico e codificadores na linguagem RobotC</a></li>
<li><a href="../pt503178/index.html">Apple Mac e dispositivos sofisticados. LTO, SAS, Fibre Channel, eSATA</a></li>
<li><a href="../pt503182/index.html">"Sou o primeiro desenvolvedor cego da minha empresa." Parte 1</a></li>
<li><a href="../pt503184/index.html">Convidamos você para a reunião on-line do Zabbix</a></li>
<li><a href="../pt503194/index.html">ISA não perdoa erros</a></li>
<li><a href="../pt503196/index.html">450 cursos gratuitos da Ivy League</a></li>
<li><a href="../pt503200/index.html">YOLOv4 - a rede neural em tempo real mais precisa no conjunto de dados Microsoft COCO</a></li>
<li><a href="../pt503204/index.html">Como flash Xiaomi Redmi 4 Prime / Pro / Premium no Android 10</a></li>
<li><a href="../pt503208/index.html">Quando é o melhor momento para investir?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>