<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§ ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ¥Š é€šè¿‡ActiveX Serverè½»æ¾è®¿é—®LabVIEW VI PHPåº”ç”¨ç¨‹åº ğŸ™„ ğŸ§›ğŸ¿ ğŸ¤©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤šå¹´ä»¥æ¥ï¼ŒLabVIEWä»…ä½¿ç”¨å†…ç½®çš„ActiveXæœåŠ¡å™¨å³å¯å°†Webä¸VIè®¾å¤‡â€œç»‘å®šâ€åœ¨ä¸€èµ·ï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•å¤æ‚çš„LabVIEWå‘å¸ƒå’ŒæœåŠ¡å™¨è®¾ç½®ã€‚LabVIEW 2020ç¤¾åŒºç‰ˆä¹Ÿä¸ä¾‹å¤–ã€‚
 
 ç›®å‰ï¼Œå¯¹äºLabVIEWï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥åœ¨ç½‘ç»œä¸Šå‘å¸ƒè™šæ‹Ÿè®¾å¤‡ï¼Œéœ€è¦ä¸åŒç¨‹åº¦çš„çŸ¥è¯†å¹¶æä¾›ä¸åŒçš„åŠŸèƒ½ã€‚åœ¨æœ¬æ–‡ä¸­...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>é€šè¿‡ActiveX Serverè½»æ¾è®¿é—®LabVIEW VI PHPåº”ç”¨ç¨‹åº</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502496/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šå¹´ä»¥æ¥ï¼ŒLabVIEWä»…ä½¿ç”¨å†…ç½®çš„ActiveXæœåŠ¡å™¨å³å¯å°†Webä¸VIè®¾å¤‡â€œç»‘å®šâ€åœ¨ä¸€èµ·ï¼Œè€Œæ— éœ€è¿›è¡Œä»»ä½•å¤æ‚çš„LabVIEWå‘å¸ƒå’ŒæœåŠ¡å™¨è®¾ç½®ã€‚</font><font style="vertical-align: inherit;">LabVIEW 2020ç¤¾åŒºç‰ˆä¹Ÿä¸ä¾‹å¤–ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç›®å‰ï¼Œå¯¹äºLabVIEWï¼Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥åœ¨ç½‘ç»œä¸Šå‘å¸ƒè™šæ‹Ÿè®¾å¤‡ï¼Œéœ€è¦ä¸åŒç¨‹åº¦çš„çŸ¥è¯†å¹¶æä¾›ä¸åŒçš„åŠŸèƒ½ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä¸å¯¹å®ƒä»¬è¿›è¡Œæè¿°ï¼Œè€Œæ˜¯å‘æ‚¨ä»‹ç»LabVIEWä¸­é›†æˆçš„ActiveX / COMæœåŠ¡å™¨çš„éæ ‡å‡†ç”¨æ³•ï¼Œä»¥ç»„ç»‡å¯¹VIçš„Webè®¿é—®ä»¥åŠæ§åˆ¶LabVIEWç¯å¢ƒæœ¬èº«ã€‚å°½ç®¡ActiveX / COMå·²ç»æ˜¯å¯ä»¥åœ¨Windowsä¸Šç»§ç»­ä½¿ç”¨çš„æ—§æŠ€æœ¯ï¼Œä½†æ˜¯é€šè¿‡é›†æˆçš„ActiveXæœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°ç®¡ç†LabVIEWå’ŒVIè®¾å¤‡ï¼ŒåŒ…æ‹¬é€šè¿‡Webã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆè¦åšçš„æ˜¯åœ¨LabVIEWä¸­åŒ…å«ç›¸åŒçš„ActiveXæœåŠ¡å™¨ï¼Œè¿™æ˜¯åœ¨ä»¥ä¸‹ç¯å¢ƒè®¾ç½®ä¸­å®Œæˆçš„ï¼šå·¥å…·-&gt;é€‰é¡¹-&gt; VIæœåŠ¡å™¨ï¼ŒActiveXå¤é€‰æ¡†ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ko/k5/ez/kok5ezsezk5gumns7dp1n1mkwhs.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥ä½¿ç”¨VBScriptä¸­çš„ç®€å•è„šæœ¬æ¥éªŒè¯æœåŠ¡å™¨æ˜¯å¦å·²æ‰“å¼€å¹¶å¯ä»¥è®¿é—®å®ƒã€‚</font><font style="vertical-align: inherit;">æ‚¨éœ€è¦åœ¨æ¡Œé¢ä¸Šåˆ›å»ºæ–‡æœ¬æ–‡ä»¶labview_test.vbsï¼Œå¹¶ç”¨ä»¥ä¸‹å†…å®¹å¡«å……å®ƒï¼š</font></font><br>
<br>
<pre><code class="vbscript hljs"><span class="hljs-keyword">Dim</span> obj
<span class="hljs-keyword">Set</span> obj = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"LabVIEW.Application"</span>)
<span class="hljs-comment">'Dim vi</span>
<span class="hljs-comment">'Set vi = obj.GetVIReference("C:\Users\Dell\Desktop\LabVIEW Web ActiveX\ActiveX Server Executable _LV2012_NI Verified\Executable as ActiveX Server\ActiveX Server.vi")</span>
WScript.Echo(obj.AppName &amp; <span class="hljs-string">" ver: "</span> &amp; obj.Version)
<span class="hljs-comment">'WScript.Echo(vi.GetControlValue("Count"))</span>
<span class="hljs-comment">'Set vi = Nothing</span>
<span class="hljs-keyword">Set</span> obj = <span class="hljs-literal">Nothing</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿è¡Œè„šæœ¬ä¹‹å‰ï¼Œè¯·å…ˆè¿è¡ŒLabVIEWç¯å¢ƒã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå®ƒæ— éœ€å…ˆå¯åŠ¨ç¯å¢ƒå³å¯å·¥ä½œã€‚</font><font style="vertical-align: inherit;">åœ¨è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒLabVIEWå®ä¾‹å°†ä½œä¸ºActiveX / COMæœåŠ¡å™¨å¯åŠ¨ï¼Œè„šæœ¬å®Œæˆåï¼Œå®ä¾‹å°†è¢«å…³é—­ï¼Œå› æ­¤æ‚¨å¿…é¡»ç­‰å¾…æ‰€æœ‰â€œåŠ è½½å’Œå¸è½½â€ã€‚</font><font style="vertical-align: inherit;">labview_test.vbsçš„è¾“å‡ºå°†æ˜¯æ ¹åº”ç”¨ç¨‹åºçš„åç§°åŠå…¶ç‰ˆæœ¬ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6n/a7/om/6na7omewgx5sqxfvvbz-7ekq1eg.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„VIè®¾å¤‡â€œ ActiveX Server.viâ€ã€‚</font><font style="vertical-align: inherit;">å®ƒåŒ…å«å‡ ä¸ªæ§ä»¶å’Œè¾…åŠ©åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†åŠ è½½å¹¶ç®¡ç†è¯¥VIã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hy/ih/77/hyih77q0rwk2kiap_hbbfulwlha.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨LabVIEWä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä»»ä½•å…¶ä»–åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä»Webå±‚å¼€å§‹ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£˜æ‰‹çš„é“è·¯</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘å¯¹æ ‡å‡†Windows WebæœåŠ¡å™¨Microsoft IISè¿›è¡Œäº†ä¸€äº›è¯•éªŒã€‚</font><font style="vertical-align: inherit;">æˆ‘å°è¯•ä½¿ç”¨ä»¥ä¸‹å†…å®¹åœ¨VBScriptä¸Šåˆ›å»ºASPé¡µé¢ï¼š</font></font><br>
<br>
<pre><code class="vbscript hljs">&lt;% @language = <span class="hljs-string">"vbscript"</span> %&gt;<font></font>
&lt;html&gt;&lt;body&gt;<font></font>
&lt;p&gt;ASP can output HTML tags as well as plain text&lt;/p&gt;<font></font>
&lt;%<font></font>
	<span class="hljs-keyword">Dim</span> obj
	<span class="hljs-keyword">Set</span> obj = <span class="hljs-built_in">CreateObject</span>(<span class="hljs-string">"LabVIEW.Application"</span>)
	<span class="hljs-built_in">response</span>.write(obj.AppName &amp; <span class="hljs-string">" ver: "</span> &amp; obj.Version &amp; <span class="hljs-string">"&lt;br&gt;"</span> &amp; vbCr)
	<span class="hljs-keyword">Dim</span> vi
	<span class="hljs-keyword">Set</span> vi = obj.GetVIReference(<span class="hljs-string">"C:\Users\Dell\Desktop\LabVIEW Web ActiveX\ActiveX Server Executable _LV2012_NI Verified\Executable as ActiveX Server\ActiveX Server.vi"</span>)
	<span class="hljs-built_in">response</span>.write(vi.GetControlValue(<span class="hljs-string">"Count"</span>) &amp; vbCr)
	<span class="hljs-keyword">set</span> vi = <span class="hljs-literal">Nothing</span>
	<span class="hljs-keyword">set</span> obj = <span class="hljs-literal">Nothing</span><font></font>
%&gt;<font></font>
&lt;/body&gt;&lt;/html&gt;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GetVIReferenceï¼ˆï¼‰æ–¹æ³•å°†VIåŠ è½½åˆ°å†…å­˜ä¸­å¹¶ä¸å…¶å»ºç«‹è¿æ¥ã€‚</font><font style="vertical-align: inherit;">ä¸»è¦å‚æ•°ï¼šæ‰€é€‰VIçš„ç»å¯¹è·¯å¾„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è„šæœ¬è¾“å‡ºåˆ°æµè§ˆå™¨ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">LabVIEW.exe ver: 20.0<font></font>
123 <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ²¡é”™ï¼Œæˆ‘ä¸å¾—ä¸ä¿®æ”¹IISåº”ç”¨ç¨‹åºæ± å’ŒåŒ¿åç”¨æˆ·éªŒè¯çš„è®¾ç½®ï¼Œè¿™äº›è®¾ç½®æ˜¯æˆ‘ä¸ºå½“å‰Windowsç”¨æˆ·é…ç½®çš„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å†³å®šä¸æ·±å…¥ä½¿ç”¨ASPå¹¶æ”¹ç”¨PHPã€‚</font><font style="vertical-align: inherit;">å¯¹äºIISï¼Œæˆ‘é…ç½®äº†PHP FastCGIå®ˆæŠ¤ç¨‹åºã€‚</font><font style="vertical-align: inherit;">æˆ‘æ²¡æœ‰ç»™æ‚¨è¿™äº›è®¾ç½®ï¼›è¿™äº›è®¾ç½®å¯¹æœ¬æ–‡çš„ä¸»è¦éƒ¨åˆ†è€Œè¨€å¹¶ä¸é‡è¦ã€‚</font><font style="vertical-align: inherit;">PHPè¿˜è®¾æ³•é€šè¿‡ä»¥ä¸‹ç±»å‹è®¿é—®LabVIEW COMå¯¹è±¡ï¼š</font></font><br>
<br>
<pre><code class="php hljs">$obj = <span class="hljs-keyword">new</span> COM(<span class="hljs-string">'LabVIEW.Application'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå½“LabVIEWéƒ½åœ¨è¿è¡Œä¸”åœ¨å…¶ä¸­æ‰“å¼€VIæ—¶ï¼ˆActiveX Server.viï¼‰ã€‚å½“è¯·æ±‚ä¸€ä¸ªPHPï¼ˆASPï¼‰è„šæœ¬æ—¶ï¼Œå°†å¹¶è¡Œå¯åŠ¨LabVIEW.exeçš„æ–°å®ä¾‹ï¼ˆå¹¶èŠ±è´¹ç›¸å½“é•¿çš„æ—¶é—´ï¼‰ï¼Œç„¶åä½¿ç”¨GetVIReferenceï¼ˆï¼‰æ–¹æ³•åŠ è½½å…¶è‡ªå·±çš„ActiveX Server.viå®ä¾‹ã€‚ PHPè„šæœ¬å®Œæˆåï¼ŒLabVIEWå®ä¾‹å…³é—­ã€‚é‚£äº›ã€‚ä¸å·²ç»åœ¨è¿è¡Œçš„LabVIEWç¯å¢ƒå®ä¾‹æ²¡æœ‰äº¤é›†ã€‚ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„Process Explorerå®ç”¨ç¨‹åºï¼Œå¯ä»¥å¾ˆå¥½åœ°è§‚å¯Ÿåˆ°è¿™ä¸€ç‚¹ã€‚å¸¦æœ‰IISåº”ç”¨ç¨‹åºæ± è®¾ç½®çš„â€œæ¸¸æˆâ€ä¹Ÿæ²¡æœ‰ç»™å‡ºç‰¹æ®Šçš„ç»“æœã€‚å°±æˆ‘è‡ªå·±è€Œè¨€ï¼Œæˆ‘å¾—å‡ºçš„ç»“è®ºæ˜¯IISä»£è¡¨ç³»ç»Ÿå……å½“ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ï¼Œå› æ­¤åˆ›å»ºäº†ä¸€ä¸ªå•ç‹¬çš„LabVIEW.exeå®ä¾‹ï¼Œè¯¥å®ä¾‹ç»‘å®šåˆ°ç³»ç»Ÿä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æˆ‘æ— æ³•ä»¥Windowsç”¨æˆ·çš„èº«ä»½é‡ç”¨å·²ç»æ‰“å¼€çš„å®ä¾‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œå‡ºç°äº†å°è¯•ä»¥å½“å‰ç”¨æˆ·çš„åä¹‰å°è¯•åœ¨ç®€å•åº”ç”¨ç¨‹åºæ¨¡å¼ä¸‹è¿è¡Œçš„ç¬¬ä¸‰æ–¹WebæœåŠ¡å™¨çš„æƒ³æ³•ã€‚</font><font style="vertical-align: inherit;">é€‰æ‹©æƒåœ¨äºNGINXï¼Œæ­¤å¤–ï¼Œæˆ‘å·²ç»å°†å…¶ç”¨ä½œLabVIEW WebServicesçš„åå‘ä»£ç†ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nginxçš„</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é‡‡ç”¨é€‚ç”¨äºWindowsçš„nginxçš„å½“å‰ç‰ˆæœ¬ã€‚</font><font style="vertical-align: inherit;">ç›®å‰ä¸ºnginx-1.17.10ã€‚</font><font style="vertical-align: inherit;">è¦å°†PHPä¸NGINXè¿æ¥ï¼Œæˆ‘ä½¿ç”¨äº†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥ä¸‹æè¿°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç®€å•çš„æœ€å°NGINXè®¾ç½®ã€‚</font><font style="vertical-align: inherit;">æˆ‘æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼šcï¼š\ nginx-1.17.10 \ conf \ nginx.conf </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†æ ¹ç›®å½•åˆ—è¡¨æ·»åŠ åˆ°æµè§ˆå™¨ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nginx.confï¼š</font></font><br>
<br>
<pre><code class="nginx hljs"><span class="hljs-attribute">location</span> / {
	<span class="hljs-attribute">root</span>   html;
	<span class="hljs-attribute">index</span>  index.html index.htm;
	<span class="hljs-attribute">autoindex</span> <span class="hljs-literal">on</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœåŠ¡å™¨æ ¹ç›®å½•ä¸­é€šè¿‡FastCGIå¯ç”¨PHPï¼š</font></font><br>
<br>
<pre><code class="nginx hljs"><span class="hljs-comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span>
<span class="hljs-comment">#</span>
<span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> {
	<span class="hljs-attribute">root</span>           html;
	<span class="hljs-attribute">fastcgi_pass</span>   <span class="hljs-number">127.0.0.1:9000</span>;
	<span class="hljs-attribute">fastcgi_index</span>  index.php;
	<span class="hljs-attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="hljs-variable">$document_root</span><span class="hljs-variable">$fastcgi_script_name</span>;
	<span class="hljs-attribute">include</span>        fastcgi_params;<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é‡‡ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æœ€æ–°ç‰ˆæœ¬çš„PHP </font><font style="vertical-align: inherit;">ã€‚æˆ‘ä½¿ç”¨äº†php-7.4.5-nts-Win32-vc15-x64.zipï¼Œæˆ‘å°†å®ƒæ”¾åœ¨cä¸­ï¼š\ php-7.4.5-nts-Win32-vc15-x64 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡å‘½åå¹¶é…ç½®php.iniï¼ˆå³phpã€‚æ¡£æ¡ˆä¸­çš„ini-developmentï¼‰ã€‚è¿›è¡Œä»¥ä¸‹æ›´æ”¹ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
php.iniï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">short_open_tag = On<font></font>
html_errors = On<font></font>
error_reporting = E_ALL &amp; ~E_NOTICE<font></font>
extension_dir = "ext"<font></font>
extension=gd2<font></font>
extension=php_com_dotnet.dll</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤„è¿æ¥äº†ç”¨äºå¤„ç†å›¾åƒçš„GDåº“ï¼ˆå¦‚æœéœ€è¦ä»LabVIEWè·å–ä¸€äº›å›¾åƒï¼‰å’Œç”¨äºåœ¨PHPä¸­ä½¿ç”¨ActiveX / COMå¯¹è±¡çš„php_com_dotnet.dllæ¨¡å—å·²è¿æ¥ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨PHPä¸­ä½¿ç”¨COMæ—¶ï¼Œåœ¨æ­£æ–‡ä¸­ä½¿ç”¨åŒ…å«0x0å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼ˆVT_BSTRï¼‰æ—¶å‘ç°äº†ä¸€ä¸ªä»¤äººä¸æ„‰å¿«çš„é”™è¯¯ã€‚é€šè¿‡ä½¿ç”¨ä¿®å¤ç¨‹åºé‡æ–°ç¼–è¯‘æ›¿æ¢php_com_dotnet.dllå¯ä»¥è§£å†³æ­¤é—®é¢˜ã€‚å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°é”™è¯¯è¯´æ˜å’Œä¿®è¡¥ç¨‹åºè¡¥ä¸</font><font style="vertical-align: inherit;">ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒä»æœªåœ¨PHPä¸­æ­£å¼ä¿®å¤ã€‚æˆ‘é‡å»ºäº†php_com_dotnet.dllï¼ˆé€‚ç”¨äºphp-7.4.5-nts-Win32-vc15-x64ï¼‰ï¼Œå¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é“¾æ¥ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°å›ºå®šçš„php_com_dotnet.dll </font><font style="vertical-align: inherit;">ã€‚å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰¾åˆ°è‡ªæ„å»ºPHPå’Œæ‰©å±•çš„æŒ‡å—</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é»˜è®¤æƒ…å†µä¸‹ï¼ŒNGINXå°†åœ¨TCPç«¯å£80ï¼ˆç«¯å£9000çš„PHP FastCGIå®ˆæŠ¤ç¨‹åºï¼‰ä¸Šè¿è¡Œï¼Œè¯·æ£€æŸ¥æ˜¯å¦æ²¡æœ‰å…¶ä»–æ­£åœ¨ä½¿ç”¨è¿™äº›ç«¯å£çš„åº”ç”¨ç¨‹åºã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯åŠ¨å’Œåœæ­¢NGINXå’ŒPHP FastCGIå®ˆæŠ¤ç¨‹åºå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è¿›è¡Œç»„ç»‡ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†æ»¡è¶³æˆ‘çš„è°ƒè¯•éœ€æ±‚ï¼Œè¿™äº›cmdè„šæœ¬å·²æˆå½¢ï¼šåœ¨åå°å¯åŠ¨/é‡æ–°å¯åŠ¨ï¼ˆæ²¡æœ‰æ‰“å¼€æ¶é­”çª—å£ï¼‰start-restart-all.cmdå’Œåœæ­¢kill-all.cmdï¼Œè¿™äº›å‘½ä»¤å·²æ”¾ç½®åœ¨NGINXç›®å½•ä¸­ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨çš„â€œè¿è¡Œéšè—æ§åˆ¶å°â€å®ç”¨ç¨‹åºï¼Œå–è‡ª</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æè¿°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
start-restart-all.cmdï¼š</font></font><br>
<br>
<pre><code class="powershell hljs">rem @<span class="hljs-built_in">echo</span> off
<span class="hljs-built_in">set</span> PHP_FCGI_MAX_REQUESTS=<span class="hljs-number">0</span>
@<span class="hljs-built_in">echo</span> Shutting down servers...<font></font>
taskkill /f /IM nginx.exe<font></font>
taskkill /f /IM php<span class="hljs-literal">-cgi</span>.exe<font></font>
@timeout <span class="hljs-number">1</span>
@<span class="hljs-built_in">echo</span> Starting servers...<font></font>
@rem <span class="hljs-built_in">start</span> /b /D <span class="hljs-string">"C:\php-7.4.5-nts-Win32-vc15-x64"</span> php<span class="hljs-literal">-cgi</span>.exe <span class="hljs-literal">-b</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9000</span>
RunHiddenConsole.exe <span class="hljs-string">"C:\php-7.4.5-nts-Win32-vc15-x64\php-cgi.exe"</span> <span class="hljs-literal">-b</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9000</span>
<span class="hljs-built_in">start</span> /b /D <span class="hljs-string">"c:\nginx-1.17.10\"</span> nginx.exe<font></font>
@timeout <span class="hljs-number">3</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kill-all.cmdï¼š</font></font><br>
<br>
<pre><code class="powershell hljs">taskkill /f /IM nginx.exe<font></font>
taskkill /f /IM php<span class="hljs-literal">-cgi</span>.exe<font></font>
pause</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è¦æ³¨æ„ç¯å¢ƒå˜é‡PHP_FCGI_MAX_REQUESTSã€‚</font><font style="vertical-align: inherit;">é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯500ã€‚åœ¨è¯·æ±‚500ä¹‹åï¼ŒPHP FastCGIå®ˆæŠ¤ç¨‹åºå°†å®Œæˆå…¶å·¥ä½œï¼Œå› æ­¤æˆ‘ç¦ç”¨äº†æ­¤è®¡æ•°å™¨è¿›è¡Œè°ƒè¯•ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ¥è‡ªæ–‡æ¡£çš„å¼•è¨€ï¼Œä»¥è¿›è¡Œåæ€ï¼š</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥é€šè¿‡å°†PHP_FCGI_MAX_REQUESTSè®¾ç½®ä¸º0æ¥ç¦ç”¨æ­¤PHPè¡Œä¸ºï¼Œä½†æ˜¯å¦‚æœPHPåº”ç”¨ç¨‹åºæ³„æ¼èµ„æºï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">æˆ–è€…ï¼Œå¯ä»¥å°†PHP_FCGI_MAX_REQUESTSè®¾ç½®ä¸ºæ¯”é»˜è®¤å€¼é«˜å¾—å¤šçš„å€¼ï¼Œä»¥å‡å°‘å‡ºç°æ­¤é—®é¢˜çš„é¢‘ç‡ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ç¼–å†™äº†2ä¸ªPHPæµ‹è¯•è„šæœ¬labview.phpï¼Œlabview_png.phpï¼Œè¿™äº›è„šæœ¬å¿…é¡»æ”¾åœ¨WebæœåŠ¡å™¨Cçš„æ ¹ç›®å½•ä¸­ï¼š\ nginx-1.17.10 \ html labview.php- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯ä¸»è¦çš„ç¤ºä¾‹è„šæœ¬</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
labview_png.php-ä»ä»LabVIEW ActiveXæœåŠ¡å™¨è¯»å–çš„VT_BSTRç±»å‹çš„å­—ç¬¦ä¸²è¿”å›PNGå›¾åƒã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">labview.php</font></font></b>
                        <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span>(strpos(exec(<span class="hljs-string">'tasklist /FI "IMAGENAME eq LabVIEW.exe" /NH'</span>), <span class="hljs-string">'LabVIEW.exe'</span>) === <span class="hljs-literal">false</span>)
	<span class="hljs-keyword">exit</span>(<span class="hljs-string">"  LabVIEW.exe"</span>);<span class="hljs-meta">?&gt;</span>
&lt;!DOCTYPE HTML <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//W3C//DTD HTML 4.01//EN"</span> <span class="hljs-string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;<font></font>
&lt;html&gt;<font></font>
&lt;head&gt;<font></font>
	&lt;meta http-equiv=<span class="hljs-string">"Content-Type"</span> content=<span class="hljs-string">"text/html; charset=utf-8"</span>&gt;<font></font>
	&lt;title&gt;LabVIEW PHP COM example&lt;/title&gt;<font></font>
	&lt;script src=<span class="hljs-string">"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"</span>&gt;&lt;/script&gt;<font></font>
	&lt;script&gt;<font></font>
		<span class="hljs-comment">// setTimeout(function(){</span>
		<span class="hljs-comment">//	window.location.reload(1);</span>
		<span class="hljs-comment">// }, 3000);</span>
		<span class="hljs-comment">// setInterval(function() {</span>
		<span class="hljs-comment">//	var myImageElement = document.getElementById('myImage');</span>
		<span class="hljs-comment">// 	myImageElement.src = 'labview_png.php?rand=' + Math.random();</span>
		<span class="hljs-comment">//}, 200);</span><font></font>
	 <font></font>
		$(document).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
			setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
				$(<span class="hljs-string">"#png"</span>).attr(<span class="hljs-string">'src'</span>, <span class="hljs-string">'labview_png.php?rand='</span> + Math.random());<font></font>
				$(<span class="hljs-string">"#auto"</span>).load(location.href + <span class="hljs-string">" #auto"</span>);<font></font>
			}, <span class="hljs-number">1000</span>);<font></font>
		});<font></font>
&lt;/script&gt;<font></font>
	<font></font>
&lt;/head&gt; <font></font>
&lt;body&gt;<font></font>
<span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">//phpinfo();</span>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'_GET val: '</span>;
<span class="hljs-keyword">foreach</span> ($_GET <span class="hljs-keyword">as</span> $key =&gt; $value)
	<span class="hljs-keyword">echo</span> <span class="hljs-string">"$key=$value, "</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'_POST val: '</span>;
<span class="hljs-keyword">foreach</span> ($_POST <span class="hljs-keyword">as</span> $key =&gt; $value)
	<span class="hljs-keyword">echo</span> <span class="hljs-string">"$key=$value, "</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
define(<span class="hljs-string">'FPStateInfo'</span>, [<span class="hljs-string">'Invalid'</span>, <span class="hljs-string">'Standard'</span>, <span class="hljs-string">'Closed'</span>, <span class="hljs-string">'Hidden'</span>, <span class="hljs-string">'Minimized'</span>, <span class="hljs-string">'Maximized'</span>]);<font></font>
define(<span class="hljs-string">'ExecStateInfo'</span>, [<span class="hljs-string">'eBad 0 VI has errors; it cannot run'</span>, <span class="hljs-string">'eIdle 1 VI is not running, but the VI is in memory.'</span>, <span class="hljs-string">'eRunTopLevel 2 VI is running as a top-level VI'</span>, <span class="hljs-string">'eRunning 3 VI is running as a subV'</span>]);<font></font>
<font></font>
$obj = <span class="hljs-keyword">new</span> COM(<span class="hljs-string">'LabVIEW.Application'</span>);
<span class="hljs-comment">//com_print_typeinfo($obj);</span><font></font>
<font></font>
$vi = $obj-&gt;GetVIReference(<span class="hljs-string">'C:\Users\Dell\Desktop\LabVIEW Web ActiveX\ActiveX Server Executable _LV2012_NI Verified\Executable as ActiveX Server\ActiveX Server.vi'</span>);<font></font>
<font></font>
<span class="hljs-comment">//$vi-&gt;OpenFrontPanel();</span><font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;form action="" method="post"&gt;'</span>;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;input type="button" value="Refresh page" onClick=\'window.location.href=window.location.href\'&gt;'</span>, PHP_EOL;<font></font>
<font></font>
$fpstate = $vi-&gt;FPState();<font></font>
$vistate = $vi-&gt;ExecState();<font></font>
<font></font>
<span class="hljs-keyword">if</span> ($_POST[<span class="hljs-string">'action'</span>]===<span class="hljs-string">'run_vi'</span> &amp;&amp; $vistate &lt;= <span class="hljs-number">1</span>) {<font></font>
	$vi-&gt;Run(<span class="hljs-literal">true</span>); <span class="hljs-comment">// async Boolean If TRUE, you do not need to wait for the VI to finish running. The default is FALSE.</span>
} <span class="hljs-keyword">elseif</span> ($_POST[<span class="hljs-string">'action'</span>]===<span class="hljs-string">'stop_vi'</span> &amp;&amp; $vistate &gt; <span class="hljs-number">1</span>) {
	<span class="hljs-comment">//$vi-&gt;SetControlValue('stop', true);</span>
	<span class="hljs-comment">//sleep(1);</span><font></font>
	$vi-&gt;Abort();<font></font>
} <span class="hljs-keyword">elseif</span> ($_POST[<span class="hljs-string">'action'</span>]===<span class="hljs-string">'open_fp'</span> &amp;&amp; $fpstate==<span class="hljs-number">2</span>) {<font></font>
	$vi-&gt;OpenFrontPanel();<font></font>
} <span class="hljs-keyword">elseif</span> ($_POST[<span class="hljs-string">'action'</span>]===<span class="hljs-string">'close_fp'</span> &amp;&amp; $fpstate!=<span class="hljs-number">2</span>) {<font></font>
	$vi-&gt;CloseFrontPanel();<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span> ($_POST[<span class="hljs-string">'Count2'</span>]) {<font></font>
	$vi-&gt;SetControlValue(<span class="hljs-string">'Count2'</span>, $_POST[<span class="hljs-string">'Count2'</span>]);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;SetControlValue(\'Count2\'):&lt;/h3&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;input onchange="this.form.submit()" type="number" name="Count2" value="'</span>, $vi-&gt;GetControlValue(<span class="hljs-string">'Count2'</span>), <span class="hljs-string">'"&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;div id="auto"&gt;'</span>;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;AppName / Version:&lt;/h3&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> $obj-&gt;AppName(), <span class="hljs-string">' / '</span>, $obj-&gt;Version(), <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;ExportedVIs:&lt;/h3&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">foreach</span> ($obj-&gt;ExportedVIs() <span class="hljs-keyword">as</span> $value)
	<span class="hljs-keyword">echo</span> $value, <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;FPState:&lt;/h3&gt;'</span>, PHP_EOL;<font></font>
$fpstate = $vi-&gt;FPState();<font></font>
<span class="hljs-keyword">echo</span> $fpstate, <span class="hljs-string">', '</span>, FPStateInfo[$fpstate], PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;button name="action" type="submit" value="open_fp"&gt;OpenFrontPanel&lt;/button&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;button name="action" type="submit" value="close_fp"&gt;CloseFrontPanel&lt;/button&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;ExecState:&lt;/h3&gt;'</span>, PHP_EOL;<font></font>
$vistate = $vi-&gt;ExecState();<font></font>
<font></font>
<span class="hljs-keyword">if</span> ($vistate &gt; <span class="hljs-number">1</span>) {
	<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;font color="blue"&gt;'</span>, $vistate, <span class="hljs-string">', '</span>, ExecStateInfo[$vistate], <span class="hljs-string">'&lt;/font&gt;'</span>, PHP_EOL;<font></font>
} <span class="hljs-keyword">else</span> {
	<span class="hljs-keyword">echo</span> $vistate, <span class="hljs-string">', '</span>, ExecStateInfo[$vistate], PHP_EOL;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;button name="action" type="submit" value="run_vi"&gt;Run VI&lt;/button&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;button name="action" type="submit" value="stop_vi"&gt;Abort VI&lt;/button&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;/form&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;GetControlValue(\'Count\') / GetControlValue(\'Count2\'):&lt;/h3&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">echo</span> $vi-&gt;GetControlValue(<span class="hljs-string">'Count'</span>), <span class="hljs-string">' / '</span>, $vi-&gt;GetControlValue(<span class="hljs-string">'Count2'</span>), PHP_EOL;
<span class="hljs-comment">//echo $vi-&gt;SetControlValue('Count2', $vi-&gt;GetControlValue('Count')+1), PHP_EOL;</span><font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;Array1:&lt;/h3&gt;'</span>, PHP_EOL;
<span class="hljs-keyword">foreach</span> ($vi-&gt;GetControlValue(<span class="hljs-string">'Array1'</span>) <span class="hljs-keyword">as</span> $value)
	<span class="hljs-keyword">echo</span> $value, <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<span class="hljs-comment">//$png_data = new variant(null, VT_UI1);</span>
<span class="hljs-comment">//$png_data = variant_set_type($vi-&gt;GetControlValue('png data'), VT_UI1);</span>
<span class="hljs-comment">//echo variant_cast($vi-&gt;GetControlValue('png1'), VT_BSTR), PHP_EOL;</span>
<span class="hljs-comment">//echo mb_strlen($vi-&gt;GetControlValue('String1')), PHP_EOL;</span>
<span class="hljs-comment">//echo variant_get_type($vi-&gt;GetControlValue('png1')), PHP_EOL;</span><font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;h3&gt;PNG data:&lt;/h3&gt;'</span>, PHP_EOL;<font></font>
$png_data = $vi-&gt;GetControlValue(<span class="hljs-string">'PNG data'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-string">'PNG size:'</span> , strlen($png_data), <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;/div&gt;'</span>;<font></font>
<font></font>
<span class="hljs-keyword">if</span> ($vistate &gt; <span class="hljs-number">1</span> &amp;&amp; $fpstate!=<span class="hljs-number">2</span>) {
	<span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;img src="labview_png.php" id="png"&gt;'</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// variant_set_type($variant, VT_BSTR)</span>
<span class="hljs-comment">//$png_data = variant_cast($vi-&gt;GetControlValue('png data'), VT_U1);</span><font></font>
<font></font>
<font></font>
<span class="hljs-comment">//echo  variant_get_type($png_data), PHP_EOL;</span>
<span class="hljs-keyword">echo</span> $vi-&gt;SetControlValue(<span class="hljs-string">'String1'</span>, <span class="hljs-string">"123\x00555321"</span>);
<span class="hljs-comment">//com_print_typeinfo($vi);</span>
$obj = <span class="hljs-literal">null</span>;
<span class="hljs-meta">?&gt;</span><font></font>
&lt;/body&gt;<font></font>
&lt;/html&gt;</code></pre><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">labview_png.php</font></font></b>
                        <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span>(strpos(exec(<span class="hljs-string">'tasklist /FI "IMAGENAME eq LabVIEW.exe" /NH'</span>), <span class="hljs-string">'LabVIEW.exe'</span>) === <span class="hljs-literal">false</span>)
	<span class="hljs-keyword">exit</span>(<span class="hljs-string">"  LabVIEW.exe"</span>);<font></font>
$obj = <span class="hljs-keyword">new</span> COM(<span class="hljs-string">'LabVIEW.Application'</span>);<font></font>
$vi = $obj-&gt;GetVIReference(<span class="hljs-string">'C:\Users\Dell\Desktop\LabVIEW Web ActiveX\ActiveX Server Executable _LV2012_NI Verified\Executable as ActiveX Server\ActiveX Server.vi'</span>);<font></font>
<font></font>
$data = $vi-&gt;GetControlValue(<span class="hljs-string">'PNG data'</span>);<font></font>
<font></font>
$im = imagecreatefromstring($data);<font></font>
<span class="hljs-keyword">if</span> ($im !== <span class="hljs-literal">false</span>) {<font></font>
    header(<span class="hljs-string">'Content-Type: image/png'</span>);<font></font>
    imagepng($im);<font></font>
    imagedestroy($im);<font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">' .'</span>;<font></font>
}<font></font>
$obj = <span class="hljs-literal">null</span>;
<span class="hljs-meta">?&gt;</span></code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¥½åœ¨LabVIEWç¯å¢ƒè¿è¡Œæ—¶æ‰§è¡Œè„šæœ¬ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè„šæœ¬å°†é‡ç”¨å·²ç»æ‰“å¼€çš„LabVIEWå®ä¾‹ã€‚</font><font style="vertical-align: inherit;">è€Œä¸æ˜¯æ¯ä¸ªè„šæœ¬è°ƒç”¨éƒ½åˆ›å»ºå’Œå…³é—­COMå®ä¾‹ã€‚</font><font style="vertical-align: inherit;">æˆ‘çš„è„šæœ¬ä½¿ç”¨äº†ä¸€äº›AJAXå’Œâ€œé‡æ–°å¯åŠ¨â€ï¼Œå¹¶ä¸”ä¸é‡å¤ä½¿ç”¨LabVIEWå°†å¯¼è‡´labview.exeçš„é¡ºåºå¯åŠ¨å’Œç»ˆæ­¢çš„â€œä¹Œé¾Ÿé©¬æ‹‰æ¾â€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½±ç‰‡è¯„è®ºï¼š</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dU2pEUCK9ko" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é™„å½•ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨HTTP Basicè®¿é—®èº«ä»½éªŒè¯å°†NGINXé…ç½®ä¸ºåå‘ä»£ç†ï¼Œä»¥ä¸WebServices LabVIEWä¸€èµ·ä½¿ç”¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ä¹…å‰ï¼Œæˆ‘å¯¹WebServices LabVIEWè¿›è¡Œäº†ä¸€äº›å®éªŒï¼ˆåœ¨ç›¸å½“è€çš„LabVIEWç‰ˆæœ¬ä¸Šå®è¯å®è¯´ï¼‰ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œæˆ‘å‘ç°é¡µé¢ï¼ˆWebServicesèµ„æºï¼‰æ²¡æœ‰ç®€å•çš„è®¿é—®æ§åˆ¶ã€‚</font><font style="vertical-align: inherit;">å»ºè®®åœ¨Application Serverä¸­é…ç½®ç”¨æˆ·å¹¶ä½¿ç”¨â€œå¤±æ•ˆâ€ Microsoft Silverlightã€‚</font><font style="vertical-align: inherit;">æˆ‘éœ€è¦ä¸€äº›ç®€å•çš„é€‰é¡¹ï¼Œä¾‹å¦‚HTTP Basicè®¿é—®èº«ä»½éªŒè¯å¯†ç éªŒè¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä½¿ç”¨NGINXå¹¶å°†å…¶é…ç½®ä¸ºå¯ç”¨äº†auth_basicçš„åå‘Webä»£ç†ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨ä»¥ä¸‹è®¾ç½®ï¼Œåœ¨è¾“å…¥å¯†ç åè®¿é—®åœ°å€httpï¼š// server_nameï¼š5500æ—¶ï¼Œç”¨æˆ·å¯ä»¥è®¿é—®è¿è¡Œåœ¨http://127.0.0.1:8001/webservice1/çš„WebServiceåº”ç”¨ç¨‹åºã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
webservice1åº”ç”¨ç¨‹åºçš„æ‰€æœ‰èµ„æºå‡å—ä¿æŠ¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nginx.confï¼š</font></font><br>
<br>
<pre><code class="nginx hljs"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span>       <span class="hljs-number">5500</span>;
    <span class="hljs-attribute">server_name</span>  localhost;
    <span class="hljs-attribute">location</span> / {
        <span class="hljs-attribute">auth_basic</span> <span class="hljs-string">"Unauthorized"</span>;
        <span class="hljs-attribute">auth_basic_user_file</span> htpasswd;
        <span class="hljs-attribute">root</span> html;
        <span class="hljs-comment">#autoindex on;</span>
        <span class="hljs-comment">#index index.html index.htm;</span>
        <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:8001/webservice1/;<font></font>
    }<font></font>
    <span class="hljs-attribute">error_page</span>   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  /50x.html;
    <span class="hljs-attribute">location</span> = /50x.html {
        <span class="hljs-attribute">root</span>   html;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥åŠå¸¦æœ‰ç”¨æˆ·å¯†ç çš„htpasswdæ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">admin:{PLAIN}1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿›ä¸€æ­¥å‘å±•è¿™ä¸ªæƒ³æ³•ï¼Œæ‚¨å¯ä»¥å¯ç”¨é€šè¿‡HTTPSå¯¹NGINXä»£ç†çš„è®¿é—®ï¼Œå¹¶å°†HTTPä»NGINXä¿ç•™åˆ°LabVIEWã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN502480/index.html">ä»€ä¹ˆæ˜¯DHCPä¾¦å¬ï¼Œå®ƒå¦‚ä½•å·¥ä½œï¼Ÿ</a></li>
<li><a href="../zh-CN502486/index.html">è¯¥ä¹¦â€œä¸æµè¡Œç—…ç«èµ›ã€‚å¯¹æŠ—è¶…çº§ç»†èŒçš„æŠ—ç”Ÿç´ </a></li>
<li><a href="../zh-CN502490/index.html">é—ªçƒçš„é™åˆ¶æ€§ä¿¡å¿µã€‚ä¸ºäº†ä»€ä¹ˆå’Œç»™ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN502492/index.html">Zextras Suiteå’ŒZimbra OSEä¸­çš„åˆ›æ–°</a></li>
<li><a href="../zh-CN502494/index.html">é»‘è‰²æ˜ŸæœŸäº”çš„7ä¸ªé”™è¯¯ä»¥åŠMagento Cloudçš„å·¥ä½œåŸç†-è§†é¢‘</a></li>
<li><a href="../zh-CN502498/index.html">æ”¹å–„Cï¼ƒæ€§èƒ½çš„æœ€ä½³å®è·µ</a></li>
<li><a href="../zh-CN502500/index.html">æŠ¤ç…§æ‰«æä»ªçš„æ¼”å˜ï¼šä»èƒ¶åˆæ¿å·¥è‰ºå“åˆ°å®é™…ä¸šåŠ¡</a></li>
<li><a href="../zh-CN502504/index.html">ç¯ç»•ç”¨æˆ·æ•°å­—</a></li>
<li><a href="../zh-CN502508/index.html">å°è½¦æœºå™¨äºº2.0ã€‚ç¬¬2éƒ¨åˆ†ã€‚rvizä¸­çš„ç®¡ç†å’Œä¸å­˜åœ¨ä¸­çš„ç®¡ç†</a></li>
<li><a href="../zh-CN502510/index.html">åœ¨äº‘ä¸­ä¿å­˜ä»€ä¹ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>