<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚èØÔ∏è üôÜ üëÑ Was ist Windows PowerShell und was isst es? Teil 4: Arbeiten mit Objekten, benutzerdefinierte Klassen üêß üöÉ üôà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Textausgabe von Befehlen im PowerShell-Interpreter-Fenster ist nur eine M√∂glichkeit, Informationen in einer f√ºr Menschen lesbaren Form anzuzeigen....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Was ist Windows PowerShell und was isst es? Teil 4: Arbeiten mit Objekten, benutzerdefinierte Klassen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/494978/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Textausgabe von Befehlen im PowerShell-Interpreter-Fenster ist nur eine M√∂glichkeit, Informationen in einer f√ºr Menschen lesbaren Form anzuzeigen. </font><font style="vertical-align: inherit;">Tats√§chlich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konzentriert sich</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Umgebung </font><font style="vertical-align: inherit;">auf die Arbeit mit Objekten: Cmdlets und Funktionen empfangen sie an der Eingabe und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geben sie an der Ausgabe zur√ºck</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und die im interaktiven Modus und in Skripten verf√ºgbaren Variablentypen basieren auf .NET-Klassen. </font><font style="vertical-align: inherit;">Im vierten Artikel des Zyklus werden wir die Arbeit mit Objekten genauer untersuchen.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhaltsverzeichnis:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ForEach-Object, Group-Object  Measure-Object</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  .NET  COM (New-Object)</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> PSCustomObject</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF">  PowerShell</font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Denken Sie daran, dass ein Objekt eine Sammlung von Datenfeldern (Eigenschaften, Ereignisse usw.) und deren Verarbeitungsmethoden (Methoden) ist. Die Struktur wird durch den Typ bestimmt, der normalerweise auf den in der einheitlichen .NET Core-Plattform verwendeten Klassen basiert. Es ist auch m√∂glich, mit COM-, CIM- (WMI) und ADSI-Objekten zu arbeiten. Eigenschaften und Methoden sind erforderlich, um verschiedene Aktionen f√ºr die Daten auszuf√ºhren. Zus√§tzlich zu PowerShell k√∂nnen Objekte als Argumente an Funktionen und Cmdlets √ºbergeben, Variablen Werte zugewiesen werden und es gibt auch einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mechanismus zum Erstellen von Befehlen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Pipeline oder Pipeline). Jeder Befehl in der Pipeline √ºbergibt seine Ausgabe der Reihe nach an den n√§chsten - Objekt f√ºr Objekt. F√ºr die Verarbeitung k√∂nnen Sie kompilierte Cmdlets verwenden oder eigene </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">erweiterte Funktionen</font></a><font style="vertical-align: inherit;"> erstellen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verschiedene Manipulationen mit Objekten in der Pipeline durchf√ºhren: Filtern, Sortieren, Gruppieren und sogar √Ñndern ihrer Struktur. </font><font style="vertical-align: inherit;">Die Daten√ºbertragung in dieser Form hat einen gravierenden Vorteil: Das empfangende Team muss den Bytestrom (Text) nicht analysieren, alle erforderlichen Informationen k√∂nnen einfach unter Bezugnahme auf die entsprechenden Eigenschaften und Methoden extrahiert werden.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objektstruktur anzeigen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie beispielsweise das Cmdlet Get-Process aus, mit dem Sie Informationen zu den im System ausgef√ºhrten Prozessen abrufen k√∂nnen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4k/fo/qs/4kfoqsdoj0-r5h7lz6y5ecwjskc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es werden einige formatierte Textdaten angezeigt, die keine Vorstellung von den Eigenschaften der zur√ºckgegebenen Objekte und ihren Methoden vermitteln. </font><font style="vertical-align: inherit;">Um die Ausgabe zu optimieren, m√ºssen Sie lernen, wie Sie die Struktur von Objekten untersuchen. Das Cmdlet Get-Member hilft uns dabei:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/86/fq/tt/86fqttuizhkkraqk9eoh9lnrfc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen wir bereits den Typ und die Struktur, und mit Hilfe zus√§tzlicher Parameter k√∂nnen wir beispielsweise nur die Eigenschaften des Objekts anzeigen, das die Eingabe eingegeben hat:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Get-Member</span> <span class="hljs-literal">-MemberType</span> Property</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Wissen wird ben√∂tigt, um administrative Aufgaben interaktiv zu l√∂sen oder um eigene Skripte zu schreiben: Zum Beispiel, um Informationen √ºber blockierte Prozesse von der Responding-Eigenschaft zu erhalten.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objektfilterung</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit PowerShell k√∂nnen Sie Objekte weiterleiten, die eine bestimmte Bedingung erf√ºllen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Where-Object</span> {   }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Ergebnis der Ausf√ºhrung des Skriptblocks in Operator-Klammern sollte ein logischer Wert sein. </font><font style="vertical-align: inherit;">Wenn es wahr ist ($ true), wird das Objekt, das in das Cmdlet Where-Object eingegeben wurde, an die Pipeline √ºbergeben, andernfalls (der Wert $ false) wird es gel√∂scht. </font><font style="vertical-align: inherit;">Zum Beispiel listen wir die gestoppten Windows Server-Dienste auf, d.h. </font><font style="vertical-align: inherit;">diejenigen mit der Status-Eigenschaft auf Gestoppt:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span>.Status <span class="hljs-operator">-eq</span> <span class="hljs-string">"Stopped"</span>}</code></pre><br>
<img src="https://habrastorage.org/webt/eq/w6/gy/eqw6gyo6ww_hha2hw_cnbse9_ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sehen wir wieder die Textdarstellung, aber wenn Sie den Typ und die interne Struktur der Objekte verstehen m√∂chten, die die Pipeline durchlaufen, ist es einfach:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span>.Status <span class="hljs-operator">-eq</span> <span class="hljs-string">"Stopped"</span>} | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/qu/uk/uy/quukuy29t6wndu8hhktdyei1rsi.png"><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objekte sortieren</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Pipelining von Objekten ist es h√§ufig erforderlich, diese zu sortieren. </font><font style="vertical-align: inherit;">Eigenschaftsnamen (Sortierschl√ºssel) werden an das Cmdlet Sort-Object √ºbergeben und geben Objekte zur√ºck, die nach ihren Werten geordnet sind. </font><font style="vertical-align: inherit;">Die Ausgabe laufender Prozesse kann einfach nach der aufgewendeten Prozessorzeit (CPU-Eigenschaft) sortiert werden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Sort-Object</span> ‚ÄìProperty cpu</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Parameter -Property kann beim Aufrufen des Cmdlets Sort-Object weggelassen werden - er wird standardm√§√üig verwendet. </font><font style="vertical-align: inherit;">Verwenden Sie f√ºr die umgekehrte Sortierung den Parameter -Descending:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Sort-Object</span> cpu <span class="hljs-literal">-Descending</span></code></pre><br>
<img src="https://habrastorage.org/webt/i5/-l/og/i5-logdefolkpn4oiqab5549qac.png"><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auswahl von Objekten und deren Teilen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Cmdlet Select-Object k√∂nnen Sie eine bestimmte Anzahl von Objekten am Anfang oder am Ende einer Pipeline mithilfe der Parameter -First oder -Last ausw√§hlen. </font><font style="vertical-align: inherit;">Damit k√∂nnen Sie einzelne Objekte oder bestimmte Eigenschaften ausw√§hlen sowie neue Objekte auf deren Basis erstellen. </font><font style="vertical-align: inherit;">Wir werden die Arbeit des Cmdlets anhand einfacher Beispiele analysieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der folgende Befehl zeigt Informationen zu 10 Prozessen an, die die maximale RAM-Gr√∂√üe (WS-Eigenschaft) verbrauchen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Sort-Object</span> WS <span class="hljs-literal">-Descending</span> | <span class="hljs-built_in">Select-Object</span> <span class="hljs-literal">-First</span> <span class="hljs-number">10</span></code></pre><br>
<img src="https://habrastorage.org/webt/uz/tk/4g/uztk4gok8nqkynaqcaupcito0ri.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen nur bestimmte Eigenschaften von Objekten ausw√§hlen, die die Pipeline durchlaufen, und auf ihrer Grundlage neue erstellen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Select-Object</span> ProcessName, Id <span class="hljs-literal">-First</span> <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis der Pipeline erhalten wir ein neues Objekt, dessen Struktur sich von der vom Cmdlet Get-Process zur√ºckgegebenen Struktur unterscheidet. </font><font style="vertical-align: inherit;">Wir werden dies mit Get-Member √ºberpr√ºfen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Select-Object</span> ProcessName, Id <span class="hljs-literal">-First</span> <span class="hljs-number">1</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/fw/2y/0c/fw2y0cn_xin2jr571bsy1crcite.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass Select-Object ein einzelnes Objekt (-First 1) zur√ºckgibt, dessen nur zwei Felder von uns angegeben wurden: Ihre Werte wurden vom ersten Objekt kopiert, das mit dem Cmdlet Get-Process an die Pipeline √ºbergeben wurde. </font><font style="vertical-align: inherit;">Mit Select-Object k√∂nnen Sie unter anderem Objekte in PowerShell-Skripten erstellen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$obj</span> = <span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Select-Object</span> ProcessName, Id <span class="hljs-literal">-First</span> <span class="hljs-number">1</span>
<span class="hljs-variable">$obj</span>.GetType()</code></pre><br>
<img src="https://habrastorage.org/webt/lf/rp/fo/lfrpfonoe8e6xidulqfn8s6xfh8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Select-Object k√∂nnen Sie Objekten berechnete Eigenschaften hinzuf√ºgen, die als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash-Tabelle dargestellt werden m√ºssen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In diesem Fall entspricht der Wert des ersten Schl√ºssels dem Namen der Eigenschaft, und der Wert des zweiten Schl√ºssels entspricht dem Wert der Eigenschaft f√ºr das aktuelle Element der Pipeline:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Select-Object</span> <span class="hljs-literal">-Property</span> ProcessName, <span class="hljs-selector-tag">@</span>{Name=<span class="hljs-string">"StartTime"</span>; Expression = {<span class="hljs-variable">$_</span>.StartTime.Minute}}</code></pre><br>
<img src="https://habrastorage.org/webt/vm/oq/6l/vmoq6l8umcadkrnqomarqazayms.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns die Struktur der Objekte an, die die Pipeline durchlaufen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Process</span> | <span class="hljs-built_in">Select-Object</span> <span class="hljs-literal">-Property</span> ProcessName, <span class="hljs-selector-tag">@</span>{Name=<span class="hljs-string">"StartTime"</span>; Expression = {<span class="hljs-variable">$_</span>.StartTime.Minute}} | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/zt/_a/df/zt_adfbgvhdylarb7lxrrj1gpp4.png"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºr jedes Objekt, Gruppenobjekt und Messobjekt</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt andere Cmdlets zum Arbeiten mit Objekten. </font><font style="vertical-align: inherit;">Zum Beispiel werden wir √ºber die drei n√ºtzlichsten sprechen: Mit </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ForEach-Object</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen Sie PowerShell-Code f√ºr jedes Objekt in der Pipeline ausf√ºhren:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">ForEach-Object</span> {   }</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Group-Object</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Gruppen - </font><font style="vertical-align: inherit;">Objekte von Eigenschaftswert:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Group-Object</span> PropertyName</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie es mit dem Parameter -NoElement ausf√ºhren, k√∂nnen Sie die Anzahl der Elemente in Gruppen ermitteln. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Measure-Object</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aggregiert verschiedene Zusammenfassungsparameter anhand der Werte der Felder von Objekten in der Pipeline (berechnet die Summe und ermittelt auch den minimalen, maximalen oder durchschnittlichen Wert):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Measure-Object</span> <span class="hljs-literal">-Property</span> PropertyName <span class="hljs-literal">-Minimum</span> <span class="hljs-literal">-Maximum</span> <span class="hljs-literal">-Average</span> <span class="hljs-literal">-Sum</span></code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Regel werden die betrachteten Cmdlets interaktiv verwendet, und Skripte erstellen h√§ufig </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit den Bl√∂cken Begin, Process und End.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen von .NET- und COM-Objekten (neues Objekt)</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt viele Softwarekomponenten mit .NET Core- und COM-Schnittstellen, die f√ºr Systemadministratoren n√ºtzlich sind. </font><font style="vertical-align: inherit;">Mit der System.Diagnostics.EventLog-Klasse k√∂nnen Sie Systemprotokolle direkt in Windows PowerShell verwalten. </font><font style="vertical-align: inherit;">Schauen wir uns ein Beispiel zum Erstellen einer Instanz dieser Klasse mit dem Cmdlet New-Object mit dem Parameter -TypeName an:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> System.Diagnostics.EventLog</code></pre><br>
<img src="https://habrastorage.org/webt/xu/qr/dg/xuqrdgtwodglftnhuszvu4uxaws.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir kein bestimmtes Ereignisprotokoll angegeben haben, enth√§lt die resultierende Instanz der Klasse keine Daten. </font><font style="vertical-align: inherit;">Um dies zu √§ndern, m√ºssen Sie w√§hrend der Erstellung die spezielle Konstruktormethode mit dem Parameter -ArgumentList aufrufen. </font><font style="vertical-align: inherit;">Wenn wir auf das Anwendungsprotokoll zugreifen m√∂chten, √ºbergeben Sie die Zeichenfolge "Anwendung" als Argument an den Konstruktor:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$AppLog</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> System.Diagnostics.EventLog <span class="hljs-literal">-ArgumentList</span> Application
<span class="hljs-variable">$AppLog</span></code></pre><br>
<img src="https://habrastorage.org/webt/gj/dl/vv/gjdlvvpxyezep9mwm180v702fb0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie: Wir haben die Ausgabe des Befehls in der Variablen $ AppLog gespeichert. </font><font style="vertical-align: inherit;">Obwohl Pipelines h√§ufig im interaktiven Modus verwendet werden, erfordert die Skripterstellung h√§ufig die Pflege einer Objektreferenz. </font><font style="vertical-align: inherit;">Dar√ºber hinaus sind die wichtigsten .NET Core-Klassen im System-Namespace enthalten: PowerShell sucht standardm√§√üig nach den darin angegebenen Typen, sodass das Schreiben von Diagnostics.EventLog anstelle von System.Diagnostics.EventLog v√∂llig korrekt ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um mit dem Journal zu arbeiten, k√∂nnen Sie auf die entsprechenden Methoden verweisen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$AppLog</span> | <span class="hljs-built_in">Get-Member</span> <span class="hljs-literal">-MemberType</span> Method</code></pre><br>
<img src="https://habrastorage.org/webt/t7/90/c5/t790c5xr4ripd1fr9la0euc5yym.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, es wird mit der Clear () -Methode mit Zugriffsrechten gel√∂scht:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$AppLog</span>.Clear()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Cmdlet New-Object wird auch zum Arbeiten mit COM-Komponenten verwendet. </font><font style="vertical-align: inherit;">Es gibt ziemlich viele davon - von den mit dem Windows-Skriptserver gelieferten Bibliotheken bis zu ActiveX-Anwendungen wie beispielsweise Internet Explorer. </font><font style="vertical-align: inherit;">Um ein COM-Objekt zu erstellen, m√ºssen Sie den Parameter -ComObject mit der Programmkennung ProgId der gew√ºnschten Klasse angeben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell
<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Network
<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Scripting.Dictionary
<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Scripting.FileSystemObject</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eigene Objekte mit einer beliebigen Struktur zu erstellen, wirkt die Verwendung von New-Object zu archaisch und umst√§ndlich. Dieses Cmdlet wird f√ºr die Arbeit mit Softwarekomponenten au√üerhalb von PowerShell verwendet. </font><font style="vertical-align: inherit;">In den folgenden Artikeln wird dieses Problem ausf√ºhrlicher behandelt. </font><font style="vertical-align: inherit;">Neben .NET- und COM-Objekten lernen wir auch CIM- (WMI) und ADSI-Objekte kennen.</font></font><br>
<br>
<a name="section8"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statische Methoden aufrufen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist nicht m√∂glich, Instanzen einiger .NET Core-Klassen zu erstellen. Dazu geh√∂ren System.Environment und System.Math. </font><font style="vertical-align: inherit;">Sie sind </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statisch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und enthalten nur statische Eigenschaften und Methoden. </font><font style="vertical-align: inherit;">Im Wesentlichen handelt es sich hierbei um Referenzbibliotheken, die verwendet werden, ohne Objekte zu erstellen. </font><font style="vertical-align: inherit;">Sie k√∂nnen durch ein Literal auf eine statische Klasse verweisen, wobei der Typname in eckige Klammern eingeschlossen wird. </font><font style="vertical-align: inherit;">Wenn Sie sich die Struktur des Objekts mit Get-Member ansehen, sehen Sie au√üerdem den Typ System.RuntimeType anstelle von System.Environment:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">System.Environment</span>] | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/ik/he/k0/ikhek0k2z6vca22zc3eycacvo5i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um nur statische Elemente anzuzeigen, m√ºssen Sie Get-Member mit dem Parameter -Static aufrufen (achten Sie auf den Objekttyp):</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">System.Environment</span>] | <span class="hljs-built_in">Get-Member</span> <span class="hljs-literal">-Static</span></code></pre><br>
<img src="https://habrastorage.org/webt/o0/g7/pb/o0g7pb_kewdzes-asln_mcgslz4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Zugriff auf statische Eigenschaften und Methoden werden zwei aufeinanderfolgende Doppelpunkte anstelle eines Punkts nach einem Literal verwendet:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-type">System.Environment</span>]::OSVersion</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span>=[<span class="hljs-type">System.Math</span>]::Sqrt(<span class="hljs-number">25</span>) 
<span class="hljs-variable">$test</span>
<span class="hljs-variable">$test</span>.GetType()</code></pre><br>
<img src="https://habrastorage.org/webt/yi/da/cs/yidacsgbamkq7sxl32r51ifmie0.png"><br>
<br>
<a name="section9"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie PSCustomObject ein</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter den vielen in PowerShell verf√ºgbaren Datentypen ist PSCustomObject zu erw√§hnen, mit dem Objekte mit einer beliebigen Struktur gespeichert werden k√∂nnen. </font><font style="vertical-align: inherit;">Das Erstellen eines solchen Objekts mit dem Cmdlet "New-Object" wird als klassische, aber umst√§ndliche und veraltete Methode angesehen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = <span class="hljs-built_in">New-Object</span>  ‚ÄìTypeName PSCustomObject <span class="hljs-literal">-Property</span> <span class="hljs-selector-tag">@</span>{Name = <span class="hljs-string">'Ivan Danko'</span>; <font></font>
                                          City = <span class="hljs-string">'Moscow'</span>;<font></font>
                                          Country = <span class="hljs-string">'Russia'</span>}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns die Struktur des Objekts an:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/m8/jr/vx/m8jrvxzu6wvnk4x2oi3bt-6w6zg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ab PowerShell 3.0 steht eine andere Syntax zur Verf√ºgung:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = [<span class="hljs-type">PSCustomObject</span>]<span class="hljs-selector-tag">@</span>{Name = <span class="hljs-string">'Ivan Danko'</span>; <font></font>
                                          City = <span class="hljs-string">'Moscow'</span>;<font></font>
                                          Country = <span class="hljs-string">'Russia'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen auf eine der folgenden Arten auf die Daten zugreifen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span>.Name<font></font>
<font></font>
<span class="hljs-variable">$object</span>.<span class="hljs-string">'Name'</span><font></font>
<font></font>
<span class="hljs-variable">$value</span> = <span class="hljs-string">'Name'</span>
<span class="hljs-variable">$object</span>.<span class="hljs-variable">$value</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Beispiel f√ºr die Konvertierung einer vorhandenen Hash-Tabelle in ein Objekt:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$hash</span> = <span class="hljs-selector-tag">@</span>{<span class="hljs-string">'Name'</span>=<span class="hljs-string">'Ivan Danko'</span>; <span class="hljs-string">'City'</span>=<span class="hljs-string">'Moscow'</span>; <span class="hljs-string">'Country'</span>=<span class="hljs-string">'Russia'</span>}
<span class="hljs-variable">$hash</span>.GetType()
<span class="hljs-variable">$object</span> = [<span class="hljs-type">pscustomobject</span>]<span class="hljs-variable">$hash</span>
<span class="hljs-variable">$object</span>.GetType()
</code></pre><br>
<img src="https://habrastorage.org/webt/m1/uu/ga/m1uugarnq3obtfdapd18xzqecva.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer der Nachteile von Objekten dieses Typs besteht darin, dass sich die Reihenfolge ihrer Eigenschaften √§ndern kann. </font><font style="vertical-align: inherit;">Um dies zu vermeiden, m√ºssen Sie das Attribut [geordnet] verwenden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = [<span class="hljs-type">PSCustomObject</span>][<span class="hljs-type">ordered</span>]<span class="hljs-selector-tag">@</span>{Name = <span class="hljs-string">'Ivan Danko'</span>; <font></font>
                                          City = <span class="hljs-string">'Moscow'</span>;<font></font>
                                          Country = <span class="hljs-string">'Russia'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt andere M√∂glichkeiten, ein Objekt zu erstellen: Oben haben wir die Verwendung des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmdlets Select-Object untersucht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es bleibt das Hinzuf√ºgen und Entfernen von Elementen zu behandeln. </font><font style="vertical-align: inherit;">Dies f√ºr das Objekt aus dem vorherigen Beispiel zu tun, ist ganz einfach:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> | <span class="hljs-built_in">Add-Member</span> ‚ÄìMemberType NoteProperty ‚ÄìName Age  ‚ÄìValue <span class="hljs-number">33</span>
<span class="hljs-variable">$object</span> | <span class="hljs-built_in">Get-Member</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/au/3v/fg/au3vfg5kkxvcg9hhotimmx_viog.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Cmdlet Add-Member k√∂nnen Sie dem zuvor erstellten $ object-Objekt nicht nur Eigenschaften, sondern auch Methoden hinzuf√ºgen, indem Sie das Konstrukt "-MemberType ScriptMethod" verwenden:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$ScriptBlock</span> = {
    <span class="hljs-comment">#  </span><font></font>
}<font></font>
<span class="hljs-variable">$object</span> | <span class="hljs-built_in">Add-Member</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">"MyMethod"</span> <span class="hljs-literal">-MemberType</span> ScriptMethod <span class="hljs-literal">-Value</span> <span class="hljs-variable">$ScriptBlock</span>
<span class="hljs-variable">$object</span> | <span class="hljs-built_in">Get-Member</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hinweis: Um den Code f√ºr die neue Methode zu speichern, haben wir die Variable $ ScriptBlock vom Typ ScriptBlock verwendet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1k/h7/um/1kh7umvv2w2ralp_6xwyxvhq2za.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie die entsprechende Methode, um Eigenschaften zu entfernen:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span>.psobject.properties.remove(<span class="hljs-string">'Name'</span>)</code></pre><br>
<a name="section10"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigene Klassen erstellen</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell 5.0 </font><font style="vertical-align: inherit;">bietet </font><font style="vertical-align: inherit;">die M√∂glichkeit, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mithilfe der charakteristischen Syntax f√ºr objektorientierte Programmiersprachen </font><font style="vertical-align: inherit;">zu definieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Hierf√ºr ist das Dienstwort Class vorgesehen. Danach sollten Sie den Klassennamen angeben und seinen Text in Operator-Klammern beschreiben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span></span><font></font>
{<font></font>
    <span class="hljs-comment">#  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein echter Typ von .NET Core, dessen Hauptteil seine Eigenschaften, Methoden und andere Elemente beschreibt. </font><font style="vertical-align: inherit;">Betrachten Sie ein Beispiel f√ºr eine einfache Klassendefinition:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span></span> <font></font>
{<font></font>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Name</span>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$City</span>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Country</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie zum Erstellen eines Objekts (einer Instanz einer Klasse) das Cmdlet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New-Object</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder ein Literal vom Typ [MyClass] und die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pseudostatische</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neue </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Methode</font></a><font style="vertical-align: inherit;"> (Standardkonstruktor):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> MyClass</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oder</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = [<span class="hljs-type">MyClass</span>]::new()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analysieren wir die Struktur des Objekts:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/gk/pt/pr/gkptprl6q2cwswt7lsdb2-0e_w8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie nicht den G√ºltigkeitsbereich: Sie k√∂nnen den Typnamen nicht als Zeichenfolge bezeichnen oder ein Typliteral au√üerhalb des Skripts oder Moduls verwenden, in dem die Klasse definiert ist. </font><font style="vertical-align: inherit;">Gleichzeitig k√∂nnen Funktionen Instanzen der Klasse (Objekte) zur√ºckgeben, die au√üerhalb des Moduls oder Skripts verf√ºgbar sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geben Sie nach dem Erstellen des Objekts seine Eigenschaften ein:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span>.Name = <span class="hljs-string">'Ivan Danko'</span>
<span class="hljs-variable">$object</span>.City = <span class="hljs-string">'Moscow'</span>
<span class="hljs-variable">$object</span>.Country = <span class="hljs-string">'Russia'</span>
<span class="hljs-variable">$object</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/tj/x4/sq/tjx4sqnhix6a4d7wmd_kqahdnj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass in der Klassenbeschreibung nicht nur Eigenschaftstypen festgelegt werden, sondern auch deren Standardwerte:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span></span><font></font>
{<font></font>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Name</span> = <span class="hljs-string">'John Doe'</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beschreibung der Klassenmethode √§hnelt der Beschreibung einer Funktion, jedoch ohne Verwendung der Funktionswortfunktion. </font><font style="vertical-align: inherit;">Wie in der Funktion werden die Parameter bei Bedarf an die Methoden √ºbergeben:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span></span> <font></font>
{<font></font>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Name</span>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$City</span>
     [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Country</span><font></font>
     <font></font>
     <span class="hljs-comment"># </span>
     Smile([<span class="hljs-built_in">bool</span>]<span class="hljs-variable">$param1</span>)<font></font>
     {<font></font>
         <span class="hljs-keyword">If</span>(<span class="hljs-variable">$param1</span>) {
            <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">':)'</span><font></font>
         }<font></font>
     }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt kann der Vertreter unserer Klasse l√§cheln:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$object</span> = [<span class="hljs-type">MyClass</span>]::new()
<span class="hljs-variable">$object</span>.Smile(<span class="hljs-variable">$true</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Methoden k√∂nnen √ºberladen werden. Dar√ºber hinaus verf√ºgt die Klasse √ºber </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statische Eigenschaften und Methoden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sowie √ºber Konstruktoren, deren Namen mit dem Namen der Klasse selbst √ºbereinstimmen. </font><font style="vertical-align: inherit;">Eine in einem Skript oder PowerShell-Modul definierte Klasse kann als Basis f√ºr eine andere Klasse dienen - so wird die Vererbung implementiert. </font><font style="vertical-align: inherit;">Gleichzeitig ist die Verwendung vorhandener .NET-Klassen als Basis zul√§ssig:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass2</span> : <span class="hljs-title">MyClass</span></span><font></font>
{<font></font>
      <span class="hljs-comment">#  ,     MyClass</span><font></font>
}<font></font>
[<span class="hljs-type">MyClass2</span>]::new().Smile(<span class="hljs-variable">$true</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Beschreibung der Arbeit mit Objekten in PowerShell ist kaum ersch√∂pfend. </font><font style="vertical-align: inherit;">In den folgenden Ver√∂ffentlichungen werden wir versuchen, dies anhand praktischer Beispiele zu vertiefen: Der f√ºnfte Artikel der Reihe befasst sich mit den Fragen der Integration von PowerShell in Softwarekomponenten von Drittanbietern. </font><font style="vertical-align: inherit;">Fr√ºhere Teile finden Sie unter den folgenden Links.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 1:   Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> 3:      ,  </a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de494964/index.html">Neuronale Netze und Handel. Praktische Anwendung</a></li>
<li><a href="../de494966/index.html">SCRUM: ein Gedicht √ºber Liebe und Schmerz</a></li>
<li><a href="../de494968/index.html">Unterwasser-Internetkabel: Wer verlegt sie?</a></li>
<li><a href="../de494970/index.html">Introversion: Zuf√§lligkeit innerhalb der Fehlergrenze oder evolution√§rer Mechanismus des Artenschutzes?</a></li>
<li><a href="../de494972/index.html">SEMrush vs SimilarWeb - wer ist genauer?</a></li>
<li><a href="../de494990/index.html">Zeit richtig nutzen: Prozessautomatisierung in Tinder</a></li>
<li><a href="../de494992/index.html">Informationen zu Mathematik, Pandemien und Quarant√§nen wurden fortgesetzt</a></li>
<li><a href="../de494994/index.html">Ein wesentlicher Beweis f√ºr den Satz der Informatik erfasst die Physik mit der Mathematik</a></li>
<li><a href="../de494998/index.html">Algorithmen f√ºr die Pr√ºfung im SHAD</a></li>
<li><a href="../de495000/index.html">Data Home: Welche Art von Daten wird vom √ñkosystem der intelligenten Dinge generiert?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>