<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòç üö¶ üöó Networking en Flexiant Cloud Orchestrator üöµüèΩ üéÖüèæ üõÄüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En la continuaci√≥n de la serie de art√≠culos sobre la orquesta de la nube, a Flexiant le gustar√≠a hablar sobre c√≥mo se gestiona la organizaci√≥n de la r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Networking en Flexiant Cloud Orchestrator</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499234/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la continuaci√≥n de la serie de art√≠culos sobre la orquesta de la nube, a Flexiant le gustar√≠a hablar sobre c√≥mo se gestiona la organizaci√≥n de la red para m√°quinas virtuales y contenedores bajo esta orquesta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flexiant identifica cuatro tipos de redes a las que puede acceder el cliente en su m√°quina virtual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVIP es una red en la que se asigna una √∫nica direcci√≥n / 32 a un cliente. El enrutamiento a esta direcci√≥n IP se realiza en la m√°quina host en la que se encuentra la m√°quina virtual de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP p√∫blica: la red en la que el cliente recibe una VLAN separada y una subred / 29. Esta es la red principal que utilizamos. El enrutamiento se realiza en nodos de enrutador especiales administrados por Flexiant Cloud Orchestrator.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP privada: red, organizaci√≥n similar a la anterior, excepto que no se muestra externamente en los nodos del enrutador. Un cliente puede usarlo para crear redes internas entre sus m√°quinas virtuales. Las direcciones IP pueden asignarse tanto desde la interfaz como desde la propia m√°quina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VLAN de interfuncionamiento: de nuevo, es muy similar a la IP privada, excepto que no est√° disponible para el cliente directamente sin la participaci√≥n del proveedor. Le damos esta red al cliente cuando necesita conectar la infraestructura L2 existente a la infraestructura de Flexiant Cloud Orchestrator.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas las redes, excepto la primera, operan en una VLAN aislada separada; en consecuencia, todos los protocolos L2 est√°n disponibles para el cliente: arp, dhcp, lldp, etc. La red PVIP se ejecuta en L3, y la usamos para clientes que desean obtener protecci√≥n contra DDoS. Si quieren proteger las direcciones IP, necesitan usarlo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada red est√° asignada a un adaptador de m√°quina virtual. Por lo tanto, en una m√°quina virtual puede haber varios tipos de redes al mismo tiempo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los clientes pueden elegir arbitrariamente las direcciones IP para IP privada y VLAN de interfuncionamiento. Las direcciones IP para IP p√∫blica y PVIP se seleccionan de la lista en el panel de control.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_l/zn/kr/_lznkrleqhvfpqv5okrisl7wcb4.jpeg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tan pronto como el adaptador recibe la red, y opcionalmente una direcci√≥n IP, la informaci√≥n sobre esto entra en la base de datos de la orquesta, y la configuraci√≥n correspondiente se ingresa en los nodos de enrutamiento (para la red IP p√∫blica), nodos de computaci√≥n (para PVIP), as√≠ como en el servidor DHCP ubicado en el nodo de gesti√≥n, en caso de que se haya configurado una direcci√≥n IP. La tabla de correspondencia entre la direcci√≥n MAC virtual de la tarjeta y la direcci√≥n IP seleccionada se ingresa en la base de datos PgSQL, desde donde es extra√≠da por el servidor DHCP.</font></font><br>
<cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cada nodo, ya sea un nodo de enrutador o un nodo de proceso, se instala el agente Flexiant, que recibe comandos de la orquesta. Dentro de los propios nodos, se genera un enrutador virtual en un espacio de nombres de red separado. Por lo tanto, la pila de red de Linux en los nodos y la pila de red del enrutador virtual son independientes entre s√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los nodos de enrutador que aseguran el funcionamiento de IP p√∫blica se duplican entre s√≠ utilizando el protocolo VRRP en la implementaci√≥n de carpa. Si uno de los nodos falla, el tr√°fico pasar√° por el otro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay un ejemplo de enrutamiento en el nodo de ruta para uno:</font></font><br>
<br>
<pre><code class="plaintext hljs">Router0# ip a l<font></font>
‚Ä¶<font></font>
766: VLAN367: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default<font></font>
    link/ether 00:1e:67:d3:67:5c brd ff:ff:ff:ff:ff:ff<font></font>
    inet6 fe80::e0fe:25ff:fef9:7304/64 scope link<font></font>
     valid_lft forever preferred_lft forever<font></font>
‚Ä¶<font></font>
Router0# brctl show VLAN367<font></font>
bridge name     bridge id               STP enabled     interfaces<font></font>
VLAN367         8000.001e67d3675c       no              bond0.367<font></font>
                                                                               evrl-000190<font></font>
<font></font>
#         ,     shell  screen,       <font></font>
<font></font>
Router0# evrs<font></font>
Router0# ip a l evrr-000190<font></font>
768: evrr-000190: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<font></font>
    link/ether e6:52:0f:21:83:b0 brd ff:ff:ff:ff:ff:ff<font></font>
    inet 217.23.xxx.xxx/29 scope global evrr-000190<font></font>
       valid_lft forever preferred_lft forever<font></font>
    inet6 fe80::e452:fff:fe21:83b0/64 scope link<font></font>
       valid_lft forever preferred_lft forever<font></font>
<font></font>
Router0# ip r l 217.23.xxx.xxx<font></font>
217.23.xxx.xxx/29 dev evrr-000190  proto kernel  scope link  src 217.23.xxx.xxx<font></font>
Router#0 ip r l ip r l 0.0.0.0/0<font></font>
default via 10.158.192.3 dev evrr-000000  proto bird<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un par de interfaces evrr / evrl son veths regulares en Linux que interconectan dos espacios de nombres de red. Por lo tanto, se ve c√≥mo el tr√°fico entrante que ingresa al enrutador virtual se enruta all√≠ a una interfaz espec√≠fica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La administraci√≥n de firewall tambi√©n se lleva a cabo en un enrutador virtual. Se crean tablas y cadenas separadas que permiten o no permiten el tr√°fico a una interfaz de red en particular.</font></font><br>
<br>
<pre><code class="plaintext hljs">Router0# iptables -nvL evrr-000190-4i<font></font>
Chain evrr-000190-4i (1 references)<font></font>
 pkts bytes target     prot opt in     out     source               destination<font></font>
 435M  124G RETURN     all  --  *      *       217.23.xxx.xxx        0.0.0.0/0<font></font>
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0<font></font>
Router0# iptables -nvL evrr-000190-4o<font></font>
Chain evrr-000190-4o (1 references)<font></font>
pkts bytes target     prot opt in     out     source               destination<font></font>
587M  782G ACCEPT     all  --  *      *       0.0.0.0/0            217.23.xxx.xxx<font></font>
6038K  350M DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usamos OSPF como protocolo de enrutamiento, la configuraci√≥n con c√≥mputo y el nodo del enrutador llega al n√∫cleo de la red, y desde all√≠ a los enrutadores centrales. </font><font style="vertical-align: inherit;">Como software en los nodos, se usa bird, que es controlado por Flexiant. </font><font style="vertical-align: inherit;">Tambi√©n realizamos cambios en las plantillas de configuraci√≥n, ya que Flexiant nos permite hacer esto. </font><font style="vertical-align: inherit;">Flexiant tambi√©n le permite usar estad√≠sticas y bgp como protocolos de enrutamiento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En t√©rminos de pago, todas las redes son gratuitas. </font><font style="vertical-align: inherit;">El pago es solo para direcciones IP para PVIP y redes IP p√∫blicas. </font><font style="vertical-align: inherit;">Sin embargo, las direcciones IP para PVIP son m√°s caras porque est√°n protegidas de ataques DDoS.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499220/index.html">La transferencia de desarrolladores a un sitio remoto debido al coronavirus aument√≥ la productividad en Google y Microsoft</a></li>
<li><a href="../es499224/index.html">Es hora de comenzar a aprender bien</a></li>
<li><a href="../es499226/index.html">Sin pandemia: c√≥mo hacer una pel√≠cula sobre criptomonedas por $ 1000 y entrar en la distribuci√≥n de pel√≠culas m√°s importante de EE. UU.</a></li>
<li><a href="../es499230/index.html">C√≥mo criar un gusano sano y contento: analizando el manual de 1910</a></li>
<li><a href="../es499232/index.html">Configuraci√≥n de gitlab.com CI y servidor VPS</a></li>
<li><a href="../es499236/index.html">N√∫mero de tel√©fono a trav√©s de los servicios estatales</a></li>
<li><a href="../es499238/index.html">Soldar en casa: grabaci√≥n de flujo</a></li>
<li><a href="../es499240/index.html">A trav√©s de espinas a las estrellas, o an√°lisis de datos en los asuntos del cielo</a></li>
<li><a href="../es499242/index.html">Los investigadores transmitieron datos desde una PC de escritorio a trav√©s de vibraciones a trav√©s de una mesa</a></li>
<li><a href="../es499244/index.html">Organizaciones sinerg√©ticas. Parte II</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>