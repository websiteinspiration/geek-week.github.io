<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåä üèÇüèæ üçÑ Deploy Hyperledger Fabric 1.4 on AWS ‚óªÔ∏è üíî üëã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hyperledger Fabric is an open source blockchain platform from the Linux Foundation. With it, you can create blockchain applications and control access...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Deploy Hyperledger Fabric 1.4 on AWS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/499214/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hyperledger Fabric is an open source blockchain platform from the Linux Foundation. With it, you can create blockchain applications and control access and permissions for data in the blockchain. Hyperledger Fabric should be used if you want to create a private blockchain network or set restrictions on what transactions each side can see. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the documentation of Hyperledger Fabric, the creation of a blockchain network on one machine using Docker is well-planned, where each network member is a separate container. But the process of setting up a network on several physical or virtual machines is not described. This will be discussed in this article.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our blockchain application is a service for storing some medical data of school and preschool children. </font><font style="vertical-align: inherit;">Data must be unchanged. </font><font style="vertical-align: inherit;">They will be presented in the form of information about vaccination and the patient‚Äôs agreement with a particular doctor. </font><font style="vertical-align: inherit;">The network will include members of Parents (an organization that represents the interests of parents), Hospital (a hospital with whose pediatricians parents can enter into an agreement to care for their child / children) and Kindergarten (a kindergarten that can request health reports and vaccinations for or another child at the hospital).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon managed blockchain</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS has an Amazon Managed Blockchain service. </font><font style="vertical-align: inherit;">It allows you to deploy blockchain networks using the AWS console user interfaces. </font><font style="vertical-align: inherit;">But, having gained some experience working with Amazon Managed Blockchain, we had to abandon the idea of ‚Äã‚Äãusing the service in commercial projects. </font><font style="vertical-align: inherit;">There were several reasons for this. </font><font style="vertical-align: inherit;">The main ones are:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Only the version of Hyperledger Fabric 1.2 was available in the Amazon Managed Blockchain, and at the time of this writing, version 1.4 is used to build enterprise blockchain networks. </font><font style="vertical-align: inherit;">It also does not allow the use of modern versions of the Node.js SDK tools;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Managed Blockchain does not support the CouchDB database, making it difficult to create applications that index stored data.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, our opinion is that it is better to use virtual or physical servers to build networks using the Hyperledger Fabric framework.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About app channels</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hyperledger Fabric has the concept of "channel." </font><font style="vertical-align: inherit;">A channel is a subnet for conducting sensitive transactions. </font><font style="vertical-align: inherit;">There will be two channels in our application.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospital". </font><font style="vertical-align: inherit;">It is intended for transactions between members of Parents and Hospital organizations: creating and modifying medical records, creating an agreement with a pediatrician, and signing a pediatrician agreement.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Parentshospitalkindergarten." </font><font style="vertical-align: inherit;">Within this channel, members of Parents and Hospital will interact with members of Kindergarten. </font><font style="vertical-align: inherit;">Also, reports will be generated based on data from medical records.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Work environment</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will deploy our blockchain network using Docker Swarm - this is the native Docker system for deploying a host cluster. If you have never worked with Docker (and especially with Docker Swarm), then first check out this product and how to orchestrate containers using Docker Swarm. The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> describes the basics of working with these tools well.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our entire network will be located on AWS EC2 servers. </font><font style="vertical-align: inherit;">Information within the blockchain network will be stored in CouchDB. </font><font style="vertical-align: inherit;">Hyperledger Fabric also supports the LevelDB database, but CouchDB, unlike the latter, makes it possible to search by any criterion in a document collection. </font><font style="vertical-align: inherit;">We will also use Fabric Certificate Authority, a modular component for managing network identifiers of all organizations and their users. </font><font style="vertical-align: inherit;">It provides registration of network participants and the issuance of certificates. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will have four EC2 servers:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orderer, MySQL DB (for storing application information that does not apply to medical records)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parents organization (Peer0, Peer1), CouchDB, Fabric-CA, CLI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hospital organization (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kindergarten organization (Peer0, Peer1), CouchDB, Fabric-CA</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating EC2 Servers on AWS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We need t2.medium services to work. </font><font style="vertical-align: inherit;">This type of EC2 server has sufficient computing power to install all the necessary software and work with the Hyperledger Fabric tool. </font><font style="vertical-align: inherit;">In the Configure Security Group, set All traffic, and Source - 0.0.0.0/0, :: / 0. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/kx/iu/bbkxiua1teuzbc0jbmajtl-o5i0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 1. </font><font style="vertical-align: inherit;">Configure Security Group in the AWS panel. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We got four EC2 servers:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-18-232-164-119.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-145-203-186.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-54-80-241-117.compute-1.amazonaws.com</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ec2-52-87-193-235.compute-1.amazonaws.com</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You will naturally have your own paths to EC2 servers. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/az/ab/as/azabas37iihj5xmuaqzrty6-mcc.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 2. </font><font style="vertical-align: inherit;">Prepared for operation EC2 servers.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installing prerequisite software on EC2 servers</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now on each EC2 server we need to install Docker and Git. </font><font style="vertical-align: inherit;">For convenience, open four tabs in the terminal. </font><font style="vertical-align: inherit;">Let's go to each EC2 service via SSH: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 1:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST1 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 2:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST2 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 3:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST3=ec2-54-80-241-117.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST3 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal 4:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST4=ec2-52-87-193-235.compute-1.amazonaws.com<font></font>
ssh ec2-user@$HOST4 -i ./key-poc.pem<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In each terminal, execute the following commands:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum update -y<font></font>
sudo yum install -y docker<font></font>
sudo service docker start<font></font>
sudo docker info<font></font>
sudo yum install git<font></font>
sudo usermod -a -G docker ec2-user<font></font>
newgrp docker<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we have Docker and Git installed.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We need to clone elements of our network from the repository. </font><font style="vertical-align: inherit;">To do this, execute the command in each terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">git clone https://github.com/nixsolutions/blockchain-poc-network.git network
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also need to clone smart contracts from the repository that will regulate the relationships between network participants. </font><font style="vertical-align: inherit;">Smart contracts are written in the Golang language. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We perform these steps on each of the four servers:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network &amp;&amp; mkdir chaincode &amp;&amp; cd chaincode<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-medical-contract.git medical-contract<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-kindergarten-contract.git kindergarten-contract<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the first terminal, we need to generate channel configuration files and certificates for connecting organizations to the network:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd network/poc-network<font></font>
./1_generate_connection_files.sh<font></font>
./2_generating_channel_configuration.sh<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now copy the channel-artifacts and crypto-config folders to the other three hosts in the poc-network folder of the network parent directory. </font><font style="vertical-align: inherit;">Please note: when copying organizations to the EC2 server, you need to remove third-party certificates from the crypto-config / peerOrganizations folder that relate to the work of other organizations. </font><font style="vertical-align: inherit;">For example, when copying to the Parents host, we need to leave the parents.poc-network.com folder in this folder, but delete hospital.poc-network.com and kindergarten.poc-network.com.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating a Docker Swarm Stack</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order for containers that belong to different organizations and are located on different EC2 servers to be able to access each other, we need to combine them into a stack. </font><font style="vertical-align: inherit;">Let's look at our file network / poc-network / docker-compose-general.yaml. </font><font style="vertical-align: inherit;">It contains the configuration of services, indicates which hosts a particular service (key </font></font><code>node.hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">will be deployed to </font><font style="vertical-align: inherit;">, aliases (key </font></font><code>aliases</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">are indicated </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We need to initialize swarm in the first terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm init<font></font>
docker swarm join-token manager<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A token will appear to attach another EC2 server to the stack. </font><font style="vertical-align: inherit;">Something like: </font></font><code>docker swarm join --token SWMTKN-1-42ml0ohnnbidg8kflgp8xp9dkkus6mn1lslqc15hrxj4tk9e3q-5h4vbzbfk8p90n83oe08gbltf 172.31.46.214:2377</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we can execute in the remaining terminals:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker swarm join --token SWMTKN-1-2xzco7t7txohnzd09318eczpbgmm8woex80byxptpt1jl5i2ar-bsg37h40xze1gaabg80i96gw2 172.31.38.245:2377
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A message appears in the console:</font></font><br>
<br>
<pre><code class="plaintext hljs">This node joined a swarm as a manager.
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After all three hosts are connected to Swarm, we can see them in the terminal of the first host by running the command:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker node ls
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16d/687/898/16d687898e5eb8b4ed00883d4eef2de7.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3. </font><font style="vertical-align: inherit;">List of servers in Docker Swarm. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the network / poc-network folder there is a .env.template file in which you need to specify a hostname for each of the hosts: </font></font><br>
<br>
<code>ORDERER=ip-172-31-38-245</code><br>
<code>PARENTS=ip-172-31-43-64</code><br>
<code>HOSPITAL=ip-172-31-38-130</code><br>
<code>KINDERGARTEN=ip-172-31-40-157</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To generate a .env file, you need to run the ./3_env_gen.sh file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now create a network with a driver </font></font><code>overlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker network create --driver overlay --attachable stage_byfn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run Swarm to create a stack based on the docker-compose-general.yaml file:</font></font><br>
<br>
<pre><code class="plaintext hljs">env $(cat .env | grep ^[A-Z] | xargs) docker stack deploy -c docker-compose-general.yaml stage 2&gt;&amp;1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With this command, we also set environment variables, which are described in the .env file and which are necessary for the network to work correctly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can execute the command </font></font><code>docker service ls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the first terminal. </font><font style="vertical-align: inherit;">You will see a list of all the services that are running on all our EC2 instances.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc6/d4d/e6c/dc6d4de6c534c2b97430a1cf2e45512c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4. </font><font style="vertical-align: inherit;">List of all services that were running on all EC2 servers. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you see the same thing in your terminal as in the screenshot, then everything is fine. </font><font style="vertical-align: inherit;">Now run our network. </font><font style="vertical-align: inherit;">In the second terminal, you must enter the CLI container (after all, this container is deployed on the second host):</font></font><br>
<br>
<pre><code class="plaintext hljs">docker exec -ti stage_cli.1.owni217t53m53efjtikb5oa2f /bin/bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The container name can be seen by executing the command in the terminal </font></font><code>docker ps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the container, we execute all our commands from the 4_create_channels.sh file, copying them one by one to the terminal. </font><font style="vertical-align: inherit;">In the bin folder, we have the binaries for creating the network:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer channel create - create channels;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer channel join - joining a peer to a channel;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer channel update - update configurations;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer chaincode install - install the codecode;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peer chaincode instantiate - deploy the specified chain code on the network.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can leave the container by running the command </font></font><code>exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parents Back Application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install the application on the second host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also need to install NodeJS and gcc-c ++ (compiler):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can also enter our database through adminer with the following authorization data: </font></font><br>
<br>
<code>&lt;HOST_1&gt;:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(where </font></font><code>&lt;HOST_1&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the address of the first EC2 server on which the database is stored) </font></font><br>
<code>dev</code><br>
<code>devpass</code><br>
<code>poc_database</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is also necessary to connect our API application to the database:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/config/config.json
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assign the correct value to the key </font></font><code>host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Our back-application has prepared migrations and seeds. </font><font style="vertical-align: inherit;">You need to run them:</font></font><br>
<br>
<pre><code class="plaintext hljs">npx sequelize-cli db:migrate<font></font>
npx sequelize-cli db:seed:all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tables should appear in the database. </font><font style="vertical-align: inherit;">And in the table of organizations we will see three rows with our organizations - parents, hospital, kindergarten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When generating certificates at the very beginning, we received files for connecting to the network for each organization on the first host. </font><font style="vertical-align: inherit;">Copy the connection-parents.json file from the first host to the second. </font><font style="vertical-align: inherit;">To do this, open another terminal from the folder where ours </font></font><code>key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is located and execute the commands:</font></font><br>
<br>
<pre><code class="plaintext hljs">HOST1=ec2-18-232-164-119.compute-1.amazonaws.com<font></font>
HOST2=ec2-54-145-203-186.compute-1.amazonaws.com<font></font>
scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-parents.json ~<font></font>
scp -i ./key-poc.pem ~/connection-parents.json ec2-user@$HOST2:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fix </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in constants.js (value for the current host):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run our application in the second terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the userGenerator.sh file, assign the </font></font><code>HOST_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correct value to the </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, you need to run the script that will create the users of the Parents organization:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh parents
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run the script to generate medical records:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Two cards will be created in the blockchain, which will also be written into the SQL database in the cards table.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hospital back application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By analogy with the previous back-application, we need to place the file to connect to the network on the third host. </font><font style="vertical-align: inherit;">To do this, in the fifth terminal, execute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-hospital.json ~<font></font>
scp -i ./key-poc.pem ~/connection-hospital.json ec2-user@$HOST3:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will clone our application to the third host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install NodeJS and gcc-c ++ (compiler):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fix </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in constants.js (value for the current host):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run our application in the third terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the userGenerator.sh file, assign the </font></font><code>HOST_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correct value to the </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we need to run a script that will create users of the Hospital organization:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh hospital
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We now have a second user in the Users table in the database.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kindergarten back application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By analogy with the previous back-application, we need to place the file to connect to the network on the third host. </font><font style="vertical-align: inherit;">To do this, in the fifth terminal, execute:</font></font><br>
<br>
<pre><code class="plaintext hljs">scp -i ./key-poc.pem -r ec2-user@$HOST1:~/network/poc-network/connection-kindergarten.json ~<font></font>
scp -i ./key-poc.pem ~/connection-kindergarten.json ec2-user@$HOST4:~/network/poc-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will clone our application to the third host:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-backend.git back<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install NodeJS and Gcc-c ++ (compiler):</font></font><br>
<br>
<pre><code class="plaintext hljs">curl -sL https://rpm.nodesource.com/setup_10.x | sudo bash -<font></font>
sudo yum install nodejs<font></font>
cd back<font></font>
sudo yum install gcc-c++ -y<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fix </font></font><code>exports.hostName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in constants.js (value for the current host):</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/constants.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run our application in the third terminal:</font></font><br>
<br>
<pre><code class="plaintext hljs">npm start
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the userGenerator.sh file, assign the </font></font><code>HOST_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correct value to the </font><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~/back/generators/userGenerator.sh
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we need to run a script that will create users of the Hospital organization:</font></font><br>
<br>
<pre><code class="plaintext hljs">./back/generators/userGenerator.sh kindergarten
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We now have a third user in the Users table in the database.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install wkhtmltopdf on the second, third and fourth EC2 servers</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The back-application uses the wkhtmltopdf library to generate a PDF report on the child‚Äôs health status. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We need to install libpng - the official library for working with raster graphics in PNG format. </font><font style="vertical-align: inherit;">The library is platform independent and consists of functions written in C language. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first team will install wkhtmltox - the open source LGPLv3 library for rendering HTML to PDF and various image formats using the QtWebKit rendering engine:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
sudo yum install -y wkhtmltox-0.12.5-1.centos7.x86_64.rpm<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second block of commands will download and deploy the libpng15 library:</font></font><br>
<br>
<pre><code class="plaintext hljs">wget https://sourceforge.net/projects/libpng/files/libpng15/older-releases/1.5.15/libpng-1.5.15.tar.gz/download -O libpng-1.5.15.tar.gz<font></font>
tar -zxvf libpng-1.5.15.tar.gz<font></font>
cd libpng-1.5.15<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The third block of commands is needed to install the compiler:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum groupinstall -y "Development Tools"<font></font>
./configure --prefix=/usr<font></font>
sudo make install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You still need to install LibTIFF:</font></font><br>
<br>
<pre><code class="plaintext hljs">sudo yum install -y libtiff
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can test:</font></font><br>
<br>
<pre><code class="plaintext hljs">wkhtmltopdf https://majestic.cloud majestic.pdf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you can generate and view PDF documents.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A little bit about Node SDK</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NodeJS-tools for working with the Hyperledger Fabric network are presented in the form of packages "fabric-ca-client -v 1.4.0" and "fabric-network" v 1.4.0 ". </font><font style="vertical-align: inherit;">All services of the backend application that interact with the network using the Node SDK are located in the Services folder, at the root of the project. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can read about these tools and their methods in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application business processes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we‚Äôll talk about how network members interact with each other in this application. </font><font style="vertical-align: inherit;">All processes are described in a UML diagram. </font><font style="vertical-align: inherit;">Let's consider each of them in more detail.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31f/484/89d/31f48489d84e6f301b105a4cff8b45c7.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.5. A graphical description of the business processes in the application.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, there are several organizations on the network: Parents, Hospital and Kindergarten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A member of Parents creates electronic health records for two of their children. This data will be stored (and supplemented) in the blockchain network. Next, the parent sends a request for an agreement with the pediatrician, who will observe his children until they reach adulthood (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">request for an agreement with a doctor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A member of the hospital organization signs an agreement (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doctor signs an agreement</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, the parent sends a request to kindergarten with a request to enroll his child (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">request for kindergarten to receive a child</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf9/da3/cee/cf9da3ceedba087e53abef137fbe353b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 6. </font><font style="vertical-align: inherit;">A page with a list of available educational institutions in the parent's account. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kindergarten sees the request in the list of new requests:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/d01/a8b/7cdd01a8bf99c9cf9d916eef519ff66b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 7. </font><font style="vertical-align: inherit;">A page with a list of applications for admission to the personal account of the educational institution. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kindergarten before deciding on the admission of the child must make sure his satisfactory state of health. </font><font style="vertical-align: inherit;">To do this, the kindergarten sends a request to the clinic in which this child is observed (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">child health report request</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">The request to the pediatrician is executed automatically after the request for admission to the garden is moved to the "Accepted" tab.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff1/5af/d29/ff15afd292455ccf1a0e9cdc69315f4c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 8. </font><font style="vertical-align: inherit;">A page with a list of approved applications for admission to the personal account of the educational institution. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The pediatrician sees the request and generates a report that contains data on the child‚Äôs health (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">child health report create</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/1e6/1f2/8be1e61f2dbbd9e146259a5b3a11ffa2.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 9. </font><font style="vertical-align: inherit;">Page with a list of applications for creating a report on the state of the child‚Äôs health in the personal account of the hospital. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The parent sees that the pediatrician has generated a report:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/fe9/c40/06dfe9c403dfe790632d631c7a54e7b0.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 10. </font><font style="vertical-align: inherit;">The page in the parent‚Äôs personal account, which displays the status of reports on the child‚Äôs health </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... and makes a decision on granting access to the preschool educational institution to view and download the report (in the diagram - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">give permission to view the report</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35f/ed9/c86/35fed9c8680c84dda737f7acb6029afc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 11. </font><font style="vertical-align: inherit;">A pop-up window for choosing an educational institution that can view the generated medical report. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parent clicks "Confirm":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/00d/cb5/3cf00dcb54572c2b93b3f2af509d8245.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 12. </font><font style="vertical-align: inherit;">Notification that the selected educational institution has received permission to view the medical report. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the list of reports in the application of the educational institution, information appears that the report has been generated and is available for viewing and downloading in PDF format.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b6/a1a/ac2/2b6a1aac247da598bf28f434d0614616.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 13. </font><font style="vertical-align: inherit;">Link to download the report in PDF format in the line with the approved application. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a report you will see in a new tab on your computer:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbb/94a/1e1/fbb94a1e19e8e0db4354d2cc60b6927e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 14. </font><font style="vertical-align: inherit;">A health report generated by a hospital employee.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creating medical records and agreements with a pediatrician, signing an agreement</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the application is designed more to demonstrate the deployment of the network on separate EC2 servers, we will execute some commands from the prepared scripts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First EC2 Server:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/setCards.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have previously connected to the database. </font><font style="vertical-align: inherit;">After executing the command, you will see two entries in the Cards table. </font><font style="vertical-align: inherit;">Also, information about the medical data of these two children was recorded on the blockchain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From this EC2 server we need to create an agreement with a pediatrician who will observe the children:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/createAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now this agreement must be signed by the user whom we created for the organization Hospital. </font><font style="vertical-align: inherit;">We execute the command from the second host:</font></font><br>
<br>
<pre><code class="plaintext hljs">node ~/back/generators/signAgreement.js
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our agreement is signed by the doctor and we can continue to work on our application. </font><font style="vertical-align: inherit;">Next, we need to install the frontend application on the second, third and fourth EC2 servers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS: You can find all the commands for generating users, cards, agreements and signing agreements in the ~ / back / generators folder.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parents Frontend Application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run on the second host (where the Parents organization is located):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We create the .env file and specify the host name on which our frontend application will be located:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-75-46.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is necessary to establish the dependencies:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You must also build the application and run it on port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our application will be available at: </font></font><code>http://&lt;HOST_2&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><code>&lt;HOST_2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the address of the second EC2 server on which our application is located. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>parents</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">password: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is what the frontend will look like. </font><font style="vertical-align: inherit;">Here you will see information about the medical cards that we created from the terminal:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/409/71a/2dd/40971a2dde54cabe268936b96d0a3618.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 15. </font><font style="vertical-align: inherit;">Information about the medical records of children in the personal account of the parent.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hospital Frontend Application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run on the second host (where the Hospital organization is located):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We create the .env file and specify the host name on which our frontend application will be located:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-3-91-238-161.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is necessary to establish the dependencies:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You must also build the application and run it on port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our application will be available at: </font></font><code>http://&lt;HOST_3&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><code>&lt;HOST_3&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the address of the third EC2 server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>hospital</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">password: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kindergarten frontend application</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Run on the second host (where the Kindergarten organization is located):</font></font><br>
<br>
<pre><code class="plaintext hljs">cd ~<font></font>
git clone https://github.com/nixsolutions/blockchain-poc-frontend.git front<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We create the .env file and specify the host name on which our frontend application will be located:</font></font><br>
<br>
<pre><code class="plaintext hljs">vim ~ /front/.env:
</code></pre><br>
<br>
<pre><code class="plaintext hljs">VUE_APP_API_BASE_URL='http://ec2-107-22-12-137.compute-1.amazonaws.com:3006/'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is necessary to establish the dependencies:</font></font><br>
<br>
<pre><code class="plaintext hljs">cd front<font></font>
npm install<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You must also build the application and run it on port 8080:</font></font><br>
<br>
<pre><code class="plaintext hljs">docker build . -t my-app<font></font>
docker run -d -p 8080:80 my-app<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our application will be available at: </font></font><code>http://&lt;HOST_4&gt;:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font><code>&lt;HOST_4&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the address of the fourth EC2 server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Login: </font></font><code>kindergarten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">password: </font></font><code>password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We examined how to deploy a network of blockchain applications on several virtual or physical servers. </font><font style="vertical-align: inherit;">The article is designed to be familiar with the basics of blockchain technology, know what smart contracts are, and at least superficially familiar with the Hyperledger Fabric framework and its standard fabric-samples application.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en499202/index.html">Opium.Fill - standardization of the color scheme through the eyes of the programmer</a></li>
<li><a href="../en499206/index.html">Virtual assistants. Creating chatbots without programming</a></li>
<li><a href="../en499208/index.html">Digital events in Moscow from April 27 to May 3</a></li>
<li><a href="../en499210/index.html">Digital events in St. Petersburg from April 27 to May 3</a></li>
<li><a href="../en499212/index.html">IBM Weekly Seminars - April 2020</a></li>
<li><a href="../en499216/index.html">Design at the system level. Part 2. Detailed architecture</a></li>
<li><a href="../en499220/index.html">Transferring developers to a remote site due to coronavirus increased productivity in Google and Microsoft</a></li>
<li><a href="../en499224/index.html">It's time to start learning right</a></li>
<li><a href="../en499226/index.html">No pandemic: how to make a movie about cryptocurrency for $ 1000 and get into the top US movie distribution</a></li>
<li><a href="../en499230/index.html">How to raise a healthy contented worm: parsing the 1910 manual</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>