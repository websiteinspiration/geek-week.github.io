<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë¶ üë¶üèΩ üÜò How to create a custom view for alert (), confirm () and prompt () for use in JavaScript ü§üüèæ üë©üèæ‚Äç‚úàÔ∏è ‚úåüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have long been thinking about customizing the appearance of typical user interaction functions in JavaScript - alert (), confirm () and prompt () (h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to create a custom view for alert (), confirm () and prompt () for use in JavaScript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496372/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I have long been thinking about customizing the appearance of typical user interaction functions in JavaScript - alert (), confirm () and prompt () (hereinafter modal windows). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indeed, they are very convenient to use, but different in different browsers and very unsightly in appearance. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finally, the hands reached. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What is the problem? The usual means of displaying dialogs (for example, bootstrap) cannot be used as simply as alert, where the browser arranges for the JavaScript code to stop executing and waiting for the user to act (click on the close button). Modal in bootstrap will require a separate event handling - clicking on a button, closing a modal window ...</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nevertheless, I have already used customization of alerts in games to replace standard messages with those corresponding to the style of game design. This works well, including connection error messages and other system situations. But this will not work if the user needs to wait for a response!</font></font><br>
<img src="https://habrastorage.org/webt/c4/mc/c_/c4mcc_awjvsbs6hpwucvdcylisu.png" alt="image"><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With the advent of Promise in ECMAScript 6 (ES6), everything is possible! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I applied the approach of separating the design of modal windows and code (alert (), confirm () and prompt ()). </font><font style="vertical-align: inherit;">But you can hide everything in the code. </font><font style="vertical-align: inherit;">What attracts such an approach - the design can be changed in different projects, but simply on different pages or depending on the situation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The bad point about this approach is the need to use markup names (id) in the code of modal windows, and even in the global scope. </font><font style="vertical-align: inherit;">But this is just an example of the principle, so I will not focus on this.</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Getting the code for alert</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, let's parse the markup (bootstrap and Font Awesome for font icons) and the alert code (I'm using jQuery):</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromiseAlert"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-exclamation-triangle text-warning"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>The app reports<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>√ó<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-secondary"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.alert = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromiseAlert .modal-body p'</span>).html(message);
        <span class="hljs-keyword">var</span> PromiseAlert = $(<span class="hljs-string">'#PromiseAlert'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromiseAlert.on(<span class="hljs-string">'hidden.bs.modal'</span>, resolve);<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As I said above, the global name PromiseAlert and the html markup classes are used for the code. In the first line of code, the alert function parameter is passed to the message body. After that, the bootstrap method displays a modal window with certain options (they make it closer to the native alert). Important! The modal window is remembered in a local variable, which is used below through closure. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finally, it is created and returned as the result of alert Promise, in which, as a result of closing the modal window, resolve this Promise is executed. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's see how this alert can be used:</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'p a[href="#"]'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Promise based alert sample'</span>);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, a message is displayed when clicking on empty links within paragraphs. Paying attention! To comply with the specification, the alert function must be preceded by the await keyword, and it can only be used inside the function with the async keyword. This allows you to expect in this place (the script will stop, as in the case with the native alert), the closing of the modal window.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What will happen if this is not done? </font><font style="vertical-align: inherit;">Depends on the logic of your application (an example of such an approach in the figure above). </font><font style="vertical-align: inherit;">If this is the end of the code or further actions of the code do not overload the page, then everything will probably be fine! </font><font style="vertical-align: inherit;">The modal window sags until the user closes it. </font><font style="vertical-align: inherit;">But if there are still modal windows or if the page reloads, there is a transition to another page, then the user simply will not see your modal window and the logic will be destroyed. </font><font style="vertical-align: inherit;">I can say that from experience, messages about various server errors (states) or from code libraries work quite well with our new alert, although they do not use await.</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We develop an approach for confirm</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's go further. </font><font style="vertical-align: inherit;">Without a doubt, confirm can only be used in the async / await binding, as </font><font style="vertical-align: inherit;">he must tell the code the result of the user's choice. </font><font style="vertical-align: inherit;">This also applies to prompt. </font><font style="vertical-align: inherit;">So confirm:</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromiseConfirm"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-check-circle text-success"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Confirm app request<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>√ó<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.confirm = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromiseConfirm .modal-body p'</span>).html(message);
        <span class="hljs-keyword">var</span> PromiseConfirm = $(<span class="hljs-string">'#PromiseConfirm'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);
        <span class="hljs-keyword">let</span> confirm = <span class="hljs-literal">false</span>;<font></font>
        $(<span class="hljs-string">'#PromiseConfirm .btn-success'</span>).on(<span class="hljs-string">'click'</span>, e =&gt; {<font></font>
            confirm = <span class="hljs-literal">true</span>;<font></font>
        });<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromiseConfirm.on(<span class="hljs-string">'hidden.bs.modal'</span>, (e) =&gt; {<font></font>
                resolve(confirm);<font></font>
            });<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is only one difference - we need to inform about the choice of the user. </font><font style="vertical-align: inherit;">This is done using another local variable in the closure - confirm. </font><font style="vertical-align: inherit;">If the confirmation button is pressed, the variable is set to true, and by default its value is false. </font><font style="vertical-align: inherit;">Well, when processing the closing of a modal window, resolve returns this variable. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the usage (required with async / await):</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'p a[href="#"]'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> confirm(<span class="hljs-string">'Want to test the Prompt?'</span>)) {
            <span class="hljs-keyword">let</span> prmpt = <span class="hljs-keyword">await</span> prompt(<span class="hljs-string">'Entered value:'</span>);
            <span class="hljs-keyword">if</span> (prmpt) <span class="hljs-keyword">await</span> alert(<span class="hljs-string">`entered: ¬´<span class="hljs-subst">${prmpt}</span>¬ª`</span>);
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Do not enter a value'</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">await</span> alert(<span class="hljs-string">'Promise based alert sample'</span>);<font></font>
    });<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moving on - an approach for prompt</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The logic above is also implemented with the test prompt. </font><font style="vertical-align: inherit;">And its markup and logic are as follows:</font></font><br>
<pre><code class="xml hljs">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromisePrompt"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-dialog"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"document"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-title"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-question-circle text-primary"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Prompt request<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Close"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">"true"</span>&gt;</span>√ó<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"PromisePromptInput"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PromisePromptInput"</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span> <span class="hljs-attr">data-dismiss</span>=<span class="hljs-string">"modal"</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br>
<pre><code class="javascript hljs">    <span class="hljs-built_in">window</span>.prompt = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#PromisePrompt .modal-body label'</span>).html(message);
        <span class="hljs-keyword">var</span> PromisePrompt = $(<span class="hljs-string">'#PromisePrompt'</span>).modal({
            <span class="hljs-attr">keyboard</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">backdrop</span>: <span class="hljs-string">'static'</span>
        }).modal(<span class="hljs-string">'show'</span>);<font></font>
        $(<span class="hljs-string">'#PromisePromptInput'</span>).focus();
        <span class="hljs-keyword">let</span> prmpt = <span class="hljs-literal">null</span>;<font></font>
        $(<span class="hljs-string">'#PromisePrompt .btn-success'</span>).on(<span class="hljs-string">'click'</span>, e =&gt; {<font></font>
            prmpt = $(<span class="hljs-string">'#PromisePrompt .modal-body input'</span>).val();<font></font>
        });<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{<font></font>
            PromisePrompt.on(<span class="hljs-string">'hidden.bs.modal'</span>, (e) =&gt; {<font></font>
                resolve(prmpt);<font></font>
            });<font></font>
        });<font></font>
    };<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The difference between logic and confirm is minimal. </font><font style="vertical-align: inherit;">An additional local variable in the closure is prmpt. </font><font style="vertical-align: inherit;">And it does not have a logical value, but a string that the user enters. </font><font style="vertical-align: inherit;">Through closure, its value resolves. </font><font style="vertical-align: inherit;">And a value is assigned to it only when the confirmation button is pressed (from the input field). </font><font style="vertical-align: inherit;">By the way, here I squandered another global variable, PromisePromptInput, just for shorthand and alternative code. </font><font style="vertical-align: inherit;">With it, I set the input focus (although it can be done in a single approach - either in the same way or as in getting the value). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can try this approach in action </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The code is located at the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It looks something like this (although the link above is more diverse):</font></font><br>
<img src="https://habrastorage.org/webt/5o/zl/rc/5ozlrc4mvo0cep-tb-lesrsrltk.png" alt="image"><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aids</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They do not relate directly to the topic of the article, but they reveal the full flexibility of the approach. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This includes bootstrap themes. </font><font style="vertical-align: inherit;">I took free themes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Switch language using automatic installation according to browser language. </font><font style="vertical-align: inherit;">There are three modes - automatic (via browser), Russian or English (forced). </font><font style="vertical-align: inherit;">The machine is installed by default. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cookies ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) I used to memorize the theme and language switch. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Themes switch simply by installing the href css segment from the above site:</font></font><br>
<pre><code class="javascript hljs">    $(<span class="hljs-string">'#themes a.dropdown-item'</span>).on(<span class="hljs-string">'click'</span>, (e) =&gt; {<font></font>
        e.preventDefault();<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item'</span>).removeClass(<span class="hljs-string">'active'</span>);<font></font>
        e.currentTarget.classList.add(<span class="hljs-string">'active'</span>);
        <span class="hljs-keyword">var</span> cur = e.currentTarget.getAttribute(<span class="hljs-string">'href'</span>);
        <span class="hljs-built_in">document</span>.head.children[<span class="hljs-number">4</span>].href = <span class="hljs-string">'https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/'</span> + cur + <span class="hljs-string">'bootstrap.min.css'</span>;
        <span class="hljs-keyword">var</span> ed = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<font></font>
        ed.setFullYear(ed.getFullYear() + <span class="hljs-number">1</span>);<font></font>
        setCookie(<span class="hljs-string">'WebApplicationPromiseAlertTheme'</span>, cur, ed);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Well, I remember in Cookies for recovery at boot:</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">var</span> cookie = getCookie(<span class="hljs-string">'WebApplicationPromiseAlertTheme'</span>);
    <span class="hljs-keyword">if</span> (cookie) {<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item'</span>).removeClass(<span class="hljs-string">'active'</span>);<font></font>
        $(<span class="hljs-string">'#themes a.dropdown-item[href="'</span> + cookie + <span class="hljs-string">'"]'</span>).addClass(<span class="hljs-string">'active'</span>);
        <span class="hljs-built_in">document</span>.head.children[<span class="hljs-number">4</span>].href = <span class="hljs-string">'https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/'</span> + cookie + <span class="hljs-string">'bootstrap.min.css'</span>;<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For localization, I used the localization.json file in which I created a dictionary of keys in English and their values ‚Äã‚Äãin Russian. </font><font style="vertical-align: inherit;">For simplicity (although the markup has become more complicated in some places), I only check purely text nodes when translating, replacing a key from a value.</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-keyword">var</span> translate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
        $(<span class="hljs-string">'#cultures .dropdown-toggle samp'</span>).text({ <span class="hljs-attr">ru</span>: <span class="hljs-string">'  '</span>, <span class="hljs-attr">en</span>: <span class="hljs-string">' English '</span> }[culture]);
        <span class="hljs-keyword">if</span> (culture == <span class="hljs-string">'ru'</span>) {
            <span class="hljs-keyword">let</span> int;
            <span class="hljs-keyword">if</span> (localization) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> el <span class="hljs-keyword">of</span> <span class="hljs-built_in">document</span>.all)
                    <span class="hljs-keyword">if</span> (el.childElementCount == <span class="hljs-number">0</span> &amp;&amp; el.textContent) {
                        <span class="hljs-keyword">let</span> text = localization[el.textContent];
                        <span class="hljs-keyword">if</span> (text) el.textContent = text;<font></font>
                    }<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> int = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (localization) {<font></font>
                    translate();<font></font>
                    clearInterval(int);<font></font>
                }<font></font>
            }, <span class="hljs-number">100</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span> location.reload();<font></font>
    };<font></font>
    <span class="hljs-keyword">if</span> (culture == <span class="hljs-string">'ru'</span>) translate();
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
so it‚Äôs hardly good to do in production (better on the server), but here I can demonstrate everything on the client. </font><font style="vertical-align: inherit;">I access the server only when changing from Russian to English - I just overload the original markup (location.reload). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The latter, as expected, the message in onbeforeunload is issued according to the browser algorithm and our confirm does not affect this. </font><font style="vertical-align: inherit;">At the end of the code there is a commented version of such a message - you can try it when you transfer it yourself.</font></font><br>
<pre><code class="javascript hljs">    <span class="hljs-comment">//window.onbeforeunload = function (e) {</span>
    <span class="hljs-comment">//    e.returnValue = 'Do you really want to finish the job?';</span>
    <span class="hljs-comment">//    return e.returnValue;</span>
    <span class="hljs-comment">//};</span>
</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en496360/index.html">BFCache, or There and back. Yandex Report</a></li>
<li><a href="../en496362/index.html">Masks reset</a></li>
<li><a href="../en496366/index.html">Miniseries: do-it-yourself ternary computer</a></li>
<li><a href="../en496368/index.html">Australian startup develops hybrid PC from electronic and biological components</a></li>
<li><a href="../en496370/index.html">Joys and sorrows of victories over C: we make candy from the prototype wc on Haskell</a></li>
<li><a href="../en496376/index.html">Quartet 9: Allegro | Brevity and simplicity</a></li>
<li><a href="../en496380/index.html">Disaster Recovery and migration using VMware vCloud Availability. Part 2</a></li>
<li><a href="../en496384/index.html">Quarantined IT people: personal experience from different countries</a></li>
<li><a href="../en496386/index.html">First steps in Spring, Rest API, focus on PUT in conjunction with the frontend</a></li>
<li><a href="../en496388/index.html">There are no healthy people, there are under-examined: early diagnosis of coronary heart disease</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>