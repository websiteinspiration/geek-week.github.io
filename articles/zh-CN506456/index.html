<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌏 👩🏼‍💼 👌 我们使用SDR接收并分析付款终端的无线电信号 🥊 🌎 ▶️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha 
 
 最近，我有机会对非接触式付款的可能性进行测试。好吧，由于付款是非接触式的，所以信号是通过无线电发送的，当然，我不能放弃用SDR接收器查看付款过程中发送和接收哪种数据的诱惑。
 
 
 照片（c）Verifone
 
 对于那些对它如何工作感兴趣的人，请删减一些细节。
 
 应当立即指...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>我们使用SDR接收并分析付款终端的无线电信号</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506456/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">哈Ha </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近，我有机会对非接触式付款的可能性进行测试。</font><font style="vertical-align: inherit;">好吧，由于付款是非接触式的，所以信号是通过无线电发送的，当然，我不能放弃用SDR接收器查看付款过程中发送和接收哪种数据的诱惑。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/lx/nc/oflxncgb4c_qvhq6ptvxadvfyf8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">照片（c）Verifone</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
对于那些对它如何工作感兴趣的人，请删减一些细节。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
应当立即指出，我没有关于用卡交换终端的协议的任何正式描述，此类数据通常仅在签署保密协议后才分发给合作伙伴公司，但没有人禁止我们收听广播并作任何假设。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，让我们开始吧。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信号频谱</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们从最简单的事情开始-启动接收器，打开终端，付款，然后查看正在播放的内容。</font><font style="vertical-align: inherit;">对信号的搜索原来是基本的，在13.56 MHz的频率上可以看到一个巨大的峰值：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/-h/l7/wo-hl75zr6ratqupuvl9ohw8wsg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
信号电平不足为奇，因为它足以与没有电源的卡进行感应式通信。</font><font style="vertical-align: inherit;">正如Google所建议的，13.56MHz是RFID设备的标准频率。</font><font style="vertical-align: inherit;">信号的对称性表明可能使用AM调制。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既然找到了信号，就可以更详细地查看信号并查看付款的不同阶段：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p8/c-/cp/p8c-cpgkrxw7rq-uhs4jt0ms_hi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更详细地考虑它们。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.空闲模式</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种模式下，终端不辐射任何东西，仅在屏幕上显示银行或商店的徽标。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.付款要求和卡等待</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
收银员启动一定金额的付款。</font><font style="vertical-align: inherit;">此时，终端进入待机支付模式。</font><font style="vertical-align: inherit;">可以使用磁条，插入卡或使用我们感兴趣的非接触式方法来通过卡付款。</font><font style="vertical-align: inherit;">为了确定何时将卡带到终端，每隔0.12s发送一次请求。</font><font style="vertical-align: inherit;">频谱上呈垂直线形式的短包裹以放大形式看起来像这样：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hl/bc/yv/hlbcyvjnx9wrtvr2d1n5bedlvdi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以清楚地看到重复的数据。</font><font style="vertical-align: inherit;">数据块（“通过眼睛”，24或32位）很可能包含一个位掩码，其中包含该读取器支持的卡格式。</font><font style="vertical-align: inherit;">至少对于其他卡（例如运输卡），读卡器不会“回应”。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.用卡交换数据</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当检测到卡时，作为响应，其控制器发送其数据-可能是卡号和服务信息。</font><font style="vertical-align: inherit;">卡本身没有电源，因此它的响应功率很弱。</font><font style="vertical-align: inherit;">如您所见，对于每个终端请求，卡都会发送响应，它们之间的“无线电”非常活跃：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/vq/cs/msvqcsmzk4qkowdclpxauf9melg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从卡接收到的增强信号看起来像这样：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vt/t4/lf/vtt4lfrsq2vh9glkdfwcxcxses8.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.卡验证</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
收到卡数据后，终端可能会检查卡上的加密密钥，此过程大约需要0.6s。</font><font style="vertical-align: inherit;">RFID模块当前处于禁用状态。</font><font style="vertical-align: inherit;">终端可能正在在线请求卡状态。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.待取款卡</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当终端读取所有数据并检查了卡时，屏幕上会显示“取出卡”消息，终端每隔5毫秒检查一次卡是否在位：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/vl/wp/bivlwp5c5uhb-etgpva3gfc0tfg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们看到相同的消息，卡的响应也可见。</font><font style="vertical-align: inherit;">在放大的视图中，您可以显示卡停止响应的时刻：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/rj/bh/jdrjbhqexfxncf0z3k5743rw8zq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一下，卡本身</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">回答非常简单，简短，“用眼睛”，最多不超过24位：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/b_/l_/n_b_l_8-zlnpokvhf98w0cpq5va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此时无线电交换结束，接收到所有数据后，终端将付款请求发送至罐。</font><font style="vertical-align: inherit;">银行做出了回应，如果付款成功，我们将收到我们的货物。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，在二进制级别，一切都非常简单。 RFID协议使用常规的幅度调制，没有火箭科学。但是，当然，主要工作是在逻辑层次上完成的，检查卡并付款是一个相当复杂的过程，其中还涉及加密。对于那些想更详细地研究该主题的人，您可以从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rizorko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lil_Toady</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">那里</font></a><font style="vertical-align: inherit;">找到有用的评论，您可以</font><font style="vertical-align: inherit;">在其中找到标准的链接。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，您可以回答许多人可能感兴趣的问题：是否可以在很远的距离内秘密地从别人的卡中提款。从对无线电信号的分析来看，我们可以说这是不太可能的。首先，该卡本身没有内置电源-为了其处理器工作时，场强应</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大。卡的正常读取距离为2-3厘米，为了将其增加到至少100厘米，场强应大于此差异三级。第二点是接收到卡的响应-它的信号非常弱，并且在很远的距离接收也不容易（此外请不要忘记13 MHz频率的波长约为20米，而这种波长的短天线效率很低）。最后，不要忘记组织方面的问题-每个付款终端都链接到法人实体的银行帐户，如果对借记资金存在投诉，可以简单地阻止该帐户。顺便说一句，终端本身具有唯一的ID，如果将其始终绑定到不同的帐户，这也将是可疑的。一般而言，尽管从理论上讲可以远程读取RFID，由评判</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本文中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，没有实际的此类撤回案例。</font><font style="vertical-align: inherit;">最后，非接触式支付的限额非常小，因此“利润”可能不会与设备的风险和成本相对应。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN506442/index.html">ick</a></li>
<li><a href="../zh-CN506444/index.html">未来的挑战</a></li>
<li><a href="../zh-CN506450/index.html">使用Rutoken技术在系统中注册和授权用户的经验（第1部分）</a></li>
<li><a href="../zh-CN506452/index.html">如何使用ESNI保护您的公共站点</a></li>
<li><a href="../zh-CN506454/index.html">一名bim经理可获得10万的收益以及如何成为一名</a></li>
<li><a href="../zh-CN506460/index.html">男性与女性的大脑差异：女性编码更好？</a></li>
<li><a href="../zh-CN506462/index.html">图钉池和tachers-我如何测试发现的一切</a></li>
<li><a href="../zh-CN506472/index.html">互联网企业家的商业保护：在哪里开设公司和帐户，寻找什么</a></li>
<li><a href="../zh-CN506478/index.html">使用WSL在Windows 10上安装和配置RTKRCV（RTKLIB）</a></li>
<li><a href="../zh-CN506480/index.html">2008年与2020年：危机期间投资者的行为如何变化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>