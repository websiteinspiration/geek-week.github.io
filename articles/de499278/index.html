<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📒 🤷🏽 🍪 Brotli Effizienz in der realen Welt #⃣ ⚒️ 🗄️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine der grundlegendsten Regeln für die Entwicklung schneller Websites ist die Optimierung ihrer Ressourcen. Wenn es sich um Textressourcen handelt - ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Brotli Effizienz in der realen Welt</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/499278/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine der grundlegendsten Regeln für die Entwicklung schneller Websites ist die Optimierung ihrer Ressourcen. Wenn es sich um Textressourcen handelt - um Code, der in HTML, CSS und JavaScript geschrieben wurde, bedeutet dies, dass es sich um Datenkomprimierung handelt. </font><font style="vertical-align: inherit;">
Der De-facto-Standard zum Komprimieren von Textressourcen im Web ist die Gzip-Methode. Das heißt, ungefähr 80% der komprimierten Ressourcen, die beim Herunterladen der Site erhalten werden, werden mit Gzip komprimiert. Um die verbleibenden 20% der Ressourcen zu komprimieren, wird ein viel neuerer Algorithmus verwendet - Brotli.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/f1/0c/go/f10cgoennqxp98xrt8hxus_wkii.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich enthalten diese 100% der komprimierten Ressourcen, die in Browser gelangen, wenn sie Antworten auf Anfragen an Websites erhalten, nicht alle Ressourcen. Es gibt immer noch viele Ressourcen, die komprimiert oder komprimiert werden könnten. Diese Ressourcen bleiben jedoch unkomprimiert. Ausführlichere Metriken zur Komprimierung finden Sie im Abschnitt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://almanac."><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font><font style="vertical-align: inherit;">Web Almanac-Ressource. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die gzip-Komprimierungsmethode ist unglaublich effizient. Alle Arbeiten von Shakespeare im Klartext dauern 5,3 MB. Und nach der Gzip-Komprimierung (Komprimierungsstufe 6) belegen sie nur 1,9 MB. Dies bedeutet, dass sich die Dateigröße, in der diese Daten gespeichert sind, um das 2,8-fache verringert hat. Gleichzeitig gehen bei der Komprimierung keine Daten verloren. Großartig!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Noch besser ist, dass der Grad der Gzip-Komprimierung durch das Vorhandensein doppelter Zeilen in Dateien beeinflusst wird. Je mehr Wiederholungen im Text enthalten sind, desto effizienter ist die Komprimierung. Dies ist sehr gut für das Web, da der in HTML, CSS und JS geschriebene Code eine einheitliche Syntax hat und viele Wiederholungen enthält. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl Gzip eine sehr effiziente Komprimierungsmethode ist, ist es auch ziemlich alt. Es erschien 1992 (was natürlich hilft, seine weit verbreitete Verbreitung zu erklären). Nach 21 Jahren veröffentlichte Google 2013 Brotli, einen neuen Algorithmus, der eine noch höhere Komprimierung verspricht als die Gzip-Methode. Dieselben Werke von Shakespeare mit einer Größe von 5,2 MB werden mit Brotli auf eine Größe von 1,7 MB (mit einer Komprimierungsstufe von 6) komprimiert. Und das bedeutet bereits eine 3,1-fache Reduzierung der Dateigröße. Dies ist sogar besser als die Verwendung von Gzip.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tool verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um den Grad der Datenkomprimierung mit Gzip und Brotli zu bewerten, werden Sie wahrscheinlich feststellen, dass Brotli beim Komprimieren einiger Daten viel effizienter ist als Gzip. </font><font style="vertical-align: inherit;">Beispielsweise sind ReactDOM-Daten bei Komprimierung mit Brotli mit maximaler Komprimierungsstufe (11) um 27% kleiner als bei Verwendung von Gzip mit maximaler Komprimierungsstufe (9). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Vergleich der Brotli-Komprimierung mit der Gzip-Komprimierung bei der Verarbeitung von ReactDOM.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierungsstufe</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Größe (in Bytes)</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierungseffizienz (im Vergleich zu nicht komprimierten Daten)</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Verbesserung gegenüber Gzip</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">43456</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.73</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39898</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,97</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elf%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39416</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,08</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fünfzehn%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38488</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,08</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fünfzehn%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">36323</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.27</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neunzehn%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">36048</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.29</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwanzig%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35804</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.31</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwanzig%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35709</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.32</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35659</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.33</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">33590</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.53</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elf</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">33036</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.59</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, umgeht Brotli auf allen Komprimierungsstufen Gzip. Bei der mit Brotli verfügbaren maximalen Komprimierungsstufe ist es 27% effizienter als Gzip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aufgrund persönlicher Beobachtungen stelle ich fest, dass der Übergang eines meiner Kunden von Gzip zu Brotli zu einer mittleren Reduzierung der Dateigröße um 31% führte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen habe ich in den letzten Jahren zusammen mit anderen Leistungsexperten Kunden ermutigt, von Gzip zu Brotli zu wechseln.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde ein paar Worte zur Browserunterstützung für Gzip und Brotli sagen. Gzip ist so weit verbreitet, dass CanIUse nicht einmal eine Tabelle mit Supportinformationen anzeigt. Es heißt so: "Dieser HTTP-Header wird in fast allen Browsern unterstützt (beginnend mit IE6 +, Firefox 2+, Chrome 1+ usw.)." Und Brotli genießt beim Schreiben dieses Materials eine sehr angenehme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unterstützung.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bei 93,17%. Und das ist sehr, sehr viel! Wenn Ihre Website also mindestens eine signifikante Größe hat, gefällt Ihnen die Rückgabe unkomprimierter Ressourcen an mehr als 6% Ihrer Benutzer möglicherweise nicht besonders gut. Mit Brotli verlieren Sie jedoch nichts. Kunden verwenden ein progressives Unterstützungsmodell für neue Algorithmen, sodass Benutzer, die keine Brotli-Ressourcen akzeptieren können, einfach die Fallback-Option in Form von Gzip verwenden. Wir werden weiter unten mehr darüber sprechen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen, insbesondere wenn Sie CDN verwenden, ist das Einschalten von Brotli eine Frage von Sekunden. </font><font style="vertical-align: inherit;">Zumindest ist dies bei Cloudflare der Fall, dem Dienst, den ich für die CSS Wizardry-Site verwende. </font><font style="vertical-align: inherit;">Viele meiner Kunden sind jedoch nicht so erfolgreich, wenn wir über die letzten Jahre sprechen. </font><font style="vertical-align: inherit;">Einige von ihnen unterstützen ihre eigene Infrastruktur, und die Praxis zeigt, dass die Installation und Bereitstellung von Brotli nicht so einfach ist. </font><font style="vertical-align: inherit;">Einige verwenden CDN-Dienste, die sich in ihren leicht zugänglichen Funktionen nicht unterscheiden, um den neuen Algorithmus zu unterstützen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den Fällen, in denen wir nicht zu Brotli wechseln konnten, hatten wir immer eine unbeantwortete Frage: "Was wäre wenn ...". </font><font style="vertical-align: inherit;">Infolgedessen entschied ich mich schließlich, mich mit Zahlen zu bewaffnen und eine Antwort auf die Frage zu geben, was der Site den Übergang zu Brotli gibt.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weniger ist nicht unbedingt schneller.</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalerweise bedeutet "weniger" jedoch "schneller". </font><font style="vertical-align: inherit;">Wenn Sie die Dateigröße reduzieren, wird diese in der Regel schneller vom Server zum Client übertragen. </font><font style="vertical-align: inherit;">Wenn Sie eine Datei beispielsweise um 20% verkleinern, bedeutet dies nicht, dass sie 20% schneller ankommt. </font><font style="vertical-align: inherit;">Der Punkt hier ist, dass die Dateigröße nur ein Aspekt der Webleistung ist. </font><font style="vertical-align: inherit;">Unabhängig von der Größe der Datei ist die an den Browser gelieferte Ressource mit vielen anderen Faktoren und vielen Systemeinschränkungen verbunden - Netzwerkverzögerungen, Paketverlust und dergleichen. </font><font style="vertical-align: inherit;">Mit anderen Worten, das Einsparen der Dateigröße hilft dabei, dieselben Daten wie zuvor zu übertragen und weniger Pakete zu senden. Die Datenübertragung zwischen dem Server und dem Client wird jedoch durch Netzwerkverzögerungen begrenzt. Infolgedessen ändert sich die Geschwindigkeit, mit der Pakete am Client ankommen, nicht.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP, Pakete, Roundtrip-Verzögerung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es sehr einfach ist, Dateien vom Server auf den Client zu übertragen, müssen wir uns das TCP-Protokoll ansehen. Wenn wir eine Datei vom Server erhalten, kommt sie nicht auf einmal zu uns. Das TCP-Protokoll, auf dem HTTP funktioniert, unterteilt die Dateien in Segmente, die als Pakete bezeichnet werden. Diese Pakete werden der Reihe nach nacheinander an den Client gesendet. Der Client bestätigt den Empfang jedes Pakets in der Serie, bevor er mit der Übertragung der nächsten Serie beginnt. Dies geschieht so lange, bis der Client alle erforderlichen Pakete sammelt, bis keine nicht gesendeten Pakete auf dem Server vorhanden sind und bis der Client die Pakete in einer Datei sammeln kann, die als Datei erkannt werden kann. Damit die Paketsequenzübertragungssitzung erfolgreich abgeschlossen werden kann, muss der Server sie an den Client senden und der Client muss ihren Empfang bestätigen. Zeit,Die Datenmenge, die zum Empfangen von Daten und zum Empfangen einer Empfangsbestätigung erforderlich ist, wird als Round Trip Time (RTT) bezeichnet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jede neue TCP-Verbindung kann nicht wissen, wie hoch die verfügbare Bandbreite ist und wie zuverlässig die Verbindung ist (dh wie hoch der Paketverlust ist). Wenn der Server versucht, Megabyte Daten über eine Verbindung zu senden, die eine Datenübertragungsrate von einem Megabit pro Sekunde unterstützt, überfordert eine solche Übertragung die Verbindung und führt zu einer Überlastung des Kommunikationskanals. Und umgekehrt: Wenn der Server versucht, eine kleine Datenmenge über eine sehr schnelle Verbindung zu übertragen, wird die Verbindung ineffizient verwendet und ist inaktiv.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Rätsel zu lösen, verwendet TCP einen Mechanismus, der als langsamer Start bezeichnet wird. </font><font style="vertical-align: inherit;">Dies ist Teil der Überlastungsfenster-Verwaltungsstrategie. </font><font style="vertical-align: inherit;">Jede neue TCP-Verbindung ist durch die Fähigkeit begrenzt, nur 10 Datenpakete in der ersten Paketsequenz zu senden (10 Pakete - die Größe des anfänglichen Überlastungsfensters). </font><font style="vertical-align: inherit;">Zehn TCP-Segmente enthalten ungefähr 14 KB Daten. </font><font style="vertical-align: inherit;">Wenn diese Pakete erfolgreich vom Client empfangen werden, enthält die zweite Serie bereits 20 Pakete, dann 40, 80, 160 usw. </font><font style="vertical-align: inherit;">Das exponentielle Wachstum von Paketen in Sequenzen wird fortgesetzt, bis eines der folgenden Ereignisse eintritt:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das System wird Paketverlust erleiden. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt reduziert der Server die Anzahl der Pakete in der folgenden Reihenfolge, dividiert die vorherige Anzahl der Pakete durch 2 und versucht erneut, die Daten zu übertragen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die Grenze der verfügbaren Bandbreite erreicht und können sie mit voller Kapazität nutzen.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese einfache und elegante Strategie ermöglicht es Ihnen, am Rande von Vorsicht und Optimismus zu balancieren. </font><font style="vertical-align: inherit;">Dies gilt für jede neue TCP-Verbindung, die von der Webanwendung hergestellt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit einfachen Worten, die anfängliche Größe des Überlastungsfensters der neuen TCP-Verbindung beträgt nur etwa 14 KB. </font><font style="vertical-align: inherit;">Oder ungefähr 11,8% der unkomprimierten ReactDOM-Daten. </font><font style="vertical-align: inherit;">Entweder 36,94% der mit Gzip komprimierten Daten oder 42,38% der mit Brotli komprimierten Daten (bei maximaler Komprimierungsstufe). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann werden wir langsamer. </font><font style="vertical-align: inherit;">Der Übergang von 11,8% auf 36,94% ist bereits eine spürbare Verbesserung! </font><font style="vertical-align: inherit;">Aber der Übergang von 36,94% auf 42,38% - das ist alles andere als beeindruckend. </font><font style="vertical-align: inherit;">Was ist los?</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datensitzungsnummer</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die in einer Sitzung übertragene Datenmenge, Kb</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kumulierte Datenmenge, Kb</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Reihenfolge, in der die ReactDOM-Daten übertragen werden</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gzip (37,904 Kb), Brotli (33,036 Kb)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">56</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">98</font></font></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">112</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">210</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unkomprimierte Option (118,656 Kb)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">224</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">434</font></font></td>
<td></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass sowohl mit Gzip komprimierte als auch mit Brotli komprimierte Daten in derselben Paketserie übertragen werden. </font><font style="vertical-align: inherit;">Das Übertragen einer Datei dauert zwei Sequenzen. </font><font style="vertical-align: inherit;">Wenn sich herausstellt, dass die RTT bei der Übertragung aller Sequenzen ziemlich einheitlich ist, bedeutet dies, dass die Übertragung von mit Gzip und Brotli komprimierten Daten dieselbe Zeit in Anspruch nimmt. </font><font style="vertical-align: inherit;">Andererseits erfordert das Übertragen einer unkomprimierten Datenversion vier Paketreihen, nicht zwei. </font><font style="vertical-align: inherit;">Dies kann insbesondere bei Verbindungen mit hohen Netzwerklatenzen zu einer spürbaren Zeit führen, die für die Datenübertragung erforderlich ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich tendiere hier dazu, dass die Geschwindigkeit der Datenübertragung nicht nur von der Dateigröße abhängt. Es wird von den Funktionsmerkmalen des TCP-Protokolls beeinflusst. Wir müssen die Dateien nicht nur verkleinern. Wir müssen sie viel kleiner machen und auf eine Größe bringen, die es ihnen ermöglicht, in weniger Paketsequenzen übertragen zu werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies bedeutet theoretisch, dass der Brotli-Algorithmus Daten wesentlich aggressiver komprimieren kann, damit er spürbar effizienter als Gzip ist. Dies ist notwendig, damit Daten in weniger Paketsequenzen übertragen werden können als bei Verwendung von Gzip. Und ich weiß nicht, wie sich dieser Algorithmus entwickeln wird ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist erwähnenswert, dass das obige Modell ziemlich vereinfacht ist. Es gibt viele andere Faktoren zu berücksichtigen. Zum Beispiel - ist es eine neue oder bereits offene TCP-Verbindung? Wird die Verbindung für etwas anderes verwendet? Stoppen und starten Priorisierungsmechanismen für den Serververkehr die Datenübertragung? Haben H / 2-Streams exklusiven Zugriff auf die Bandbreite? Dieser Abschnitt ist eine ernstere Studie. Es sollte als guter Ausgangspunkt für Ihre eigene Forschung angesehen werden. Aber überlegen Sie sich, die Daten gründlich mit etwas wie Wireshark zu analysieren, und lesen Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieses</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Material, das eine tiefere Beschreibung der „Magie“ der ersten 14 KB enthält.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies gilt nur für brandneue TCP-Verbindungen. </font><font style="vertical-align: inherit;">Dateien, die über eine vorhandene Verbindung übertragen werden, werden nicht langsam gestartet. </font><font style="vertical-align: inherit;">Dies führt uns zu zwei wichtigen Schlussfolgerungen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich denke nicht, dass es sich lohnt, es zu wiederholen, aber ich werde es wiederholen: statische Ressourcen müssen gehostet werden. </font><font style="vertical-align: inherit;">Dies ist eine großartige Möglichkeit, Verzögerungen beim langsamen Start zu vermeiden, da die Verwendung Ihres eigenen, bereits „aufgewärmten“ Servers bedeutet, dass Pakete, die diesen Server verlassen, Zugriff auf eine größere Bandbreite haben. </font><font style="vertical-align: inherit;">Diese Schlussfolgerung führt mich zur zweiten Schlussfolgerung.</font></font></li>
<li> ,              ,    .       ,            .    .</li>
</ol><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong>   </strong></td>
<td><strong> ,    , </strong></td>
<td><strong>   , </strong></td>
</tr>
<tr>
<td>1</td>
<td>14</td>
<td>14</td>
</tr>
<tr>
<td>2</td>
<td>28</td>
<td>42</td>
</tr>
<tr>
<td>3</td>
<td>56</td>
<td>98</td>
</tr>
<tr>
<td>4</td>
<td>112</td>
<td>210</td>
</tr>
<tr>
<td>5</td>
<td>224</td>
<td>434</td>
</tr>
<tr>
<td>6</td>
<td>448</td>
<td>882</td>
</tr>
<tr>
<td>7</td>
<td>896</td>
<td>1778</td>
</tr>
<tr>
<td>8</td>
<td>1792</td>
<td>3570</td>
</tr>
<tr>
<td>9</td>
<td>3584</td>
<td>7154</td>
</tr>
<tr>
<td>10</td>
<td>7168</td>
<td>14322</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>20</td>
<td>7340032</td>
<td>14680050</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende der 10. Datenübertragungssitzung beträgt die in einer Sitzung übertragene Datenmenge 7168 KB, während insgesamt bereits 14322 KB Daten übertragen wurden. </font><font style="vertical-align: inherit;">Dies ist mehr als genug für normale Arbeiten im Internet (dh nicht zum Anzeigen des Game of Thrones). </font><font style="vertical-align: inherit;">Tatsächlich kommt es normalerweise vor, dass wir die gesamte Webseite und alle ihre Ressourcen laden, ohne die Grenze unserer Bandbreite zu erreichen. </font><font style="vertical-align: inherit;">Mit anderen Worten, die Verwendung eines Glasfaserkommunikationskanals mit 1 Gbit / s (dh 0,125 GB / s) lässt das normale Surfen nicht viel schneller erscheinen als die Verwendung einer langsameren Verbindung, da der größte Teil dieses Kanals nicht gleichmäßig ist wird verwendet.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und bis zur 20. Datenübertragungssitzung übertragen wir theoretisch 7,34 GB Daten in einer Paketsequenz.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist mit der realen Welt?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher haben wir uns mit theoretischen Überlegungen befasst. </font><font style="vertical-align: inherit;">Und ich habe angefangen, an diesem Material zu arbeiten, weil ich gerne wissen möchte, welche Auswirkungen Brotli auf reale Websites haben kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher haben die hier angegebenen Zahlen auf den großen Unterschied zwischen dem Mangel an Komprimierung und der Verwendung von Gzip und der Tatsache hingewiesen, dass der Gewinn durch die Verwendung von Brotli im Vergleich zu Gzip recht gering ist. </font><font style="vertical-align: inherit;">Dies zeigt uns, dass der Übergang von der fehlenden Komprimierung zur Verwendung von Gzip eine spürbare Verbesserung bringt, während der Übergang von Gzip zu Brotli wahrscheinlich weniger beeindruckend aussieht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe als Beispiele mehrere Websites ausgewählt, die sich an folgenden Überlegungen orientieren:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Site sollte relativ bekannt sein (es ist besser, Sites zu verwenden, die mit etwas verglichen werden können).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Stelle sollte für den Test geeignet sein. </font><font style="vertical-align: inherit;">Das heißt - es sollte eine geeignete Größe haben (daher ist es interessanter, seine Materialien auf Komprimierung zu analysieren) und gleichzeitig nicht hauptsächlich Materialien enthalten, die nicht mit Gzip / Brotli komprimiert wurden - wie zum Beispiel YouTube.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht alle Websites aus der Sammlung sollten großen Unternehmen gehören (es lohnt sich, einige, beispielsweise „normale“ Websites, zu analysieren).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angesichts dieser Anforderungen habe ich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unten aufgeführten Websites </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ausgewählt</font></a><font style="vertical-align: inherit;"> und mit dem Testen begonnen. </font><font style="vertical-align: inherit;">Hier sind die Websites, die ich ausgewählt habe:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m.facebook.com</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.linkedin.com</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.insider.com</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yandex.com</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.esedirect.co.uk</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.story.one</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.cdm-bedrijfskleding.nl</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.everlane.com</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wollte die Tests nicht komplizieren und habe mich daher auf folgende Indikatoren festgelegt:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Menge der übertragenen Daten.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erste FCP-Zeit (Contentful Paint).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie wurden in folgenden Situationen analysiert:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlende Komprimierung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit gzip.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit brotli.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die FCP-Metrik kommt der realen Welt nahe und ist universell genug für ihre Anwendung auf jede Site, da Sie damit bewerten können, was Benutzer von Websites benötigen - dh den Inhalt dieser Sites. </font><font style="vertical-align: inherit;">Darüber hinaus habe ich mich für diese Metrik entschieden, weil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paul Calvano</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ein intelligenter Mensch, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Folgendes</font></a><font style="vertical-align: inherit;"> sagte: „Die Erfahrung zeigt, dass die Verwendung von Brotli zu einem verbesserten FCP führt, insbesondere wenn kritische CSS / JS-Ressourcen groß sind.“ .</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testen</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde dir ein schmutziges Geheimnis verraten. Viele Studien zur Webleistung (nicht alle, aber viele) basieren nicht auf Untersuchungen zu Leistungsverbesserungen, sondern auf Schlussfolgerungen aus dem Gegenteil - aus Leistungseinbußen. Zum Beispiel ist es für die BBC viel einfacher zu behaupten, dass "sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10% der Benutzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für jede zusätzliche Sekunde </font><font style="vertical-align: inherit;">verlieren, die </font><font style="vertical-align: inherit;">sie zum Laden ihrer Website benötigen", als herauszufinden, was dank einer Verbesserung von einer Sekunde passiert. Es ist viel einfacher, die Website zu verlangsamen, als sie zu beschleunigen, und Sie haben das Gefühl, dass dies der Grund ist, warum viele Leute diesen Job so gut machen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor diesem Hintergrund habe ich nicht versucht, zuerst Websites herunterzuladen, die Gzip verwenden, und dann offline ihren Inhalt mithilfe von Brotli irgendwie zu komprimieren. </font><font style="vertical-align: inherit;">Stattdessen habe ich Websites gefunden, die Brotli verwenden, und dann die Komprimierung deaktiviert. </font><font style="vertical-align: inherit;">Ich ging von Brotli zu Gzip und dann von Gzip zu Non-Compression, um zu messen, wie dies auf der Site funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl ich beispielsweise keine Verbindung zum Linkedin-Server herstellen und Brotli nicht trennen kann, kann ich einfach über einen Browser auf diese Site zugreifen, der Brotli nicht unterstützt. </font><font style="vertical-align: inherit;">Obwohl ich die Brotli-Unterstützung in Chrome nicht deaktivieren kann, kann ich die Tatsache, dass mein Browser Brotli unterstützt, vor dem Server verbergen. </font><font style="vertical-align: inherit;">Browser teilen den Servern mithilfe des Anforderungsheaders mit, welche Komprimierungsalgorithmen sie unterstützen</font></font><code>content-encoding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mit Webpagetest kann ich die Header selbst anpassen. </font><font style="vertical-align: inherit;">Also ist alles sehr einfach!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3bb/295/390/3bb2953909f7cea0ac8970049f763638.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit den erweiterten Funktionen von WebPageTest können wir benutzerdefinierte Anforderungsheader festlegen.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So</font><i><font color="#999999"><font style="vertical-align: inherit;"> richte</font></font></i><font style="vertical-align: inherit;"> ich das Feld Benutzerdefinierte Header ein:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vollständiges Herunterfahren der Komprimierung : </font></font><code>accept-encoding: randomstring</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deaktivieren von Brotli, aber Gzip-Unterstützung : </font></font><code>accept-encoding: gzip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So verwenden Sie Brotli, wenn diese Komprimierungsmethode von der Site unterstützt wird (und sofern sie vom Browser unterstützt wird): Das Feld bleibt leer.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können herausfinden, ob dies wie beabsichtigt funktioniert, indem Sie das Vorhandensein (oder Fehlen) des Headers </font></font><code>content-encoding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der Serverantwort </font><font style="vertical-align: inherit;">überprüfen </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie erwartet bedeutete der Übergang von mangelnder Komprimierung zu Gzip eine signifikante Verbesserung, aber der Übergang von Gzip zu Brotli sieht nicht so beeindruckend aus. </font><font style="vertical-align: inherit;">Die Rohdaten aus meinen Experimenten finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die folgenden Ergebnisse interessieren mich am meisten:</font></font><br>
<br>
<ul>
<li>     Gzip     : 73%.</li>
<li>  FCP   Gzip     : 23.305%.</li>
<li>     Brotli    Gzip: 5.767%.</li>
<li>  FCP   Brotli    Gzip: 3.462%.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies sind alles Medianwerte. </font><font style="vertical-align: inherit;">Apropos "Materialgrößen", ich meine nur HTML, CSS und JavaScript. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dank der Verwendung von Gzip konnten die Dateigrößen im Vergleich zu unkomprimierten Versionen um 73% reduziert werden. </font><font style="vertical-align: inherit;">Durch die Verwendung von Brotli konnte die Dateigröße nur um weitere 5,7% reduziert werden. </font><font style="vertical-align: inherit;">Wenn wir über FCP sprechen, verbesserte sich dieser Indikator dank Gzip um 23% im Vergleich zur fehlenden Komprimierung, und Brotli fügte nur weitere 3,5% hinzu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl solche Ergebnisse die Theorie zu bestätigen scheinen, gibt es verschiedene Möglichkeiten, diese Ergebnisse zu verbessern. </font><font style="vertical-align: inherit;">Das erste ist, eine viel größere Anzahl von Websites zu testen. Ich möchte zwei weitere detaillierter diskutieren.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigene Ressourcendaten und Daten aus externen Quellen</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In meinen Tests habe ich Brotli überall ausgeschaltet, nicht nur für Server, auf denen Standortdaten gespeichert sind. </font><font style="vertical-align: inherit;">Dies bedeutet, dass ich nicht nur die Vorteile gemessen habe, die Websites durch die Verwendung von Brotli erhalten, sondern auch die Vorteile, die Brotli aus den externen Quellen dieser Websites zieht. </font><font style="vertical-align: inherit;">Dies fällt nur dann in den Bereich unserer Interessen, wenn Ressourcen von Drittanbietern auf kritische Weise für die untersuchten Websites verwendet werden. Dies ist jedoch erwähnenswert.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierungsstufen</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apropos Komprimierung: Wir diskutieren häufig die Ergebnisse, die mit dem besten Komprimierungsanwendungsszenario erzielt wurden. Nämlich - wenn wir Gzip verwenden, denken wir an die 9. Komprimierungsstufe und wenn wir Brotli verwenden - an die 11. Stufe. Es ist jedoch unwahrscheinlich, dass der untersuchte Server optimal konfiguriert wird. Zum Beispiel verwendet Apache die gzip-Komprimierung der Stufe 6, während NGINX nur die erste verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Deaktivieren von Brotli bedeutet, dass wir zur Fallback-Option, zu Gzip, wechseln. Angesichts der Art und Weise, wie ich die Websites getestet habe, konnte ich eine solche Fallback-Konfiguration nicht ändern oder irgendwie darauf reagieren. Ich sage das, weil die Materialien der beiden Stellen im Test tatsächlich größer wurden, als Brotli eingeschaltet wurde. Dies zeigt mir, dass der Grad der Gzip-Komprimierung so war, dass er eine stärkere Komprimierung lieferte als der Grad der Brotli-Komprimierung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Auswahl einer Komprimierungsstufe ist ein Kompromiss. </font><font style="vertical-align: inherit;">Jeder möchte nach der höchsten Komprimierungsstufe fragen und diesbezüglich das Problem als gelöst betrachten. </font><font style="vertical-align: inherit;">Ein solcher Ansatz ist jedoch unpraktisch. </font><font style="vertical-align: inherit;">Tatsache ist, dass die zusätzliche Zeit, die der Server benötigt, um diese Komprimierung dynamisch durchzuführen, sehr wahrscheinlich die Vorteile einer höheren Komprimierungsstufe zunichte macht. </font><font style="vertical-align: inherit;">Um dieses Problem zu lösen, können Sie auf Folgendes zurückgreifen:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können eine pragmatische Komprimierungsstufe verwenden, die das richtige Gleichgewicht zwischen Geschwindigkeit und Effizienz bei der dynamischen Datenkomprimierung bietet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können vorkomprimierte statische Ressourcen auf den Server hochladen, deren Komprimierungsstufe höher ist als die für die dynamische Komprimierung verwendete. </font><font style="vertical-align: inherit;">In diesem Fall können Sie zur Auswahl der Stufe der dynamischen Komprimierung die im ersten Absatz beschriebene Idee verwenden.</font></font></li>
</ol><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Man hat den Eindruck, dass man vernünftigerweise die Bedeutungslosigkeit von Brotlis Vorteilen gegenüber Gzip erkennen kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Aktivieren der Brotli-Unterstützung nur einige Mausbewegungen im Bedienfeld Ihres CDN erfordert, sollten Sie Brotli nehmen und sofort einschalten. Die Unterstützung für diesen Komprimierungsalgorithmus ist breit genug, Browser, die Brotli nicht unterstützen, wechseln problemlos zu Ersatzmechanismen, und selbst eine geringfügige Verbesserung ist besser als nichts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie nach Möglichkeit statische Ressourcen, die mit der maximalen Komprimierungsstufe vorkomprimiert wurden, auf die Server hoch. Verwenden Sie für die dynamische Komprimierung nicht die höchste, sondern nicht die niedrigste Komprimierungsstufe. Wenn Sie NGINX verwenden, stellen Sie sicher, dass Sie nicht die standardmäßige erste Komprimierungsstufe für NGINX verwenden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie jedoch für die Verwendung von Brotli möglicherweise wochenlanges Entwickeln, Testen und Bereitstellen benötigen, geraten Sie nicht in Panik. Stellen Sie nur sicher, dass Sie die Gzip-Komprimierung für alles verwenden, was komprimiert werden kann (dazu gehören neben Textressourcen auch Dateien .ico und .ttf - wenn sie natürlich in Ihrem Projekt verwendet werden). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich nehme an, eine kurze Version dieses Artikels könnte folgendermaßen aussehen: Wenn Sie Brotli nicht aktivieren sollten oder können, verlieren Sie nicht so viel. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planen Sie Brotli zu verwenden?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499252/index.html">Erstellen eines pseudo-dreidimensionalen Rennspiels</a></li>
<li><a href="../de499254/index.html">Das Mitglied des PyConRu 2020-Programmkomitees beantwortet Fragen zu Python: ein aktuelles Aussehen und ein bisschen Parseltang</a></li>
<li><a href="../de499262/index.html">Letzter Online-Hackathon für selbstständige SMZhack: Projekte, die die Menschen treffen werden</a></li>
<li><a href="../de499268/index.html">Raumbewusstsein: Was kann eine Hololens-Brille?</a></li>
<li><a href="../de499274/index.html">Wir haben die neue Kapsel zerlegt. Wir wissen, wie viele Mikrofone und wie es funktioniert</a></li>
<li><a href="../de499280/index.html">Der Preis für JavaScript-Frameworks</a></li>
<li><a href="../de499286/index.html">Studie: Der Handel mit Unternehmensnetzwerken nimmt auf dem Schwarzmarkt zu</a></li>
<li><a href="../de499288/index.html">Alle Maßnahmen zur Unterstützung des Geschäfts im Zusammenhang mit dem Coronavirus. Teil 1</a></li>
<li><a href="../de499290/index.html">Wie schreibe ich einen technischen Standard für Informationssicherheit für ein großes Unternehmen?</a></li>
<li><a href="../de499296/index.html">Englisch für Demo (Struktur, Sätze, Fragen und Antworten, Grammatik, Tipps)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>