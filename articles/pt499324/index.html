<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõë üòà üë©üèø‚Äçüé® Instale e configure o SDK para criar a extens√£o do LibreOffice üëèüèº üçí üåí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introdu√ß√£o
 Durante o processo de desenvolvimento de nosso produto DSS, foi necess√°rio criar uma extens√£o para o LibreOffice em C ++. A escolha do idi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Instale e configure o SDK para criar a extens√£o do LibreOffice</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/crosstech/blog/499324/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdu√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante o processo de desenvolvimento de nosso produto DSS, foi necess√°rio criar uma extens√£o para o LibreOffice em C ++. </font><font style="vertical-align: inherit;">A escolha do idioma ocorreu devido √† presen√ßa de projetos existentes em C ++, mas eu n√£o queria criar um "zool√≥gico" nos projetos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßamos a estudar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">materiais</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre esta quest√£o, artigos, inclusive sobre este </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recurso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Parece que existem muitos dados, mas, na verdade, as informa√ß√µes eram muito escassas ou n√£o eram mais relevantes devido a vers√µes desatualizadas do LO. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu tive que estudar a quest√£o por conta pr√≥pria.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/et/dn/fnetdnyb4rkf2ivr4eq0y2z-kla.png" alt="imagem"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Montagem do SDK</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para criar no Windows, voc√™ precisar√°</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice 6.2.4 / 6.2.5 + LibreOffice SDK 6.2.4 / 6.2.5 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou superior.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O GNU Zip torna o CoreUtils Sed ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNU</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jdk ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft VS com compilador instalado para C ++ + MSTools e Microsoft.NET</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passos principais</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o LibreOffice e o LibreOffice SDK, de prefer√™ncia no diret√≥rio "Sem espa√ßos". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemplo C: \ App \ Libreoffice6.2.4.2x64 e C: \ App \ Libreoffice6.2.4.2x64 \ sdk, respectivamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abrimos o console, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
acessamos </font><font style="vertical-align: inherit;">o diret√≥rio que cont√©m o SDK baixado: </font><font style="vertical-align: inherit;">cd C: \ App \ Libreoffice6.2.4.2x64 \ sdk </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Execute setsdkenv_windows.bat </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse script gera um arquivo em lotes para o usu√°rio no sistema pela primeira vez, solicitando que voc√™ registre os caminhos para:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LibreOffice</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDK do LibreOffice;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilit√°rios GNU para criar pacotes, compiladores C ++, C # e VB.NET e o diret√≥rio Java SDK.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Especifique as pastas apropriadas.</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Importante</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! Voc√™ deve especificar todos os caminhos para as vers√µes das profundidades de bits correspondentes. "A implanta√ß√£o autom√°tica de componentes UNO (SIM / N√ÉO)" instalar√° o pacote imediatamente ap√≥s a montagem, eu escolhi N√ÉO. Tamb√©m √© necess√°rio seguir o caminho para o arquivo em lotes, por exemplo C: \ Users \ yurev.admin \ AppData \ Roaming \ libreoffice6.2_sdk e ajustar o caminho para VCVARS32 usando al√ßas, eu fiz isso por meio de uma nova vari√°vel.</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">set</span> OO_SDK_CPP_HOME=C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Tools\MSVC\14.20.27508\bin\HostX64\x64
<span class="hljs-built_in">set</span> OO_SDK_VCVARS_HOME=C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build
<span class="hljs-keyword">if</span> defined OO_SDK_VCVARS_HOME call <span class="hljs-string">"%OO_SDK_VCVARS_HOME%\VCVARS64.bat"</span> </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ precisa escolher um caminho para sua profundidade de bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s definir com √™xito as vari√°veis ‚Äã‚Äãde ambiente, receberemos a seguinte mensagem: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fq/se/yq/fqseyqla8wjsipeqmk4kgcbjsqg.jpeg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o deve haver nenhum coment√°rio - isso afetar√° a montagem posteriormente. </font><font style="vertical-align: inherit;">A linha de comando entra no Shell preparada para o modo SDK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m vamos ao diret√≥rio com os pacotes GNU (C: \ Arquivos de Programas (x86) \ GnuWin32 \ bin) e renomeamos o vinculador link.exe para que ele n√£o se confunda com o vinculador Microsoft no futuro, se necess√°rio, sempre podemos cham√°-lo com um novo nome.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compila√ß√£o do SDK</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥ximo passo √© compilar os cabe√ßalhos ou as classes (para Java). </font><font style="vertical-align: inherit;">Por si s√≥, o SDK √© uma cole√ß√£o de componentes com a extens√£o .idl, montados em blocos .udl, que, por sua vez, s√£o montados em um registro com a extens√£o .rdb. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dessa forma, √© claro, √© imposs√≠vel us√°-lo, mas o objetivo dessa abordagem √© a capacidade de escrever seus pr√≥prios componentes, que s√£o adicionados √† √°rvore geral. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pegue o projeto no exemplo do LibreOffice. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V√° para o diret√≥rio C: \ App \ Libreoffice6.2.4.2x64 \ sdk \ examples \ cpp \ complextoolbarcontrols e execute make. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se os dados na primeira etapa forem inseridos corretamente e as vari√°veis ‚Äã‚Äãde ambiente forem definidas corretamente, veremos</font></font><br>
<br>
<pre><code class="bash hljs">C:\App\Libreoffice6.2.4.2x64\sdk\examples\cpp\complextoolbarcontrols&gt;make<font></font>
mkdir c:\libreoffice6.2_sdk\WINexample.out\slo\complextoolbarcontrols<font></font>
   c:\libreoffice6.2_sdk\WINexample.out\slo\complextoolbarcontrols  .<font></font>
make: [c:/libreoffice6.2_sdk/WINexample.out/slo/complextoolbarcontrols/MyProtocolHandler.obj]  1 ()<font></font>
cl -c -MD -Zm500 -Zc:wchar_t- -wd4251 -wd4275 -wd4290 -wd4675 -wd4786 -wd4800 -GR -EHa -I. -Ic:/libreoffice6.2_sdk/WINexample.out/inc-Ic:/libreoffice6.2_sdk/WINexample.out/inc/examples -I../../../include -Ic:/libreoffice6.2_sdk/WINexample.out/inc/complextoolbarcontrols -DWIN32 -DWNT -D_DLL -DCPPU_ENV=mscx -Foc:\libreoffice6.2_sdk\WINexample.out\slo\complextoolbarcontrols\MyProtocolHandler.obj MyProtocolHandler.cxx<font></font>
  Microsoft (R) C/C++  19.21.27702.2  x64<font></font>
(C)   (Microsoft Corporation).   .</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 e a montagem ir√°, como resultado da montagem, obtemos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivos baixados no diret√≥rio C: \ libreoffice6.2_sdk \ WINexample.out \ inc, </font></font></li>
<li> manifest.xml  C:\libreoffice6.2_sdk\WINexample.out\misc\complextoolbarcontrols\complextoolbarcontrols\META-INF,</li>
<li>complextoolbarcontrols.uno.dll  C:\libreoffice6.2_sdk\WINexample.out\misc\complextoolbarcontrols\Windows, </li>
<li> ,   description.xml  C:\libreoffice6.2_sdk\WINexample.out\misc\complextoolbarcontrols,</li>
<li>  C:\libreoffice6.2_sdk\WINexample.out\slo\complextoolbarcontrols </li>
<li>    complextoolbarcontrols.oxt  C:\libreoffice6.2_sdk\WINexample.out\bin.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em ess√™ncia, o Makefile faz tudo por n√≥s no qual inserimos corretamente as vari√°veis ‚Äã‚Äãde ambiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Cppmaker, com base nos arquivos de registro offapi.rdb e types.rdb, baixa as depend√™ncias necess√°rias para criar arquivos cxx. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O compilador coleta esses arquivos em objetos, vinculando-os a partir do diret√≥rio LibreOffice, coleta a DLL de sa√≠da e, em seguida, os arquivos manifest.xml description.xml .components s√£o gerados e tudo isso √© empacotado usando zip no arquivo .oxt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A vers√£o com cigwin ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) teve que ser abandonada devido √† impossibilidade de constru√ß√£o devido a um console suspenso.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para criar no Linux, voc√™ precisar√° de:</font></font></h3><br>
<pre><code class="bash hljs">ibcurl4-openssl-dev zip git build-essential wget curl gstreamer1.0-libav libkrb5-dev nasm graphviz ccache libpython3-dev libreoffice-dev*</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esses pacotes n√£o ocupam muito espa√ßo; portanto, usamos a imagem do Docker para criar a extens√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O processo de prepara√ß√£o √© quase semelhante ao Windows. </font><font style="vertical-align: inherit;">Em vez de setsdkenv_windows.bat, execute setsdkenv_unix em / usr / lib / libreoffice / sdk. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, por analogia com o Windows, v√° para / usr / lib / libreoffice / sdk / examples / cpp / complextoolbarcontrols e execute make. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, ap√≥s a conclus√£o da montagem, obteremos a extens√£o final que se encontra no diret√≥rio especificado durante a configura√ß√£o por meio de setsdkenv_unix.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Links que nos ajudaram</font></font></h4><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">niocs.github.io/LOBook/extensions/part5.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - um bom tutorial sobre como criar extens√µes;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forum.openoffice.org/en/forum/viewtopic.php?f=44&amp;t=71155</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - um f√≥rum com dicas sensatas;</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt499312/index.html">Powerhell para iniciantes</a></li>
<li><a href="../pt499314/index.html">Computador DIY na mesa</a></li>
<li><a href="../pt499316/index.html">Microsservi√ßos eficientes e confi√°veis</a></li>
<li><a href="../pt499320/index.html">Qual √© a geometria do universo?</a></li>
<li><a href="../pt499322/index.html">Distribui√ß√µes Windows Server ou Linux? Escolhendo um SO do servidor</a></li>
<li><a href="../pt499326/index.html">Doce amargura do produto: em que m√©tricas trabalhar?</a></li>
<li><a href="../pt499328/index.html">Cylance vs Sality</a></li>
<li><a href="../pt499330/index.html">Movendo-se on-line: a experi√™ncia do planejamento estrat√©gico on-line</a></li>
<li><a href="../pt499334/index.html">Qual √© o resultado do email marketing: como fazer uma previs√£o</a></li>
<li><a href="../pt499338/index.html">Todas as entrevistas e contrata√ß√µes de funcion√°rios agora s√£o exclu√≠das.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>