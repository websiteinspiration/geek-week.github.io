<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöâ üë©üèº‚Äçüè´ üóø AWS Lambda in Aktion. Teil 2: Kennenlernen von Entwicklungs- und Testwerkzeugen üçπ üíæ üö£üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Leitfaden ist das Ergebnis pers√∂nlicher Erfahrungen beim Entwickeln und Testen von Anwendungen ohne Server sowie beim Man√∂vrieren zwischen Kr√ºc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>AWS Lambda in Aktion. Teil 2: Kennenlernen von Entwicklungs- und Testwerkzeugen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/496756/"><img src="https://habrastorage.org/webt/7w/hp/bb/7whpbbwttpekzxdq4-7sgs28rio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Leitfaden ist das Ergebnis pers√∂nlicher Erfahrungen beim Entwickeln und Testen von Anwendungen ohne Server sowie beim Man√∂vrieren zwischen Kr√ºcken und Fahrr√§dern beim Versuch, diese zu testen. Als ich anfing, Serverless-Anwendungen zu entwickeln, musste ich alles mit meinen H√§nden herausfinden. Es gab keine klaren Anleitungen oder praktischen Tools f√ºr die lokale Entwicklung und das Testen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt √§ndert sich die Situation: Es tauchten Werkzeuge auf, aber es ist nicht einfach, Handb√ºcher zu ihrer Verwendung zu finden. In diesem Artikel werde ich anhand eines einfachen Beispiels zeigen, wie mit der neuen Funktionalit√§t gearbeitet wird. Sie k√∂nnen es leicht meistern und die Probleme und Fehler umgehen, auf die ich ‚ÄûGl√ºck‚Äú hatte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie lernen, wie Sie mit der AWS-, SAM-CLI- und IntelljIDEA-Browserkonsole entwickeln. </font><font style="vertical-align: inherit;">Ich werde auch √ºber das Testen sprechen: Integration, E2E und Unit-Tests. </font><font style="vertical-align: inherit;">Und schlie√ülich werden wir diskutieren, wie viel eine solche L√∂sung kosten wird (Spoiler: Sie k√∂nnen viel sparen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel ist n√ºtzlich f√ºr diejenigen, die mit der Entwicklung von Anwendungen ohne Server beginnen und noch nicht mit den Tools und Ans√§tzen vertraut sind.</font></font><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was wird besprochen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hallo alle zusammen! </font><font style="vertical-align: inherit;">Mein Name ist Alexander Gruzdev und ich freue mich, den zweiten Teil des Artikels √ºber die Verwendung und Entwicklung von Serverless-L√∂sungen auf Basis von AWS Lambda vorstellen zu k√∂nnen. </font><font style="vertical-align: inherit;">In der Folge werden wir im ersten Teil √ºber die M√∂glichkeiten zum Entwickeln und Testen der L√∂sung sprechen ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda in Aktion in Java 11. Wir besuchen Serverless in ‚ÄûProduktion‚Äú</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seit der Ver√∂ffentlichung des letzten Artikels wurde die Testanwendung leicht √ºberarbeitet, die Hauptbedeutung bleibt jedoch gleich. </font><font style="vertical-align: inherit;">Dies ist ein triviales HTML-Formular ‚ÄûKontakt‚Äú, das Daten aus dem Formular √ºber HTTP-Anforderungen an die Gateway-API sendet und die Verarbeitungsanforderung wiederum an AWS Lambda weiterleitet. </font><font style="vertical-align: inherit;">W√§hrend der Verarbeitung schreibt das Lambda Daten in die DynamoDB-Tabelle und sendet einen Brief √ºber AWS SES. </font><font style="vertical-align: inherit;">Das Komponentendiagramm ist unten dargestellt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/zp/wd/aczpwdfofm_vp7xqrjdis2gsblu.png" alt="Komponentendiagramm"><br>
<br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhalt</font></font></h1><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklung mit der AWS Browser Console</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklung mit SAM-CLI</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklung mit IntelljIDEA</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arten von Tests</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serverlose Kosten</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√ºtzliche Links</font></font></a></li>
</ol><br>
<br>
<a name="Part1"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Entwicklung mit der AWS-Browserkonsole</font></font></h1><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS-Konsole</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die AWS-Konsole bietet Zugriff auf jeden AWS-Service, sei es auf Ihren virtuellen EC2-Server, IAM- oder AWS Lambda-Rollen- / Zugriffsrichtlinieneinstellungen, mit allen Parametern, die in Echtzeit ohne erneute Bereitstellung √ºber Continuous Delivery- / Continuous Deployment-Systeme ge√§ndert werden k√∂nnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies beschleunigt den Entwicklungsprozess und einige Arten von Tests erheblich. </font><font style="vertical-align: inherit;">Es hilft auch, die Start- und Betriebsparameter Ihrer Anwendungen visuell zu steuern.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Gateway Console</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úber die Konsole k√∂nnen Sie den aktuellen Status der Anwendung √ºberwachen, Ihre Umgebungen verwalten und neue Versionen bereitstellen. </font><font style="vertical-align: inherit;">Ich werde zeigen, wie dies verwendet werden kann, um den Zustand der Umwelt zu √ºberpr√ºfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie diese ‚Äûmagische‚Äú Konsole aussieht, sehen Sie im Screenshot der Registerkarte Ressourcen der Anwendung Kontakt: </font><font style="vertical-align: inherit;">
Der Screenshot zeigt, wie die Anforderung vom Client √ºber die Gateway-API in das Lambda gelangt und wie die Antwort an den Client zur√ºckgegeben wird, wenn die Ressource / contact von der POST-Methode aufgerufen wird.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/f7/fe/s2/f7fes2uz9qxcpj9dqmko6zuxalc.png" alt="Gateway-Ressourcen"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methodenanforderung</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - der erste Schritt bei der Verarbeitung der Anforderung. </font><font style="vertical-align: inherit;">In unserem Fall enth√§lt es keine Einstellungen, kann aber beispielsweise Einstellungen f√ºr die Autorisierung enthalten.</font></font><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrationsanforderung</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bedeutet, dass die HTTP-Anforderung in einem speziellen Format an das Lambda √ºbertragen wird: Sie enth√§lt alle vom Client gesendeten Informationen und Details zum aufgerufenen Kontext.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Integrationsantwort</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> besagt, dass der HTTP-Client die Antwort direkt vom Lambda erh√§lt. </font><font style="vertical-align: inherit;">Daher sind Sie selbst f√ºr die Bildung des Reaktionsk√∂rpers in Lambda verantwortlich.</font></font></li>
</ul><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deaktivieren Sie die Proxy-Integration</font></font></b>
                        <div class="spoiler_text">     API Gateway  ,    <i>Use Lambda Proxy integration</i>   <i>Integration Request</i>.          . ,          ,     .<br>
<br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel f√ºr eine Integrationsanforderung</font></font></b>
                        <div class="spoiler_text">    SAM init      <i>events</i>,     ,      <i>Integration request</i>.    ,   AWS    ,     .         AWS Lambda.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dr√ºcken Sie die TEST-Taste, um zu √ºberpr√ºfen, ob die Anwendung funktioniert. </font><font style="vertical-align: inherit;">Dadurch erhalten Sie Zugriff auf die HTTP-Gateway-API-Aufrufe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im folgenden Screenshot habe ich eine Anfrage zum Aufw√§rmen des Lambda gesendet: </font><font style="vertical-align: inherit;">
Zus√§tzlich zur Antwort auf die Anfrage zeigt die Gateway-API detaillierte Protokolle an. </font><font style="vertical-align: inherit;">Auf die gleiche Weise k√∂nnen Sie eine echte Anfrage stellen, indem Sie den JSON-Anfragetext in der folgenden Form ersetzen:</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ia/kf/ga/iakfgafb8t4-9aocr5o-e5dspy0.png" alt="Gateway-Testanforderung"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<pre><code class="javascript hljs">{
    <span class="hljs-string">"subject"</span>: <span class="hljs-string">"Email subject"</span>,
    <span class="hljs-string">"question"</span>: <span class="hljs-string">"Your question‚Ä¶"</span>,
    <span class="hljs-string">"username"</span>: <span class="hljs-string">"Your name‚Ä¶"</span>,
    <span class="hljs-string">"phone"</span>: <span class="hljs-string">"Your phone‚Ä¶"</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"Your email‚Ä¶"</span><font></font>
} <font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So k√∂nnen Sie Ihre API manuell ohne UI-Formulare und Front-End-Anwendungen testen und so die Front-End- und Back-End-Entwicklung trennen. </font><font style="vertical-align: inherit;">Alternativ zur integrierten Konsole k√∂nnen Sie Postman oder einen anderen HTTP-Client verwenden.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postbote als Alternative</font></font></b>
                        <div class="spoiler_text">   HTTP-     Postman.         .   ,   API Gateway       AWS ,              API. ,  ,       AWS .<br>
</div>
                    </div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lambda-Konsole</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Testen und Entwickeln k√∂nnen Sie zus√§tzlich zu Anforderungen √ºber die Gateway-API die AWS Lambda-Browserkonsole verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sein Bildschirm ist in mehrere Bl√∂cke unterteilt:</font></font><br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Designer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zeigt vorhandene Trigger und Ebenen an. </font><font style="vertical-align: inherit;">In unserem Fall ist der Ausl√∂ser API Gateway. </font><font style="vertical-align: inherit;">Wenn wir darauf klicken, werden alle erforderlichen Informationen ge√∂ffnet: URL, Stufe, Ressourcenpfad.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit Aliasen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (verf√ºgbar bei Auswahl eines bestimmten Lambda-Alias) k√∂nnen Sie die Verteilung des Datenverkehrs nach Lambda-Version konfigurieren. </font><font style="vertical-align: inherit;">Mehr dazu im n√§chsten Absatz.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png"></a></li>
<li><i>Function code</i> ‚Äî        .      zip-  ,    .       ,   Function code      .         Python/NodeJs. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/1l/p1/0y/1lp10yo_zd7tcbcr7cyu-dyxtlw.png"></a></li>
<li><i>Environment variables.</i> ,      .  ,        ,     .    ,         . ,    ,        .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/hx/sg/z_/hxsgz_-adludvt4phrfgebnjqa4.png"></a></li>
<li><i>Tags</i> ‚Äî  ,       , ,    ,    .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/qm/za/bt/qmzabtb2nt-yo9tedqlxluhop8e.png"></a></li>
<li><i>Execution role</i> ‚Äî      (   ) ,      .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/bf/rk/3s/bfrk3sw8ig7rseuhnwr4mr8o8-c.png"></a></li>
<li><i>Basic settings</i> ‚Äî         .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ds/lr/cj/dslrcjorhygk_bmfzlxp5ddxqz0.png"></a></li>
<li><i>Network</i>:      -  ,          VPC.    ‚Äî   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  .</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-i/lz/hm/-ilzhms_ty6b7i7pex7pc1dbcbw.png"></a></li>
<li><i>AWS X-Ray</i>   .           AWS-. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/pj/l6/qz/pjl6qzbt3133iqwonql03wd96qs.png"></a></li>
<li><i> Reserve concurrency</i>     ,                  .          .<br>
   Provisioned concurrency</li>
<li><i>Provisioned concurrency</i> ‚Äî    .       ,          .     ,     ‚Äî    .          Free Tier .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/mb/gt/sq/mbgtsqv1iueoy6js88rv4rusi7s.png"></a></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dem asynchronen Aufruf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen Sie die spezielle Behandlung von asynchronen Anforderungen konfigurieren. </font><font style="vertical-align: inherit;">Wir geben an, wie viele wiederholte Anrufe im Fehlerfall get√§tigt werden m√ºssen und wie lange die Anforderung in der Warteschlange h√§ngen bleiben kann. </font><font style="vertical-align: inherit;">Optional k√∂nnen Sie eine Warteschlange f√ºr die Verarbeitung fehlgeschlagener Anforderungen angeben.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/fp/g_/zi/fpg_ziuv-ouv4yeeejmxqlko-za.png"></a><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenbank-Proxys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind eine weitere neue Funktion, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit der Sie den</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zugriff auf die Datenbank √ºber Proxys in Form von API Gateway + Lambda </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">konfigurieren</font></a><font style="vertical-align: inherit;"> k√∂nnen.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/bp/f4/fw/bpf4fw1yjd0ayzsolj0vbhnjrfs.png"></a></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes wollen wir sehen, wie man aus dieser Konsole entwickelt. </font><font style="vertical-align: inherit;">Zus√§tzlich zum √Ñndern der Parameter kann mit der Funktion " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testereignisse konfigurieren"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Testanforderung erstellt werden. </font><font style="vertical-align: inherit;">Eine ziemlich umfangreiche Liste ist verf√ºgbar, aber wir werden das nutzen, was ich bereits im Projekt angeh√§ngt habe:</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ContactUs Anfrage</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs">{
  <span class="hljs-string">"body"</span>: <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span>: <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"path"</span>: <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"isBase64Encoded"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"queryStringParameters"</span>: {
    <span class="hljs-string">"foo"</span>: <span class="hljs-string">"bar"</span><font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span>: {
    <span class="hljs-string">"proxy"</span>: <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"stageVariables"</span>: {
    <span class="hljs-string">"baz"</span>: <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"headers"</span>: {
    <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,
    <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, sdch"</span>,
    <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.8"</span>,
    <span class="hljs-string">"Cache-Control"</span>: <span class="hljs-string">"max-age=0"</span>,
    <span class="hljs-string">"CloudFront-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span>,
    <span class="hljs-string">"CloudFront-Is-Desktop-Viewer"</span>: <span class="hljs-string">"true"</span>,
    <span class="hljs-string">"CloudFront-Is-Mobile-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-SmartTV-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-Tablet-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Viewer-Country"</span>: <span class="hljs-string">"US"</span>,
    <span class="hljs-string">"Host"</span>: <span class="hljs-string">"1234567890.execute-api.us-east-1.amazonaws.com"</span>,
    <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"1"</span>,
    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
    <span class="hljs-string">"Via"</span>: <span class="hljs-string">"1.1 08f323deadbeefa7af34d5feb414ce27.cloudfront.net (CloudFront)"</span>,
    <span class="hljs-string">"X-Amz-Cf-Id"</span>: <span class="hljs-string">"cDehVQoZnx43VYQb9j2-nvCh-9z396Uhbp027Y2JvkCPNLmGJHqlaA=="</span>,
    <span class="hljs-string">"X-Forwarded-For"</span>: <span class="hljs-string">"127.0.0.1, 127.0.0.2"</span>,
    <span class="hljs-string">"X-Forwarded-Port"</span>: <span class="hljs-string">"443"</span>,
    <span class="hljs-string">"X-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span><font></font>
  },<font></font>
  <span class="hljs-string">"requestContext"</span>: {
    <span class="hljs-string">"accountId"</span>: <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"resourceId"</span>: <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"stage"</span>: <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"requestId"</span>: <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"requestTime"</span>: <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span>: <span class="hljs-number">1428582896000</span>,
    <span class="hljs-string">"identity"</span>: {
      <span class="hljs-string">"cognitoIdentityPoolId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accountId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoIdentityId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"caller"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accessKey"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"sourceIp"</span>: <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"cognitoAuthenticationType"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userArn"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userAgent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span>: <span class="hljs-literal">null</span><font></font>
    },<font></font>
    <span class="hljs-string">"path"</span>: <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"resourcePath"</span>: <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"apiId"</span>: <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"protocol"</span>: <span class="hljs-string">"HTTP/1.1"</span><font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie nach dem Hinzuf√ºgen der Anforderung auf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um das Ergebnis des Lambda anzuzeigen: </font><font style="vertical-align: inherit;">
Lambda gibt JSON zur√ºck, das den Statuscode und den Antworttext enth√§lt. </font><font style="vertical-align: inherit;">Der Body-Wert geht direkt an den Client, der die Gateway-API aufgerufen hat. </font><font style="vertical-align: inherit;">Dar√ºber hinaus weist der Screenshot die Merkmale des Aufrufs auf: die Ausf√ºhrungszeit, die Ausf√ºhrungszeit, f√ºr die wir bezahlen, die maximale Speichermenge, die vom Lambda verbraucht wurde. </font><font style="vertical-align: inherit;">Basierend auf diesen Metriken k√∂nnen wir die optimale Speichermenge so konfigurieren, dass das Lambda Ihren Preis- / Antwortratenanforderungen entspricht.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/oc/vw/w1/ocvww1tut1fhx0czz5ijzjnpvhg.png" alt="Gateway-Ressourcen"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden der AWS-Konsole zum Testen der kanarischen Bereitstellung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns nun einen wichtigen Punkt im Zusammenhang mit der Bereitstellung einer neuen Lambda-Version ansprechen. </font><font style="vertical-align: inherit;">Ich habe solche Parameter angegeben, als ich die SAM-Vorlage schrieb:</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Parameter f√ºgt jeder neuen Version des Lambda automatisch einen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Live-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alias ‚Äã‚Äãhinzu </font><font style="vertical-align: inherit;">.</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen √ºber Aliase</font></font></b>
                        <div class="spoiler_text">     ,   .    ,         ,       API Gateway.      1, 2, 3   .    <i>LATEST</i>,     .     2  3   API Gateway (Stage   AWS),          Gateway-Lambda.  API Gateway      (ARN ),      <i>LATEST</i>. <br>
 <br>
 ‚Äî    (  ), ,      ,    ARN .      ,         Stage  API Gateway      .  ,    API Gateway: dev, qa  prod       .<br>
<br>
         ,    ,      .       ,        .  , live,    .    live-    , , ,    ,       CloudWatch.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Testen der kanarischen Bereitstellung k√∂nnen Sie sowohl die Gateway-API-Konsole als auch die Lambda-Konsole verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst m√ºssen Sie den Lambda-Code √§ndern, damit er eine andere Antwort zur√ºckgibt. </font><font style="vertical-align: inherit;">Geben Sie beispielsweise in der Aufw√§rmverarbeitung in der Antwort Version 2 anstelle von Version 1 an. Dies ist unser Marker. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mithilfe der API-Funktionalit√§t des Gateway-Tests k√∂nnen wir jetzt sicherstellen, dass beim Senden von WARM-UP-Anforderungen innerhalb von zehn Minuten nur 10% der Antworten Version 2 im Antworttext enthalten. </font><font style="vertical-align: inherit;">Nach dieser Zeit gibt Version 2 100% der Anforderungen zur√ºck. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zur Gateway-API-Konsole k√∂nnen wir die Lambda-Konsole verwenden, bei der nach Auswahl des erforderlichen Alias ‚Äã‚Äãeine Richtlinie zur Verkehrsverteilung angezeigt wird, die gesteuert werden kann.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png" alt="Lambda alias"></a><br>
<br>
<br>
<a name="Part2"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Lokale Entwicklung mit SAM-CLI</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor einiger Zeit wurde einer der Hauptnachteile bei der Verwendung von Lambda als unangenehm bei der Entwicklung und dem Testen auf dem lokalen Computer angesehen. Jetzt hat sich die Situation stark ver√§ndert: Das SAM-Framework ist erschienen, mit dem nicht nur L√∂sungen gesammelt und bereitgestellt werden k√∂nnen, sondern auch die lokale Entwicklung vereinfacht wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen Ihr Lambda beispielsweise direkt von der Konsole aus aufrufen:</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Befehl wird aus dem Verzeichnis mit der SAM-Vorlage gestartet und √ºbertr√§gt den Inhalt der JSON-Datei an das Eingabe-Lambda ContactUsFunction (dies ist der logische Name in der Vorlage). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, mit diesem Befehl l√∂st SAM das Image </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lambci / lambda: java11</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Docker aus </font><font style="vertical-align: inherit;">und f√ºhrt Ihren Code darin aus. </font><font style="vertical-align: inherit;">F√ºr den Zugriff auf Remotedienste wie SES wird Ihre AWS-Konfiguration mit einem Geheim- / Zugriffsschl√ºssel verwendet. Sie muss daher auf dem neuesten Stand sein. </font><font style="vertical-align: inherit;">Ein weiterer wichtiger Punkt: Wenn Sie keinen Header f√ºr den Aufw√§rmmodus hinzuf√ºgen, werden die echten AWS SES- und DynamoDB-Dienste aufgerufen.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufen Sie hier an</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction<font></font>
Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2 Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Request was received<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"protocol"</span> : <span class="hljs-string">"HTTP/1.1"</span>,
    <span class="hljs-string">"requestTime"</span> : <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span> : 1428582896000,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : { },
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"X-WARM-UP"</span> : [ <span class="hljs-string">"13"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : {
    <span class="hljs-string">"proxy"</span> : <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : {
    <span class="hljs-string">"baz"</span> : <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2?[0m<font></font>
?[32mREPORT RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2     Init Duration: 1984.55 ms       Duration: 42.22 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
{<span class="hljs-string">"statusCode"</span>:201,<span class="hljs-string">"multiValueHeaders"</span>:{<span class="hljs-string">"Access-Control-Allow-Origin"</span>:[<span class="hljs-string">"*"</span>]},<span class="hljs-string">"body"</span>:{<span class="hljs-string">"response"</span>:<span class="hljs-string">"Lambda was warmed up. V1"</span>},<span class="hljs-string">"isBase64Encoded"</span>:<span class="hljs-literal">false</span>}
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zum Lambda-Protokoll werden Serviceinformationen zum Anrufstatus und eine Antwort im JSON-Format in die Konsole geschrieben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Gateway-API kann wie das Lambda lokal ausgef√ºhrt werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir f√ºhren den Befehl aus:</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> start-api
</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konsolenprotokoll beim Start</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> start-api<font></font>
Mounting ContactUsFunction at http://127.0.0.1:3000/contact [POST, OPTIONS]<font></font>
You can now browse to the above endpoints to invoke your <span class="hljs-built_in">functions</span>. You <span class="hljs-keyword">do</span> not need to restart/reload SAM CLI <span class="hljs-keyword">while</span> working on your <span class="hljs-built_in">functions</span>, changes will be reflected instantly/automatically. You only need to restart SAM CLI <span class="hljs-keyword">if</span> you update your AWS SAM template<font></font>
2020-01-06 22:20:30  * Running on http://127.0.0.1:3000/ (Press CTRL+C to quit)<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Start des Servers k√∂nnen wir Anfragen ausf√ºhren. </font><font style="vertical-align: inherit;">Ich werde Postman benutzen und eine Anfrage senden, um das Lambda aufzuw√§rmen.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/_e/hg/vs/_ehgvsftbjygwjcu3iiol-vky68.png"></a><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der Konsole sehen wir</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: 27868750-3637-1f80-3d80-53a724da16ef Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Request was received<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\r\n  \"subject\": \"Question\",\r\n  \"question\": \"How much does it cost\",\r\n  \"username\": \"Alex\",\r\n  \"phone\": \"+79999999999\",\r\n  \"email\": \"alex@gmail.com\"\r\n}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"Prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"protocol"</span> : null,
    <span class="hljs-string">"requestTime"</span> : null,
    <span class="hljs-string">"requestTimeEpoch"</span> : 0,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : null,
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"Accept"</span> : [ <span class="hljs-string">"application/json"</span> ],
    <span class="hljs-string">"Accept-Encoding"</span> : [ <span class="hljs-string">"gzip, deflate, br"</span> ],
    <span class="hljs-string">"Accept-Language"</span> : [ <span class="hljs-string">"ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7"</span> ],
    <span class="hljs-string">"Cache-Control"</span> : [ <span class="hljs-string">"no-cache"</span> ],
    <span class="hljs-string">"Connection"</span> : [ <span class="hljs-string">"keep-alive"</span> ],
    <span class="hljs-string">"Content-Length"</span> : [ <span class="hljs-string">"150"</span> ],
    <span class="hljs-string">"Content-Type"</span> : [ <span class="hljs-string">"text/plain;charset=UTF-8"</span> ],
    <span class="hljs-string">"Host"</span> : [ <span class="hljs-string">"127.0.0.1:3000"</span> ],
    <span class="hljs-string">"Origin"</span> : [ <span class="hljs-string">"chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop"</span> ],
    <span class="hljs-string">"Postman-Token"</span> : [ <span class="hljs-string">"5cadaccd-6fae-5bc2-b4ef-63900a1725ff"</span> ],
    <span class="hljs-string">"Sec-Fetch-Mode"</span> : [ <span class="hljs-string">"cors"</span> ],
    <span class="hljs-string">"Sec-Fetch-Site"</span> : [ <span class="hljs-string">"cross-site"</span> ],
    <span class="hljs-string">"User-Agent"</span> : [ <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36"</span> ],
    <span class="hljs-string">"X-Forwarded-Port"</span> : [ <span class="hljs-string">"3000"</span> ],
    <span class="hljs-string">"X-Forwarded-Proto"</span> : [ <span class="hljs-string">"http"</span> ],
    <span class="hljs-string">"X-Warm-Up"</span> : [ <span class="hljs-string">"123"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : null,
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : null,
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: 27868750-3637-1f80-3d80-53a724da16ef?[0m<font></font>
?[32mREPORT RequestId: 27868750-3637-1f80-3d80-53a724da16ef     Init Duration: 1951.87 ms       Duration: 42.91 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
2020-01-06 22:28:11 127.0.0.1 - - [06/Jan/2020 22:28:11] <span class="hljs-string">"POST /contact HTTP/1.1"</span> 201 -
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Protokolle werden nat√ºrlich nicht optimal formatiert. </font><font style="vertical-align: inherit;">Hoffentlich wird dies in Zukunft behoben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wichtig: Wenn Sie den Lambda-Code √§ndern, ist ein Neustart der API nicht erforderlich. </font><font style="vertical-align: inherit;">Es reicht aus, das Lambda mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl sam build neu zu erstellen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen √ºber Bugs</font></font></b>
                        <div class="spoiler_text">        Java-  <i>aws-serverless-java-container-core</i>,    :       502 .    :<br>
<pre><code class="bash hljs">Invalid API Gateway Response Keys: {<span class="hljs-string">'base64Encoded'</span>} <span class="hljs-keyword">in</span> {<span class="hljs-string">'statusCode'</span>: 200, <span class="hljs-string">'headers'</span>: {<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/plain'</span>}, <span class="hljs-string">'body'</span>: <span class="hljs-string">'Hello World'</span>, <span class="hljs-string">'base64Encoded'</span>: False} 
</code></pre><br>
  - ,   API Gateway    AWS       JsonProperty.     <i>'isBase64Encoded'</i>   <i>'base64Encoded'</i>, , ,    .   ,       Java- ContactUsProxyResponse  AwsProxyRequest.<br>
</div>
                    </div><br>
<br>
<a name="Part3"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Ortsgespr√§che von IDEA</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles, was im obigen Absatz beschrieben wurde, ist die Funktionalit√§t des SAM-Tools. Es wird √ºber die Befehlszeile gesteuert und kann in jede Schnittstelle integriert werden. Genau dies wurde im Plugin f√ºr IntelljIDEA AWS Toolkit getan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Plugin f√ºgt zus√§tzliche Konfigurationen zum Starten eines Lambda direkt von der IDE hinzu. So sieht das Konfigurationsfenster aus. </font><font style="vertical-align: inherit;">
Sie m√ºssen entweder eine Vorlage mit einer Beschreibung des Lambda ausw√§hlen oder die Einstellungen manuell konfigurieren. </font><font style="vertical-align: inherit;">
Im ersten Fall wird der Speicherplatz und die Sprache f√ºr die Kompilierung automatisch aus der Vorlage entnommen. Im zweiten Fall k√∂nnen Sie die RAM-Gr√∂√üe selbst konfigurieren und eine ungef√§hre Berechnung des Grenzwerts vornehmen. </font><font style="vertical-align: inherit;">
Mit einem anderen Plugin k√∂nnen Sie die Konfiguration direkt aus dem Fenster des Java-Code-Editors oder der Yaml-Vorlage ausf√ºhren. Screenshots unten:</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/2s/8u/xk/2s8uxk8n8gfza3p9z9ewugw-xge.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/8o/um/83/8oum83fe_tkz8suqmxzg-evjpaa.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/iw/ma/is/iwmais_steqx3sfhwstdxk7ncwa.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist in der Tat alles. </font><font style="vertical-align: inherit;">Durch Ausf√ºhren der benutzerdefinierten Konfiguration automatisieren Sie einfach h√§ufige Lambda-Aufrufe von der Konsole aus. </font><font style="vertical-align: inherit;">Einverstanden, ganz bequem?</font></font><br>
<br>
<a name="Part4"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Testen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sprechen wir √ºber die Arten von Tests f√ºr Lambdas. </font><font style="vertical-align: inherit;">Da ich im Beispiel Java verwendet habe, enthalten die Tests auch Standardtools f√ºr Unit- und Integrationstests: Junit 4, Mockito und PowerMockito.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unit-Tests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Lambda-Code mit Unit-Tests abzudecken, ben√∂tigen Sie keine spezifischen Kenntnisse. </font><font style="vertical-align: inherit;">Es reicht aus, Standard-Java-Praktiken anzuwenden: Sperren Sie alle Abh√§ngigkeiten in der Klasse und versuchen Sie, alle m√∂glichen F√§lle der Anforderungsverarbeitung zu testen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe nicht alle Testszenarien hinzugef√ºgt und mich auf zwei positive und zwei negative Szenarien beschr√§nkt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste positive Test best√§tigt, dass bei einem X-WARM-UP-Header keine Anforderungen in DbService und EmailService vorhanden sind. </font><font style="vertical-align: inherit;">Der zweite Fall pr√ºft, ob diese Dienste aufgerufen werden, wenn die Anforderung echt ist. </font><font style="vertical-align: inherit;">Dies sind die einfachsten Tests, und ich habe einen Teil der darin enthaltenen Pr√ºfungen weggelassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Negative Szenarien sind eine Antwortpr√ºfung im Falle eines Client- oder Serververarbeitungsfehlers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrationstests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Integrationstests habe ich mich entschlossen, DbService und seine Arbeit mit der DynamoDB-Tabelle zu testen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall habe ich das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Localstack-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tool verwendet </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Diese L√∂sung bietet kostenlose Mokas f√ºr AWS-Services, die als Docker-Container ausgef√ºhrt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie zum Installieren dieser L√∂sung einfach die folgenden Befehle aus:</font></font><br>
<pre><code class="bash hljs">pip install localstack<font></font>
localstack start<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder Sie k√∂nnen die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker-Compose-Datei verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker-Compose zum Erh√∂hen nur von DynamoDB</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">version: <span class="hljs-string">'2.1'</span><font></font>
services:<font></font>
  localstack:<font></font>
    container_name: <span class="hljs-string">"<span class="hljs-variable">${LOCALSTACK_DOCKER_NAME-localstack_main}</span>"</span><font></font>
    image: localstack/localstack<font></font>
    ports:<font></font>
      - <span class="hljs-string">"4567-4599:4567-4599"</span>
      - <span class="hljs-string">"<span class="hljs-variable">${PORT_WEB_UI-8080}</span>:<span class="hljs-variable">${PORT_WEB_UI-8080}</span>"</span><font></font>
    environment:<font></font>
      - SERVICES=dynamodb<font></font>
      - DEBUG=<span class="hljs-variable">${DEBUG- }</span>
      - DATA_DIR=<span class="hljs-variable">${DATA_DIR- }</span>
      - PORT_WEB_UI=<span class="hljs-variable">${PORT_WEB_UI- }</span>
      - LAMBDA_EXECUTOR=<span class="hljs-variable">${LAMBDA_EXECUTOR- }</span>
      - KINESIS_ERROR_PROBABILITY=<span class="hljs-variable">${KINESIS_ERROR_PROBABILITY- }</span><font></font>
      - DOCKER_HOST=unix:///var/run/docker.sock<font></font>
    volumes:<font></font>
      - <span class="hljs-string">"<span class="hljs-variable">${TMPDIR:-/tmp/localstack}</span>:/tmp/localstack"</span>
      - <span class="hljs-string">"/var/run/docker.sock:/var/run/docker.sock"</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Befehl start l√∂st standardm√§√üig alle verf√ºgbaren AWS-Services aus. </font><font style="vertical-align: inherit;">Um DynamoDB spezifisch zu erh√∂hen, legen Sie einfach die Umgebungsvariable fest:</font></font><br>
<pre><code class="bash hljs"><span class="hljs-built_in">set</span> SERVICES=dynamodb
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt einen speziellen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LocalstackTestRunner f√ºr Junit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit dem Sie die erforderlichen Dienste mithilfe der Konfiguration </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@LocalstackDockerProperties starten k√∂nnen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Schreiben eines Tests f√ºr DbService sieht daher folgenderma√üen aus:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úber die Testklasse hinzuf√ºgen. </font></font><br>
<pre><code class="java hljs"><span class="hljs-meta">@RunWith(LocalstackTestRunner.class)</span>
<span class="hljs-meta">@LocalstackDockerProperties(services = { "dynamodb" })</span>
</code></pre> <br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie eine Tabelle </font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@Before</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span><span class="hljs-params">()</span> </span>{<font></font>
    AmazonDynamoDB clientDynamoDB = TestUtils.getClientDynamoDB();<font></font>
    dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(clientDynamoDB);<font></font>
    dbService = <span class="hljs-keyword">new</span> DbService(dynamoDB);<font></font>
<font></font>
    dynamoDB.createTable(<font></font>
            <span class="hljs-keyword">new</span> CreateTableRequest()<font></font>
                    .withTableName(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                    .withKeySchema(<span class="hljs-keyword">new</span> KeySchemaElement(<span class="hljs-string">"Id"</span>, KeyType.HASH))<font></font>
                    .withAttributeDefinitions(<span class="hljs-keyword">new</span> AttributeDefinition(<span class="hljs-string">"Id"</span>, ScalarAttributeType.S))<font></font>
                    .withProvisionedThroughput(<span class="hljs-keyword">new</span> ProvisionedThroughput(<span class="hljs-number">10L</span>, <span class="hljs-number">10L</span>)));<font></font>
}<font></font>
                </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir beschreiben das Testszenario</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-comment">// given</span>
ContactUsRequest contactUsRequest = <span class="hljs-keyword">new</span> ContactUsRequest(<span class="hljs-string">"subject"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"+79991234545"</span>, <span class="hljs-string">"123@mail.ru"</span>, <span class="hljs-string">"Qeustion"</span>);<font></font>
<font></font>
<span class="hljs-comment">// when</span>
dbService.putContactUsRequest(<span class="hljs-string">"123"</span>, contactUsRequest);<font></font>
<font></font>
<span class="hljs-comment">// then</span>
Item item = dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).getItem(<span class="hljs-keyword">new</span> PrimaryKey(<span class="hljs-string">"Id"</span>, <span class="hljs-string">"123"</span>));<font></font>
assertEquals(contactUsRequest.getSubject(), item.get(<span class="hljs-string">"Subject"</span>));<font></font>
assertEquals(contactUsRequest.getUsername(), item.get(<span class="hljs-string">"Username"</span>));<font></font>
assertEquals(contactUsRequest.getPhone(), item.get(<span class="hljs-string">"Phone"</span>));<font></font>
assertEquals(contactUsRequest.getEmail(), item.get(<span class="hljs-string">"Email"</span>));<font></font>
assertEquals(contactUsRequest.getQuestion(), item.get(<span class="hljs-string">"Question"</span>));
              </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergessen Sie nicht, die Tabelle nach dem Test zu l√∂schen.</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@After</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tearDown</span><span class="hljs-params">()</span> </span>{<font></font>
    dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).delete();<font></font>
}<font></font>
               </code></pre><br>
 </div>
                    </div><br>
 </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten wir mit Localstack eine ziemlich umfangreiche Auswahl an AWS-Mocks, mit denen Sie die Arbeit dieser Services emulieren k√∂nnen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E2E-Tests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um E2E-Szenarien abzuspielen, ist es besser, AWS-Testdienste speziell f√ºr die Ausf√ºhrung von Tests zu erstellen, wenn nat√ºrlich eine solche M√∂glichkeit besteht. </font><font style="vertical-align: inherit;">Dies kann mithilfe der optionalen CloudFormation-Vorlage erfolgen, in der die Ressourcen Kopien der Hauptvorlage sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Test kann durchgef√ºhrt werden, indem das Lambda √ºber AWS-CLI aufgerufen und das Ergebnis mit einem beliebigen verf√ºgbaren Tool verarbeitet wird. </font><font style="vertical-align: inherit;">Sie k√∂nnen weiterhin in Unit-Tests anrufen, ohne jedoch Mobs zu erstellen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leistungstests</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da Leistungstests einen separaten Artikel oder sogar ein Buch verdienen, werde ich nicht versuchen, alle Informationen hier zu platzieren. </font><font style="vertical-align: inherit;">Kurz gesagt, wenn Sie √ºber Stresstests sprechen, m√ºssen Sie bedenken, dass die Nutzung fast aller AWS-Services nicht kostenlos ist, und Sie sollten bereit sein, die m√∂glichen Kosten im Voraus abzusch√§tzen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die erforderlichen Ressourcen f√ºr ein Lambda auswerten m√∂chten, verwenden Sie die UI-Konsole und f√ºhren Sie einige Testaufrufe durch. </font><font style="vertical-align: inherit;">Bewerten Sie anschlie√üend anhand der g√§ngigen Logik und Mathematik, wie stark sich die Leistung Ihres Lambda in Abh√§ngigkeit von der Menge der verf√ºgbaren Ressourcen erh√∂ht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie CloudWatch nicht. </font><font style="vertical-align: inherit;">Mit seiner Hilfe k√∂nnen Sie sehr aussagekr√§ftige Dashboards erstellen und anhand dieser bestimmen, welche Lambda-Parameter und Ausgaben Sie sich leisten k√∂nnen.</font></font><br>
<br>
<a name="Part5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Die Kosten f√ºr serverlose L√∂sungen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bewertung einer L√∂sung ist immer spezifisch, da Sie nicht nur die Kosten eines Anrufs, sondern auch den eingehenden / ausgehenden Datenverkehr sowie die Kosten f√ºr das Zwischenspeichern, Protokollieren und √úberwachen ber√ºcksichtigen m√ºssen. </font><font style="vertical-align: inherit;">Wenn Sie die Verwendung von Lambda in Betracht ziehen, versuchen Sie, die Last vorherzusagen, die Ihr Dienst bew√§ltigen wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es sich um Einzelanrufe oder einen ETL-Prozess handelt, der alle paar Stunden / Tage beginnt, zahlt sich das Lambda eher aus. </font><font style="vertical-align: inherit;">Wenn Sie eine Belastung von mehreren Abfragen pro Sekunde vorhersagen, m√ºssen Sie eine genaue Sch√§tzung vornehmen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Folgenden gebe ich ungef√§hre Sch√§tzungen der Kosten f√ºr das Lambda und den billigsten EC2-Server an, damit Sie verstehen, um welche Werte es sich handelt: </font><font style="vertical-align: inherit;">
Die folgenden Parameter f√ºr das Lambda wurden zur Berechnung herangezogen:</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/p_/0w/ij/p_0wij6j_z2xop6dbt185485llc.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorlaufzeit:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 150 Millisekunden</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preis:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0.00001667 f√ºr 1 GB-s</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicher:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 256 MB</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr EC2 t2.nano:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preis:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4,75 USD pro Monat</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicher:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 512 MB</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCPU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximale Auslastung:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5% CPU pro Monat</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EC2-Lastdaten genommen </font><font style="vertical-align: inherit;">. Nach diesen Berechnungen kann der angegebene Server einer konstanten Last von 0,3 Anforderungen pro Sekunde standhalten. Mit zunehmender Last erh√∂ht sich die Antwortzeit, was die Effizienz dieses Servers verringert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle diese Berechnungen sind recht abstrakt und ber√ºcksichtigen nicht viele Faktoren: Rabatte auf eine Vorauszahlung oder eine gro√üe Anzahl von Anfragen, Lambda-Ausf√ºhrungszeit usw. Sie zeigen jedoch, dass Lambda mit einer Last von weniger als 1 Anforderung pro Sekunde weniger kostet als der billigste EC2-Server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie √ºbrigens nicht, den Preis von ALB zum EC2-Preis hinzuzuf√ºgen, wenn Sie mehrere Anwendungsreplikate oder elastische IPs aufbewahren m√ºssen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/wc/md/grwcmd0t5swk3uwf-shmglewttu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Testen und die lokale Entwicklung von Serverless-L√∂sungen sind weniger beliebt als dieselben Microservices. </font><font style="vertical-align: inherit;">Dennoch studieren und wenden immer mehr Menschen diese Technologien an und geben verschiedenen Open-Source-Produkten die M√∂glichkeit, besser und effizienter zu werden. </font><font style="vertical-align: inherit;">Solche L√∂sungen vereinfachen das Leben von Unternehmen erheblich, die ein Produkt so schnell wie m√∂glich ver√∂ffentlichen m√ºssen und nicht die gesamte Infrastruktur konfigurieren m√ºssen. </font><font style="vertical-align: inherit;">Aber selbst in bereits entwickelten Produkten gibt es meiner Meinung nach einen Platz f√ºr serverlose Datenbanken oder Lambdas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich behaupte nicht, ein Experte auf dem Gebiet des Testens von Serverless-L√∂sungen zu sein, aber aufgrund meiner pers√∂nlichen positiven Erfahrung habe ich beschlossen, die wichtigsten Punkte in diesem Artikel hervorzuheben. </font><font style="vertical-align: inherit;">Ich hoffe, dass sie jemandem n√ºtzlich sein werden, und vielleicht k√∂nnen einige von Ihnen mich erg√§nzen oder sogar korrigieren, wor√ºber ich mich sehr freuen werde.</font></font><br>
<br>
<a name="Part6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√ºtzliche Links</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda in Aktion. </font><font style="vertical-align: inherit;">Teil 1</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  GitHub</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Localstack Git </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> docker-compose   Localstack</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   EC2  AWS Lambda</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SAM-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SAM-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   AWS Lambda</a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496742/index.html">√úber eine L√∂sung f√ºr das Problem von Dieben und Prostituierten in Online-Bildungsdienstleistungssystemen</a></li>
<li><a href="../de496744/index.html">Wie man angesichts fallender M√§rkte Finanzen spart und sogar Geld verdient: Strukturprodukte</a></li>
<li><a href="../de496750/index.html">Schichtung oder wie man lernt, Daten zu vertrauen</a></li>
<li><a href="../de496752/index.html">Wie das Ebola-Virus uns den Umgang mit Infektionsdaten beigebracht hat und wir alle seine Lektionen vergessen haben</a></li>
<li><a href="../de496754/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 506 (24.03.2020-30.03.2020)</a></li>
<li><a href="../de496758/index.html">Digitale mittelalterliche Gesundheitsversorgung. Globaler technologischer Wandel nach COVID-19</a></li>
<li><a href="../de496760/index.html">Benutzerfluss: So erstellen Sie beliebte Anwendungen und Websites</a></li>
<li><a href="../de496762/index.html">Partikelbasierte Oberfl√§chenerosionssimulation</a></li>
<li><a href="../de496764/index.html">Klein aber fein: DuckDuckGo vs. Ad Monsters</a></li>
<li><a href="../de496766/index.html">Was ist Azure Stack HCI und wie funktioniert es?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>