<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎖️ 🐟 📮 Node.jsでの小さなバッファの大きな競争 👤 ◽️ 🥙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PostgreSQLへのクエリを監視するためのサービスについてはすでに説明しましたが、オンラインサーバーログコレクターを実装しました。その主なタスクは、一度に多数のホストからログストリームを同時に受信し、それらを行にすばやく解析し、特定のルールに従ってパケットにグループ化し、処理し、書き込むことです...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Node.jsでの小さなバッファの大きな競争</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tensor/blog/488678/"><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQLへのクエリを監視するため</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サービス</font></a><font style="vertical-align: inherit;">についてはすでに説明しましたが</font><font style="vertical-align: inherit;">、オンラインサーバーログコレクターを実装しました。その主なタスクは、一度に多数のホストからログストリームを同時に受信し、それら</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を行に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すばやく</font><b><font style="vertical-align: inherit;">解析</font></b><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">、特定のルールに従ってパケットにグループ化し、処理し、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き込むことです。結果はPostgreSQL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストレージになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vk/dn/xj/vkdnxj5l8luuvnk31xevce4auae.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのケースでは、</font><b><font style="vertical-align: inherit;">1日あたり</font></b></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GBを超えるログ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">生成する</font></b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">数百のサーバー</font></a><font style="vertical-align: inherit;">と数百万のリクエストと計画</font><font style="vertical-align: inherit;">について話してい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。したがって、リソースの大部分がこれらの2つの操作（行への解析とデータベースへの書き込み）に正確に費やされていることがわかっても、驚くことではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロファイラーの内部に突っ込んだところ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>Buffer</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node.jsを操作する</font><font style="vertical-align: inherit;">いくつかの機能が見つかりました</font><font style="vertical-align: inherit;">。その知識により、時間とサーバーリソースを大幅に節約できます。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU負荷</font></font></h2><br>
<img src="https://habrastorage.org/webt/od/uv/lm/oduvlmuc8wmu5obyljyygjnc8vw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセッサー時間の大部分は、理解できる着信ログストリームの処理に費やされました。</font><font style="vertical-align: inherit;">しかし、プリミティブの資源集約性だったかは明らかではなかった</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラインにバイナリブロックの着信ストリームの「スライス」</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">による</font></font><code>\r\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/v4/tb/dkv4tbigt2rwylskt8x_iqzcurc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
気配り開発者すぐにここではそれほど効率的気づく</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイトサイクル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の着信バッファスルーを。</font><font style="vertical-align: inherit;">まあ、ラインは隣接するブロック間で「引き裂く」ことができるため</font><font style="vertical-align: inherit;">、前に処理されたブロックから残って</font><font style="vertical-align: inherit;">いる</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能的な「テールアタッチメント」</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もあり</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readlineを試す</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
利用可能なソリューションの簡単なレビューにより、</font><font style="vertical-align: inherit;">ラインにスライスするために必要な機能を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">備え</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た通常の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">readlineモジュール</font></a><font style="vertical-align: inherit;">にたどり着きました：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/px/0v/hepx0v5do7wgj9osz0cwyhuljvg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それが実装された後、プロファイラーの上部からの「スライス」はさらに深くなりました：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jc/5x/et/jc5xetsqi24hpgggyg0yss6ggww.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、判明したように、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readlineは文字列を</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部的</font><b><font style="vertical-align: inherit;">にUTF-8に強制しますが</font></b><font style="vertical-align: inherit;">、これは不可能ですログエントリ（要求、計画、エラーテキスト）のソースエンコーディングが異なる場合に実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、1つのPostgreSQLサーバー上でも、複数のデータベースを同時にアクティブにできます。各データベースは</font><b><font style="vertical-align: inherit;">、元のエンコードで</font></b><font style="vertical-align: inherit;">正確</font><b><font style="vertical-align: inherit;">に</font></b><font style="vertical-align: inherit;">共通サーバーログに出力を生成します。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その結果、win-1251のベースの所有者（「正直な」マルチバイトUNICODEが必要ない場合は、ディスクスペースを節約するためにこれを使用すると便利な場合があります）は、テーブルとインデックスのほぼこのような「ロシア語」名で計画を観察できました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mb/6w/ri/mb6wriic6gmbvaz0koz8vddn_gm.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイクの改造</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは問題です...それでも自分でカットする必要がありますが、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>Buffer.indexOf()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「バイトスキャン」ではなく</font><font style="vertical-align: inherit;">タイプの最適化を使用する</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ii/kf/h0/iikfh0v9mn2pyjd56eislxit69a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
と、すべてが問題ないようです。テスト回路の負荷は増加せず、win1251-namesは修復され、バトルに参加しました... Ta-dam！</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPUの使用率は、定期的に100％の天井を突き破る</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0r/k_/3u/0rk_3ujn57ml6uf2qs5xiuztnto.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはどのように..ですそれはそれは私たちのせいであることが判明した？</font></font><code>Buffer.concat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは「テールスティック」前のブロックから残っていると：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j6/nx/hw/j6nxhw_xyt8rhrz9z9dlfbaz7fo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、我々は唯一の接着を持っている</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちがブロックを通る線を通過したときに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、彼らはいけません多くになる-本当に、本当に？..まあ、ほとんど。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たった今、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時々</font><b><font style="vertical-align: inherit;">、数百の16KBセグメントの「文字列」が</font></b><font style="vertical-align: inherit;">来る</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/iq/rk/54/iqrk54dnsrr9xhfgvawz5pptc90.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを生成するために注意を払った開発者の仲間に感謝します。</font><font style="vertical-align: inherit;">「まれに、しかし正確に」発生するため、テスト回路で事前に確認することはできませんでした。</font><b><font style="vertical-align: inherit;">数メガバイトの</font></b><font style="vertical-align: inherit;">小さな断片</font><b><font style="vertical-align: inherit;">を数百回バッファに貼り付ける</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ことが</font><font style="vertical-align: inherit;">、CPUリソースの消費を伴うメモリ再割り当ての深淵への直接パスである</font><font style="vertical-align: inherit;">ことは明らかです</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そのため、ラインが完全に終了するまで接着しないでください。</font><b><font style="vertical-align: inherit;">私たちはします</font></b><font style="vertical-align: inherit;">ちょうど</font><b><font style="vertical-align: inherit;">配列内の「作品」を置く</font></b><font style="vertical-align: inherit;">：全体のライン「アウト」を与えるために時間になるまで、</font><font style="vertical-align: inherit;">
今、負荷がreadlineの指標に戻ってきたし。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/5i/d8/ol/5id8olet5wr0mxddkn4u3ieuwu0.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリ消費</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動的メモリ割り当てを使用して言語で記述した多くの人々は、最も不愉快な「パフォーマンスキラー」の1つが、</font><font style="vertical-align: inherit;">メモリに作成されたオブジェクトをスキャンしてより大きなオブジェクトを削除するガベージコレクタ（GC）</font><font style="vertical-align: inherit;">の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックグラウンドアクティビティである</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことを認識して</font><font style="vertical-align: inherit;">います。誰も必要ありません。</font><font style="vertical-align: inherit;">このトラブルも私たちを追い越しました-ある時点で、GCアクティビティがなんとなく多すぎて場違いであることに気づき始めました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/pp/ht/hgppht17ouvqyv9xdqv7wf4n5kq.png"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">従来の「ねじれ」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は実際には効果がありませんでした...「他のすべてが失敗した場合、ダンプしてください！」</font><font style="vertical-align: inherit;">そして、民俗の知恵は失望しませんでした- </font><font style="vertical-align: inherit;">合計サイズが520MB </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の8360バイトのバッファーのクラウド</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を見ました</font><font style="vertical-align: inherit;">... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s7/ct/km/s7ctkmzfmorz0qhbsaw1v3aorpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それらはCopyBinaryStream内で生成されました-状況は解消し始めました...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コピー...バイナリ付きのSTDINから</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースに送信されるトラフィックの量を減らすために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイナリ形式のCOPY</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">実際、各レコードについて、「ピース」-レコード内のフィールド数（2バイト）と、各列の値のバイナリ表現（タイプID +データあたり4バイト）で構成されるバッファーをストリームに送信する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなテーブルの行は、ほとんど常に</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可変長であるので、固定長のバッファを</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すぐに割り当てる</font><b><font style="vertical-align: inherit;">ことはオプションではありません</font></b><font style="vertical-align: inherit;">。サイズが不足している場合の再割り当ては、パフォーマンスを簡単に「消費」します。</font><font style="vertical-align: inherit;">したがって、を使用して「断片から接着」することも価値があり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>Buffer.concat()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ええと、何度も何度も繰り返される部分（たとえば、同じテーブルのレコード内のフィールド数）がある</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ので、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらを</font><b><font style="vertical-align: inherit;">覚えて</font></b><font style="vertical-align: inherit;">おき</font><b><font style="vertical-align: inherit;">、</font></b><font style="vertical-align: inherit;">最初のアクセスで一度生成さ</font><b><font style="vertical-align: inherit;">れた既製のものを取得</font></b><font style="vertical-align: inherit;">しましょう</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">COPY形式に基づいて、いくつかのオプションがあります-典型的な部分は、長さが1、2、または4バイト</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/32/c2/dx32c2pramljew4m2x2ztitewio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5e/vd/mx/5evdmx_4gln9ccxajf2weqv2z4w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、はい。バッファを作成するたびに、デフォルトで8KBのメモリが割り当てられます。これにより</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、連続</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して作成さ</font><i><b><font style="vertical-align: inherit;">れた</font></b></i><font style="vertical-align: inherit;">小さなバッファ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">、すでに割り当てられているメモリに「並べて」スタックできます。</font><font style="vertical-align: inherit;">そして、私たちの割り当ては「オンデマンド」で機能し、まったく「近い」わけではないことが判明しまし</font><font style="vertical-align: inherit;">た。これが、1〜4 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイトのバッファーの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれ</font><b><font style="vertical-align: inherit;">が8KB +ヘッダーを物理的に占有し</font></b><font style="vertical-align: inherit;">ている理由です。ここでは、520MBです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スマートメモ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
うーん...なぜこれまで、またはその1/2バイトのバッファが必要になるまで待たなければならないのでしょうか。</font><font style="vertical-align: inherit;">4バイトの場合は別の問題ですが、これらのいくつかのオプションの合計は256 + 65536です。そのため</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を一度に</font><font style="vertical-align: inherit;">nagenerimして</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みましょう</font><font style="vertical-align: inherit;">！</font><font style="vertical-align: inherit;">同時に、各チェックが存在するための条件を削減しました。初期化はプロセスの開始時にのみ実行されるため、より速く動作します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fs/yq/ge/fsyqgetrrresipf9qmqpifnt-ku.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、1/2バイトのバッファーに加えて、4バイトの値に対して最も実行中の値（下位2バイトおよび-1）をすぐに初期化します。</font><font style="vertical-align: inherit;">そして、それは役立った、520MBの代わりにたったの10MB！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7l/7h/ot/7l7hotlahibczpu7nvmjsdxxo7a.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488666/index.html">すべての機会のための10の反応コンポーネント</a></li>
<li><a href="../ja488668/index.html">CI / CDチェーンとDocker自動化</a></li>
<li><a href="../ja488670/index.html">マスクレジスタについて</a></li>
<li><a href="../ja488672/index.html">UARTによるARM Cortex-Mマイクロコントローラーのデバッグ</a></li>
<li><a href="../ja488674/index.html">ExcelとPowerPointを使用したインフォグラフィック</a></li>
<li><a href="../ja488680/index.html">Zimbra OSEスパムメーリングリスト</a></li>
<li><a href="../ja488682/index.html">Pythonプログラミングスキルをテストする方法 Yandexからのタスク</a></li>
<li><a href="../ja488686/index.html">Flowmonネットワークを使用した分散アプリケーションおよびデータベースのパフォーマンスの監視</a></li>
<li><a href="../ja488690/index.html">レーベンシュタインの最短距離文字認識</a></li>
<li><a href="../ja488692/index.html">大規模なプロセスをIBM BPMからCamundaに移行し、機能開発を停止しない方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>