<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐆 🤴🏻 ✊ 新しいYandex.Kassi APIに切り替える8つの理由 🤲 💬 ♦️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2017年10月、Yandex.Kassiは新しい支払いプロトコルとAPIの3番目のバージョンを備えています。我々はすでにしている話をどのように、私たちはこれに来た理由について、そして今、私たちはまだ行っていない人のためにそれにスイッチへの主な理由を思い出します。
 
 1.支払いの関連付けが本当に...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>新しいYandex.Kassi APIに切り替える8つの理由</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/453174/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2017年10月、Yandex.Kassiは新しい支払いプロトコルとAPIの3番目のバージョンを備えています。</font><font style="vertical-align: inherit;">我々はすでにしている</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">話を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どのように、私たちはこれに来た理由について、そして今、私たちはまだ行っていない人のためにそれにスイッチへの主な理由を思い出します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.支払いの関連付けが本当に速くなった</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいAPIでは、以前よりも5〜10倍速く処理されます。平均的な開発者は、以前とは異なり、5営業日ではなく1営業日で支払いを自分のWebサイトまたはアプリケーションに接続できます。</font><font style="vertical-align: inherit;">もちろん、これは作業のその部分に関するものであり、すべてが合意されると、アプリケーションが承認され、アクセスキーが受信されます。</font><font style="vertical-align: inherit;">しかし、それでも1日で十分です。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソーシャルネットワークで販売している人にとっては、請求は、メール、SMS、またはプライベートメッセージで送信できる単なるリンクで機能します。 </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.開発者と管理者の力を節約する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いバージョンを維持するには、さまざまな小さなことに注意する必要があります。APIを操作するために静的IPアドレスを割り当て、年に1回証明書を変更します。そして、古いバージョンではサービスの多くのホスティングプロバイダは、「HTTPSでホスティング」に含ま無料（またはほぼ無料）今あるHTTPS SNIモード、のためのサポートはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
払い戻し、確認、取消またはカード決済の試行については、MWSのプロトコルが使用されている（マーチャントWebサービス） MWSの助けを借りて、ストアは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">払い戻し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">遅延支払いの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確認</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャンセル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クレジットカードによる繰り返し支払いを行うことができます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（支払者がこれに同意した場合）。</font><font style="vertical-align: inherit;">MWSを操作するための古いバージョンのAPIでは、ストアはYandex.Money証明機関からX.509証明書を受信する必要がありました。これにより、ストアはYandex.Cashへの要求を生成しました。</font><font style="vertical-align: inherit;">これですべてがすぐに使えるようになりました。アクセスキーを取得し、必要な支払い方法を実装するだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、統合プロセスから多くの不要なものがなくなりました。統合プロセスは私たち自身で対処し、開発者と管理者のために時間を費やす必要がありました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. RESTのみ、それ以上</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書き直し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予想通りになりましたプロトコルが明確に構築されていると振る舞う- RESTスタイルのすべてを。過去の困難の貯金箱では、ほぼすべての支払い方法に独自の構文、スクリプト、および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセス</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり、インストール、構成、および支払いの際に実行する必要がありました。新しいプロトコルは「小児疾患」を取り除き、基準を満たしています-とりわけ、国際的な支払いのリーダーによって設定されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
比較のために、のを見てみましょう</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">古い</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">還付の方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前は、XML 1.0標準に従って操作を実行するための注文ドキュメントを作成し、デジタル署名を使用してPKCS＃7形式の暗号化パッケージを作成する必要がありましたが、認証、データ圧縮、暗号化のチェーンはありませんでした。</font><font style="vertical-align: inherit;">その後、POSTリクエストがHTTP / 1.1を介して生成され、暗号化パッケージの本体を使用するか、application / pkcs-mime MIMEタイプを介して添付されます。</font><font style="vertical-align: inherit;">次に、中小企業です。8つの入力パラメータを渡すことで、原則としてすべての準備が整います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計HTTPリクエスト：</font></font><br>
<pre><code class="plaintext hljs">POST /webservice/mws/api/returnPayment HTTP/1.1<font></font>
Content-Type: application/pkcs7-mime<font></font>
Content-Length: 906<font></font>
<font></font>
——-BEGIN PKCS7——-<font></font>
MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQEHAaCA<font></font>
JIAEgbE8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pg0KPG1h<font></font>
a2VEZXBvc2l0aW9uUmVzcG9uc2UgY2xpZW50T3JkZXJJZD0iMTI5MTExNjIzNDUy<font></font>
OCIgc3RhdHVzPSIwIi6789Jvcj0iMCIgcHJvY2Vzc2VkRFQ9IjIwMTAtMTEtMzBU<font></font>
MTE6MjM6NTQuNjI0WiIgYmFsYW5jZT0iNTQxNDYuNzMiIC8+DQoAAAAAAAAxggF8<font></font>
MIIBeAIBATB3MGoxCzAJBgNVBAYTAlJVMQ8wDQYDVQQIEwZSdXNzaWExFjAUBgNV<font></font>
BAcTDVN0LlBldGVyc2J1cmcxITAfBgNVBAoTGEludGVybmV0IFdpZGdpdHMgUHR5<font></font>
IEx0ZDEPMA0GA1UEAxMGc2VydmVyAgkAy2xbdQckXjIwCQYFKw4DAhoFAKBdMBgG<font></font>
CSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTEwMTEzMDEx<font></font>
MjM1NVowIwYJKoZIhvcNAQkEMRYEFEYNh8glwqIXGR/n6oYrApa8DaO5MA0GCSqG<font></font>
SIb3DQEBAQUABIGAHlgGsYK30RXWBvuQao0V73KIPQE1A6BCg7Y6Iag/xlmZ3rBB<font></font>
kFpszF/O2fB+t84pCHfV15ErZQEkAqIotkEYEgA3hAddEW5+RWUzp+3npHpW5OY7<font></font>
h3niP5Pj+r0P8EDgHe2j0Zb3dzj2mbwOshZD+FP1IcR8AmiTV3u35C6KAEsAAAAA<font></font>
AAA=<font></font>
——-END PKCS7——-</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして払い戻し自体のリクエスト：</font></font><br>
<pre><code class="plaintext hljs">&lt;returnPaymentRequest<font></font>
clientOrderId="46890"<font></font>
requestDT="2011-07-02T20:38:00.000Z"<font></font>
invoiceId="2000000433"<font></font>
shopId="6689"<font></font>
amount="10.00"<font></font>
currency="643"<font></font>
cause="   "<font></font>
/&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいバージョンのAPIでは、Pythonでの払い戻しは次のようになります。</font></font><br>
<pre><code class="plaintext hljs">refund = Refund.create({<font></font>
 &nbsp;&nbsp;&nbsp;"amount": {<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"value": "2.00",<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"currency": "RUB"<font></font>
 &nbsp;&nbsp;&nbsp;},<font></font>
 &nbsp;&nbsp;&nbsp;"payment_id": "21741269-000d-50be-b000-0486ffbf45b0"<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明確なJSONが返され、最小限の時間で何でも解析できます。</font></font><br>
<pre><code class="json hljs">{
 &nbsp;&nbsp;&nbsp;<span class="hljs-attr">"id"</span>: <span class="hljs-string">"216742f7-0016-50be-b000-078a43a63ae4"</span>,
 &nbsp;&nbsp;&nbsp;<span class="hljs-attr">"status"</span>: <span class="hljs-string">"succeeded"</span>,
 &nbsp;&nbsp;&nbsp;<span class="hljs-attr">"amount"</span>: {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">"value"</span>: <span class="hljs-string">"2.00"</span>,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">"currency"</span>: <span class="hljs-string">"RUB"</span><font></font>
 &nbsp;&nbsp;&nbsp;},<font></font>
 &nbsp;&nbsp;&nbsp;<span class="hljs-attr">"created_at"</span>: <span class="hljs-string">"2017-10-04T19:27:51.407Z"</span>,
 &nbsp;&nbsp;&nbsp;<span class="hljs-attr">"payment_id"</span>: <span class="hljs-string">"21746789-000f-50be-b000-0486ffbf45b0"</span>
 &nbsp;}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
美しさ。 </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.さまざまな言語とテクノロジーのサポート</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいAPIには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モバイルデバイス用のSDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、PHP、Python、Node.js </font><font style="vertical-align: inherit;">も含まれてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。バックエンド担当者が何をするにせよ（非常にエキゾチックな場合を除いて）、キャッシャーを介した支払いはすぐにつながります。数か月以上Pythonで積極的に書いている人は、統合に対処します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
昨年、iOSおよびAndroid上のモバイルアプリケーション用のライブラリをリリースしました。その助けを借りて、支払いフォームはアプリケーションに埋め込まれ、その一部のように見えます（WebViewはありません）。ユーザーは、Yandex.Moneyウォレットから、Google Pay、Apple Pay、またはSberbank Onlineを通じてクレジットカードで支払うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それも簡単に実装されています-開発者に指示を与えると、すぐにそれがどれほど素晴らしいものになるかがわかります。</font><font style="vertical-align: inherit;">モバイルSDKがあなたとあなたのモバイルアプリケーションのユーザーの幸せのレベルをどのように向上させるかについては、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハブログに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでに詳しく書いています</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.シャーマニズムのない定期的な支払い</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストールと構成の直後に、資金の事前承認を伴うカード支払いが発生します-それらはデフォルトでAPIに組み込まれています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
定期的な支払い（カードとウォレットの両方）があります。それらはセキュリティサービスと調整する必要がありますが、古いプロトコルでは同じでした。</font><font style="vertical-align: inherit;">定期的な支払いで必須の3D-Secureが使用されているカードを使用する場合、新しいAPIはまずそのカードへのリンクを返します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、すべてが簡単になりました-ここでも、MWSで長い儀式を実行し、証明書や他のすべての暗号通貨を取得する必要はありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.支払いステータスの変更の自動通知</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前は、各支払いのステータスを手動で確認する必要がありましたが、変更された場合、開発者は自動的に通知を受け取ります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API v3に組み込まれている支払いステータスの自動通知には4つのタイプがあります。</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「支払い後、商人による確認を待っています」、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「有料」</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「支払い中にキャンセルまたはエラーが発生しました」、</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「支払いが返されました。」</font></font><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いプロトコルでは、注文のリストとプロパティを表示する、このための複雑なMWSメソッドlistOrdersを作成する必要がありました。</font><font style="vertical-align: inherit;">12個のパラメーター、要求を送信する複雑なロジック、およびCSV形式で応答を受信する興味深い機会：</font></font><br>
<br>
<pre><code class="plaintext hljs">status=0;error=0;processedDT=2011-08-02T14:46:58.096+03:00;orderCount=2<font></font>
shopId;shopName;articleId;articleName;invoiceId;orderNumber;paymentSystemOrderNumber;customerNumber;createdDatetime;paid;orderSumAmount;<font></font>
orderSumCurrencyPaycash;orderSumBankPaycash;paidSumAmount;paidSumCurrencyPaycash;paidSumBankPaycash;receivedSumAmount;receivedSumCurrencyPaycash;<font></font>
receivedSumBankPaycash;shopSumAmount;shopSumCurrencyPaycash;shopSumBankPaycash;paymentDatetime;paymentAuthorizationTime;payerCode;payerAddress;payeeCode;<font></font>
paymentSystemDatetime;avisoReceivedDatetime;avisoStatus;paymentType;agentId;uniLabel;environment<font></font>
1;" ";2;"-";2000024717776;"2011.08.02 09:07:32";483512879684006008;97881;2011-08-02T08:07:59.148+03:00;true;10.15;643;1003;10.15;643;<font></font>
1003;10.15;643;1003;10.15;643;1003;2011-08-02T08:07:59.684+03:00;483512879684006008;41003476047679;192.168.1.127;41003131475668;2011-08-02T08:07:59.684+03:00;<font></font>
2011-08-02T08:07:59.660+03:00;1000;AC;200002;1cd12967-0001-5000-8000-000000034fd8;Live<font></font>
1;" ";2;"-";2000024717780;2000024717780;483512937773006008;770367;2011-08-02T08:08:57.175+03:00;true;10.00;643;1003;10.00;643;<font></font>
1003;10.00;643;1003;10.00;643;1003;2011-08-02T08:08:57.773+03:00;483512937773006008;41003494819180;192.168.1.127;41003131475668;2011-08-02T08:08:57.773+03:00;<font></font>
2011-08-02T08:08:57.730+03:00;1000;AC;200002;1cd129a4-0001-5000-8000-000000034fe1;Live</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいバージョンではそうです。</font><font style="vertical-align: inherit;">問い合わせ：</font></font><br>
<pre><code class="plaintext hljs">curl https://payment.yandex.net/api/v3/payments/{payment_id} \ -u &lt; &gt;:&lt; &gt;<font></font>
: <font></font>
{<font></font>
 &nbsp;"id": "22312f66-000f-5100-8000-18db351245c7",<font></font>
 &nbsp;"status": "waiting_for_capture",<font></font>
 &nbsp;"paid": true,<font></font>
 &nbsp;"amount": {<font></font>
 &nbsp;&nbsp;&nbsp;"value": "2.00",<font></font>
 &nbsp;&nbsp;&nbsp;"currency": "RUB"<font></font>
 &nbsp;},<font></font>
 &nbsp;"created_at": "2018-07-18T10:51:18.139Z",<font></font>
 &nbsp;"description": " №72",<font></font>
 &nbsp;"expires_at": "2018-07-25T10:52:00.233Z",<font></font>
 &nbsp;"metadata": {},<font></font>
 &nbsp;"payment_method": {<font></font>
 &nbsp;&nbsp;&nbsp;"type": "bank_card",<font></font>
 &nbsp;&nbsp;&nbsp;"id": "22ebbf66-000f-5000-8000-18db351245c7",<font></font>
 &nbsp;&nbsp;&nbsp;"saved": false,<font></font>
 &nbsp;&nbsp;&nbsp;"card": {<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"first6": "555555",<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"last4": "4444",<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"card_type": "MasterCard"<font></font>
 &nbsp;&nbsp;&nbsp;},<font></font>
 &nbsp;&nbsp;&nbsp;"title": "Bank card *4444"<font></font>
 &nbsp;},<font></font>
 &nbsp;"test": false<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.エラーが発生した時点がすぐにわかる</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
支払いが失敗した場合、「何かがうまくいかなかった」のではなく、新しいAPIが原因を明らかにします。たとえば、カードが不足しているか、ユーザーがSberbank Online経由で支払いたいのですが、接続されていませんでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時々、「何かがうまくいかなかった」という短期間があるかもしれません-もちろん、私たちは彼らと戦います（編集長のナターシャが私にうなずいて親指を示します）が、異なるバンク間のエラーマッピングの違いやソフトウェアの予期しない動作を予測すること無理だよ。</font><font style="vertical-align: inherit;">私たちにも。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、支払いがキャンセルされた場合、APIの応答からすぐに明確になります。</font></font><br>
<pre><code class="plaintext hljs">{<font></font>
 &nbsp;"id": "22379b7b-000f-5000-9030-1a603a795739",<font></font>
 &nbsp;"status": "canceled",<font></font>
 &nbsp;"paid": false,<font></font>
 &nbsp;"amount": {<font></font>
 &nbsp;&nbsp;&nbsp;"value": "2.00",<font></font>
 &nbsp;&nbsp;&nbsp;"currency": "RUB"<font></font>
 &nbsp;},<font></font>
 &nbsp;"created_at": "2018-05-23T15:24:43.812Z",<font></font>
 &nbsp;"metadata": {},<font></font>
 &nbsp;"payment_method": {<font></font>
 &nbsp;&nbsp;&nbsp;"type": "bank_card",<font></font>
 &nbsp;&nbsp;&nbsp;"id": "22977a7b-000f-5000-9000-1a603a795129",<font></font>
 &nbsp;&nbsp;&nbsp;"saved": false<font></font>
 &nbsp;},<font></font>
 &nbsp;"recipient": {<font></font>
 &nbsp;&nbsp;&nbsp;"account_id": "100001",<font></font>
 &nbsp;&nbsp;&nbsp;"gateway_id": "1000001"<font></font>
 &nbsp;},<font></font>
 &nbsp;"test": false,<font></font>
 &nbsp;"cancellation_details": {<font></font>
 &nbsp;&nbsp;&nbsp;"party": "payment_network",<font></font>
 &nbsp;&nbsp;&nbsp;"reason": "payment_method_restricted"<font></font>
 &nbsp;}<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.始める前にすべてを確認できます</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストキーを取得してすべてがどのように機能するかを確認するには、Yandex.Cashアカウントに登録する必要があります。これには、Yandexのユーザー名と会社TINが必要です。アンケートで、自己登録を選択します。1分以内にテスト回路が作成され、支払いの状況を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この機能を開始する前は</font><font style="vertical-align: inherit;">、Insomnia RESTクライアントを使用してAPI v3を試すことができる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト環境</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり</font><font style="vertical-align: inherit;">ました。クレジットカードによる支払いの例があり、どの要求が送信され、どの応答が返され、データ交換プロセスのすべての段階で何が発生するかが明確に示されています。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3f4/4b4/85b/3f44b485b5bab915a49f1589344a3b7d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
統合とメンテナンスのすべての段階で、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロシア語</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">英語の</font></a><font style="vertical-align: inherit;">段階的なガイドが</font><font style="vertical-align: inherit;">あります</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">言語、さらに詳細な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIリファレンス</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的には、新しいAPIに切り替えます（まだ行っていない場合）。または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Yandex.Checkoutに接続します</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -すべての準備が整っています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453162/index.html">骨董品：ThinkPad 380E、Economy 90s、Windows 95</a></li>
<li><a href="../ja453164/index.html">暗号トークンPKCS＃11。「タイムスタンプに署名して追加する機能を備えた」グラフィックユーティリティ。パート1</a></li>
<li><a href="../ja453166/index.html">ViewPagerをiOSスタイルのアニメーションでフラグメントマネージャーに変える</a></li>
<li><a href="../ja453168/index.html">研究：ゲーム理論を使用したブロッキングプロキシサービスの作成</a></li>
<li><a href="../ja453170/index.html">ブレーンストーミング：タスクを別の角度から見る方法</a></li>
<li><a href="../ja453178/index.html">コードを改善する開発者の主なスキル</a></li>
<li><a href="../ja453182/index.html">あなたのポケットの中の全世界、または数日でモバイルカードを作る方法</a></li>
<li><a href="../ja453188/index.html">非IT管理者にフォールトトレラントITインフラストラクチャを構築する原則を説明する方法</a></li>
<li><a href="../ja453192/index.html">プロセスの同期と非同期</a></li>
<li><a href="../ja453194/index.html">PHDays 9でBest Reverser問題を解決します</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>