<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✝️ 🗯️ 🚬 Powershellホストの可用性の監視 🤦🏽 🆚 🤵🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは。私は簡単な指示を共有したいと思います。登録とSMSなし！
 
 インターネットの広大さから
 
 重要：私はプログラマーでもシステム管理者でもありませんが、大量のサーバーとサービスと同時に作業する必要があり、私は自分の便宜のためにこのスクリプトを書きました。
 
 これが便利で興味がある...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Powershellホストの可用性の監視</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463777/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは。私は簡単な指示を共有したいと思います。</font><font style="vertical-align: inherit;">登録とSMSなし！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/il/za/2pilzao3cmanplkez6dtrphvotg.jpeg"></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターネットの広大さから</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：私はプログラマーでもシステム管理者でもありませんが、大量のサーバーとサービスと同時に作業する必要があり、私は自分の便宜のためにこのスクリプトを書きました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">便利で</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">興味</font><font style="vertical-align: inherit;">があると思うすべての人に</font><font style="vertical-align: inherit;">、私は猫の下で尋ねます。</font></font><br>
<hr><a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜPowershellなのか</font></font></b><div class="spoiler_text"><i>        Python,      ,     .exe, ,       .     Powershell    .</i><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰もがコンソール/端末を愛しているわけではない</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは矛盾ではないと思います。そうでないと、誰もが引き続きコンソールメールクライアントを使用し、GUIが* nix-systemsに表示されません。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
日常生活ではPowershellをかなり原始的に使用する必要があるため、最初に、GUIをそれに固定できるかどうかを理解しようとしました。</font><font style="vertical-align: inherit;">それはあなたができること、そしてかなり簡単なことさえわかります：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pf/h3/d-/pfh3d-h85oekprcwuu0dzdesxfu.png"></div><br>
<pre><code class="plaintext hljs">Add-Type -assembly System.Windows.Forms # <font></font>
$main_form = New-Object System.Windows.Forms.Form #    ""<font></font>
<font></font>
#   <font></font>
$main_form.Text ='Links up' #  <font></font>
$main_form.Width = 300 # <font></font>
$main_form.Height = 200 # <font></font>
$main_form.AutoSize = $true #     ,  <font></font>
$main_form.ShowDialog() # ""<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに出力要素を追加して、基本的なWindwows </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トートロジー</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウを取得します</font><s><font style="vertical-align: inherit;">か？</font></s><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/66/md/en/66mdenqsxhgccqee_sxl1zx7bb0.png"></div><br>
<pre><code class="plaintext hljs">Add-Type -assembly System.Windows.Forms # <font></font>
<font></font>
$main_form = New-Object System.Windows.Forms.Form #    ""<font></font>
<font></font>
#     <font></font>
$main_form.Text ='Links up' #  <font></font>
$main_form.Width = 300 # <font></font>
$main_form.Height = 200 # <font></font>
$main_form.AutoSize = $true #     ,  <font></font>
<font></font>
$Label = New-Object System.Windows.Forms.Label #      ,     ,      Powershell<font></font>
$Label.Text = "!   Windows-,    ?" # <font></font>
$Label.Location  = New-Object System.Drawing.Point(10,65) #        (x,y)<font></font>
$Label.AutoSize = $true <font></font>
<font></font>
$main_form.Controls.Add($Label) #    ,       <font></font>
<font></font>
$main_form.ShowDialog() #   </code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スピーカーを追加</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、「Yandexにpingを実行」して* .isoをマウントしたツールは、個別のGUIを取得しましたが、これでは不十分です。</font><font style="vertical-align: inherit;">同様に、アクセシビリティに関する情報を表示できますが、監視のために毎回スクリプトを再起動する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、2つのアイコンを描画し、画像を表示する機能を追加します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/40/xh/sh40xhgqonwm5nvdqqh0jtinzmu.png"></div><br>
<pre><code class="plaintext hljs">$PictureBox = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox.width = 10<font></font>
$PictureBox.height = 10<font></font>
$PictureBox.location = New-Object System.Drawing.Point(178,12)<font></font>
<font></font>
#               <font></font>
#&lt;b&gt;test-connection&lt;/b&gt;, :<font></font>
#-Count -  - <font></font>
#-computer - IP     <font></font>
#-quiet -       Boolean <font></font>
if ((test-connection -Count 1 -computer ya.ru -quiet) -eq $True) {<font></font>
	$PictureBox.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$main_form.Controls.Add($PictureBox)<font></font>
</code></pre><br>
<s><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここでも、DNSニックネームはいたずらです...</font></font></i></s><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m2/ij/-f/m2ij-fy3dqgd-s31avukhhzky6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、測定値を更新できるようにボタンを追加します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hu/90/_-/hu90_-mdwepm_j3ckujjlre1xo8.png"></div><br>
<pre><code class="plaintext hljs">$Button = New-Object System.Windows.Forms.Button<font></font>
$Button.Location = New-Object System.Drawing.Size(100,150) <font></font>
$Button.Size = New-Object System.Drawing.Size(80,30)<font></font>
$Button.Text = "Reload"<font></font>
<font></font>
#        PictureBox    <font></font>
$Button.Add_Click({ <font></font>
	if ((Test-Connection -Count 1 -computer ya.ru -quiet) -eq $True)<font></font>
		{$PictureBox.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox.imageLocation	= "C:\Test\no.png"}<font></font>
	  <font></font>
	if ((Test-Connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True)<font></font>
		{$PictureBox1.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox1.imageLocation	= "C:\Test\no.png"}<font></font>
 	})<font></font>
<font></font>
$main_form.Controls.Add($Button)<font></font>
</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k_/7q/_l/k_7q_lipmrun-isgcadlcfpi2ue.gif"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すばらしい、今生産中！</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font></s></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手動で約6のホストを処方したところ、私は突然1つのことに気づきました-しかし、このプロジェクトは終了し、ホストは変更され、毎回スクリプトを編集する必要があります。</font><font style="vertical-align: inherit;">一方で、それは大丈夫です、それはあなた自身のための同じ決定です。</font><font style="vertical-align: inherit;">一方、</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは愛するあなた自身のための決定</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です、何が起こるかを見てください：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スペクタクルは気弱な人には向かない</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">Add-Type -assembly System.Windows.Forms # <font></font>
<font></font>
$main_form = New-Object System.Windows.Forms.Form #    ""<font></font>
<font></font>
#     <font></font>
$main_form.Text ='Links up' #  <font></font>
$main_form.Width = 300 # <font></font>
$main_form.Height = 200 # <font></font>
$main_form.AutoSize = $true #     ,  <font></font>
<font></font>
$Label = New-Object System.Windows.Forms.Label #      ,     ,      Powershell<font></font>
$Label.Text = "ya.ru		............................" #  <font></font>
$Label.Location  = New-Object System.Drawing.Point(15,10) #        (x,y)<font></font>
$Label.AutoSize = $true <font></font>
<font></font>
$Label1 = New-Object System.Windows.Forms.Label #      ,     ,      Powershell<font></font>
$Label1.Text = "8.8.8.8		............................" #  googl- DNS-<font></font>
$Label1.Location  = New-Object System.Drawing.Point(15,30) #        (x,y)<font></font>
$Label1.AutoSize = $true <font></font>
<font></font>
$Label2 = New-Object System.Windows.Forms.Label<font></font>
$Label2.Text = "192.168.x.x	............................"<font></font>
$Label2.Location  = New-Object System.Drawing.Point(15,50)<font></font>
$Label2.AutoSize = $true<font></font>
<font></font>
$Label3 = New-Object System.Windows.Forms.Label<font></font>
$Label3.Text = "192.168.x.x	............................"<font></font>
$Label3.Location  = New-Object System.Drawing.Point(15,70)<font></font>
$Label3.AutoSize = $true<font></font>
<font></font>
$Label4 = New-Object System.Windows.Forms.Label<font></font>
$Label4.Text = "10.0.x.x	 ............................"<font></font>
$Label4.Location  = New-Object System.Drawing.Point(15,90)<font></font>
$Label4.AutoSize = $true<font></font>
<font></font>
$Label5 = New-Object System.Windows.Forms.Label<font></font>
$Label5.Text = "162.102.x.x	 ............................"<font></font>
$Label5.Location  = New-Object System.Drawing.Point(15,110)<font></font>
$Label5.AutoSize = $true<font></font>
<font></font>
$PictureBox = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox.width = 10<font></font>
$PictureBox.height = 10<font></font>
<font></font>
#               <font></font>
#&lt;b&gt;test-connection&lt;/b&gt;, :<font></font>
#-Count -  - <font></font>
#-computer - IP     <font></font>
#-quiet -       Boolean <font></font>
$PictureBox.location = New-Object System.Drawing.Point(235,12)<font></font>
if ((test-connection -Count 1 -computer ya.ru -quiet) -eq $True) {<font></font>
	$PictureBox.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$PictureBox1 = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox1.width = 10<font></font>
$PictureBox1.height = 10<font></font>
$PictureBox1.location = New-Object System.Drawing.Point(235,32)<font></font>
if ((test-connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True) {<font></font>
	$PictureBox1.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox1.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox1.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$PictureBox2 = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox2.width = 10<font></font>
$PictureBox2.height = 10<font></font>
$PictureBox2.location = New-Object System.Drawing.Point(235,52)<font></font>
if ((test-connection -Count 1 -computer 192.168.x.x -quiet) -eq $True) {<font></font>
	$PictureBox2.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox2.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox2.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$PictureBox3 = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox3.width = 10<font></font>
$PictureBox3.height = 10<font></font>
$PictureBox3.location = New-Object System.Drawing.Point(235,72)<font></font>
if ((test-connection -Count 1 -computer 192.168.x.x -quiet) -eq $True) {<font></font>
	$PictureBox3.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox3.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox3.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$PictureBox4 = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox4.width = 10<font></font>
$PictureBox4.height = 10<font></font>
$PictureBox4.location = New-Object System.Drawing.Point(235,92)<font></font>
if ((test-connection -Count 1 -computer 10.0.x.x -quiet) -eq $True) {<font></font>
	$PictureBox4.imageLocation = "C:\Test\yes.png" #     <font></font>
}<font></font>
Else {<font></font>
	$PictureBox4.imageLocation = "C:\Test\no.png" #     <font></font>
}<font></font>
$PictureBox1.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$PictureBox5 = New-Object system.Windows.Forms.PictureBox #      <font></font>
$PictureBox5.width = 10<font></font>
$PictureBox5.height = 10<font></font>
$PictureBox5.location = New-Object System.Drawing.Point(235,112)<font></font>
if ((test-connection -Count 1 -computer 162.102.x.x -quiet) -eq $True) {<font></font>
	$PictureBox5.imageLocation = "C:\Test\yes.png" #     <font></font>
	}<font></font>
Else {<font></font>
	$PictureBox5.imageLocation = "C:\Test\no.png" #     <font></font>
	}<font></font>
$PictureBox5.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
<font></font>
$Button = New-Object System.Windows.Forms.Button<font></font>
$Button.Location = New-Object System.Drawing.Size(100,150) <font></font>
$Button.Size = New-Object System.Drawing.Size(80,30)<font></font>
$Button.Text = "Reload"<font></font>
<font></font>
#        PictureBox    <font></font>
$Button.Add_Click({ <font></font>
	if ((Test-Connection -Count 1 -computer ya.ru -quiet) -eq $True)<font></font>
		{$PictureBox.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox.imageLocation	= "C:\Test\no.png"}<font></font>
	  <font></font>
	if ((Test-Connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True)<font></font>
		{$PictureBox1.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox1.imageLocation	= "C:\Test\no.png"}<font></font>
<font></font>
	if ((Test-Connection -Count 1 -computer 192.168.x.x -quiet) -eq $True)<font></font>
		{$PictureBox2.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox2.imageLocation	= "C:\Test\no.png"}<font></font>
<font></font>
	if ((Test-Connection -Count 1 -computer 192.168.x.x -quiet) -eq $True)<font></font>
		{$PictureBox3.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox3.imageLocation	= "C:\Test\no.png"}<font></font>
<font></font>
	if ((Test-Connection -Count 1 -computer 10.0.x.x -quiet) -eq $True)<font></font>
		{$PictureBox4.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox4.imageLocation	= "C:\Test\no.png"}<font></font>
<font></font>
	if ((Test-Connection -Count 1 -computer 162.102.x.x -quiet) -eq $True)<font></font>
		{$PictureBox5.imageLocation	= "C:\Test\yes.png"}<font></font>
	Else {$PictureBox5.imageLocation	= "C:\Test\no.png"}<font></font>
	})<font></font>
<font></font>
$main_form.Controls.Add($Label) #    ,       <font></font>
$main_form.Controls.Add($Label1)<font></font>
$main_form.Controls.Add($Label2)<font></font>
$main_form.Controls.Add($Label3)<font></font>
$main_form.Controls.Add($Label4)<font></font>
$main_form.Controls.Add($Label5)<font></font>
$main_form.Controls.Add($PictureBox)<font></font>
$main_form.Controls.Add($PictureBox1)<font></font>
$main_form.Controls.Add($PictureBox2)<font></font>
$main_form.Controls.Add($PictureBox3)<font></font>
$main_form.Controls.Add($PictureBox4)<font></font>
$main_form.Controls.Add($PictureBox5)<font></font>
$main_form.Controls.Add($Button)<font></font>
<font></font>
$main_form.ShowDialog() #   <font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
清潔さを守り、構造を忠実に守っていても、定期的な編集は心地よい感覚にはなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、別の関数で可用性チェックを行い、別の変数でディレクトリパスを作成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">$script_path	= "C:\Test\PS ping"<font></font>
<font></font>
#      PictureBox  IP-   .<font></font>
#     .<font></font>
function get_status($PictureBox,$path_ip) {<font></font>
	if ((Test-Connection -Count 1 -computer $path_ip -quiet) -eq $True)<font></font>
		{$PictureBox.imageLocation	= $script_path + "\yes.png"}<font></font>
	Else {$PictureBox.imageLocation	= $script_path + "\no.png"} <font></font>
	}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホストデータを外部のpath.txtファイルに転送し、「ip / host-functional-name /」の形式で書き込み、ドキュメントではそれらを配列に入れます。</font><font style="vertical-align: inherit;">また、Y位置の計算をより自動化します。</font><font style="vertical-align: inherit;">これにより、関数を呼び出してラベルとチェックボックスを作成することができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/bq/f3/obbqf3swvwgscx0u1rfnck1enpo.png"></div><br>
<pre><code class="plaintext hljs">#  ,   :  Label, IP-,      Y<font></font>
Function Create_line($label,$path_ip,$caption, $top){ <font></font>
	$label.Location = New-Object System.Drawing.Point(1, $top)<font></font>
	$label.text = $path_ip+$caption<font></font>
	$label.font = $font<font></font>
	$Label.AutoSize = $true<font></font>
	}<font></font>
#    ,   :  PictureBox, IP-     Y<font></font>
Function Create_link($PictureBox,$path_ip, $top){ <font></font>
	$PictureBox.width	= 10<font></font>
	$PictureBox.height	= 10<font></font>
	$PictureBox.location	= New-Object System.Drawing.Point(210,$top)<font></font>
	get_status -PictureBox $PictureBox -path_ip $path_ip<font></font>
	$PictureBox.SizeMode	= [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
	}<font></font>
<font></font>
$line = Get-content -LiteralPath $script_path"\path.txt" #    <font></font>
$len = $line.Length	# ,      <font></font>
<font></font>
$i = 0<font></font>
<font></font>
#     <font></font>
$ip = @()	# ip<font></font>
$capt = @()	# <font></font>
$Labels =@()	# Label<font></font>
$PictureBoxs =@()	# PictureBox<font></font>
<font></font>
while($i -lt $len){<font></font>
	$f = $line[$i].IndexOf("/") #   <font></font>
	$l = $line[$i].LastIndexOf("/")	#   <font></font>
	$ip += $line[$i].Substring(0,$f)	# ip<font></font>
	$capt += $line[$i].Substring($f+1,$l-$f-1)	# <font></font>
<font></font>
	#  Label<font></font>
	Create_line -label ($label_obj = New-Object System.Windows.Forms.Label) -path_ip $ip[$i] -caption $capt[$i] -top $label_from_top<font></font>
	#  PictureBox<font></font>
	Create_link -PictureBox ($PictureBox_obj = New-Object system.Windows.Forms.PictureBox) -path_ip $ip[$i] -top $label_from_top<font></font>
<font></font>
	$label_from_top += 15	# ""   Y<font></font>
<font></font>
	$Labels	+= $label_obj	#  Label   <font></font>
	$PictureBoxs	+= $PictureBox_obj	#  PictureBox   <font></font>
	$main_form.Controls.Add($Labels[$i])<font></font>
	$main_form.Controls.Add($PictureBoxs[$i])<font></font>
	$i	+=1<font></font>
	}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後のチェックの時間を表示する場所を追加します。便利です。ボタンをクリックしたときのアクションを少し追加します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7c/zt/0v/7czt0vf-_y2yp7fdtd5gpwhejss.png"></div><br>
<pre><code class="plaintext hljs">$Label0	= New-Object System.Windows.Forms.Label<font></font>
$Label0.Text	= Get-Date<font></font>
$Label0.Location	= New-Object System.Drawing.Point(80,180)<font></font>
$Label0.AutoSize	= $true<font></font>
$main_form.Controls.Add($Label0)<font></font>
$Button.Add_Click({ <font></font>
	while($i -lt $len){<font></font>
		get_status -PictureBox $PictureBoxs[$i] -path_ip $ip[$i]<font></font>
		$i +=1<font></font>
		}<font></font>
	$Label0.Text	= Get-Date <font></font>
	})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、バグ</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><s><font style="vertical-align: inherit;">はなく</font></s><font style="vertical-align: inherit;">小さな機能を</font><s><font style="vertical-align: inherit;">追加しました</font></s><font style="vertical-align: inherit;">。これは、アクセスできないホストを検出すると、インジケーターの変化だけでなく、スピーカーからも叫びました。</font></font><br>
<br>
<pre><code class="plaintext hljs">Add-Type -AssemblyName System.Speech<font></font>
$voice	= New-Object System.Speech.Synthesis.SpeechSynthesizer<font></font>
$voice.Rate	= 5<font></font>
$voice.Speak("! !    !")<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ですから、いくつかの装飾を施し、読みやすい</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快適な</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外観にし</font><s><font style="vertical-align: inherit;">てから</font></s><font style="vertical-align: inherit;">、次のようになりました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全なスクリプトコード</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">Add-Type -AssemblyName System.Speech<font></font>
Add-Type -assembly System.Windows.Forms<font></font>
<font></font>
$script_path	= "C:\PS ping"<font></font>
$label_from_top	= 10<font></font>
$voice	= New-Object System.Speech.Synthesis.SpeechSynthesizer<font></font>
$voice.Rate	= 5<font></font>
<font></font>
#      PictureBox  IP-   .<font></font>
#     .<font></font>
function get_status($PictureBox,$path_ip) {<font></font>
	if ((Test-Connection -Count 1 -computer $path_ip -quiet) -eq $True) {<font></font>
		$PictureBox.imageLocation	= $script_path + "\yes.png"<font></font>
		}<font></font>
	Else {<font></font>
		$PictureBox.imageLocation	= $script_path + "\no.png"<font></font>
		$voice.Speak("!  " + $path_ip + ", !")<font></font>
		}<font></font>
	}<font></font>
<font></font>
#  ,   :  Label, IP-,      Y<font></font>
Function Create_line($label,$path_ip,$caption, $top){ <font></font>
	$label.Location	= New-Object System.Drawing.Point(1, $top)<font></font>
	$label.text	= $path_ip+$caption<font></font>
	$label.font	= $font<font></font>
	$Label.AutoSize	= $true<font></font>
	}<font></font>
<font></font>
#    ,   :  PictureBox, IP-     Y<font></font>
Function Create_link($PictureBox,$path_ip, $top){ <font></font>
	$PictureBox.width	= 10<font></font>
	$PictureBox.height	= 10<font></font>
	$PictureBox.location	= New-Object System.Drawing.Point(210,$top)<font></font>
	get_status -PictureBox $PictureBox -path_ip $path_ip<font></font>
	$PictureBox.SizeMode	= [System.Windows.Forms.PictureBoxSizeMode]::zoom<font></font>
	}<font></font>
<font></font>
$main_form	= New-Object System.Windows.Forms.Form<font></font>
$main_form.Text ='Links up' #  <font></font>
$main_form.Width = 300 # <font></font>
$main_form.Height = 200 # <font></font>
$main_form.AutoSize = $true #     ,  <font></font>
$main_form.TopMost	= $true #   ,       <font></font>
<font></font>
$line = Get-content -LiteralPath $script_path"\path.txt" #    <font></font>
$len = $line.Length	# ,      <font></font>
<font></font>
$i = 0<font></font>
<font></font>
#     <font></font>
$ip	= @()	# ip<font></font>
$capt	= @()	# <font></font>
$Labels	=@()	# Label<font></font>
$PictureBoxs	=@()	# PictureBox<font></font>
<font></font>
while($i -lt $len){<font></font>
	$f	= $line[$i].IndexOf("/") #   <font></font>
	$l	= $line[$i].LastIndexOf("/")	#   <font></font>
	$ip	+= $line[$i].Substring(0,$f)	# ip<font></font>
	$capt	+= $line[$i].Substring($f+1,$l-$f-1)	# <font></font>
<font></font>
	#  Label<font></font>
	Create_line -label ($label_obj = New-Object System.Windows.Forms.Label) -path_ip $ip[$i] -caption $capt[$i] -top $label_from_top<font></font>
	#  PictureBox<font></font>
	Create_link -PictureBox ($PictureBox_obj = New-Object system.Windows.Forms.PictureBox) -path_ip $ip[$i] -top $label_from_top<font></font>
<font></font>
	$label_from_top	+= 15	# ""   Y<font></font>
<font></font>
	$Labels	+= $label_obj	#  Label   <font></font>
	$PictureBoxs	+= $PictureBox_obj	#  PictureBox   <font></font>
	$main_form.Controls.Add($Labels[$i])<font></font>
	$main_form.Controls.Add($PictureBoxs[$i])<font></font>
	$i	+=1<font></font>
}<font></font>
<font></font>
#     <font></font>
$Label0	= New-Object System.Windows.Forms.Label<font></font>
$Label0.Text	= Get-Date<font></font>
$Label0.Location	= New-Object System.Drawing.Point(80,180)<font></font>
$Label0.AutoSize	= $true<font></font>
<font></font>
<font></font>
#        PictureBox    <font></font>
$Button	= New-Object System.Windows.Forms.Button<font></font>
$Button.Location	= New-Object System.Drawing.Size(100,200)<font></font>
$Button.Size	= New-Object System.Drawing.Size(80,30)<font></font>
$Button.Text	= "Reload"<font></font>
<font></font>
$Button.Add_Click({ <font></font>
	while($i -lt $len){<font></font>
		get_status -PictureBox $PictureBoxs[$i] -path_ip $ip[$i]<font></font>
		$i	+=1<font></font>
		}<font></font>
	$i	= 0<font></font>
	$Label0.Text	= Get-Date <font></font>
})<font></font>
<font></font>
$main_form.Controls.Add($Button)<font></font>
$main_form.Controls.Add($Label0)<font></font>
<font></font>
$main_form.ShowDialog()<font></font>
</code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あとがき</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は誰かがこのチュートリアルが役立つことを願っています。</font><font style="vertical-align: inherit;">クレードルからほとんどこれをしたなら、おめでとう、私はしませんでした。</font><font style="vertical-align: inherit;">しかし、私はあなたのコメントや提案を聞く準備ができています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私にとっては、このような小さいながらも日常生活で役立つユーティリティを掘り下げて収集できて良かったです。</font><font style="vertical-align: inherit;">計画では、GUIからのノードの追加と削除を</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する必要があります。また、ボタンを「突く」必要がなく、「powershell.exe」がハングしないように、</font><s><font style="vertical-align: inherit;">主に</font></s><font style="vertical-align: inherit;">自動ステータス更新を</font><s><font style="vertical-align: inherit;">実装</font></s><font style="vertical-align: inherit;">するの</font><s><font style="vertical-align: inherit;">と同じことを行う</font></s><font style="vertical-align: inherit;">必要があります。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">GitHub</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
のスクリプトの最新バージョン</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja463765/index.html">Slurm DevOps：DevOpsの哲学について議論しない理由と代わりに何が起こるか</a></li>
<li><a href="../ja463769/index.html">Mitap Netologii「データサイエンスのキャリア：初心者から中級者まで」</a></li>
<li><a href="../ja463771/index.html">[ピーター]セバスチャンダシュナーとJUG.ruとの出会い-エンタープライズテストの作成をより楽しくする</a></li>
<li><a href="../ja463773/index.html">情報からの子供の保護の仕組み-そしてそれが最初にどこから来たのかについての魅惑的な物語（18+）</a></li>
<li><a href="../ja463775/index.html">誰がSAML 2.0認証プロトコルを使用するか</a></li>
<li><a href="../ja463781/index.html">AndroidアーキテクチャのZen分離コンポーネント</a></li>
<li><a href="../ja463785/index.html">端末エミュレーターの概要</a></li>
<li><a href="../ja463787/index.html">HPの大きな古い驚き</a></li>
<li><a href="../ja463789/index.html">Swiftにおけるジェネリックの力。パート2</a></li>
<li><a href="../ja463791/index.html">アイアングリップ：ジオメトリと表面テクスチャに応じた鳥の着陸の運動学</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>