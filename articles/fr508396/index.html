<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçü§ù‚Äçüë®üèº üë©üèº üë©üèΩ‚Äçü§ù‚Äçüë®üèº Transfert de dynamique mol√©culaire √† CUDA. Partie I: Les bases üí∂ üëÉüèª ‚õΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le but de cet article est de soulever les questions de la parall√©lisation du code d'un programme de mod√©lisation num√©rique utilisant la m√©thode de la ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Transfert de dynamique mol√©culaire √† CUDA. Partie I: Les bases</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/508396/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le but de cet article est de soulever les questions de la parall√©lisation du code d'un programme de mod√©lisation num√©rique utilisant la m√©thode de la dynamique mol√©culaire (MD) utilisant la technologie CUDA. Pourquoi est-ce n√©cessaire, car les progiciels MD existent d√©j√†, y compris ceux qui fonctionnent sur CUDA? Le fait est que je d√©veloppe mon propre concept de ¬´champ de force non constant¬ª, qui n'est pas mis en ≈ìuvre dans les programmes de DM existants. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Refaire le code de quelqu'un d'autre pour ces besoins est une t√¢che plut√¥t ingrate, j'ai donc d√©cid√© de transf√©rer mon code s√©quentiel d√©j√† √©crit et en m√™me temps de partager quelques r√©flexions. De plus, c'est une r√©ponse au commentaire qui scintille souvent ici sur des articles de CUDA comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">celui-ci</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, quelle est la dynamique mol√©culaire? </font><font style="vertical-align: inherit;">Sur Habr√© il y a d√©j√† plusieurs articles sur ce sujet, par exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En bref, MD est une m√©thode qui vous permet de simuler le mouvement de nombreuses particules (y compris les atomes, les ions, les mol√©cules) et de calculer les propri√©t√©s collectives du syst√®me, en fonction de ce mouvement. </font><font style="vertical-align: inherit;">Comment √ßa fonctionne? </font><font style="vertical-align: inherit;">Supposons pour un ensemble de N particules des coordonn√©es initiales, des vitesses, des masses et (plus important!) Des lois d'interaction entre elles. </font><font style="vertical-align: inherit;">Nous changeons les coordonn√©es en fonction des vitesses. </font><font style="vertical-align: inherit;">Sur la base des lois d'interaction, nous calculons les forces agissant entre les particules. </font><font style="vertical-align: inherit;">Puisque nous connaissons la force et la masse, nous connaissons l'acc√©l√©ration. </font><font style="vertical-align: inherit;">Nous ajustons la vitesse en tenant compte de l'acc√©l√©ration. </font><font style="vertical-align: inherit;">Et encore une fois, nous passons √† changer les coordonn√©es. </font><font style="vertical-align: inherit;">Et donc nous r√©p√©tons mille fois jusqu'√† </font><s><font style="vertical-align: inherit;">ce</font></s><font style="vertical-align: inherit;"> que </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous soyez fatigu√©</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous n‚Äôobtiendrons pas suffisamment de statistiques.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/getpro/habr/post_images/d14/4f3/4f0/d144f34f09888282c2118202bc8d201a.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les applications r√©elles, la s√©quence de calculs de la ¬´coordonn√©e - vitesse - force¬ª est un peu plus compliqu√©e, bas√©e sur l'expansion des fonctions de coordonn√©es des particules dans une s√©rie. Le plus courant est l'algorithme de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocity Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le pseudocode du programme MD bas√© sur l'int√©grateur Verlet est le suivant:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">init_md;
<span class="hljs-keyword">int</span> iStep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (iStep &lt; nStep)<font></font>
{<font></font>
    reset_quantities;<font></font>
    clear_cell_list;<font></font>
    verlet_1stage;<font></font>
    forces_calculation;<font></font>
    verlet_2stage;<font></font>
    temp_scale;<font></font>
    termostat;<font></font>
    some_output;<font></font>
    iStep++;<font></font>
}<font></font>
final_md; <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La boucle de programme principale ex√©cute un nombre de fois sp√©cifi√© par l'utilisateur ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nStep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Une it√©ration de cette boucle est appel√©e un pas de temps, ou simplement un pas de temps. Les fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INIT_MD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some_output</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">final_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne seront pas prises en compte, elles lisent les informations d'entr√©e, les valeurs </font><i><font style="vertical-align: inherit;">mises √† </font></i><i><font style="vertical-align: inherit;">z√©ro</font></i><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">sortent</font></i><font style="vertical-align: inherit;"> les donn√©es, allouent et lib√®rent de la m√©moire, etc. Du point de vue de la sortie d'informations, la dynamique mol√©culaire est id√©ale pour les calculs sur une carte vid√©o: la plupart des calculs n'ont pas besoin d'√™tre d√©charg√©s. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_2stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se rapportent √† l'int√©grateur des √©quations de mouvement et de temp√©rature. </font><font style="vertical-align: inherit;">La fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forces_calculation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcule les forces agissant entre les particules, et la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clear_cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fait r√©f√©rence √† la technique d'acc√©l√©ration des calculs (voir plus loin √† ce sujet). </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez tous ces groupes de fonctions.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 Int√©gration d'√©quations de mouvement</font></font></h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'essence de la premi√®re √©tape de l'algorithme de Verlet peut √™tre exprim√©e par les formules suivantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.568ex" height="5.134ex" viewBox="0 -1455.1 9716.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-58" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2B" x="3261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-56" x="4262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-64" x="5031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-74" x="5555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2B" x="6138" y="0"></use><g transform="translate(6917,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-6D" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-64" x="8377" y="0"></use><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-32" x="511" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>X</mi><mo>=</mo><mi>X</mi><mo>+</mo><mi>V</mi><mi>d</mi><mi>t</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">X = X + Vdt + \frac{F}{m}dt^2</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2E" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">V = V + \frac{F}{m}\frac{dt}{2}. </script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seconde:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.928ex" height="5.134ex" viewBox="0 -1455.1 6858 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-3D" x="1047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-56" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2B" x="3095" y="0"></use><g transform="translate(3873,0)"><g transform="translate(342,0)"><rect stroke="none" width="998" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-46" x="124" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-6D" x="60" y="-686"></use></g></g><g transform="translate(5334,0)"><g transform="translate(120,0)"><rect stroke="none" width="1005" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-74" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-32" x="252" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2C" x="6579" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>V</mi><mo>=</mo><mi>V</mi><mo>+</mo><mfrac><mi>F</mi><mi>m</mi></mfrac><mfrac><mrow><mi>d</mi><mi>t</mi></mrow><mn>2</mn></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">V = V + \frac{F}{m}\frac{dt}{2},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o√π X est la coordonn√©e des particules, V est sa vitesse, F est la force qui agit sur elle, m est sa masse et dt est le pas de temps. </font><font style="vertical-align: inherit;">Tout cela s'applique √† toutes les particules et, naturellement, se produit en 3 dimensions, donc:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_1stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i, t
  <span class="hljs-keyword">float</span> charge;
  <span class="hljs-keyword">float</span> engElecField = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//     </span>
  __shared__ <span class="hljs-keyword">float</span> shEngElField;	<span class="hljs-comment">// shared   </span><font></font>
<font></font>
  <span class="hljs-comment">//    shared </span>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shEngElField = <span class="hljs-number">0</span>;<font></font>
    __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//   ,     </span>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
<font></font>
     t = md-&gt;types[i];<font></font>
     charge = md-&gt;specs[t].charge;<font></font>
<font></font>
     <span class="hljs-comment">//  v = v + f/m * 0.5 dt</span><font></font>
     md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
     md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
     md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
     <span class="hljs-comment">// x = x + v * dt</span><font></font>
     md-&gt;xyz[i].x += md-&gt;vls[i].x * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].y += md-&gt;vls[i].y * md-&gt;tSt;<font></font>
     md-&gt;xyz[i].z += md-&gt;vls[i].z * md-&gt;tSt;<font></font>
<font></font>
     put_periodic(&amp;md-&gt;xyz[i], md-&gt;vls[i], md-&gt;masses[i], md-&gt;types[i], md);<font></font>
<font></font>
     keep_in_cell(i, md-&gt;xyz[i], md);<font></font>
<font></font>
     <span class="hljs-comment">//   </span>
     engElecField += charge * md-&gt;xyz[i].x * md-&gt;elecField.x; <span class="hljs-comment">// Eng = q * x * dU/dx</span><font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//     shared ‚Ä¶</span><font></font>
  atomicAdd(&amp;shEngElField, engElecField);<font></font>
   __syncthreads();<font></font>
<font></font>
  <span class="hljs-comment">//..    </span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)   <span class="hljs-comment">// 0th thread</span><font></font>
  {<font></font>
      atomicAdd(&amp;md-&gt;engElecField, shEngElField);<font></font>
  }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les param√®tres d'entr√©e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerBlock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atPerTherad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont √©gaux au nombre de particules (atomes) trait√©es par un bloc et un flux, respectivement. </font><font style="vertical-align: inherit;">√âtant donn√© que le nombre d'atomes dans ces calculs est g√©n√©ralement constant, ces variables peuvent √™tre calcul√©es une fois pour toutes quelque part dans la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init_md</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le param√®tre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">type * cudaMD est un lien vers la structure, qui contient des liens vers toutes les variables n√©cessaires au calcul, telles que:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le nombre de particules;</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xyz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un tableau de coordonn√©es de type float3;</font></font></li>
<li><b>vls</b> ‚Äì    float3 (3  );</li>
<li><b>frs </b>‚Äì   ( 3  );</li>
<li> <b>rMasshdT </b>   0.5*dt*m   ;</li>
<li><b>types </b>‚Äì   ,     ;</li>
<li> <b>spec </b>  , ,   ..    i-      <b>spec[types[i]]</b>.</li>
</ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai combin√© tout cela dans une structure afin de ne pas passer un tas de param√®tres dans la fonction. </font><font style="vertical-align: inherit;">Ce n'est peut-√™tre pas la meilleure solution? </font><font style="vertical-align: inherit;">Peut-√™tre que cela valait la peine de les d√©clarer des variables globales? </font><font style="vertical-align: inherit;">Pas dans le sens o√π ils sont dans la m√©moire globale, mais dans le fait qu'ils sont visibles dans toutes les fonctions du programme. </font></font></font><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> discuterons de la </font><font style="vertical-align: inherit;">fonction </font><i><font style="vertical-align: inherit;">keep_in_cell</font></i><font style="vertical-align: inherit;"> dans la section pour acc√©l√©rer les calculs, et la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> place une particule dans un volume simul√© (bo√Æte) si elle s'en √©chappe (comme dans un pacman, comme le dit avec justesse</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans son article sur MD). </font><font style="vertical-align: inherit;">Eh bien, puisque la fonction d√©crite effectue une mise √† jour des coordonn√©es des particules, il est logique de calculer toutes les √©nergies qui ne d√©pendent que des coordonn√©es, par exemple, l'√©nergie des particules dans un champ externe, le cas √©ch√©ant. </font><font style="vertical-align: inherit;">Ci-apr√®s, selon une remarque valable</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, J'ai supprim√© la fonction du code, supprim√© la mise √† z√©ro de variables telles que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engElecField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; engKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset_quantites</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est maintenant s√©lectionn√©e √† ces fins </font><font style="vertical-align: inherit;">. La question sur la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verlet_1stage</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><i><font style="vertical-align: inherit;">la</font></i><font style="vertical-align: inherit;"> suivante: </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certaines variables (coordonn√©es, vitesses, etc.) sont utilis√©es plusieurs fois et est-il conseill√© de les d√©charger d'abord dans une m√©moire plus rapide? Ou le compilateur est-il capable d'optimiser de telles choses lui-m√™me?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">put_periodic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fait en sorte qu'une particule volant hors des fronti√®res de la r√©gion simul√©e (bo√Æte) apparaisse de son autre c√¥t√© (conditions aux limites p√©riodiques):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">put_periodic</span><span class="hljs-params">(float3&amp; xyz, float3 vel, <span class="hljs-keyword">float</span> mass, <span class="hljs-keyword">int</span> type, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">if</span> (xyz.x &lt; <span class="hljs-number">0</span>)<font></font>
   {<font></font>
      xyz.x += md-&gt;leng.x;<font></font>
<font></font>
      atomicAdd(&amp;md-&gt;specAcBoxNeg[type].x, <span class="hljs-number">1</span>); <font></font>
      atomicAdd(&amp;md-&gt;negMom.x, mass * (-vel.x)); <font></font>
   }<font></font>
   <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> (xyz.x &gt;= md-&gt;leng.x)<font></font>
     {<font></font>
        xyz.x -= md-&gt;leng.x;<font></font>
<font></font>
        atomicAdd(&amp;md-&gt;specAcBoxPos[type].x, <span class="hljs-number">1</span>);<font></font>
        atomicAdd(&amp;md-&gt;posMom.x, mass * vel.x);<font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonction fonctionne pour une bo√Æte avec la g√©om√©trie d'une bo√Æte rectangulaire. </font><font style="vertical-align: inherit;">Le code est pour mesurer x, le reste des mesures est compl√®tement similaire. </font><font style="vertical-align: inherit;">Les </font><b><font style="vertical-align: inherit;">champs </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">revLeng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont la taille de la bo√Æte dans la dimension correspondante et sa valeur inverse. </font><font style="vertical-align: inherit;">En g√©n√©ral, pour renvoyer une particule en boxe, vous pouvez vous passer d'op√©rateurs conditionnels:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">xyz.x -= <span class="hljs-built_in">floor</span>(xyz.x * md-&gt;revLeng.x) * md-&gt;leng.x;</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai utilis√© des op√©rateurs conditionnels dans la version s√©rie, car je devais compter le nombre de particules passant par la fronti√®re de la bo√Æte et la quantit√© de mouvement totale de ces particules (la pression peut en √™tre exprim√©e). </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ces compteurs sont √©galement inclus dans le code ci-dessus, peut-√™tre pour CUDA, vous devrez penser √† comment vous en passer</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxi√®me partie de l'int√©grateur de vitesse Verlet:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">verlet_2stage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
  <span class="hljs-keyword">int</span> i;
  <span class="hljs-keyword">float</span> kinE = <span class="hljs-number">0.0</span>;		<span class="hljs-comment">//  </span>
  __shared__ <span class="hljs-keyword">float</span> shKinE;	<span class="hljs-comment">// shared </span><font></font>
<font></font>
 <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
 <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
  <span class="hljs-comment">//     shared </span>
 <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
        shKinE = <span class="hljs-number">0.0</span>;<font></font>
  __syncthreads();<font></font>
<font></font>
<font></font>
  <span class="hljs-comment">// v = v + f/m * 0.5 dt</span>
  <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
  {<font></font>
    md-&gt;vls[i].x += md-&gt;rMasshdT[i] * md-&gt;frs[i].x;<font></font>
    md-&gt;vls[i].y += md-&gt;rMasshdT[i] * md-&gt;frs[i].y;<font></font>
    md-&gt;vls[i].z += md-&gt;rMasshdT[i] * md-&gt;frs[i].z;<font></font>
<font></font>
    <span class="hljs-comment">//  mv2</span><font></font>
    kinE += (md-&gt;vls[i].x * md-&gt;vls[i].x + md-&gt;vls[i].y  * md-&gt;vls[i].y + md-&gt;vls[i].z * md-&gt;vls[i].z) * md-&gt;masses[i];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//      shared memory...</span>
  atomicAdd(&amp;shKinE, <span class="hljs-number">0.5</span> * kinE);   <span class="hljs-comment">// kinE = mv2/2</span><font></font>
  __syncthreads();<font></font>
  <span class="hljs-comment">//...   global memory</span>
  <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     atomicAdd(&amp;md-&gt;engKin, shKinE);<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code de structure est compl√®tement similaire √† la premi√®re partie de l'int√©grateur. Nous mettons √† jour les vitesses de chaque particule, r√©sumons l'√©nergie cin√©tique. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fonctions ¬´ de temp√©rature ¬ª </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp_scale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termostat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les syst√®mes mol√©culaires diff√®rent des syst√®mes m√©caniques en ce qu'ils ont le concept de temp√©rature. MD a h√©rit√© de la d√©finition de la temp√©rature de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la th√©orie mol√©culaire-cin√©tique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o√π la temp√©rature est une valeur proportionnelle √† l'√©nergie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">cin√©tique</font></a><font style="vertical-align: inherit;"> moyenne des particules (il y a des raisons de croire que c'est une erreur). Pour maintenir la temp√©rature souhait√©e en de tels termes, vous pouvez simplement mettre √† l'√©chelle les vitesses des particules, comme le fait la fonction temp_scale:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">temp_scale</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">float</span> k;
   <span class="hljs-keyword">int</span> i;
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   k = <span class="hljs-built_in">sqrt</span>(md-&gt;teKin / md-&gt;engKin);
   <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)<font></font>
   {<font></font>
      md-&gt;vls[i].x *= k;<font></font>
      md-&gt;vls[i].y *= k;<font></font>
      md-&gt;vls[i].z *= k;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
    <span class="hljs-keyword">if</span> (!threadIdx.x)<font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;teKin;<font></font>
     }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le champ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teKin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient l'√©nergie cin√©tique cible, elle est proportionnelle √† la temp√©rature r√©gl√©e par l'utilisateur. La fonction multiplie simplement toutes les composantes des vecteurs vitesse par k, puis un flux d√©finit l'√©nergie cin√©tique √©gale √† la valeur donn√©e. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, la variable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©finie dans chaque thread, bien qu'il soit possible qu'elle doive √™tre d√©finie dans un (car c'est la m√™me) pour ne pas faire de travail inutile, d'autant plus que la racine carr√©e est impliqu√©e.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une telle √©chelle de temp√©rature primitive est g√©n√©ralement utilis√©e dans les √©tapes pr√©liminaires de la simulation (p√©riode d'√©quilibrage) avec une fr√©quence de plusieurs √©tapes. </font><font style="vertical-align: inherit;">Des algorithmes plus sophistiqu√©s de maintien en temp√©rature (thermostats) simulent les collisions de particules avec un certain r√©servoir d'une temp√©rature donn√©e, le plus populaire est le thermostat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nose-Hoover</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">tstat_nose</span><span class="hljs-params">(<span class="hljs-keyword">int</span> atPerBlock, <span class="hljs-keyword">int</span> atPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//   if (!blockIdx.x)</span>
<span class="hljs-comment">//     if (!threadIdx.x)   </span>
<span class="hljs-comment">//        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass;</span>
<span class="hljs-comment">//   __synctreads();</span><font></font>
<font></font>
   <span class="hljs-keyword">float</span> scale = <span class="hljs-number">1.0</span> - md-&gt;tSt * md-&gt;chit;<font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * atPerBlock + threadIdx.x * atPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + atPerThread, md-&gt;nAt);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
       md-&gt;vls[i].x *= scale;<font></font>
       md-&gt;vls[i].y *= scale;<font></font>
       md-&gt;vls[i].z *= scale;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">if</span> (!blockIdx.x)
     <span class="hljs-keyword">if</span> (!threadIdx.x)   <font></font>
     {<font></font>
        md-&gt;engKin = md-&gt;engKin * scale * scale;<font></font>
        md-&gt;consInt += md-&gt;tSt * md-&gt;chit * md-&gt;qMassTau2;<font></font>
        md-&gt;chit += md-&gt;tSt * (md-&gt;engKin - md-&gt;teKin) * md-&gt;rQmass; <font></font>
     }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La diff√©rence avec la fonction pr√©c√©dente ne r√©side que dans une d√©finition plus complexe du facteur de correction. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©sumer ce groupe de fonctions. </font><font style="vertical-align: inherit;">Tous sont parfaitement parall√©lis√©s, non seulement parce qu'ils effectuent exactement les m√™mes actions pour toutes les particules, mais aussi parce qu'ils ne n√©cessitent pas de r√©f√©rences crois√©es. </font><font style="vertical-align: inherit;">Le flux, traitant les tableaux avec l'index i, n'acc√®de pas √† l'index j, il n'y a pas de conflit d'acc√®s aux m√™mes donn√©es.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Calcul des forces et liste des cellules</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les syst√®mes mol√©culaires, la principale source de forces agissant sur la particule (√† l'exception des champs externes d√©j√† mentionn√©s) sont d'autres particules. </font><font style="vertical-align: inherit;">Le calcul de ces forces est la partie la plus complexe, longue et ambigu√´ du DM. </font><font style="vertical-align: inherit;">L'une des approximations les plus simples est que toutes les interactions dans le syst√®me sont la somme des interactions entre chaque paire de particules (approximation par paire). </font><font style="vertical-align: inherit;">√Ä ces fins, un potentiel de paire est introduit - une d√©pendance fonctionnelle de l'√©nergie potentielle d'interaction de deux particules sur la distance entre elles. </font><font style="vertical-align: inherit;">Les potentiels de couple les plus connus: le potentiel de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lennard-Jones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ou ¬´6-12¬ª), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buckingham</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et Born-Mayer-Huggins. </font><font style="vertical-align: inherit;">Par exemple, je donnerai les expressions analytiques des deux premi√®res:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mn>4</mn><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>&amp;#x2212;</mo><mfrac><msup><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>12</mn></mrow></msup></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.901ex" height="5.634ex" viewBox="0 -1616.6 8137.9 2425.9" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-34" x="2101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-3F5" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-28" x="3008" y="0"></use><g transform="translate(3398,0)"><g transform="translate(120,0)"><rect stroke="none" width="1146" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-36" x="810" y="513"></use></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2212" x="5007" y="0"></use><g transform="translate(5785,0)"><g transform="translate(342,0)"><rect stroke="none" width="1500" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-3C3" x="0" y="0"></use><g transform="translate(572,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-32" x="500" y="0"></use></g></g><g transform="translate(120,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-32" x="500" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-29" x="7748" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mn>4</mn><mi>œµ</mi><mo stretchy="false">(</mo><mfrac><msup><mi>œÉ</mi><mn>6</mn></msup><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>‚àí</mo><mfrac><msup><mi>œÉ</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup></mfrac><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">U=4\epsilon(\frac{\sigma^6}{r^6}-\frac{\sigma^{12}}{r^{12}})</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<p></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mi>r</mi><mi>&amp;#x03C1;</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.645ex" height="5.634ex" viewBox="0 -1455.1 9750.1 2425.9" role="img" focusable="false" style="vertical-align: -2.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-3D" x="1045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-41" x="2101" y="0"></use><g transform="translate(3018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-28" x="4548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2212" x="4937" y="0"></use><g transform="translate(5716,0)"><g transform="translate(120,0)"><rect stroke="none" width="637" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-72" x="93" y="676"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-3C1" x="60" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-29" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2212" x="7205" y="0"></use><g transform="translate(7983,0)"><g transform="translate(342,0)"><rect stroke="none" width="1025" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-43" x="132" y="676"></use><g transform="translate(60,-736)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-36" x="638" y="408"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/508396/&amp;usg=ALkJrhhC9r23lMCzpaIpkXbFoGz_LxifRQ#MJMAIN-2C" x="9471" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo>=</mo><mi>A</mi><mi>exp</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mo>‚àí</mo><mfrac><mi>r</mi><mi>œÅ</mi></mfrac><mo stretchy="false">)</mo><mo>‚àí</mo><mfrac><mi>C</mi><msup><mi>r</mi><mn>6</mn></msup></mfrac><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">U=A\exp(-\frac{r}{\rho})-\frac{C}{r^6},</script></p>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o√π U est l'√©nergie potentielle d'une paire de particules, r est la distance entre les particules et toutes les autres lettres sont des param√®tres qui d√©pendent uniquement du type de particules en interaction et sont d√©finis au stade de l'initialisation. </font><font style="vertical-align: inherit;">Cependant, plus encore que l'√©nergie, nous nous int√©ressons aux forces d'interaction entre ces particules. </font><font style="vertical-align: inherit;">Les forces sont triviales, gr√¢ce √† la d√©riv√©e du potentiel de paire, pour laquelle il est √©galement facile d'obtenir une expression analytique et de coudre dans le programme. </font><font style="vertical-align: inherit;">Et, puisque la force d'action est √©gale √† la force de r√©action, nous obtenons imm√©diatement les forces agissant sur les deux particules l'une de l'autre, pseudocode:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">U = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; N; i++)
	<span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; N<span class="hljs-number">-1</span>; j++)<font></font>
	{<font></font>
		dx = x[i] ‚Äì x[j];<font></font>
		dy = y[i] ‚Äì y[j];<font></font>
		dz = z[i] ‚Äì z[j];<font></font>
		r = <span class="hljs-built_in">sqrt</span>(dx*dx + dy*dy + dz*dz);<font></font>
		U += pair_pot(r, types[i], types[j]);<font></font>
		F = force(r, types[i], types[j])<font></font>
		fx[i] = F * dx;<font></font>
		fx[j] = -F * dx;<font></font>
		fy[i] = F * dy;<font></font>
		fy[j] = -F * dy;<font></font>
		fz[i] = F * dz;<font></font>
		fz[j] = -F * dz;<font></font>
<font></font>
	}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code est simple: nous trouvons la distance entre les particules, la substituons dans la fonction pour le potentiel de la paire et dans la fonction pour la force (les deux d√©pendent des types de particules en interaction) et calculons les projections des forces. Le cycle est effectu√© N (N-1) / 2 fois, o√π N est le nombre de particules. Pour r√©duire au moins en quelque sorte le nombre de calculs, nous pouvons profiter du fait que la valeur de ces potentiels diminue rapidement avec la distance. √Ä des distances sup√©rieures √† 6-8 angstr√∂ms, le potentiel ne peut pas √™tre calcul√©, il sera presque nul. En ajoutant la condition de v√©rification de la distance (ou plut√¥t de son carr√©) nous r√©duirons le nombre de calculs, mais pas le nombre d'it√©rations du cycle. Pour les grands syst√®mes, la plupart des contr√¥les donneront faux. Les techniques suivantes peuvent r√©duire le nombre de v√©rifications en supprimant une partie des paires avec une grande distance interatomique connue.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux m√©thodes principales pour r√©duire le nombre de recherches de paires de particules: une liste de voisins (aka </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste Verlet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) et une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">liste de cellules</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(liste des cellules). Dans la premi√®re, pour chaque particule, nous nous souvenons de ses voisins qui se trouvent dans le rayon du potentiel. La liste des voisins doit √™tre mise √† jour avec une p√©riodicit√© inconnue, ce qui est l'inconv√©nient de la m√©thode. Par cons√©quent, arr√™tons-nous sur la liste des cellules, dont l'essence est de diviser le volume (bo√Æte) simul√© en (sous) cellules. Initialement, la taille des cellules a √©t√© choisie pour √™tre sup√©rieure ou √©gale au rayon de coupure. Ensuite, il suffit de trier les paires de particules √† l'int√©rieur de chaque cellule et entre les cellules adjacentes. La taille des cellules peut √™tre diff√©rente, l'essentiel est de d√©terminer quelles paires de cellules vous devez v√©rifier. En fait, c'est une tentative de d√©crire la sph√®re en cubes. Traditionnellement, pour impl√©menter une liste de cellules en code s√©quentiel, deux tableaux sont introduits, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">head</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">La taille de la premi√®re est √©gale au nombre de cellules, la seconde au nombre de particules. </font><font style="vertical-align: inherit;">Le premier stocke l'indice d'une des particules dans une cellule donn√©e, les indices de la seconde correspondent aux indices des particules, et le contenu correspond √† l'indice de la particule suivante dans la cellule (-1, s'il n'y a plus de particules dans la cellule), l'illustration est donn√©e ci-dessous. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/tu/bw/hu/tubwhuvbci2oc2uxlupu3nt4zsc.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le pseudo-code pour parcourir une telle liste √† l'int√©rieur d'une cellule avec l'index cell_index:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs">i = head[cell_index];
<span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
{<font></font>
      j = <span class="hljs-built_in">list</span>[i];
      <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
              i-j;<font></font>
           j = <span class="hljs-built_in">list</span>[j];<font></font>
      }<font></font>
i = <span class="hljs-built_in">list</span>[i]; <font></font>
}	<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons maintenant d'impl√©menter une liste de cellules sur CUDA. </font><font style="vertical-align: inherit;">Dans l'approximation z√©ro, nous distribuons simplement une plage de cellules √† chaque flux, sinon, laissant un code s√©quentiel pour √©num√©rer les paires de particules √† l'int√©rieur de la cellule et les paires impliquant des particules de cellules voisines. </font><font style="vertical-align: inherit;">Pour chaque cellule, un tableau de cellules voisines </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lstHNeig [iC] [jC]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le nombre de ces voisins, un tableau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nHeadNeig [],</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doivent √™tre d√©finis </font><font style="vertical-align: inherit;">:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> cellPerBlock, <span class="hljs-keyword">int</span> cellPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iC, jC;	<span class="hljs-comment">//  </span>
   <span class="hljs-keyword">int</span> i, j;	<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * cellPerBlock + threadId.x * cellPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-comment">//   </span>
   <span class="hljs-keyword">for</span> (iC = id0; iC &lt; N; iC++)<font></font>
   {<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         <span class="hljs-comment">//    </span><font></font>
         j = md-&gt;clist[i]; 	<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
               i-j;<font></font>
            j = md-&gt;clist[j];  <font></font>
         }<font></font>
<font></font>
         <span class="hljs-comment">//    </span>
         <span class="hljs-keyword">for</span> (jC = <span class="hljs-number">0</span>; jC &lt; md-&gt;nHeadNeig[iC]; jC++)<font></font>
         {<font></font>
            j = md-&gt;chead[md-&gt;lstHNeig[iC][jC]];<font></font>
            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
            {<font></font>
                  i-j;    <font></font>
               j = md-&gt;clist[j];<font></font>
            }<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä mon avis, une telle impl√©mentation ne r√©v√®le pas pleinement le potentiel d'une carte vid√©o, car un seul flux traite une cellule, ce qui, en r√®gle g√©n√©rale, est nettement inf√©rieur au nombre de particules. Deuxi√®mement, √† l'int√©rieur de la fonction de traitement d'une paire de particules, il n'est possible de travailler que par des op√©rations atomiques. Essayons de parall√©liser la t√¢che plus fortement, laissez chaque thread traiter une paire de cellules voisines (nous pensons qu'une liste de ces paires a d√©j√† √©t√© cr√©√©e):</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list1</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pairPerBlock, <span class="hljs-keyword">int</span> pairPerThread, cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, jC;	<span class="hljs-comment">//     </span>
   <span class="hljs-keyword">int</span> i, j;		<span class="hljs-comment">//  </span><font></font>
<font></font>
   <span class="hljs-keyword">int</span> id0 = blockIdx.x * pairPerBlock + threadId.x * pairPerThread;
   <span class="hljs-keyword">int</span> N = min(id0 + cellPerThread, md-&gt;nCell);<font></font>
<font></font>
   <span class="hljs-keyword">for</span> (iP = id0; iC &lt; N; iP++)<font></font>
   {<font></font>
      iC = md-&gt;cellPairs[iP].x;<font></font>
      jC = md-&gt;cellPairs[iP].y;<font></font>
      i = md-&gt;chead[iC];<font></font>
<font></font>
      <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>)<font></font>
      {<font></font>
         j = md-&gt;chead[jC];<font></font>
         <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>)<font></font>
         {<font></font>
                i-j;<font></font>
             j = md-&gt;clist[j];<font></font>
         }<font></font>
         i = md-&gt;clist[i];<font></font>
      } <font></font>
   }<font></font>
} <font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableau cellPairs []</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient le nombre de paires de cellules voisines (.x est la premi√®re cellule de la paire, .y est la seconde). Le code est plus simple et plus √©l√©gant, mais ici le traitement de paires de particules √† l'int√©rieur d'une cellule dispara√Æt, pour lequel une fonction distincte doit √™tre √©crite. Il y a un autre probl√®me, l'organisation de la liste des cellules et son analyse sont inefficaces pour le calcul parall√®le, car pour obtenir l'index de la prochaine particule dans la cellule, vous devez parcourir toutes les pr√©c√©dentes. Essayons de cr√©er un code et une structure de donn√©es plus efficaces afin que quelques cellules puissent traiter plusieurs threads √† la fois. Maintenant, laissez la liste des cellules √™tre stock√©e dans une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tableau √† deux dimensions </font><b><font style="vertical-align: inherit;">[] []</font></b><font style="vertical-align: inherit;"> , o√π le premier index d√©finit le num√©ro de la cellule, et le second - le num√©ro atomique dans la cellule. Je stocke √©galement le nombre de particules dans une cellule dans l'√©l√©ment z√©ro du tableau:</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule [i] [0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la valeur de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellule [i] [j + 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est √©gale √† l'indice g√©n√©ral de la particule dans la m√©moire globale. Certes, une telle impl√©mentation n√©cessite de conna√Ætre le nombre maximum de particules dans une cellule et prendra plus de m√©moire. Nous diviserons √©galement notre t√¢che en 2 sous-t√¢ches. La premi√®re fonction calculera l'interaction dans des paires de cellules disjointes (par exemple, avec des indices 0-1, 2-3, 4-5, etc.) et √† l'int√©rieur des cellules:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2a</span><span class="hljs-params">(cudaMD *md)</span>
</span>{
   <span class="hljs-keyword">int</span> iP, iC, iCA, iCB, step, step1; 
   <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;
   <span class="hljs-keyword">int</span> id;
   <span class="hljs-keyword">int</span> nA, nB, nOwn;  
   <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;		<span class="hljs-comment">//   </span><font></font>
<font></font>
   <span class="hljs-comment">//  --        </span>
   __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
   <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
   <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
<span class="hljs-comment">//   shared </span>
  <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      
  <span class="hljs-keyword">int</span>* sAids = shMem;		<span class="hljs-comment">//     1 (   )</span>
  <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell]; <span class="hljs-comment">//     </span>
  float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell]; <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//     2 (B)</span>
  <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
  <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
  float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
  float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
   <span class="hljs-comment">//   ,    </span><font></font>
   float3 *sXyz;<font></font>
   float3 *sFrs;<font></font>
   <span class="hljs-keyword">int</span> *sTypes;
   <span class="hljs-keyword">int</span> *sIds;<font></font>
<font></font>
   <span class="hljs-comment">//       </span>
   iCA = md-&gt;cellPairs[blockIdx.x].x;  <span class="hljs-comment">//   </span>
   iCB = md-&gt;cellPairs[blockIdx.x].y;  <span class="hljs-comment">//   B</span><font></font>
<font></font>
   <span class="hljs-comment">//    -- </span>
  <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
<font></font>
   <span class="hljs-comment">//      shared_memory</span>
   <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>) <span class="hljs-comment">//!       A,  -   B. ,     </span><font></font>
     {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
     }<font></font>
   <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
     }<font></font>
<font></font>
   <span class="hljs-comment">//        </span>
   nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
   nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
   nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA  nB</span><font></font>
<font></font>
   <span class="hljs-comment">//   ,     </span>
  step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
   id0 = (threadIdx.x - deltId) * step;<font></font>
   N = min(id0 + step, nOwn);<font></font>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
   {<font></font>
      id = md-&gt;cells[iC][i+<span class="hljs-number">1</span>];<font></font>
      sIds[i] = id;		<span class="hljs-comment">//   </span>
      sXyz[i] = md-&gt;xyz[id];	<span class="hljs-comment">//  </span>
      sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <span class="hljs-comment">//  </span><font></font>
   sTypes[i] = md-&gt;types[id];<font></font>
   }<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//      </span>
   <span class="hljs-comment">//        i=0  j=1,    j     </span>
   i = <span class="hljs-number">0</span>;<font></font>
   j = threadIdx.x ‚Äì deltId + <span class="hljs-number">1</span>;<font></font>
   step1 = blockDim.x / <span class="hljs-number">2</span>;
   <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
   {<font></font>
      <span class="hljs-keyword">while</span> (j &gt;= nOwn)<font></font>
      {<font></font>
          i++;<font></font>
          <span class="hljs-keyword">if</span> (i &gt;= nOwn<span class="hljs-number">-1</span>)<font></font>
          {<font></font>
              ex = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">break</span>;<font></font>
          }<font></font>
          j = i + <span class="hljs-number">1</span> + j - nOwn;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
      pair_in_cell(sXyz[i], @sFrs[i], sTypes[i], sXyz[j], @sFrs[j], sTypes[j], md, eVdW, eCoul);<font></font>
      j = j + step1;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">//       </span><font></font>
   step1 = ceilf(nA / blockDim.x);<font></font>
   id1 = threadIdx.x * step1;<font></font>
   N1 = min(id1 + step1, nA);<font></font>
   <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
     <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
       pair_between_cell(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[blockId.x], md, eVdW, eCoul);<font></font>
<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
       md-&gt;frs[sIds[i]] = sFrs[i];<font></font>
<font></font>
   <span class="hljs-comment">//     </span><font></font>
   atomicAdd(&amp;engCoul, eCoul);<font></font>
   atomicAdd(&amp;engVdw, eVdW);<font></font>
   __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
   <span class="hljs-keyword">if</span> (!threadIdx.x) <font></font>
   {<font></font>
      atomicAdd(&amp;md-&gt;engCoul, engCoul);  <font></font>
      atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
   }<font></font>
}<font></font>
 </code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables de la forme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">float3PerCell</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont le produit du nombre maximum de particules dans une cellule par la taille du type float3. Il est judicieux de les calculer une fois lors de l'initialisation du syst√®me. Les fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_in_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculent les interactions entre les particules dans les m√™mes cellules et les cellules diff√©rentes, respectivement. En tant que param√®tres, ils obtiennent les coordonn√©es des particules, leurs types et pointeurs o√π √©crire les forces. Param√®tres de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pair_between_cell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclure √©galement l'amplitude des d√©placements, pour tenir compte des conditions aux limites p√©riodiques. Les codes de ces fonctions seront donn√©s ci-dessous. Pour trier les paires de particules √† l'int√©rieur de la cellule, je voulais suivre la voie standard - diviser le nombre de paires en intervalles √©gaux et donner √† chaque flux un intervalle. Cependant, pour obtenir les indices de particules ij par le nombre de paires, j'ai trouv√© l'√©quation quadratique et j'ai d√©cid√© de le faire diff√©remment: le premier fil traite une paire de particules avec les indices 0-1, le second - 0-2, etc. Apr√®s avoir trait√© la paire ij, le flux va √† la paire i- (j + N), o√π N est le nombre de flux dans le bloc et s'il d√©passe la limite de plage, il augmente l'indice de la premi√®re particule de la paire, voir le diagramme:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<img src="https://habrastorage.org/webt/fv/-h/qa/fv-hqah4yeuzhpa9jbidswkmse8.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©num√©ration des paires entre les diff√©rentes cellules est la suivante: tous les flux obtiennent leur intervalle d'indices de particules √† partir de la cellule A et calculent les interactions entre ces particules et toutes les particules de la cellule B. La deuxi√®me fonction calcule les interactions dans toutes les paires restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">cell_list2b</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> iPair, iC, iCA, iCB, step, step1; 
    <span class="hljs-keyword">int</span> i, j, id0, id1, N, N1, deltId;    
    <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">int</span> nA, nB, nOwn; <font></font>
<font></font>
    __shared__ <span class="hljs-keyword">float</span> engVdW, engCoul;
    <span class="hljs-keyword">float</span> eVdW = <span class="hljs-number">0.0</span>;
    <span class="hljs-keyword">float</span> eCoul = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-keyword">extern</span> __shared__ <span class="hljs-keyword">int</span> shMem[];      <span class="hljs-comment">// declaration of shared memory</span>
    <span class="hljs-keyword">int</span>* sAids = shMem;
    <span class="hljs-keyword">int</span>* sAtypes = (<span class="hljs-keyword">int</span>*)&amp;sAids[md-&gt;maxAtPerCell];<font></font>
    float3* sAxyz = (float3*)&amp;sAtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sAfrs = (float3*)&amp;sAxyz[md-&gt;maxAtPerCell];<font></font>
    <span class="hljs-keyword">int</span>* sBids = (<span class="hljs-keyword">int</span>*)&amp;sAfrs[md-&gt;maxAtPerCell];
    <span class="hljs-keyword">int</span>* sBtypes = (<span class="hljs-keyword">int</span>*)&amp;sBids[md-&gt;maxAtPerCell];<font></font>
    float3* sBxyz = (float3*)&amp;sBtypes[md-&gt;maxAtPerCell];<font></font>
    float3* sBfrs = (float3*)&amp;sBxyz[md-&gt;maxAtPerCell];<font></font>
<font></font>
    float3* sXyz;<font></font>
    float3* sFrs;  <font></font>
    <span class="hljs-keyword">int</span>* sTypes;
    <span class="hljs-keyword">int</span>* sIds;<font></font>
<font></font>
    iPair = blockIdx.x + md-&gt;nPair1;<font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        engVdW = <span class="hljs-number">0.0</span>;<font></font>
        engCoul = <span class="hljs-number">0.0</span>;<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    iCA = md-&gt;cellPairs[iPair].x; <font></font>
    iCB = md-&gt;cellPairs[iPair].y;<font></font>
    nA = md-&gt;cells[iCA][<span class="hljs-number">0</span>];<font></font>
    nB = md-&gt;cells[iCB][<span class="hljs-number">0</span>];<font></font>
    <font></font>
    <span class="hljs-comment">//    ,        </span>
    <span class="hljs-keyword">if</span> (!nA)
       <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">if</span> (!nB)
        <span class="hljs-keyword">return</span>;<font></font>
<font></font>
    <span class="hljs-comment">//      shared_memory</span>
    <span class="hljs-keyword">if</span> (threadIdx.x &lt; blockDim.x / <span class="hljs-number">2</span>)<font></font>
    {<font></font>
        iC = iCA;<font></font>
        sXyz = sAxyz;<font></font>
        sFrs = sAfrs;<font></font>
        sTypes = sAtypes;<font></font>
        sIds = sAids;<font></font>
        deltId = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        iC = iCB;<font></font>
        sXyz = sBxyz;<font></font>
        sFrs = sBfrs;<font></font>
        sTypes = sBtypes;<font></font>
        sIds = sBids;<font></font>
        deltId = blockDim.x / <span class="hljs-number">2</span>;<font></font>
    }<font></font>
    nOwn = md-&gt;cells[iC][<span class="hljs-number">0</span>]; <span class="hljs-comment">// nA or nB</span><font></font>
<font></font>
    step = ceilf(<span class="hljs-number">2</span> * (<span class="hljs-keyword">double</span>)nOwn / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id0 = (threadIdx.x - deltId) * step;<font></font>
    N = min(id0 + step, nOwn);<font></font>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        id = md-&gt;cells[iC][i + <span class="hljs-number">1</span>];<font></font>
        sIds[i] = id;     <font></font>
        sXyz[i] = md-&gt;xyz[id];    <font></font>
        sFrs[i] = make_float3(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);    <font></font>
        sTypes[i] = md-&gt;types[id];<font></font>
    }<font></font>
    __syncthreads();<font></font>
<font></font>
    <span class="hljs-comment">//       </span>
    step1 = ceilf((<span class="hljs-keyword">double</span>)nA / (<span class="hljs-keyword">double</span>)blockDim.x);<font></font>
    id1 = threadIdx.x * step1;<font></font>
    N1 = min(id1 + step1, nA);<font></font>
    <span class="hljs-keyword">for</span> (i = id1; i &lt; N1; i++)
        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; nB; j++)<font></font>
        {<font></font>
            pair_between_cell1(sAxyz[i], &amp;sAfrs[i], sAtypes[i], sBxyz[j], &amp;sBfrs[j], sBtypes[j], md-&gt;cellShifts[iPair], md, eVdW, eCoul);<font></font>
<font></font>
        }<font></font>
    __syncthreads();<font></font>
<font></font>
   <span class="hljs-comment">//     global memory</span>
    <span class="hljs-keyword">for</span> (i = id0; i &lt; N; i++)<font></font>
    {<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].x), sFrs[i].x);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].y), sFrs[i].y);<font></font>
        atomicAdd(&amp;(md-&gt;frs[sIds[i]].z), sFrs[i].z);<font></font>
    }<font></font>
<font></font>
    atomicAdd(&amp;engCoul, eCoul);<font></font>
    atomicAdd(&amp;engVdW, eVdW);<font></font>
    __syncthreads();<font></font>
 <font></font>
    <span class="hljs-keyword">if</span> (threadIdx.x == <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        atomicAdd(&amp;md-&gt;engCoul1, engCoul);<font></font>
        atomicAdd(&amp;md-&gt;engVdW, engVdW);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code est presque similaire √† la fonction pr√©c√©dente, seules les paires restantes sont d√©sormais trait√©es (l'index de la paire est d√©cal√© de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">md-&gt; nPair1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), l'interaction est calcul√©e uniquement entre la paire de cellules (d√©j√† compt√©e √† l'int√©rieur des cellules), et lors de la copie dans la m√©moire globale, nous utilisons atomicAdd pour r√©sumer les r√©sultats et ne pas √©craser leur. </font><font style="vertical-align: inherit;">Maintenant, j'apporte les fonctions restantes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">keep_in_cell</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, float3 xyz, cudaMD* md)</span>
<span class="hljs-comment">//  index    xyz  cell list</span>
</span>{
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">int</span> c = <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.x / (<span class="hljs-keyword">double</span>)md-&gt;cSize.x) * md-&gt;cnYZ + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.y / (<span class="hljs-keyword">double</span>)md-&gt;cSize.y) * md-&gt;cNumber.z + <span class="hljs-built_in">floor</span>((<span class="hljs-keyword">double</span>)xyz.z / (<span class="hljs-keyword">double</span>)md-&gt;cSize.z);<font></font>
<font></font>
    <span class="hljs-keyword">int</span> j = atomicAdd(&amp;(md-&gt;cells[c][<span class="hljs-number">0</span>]), <span class="hljs-number">1</span>);<font></font>
    md-&gt;cells[c][j + <span class="hljs-number">1</span>] = index;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base des coordonn√©es, nous calculons l'indice de la cellule o√π cette particule entre. Nous augmentons le compteur de particules dans cette cellule. Nous √©crivons l'indice des particules dans une nouvelle cellule. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cSize</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est la taille des cellules, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cnYZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le produit du nombre de cellules dans les mesures Y et Z. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut √™tre utile de ne pas calculer l'indice des cellules, mais de les stocker sous forme de tableau tridimensionnel dans la m√©moire de texture, en utilisant des index de la forme [x / md-&gt; cSize.x ]. Donnera-t-il un coup de pouce aux performances?</font></font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Fonctions de calcul des interactions:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_in_cell</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw = <span class="hljs-literal">NULL</span>;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x; <font></font>
    dy = xyzA.y - xyzB.y;<font></font>
    dz = xyzA.z - xyzB.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-comment">//if (r2 &lt;= sim-&gt;r2Max)    </span>
    <span class="hljs-comment">//{</span>
    r = <span class="hljs-number">0.0</span>;<font></font>
    f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//  </span><font></font>
    f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul);<font></font>
<font></font>
    <span class="hljs-comment">// -- </span><font></font>
    vdw = md-&gt;vdws[typeA][typeB];<font></font>
    <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
        <span class="hljs-comment">//if (r2 &lt;= vdw-&gt;r2cut)   //!      </span><font></font>
            f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
    <span class="hljs-comment">//      atomic,        </span><font></font>
    atomicAdd(&amp;(fxyzA-&gt;x), f * dx);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;y), f * dy);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
    atomicAdd(&amp;(fxyzA-&gt;z), f * dz);<font></font>
    atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    <span class="hljs-comment">//}</span><font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous calculons la distance entre les particules, la substituons d'abord dans la fonction pour le Coulomb, puis pour l'interaction de van der Waals. Si la taille de la cellule est choisie de sorte que sa diagonale ne d√©passe pas la plage du type d'interaction le plus court, les contr√¥les de distance peuvent √™tre supprim√©s (je les ai sp√©cifiquement laiss√©s comment√©s dans le code). Je note qu'ici, je calcule le carr√© de la distance ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), et la distance ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) elle-m√™me est calcul√©e dans la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableau chProd [i] [j]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stocke le produit des charges des types de particules correspondants. Peut-√™tre devrait-il √©galement √™tre plac√© dans la m√©moire de texture. La structure vdw stocke des param√®tres potentiels appari√©s et un pointeur de fonction ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feng_r</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) pour calculer l'interaction de van der Waals. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fonction de calcul des interactions entre deux cellules diff√©rentes:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">pair_between_cell1</span><span class="hljs-params">(float3 xyzA, float3* fxyzA, <span class="hljs-keyword">int</span> typeA, float3 xyzB, float3* fxyzB, <span class="hljs-keyword">int</span> typeB, float3 shift, cudaMD* md, <span class="hljs-keyword">float</span>&amp; engVdw, <span class="hljs-keyword">float</span>&amp; engCoul)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> dx, dy, dz;<font></font>
    cudaVdW* vdw;<font></font>
<font></font>
    dx = xyzA.x - xyzB.x - shift.x;<font></font>
    dy = xyzA.y - xyzB.y - shift.y;<font></font>
    dz = xyzA.z - xyzB.z - shift.z;<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)<font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[typeA][typeB], md-&gt;alpha, engCoul); <font></font>
<font></font>
        vdw = md-&gt;vdws[typeA][typeB];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw);<font></font>
<font></font>
<font></font>
        fxyzA-&gt;x += f * dx;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;x), -f * dx);<font></font>
        fxyzA-&gt;y += f * dy;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;y), -f * dy);<font></font>
        fxyzA-&gt;z += f * dz;<font></font>
        atomicAdd(&amp;(fxyzB-&gt;z), -f * dz);<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code est presque identique √† la fonction pr√©c√©dente, il y a une correction √† la diff√©rence de coordonn√©es pour prendre en compte les conditions aux limites p√©riodiques, les v√©rifications de distance ne sont pas comment√©es, et comme nous le rappelons des fonctions du groupe de fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">il n'est pas n√©cessaire d'appliquer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atomicAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† la cellule A, car les particules qu'il </font><i><font style="vertical-align: inherit;">contient</font></i><font style="vertical-align: inherit;"> sont trait√©es ind√©pendamment. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je note qu'en fonction de la distance entre des cellules sp√©cifiques dans une paire, vous pouvez omettre certains contr√¥les et calculs de distance. </font><font style="vertical-align: inherit;">Pour ce faire, vous pouvez √©crire des versions l√©g√®rement diff√©rentes de cette fonction. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je donne √©galement des fonctions qui calculent les forces et les √©nergies des potentiels de paire pour le potentiel de Lennard-Jones et Buckingham:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fe_lj</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = 4e[(s/r)^12 - (s/r)^6]</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> sr2 = vdw-&gt;p1 * r2i;
    <span class="hljs-keyword">float</span> sr6 = sr2 * sr2 * sr2;<font></font>
<font></font>
    eng += vdw-&gt;p0 * sr6 * (sr6 - <span class="hljs-number">1.0</span>);
    <span class="hljs-keyword">return</span> vdw-&gt;p2 * r2i * sr6 * (<span class="hljs-number">2.0</span> * sr6 - <span class="hljs-number">1.0</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">cu_fer_buck</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, cudaVdW* vdw, <span class="hljs-keyword">float</span>&amp; eng)</span>
<span class="hljs-comment">// U = A exp(-r/ro) - C/r^6</span>
</span>{
    <span class="hljs-keyword">float</span> r2i = <span class="hljs-number">1.0</span> / r2;
    <span class="hljs-keyword">float</span> r4i = r2i * r2i;
    <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0.0</span>)    <span class="hljs-comment">//  r , </span>
        r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
<font></font>
    eng += vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) - vdw-&gt;p2 * r4i * r2i;
    <span class="hljs-keyword">return</span> vdw-&gt;p0 * <span class="hljs-built_in">exp</span>(-r / vdw-&gt;p1) / r / vdw-&gt;p1 - <span class="hljs-number">6.0</span> * vdw-&gt;p2 * r4i * r4i;<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fonctions renvoient la force (qui doit √™tre multipli√©e par la projection du vecteur distance) et ajoutent de l'√©nergie √† la variable </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Un pointeur vers l'une de ces fonctions est stock√© dans la structure cudaVdW. </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D'une mani√®re g√©n√©rale, pour obtenir des trajectoires de mouvement, l'√©nergie ne peut pas √™tre calcul√©e, elle est n√©cessaire pour diff√©rentes statistiques. Si nous supprimons les expressions d'√©nergie de ces fonctions, les calculs devraient s'acc√©l√©rer. Et vous pouvez le faire: une fois quelques √©tapes pour appeler la fonction compl√®te, et le reste du temps - seulement un analogique r√©duit.</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Une partie de l'interaction Coulomb est calcul√©e par la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_ewald</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__device__ <span class="hljs-keyword">float</span> <span class="hljs-title">real_ewald</span><span class="hljs-params">(<span class="hljs-keyword">float</span> r2, <span class="hljs-keyword">float</span>&amp; r, <span class="hljs-keyword">float</span> chprd, <span class="hljs-keyword">float</span> alpha, <span class="hljs-keyword">float</span>&amp; eng)</span>
</span>{
    <span class="hljs-keyword">float</span> ar; 
    <span class="hljs-keyword">float</span> erfcar;
    <span class="hljs-keyword">float</span> kqq = chprd * d_Fcoul_scale; <span class="hljs-comment">// q[i]*q[j]*1/4pie0;</span><font></font>
<font></font>
    r = <span class="hljs-built_in">sqrt</span>(r2);<font></font>
    ar = alpha * r;<font></font>
    erfcar = erfc(ar);<font></font>
<font></font>
    eng += kqq * erfcar / r;<font></font>
    <span class="hljs-keyword">return</span> kqq / r / r2 * (erfcar + <span class="hljs-number">2</span> * ar / d_sqrtpi * <span class="hljs-built_in">exp</span>(-ar * ar));<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela diff√®re de la loi Coulomb famili√®re, mais plus √† ce sujet dans un article s√©par√©. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tests avec un exemple r√©el ont montr√© qu'il y a tr√®s peu de particules dans une paire de cellules pour charger tous les flux allou√©s au bloc. Une optimisation suppl√©mentaire des fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consiste √† traiter plusieurs paires √† la fois dans un bloc. Jusqu'√† pr√©sent, je n'ai √©crit que la version la plus simple, o√π les flux sont simplement divis√©s en plusieurs paires de cellules, c'est-√†-dire un bloc ne traite pas une paire, mais disons 4: 0-1, 1-2, 3-4, 5-6. Vous pouvez remarquer que dans ce cas, le chargement des donn√©es dans la m√©moire partag√©e peut en m√™me temps traiter les paires 0-2, 0-3, 0-4, etc. Cependant, cela n√©cessite des astuces suppl√©mentaires au stade de la pr√©paration des donn√©es, que je n'ai pas encore r√©fl√©chies. Aussi si dans la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous chargez des paires avec une cellule commune (par exemple, les m√™mes 0-2, 0-3, 0-4, etc.), vous pouvez r√©duire le nombre d'appels vers la m√©moire globale en copiant les donn√©es de la cellule 0 une seule fois. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour v√©rifier si tout fonctionne correctement dans mon impl√©mentation d'algorithmes de liste de cellules, j'ai √©galement √©crit une fonction qui calcule les interactions de mani√®re na√Øve, en triant simplement toutes les paires:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<pre><code class="cpp hljs"><span class="hljs-function">__global__ <span class="hljs-keyword">void</span> <span class="hljs-title">all_pair</span><span class="hljs-params">(cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">int</span> i, j;
    <span class="hljs-keyword">int</span> step = blockDim.x * gridDim.x;
    <span class="hljs-keyword">int</span> ex = <span class="hljs-number">0</span>;  <span class="hljs-comment">// exit flag</span>
    <span class="hljs-keyword">int</span> nAt = md-&gt;nAt;<font></font>
<font></font>
    i = <span class="hljs-number">0</span>;<font></font>
    j = blockIdx.x * blockDim.x + threadIdx.x + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">while</span> (j &gt;= nAt)<font></font>
        {<font></font>
            i++;<font></font>
            <span class="hljs-keyword">if</span> (i &gt;= nAt - <span class="hljs-number">1</span>)<font></font>
            {<font></font>
                ex = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">break</span>;<font></font>
            }<font></font>
            j = i + <span class="hljs-number">1</span> + j - nAt;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (ex) <span class="hljs-keyword">break</span>;<font></font>
        global_pair(i, j, iStep, md);<font></font>
        j = j + step;<font></font>
    }<font></font>
} <font></font>
<font></font>
<span class="hljs-function">__device__ <span class="hljs-keyword">void</span> <span class="hljs-title">global_pair</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, cudaMD* md)</span>
</span>{
    <span class="hljs-keyword">float</span> r, r2, f;
    <span class="hljs-keyword">float</span> engCoul = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">float</span> engVdw = <span class="hljs-number">0</span>;<font></font>
    cudaVdW* vdw;<font></font>
    <span class="hljs-keyword">int</span> ti, tj;<font></font>
<font></font>
    <span class="hljs-keyword">float</span> dx = md-&gt;xyz[i].x - md-&gt;xyz[j].x;
    <span class="hljs-keyword">float</span> dy = md-&gt;xyz[i].y - md-&gt;xyz[j].y;
    <span class="hljs-keyword">float</span> dz = md-&gt;xyz[i].z - md-&gt;xyz[j].z;<font></font>
<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-keyword">if</span> (dx &gt; md-&gt;halfLeng.x)<font></font>
        dx -= md-&gt;leng.x;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dx &lt; -md-&gt;halfLeng.x)<font></font>
            dx += md-&gt;leng.x;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dy &gt; md-&gt;halfLeng.y)<font></font>
        dy -= md-&gt;leng.y;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dy &lt; -md-&gt;halfLeng.y)<font></font>
            dy += md-&gt;leng.y;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (dz &gt; md-&gt;halfLeng.z)<font></font>
        dz -= md-&gt;leng.z;<font></font>
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">if</span> (dz &lt; -md-&gt;halfLeng.z)<font></font>
            dz += md-&gt;leng.z;<font></font>
<font></font>
    r2 = dx * dx + dy * dy + dz * dz;<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (r2 &lt;= md-&gt;r2Real)    <font></font>
    {<font></font>
        r = <span class="hljs-number">0.0</span>;<font></font>
        f = <span class="hljs-number">0.0</span>;<font></font>
<font></font>
        ti = md-&gt;types[i];<font></font>
        tj = md-&gt;types[j];<font></font>
<font></font>
        f += real_ewald(r2, r, md-&gt;chProd[ti][tj], md-&gt;alpha, engCoul);<font></font>
<font></font>
        vdw = md-&gt;vdws[ti][tj];<font></font>
        <span class="hljs-keyword">if</span> (vdw != <span class="hljs-literal">NULL</span>)
            <span class="hljs-keyword">if</span> (r2 &lt;= vdw-&gt;r2cut)   <font></font>
                f += vdw-&gt;feng_r(r2, r, vdw, engVdw); <font></font>
<font></font>
        dx *= f;<font></font>
        dy *= f;<font></font>
        dz *= f;<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].x), dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].x), -dx);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].y), dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].y), -dy);<font></font>
        atomicAdd(&amp;(md-&gt;frs[i].z), dz);<font></font>
        atomicAdd(&amp;(md-&gt;frs[j].z), -dz);<font></font>
<font></font>
        atomicAdd(&amp;(md-&gt;engCoul1), engCoul);<font></font>
        atomicAdd(&amp;(md-&gt;engVdW), engVdw);<font></font>
<font></font>
    }<font></font>
}<font></font>
</code>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
    </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les r√©sultats des calculs ont co√Øncid√©. </font><font style="vertical-align: inherit;">Vrai, apparemment, en raison de diff√©rentes s√©quences d'arrondi, les coordonn√©es des particules √† la 3e d√©cimale peuvent varier d'un d√©but √† l'autre. </font><font style="vertical-align: inherit;">Je note que sur un syst√®me d'environ 1400 particules et un rayon de coupure de 6 angstr√∂ms, les fonctions </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell_list2b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perdent environ deux fois le temps d'ex√©cution pour une simple √©num√©ration. </font><font style="vertical-align: inherit;">Lors du traitement de plusieurs blocs (8 et 16) √† la fois dans un bloc, les vitesses sont compar√©es et peuvent m√™me √™tre l√©g√®rement en avance sur la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all_pair</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cependant, cela devrait d√©pendre fortement de la taille du syst√®me. </font><font style="vertical-align: inherit;">√Ä mesure que le nombre d'atomes augmente, la vitesse des algorithmes de liste de cellules cro√Æt lin√©airement et l'√©num√©ration simple quadratique. </font><font style="vertical-align: inherit;">De plus, la liste des cellules est tr√®s efficace pour mod√©liser les syst√®mes d√©charg√©s (grandes distances entre particules), par exemple les gaz</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci conclut cet article, je serai heureux de toutes les questions et commentaires, en particulier sur l'augmentation de la productivit√©. </font><font style="vertical-align: inherit;">Les moments les plus contest√©s au cours de la narration que j'ai not√©s en rouge. </font><font style="vertical-align: inherit;">Puisque le transfert du reste de la dynamique mol√©culaire fonctionnelle reste √† faire, je compte poursuivre le cycle de ces articles:</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommation d'Ewald.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaction intramol√©culaire.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation d'espaces et de liaisons.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfert √©lectronique.</font></font></li>
</ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'apr√®s la litt√©rature sur MD, je peux recommander le livre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daan Frenkel et Berend Smit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Understanding Molecular Simulation: From Algorithms to Applications</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computer Simulation of Liquids,</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©crit par </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MP Allen, DJ Tildesley</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour la premi√®re, √† ma connaissance, il existe une traduction en russe. </font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je remercie √©galement Pavel Kudinov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pavel_kudinov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour son commentaire appelant √† ¬´ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©crire du code GPGPU aussi simple et direct qu'un marteau</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬ª, lecture que j'ai finalement pass√©e √† l'action, qui a abouti √† cet article.</font></font>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    

      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27/06/2020. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merci au commentaire</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avdx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supprim√© la mise √† z√©ro des param√®tres globaux des fonctions et d√©fini la gamme de particules √©mises vers le flux d'une mani√®re diff√©rente.</font></font></div>
      
    </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr508380/index.html">Automatisation de l'exp√©dition des marchandises en Chine</a></li>
<li><a href="../fr508384/index.html">Comment familiariser le d√©veloppeur avec les valeurs de votre entreprise sans recourir √† la violence</a></li>
<li><a href="../fr508390/index.html">VR lors de la formation du personnel. Les vrais avantages et inconv√©nients</a></li>
<li><a href="../fr508392/index.html">Financement de la guerre civile (USA vs USA)</a></li>
<li><a href="../fr508394/index.html">Comment les √©tudiants de premi√®re ann√©e du HSE de Saint-P√©tersbourg ont √©crit un client torrent, un analyseur de code, un √©diteur de photos et pas seulement pour le semestre</a></li>
<li><a href="../fr508398/index.html">Trois fa√ßons pour un programmeur: expert, leader, fondateur</a></li>
<li><a href="../fr508400/index.html">Comment un ¬´citoyen actif¬ª accoutume les gens au phishing</a></li>
<li><a href="../fr508402/index.html">Comment l'architecture HiCampus simplifie la mise en r√©seau des campus</a></li>
<li><a href="../fr508404/index.html">AI vs AI battle: fraude et faux contenu</a></li>
<li><a href="../fr508408/index.html">Les antivirus mobiles ne fonctionnent pas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>