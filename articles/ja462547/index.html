<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♌️ 👃🏼 👩‍👧‍👦 SGX Malvar：悪意のある人が、それが考えられた目的のためにインテルの新しいテクノロジーをどのように利用するか 🔭 ☠️ ☂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ご存知のように、エンクレーブで実行されるコードは、その機能が大幅に制限されています。システムコールは実行できません。 I / O操作は実行できません。彼は、ホストアプリケーションコードセグメントのベースアドレスを知りません。 jmpしてホストコードを呼び出すことはできません。彼は、ホストアプリケーシ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SGX Malvar：悪意のある人が、それが考えられた目的のためにインテルの新しいテクノロジーをどのように利用するか</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462547/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ご存知のように、エンクレーブで実行されるコードは、その機能が大幅に制限されています。システムコールは実行できません。 I / O操作は実行できません。彼は、ホストアプリケーションコードセグメントのベースアドレスを知りません。 jmpしてホストコードを呼び出すことはできません。彼は、ホストアプリケーションをガイドするアドレススペースの構造（たとえば、どのページが昇格されるか、またはこれらのページにどのような種類のデータが配置されるか）を知りません。オペレーティングシステムにメモリの一部をホストアプリケーションに追加するように要求することはできません（たとえば、/ proc / pid / mapsを介して）。ホストアプリケーションのブラインドの任意のメモリ領域を読み取る単純な試み-書き込みの試みは言うまでもなく-遅かれ早かれ（最初ではなく）、エンクレーブプログラムが強制的に完了します。これは毎回起こりますエンクレーブによって要求された仮想アドレス空間がホストアプリケーションにアクセスできない場合。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このような厳しい現実がある場合、ウイルス作成者はSGXエンクレーブを使用して悪意のある目標を実現できますか？</font></font></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-読みやすさの</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ためにアドレスをプローブするための</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハック- </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">書き込み可能性のためにアドレスをプローブするための</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ハック-制御フローをリダイレクトするためのハック</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-悪者に上記の3つのハックを与えるもの</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-悪人がこれらのハックを使用してranzomvariを作成する方法</font></font></a></p><br>
<p><img src="https://habrastorage.org/webt/jw/ak/c1/jwakc1r2ic_hbeu3zaklnkev6po.jpeg"></p><a name="habracut"></a><br>
<p>    ,  ,      ,   -,        ,    .  ,       .        ,  SGX- :  -       ,             -.</p><br>
<p>,  ,            -,      ,   -        ROP-, –       -,  -.        ,      . ,         DoS-.         ,        .</p><br>
<p>   ,      ,    SGX    :   ROP-.         - ( process hollowing,    ),       (            ).</p><br>
<a name="a1"></a><br>
<h1 id="hak-dlya-zondirovaniya-adresov-na-predmet-vozmozhnosti-ih-schityvaniya">        </h1><br>
<p>   ,       -          , –          .       .        Intel’  TSX.      TSX':        TSX-,  ,  -    ,  TSX',     .       , –    ,     . .. TSX        ,  , –   .</p><br>
<p> <em>  </em> -, TSX-    .        -  ,    (,  ),          .     TSX   ,   ,      .       .</p><br>
<p> <em>  </em> -, TSX    (  )   .     , –        .      ,     -.</p><br>
<p><img src="https://habrastorage.org/webt/ws/56/5m/ws565mbicysq6wpxoadwankb-6a.png"></p><br>
<p><img src="https://habrastorage.org/webt/uv/mw/jg/uvmwjgnn9ygxbaaof_cq0v0jdau.png"></p><br>
<p>   TSX’       :            ,     TSX-,   .  ,    TSX’      .</p><br>
<p> ,       -  ,    ,  ,    ;         «  ».</p><br>
<p>        - ,    ROP-.        .           .   16     45  ( Intel i7-6700K).       ,     ROP-.</p><br>
<a name="a2"></a><br>
<h1 id="hak-dlya-zondirovaniya-adresov-na-predmet-vozmozhnosti-zapisi">       </h1><br>
<p>    ROP-            -.                ().   ,        -   ,           -  .       ,   .</p><br>
<p>   ,      TSX'.  ,     ,      ,   ,        .      :     TSX-,      ,       –    (explicit abort).</p><br>
<p>     TSX-,  ,     .   «explicit abort»,  ,     ,       .       ,    , –   «explicit abort».</p><br>
<p><img src="https://habrastorage.org/webt/yo/pg/iy/yopgiyrkws5wdk-nin_q2e3wpvy.png"></p><br>
<p>   TSX’    ,    (      ):            ,    ,      .</p><br>
<a name="a3"></a><br>
<h1 id="hak-dlya-perenapravleniya-potoka-upravleniya">    </h1><br>
<p>  ROP-  , –     ROP-, –       RIP   -     (   -   ).       RIP,   .          ROP-.</p><br>
<p>  ROP- ,      -          . ,     ,     .            ROP-  .        ,   , –      .</p><br>
<p><img src="https://habrastorage.org/webt/w_/s-/qn/w_s-qnrj9fscjgiiz1q_xu6tz6m.png"></p><br>
<a name="a4"></a><br>
<h1 id="chto-dayut-zlodeyu-tri-perechislennye-vyshe-haka">      </h1><br>
<p>(1)     <em>        </em>, –   - ROP-,   .</p><br>
<p><img src="https://habrastorage.org/webt/9a/2z/p9/9a2zp9bhjuor86g3njvlsxetwcg.png"></p><br>
<p>(2)   <em>       </em>, –      - ,     .</p><br>
<p><img src="https://habrastorage.org/webt/es/t5/-2/est5-2k5ycrnhrgw_ma_2tkf6wi.png"></p><br>
<p>(3) ,   ROP-  ,    (1),       -.</p><br>
<p><img src="https://habrastorage.org/webt/do/54/bz/do54bzlimfouln6hun33s6k1aqg.png"></p><br>
<p>(4) ,  -       ROP-,     , –   -       .</p><br>
<a name="a5"></a><br>
<h1 id="kak-zlodey-zadeystvuet-eti-haki-dlya-sozdaniya-ranzomvari">       </h1><br>
<p>   -     -  ECALL' ( ,    ),      -      (      ,   ).   <em>        </em>, –    -     ROP-,       «RANSOM»    (       )      .  , -  ,      .     ?</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認識を容易にするために、定義によるニーモニックをいくつか紹介します。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/uu/fo/v_/uufov_dqhtly23sabyj6a4k8jik.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ペイロードの実行後にホストアプリケーションの通常の動作を復元するために、RSPおよびRBPレジスタの初期値を保存します。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/h1/nx/1x/h1nx1xpue_tb2tew4z0-kytjgr4.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切なスタックフレームを探しています（「制御フローをリダイレクトするためのハック」セクションのコードを参照）。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切なROPガジェットを見つけます。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/r0/we/cf/r0wecfpdydx94xqv5zkkwmbgt4q.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ペイロードを注入する場所を見つけます。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/0e/zk/7y/0ezk7yfmzak5oobrhqivpzd3jbe.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROPチェーンの構築：</font></font></p><br>
<p><img src="https://habrastorage.org/webt/jh/2-/k9/jh2-k9yyt_2rts1oexzaore2qoc.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このように、悪意のあるプログラムに耐えるように設計されたインテルのSGXテクノロジーは、悪意のあるユーザーによって悪用され、反対の目標を達成します。</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462537/index.html">クラウド移行</a></li>
<li><a href="../ja462539/index.html">三角法を避ける</a></li>
<li><a href="../ja462541/index.html">SpringでのConditionalの使用</a></li>
<li><a href="../ja462543/index.html">RaiffeisenbankでのJavaミートアップ</a></li>
<li><a href="../ja462545/index.html">テレグラムブロッキング、ヘッツナーサブネット/ 16、ILVの経験</a></li>
<li><a href="../ja462549/index.html">クォーラムブロックチェーン：Javaコードへの統合</a></li>
<li><a href="../ja462551/index.html">テストに関する開発者からのよくある質問</a></li>
<li><a href="../ja462553/index.html">シンプルについて少し。テスト設計。パート1</a></li>
<li><a href="../ja462555/index.html">ディスカッション：Cookieなしで機能する場合-代替案を教えてくれます</a></li>
<li><a href="../ja462563/index.html">ウェビナー「コンプライアンスを生き残る方法は？」規制要件を満たすための最善のアプローチ」</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>