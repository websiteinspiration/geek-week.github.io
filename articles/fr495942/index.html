<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö´ üè© üóëÔ∏è Gagnez du temps, des nerfs et des heures de travail ‚ÜôÔ∏è üí® üë®üèΩ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos projets sont g√©n√©ralement r√©gionaux et les clients, g√©n√©ralement des minist√®res. Mais, en plus du secteur public, des organisations priv√©es utilis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Gagnez du temps, des nerfs et des heures de travail</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/barsgroup/blog/495942/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nos projets sont g√©n√©ralement r√©gionaux et les clients, g√©n√©ralement des minist√®res. </font><font style="vertical-align: inherit;">Mais, en plus du secteur public, des organisations priv√©es utilisent √©galement nos syst√®mes. </font><font style="vertical-align: inherit;">Il n'y a pratiquement aucun probl√®me avec eux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, les principaux projets sont r√©gionaux, et parfois il y a des probl√®mes avec eux. </font><font style="vertical-align: inherit;">Par exemple, avec les performances, lorsque dans des r√©gions √† partir de 20 000, nos pr√©cieux utilisateurs sont dans la p√©riode de d√©ploiement de nouvelles fonctionnalit√©s sur les serveurs de produits. </font><font style="vertical-align: inherit;">C‚Äôest une douleur ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m‚Äôappelle Ruslan et je suis impliqu√© dans l‚Äôescorte des syst√®mes d‚Äôinformation du groupe BARS et dans le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©veloppement d‚Äôun robot tueur pour les DBAs en s√©rie brutaux</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le je√ªne n'est pas pour les faibles de c≈ìur - beaucoup de lettres et d'images.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_2/kf/av/_2kfavets7hbt3nwzvy_bd9mqos.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certaines de nos applications fonctionnent sur Oracle DBMS. Il y a des projets sur le SGBD PostgreSQL. Oracle a une chose merveilleuse - la collecte de statistiques sur la charge du SGBD, qui met en √©vidence les probl√®mes existants et donne m√™me des recommandations pour l'√©limination - Automatic Workload Repository (AWR). √Ä un moment donn√© (√† savoir, au moment de la douleur), les d√©veloppeurs ont constamment demand√© √† collecter des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rapports AWR pour l'analyse des performances</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Honn√™tement, nous nous sommes rendus sur le serveur SGBD, avons collect√© des rapports, nous les avons tra√Æn√©s et nous les avons envoy√©s pour analyse en production. Une fois apr√®s le 5, il a commenc√© √† se fatiguer ... apr√®s le 10 - pour provoquer une irritation ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un jour, un de mes coll√®gues a exprim√© l'id√©e que tout ce qui est fait plus d'une fois devrait √™tre automatis√©. Jusqu'au moment de l'agacement, pour √™tre honn√™te, je n'y ai pas pens√© et j'ai essay√© d'automatiser tout ce qui peut √™tre automatis√©, mais souvent ce n'√©tait pas demand√© et c'√©tait plus une recherche qu'une application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis j'ai pens√©: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Les administrateurs ne sont pas n√©cessaires pour g√©n√©rer un rapport ..."</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Apr√®s tout, collecter un rapport, c'est ex√©cuter le script sql @ $ ORACLE_HOME / rdbms / admin / awrrpt.sql et r√©cup√©rer le rapport du serveur √† nous-m√™mes ... Oh oui, nous ne laissons pas le d√©veloppement aller en vente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, j'ai recherch√© les informations n√©cessaires sur Google, cr√©√© une fonction √† partir de l'article sur une base de test, tir√© le script et un miracle - le rapport a √©t√© collect√© et il peut √™tre enregistr√© localement. A cr√©√© des fonctions o√π les rapports AWR √©taient souvent n√©cessaires, a expliqu√© aux d√©veloppeurs comment l'utiliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä cette √©poque, pendant mon temps libre, apr√®s avoir parl√© avec @BotFather, j'ai cr√©√© un bot Telegram pour moi, juste pour le plaisir. J'ai foir√© une simple fonctionnalit√© l√†-bas - pour montrer l'heure actuelle, les taux de change, la m√©t√©o, lui ai appris √† envoyer des compliments √† ma femme (alors une fille) selon un horaire. Peut-√™tre qu'√† ce moment-l√†, envoyer des compliments √©tait la fonctionnalit√© la plus recherch√©e de mon bot, ma femme a appr√©ci√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc. Les d√©veloppeurs nous √©crivent dans Telegram, nous leur envoyons un rapport dans Telegram ... Mais que se passe-t-il s'ils ne nous √©crivent pas, mais au bot? En effet, ce sera mieux pour tout le monde, le rapport sera re√ßu plus rapidement, et surtout, par nous. L'id√©e de la premi√®re fonctionnalit√© recherch√©e est donc n√©e pour mon bot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai commenc√© la mise en ≈ìuvre. Je l'ai fait, comme je l'ai g√©r√©, en PHP (en fait notre application est en PHP, je le comprends plus qu'en Python). L'encodeur vient de moi, donc je ne montrerai pas mon code :) Le </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot vit dans notre r√©seau d'entreprise, il a acc√®s √† certains projets, y compris les bases de donn√©es cibles. Afin de ne pas d√©ranger les param√®tres de la commande ou du menu, j'ai viss√© cette fonctionnalit√© √† un chat de groupe avec des notifications de surveillance. Le bot sait donc imm√©diatement sur quelle base de donn√©es collecter le rapport. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayant re√ßu une commande de la forme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr N</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o√π N est le nombre d'heures compl√®tes pour lesquelles un rapport est n√©cessaire (par d√©faut - 1 heure), m√™me pendant une semaine, si la base de donn√©es ne red√©marre pas, le bot commence imm√©diatement √† travailler, collecte le rapport, le publie en tant que page Web et juste l√† (presque ici) donne un lien vers un rapport bien n√©cessaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous suivons le lien et le voici, le rapport AWR: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yr/tk/kiyrtktigm4qjsumovp2vl4roa0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme pr√©vu, les d√©veloppeurs ont fait face √† cette g√©n√©ration de rapport, a m√™me remerci√© quelqu'un. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayant appr√©ci√© la commodit√© de l'√©quipe, les chefs de projet des autres r√©gions ont souhait√© la m√™me chose, car ils </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obtiennent surtout du luli du client soucieux des</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performances et de la disponibilit√© des syst√®mes. Ajout d'un bot √† d'autres chats. Ils l'utilisent toujours, et je m'en r√©jouis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus tard, des coll√®gues du CIT ont √©crit sur la fa√ßon dont nous collectons les rapports, ils le voulaient √©galement. </font><font style="vertical-align: inherit;">Je ne les ai pas ajout√©s √† nos chats, j'ai cr√©√© un chat s√©par√© avec la g√©n√©ration de rapports sur un planning et sur demande.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ pgBadger</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d'autres applications en PHP en collaboration avec PostgreSQL. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impl√©mentation de la collecte du rapport pgBadger pour ceux qui en ont besoin sur le m√™me principe - dans les chats de groupe. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au d√©but, ils l'ont utilis√©, mais ils se sont arr√™t√©s. </font><font style="vertical-align: inherit;">D√©coupe fonctionnelle inutile.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ devoir</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre d√©partement, il y a des quarts de nuit et, en cons√©quence, il y a un horaire. </font><font style="vertical-align: inherit;">C'est dans google tables. </font><font style="vertical-align: inherit;">Il n'est pas toujours pratique de rechercher un lien, d'ouvrir un horaire, de chercher par vous-m√™me ... Un des anciens coll√®gues a √©galement jou√© avec son bot Telegram et a introduit des </font><b><font style="vertical-align: inherit;">notifications sur le d√©but d'un quart de travail pour les employ√©s</font></b><font style="vertical-align: inherit;"> du d√©partement dans le chat de notre d√©partement </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le bot analyse le programme, d√©termine le pr√©pos√© par la date du jour et, selon le programme ou sur demande, indique qui est en service aujourd'hui. </font><font style="vertical-align: inherit;">Cela s'est av√©r√© super, confortable. </font><font style="vertical-align: inherit;">C'est vrai, je n'ai pas vraiment aim√© le format du message. </font><font style="vertical-align: inherit;">De plus, pour les employ√©s d'un autre service (par exemple, le centre d'affaires ¬´M√©decine¬ª), les informations sur le service dans d'autres domaines ne sont pas vraiment n√©cessaires, mais vous devez savoir qui est de service en ¬´M√©decine¬ª en cas de probl√®me. </font><font style="vertical-align: inherit;">J'ai d√©cid√© ¬´d'emprunter¬ª la fonctionnalit√©, mais de changer ce que je n'aimais pas. </font><font style="vertical-align: inherit;">J'ai cr√©√© un format de message pratique pour moi et pour les autres, en supprimant les informations redondantes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ tnls</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le ¬´test de plume¬ª de l'automatisation via le bot Telegram, de nombreuses id√©es diff√©rentes sont apparues, mais je voulais faire les choses strictement n√©cessaires. J'ai d√©cid√© de tenir des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statistiques sur les appels.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour acc√©der aux projets de nos clients, nous avons mis en place ce que l'on appelle le ¬´serveur hop¬ª ou le serveur de transfert. Des connexions VPN y sont √©tablies, puis via ssh, des ports d'application, des bases de donn√©es et d'autres sondes auxiliaires sont transmis √† notre r√©seau local pour faciliter l'acc√®s aux projets de nos employ√©s, sans probl√®mes avec les connexions VPN. Il suffit de configurer une connexion VPN √† notre r√©seau d'entreprise.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les statistiques d'appels sugg√®rent que souvent, apr√®s la chute d'un des tunnels (en cas de probl√®me de r√©seau, par timeout par exemple), ils se retournent pour r√©tablir l'acc√®s au projet. </font><font style="vertical-align: inherit;">Dans la plupart des cas, il suffit de red√©marrer la connexion et tout se passe bien. </font><font style="vertical-align: inherit;">Faisons-le vous-m√™me. </font><font style="vertical-align: inherit;">Voici la commande: </font></font><br>
<img src="https://habrastorage.org/webt/pq/th/ad/pqthadwkyi0tegqd7tn2qzrpxws.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬´ Fall par ¬ª √† l'√©l√©ment de menu souhait√©, s√©lectionnez votre projet, attendez une minute et tout le </font><font style="vertical-align: inherit;">monde est heureux et satisfait ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quand une commande est re√ßue, par un l√©ger mouvement de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> octets et les </font><font style="vertical-align: inherit;">bits, les connecte bot au serveur de transfert, sachant √† l' </font><font style="vertical-align: inherit;">avance les besoins d'exp√©dition √† red√©marrer, et fait son travail - r√©tablit la connexion au projet. </font><font style="vertical-align: inherit;">J'ai √©crit des instructions pour r√©soudre ces probl√®mes par moi-m√™me. </font><font style="vertical-align: inherit;">Et nous n'avons √©t√© contact√©s que si l'outil fourni ne fonctionne pas ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ecp_to_pem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, les statistiques ont montr√© qu'il est souvent n√©cessaire de convertir la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signature num√©rique Crypto Pro au format pem</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) pour diverses int√©grations, et nous en avons beaucoup. T√¢che: vous prenez le conteneur, le copiez sur un ordinateur Windows avec l'utilitaire P12FromGostCSP install√© (soit dit en passant, pay√©), le convertissez en pfx et convertissez pfx en utilisant OpenSSL (avec prise en charge du cryptage GOST) en pem. Pas tr√®s pratique, mais je le veux au clic d'un doigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google est √† nouveau venu √† la rescousse. Trouv√© l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilit√© d'une personne aimable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Recueilli, comme √©crit dans le fichier README - gagn√©. Il a appris au bot √† travailler avec l'utilitaire et a obtenu une conversion presque instantan√©e.</font></font><br>
<img src="https://habrastorage.org/webt/aq/qo/yu/aqqoyu8qmwsrjbske46acai6bie.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment de la mise en ≈ìuvre finale, un ordre a √©t√© √©mis pour passer √† un nouveau format de cryptage - gost-2012. </font><font style="vertical-align: inherit;">Pour autant que je m'en souvienne, l'utilitaire √† ce moment-l√† ne fonctionnait qu'avec l'ancien GOST (2001), c'√©tait peut-√™tre g√©n√©ralement un autre utilitaire similaire d'une autre bonne personne, je ne me souviens pas exactement. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s la transition vers le nouveau GOST, la fonctionnalit√© du bot a √©t√© supprim√©e pour des raisons de s√©curit√©. </font><font style="vertical-align: inherit;">L'impl√©ment√© dans un conteneur Docker.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerfile, qui a soudainement besoin de:</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">FROM ubuntu:16.04                                                                                                                                                                        <font></font>
RUN apt update &amp;&amp; apt -y install git sudo wget unzip gcc g++ make &amp;&amp; \                       <font></font>
   cd /srv/ &amp;&amp; git clone https://github.com/kov-serg/get-cpcert.git &amp;&amp; \                    <font></font>
   cd get-cpcert &amp;&amp; chmod +x *.sh &amp;&amp; ./prepare.sh &amp;&amp; ./build.sh &amp;&amp; \                        <font></font>
   mkdir -p /srv/{in,out} &amp;&amp; \                                                              <font></font>
   echo '#!/bin/bash' &gt; /srv/getpem.sh &amp;&amp; \                                                 <font></font>
   echo 'cd /srv/get-cpcert' &gt;&gt; /srv/getpem.sh &amp;&amp; \                                         <font></font>
   echo './get-cpcert /srv/in/$CONT.000 $PASS &gt; /srv/out/$CONT.pem' &gt;&gt; /srv/getpem.sh &amp;&amp; \  <font></font>
   chmod +x /srv/getpem.sh                                                                  ENTRYPOINT /srv/getpem.sh</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour convertir, vous devez placer le conteneur source (un r√©pertoire de la forme xxx.000) dans le r√©pertoire / srv / in et r√©cup√©rer le pem fini dans / srv / out. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Convertir:</font></font><br>
<br>
<pre><code class="plaintext hljs"> docker run -t -i -e CONT='&lt;   ( ".000")&gt;' -e PASS='&lt;  &gt;' -v /srv/in:/srv/in -v /srv/out:/srv/out --name ecptopem &lt;  &gt;/med/ecptopem:latest </code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop et / emstart</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois, notre entreprise a obtenu un DBA Oracle tr√®s cool, avec plus d'exp√©rience dans l'administration du SGBD et dans le d√©veloppement. Et cela ne s'est pas produit tout de suite avec une connexion ssh aux serveurs SGBD: soit il ne sait pas o√π se connecter et comment, alors les acc√®s ne sont pas clairement d√©crits, il est impossible de se transmettre quelque chose. Eh bien, nous sommes heureux de vous aider, avons parl√© de la fa√ßon de vous connecter et avons transmis Enterprise Manager pour cela. Mais avec ssh, cela n'a toujours pas fonctionn√©. L'un des coll√®gues l'a expliqu√© simplement: pur-sang DBA :) Nous avons d√©cid√© que si nous devions resserrer quelque chose sur le serveur, nous le ferions nous-m√™mes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EM se bloque sous une charge lourde et le red√©marre ... vous devez vous connecter via ssh et red√©marrer via le terminal. </font><font style="vertical-align: inherit;">"Les administrateurs le savent bien", a d√©cid√© notre nouveau coll√®gue. </font><font style="vertical-align: inherit;">Les charges importantes sur le SGBD ne sont pas rares chez nous, les demandes de red√©marrage EM sont √©galement fr√©quentes. </font><font style="vertical-align: inherit;">Puis le m√™me sc√©nario: tension, irritation et recherche d'une solution au probl√®me. </font><font style="vertical-align: inherit;">Ainsi, dans le m√™me groupe de discussions, la commande: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop et / emstart est apparue.</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/kk/yd/8j/kkyd8jikdyflvrkkoqvyens8dym.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ tuer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cas de forte concurrence √† la base, et cela arrive parfois, vous devez d√©charger rapidement la base de donn√©es. </font><font style="vertical-align: inherit;">Le moyen le plus rapide est de tuer le processus probl√©matique ... Pour ce faire, connectez-vous via ssh, kill -9 ... Le bot vous aidera! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jb/8q/cs/jb8qcsft8ce6jp5e7rijqtvcjti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexey a appr√©ci√© l'√©quipe et lui a donn√© un nom affectueux - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Kilyalka¬ª</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou un pistolet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois, apr√®s avoir vu comment Alex essaye et souffre, chaque fois que vous entrez / tuez xxx pour chacun des processus, j'ai d√©cid√© d'ajouter du ¬´multilat√©ralisme¬ª √† notre arme: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/sc/kh/5dsckh_3qe5lhmvhop1pmxkt1hk.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est mieux! </font><font style="vertical-align: inherit;">Tout pour toi, Alex, travaille juste, mon cher! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturellement, l'acc√®s √† une commande aussi importante √©tait limit√© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par user_id - "protection contre le fou".</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Voyant comment Lesha clouait intelligemment les processus sur le serveur de base de donn√©es, plusieurs personnes ont essay√© d'entrer une commande avec un num√©ro de processus al√©atoire, mais vous ne pouvez pas tromper mon robot intelligent, il a imm√©diatement refus√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, juste au cas o√π, j'aurais fait une commande: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog &lt;nombre de lignes&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - obtenir le nombre sp√©cifi√© de lignes alertlog'a Le </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bot extrait alertlog et l'envoie √† notre service, tel que pastebin, appel√© pyste, et envoie un lien vers la p√¢te pour le chat de demande.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ch√®ques</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puis vint une demande de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surveillance des performances r√©elles de notre application.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jusqu'√† pr√©sent, le support technique du projet a collect√© ces donn√©es √† la main. Pas une affaire! Nos vaillants testeurs ont d√©velopp√© des cas de test pour cela. Le journal de test r√©sultant n'est pas tr√®s pratique √† lire, un utilisateur inexp√©riment√© comprendra longtemps et non le fait qu'il mettra en √©vidence les informations n√©cessaires. Et nous n'aimons pas faire de nos mains ce que nous ne pouvons pas faire de nos mains ... Une nouvelle t√¢che pour le bot! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/--/u6/1l/--u61ld0yk0fljkwuerjn3g8zsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande / checks affiche un menu simple et sans ambigu√Øt√©, cette fois, nos gars ont appris √† utiliser cette commande sans instructions! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous s√©lectionnez l'√©l√©ment souhait√©, au lieu du menu, une notification appara√Æt sur le d√©but du test afin que les utilisateurs impatients n'ex√©cutent pas notre test 100500 fois:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/xv/sv/j7xvsv_byo8gdw7y3qweig15msq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fonction de l'√©l√©ment de menu s√©lectionn√©, un test sp√©cifique est lanc√© depuis notre r√©seau, √† savoir depuis la machine o√π r√©side le bot (jmeter y est pr√©-configur√©, les tests n√©cessaires sont plac√©s ...) ou imm√©diatement depuis le centre de donn√©es (depuis la machine pr√©par√©e √† c√¥t√© de l'application), de sorte que lors du test √©liminez les retards du r√©seau, ou minimisez-les. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir termin√© le test et re√ßu le journal, le bot l'analyse et affiche le r√©sultat sous une forme ¬´lisible par l'homme¬ª:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/xp/s8/7wxps8jupg80bbq_uuywyz1-gag.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Collection de m√©triques</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La fonctionnalit√© est ¬´entr√©e¬ª et les chefs de projet qui le souhaitent ont re√ßu une telle fonction pour leurs r√©gions. Et un chef de projet compatissant a d√©clar√©: "Je veux avoir des statistiques √† temps!" Quelqu'un du CIT lui a dit qu'il serait pratique de surveiller tout cela dans Zabbix. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zabbix, donc Zabbix ... J'ai</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
pens√© qu'il fallait se pr√©parer √† la n√©cessit√© de dupliquer la solution ... J'ai con√ßu l'id√©e dans un conteneur docker. Dans le conteneur, selon le calendrier (toutes les 10 minutes), jmeter est lanc√©, ajoute le journal √† un endroit sp√©cifique, php le parse et affiche les donn√©es n√©cessaires sous la forme d'une page Web. Zabbix utilise la cl√© web.page.get pour obtenir cette page, s√©lectionne r√©guli√®rement les donn√©es n√©cessaires pour certains √©l√©ments d√©pendants et construit un graphique.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/aq/cd/oqaqcdqj2mjodianmnwmrucyix8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que ce ne soit pas mal. </font><font style="vertical-align: inherit;">En observant le graphique, nous voyons tout d'abord la vitesse approximative de l'application, et si des pics sont d√©tect√©s sur le graphique, nous savons √† peu pr√®s o√π se trouve le ¬´bouchon¬ª. </font><font style="vertical-align: inherit;">Tout est simple. </font><font style="vertical-align: inherit;">Jusqu'√† pr√©sent, il s'est av√©r√© √™tre en demande uniquement pour une r√©gion, mais je suis pr√™t √† le reproduire pour ceux qui le souhaitent.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppement d'applications</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a pas si longtemps, des statistiques sur des t√¢ches du m√™me type ont donn√© des id√©es pour simplifier et faciliter le travail. Sur certains projets, sur les serveurs d'applications, il est n√©cessaire d'installer les conteneurs de cl√©s de Crypto Pro, ils sont nombreux et la signature num√©rique expirera avec le temps. Parfois, 2 t√¢ches ¬´volent¬ª par jour. Mais j'ai consid√©r√© que l'utilisation du bot √† ces fins n'√©tait pas s√ªre et j'ai d√©cid√© de faire la fonctionnalit√© directement dans l'application. Naturellement avec autorisation et contr√¥le d'acc√®s. Si vous disposez des privil√®ges n√©cessaires, un √©l√©ment de menu suppl√©mentaire sera disponible pour travailler avec les signatures num√©riques, l'installation, la suppression, l'affichage des informations, etc. ... Pour le moment, la fonctionnalit√© est en cours de d√©veloppement. Il s'est av√©r√© que ce n'est pas tr√®s difficile, vous devez lire un peu les instructions, regarder des exemples de code, demander √† des coll√®gues plus exp√©riment√©s en d√©veloppement, et c'est parti.Au cours de la recherche, des id√©es sont apparues pour √™tre ajout√©es √† la demande. Je ne construirai pas de plans napol√©oniens - il y a du d√©veloppement, laissez chacun faire ce qu'il veut. Mais pour l'instant c'est int√©ressant - je le fais moi-m√™me.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des plans</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai dit, de nombreuses id√©es diff√©rentes sont n√©es pour utiliser notre bot et pas seulement - en g√©n√©ral, disons, des id√©es de ¬´points d'automatisation¬ª, beaucoup d'entre elles ont √©t√© oubli√©es, car je n'ai pas eu le temps de les √©crire. </font><font style="vertical-align: inherit;">Maintenant, j'essaie d'√©crire tout ce qui me vient √† l'esprit et je recommande aux autres de faire de m√™me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais Alex n'oublie pas de jeter sa Wishlist. </font><font style="vertical-align: inherit;">Parmi ces derniers: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_sql SQL_ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tue toutes les sessions avec une telle requ√™te SQL_ID </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tue la session de blocage racine </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ show_em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - montre une image de performance EM </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trick, veut </font><b><font style="vertical-align: inherit;">assembler</font></b><font style="vertical-align: inherit;"> DBA depuis le t√©l√©phone =) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est ainsi que nous travaillons pour le bien de la patrie! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et comment vous √©pargnez-vous des t√¢ches routini√®res et inint√©ressantes?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que la lecture s'est av√©r√©e int√©ressante, et peut-√™tre m√™me utile √† quelqu'un, et je n'ai pas r√©ussi √† fatiguer le lecteur ... Bonne chance √† nous tous.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495924/index.html">Pourquoi est-il si difficile de construire un bon mod√®le de distribution COVID-19?</a></li>
<li><a href="../fr495926/index.html">Nous √©crivons le firmware pour TI cc2530 sur Z-Stack 3.0 pour relais Zigbee Sonoff BASICZBR3 avec capteur ds18b20</a></li>
<li><a href="../fr495932/index.html">Quelle est la signification cach√©e des auteurs dans le guide SCRUM. Partie 1. √Ä propos du processus</a></li>
<li><a href="../fr495934/index.html">Gouvernance des donn√©es √† domicile</a></li>
<li><a href="../fr495938/index.html">Une s√©lection d'articles sur l'apprentissage automatique: cas, guides et √©tudes pour mars 2020</a></li>
<li><a href="../fr495944/index.html">Mise √† jour du TOP50 (classement des supercalculateurs CIS): dynamique et tendances</a></li>
<li><a href="../fr495946/index.html">Norbert Wiener: le p√®re distrait de la cybern√©tique</a></li>
<li><a href="../fr495948/index.html">Rouille int√©gr√©e. D√©veloppement pour les processeurs Cortex-M3 utilisant la carte de d√©bogage STM32F103C8T6 (Black Pill)</a></li>
<li><a href="../fr495954/index.html">Comment Cisco fonctionne-t-il en mode d'acc√®s √† distance et dans un p√©rim√®tre absent depuis 20 ans?</a></li>
<li><a href="../fr495956/index.html">Faut que vous y allez rapidement. Optimisation des demandes de contenu de messagerie IMAP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>