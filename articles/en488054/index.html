<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗒️ ⚖️ 👩🏿‍🌾 Relationships between Database Tables 👩🏿‍🤝‍👨🏼 🕤 🚭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction
 Communication is a rather important topic that should be understood when designing databases. From my own personal experience I’ll sa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Relationships between Database Tables</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488054/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Introduction</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Communication is a rather important topic that should be understood when designing databases. </font><font style="vertical-align: inherit;">From my own personal experience I’ll say that, having realized the connections, I was much easier to understand the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normalization of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the database.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">Who is this article for?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article will be useful for those who want to understand the relationships between database tables. </font><font style="vertical-align: inherit;">In it, I tried to tell in plain language what it is. </font><font style="vertical-align: inherit;">For a better understanding of the topic, I alternate theoretical material with practical examples presented in the form of a diagram and a query that creates the tables we need. </font><font style="vertical-align: inherit;">I use Microsoft SQL Server DBMS and I write queries in T-SQL. </font><font style="vertical-align: inherit;">The code I wrote should work on other DBMSs, since queries are universal and do not use specific T-SQL constructs.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">How can you apply this knowledge?</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The process of creating databases will become easier and more understandable for you. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Understanding the relationships between tables will help you to better understand normalization, which is very important when designing a database. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dealing with a foreign database will be much easier. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> At the interview, this will be a very good plus. </font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Acknowledgments</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The advice and criticism of the authors were taken into account. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jobgemws</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unfilled</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firnind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hamaruba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1. </font><font style="vertical-align: inherit;">How are communications organized?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links are created using foreign keys. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A foreign key is an attribute or set of attributes that reference the primary key or unique of another table. </font><font style="vertical-align: inherit;">In other words, it is something like a pointer to a row in another table.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2. </font><font style="vertical-align: inherit;">Types of Relations</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links are divided into:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Many to many.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to many.</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with obligatory connection;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with optional communication;</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to one.</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with obligatory connection;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with optional communication;</font></font></li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us consider in detail each of them.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Many to many</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine that we need to write a database that will be stored by an IT company employee. </font><font style="vertical-align: inherit;">At the same time, there is a certain standard set of posts. </font><font style="vertical-align: inherit;">Wherein:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An employee may have one or more posts. </font><font style="vertical-align: inherit;">For example, a certain employee can be both an administrator and a programmer.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A position may “own” one or more employees. </font><font style="vertical-align: inherit;">For example, admins are a specific set of workers. </font><font style="vertical-align: inherit;">In other words, some workers belong to admins.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Employees are represented by the Employee table (id, name, age), positions are represented by the Position table (id and position name). </font><font style="vertical-align: inherit;">As you can see, both of these tables are interconnected by the rule many to many: each employee has one or more positions (many positions), each position corresponds to one or more employees (many employees).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1. </font><font style="vertical-align: inherit;">How to build such tables?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We already have two tables describing the employee and the profession. </font><font style="vertical-align: inherit;">Now we need to establish many to many relationships between them. </font><font style="vertical-align: inherit;">To implement such a relationship, we need some kind of intermediary between the "Employee" and "Position" tables. </font><font style="vertical-align: inherit;">In our case, it will be a certain table “EmployeesPositions” (workers and positions). </font><font style="vertical-align: inherit;">This mediation table links the employee and the position as follows:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmployeeId</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PositionId</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the left are the employees (their id), on the right are the positions (their id). </font><font style="vertical-align: inherit;">Employees and positions on this table are indicated using id'shniki. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This table can be viewed from two sides:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, we say that the employee with id 1 is on the position with id 1. At the same time, pay attention to the fact that in this table the employee with id 1 has two positions: 1 and 2. That is, each employee on the left corresponds to a certain position on the right.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can also say that posts with id 3 belong to users with id 2 and 3. That is, each employee on the right has a certain employee on the left. </font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2. </font><font style="vertical-align: inherit;">Implementation</font></font></h3><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagram</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/xx/94/bv/xx94bv6prnqjfxfbvijuh5sbq5i.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T-SQL Code</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Employee<font></font>
(<font></font>
	EmployeeId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	EmployeeName <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	EmployeeAge <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">--   Employee .</span>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, N<span class="hljs-string">'John Smith'</span>, <span class="hljs-number">22</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, N<span class="hljs-string">'Hilary White'</span>, <span class="hljs-number">22</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">3</span>, N<span class="hljs-string">'Emily Brown'</span>, <span class="hljs-number">22</span>)<font></font>
<font></font>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Position<font></font>
(<font></font>
	PositionId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	PositionName <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">--   Position .</span>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Position(PositionId, PositionName) <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>, N<span class="hljs-string">'IT-director'</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Position(PositionId, PositionName) <span class="hljs-keyword">values</span>(<span class="hljs-number">2</span>, N<span class="hljs-string">'Programmer'</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Position(PositionId, PositionName) <span class="hljs-keyword">values</span>(<span class="hljs-number">3</span>, N<span class="hljs-string">'Engineer'</span>)<font></font>
<font></font>
<span class="hljs-comment">--   EmployeesPositions .</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.EmployeesPositions<font></font>
(<font></font>
	PositionId <span class="hljs-built_in">int</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">references</span> dbo.Position(PositionId),<font></font>
	EmployeeId <span class="hljs-built_in">int</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">references</span> dbo.Employee(EmployeeId),<font></font>
	primary <span class="hljs-keyword">key</span>(PositionId, EmployeeId)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.EmployeesPositions(EmployeeId, PositionId) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.EmployeesPositions(EmployeeId, PositionId) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.EmployeesPositions(EmployeeId, PositionId) <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.EmployeesPositions(EmployeeId, PositionId) <span class="hljs-keyword">values</span> (<span class="hljs-number">3</span>, <span class="hljs-number">3</span>)</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explanation</font></font></b><div class="spoiler_text">   foreign key     primary key  unique  .     <br>
<br>
<ul>
<li>  PositionId  EmployeesPositions   PositionId  Position;</li>
<li> EmployeeId  EmployeesPositions —   EmployeeId  Employee;</li>
</ul> <br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.3. </font><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To implement many-to-many relationships, we need a mediator between the two tables under consideration. </font><font style="vertical-align: inherit;">It must store two foreign keys, the first of which refers to the first table, and the second to the second.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. One to many</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is the most common connection between databases. </font><font style="vertical-align: inherit;">We consider it after linking many to many for comparison. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suppose we need to implement a certain database that records user data. </font><font style="vertical-align: inherit;">The user has: name, surname, age, phone numbers. </font><font style="vertical-align: inherit;">Moreover, each user can have one or more phone numbers (many phone numbers). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, we observe the following: a user can have many phone numbers, but it cannot be said that a specific user belongs to the phone number. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In other words, the phone belongs to only one user. </font><font style="vertical-align: inherit;">A user may own 1 or more phones (many). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we can see, this relationship is one to many.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1. </font><font style="vertical-align: inherit;">How to build such tables?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Users will be represented by a certain “Person” table (id, first name, last name, age), phone numbers will be represented by the “Phone” table. </font><font style="vertical-align: inherit;">It will look like this:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PhoneId</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personid</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phone number</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11 091-10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19 124-66</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21 972-02</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This table represents three phone numbers. </font><font style="vertical-align: inherit;">In this case, the phone numbers with id 1 and 2 belong to the user with id 5. But the number with id 3 belongs to the user with id 17. </font></font><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">If the “Phones” table had more attributes, we would safely add them to this table.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2. </font><font style="vertical-align: inherit;">Why aren't we doing an intermediary table here?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An intermediary table is only needed if we have a many-to-many relationship. </font><font style="vertical-align: inherit;">For the simple reason that we can consider it from two sides. </font><font style="vertical-align: inherit;">Like the EmployeesPositions table earlier:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each employee has several positions (many).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each position belongs to several employees (many).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But in our case, we cannot say that each phone has several users - only one user can belong to a phone number. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now read again the note at the end of paragraph 5.1. </font><font style="vertical-align: inherit;">- it will become more understandable for you.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.3. </font><font style="vertical-align: inherit;">Implementation</font></font></h4><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagram</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/h7/sz/4b/h7sz4bktrl3xj_u7insrwlw2fxs.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T-SQL Code</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Person<font></font>
(<font></font>
	PersonId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	FirstName <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	LastName <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	PersonAge <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Person(PersonId, FirstName, LastName, PersonAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">5</span>, N<span class="hljs-string">'John'</span>, N<span class="hljs-string">'Doe'</span>, <span class="hljs-number">25</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Person(PersonId, FirstName, LastName, PersonAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">17</span>, N<span class="hljs-string">'Izabella'</span>, N<span class="hljs-string">'MacMillan'</span>, <span class="hljs-number">19</span>)<font></font>
<font></font>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Phone<font></font>
(<font></font>
	PhoneId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	PersonId <span class="hljs-built_in">int</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">references</span> dbo.Person(PersonId),<font></font>
	PhoneNumber <span class="hljs-built_in">varchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Phone(PhoneId, PersonId, PhoneNumber) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-string">'11 091-10'</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Phone(PhoneId, PersonId, PhoneNumber) <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-string">'19 124-66'</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Phone(PhoneId, PersonId, PhoneNumber) <span class="hljs-keyword">values</span> (<span class="hljs-number">3</span>, <span class="hljs-number">17</span>, <span class="hljs-string">'21 972-02'</span>)
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explanation</font></font></b><div class="spoiler_text">  Phone     .      (    Person).  ,    : «     ».  ,   id  .<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. One to one</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine that at work you were given the task of writing a database to record all employees for HR. </font><font style="vertical-align: inherit;">The boss assured that the company needed to know only about the name, age and phone number of the employee. </font><font style="vertical-align: inherit;">You developed such a database and placed in it all 1000 employees of the company. </font><font style="vertical-align: inherit;">And then the boss says that for some reason they need to know about whether the employee is disabled or not. </font><font style="vertical-align: inherit;">The simplest thing that comes to mind is to add a new bool column to your table. </font><font style="vertical-align: inherit;">But it’s too long to enter 1000 values ​​and true you will enter much less often than false (2% will be true, for example). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An easier solution would be to create a new table, let's call it “DisabledEmployee”. </font><font style="vertical-align: inherit;">It will look like this:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DisabledPersonId</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmployeeId</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">159</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">722</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">937</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But this is not a one-to-one relationship. The fact is that in such a table an employee can be entered more than once; accordingly, we have received a one-to-many relationship: an employee can be disabled several times. It is necessary to make sure that the employee can be entered in the table only once, respectively, could be disabled only once. To do this, we need to indicate that the EmployeeId column can only store unique values. We just need to impose a unique constraint on the EmloyeeId column. This restriction reports that an attribute can </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">only</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> take </font><font style="vertical-align: inherit;">unique values. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By doing this, we got a one-to-one relationship. </font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The note</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Note that we could also impose a primary key constraint on the EmloyeeId attribute. </font><font style="vertical-align: inherit;">It differs from the unique constraint only in that it cannot be null.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1. </font><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can say that a one-to-one relationship is a division of the same table into two. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2. </font><font style="vertical-align: inherit;">Implementation</font></font></h3><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagram</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/tj/fc/wp/tjfcwp7oxhpw9dgdus6ly2djnr0.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T-SQL Code</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.Employee<font></font>
(<font></font>
	EmployeeId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	EmployeeName <span class="hljs-keyword">nvarchar</span>(<span class="hljs-number">128</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	EmployeeAge <span class="hljs-built_in">int</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">159</span>, N<span class="hljs-string">'John Smith'</span>, <span class="hljs-number">22</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">722</span>, N<span class="hljs-string">'Hilary White'</span>, <span class="hljs-number">29</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">937</span>, N<span class="hljs-string">'Emily Brown'</span>, <span class="hljs-number">19</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">100</span>, N<span class="hljs-string">'Frederic Miller'</span>, <span class="hljs-number">16</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">99</span>, N<span class="hljs-string">'Henry Lorens'</span>, <span class="hljs-number">20</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.Employee(EmployeeId, EmployeeName, EmployeeAge) <span class="hljs-keyword">values</span> (<span class="hljs-number">189</span>, N<span class="hljs-string">'Bob Red'</span>, <span class="hljs-number">25</span>)<font></font>
<font></font>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dbo.DisabledEmployee<font></font>
(<font></font>
	DisabledPersonId <span class="hljs-built_in">int</span> primary <span class="hljs-keyword">key</span>,<font></font>
	EmployeeId <span class="hljs-built_in">int</span> <span class="hljs-keyword">unique</span> <span class="hljs-keyword">foreign</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">references</span> dbo.Employee(EmployeeId)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.DisabledEmployee(DisabledPersonId, EmployeeId) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-number">159</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.DisabledEmployee(DisabledPersonId, EmployeeId) <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, <span class="hljs-number">722</span>)
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dbo.DisabledEmployee(DisabledPersonId, EmployeeId) <span class="hljs-keyword">values</span> (<span class="hljs-number">3</span>, <span class="hljs-number">937</span>)</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explanation</font></font></b><div class="spoiler_text"> DisabledEmployee   EmployeeId,    .     EmployeeId  Employee.  ,     unique,    ,         . ,           .<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Mandatory and optional communications</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relations can be divided into mandatory and optional.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1. </font><font style="vertical-align: inherit;">One to many</font></font></h3><br>
<ol>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to many with a mandatory connection:</font></font></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Many soldiers belong to one regiment. </font><font style="vertical-align: inherit;">One fighter belongs to only one regiment. </font><font style="vertical-align: inherit;">Please note that any soldier necessarily belongs to one regiment, and a regiment cannot exist without soldiers.</font></font></li>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to many with optional connection:</font></font></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
All people live on planet Earth. </font><font style="vertical-align: inherit;">Everyone lives only on Earth. </font><font style="vertical-align: inherit;">Moreover, a planet can exist without humanity. </font><font style="vertical-align: inherit;">Accordingly, finding us on Earth is optional</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The same relationship can be considered as mandatory and as optional. </font><font style="vertical-align: inherit;">Consider this example:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One biological mother can have many children. </font><font style="vertical-align: inherit;">A child has only one biological mother.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A) A woman doesn’t necessarily have her own children. </font><font style="vertical-align: inherit;">Accordingly, communication is optional. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
B) The child necessarily has only one biological mother - in this case, communication is required.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2. </font><font style="vertical-align: inherit;">One to one</font></font></h3><br>
<ol>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to one with a mandatory connection:</font></font></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
One citizen of a certain country must have only one passport of that country. </font><font style="vertical-align: inherit;">One passport has only one holder.</font></font></li>
<li><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to one with optional link:</font></font></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
One country can have only one constitution. </font><font style="vertical-align: inherit;">One constitution belongs to only one country. </font><font style="vertical-align: inherit;">But the constitution is not binding. </font><font style="vertical-align: inherit;">A country may or may not have it, as, for example, Israel and Great Britain.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The same connection can be considered as mandatory and as optional:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One person can have only one passport. </font><font style="vertical-align: inherit;">One passport has only one owner.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A) The presence of a passport is optional - a citizen may not have it. </font><font style="vertical-align: inherit;">This is an optional link. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
B) A passport must have only one owner. </font><font style="vertical-align: inherit;">In this case, this is already a mandatory connection.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3. </font><font style="vertical-align: inherit;">Many to many</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Any many-to-many relationship is optional. </font><font style="vertical-align: inherit;">For instance:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A person can invest in shares of different companies (many). </font><font style="vertical-align: inherit;">Some company’s investors are certain people (many).</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A) A person may not invest his money in stocks at all. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
B) Nobody could buy shares of the company.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. How to read charts?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Above, I gave diagrams of the tables we created. </font><font style="vertical-align: inherit;">But in order to understand them, you need to know how to "read" them. </font><font style="vertical-align: inherit;">We will understand this using the example of the diagram from paragraph 5.3. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h7/sz/4b/h7sz4bktrl3xj_u7insrwlw2fxs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We see a one-to-many relationship. </font><font style="vertical-align: inherit;">One person owns many phones.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Near the table Person is a golden key. </font><font style="vertical-align: inherit;">It denotes the word "one."</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Near the Phone table is an infinity sign. </font><font style="vertical-align: inherit;">It denotes the word "many."</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Summary</font></font></h3><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connections are:</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Many to many.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to many. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) with obligatory communication; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) with an optional link.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One to one. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) with obligatory communication; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) with an optional link.</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connections are organized using foreign keys.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A foreign key is an attribute or set of attributes that reference the primary key or unique of another table. </font><font style="vertical-align: inherit;">In other words, it is something like a pointer to a row in another table.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. Objectives</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For better assimilation of the material, I suggest you solve the following problems:</font></font><br>
<br>
<ol>
<li>  : id, , , ,  .    ,        ,       ,   .<br>
</li>
<li>  : id, , , .         ,       .</li>
<li>  : , , ,  <br>
<ul>
<li>   : id, , .</li>
<li>   : id, .</li>
</ul><br>
       ,    —  .       ,        .<br>
</li>
<li>     6.2.  -   ,      DisabledEmployee.</li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en488042/index.html">10/50/99: how to give feedback</a></li>
<li><a href="../en488046/index.html">The book "Development using quantum computers"</a></li>
<li><a href="../en488048/index.html">To illuminate with a searchlight. How to get maximum impact on "social" hackathons?</a></li>
<li><a href="../en488050/index.html">Amazon Neptune First Impressions</a></li>
<li><a href="../en488052/index.html">How to manipulate financial reporting - the example of Uber</a></li>
<li><a href="../en488056/index.html">Analysis of the new CAO regarding BVS flights</a></li>
<li><a href="../en488058/index.html">Graphing Dummies: A Step-by-Step Guide</a></li>
<li><a href="../en488060/index.html">Backblaze - 2019 hard drive statistics</a></li>
<li><a href="../en488062/index.html">Dynamics 365 & Power Platform Meetup at Lamoda - Report</a></li>
<li><a href="../en488064/index.html">Seven Reasons Why Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>