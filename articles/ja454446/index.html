<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹🏼 👸🏼 🕴🏻 C＃8の新機能 💔 🥚 👨🏾‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="G8はまだRTMもリリースしておらず、私はすでにそれについての投稿を書いています。何のために？まあ、基本的な考え方は、警告された人が武装しているということです。したがって、この投稿では、現在知られていることについて説明します。それがすべてセットアップである場合は、そうです。
 
 null可能な参照...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C＃8の新機能</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454446/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G8はまだRTMもリリースしておらず、私はすでにそれについての投稿を書いています。</font><font style="vertical-align: inherit;">何のために？</font><font style="vertical-align: inherit;">まあ、基本的な考え方は、警告された人が武装しているということです。</font><font style="vertical-align: inherit;">したがって、この投稿では、現在知られていることについて説明します。それがすべてセットアップである場合は、そうです。</font></font></p><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null可能な参照型</font></font></h3><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたが気付いているかどうかはわかりませんが、すべての現代言語の設計者は、少なくともいくつかの重要な側面を「解体」しています。</font><font style="vertical-align: inherit;">主なスタブの1つは初期化されていないオブジェクトであり</font></font><nobr><code>NULL</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Cおよび</font></font><nobr><code>nullptr</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近のC ++ </font><font style="vertical-align: inherit;">で重要なポインタ</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">別の側面は、文字列の長さがO（n）で計算される場合の、ゼロで終了する文字列です。</font><font style="vertical-align: inherit;">しかし、私たちは今、代弁してい</font></font><nobr><code>null</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＃これはもちろん、たとえば、次のような別の形になっています。</font></font></p><br>
<pre><code class="cs">public class Person<font></font>
{<font></font>
  public string FirstName { get; set; }<font></font>
  public string LastName { get; set; }<font></font>
  public string MiddleName { get; set; }<font></font>
  public Person(string first, string last, string middle) =&gt;<font></font>
    (FirstName, LastName, MiddleName) = (first, last, middle);<font></font>
  public string FullName =&gt;<font></font>
    $"{FirstName} {MiddleName[0]} {LastName}";<font></font>
}<font></font>
</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上記の例は問題を非常によく示しています。</font><font style="vertical-align: inherit;">ある人はミドルネームを持っているかもしれませんが、たとえば、私はパスポートにミドルネームを持っていないので、このフィールドに何を書くべきか明確ではありません。</font><font style="vertical-align: inherit;">C＃のデフォルトの文字列値はthis </font></font><nobr><code>null</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">この値を空の文字列に補間すると（</font></font><nobr><code>$</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">裏で行われます</font></font><nobr><code>string.Format()</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、問題はありません。</font><font style="vertical-align: inherit;">ただし、</font></font><nobr><code>null</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-valueの</font><font style="vertical-align: inherit;">最初の文字を取得しようとする</font><font style="vertical-align: inherit;">と、NRE（NullReferenceException）例外が発生します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この問題の根本的な解決策はありません。</font><font style="vertical-align: inherit;">突然禁止した場合は</font></font><nobr><code>null</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、100500の静的チェックを記述して、すべてのコンストラクターブランチのすべてのオブジェクトを初期化する必要があります。</font><font style="vertical-align: inherit;">または、</font></font><nobr><code>Optional</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型</font><font style="vertical-align: inherit;">に完全に移動し</font><font style="vertical-align: inherit;">ます。実際には、問題も完全には解決しません。</font></font></p><br>
<p>        -   ,    .      (NuGet  <nobr><code>JetBrains.Annotations</code></nobr>)         :</p><br>
<pre><code class="cs">public class Person<font></font>
{<font></font>
  public string FirstName { get; set; }<font></font>
  public string LastName { get; set; }<font></font>
  [CanBeNull] public string MiddleName { get; set; }<font></font>
  public Person(string first, string last, [CanBeNull] string middle) =&gt;<font></font>
    (FirstName, LastName, MiddleName) = (first, last, middle);<font></font>
  public string FullName =&gt;<font></font>
    $"{FirstName} {MiddleName[0]} {LastName}";<font></font>
}<font></font>
</code></pre><br>
<p>         NRE   <nobr><code>MiddleName[0]</code></nobr>.</p><br>
<p> </p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c0/fdb/077/8c0fdb077c01c3d76e3837e101530a61.png"></div><br>
<br>
<p> Microsoft…    ,      .   ,     VS     .    .     .</p><br>
<p>,      .    ,    .   ,  C#8    :</p><br>
<pre><code class="cs">#nullable enable
</code></pre><br>
<p>          . ,   - <br>
</p><br>
<pre><code class="cs">var p = new Person("Dmitri", "Nesteruk", null);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の警告が表示されます。</font></font><br>
<br>
<pre><code class="cs">1&gt;NullableReferenceTypes.cs(26,48,26,52): warning CS8625: Cannot convert null literal to non-nullable reference or unconstrained type parameter.
</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はい、はい、エラーではなく警告のみです（キャンセルされた人は誰も警告をエラーとして扱いません）。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さて、わかりました、次は何ですか？</font><font style="vertical-align: inherit;">そして、どういうわけかC＃に何らかの形で伝えたいと思い</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">理論的に</font></font><nobr><code>MiddleName</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><nobr><code>null</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、インデックスを使用したアクセス</font></font><nobr><code>[0]</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もチェックする必要</font><font style="vertical-align: inherit;">がある</font><font style="vertical-align: inherit;">理由</font><font style="vertical-align: inherit;">かもしれません</font><font style="vertical-align: inherit;">。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これを行うには、フィールドを次のように変更します。</font></font></p><br>
<pre><code class="cs">public string? MiddleName;
</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あれは何ですか？</font><font style="vertical-align: inherit;">それは</font></font><nobr><code>string?</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some </font></font><nobr><code>Nullable&lt;T&gt;</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">同等に</font><font style="vertical-align: inherit;">見えるかもしれ</font><font style="vertical-align: inherit;">ませんが、このタイプの内容を思い出させてください</font></font><nobr><code>T : struct</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。したがって</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">これは明らかに別のものです。</font><font style="vertical-align: inherit;">この質問は、コンパイラへのヒントにすぎません。</font><font style="vertical-align: inherit;">実際、フィールドタイプはまだ正常</font></font><nobr><code>string</code></nobr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これで、コンパイラーはインデックス0で別のアクセス警告を表示します。</font><font style="vertical-align: inherit;">そしてそれが機能するためには、例えば次のように書いて、どうにかして安全にプレイする必要があります：</font></font></p><br>
<pre><code class="cs">public string FullName =&gt;  $"{FirstName} {MiddleName?[0]} {LastName}";
</code></pre><br>
<p>   :     IL?      — !       :      nullable      nullable   <nobr><code>[Nullable]</code></nobr>.     :        .</p><br>
<h4>  </h4><br>
<p>  C#8   -    -.  ,        nullable-</p><br>
<pre><code class="cs">string? s = GetString();
</code></pre><br>
<p>          warning.     :</p><br>
<pre><code class="cs">if (s != null){  char c = s[0];}
</code></pre><br>
<p>   !  ,            .         .</p><br>
<h4>  </h4><br>
<p>      null.  —      «»,         ,          null-   .</p><br>
<p>  —           .   :</p><br>
<ul>
<li><p><nobr><code>(null as Person).FullName</code></nobr>    warning</p></li>
<li><p><nobr><code>(null as Person)!.FullName</code></nobr> warning   , ..      </p></li>
<li><p><nobr><code>(null as Person)!!!!!!!!!!!!!.FullName</code></nobr>        </p></li>
<li><p><nobr><code>(null as Person)!?.FullName</code></nobr>            <nobr><code>null</code></nobr>;    , <nobr><code>?!</code></nobr>,  </p></li>
</ul><br>
<h4>  </h4><br>
<p>,       -      BCL       .     </p><br>
<pre><code class="cs">Type t = Type.GetType("abracadabra");Console.WriteLine(t.Name);
</code></pre><br>
<p>    . -   <nobr><code>Type.GetType()</code></nobr>  <nobr><code>null</code></nobr>     ,   BCL     <nobr><code>nullable</code></nobr> ,   .</p><br>
<p> ,    «»    </p><br>
<pre><code class="cs">Type t = Type.GetType("abracadabra");<font></font>
Type? u = t;<font></font>
Console.WriteLine(u.Name);<font></font>
</code></pre><br>
<p>      . ,    <nobr><code>t != null</code></nobr>,  <nobr><code>u</code></nobr>      <nobr><code>null</code></nobr>,    .</p><br>
<h4></h4><br>
<p>Nullable reference types —   ,    .    .    , ,    -    nullability    ,   ,  .</p><br>
<h3>  </h3><br>
<p>     :   ,     ,  ,      . ,  X~N(0,1),   E[X²]  V[X²]?</p><br>
<p>   ,          ,       « ».</p><br>
<p>,        : <nobr><code>Index</code></nobr>  <nobr><code>Range</code></nobr>.</p><br>
<h4>Index</h4><br>
<p>   ,       <nobr><code>int</code></nobr>   <nobr><code>uint</code></nobr>?  :             ( ).      ,    C#  <nobr><code>x[-1]</code></nobr>   .</p><br>
<p>           .     ..     -1    ,         ,  .</p><br>
<p> C#       . ,   .  ,      <nobr><code>Index</code></nobr>      ,     :</p><br>
<pre><code class="cs">Index i0 = 2; // implicit conversion
</code></pre><br>
<p> ,   ,           .</p><br>
<p>   <nobr><code>Index</code></nobr>    (      —   ):</p><br>
<ul>
<li><p><nobr><code>Value</code></nobr>,      </p></li>
<li><p><nobr><code>IsFromEnd</code></nobr> —  , ,     <em></em>     </p></li>
</ul><br>
<p>     :</p><br>
<pre><code class="cs">Index i1 = new Index(0, false);
</code></pre><br>
<p> ,   ,     .     (  ,   )    :</p><br>
<pre><code class="cs">var i2 = ^0; // Index(0, true)
</code></pre><br>
<p>!     ,   <nobr><code>^</code></nobr>     (     , LaTeX,  ),           « ».</p><br>
<p> ,     ,     (<nobr><code>operator this[]</code></nobr>)   <nobr><code>Index</code></nobr>,     </p><br>
<pre><code class="cs">var items = new[] { 1, 2, 3, 4, 5 };<font></font>
items[^2] = 33; // 1, 2, 33, 4, 5<font></font>
</code></pre><br>
<h4>Range</h4><br>
<p>    —   <nobr><code>Range</code></nobr>,     ,      ,    1.      :</p><br>
<pre><code class="cs">X..Y
</code></pre><br>
<p>  «   X   Y».  ,       <nobr><code>Y</code></nobr>   — <em> </em>    <nobr><code>Y</code></nobr>.    .</p><br>
<p>,   :</p><br>
<ul>
<li><p><nobr><code>var a = i1..i2; // Range(i1, i2)</code></nobr> —       </p></li>
<li><p><nobr><code>var b = i1..; // Range(i1, new Index(0, true));</code></nobr> —   <nobr><code>i1</code></nobr>    </p></li>
<li><p><nobr><code>var c = ..i2; // Range(new Index(0, false), i2)</code></nobr> —         <nobr><code>i2</code></nobr></p></li>
<li><p><nobr><code>var e = ..;</code></nobr> —   ,        </p></li>
<li><p><nobr><code>Range.ToEnd(2);</code></nobr> —      —   ,     ;    ,     dotPeek, ilSpy   </p></li>
</ul><br>
<h4>   ?</h4><br>
<p>,    ++      (undefined behavior?).   ,   <nobr><code>Range</code></nobr>  C#   .    : <strong>       « »</strong>.</p><br>
<p>  <nobr><code>x = {1, 2, 3}</code></nobr>.   <nobr><code>x[0..2]</code></nobr>   <nobr><code>{1, 2}</code></nobr>,     <nobr><code>x[..2]</code></nobr>   <nobr><code>x[..]</code></nobr>,   <nobr><code>{1, 2, 3}</code></nobr>.</p><br>
<p>    ..  <nobr><code>x[2]</code></nobr>  <nobr><code>x[^1]</code></nobr> —   ,       <nobr><code>Range</code></nobr>- !</p><br>
<h4>  </h4><br>
<p>-,  <nobr><code>X..Y</code></nobr>     <nobr><code>X &lt;= Y</code></nobr> (   ?).        ( 7..3),     <nobr><code>ArgumentOutOfRangeException</code></nobr>.  <em></em>  ..           ,         .</p><br>
<p>-, «»    ,     <nobr><code>1..2..100</code></nobr>     .    .       MATLAB.</p><br>
<p><nobr><code>Range</code></nobr>       :</p><br>
<ul>
<li><p> ,    ,    </p></li>
<li><p>    <nobr><code>Substring()</code></nobr>.   C#      .</p></li>
<li><p>    <nobr><code>AsSpan()</code></nobr>   <nobr><code>Range</code></nobr>.</p></li>
<li><p> <nobr><code>Span</code></nobr>    <nobr><code>Range</code></nobr> — <nobr><code>Span.Slice()</code></nobr>,  -.</p></li>
</ul><br>
<p>,      <nobr><code>Index/Range</code></nobr>        <nobr><code>operator this[]</code></nobr>.    ,       « »  . ,      (singly linked list),   - « » —  .</p><br>
<h4></h4><br>
<p>   ,             <nobr><code>struct</code></nobr>-. -     , «»      ,       .</p><br>
<p> ,      :</p><br>
<p> </p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/283/851/1e5/2838511e5010e3966e830e753d0696be.png"></div><br>
<br>
<h3>Default Interface Members</h3><br>
<p>          ,        .   ,     — ?</p><br>
<p>   .      <nobr><code>Enumerable.Count()</code></nobr> —      <nobr><code>while (x.MoveNext())</code></nobr>      ,    .     <nobr><code>Count()</code></nobr>  :</p><br>
<pre><code class="cs">if (x is IList&lt;T&gt; list)<font></font>
  return list.Count;<font></font>
</code></pre><br>
<p>?    <nobr><code>IReadOnlyList&lt;T&gt;</code></nobr>,     ?   « »?!?</p><br>
<p>,      ,    open-closed principle     SOLID, ..         —   .</p><br>
<p>   ? ,   ,  , -     <nobr><code>Count()</code></nobr>,   <nobr><code>IReadOnlyList&lt;T&gt;</code></nobr>,   ,    .     !     - <nobr><code>IReadOnlyList&lt;T&gt;.Count()</code></nobr>    <nobr><code>IEnumerable&lt;T&gt;.Count()</code></nobr>? ,  !   .</p><br>
<p>       .    , - -,        .</p><br>
<h4> </h4><br>
<p>        :</p><br>
<pre><code class="cs">public interface IHuman<font></font>
{<font></font>
  string Name { get; set; }<font></font>
    <font></font>
  public void SayHello() <font></font>
  {<font></font>
    Console.WriteLine($"Hello, I am {Name}");<font></font>
  }<font></font>
}<font></font>
<font></font>
public class Human : IHuman<font></font>
{<font></font>
  public string Name { get;set; }<font></font>
}<font></font>
</code></pre><br>
<p>  ,     ,     :</p><br>
<pre><code class="cs">Human human = new Human() { Name = "John" };<font></font>
human.SayHello(); // will not compile<font></font>
</code></pre><br>
<p> ?  ,  .     —   ,   ,        ,        .</p><br>
<p>,  ? ,       ,    <strong> </strong>,     .        <nobr><code>Human</code></nobr>  <em></em> <nobr><code>SayHello()</code></nobr>? ,  .</p><br>
<p>    :       ,          :</p><br>
<pre><code class="cs">IHuman human = new Human() { Name = "John" };<font></font>
human.SayHello();<font></font>
((IHuman)new Human { … }).SayHello();<font></font>
</code></pre><br>
<h4> </h4><br>
<p>,    ,     :       <nobr><code>Foo()</code></nobr> (  ),            <nobr><code>Foo()</code></nobr>,     :</p><br>
<pre><code class="cs">public interface IHuman<font></font>
{<font></font>
  string Name { get; set; }<font></font>
  <font></font>
  void SayHello() <font></font>
  {<font></font>
    Console.WriteLine($"Hello, I am {Name}");<font></font>
  }<font></font>
}<font></font>
public interface IFriendlyHuman : IHuman<font></font>
{<font></font>
  void SayHello()<font></font>
  {<font></font>
    Console.WriteLine(      $"Greeting, my name is {Name}");<font></font>
  }<font></font>
}<font></font>
((IHuman)new Human()).SayHello();<font></font>
// Hello, I am John<font></font>
((IFriendlyHuman)new Human()).SayHello();<font></font>
// Greeting, my name is John<font></font>
</code></pre><br>
<p>,     <nobr><code>IFriendlyHuman.SayHello()</code></nobr>    override- <nobr><code>IHuman.SayHello()</code></nobr>,    !       <nobr><code>SayHello()</code></nobr>   ?     :</p><br>
<pre><code class="cs">public interface IFriendlyHuman : IHuman<font></font>
{<font></font>
  void IHuman.SayHello()<font></font>
  //   ↑↑↑↑↑↑<font></font>
  {<font></font>
    Console.WriteLine(      $"Greeting, my name is {Name}");<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
<p>     <nobr><code>SayHello()</code></nobr>   ,   <nobr><code>IHuman</code></nobr>  <nobr><code>IFriendlyHuman</code></nobr>      ,      :</p><br>
<pre><code class="cs">((IHuman)new Human()).SayHello();<font></font>
Greeting, my name is John<font></font>
((IFriendlyHuman)new Human()).SayHello();<font></font>
Greeting, my name is John<font></font>
</code></pre><br>
<h4>Diamond Inheritance</h4><br>
<p>,        « override-»   -    ,      :</p><br>
<pre><code class="cs">interface ITalk { void Greet(); }<font></font>
interface IAmBritish : ITalk<font></font>
{<font></font>
  void ITalk.Greet() =&gt; WriteLine("Good day!");<font></font>
}<font></font>
interface IAmAmerican : ITalk<font></font>
{<font></font>
  void ITalk.Greet() =&gt; WriteLine("Howdy!");<font></font>
}<font></font>
class DualNational : IAmBritish, IAmAmerican {}<font></font>
// Error CS8705 Interface member 'ITalk.Greet()' does not have a most specific implementation. Neither 'IAmBritish.ITalk.Greet()', nor 'IAmAmerican.ITalk.Greet()' are most specific.<font></font>
</code></pre><br>
<p>   ,      « » ( ,    )    ,   ,       -  - <nobr><code>IAmAmerican.Greet()</code></nobr> —        ,   -,   ?</p><br>
<h4></h4><br>
<p>   .       ,   ,  ,              API.    —       -.     -?</p><br>
<h3>Pattern Matching</h3><br>
<p>     F#      .  —  F#     ,         ,   # ,       .</p><br>
<p>   ,  F# <nobr><code>match</code></nobr>  # <nobr><code>switch</code></nobr>.  C#8     .</p><br>
<h4>Property Matching</h4><br>
<p>      ,    :</p><br>
<pre><code class="cs">struct PhoneNumber{<font></font>
  public int Code, Number;<font></font>
}<font></font>
var phoneNumber = new PhoneNumber();<font></font>
var origin = phoneNumber switch {<font></font>
  { Number: 112 } =&gt; "Emergency",<font></font>
  { Code: 44 } =&gt; "UK"<font></font>
};<font></font>
</code></pre><br>
<p>     <nobr><code>phoneNumber</code></nobr>,      .      switch statement  switch <em>expression</em>,       - .</p><br>
<p>   ,   — ,      .     :       default-init ( ,  <nobr><code>default(T)</code></nobr>         )    .   ,      ,   :</p><br>
<p> </p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9d/506/4c1/d9d5064c140536ff7f868a453ac27237.png"></div><br>
<br>
<p>          :</p><br>
<p> </p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21a/d2f/273/21ad2f273af8e46689b97b998cbdf616.png"></div><br>
<br>
<h4></h4><br>
<p>         ,     ,    :</p><br>
<pre><code class="cs">var origin = phoneNumber switch {<font></font>
  { Number: 112 } =&gt; "Emergency",<font></font>
  { Code: 44 } =&gt; "UK",<font></font>
  { } =&gt; "Indeterminate",<font></font>
  _ =&gt; "Missing"<font></font>
};<font></font>
</code></pre><br>
<p>  ?  ,    2 : <nobr><code>_</code></nobr> (),     ,  <nobr><code>{}</code></nobr>       <nobr><code>null</code></nobr>.</p><br>
<p>     ,        .     ?</p><br>
<pre><code class="cs">var origin = phoneNumber switch {<font></font>
  { Number: 112 } =&gt; "Emergency",<font></font>
  { Code: 44 } =&gt; "UK",<font></font>
  { } =&gt; "Unknown"<font></font>
};<font></font>
</code></pre><br>
<p>     ?  <nobr><code>phoneNumber</code></nobr>  <nobr><code>struct</code></nobr> —   ,     <nobr><code>class</code></nobr>.    -    ,     <nobr><code>null</code></nobr>, …   nullable reference types!</p><br>
<p>  ,                .</p><br>
<h4> </h4><br>
<p>-       ,   .  nullable reference types —  ,     nullable <em> </em>,   recursive patterns —     .</p><br>
<p> F#,     ,        .  C# ,     ,     ,     C# —  .</p><br>
<p> , « »  C#              -,    :</p><br>
<pre><code class="cs">var personsOrigin = person switch {<font></font>
  { Name: "Dmitri" } =&gt; "Russia",<font></font>
  { PhoneNumber: { Code: 46 } } =&gt; "Sweden",<font></font>
  { Name: var name } =&gt; $"No idea where {name} lives"<font></font>
};<font></font>
</code></pre><br>
<p>      .  —  ,      <nobr><code>person.PhoneNumber</code></nobr>     <nobr><code>Code</code></nobr>   <nobr><code>46</code></nobr>.  —                   .     ,         «».</p><br>
<h4></h4><br>
<p>    :          <nobr><code>switch</code></nobr>-.  :</p><br>
<pre><code class="cs">var error = person switch {<font></font>
  null =&gt; "Object missing",<font></font>
  { PhoneNumber: null } =&gt; "Phone number missing entirely",<font></font>
  { PhoneNumber: { Number: 0 } } =&gt; "Actual number missing",<font></font>
  { PhoneNumber: { Code: var code } } when code &lt; 0 =&gt; "WTF?",<font></font>
  { } =&gt; null // no error<font></font>
};<font></font>
if (error != null)<font></font>
  throw new ArgumentException(error);<font></font>
</code></pre><br>
<p> ,      :    ,    <nobr><code>when</code></nobr>          ,    .</p><br>
<h4>    </h4><br>
<p>-  «»         .     ,      :</p><br>
<pre><code class="cs">IEnumerable&lt;int&gt; GetMainOfficeNumbers()<font></font>
{<font></font>
  foreach (var pn in numbers)<font></font>
  {<font></font>
    if (pn is ExtendedPhoneNumber { Office: "main" })<font></font>
      yield return pn.Number;<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
<p>         ,   ,           .  .</p><br>
<h4></h4><br>
<p>      —    ,  ,    .       <nobr><code>Deconstruct()</code></nobr>       <nobr><code>out</code></nobr>-.</p><br>
<p> ,       -   :</p><br>
<pre><code class="cs">var type = shape switch<font></font>
{<font></font>
  Rectangle((0, 0), 0, 0) =&gt; "Point at origin",<font></font>
  Circle((0, 0), _) =&gt; "Circle at origin",<font></font>
  Rectangle(_, var w, var h) when w == h =&gt; "Square",<font></font>
  Rectangle((var x, var y), var w, var h) =&gt;<font></font>
    $"A {w}×{h} rectangle at ({x},{y})",<font></font>
  _ =&gt; "something else"<font></font>
};<font></font>
</code></pre><br>
<p>         ,    :   -,      ,     .       «» —     ,     .  (<nobr><code>_</code></nobr>)     ,    .</p><br>
<h4></h4><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらのアプリケーションを見つけるために必要で便利な機能。</font><font style="vertical-align: inherit;">検証と類似タイプの分析は非常に簡潔になります。</font></font></p><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何、すべての機能を表示しなかったのですか？</font><font style="vertical-align: inherit;">ええ、私は実際には約束しませんでした。</font><font style="vertical-align: inherit;">開始するには十分です。</font><font style="vertical-align: inherit;">言語がリリースされるまで、私はまだ少し調査することができます。</font><font style="vertical-align: inherit;">探索したい場合は、VS 2019 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preview</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（はい、プレビューバージョンでRTMではありません）、. NET Core 3（上記の多くは単に.NET Frameworkでサポートされていません）が必要です。dotPeekも理解に役立ちます舞台裏で何が。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それは今のところすべてです。</font><font style="vertical-align: inherit;">続行する（おそらく）は次のとおりです。</font><font style="vertical-align: inherit;">■</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454436/index.html">ペティペティジョイ＃1：ログル</a></li>
<li><a href="../ja454438/index.html">一輪車の乗り方を学ぶには？</a></li>
<li><a href="../ja454440/index.html">ペティリトルファン＃2：スターレット</a></li>
<li><a href="../ja454442/index.html">ビジネス用のプロキシネットワークを選択する方法：3つの実用的なヒント</a></li>
<li><a href="../ja454444/index.html">Habrの読み込み、またはページの189リクエストがどのように影響を与えるかをプロファイルします</a></li>
<li><a href="../ja454450/index.html">エジソンがワイヤレスを発明し、何も理解しなかった方法</a></li>
<li><a href="../ja454452/index.html">特定のルールに従って、認識された画像にコンテンツを表示します</a></li>
<li><a href="../ja454456/index.html">Cisco 200-125 CCNA v3.0のトレーニング。7日目。FAQ</a></li>
<li><a href="../ja454458/index.html">変成テスト：この有望な手法について誰も知らない理由</a></li>
<li><a href="../ja454460/index.html">モバイル＃300開発者向けの興味深い資料のダイジェスト（5月27日-6月2日）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>