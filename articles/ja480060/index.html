<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ· ğŸ•• ğŸ¢ ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã®å˜ç´”ãªP300åˆ†é¡å™¨ âšœï¸ ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘ğŸ» ğŸ”Ÿ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç§ã®åŒåƒšã®ãƒ©ãƒ•ã‚¡ã‚¨ãƒ«ãƒ»ã‚°ãƒªã‚´ãƒªã‚¢ãƒ³ eegdude æœ€è¿‘ã€äººé¡ãŒè„³æ³¢ã‚’å¿…è¦ã¨ã—ãŸç†ç”±ã¨ãã®ä¸­ã«è¨˜éŒ²ã§ãã‚‹é‡è¦ãªç¾è±¡ã«ã¤ã„ã¦ã®è¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚ä»Šæ—¥ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ãƒˆãƒ”ãƒƒã‚¯ã®ç¶šãã§ã€P300åŠ›å­¦ã‚’ä½¿ç”¨ã—ã¦ã‚²ãƒ¼ãƒ ã«è¨˜éŒ²ã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®1ã¤ã‚’ä½¿ç”¨ã—ã¦ã€EEGä¿¡å·ã‚’è¦–è¦šåŒ–ã—ã€å‘¼ã³å‡º...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã®å˜ç´”ãªP300åˆ†é¡å™¨</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480060/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ã®åŒåƒšã®ãƒ©ãƒ•ã‚¡ã‚¨ãƒ«ãƒ»ã‚°ãƒªã‚´ãƒªã‚¢ãƒ³ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eegdude</font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€è¿‘</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€äººé¡ãŒè„³æ³¢ã‚’å¿…è¦ã¨ã—ãŸç†ç”±ã¨ãã®ä¸­ã«è¨˜éŒ²ã§ãã‚‹é‡è¦ãªç¾è±¡ã«ã¤ã„ã¦ã®è¨˜äº‹ã‚’</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">æ›¸ã</font></a><font style="vertical-align: inherit;">ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ä»Šæ—¥ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®ãƒˆãƒ”ãƒƒã‚¯ã®ç¶šãã§ã€P300åŠ›å­¦ã‚’ä½¿ç”¨ã—ã¦ã‚²ãƒ¼ãƒ ã«è¨˜éŒ²ã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®1ã¤ã‚’ä½¿ç”¨ã—ã¦ã€EEGä¿¡å·ã‚’è¦–è¦šåŒ–ã—ã€å‘¼ã³å‡ºã•ã‚ŒãŸãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ§‹é€ ã‚’ç¢ºèªã—ã€ä¸»è¦ãªåˆ†é¡å­ã‚’æ§‹ç¯‰ã—ã€ãã®ã‚ˆã†ãªå‘¼ã³å‡ºã•ã‚ŒãŸãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å­˜åœ¨ã‚’äºˆæ¸¬ã§ãã‚‹å“è³ªã‚’è©•ä¾¡ã—ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P300ã¯ã€å‘¼ã³å‡ºã•ã‚ŒãŸãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆVPï¼‰ã§ã‚ã‚Šã€åˆºæ¿€ã®æ„æ€æ±ºå®šã¨åˆ†åŒ–ï¼ˆä»¥ä¸‹ã§èª¬æ˜ã—ã¾ã™ï¼‰ã«é–¢é€£ã™ã‚‹è„³ã®ç‰¹å®šã®å¿œç­”ã§ã‚ã‚‹ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯é€šå¸¸ã€æœ€æ–°ã®BCIã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EEGåˆ†é¡ã‚’è¡Œã†ã«ã¯ã€å‹é”ã«é›»è©±ã—ã¦ã€VRã§ã‚¢ãƒ©ã‚¤ã‚°ãƒã¨ãƒ‡ãƒ¼ãƒ¢ãƒ³ã«ã¤ã„ã¦ã®ã‚²ãƒ¼ãƒ ã‚’æ›¸ãã€è‡ªåˆ†ã®åå¿œã‚’æ›¸ãç•™ã‚ã¦ã€ç§‘å­¦è¨˜äº‹ã‚’æ›¸ãã¾ã™ï¼ˆã“ã‚Œã«ã¤ã„ã¦ã¯ã¾ãŸå¾Œã§è©±ã—ã¾ã™ï¼‰ãŒã€å¹¸ã„ã«ã‚‚ä¸–ç•Œä¸­ã®ç§‘å­¦è€…ãŒç§ãŸã¡ã®ãŸã‚ã«ã„ãã¤ã‹ã®å®Ÿé¨“ã‚’è¡Œã„ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®ã‚³ãƒ¼ãƒ‰ã¨è¦–è¦šåŒ–ã€ãŠã‚ˆã³ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ãƒªãƒ³ã‚¯ã‚’ä½¿ç”¨ã—ã¦P300ã§ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã®åˆ†æã¯ã€çŒ«ã®ä¸‹ã«ã‚ã‚Šã¾ã™ã€‚</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ã¯ã€ã‚³ãƒ¼ãƒ‰ã®è¦ç‚¹ã®ã¿ã‚’ç¤ºã—ã¦ã„</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™ã€‚ã“ã“</font></a><font style="vertical-align: inherit;">ã§ã¯ã€jupyterãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">æ¤œç´¢</font></a><font style="vertical-align: inherit;">ã§å®Œå…¨ã«å†ç¾å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¤ºã—</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦ã„ã¾ã™ã€‚</font></font></a></p><br>
<p>    P300          .     , ,     ,       ( , ,    -).        </p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wKDimrzvwYA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p>    :       (  3  7) .          (  â€”   ),       .                ,       (     ).       ,      .             (  ,        ).    ,           +.     P300 speller,  .</p><br>
<p>  ,  ,   (  )      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">space inviders</a>.    </p><br>
<p><img src="https://habrastorage.org/webt/xg/yb/du/xgybdulftmr0dpr4muypl7avlro.png" alt="è„³ã®ã‚¤ãƒ³ãƒã‚¤ãƒ€ãƒ¼ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤"></p><br>
<p>-,    ,      .<br>
  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></p><br>
<p>  ,    ,            .    16      ,        ( ),   ,      .</p><br>
<p>   BCI   ,   ,      ,      :    <code>.mat</code>   ""  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>.edf</code></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>.gdf</code></a>.<br>
 ,       â€”          .<br>
     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">NeuroTechX</a>        numpy.<br>
     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">moabb</a>      BCI.</p><br>
<h2 id="zagruzka-syrogo-dataseta">  </h2><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> moabb.datasets<font></font>
sampling_rate = <span class="hljs-number">512</span><font></font>
<font></font>
m_dataset = moabb.datasets.bi2013a(<font></font>
    NonAdaptive=<span class="hljs-literal">True</span>,<font></font>
    Adaptive=<span class="hljs-literal">True</span>,<font></font>
    Training=<span class="hljs-literal">True</span>,<font></font>
    Online=<span class="hljs-literal">True</span>,<font></font>
)<font></font>
m_dataset.download()<font></font>
m_data = m_dataset.get_data()</code></pre><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">RawEDF</a>,   .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>mne</code></a>,        :        , ,       .        ..       (  <code>0.19</code>,     <code>0.17</code> ..      )   ,       .</p><br>
<p>      â€”     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 10-20</a>.        ,   ,          .       10-10 (  10-20    )     ,      .<br>
<img src="https://habrastorage.org/webt/j0/x0/uq/j0x0uq27-vjl277bgamcuuz3qpy.jpeg" alt="ã‚·ã‚¹ãƒ†ãƒ 10-10"></p><br>
<pre><code class="python hljs">print(m_data[<span class="hljs-number">1</span>][<span class="hljs-string">'session_1'</span>][<span class="hljs-string">'run_1'</span>])
<span class="hljs-comment"># &lt;RawEDF  |  1.gdf, n_channels x n_times : 17 x 159232 (311.0 sec), ~20.7 MB, data loaded&gt;</span><font></font>
<font></font>
channels = m_data[<span class="hljs-number">1</span>][<span class="hljs-string">'session_1'</span>][<span class="hljs-string">'run_1'</span>].ch_names[:<span class="hljs-number">-1</span>]<font></font>
channels<font></font>
<font></font>
<span class="hljs-comment"># ['FP1', 'FP2', 'F5', 'AFz', 'F6', 'T7', 'Cz', 'T8', 'P7', 'P3', 'Pz', 'P4', 'P8', 'O1', 'Oz', 'O2']</span>
</code></pre><br>
<p>             16        (      ,       ).</p><br>
<p>          ,         .</p><br>
<pre><code class="python hljs">raw_dataset = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> _, sessions <span class="hljs-keyword">in</span> sorted(m_data.items()):<font></font>
    eegs, markers = [], []<font></font>
    <span class="hljs-keyword">for</span> item, run <span class="hljs-keyword">in</span> sorted(sessions[<span class="hljs-string">'session_1'</span>].items()):<font></font>
        data = run.get_data()<font></font>
        eegs.append(data[:<span class="hljs-number">-1</span>])<font></font>
        markers.append(data[<span class="hljs-number">-1</span>])<font></font>
    raw_dataset.append((eegs, markers))</code></pre><br>
<h2 id="filtraciya-i-razdelenie-na-epohi">    </h2><br>
<p>           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>    .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>  .</p><br>
<p>       3 :</p><br>
<ul>
<li></li>
<li></li>
<li></li>
</ul><br>
<p>        <code>sklearn</code>-        ,       .<br>
     ,    .</p><br>
<p><strong></strong></p><br>
<p>-                 <code>eeg = eeg[:, ::10]</code>.    ( â€” .     ).    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>  scipy</code></a>.</p><br>
<p><strong></strong></p><br>
<p>       <code>scipy</code>,  bandpass   4          (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>filtfilt</code></a>)   .   â€”  0.5  20 ,      .</p><br>
<p><strong></strong></p><br>
<p>   <code>StandardScaler</code> ( ,    ),      .           .. ,       ,           .<br>
    ,            ,       (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-  ()</a>)</p><br>
<p>          (,  ,  ),      ,       .</p><br>
<pre><code class="python hljs">reload(transformers)<font></font>
<font></font>
decimation_factor = <span class="hljs-number">10</span><font></font>
final_rate = sampling_rate // decimation_factor<font></font>
epoch_duration = <span class="hljs-number">0.9</span> <span class="hljs-comment"># seconds</span><font></font>
epoch_count = int(epoch_duration * final_rate)<font></font>
<font></font>
eeg_pipe = make_pipeline(<font></font>
    transformers.Decimator(decimation_factor),<font></font>
    transformers.ButterFilter(sampling_rate // decimation_factor, <span class="hljs-number">4</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">20</span>),<font></font>
    transformers.ChannellwiseScaler(StandardScaler()),<font></font>
)<font></font>
markers_pipe = transformers.MarkersTransformer(labels_mapping, decimation_factor)</code></pre><br>
<p>              .             0.5-1 ,      900 ,     .</p><br>
<p>   16  ,       50 ,        <code>(16, 45)</code> â€” 900   50   45  .</p><br>
<p>      â€”    ( , , 1)    (, 0) .</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> eegs, _ <span class="hljs-keyword">in</span> raw_dataset:<font></font>
    eeg_pipe.fit(eegs)<font></font>
<font></font>
dataset = []<font></font>
<font></font>
<span class="hljs-keyword">for</span> eegs, markers <span class="hljs-keyword">in</span> raw_dataset:<font></font>
    epochs = []<font></font>
    labels = []<font></font>
    filtered = eeg_pipe.transform(eegs)<font></font>
    markups = markers_pipe.transform(markers)<font></font>
    <span class="hljs-keyword">for</span> signal, markup <span class="hljs-keyword">in</span> zip(filtered, markups):<font></font>
        epochs.extend([signal[:, start:(start + epoch_count)] <span class="hljs-keyword">for</span> start <span class="hljs-keyword">in</span> markup[:, <span class="hljs-number">0</span>]])<font></font>
        labels.extend(markup[:, <span class="hljs-number">1</span>])<font></font>
    dataset.append((np.array(epochs), np.array(labels)))</code></pre><br>
<pre><code class="python hljs">dataset[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>].shape, dataset[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>].shape
<span class="hljs-comment"># ((1308, 16, 45), (1308,))</span></code></pre><br>
<p>        <code>Pytorch</code>       .        -    ,         (.. transfer learning, calibration-less prediction).          .           .</p><br>
<h2 id="issledovanie-i-vizualizaciya-dannyh">   </h2><br>
<p>           .</p><br>
<p>   ,    ,      -      - .</p><br>
<p><img src="https://habrastorage.org/webt/mb/xy/js/mbxyjsh7g4ch3an8smi2wtpujpw.png" alt="ã‚²ãƒ¼ãƒ ã®1å›ã®å®Ÿè¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸEEGä¿¡å·"></p><br>
<p>          ,       400-600 .        P300.</p><br>
<p><img src="https://habrastorage.org/webt/eu/v9/k-/euv9k-t6w0nss44m2fnvt_mrhxs.png" alt="p300ã‚¨ãƒãƒƒã‚¯"></p><br>
<p>     35  ,    .      1300  1750 (   ,  -   ,  - ).</p><br>
<p>     : 1  5     ..     6          â€” .         .</p><br>
<p><img src="https://habrastorage.org/webt/ed/7n/jb/ed7njbim3sdcge3lpb-_ll8ucls.png" alt="ã‚¯ãƒ©ã‚¹ãƒãƒ©ãƒ³ã‚¹"></p><br>
<p>         </p><br>
<p><img src="https://habrastorage.org/webt/c5/tx/oa/c5txoadzfwl8qzg8t-29siuftnw.png" alt="ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å¹³å‡å¿œç­”"></p><br>
<p>    ,      ,         180,      ,        250  500  â€”     P300.</p><br>
<p>         ,           ,  ,       â€”    .      ,   -  P300       .</p><br>
<p>(         ..         ,      ,        ,    )</p><br>
<p><img src="https://habrastorage.org/webt/7b/nw/hw/7bnwhwdx7xrbkvwgqiw9jc5um5g.png" alt="äººå¹³å‡å¿œç­”"></p><br>
<p>       .</p><br>
<p>      ""  â€”    ,     .   P300      -  .</p><br>
<p>        â€”     ,  .      ,         . ,   (    ,  , )   .</p><br>
<p><img src="https://habrastorage.org/webt/jt/kj/sj/jtkjsjbgmym86-unjyshdxgtd80.png" alt="png"></p><br>
<p>     .       ,      â€”    ..</p><br>
<p>    .  Fp1,2     ,   .       ,    â€”   -  .</p><br>
<p>        P300,      â€”    (mutual information)   - (aka stepwise regression).        .</p><br>
<p> ,        ,                    . ,    16       ,  -  . (<code>mne</code>     ,     ,       )</p><br>
<p><img src="https://habrastorage.org/webt/zq/2y/kz/zq2ykzbpc6oxqz2woyizwuswod4.png" alt="png"></p><br>
<p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png" alt="png"></p><br>
<h2 id="klassifikaciya"></h2><br>
<p>         .</p><br>
<p>       â€” . ,    (SVM)   ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>pyriemann</code></a> (       ),  ,                <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  kaggle.</p><br>
<pre><code class="python hljs">clfs = {
    <span class="hljs-string">'LR'</span>: (<font></font>
        make_pipeline(Vectorizer(), LogisticRegression()),<font></font>
        {<span class="hljs-string">'logisticregression__C'</span>: np.exp(np.linspace(<span class="hljs-number">-4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>))},<font></font>
    ),<font></font>
    <span class="hljs-string">'LDA'</span>: (<font></font>
        make_pipeline(Vectorizer(), LDA(shrinkage=<span class="hljs-string">'auto'</span>, solver=<span class="hljs-string">'eigen'</span>)),<font></font>
        {},<font></font>
    ),<font></font>
    <span class="hljs-string">'SVM'</span>: (<font></font>
        make_pipeline(Vectorizer(), SVC()),<font></font>
        {<span class="hljs-string">'svc__C'</span>: np.exp(np.linspace(<span class="hljs-number">-4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>))},<font></font>
    ),<font></font>
    <span class="hljs-string">'CSP LDA'</span>: (<font></font>
        make_pipeline(CSP(), LDA(shrinkage=<span class="hljs-string">'auto'</span>, solver=<span class="hljs-string">'eigen'</span>)),<font></font>
        {<span class="hljs-string">'csp__n_components'</span>: (<span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">13</span>), <span class="hljs-string">'csp__cov_est'</span>: (<span class="hljs-string">'concat'</span>, <span class="hljs-string">'epoch'</span>)},<font></font>
    ),<font></font>
    <span class="hljs-string">'Xdawn LDA'</span>: (<font></font>
        make_pipeline(Xdawn(<span class="hljs-number">2</span>, classes=[<span class="hljs-number">1</span>]), Vectorizer(), LDA(shrinkage=<span class="hljs-string">'auto'</span>, solver=<span class="hljs-string">'eigen'</span>)),<font></font>
        {},<font></font>
    ),<font></font>
    <span class="hljs-string">'ERPCov TS LR'</span>: (<font></font>
        make_pipeline(ERPCovariances(estimator=<span class="hljs-string">'oas'</span>), TangentSpace(), LogisticRegression()),<font></font>
        {<span class="hljs-string">'erpcovariances__estimator'</span>: (<span class="hljs-string">'lwf'</span>, <span class="hljs-string">'oas'</span>)},<font></font>
    ),<font></font>
    <span class="hljs-string">'ERPCov MDM'</span>: (<font></font>
        make_pipeline(ERPCovariances(), MDM()),<font></font>
        {<span class="hljs-string">'erpcovariances__estimator'</span>: (<span class="hljs-string">'lwf'</span>, <span class="hljs-string">'oas'</span>)},<font></font>
    ),<font></font>
}</code></pre><br>
<p><img src="https://habrastorage.org/webt/3x/yb/qc/3xybqcusgidyxfs5lfcilxqn-gs.png" alt="ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ç›¸äº’æ¤œè¨¼"></p><br>
<p>      "+" ..  ,   -              .        .</p><br>
<p>             .<br>
 accuracy          (  5/6 ~ 83%),        precision-recall-f1.</p><br>
<p>   ,       .  ,         ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Neiry</a>   ""    (,      ).</p><br>
<p>        .             (, ,  ..      ).          (, 6   5 )        (30 ),  30           ,   ,     .             .</p><br>
<p><img src="https://habrastorage.org/webt/zx/-o/lm/zx-olmert9y5wdjpebgqa1dy8zm.png" alt="crossvalidate_dataset"></p><br>
<p>    transfer learning â€”      .   ,     ,         ,         .    ,       P300       .</p><br>
<p>    â€”     ,   ,       10      ,       </p><br>
<p>  1 <br>
<img src="https://habrastorage.org/webt/fk/n5/5w/fkn55wh6yl7hfpjtjrqesq8gm8e.png" alt="transfer_validate_1"></p><br>
<p>  10 <br>
<img src="https://habrastorage.org/webt/in/ol/kq/inolkqy3-fezzcavmstah4vwhic.png" alt="transfer_valiidate_10"></p><br>
<p> f1   0.23  0.4    (       ).</p><br>
<p> ,      ""  "".           5   ,   accuracy    75%.</p><br>
<p>   ,     ,  , ,      â€”              .</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>       P300      .      (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>)       .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EEGä¿¡å·ã‚’æ“ä½œã™ã‚‹æ–¹æ³•ã®åŸºæœ¬ã‚’ç†è§£ã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ã•ã‚‰ã«è©³ã—ãèª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚é«˜åº¦ãªå‰å‡¦ç†æ–¹æ³•ã¨ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é©ç”¨ã—ã¦ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã®æ§‹ç¯‰ã«é–¢ã™ã‚‹å•é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¤ã¥ã...</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja480040/index.html">ãƒ©ãƒ³ãƒ–ãƒ©ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—ãŒNginxã¨ãƒ•ã‚¡ã‚¦ãƒ³ãƒ€ãƒ¼ã‚’æ”»æ’ƒã™ã‚‹ã“ã¨ã®æ„å‘³ã¨ã€ãã‚ŒãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¥­ç•Œã«ã©ã®ã‚ˆã†ã«å½±éŸ¿ã™ã‚‹ã‹</a></li>
<li><a href="../ja480042/index.html">è‡ªå–¶æ¥­ãŠã‚ˆã³è‡ªç¤¾ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€‚Nginxã‚’ãƒ•ã‚©ãƒ­ãƒ¼</a></li>
<li><a href="../ja480050/index.html">ã€Œã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã€ã®æ¦‚å¿µã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¿æŸ»</a></li>
<li><a href="../ja480056/index.html">ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã«ã‚ˆã‚‹éš ã—ã‚«ãƒ¡ãƒ©ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ï¼šãƒ“ãƒƒã‚°ãƒ–ãƒ©ã‚¶ãƒ¼ã¾ãŸã¯ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®èª¤ç®—ï¼Ÿ</a></li>
<li><a href="../ja480058/index.html">ã‚¯ãƒªã‚¹ãƒã‚¹ãƒ„ãƒªãƒ¼ã®ãƒˆãƒ©ãƒ³ã‚¹ã‚¹ã‚¿ãƒ¼</a></li>
<li><a href="../ja480062/index.html">10åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚ã‚¿ã‚¹ã‚¯ã§é€šä¿¡ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…±æœ‰ã™ã‚‹æ–¹ãŒä¾¿åˆ©ãªå ´æ‰€ã¯ã©ã“ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja480064/index.html">ãƒ†ãƒ¼ãƒåˆ¥ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã•ã‚ŒãŸå˜èªã®å­¦ç¿’</a></li>
<li><a href="../ja480068/index.html">[æ›´æ–°]ç§ãŸã¡ã®äººã€…ã¯æš´åŠ›ã‚’å—ã‘ã€ç§ãŸã¡ã¯æ²ˆé»™ã—ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja480072/index.html">Kubernetesï¼šã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒãªãœãã‚Œã»ã©é‡è¦ãªã®ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja480076/index.html">ã•ã¾ã–ã¾ãªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ«ãƒãƒ—ãƒ­ã‚»ãƒƒã‚·ãƒ³ã‚°ã¨èª¿æ•´</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>