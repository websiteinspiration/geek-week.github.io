<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🎨 🤷🏿 👨 Écrire un simple éditeur WYSIWYG avec ProseMirror 🔝 📫 🐌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque Sports.ru avait besoin de son propre éditeur WYSIWYG , nous avons décidé de le faire sur la base de la bibliothèque ProseMirror. L'une des pri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Écrire un simple éditeur WYSIWYG avec ProseMirror</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sports_ru/blog/491902/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque Sports.ru avait besoin de son propre </font></font><abbr title="Ce que vous voyez est ce que vous obtenez"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éditeur WYSIWYG</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nous avons décidé de le faire sur la base de la bibliothèque ProseMirror. </font><font style="vertical-align: inherit;">L'une des principales caractéristiques de cet outil est sa modularité et ses nombreuses possibilités de personnalisation.Ainsi, avec lui, vous pouvez adapter très finement l'éditeur à n'importe quel projet. </font><font style="vertical-align: inherit;">En particulier, ProseMirror est déjà utilisé dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le New York Times</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Guardian</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans cet article, nous expliquerons comment écrire votre éditeur WYSIWYG à l'aide de ProseMirror.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kf/to/_b/kfto_btseokytxzu3k5jsbltebs.png" alt="Écrire un simple éditeur WYSIWYG avec ProseMirror"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Présentation de ProseMirror</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'auteur de ProseMirror est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marijn Haverbeke,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui est connu dans la communauté des développeurs frontaux principalement comme l'auteur du livre populaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eloquent Javascript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Au début de notre travail (automne 2018), il n'y avait aucun matériel sur le travail avec cette bibliothèque, à l'exception de la documentation officielle et des tutoriels de l'auteur. Le dossier de documentation de l'auteur comprend plusieurs sections, les plus utiles d'entre elles sont le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guide ProseMirror</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (description des concepts de base) et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manuel de référence</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (spécification de bibliothèque). Vous trouverez ci-dessous un résumé des idées clés du Guide ProseMirror.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ProseMirror stocke toujours l'état d'un document dans sa propre structure de données. Et déjà à partir de cette structure en runtime les éléments DOM correspondants sont générés sur la page avec laquelle l'utilisateur final interagit. De plus, ProseMirror stocke non seulement l'état actuel (état), mais également l'historique des modifications précédentes, qui peuvent être annulées si nécessaire. Tout changement d'état doit se produire par le biais de transactions, les manipulations habituelles avec l'arborescence DOM ne fonctionneront pas directement ici. Une transaction est une abstraction qui décrit la logique d'un changement d'état étape par étape. L'essence de leur travail n'est pas sans rappeler l'envoi et l'exécution d'actions dans les bibliothèques de gestion d'état, par exemple, Redux et Vuex.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La bibliothèque elle-même est construite sur des modules indépendants qui peuvent être désactivés ou ajoutés en fonction des besoins. </font><font style="vertical-align: inherit;">Une liste des principaux modules qui, selon nous, seraient nécessaires à presque tout le monde:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-model</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un modèle de document qui décrit tous les composants d'un document, leurs propriétés et les actions qui peuvent être effectuées sur eux;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-state</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une structure de données qui décrit l'état du document créé à un certain moment, y compris des fragments et des transactions sélectionnés pour passer d'un état à un autre;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-view</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - présentation du document dans le navigateur et les outils pour que l'utilisateur puisse interagir avec le document;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-transform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une fonction de stockage de l'historique des transactions, à l'aide de laquelle les transactions sont implémentées et qui vous permet de revenir aux états précédents ou de mener le développement conjoint d'un document.</font></font><br>
 </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de cet ensemble minimal, les modules suivants peuvent également être utiles:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-commands</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un ensemble de commandes prêtes à l'emploi pour l'édition. </font><font style="vertical-align: inherit;">En règle générale, vous devez écrire quelque chose de plus complexe ou individuel vous-même, mais Marijn Haverbeke a déjà fait certaines choses pour nous, par exemple, en supprimant un fragment de texte sélectionné;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prosemirror-keymap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un module de deux méthodes pour spécifier les raccourcis clavier;</font></font><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prosemirror-history</a> –          , ..    ,    ,  ,       ;<br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prosemirror-schema-list</a> –      ,     (      DOM-,   ,      ).<br>
 </li>
</ul><br>
<h2>   ProseMirror</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons par créer un aperçu de l'éditeur. Le schéma dans ProseMirror définit une liste d'éléments qui peuvent être dans notre document, et leurs propriétés. Chaque élément a une méthode toDOM, qui détermine comment cet élément sera représenté dans l'arborescence DOM de la page Web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le principe de WYSIWYG est réalisé précisément dans le fait que lors de la création du schéma, nous avons un contrôle total sur la façon dont le contenu modifiable est affiché sur la page, et, en conséquence, nous pouvons donner à chaque élément une telle structure HTML et définir des styles tout comme le contenu à afficher. Les nœuds peuvent être créés et personnalisés selon vos besoins, en particulier, vous aurez probablement besoin de paragraphes, en-têtes, listes, images, paragraphes, supports.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que chaque paragraphe du texte soit enveloppé dans la balise «p» avec la classe «paragraphe», qui détermine les règles pour les styles de paragraphe nécessaires à la mise en page. Dans ce cas, le schéma ProseMirror peut ressembler à ceci:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { Schema } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-model"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> mySchema = <span class="hljs-keyword">new</span> Schema({
    <span class="hljs-attr">nodes</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">doc</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">content</span>: <span class="hljs-string">'block'</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">text</span>: {},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">paragraph</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">content</span>: <span class="hljs-string">'inline'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;<span class="hljs-attr">group</span>: <span class="hljs-string">'block'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="hljs-attr">toDOM</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDOM</span>(<span class="hljs-params">node</span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-keyword">return</span> [<span class="hljs-string">'p'</span>, {<span class="hljs-attr">class</span>: <span class="hljs-string">'paragraph'</span>}, <span class="hljs-number">0</span>];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  },<font></font>
    },<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous importons le constructeur pour créer notre schéma et lui passons un objet qui décrit les nœuds (ci-après appelés nœuds) dans le futur éditeur. Les nœuds sont des abstractions qui décrivent les types de contenu créés. Par exemple, avec un tel schéma, seuls les nœuds de type texte et paragraphe peuvent se trouver dans l'éditeur. Doc est le nom du nœud de niveau supérieur, qui ne sera composé que d'éléments de bloc, c'est-à-dire dans ce cas uniquement à partir des paragraphes (car nous n'en avons pas décrit d'autres). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le texte est des nœuds de texte quelque peu similaires aux nœuds DOM de texte. En utilisant la propriété group, nous pouvons regrouper nos nœuds de différentes manières afin qu'ils soient plus facilement accessibles dans le code. Les groupes peuvent être définis de la manière qui nous convient. Dans notre cas, nous avons divisé les nœuds uniquement en blocs et en ligne. Le texte est en ligne par défaut, donc cela peut être omis explicitement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une chose complètement différente est le paragraphe (paragraphe). </font><font style="vertical-align: inherit;">Nous avons annoncé que les paragraphes se composent d'éléments de texte en ligne et ont également leur propre représentation dans le DOM. </font><font style="vertical-align: inherit;">Un paragraphe sera un élément de bloc, à peu près dans le sens où les éléments de bloc DOM le sont. </font><font style="vertical-align: inherit;">Selon ce schéma, les paragraphes de la page seront présentés dans l'éditeur en ligne comme suit:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"paragraph"</span>&gt;</span>Content of the paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez maintenant créer l'éditeur lui-même:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { EditorState } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-state"</span>;
<span class="hljs-keyword">import</span> { EditorView } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-view"</span>;
<span class="hljs-keyword">import</span> { Schema } <span class="hljs-keyword">from</span> <span class="hljs-string">"prosemirror-model"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> mySchema = <span class="hljs-keyword">new</span> Schema({
    <span class="hljs-attr">nodes</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">doc</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">content</span>: <span class="hljs-string">'block+'</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">text</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">group</span>: <span class="hljs-string">'inline'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<span class="hljs-attr">paragraph</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">content</span>: <span class="hljs-string">'inline*'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">group</span>: <span class="hljs-string">'block'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">toDOM</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDOM</span>(<span class="hljs-params">node</span>) </span>{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-keyword">return</span> [<span class="hljs-string">'p'</span>, {<span class="hljs-attr">class</span>: <span class="hljs-string">'paragraph'</span>}, <span class="hljs-number">0</span>];<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    },<font></font>
    },<font></font>
});<font></font>
<font></font>
<span class="hljs-comment">/**
 * @classdesc  
 * @param {Object} el DOM-,    
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wysiwyg</span> </span>{
    <span class="hljs-keyword">constructor</span>(el) {
        <span class="hljs-keyword">this</span>.el = el;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
      * <span class="hljs-doctag">@description </span>    
&nbsp;    &nbsp;* <span class="hljs-doctag">@param <span class="hljs-type">{Object}</span> </span>content ,    
&nbsp;     */</span><font></font>
    setArticle(content) {<font></font>
        <span class="hljs-keyword">const</span> state = EditorState.fromJSON(<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;        {<span class="hljs-attr">schema</span>: mySchema},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;        content,<font></font>
        );<font></font>
        <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> EditorView(<span class="hljs-keyword">this</span>.el, {<span class="hljs-attr">state</span>: state});<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, comme d'habitude, nous importons tous les constructeurs nécessaires des modules correspondants et prenons le schéma décrit ci-dessus. Nous créons l'éditeur en tant que classe avec un ensemble de méthodes nécessaires. Pour que la page Web puisse modifier et créer du contenu, vous devez créer un état, un état, en utilisant la mise en page et le contenu de l'article, et en présentant le contenu de l'état actuel dans l'élément racine donné. Nous plaçons ces actions dans la méthode setArticle, sauf pour lesquelles rien n'est nécessaire jusqu'à présent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le même temps, le contenu est facultatif. Si ce n'est pas le cas, vous obtenez un éditeur vide et le contenu peut déjà être créé directement sur place. Disons que nous avons un fichier HTML avec ce balisage:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"editor"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour créer un éditeur WYSIWYG vide sur une page, vous n'avez besoin que de quelques lignes dans un script qui s'exécute sur une page avec ce balisage:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
<span class="hljs-keyword">import</span> Wysiwyg <span class="hljs-keyword">from</span> <span class="hljs-string">'wysiwyg'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'editor'</span>);
<span class="hljs-keyword">const</span> myWysiwyg = <span class="hljs-keyword">new</span> Wysiwyg(root);<font></font>
myWysiwyg.setArticle();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant ce code, vous pouvez écrire n'importe quel texte à partir de zéro. </font><font style="vertical-align: inherit;">À ce stade, vous pouvez déjà voir comment ProseMirror fonctionne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un utilisateur tape du texte dans cet éditeur, des transactions d'état se produisent. </font><font style="vertical-align: inherit;">Par exemple, si vous tapez la phrase «Ceci est mon nouvel éditeur WYSIWYG cool» dans l'éditeur avec le schéma ci-dessus, ProseMirror répondra à la saisie au clavier en appelant l'ensemble de transactions approprié, et une fois la saisie terminée, le contenu dans l'état du document ressemblera à ceci:</font></font><br>
<br>
<pre><code class="javascript hljs">content: [<font></font>
    {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'    WYSIWYG-'</span>,<font></font>
    },<font></font>
]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous voulons que du texte, par exemple, le contenu d'un article déjà créé précédemment, soit ouvert dans l'éditeur pour être édité, alors ce contenu doit correspondre au schéma créé précédemment. </font><font style="vertical-align: inherit;">Ensuite, le code d'initialisation de l'éditeur sera un peu différent:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//     </span>
<span class="hljs-keyword">import</span> Wysiwyg <span class="hljs-keyword">from</span> <span class="hljs-string">'wysiwyg'</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'editor'</span>);
<span class="hljs-keyword">const</span> myWysiwyg = <span class="hljs-keyword">new</span> Wysiwyg(root);
<span class="hljs-keyword">const</span> content = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'doc'</span>,
    <span class="hljs-attr">content</span>: [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'Hello, world!'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<span class="hljs-attr">type</span>: <span class="hljs-string">'paragraph'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attr">value</span>: <span class="hljs-string">'This is my first wysiwyg-editor'</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;}<font></font>
    ],<font></font>
};<font></font>
myWysiwyg.setArticle(content);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hourra! </font><font style="vertical-align: inherit;">Nous avons créé notre premier éditeur, qui peut créer une page propre pour créer un nouveau contenu et ouvrir l'existant pour le modifier.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que faire avec l'éditeur ensuite</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais même avec un ensemble complet de nœuds, notre éditeur manque encore de fonctions importantes - mise en forme du texte, des paragraphes. Pour cela, en plus des nœuds, un objet avec des paramètres de formatage, des repères, doit également être transféré au circuit. Pour plus de simplicité, nous les appelons des «marques». Et pour contrôler l'ajout, la suppression et la mise en forme de tous ces éléments, les utilisateurs auront besoin d'un menu. Les menus peuvent être ajoutés à l'aide de plug-ins personnalisés qui stylisent les objets de menu et décrivent le changement d'état d'un document lors du choix de certaines actions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide de plugins, vous pouvez créer n'importe quelle conception qui étend les fonctionnalités intégrées de l'éditeur. L'idée principale des plugins est qu'ils traitent certaines actions des utilisateurs afin de générer des transactions qui leur correspondent. Par exemple, si vous voulez cliquer sur l'icône de liste dans le menu pour créer une nouvelle liste vide et déplacer le curseur au début du premier élément, alors nous devons certainement décrire cette transaction dans le plugin correspondant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez en savoir plus sur les paramètres de formatage et les plugins dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> officielle </font><font style="vertical-align: inherit;">, ainsi que de très petits </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exemples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utiles </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">d'</font></a><font style="vertical-align: inherit;"> utilisation des fonctionnalités de ProseMirror </font><font style="vertical-align: inherit;">peuvent être très utiles </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous êtes intéressé par la façon dont nous avons intégré un nouvel éditeur basé sur ProseMirror dans un projet existant, nous en avons parlé dans un autre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr491886/index.html">KnowledgeConf 2020 Online: mise en œuvre d'une gestion des connaissances étape par étape</a></li>
<li><a href="../fr491888/index.html">GitLab CI: 6 fonctionnalités des dernières versions que nous attendions</a></li>
<li><a href="../fr491890/index.html">Drive Anatomy: SSD</a></li>
<li><a href="../fr491896/index.html">Comment nous, Cyan, améliorons un produit grâce à la recherche sur l'expérience utilisateur</a></li>
<li><a href="../fr491900/index.html">Flexibilité et automatisation dans l'apprentissage automatique</a></li>
<li><a href="../fr491904/index.html">Comment écrire du code Python sûr. Repas Kushal Das</a></li>
<li><a href="../fr491916/index.html">Création d'environnements virtuels et installation de bibliothèques pour Python 3 dans l'IDE PyCharm</a></li>
<li><a href="../fr491924/index.html">Test bêta de l'analyseur PVS-Studio # sur Linux et macOS</a></li>
<li><a href="../fr491926/index.html">Développement d'applications mobiles multiplateformes en 2020</a></li>
<li><a href="../fr491934/index.html">Profils psychologiques des investisseurs boursiers: comment cela fonctionne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>