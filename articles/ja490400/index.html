<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💷 🖊️ 🌻 OpenCVライブラリを使用して、3D点群の2D断面の楕円弧を認識する 🤙🏼 🕴🏽 👵🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="3D点群（3dOT）を受け取ることができる手頃な価格のレーザースキャナー（ライダー）の普及と、この技術のさまざまな分野（機械工学からセキュリティ、石油産業から建築まで）での幅広いアプリケーションに関連して、処理アルゴリズムへの関心が復活しました。点の雲。業界
 
 での3dの人気のあるアプリケーショ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenCVライブラリを使用して、3D点群の2D断面の楕円弧を認識する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490400/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3D点群（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3dOT</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を受け取ることができる手頃な価格のレーザースキャナー（ライダー）の普及</font><font style="vertical-align: inherit;">と、この技術のさまざまな分野（機械工学からセキュリティ、石油産業から建築まで）での幅広いアプリケーションに関連して、処理アルゴリズムへの関心が復活しました。点の雲。</font><font style="vertical-align: inherit;">業界</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
での</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3d</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の人気のあるアプリケーションの1つは、</font><font style="vertical-align: inherit;">通常はパイプラインとその他の円筒形状の構造で構成される、建設された古い機器または改造された機器のみの設計ドキュメントの作成です。</font><em><font style="vertical-align: inherit;">3dOT</font></em><font style="vertical-align: inherit;">で</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幾何プリミティブを検出する</font><font style="vertical-align: inherit;">には、通常、</font><em><font style="vertical-align: inherit;">Microsoft PCL</font></em><font style="vertical-align: inherit;">などの特殊な3Dライブラリが使用されます。</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。既製のライブラリを使用するアプローチは、利点とともに、欠点があります。たとえば、通常2D次元を持つ既存のカドフ処理スキームにそれらを組み込むことは困難です。</font><font style="vertical-align: inherit;">2Dセクションから始めて、</font><em><font style="vertical-align: inherit;">OpenCV</font></em><font style="vertical-align: inherit;">などの信頼性の高い最適化された画像処理ライブラリで利用可能な2D処理のすべての武器を使用して、ポンプステーションなどの</font><em><font style="vertical-align: inherit;">3dOT</font></em></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を処理する方法を考えてみましょう</font><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">図1.ポンプ場の3D OTモデル</font></i></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/c2/bu/-i/c2bu-isuyb45ji2pz_6nibzg8zi.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さまざまなパイプ構造をスキャンして得られる断面の主な要素は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">楕円弧</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8w/zl/2h/8wzl2hcgbhlmexqxdvl6ezottgm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2.平均レベルでのポンプ場の3Dモデルの水平断面。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この記事では、任意の楕円弧を検出できる1つの主要なアルゴリズムに考察を限定します</font><i><font style="vertical-align: inherit;">。</font></i><font style="vertical-align: inherit;">これは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">弧セグメント</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">成長と領域結合</font></i><font style="vertical-align: inherit;">（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">領域成長とエッジリンク</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">反復アルゴリズムです</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成長アルゴリズムは、統計アルゴリズムと比較して、時間がかかりますが、最も明白で簡単に検証できます。統計アルゴリズムは、1つの楕円に属する結合が弱く離れたオブジェクトがシーンに含まれている場合に適しています。</font><font style="vertical-align: inherit;">これらのアルゴリズムについては、今後の記事で説明します。</font></font><br>
<br>
</p><h4>  </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、簡単にするために、ソース</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3dOT</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルからセクションを取得し、セクションを</font><font style="vertical-align: inherit;">前処理し、それをクラスター化してジオメトリックプリミティブを分離する</font><font style="vertical-align: inherit;">手順</font><font style="vertical-align: inherit;">と、後続のバインディング、修正、およびモデルパラメーターを取得するために必要なその他の写真測量操作</font><font style="vertical-align: inherit;">を省略し</font><font style="vertical-align: inherit;">ます。ヒューリスティック検索アルゴリズムのパラメーター化については同じ方法で説明しません。</font><font style="vertical-align: inherit;">アルゴリズムが構築</font><font style="vertical-align: inherit;">されるすべての</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本的な操作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について説明します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この画像では、点群の水平断面から切り取られた楕円弧を検出（認識、分類）する（つまり、楕円のパラメーターと楕円弧の初期角度と最終角度を計算する）必要があると想定しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/co/rj/km/corjkmmhyxcxvrnex89_iex1aei.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3. 3Dモデルの断面の楕円弧の1つ（平滑化後）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラスターの処理を盲目的に最小限に抑えるために、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アウトラインを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介してラスターのすべての操作を実行します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV </font></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">findContours</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロシージャ</font><font style="vertical-align: inherit;">は、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マット</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラスター上で</font><font style="vertical-align: inherit;">すべての外部（内部形状なし）</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">輪郭</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を整数ポイントベクトル（ラスター座標）のベクトルの形式で</font><font style="vertical-align: inherit;">検索し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="cpp hljs"> <span class="hljs-function">Mat <span class="hljs-title">mat</span><span class="hljs-params">(size)</span></span>;<font></font>
 <span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">vector</span>&lt;Point&gt;&gt; contours;<font></font>
 findContours(mat, contours, RETR_EXTERNAL, CHAIN_APPROX_SIMPLE);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは私たちの主要な操作であり、いくつかの単純なケースで</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、タスクを完全に解決します</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、退化したケースが常に見つかるとは限らないため、コンターによる処理技術をさらに詳しく検討してみましょう。</font><i><font style="vertical-align: inherit;">OpenCV</font></i><font style="vertical-align: inherit;">関数</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を使用して既存の外部回路に従ってラスターを生成する逆の操作</font><font style="vertical-align: inherit;">も、単純に見えます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<pre><code class="cpp hljs"> drawContours(mat, contours, <span class="hljs-number">-1</span>, Scalar(<span class="hljs-number">255</span>), <span class="hljs-number">-1</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、輪郭のマスク、描画、または面積の計算にも非常によく使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、初期段階では</font><font style="vertical-align: inherit;">、楕円弧に接続する必要</font><font style="vertical-align: inherit;">がある</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一連のパッチ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（特定の曲線の一部）があり、構造の他のコンポーネント（ファスナーなど）の一部や、スキャン中のシャドウイングなどによって生じる光学ノイズを排除します理由。</font><font style="vertical-align: inherit;">等高線のタイプ（楕円、線形セグメント、ハッチングなど）と、等高線の終点と回転した輪郭の長方形を返す</font><i><font style="vertical-align: inherit;">判別関数</font></i><font style="vertical-align: inherit;">を</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成してみましょう</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<pre><code class="cpp hljs"> contourTypeSearch(<font></font>
   <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;Point&gt; &amp;contour, Vec4i &amp;def, RotatedRect &amp;rc);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長方形の長さと幅の比率は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線形セグメント</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">近いコンター</font><font style="vertical-align: inherit;">や小さな</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノイズコンター</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をすばやく区別するのに役立ち</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><em><font style="vertical-align: inherit;">OpenCVで</font></em></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
回転した長方形</font><font style="vertical-align: inherit;">は、</font><u><font style="vertical-align: inherit;">複雑な</font></u><font style="vertical-align: inherit;">座標系を</font><font style="vertical-align: inherit;">持ってい</font><font style="vertical-align: inherit;">ます。必要なのは角度自体ではなく、その</font><i><font style="vertical-align: inherit;">三角関数</font></i><font style="vertical-align: inherit;">である場合、コンテキストからはさらに明白ではなくなります。</font><i><font style="vertical-align: inherit;">角度の絶対値を使用する</font></i><font style="vertical-align: inherit;">場合、</font><u><font style="vertical-align: inherit;">角度は水平から反時計回りに長方形の最初のエッジまで数えられ、負の値を持つ</font></u><font style="vertical-align: inherit;">ことを考慮する必要があり</font><u><font style="vertical-align: inherit;">ます</font></u><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">楕円の輪郭</font><i><font style="vertical-align: inherit;">の端点</font></i><font style="vertical-align: inherit;">は、</font><em><font style="vertical-align: inherit;">マット</font></em><font style="vertical-align: inherit;">ラスターを受け取る手順を使用して検出されます。</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"></font><br>
<br>
<i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスキングによって元の画像から抽出された識別された輪郭で、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大の欠陥</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返します</font><font style="vertical-align: inherit;">：</font></font><br>
<pre><code class="cpp hljs"> contourConvFeature(mat, &amp;def, … );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この関数のメインコードは、2つの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロシージャを呼び出すこと</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; *hull = <span class="hljs-keyword">new</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;();<font></font>
 convexHull(contour, *hull);<font></font>
 <span class="hljs-built_in">vector</span>&lt;Vec4i&gt; *defs = <span class="hljs-keyword">new</span> <span class="hljs-built_in">vector</span>&lt;Vec4i&gt;();<font></font>
 convexityDefects(contour, *hull, *defs);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の手順では、</font><font style="vertical-align: inherit;">調査中の輪郭の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">凸多角形</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">見つけ、2番目の手順では、</font><font style="vertical-align: inherit;">すべての</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">凸欠陥を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">輪郭の終点を決定することを考慮して、凸面に関して</font><i><font style="vertical-align: inherit;">最大の</font></i><font style="vertical-align: inherit;">欠陥</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
のみを取得し</font><font style="vertical-align: inherit;">ます。これは、輪郭の外部または内部境界に</font><i><font style="vertical-align: inherit;">フィーチャ</font></i><font style="vertical-align: inherit;">がある場合には当てはまらないことがあり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。するために</font><i><font style="vertical-align: inherit;">平滑化</font></i><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">、我々は（ないように輪郭線との間の「ぼけ」峡部にはなく、画像全体に、元のトポロジーに違反していない）研究中の輪郭に付加的な平滑化を適用します。</font><i><font style="vertical-align: inherit;">図4.バルジ欠陥の計算</font></i><i><font style="vertical-align: inherit;">オプション（a）は</font></i><font style="vertical-align: inherit;">誤って赤いエンドポイントを定義しています。</font><i><font style="vertical-align: inherit;">オプション（b）</font></i></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/cb/e2/tl/cbe2tlqhmia2hyb727mcspjsb5w.png"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br>
<i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンドポイントを正しく定義します。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション（c）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、元の形状の端点を再定義します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
採用したテクノロジーでは毎回輪郭が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再生成</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">されるため、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">徹底的な検索</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手順によって対応点（またはむしろ、それらのインデックス）を再</font><i><font style="vertical-align: inherit;">検索する</font></i><font style="vertical-align: inherit;">必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="cpp hljs"> nearestContourPtIdx(<span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;Point&gt; &amp;contour, <span class="hljs-keyword">const</span> Point&amp; pt);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
機能を完全に取り除くことができない場合のために、</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーク分離の</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加モードも実装されました</font><font style="vertical-align: inherit;">（内部/外部アークと別々に動作します）。これは、たとえば、輪郭の外部アークが</font><font style="vertical-align: inherit;">他のオブジェクト</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と接触</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しているか、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノイズ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><i><font style="vertical-align: inherit;">多い</font></i><font style="vertical-align: inherit;">場合に重要</font><font style="vertical-align: inherit;">です。この場合、内部アークで作業に行くことができます。この場合、外部アークと内部アークを別々に処理する必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">円弧</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">凸</font></i><font style="vertical-align: inherit;">率の比率に関するよく知られている式によれば</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">円</font><font style="vertical-align: inherit;">の</font><i><font style="vertical-align: inherit;">半径</font></i><font style="vertical-align: inherit;">は概算され</font><font style="vertical-align: inherit;">、大きすぎる楕円は拒否されます。</font></font><br>
<pre><code class="matlab hljs">R = bulge / <span class="hljs-number">2</span> + SQR(<span class="hljs-built_in">hypot</span>) / (<span class="hljs-number">8</span> * bulge);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、すべての等高線について、それらの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">凸状欠陥メトリックが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検出されました</font><font style="vertical-align: inherit;">（またはそれらは線形または小さいとして分類され、手順から削除されました）。</font><font style="vertical-align: inherit;">最後の段階では、回転したディメンションパラメータなどの追加のパラメータが初期メトリックに追加され、調査されたメトリックの完全なセットが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズ順に並べられます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="cpp hljs"> <span class="hljs-keyword">typedef</span> tuple&lt;<span class="hljs-keyword">int</span> , <span class="hljs-comment">// </span><font></font>
   RotatedRect, <span class="hljs-comment">//  </span><font></font>
   Vec4i, <span class="hljs-comment">//  </span><font></font>
   <span class="hljs-keyword">int</span>&gt; <span class="hljs-comment">// </span><font></font>
   RectDefMetric;</code></pre><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端点で弧セグメントをリンクするためのアルゴリズム</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成長アルゴリズムは明確で明白です。最大の等高線を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">種</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として取り、</font><font style="vertical-align: inherit;">成長を試みます。つまり、成長条件を満たす最も近いパッチを見つけて、そのエンドポイントに接続します。成長した図では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目的の楕円弧</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を入力し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。マスク</font><font style="vertical-align: inherit;">して、元のセットから図</font><font style="vertical-align: inherit;">を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">差し引き</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のセットがなくなるまで</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成長手順を繰り返します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成長アルゴリズムの基本的な手順は次のようになります。</font></font><br>
<pre><code class="cpp hljs"> <span class="hljs-built_in">vector</span>&lt;Point&gt; *patch =<font></font>
    growingContours(contour, def, tmp, hull);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contour</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は調査中の等高線、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">def</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はその凸欠陥、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hull</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は領域全体の凸多角形、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tmp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は補助バッファーマトリックスです。出力では、ベクトル成長した輪郭が得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この手順は、成長のシードを試行するサイクルで構成され、成長に利用できるパッチを使い果たすか</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、最大反復数のパラメーター</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって制限され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/se/p1/tpsep1tdzgtvitxcnptg9rxu4m0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図5.シードなしの成長のための多くのパッチ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
主な難点は</font><font style="vertical-align: inherit;">、図形が</font><i><font style="vertical-align: inherit;">前方に</font></i><font style="vertical-align: inherit;">のみ成長するように、輪郭の端点に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も近いパッチ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">選択する</font><font style="vertical-align: inherit;">こと</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。以下のための</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線方向</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端点付近の円弧に属する平均線をとります。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図6</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のディスプレイ特定の反復における種子への接続候補。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5g/8x/ij/5g8xijwx2owywp4kgjielcgoft8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図6.複数の生育候補パッチで囲まれたシード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
各候補パッチについて、次のメトリックが計算されます。</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> tuple&lt;<font></font>
   <span class="hljs-keyword">double</span>, <span class="hljs-comment">//    2      2   </span><font></font>
   <span class="hljs-keyword">bool</span>, <span class="hljs-keyword">bool</span>, <span class="hljs-comment">//,  4   </span><font></font>
   <span class="hljs-keyword">int</span>, <span class="hljs-comment">// </span><font></font>
   Vec4i&gt; <span class="hljs-comment">//  </span><font></font>
   DistMetric;</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線円錐に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
該当するパッチのみ</font><i><font style="vertical-align: inherit;">が</font></i><font style="vertical-align: inherit;">考慮されます</font><font style="vertical-align: inherit;">。次に、距離が最小のパッチが選択され、接続セクションをラスターにインプリント</font><font style="vertical-align: inherit;">することにより、シードの対応する端に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">します。シードのもう一方の端については、パラメーターに一致するパッチが検索され、見つかった場合はシードにも接続されます。次に、シードは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスクさ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ、多くのパッチから</font><i><font style="vertical-align: inherit;">差し引か</font></i><font style="vertical-align: inherit;">れます。手順は最初から繰り返されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成長手順の最後に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">楕円弧</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を取得しましたが</font><font style="vertical-align: inherit;">、これはまだ検証されていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめに、標準の</font><i><font style="vertical-align: inherit;">OpenCV</font></i><font style="vertical-align: inherit;">を使用して</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッチが受け取る手順（パスの形式で、パスとラスターは相互に交換可能であることを覚えています）は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回転した次元</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまり完全な楕円</font><font style="vertical-align: inherit;">を返します</font><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="cpp hljs"> RotatedRect box = fitEllipse(patch);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、大きすぎる楕円と小さすぎる楕円を拒否し、元の手順を適用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果として得られる楕円弧の</font><i><font style="vertical-align: inherit;">面積と</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラスター形式の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期成長パッチ</font><font style="vertical-align: inherit;">を</font><i><font style="vertical-align: inherit;">比較します</font></i><font style="vertical-align: inherit;">。この手順には、偽のトリックがいくつか含まれているため、ここではその説明を省略します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最後に、検出された楕円の残りのパラメーター、つまり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始角度と終了角度</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を見つけます</font><font style="vertical-align: inherit;">（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fitEllipseの</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">半軸はすでにわかってい</font><em><font style="vertical-align: inherit;">ます</font></em><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開始角度と終了角度を決定するには、次のように進めます。完全な楕円を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポリゴンに戻し</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、直接列挙することで、その端に最も近い点を見つけます。それらの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">角度座標</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（実際には、インデックス）および楕円弧の開始角度と終了角度になります。</font><font style="vertical-align: inherit;">コードでは、次のようになります（少し簡略化されています）。</font></font><br>
<pre><code class="cpp hljs"> <span class="hljs-function">pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;</span><font></font><span class="hljs-function">
   <span class="hljs-title">ellipseAngles</span><span class="hljs-params">(<span class="hljs-keyword">const</span> RotatedRect &amp;box,</span></span><font></font><span class="hljs-function"><span class="hljs-params">
   <span class="hljs-built_in">vector</span>&lt;Point&gt; &amp;ell, <span class="hljs-keyword">const</span> Point &amp;ps, </span></span><font></font><span class="hljs-function"><span class="hljs-params">
   <span class="hljs-keyword">const</span> Point &amp;pe, <span class="hljs-keyword">const</span> Point &amp;pm)</span> </span><font></font><span class="hljs-function">
 </span>{<font></font>
    <span class="hljs-built_in">vector</span>&lt;Point&gt; ell0;<font></font>
    ellipse2Poly(Point(box.center.x, box.center.y), <font></font>
      Size(box.size.width / <span class="hljs-number">2</span>, box.size.height / <span class="hljs-number">2</span>),<font></font>
      box.angle, <span class="hljs-number">0</span>, <span class="hljs-number">355</span>, <span class="hljs-number">5</span>, ell0);<font></font>
    <span class="hljs-keyword">int</span> i0 = nearestContourPtIdx(ell0, ps);<font></font>
    <span class="hljs-keyword">int</span> i1 = nearestContourPtIdx(ell0, pe);<font></font>
    cutSides(ell0, i0, i1, i2, ell, <span class="hljs-literal">nullptr</span>);<font></font>
    <span class="hljs-keyword">return</span> pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;(i0, i1);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cutSides</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロシージャで</font><em><font style="vertical-align: inherit;">は</font></em><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">楕円弧トラバーサル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トポロジ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を考慮してい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">合計で、インデックス</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i0、i1、i2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をバイパスする8つの可能なケースを検討する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">外側の輪郭に沿って行くのか、内側の輪郭に沿って行くのか、およびどちらのインデックスが大きいか、最初か最後か？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを見やすくする：</font></font><br>
<pre><code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cutSides</span><span class="hljs-params">(</span></span><font></font><span class="hljs-function"><span class="hljs-params">
   <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;Point&gt; &amp;ell0, <span class="hljs-keyword">int</span> i0, <span class="hljs-keyword">int</span> i1, <span class="hljs-keyword">int</span> i2, </span></span><font></font><span class="hljs-function"><span class="hljs-params">
   <span class="hljs-built_in">vector</span>&lt;Point&gt; *ell_in, <span class="hljs-built_in">vector</span>&lt;Point&gt; *ell_out)</span></span><font></font><span class="hljs-function">
 </span>{<font></font>
   <span class="hljs-keyword">if</span> (i0 &lt; i1) {<font></font>
      <span class="hljs-keyword">if</span> (i2 &gt; i0 &amp;&amp; i2 &lt; i1) {<font></font>
         <span class="hljs-keyword">if</span> (ell_in) {...}<font></font>
            <span class="hljs-keyword">if</span> (ell_out) {...}<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            <span class="hljs-keyword">if</span> (ell_in) {...}<font></font>
            <span class="hljs-keyword">if</span> (ell_out) {...}<font></font>
        }}<font></font>
    <span class="hljs-keyword">else</span> {<font></font>
        <span class="hljs-keyword">if</span> (i2 &gt; i1 &amp;&amp; i2 &lt; i0) {<font></font>
            <span class="hljs-keyword">if</span> (ell_in) {...}<font></font>
            <span class="hljs-keyword">if</span> (ell_out) {...}<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            <span class="hljs-keyword">if</span> (ell_in) {...}<font></font>
            <span class="hljs-keyword">if</span> (ell_out) {...}<font></font>
        }}}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複雑なケースで楕円を検出した結果のいくつかを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図7に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/56/hd/jv56hdcpfuvmi59k0unppjknlq4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の記事では、統計的な検出方法について検討します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490386/index.html">証券取引所で他にどのようにお金を稼ぎ、リスクを減らすか：配当金を支払う会社の株式</a></li>
<li><a href="../ja490390/index.html">101XPのマネージングディレクター、Olga Makushenko：「ビジネスとしてのゲーム開発における5つの主要な間違い」</a></li>
<li><a href="../ja490392/index.html">Catchain：TONブロックチェーンコンセンサスアルゴリズム</a></li>
<li><a href="../ja490394/index.html">コモドールアミガ500+：誰も怒らせない</a></li>
<li><a href="../ja490398/index.html">赤いホグワーツ。役員、またはなぜ歴史家が探偵のようであるか</a></li>
<li><a href="../ja490404/index.html">5Gがなぜ、どのようにすべてを変えるか：テクノロジー、段階的な実装、および加入者機器の要素ベース</a></li>
<li><a href="../ja490406/index.html">表現できないほど魅力的：公開できないハニオットをどのように作成したか</a></li>
<li><a href="../ja490408/index.html">FreeBSD：GNU / Linuxよりもはるかに優れている</a></li>
<li><a href="../ja490410/index.html">インターネットを介して接続された生きている人工ニューロン</a></li>
<li><a href="../ja490412/index.html">たぶん、JavaScriptで少し落ち着かなければなりませんか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>