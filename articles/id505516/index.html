<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😲 🧡 👨🏿‍🔧 Pembelajaran mesin: mulai dari mana atau bagaimana membangun model pertama 🍨 🎆 👩🏾‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagai tugas pertama untuk pembelajaran mesin, kami mengambil sesuatu yang jelas dan sederhana, misalnya, perkiraan biaya perumahan. Dataset siap dap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pembelajaran mesin: mulai dari mana atau bagaimana membangun model pertama</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505516/"><img src="https://habrastorage.org/webt/cn/mg/fr/cnmgfrvs-ej5ldlqz9cmmdjdcrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai tugas pertama untuk pembelajaran mesin, kami mengambil sesuatu yang jelas dan sederhana, misalnya, perkiraan biaya perumahan. Dataset siap dapat ditemukan di situs web kaggle. Pada langkah pertama pelatihan, Anda tidak boleh mengambil kumpulan data dengan sejumlah besar variabel, misalnya, "Harga Rumah: Teknik Regresi Lanjut" terdiri dari 80 variabel dan regresi lanjutan, kami akan berhenti di "Penjualan Rumah di King County, AS" dengan 21 parameter. Unduh data dan analisis deskripsi yang disediakan. Tanggal tersedia, harga, jumlah kamar tidur, kamar mandi, total dan ruang tamu, jumlah lantai, penilaian pemandangan, pemandangan laut, penilaian kondisi umum, kelas (penilaian konstruksi dan desain), area di atas dan di bawah permukaan tanah, tahun konstruksi, tahun terakhir perbaikan, kode area, koordinat (bujur dan lintang), data pada area rumah 15 tetangga.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami telah memilih tugas dan siap untuk mulai menyelesaikannya. Solusinya akan mencakup dua tahap: analisis data dan pembangunan model. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Bekerja dengan data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita menyimpang dan secara terpisah mencatat pentingnya analisis data. Saat ini, semua algoritma yang kurang lebih populer sudah ditulis dalam bentuk perpustakaan dan konstruksi langsung model dikurangi menjadi beberapa baris kode, misalnya, k-tetangga terdekat dari sklearn dengan python:</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn .neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<font></font>
clf_KNN = KNeighborsClassifier()       <span class="hljs-comment"># </span>
clf_KNN.fit(X_train, Y_train)          <span class="hljs-comment"># </span>
Y_KNN = clf_KNN.predict(X_test)        <span class="hljs-comment">#    </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya empat baris kode untuk mendapatkan hasilnya. Jadi apa kesulitannya? Kesulitannya terletak pada mendapatkan X_train - data yang diumpankan ke input model. Prinsip terkenal "sampah masuk" = "sampah masuk" (English Garbage in - waste out (GIGO)) dalam pemodelan bekerja lebih dari 100% dan kualitas solusi yang diperoleh untuk masalah pembelajaran mesin akan sangat tergantung pada bekerja dengan data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang - ke pertempuran! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk analisis data kami akan menggunakan panda, untuk memahami dan mengevaluasi "dengan mata" kami menggunakan grafik sederhana dari seaborn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengimpor perpustakaan, membaca data, memperoleh beberapa catatan dari array data, melihat tipe data dan kelalaian di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode dan Keluar</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<font></font>
df = pd.read_csv(<span class="hljs-string">'…/train.csv'</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/1q/cy/og/1qcyogx0fmdgtibrhx1l2b5mdty.png"><br>
<br>
<pre><code class="python hljs">df.info()</code></pre><br>
<pre><code class="plaintext hljs">RangeIndex: 21613 entries, 0 to 21612<font></font>
Data columns (total 21 columns):<font></font>
id 21613 non-null int64<font></font>
date 21613 non-null object<font></font>
price 21613 non-null float64<font></font>
bedrooms 21613 non-null int64<font></font>
bathrooms 21613 non-null float64<font></font>
sqft_living 21613 non-null int64<font></font>
sqft_lot 21613 non-null int64<font></font>
floors 21613 non-null float64<font></font>
waterfront 21613 non-null int64<font></font>
view 21613 non-null int64<font></font>
condition 21613 non-null int64<font></font>
grade 21613 non-null int64<font></font>
sqft_above 21613 non-null int64<font></font>
sqft_basement 21613 non-null int64<font></font>
yr_built 21613 non-null int64<font></font>
yr_renovated 21613 non-null int64<font></font>
zipcode 21613 non-null int64<font></font>
lat 21613 non-null float64<font></font>
long 21613 non-null float64<font></font>
sqft_living15 21613 non-null int64<font></font>
sqft_lot15 21613 non-null int64<font></font>
dtypes: float64(5), int64(15), object(1)<font></font>
memory usage: 3.5+ MB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Array data terdiri dari 21613 catatan tanpa celah dalam data dan hanya berisi 1 tanggal bidang teks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan bekerja dengan setiap masuk secara lebih detail dan mulai dengan yang paling sederhana - membuang id (tidak membawa informasi berguna), kode pos (kode area tempat rumah berada) dan koordinat (lat &amp; panjang), karena kami hanya berkenalan dengan pembelajaran mesin, dan konversi geografis yang benar Data terlalu spesifik untuk spesialis pemula.</font></font><br>
<br>
<pre><code class="python hljs">df=df.drop([<span class="hljs-string">'id'</span>,<span class="hljs-string">'zipcode'</span>,<span class="hljs-string">'lat'</span>,<span class="hljs-string">'long'</span>], axis=<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lihat tanggal pengumuman. Format tanggal diatur ke YYYYMMDDTT000000, secara umum, itu juga dapat dihapus dari dataset, tetapi kami memiliki tahun konstruksi (yr_built) dan bidang tahun perbaikan terakhir (yr_renovated), yang ditentukan dalam format tahun (YYYY), yang tidak terlalu informatif. Dengan menggunakan tanggal pengumuman, Anda dapat mengkonversi tahun menjadi usia dengan pengurangan (tahun pengumuman - tahun konstruksi / tahun perbaikan). Kami mencatat tahun perbaikan adalah 0 untuk beberapa rumah, dan dengan asumsi bahwa ini berarti tidak ada perbaikan dari bangunan, kami mengganti nol di tahun perbaikan dengan tahun konstruksi, pertama-tama memastikan bahwa data tidak berisi catatan yang salah di mana tahun perbaikan kurang dari tahun konstruksi:</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">'yr_renovated'</span>]&lt;df[<span class="hljs-string">'yr_built'</span>])&amp;df[<span class="hljs-string">'yr_renovated'</span>]!=<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/l7/wo/ii/l7woii1rk3buxzexbab2i4uokmq.png"><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'yr_renovated'</span>]==<span class="hljs-number">0</span>, [<span class="hljs-string">'yr_renovated'</span>]]=df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_built'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_renovated'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_renovated'</span>]<font></font>
df=df.drop(<span class="hljs-string">'date'</span>, axis=<span class="hljs-number">1</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4z/za/uw/4zzauwyidq18e0lq_8x5-up5e88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menganalisis harga dengan parameter berikutnya dan menggunakan "Petak kotak" untuk ini. Kotak kumis adalah grafik sederhana dan nyaman yang menunjukkan distribusi probabilitas satu dimensi, atau, lebih sederhana, konsentrasi data. Gambar median (garis di tengah), kuartil atas dan bawah (sisi kotak), tepi sampel yang signifikan secara statistik ("kumis") dan pencilan (titik di belakang "kumis"). Mudah dipahami dari gambar pada distribusi normal (kanan). Grafik memungkinkan Anda menilai dengan cepat di mana sebagian besar data berada (50% di dalam kotak), simetri mereka (median offset ke satu sisi kotak dan / atau panjang "kumis") dan tingkat dispersi - varians (ukuran kotak, ukuran kumis, dan jumlah titik - emisi).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/bh/uw/bibhuwyeeexpszcl7sahfpdo8le.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dimungkinkan untuk membangun distribusi hanya karakteristik ini di seluruh array, tetapi akan lebih informatif untuk menggunakan 2 sumbu - misalnya, harga dan jumlah kamar tidur, yang pada gilirannya juga akan menunjukkan adanya koneksi antara tanda-tanda:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'price'</span>, data=df)			<span class="hljs-comment"># price</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)	<span class="hljs-comment">#price &amp; bedrooms</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harga keluar &amp; kamar tidur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/oh/ta/zaohtajsfsedoz8lagkzjto-oa0.png"><br>
<br>
<img src="https://habrastorage.org/webt/fn/em/4g/fnem4gwwbubwzkrhi25i4ly3j4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafik segera menunjukkan keberadaan nilai ekstrim dari harga dan kamar tidur (bayangkan sebuah rumah dengan 33 kamar tidur! J). Kehadiran nilai-nilai tersebut (disebut juga outlier) dalam harga atribut target sering mengarah ke pelatihan ulang model, karena mereka akan memberikan kesalahan besar, yang berusaha diminimalkan oleh algoritma. Dapat dilihat dari grafik bahwa mayoritas (jika dihitung - 93,22%) terletak pada kisaran 0-1juta, dan lebih dari 2mln - hanya 198 nilai (0,92%). Anda dapat menghilangkan 1% dari dataset hampir tanpa rasa sakit, karena itu, setelah memanggil tampilan sederhana dari 217 catatan, setelah sebelumnya mengurutkannya berdasarkan harga, kita akan melihat tanda harga yang diinginkan dari 1 965 000 dan menghapus semua yang di atas harga ini.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values (by=<span class="hljs-string">'price'</span>, ascending=<span class="hljs-literal">False</span>).head(<span class="hljs-number">217</span>) <font></font>
df=df[df[<span class="hljs-string">'price'</span>]&lt;=<span class="hljs-number">1965000</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita pikirkan sedikit tentang tanda kamar tidur. </font><font style="vertical-align: inherit;">Kita melihat 13 rumah dengan kamar tidur = 0, serta catatan aneh tentang rumah dengan 33 kamar tidur. </font><font style="vertical-align: inherit;">Kami akan melakukan hal yang sama dengan harga, menghapus nol dari bedrom (dan kamar mandi pada saat yang sama):</font></font><br>
<br>
<pre><code class="python hljs">df=df[(df[<span class="hljs-string">'bedrooms'</span>]!=<span class="hljs-number">0</span>)&amp;(df[<span class="hljs-string">'bathrooms'</span>]!=<span class="hljs-number">0</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengenai rumah dengan 33 kamar tidur - mengingat harganya, kita dapat mengasumsikan bahwa ini adalah kesalahan ketik dan kamar tidur sebenarnya adalah 3. Mari kita membandingkan ruang tamu rumah ini (1620) dengan rata-rata ruang tamu rumah 3 kamar tidur (1798.2), yang mungkin merupakan dugaan kita, oleh karena itu, ubah saja nilai ini menjadi 3 dan bangun plot kotak sebelumnya lagi:</font></font><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'bedrooms'</span>]==<span class="hljs-number">33</span>,[<span class="hljs-string">'bedrooms'</span>]]=<span class="hljs-number">3</span> 
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/qi/wd/fs/qiwdfscthapolbucfyjqy-uoggc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yah, jauh lebih baik. </font><font style="vertical-align: inherit;">Demikian pula, kamar tidur melihat kamar mandi. </font><font style="vertical-align: inherit;">Kami menghapus nilai nol, tidak ada nilai ekstrem lainnya di bidang:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'bathrooms'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bidang sqft_living, lantai, tepi laut, tampilan, kondisi, kelas, sqft_living15 juga semua nilai lebih atau kurang nyata, kami tidak akan menyentuhnya:</font></font><br>
<br>
<pre><code class="python hljs">plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">2</span>,<span class="hljs-number">3</span> 			<span class="hljs-comment"># </span>
sns.boxplot(y=<span class="hljs-string">'sqft_living'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'floors'</span>,color=<span class="hljs-string">'#2ecc71'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'sqft_living15'</span>,color=<span class="hljs-string">'#9b59b6'</span>, data=df) <font></font>
plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">4</span>,<span class="hljs-number">4</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'waterfront'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'view'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'condition'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'grade'</span> , data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/uw/h8/oquwh8x-cln4tbaz9xrzqyk9szs.png"><br>
<br>
<img src="https://habrastorage.org/webt/yl/ns/bz/ylnsbzq_kx2dtvrvjy8iytxudve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi dengan sqft_lot dan sqft_lot15 Anda perlu menemukan sesuatu dan karena nilai-nilai yang besar, logaritma cukup cocok:</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sqft_lot'</span>]=np.log(df[<span class="hljs-string">'sqft_lot'</span>])<font></font>
df[<span class="hljs-string">'sqft_lot15'</span>]=np.log(df[<span class="hljs-string">'sqft_lot15'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_lot sebelum dan sesudah: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/up/g2/yrupg24jwmfsptci9hf8uaq6wmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_above dan sqft_basement adalah komponen dari sqft_living, jadi kami juga tidak akan menyentuh mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan ini, kita akan mengakhiri dengan analisis pendahuluan dan melihat peta panas korelasi:</font></font><br>
<br>
<pre><code class="python hljs">sns.heatmap(df.corr(),  cmap = <span class="hljs-string">'viridis'</span>,annot = <span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/ny/yi/uq/nyyiuqa9zbilc9l6gqzljfe35xu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memeriksa peta korelasi, kita melihat bahwa kadang-kadang atribut sangat berkorelasi satu sama lain, jadi kami menghapus beberapa atribut dengan korelasi tinggi - sqft_lot15 (tinggalkan sqft_lot), yr_built (biarkan yr_renovated), sqft_above (sqft_living). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini melengkapi pekerjaan dengan data dan melanjutkan ke pembuatan model. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Pemodelan </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian ini, kita akan membangun 2 model: regresi linier dan pohon keputusan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua model yang kita butuhkan ada di perpustakaan sklearn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, kami memisahkan variabel target dari sisa data pelatihan, dan juga membagi sampel menjadi pelatihan (70%) dan tes (30%, di mana kami akan memeriksa cara kerja model):</font></font><br>
<br>
<pre><code class="python hljs">Y=df[<span class="hljs-string">'price'</span>]<font></font>
X=df.drop (<span class="hljs-string">'price'</span>,axis=<span class="hljs-number">1</span>) 
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X_train, X_test, Y_train, Y_test  = train_test_split(X, Y, test_size = <span class="hljs-number">0.3</span>, shuffle = <span class="hljs-literal">True</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga, dari sklearn, untuk mengevaluasi model, kami mengunggah 3 metrik - mean_absolute_error (mean absolute error), mean_squared_error (standar deviasi), r2_score (koefisien determinasi):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan regresi linier:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression<font></font>
LR = LinearRegression() 				<span class="hljs-comment"># </span>
LR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_LR = LR.predict(X_test)				<span class="hljs-comment">#       </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_LR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'√MSE:'</span>, round (mean_squared_error(Y_test, Y_LR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_LR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 124477.452 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√MSE 175205.645 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.627 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pohon </font><font style="vertical-align: inherit;">keputusan </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor<font></font>
TR = DecisionTreeRegressor()				<span class="hljs-comment"># </span>
TR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_TR=TR.predict(X_test)  				<span class="hljs-comment">#   </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_TR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'√MSE:'</span>, round (mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_TR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 151734.906 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√MSE 220856.721 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.407 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan metrik, kita dapat menyimpulkan bahwa regresi Linear menunjukkan hasil terbaik, sehingga lebih logis untuk memilihnya. Namun, kami tidak menanyakan kesalahan model, apakah model tersebut dilatih ulang, dll. Kemungkinan besar pelatihan ulang yang menyebabkan penurunan hasil DecisionTreeRegressor, karena kami bahkan tidak membatasi kedalaman pohon dalam parameter model. Kita dapat dengan mudah memeriksa ini dengan memilah-milah kedalaman pohon dalam siklus pendek:</font></font><br>
<br>
<pre><code class="python hljs">dep,score=[],[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>,<span class="hljs-number">16</span>):<font></font>
    TR = DecisionTreeRegressor(max_depth=i)<font></font>
    TR.fit(X_train, Y_train)<font></font>
    Y_TR=TR.predict(X_test)<font></font>
    dep.append(i)<font></font>
    score.append(mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))	<span class="hljs-comment">#  √MSE</span>
		plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">6</span>,<span class="hljs-number">3</span>
		plt.plot(dep, score)</code></pre><br>
<img src="https://habrastorage.org/webt/ar/fn/yt/arfnytm068lhpknk_ifnpshupgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jelas, indikator terbaik adalah di max_depth = 7, dan, melihat pada metrik (MAE: 124861.441, √MSE 175322.737, R2_score: 0.626), menjadi jelas bahwa model dengan pembatasan seperti itu mirip dengan regresi linier dalam kualitas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga dapat mencoba untuk mengevaluasi atribut apa yang paling penting untuk model untuk perkiraan biaya: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/qx/qw/x1qxqwlhqbfotpp45hhyr4nz0uc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan grafik, jelas bahwa grade paling mempengaruhi biaya - penilaian subjektif umum rumah oleh perusahaan real estat (yang, omong-omong, menunjukkan kompetensi penilaian :-))), di tempat kedua adalah area rumah, dan di ketiga - tahun perbaikan terakhir. Indikator mempertimbangkan jumlah kamar tidur, kamar mandi, lantai model dianggap tidak signifikan untuk perkiraan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk lebih memahami hasil, kami menghitung kesalahan rata-rata dalam% - menurut regresi linier, kesalahan rata-rata adalah 27,5%, yaitu, model membuat kesalahan sedikit lebih dari seperempat saat memperkirakan biaya rumah, yang cukup banyak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisakah hasilnya ditingkatkan? </font><font style="vertical-align: inherit;">Ya, tentu saja, pada tahap saat ini, kami hanya menerima solusi dasar - beberapa titik awal untuk perbandingan akan menjadi model yang lebih baik atau lebih buruk yang dapat kita buat dengan metode yang lebih canggih atau menggunakan pemrosesan data yang lebih kompleks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami hanya sedikit menyentuh pada masalah pelatihan ulang dan tidak menyentuh sama sekali tentang apa kesalahan model dan banyak aspek lain dari penciptaan model. </font><font style="vertical-align: inherit;">Sebagai aturan, berbagai metode validasi model digunakan untuk menjawab pertanyaan-pertanyaan ini dan menemukan solusi optimal, tetapi kami akan menulis tentang ini di artikel berikut.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id505498/index.html">Bagaimana kami memecahkan masalah memori tumpukan tidak diinisialisasi pada Windows</a></li>
<li><a href="../id505502/index.html">Omnichannel dalam layanan pelanggan: apa yang harus dicari dan bagaimana melakukan semuanya dengan benar?</a></li>
<li><a href="../id505506/index.html">Dia tidak menggigit: bagaimana membuat robot industri aman bagi pekerja</a></li>
<li><a href="../id505508/index.html">Bukan hanya teknologi tak berawak: masa depan industri otomotif</a></li>
<li><a href="../id505510/index.html">Merampingkan Check Point API dengan Python SDK</a></li>
<li><a href="../id505522/index.html">Monetisasi dalam game online: cara menggunakan pengalaman orang lain untuk kebutuhan Anda sendiri</a></li>
<li><a href="../id505528/index.html">Hal terpenting di Wi-Fi 6. Tidak, serius</a></li>
<li><a href="../id505530/index.html">Google membuat prosesornya, dan AMD bersiap untuk menghancurkan Qualcomm</a></li>
<li><a href="../id505532/index.html">Saluran telegram tentang pengembangan game: bagian 2</a></li>
<li><a href="../id505536/index.html">Cara memasak pelacakan panggilan: Pengalaman Cyan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>