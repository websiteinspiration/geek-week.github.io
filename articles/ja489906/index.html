<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍣 #⃣ 🦆 OpenCVの仮想試着室 🐓 👩🏽‍🤝‍👩🏻 🚞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="オンラインストアで気に入ったものを試着せずに購入したくないですか？もちろん、一部のお店ではご注文後、着払いで試着する機会もございます。ただし、統計によると、オンラインの衣料品店や靴店でのオンライン注文のシェアは毎年増加していますが、返品のシェアも50〜70％に達しています。これらは、オンラインの試着...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenCVの仮想試着室</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/489906/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインストアで気に入ったものを試着せずに購入したくないですか？もちろん、一部のお店ではご注文後、着払いで試着する機会もございます。ただし、統計によると、オンラインの衣料品店や靴店でのオンライン注文のシェアは毎年増加していますが、返品のシェアも50〜70％に達しています。これらは、オンラインの試着室を使用して大幅に削減できる大きな物流コストです。写真をアップロードし、服を選択すると、それが画像に転送されると想像してください。靴の仮想試着室はすでに存在しており、非常にうまく機能しています。少し前、私たちはこのトピックに興味を持っていましたが、服はどうですか？そのような作品も存在しますが、あまり成功していない作品が多く、記事に加えて何も見つかりません。実用的な例を夢見ることができます。これを修正し、OpenCVライブラリのネットワークの1つをサポートすることにしました。これから来たものは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">virtual_try_on.py</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプル。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/ph/-z/of/ph-zofulxoocdovsziuo3nvo_94.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果は完璧ではありませんが、この領域ではかなり良いと考えられています。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仮想試着室がどのように機能するか、モデルをOpenCVに統合するときに発生した問題を知りたい場合は、猫へようこそ！</font></font></p><a name="habracut"></a><br>
<p>    2019  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CP-VTON</a>     .     CP-VTON  ,           ,         (,   ).     3D  ,     3D-.       .        github.   CP-VTON  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>       ,   ,      .</p><br>
<p>         . </p><br>
<h2 id="princip-raboty"> </h2><br>
<p> CP-VTON    : GMM (Geometric Matching Module) —           TOM (Try-On Module) —        . </p><br>
<p>  GMM   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>c</mi><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.889ex" height="2.634ex" viewBox="0 -809.3 3396.5 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="1339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="1772" y="0"></use><g transform="translate(2217,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="613" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="3006" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>c</mi><mo>,</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(I, c, c_t )</script>,   TOM — <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>,</mo><msub><mi>I</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.19ex" height="2.634ex" viewBox="0 -809.3 3526.1 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="894" y="0"></use><g transform="translate(1339,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="33" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-5E" x="55" y="-7"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="1895" y="0"></use><g transform="translate(2340,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="3136" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mo>,</mo><msub><mi>I</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">(I, \hat{c}, I_t)</script>, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.009ex" viewBox="0 -755.5 504.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">I</script> —  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">c</script> —  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.292ex" height="2.009ex" viewBox="0 -755.5 556.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="33" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-5E" x="55" y="-7"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">\hat{c}</script> —  GMM, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.849ex" height="2.259ex" viewBox="0 -755.5 796.1 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">I_t</script> — ground truth (   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">c</script>), <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.833ex" height="1.759ex" viewBox="0 -540.2 789.1 757.5" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="613" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">c_t</script> — ground truth ( ,      <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.849ex" height="2.259ex" viewBox="0 -755.5 796.1 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">I_t</script>).      ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.849ex" height="2.259ex" viewBox="0 -755.5 796.1 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">I_t</script>  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">c</script>.          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">VITON</a>,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.009ex" viewBox="0 -755.5 504.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">I</script>         <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.884ex" viewBox="-38.5 -540.2 542 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-70" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">p</script>.   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.884ex" viewBox="-38.5 -540.2 542 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-70" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">p</script>       ,  , ,    ,      (, , ).            .  , GMM    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.02ex" height="2.634ex" viewBox="0 -809.3 2161.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-70" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="1338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="1771" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">(p, c)</script>     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.292ex" height="2.009ex" viewBox="0 -755.5 556.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="33" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-5E" x="55" y="-7"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\hat{c}</script>,       <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.833ex" height="1.759ex" viewBox="0 -540.2 789.1 757.5" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="613" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">c_t</script>. TOM    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.304ex" height="2.634ex" viewBox="0 -809.3 2283.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-70" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2C" x="893" y="0"></use><g transform="translate(1338,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="33" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-5E" x="55" y="-7"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="1894" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">(p, \hat{c})</script>,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>o</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.053ex" height="2.259ex" viewBox="0 -755.5 883.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-19">I_o</script>   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.849ex" height="2.259ex" viewBox="0 -755.5 796.1 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">I_t</script>.</p><br>
<p>    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.884ex" viewBox="-38.5 -540.2 542 811.3" role="img" focusable="false" style="vertical-align: -0.63ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-70" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">p</script>.       ,      .           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">OpenPose</a>.             .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">LIP_JPPNet</a>.      OpenCV  () sample <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">human_parsing.py</a>.</p><br>
<p>      ,    — ,  : ,  ,    .    ,       .</p><br>
<p><img src="https://habrastorage.org/webt/zc/z5/yd/zcz5yd4mri1tjefo1_ky9n82aoi.png" alt="前処理"></p><br>
<p>  .</p><br>
<p>GMM           .                ,  ,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mn>2</mn></msub><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x440;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x443;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.868ex" height="2.384ex" viewBox="0 -809.3 4679.3 1026.6" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-32" x="963" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2212" x="1357" y="0"></use><g transform="translate(2358,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2842,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3273,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3703,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4248,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>2</mn></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-22">L_2-</script>.          .           .           ,   .      <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>c</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.292ex" height="2.009ex" viewBox="0 -755.5 556.1 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="33" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-5E" x="55" y="-7"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>c</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-23">\hat{c}</script>  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.833ex" height="1.759ex" viewBox="0 -540.2 789.1 757.5" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="613" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">c_t</script>  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mn>1</mn></msub><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.479ex" height="2.259ex" viewBox="0 -755.5 4081.4 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-31" x="963" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2212" x="1357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6C" x="2358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="2656" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-73" x="3142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-73" x="3611" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">L_1-loss</script>.</p><br>
<p><img src="https://habrastorage.org/webt/hw/er/qe/hwerqehwxjvyyytowzqfp_3l64g.png" alt="うーん"></p><br>
<p> TOM       .     Unet.    ,                     . Unet    ,    .       ,           Unet .       ,     .      Upsample  .  (encoder)      VGG-19.          . Unet    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>r</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.997ex" height="2.259ex" viewBox="0 -755.5 859.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-72" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">I_r</script>    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.009ex" viewBox="0 -755.5 1051.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">M</script>.       <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.509ex" viewBox="0 -540.2 433.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">c</script>    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>r</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.997ex" height="2.259ex" viewBox="0 -755.5 859.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-72" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">I_r</script>,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.254ex" height="2.634ex" viewBox="0 -809.3 3553.9 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4D" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="3164" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">(1 - M)</script>     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>o</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.053ex" height="2.259ex" viewBox="0 -755.5 883.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">I_o</script>.</p><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>I</mi><mi>o</mi></msub><mo>=</mo><mi>M</mi><mo>&amp;#x2299;</mo><mi>c</mi><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>M</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2299;</mo><msub><mi>I</mi><mi>r</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.373ex" height="2.634ex" viewBox="0 -809.3 11785.4 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="622" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-3D" x="1161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4D" x="2217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2299" x="3491" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-63" x="4492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2B" x="5148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-28" x="6148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-31" x="6538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2212" x="7260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4D" x="8261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-29" x="9313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2299" x="9924" y="0"></use><g transform="translate(10925,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-72" x="622" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>I</mi><mi>o</mi></msub><mo>=</mo><mi>M</mi><mo>⊙</mo><mi>c</mi><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo><mo>⊙</mo><msub><mi>I</mi><mi>r</mi></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-32">I_o=M\odot c + (1 - M)\odot I_r</script></p><br>
<p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2299;</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.884ex" viewBox="0 -647.8 778.5 811.3" role="img" focusable="false" style="vertical-align: -0.38ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2299" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊙</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">\odot</script> —    .</p><br>
<p><img src="https://habrastorage.org/webt/hl/fn/pe/hlfnpepqe0u6txqjkfpof3qgbpm.png" alt="トム"></p><br>
<p>     Try-On  —   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>o</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.053ex" height="2.259ex" viewBox="0 -755.5 883.8 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>o</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">I_o</script>  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.849ex" height="2.259ex" viewBox="0 -755.5 796.1 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-74" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">I_t</script>.                  .       ,    ,      .       <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mn>1</mn></msub><mo>&amp;#x2212;</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.479ex" height="2.259ex" viewBox="0 -755.5 4081.4 972.7" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-31" x="963" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMAIN-2212" x="1357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6C" x="2358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-6F" x="2656" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-73" x="3142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/intel/blog/489906/&amp;usg=ALkJrhhJSzO4HcxwLQUFpHn6VpNwU4tUEw#MJMATHI-73" x="3611" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>1</mn></msub><mo>−</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">L_1- loss</script>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">perceptual loss</a>.            VGG     ,         .  VGG       —      ,        .</p><br>
<h2 id="realizaciya-v-opencv">  OpenCV</h2><br>
<p>                           .    json      ,     OpenPose  Caffe,        LIP.</p><br>
<p>     ,         ,             .</p><br>
<pre><code class="bash hljs">python3 virtual_try_on.py -i person_img.jpg -c cloth.jpg</code></pre><br>
<p>    OpenCV       PIL.     .   LIP   ,      .      CP-VTON     .   ,       :</p><br>
<pre><code class="python hljs">shape = (segm &gt; <span class="hljs-number">0</span>).astype(np.float32)<font></font>
head  = (segm == <span class="hljs-number">1</span>).astype(np.float32) + \<font></font>
        (segm == <span class="hljs-number">2</span>).astype(np.float32) + \<font></font>
        (segm == <span class="hljs-number">4</span>).astype(np.float32) + \<font></font>
        (segm == <span class="hljs-number">13</span>).astype(np.float32)<font></font>
cloth = (segm == <span class="hljs-number">5</span>).astype(np.float32) + \<font></font>
        (segm == <span class="hljs-number">6</span>).astype(np.float32) + \<font></font>
        (segm == <span class="hljs-number">7</span>).astype(np.float32)</code></pre><br>
<p>,  PIL      ,      .       human_colormap.mat.    ? Matlab   .  , scipy    .   ()            .</p><br>
<p> – .        16 ,    .</p><br>
<pre><code class="python hljs">mask = mask.resize((width // <span class="hljs-number">16</span>, height // <span class="hljs-number">16</span>), Image.BILINEAR)<font></font>
mask = mask.resize((width, height), Image.BILINEAR)</code></pre><br>
<p>    .     . ,        OpenCV.  PIL resize  cv.resize     .</p><br>
<p><img src="https://habrastorage.org/webt/dg/2h/ss/dg2hssxuigwj2s7grc9ja0humag.jpeg"> <img src="https://habrastorage.org/webt/6v/bs/zp/6vbszpfhzfnr_d17k6wc76pzjak.jpeg"></p><br>
<p> ,   PIL resize,  — cv.resize.</p><br>
<p>    ,    ?    .</p><br>
<p><img src="https://habrastorage.org/webt/ux/ud/0x/uxud0x1nalslqajcfpdj65l8eyg.jpeg" alt="mask_pil"> <img src="https://habrastorage.org/webt/z5/5x/yy/z55xyyajx9hj1jxarrgui4s3krw.jpeg" alt="mask_ocv"></p><br>
<p> ,      PIL resize,  — cv.resize.</p><br>
<p> ,       .       ?  ,      .  ,    –    .   ,  bilinear resize     bilinear,   area.     scale factor,       33 = 16 * 2 + 1,      OpenCV    – 3.     ,        ,       .           .  .      ,   .       .         :</p><br>
<div class="spoiler"><b class="spoiler_title">    PIL</b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BilinearFilter</span>(<span class="hljs-params">object</span>):</span>
    <span class="hljs-string">"""
    PIL bilinear resize implementation
    image = image.resize((image_width // 16, image_height // 16), Image.BILINEAR)
    """</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_precompute_coeffs</span>(<span class="hljs-params">self, inSize, outSize</span>):</span>
        filterscale = max(<span class="hljs-number">1.0</span>, inSize / outSize)<font></font>
        ksize = int(np.ceil(filterscale)) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span><font></font>
<font></font>
        kk = np.zeros(shape=(outSize * ksize, ), dtype=np.float32)<font></font>
        bounds = np.empty(shape=(outSize * <span class="hljs-number">2</span>, ), dtype=np.int32)<font></font>
<font></font>
        centers = (np.arange(outSize) + <span class="hljs-number">0.5</span>) * filterscale + <span class="hljs-number">0.5</span>
        bounds[::<span class="hljs-number">2</span>] = np.where(centers - filterscale &lt; <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, centers - filterscale)<font></font>
        bounds[<span class="hljs-number">1</span>::<span class="hljs-number">2</span>] = np.where(centers + filterscale &gt; inSize, inSize, centers + filterscale) - bounds[::<span class="hljs-number">2</span>]<font></font>
        xmins = bounds[::<span class="hljs-number">2</span>] - centers + <span class="hljs-number">1</span><font></font>
<font></font>
        points = np.array([np.arange(row) + xmins[i] <span class="hljs-keyword">for</span> i, row <span class="hljs-keyword">in</span> enumerate(bounds[<span class="hljs-number">1</span>::<span class="hljs-number">2</span>])]) / filterscale
        <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, outSize):<font></font>
            point = points[xx]<font></font>
            bilinear = np.where(point &lt; <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span> - abs(point), <span class="hljs-number">0.0</span>)<font></font>
            ww = np.sum(bilinear)<font></font>
            kk[xx * ksize : xx * ksize + bilinear.size] = np.where(ww == <span class="hljs-number">0.0</span>, bilinear, bilinear / ww)
        <span class="hljs-keyword">return</span> bounds, kk, ksize<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_resample_horizontal</span>(<span class="hljs-params">self, out, img, ksize, bounds, kk</span>):</span>
        <span class="hljs-keyword">for</span> yy <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, out.shape[<span class="hljs-number">0</span>]):
            <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, out.shape[<span class="hljs-number">1</span>]):<font></font>
                xmin = bounds[xx * <span class="hljs-number">2</span> + <span class="hljs-number">0</span>]<font></font>
                xmax = bounds[xx * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]<font></font>
                k = kk[xx * ksize : xx * ksize + xmax]<font></font>
                out[yy, xx] = np.round(np.sum(img[yy, xmin : xmin + xmax] * k))<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_resample_vertical</span>(<span class="hljs-params">self, out, img, ksize, bounds, kk</span>):</span>
        <span class="hljs-keyword">for</span> yy <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, out.shape[<span class="hljs-number">0</span>]):<font></font>
            ymin = bounds[yy * <span class="hljs-number">2</span> + <span class="hljs-number">0</span>]<font></font>
            ymax = bounds[yy * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>]<font></font>
            k = kk[yy * ksize: yy * ksize + ymax]<font></font>
            out[yy] = np.round(np.sum(img[ymin : ymin + ymax, <span class="hljs-number">0</span>:out.shape[<span class="hljs-number">1</span>]] * k[:, np.newaxis], axis=<span class="hljs-number">0</span>))<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">imaging_resample</span>(<span class="hljs-params">self, img, xsize, ysize</span>):</span><font></font>
        height, width, *args = img.shape<font></font>
        bounds_horiz, kk_horiz, ksize_horiz = self._precompute_coeffs(width, xsize)<font></font>
        bounds_vert, kk_vert, ksize_vert    = self._precompute_coeffs(height, ysize)<font></font>
<font></font>
        out_hor = np.empty((img.shape[<span class="hljs-number">0</span>], xsize), dtype=np.uint8)<font></font>
        self._resample_horizontal(out_hor, img, ksize_horiz, bounds_horiz, kk_horiz)<font></font>
        out = np.empty((ysize, xsize), dtype=np.uint8)<font></font>
        self._resample_vertical(out, out_hor, ksize_vert, bounds_vert, kk_vert)<font></font>
        <span class="hljs-keyword">return</span> out</code></pre></div></div><br>
<h2 id="rezultaty"></h2><br>
<p>       4 ,    ,     OpenCV.           .       ,        .      ,          .             256  192,     .       sample        .       ,           -   ,        .</p><br>
<p>P.S.   2020  OpenCV   20-.            .   !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja489892/index.html">Luxoftでの内部ITコミュニティの構築方法</a></li>
<li><a href="../ja489898/index.html">トイレについての別の記事</a></li>
<li><a href="../ja489900/index.html">PostgreSQLアンチパターン：トリガーをバイパスしてデータを変更する</a></li>
<li><a href="../ja489902/index.html">投資ポートフォリオの効果を測定する方法：3つの実際的なアプローチ</a></li>
<li><a href="../ja489904/index.html">アップデートをテストする理由と方法</a></li>
<li><a href="../ja489912/index.html">Web開発でマイクロサービスをデバッグするときの苦痛</a></li>
<li><a href="../ja489914/index.html">Proxmox VEでのクラスタリング</a></li>
<li><a href="../ja489916/index.html">プロトブフまたはJSON構造のフロントエンド通信プロトコル？</a></li>
<li><a href="../ja489918/index.html">仮想燃料カードプロジェクトの実装方法</a></li>
<li><a href="../ja489920/index.html">サイト、IPv6に移動、2つ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>