<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🔬 😜 📅 Python-Telegramm-Paginierungsbot 💃🏿 🐖 👕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor kurzem stand ich vor der Aufgabe, eine Liste von Elementen in einem Telegrammbot zu paginieren. Und sie war überrascht, dass PyPi für eine solche ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Python-Telegramm-Paginierungsbot</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501812/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vor kurzem stand ich vor der Aufgabe, eine Liste von Elementen in einem Telegrammbot zu paginieren. </font><font style="vertical-align: inherit;">Und sie war überrascht, dass PyPi für eine solche scheinbar typische Aufgabe keine einzige Bibliothek hat. </font><font style="vertical-align: inherit;">Daher wurde beschlossen, dieses ärgerliche Versäumnis zu korrigieren und seine Umsetzung zu veröffentlichen.</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können das Paket von PyPi installieren, indem Sie es in der Konsole ausführen:</font></font></p><br>
<pre><code class="bash hljs">pip install python-telegram-bot-pagination</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die InlineKeyboardPaginator-Klasse aus dem Paket telegram_bot_pagination erleichtert das Abrufen einer Reihe von Inline-Schaltflächen zum Navigieren durch die Listenseiten. </font><font style="vertical-align: inherit;">Es ist erforderlich, die Anzahl der Seiten, in die die Liste der Elemente unterteilt ist, sowie die aktuelle Seite und das aktuelle Muster zum Generieren von Daten, die durch Drücken der Bot-Taste zurückgegeben werden, an den Designer zu übertragen. </font><font style="vertical-align: inherit;">Danach bildet der Paginator selbst die erforderliche Tastatur, die über die Markup-Eigenschaft verfügbar ist.</font></font></p><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> telegram_bot_pagination <span class="hljs-keyword">import</span> InlineKeyboardPaginator<font></font>
<font></font>
paginator = InlineKeyboardPaginator(<font></font>
        <span class="hljs-number">10</span>,<font></font>
        current_page=<span class="hljs-number">1</span>,<font></font>
        data_pattern=<span class="hljs-string">'elements#{page}'</span>
    )</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt gibt paginator.markup ein json-Objekt für das Feld reply_markup der API-Methode sendMessage Telegram Bot zurück. </font><font style="vertical-align: inherit;">In diesem Fall werden fünf Schaltflächen gebildet. </font><font style="vertical-align: inherit;">Wenn die Anzahl der Seiten fünf oder weniger beträgt, werden die Schaltflächen entsprechend angezeigt. </font><font style="vertical-align: inherit;">Wenn nur eine Seite vorhanden ist, ist das Markup leer. </font><font style="vertical-align: inherit;">Wenn mehr als fünf Seiten vorhanden sind, enthält die Tastatur 5 Tasten für:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erste Seite;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vorherige Seite;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aktuelle Seite;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nächste Seite;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">letzte Seite.</font></font></li>
</ul><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn beispielsweise ein Array von Charakterseiten mit Beschreibungen von Harry-Potter-Charakteren vorhanden ist, um einen Bot zu erstellen, der eine Liste von Charakteren anzeigt, benötigen wir eine Funktion, die die aktuelle Listenseite sendet:</font></font></p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_character_page</span>(<span class="hljs-params">message, page=<span class="hljs-number">1</span></span>):</span><font></font>
    paginator = InlineKeyboardPaginator(<font></font>
        len(character_pages),<font></font>
        current_page=page,<font></font>
        data_pattern=<span class="hljs-string">'character#{page}'</span><font></font>
    )<font></font>
<font></font>
    bot.send_message(<font></font>
        message.chat.id,<font></font>
        character_pages[page<span class="hljs-number">-1</span>],<font></font>
        reply_markup=paginator.markup,<font></font>
        parse_mode=<span class="hljs-string">'Markdown'</span>
    )</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und der Button-Handler im Bot:</font></font></p><br>
<pre><code class="python hljs">
<span class="hljs-meta">@bot.callback_query_handler(func=lambda call: call.data.split('#')[0]=='character')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">characters_page_callback</span>(<span class="hljs-params">call</span>):</span>
    page = int(call.data.split(<span class="hljs-string">'#'</span>)[<span class="hljs-number">1</span>])<font></font>
    bot.delete_message(<font></font>
        call.message.chat.id,<font></font>
        call.message.message_id<font></font>
    )<font></font>
    send_character_page(call.message, page)<font></font>
</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Beispiel verwendet pyTelegramBotAPI, um mit dem Bot zu arbeiten.</font></font></em></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Den vollständigen Code für das Beispiel finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Ergebnis sieht abhängig von der Anzahl der Einträge in der Liste folgendermaßen aus:</font></font></p><br>
<p><img src="https://habrastorage.org/webt/ql/c9/_t/qlc9_t6jziecxi7nnhgasn_rmlo.png"></p><br>
<p><img src="https://habrastorage.org/webt/na/us/ut/nausutgts_d96lpmy_9oqhual4y.png"></p><br>
<p><img src="https://habrastorage.org/webt/7k/o7/xw/7ko7xw3169bgtdh4evx4gu7jsas.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielen Dank für Ihre Aufmerksamkeit. </font><font style="vertical-align: inherit;">Ich werde mich über jede konstruktive Kritik freuen.</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501800/index.html">Kleine Osinta-Sitzung zur Modernisierung und Produktion von Funkkommunikationssystemen für die Streitkräfte der Russischen Föderation</a></li>
<li><a href="../de501804/index.html">Pfeil. Alles, was Sie über Konstanten wissen müssen</a></li>
<li><a href="../de501806/index.html">ACS: Probleme, Lösungen und Sicherheitsrisikomanagement</a></li>
<li><a href="../de501808/index.html">Die Liste der Änderungen in D 2.092. Ausleihen Ausleihen</a></li>
<li><a href="../de501810/index.html">Coole 3D-Shooter auf einem alten Laptop: ein Test der Cloud-Gaming-Plattform GFN.RU</a></li>
<li><a href="../de501814/index.html">COVID-Änderungen: Geschichten von StartupDrive-Mitgliedern, die sich während einer Pandemie geändert haben und stärker geworden sind</a></li>
<li><a href="../de501820/index.html">Integration von Netflow- und SIEM-Überwachungslösungen</a></li>
<li><a href="../de501822/index.html">Ingenieur der dritten Generation</a></li>
<li><a href="../de501824/index.html">Machen Sie sich bereit für einen Hackathon zu Hause</a></li>
<li><a href="../de501826/index.html">Über ehrgeizige Gründer oder wie ich versucht habe, Investitionen für ein Startup zu sammeln</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>