<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏼 🥙 ⛑️ Nochmals ca. 433 MHz Sender und Empfänger 🤾🏻 👷🏻 🍵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der einfachste Satz von 433-MHz- ISM- Empfängern und -Sendern hat bei Elektronikliebhabern wohlverdiente Popularität erlangt. Die Kits sind billig (se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nochmals ca. 433 MHz Sender und Empfänger</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491530/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der einfachste Satz von </font><font style="vertical-align: inherit;">433-MHz- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISM-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Empfängern und -Sendern hat </font><font style="vertical-align: inherit;">bei Elektronikliebhabern wohlverdiente Popularität erlangt. Die Kits sind billig (selbst in Chip-Deep kann man sie für 300 Rubel kaufen, und bei Ali, sagen sie, im Allgemeinen für fünfzig Dollar), sie sind einfach und zuverlässig. Darüber hinaus (was Sie wahrscheinlich nicht vermuten) ist dies die weitreichendste und durchdringendste Methode des drahtlosen Datenaustauschs - ein Signal mit einer Frequenz von 433 MHz passiert Hindernisse viel besser und arbeitet in größerer Entfernung als im beliebten 2,4-GHz-Band (433) MHz wird </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch eine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wand aus einem halben Meter Beton </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">vollständig verzögert</font></a><font style="vertical-align: inherit;"> , und Wi-Fi stirbt bereits um 10 Zentimeter. Ich gebe zu, dass kürzlich </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MBee-868-</font></a><font style="vertical-align: inherit;"> Module erschienen sind</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Da sie mit einer geeigneten (Richt-) Antenne ausgestattet sind, „schießen“ sie weiter, sind jedoch mindestens eine Größenordnung teurer, schwieriger anzuschließen, erfordern ein energiesparendes Management und eine Vorkonfiguration. </font><font style="vertical-align: inherit;">Außerdem passiert die Frequenz von 868 MHz doppelt so schlechte Hindernisse (obwohl sie natürlich unvergleichlich besser ist als die Frequenz von 2,4 GHz). </font><font style="vertical-align: inherit;">Natürlich wurde </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a04/2bb/c3c/a042bbc3ca312c739041b507e7ca4b5e.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
viel über 433-MHz-Sender und -Empfänger (einschließlich des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hubs) geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es scheint jedoch, dass niemand aus irgendeinem seltsamen Grund weiß, wie man dieses Kit korrekt in die Schaltung einbindet. </font><font style="vertical-align: inherit;">Als ich hier noch einmal las </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass das Kit „ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 Meter in Sichtweite nahm, konnte der 9. Meter nicht gemeistert werden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">", Meine Geduld schnappte. </font><font style="vertical-align: inherit;">Welche anderen 8 Meter ?! </font><font style="vertical-align: inherit;">Bei 40-50 hätte ich geglaubt, obwohl in Wirklichkeit die Reichweite wahrscheinlich noch größer ist.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist erwähnenswert, dass ich das Problem, eine Leitung für die Übertragung beliebiger Daten zu erstellen und nicht nur intelligente Steckdosen oder Motormodellboote zu steuern, weiter löse. Meine Aufgabe ist komplizierter, aber der Abstand zum zuverlässigen Betrieb ist immer noch viel größer. Darüber hinaus ist bei einer solchen Aufgabe nicht nur und nicht so sehr die Entfernung innerhalb der Sichtlinie wichtig (sie kann nur zum Vergleich dienen), sondern auch die Fähigkeit, verschiedene Hindernisse zu durchdringen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe ein solches Kit, das auf dem Land in einem Abstand von etwa 25 bis 30 Metern in einem spitzen Winkel zur Blockwand arbeitet, so dass sich ungefähr ein Meter (insgesamt) Wände und Trennwände, die teilweise durch Folienisolierung abgeschirmt sind, im Signalweg befinden. In einer viel kürzeren Entfernung, fast direkt hinter der Wand, verliert WiFi bereits das Signal vollständig. In der Stadt endet das Signal von einem Ende einer Dreizimmer-Stadtwohnung zum anderen durch zwei innere Trennwände sowie vom Balkon, wo in einer geraden Linie zwischen Sender und Empfänger mindestens 80 Zentimeter Mauerwerk und eine Putztrennwand vorhanden sind. Ich habe keine teureren Kit-Optionen verwendet, die in der obigen Bewertung erwähnt wurden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein zusätzlicher Vorteil des Kits besteht darin, dass der Sender in Pausen nichts und ohne spezielle Ruhemodi einfach nach dem Prinzip seines Geräts verbraucht (der Verbrauchsstrom in Ruhe ist vergleichbar mit den Kollektorleckströmen eines verriegelten Transistors, dh etwa 100 nA). </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, was die Fallstricke sind.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senderverbindung</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Sender (FS1000A) ist, wie aus dem folgenden Diagramm hervorgeht, der einfachste Generator, der auf einem 433-MHz-SAW-Resonator basiert. </font><font style="vertical-align: inherit;">Der Generator ist auf dem Transistor Q1 montiert, und der Transistor Q2, auf dessen Grundlage digitale Daten geliefert werden, ist einfach ein Schlüssel, der den Generator bei Vorhandensein eines hohen Pegels (logische Einheit) am Eingang mit Strom (an den GND-Bus) verbindet. </font><font style="vertical-align: inherit;">Die Leistung kann zwischen 5 und 12 Volt liegen. Je höher die Leistung, desto weiter funktioniert die Verbindung laut Hersteller.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a21/50c/737/a2150c737eb648ed465e060aa2d178ae.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe die grundlegenden Vorteile einer erhöhten Ernährung als Teil meiner Aufgabe nicht bemerkt. Nichtsdestotrotz sollte man nicht vernachlässigen, dass hier keine besonderen Leistungsanforderungen bestehen und das Gerät mit erhöhter Spannung nur besser funktioniert. Es ist praktisch, den Sender direkt an die Spannung eines 9-12-Volt-Adapters, einer Batterie oder eines Satzes von 6 Batterien (Vin Arduino-Pin) anzuschließen. Bei einer instabilen Stromversorgung, die 12 Volt überschreiten kann (wie zum Beispiel bei Batterien), entkopple ich den Sender normalerweise mit einem separaten 9-Volt-Stabilisator vom Hauptstromkreis (Sie können den einfachsten 78L09 verwenden), und ich sehe keinen Unterschied im Betrieb zwischen 9 und 12 Volt. Mit Uno oder Nano können Sie den eingebauten 5-Volt-Stabilisator verwenden, um den Controller selbst und andere Schaltkreise (z. B. Sensoren) mit Strom zu versorgen.und für Mini (insbesondere seine billigen Klone) würde ich Ihnen raten, einen separaten 5-Volt-Stabilisator zu verwenden, der an den 5-V-Pin angeschlossen wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass kürzlich Sender erschienen sind, die etwas unüblich aussehen (siehe Abb. Unten). Es stellte sich heraus, dass das Fehlen eines L1-Gashebels (drei Umdrehungen), von dem nur noch Löcher übrig waren - eine Fiktion, die einfach durch die entsprechende SMD-Komponente ersetzt wurde. Schlimmer bei dieser Option ist anders: Schlampiges Drucken kann hinsichtlich der Verbindung von Datenpins und Strom irreführend sein. Die richtige Verbindung ist in der Abbildung dargestellt. Sie ist für alle Optionen gleich:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/db4/cfc/e17/db4cfce176c768cc5f3504edfbf91513.png" width="250"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Auffälligste in dieser Angelegenheit ist, dass der Sender bei einer Verwechslung von Daten und Leistung über kurze Entfernungen weiter arbeitet! </font><font style="vertical-align: inherit;">Wenn Sie sich die Schaltung ansehen, werden Sie verstehen, was es ist: Die Q2-Basis über den Widerstand ist mit der Stromversorgung verbunden, der Transistor ist immer offen und hat keinen Einfluss auf den Betrieb der Schaltung. </font><font style="vertical-align: inherit;">Ein logisch hoher Pegel auf dem Leistungsbus versorgt den Generator nur zum richtigen Zeitpunkt. </font><font style="vertical-align: inherit;">Die Absurditäten beginnen in einiger Entfernung - es ist klar, dass aus einer logischen Schlussfolgerung die Stromquelle schlecht ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empfängerverbindung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Achten Sie beim Kauf eines Empfängers (er kann als MX-RM-5V oder XD-RF-5V bezeichnet werden) auf die Länge der Klemmen - ich bin irgendwie auf eine ganze Charge mit verkürzten Stiften gestoßen, die dazu führte, dass der </font><font style="vertical-align: inherit;">Empfänger bei der geringsten Verzerrung aus </font><font style="vertical-align: inherit;">dem Standard- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBS-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anschluss </font><font style="vertical-align: inherit;">herausfiel Ich musste mich speziell an das Board binden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Empfängerschaltung ist viel komplizierter (ich werde sie nicht spielen, aber Sie können sie zum Beispiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier finden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Es sollte ein Hochfrequenzsignal empfangen und verstärken, die Frequenz von 433 MHz herausfiltern, Bursts isolieren und in logische Pegel umwandeln. Der Empfänger hat eine Stimmdrossel (in der Mitte der Platine), aber ohne genaue Instrumente zur Messung der Amplituden-Frequenz-Eigenschaften empfehle ich nicht, sie zu verdrehen - höchstwahrscheinlich werden Sie nichts verbessern, sondern nur verderben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da das Signal bereits in geringer Entfernung viel weniger Interferenzen aufweist, ist es klar, dass wir uns mit Interferenzen an allen Fronten befassen müssen: mit Schaltkreisen und Softwaremethoden. Bibliotheken erledigen das Letzte für uns, aber unabhängig davon, welche Mathematik in der Softwareverarbeitung verwendet wird, ist es ratsam, zuerst alles zu tun, damit die logische Einheit am Ausgang nur erscheint, wenn ein nützliches Signal platzt und nicht bei Störungen auftritt. Mit anderen Worten, es wäre schön, im Voraus auf Störungen während des Empfangs auf das Maximum abzustimmen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Standardmethode zur Rauschunterdrückung, die in meiner Zeit jedem Schüler bekannt ist, der mindestens ein Radio oder einen Verstärker zusammengebaut hat, besteht darin, dass für störungsempfindliche Knoten eine separate Stromversorgung erforderlich ist, die maximal von anderen Schaltkreisen isoliert ist. Sie können dies auf verschiedene Arten tun: Nachdem Sie eine separate Zenerdiode installiert haben, isolieren diese häufig die Leistung eines Problemknotens mit einem LC-Filter (dies wird beispielsweise für ADCs empfohlen, siehe Datenblätter für AVR-Controller). Unter unseren Bedingungen, wenn moderne Komponenten klein und billig sind, ist es jedoch einfacher, einen vom Rest getrennten Stabilisator am Empfänger anzubringen.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bd3/85b/94a/bd385b94af583fa8c188053297965c1b.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Stabilisator vom Typ LP2950-5.0 plus zwei dafür erforderliche Kondensatoren in der billigsten Option (wenn beide Kondensatoren aus Keramik im Bereich von 1 bis 3 Mikrofarad bestehen) erhöht die Kosten Ihrer Schaltung um maximal 60. Aber ich möchte lieber nicht sparen: Am Ausgang habe ich eine gewöhnliche Keramik und am Eingang einen Elektrolyten (10-100 μF), außerdem Festkörper (Polymer) oder Tantal. Auf Keramikkondensatoren kann sowohl dort als auch dort verzichtet werden, wenn die Eingangsspannung von 7-12 Volt von Batterie-Batterien oder von einem anderen analogen Stabilisator stammt. Gepulste stabilisierte Quellen und die einfachsten nicht stabilisierten Gleichrichter erfordern eine zusätzliche Filterung. Sie können billigen Aluminiumelektrolyten verwenden, wenn Sie eine keramische 0,1-Mikrofarad parallel dazu platzieren.Es ist sogar noch besser, eine Reiheninduktivität am Eingang mehrerer Fraktionen oder Einheiten von Milligenri anzubringen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Stabilisator sollte direkt in der Nähe des Empfängers installiert werden, die Länge der Leiter sollte minimal sein. Anstelle des LP2950 können Sie den LM2931 oder ähnliches mit einer kleinen Durchgangsspannung verwenden (dies ist besonders wichtig, wenn der Stromkreis mit Batterien betrieben wird - für einen normalen LM78L05 sollte die Eingangsspannung mindestens 7,5 und vorzugsweise 8-9 Volt betragen).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verglichen mit dem Fall, dass der Empfänger direkt von Arduino aus mit Strom versorgt wird, wie in allen Veröffentlichungen empfohlen (ich habe keine Ausnahmen gesehen), werden Sie erstaunt sein über den erzielten Effekt - die Reichweite und die Fähigkeit, durch die Wände zu dringen, nehmen sofort erheblich zu. Der Empfänger kann zusammen mit dem Stabilisator zur Vereinfachung in einer separaten kleinen Box ausgeführt werden. Sie können den Ausgang mit einem dreiadrigen Kabel (zwei Netzteile und ein Signalleiter) mit einer Länge von bis zu 3 Metern und möglicherweise mehr mit dem Controller im Hauptgehäuse verbinden. Dies ist bequemer, da immer noch Antennen benötigt werden. Gemäß den Regeln ist es besser, wenn sie im Raum parallel zueinander sind. Große Gehäuse können nicht immer so platziert werden, dass die Antennen in der richtigen Ausrichtung hervorstehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der einfachsten Version können Sie als Antennen einadrige Drahtabfälle mit einem Querschnitt von mindestens 0,5 mm und einer Länge von 17 cm ± 1-3 mm verwenden. </font><font style="vertical-align: inherit;">Verwenden Sie keinen verseilten Befestigungsdraht! </font><font style="vertical-align: inherit;">Kompaktere Spiralantennen werden zum Verkauf angeboten, aber ich persönlich habe ihre Wirksamkeit nicht getestet. </font><font style="vertical-align: inherit;">Die Antennenspitze sowohl des Senders als auch des Empfängers ist in das entsprechende Loch in der Ecke der Platine eingeschlossen (machen Sie keinen Fehler in der aktualisierten Version des Senders - das Wort ANT ist auch dort fehl am Platz, siehe Abb. Oben).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erzeugung und Verarbeitung übertragener Daten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist der zweite große Nachteil der meisten Bewertungen zu unserem Thema: Die Autoren beschränken sich auf ein lokales Problem, ohne es allgemein zu formulieren, wie die Übertragung beliebiger Daten in einem Paket. Wie Sie aus der obigen Beschreibung verstanden haben, kann von unserem Satz nur eine einfache Folge von Bits übertragen werden. Die Standard- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualWire-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek </font><font style="vertical-align: inherit;">codiert sie auf spezielle Weise (jede Tetrade wird mit 6 Bit codiert, ein Synchronisationsheader wird vorne hinzugefügt und eine Prüfsumme für das gesamte Paket wird hinzugefügt) und wandelt die Ausgabe in eine bekanntere Folge von Bytes um. Aber der Programmierer muss sich schon selbst darum kümmern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weiterhin nehmen wir an, dass der Sender und der Empfänger mit dem Arduino verbunden sind. Neben VirtualWire gibt es im Zusammenhang mit dem Boom von „Smart Homes“ viele andere Dinge wie RC-Switch oder RemoteSwitch, die sich jedoch auf andere Aufgaben konzentrieren, und es lohnt sich eindeutig nicht, sie zur Übertragung beliebiger Daten zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die maximale Länge einer einzelnen Nachricht in VirtualWire beträgt 27 Byte (siehe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Die Übertragung einer vollständigen Nachricht (sie wird automatisch mit einer Signatur 0xb38, einem Nachrichtenlängenwert und einer Prüfsumme ergänzt) mit meiner gewählten Geschwindigkeit von 1200 Bit / s beträgt 0,35 Sekunden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je höher übrigens die gewählte Übertragungsgeschwindigkeit ist, desto geringer ist die Übertragungsreichweite. Aus der Erfahrung mit RS-232 ist bekannt, dass mit zunehmender Reichweite die zulässige Übertragungsgeschwindigkeit exponentiell abnimmt: Bei einer Geschwindigkeit von 19.200 läuft eine ungeschirmte Leitung 15 Meter lang, bei 9600 - 150 Metern und bei einer Geschwindigkeit von 1200 - mehr als einem Kilometer. Es wäre interessant, die Art dieser Abhängigkeit für unseren Fall experimentell herauszufinden, da hier viel von der verwendeten Mathematik abhängt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Initialisieren des Senders in VirtualWire sieht folgendermaßen aus:</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span><font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span>
  vw_set_tx_pin(<span class="hljs-number">10</span>);   <span class="hljs-comment">//   VirtualWire D10</span><font></font>
. . . . .<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden die Prinzipien der Datengenerierung anhand eines konkreten Beispiels analysieren. Lassen Sie uns einen entfernten Temperatur-Feuchtigkeits-Sensor haben. Es gibt Werte (Temperatur- und Feuchtigkeitsvariablen) in Form einer reellen Zahl mit einem Vorzeichen (float) an. Um das Verständnis auf der Empfangsseite zu vereinfachen, werden wir alle auf eine positive Ganzzahl mit einer Anzahl von mindestens 4 Dezimalstellen reduzieren, die Bits einzeln in ASCII-Zeichen übersetzen, die resultierende Zeichenfolge übertragen und auf der Empfangsseite umgekehrte Operationen ausführen. Natürlich können Sie die Aufgabe vereinfachen (z. B. auf die Konvertierung in ASCII verzichten und die Zahlen verkürzen), aber in dieser Form ist sie für fast alle Arten von digitalen Daten gleich, was die Demontage beim Empfang vereinfacht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Praxis ist es praktisch, den String-Typ zu verwenden, um eine Nachricht zu erstellen.</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-comment">//    </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ledPin 13 <span class="hljs-comment">//  (D13,  19 ATmega) </span></span>
<span class="hljs-keyword">char</span> msg[<span class="hljs-number">13</span>];
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> tmpr=<span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> hum=<span class="hljs-number">0</span>;<font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  delay(<span class="hljs-number">1000</span>); <span class="hljs-comment">// 1 c</span>
<span class="hljs-keyword">float</span> temperature;
<span class="hljs-keyword">float</span> humidity;<font></font>
. . . . .  <span class="hljs-comment">//   temperature  humidity  </span>
<span class="hljs-comment">//       4 :</span>
  tmpr = temperature*<span class="hljs-number">10</span>+<span class="hljs-number">2731</span>; <span class="hljs-comment">//2731 =     </span>
<span class="hljs-comment">//    4 :</span>
  hum = humidity*<span class="hljs-number">10</span>+<span class="hljs-number">1000</span>; 
<span class="hljs-comment">//  :</span>
  digitalWrite (ledPin,HIGH); <span class="hljs-comment">//  —  </span>
  String strMsg=<span class="hljs-string">"DAH"</span>; <span class="hljs-comment">// - </span>
  strMsg+=tmpr; <span class="hljs-comment">//  </span>
  strMsg+=hum; <span class="hljs-comment">// </span>
  strMsg.toCharArray(msg,<span class="hljs-number">12</span>); <span class="hljs-comment">//   , 12 –  </span>
<span class="hljs-comment">//  :</span>
  vw_send((<span class="hljs-keyword">uint8_t</span> *)msg, <span class="hljs-built_in">strlen</span>(msg)); <span class="hljs-comment">//  </span>
  vw_wait_tx(); <span class="hljs-comment">//   </span>
  delay(<span class="hljs-number">500</span>); <span class="hljs-comment">// 500 </span>
  digitalWrite (ledPin, LOW); <span class="hljs-comment">//  —  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie genauere Zahlen mit einer großen Anzahl von Ziffern übertragen müssen, erhöhen Sie einfach die Länge des msg-Arrays. Die globalen „flüchtigen“ Variablen tmpr und hum werden benötigt, wenn Sie mehrere Messwerte mitteln. Andernfalls können sie auch innerhalb der Funktion loop () als lokal deklariert werden. Wie Sie sehen, besteht die Nachricht aus konvertierten Temperatur- und Feuchtigkeitswerten in ASCII-Zeichenfolgen mit jeweils vier Bytes, denen eine Zeichenfolge mit drei DAH-Zeichen vorangestellt ist (Zeichen können beliebige Zeichen aus der ASCII-Tabelle sein). Dies ist eine Signatur, mit der Sie diese Nachricht von den möglichen anderen unterscheiden können, die von ähnlichen Geräten gesendet werden. Vernachlässigen Sie die Signatur nicht, auch wenn Sie der Meinung sind, dass andere Geräte in der Nähe dieses Bereichs nicht erwartet werden. Gleichzeitig dient sie als zusätzliche Garantie für die Integrität der empfangenen Daten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie auch, dass Sie beim Konvertieren einer Zeichenfolge in ein Array ein Zeichen mehr als die Gesamtlänge der Nachricht angeben müssen (3 + 4 + 4 = 11). Dies berücksichtigt das Nullzeichen, das die Zeichenfolge schließt. </font><font style="vertical-align: inherit;">Die Größe des msg [] -Arrays muss mit einem Rand angegeben werden und kann beliebig sein, in diesem Fall zwischen 13 und 27 Byte. </font><font style="vertical-align: inherit;">Bei der Übertragung wird immer noch genau so viel gesendet, wie die Funktion strlen (msg) zurückgibt, dh 11 Byte + ein Nullzeichen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im empfangenden Teil muss das resultierende Array von ASCII-Codes analysiert werden. </font><font style="vertical-align: inherit;">Aber zuerst müssen Sie es akzeptieren. </font><font style="vertical-align: inherit;">Um den Empfang zu initialisieren, werden die folgenden Aktionen ausgeführt:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span>
<span class="hljs-keyword">char</span> str[<span class="hljs-number">5</span>];     ASCII  
  <span class="hljs-keyword">uint8_t</span> buf [VW_MAX_MESSAGE_LEN];  <span class="hljs-comment">//    </span>
  <span class="hljs-keyword">uint8_t</span> buflen = VW_MAX_MESSAGE_LEN;  <span class="hljs-comment">// max   </span><font></font>
. . . . .<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_set_rx_pin(<span class="hljs-number">2</span>); <span class="hljs-comment">//D2   VirtualWire</span>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span><font></font>
. . . . .<font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich ist die Technik beim Parsen einer Linie folgende:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_rx_start();  <span class="hljs-comment">//  </span>
  buflen = VW_MAX_MESSAGE_LEN; <span class="hljs-comment">//    </span>
 <span class="hljs-keyword">if</span> (vw_have_message()) { <span class="hljs-comment">// </span>
 <span class="hljs-keyword">if</span> (vw_get_message(buf, &amp;buflen)) <span class="hljs-comment">//   </span><font></font>
  {<font></font>
    vw_rx_stop(); <span class="hljs-comment">//   :</span>
        <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; i++)  <span class="hljs-comment">//    </span>
                str[i]= buf[i]; <span class="hljs-comment">// </span>
                str[<span class="hljs-number">3</span>]=<span class="hljs-string">'\0'</span>;
      <span class="hljs-keyword">if</span> ((str[<span class="hljs-number">0</span>]==<span class="hljs-string">'D'</span>)&amp;&amp;(str[<span class="hljs-number">1</span>]==<span class="hljs-string">'A'</span>)&amp;&amp;(str[<span class="hljs-number">2</span>]==<span class="hljs-string">'H'</span>)) {
<span class="hljs-comment">// ,  </span>
       <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">3</span>;i&lt;<span class="hljs-number">7</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-3</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> tmpr=atoi(str); <span class="hljs-comment">//   </span>
      tmpr=tmpr<span class="hljs-number">-2731</span>; <span class="hljs-comment">// 2731,     </span>
. . . . .<span class="hljs-comment">//    10    float,  </span>
. . . . . <span class="hljs-comment">//    -</span>
<span class="hljs-comment">// :</span>
      <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">7</span>;i&lt;<span class="hljs-number">11</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-7</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> hh = atoi(str); <span class="hljs-comment">//   </span>
      hh=(hh<span class="hljs-number">-1000</span>)/<span class="hljs-number">10</span>;
      <span class="hljs-keyword">if</span> (hh&gt;<span class="hljs-number">99</span>) hh=<span class="hljs-number">99</span>; <span class="hljs-comment">//   %,  </span>
. . . . . <span class="hljs-comment">// -</span>
   } <span class="hljs-comment">//end   DAT</span>
  } <span class="hljs-comment">//end  </span>
 } <span class="hljs-comment">// </span>
} <span class="hljs-comment">// end loop</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, Sie haben jetzt weniger Fragen zur Verwendung dieser billigen und benutzerfreundlichen Geräte.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491518/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 501 (18.02.2020, 24.02.2020)</a></li>
<li><a href="../de491520/index.html">Konvertieren Sie xls in xlsx und xml in C #</a></li>
<li><a href="../de491522/index.html">Warum leben Frauen länger?</a></li>
<li><a href="../de491524/index.html">Stas Afanasyev. Juno. Pipelines basierend auf io.Reader / io.Writer. Teil 2</a></li>
<li><a href="../de491528/index.html">Meine Erfahrung ist die Durchführung von 1000 Interviews. Zusammenfassung des Berichts von Yegor Bugaenko</a></li>
<li><a href="../de491532/index.html">Laravel + Docker + Gitlab. Wo soll ich anfangen?</a></li>
<li><a href="../de491534/index.html">Eine kurze Anleitung zur Verwendung von GDB</a></li>
<li><a href="../de491536/index.html">YouTube - Fehler. Bitte versuchen Sie es später noch einmal. Wiedergabe-ID: <...></a></li>
<li><a href="../de491538/index.html">Sprawl Lemmas für reguläre und kontextfreie Sprachen</a></li>
<li><a href="../de491540/index.html">Netzwerke für einen unerfahrenen IT-Spezialisten. Obligatorische Basis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>