<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑 😡 🔈 OpenToonz: Innen und außen 📨 🚜 👩🏽‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fast vier Jahre sind vergangen, seit PVS-Studio den OpenToonz-Quellcode überprüft hat. Dieses Projekt ist ein sehr leistungsfähiges Werkzeug zum Erste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenToonz: Innen und außen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/494220/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dea/ccf/6dd/deaccf6dded129be42e3f458e2457c48.png" alt="image1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fast vier Jahre sind vergangen, seit PVS-Studio den OpenToonz-Quellcode überprüft hat. </font><font style="vertical-align: inherit;">Dieses Projekt ist ein sehr leistungsfähiges Werkzeug zum Erstellen zweidimensionaler Animationen. </font><font style="vertical-align: inherit;">Seit der letzten Überprüfung wurden mit seiner Hilfe animierte Werke wie Mary und die Hexenblume, Batman Ninja, Promare und andere geschaffen. </font><font style="vertical-align: inherit;">Da große Studios weiterhin Toonz verwenden, sollten Sie die Qualität des Quellcodes erneut überprüfen.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können sich mit der vorherigen Fehleranalyse im Artikel " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlechter Code eines Pakets zum Erstellen von 2D-Animationen von Toonz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">vertraut machen</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Im Allgemeinen scheint sich die Qualität des Codes nicht wesentlich verbessert zu haben, sodass der Gesamteindruck nicht besser ist. </font><font style="vertical-align: inherit;">Darüber hinaus wurden viele der gleichen Fehler wie im vorherigen Artikel gefunden. </font><font style="vertical-align: inherit;">Wir werden sie nicht noch einmal betrachten, da es viele Dinge zur Auswahl gibt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen jedoch verstehen, dass das Vorhandensein von Fehlern die aktive und produktive Verwendung des Softwareprodukts nicht unbedingt verhindert. Höchstwahrscheinlich leben die gefundenen Fehler in selten verwendeten oder vollständig nicht verwendeten Teilen des Codes, da sie sonst bei der Verwendung der Anwendung identifiziert und behoben worden wären. Dies bedeutet jedoch nicht, dass die statische Analyse redundant ist. Es ist nur so, dass die Bedeutung der statischen Analyse nicht darin besteht, nach alten und irrelevanten Fehlern zu suchen, sondern den Entwicklungsprozess zu verbilligen. Viele Fehler beim Schreiben von Code können sofort und nicht während des Betriebs der Software erkannt werden. Dementsprechend werden bei regelmäßiger Verwendung eines statischen Analysators Fehler frühzeitig korrigiert. Dies spart sowohl Entwicklern Zeit als auch Unternehmensgeld und verbessert die Wahrnehmung des Produkts durch die Benutzer. Stimmen Sie zu, es ist unangenehm, Entwickler ständig abzumelden.das eine oder andere funktioniert nicht.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N1 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V610 Undefiniertes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verhalten. </font><font style="vertical-align: inherit;">Überprüfen Sie den Schaltoperator '&lt;&lt;'. </font><font style="vertical-align: inherit;">Der linke Operand '(- 1)' ist negativ.</font></font><br>
<br>
<pre><code class="cpp hljs">decode_mcu_AC_refine (j_decompress_ptr cinfo, JBLOCKROW *MCU_data)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> p1, m1;<font></font>
  p1 = <span class="hljs-number">1</span> &lt;&lt; cinfo-&gt;Al;    <font></font>
  m1 = (<span class="hljs-number">-1</span>) &lt;&lt; cinfo-&gt;Al; <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist nicht klar, was der Code-Autor hier erreichen wollte. </font><font style="vertical-align: inherit;">Die Verwendung von Schichtoperatoren mit negativen Zahlen führt zu undefiniertem Verhalten. </font><font style="vertical-align: inherit;">Die Art und Weise, wie das Verhalten der Schichtoperatoren im Standard beschrieben wird, erscheint auf den ersten Blick etwas verwirrend, überprüfen Sie es jedoch dennoch: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Der Typ des Ergebnisses ist der des heraufgestuften linken Operanden. </font><font style="vertical-align: inherit;">Das Verhalten ist undefiniert, wenn der rechte Operand negativ ist oder größer oder gleich der Länge in Bits des heraufgestuften linken Operanden ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Der Wert von E1 &lt;&lt; E2 ist E1 linksverschobene E2-Bitpositionen; Leerzeichen werden mit Null gefüllt. Wenn E1 einen vorzeichenlosen Typ hat, ist der Wert des Ergebnisses E1 * 2 ^ E2, modulo um eins mehr als der im Ergebnistyp darstellbare Maximalwert. Andernfalls ist dies der resultierende Wert, wenn E1 einen vorzeichenbehafteten Typ und einen nicht negativen Wert hat und E1 * 2 ^ E2 im Ergebnistyp darstellbar ist. Andernfalls ist das Verhalten undefiniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Verhalten ist also nicht definiert, wenn der rechte oder linke Operand einen negativen Wert hat. Wenn der Operand vom Typ mit Vorzeichen und nicht negativem Wert ist und in den resultierenden Typ passt, ist das Verhalten normal. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N2 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Verwendung des Musters 'if (A) {...} else if (A) {...}' wurde erkannt. </font><font style="vertical-align: inherit;">Es besteht die Wahrscheinlichkeit, dass ein logischer Fehler vorliegt. </font><font style="vertical-align: inherit;">Überprüfen Sie die Zeilen: 156, 160. cameracapturelevelcontrol.cpp 156</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CameraCaptureLevelHistogram::mousePressEvent</span><span class="hljs-params">(QMouseEvent* event)</span> </span>{
  <span class="hljs-keyword">if</span> (event-&gt;button() != Qt::LeftButton) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (m_currentItem == Histogram) {<font></font>
    m_histogramCue = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == None) <span class="hljs-keyword">return</span>;<font></font>
  QPoint pos = event-&gt;pos();<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_black;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == GammaSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - gammaToHPos(m_gamma, m_black, m_white);<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_white;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == ThresholdSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_threshold;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier werden der Variablen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_offset</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> je nach Wert von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unterschiedliche Werte </font><i><font style="vertical-align: inherit;">zugewiesen</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Das Duplizieren der Prüfung in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlackSlider ist jedoch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sinnlos, und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anhand des</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zustands der Bedingung können Sie erkennen, dass die Variable </font><i><font style="vertical-align: inherit;">m_white</font></i><font style="vertical-align: inherit;"> an der Berechnung beteiligt ist </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Schauen wir uns die möglichen Werte für </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs">  LevelControlItem m_currentItem;<font></font>
<font></font>
  <span class="hljs-keyword">enum</span> LevelControlItem {<font></font>
    None = <span class="hljs-number">0</span>,<font></font>
    BlackSlider,<font></font>
    WhiteSlider,<font></font>
    GammaSlider,<font></font>
    ThresholdSlider,<font></font>
    Histogram,<font></font>
    NumItems<font></font>
  };</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/664/caa/09b/664caa09b6eca7a582ae4441c232e61e.png" alt="image3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass auch der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WhiteSlider-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wert </font><i><font style="vertical-align: inherit;">möglich ist</font></i><font style="vertical-align: inherit;"> , für den keine Überprüfung durchgeführt wird. </font><font style="vertical-align: inherit;">Daher ist es durchaus möglich, dass einige der Verhaltensszenarien aufgrund eines Fehlers beim Kopieren und Einfügen verloren gingen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N3 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Verwendung des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Musters</font></a><font style="vertical-align: inherit;"> 'if (A) {...} else if (A) {...}' wurde erkannt. </font><font style="vertical-align: inherit;">Es besteht die Wahrscheinlichkeit, dass ein logischer Fehler vorliegt. </font><font style="vertical-align: inherit;">Überprüfen Sie die Zeilen: 784, 867. tpalette.cpp 784</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPalette::loadData</span><span class="hljs-params">(TIStream &amp;is)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> tagName;
  <span class="hljs-keyword">while</span> (is.openChild(tagName)) {
    <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"version"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">if</span> (....){<font></font>
          ....<font></font>
        }<font></font>
        ....<font></font>
        is.closeChild();<font></font>
        }<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"refImgPath"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"animation"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">int</span> key = <span class="hljs-string">'0'</span>;
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">int</span> styleId = <span class="hljs-number">0</span>;<font></font>
        ....<font></font>
      }<font></font>
    } <font></font>
      ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer ähnlicher Fehler. </font><font style="vertical-align: inherit;">Hier haben dieselben Bedingungen unterschiedliche Körper, aber es ist </font><font style="vertical-align: inherit;">nicht mehr </font><font style="vertical-align: inherit;">möglich, auf die möglichen Optionen für den Wert </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tagName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu schließen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Höchstwahrscheinlich wurde nur eine Option übersehen, und am Ende haben wir Code, der niemals ausgeführt wird. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N4 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V547 Der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ausdruck 'chancount == 2' ist immer wahr. </font><font style="vertical-align: inherit;">psd.cpp 720</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPSDReader::readImageData</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> chancount)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">1</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) { <span class="hljs-comment">// &lt;= 1</span><font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">8</span> &amp;&amp; chancount &gt; <span class="hljs-number">1</span>) {<font></font>
    ....<font></font>
    <span class="hljs-keyword">for</span> (....) {
      <span class="hljs-keyword">if</span> (chancount &gt;= <span class="hljs-number">3</span>) {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">4</span>)  <font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (chancount &lt;= <span class="hljs-number">2</span>)  <span class="hljs-comment">// &lt;= 2</span><font></font>
      {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">2</span>) <span class="hljs-comment">// &lt;= 3</span><font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      }<font></font>
      ....<font></font>
    }<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_headerInfo.depth == <span class="hljs-number">8</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein kleiner logischer Fehler hat sich in diese Prüfungen eingeschlichen. </font><font style="vertical-align: inherit;">Im Test unter Nummer eins wird der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chancount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit 1 verglichen, und im Test unter Nummer 2 wird überprüft, ob diese Variable kleiner oder gleich 2 ist. Infolgedessen ist der einzig mögliche </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chancount-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wert </font><font style="vertical-align: inherit;">2 </font><font style="vertical-align: inherit;">für die Bedingung unter Nummer </font><font style="vertical-align: inherit;">3. Dieser Fehler führt möglicherweise nicht zu einer fehlerhaften Programmoperation. Dies erschwert jedoch das Lesen und Verstehen des Codes. </font><font style="vertical-align: inherit;">Zum Beispiel ist nicht klar, warum der else-Zweig dann ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen benötigt die in diesem Fragment betrachtete Funktion etwas mehr als 300 Codezeilen und besteht aus solchen Haufen von Bedingungen und Schleifen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/725/c28/39a/725c2839a5774ec76b0143ec64531fda.png" alt="image4.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N5 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V614</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nicht initialisierte Variable 'precSegmentIndex' verwendet. </font><font style="vertical-align: inherit;">Überprüfen Sie das fünfte tatsächliche Argument der Funktion 'insertBoxCorners'. </font><font style="vertical-align: inherit;">rasterselection.cpp 803</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">TStroke <span class="hljs-title">getIntersectedStroke</span><span class="hljs-params">(TStroke &amp;stroke, TRectD bbox)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> precSegmentIndex, currentSegmentIndex, startSegmentIndex,<font></font>
      precChunkIndex = <span class="hljs-number">-1</span>;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....) {<font></font>
    insertBoxCorners(bbox, points, outPoints, currentSegmentIndex,<font></font>
                     precSegmentIndex);<font></font>
    ....<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insertBoxCorners</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> currentSegmentIndex, <span class="hljs-keyword">int</span> precSegmentIndex)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> sameIndex = (precSegmentIndex == currentSegmentIndex);<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> segmentIndex = precSegmentIndex;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Möglicherweise wurde hier sogar während der Initialisierung der Variablen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precChunkIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ein Fehler gemacht </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der Entwickler könnte erwarten, dass die Initialisierung des letzten Elements -1 mit demselben Wert wie andere in derselben Zeile deklarierte Variablen initialisiert wird. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N6 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V590</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie den Ausdruck 's! = "" &amp;&amp; s == "color"'. </font><font style="vertical-align: inherit;">Der Ausdruck ist übertrieben oder enthält einen Druckfehler. </font><font style="vertical-align: inherit;">cleanupparameters.cpp 416</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CleanupParameters::loadData</span><span class="hljs-params">(TIStream &amp;is, <span class="hljs-keyword">bool</span> globalParams)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> s = is.getTagAttribute(<span class="hljs-string">"sharpness"</span>);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"lineProcessing"</span>)<font></font>
    ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s)) <font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s))<font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; s == <span class="hljs-string">"color"</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"despeckling"</span>) {<font></font>
    ....  <font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Fehler, auch eher ein Fehler, führt an sich nur zu einem unnötigen Vergleich. </font><font style="vertical-align: inherit;">Wenn wir jedoch den Code als Ganzes betrachten, wird klar, dass der zusätzliche Vergleich als Ergebnis des Kopierens und Einfügens aus den vorherigen Bedingungen aufgetreten ist.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bcc/077/857/bcc077857a8341d45e6fcf504129353c.png" alt="image5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solche Nudeln, die Dutzende oder mehr Codezeilen belegen, können durchaus andere logische Fehler enthalten, und ihre Suche mit dieser Formatierung kann zu Qualen führen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N7 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V772 Das</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufrufen eines Löschoperators für einen ungültigen Zeiger führt zu undefiniertem Verhalten. </font><font style="vertical-align: inherit;">pluginhost.cpp 1327</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die Analysatormeldung selbst bereits ziemlich vollständig: Das Aufrufen des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Löschoperators</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für einen Zeiger auf einen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ungültigen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Typ </font><font style="vertical-align: inherit;">führt zu undefiniertem Verhalten. </font><font style="vertical-align: inherit;">Wenn eine universelle Funktion zum Entfernen von Schnittstellen benötigt wurde, kann es sich lohnen, sie zu einer Boilerplate zu machen.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;class T&gt;
<span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(T *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N8 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist seltsam, dass der Operator 'sizeof ()' die Größe eines Zeigers auf eine Klasse auswertet, nicht jedoch die Größe des Klassenobjekts 'm_xshHandle'. </font><font style="vertical-align: inherit;">tstageobjectcmd.cpp 455</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DVAPI</span> <span class="hljs-title">TStageObjectParams</span> {</span><font></font>
  ....<font></font>
};<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemovePegbarNodeUndo</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> TUndo {<font></font>
  ....<font></font>
  TXsheetHandle *m_xshHandle;<font></font>
<font></font>
<span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(m_xshHandle);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehler, der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">häufig genug</font></a><font style="vertical-align: inherit;"> ist und sowohl durch Unaufmerksamkeit als auch durch Unwissenheit auftreten kann. </font><font style="vertical-align: inherit;">Hier, wahrscheinlich war es eine Frage der Unaufmerksamkeit, da im ersten Term </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wurde jedoch dereferenziert. </font><font style="vertical-align: inherit;">Wenn Sie die Größe eines Objekts benötigen, sollten Sie immer daran denken, dass der Zeiger eines Objekts dereferenziert werden muss. </font><font style="vertical-align: inherit;">Ansonsten erhalten wir nur die Größe des Zeigers selbst.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(*m_xshHandle);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N9 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist seltsam, dass der Operator 'sizeof ()' die Größe eines Zeigers auf eine Klasse auswertet, nicht jedoch die Größe des Klassenobjekts 'this'. </font><font style="vertical-align: inherit;">shaderfx.cpp 107</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RectF</span> {</span>
  GLfloat m_val[<span class="hljs-number">4</span>];<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>==(<span class="hljs-keyword">const</span> RectF &amp;rect) <span class="hljs-keyword">const</span> {
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);<font></font>
  }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und hier haben sie offensichtlich vergessen, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zeiger zu dereferenzieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Als Ergebnis erhalten wir nicht die Größe des Objekts, sondern die Größe des Zeigers. </font><font style="vertical-align: inherit;">Infolgedessen werden nur die ersten 4 oder 8 Bytes verglichen (abhängig von der Bittiefe). </font><font style="vertical-align: inherit;">Die richtige Version des Codes:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(*<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N10 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V554</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Falsche Verwendung von unique_ptr. </font><font style="vertical-align: inherit;">Der mit 'new []' zugewiesene Speicher wird mit 'delete' bereinigt. </font><font style="vertical-align: inherit;">screenavermaker.cpp 29</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeScreenSaver</span><span class="hljs-params">(TFilePath scrFn, TFilePath swfFn,
                     <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> screenSaverName)</span> </span>{
  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">stat</span> <span class="hljs-title">results</span>;</span><font></font>
....<font></font>
  <span class="hljs-keyword">int</span> swfSize = results.st_size;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;<span class="hljs-keyword">char</span>&gt; <span class="hljs-title">swf</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[swfSize])</span></span>;<font></font>
....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird oft vergessen, dass der Typ, mit dem unique_ptr instanziiert wird, davon abhängt, ob delete oder delete [] verwendet wird. Wenn Sie den Zeiger wie im betrachteten Fragment instanziieren, während Sie Speicher durch new [] zuweisen, kann dies zu undefiniertem Verhalten führen, da die Freigabe durch Löschen erfolgt. Um dies zu vermeiden, müssen Sie dem Zeigertyp eckige Klammern hinzufügen: std :: unique_ptr &lt;char []&gt;. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N11 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V521</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solche Ausdrücke mit dem Operator ',' sind gefährlich. Stellen Sie sicher, dass der Ausdruck 'm_to, m_from = it-&gt; first.getNumber ()' korrekt ist. flipbook.cpp 509</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadImagesPopup</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> FileBrowserPopup {<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> m_from, m_to, ....;<font></font>
  ....<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoadImagesPopup::onFilePathClicked</span><span class="hljs-params">(....)</span> </span>{<font></font>
  TLevel::Iterator it;<font></font>
  ....<font></font>
  it = level-&gt;begin();<font></font>
  m_to, m_from = it-&gt;first.getNumber();  <span class="hljs-comment">// &lt;=</span>
  <span class="hljs-keyword">for</span> (; it != level-&gt;end(); ++it) m_to = it-&gt;first.getNumber();<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (m_from == <span class="hljs-number">-2</span> &amp;&amp; m_to == <span class="hljs-number">-2</span>) m_from = m_to = <span class="hljs-number">1</span>;<font></font>
<font></font>
  m_minFrame = m_from;<font></font>
  m_maxFrame = m_to;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht hat der Programmierer erwartet, dass Sie mehreren Variablen einen Wert zuweisen können, indem Sie sie einfach mit einem Komma ausschreiben. Der Operator "," in C ++ funktioniert jedoch anders. Darin wird der erste Operand ausgeführt und das Ergebnis wird "zurückgesetzt", dann wird der zweite Operand berechnet. Und obwohl die Variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in einem nachfolgenden Zyklus initialisiert wird, ist es möglich, dass </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keinen Wert erhält </font><font style="vertical-align: inherit;">, wenn etwas schief geht oder jemand ungenau umgestaltet </font><font style="vertical-align: inherit;">. Und im Allgemeinen sieht dieser Code auf jeden Fall seltsam aus. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N12 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V532</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie die Anweisung des Musters '* pointer ++'. Vermutlich gemeint: '(* Zeiger) ++'. trop.cpp 140</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>, <span class="hljs-title">class</span> <span class="hljs-title">Q</span>&gt;
<span class="hljs-title">void</span> <span class="hljs-title">doGammaCorrect</span>(<span class="hljs-title">TRasterPT</span>&lt;T&gt; <span class="hljs-title">raster</span>, <span class="hljs-title">double</span> <span class="hljs-title">gamma</span>) {</span>
  <span class="hljs-function">Gamma_Lut&lt;Q&gt; <span class="hljs-title">lut</span><span class="hljs-params">(....)</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword">int</span> j;
  <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; raster-&gt;getLy(); j++) {<font></font>
    T *pix    = raster-&gt;pixels(j);<font></font>
    T *endPix = pix + raster-&gt;getLx();<font></font>
    <span class="hljs-keyword">while</span> (pix &lt; endPix) {<font></font>
      pix-&gt;r = lut.m_table[pix-&gt;r];<font></font>
      pix-&gt;b = lut.m_table[pix-&gt;b];<font></font>
      pix-&gt;g = lut.m_table[pix-&gt;g];<font></font>
      *pix++; <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein kleiner Fehler, der die Person, die den Code liest, weiter verwirren kann. Das Inkrement verschiebt wie beabsichtigt den Zeiger. Danach kommt es jedoch zu einer bedeutungslosen Dereferenzierung. Besser einfach </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pix ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> schreiben </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N13 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V773</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Funktion wurde beendet, ohne den Zeiger 'autoCloseUndo' loszulassen. Ein Speicherverlust ist möglich. vectortapetool.cpp 575</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">joinLineToLine</span><span class="hljs-params">(....)</span> </span>{<font></font>
  ....<font></font>
  UndoAutoclose *autoCloseUndo = <span class="hljs-number">0</span>;<font></font>
  ....<font></font>
  autoCloseUndo = <span class="hljs-keyword">new</span> UndoAutoclose(....);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (pos &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<font></font>
  ....<font></font>
  TUndoManager::manager()-&gt;add(autoCloseUndo);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab mehr als 20 solcher Warnungen. Oft wird irgendwo am Ende der Funktion der Speicher freigegeben, aber für eine frühere </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rückgabe wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dieser notwendige Schritt übersprungen. So ist es hier. Am Ende wird der Zeiger an </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TUndoManager :: manager () -&gt; add () übergeben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das das Löschen des Zeigers übernimmt. Es gibt jedoch eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rückgabe,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die Sie vergessen haben, diese Methode aufzurufen. Es lohnt sich also immer, sich Ihre Zeiger zu merken, wenn Sie die Funktion verlassen, und nicht nur irgendwo am Ende des Blocks oder vor der letzten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rückkehr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Löschvorgang einzugeben </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn jedoch für eine abgekürzte Version des Codes dieser Fehler offensichtlich erscheint, kann es in realem, komplizierterem Code schwierig sein, ein solches Problem aufzuspüren. Hier hilft der immer müde statische Analysator. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N14 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V522 Es kann zu einer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dereferenzierung der Nullzeiger-Region kommen. palettecmd.cpp 94</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isStyleUsed</span><span class="hljs-params">(<span class="hljs-keyword">const</span> TVectorImageP vi, <span class="hljs-keyword">int</span> styleId)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> regionCount = vi-&gt;getRegionCount();
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; regionCount; i++) {<font></font>
    TRegion *region = vi-&gt;getRegion(i);<font></font>
    <span class="hljs-keyword">if</span> (region || region-&gt;getStyle() != styleId) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier können wir davon ausgehen, dass der Entwickler die Regeln der Kurzschlussbewertung verwechselt hat und dachte, dass die </font><font style="vertical-align: inherit;">Dereferenzierung eines solchen Nullzeigers nicht stattfinden wird </font><font style="vertical-align: inherit;">, wenn die erste Überprüfung des Zeigers </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zurückgibt </font><font style="vertical-align: inherit;">. Für den Operator "||" es ist genau das Gegenteil. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragment N15 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist wahrscheinlich besser, der Variablen 'ca' einen Wert zuzuweisen, als ihn erneut zu deklarieren. Vorherige Deklaration: xshcellmover.cpp, Zeile 319. xshcellmover.cpp 323 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist wahrscheinlich besser, der Variablen 'cb' einen Wert zuzuweisen, als ihn erneut zu deklarieren. Vorherige Deklaration: xshcellmover.cpp, Zeile 320. xshcellmover.cpp 324xshcellmover.cpp 323</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">redo</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
  <span class="hljs-keyword">int</span> ca       = m_cellsMover.getStartPos().x;
  <span class="hljs-keyword">int</span> cb       = m_cellsMover.getPos().x;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (!m_cellsMover.getOrientation()-&gt;isVerticalTimeline()) {
    <span class="hljs-keyword">int</span> ca = m_cellsMover.getStartPos().y;
    <span class="hljs-keyword">int</span> cb = m_cellsMover.getPos().y;<font></font>
  }<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (ca != cb) {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht noch ein Copy-Paste, aber mit einer nicht ganz gewöhnlichen Essenz des Fehlers. Der Aufruf von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wurde durch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y ersetzt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber sie haben vergessen, den Typ der Variablen am Anfang der Zeile zu entfernen, aufgrund dessen eine lokale Neumeldung erfolgt. Infolgedessen werden anstelle einer Änderung der Positionsausrichtung für das anfängliche </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neue lokale </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb erstellt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit denen nichts weiter passiert. Externe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existieren jedoch weiterhin mit Werten für </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerung N1</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während ich den Artikel schrieb, wurde es für mich interessant, in diesem Programm zu stöbern und zu versuchen, etwas zu tun. </font><font style="vertical-align: inherit;">Vielleicht hatte ich Glück, aber das seltsame Verhalten ließ nicht lange auf sich warten: Hängen Sie auf, zeigen Sie meine Manipulation des Tablets nach dem Durchhängen und dem ungeraden Quadrat an, indem Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strg + Z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> drücken </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Leider konnte ich dieses Verhalten nicht wiederholen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/a67/350/35da67350bc54eb9cbada817d91a04c8.png" alt="image6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz dieses Verhaltens und der Gewohnheit, regelmäßig </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strg + S zu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> drücken, beeindruckt OpenToonz mit seiner Größe und Funktionalität. </font><font style="vertical-align: inherit;">Dennoch ist es nicht umsonst, dass auch große Studios es nutzen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und meine Kunst als Bonus:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e88/a95/8e3/e88a958e3dd8c85b3894de88f140b7e0.gif" alt="image7.gif"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerung N2</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Im Fall von OpenToonz ist es offensichtlich, dass der Versuch, alle vom Analysegerät erkannten Fehler auf einmal zu beheben, eine große Aufgabe ist, die den Entwicklungsprozess zum Stillstand bringt. </font><font style="vertical-align: inherit;">In solchen Fällen gibt es den Ansatz der „Massenunterdrückung“, bei dem technische Schulden in die Suppressorbasis des Analysators eingegeben werden und die weitere Arbeit mit dem Analysator auf der Grundlage neuer Antworten durchgeführt wird. </font><font style="vertical-align: inherit;">Wenn Zeit erscheint, können Sie die technischen Schulden klären. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Ich erinnere Sie daran, dass Entwickler von Open Source-Projekten die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kostenlose Lizenzierungsoption PVS-Studio verwenden können</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Wenn Sie diesen Artikel einem englischsprachigen Publikum zugänglich machen möchten, verwenden Sie bitte den Übersetzungslink: Victoria Khanieva. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">OpenToonz</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de494202/index.html">Rangfolge der Moskauer Bezirke nach Mietpreis mit Python</a></li>
<li><a href="../de494204/index.html">Notizblock mit Oszilloskop und Frequenzgenerator (Soundkarte)</a></li>
<li><a href="../de494206/index.html">Die biologischen Probleme von Bugfix</a></li>
<li><a href="../de494210/index.html">Installieren Sie Ubuntu auf Microsoft Surface Pro</a></li>
<li><a href="../de494214/index.html">Wie Coronavirus IT-Giganten hilft, die Welt zu erobern</a></li>
<li><a href="../de494222/index.html">Haben Sie aufgehört, in Quarantäne zu arbeiten?</a></li>
<li><a href="../de494224/index.html">Alle Wege führen zu Fullstack</a></li>
<li><a href="../de494226/index.html">Vereinbarte Position</a></li>
<li><a href="../de494228/index.html">3D-Druck bei der Erstellung der Boeing 777</a></li>
<li><a href="../de494230/index.html">AI vs. COVID-19: Hubei und Florida Erfahrung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>