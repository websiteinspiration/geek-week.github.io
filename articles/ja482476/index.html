<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â­•ï¸ ğŸ‘³ğŸ¿ ğŸ’‰ ActivityLifecycleCallbacks-ãƒ‘ãƒ–ãƒªãƒƒã‚¯APIã®ç›²ç‚¹ ğŸ“ ğŸ« ğŸ‘¨ğŸ¼â€ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å­ä¾›ã®é ƒã‹ã‚‰ã€èª¬æ˜æ›¸ã‚’èª­ã‚€ã®ãŒå¥½ãã§ã™ã€‚ç§ã¯å¤§äººã«ãªã‚Šã¾ã—ãŸãŒã€ãã‚Œã§ã‚‚å¤§äººãŒæŒ‡ç¤ºã«ä¸æ³¨æ„ã§ã‚ã‚‹ã“ã¨ã«ç§ã¯é©šã‹ã•ã‚Œã¾ã™ã€‚é›»å­ãƒ¬ãƒ³ã‚¸ã®æ¸©åº¦ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«ä½•äººã‚’ä½¿ç”¨ã—ã¾ã—ãŸã‹ï¼Ÿãã—ã¦ã€å½¼å¥³ã¯ã»ã¨ã‚“ã©å…¨å“¡ã«ã„ã¾ã™ã€‚
 
 Androidãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã•ã¾ã–ã¾ãªã‚¯ãƒ©ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚€ã“ã¨ã«ã—ãŸã®ã§ã™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ActivityLifecycleCallbacks-ãƒ‘ãƒ–ãƒªãƒƒã‚¯APIã®ç›²ç‚¹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/482476/"><img src="https://habrastorage.org/webt/h5/7s/op/h57sopubtnsjbnkfclj9sapsho4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å­ä¾›ã®é ƒã‹ã‚‰ã€èª¬æ˜æ›¸ã‚’èª­ã‚€ã®ãŒå¥½ãã§ã™ã€‚ç§ã¯å¤§äººã«ãªã‚Šã¾ã—ãŸãŒã€ãã‚Œã§ã‚‚å¤§äººãŒæŒ‡ç¤ºã«ä¸æ³¨æ„ã§ã‚ã‚‹ã“ã¨ã«ç§ã¯é©šã‹ã•ã‚Œã¾ã™ã€‚é›»å­ãƒ¬ãƒ³ã‚¸ã®æ¸©åº¦ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«ä½•äººã‚’ä½¿ç”¨ã—ã¾ã—ãŸã‹ï¼Ÿãã—ã¦ã€å½¼å¥³ã¯ã»ã¨ã‚“ã©å…¨å“¡ã«ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Androidãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã•ã¾ã–ã¾ãªã‚¯ãƒ©ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚€ã“ã¨ã«ã—ãŸã®ã§ã™ã€‚ç§ã¯ãƒ¡ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ï¼ˆViewã€Activityã€Fragmentã€Application </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã‚’å®Ÿè¡Œã—</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã—ãŸãŒã€</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Application.registerActivityLifecycleCallbacksï¼ˆï¼‰</font></a><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ã¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ActivityLifecycleCallbacks</font></a><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</font><font style="vertical-align: inherit;">ã«éå¸¸ã«èˆˆå‘³ã‚’æŒã£ã¦ã„ã¾ã—ãŸ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã§ã®ä½¿ç”¨ä¾‹ã®ã†ã¡ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ãƒ­ã‚°ã«è¨˜éŒ²ã™ã‚‹ã“ã¨ã»ã©å„ªã‚ŒãŸã‚‚ã®ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ãã‚Œã‹ã‚‰ç§ã¯è‡ªåˆ†ã§ãã‚Œã‚’å®Ÿé¨“ã—å§‹ã‚ã¾ã—ãŸã€ãã—ã¦ä»Šç§ãŸã¡ã¯Yandex.Moneyã§ç©æ¥µçš„ã«ãã‚Œã‚’ä½¿ç”¨ã—ã¦ã€å¤–éƒ¨ã‹ã‚‰ã®Activityã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å½±éŸ¿ã«é–¢é€£ã™ã‚‹ã•ã¾ã–ã¾ãªã‚¿ã‚¹ã‚¯ã‚’è§£æ±ºã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ActivityLifecycleCallbacksã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¦‹ã¦ãã ã•ã„ã€‚API14ã«ç™»å ´ã—ãŸã¨ãã®æ§˜å­ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ActivityLifecycleCallbacks</span> </span>{<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityCreated(Activity activity, Bundle savedInstanceState);<font></font>
&nbsp; &nbsp;&nbsp;void onActivityStarted(Activity activity);<font></font>
&nbsp;&nbsp; &nbsp;void onActivityResumed(Activity activity);<font></font>
&nbsp;&nbsp;&nbsp; void onActivityPaused(Activity activity);<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityStopped(Activity activity);<font></font>
&nbsp; &nbsp;&nbsp;void onActivitySaveInstanceState(Activity activity, Bundle outState);<font></font>
&nbsp;&nbsp; &nbsp;void onActivityDestroyed(Activity activity);<font></font>
}</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API 29ä»¥é™ã€ã„ãã¤ã‹ã®æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚</font></font></b><div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ActivityLifecycleCallbacks</span> </span>{
&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">default</span> void onActivityPreCreated(
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState) { }<font></font>
&nbsp;&nbsp;&nbsp; void onActivityCreated(<font></font>
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostCreated(
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPreStarted(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityStarted(<span class="hljs-meta">@NonNull</span> Activity activity);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostStarted(<span class="hljs-meta">@NonNull</span> Activity activity) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPreResumed(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityResumed(<span class="hljs-meta">@NonNull</span> Activity activity);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostResumed(<span class="hljs-meta">@NonNull</span> Activity activity) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPrePaused(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityPaused(<span class="hljs-meta">@NonNull</span> Activity activity);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostPaused(<span class="hljs-meta">@NonNull</span> Activity activity) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPreStopped(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityStopped(<span class="hljs-meta">@NonNull</span> Activity activity);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostStopped(<span class="hljs-meta">@NonNull</span> Activity activity) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPreSaveInstanceState(
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@NonNull</span> Bundle outState) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivitySaveInstanceState(<font></font>
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@NonNull</span> Bundle outState);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostSaveInstanceState(
        <span class="hljs-meta">@NonNull</span> Activity activity,
        <span class="hljs-meta">@NonNull</span> Bundle outState) { }
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPreDestroyed(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
 &nbsp;&nbsp;&nbsp;void onActivityDestroyed(<span class="hljs-meta">@NonNull</span> Activity activity);
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">default</span> void onActivityPostDestroyed(<span class="hljs-meta">@NonNull</span> Activity activity) { }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯Android 4.0 ICSã§ã®ã¿è¡¨ç¤ºã•ã‚ŒãŸãŸã‚ã€ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯ã»ã¨ã‚“ã©æ³¨æ„ãŒæ‰•ã‚ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã§éå¸¸ã«èˆˆå‘³æ·±ã„ã“ã¨ã‚’å®Ÿè¡Œã§ãã‚‹ãŸã‚ã€ç„¡é§„ã§ã™ã€‚ã™ã¹ã¦ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤–éƒ¨ã‹ã‚‰å½±éŸ¿ã‚’ä¸ãˆã¾ã™ã€‚ã—ã‹ã—ã€ãã®è©³ç´°ã«ã¤ã„ã¦ã¯å¾Œã§ã€æœ€åˆã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è©³ã—ãè¦‹ã¦ã„ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å„ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã®åŒæ§˜ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¡¨ç¤ºã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã§ãƒ¡ã‚½ãƒƒãƒ‰ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚ŒãŸã¨ãã«å‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒMainActivityã§å§‹ã¾ã‚‹å ´åˆã€æœ€åˆã«ActivityLifecycleCallback.onActivityCreatedï¼ˆMainActivityã€nullï¼‰å‘¼ã³å‡ºã—ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã°ã‚‰ã—ã„ã§ã™ãŒã€ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã‹ï¼Ÿã“ã“ã«ã¯é­”æ³•ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£è‡ªä½“ãŒã€ã©ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ã‚ã‚‹ã‹ã‚’å ±å‘Šã—ã¾ã™ã€‚ä»¥ä¸‹ã¯Activity.onCreateï¼ˆï¼‰ã®ã‚³ãƒ¼ãƒ‰ã®ä¸€éƒ¨ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs">    mFragments.restoreAllState(p, mLastNonConfigurationInstances != <span class="hljs-keyword">null</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? mLastNonConfigurationInstances.fragments : <span class="hljs-keyword">null</span>);<font></font>
}<font></font>
mFragments.dispatchCreate();<font></font>
getApplication().dispatchActivityCreated(<span class="hljs-keyword">this</span>, savedInstanceState);
<span class="hljs-keyword">if</span> (mVoiceInteractor != <span class="hljs-keyword">null</span>) {
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡è‡ªèº«ãŒBaseActivityã‚’å®Ÿè¡Œã—ãŸã‹ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">Androidã®åŒåƒšã ã‘ãŒç§ãŸã¡ã®ãŸã‚ã«ã“ã‚Œã‚’è¡Œã„ã€ã™ã¹ã¦ã®äººã«ä½¿ç”¨ã‚’ç¾©å‹™ä»˜ã‘ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ã“ã‚Œã¯ã¨ã¦ã‚‚è‰¯ã„ã§ã™ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API 29ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã»ã¼åŒã˜ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ãŒã€ãã‚Œã‚‰ã®äº‹å‰ã‚³ãƒ”ãƒ¼ã¨äº‹å¾Œã‚³ãƒ”ãƒ¼ã¯ã€ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‰å¾Œã«æ­£ç›´ã«å‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç¾åœ¨ã¯ActivityManagerã«ã‚ˆã£ã¦åˆ¶å¾¡ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ã“ã‚Œã¯ç§ã®æ¨æ¸¬ã«ã™ãã¾ã›ã‚“ã€‚ãªãœãªã‚‰ã€ã‚½ãƒ¼ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ã®ã«ååˆ†ãªã»ã©æ·±ãæ˜ã‚Šä¸‹ã’ãªã‹ã£ãŸã‹ã‚‰ã§ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ActivityLifecycleCallbacksã‚’æ©Ÿèƒ½ã•ã›ã‚‹æ–¹æ³•ã¯ï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨åŒæ§˜ã«ã€æœ€åˆã«ãã‚Œã‚‰ã‚’ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ActivityLifecycleCallbacksã‚’Application.onCreateï¼ˆï¼‰ã«ç™»éŒ²ã™ã‚‹ãŸã‚ã€ã™ã¹ã¦ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¨ãã‚Œã‚‰ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApplication</span> : <span class="hljs-type">Application</span></span>() {
 &nbsp;&nbsp;&nbsp;<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()<font></font>
        registerActivityLifecycleCallbacks(MyCallbacks())<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°‘ã—ä½™è«‡ã§ã™ãŒã€API 29ä»¥é™ã€ActivityLifecycleCallbacksã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å†…ã‹ã‚‰ç™»éŒ²ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯</font><font style="vertical-align: inherit;">ã€ã“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã§ã®ã¿æ©Ÿèƒ½</font><font style="vertical-align: inherit;">ã™ã‚‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ãªã‚Šã¾ã™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã§å…¨éƒ¨ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ActivityLifecycleCallbacksã¨ã„ã†åå‰ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã“ã‚Œã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ãƒ­ã‚°ã«è¨˜éŒ²ã™ã‚‹ä¾‹ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ãŒã€ãã‚Œã¯èˆˆå‘³æ·±ã„ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«ã¯å¤šãã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆç´„400ï¼‰ãŒã‚ã‚Šã€ã“ã‚Œã‚‰ã™ã¹ã¦ã‚’ä½¿ç”¨ã—ã¦å¤šãã®èˆˆå‘³æ·±ã„ä¾¿åˆ©ãªã“ã¨ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã§ä½•ãŒã§ãã¾ã™ã‹ï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã§ã€ä½•ãŒã®ãã¿ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã™ã¹ã¦ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ãƒ†ãƒ¼ãƒã‚’å‹•çš„ã«å¤‰æ›´ã—ãŸã„ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">setThemeï¼ˆï¼‰ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã§ã™ã€‚ã¤ã¾ã‚Šã€ActivityLifecycleCallbackã‹ã‚‰å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThemeCallback</span></span>(
    <span class="hljs-meta">@StyleRes</span> <span class="hljs-keyword">val</span> myTheme: <span class="hljs-built_in">Int</span><font></font>
) : ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>, 
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {<font></font>
        activity.setTheme(myTheme)<font></font>
    }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ãƒˆãƒªãƒƒã‚¯ã‚’è‡ªå®…ã§ã®ã¿ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ¥ç¶šã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€éƒ¨ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¯ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ãƒ†ãƒ¼ãƒã‚’å®‰å…¨ã«å¤‰æ›´ã§ãã‚‹ã¨åˆ¤æ–­ã§ãã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¾ãŸã¯ãã®ä»–ã®ç—‡çŠ¶ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ï¼ˆKotlinovsky =ï¼‰ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThemeCallback</span></span>(
    <span class="hljs-meta">@StyleRes</span> <span class="hljs-keyword">val</span> myTheme: <span class="hljs-built_in">Int</span><font></font>
) : ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {
        <span class="hljs-keyword">val</span> myPackage = <span class="hljs-string">"my.cool.application"</span><font></font>
        activity<font></font>
            .takeIf { it.javaClass.name.startsWith(myPackage) }<font></font>
            ?.setTheme(myTheme)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ä¾‹ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¾ãŸã¯AndroidManifestã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ThemeCallbackã‚’ç™»éŒ²ã™ã‚‹ã®ã‚’å¿˜ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ¥ã®èˆˆå‘³æ·±ã„ä¾‹ãŒå¿…è¦ã§ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»»æ„ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DialogCallback</span></span>(
    <span class="hljs-keyword">val</span> dialogFragment: DialogFragment<font></font>
) : Application.ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {
        <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">val</span> tag = dialogFragment.javaClass.name<font></font>
            (activity <span class="hljs-keyword">as</span>? AppCompatActivity)<font></font>
                ?.supportFragmentManager<font></font>
                ?.also { fragmentManager -&gt;<font></font>
                    <span class="hljs-keyword">if</span> (fragmentManager.findFragmentByTag(tag) == <span class="hljs-literal">null</span>) {<font></font>
                        dialogFragment.show(fragmentManager, tag)<font></font>
                    }<font></font>
                }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ãƒˆãƒªãƒƒã‚¯ã‚’è‡ªå®…ã§ã®ã¿ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚‚ã¡ã‚ã‚“ã€ã™ã¹ã¦ã®ç”»é¢ã«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ãªã„ã§ãã ã•ã„-ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç§ãŸã¡ã‚’æ°—ã«å…¥ã‚‰ã‚Œã¾ã›ã‚“ã€‚ãŸã ã—ã€ç‰¹å®šã®ç”»é¢ã§ã“ã®ã‚ˆã†ãªã‚‚ã®ã‚’è¡¨ç¤ºã™ã‚‹ã¨ä¾¿åˆ©ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€åˆ¥ã®ã‚±ãƒ¼ã‚¹ã‚’ç¤ºã—ã¾ã™ã€‚Activityã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã‹ã€‚ã—ã‹ã—ã€Activity.startActivityForResultï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã—ãŸå¾Œã€çµæœã‚’å¾…ã¤å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿç§ã¯1ã¤ã®ãƒ¬ã‚·ãƒ”ã‚’æŒã£ã¦ã„ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StartingActivityCallback</span> : <span class="hljs-type">Application.ActivityLifecycleCallbacks {</span></span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {
        <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {<font></font>
            (activity <span class="hljs-keyword">as</span>? AppCompatActivity)<font></font>
                ?.supportFragmentManager<font></font>
                ?.also { fragmentManager -&gt;<font></font>
                    <span class="hljs-keyword">val</span> startingFragment = findOrCreateFragment(fragmentManager)<font></font>
<font></font>
                    startingFragment.listener = { resultCode, <span class="hljs-keyword">data</span> -&gt;
                        <span class="hljs-comment">// handle response here</span><font></font>
                    }<font></font>
<font></font>
                    <span class="hljs-comment">// start Activity inside StartingFragment</span><font></font>
                }<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findOrCreateFragment</span><span class="hljs-params">(
        fragmentManager: <span class="hljs-type">FragmentManager</span>
    )</span></span>: StartingFragment {
        <span class="hljs-keyword">val</span> tag = StartingFragment::<span class="hljs-keyword">class</span>.java.name<font></font>
        return fragmentManager<font></font>
            .findFragmentByTag(tag) <span class="hljs-keyword">as</span> StartingFragment?<font></font>
                ?: StartingFragment().apply {<font></font>
                    fragmentManager<font></font>
                        .beginTransaction()<font></font>
                        .add(this, tag)<font></font>
                        .commit()<font></font>
                }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ä¾‹ã§ã¯ã€Fragmentã‚’å˜ã«ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒé–‹å§‹ã•ã‚Œã€çµæœãŒå–å¾—ã•ã‚Œã€å‡¦ç†ãŒå§”ä»»ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ³¨æ„ï¼šã“ã“ã§ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒAppCompatActivityã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç„¡é™ãƒ«ãƒ¼ãƒ—ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»–ã®æ¡ä»¶ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã‚’è¤‡é›‘ã«ã—ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ãã®ç¬é–“ã¾ã§ã€ç§ãŸã¡ã¯ã™ã§ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">è‡ªåˆ†ã§è¿½åŠ ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ç”»é¢ã‚’é–‹ãã“ã¨ã«é–¢ã™ã‚‹åˆ†æã‚’é€ä¿¡ã™ã‚‹ã¨ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">åŒæ™‚ã«ã€ç”»é¢ã«ã¯ç‹¬è‡ªã®åå‰ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ï¼Ÿ</font><font style="vertical-align: inherit;">ã¨ã¦ã‚‚ç°¡å˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">ç”»é¢åã‚’æŒ‡å®šã§ãã‚‹Screenã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Screen</span> </span>{
    <span class="hljs-keyword">val</span> screenName: String<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ç›®çš„ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«ãã‚Œã‚’å®Ÿè£…ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NamedActivity</span> : <span class="hljs-type">Activity</span></span>(), Screen {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> screenName: String&nbsp; = <span class="hljs-string">"First screen"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®å¾Œã€ãã®ã‚ˆã†ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ç”¨ã«ç‰¹åˆ¥ãªActivityLifecycleCallbacksã‚’è¨­å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnalyticsActivityCallback</span></span>(
    <span class="hljs-keyword">val</span> sendAnalytics: (String) -&gt; <span class="hljs-built_in">Unit</span><font></font>
) : Application.ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {
        <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {<font></font>
            (activity <span class="hljs-keyword">as</span>? Screen)?.screenName?.let(sendAnalytics)<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦‹ã‚‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ã€å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯åˆ†æã‚’é€ä¿¡ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¿®æ­£ã®ãŸã‚ã«ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã•ã‚‰ã«ã„ãã¤ã‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã©ã†ã—ã¾ã™ã‹ï¼Ÿ</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’æ‹¡å¼µã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ScreenWithParameters</span> : <span class="hljs-type">Screen {</span></span>
    <span class="hljs-keyword">val</span> parameters: Map&lt;String, String&gt;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿè£…ï¼š</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NamedActivity</span> : <span class="hljs-type">Activity</span></span>(), ScreenWithParameters {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> screenName: String = <span class="hljs-string">"First screen"</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> parameters: Map&lt;String, String&gt; = mapOf(<span class="hljs-string">"key"</span> to <span class="hljs-string">"value"</span>)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç™ºé€ã—ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnalyticsActivityCallback</span></span>(
    <span class="hljs-keyword">val</span> sendAnalytics: (String, Map&lt;String, String&gt;?) -&gt; <span class="hljs-built_in">Unit</span><font></font>
) : Application.ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {
        <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {<font></font>
            (activity <span class="hljs-keyword">as</span>? Screen)?.screenName?.let { name -&gt;<font></font>
                sendAnalytics(<font></font>
                    name,<font></font>
                    (activity <span class="hljs-keyword">as</span>? ScreenWithParameters)?.parameters<font></font>
                )<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ãã‚Œã¯ã¾ã ç°¡å˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã¯ã™ã¹ã¦ã€æœ¬å½“ã«èˆˆå‘³æ·±ã„ãƒˆãƒ”ãƒƒã‚¯ã§ã‚ã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ–ä¾å­˜æ€§æ³¨å…¥ã«ã‚ãªãŸã‚’å°ããŸã‚ã®ã‚‚ã®ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã¯ã„ã€ãƒ€ã‚¬ãƒ¼ã€ã‚³ã‚¤ãƒ³ã€ã‚®ã‚¹ã€ã‚³ãƒ‡ã‚¤ãƒ³ãªã©ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€å°ã•ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ãã‚Œã‚‰ã¯å†—é•·ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€ç§ã«ã¯è§£æ±ºç­–ãŒã‚ã‚Šã¾ã™...ã©ã‚Œã‚’æ¨æ¸¬ã—ã¾ã™ã‹ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoolToolImpl</span> </span>{
    <span class="hljs-keyword">val</span> extraInfo = <span class="hljs-string">"i am dependency"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤§äººã®ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã®ã‚ˆã†ã«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ãã‚Œã‚’é–‰ã˜ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CoolTool</span> </span>{
    <span class="hljs-keyword">val</span> extraInfo: String<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoolToolImpl</span> : <span class="hljs-type">CoolTool {</span></span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> extraInfo = <span class="hljs-string">"i am dependency"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ä»Šã€ActivityLifecycleCallbacksã®ã¡ã‚‡ã£ã¨ã—ãŸã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒã‚¸ãƒƒã‚¯ï¼šã“ã®ä¾å­˜é–¢ä¿‚ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆã—ã€å¿…è¦ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ¼ã«å®Ÿè£…ã—ã€ActivityLifecycleCallbacksã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚’è¦‹ã¤ã‘ã¦CoolToolImplå®Ÿè£…ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">RequireCoolTool</span> </span>{
    <span class="hljs-keyword">var</span> coolTool: CoolTool<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoolToolActivity</span> : <span class="hljs-type">Activity</span></span>(), RequireCoolTool {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> coolTool: CoolTool<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InjectingLifecycleCallbacks</span> : <span class="hljs-type">ActivityLifecycleCallbacks {</span></span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {<font></font>
        (activity <span class="hljs-keyword">as</span>? RequireCoolTool)?.coolTool = CoolToolImpl()<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
InjectingLifecycleCallbacksã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ç™»éŒ²ã—ã€ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ï¼š</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DIActivityTest</span> </span>{
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> `should access extraInfo <span class="hljs-keyword">when</span> created`<span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// prepare</span>
        <span class="hljs-keyword">val</span> mockTool: CoolTool = mock()
        <span class="hljs-keyword">val</span> application = getApplicationContext&lt;android.app.Application&gt;()<font></font>
        application.registerActivityLifecycleCallbacks(<font></font>
            <span class="hljs-keyword">object</span> : Application.ActivityLifecycleCallbacks {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
                    activity: <span class="hljs-type">Activity</span>,
                    savedInstanceState: <span class="hljs-type">Bundle</span>?
                )</span></span> {<font></font>
                    (activity <span class="hljs-keyword">as</span>? RequireCoolTool)?.coolTool = mockTool<font></font>
                }<font></font>
            })<font></font>
<font></font>
        <span class="hljs-comment">// invoke</span>
        launch&lt;DIActivity&gt;(Intent(application, DIActivity::<span class="hljs-keyword">class</span>.java))<font></font>
<font></font>
        // assert<font></font>
        verify(mockTool).extraInfo<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€å¤§è¦æ¨¡ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯é©åˆ‡ã«æ‹¡å¼µã•ã‚Œãªã„ãŸã‚ã€DIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’èª°ã‹ã‚‰ã‚‚å¥ªã†ã“ã¨ã¯ã—ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">å–ã‚Šçµ„ã¿ã‚’çµ„ã¿åˆã‚ã›ã¦ã‚·ãƒŠã‚¸ãƒ¼ã‚’é”æˆã™ã‚‹æ–¹ãŒè‰¯ã„å ´åˆã€‚</font><font style="vertical-align: inherit;">Dagger2ã®ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«AndroidInjection.injectï¼ˆã“ã‚Œï¼‰ãªã©ã®åŸºæœ¬çš„ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒã‚ã‚‹å ´åˆã¯ã€ãã‚Œã‚’ç ´æ£„ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»£ã‚ã‚Šã«ã€ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚&nbsp;</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æŒ‡ç¤ºã«å¾“ã£ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«DispatchingAndroidInjectorã‚’å®Ÿè£…ã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å„ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã§DispatchingAndroidInjector.maybeInjectï¼ˆï¼‰ã‚’å‘¼ã³å‡ºã™ActivityLifecycleCallbacksã‚’ä½œæˆã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ActivityLifecycleCallbacksã‚’ç™»éŒ²ã—ã¾ã™ã€‚</font></font></li>
</ol><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApplication</span> : <span class="hljs-type">Application</span></span>() {
    <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> dispatchingAndroidInjector: DispatchingAndroidInjector&lt;Any&gt;<font></font>
<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()<font></font>
        DaggerYourApplicationComponent.create().inject(<span class="hljs-keyword">this</span>);<font></font>
        registerActivityLifecycleCallbacks(<font></font>
            InjectingLifecycleCallbacks(<font></font>
                dispatchingAndroidInjector<font></font>
            )<font></font>
        )<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InjectingLifecycleCallbacks</span></span>(
    <span class="hljs-keyword">val</span> dispatchingAndroidInjector: DispatchingAndroidInjector&lt;Any&gt;<font></font>
) : ActivityLifecycleCallbacks {<font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActivityCreated</span><span class="hljs-params">(
        activity: <span class="hljs-type">Activity</span>,
        savedInstanceState: <span class="hljs-type">Bundle</span>?
    )</span></span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispatchingAndroidInjector.maybeInject(activity)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ä»–ã®DIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚‚åŒã˜åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä½•ãŒèµ·ã“ã£ãŸã®ã‹ã‚³ãƒ¡ãƒ³ãƒˆã«æ›¸ãè¾¼ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ç´„ã™ã‚‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ActivityLifecycleCallbacksã¯ã€éå°è©•ä¾¡ã•ã‚Œã¦ã„ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®ä¾‹ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1ã¤ã‚’è©¦ã—ã¦</font><font style="vertical-align: inherit;">ã€Yandex.MoneyãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ”¹å–„ã«å½¹ç«‹ã¤ã®ã¨åŒã˜ã‚ˆã†ã«ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ãã‚Œã‚‰ã‚’æ”¯æ´ã—ã¦ãã ã•ã„ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482466/index.html">Vue 3.0ã«å‚™ãˆã‚‹ãŸã‚ã«ã§ãã‚‹5ã¤ã®ã“ã¨</a></li>
<li><a href="../ja482468/index.html">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…ã®ç”Ÿæ´»ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹VS Codeã®5ã¤ã®æ‹¡å¼µæ©Ÿèƒ½ã¨ãƒ†ãƒ¼ãƒ</a></li>
<li><a href="../ja482470/index.html">æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§å®‰ä¾¡ãªé›»è©±ã§ã®ãƒšãƒ¼ã‚¸ã®é«˜é€Ÿèª­ã¿è¾¼ã¿</a></li>
<li><a href="../ja482472/index.html">JavaScriptã¯ä½•ã§ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja482474/index.html">ã€Œå¤ã®éã”ã—æ–¹ã€</a></li>
<li><a href="../ja482478/index.html">Iteraptorï¼šãƒ‡ã‚£ãƒ¼ãƒ—ãƒˆãƒ©ãƒ³ã‚¹ãƒšã‚¢ãƒ¬ãƒ³ãƒˆãƒãƒƒãƒ—ã®ãƒ¬ãƒ‡ãƒ¥ã‚¹ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
<li><a href="../ja482480/index.html">æ¥å¹´ã®å®‡å®™ã®ã‚¿ãƒƒãƒ</a></li>
<li><a href="../ja482482/index.html">ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ³ã‚°ã‚²ãƒ¼ãƒ </a></li>
<li><a href="../ja482484/index.html">åˆ¶ç´„ç†è«–ã‚’ä½¿ç”¨ã—ã¦é–‹ç™ºåŠ¹ç‡ã‚’ä¸Šã’ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja482490/index.html">MISRAã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>