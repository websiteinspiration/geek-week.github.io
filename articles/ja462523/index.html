<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍⚖️ 🏆 🧔🏾 LinOTP 2要素認証サーバー 🤰🏾 👨🏽‍⚖️ 🐡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日、企業のネットワーク、サイト、サービス、sshを保護するために2要素認証サーバーを構成する方法を共有したいと思います。サーバーは一群を実行します：LinOTP + FreeRadius。
 
 なぜそれが必要なのですか？
 これは、サードパーティのプロバイダーとは関係なく、ネットワーク内で完全に...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>LinOTP 2要素認証サーバー</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462523/"><img src="https://habrastorage.org/webt/kj/44/5r/kj445ra0isuup3lhrfhn9tc5qre.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日、企業のネットワーク、サイト、サービス、sshを保護するために2要素認証サーバーを構成する方法を共有したいと思います。サーバーは一群を実行します：LinOTP + FreeRadius。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜそれが必要なのですか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、サードパーティのプロバイダーとは関係なく、ネットワーク内で完全に無料で便利なソリューションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサービスは、他のオープンソース製品とは異なり、非常に便利で視覚的に優れており、膨大な数の機能とポリシー（たとえば、ログイン+パスワード+（PIN + OTPToken））もサポートしています。 APIを介して、SMS送信サービス（LinOTP構成-&gt;プロバイダー構成-&gt; SMSプロバイダー）と統合し、Google Autentificatorなどのモバイルアプリケーション用のコードを生成します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考えたサービスより便利だと思います</font><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサーバーは、Cisco ASA、OpenVPNサーバー、Apache2、および実際には、RADIUSサーバーを介した認証をサポートするほとんどすべてのもの（たとえば、データセンター内のSSH）で正常に動作します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なもの：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1）Debian 8（jessie）- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必須！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（debian 9への試用インストールについては、記事の最後で説明しています）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はじめに：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debian 8のインストール。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LinOTPリポジトリを追加します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># echo 'deb http://www.linotp.org/apt/debian jessie linotp' &gt; /etc/apt/sources.list.d/linotp.list</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーを追加：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># gpg --search-keys 913DFF12F86258E5</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時々「クリーン」インストールで、このコマンドを実行した後、Debianは以下を発行します： </font></font><br>
<br>
<pre><code class="plaintext hljs">gpg:   `/root/.gnupg'<font></font>
gpg:     `/root/.gnupg/gpg.conf'<font></font>
gpg: :   `/root/.gnupg/gpg.conf'      <font></font>
gpg:    `/root/.gnupg/secring.gpg'<font></font>
gpg:    `/root/.gnupg/pubring.gpg'<font></font>
gpg:     ( --keyserver)<font></font>
gpg:      :  URI<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはgnupgの初期設定です。</font><font style="vertical-align: inherit;">何も間違ってない。</font><font style="vertical-align: inherit;">もう一度コマンドを実行してください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debianaの質問：</font></font><br>
<br>
<pre><code class="plaintext hljs">gpg:  "913DFF12F86258E5"  hkp  keys.gnupg.net<font></font>
(1)	LSE LinOTP2 Packaging &lt;linotp2@lsexperts.de&gt;<font></font>
	  2048 bit RSA key F86258E5, : 2010-05-10<font></font>
Keys 1-1 of 1 for "913DFF12F86258E5".   , N)   Q) &gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは答えます：1 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># gpg --export 913DFF12F86258E5 | apt-key add -</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get update</span></code></pre><cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysqlをインストールします。</font><font style="vertical-align: inherit;">理論的には、別のSQLサーバーを使用することもできますが、簡単にするために、LinOTPで推奨されているように使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（LinOTPデータベースの再構成を含む追加情報は、公式ドキュメントの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクにあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。同じ場所に、dpkg-reconfigure linotpコマンドを見つけて、すでにmysqlをインストールしている場合は設定を変更できます）。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get install mysql-server</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get update</span></code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（更新を再度確認しても害はありません）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LinOTPとアドオンモジュールをインストールします。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get install linotp</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストーラーの質問に回答</font><font style="vertical-align: inherit;">
します。Apache2を</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用：はい</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理者用のパスワードを作成Linotp：「YourPassword」</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自己署名証明書を生成？：はい</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQLを使用？：はい</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースの場所：localhost </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーにLinOTPデータベース（データベース名）を</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成</font><font style="vertical-align: inherit;">：LinOTP2 </font><font style="vertical-align: inherit;">の別のユーザーを作成データベース：LinOTP2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーにパスワード</font><font style="vertical-align: inherit;">を設定し</font><font style="vertical-align: inherit;">ます： "YourPassword" </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースを今すぐ作成しますか？</font><font style="vertical-align: inherit;">（「Are you sure you want ...」など）：はい</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストール時に作成したMySQLルートパスワードを入力します：「YourPassword」</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（オプション、設定できません）</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get install linotp-adminclient-cli </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（オプション、設定できません）</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get install libpam-linotp  </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、Linotp Webインターフェースは次の場所で入手できます。 </font></font><br>
<br>
<pre><code class="plaintext hljs">"&lt;b&gt;https&lt;/b&gt;: //IP_/manage"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウェブインターフェースの設定については、少し後で説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、最も重要なこと！</font><font style="vertical-align: inherit;">FreeRadiusを上げてLinotpにリンクします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FreeRadiusとLinOTPモジュールをインストールする</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt-get install freeradius linotp-freeradius-perl</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックアップクライアントとユーザーの半径の構成。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># mv /etc/freeradius/clients.conf  /etc/freeradius/clients.old</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># mv /etc/freeradius/users  /etc/freeradius/users.old</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空のクライアントファイルを作成します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># touch /etc/freeradius/clients.conf</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい構成ファイルを編集します（例としてバックアップ構成を使用できます）</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/freeradius/clients.conf</span></code></pre><br>
<pre><code class="plaintext hljs">client 192.168.188.0/24 {<font></font>
secret  = passwd #    <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、usersファイルを作成します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># touch /etc/freeradius/users</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルを編集して、認証にperlを使用することを半径に伝えます。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/freeradius/users</span></code></pre><br>
<pre><code class="plaintext hljs">DEFAULT Auth-type := perl</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ファイル/ etc / freeradius / modules / perlを編集します</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/freeradius/modules/perl</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールパラメータにperl linotpスクリプトへのパスを書き込む必要があります。 </font></font><br>
<br>
<pre><code class="plaintext hljs">Perl { .......<font></font>
.........<font></font>
&lt;source lang="bash"&gt;module = /usr/lib/linotp/radius_linotp.pm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
..... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、どのドメイン（データベース、ファイル）からデータを取得するかを示すファイルを作成します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># touch /etc/linotp2/rlm_perl.ini</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/linotp2/rlm_perl.ini</span></code></pre><br>
<pre><code class="plaintext hljs">URL=https://IP__LinOTP_(192.168.X.X)/validate/simplecheck<font></font>
REALM=webusers1c<font></font>
RESCONF=LocalUser<font></font>
Debug=True<font></font>
SSL_CHECK=False</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、重要であるため、もう少し停止</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
します。コメント付きのファイルの完全な説明：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃LinotpサーバーのIP（LinOTPサーバーのIPアドレス）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
URL = https：//172.17.14.103/validate/simplecheck＃Web </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上に作成する私たちの領域LinOTPインターフェース。）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
REALM =リアーム1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃LinOTP Webモードで作成されたユーザーグループの名前。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RESCONF = flat_file </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#optional：すべて</font><font style="vertical-align: inherit;">正常に</font><font style="vertical-align: inherit;">機能しているようであればコメントアウト</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debug = True </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#optional：自己署名証明書がある場合はこれを使用し、そうでない場合はコメント化します（証明書を作成して検証する場合はSSL）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSL_CHECK = False </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次にファイルを作成します/ etc / freeradius / sites-available / linotp</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># touch /etc/freeradius/sites-available/linotp</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># nano /etc/freeradius/sites-available/linotp</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして設定をそれにコピーします（不適切な編集は何もしません）：</font></font><br>
<br>
<pre><code class="plaintext hljs">authorize {<font></font>
#normalizes maleformed client request before handed on to other modules (see '/etc/freeradius/modules/preprocess')<font></font>
preprocess<font></font>
#  If you are using multiple kinds of realms, you probably<font></font>
#  want to set "ignore_null = yes" for all of them.<font></font>
#  Otherwise, when the first style of realm doesn't match,<font></font>
#  the other styles won't be checked.<font></font>
#allows a list of realm (see '/etc/freeradius/modules/realm')<font></font>
IPASS<font></font>
#understands something like USER@REALM and can tell the components apart (see '/etc/freeradius/modules/realm')<font></font>
suffix<font></font>
#understands USER\REALM and can tell the components apart (see '/etc/freeradius/modules/realm')<font></font>
ntdomain<font></font>
#  Read the 'users' file to learn about special configuration which should be applied for<font></font>
# certain users (see '/etc/freeradius/modules/files')<font></font>
files<font></font>
# allows to let authentification to expire (see '/etc/freeradius/modules/expiration')<font></font>
expiration<font></font>
# allows to define valid service-times (see '/etc/freeradius/modules/logintime')<font></font>
logintime<font></font>
# We got no radius_shortname_map!<font></font>
pap<font></font>
}<font></font>
#here the linotp perl module is called for further processing<font></font>
authenticate {<font></font>
perl<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、simリンクを作成します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># ln -s ../sites-available/linotp /etc/freeradius/sites-enabled</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
個人的には、デフォルトのRADIUSサイトを強制終了していますが、必要な場合は、構成を編集するか、無効にすることができます。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># rm /etc/freeradius/sites-enabled/default</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># rm /etc/freeradius/sites-enabled/inner-tunnel</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># service freeradius reload</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Webフェイスに戻って詳細を検討し</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。右上隅で、LinOTP Config-&gt; UserIdResolvers-&gt; Newをクリックします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なものを選択します：LDAP（AD win、LDAP samba）、SQL、またはローカルFlatfileユーザー。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必須フィールドに入力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、REALMSを作成します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
右上隅で、LinOTP Config-&gt; Realms-&gt; Newをクリックします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
REALMSに名前を付け、前に作成したUserIdResolversをクリックします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このすべてのデータは、上記で書いた/etc/linotp2/rlm_perl.iniファイル内のfreeRadiusによって必要とされるため、編集していない場合は、ここで実行してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのサーバーが構成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debian 9でのLinOTPのセットアップ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ユーザーに感謝</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プリホドコフ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃LinOTPリポジトリを/etc/apt/sources.list.d/linotp.listに追加して、担当者を更新します</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">。echo</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
“ deb </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linotp.org/apt/debian</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stretch linotp”&gt; /etc/apt/sources.list.d/linotp .list </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-get update </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-get install dirmngr </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-key adv --recv-keys 913DFF12F86258E5 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃基本的にmysqlサーバーをインストールして構成します：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-get install mysql-server </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃linotpとfreeradiusをインストールします</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-get install linotp linotp-adminclientパッケージ-cli python-ldap freeradius python-passlib python-bcrypt git libio-all-lwp-perl libconfig-file-perl libtry-tiny-perl </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃設定ファイルへのシンボリックリンクを作成するfreeradius </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ln -s /etc/freeradius/3.0/sites-available / etc / freeradius / sites-available</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ln -s /etc/freeradius/3.0/sites-enabled / etc / freeradius / sites-enabled </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ln -s /etc/freeradius/3.0/clients.conf /etc/freeradius/clients.conf </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ln -s / etc / freeradius / 3.0 / users / etc / freeradius / users </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃linotp-auth-freeradius-perl </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
git clone </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/LinOTP/linotp-auth-freeradius-perl</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
cd linotp-auth-freeradius-perl / </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cp radius_linotp.pm / usr / moduleをインストールしますshare / linotp / radius_linotp.pm </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃linotpのfreeradius設定ファイルを</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cat / etc / freeradius / sites-enabled / linotp </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
server linotp { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
listen { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ipaddr = * </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
port = 1812 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
type = auth </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
listen { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ipaddr = * </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
port = 1813 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイプ=アカウント</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
authorize { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
preprocess </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
update { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＆control：Auth-Type：= Perl </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
authenticate { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auth-Type Perl { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
perl </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
accounting { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unix </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃sites-enabled for freeradiusのみ、linotp </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ls / etc / freeradius / sites-enabledのままにします</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
linotp </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃freeradius </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cat /etc/freeradius/clients.conf </font><font style="vertical-align: inherit;">への接続を許可するホストを追加します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
client host1 { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ipaddr = IP_1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 netmask = 32 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 secret = 'SECRET_1' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
client host2 { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ipaddr = IP_2 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 netmask = 32 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 secret = 'SECRET_2' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃ユーザーベースとして、perlコネクタ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cat / etc / freeradius / users </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DEFAULT Auth-type：= perl </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cat /etc/freeradius/3.0/mods-available/perl </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
perl { </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 filename = /usr/share/linotp/radius_linotp.pmを使用します</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 func_authenticate = authenticate </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 func_authorize = authorize </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃mods-enabledディレクトリで、perlモジュールのmods-availableディレクトリからシンボリックリンクを作成し、eap </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ln -s /etc/freeradius/3.0/mods-available/perl /etc/freeradius/3.0/mods- </font><font style="vertical-align: inherit;">を削除します</font><font style="vertical-align: inherit;">enabled / perl </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rm /etc/freeradius/3.0/mods-enabled/eap＃監査キーを</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成してlinotpを実行します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
linotp-create-auditkeys -f linotp.ini </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃コネクタ設定を作成して、半径に到達するUDをチェックします</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cat /etc/linotp2/rlm_perl.ini </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
URL = https：// IP_LINOTP_SRV / validate / simplecheck </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
REALM = realm </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RESCONF = LocalUser </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debug = True </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSL_CHECK = False </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2要素認証で保護する必要が最も多いシステムを設定するためのリンクをいくつか残します：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
設定</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache2での</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2要素認証</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ASAでの構成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（別のトークン生成サーバーが使用されていますが、ASA自体の設定は同じです）。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2要素認証を使用したVPN </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">sshでの2 </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">要素認証の</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
構成</font><font style="vertical-align: inherit;">（LinOTPもそこで使用されます）-著者に感謝します。また、LiOTPポリシーの設定に関する興味深い点も見つけることができます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、多くのサイトのcmsは、2要素認証をサポートしています（Wordpressの場合、LinOTPは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">githubに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自の特別なモジュールさえあります</font><font style="vertical-align: inherit;">）。たとえば、企業のWebサイトで会社の従業員用の安全なセクションを</font><font style="vertical-align: inherit;">作成する</font><font style="vertical-align: inherit;">場合などです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要な事実！</font><font style="vertical-align: inherit;">Google認証システムを使用する場合は、[Google認証システム]チェックボックスをオンにしないでください。</font><font style="vertical-align: inherit;">その場合、QRコードは読み取れません...（奇妙な事実）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事を書くために、以下の記事からの情報が使用されました：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itnan.ru/post.php?c=1&amp;p=270571 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.digitalbears.net/?p=469</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
著者に感謝します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462509/index.html">Product Fest-行きたいIT製品管理会議</a></li>
<li><a href="../ja462511/index.html">Google Play Instant。生涯のリファクタリング</a></li>
<li><a href="../ja462513/index.html">移転：領域の準備、選択、開発</a></li>
<li><a href="../ja462515/index.html">システムキーボードを操作するときのバグ</a></li>
<li><a href="../ja462519/index.html">本「マイクロサービス。開発とリファクタリングのパターン»</a></li>
<li><a href="../ja462525/index.html">3CXは、エンドツーエンドの音声暗号化を備えたiOSおよびAndroid用の新しいSIPソフトフォンを発売</a></li>
<li><a href="../ja462527/index.html">SincNetニューラルネットワークがバックプロパゲーションを介してサウンドに重要な周波数を割り当てる方法</a></li>
<li><a href="../ja462529/index.html">NASAのルナステーションのアイデアは良くない</a></li>
<li><a href="../ja462533/index.html">IntelliJ IDEA 2019.2：Java 13プレビューのサポート、プロファイリングツール、新しいサービスウィンドウなど</a></li>
<li><a href="../ja462537/index.html">クラウド移行</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>