<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏾 🍘 🧟 最高のSQL中難易度面接質問 👩🏿‍🤝‍👩🏽 🐴 ✊🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SQLコースの最初の70％は非常に簡単なようです。残りの30％で問題が発生します。
 
 2015年から2019年にかけて、12社以上の企業のデータアナリストとデータ分析スペシャリストのポジションについて4つの面接を行いました。 2017年に別の面接に失敗した後-複雑なSQLの質問について混乱した-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最高のSQL中難易度面接質問</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dcmiran/blog/500360/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLコースの最初の70％は非常に簡単なようです。残りの30％で問題が発生します。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2015年から2019年にかけて、12社以上の企業のデータアナリストとデータ分析スペシャリストのポジションについて4つの面接を行いました。 2017年に別の面接に失敗した後-複雑なSQLの質問について混乱した-面接の準備をよりよくするために、中程度および高度の複雑さのSQLの質問でタスクブックを編集し始めました。このガイドは、2019年の最後の面接で役立ちます。昨年、私はこのガイドを数人の友人と共有し、パンデミックによる余暇のおかげで、私はそれを洗練してこのドキュメントを編集しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初心者向けのすばらしいSQLチュートリアルがたくさんあります。私のお気に入りは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zi Chung Kaoによる</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">CodecademyのインタラクティブSQL</font></a><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select Star SQL </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">コース</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし実際には、SQLコースの最初の70％は非常に単純であり、本当の困難は残りの30％から始まります。これは初心者向けガイドでは説明されていません。</font><font style="vertical-align: inherit;">したがって、テクノロジー企業のデータアナリストやデータ分析スペシャリストへのインタビューでは、この30％について質問することがよくあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
驚いたことに、中程度の難易度のこのような問題について網羅的な情報源が見つからなかったため、このガイドをまとめました。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
面接には役立ちますが、同時に、現在および将来の仕事での効果が高まります。</font><font style="vertical-align: inherit;">個人的には、上記のSQLテンプレートの一部は、レポートツールとデータ分析機能を実行して傾向を特定するETLシステムにも役立つと思います。</font></font><br>
<br>
<blockquote><h1><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></a></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">        SQL</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 2.   </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 3.     ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 2</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 3</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 4.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 5.  </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 6.   </a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 1.     </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 2.        ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 2</a></li>
</ul></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">     </a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 1. </a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 2.   ( )</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 1</a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 2</a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">№ 3.  </a></li>
</ul></li>
</ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データアナリストやデータアナリストへのインタビュー中に、SQLだけでなく質問もすることを理解する必要があります。その他の一般的なトピックには、過去のプロジェクトの議論、A / Bテスト、メトリック開発、未解決の分析問題などがあります。約3年前、Quora </font><font style="vertical-align: inherit;">はFacebookの製品アナリストのポジションに対するインタビューの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヒント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">投稿</font><font style="vertical-align: inherit;">しました。そこで、このトピックはより詳細に議論されます。ただし、SQLの知識を向上させることが面接に役立つ場合は、このガイドは一見の価値があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将来的には、このガイドのコードを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Select Star SQL</font></a><font style="vertical-align: inherit;">などのサイトに移植でき</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLステートメントを簡単に記述できるようにし、コードの実行結果をリアルタイムで確認します。</font><font style="vertical-align: inherit;">オプションとして、質問をプラットフォームに問題として追加し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeetCode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インタビューの準備をし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">それまでの間、このドキュメントを公開して、人々がこの情報を理解できるようにしたいと思っていました。</font></font><br>
<br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前提条件とマニュアルの使用方法</font></font></h1><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL言語の知識に関する前提条件：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SQLの実用的な知識があることが前提となります。</font><font style="vertical-align: inherit;">あなたはおそらく仕事でそれを頻繁に使用しますが、自己関連付けやウィンドウ関数などのトピックであなたのスキルを磨きたいです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このマニュアルの使用方法：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボードまたは仮想ノートブックはインタビューで（コードをコンパイルせずに）使用されることが多いため、鉛筆と紙を用意し、各問題の解決策を書き留めて、完了後にノートと回答を比較することをお勧めします。</font><font style="vertical-align: inherit;">または、面接担当者となる友人とあなたの答えを考え出してください！</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホワイトボードまたはメモ帳へのインタビュー中、軽度の構文エラーはあまり問題になりません。</font><font style="vertical-align: inherit;">ただし、インタビュアーの注意をそらす可能性があるため、ロジックにすべての注意を集中させるために、その数を減らすことが理想的です。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与えられた答えは必ずしも各問題を解決する唯一の方法ではありません。</font><font style="vertical-align: inherit;">このガイドに追加できる追加の解決策を含むコメントを自由に書いてください！</font></font></li>
</ul><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLインタビューで複雑なタスクを解決するためのヒント</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、すべてのプログラミングインタビューの標準的なヒント...</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題の説明を注意深く聞き、問題の本質をインタビュアーに繰り返します</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題を本当に理解していることを示すために境界線のケースを作成します（つまり、作成する</font><font style="vertical-align: inherit;">最終的なSQLクエリに含まれ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ない</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font><font style="vertical-align: inherit;">）</font></font><br>
</li>
<li>(    )     ,     —     :     ,             <br>
<ul>
<li>,      ,     </li>
</ul></li>
<li>  SQL,   ,     .      ,      .</li>
</ol><br>
<a name="3"></a><h1>   </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここに記載されている問題の一部は、古いPeriscopeブログエントリ（主</font><font style="vertical-align: inherit;">に2014年頃</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sean Cook</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって作成さ</font><font style="vertical-align: inherit;">れましたが、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SiSenseがPeriscopeと統合</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">された後に資料から削除されたようです</font><font style="vertical-align: inherit;">）とStackOverflowに関する議論から</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">改変</font></a><font style="vertical-align: inherit;">されてい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">必要に応じて、出典は各質問の最初にマークされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の選択スターSQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も良いですが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、頭の体操の選択</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このドキュメントの補完的な問題。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの質問は、私自身のインタビューからの質問の文字どおりのコピーではなく、私が働いていた、または働いていた会社では使用されなかったことに注意してください。</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己関連付けタスク</font></font></h1><br>
<a name="5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1.月ごとの割合の変化</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば、アクティブなユーザーの月間オーディエンスなど、主要なメトリックが月ごとにどのように変化するかを知っておくと役立ちます。</font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式の</font><font style="vertical-align: inherit;">テーブルがあるとします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">日付|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目的</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：アクティブユーザー（MAU）の月間視聴者の月間変化率を求めます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：（</font></font></b><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この解決策には、このドキュメントの他のコードブロックと同様に、異なるSQLバリアント間で異なる可能性のあるSQL構文要素に関するコメントとその他の注意事項が含まれています）</font></font></i> <br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> mau <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
  <span class="hljs-keyword">SELECT</span> 
   <span class="hljs-comment">/* 
    *       
    *  , .&nbsp;.   ,    . 
    *    ,   
    *
    *  Postgres  DATE_TRUNC(),   
    *      SQL   
    * . https://www.postgresql.org/docs/9.0/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC
    */</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>) month_timestamp,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) mau
  <span class="hljs-keyword">FROM</span> <font></font>
    logins <font></font>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-built_in">date</span>)<font></font>
  )<font></font>
 <font></font>
 <span class="hljs-keyword">SELECT</span> 
    <span class="hljs-comment">/*
    *    SELECT      . 
    * 
    *        ,   
    *    ,   , 
    *        ..
    */</span> <font></font>
    a.month_timestamp previous_month, <font></font>
    a.mau previous_mau, <font></font>
    b.month_timestamp current_month, <font></font>
    b.mau current_mau, <font></font>
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-number">100.0</span>*(b.mau - a.mau)/a.mau,<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> percent_change 
 <span class="hljs-keyword">FROM</span><font></font>
    mau a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    <span class="hljs-comment">/*
    *   `ON b.month_timestamp = a.month_timestamp + interval '1 month'` 
    */</span>
    mau b <span class="hljs-keyword">ON</span> a.month_timestamp = b.month_timestamp - <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span> </code></pre><br>
<a name="6"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 2.マーキングツリー構造</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>tree</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つの列</font><font style="vertical-align: inherit;">を持つテーブルがある</font><font style="vertical-align: inherit;">とします。最初の列はノードを示し、2番目の列は親ノードを示します。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノードの親</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
12</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4 3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5 NULL </font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各ノードを内部（ルート）、ルート（ルート）、またはエンドノード/リーフ（リーフ）として指定するようにSQLを記述し、上記の値に対して以下を取得します：</font></font><br>
<br>
<pre><code class="sql hljs">node    label  <font></font>
1       Leaf<font></font>
2       Inner<font></font>
3       Inner<font></font>
4       Leaf<font></font>
5       Root</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（注：ツリーのようなデータ構造の用語の詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ただし、この問題を解決する必要はありません！）</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fabian Hoffmanは、2020年5月2日にこのより一般的な解決策を提案しました。</font><font style="vertical-align: inherit;">ありがとう</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> join_table <span class="hljs-keyword">AS</span><font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> <font></font>
        cur.node, <font></font>
        cur.parent, <font></font>
        <span class="hljs-keyword">COUNT</span>(next.node) <span class="hljs-keyword">AS</span> num_children
    <span class="hljs-keyword">FROM</span> <font></font>
        tree cur<font></font>
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
        tree <span class="hljs-keyword">next</span> <span class="hljs-keyword">ON</span> (next.parent = cur.node)
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
        cur.node, <font></font>
        cur.parent<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span>
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Root"</span>
        <span class="hljs-keyword">WHEN</span> num_children = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">"Leaf"</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">"Inner"</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label
<span class="hljs-keyword">FROM</span> 
    join_table </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明示的な接続のない代替ソリューション：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2020年5月2日のWilliam Chardginは</font></font><code>WHERE parent IS NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このソリューションが</font></font><code>Leaf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに</font><font style="vertical-align: inherit;">戻る</font><font style="vertical-align: inherit;">という条件の必要性に注意を向けました</font></font><code>NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ウィリアム、ありがとう！</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    node,<font></font>
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Root'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> 
            (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Leaf'</span>
        <span class="hljs-keyword">WHEN</span> node <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">FROM</span> tree) <span class="hljs-keyword">AND</span> <span class="hljs-keyword">parent</span> <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Inner'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> label 
 <span class="hljs-keyword">from</span> 
    tree</code></pre><br>
<a name="7"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 3. 1か月あたりのユーザー保持（いくつかの部分）</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクは、SiSenseブログの記事</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己関連付け</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を使用して保持、</font></a><font style="vertical-align: inherit;">アウトフロー、および再アクティブ化</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を計算する」</font></a><font style="vertical-align: inherit;">から転用されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="8"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：次</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の表にあるサイトのユーザー認証に関する統計があるとします</font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">日付|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-07-02 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-04 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1か月あたりの保持ユーザー数を受け取るリクエストを記述します。</font><font style="vertical-align: inherit;">今回の場合、このパラメーターは、今月と前月にシステムにログインしたユーザーの数として定義されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> a.user_id) retained_users 
 <span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
 <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                             <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    date_trunc(<span class="hljs-string">'month'</span>, a.date)</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
自己結合の前にuser_idを事前に複製するとソリューションがより効率的になることをTom Moertelは指摘し、以下のコードを提案しました。</font><font style="vertical-align: inherit;">トム、ありがとう！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代替ソリューション：</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> DistinctMonthlyUsers <span class="hljs-keyword">AS</span> (
  <span class="hljs-comment">/*
  *     ** , 
  *  
  */</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span>
      DATE_TRUNC(<span class="hljs-string">'MONTH'</span>, a.date) <span class="hljs-keyword">AS</span> month_timestamp,<font></font>
      user_id<font></font>
    <span class="hljs-keyword">FROM</span> logins<font></font>
  )<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span><font></font>
  CurrentMonth.month_timestamp month_timestamp,<font></font>
  <span class="hljs-keyword">COUNT</span>(PriorMonth.user_id) <span class="hljs-keyword">AS</span> retained_user_count
<span class="hljs-keyword">FROM</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> CurrentMonth
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> 
    DistinctMonthlyUsers <span class="hljs-keyword">AS</span> PriorMonth
  <span class="hljs-keyword">ON</span>
    CurrentMonth.month_timestamp = PriorMonth.month_timestamp + <span class="hljs-built_in">INTERVAL</span> <span class="hljs-string">'1 MONTH'</span>
    <span class="hljs-keyword">AND</span> 
    CurrentMonth.user_id = PriorMonth.user_id</code></pre><br>
<a name="9"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、前のタスクである1か月の保持ユーザー数を計算し、それを上下逆にします。</font><font style="vertical-align: inherit;">今月、サイトに戻っ</font><font style="vertical-align: inherit;">て</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いない</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーをカウントするリクエストを作成します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり、「失われた」ユーザーです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> b.user_id) churned_users 
<span class="hljs-keyword">FROM</span> <font></font>
    logins a <font></font>
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> 
    logins b <span class="hljs-keyword">ON</span> a.user_id = b.user_id 
        <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, b.date) + 
                                         <span class="hljs-built_in">interval</span> <span class="hljs-string">'1 month'</span>
<span class="hljs-keyword">WHERE</span> 
    a.user_id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題はまたして解決することができることに注意してください</font></font><code>LEFT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か</font></font><code>RIGHT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="10"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート3</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：これは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、実際の面接で提供されるよりもおそらく難しい作業です。</font><font style="vertical-align: inherit;">パズルのように考えてください。スキップして次のタスクに進むことができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：これまでの2つの問題をうまく処理しました。</font><font style="vertical-align: inherit;">新しいタスクの条件の下で、失われたユーザーの表ができました</font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ユーザーが先月アクティブだったが、今月アクティブではなかった場合、そのユーザーは今月のテーブルに入力されます。</font><font style="vertical-align: inherit;">これは次のようになります</font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">user_id | </font><font style="vertical-align: inherit;">month_date |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">12 | </font><font style="vertical-align: inherit;">2018-05-01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">234 | </font><font style="vertical-align: inherit;">2018-10-01 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ここで、コホート分析、つまり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、過去に再</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクティブ</font><i><font style="vertical-align: inherit;">化された</font></i><font style="vertical-align: inherit;">アクティブユーザーの総数の分析を実行したいとします</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらのユーザーでテーブルを作成します。</font><font style="vertical-align: inherit;">テーブル</font></font><code>user_churns</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、コホートを作成できます</font></font><code>logins</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Postgresでは、現在のタイムスタンプはを介してアクセスできます</font></font><code>current_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> user_login_data <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) month_timestamp,<font></font>
        a.user_id,<font></font>
        <span class="hljs-comment">/* 
        *   ,    SQL,   , 
        *      SELECT   HAVING.
        *       .  
        */</span> 
        <span class="hljs-keyword">MAX</span>(b.month_date) <span class="hljs-keyword">as</span> most_recent_churn, 
        <span class="hljs-keyword">MAX</span>(DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)) <span class="hljs-keyword">as</span> most_recent_active 
     <span class="hljs-keyword">FROM</span> <font></font>
        logins a<font></font>
     <span class="hljs-keyword">JOIN</span> <font></font>
        user_churns b <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = b.user_id <span class="hljs-keyword">AND</span> DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; b.month_date 
     <span class="hljs-keyword">JOIN</span><font></font>
        logins c <font></font>
            <span class="hljs-keyword">ON</span> a.user_id = c.user_id 
            <span class="hljs-keyword">AND</span> 
            DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) &gt; DATE_TRUNC(<span class="hljs-string">'month'</span>, c.date)
     <span class="hljs-keyword">WHERE</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date) = DATE_TRUNC(<span class="hljs-string">'month'</span>, <span class="hljs-keyword">current_timestamp</span>)
     <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        DATE_TRUNC(<span class="hljs-string">'month'</span>, a.date),<font></font>
        a.user_id<font></font>
     <span class="hljs-keyword">HAVING</span> 
        most_recent_churn &gt; most_recent_active</code></pre><br>
<a name="11"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 4.増加する合計</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクは、SiSenseブログの記事</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、SQLのキャッシュフローモデリング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から変更されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>transactions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式の</font><font style="vertical-align: inherit;">テーブルがあるとします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">日付| </font><font style="vertical-align: inherit;">キャッシュフロー|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ----------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br><font style="vertical-align: inherit;"></font><code>cash_flow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">収益から毎日のコストを引いたものは</font><font style="vertical-align: inherit;">
どこですか</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目的：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャッシュフローの現在までの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を毎日</font><font style="vertical-align: inherit;">取得するリクエストを作成</font><font style="vertical-align: inherit;">し、最終的に次の形式のテーブルを取得します。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">日付| </font><font style="vertical-align: inherit;">incremental_cf |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">-1000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">-1100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">-1050 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    a.date <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(b.cash_flow) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions a<font></font>
<span class="hljs-keyword">JOIN</span> b <font></font>
    transactions b <span class="hljs-keyword">ON</span> a.date &gt;= b.date 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    a.date <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ウィンドウ関数を使用した代替ソリューション（より効率的！）：</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-built_in">date</span>, 
    <span class="hljs-keyword">SUM</span>(cash_flow) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span>) <span class="hljs-keyword">as</span> cumulative_cf 
<span class="hljs-keyword">FROM</span><font></font>
    transactions <font></font>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-built_in">date</span> <span class="hljs-keyword">ASC</span></code></pre><br>
<a name="12"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 5.移動平均</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクは、SiSenseブログの記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLとSQL Serverの移動平均」を基にしています</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">移動平均はさまざまな方法で計算できます。</font><font style="vertical-align: inherit;">ここでは、以前の平均を使用します。</font><font style="vertical-align: inherit;">したがって、月の7日目のメトリックは、前の6日間と自分自身の平均になります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>signups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式の</font><font style="vertical-align: inherit;">テーブルがあるとします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">日付| </font><font style="vertical-align: inherit;">サインアップ|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-01 | </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-02 | </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-01-03 | </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">... | </font><font style="vertical-align: inherit;">... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2018-10-01 | </font><font style="vertical-align: inherit;">35 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：1日の登録の7日間の移動平均を取得するリクエストを作成します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
  a.date, <font></font>
  <span class="hljs-keyword">AVG</span>(b.sign_ups) average_sign_ups 
<span class="hljs-keyword">FROM</span> <font></font>
  signups a <font></font>
<span class="hljs-keyword">JOIN</span> 
  signups b <span class="hljs-keyword">ON</span> a.date &lt;= b.date + <span class="hljs-built_in">interval</span> <span class="hljs-string">'6 days'</span> <span class="hljs-keyword">AND</span> a.date &gt;= b.date
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
  a.date</code></pre><br>
<a name="13"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 6.いくつかの接続条件</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクは、SiSenseブログの記事</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「SQLを使用した電子メールの分析」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から変更されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>emails</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドレスに送信されて</font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信さ</font><font style="vertical-align: inherit;">れたメールが</font><font style="vertical-align: inherit;">テーブルに</font><font style="vertical-align: inherit;">含まれている</font><font style="vertical-align: inherit;">とします。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">件名| </font><font style="vertical-align: inherit;">から| </font><font style="vertical-align: inherit;">へ| </font><font style="vertical-align: inherit;">タイムスタンプ|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ---- | ---------- | -------------- | -------------- | --- ------------------ |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">ヨセミテ| </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 12:45:03 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">ビッグサー| </font><font style="vertical-align: inherit;">sarah@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:30:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">ヨセミテ| </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-02 16:35:04 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">実行中| </font><font style="vertical-align: inherit;">jill@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 08:12:45 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">ヨセミテ| </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">2018-01-03 14:02:01 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">ヨセミテ| </font><font style="vertical-align: inherit;">thomas@g.com | </font><font style="vertical-align: inherit;">zach@g.com | </font><font style="vertical-align: inherit;">2018-01-03 15:01:05 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：に</font></font></b><font style="vertical-align: inherit;"></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信さ</font><font style="vertical-align: inherit;">れた各レター（</font><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">応答時間を取得するリクエストを記述</font><font style="vertical-align: inherit;">し</font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">他のアドレスへの手紙は含めないでください。</font><font style="vertical-align: inherit;">各スレッドに固有のテーマがあるとします。</font><font style="vertical-align: inherit;">スレッドには</font></font><code>zach@g.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、他の受信者との</font><font style="vertical-align: inherit;">間でいくつかの往復の手紙がある場合があることに注意してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    a.id, <font></font>
    <span class="hljs-keyword">MIN</span>(b.timestamp) - a.timestamp <span class="hljs-keyword">as</span> time_to_respond 
<span class="hljs-keyword">FROM</span> <font></font>
    emails a <font></font>
<span class="hljs-keyword">JOIN</span><font></font>
    emails b <font></font>
        <span class="hljs-keyword">ON</span> <font></font>
            b.subject = a.subject <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.to = b.from<font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.from = b.to <font></font>
        <span class="hljs-keyword">AND</span> <font></font>
            a.timestamp &lt; b.timestamp <font></font>
 <span class="hljs-keyword">WHERE</span> 
    a.to = <span class="hljs-string">'zach@g.com'</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    a.id </code></pre><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウ関数のタスク</font></font></h1><br>
<a name="15"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1.最大値の識別子を見つける</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式の部門と従業員の給与に関するデータを含む</font><font style="vertical-align: inherit;">テーブルがある</font><font style="vertical-align: inherit;">とします。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">給与|     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>empno</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最高の給与</font><font style="vertical-align: inherit;">を取得するリクエストを作成し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">あなたのソリューションが同じ給与のケースを処理することを確認してください！</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> max_salary <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">MAX</span>(salary) max_salary
    <span class="hljs-keyword">FROM</span> <font></font>
        salaries<font></font>
    )<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
    s.empno<font></font>
<span class="hljs-keyword">FROM</span> <font></font>
    salaries s<font></font>
<span class="hljs-keyword">JOIN</span> 
    max_salary ms <span class="hljs-keyword">ON</span> s.salary = ms.max_salary</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を使用した代替ソリューション</font></font><code>RANK()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> sal_rank <span class="hljs-keyword">AS</span> 
  (<span class="hljs-keyword">SELECT</span> <font></font>
    empno, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) rnk
  <span class="hljs-keyword">FROM</span> <font></font>
    salaries)<font></font>
<span class="hljs-keyword">SELECT</span> <font></font>
  empno<font></font>
<span class="hljs-keyword">FROM</span><font></font>
  sal_rank<font></font>
<span class="hljs-keyword">WHERE</span> 
  rnk = <span class="hljs-number">1</span>;</code></pre><br>
<a name="16"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No.2。窓関数による平均値とランキング（一部）</font></font></h2><br>
<a name="17"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>salaries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の形式の</font><font style="vertical-align: inherit;">テーブル</font><font style="vertical-align: inherit;">があるとします。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">給与|     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じテーブルを返すクエリを作成しますが、部門の平均給与を示す新しい列を使用します。</font><font style="vertical-align: inherit;">次のようなテーブルが必要です。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">給与| </font><font style="vertical-align: inherit;">avg_salary |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">5020 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">3700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">4867 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">4867 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-comment">/*
    * AVG() is a Postgres command, but other SQL flavors like BigQuery use 
    * AVERAGE()
    */</span> 
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(salary),<span class="hljs-number">0</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname) avg_salary
<span class="hljs-keyword">FROM</span>
    salaries</code></pre><br>
<a name="18"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部門の給与に基づいてタイムシートの各従業員の位置を含む列を追加するクエリを記述します。最高の給与をもつ従業員は1位になります。次の形式のテーブルが必要です。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  depname | </font><font style="vertical-align: inherit;">empno | </font><font style="vertical-align: inherit;">給与| </font><font style="vertical-align: inherit;">salary_rank |     </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
----------- + ------- + -------- + ------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">4200 | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">4500 | </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">6000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開発する| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5200 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">3500 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 職員| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3900 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">5000 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 販売| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">4800 | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <font></font>
    *, <font></font>
    <span class="hljs-keyword">RANK</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> depname <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) salary_rank
 <span class="hljs-keyword">FROM</span>  
    salaries </code></pre><br>
<a name="19"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中および高難度の他のタスク</font></font></h1><br>
<a name="20"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 1.ヒストグラム</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>sessions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各行が秒単位の長さのビデオストリーミングセッションを表す</font><font style="vertical-align: inherit;">テーブルがあるとします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">session_id | </font><font style="vertical-align: inherit;">length_seconds |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------------ | ---------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">453 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">27 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5秒の間隔に該当するセッションの数を計算するクエリを記述します。つまり、上記のフラグメントの場合、結果は次のようになります。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">バケット| </font><font style="vertical-align: inherit;">カウント|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">20-25 </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">450〜455 | </font><font style="vertical-align: inherit;">1 |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
適切なラインラベルの最大スコアカウント（ "5-10"など）</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソリューション：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> bin_label <span class="hljs-keyword">AS</span> 
(<span class="hljs-keyword">SELECT</span> <font></font>
    session_id, <font></font>
    <span class="hljs-keyword">FLOOR</span>(length_seconds/<span class="hljs-number">5</span>) <span class="hljs-keyword">as</span> bin_label 
 <span class="hljs-keyword">FROM</span><font></font>
    sessions <font></font>
 )<font></font>
 <span class="hljs-keyword">SELECT</span> 
    CONCATENTATE(<span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>), <span class="hljs-string">'-'</span>, <span class="hljs-keyword">STR</span>(bin_label*<span class="hljs-number">5</span>+<span class="hljs-number">5</span>)) <span class="hljs-keyword">bucket</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> session_id) <span class="hljs-keyword">count</span> 
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <font></font>
    bin_label<font></font>
 <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    bin_label <span class="hljs-keyword">ASC</span> </code></pre><br>
<a name="21"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 2.クロス接続（いくつかの部品）</font></font></h2><br>
<a name="22"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>state_streams</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビデオホスティングからのストリーミングの総時間数と状態の名前が各行に示され</font><font style="vertical-align: inherit;">ているテーブルがあるとしましょう</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">状態| </font><font style="vertical-align: inherit;">total_streams |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | --------------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">34569 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">33999 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CA | </font><font style="vertical-align: inherit;">98324 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MA | </font><font style="vertical-align: inherit;">19345 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">.. | </font><font style="vertical-align: inherit;">.. |</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（実際、このタイプの集計テーブルには通常、日付列がありますが、このタスクでは除外します）</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スレッドの総数が互いに1,000以内の状態のペアを取得するクエリを記述します。</font><font style="vertical-align: inherit;">上記のスニペットの場合、次のようなものが見られます。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">state_a | </font><font style="vertical-align: inherit;">state_b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| --------- | --------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NC | </font><font style="vertical-align: inherit;">SC |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SC | </font><font style="vertical-align: inherit;">NC |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a<font></font>
 <span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> <font></font>
    state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳しくは、明示的に結合を指定せずにクロス結合を作成することもできます。</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &lt;&gt; b.state </code></pre><br>
<a name="23"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート2</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、本当に重要なSQLテンプレートではなく、おまけの質問です。</font><font style="vertical-align: inherit;">スキップできます！</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前のソリューションからSQLを変更して重複を削除するにはどうすればよいですか？</font><font style="vertical-align: inherit;">例えば、同じテーブルの例は、水蒸気</font></font><code>NC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>SC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一度だけではなく、二人はありました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span>
    a.state <span class="hljs-keyword">as</span> state_a, <font></font>
    b.state <span class="hljs-keyword">as</span> state_b 
 <span class="hljs-keyword">FROM</span>   <font></font>
    state_streams a, state_streams b <font></font>
 <span class="hljs-keyword">WHERE</span> 
    <span class="hljs-keyword">ABS</span>(a.total_streams - b.total_streams) &lt; <span class="hljs-number">1000</span>
    <span class="hljs-keyword">AND</span> 
    a.state &gt; b.state </code></pre><br>
<a name="24"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 3.高度な計算</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">謝辞：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このタスクは</font><font style="vertical-align: inherit;">、StackOverflow（私のニックネームはzthomas.nc）で私が尋ねた質問</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">についてのディスカッション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から採用されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：これは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、実際の面接で提供されるよりもおそらく難しい作業です。</font><font style="vertical-align: inherit;">それをパズルのように考えてください-スキップすることもできます！</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト：</font></font></b><font style="vertical-align: inherit;"></font><code>table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この種類の</font><font style="vertical-align: inherit;">テーブルが</font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり、クラスの異なる値が</font><font style="vertical-align: inherit;">同じユーザーに</font><font style="vertical-align: inherit;">対応</font><font style="vertical-align: inherit;">しているとします</font></font><code>class</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">ユーザー| </font><font style="vertical-align: inherit;">クラス|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------ | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">a |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">a |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスに可能な値が2つしかないと仮定します。</font><font style="vertical-align: inherit;">各クラスのユーザー数を計算するクエリを記述します。</font><font style="vertical-align: inherit;">この場合、両方のラベル</font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">持つユーザーが</font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスを参照する必要があります</font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このサンプルでは、​​次の結果が得られます。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">クラス| </font><font style="vertical-align: inherit;">カウント|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ------- | ------- |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">b | </font><font style="vertical-align: inherit;">2 |</font></font></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">決定：</font></font></b><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">WITH</span> usr_b_sum <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) num_b
    <span class="hljs-keyword">FROM</span> 
        <span class="hljs-keyword">table</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
        <span class="hljs-keyword">user</span><font></font>
), <font></font>
<font></font>
usr_class_label <span class="hljs-keyword">AS</span> <font></font>
(<font></font>
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-keyword">user</span>, 
        <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> num_b &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'b'</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'a'</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">class</span> 
    <span class="hljs-keyword">FROM</span> <font></font>
        usr_b_sum<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">class</span>, 
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> <span class="hljs-keyword">user</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">FROM</span><font></font>
    usr_class_label<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">class</span> <span class="hljs-keyword">ASC</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代替ソリューションは、命令を使用して</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーターに</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>UNION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"a"</span> <span class="hljs-keyword">class</span>,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) - <font></font>
        (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> 
<span class="hljs-keyword">UNION</span>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">"b"</span> <span class="hljs-keyword">class</span>,<font></font>
    (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> user_id) <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">class</span> = <span class="hljs-string">'b'</span>) <span class="hljs-keyword">count</span> </code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja500346/index.html">KubernetesでのDNSの問題。公開検死</a></li>
<li><a href="../ja500348/index.html">数学者の目を通したCOVID-19パンデミック、または古典的なSEIRDモデルが機能しない理由</a></li>
<li><a href="../ja500352/index.html">Facebookでインターンシップを取得し、ロンドンでオファーを取得するにはどうすればよいですか？Facebookエンジニアに質問する</a></li>
<li><a href="../ja500354/index.html">Googleタグマネージャーでデータを追跡する新しい方法-サーバー側のタグ付け</a></li>
<li><a href="../ja500356/index.html">WebRTCを介したデバイス間の直接ファイル転送</a></li>
<li><a href="../ja500364/index.html">MoodleとBigBlueButtonの学校学習ポータルを拡張する</a></li>
<li><a href="../ja500368/index.html">予測可能なランダムシーケンスの生成：順列への別のアプローチ</a></li>
<li><a href="../ja500370/index.html">2020年に購読する価値のあるプログラマー向けの役立つ10の英語ポッドキャスト</a></li>
<li><a href="../ja500378/index.html">職場での効果的な情報検索</a></li>
<li><a href="../ja500380/index.html">個人データのリモート処理：リスクと考えられる結果</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>