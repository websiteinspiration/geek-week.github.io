<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•å üßòüèø ‚õìÔ∏è Windows vs Sysmon üèÇüèæ üöµüèº üë©‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En la √∫ltima conferencia de ZeroNights, en el curso de una comunicaci√≥n informal con nuestros colegas en el sistema de monitoreo, nos hicieron una pre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows vs Sysmon</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489050/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/x6/_z/yyx6_zfwsrw0m-c8zx_yr5bimqs.jpeg"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la √∫ltima conferencia de ZeroNights, en el curso de una comunicaci√≥n informal con nuestros colegas en el sistema de monitoreo, nos hicieron una pregunta simple a primera vista: se cre√≠a ampliamente que Sysmon deber√≠a usarse para monitorear completamente el punto final con el sistema operativo Windows, ¬øes as√≠? </font><font style="vertical-align: inherit;">Y si es as√≠, ¬øpor qu√© razones espec√≠ficas (hola Seryozha!)? </font><font style="vertical-align: inherit;">No pudimos encontrar una respuesta integral inequ√≠voca en nuestro bagaje de conocimientos o una comparaci√≥n correspondiente en Internet, por lo tanto, en primer lugar, para nosotros mismos, y no menos importante, de modo que en el futuro dicha fuente a√∫n estar√≠a disponible en la comunidad, decidimos explorar este tema y compare los eventos cara a cara de Windows y Sysmon. </font><font style="vertical-align: inherit;">Como dice el refr√°n, "1 ... 2 ... 3 ... ¬°Lucha!".</font></font><a name="habracut"></a></p><br>
<a name="stage1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introducci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cualquier especialista en el campo de la seguridad de la informaci√≥n se ve obligado a trabajar dentro de un determinado marco. Por ejemplo, dentro de un presupuesto limitado, la seguridad, con raras excepciones, no es la forma principal para que una organizaci√≥n obtenga ganancias o realice otras funciones dentro de su negocio principal. Por lo tanto, en condiciones de recursos limitados que posee la organizaci√≥n, solo una peque√±a parte de ellos a menudo se asigna al sector de seguridad para mantener esta direcci√≥n al nivel m√≠nimo suficiente (de acuerdo con ciertos requisitos). Incluso con recursos ilimitados, siempre habr√° otras restricciones que no permitir√°n llevar el nivel de seguridad al absoluto. Estas son las notorias vulnerabilidades del d√≠a cero o normal (administraci√≥n de parches sin fin), y la carrera armamentista constante de piratas inform√°ticos y guardias de seguridad,y el dinamismo del desarrollo de la infraestructura de TI, y mucho, mucho m√°s.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este sentido, m√°s que nunca, la cuesti√≥n de priorizar los medios y m√©todos de protecci√≥n es urgente, incluso en la direcci√≥n del monitoreo. En esta √°rea, seg√∫n las estad√≠sticas basadas en los datos de la matriz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MITER ATT &amp; CK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sobre la que ya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escribimos la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √∫ltima vez, las prioridades son las siguientes: una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuente de eventos de seguridad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como puntos finales </font><font style="vertical-align: inherit;">toma el primer lugar incondicional </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/9p/it/hr9piteihbc4qv4qgsff55qu2iq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta fuente lidera la cantidad de t√©cnicas matriciales que pueden identificarse en funci√≥n de los eventos registrados en ella. El sistema operativo m√°s com√∫n para puntos finales sigue siendo Microsoft Windows. Recopilar exactamente sus registros en la mayor√≠a de las infraestructuras corporativas dar√° el mejor resultado en la relaci√≥n de todos los tipos de costos a la cobertura de dispositivos de red y la cobertura de t√©cnicas maliciosas. Esto es confirmado por las estad√≠sticas de los mismos autores. Los lugares 1-3, 5, 7, 8, 10 y la parte 4 ocupan solo estos llamados eventos b√°sicos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/7q/7o/gh7q7otidvmpw_ibo6fqnaxmsuw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, como en el famoso chiste, hay una advertencia. En los √∫ltimos a√±os, se ha aceptado ampliamente que los registros de Windows deben complementarse, si no reemplazarse, con eventos Sysmon; dicen que son m√°s completos, mejores y m√°s adaptados como herramienta de monitoreo desde el punto de vista de la seguridad de la informaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, este enfoque de alguna manera cumple con el concepto de minimalismo. Cada producto de software que est√° tratando de agregar a los suyos o que un cliente empresarial le haya dado voluntariamente es un aumento en el √°rea de ataque, los costos de administraci√≥n y actualizaci√≥n, y los puntos de falla. Y a menudo, y justo antes de la implementaci√≥n de su sistema de monitoreo, mientras su enfoque pasa la aprobaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon fue desarrollado por especialistas de Microsoft, y recientemente absorbido por esta corporaci√≥n, que brinda cierto nivel de confianza por parte de TI. Adem√°s, los registros se escriben en forma de un registro .evtx, que le permite recopilarlos y procesarlos utilizando las mismas herramientas y m√©todos que los registros normales de Windows.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inmediatamente haga una reserva de que el art√≠culo result√≥ ser grande, aunque intentamos duplicar y comprimir el material m√≠nimamente. El lector, por supuesto, puede decir, refiri√©ndonos a esa broma sobre Lenin: "Pero √©l podr√≠a haber cortado ...". O que "la publicaci√≥n podr√≠a dividirse en dos o tres partes para una mayor legibilidad". Pero nos pareci√≥ que, a pesar del volumen del material preparado, debemos proporcionar una respuesta completa a la pregunta de nuestros colegas en la tienda, y la b√∫squeda ser√≠a m√°s conveniente. Por lo tanto, para no perder nada, le recomendamos que lea el art√≠culo 1 por completo, tal vez tome notas por s√≠ mismo y solo luego regrese a grupos espec√≠ficos de eventos y profundice en ellos en detalle.</font></font><br>
<br>
<a name="stage2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para mayor comodidad, agregamos una tabla de contenido: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introducci√≥n </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabla de contenido </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formato de comparaci√≥n </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creaci√≥n de un proceso </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conexiones de red </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalizaci√≥n de un proceso </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descarga de un controlador </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acceso a un proceso </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creaci√≥n de un archivo </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acciones de registro </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n de WMI </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Consultas </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eventos √∫nicos de Sysmon Eventos de </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtrado </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otros proveedores de eventos base gratuitos </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salida general</font></font></a><br>
<br>
<a name="stage3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formato de comparaci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por qu√© y qu√© se compar√≥, parece estar claro. ¬øY c√≥mo se hizo esto y por qu√© exactamente? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidimos hacer una comparaci√≥n en forma de tabla para cada uno de los grupos de eventos que reflejan una determinada actividad en el sistema. Por ejemplo, los eventos con ID (ID de evento, EID) 12, 13 y 14 en Sysmon, que reflejan la actividad con el registro, ni siquiera se filtran por separado, aunque hablan de diferentes acciones at√≥micas. Por la misma l√≥gica, se hizo el resto de la agrupaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dichos grupos incluyeron solo eventos similares. Por ejemplo, un an√°logo del evento Sysmon EID 6 es el evento Windows EID 6. Al mismo tiempo, hay al menos 219 y 7036 eventos de Windows sobre la carga de controladores. Pero surgen en caso de falla. Aquellos. no lleve la misma carga sem√°ntica y, si es necesario, puede complementar los eventos de Sysmon o Windows, seg√∫n lo que hayamos decidido recopilar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para los grupos de eventos reflejados en la tabla, los campos informativos (que utilizamos para fines de monitoreo) contenidos en los eventos se presentan en forma de cadenas. Para cada uno de estos campos, se indica su nombre. Para Windows, son posibles 2 opciones, para xml y vistas de revistas (¬øqui√©n hubiera pensado que coincidir√≠an?) Si difieren m√°s que por espacios. Esto se hace porque El nombre del campo que se incluir√° en el sistema de monitoreo puede depender del m√©todo de recolecci√≥n. Las l√≠neas tambi√©n contienen datos de eventos (para comprender su formato) y un comentario (si en nuestra opini√≥n esto es obligatorio). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los campos con la misma carga sem√°ntica para ambas fuentes se combinan en una l√≠nea. En ausencia de un campo con la misma carga sem√°ntica para una de las fuentes, los guiones ("-") se indican en los campos correspondientes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las l√≠neas que contienen informaci√≥n sobre una entidad particular, por ejemplo, el sujeto que realiza la acci√≥n, se combinan en un grupo sem√°ntico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaci√≥n se realiz√≥ para las versiones de Windows Kernel 6.3 (Windows 2012R2) y 10.0 (Windows 10, 2016, 2019). No se consideraron versiones anteriores, ya que aunque todav√≠a est√°n muy extendidas, est√°n desapareciendo gradualmente. Si los eventos para diferentes versiones de kernel no difer√≠an, las columnas se combinaron en una para reducir la duplicaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como la tasa es a tiempo completo, las columnas se organizan en el siguiente orden desde el centro hasta los bordes: datos, nombre del campo, comentario. Esto hace que la comparaci√≥n sea m√°s visual. Para la separaci√≥n visual de las columnas de acuerdo con las fuentes a las que se refieren, se utilizan colores.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exclusivo de Sysmon EID (dado que en este caso es una herramienta adicional, el registro del sistema operativo se incluye en la funcionalidad b√°sica del sistema operativo) se proporciona en una secci√≥n separada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La secci√≥n con la tabla muestra la configuraci√≥n de GPO que se debe realizar para habilitar la grabaci√≥n en el registro de eventos del grupo, como </font><font style="vertical-align: inherit;">El n√∫mero de posibles opciones de auditor√≠a es generalmente bastante grande. </font><font style="vertical-align: inherit;">Para Sysmon, tales configuraciones no se muestran porque </font><font style="vertical-align: inherit;">Todos ellos est√°n contenidos en un √∫nico archivo de configuraci√≥n.</font></font><br>
<br>
<a name="stage4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proceso de creaci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parad√≥jicamente, decidieron comenzar desde el principio. Y luego tampoco fueron originales y se pusieron en orden, al aumentar EID Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El registro de datos de eventos en Windows se habilita de la siguiente manera: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de pol√≠ticas de auditor√≠a - Pol√≠ticas de auditor√≠a - Seguimiento detallado - Creaci√≥n del proceso de auditor√≠a - El √©xito permite el registro del evento en s√≠; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Configuraci√≥n de la computadora - Pol√≠ticas - Plantillas administrativas - Sistema - Creaci√≥n del proceso de auditor√≠a - Incluir l√≠nea de comando en eventos de creaci√≥n de proceso - agrega la l√≠nea de comando del proceso iniciado al evento, lo que a menudo hace posible distinguir un inicio leg√≠timo de uno ileg√≠timo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaci√≥n en el formato descrito anteriormente se presenta en la siguiente tabla.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/rs/dw/nm/rsdwnmsmgurjif--9gck7phggee.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En lo sucesivo, todas las tablas est√°n representadas por im√°genes y se puede hacer clic en ellas. Dado que, en primer lugar, no encontramos una buena manera de transferir tablas a Markdown o HTML mientras conservamos el ancho de columna o la separaci√≥n sil√°bica de acuerdo con la versi√≥n existente en Excel. Y en segundo lugar, sus contenidos no son muy valiosos para la indexaci√≥n, excepto los comentarios. Mucho m√°s valioso en las tablas es la composici√≥n de los campos discutidos en este art√≠culo y el formato de datos con el que tendr√° que trabajar si se utilizan estos or√≠genes de eventos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©relo en orden, pero no l√≠nea por l√≠nea: cada uno har√° un an√°lisis tan detallado por s√≠ mismo. </font><font style="vertical-align: inherit;">En esta secci√≥n y a continuaci√≥n, nos detendremos solo en la informaci√≥n encontrada por primera vez. </font><font style="vertical-align: inherit;">Inmediatamente comience con un ejemplo de este comportamiento. </font><font style="vertical-align: inherit;">Los campos de la secci√≥n Sistema est√°n presentes en cada evento que cae en el registro, independientemente de la fuente: Sysmon o Windows. </font><font style="vertical-align: inherit;">Incluyen informaci√≥n general:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El nombre del proveedor del evento.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La hora en que se registr√≥ el evento.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El nombre de la revista de donde obtuvimos este evento.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El host en el que ocurri√≥ el evento.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El nombre del proveedor y el registro despu√©s de la conexi√≥n generalmente no son utilizados por el analista. Pero permiten comprender d√≥nde y qui√©n escribe los registros, lo cual es importante si el proceso de recopilaci√≥n a√∫n no ha comenzado. El tiempo, el host y el EID son las principales balizas mediante las cuales se realiza el filtrado primario de eventos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, entre los campos que me gustar√≠a destacar, el GUID para la sesi√≥n del usuario y los procesos hijo y padre solo existe en los registros de Sysmon. Y para la misma alcanc√≠a, por rarezas: el ID del proceso (nuevo y principal) en los eventos de Windows se escribe en hexadecimal, aunque se muestra en notaci√≥n decimal en el mismo Administrador de tareas. Como dice el refr√°n, feliz depuraci√≥n ("-¬øQuieres mejorar? -Github") ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La l√≠nea de comando al iniciar un proceso en eventos de Windows tiene un formato diferente dependiendo de la utilidad utilizada para iniciarlo. Pero en Sysmon, los autores quer√≠an y pod√≠an: el formato no depende de otra entrada. No voy a juzgar las razones, pero los creadores del contenido de SIEM no escribir√°n gracias a Microsoft sobre esto, eso es seguro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La principal caracter√≠stica distintiva de Sysmon para esto, as√≠ como para otros eventos que contienen este campo, llamar√≠a el hash del archivo ejecutable. El formato hash se selecciona en la configuraci√≥n de Sysmon.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nuevo, de los bonos adicionales interesantes de Sysmon: el campo Nombre de la regla. </font><font style="vertical-align: inherit;">Esta es, de hecho, una etiqueta que es conveniente para marcar ciertos filtros en el archivo de configuraci√≥n y luego usarla al analizar eventos. </font><font style="vertical-align: inherit;">Por ejemplo, podemos decir que el proceso de inicio X se refiere a las t√°cticas Y o la t√©cnica Z. Este enfoque es interesante tanto desde el punto de vista del analista como desde el punto de vista del desarrollador de contenido SIEM o Sysmon: nos permite comprender la raz√≥n por la que decidimos recopilar este evento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon es mucho mejor para arreglar este grupo de eventos:</font></font><br>
<br>
<ul>
<li> GUID       ,          , ,     ,      ID         (    ).  , ,           .         .    ID           , , SIEM,         .  GUID,  ‚Äî  .</li>
<li>  ‚Äî                 ‚Äî  ,            ,    .    ‚Äî  Sysmon    ,      SIEM ( ).   -    ‚Äî   ,        .    ,   SIEM     .   , ,  IBM QRadar. , -     .   , ,     ‚Äî  Windows  ,    ,    .</li>
<li>  Rule Name    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La aplicabilidad de los campos √∫nicos restantes, que en los eventos de Windows, que en los eventos de Sysmon, juega un papel, como se dice en ingl√©s, caso por caso. </font><font style="vertical-align: inherit;">Por lo tanto, para decidir la elecci√≥n de un registro particular, o en general combinarlos, tambi√©n es necesario caso por caso.</font></font></li>
</ul><a name="stage5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conexiones de red</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grabaci√≥n de estos eventos en Windows: Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n de pol√≠tica de auditor√≠a avanzada - Pol√≠ticas de auditor√≠a - Acceso a objetos - Conexi√≥n de plataforma de filtrado de auditor√≠a</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øPor qu√© decidi√≥ centrarse en los eventos de la Plataforma de filtrado de Windows (WFP) y no en el Firewall de Windows? La respuesta es simple. Seg√∫n nuestra pr√°ctica, los puntos finales en forma de antivirus ya est√°n en los hosts de todos modos. Aunque no est√°n dise√±ados para monitorear los eventos b√°sicos del sistema (por lo que no son adecuados para nuestros prop√≥sitos), sin embargo, en las realidades modernas, siempre incluyen un firewall host. Por esta raz√≥n, para evitar la duplicaci√≥n, el Firewall de Windows generalmente simplemente se cancela. En consecuencia, nadie escribe al coronel ... Sin embargo, el PMA, aunque puede filtrar el tr√°fico, lo usamos solo para monitoreo. Por lo tanto, la duplicaci√≥n est√° ausente.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/59/ba/nq59banogevpo2koyntusv8dtfo.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tabla muestra que si intentamos confiar en los eventos de Windows, entonces el ultrasonido del usuario y el FQDN de los hosts que interact√∫an tendr√°n que ser restaurados por enriquecimiento de eventos. Sin embargo, si lo piensa, es m√°s importante para nosotros saber qu√© proceso ha establecido la conexi√≥n y no qu√© usuario. Por ejemplo, el malware va a su centro de C&amp;C. De todos modos, queremos saber qui√©n inici√≥ el proceso o crear un incidente en base al entendimiento de que el bloc de notas no va a Internet en s√≠ (es decir, en funci√≥n de la informaci√≥n disponible en el evento).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y con FQDN es a√∫n m√°s simple: todos los sistemas modernos incluyen el componente CMDB como una funcionalidad b√°sica o adicional. </font><font style="vertical-align: inherit;">Y si no, definitivamente vale la pena abastecerse de una soluci√≥n de terceros. </font><font style="vertical-align: inherit;">Conocer su infraestructura es la base de la seguridad de la informaci√≥n en general. </font><font style="vertical-align: inherit;">Por lo tanto, la informaci√≥n est√° disponible mediante enriquecimiento o mediante una tarjeta de activos, que permitir√° su uso en correlaci√≥n. </font><font style="vertical-align: inherit;">Lo principal es, si es posible, no olvidar conectar los registros de DHCP para que la informaci√≥n est√© actualizada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los dem√°s campos √∫nicos no son tan significativos, por ejemplo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puertos famosos </font><font style="vertical-align: inherit;">No confiar√≠amos en este campo: no es en vano que haya medios para detectar anomal√≠as en el tr√°fico cuando, por ejemplo, el t√∫nel ssh pasa por el puerto 80 en lugar de HTTP.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direcci√≥n del tr√°fico. </font><font style="vertical-align: inherit;">Conociendo la ID del host (IP o FQDN) y la fuente \ destino de la conexi√≥n, puede calcular f√°cilmente la direcci√≥n.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en este caso, Sysmon gana, pero de manera menos significativa: GUID, FQDN, el usuario proporciona una conveniencia que es bastante posible de lograr utilizando SIEM o soluciones de terceros. </font><font style="vertical-align: inherit;">Sin embargo, peque√±os esfuerzos no significan cero.</font></font><br>
<a name="stage6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proceso de finalizaci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, el evento, como ya se mencion√≥ anteriormente, no se usa con mucha frecuencia, pero ...</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/lq/0e/x0/lq0ex02swhhs39noycfzb1m2wog.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si es necesario, entonces hay una clara victoria del lado de Windows. </font><font style="vertical-align: inherit;">Agregamos solo c√≥mo habilitar el registro y vamos directamente a las conclusiones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de la pol√≠tica de auditor√≠a - Pol√≠ticas de auditor√≠a - Seguimiento detallado - Terminaci√≥n del proceso de auditor√≠a - √âxito</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, la ventaja del registro nativo del sistema operativo se logra mediante:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muestra el usuario que complet√≥ el proceso.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La presencia del c√≥digo de salida, que puede hablar sobre la finalizaci√≥n regular del proceso, as√≠ como los errores.</font></font></li>
</ul><a name="stage7"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descarga de controlador</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este evento de Windows, a diferencia de los otros, est√° habilitado de forma predeterminada y se introduce en el registro del sistema. </font><font style="vertical-align: inherit;">No hay muchos campos informativos en estos eventos.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/a3/hd/4k/a3hd4kpimlddce6uu5az5mzn_dw.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y de nuevo, inmediatamente a las conclusiones.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este grupo, los eventos de Sysmon proporcionan al analista informaci√≥n mucho m√°s √∫til. </font><font style="vertical-align: inherit;">Por ejemplo, seg√∫n los eventos de Windows, ni siquiera est√° claro qu√© archivo de controlador se utiliz√≥. </font><font style="vertical-align: inherit;">Por lo tanto, en este grupo de Windows en personas externas expl√≠citas.</font></font><br>
<a name="stage8"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acceso al proceso</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No clasificar√≠amos este grupo de eventos como b√°sico, sino como un nivel ligeramente avanzado. Desde el punto de vista de la seguridad, el evento puede ser de gran inter√©s. Hay muchas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formas en que un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proceso malicioso puede hacer que su leg√≠timo "mejor". Por supuesto, no por el altruismo, sino por acciones maliciosas. Y los eventos bajo consideraci√≥n solo nos ayudar√°n a descubrir muchas opciones para tal creatividad. Estos registros est√°n habilitados en Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de la pol√≠tica de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Objeto del n√∫cleo de auditor√≠a - √âxito</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/g5/3x/xm/g53xxmsrxfjnuq5dy-hxfatsq2g.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows tiene dos ventajas. En primer lugar, la asignaci√≥n del usuario a partir del cual est√° trabajando el proceso de origen. Como se√±alamos anteriormente, la ventaja suele ser insignificante. Y, en segundo lugar, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HandleID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y derechos de acceso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si el inter√©s en los derechos de acceso es claro, HandleID solo es √∫til para buscar eventos relacionados. Es necesario para organizar la interacci√≥n del usuario a trav√©s de procesos con objetos del sistema operativo: los mismos procesos (sus hilos), archivos, etc. En consecuencia, los eventos adicionales pueden mostrar c√≥mo, como resultado, a qui√©n se emiti√≥ y cu√°ndo se revoc√≥ el identificador requerido para el acceso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al tocar el tema de los objetos y manejarlos por primera vez, as√≠ como registrar acciones con ellos, es importante tener en cuenta dos cosas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, para registrar los pasos adicionales anteriores, es importante habilitar configuraciones de pol√≠ticas de auditor√≠a adicionales, en particular Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de la pol√≠tica de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Manipulaci√≥n del controlador de auditor√≠a - √âxito. Vale la pena recordar que el volumen de estos eventos puede ser muy grande. El mango se emite al recibir una solicitud, respectivamente, refleja los derechos reclamados. Pero, ¬øpor qu√© no podemos esperar el mismo volumen de eventos directamente de la auditor√≠a de acceso a objetos?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto se debe a que, en segundo lugar, es necesario habilitar SACL en el objeto que se planea controlar. De hecho, esta es una lista similar a la lista de derechos de acceso DACL, que determina si el sujeto u objeto creado con su token recibir√° √©xito o falla cuando intente acceder al objeto. Pero la SACL determina aproximadamente la misma forma, no los derechos para interactuar con el objeto, sino si se generar√°n eventos de seguridad al solicitar y ejercer ciertos derechos. Estos eventos incluir√°n los derechos de acceso no solicitados, pero en realidad utilizados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtenemos un filtro que le permite registrar solo el acceso a los objetos que son cr√≠ticos para nosotros y solo aquellos tipos de acceso que son importantes para nosotros. Pero a cambio, debemos adjuntar una SACL directamente a cada objeto o indicar que la SACL se hereda del objeto padre. Por supuesto, esto puede ser automatizado por varios m√©todos. Pero mantener la configuraci√≥n de tales herramientas de automatizaci√≥n es poco probable que sea conveniente. A diferencia de una simple lista de Sysmon, que tambi√©n puede incluir comodines, aunque sean peculiares. Hablaremos sobre el filtrado en Sysmon en una secci√≥n separada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afortunadamente, para los objetos de tipo, ya existe un proceso SACL por defecto para la versi√≥n del n√∫cleo 6.3 y superior. Si alguien puede especificar una forma de recibir este SACL (recomendaciones de este </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no pudimos cumplir), ser√° interesante escuchar / discutir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el lado de Sysmon, adem√°s de los GUID y los nombres de reglas ya discutidos, hay varios campos m√°s interesantes. </font><font style="vertical-align: inherit;">Primero, el PID del proceso objetivo. </font><font style="vertical-align: inherit;">Le permitir√° monitorear la actividad posterior del objeto infectado, porque puede haber varias instancias desde un archivo ejecutable. </font><font style="vertical-align: inherit;">En segundo lugar, el campo CallTrace, que captura las acciones del origen del evento en el destino. </font><font style="vertical-align: inherit;">Mira esto y date cuenta de que "juego de manos y sin fraude" no son solo palabras. </font><font style="vertical-align: inherit;">Por otro lado, un an√°lisis tan detallado ya es el destino de los forenses. </font><font style="vertical-align: inherit;">Y quien tenga un forense dedicado probablemente no est√© al comienzo del camino para construir un sistema de monitoreo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este grupo, los eventos difieren en un n√∫mero bastante grande de campos. </font><font style="vertical-align: inherit;">Pero si en los eventos de Windows esta informaci√≥n probablemente proporciona la conveniencia del an√°lisis inicial, entonces Sysmon captura datos √∫nicos que son dif√≠ciles de obtener de cualquier otra manera. </font><font style="vertical-align: inherit;">Por lo tanto, la ventaja permanece con Sysmon.</font></font><br>
<a name="stage9"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creaci√≥n de archivos</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta categor√≠a se incluye en Windows de la siguiente manera: Configuraci√≥n de la computadora - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de la pol√≠tica de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Sistema de archivos de auditor√≠a - √âxito</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/qp/wy/wuqpwygxyngiqa8db58gvoenmiu.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se puede ver en la tabla, todos los pros y los contras de este grupo son similares a los ya descritos anteriormente. Incluyendo los pros y los contras de SACL (para archivos y carpetas para todos los usuarios (Todos), incluye Propiedades - Seguridad - Avanzado - Auditor√≠a - Agregar - Todos - √âxito - Escribir (para archivos) o Modificar (para un directorio)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n puede configurar SACL en archivos de forma global defini√©ndolo en Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de pol√≠ticas de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Auditor√≠a de acceso a objetos global - Sistema de archivos. Pero el n√∫mero de eventos, especialmente con archivos temporales, aumentar√° en proporci√≥n al volumen de operaciones. No dir√≠a que este es un enfoque efectivo, solo es posible para una peque√±a parte de las operaciones.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Me gustar√≠a se√±alar las rarezas de registro que comienzan aqu√≠. </font><font style="vertical-align: inherit;">Para este grupo no es fijo sucesos de Windows cuando se crea un archivo a trav√©s de Powershell, por ejemplo, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el New-Item el directorio C: \ ForTest \ test.t</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Al mismo tiempo, la misma acci√≥n se muestra perfectamente en los registros de Sysmon.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este grupo de eventos se registra mejor con Sysmon.</font></font><br>
<a name="stage10"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acciones de registro</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta ahora, hablando del grupo, hemos incluido solo un evento en √©l. </font><font style="vertical-align: inherit;">Esta tendencia cambiar√° aqu√≠.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kl/wm/b0/klwmb01kl6o_14omabn-qdhjh-c.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El registro de estos eventos se configura de la siguiente manera: Configuraci√≥n de la computadora - Polcies - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de la pol√≠tica de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Registro de auditor√≠a - √âxito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La SACL para todos los usuarios (Todos) se define de la siguiente manera: regedit.exe - rama de registro - Permisos - Avanzado - Auditor√≠a - Todos - √âxito - Permisos avanzados - Control total o establecer valor, Crear subclave, Crear enlace, Eliminar, Escribir DAC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n puede configurar SACL en archivos de forma global defini√©ndolo en Configuraci√≥n del equipo - Pol√≠ticas - Configuraci√≥n de Windows - Configuraci√≥n de seguridad - Configuraci√≥n avanzada de pol√≠ticas de auditor√≠a - Pol√≠ticas de auditor√≠a - Acceso a objetos - Auditor√≠a de acceso a objetos global - Registro. Los contras del enfoque son similares a las mismas operaciones de archivo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inmediatamente enf√≥quese en las limitaciones. </font><font style="vertical-align: inherit;">Para Sysmon, todas las operaciones (crear, modificar, eliminar) con valor o eventos de aumento de clave (excepto el cambio de nombre del valor). </font><font style="vertical-align: inherit;">Para ventanas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas las operaciones con eventos de aumento de valor. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear una clave no genera eventos. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambiar el nombre de la clave solo genera el evento Access; no se muestra el nuevo nombre de la clave; </font><font style="vertical-align: inherit;">los derechos solicitados especificados en el evento no tienen una correspondencia intuitiva inequ√≠voca con la operaci√≥n. </font><font style="vertical-align: inherit;">Por lo tanto, la operaci√≥n de cambio de nombre solo se puede determinar mediante el m√©todo de excepci√≥n: no hay un evento de eliminaci√≥n 4660 con este HandleID.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La eliminaci√≥n de la clave provoca el evento 4663 seguido de 4660.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s de los campos discutidos en las secciones anteriores, es importante tener en cuenta que los eventos de Windows contienen datos antiguos y nuevos de nombres y valores de clave y valor, que durante la investigaci√≥n pueden ayudar a comprender el motivo del atacante. </font><font style="vertical-align: inherit;">Especialmente si los valores iniciales no son est√°ndar o t√≠picos, y la configuraci√≥n, incluidos los datos de registro de la m√°quina bajo investigaci√≥n, no se almacena en ning√∫n lugar fuera del host.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como podemos ver, existen restricciones m√°s estrictas en el registro de Windows. </font><font style="vertical-align: inherit;">Y para corregir algunos hechos, se necesita una "correlaci√≥n", aunque sea la m√°s simple. </font><font style="vertical-align: inherit;">Sin embargo, puede proporcionar una mayor cantidad de informaci√≥n realmente √∫til. </font><font style="vertical-align: inherit;">Es dif√≠cil dar preferencia a uno de los participantes para este grupo de eventos.</font></font><br>
<a name="stage11"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n de WMI</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasamos al pen√∫ltimo grupo de eventos. Estos son eventos de WMI. Un atacante puede crear un filtro (filtro) que recibe cualquier evento sobre un cambio en el estado del sistema, en nuestro ejemplo, un cambio en el estado de un servicio. Y para llevar a cabo ciertas acciones basadas en los eventos recibidos de este filtro, creando un consumidor. En nuestro caso, esta es una entrada en el archivo de registro. A continuaci√≥n, debe conectar la salida del filtro a la entrada del consumidor, creando un enlace entre el filtro y el consumidor. Resultar√° un sistema que funciona bajo condiciones dadas. A menudo se usa para t√°cticas de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persistencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es precisamente en el orden descrito que se registran los eventos 19-21 Sysmon.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es importante comprender que crear un filtro o consumidor en s√≠ mismo no representa una amenaza, pero, por supuesto, puede ser parte de un ataque. Adem√°s, para actividades maliciosas, se puede utilizar un filtro existente, un consumidor o ambos. Aqu√≠ es como con un cuchillo o, m√°s cerca del tema del recurso, con mensajeros cifrados. La pregunta no est√° en la herramienta, sino en su uso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Echemos un vistazo m√°s de cerca a la mesa.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f9/bo/br/f9bobr7pus2gf7lnaxgoxcirosq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un punto importante que debe tenerse en cuenta en primer lugar: el evento 5861 se genera en el registro especificado solo sobre el hecho de la creaci√≥n o modificaci√≥n posterior (incluso en t√©rminos de filtro y consumidor) del paquete. Esto, por un lado, facilita el seguimiento de actividades supuestamente maliciosas (no se necesita correlaci√≥n entre dos o tres eventos) si no solo se crea un grupo dentro de √©l. Y, por otro lado, perdemos la hora de inicio de esta actividad si el filtro o el consumidor se crean precisamente dentro del marco y con anticipaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øEs esto cr√≠tico? Caso por caso. Si comenzamos a desenrollar la secuencia de un incidente y vemos que se cre√≥ un filtro o consumidor at√≠pico y supuestamente malicioso hace dos a√±os, inmediatamente nos damos cuenta de que los atacantes han estado en casa con nosotros durante m√°s de dos a√±os. Y las huellas del ataque deben buscarse al menos a esta profundidad. ¬øCon qu√© frecuencia ocurre esto? Esta es la pregunta principal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero si se realizan cambios en el filtro o en el consumidor del paquete existente, veremos la imagen completa en un solo evento. Mientras que Sysmon reflejar√° solo aquellos cambios (ese objeto) que se hicieron.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre otras diferencias: en los eventos de Sysmon, los datos se reflejan en una forma m√°s estructurada y en un formato m√°s conveniente. Por ejemplo, en lugar del SID en un formato at√≠pico, el inicio de sesi√≥n del usuario se presenta de inmediato. Pero los datos son un poco menos. Quiz√°s esto es cr√≠tico para su caso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Concluimos con restricciones. En primer lugar, a pesar de que esta revista ha estado presente desde Windows 2012 (kernel 6.2), no pudimos obtener estos eventos incluso para el kernel 6.3 (2012R2), que se estudia en el art√≠culo. Quiz√°s esto se deba a la ausencia de parches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En segundo lugar, seg√∫n el autor de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">art√≠culos, el filtro para eventos de temporizador no est√° arreglado por Sysmon. </font><font style="vertical-align: inherit;">Ser√≠a posible no tomar una palabra, sino verificar. </font><font style="vertical-align: inherit;">Adem√°s, la versi√≥n de Sysmon es antigua. </font><font style="vertical-align: inherit;">Pero aqu√≠ es importante un precedente: no hay algunos tipos de filtros y consumidores de WMI. </font><font style="vertical-align: inherit;">A partir de dicho estudio, complementado con detalles, se podr√≠a hacer un art√≠culo separado. </font><font style="vertical-align: inherit;">Simplemente pruebe los tipos de destino para comprender exactamente lo que se registrar√°n.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este caso, nos sentimos m√°s c√≥modos con el uso de eventos de Windows. </font><font style="vertical-align: inherit;">Desde el punto de vista de la conveniencia: m√°s datos, no hay necesidad de correlaci√≥n primaria. </font><font style="vertical-align: inherit;">Entonces, desde el punto de vista del establecimiento de objetivos, corrige la creaci√≥n de un mecanismo (basado en partes nuevas, modificadas o existentes), y no sus piezas individuales.</font></font><br>
<a name="stage12"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consultas DNS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, pasamos al grupo final que se compara, pero a√∫n lejos de la conclusi√≥n de nuestro art√≠culo. </font><font style="vertical-align: inherit;">Este tipo y el conjunto correspondiente de eventos son recientes no solo por la aparici√≥n en nuestro art√≠culo, sino tambi√©n al agregar Sysmon al kit de herramientas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los √∫ltimos a√±os, el tema del uso de DNS para otros fines, por ejemplo, para recibir comandos de C&amp;C o robar informaci√≥n a trav√©s de este canal, se ha vuelto popular. </font><font style="vertical-align: inherit;">Lo m√°s probable es que no lo haga por s√≠ solo: remitir√≠amos las historias sobre tal uso de los canales ICMP y DNS a cero. </font><font style="vertical-align: inherit;">En ese momento, los estudiantes familiares eran sofisticados en la encapsulaci√≥n del tr√°fico de juguetes para llegar a los codiciados servidores de juegos de la red del instituto a trav√©s de los √∫nicos canales permitidos (hola, Zhenya</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tumbochko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">!). Esto permiti√≥ pasar el tiempo aburrido o dominar r√°pidamente sus laboratorios. Y no fue su idea. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero no hace mucho tiempo, se agreg√≥ un concepto como DoH a este canal de fuga, lo que complic√≥ la detecci√≥n de tr√°fico DNS sospechoso a nivel de red. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tal vez fue solo una estratagema de marketing: vender una nueva, que tambi√©n es una vieja y olvidada. O el inicio de la ocurrencia generalizada de tales canales en actividad maliciosa detectable. No profundizamos en este tema, preparados para recolectar granos; de repente, uno de los lectores decide dejar caer un poco de sabidur√≠a en los comentarios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, m√°s cerca del punto. Active el Visor de eventos - Registros de aplicaciones y servicios - Microsoft - Windows - Eventos de cliente DNS - Operativo - Men√∫ contextual - Habilitar registro.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/oz/9m/4ooz9mm2kjdsagzhnxcymt5_mpq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo lo mismo que ya se discuti√≥. En cuanto a la informaci√≥n sobre el tema, prestamos atenci√≥n a la indicaci√≥n expl√≠cita de la imagen del archivo ejecutable que ejecut√≥ la solicitud en el evento Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si hablamos del objeto, hay mucha m√°s informaci√≥n en los registros de Windows. Pero hay varios "peros" importantes. En primer lugar, la informaci√≥n se distribuye en varios eventos con todas las consecuencias.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En segundo lugar, la informaci√≥n se presenta de forma poco intuitiva. </font><font style="vertical-align: inherit;">Descifrar la mayor parte del conocimiento requiere conocer c√≥mo se forman los campos del paquete y la capacidad de transformar estos datos nuevamente en hechos que faciliten la decisi√≥n del analista. </font><font style="vertical-align: inherit;">Podemos decir que, de hecho, el analista no es en vano obtener un salario y por qu√© no sentarse y resolverlo. </font><font style="vertical-align: inherit;">Si, eso es correcto. </font><font style="vertical-align: inherit;">Pero les recuerdo que estamos hablando de un peque√±o equipo sin especialistas de perfil estrecho, antes del cual las tareas de seguridad de la informaci√≥n no tienen fin. </font><font style="vertical-align: inherit;">Y si por cada evento analizado por SIEM, tal tarea recae sobre √©l, no los alcanzar√° en unos a√±os.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para este grupo, el ganador es dif√≠cil de determinar. </font><font style="vertical-align: inherit;">Sysmon ofrece una versi√≥n lac√≥nica, desde la cual puede exprimir f√°cilmente una buena porci√≥n de informaci√≥n √∫til. </font><font style="vertical-align: inherit;">Windows ofrece una opci√≥n avanzada. </font><font style="vertical-align: inherit;">Queda por "coserlo", lidiar con el contenido y preguntarse si era hora de presentar NTA?</font></font><br>
<a name="stage13"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eventos √∫nicos de Sysmon</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atribuimos lo siguiente a los eventos √∫nicos de Sysmon:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 4, 16. Aunque puede rastrearse a trav√©s de los registros de Windows, solo nos informan sobre los eventos en Sysmon. </font><font style="vertical-align: inherit;">En consecuencia, en su ausencia no tienen sentido.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 2: EID 4663 podr√≠a considerarse como un an√°logo, pero incluso teniendo en cuenta las listas de derechos de acceso proporcionadas en √©l, el evento no es tan granular como EID2, y no est√° enriquecido a ese estado con otros eventos de Windows.</font></font></li>
<li>EID 7-9, 17 ‚Äî   .      ETW.  ,   ,      .</li>
<li>EID 15 ‚Äî   ,    ETW.       ,      ‚Äî .</li>
<li>EID 18 ‚Äî      (named pipes)       . , -,   .  -,      ,        .       ETW.</li>
</ul><a name="stage14"></a><br>
<h1> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay tres opciones para filtrar eventos en el lado de origen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primero est√° disponible solo para eventos de Windows y solo para monitorear el acceso y las operaciones con objetos. Implementado usando SACL. Entre las desventajas de este enfoque est√° la complejidad de la configuraci√≥n granular (por ejemplo, no solo puede monitorear archivos existentes o creados con la extensi√≥n .exe). Entre las ventajas est√° la capacidad de limitar la lista de usuarios para quienes se registran las operaciones con el objeto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo est√° disponible tanto para eventos de Windows como para eventos de Sysmon: usando Xpath, teniendo en cuenta las restricciones impuestas por el gran Microsoft. Dado que el m√©todo est√° disponible para ambas fuentes, la descripci√≥n est√° m√°s all√° del alcance de este art√≠culo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y el tercero es la configuraci√≥n de Sysmon. Hay muchas opciones:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emulaci√≥n de comodines: contiene (any | all), excluye (any | all), termina con, comienza con. </font><font style="vertical-align: inherit;">El uso de contiene | excluye todo le permite emular expresiones como "C: \ Windows \ *. Exe".</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coincidencia exacta - es, no es, imagen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aritm√©tica: menos que, m√°s que.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cabe se√±alar que dicho filtrado no est√° disponible para todos los campos. </font><font style="vertical-align: inherit;">Por ejemplo, no puede incluir en la lista blanca hashes de software est√°ndar, la creaci√≥n de procesos para los que no estamos interesados. </font><font style="vertical-align: inherit;">Un ejemplo de nuestra experiencia: el proceso leg√≠timo git.exe cre√≥ decenas de miles de eventos de inicio por d√≠a en los hosts de nuestros desarrolladores. </font><font style="vertical-align: inherit;">Quiz√°s, espec√≠ficamente en este caso, su comportamiento podr√≠a ser m√°s estricto, reduciendo as√≠ este eje de eventos. </font><font style="vertical-align: inherit;">Pero excluir archivos ejecutables por nombre de imagen no es una buena idea. </font><font style="vertical-align: inherit;">Bueno, tal vez solo un antivirus con autodefensa habilitado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon tambi√©n solo est√° en camino hacia un filtrado sofisticado mediante la combinaci√≥n de condiciones de diferentes campos. </font><font style="vertical-align: inherit;">Puede crear solo un grupo de reglas para cada EID combinado por relaciones AND, y solo uno con relaciones OR. </font><font style="vertical-align: inherit;">En consecuencia, las condiciones de la forma (A y B) o (C y D) ya no se pueden escribir. </font><font style="vertical-align: inherit;">Dependiendo de la corriente filtrada, este hecho puede no dar ninguna ventaja significativa, pero tambi√©n puede dar un resultado tangible.</font></font><br>
<a name="stage15"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otros proveedores de eventos base gratuitos</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta secci√≥n, en primer lugar, me gustar√≠a hablar sobre el mecanismo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ETW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Event Trace for Windows). Los registros de eventos integrados de Windows y Sysmon registran eventos utilizando este mecanismo. De hecho, por cada acci√≥n en el sistema podemos obtener un evento. La forma m√°s f√°cil de ver el volumen potencial de tales eventos es habilitar la opci√≥n Visor de eventos - Ver - Mostrar an√°lisis y depuraci√≥n. Para que los eventos no llenen inmediatamente su sistema, cada registro se activa por separado en su men√∫ contextual. Miras esta bondad e involuntariamente te haces una pregunta: ¬øpor qu√© necesitamos a Sysmon con un volumen de eventos tan diversos?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El hecho es que, en primer lugar, estos registros originalmente estaban destinados a la depuraci√≥n, y no con fines de seguridad. Por lo tanto, no se proporciona su colecci√≥n centralizada. En particular, no encontrar√° el FQDN del host en el que se crearon en ninguna parte. La cuesti√≥n, por supuesto, puede ser resuelta por utilidades de terceros, desde peque√±as a grandes, desde scripts hasta servicios de registro completos. Pero debe recordar que este es un software adicional en una gran empresa y, en consecuencia, una tarea separada. Perm√≠tame recordarle que en la introducci√≥n procedemos del principio del minimalismo en la actividad adicional para instalar software.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en segundo lugar, estos registros informan con tanto detalle sobre cada estornudo que tambi√©n tienen que seleccionar la informaci√≥n poco a poco. Las entradas del diario son verdaderamente at√≥micas y requerir√°n una correlaci√≥n previa o enriquecimiento para que el analista trabaje productivamente. Despu√©s de todo, un programador que depura su creaci√≥n usando estos eventos sabe c√≥mo deber√≠a funcionar todo. Y un guardia de seguridad, especialmente de perfil amplio, piensa en niveles mucho m√°s altos de abstracci√≥n. S√≠, adem√°s, busca actividad ileg√≠tima desconocida. Tal declaraci√≥n del problema conduce a un m√≥dulo de software adicional que llevar√° a cabo el preprocesamiento. Esto nuevamente complicar√° nuestro concepto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si bien no hemos ido muy lejos de iniciar sesi√≥n con Windows, no olvidaremos mencionar WMI. Esta herramienta b√°sicamente captura los cambios de estado sin mostrar su fuente. Como ejemplo de una excepci√≥n, cargar un archivo dll: muestra el m√≥dulo dll y el proceso que lo est√° cargando. Pero por razones de seguridad, este evento tambi√©n requiere enriquecimiento, ya que aqu√≠ es donde se agota su informaci√≥n. En general, la falta de pescado y el c√°ncer son peces. Pero la herramienta solo se puede usar como extra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra opci√≥n popular, pero no cubierta en el art√≠culo, es la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">osquery.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Las dos razones principales por las que no consideramos esta soluci√≥n aqu√≠ son la baja frecuencia de actualizaciones del producto (menos tanto en t√©rminos de seguridad como de funcionalidad) y el mayor uso de los recursos del sistema en comparaci√≥n con otras opciones (se incluye una base de datos completa). </font><font style="vertical-align: inherit;">Presumiblemente, la soluci√≥n es adecuada para servidores para los que fue desarrollada. </font><font style="vertical-align: inherit;">Pero para estaciones de trabajo, posiblemente con hardware obsoleto, apenas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recientemente, han aparecido varias herramientas m√°s que no est√°n tan extendidas como las consideradas. </font><font style="vertical-align: inherit;">Estos incluyen Velociraptor y SilkETW. </font><font style="vertical-align: inherit;">No inventan una bicicleta y tambi√©n funcionan por encima del est√°ndar de Windows: ETW. </font><font style="vertical-align: inherit;">En vista del volumen de material ya citado, se decidi√≥ separar estas herramientas en una publicaci√≥n separada (ya que el tiempo y el esfuerzo est√°n disponibles, as√≠ como un sentido de demanda).</font></font><br>
<a name="stage16"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n general</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el curso de la comparaci√≥n, se demostr√≥ que los eventos de Sysmon que tienen an√°logos generalmente superan a los eventos de Windows en sus caracter√≠sticas funcionales. </font><font style="vertical-align: inherit;">Algunos eventos de Sysmon simplemente no tienen alternativas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, no olvide que, en primer lugar, la soluci√≥n debe elegirse en funci√≥n de sus tareas. </font><font style="vertical-align: inherit;">Si solo est√° construyendo un sistema de monitoreo y en el primer a√±o planea implementar m√©todos para detectar de siete a diez incidentes, como Gartner leg√≥, entonces deber√≠a tener suficientes eventos de Windows. </font><font style="vertical-align: inherit;">Y quiz√°s mucho m√°s de un a√±o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En segundo lugar, el sistema de registro de eventos de Windows tambi√©n se actualiza constantemente, y durante la redacci√≥n de este art√≠culo, aparecieron los EID de Windows como 4798 y 4799. Tambi√©n es posible que el conjunto de campos se complemente. Por lo tanto, esta comparaci√≥n, aunque es la m√°s completa, basada en la informaci√≥n que poseemos, no est√° tallada en piedra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en tercer lugar, Sysmon sigue siendo una herramienta externa, lo que conlleva una serie de riesgos. Por ejemplo, hemos tenido casos en los que el registro de EID individuales se termin√≥ sin declarar un motivo. En este caso, la grabaci√≥n de otros eventos fue como de costumbre. M√°s colegas eminentes afirman que el problema estaba relacionado con p√©rdidas de memoria en la versi√≥n 10.41. Pero la versi√≥n 10.42, en la que este problema se cierra total o parcialmente (con el registro de cambios de Sysmon, todo no est√° tan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detallado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), no resolvi√≥ nuestros problemas en esta direcci√≥n. </font><font style="vertical-align: inherit;">Solo el componente desinstalar-instalar ayuda. </font><font style="vertical-align: inherit;">Toda seguridad y que tengas un buen d√≠a! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias a timur</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zinint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por ayuda en la preparaci√≥n de la publicaci√≥n. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Resulta muy dif√≠cil mantener un registro de cambios normal o agregar nuevas caracter√≠sticas a la descripci√≥n principal, as√≠ como descubrimos (gracias, t√≠o Dim</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shudv</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), un cami√≥n con nishtyaks volc√≥ en nuestra calle hace ya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9 meses</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... Resumen: en Sysmon puedes hacer (A y B) o (C y D), solo shh ...</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es489040/index.html">Contact Center AI: un tercero en conversaci√≥n est√° bien</a></li>
<li><a href="../es489042/index.html">Gran reapertura de la tienda: cargando datos en Android usando corutina</a></li>
<li><a href="../es489044/index.html">F√≠sica del texto. Parte 1. S√≠mbolos</a></li>
<li><a href="../es489046/index.html">Auto-conducci√≥n Monster Truck GAZ66 1/16</a></li>
<li><a href="../es489048/index.html">El registro y el seguimiento de consultas son las mejores pr√°cticas. Informe Yandex</a></li>
<li><a href="../es489058/index.html">Conjuntos de redes neuronales con PyTorch y Sklearn</a></li>
<li><a href="../es489060/index.html">An√°lisis: ¬øcu√°l es la diferencia entre las inversiones de alto riesgo y las de bajo riesgo?</a></li>
<li><a href="../es489062/index.html">Incre√≠ble rendimiento paralelo de Apache Parquet I / O en Python</a></li>
<li><a href="../es489068/index.html">Inmortalidad digital: un enfoque de ingenier√≠a</a></li>
<li><a href="../es489070/index.html">Costar√° 354 pares de calcetines. Una selecci√≥n de regalos para el 23 de febrero.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>