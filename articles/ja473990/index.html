<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📶 🙌 💲 OpenGLを学んでください。レッスン7.2-テキストの描画 ☃️ 🆖 👩🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="グラフィックの冒険のある時点で、OpenGLを介してテキストを出力したい場合があります。予想とは逆に、OpenGLなどの低レベルライブラリでは、画面上に単純な線を表示することは非常に困難です。テキストをレンダリングするために128を超える異なる文字が必要ない場合、それは難しくありません。文字が高さ、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenGLを学んでください。レッスン7.2-テキストの描画</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473990/"><p><img src="https://habrastorage.org/web/c9e/9b2/a3b/c9e9b2a3baf749ab8e2b385c6d93d966.png" alt="画像" align="left" width="300"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフィックの冒険のある時点で、OpenGLを介してテキストを出力したい場合があります。予想とは逆に、OpenGLなどの低レベルライブラリでは、画面上に単純な線を表示することは非常に困難です。テキストをレンダリングするために128を超える異なる文字が必要ない場合、それは難しくありません。文字が高さ、幅、オフセットと一致しないと、問題が発生します。お住まいの地域によっては、128文字以上必要になる場合があります。しかし、特殊文字、数学または音楽の文字が必要な場合はどうでしょうか？テキストの描画が最も簡単な作業ではないことを理解するとすぐに、OpenGLのような低レベルAPIに属してはならない可能性が高いことに気づくでしょう。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGLはテキストをレンダリングする手段を提供しないため、このケースのすべての困難は私たちにあります。</font><font style="vertical-align: inherit;">グラフィックプリミティブ「シンボル」はないので、私たち自身でそれを発明する必要があります。</font><font style="vertical-align: inherit;">すでに用意されている例があります：を介してシンボルを描画する、シンボルの</font></font><code>GL_LINES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3Dモデルを作成する、または3次元空間の平らな四角形にシンボルを描画します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどの場合、開発者は</font><s><font style="vertical-align: inherit;">コーヒー</font></s></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font></s> <s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">飲み</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、最後のオプション</font><s><font style="vertical-align: inherit;">を</font></s><font style="vertical-align: inherit;">選択するのが面倒です。</font><font style="vertical-align: inherit;">これらのテクスチャのある四角形を描画することは、適切なテクスチャを選択するほど難しくありません。</font><font style="vertical-align: inherit;">このチュートリアルでは、いくつかの方法を学び、FreeTypeを使用して高度で柔軟なテキストレンダラーを記述します。</font></font></p><a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></b><div class="spoiler_text"><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1.はじめに</font></font></b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opengl</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウ作成</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちはウィンドウ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは三角形</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェーダー</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクスチャー</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 2.  </b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 3.  3D-</b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Assimp</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   Mesh</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 3D-</a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 4.   OpenGL</b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> GLSL</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 5.  </b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> .  -</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Normal Mapping</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Parallax Mapping</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HDR</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Bloom</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SSAO</a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 6. PBR</b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">IBL.  </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">IBL.  </a></li>
</ol></div></div><br>
<div class="spoiler"><b class="spoiler_title"> 7. </b><div class="spoiler_text"><ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
<li><strong> </strong></li>
</ol></div></div></div></div><br>
<h1 id="klassika-rastrovye-shrifty"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラシック：ラスターフォント</font></font></h1><br>
<p>- <s>  </s>        (  )         ,    (bitmap font).          .    .       ,   .                 .</p><br>
<p><img src="https://habrastorage.org/webt/0q/dd/sm/0qddsmwzcxldp9s0kvohcz2qgea.png"></p><br>
<p>   ,      "OpenGL".         ,    ,       .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>    ,      .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    Codehead</a>.</p><br>
<p>      .     ,     . ,    .    ,     .          .  ,        ,    ,  ,   .</p><br>
<p>       (     ),        .          .    —  TrueType    FreeType.</p><br>
<h1 id="sovremennost-freetype">: FreeType</h1><br>
<p>FreeType — ,   ,         ,   .      Mac OS X, Java, Qt, PlayStation, Linux  Android.   TrueType-     .</p><br>
<p> TrueType —   ,   ,   .     ,           .  TrueType ,           .</p><br>
<p>FreeType    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>.     FreeType ,   precompiled-,     .       <code>freetype.lib</code>  ,   ,    .</p><br>
<p>    :</p><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ft2build.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> FT_FREETYPE_H</span></code></pre><br>
<blockquote> FreeType     (   ,  ,  - ),            .  FreeType -  ( , <code>#include &lt;3rdParty/FreeType/ft2build.h&gt;</code>)     .</blockquote><p>   FreeType?  TrueType             .                 .</p><br>
<p>  ,    FreeType     face ( FreeType  ).      TrueType  <code>arial.ttf</code>,    C:/Windows/Fonts.</p><br>
<pre><code class="cpp hljs">FT_Library ft;
<span class="hljs-keyword">if</span> (FT_Init_FreeType(&amp;ft))
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"ERROR::FREETYPE: Could not init FreeType Library"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;<font></font>
FT_Face face;<font></font>
<span class="hljs-keyword">if</span> (FT_New_Face(ft, <span class="hljs-string">"fonts/arial.ttf"</span>, <span class="hljs-number">0</span>, &amp;face))
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"ERROR::FREETYPE: Failed to load font"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;</code></pre><br>
<p>    FreeType      .</p><br>
<p>    <s> </s> face,      ,    :</p><br>
<pre><code class="cpp hljs">FT_Set_Pixel_Sizes(face, <span class="hljs-number">0</span>, <span class="hljs-number">48</span>);</code></pre><br>
<p>      .    0 ()   FreeType       .</p><br>
<p>Face FreeType   .    -    <code>FT_Load_Char</code>.      <code>X</code>:</p><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (FT_Load_Char(face, <span class="hljs-string">'X'</span>, FT_LOAD_RENDER))
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"ERROR::FREETYTPE: Failed to load Glyph"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;</code></pre><br>
<p> <code>FT_LOAD_RENDER</code>     ,   FreeType   8-     ,      :</p><br>
<pre><code class="cpp hljs">face-&gt;glyph-&gt;bitmap;</code></pre><br>
<p>,    FreeType,   ,       .  ,    FreeType,             .  ,    <code>.</code>      <code>X</code>.    FreeType    ,  ,         .   , ,   FreeType    .</p><br>
<p><img src="https://habrastorage.org/webt/ux/2y/kh/ux2ykhrgznafueqwujrjdqgun9q.png"></p><br>
<p>    baseline (   ).     baseline (<code>X</code>),   (<code>g</code>, <code>p</code>).           baseline,      ,        .    ,    :</p><br>
<ul>
<li><strong>width</strong>:    ,   <code>face-&gt;glyph-&gt;bitmap.width</code></li>
<li><strong>height</strong>:    ,   <code>face-&gt;glyph-&gt;bitmap.rows</code></li>
<li><strong>bearingX</strong>:          origin,   <code>face-&gt;glyph-&gt;bitmap_left</code></li>
<li><strong>bearingY</strong>:          origin,   <code>face-&gt;glyph-&gt;bitmap_top</code></li>
<li><strong>advance</strong>:       1/64     origin,   <code>face-&gt;glyph-&gt;advance.x</code></li>
</ul><br>
<p>    ,        ,      ,          —     .     -      ,    .   ,      <code>std::map</code>:</p><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Character</span> {</span>
    GLuint     TextureID; <span class="hljs-comment">// ID  </span>
    glm::ivec2 Size;      <span class="hljs-comment">//  </span>
    glm::ivec2 Bearing;   <span class="hljs-comment">//     </span>
    GLuint     Advance;   <span class="hljs-comment">//      </span><font></font>
};<font></font>
<font></font>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">map</span>&lt;GLchar, Character&gt; Characters;</code></pre><br>
<p>            128 .              <code>Character</code>,     <code>Characters</code>  <code>std::map</code>.  ,  ,        .</p><br>
<pre><code class="cpp hljs">glPixelStorei(GL_UNPACK_ALIGNMENT, <span class="hljs-number">1</span>); <span class="hljs-comment">// Disable byte-alignment restriction</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> (GLubyte c = <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">128</span>; c++)<font></font>
{<font></font>
    <span class="hljs-comment">// Load character glyph</span>
    <span class="hljs-keyword">if</span> (FT_Load_Char(face, c, FT_LOAD_RENDER))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"ERROR::FREETYTPE: Failed to load Glyph"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">continue</span>;<font></font>
    }<font></font>
    <span class="hljs-comment">// Generate texture</span><font></font>
    GLuint texture;<font></font>
    glGenTextures(<span class="hljs-number">1</span>, &amp;texture);<font></font>
    glBindTexture(GL_TEXTURE_2D, texture);<font></font>
    glTexImage2D(<font></font>
        GL_TEXTURE_2D,<font></font>
        <span class="hljs-number">0</span>,<font></font>
        GL_RED,<font></font>
        face-&gt;glyph-&gt;bitmap.width,<font></font>
        face-&gt;glyph-&gt;bitmap.rows,<font></font>
        <span class="hljs-number">0</span>,<font></font>
        GL_RED,<font></font>
        GL_UNSIGNED_BYTE,<font></font>
        face-&gt;glyph-&gt;bitmap.buffer<font></font>
    );<font></font>
    <span class="hljs-comment">// Set texture options</span><font></font>
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);<font></font>
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);<font></font>
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);<font></font>
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);<font></font>
    <span class="hljs-comment">// Now store character for later use</span><font></font>
    Character character = {<font></font>
        texture,<font></font>
        glm::ivec2(face-&gt;glyph-&gt;bitmap.width, face-&gt;glyph-&gt;bitmap.rows),<font></font>
        glm::ivec2(face-&gt;glyph-&gt;bitmap_left, face-&gt;glyph-&gt;bitmap_top),<font></font>
        face-&gt;glyph-&gt;advance.x<font></font>
    };<font></font>
    Characters.insert(<span class="hljs-built_in">std</span>::pair&lt;GLchar, Character&gt;(c, character));
    <span class="hljs-comment">// Characters[c] = character;</span>
}</code></pre><br>
<p>       128   ,  ,      .  ,    <code>GL_RED</code>    <code>internalFormat</code>  <code>format</code> . ,    — 8-    ,     1 .             .    ,        .    1     ,      OpenGL:</p><br>
<pre><code class="cpp hljs">glPixelStorei(GL_UNPACK_ALIGNMENT, <span class="hljs-number">1</span>);</code></pre><br>
<p>OpenGL ,     4- , ..      4  ( 8 , 4000 , 2048 ) ()    4    (    RGBA),     1   ,     .    (unpack alignment,   ?)  1    ,    segfault'.</p><br>
<p>,       ,    FreeType:</p><br>
<pre><code class="cpp hljs">FT_Done_Face(face);   <span class="hljs-comment">//     face</span>
FT_Done_FreeType(ft); <span class="hljs-comment">//   FreeType</span></code></pre><br>
<h4 id="sheydery"></h4><br>
<p>  ,    :</p><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#version 330 core</span>
layout (location = <span class="hljs-number">0</span>) in vec4 vertex; <span class="hljs-comment">// &lt;vec2 pos, vec2 tex_coord&gt;</span><font></font>
out vec2 TexCoords;<font></font>
<font></font>
uniform mat4 projection;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    gl_Position = projection * vec4(vertex.xy, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>);<font></font>
    TexCoords = vertex.zw;<font></font>
}</code></pre><br>
<p>         <code>vec4</code>.              :</p><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#version 330 core</span><font></font>
in vec2 TexCoords;<font></font>
out vec4 color;<font></font>
<font></font>
uniform sampler2D text;<font></font>
uniform vec3 textColor;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    vec4 sampled = vec4(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, texture(text, TexCoords).r);<font></font>
    color = vec4(textColor, <span class="hljs-number">1.0</span>) * sampled;<font></font>
}</code></pre><br>
<p>   2   —       .       .        ,    <code>r</code>-   .                .     RGB    <code>textColor</code>,    .</p><br>
<p>    ,   :</p><br>
<pre><code class="cpp hljs">glEnable(GL_BLEND);<font></font>
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);</code></pre><br>
<p>         .                        ,     :</p><br>
<pre><code class="cpp hljs">glm::mat4 projection = glm::ortho(<span class="hljs-number">0.0f</span>, <span class="hljs-number">800.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">600.0f</span>);</code></pre><br>
<p>     <code>0.0f</code>,  —   .    <code>y</code>      (<code>y = 0</code>)    (<code>y = 600</code>).  ,   <code>(0, 0)</code>      .</p><br>
<p>   VBO  VAO   .       VBO ,         .</p><br>
<pre><code class="cpp hljs">GLuint VAO, VBO;<font></font>
glGenVertexArrays(<span class="hljs-number">1</span>, &amp;VAO);<font></font>
glGenBuffers(<span class="hljs-number">1</span>, &amp;VBO);<font></font>
glBindVertexArray(VAO);<font></font>
glBindBuffer(GL_ARRAY_BUFFER, VBO);<font></font>
glBufferData(GL_ARRAY_BUFFER, <span class="hljs-keyword">sizeof</span>(GLfloat) * <span class="hljs-number">6</span> * <span class="hljs-number">4</span>, <span class="hljs-literal">NULL</span>, GL_DYNAMIC_DRAW);<font></font>
glEnableVertexAttribArray(<span class="hljs-number">0</span>);<font></font>
glVertexAttribPointer(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, GL_FLOAT, GL_FALSE, <span class="hljs-number">4</span> * <span class="hljs-keyword">sizeof</span>(GLfloat), <span class="hljs-number">0</span>);<font></font>
glBindBuffer(GL_ARRAY_BUFFER, <span class="hljs-number">0</span>);<font></font>
glBindVertexArray(<span class="hljs-number">0</span>);</code></pre><br>
<p>   6   4    ,     <code>6 * 4 = 24</code> float' .        ,      <code>GL_DYNAMIC_DRAW</code>.</p><br>
<h4 id="vyvod-stroki-teksta-na-ekran">    </h4><br>
<p>   ,      <code>Character</code>       .      " "    6        <code>glBufferSubData</code>.</p><br>
<p>    <code>RenderText</code>,     :</p><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RenderText</span><span class="hljs-params">(Shader &amp;s, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> text, GLfloat x, GLfloat y, GLfloat scale, glm::vec3 color)</span>
</span>{
    <span class="hljs-comment">// Activate corresponding render state</span><font></font>
    s.Use();<font></font>
    glUniform3f(glGetUniformLocation(s.Program, <span class="hljs-string">"textColor"</span>), color.x, color.y, color.z);<font></font>
    glActiveTexture(GL_TEXTURE0);<font></font>
    glBindVertexArray(VAO);<font></font>
<font></font>
    <span class="hljs-comment">// Iterate through all characters</span>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::const_iterator c;
    <span class="hljs-keyword">for</span> (c = text.begin(); c != text.end(); c++)<font></font>
    {<font></font>
        Character ch = Characters[*c];<font></font>
<font></font>
        GLfloat xpos = x + ch.Bearing.x * scale;<font></font>
        GLfloat ypos = y - (ch.Size.y - ch.Bearing.y) * scale;<font></font>
<font></font>
        GLfloat w = ch.Size.x * scale;<font></font>
        GLfloat h = ch.Size.y * scale;<font></font>
        <span class="hljs-comment">// Update VBO for each character</span>
        GLfloat vertices[<span class="hljs-number">6</span>][<span class="hljs-number">4</span>] = {<font></font>
            { xpos, ypos + h, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span> },<font></font>
            { xpos, ypos, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span> },<font></font>
            { xpos + w, ypos, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span> },<font></font>
            { xpos, ypos + h, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span> },<font></font>
            { xpos + w, ypos, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span> },<font></font>
            { xpos + w, ypos + h, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span> }<font></font>
        };<font></font>
        <span class="hljs-comment">// Render glyph texture over quad</span><font></font>
        glBindTexture(GL_TEXTURE_2D, ch.textureID);<font></font>
        <span class="hljs-comment">// Update content of VBO memory</span><font></font>
        glBindBuffer(GL_ARRAY_BUFFER, VBO);<font></font>
        glBufferSubData(GL_ARRAY_BUFFER, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vertices), vertices);<font></font>
        glBindBuffer(GL_ARRAY_BUFFER, <span class="hljs-number">0</span>);
        <span class="hljs-comment">// Render quad</span>
        glDrawArrays(GL_TRIANGLES, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);
        <span class="hljs-comment">// Now advance cursors for next glyph (note that advance is number of 1/64 pixels)</span>
        x += (ch.Advance &gt;&gt; <span class="hljs-number">6</span>) * scale; <span class="hljs-comment">// Bitshift by 6 to get value in pixels (2^6 = 64)</span><font></font>
    }<font></font>
    glBindVertexArray(<span class="hljs-number">0</span>);<font></font>
    glBindTexture(GL_TEXTURE_2D, <span class="hljs-number">0</span>);<font></font>
}</code></pre><br>
<p>   :  origin,    . ,       <code>scale</code>.    VBO   .</p><br>
<p>     :</p><br>
<pre><code class="cpp hljs">GLfloat ypos = y - (ch.Size.y - ch.Bearing.y);</code></pre><br>
<p> ,   <code>p</code>  <code>g</code>,    baseline, ,       <code>y</code>  <code>RenderText</code>.   <code>y_offset</code>     :</p><br>
<p><img src="https://habrastorage.org/webt/2m/kp/g2/2mkpg2lb3jrfhl-zt9elefuopek.png"></p><br>
<p>  ,   <s> </s>  ,      baseline.     . ,  <code>y_offset = bearingY - height</code>  <code>ypos = y + y_offset</code>.</p><br>
<p>   ,      :</p><br>
<pre><code class="cpp hljs">RenderText(shader, <span class="hljs-string">"This is sample text"</span>, <span class="hljs-number">25.0f</span>, <span class="hljs-number">25.0f</span>, <span class="hljs-number">1.0f</span>, glm::vec3(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8f</span>, <span class="hljs-number">0.2f</span>));<font></font>
RenderText(shader, <span class="hljs-string">"(C) LearnOpenGL.com"</span>, <span class="hljs-number">540.0f</span>, <span class="hljs-number">570.0f</span>, <span class="hljs-number">0.5f</span>, glm::vec3(<span class="hljs-number">0.3</span>, <span class="hljs-number">0.7f</span>, <span class="hljs-number">0.9f</span>));</code></pre><br>
<p>   :</p><br>
<p><img src="https://habrastorage.org/webt/dq/xs/uf/dqxsufeshmfga1wyzr1dl8amjes.png"></p><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> (    ).</p><br>
<p> ,   ,  :</p><br>
<p><img src="https://habrastorage.org/webt/up/uc/fh/upucfh3hztm2du_zx7uc2wtiaby.png"></p><br>
<p>   ,       baseline,   ,   <code>(</code>  <code>p</code>,  .</p><br>
<h1 id="chto-zhe-dalee">  ?</h1><br>
<p>  ,    TrueType    FreeType.   ,       . ,         ,      .    ,        .   —      : " "     ,    FreeType.        ,     ,  .</p><br>
<p>  FreeType    :   , ,                 . Valve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://web.archive.org/web/20120815035559/"></a> (  )        signed distance fields.           3D-.</p><br>
<p><strong>P.S.</strong>:    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-</a>   .       ,   !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja473976/index.html">AWS Elasticsearch：根本的に欠陥のある製品</a></li>
<li><a href="../ja473978/index.html">そのような痛み、そのような痛み、サービスとしてのレジ2：0</a></li>
<li><a href="../ja473982/index.html">NB-IoT：それはどのように機能しますか？パート3：SCEF-オペレーターサービスへの単一のアクセスウィンドウ</a></li>
<li><a href="../ja473984/index.html">データサイエンスダイジェスト（2019年10月）</a></li>
<li><a href="../ja473986/index.html">「私の夢は、木々の間から人を見ることです」-現代の検索技術に関する「Lisa Alert」の創設者</a></li>
<li><a href="../ja473992/index.html">産業オートメーションシステムの最新プロトコルの概要</a></li>
<li><a href="../ja473994/index.html">最新のスクリプトの読み込み</a></li>
<li><a href="../ja473998/index.html">オランダ、またはあちらこちら</a></li>
<li><a href="../ja474000/index.html">IQBX-クラブやDIY愛好家のための電気機械デザイナー[コンセプト]</a></li>
<li><a href="../ja474004/index.html">ノリリスクからリヤドへ：キングストンの工業用温度microSD UHS-Iメモリカードの実際の事例</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>