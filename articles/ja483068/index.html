<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â±ï¸ ğŸ‘‘ ğŸ¤³ğŸ¼ äººæ°—ã®ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆBattlEyeã®ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚° â˜˜ï¸ ğŸ€ â©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BattlEyeã¯ã€ä¸»ã«32æ­³ã®Bastian Heiko SuterãŒé–‹ç™ºã—ãŸãƒ‰ã‚¤ãƒ„ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£è£½ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆã§ã™ã€‚ã“ã‚Œã¯ã€ã‚²ãƒ¼ãƒ ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã«ã€ä¸€èˆ¬çš„ãªä¿è­·ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ä½¿ã„ã‚„ã™ã„ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’æä¾›ã™ã‚‹ï¼ˆã¾ãŸã¯æä¾›ã—ã‚ˆã†ã¨ã™ã‚‹ï¼‰ã ã‘ã§ãªãã€ç‰¹å®šã®ã‚²ãƒ¼ãƒ ã®ãƒãƒ¼ãƒˆæ¤œå‡ºã‚’ä½¿ç”¨ã—ã¦ã‚»...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>äººæ°—ã®ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆBattlEyeã®ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483068/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ps/ae/ij/psaeijpcayldgrqiqeiq6l83nue.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€ä¸»ã«32æ­³ã®</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bastian Heiko SuterãŒ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é–‹ç™ºã—ãŸãƒ‰ã‚¤ãƒ„ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£è£½ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆ</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã‚²ãƒ¼ãƒ ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ¼ã«ã€ä¸€èˆ¬çš„ãªä¿è­·ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ä½¿ç”¨ã™ã‚‹ä½¿ã„ã‚„ã™ã„ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’æä¾›ã™ã‚‹ï¼ˆã¾ãŸã¯æä¾›ã—ã‚ˆã†ã¨ã™ã‚‹ï¼‰ã ã‘ã§ãªãã€ç‰¹å®šã®ã‚²ãƒ¼ãƒ ã®ãƒãƒ¼ãƒˆæ¤œå‡ºã‚’ä½¿ç”¨ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’æœ€é©åŒ–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">è£½å“ã®Webã‚µã‚¤ãƒˆã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€å¸¸ã«æœ€æ–°ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®æœ€ä¸Šä½ã«ã‚ã‚Šã€é©æ–°çš„ãªä¿è­·ã¨æ¤œå‡ºã®æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ˜ã‚‰ã‹ã«ã€ã“ã‚Œã¯çµæœã¨ã—ã¦é–‹ç™ºè€…ã®å›½ç±ã§ã™</font></font><code>QUALITY MADE IN GERMANY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">BattlEyeã¯ã€è£½å“ã®ä½¿ç”¨æ–™é‡‘ã‚’æ”¯æ‰•ã£ãŸã‚²ãƒ¼ãƒ å†…ã®è©æ¬ºå¸«ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«é€£æºã™ã‚‹å¤šãã®è¦ç´ ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">4ã¤ã®ä¸»è¦ãªè¦ç´ ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEService</font></font><ul>
<li>  Windows,     BattlEye <em>BEServer</em>,    -   <em>BEDaisy</em>  <em>BEClient</em>.</li>
</ul></li>
<li>BEDaisy<ul>
<li>  Windows,       -,       </li>
</ul></li>
<li>BEClient<ul>
<li>   Windows,     ,        .       .</li>
</ul></li>
<li>BEServer<ul>
<li> -,          .</li>
</ul></li>
</ul><br>
<h1>-</h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€è¿‘ã€BattlEyeã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ãƒ€ãƒ³ãƒ—ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã—ã€ç§ãŸã¡ã¯ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®BattlEyeãŒæ­£ç¢ºã«ä½•ã‚’æ¢ã—ã¦ã„ã‚‹ã‹ã«ã¤ã„ã¦æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ç§ãŸã¡ã¯6ã‹æœˆé–“BattlEyeã‚’åˆ†æã—ãªã‹ã£ãŸãŸã‚ã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®æœ€å¾Œã®ãƒ€ãƒ³ãƒ—ã¯ãŠãã‚‰ãå¤ããªã£ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">BattlEyeãŒã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’å®Œäº†ã—ã€ä»¥å‰ã®æ¤œå‡ºæ‰‹é †ã‚’å‰Šé™¤ã—ãªã‹ã£ãŸã¨ä»®å®šã™ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã®ã•ã¾ã–ã¾ãªéƒ¨åˆ†ãŒã“ã®æœ€å¾Œã®ãƒ€ãƒ³ãƒ—ã‹ã‚‰ãƒ¡ãƒ¢ãƒªã‹ã‚‰ã®ã¿å›å¾©ã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã©ã†ã‚„ã£ã¦ï¼Ÿ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰BEServiceã¨å‘¼ã°ã‚Œã‚‹Windowsã‚µãƒ¼ãƒ“ã‚¹ã«ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é…ä¿¡ã—ã¦ã„ã‚‹ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ã‚²ãƒ¼ãƒ å†…ã«ã‚ã‚‹BEClientãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨é€šä¿¡ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿äº¤æ›ã¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é€šã˜ã¦å®Ÿè¡Œã•ã‚Œã¾ã™</font></font><code>\.namedpipeBattleye</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦2018å¹´ã¾ã§ã¯æš—å·åŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚é€ä¿¡ã•ã‚ŒãŸã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€éå¸¸ã«å°ã•ãªã‚­ãƒ¼ã‚’å‚™ãˆãŸxor-encryptorã§æš—å·åŒ–ã•ã‚Œã‚‹ãŸã‚ã€ã‚ˆãçŸ¥ã‚‰ã‚ŒãŸå¹³æ–‡æ”»æ’ƒã‚’éå¸¸ã«ç°¡å˜ã«å®Ÿè¡Œã§ãã¾ã™ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡ã•ã‚Œã‚‹ã¨ã€æ—¢çŸ¥ã®ã™ã¹ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å¤–å´ã«é…ç½®ã•ã‚Œã¦å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ç°¡å˜ã«åˆ¤åˆ¥ã§ãã¾ã™ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãƒ€ãƒ³ãƒ—ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€CreateFileã€ReadFileãªã©ã®æ¨™æº–ã®Windows APIé–¢æ•°ã‚’å‡¦ç†ã—ã€ã™ã¹ã¦ã®æ—¢çŸ¥ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å¤–å´ã«ã‚ã‚‹ã™ã¹ã¦ã®å‘¼ã³å‡ºã—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆè¿”ã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ¡ãƒ¢ãƒªæƒ…å ±ã‚’è¦æ±‚ï¼‰ã®å¯¾å¿œã™ã‚‹ãƒ¡ãƒ¢ãƒªé ˜åŸŸã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã‹ã€ã¾ãŸã¯ã‚²ãƒ¼ãƒ ã®ä»®æƒ³ãƒ¡ãƒ¢ãƒªç©ºâ€‹â€‹é–“ã‚’å®šæœŸçš„ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã€æ—¢çŸ¥ã®ã™ã¹ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å¤–éƒ¨ã«ã‚ã‚‹å®Ÿè¡Œå¯èƒ½ãƒ¡ãƒ¢ãƒªã‚’æ¢ã—ã€ãƒ‡ã‚£ã‚¹ã‚¯ã«ãƒ€ãƒ³ãƒ—ã—ã¾ã™ã€‚ã‚ãªãŸã¯è¿½è·¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™çµæœãŒåŒä¸€ã®ãƒ€ãƒ³ãƒ—ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã€ã©ã®é ˜åŸŸãŒã™ã§ã«ãƒ€ãƒ³ãƒ—ã•ã‚Œã¦ã„ã‚‹ã‹ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èª¬æ˜</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜äº‹ã§ç´¹ä»‹ã—ãŸæ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ã®æ–­ç‰‡ãŒã•ã‚Œã¦ã„ã‚‹</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼·åŠ›</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªç¾ã—ã•ã®ãŸã‚ã«ä¿®æ­£ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">BattlEyeã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ãƒ³ãƒ—ã—ã¦ã™ãã«ã“ã‚Œã‚‰ã®éƒ¨åˆ†ã‚’èªè­˜ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã«ã¯é–¢æ•°å‘¼ã³å‡ºã—ãŒå«ã¾ã‚Œã¦ãŠã‚‰ãšã€è¨˜äº‹ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å¤šããŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€å®Ÿéš›ã«ã¯ã“ã‚Œã¯é‡è¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®æã‚ã—ã„å¤ä»£ã«ã¤ã„ã¦èª­ã¿çµ‚ãˆâ€‹â€‹ãŸã‚‰ã€ãã‚Œã‚’å›é¿ã™ã‚‹æ©Ÿä¼šãŒã‚ã‚‹ã§ã—ã‚‡ã†ï¼ˆï¼š</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¢ãƒªã®ä¸¦ã¹æ›¿ãˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ³ãƒ</font><font style="vertical-align: inherit;">ãƒãƒ¼ãƒˆ</font><font style="vertical-align: inherit;">ã§æœ€ã‚‚ä¸€èˆ¬çš„ãªæ¤œå‡ºãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¢çŸ¥ã®</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ¼ãƒˆã‚¤ãƒ¡ãƒ¼ã‚¸</font><font style="vertical-align: inherit;">ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã®ãƒ¡ãƒ¢ãƒªã®åˆ—æŒ™ã¨ãƒ¡ãƒ¢ãƒªã‚¹ã‚­ãƒ£ãƒ³</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">å®Ÿè£…ã¯ç°¡å˜ã§ã€éå»ã«ç¤ºã—ãŸã‚ˆã†ã«ã€é©åˆ‡ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã®åŸºæœ¬ã‚’å¿˜ã‚Œãšã«ã€å…±é€šæ©Ÿèƒ½ã®ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã‚’ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆã«è¼‰ã›ã¦ã„ã‚Œã°ã€éå¸¸ã«åŠ¹æœçš„ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Battleyeã¯ã€ã‚²ãƒ¼ãƒ ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆã“ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ç¾åœ¨ã®ãƒ—ãƒ­ã‚»ã‚¹ï¼‰ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“å…¨ä½“ã‚’åå¾©å‡¦ç†ã—ã€ãƒšãƒ¼ã‚¸ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãŒå¯¾å¿œã™ã‚‹ãƒ¡ãƒ¢ãƒªç©ºé–“ã®å¤–ã«ã‚ã‚‹ã‹ã©ã†ã‹ã«ã¤ã„ã¦ã•ã¾ã–ã¾ãªãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Battleyeã§ã®å®Ÿè£…æ–¹æ³•ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// MEMORY ENUMERATION</span>
<span class="hljs-keyword">for</span> (current_address = <span class="hljs-number">0</span>
    <span class="hljs-comment">// QUERY MEMORY_BASIC_INFORMATION</span>
    NtQueryVirtualMemory(GetCurrentProcess(), current_address, <span class="hljs-number">0</span>, &amp;memory_information, <span class="hljs-number">0x30</span>, &amp;return_length) &gt;= <span class="hljs-number">0</span> <font></font>
    current_address = memory_information.base_address + memory_information.region_size) <font></font>
{<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> outside_of_shellcode = <font></font>
        memory_information.base_address &gt; shellcode_entry || <font></font>
        memory_information.base_address + memory_information.region_size &lt;= shellcode_entry<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> executable_memory = <font></font>
        memory_information.state == MEM_COMMIT &amp;&amp;<font></font>
        (memory_information.protect == PAGE_EXECUTE ||<font></font>
        memory_information.protect == PAGE_EXECUTE_READ ||<font></font>
        memory_information.protect == PAGE_EXECUTE_READWRITE<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> unknown_whitelist = <font></font>
        memory_information.protect != PAGE_EXECUTE_READWRITE || <font></font>
        memory_information.region_size != <span class="hljs-number">100000000</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!executable_memory || !outside_of_shellcode || !unknown_whitelist)
        <span class="hljs-keyword">continue</span><font></font>
<font></font>
    <span class="hljs-comment">// RUN CHECKS</span><font></font>
    memory::anomaly_check(memory_information<font></font>
<font></font>
    memory::pattern_check(current_address, memory_information<font></font>
<font></font>
    memory::module_specific_check_microsoft(memory_information<font></font>
<font></font>
    memory::guard_check(current_address, memory_information<font></font>
<font></font>
    memory::module_specific_check_unknown(memory_information<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨˜æ†¶ç•°å¸¸</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¹ãƒšãƒ¼ã‚¹å†…ã®ã™ã¹ã¦ã®ç•°å¸¸ã€ä¸»ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã«å¯¾å¿œã—ãªã„å®Ÿè¡Œå¯èƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ¡ãƒ¢ãƒªã‚’ãƒãƒ¼ã‚¯ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">memory::anomaly_check</span><span class="hljs-params">(MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-comment">// REPORT ANY EXECUTABLE PAGE OUTSIDE OF KNOWN MODULES</span>
    <span class="hljs-keyword">if</span> (memory_information.type == MEM_PRIVATE || memory_information.type == MEM_MAPPED) <font></font>
    {<font></font>
        <span class="hljs-keyword">if</span> ((memory_information.base_address &amp; <span class="hljs-number">0xFF0000000000</span>) != <span class="hljs-number">0x7F0000000000</span> &amp;&amp; <span class="hljs-comment">// UPPER EQUALS 0x7F</span>
            (memory_information.base_address &amp; <span class="hljs-number">0xFFF000000000</span>) != <span class="hljs-number">0x7F000000000</span> &amp;&amp;  <span class="hljs-comment">// UPPER EQUALS 0x7F0</span>
            (memory_information.base_address &amp; <span class="hljs-number">0xFFFFF0000000</span>) != <span class="hljs-number">0x70000000</span> &amp;&amp; <span class="hljs-comment">// UPPER EQUALS 0x70000</span>
            memory_information.base_address != <span class="hljs-number">0x3E0000</span>))<font></font>
        {<font></font>
            memory_report.unknown = <span class="hljs-number">0</span>
            memory_report.report_id = <span class="hljs-number">0x2F</span><font></font>
            memory_report.base_address = memory_information.base_address<font></font>
            memory_report.region_size = memory_information.region_size<font></font>
            memory_report.memory_info = <font></font>
                memory_information.type | <font></font>
                memory_information.protect | <font></font>
                memory_information.state<font></font>
            <font></font>
            battleye::report(&amp;memory_report, <span class="hljs-keyword">sizeof</span>(memory_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚¹ã‚­ãƒ£ãƒ³</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚ˆã†ã«ã€BattlEyeã¯ã€ä»¥ä¸‹ã«ç¤ºã™å®Ÿè£…ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã•ã¾ã–ã¾ãªæ˜ç¢ºã«å®šç¾©ã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­˜åœ¨ã«ã¤ã„ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¡ãƒ¢ãƒªã‚‚ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã‚‹å ´åˆ</font><font style="vertical-align: inherit;">ã€æ—¢çŸ¥ã®ç”»åƒã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œç´¢ã—ã¦ã‚¹ã‚­ãƒ£ãƒ³ã—ãªã„ãŸã‚ã€èª­ã¿è¾¼ã¾ã‚ŒãŸå„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚³ãƒ¼ãƒ‰é ˜åŸŸã‚’æ›¸ãæ›ãˆã‚‹</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã¨ã«ã‚ˆã‚Š</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font><strong><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®ãƒã‚§ãƒƒã‚¯ã‚’å›é¿ã§ãã‚‹ã¨</font></strong><font style="vertical-align: inherit;">æ¨æ¸¬</font><strong><font style="vertical-align: inherit;">ã§ãã¾ã™</font></strong><font style="vertical-align: inherit;">ã€‚å®Œå…¨æ€§ãƒã‚§ãƒƒã‚¯ã«</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é™¥ã‚‰</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªã„ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€ãƒ‘ãƒƒã‚«ãƒ¼ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ãªã„ã¨å®Œå…¨æ€§ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã§ããªã„ãŸã‚</font><font style="vertical-align: inherit;">ã€ãƒ‘ãƒƒã‚¯ãŠã‚ˆã³ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«ç™»éŒ²ã•ã‚ŒãŸã™ã¹ã¦ã®é ˜åŸŸã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€</font><em><font style="vertical-align: inherit;">RWX</font></em><font style="vertical-align: inherit;">ã¨ã—ã¦ãƒãƒ¼ã‚¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰é ˜åŸŸã‚’æ›¸ãç›´ã™å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚ BattlEyeã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ¡ãƒ¢ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">[<span class="hljs-number">05</span> <span class="hljs-number">18</span>] ojectsPUBGChinese<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">17</span>] BattleGroundsPrivate_CheatESP<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">17</span>] [%<span class="hljs-number">.0</span>fm] %s<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">3</span>E] <span class="hljs-number">0000</span>Neck0000Chest0000000Mouse <span class="hljs-number">10</span>
[<span class="hljs-number">05</span> <span class="hljs-number">3F</span>] PlayerESPColor<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">40</span>]  Aimbot: %d02D3E2041<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">36</span>] HackMachine<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">4</span>A] VisualHacks.net<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">50</span>] <span class="hljs-number">3E232</span>F653E31314E4E563D4276282A3A2E463F757523286752552E6F30584748<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">4F</span>] DLLInjection-master\x64\Release\<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">52</span>] NameESP<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">48</span>] Skullhack<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">55</span>] .rdata$zzzdbg<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">39</span>] AimBot<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">39</span>] EB4941803C123F755C623FEB388D41D0FBEC93C977583E930EB683E1DF<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">5F</span>] <span class="hljs-number">55E9</span>
[<span class="hljs-number">05</span> <span class="hljs-number">5F</span>] <span class="hljs-number">57E9</span>
[<span class="hljs-number">05</span> <span class="hljs-number">5F</span>] <span class="hljs-number">60E9</span>
[<span class="hljs-number">05</span> <span class="hljs-number">68</span>] D3D11Present initialised<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">6</span>E] [ %<span class="hljs-number">.0</span>fM ]<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">74</span>] [hp:%d]%dm<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">36</span>] <span class="hljs-number">48836424380488</span>D4C2458488B5424504C8BC848894C24304C8BC7488D4C2460<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">36</span>] <span class="hljs-number">741F</span>BA80000FF15607E0085C07510F2F1087801008B8788100EB<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">36</span>] <span class="hljs-number">40F</span>2AA156F8D2894E9AB4489535D34F9CPOSITION0000COL<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">7</span>A] FFE090<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">79</span>] %s00%d00POSITION0000COLOR0000000<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">36</span>] <span class="hljs-number">8E85765</span>DCDDA452E75BA12B4C7B94872116DB948A1DAA6B948A7676BB948902C<font></font>
[<span class="hljs-number">05</span> <span class="hljs-number">8</span>A] n&lt;assembly xmlsn=<span class="hljs-string">'urn:schemas-mi</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®ãƒ¡ãƒ¢ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¯ã€2ãƒã‚¤ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã€ã¤ã¾ã‚Šä¸æ˜ãªé™çš„å€¤</font></font><code>05</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ä¸€æ„ã®è­˜åˆ¥å­</font><font style="vertical-align: inherit;">ã‚‚å«ã¾ã‚Œã¦ã„</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã“ã¨BattlEyeã¯ã€å‹•çš„ã‹ã‚‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã™ã‚‹ã“ã¨ã§</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEServer</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã«é€ä¿¡ã—</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEClient</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ç§ãŸã¡ã¯è¨˜äº‹ã§ã“ã‚Œã‚’èª¬æ˜ã—ã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã£ã¦ç¹°ã‚Šè¿”ã—ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">memory::pattern_check</span><span class="hljs-params">(<span class="hljs-keyword">void</span>* current_address, MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> is_user32 = memory_information.allocation_base == GetModuleHandleA(<span class="hljs-string">"user32.dll"</span><font></font>
    <font></font>
    <span class="hljs-comment">// ONLY SCAN PRIVATE MEMORY AND USER32 CODE SECTION</span>
    <span class="hljs-keyword">if</span> (memory_information.type != MEM_PRIVATE &amp;&amp; !is_user32) 
        <span class="hljs-keyword">continue</span><font></font>
<font></font>
    <span class="hljs-keyword">for</span> (address = current_address <font></font>
         address != memory_information.base_address + memory_information.region_size <font></font>
         address += PAGE_SIZE) <span class="hljs-comment">// PAGE_SIZE</span><font></font>
    {<font></font>
        <span class="hljs-comment">// READ ENTIRE PAGE FROM LOCAL PROCESS INTO BUFFER</span>
        <span class="hljs-keyword">if</span> (NtReadVirtualMemory(GetCurrentProcess(), address, buffer, PAGE_SIZE, <span class="hljs-number">0</span>) &lt; <span class="hljs-number">0</span>)
            <span class="hljs-keyword">continue</span><font></font>
<font></font>
        <span class="hljs-keyword">for</span> (pattern_index = <span class="hljs-number">0</span> pattern_index &lt; <span class="hljs-number">0x1C</span><span class="hljs-comment">/*PATTERN COUNT*/</span> ++pattern_index)<font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (pattern[pattern_index].header == <span class="hljs-number">0x57A</span> &amp;&amp; !is_user32) <span class="hljs-comment">// ONLY DO FFE090 SEARCHES WHEN IN USER32</span>
                <span class="hljs-keyword">continue</span><font></font>
<font></font>
            <span class="hljs-keyword">for</span> (offset = <span class="hljs-number">0</span> pattern[pattern_index].length + offset &lt;= PAGE_SIZE ++offset) <font></font>
            {<font></font>
                <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> pattern_matches = <font></font>
                    memory::pattern_match(&amp;address[offset], pattern[pattern_index <span class="hljs-comment">//    BASIC PATTERN MATCH</span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> (pattern_matches) <font></font>
                {<font></font>
                    <span class="hljs-comment">// PATTERN FOUND IN MEMORY</span>
                    pattern_report.unknown = <span class="hljs-number">0</span>
                    pattern_report.report_id = <span class="hljs-number">0x35</span><font></font>
                    pattern_report.type = pattern[index].header<font></font>
                    pattern_report.data = &amp;address[offset<font></font>
                    pattern_report.base_address = memory_information.base_address<font></font>
                    pattern_report.region_size = memory_information.region_size<font></font>
                    pattern_report.memory_info = <font></font>
                        memory_information.type | <font></font>
                        memory_information.protect | <font></font>
                        memory_information.state<font></font>
<font></font>
                    battleye::report(&amp;pattern_report, <span class="hljs-keyword">sizeof</span>(pattern_report), <span class="hljs-number">0</span><font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰¹å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ¤œè¨¼ï¼ˆMicrosoftï¼‰</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯ã¯ã€ã‚²ãƒ¼ãƒ ã«èª­ã¿è¾¼ã¾ã‚ŒãŸç‰¹å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å­˜åœ¨ã‚’å ±å‘Šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">memory::module_specific_check_microsoft</span><span class="hljs-params">(MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-keyword">auto</span> executable = <font></font>
        memory_information.protect == PAGE_EXECUTE || <font></font>
        memory_information.protect == PAGE_EXECUTE_READ || <font></font>
        memory_information.protect == PAGE_EXECUTE_READWRITE<font></font>
<font></font>
    <span class="hljs-keyword">auto</span> allocated = <font></font>
        memory_information.state == MEM_COMMIT<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!allocated || !executable)
        <span class="hljs-keyword">continue</span><font></font>
<font></font>
    <span class="hljs-keyword">auto</span> mmres_handle = GetModuleHandleA(<span class="hljs-string">"mmres.dll"</span>
    <span class="hljs-keyword">auto</span> mshtml_handle = GetModuleHandleA(<span class="hljs-string">"mshtml.dll"</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (mmres_handle &amp;&amp; mmres_handle == memory_information.allocation_base)<font></font>
    {<font></font>
        battleye_module_anomaly_report module_anomaly_report<font></font>
        module_anomaly_report.unknown = <span class="hljs-number">0</span>
        module_anomaly_report.report_id = <span class="hljs-number">0x5B</span>
        module_anomaly_report.identifier = <span class="hljs-number">0x3480</span><font></font>
        module_anomaly_report.region_size = memory_information.region_size<font></font>
        battleye::report(&amp;module_anomaly_report, <span class="hljs-keyword">sizeof</span>(module_anomaly_report), <span class="hljs-number">0</span>   <font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mshtml_handle &amp;&amp; mshtml_handle == memory_information.allocation_base)<font></font>
    {<font></font>
        battleye_module_anomaly_report module_anomaly_report<font></font>
        module_anomaly_report.unknown = <span class="hljs-number">0</span>
        module_anomaly_report.report_id = <span class="hljs-number">0x5B</span>
        module_anomaly_report.identifier = <span class="hljs-number">0xB480</span><font></font>
        module_anomaly_report.region_size = memory_information.region_size<font></font>
        battleye::report(&amp;module_anomaly_report, <span class="hljs-keyword">sizeof</span>(module_anomaly_report), <span class="hljs-number">0</span>  <font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰¹å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒã‚§ãƒƒã‚¯ï¼ˆä¸æ˜ï¼‰</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç‰¹å®šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒã‚§ãƒƒã‚¯ãŒã‚·ã‚¹ãƒ†ãƒ ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œ</font><font style="vertical-align: inherit;">ã¯ã€ã“ã‚Œã‚‰ã®åŸºæº–ã®</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã„ãšã‚Œã‹</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’æº€ãŸã™ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ãŸã“ã¨ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€šçŸ¥ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">memory::module_specific_check_unknown</span><span class="hljs-params">(MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> dos_header = (DOS_HEADER*)module_handle
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> pe_header = (PE_HEADER*)(module_handle + dos_header-&gt;e_lfanew<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> is_image = memory_information.state == MEM_COMMIT &amp;&amp; memory_information.type == MEM_IMAGE
    <span class="hljs-keyword">if</span> (!is_image)
        <span class="hljs-keyword">return</span><font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> is_base = memory_information.base_address == memory_information.allocation_base
    <span class="hljs-keyword">if</span> (!is_base)
        <span class="hljs-keyword">return</span><font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> match_1 = <font></font>
        time_date_stamp == <span class="hljs-number">0x5B12C900</span> &amp;&amp; <font></font>
        *(__int8*)(memory_information.base_address + <span class="hljs-number">0x1000</span>) == <span class="hljs-number">0x00</span> &amp;&amp;<font></font>
        *(__int32*)(memory_information.base_address + <span class="hljs-number">0x501000</span>) != <span class="hljs-number">0x353E900</span><font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> match_2 = <font></font>
        time_date_stamp == <span class="hljs-number">0x5A180C35</span> &amp;&amp; <font></font>
        *(__int8*)(memory_information.base_address + <span class="hljs-number">0x1000</span>) != <span class="hljs-number">0x00</span><font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> match_2 = <font></font>
        time_date_stamp == <span class="hljs-number">0xFC9B9325</span> &amp;&amp; <font></font>
        *(__int8*)(memory_information.base_address + <span class="hljs-number">0x6D3000</span>) != <span class="hljs-number">0x00</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (!match_1 &amp;&amp; !match_2 &amp;&amp; !match_3)
        <span class="hljs-keyword">return</span><font></font>
    <font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> buffer_offset = <span class="hljs-number">0x00</span> <span class="hljs-comment">// OFFSET DEPENDS ON WHICH MODULE MATCHES, RESPECTIVELY 0x501000, 0x1000 AND 0x6D3000</span><font></font>
<font></font>
    unknown_module_report.unknown1 = <span class="hljs-number">0</span>
    unknown_module_report.report_id = <span class="hljs-number">0x46</span>
    unknown_module_report.unknown2 = <span class="hljs-number">1</span><font></font>
    unknown_module_report.data = *(__int128*)(memory_information.base_address + buffer_offset <font></font>
    battleye::report(&amp;unknown_module_report, <span class="hljs-keyword">sizeof</span>(unknown_module_report), <span class="hljs-number">0</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã©ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã“ã‚Œã‚‰ã®åŸºæº–ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€ã“ã‚Œã¯ç‰¹å®šã®ãƒãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®éå¸¸ã«é™ã‚‰ã‚ŒãŸã‚»ãƒƒãƒˆã‚’æ¤œå‡ºã™ã‚‹è©¦ã¿ã§ã‚ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿½åŠ ï¼š@ how02ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</font></font><code>action_x64.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒ</font></font><code>0x5B12C900</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ã‚Šã€è¨˜éŒ²ã§ãã‚‹ã‚³ãƒ¼ãƒ‰é ˜åŸŸãŒå«ã¾</font><font style="vertical-align: inherit;">ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’é€šçŸ¥ã—ã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å‰è¿°ã®ã‚ˆã†ã«ã€ã“ã‚Œã¯æ‚ªç”¨ã«ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¢ãƒªä¿è­·</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã‚‚æŒã¤ãƒ¡ãƒ¢ãƒªã«ã¤ã„ã¦ã€ç§ã©ã‚‚ã®æ„è¦‹ã§ã¯ã€ãƒ«ãƒƒã‚¯ã‚¹ã¯éå¸¸ã«æ€ªã—ã’ãªæ¤œå‡ºæ‰‹é †ã€å®Ÿè£…</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAGE_GUARDã®</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ©ã‚°ã®</font><em><font style="vertical-align: inherit;">ã‚»ãƒƒãƒˆã‚’</font></em><font style="vertical-align: inherit;">å ´åˆã¯ã€å®Ÿéš›ã«ç¢ºèªã›ãšã€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAGE_GUARDã®</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ©ã‚°ãŒã•ã‚Œã‚‹</font><em><font style="vertical-align: inherit;">è¨­å®šã—ã¾ã™</font></em><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">memory::guard_check</span><span class="hljs-params">(<span class="hljs-keyword">void</span>* current_address, MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-keyword">if</span> (memory_information.protect != PAGE_NOACCESS)<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> bad_ptr = IsBadReadPtr(current_address, <span class="hljs-keyword">sizeof</span>(temporary_buffer
        <span class="hljs-keyword">auto</span> read = NtReadVirtualMemory(<font></font>
            GetCurrentProcess(), <font></font>
            current_address, <font></font>
            temporary_buffer, <span class="hljs-keyword">sizeof</span>(temporary_buffer), 
            <span class="hljs-number">0</span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> (read &lt; <span class="hljs-number">0</span> || bad_ptr)<font></font>
        {<font></font>
            <span class="hljs-keyword">auto</span> query = NtQueryVirtualMemory(<font></font>
                GetCurrentProcess(), <font></font>
                current_address, <font></font>
                <span class="hljs-number">0</span>, <font></font>
                &amp;new_memory_information, <span class="hljs-keyword">sizeof</span>(new_memory_information), <font></font>
                &amp;return_length<font></font>
<font></font>
            memory_guard_report.guard = <font></font>
                    query &lt; <span class="hljs-number">0</span> || <font></font>
                    new_memory_information.state != memory_information.state || <font></font>
                    new_memory_information.protect != memory_information.protect<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (memory_guard_report.guard)<font></font>
            {<font></font>
                memory_guard_report.unknown = <span class="hljs-number">0</span>
                memory_guard_report.report_id = <span class="hljs-number">0x21</span><font></font>
                memory_guard_report.base_address = memory_information.base_address<font></font>
                memory_guard_report.region_size = (<span class="hljs-keyword">int</span>)memory_information.region_size<font></font>
                memory_guard_report.memory_info = <font></font>
                    memory_information.type | <font></font>
                    memory_information.protect | <font></font>
                    memory_information.state<font></font>
<font></font>
                battleye::report(&amp;memory_guard_report, <span class="hljs-keyword">sizeof</span>(memory_guard_report), <span class="hljs-number">0</span><font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸¦ã¹æ›¿ãˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰BattlEyeã¯ã€ã‚²ãƒ¼ãƒ ä¸­ã«ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åå¾©å‡¦ç†ã—ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä¸Šã‹ã‚‰ä¸‹ã«ï¼ˆzå€¤ã§ï¼‰ãƒã‚¤ãƒ‘ã‚¹ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚²ãƒ¼ãƒ å†…ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒ³ãƒ‰ãƒ«ã¯ã“ã®åˆ—æŒ™ã‹ã‚‰é™¤å¤–ã•ã‚Œã€ã“ã‚Œã¯å‘¼ã³å‡ºã—ã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã¾ã™</font></font><code>GetWindowThreadProcessId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€å¯¾å¿œã™ã‚‹é–¢æ•°ã‚’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å½ã®æ‰€æœ‰è€…ã«ãƒã‚¤ãƒ³ãƒ‰ã—ã¦ã€</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BattlEyeãŒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ãƒã‚§ãƒƒã‚¯ã—ãªã„</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚ˆã†ã«ã™ã‚‹ã“ã¨</font><strong><font style="vertical-align: inherit;">ãŒã§ãã¾ã™</font></strong><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">window_handler::enumerate</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> window_handle = GetTopWindow<font></font>
         window_handle <font></font>
         window_handle = GetWindow(window_handle, GW_HWNDNEXT), <span class="hljs-comment">// GET WINDOW BELOW</span>
         ++window_handler::windows_enumerated)                  <span class="hljs-comment">// INCREMENT GLOBAL COUNT FOR LATER USAGE</span><font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> window_process_pid = <span class="hljs-number">0</span><font></font>
        GetWindowThreadProcessId(window_handle, &amp;window_process_pid<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (window_process_pid == GetCurrentProcessId())
            <span class="hljs-keyword">continue</span><font></font>
<font></font>
        <span class="hljs-comment">// APPEND INFORMATION TO THE MISC. REPORT, THIS IS EXPLAINED LATER IN THE ARTICLE</span><font></font>
        window_handler::handle_summary(window_handle<font></font>
<font></font>
        <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> max_character_count = <span class="hljs-number">0x80</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> length = GetWindowTextA(window_handle, window_title_report.window_title, max_character_count<font></font>
<font></font>
        <span class="hljs-comment">// DOES WINDOW TITLE MATCH ANY OF THE BLACKLISTED TITLES?</span>
        <span class="hljs-keyword">if</span> (!contains(window_title_report.window_title, <span class="hljs-string">"CheatAut"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"pubg_kh"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"conl -"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"PerfectA"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"AIMWA"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"PUBG AIM"</span>) &amp;&amp;<font></font>
            !contains(window_title_report.window_title, <span class="hljs-string">"HyperChe"</span>))
            <span class="hljs-keyword">continue</span><font></font>
<font></font>
        <span class="hljs-comment">// REPORT WINDOW</span>
        window_title_report.unknown_1 = <span class="hljs-number">0</span>
        window_title_report.report_id = <span class="hljs-number">0x33</span>
        battleye::report(&amp;window_title_report, <span class="hljs-keyword">sizeof</span>(window_title_report) + length, <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç•°å¸¸ã‚’æ¤œç´¢</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒ2ã¤æœªæº€ã®å ´åˆã€é€šçŸ¥ãŒã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ãŠãã‚‰ãã€BattlEyeã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãŒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’æ¤œæŸ»ã§ããªã„ã‚ˆã†ã«ã™ã‚‹å¯¾å¿œã™ã‚‹é–¢æ•°ã®ãƒ‘ãƒƒãƒé©ç”¨ã‚’é˜²ããŸã‚ã«è¡Œã‚ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">window_handler::check_count</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (window_handler::windows_enumerated &gt; <span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span><font></font>
    <font></font>
    <span class="hljs-comment">// WINDOW ENUMERATION FAILED, MOST LIKELY DUE TO HOOK</span>
    window_anomaly_report.unknown_1 = <span class="hljs-number">0</span>
    window_anomaly_report.report_id = <span class="hljs-number">0x44</span><font></font>
    window_anomaly_report.enumerated_windows = windows_enumerated<font></font>
    battleye::report(&amp;window_anomaly_report, <span class="hljs-keyword">sizeof</span>(window_anomaly_report), <span class="hljs-number">0</span><font></font>
    <font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸¦ã¹æ›¿ãˆ</font></font></h2><br><font style="vertical-align: inherit;"></font><code>CreateToolhelp32Snapshot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BattlEyeã‚’</font><font style="vertical-align: inherit;">
å‘¼ã³å‡ºã™ã“ã¨ã«ã‚ˆã‚Š</font><font style="vertical-align: inherit;">ã€å®Ÿè¡Œä¸­ã®ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åå¾©å‡¦ç†ã—</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ãŒã€ã‚¨ãƒ©ãƒ¼ã¯å‡¦ç†ã—ãªã„</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŸã‚ã€ãƒ‘ãƒƒãƒã‚’é©ç”¨ã—ã¦æ¬¡ã®æ¤œå‡ºæ‰‹é †ã‚’å›é¿ã™ã‚‹ã“ã¨ãŒéå¸¸ã«ç°¡å˜ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ã‚¹ãƒã‚§ãƒƒã‚¯</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒï¼ˆãƒ‡ã‚£ã‚¹ã‚¯ã®ãƒ«ãƒ¼ãƒˆã‹ã‚‰æ•°ãˆã¦ï¼‰å°‘ãªãã¨ã‚‚2ã¤ã®ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ã‚ã‚‹å ´åˆã€å¯¾å¿œã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¸ã®ãƒ‘ã‚¹ã«æ¬¡ã®è¡Œã®å°‘ãªãã¨ã‚‚1ã¤ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">Desktop<font></font>
Temp<font></font>
FileRec<font></font>
Documents<font></font>
Downloads<font></font>
Roaming<font></font>
tmp.ex<font></font>
notepad.<font></font>
...\.<font></font>
cmd.ex</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹ãŒã“ã‚Œã‚‰ã®è¡Œã®ã„ãšã‚Œã‹ã«å¯¾å¿œã™ã‚‹å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã¯ã€å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹ã«é–¢ã™ã‚‹é€šçŸ¥ã¨ã€è¦ªãƒ—ãƒ­ã‚»ã‚¹ãŒæ¬¡ã®ã„ãšã‚Œã‹ã§ã‚ã‚‹ã‹ã©ã†ã‹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å—ã‘å–ã‚Šã¾ã™ï¼ˆã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹å¯¾å¿œã™ã‚‹ãƒ•ãƒ©ã‚°ãƒ“ãƒƒãƒˆãŒå«ã¾ã‚Œã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">steam.exe       [<span class="hljs-number">0x01</span>]<font></font>
explorer.exe    [<span class="hljs-number">0x02</span>]<font></font>
lsass.exe       [<span class="hljs-number">0x08</span>]<font></font>
cmd.exe         [<span class="hljs-number">0x10</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒé©åˆ‡ãªæ¨©é™</font></font><code>QueryLimitedInformation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§</font><font style="vertical-align: inherit;">è¨˜è¿°å­ã‚’é–‹ãã“ã¨ãŒã§ããªã„</font></font><code>0x04</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å ´åˆã€å‘¼ã³å‡ºã—</font></font><code>OpenProcess</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒå¤±æ•—ã—ãŸ</font><font style="vertical-align: inherit;">ã¨ãã®ã‚¨ãƒ©ãƒ¼ã®åŸå› ãŒ</font><font style="vertical-align: inherit;">ç­‰ã—ããªã„</font><font style="vertical-align: inherit;">å ´åˆã€</font><font style="vertical-align: inherit;">ãƒ•ãƒ©ã‚°ãƒ“ãƒƒãƒˆã‚’è¨­å®šã—</font><font style="vertical-align: inherit;">ã¾ã™</font></font><code>ERROR_ACCESS_DENIED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¯¾å¿œã™ã‚‹ãƒ•ãƒ©ã‚°å€¤ã®æœ€å¾Œã®åˆ—æŒ™ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">enum</span> BATTLEYE_PROCESS_FLAG<font></font>
{<font></font>
  STEAM     = <span class="hljs-number">0x1</span>,<font></font>
  EXPLORER  = <span class="hljs-number">0x2</span>,<font></font>
  ERROR     = <span class="hljs-number">0x4</span>,<font></font>
  LSASS     = <span class="hljs-number">0x8</span>,<font></font>
  CMD       = <span class="hljs-number">0x10</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ªãƒ—ãƒ­ã‚»ã‚¹ãŒSteamã®å ´åˆã€ãƒ•ãƒ©ã‚°ãŒå³åº§ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¨­å®šã•ã‚Œã€ã‚µãƒ¼ãƒãƒ¼ã¯é€šçŸ¥IDã§ã“ã‚Œã«ã¤ã„ã¦é€šçŸ¥ã•ã‚Œã¾ã™ </font></font><code>0x40</code><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”»åƒå</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒ­ã‚»ã‚¹ãŒä»¥ä¸‹ã®å¤šãã®åŸºæº–ã®ã„ãšã‚Œã‹ã‚’æº€ãŸã—ã¦ã„ã‚‹å ´åˆã€ã™ãã«ãƒ•ãƒ©ã‚°ãŒè¨­å®šã•ã‚Œã€ã‚µãƒ¼ãƒãƒ¼ã¯é€šçŸ¥IDã§ã“ã‚Œã«ã¤ã„ã¦é€šçŸ¥ã•ã‚Œã¾ã™ </font></font><code>0x38</code><br>
<br>
<pre><code class="cpp hljs">   <span class="hljs-string">"Loadlibr"</span>
   <span class="hljs-string">"Rng "</span>
   <span class="hljs-string">"A0E7FFFFFF81"</span>
   <span class="hljs-string">"RNG "</span>
   <span class="hljs-string">"90E54355"</span>
   <span class="hljs-string">"2.6.ex"</span>
   <span class="hljs-string">"TempFile.exe"</span></code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steamã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€ã»ã¨ã‚“ã©ã®Steamãƒ¦ãƒ¼ã‚¶ãƒ¼ã«çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã‚²ãƒ¼ãƒ å†…ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’æ‹…å½“ã™ã‚‹Steamã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç›£è¦–ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">Steamã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®å®Œå…¨ãªãƒ›ã‚¹ãƒˆåã¯</font></font><code>gameoverlayui.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã‚²ãƒ¼ãƒ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ãƒãƒƒã‚­ãƒ³ã‚°ã—ãŸã‚Šã€é•æ³•ãªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’å®Ÿè¡Œã—ãŸã‚Šã™ã‚‹ã®ã¯éå¸¸ã«ç°¡å˜ã§ã‚ã‚‹ãŸã‚ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ¤œè¨¼ã«ã¯æ¬¡ã®æ¡ä»¶ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">file size != <span class="hljs-number">0</span> &amp;&amp; image name contains (<span class="hljs-keyword">case</span> insensitive) gameoverlayu</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Steamã‚²ãƒ¼ãƒ ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã«å›ºæœ‰ã®è¿½åŠ ã®ãƒã‚§ãƒƒã‚¯ã¯ã€ã‚²ãƒ¼ãƒ ãƒ—ãƒ­ã‚»ã‚¹è‡ªä½“ã«å¯¾ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹æ‰‹é †ã¨ã»ã¼åŒã˜ã§ã‚ã‚‹ãŸã‚ã€ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ã§ã¯çœç•¥ã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steamã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¡ãƒ¢ãƒªã‚¹ã‚­ãƒ£ãƒ³</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Steamã‚²ãƒ¼ãƒ ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç•°å¸¸ãŒãªã„ã‹ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã¯éå¸¸ã«ä¸€èˆ¬åŒ–ã•ã‚Œã¦ãŠã‚Šã€ãƒãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ãŸã‚ã€ã“ã‚Œã‚‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç›®çš„ã‚’èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameoverlay::pattern_scan</span><span class="hljs-params">(MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{
    <span class="hljs-comment">// PATTERNS:</span>
    <span class="hljs-comment">// Home</span>
    <span class="hljs-comment">// F1</span>
    <span class="hljs-comment">// FFFF83C48C30000000000</span>
    <span class="hljs-comment">// \.pipe%s</span>
    <span class="hljs-comment">// C760000C64730</span>
    <span class="hljs-comment">// 60C01810033D2</span><font></font>
<font></font>
    <span class="hljs-comment">// ... </span>
    <span class="hljs-comment">// PATTERN SCAN, ALMOST IDENTICAL CODE TO THE AFOREMENTIONED PATTERN SCANNING ROUTINE</span><font></font>
<font></font>
    gameoverlay_memory_report.unknown_1 = <span class="hljs-number">0</span>
    gameoverlay_memory_report.report_id = <span class="hljs-number">0x35</span>
    gameoverlay_memory_report.identifier = <span class="hljs-number">0x56C</span><font></font>
    gameoverlay_memory_report.data = &amp;buffer[offset<font></font>
    gameoverlay_memory_report.base_address = memory_information.base_address<font></font>
    gameoverlay_memory_report.region_size = (<span class="hljs-keyword">int</span>)memory_information.region_size<font></font>
    gameoverlay_memory_report.memory_info = <font></font>
        memory_information.type | <font></font>
        memory_information.protect | <font></font>
        memory_information.state<font></font>
<font></font>
    battleye::report(&amp;gameoverlay_memory_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_memory_report), <span class="hljs-number">0</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚­ãƒ£ãƒ³æ‰‹é †ã§ã¯ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã®å¤–éƒ¨ã«ã‚ã‚‹å®Ÿè¡Œå¯èƒ½ã‚³ãƒ¼ãƒ‰ã®å½¢å¼ã®ç•°å¸¸ã‚‚æ¢ã—ã¾ã™ã€‚ã‚¯ãƒ©ãƒƒã‚«ãƒ¼ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚³ãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã—ãŸã“ã¨ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameoverlay::memory_anomaly_scan</span><span class="hljs-params">(MEMORY_BASIC_INFORMATION memory_information)</span>
</span>{  
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// ALMOST IDENTICAL ANOMALY SCAN COMPARED TO MEMORY ENUMERATION ROUTINE OF GAME PROCESS</span><font></font>
<font></font>
    gameoverlay_report.unknown = <span class="hljs-number">0</span>
    gameoverlay_report.report_id = <span class="hljs-number">0x3B</span><font></font>
    gameoverlay_report.base_address = memory_information.base_address<font></font>
    gameoverlay_report.region_size = memory_information.region_size<font></font>
    gameoverlay_report.memory_info = memory_information.type | memory_information.protect | memory_information.state<font></font>
    battleye::report(&amp;gameoverlay_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_report), <span class="hljs-number">0</span>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steamã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ä¿è­·</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Steamã‚²ãƒ¼ãƒ ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒã€</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ©ã‚¤ãƒˆï¼ˆWinTcbï¼‰</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªã©ã®Windowsãƒ—ãƒ­ã‚»ã‚¹ã®ä¿è­·ã«ã‚ˆã£ã¦ä¿è­·ã•ã‚Œã¦ã„ã‚‹</font><font style="vertical-align: inherit;">å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã¯ãã‚Œã«é–¢ã™ã‚‹é€šçŸ¥ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameoverlay::protection_check</span><span class="hljs-params">(HANDLE process_handle)</span>
</span>{
    <span class="hljs-keyword">auto</span> process_protection = <span class="hljs-number">0</span><font></font>
<font></font>
    NtQueryInformationProcess(<font></font>
        process_handle, ProcessProtectionInformation, <font></font>
        &amp;process_protection, <span class="hljs-keyword">sizeof</span>(process_protection), <span class="hljs-literal">nullptr</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (process_protection == <span class="hljs-number">0</span>) <span class="hljs-comment">// NO PROTECTION</span>
        <span class="hljs-keyword">return</span><font></font>
<font></font>
    gameoverlay_protected_report.unknown = <span class="hljs-number">0</span>
    gameoverlay_protected_report.report_id = <span class="hljs-number">0x35</span>
    gameoverlay_protected_report.identifier = <span class="hljs-number">0x5B1</span><font></font>
    gameoverlay_protected_report.data = process_protection<font></font>
    battleye::report(&amp;gameoverlay_protected_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_protected_report), <span class="hljs-number">0</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€å¯¾å¿œã™ã‚‹</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenProcess</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘¼ã³å‡ºã—</font><font style="vertical-align: inherit;">ãŒ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ERROR_ACCESS_DENIED</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ã«è¿”ã™</font><font style="vertical-align: inherit;">å ´åˆ</font><font style="vertical-align: inherit;">ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é–¢ã™ã‚‹IDã®é€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã¾ã™</font></font><code>3B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¸¦ã¹æ›¿ãˆ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Steamã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚‚ã‚½ãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€</font></font><code>vgui2_s.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠã‚ˆã³</font><font style="vertical-align: inherit;">ãŒæ¤œç´¢ã•ã‚Œ</font></font><code>gameoverlayui.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¯¾ã—ã¦ã€ã‹ã‚‰å§‹ã¾ã‚‹ã„ãã¤ã‹ã®ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã¾ã™</font></font><code>gameoverlayui.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®æ¡ä»¶ãŒæº€ãŸã•ã‚Œã¦ã„ã‚‹å ´åˆï¼š</font></font><code>[gameoverlayui.dll+6C779] == 08BE55DC3CCCCB8????????C3CCCCCC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒã‚¤ãƒˆã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã§vtableã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™</font></font><code>????????</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®vtableè¦ç´ ã®ã„ãšã‚Œã‹ãŒã‚½ãƒ¼ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«gameoverlayui.dllã®å¤–éƒ¨ã«ã‚ã‚‹ã‹ã€æŒ‡ç¤ºã‚’ç¤ºã—ã¦ã„ã‚‹</font></font><code>int 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é€šçŸ¥IDã¨ã¨ã‚‚ã«ã‚µãƒ¼ãƒãƒ¼ã«å ±å‘Šã•ã‚Œã¾ã™</font></font><code>3B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameoverlay::scan_vtable</span><span class="hljs-params">(HANDLE process_handle, <span class="hljs-keyword">char</span>* buffer, MODULEENTRY32 module_entry)</span>
</span>{
    <span class="hljs-keyword">char</span> function_buffer[<span class="hljs-number">16</span><font></font>
<font></font>
    <span class="hljs-keyword">for</span> (vtable_index = <span class="hljs-number">0</span> vtable_index &lt; <span class="hljs-number">20</span> vtable_index += <span class="hljs-number">4</span>)<font></font>
    {<font></font>
        NtReadVirtualMemory(<font></font>
          process_handle,<font></font>
          *(<span class="hljs-keyword">int</span>*)&amp;buffer[vtable_index],<font></font>
          &amp;function_buffer,<font></font>
          <span class="hljs-keyword">sizeof</span>(function_buffer),
          <span class="hljs-number">0</span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> (*(<span class="hljs-keyword">int</span>*)&amp;buffer[vtable_index] &lt; module_entry.modBaseAddr ||<font></font>
            *(<span class="hljs-keyword">int</span>*)&amp;buffer[vtable_index] &gt;= module_entry.modBaseAddr + module_entry.modBaseSize ||<font></font>
            function_buffer[<span class="hljs-number">0</span>] == <span class="hljs-number">0xCC</span> )    <span class="hljs-comment">// FUNCTION PADDING</span><font></font>
        {<font></font>
            gameoverlay_vtable_report.report_id = <span class="hljs-number">0x3B</span><font></font>
            gameoverlay_vtable_report.vtable_index = vtable_index<font></font>
            gameoverlay_vtable_report.address = buffer[vtable_index<font></font>
            battleye::report(&amp;gameoverlay_vtable_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_vtable_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å¯¾ã—ã¦</font></font><code>vgui2_s.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰¹å®šã®æ¤œè¨¼æ‰‹é †ã‚‚å®Ÿè¡Œã•</font><font style="vertical-align: inherit;">ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vgui::scan</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (!equals(vgui_buffer, <span class="hljs-string">"6A08B31FF561C8BD??????????FF96????????8BD????????8B1FF90"</span>))<font></font>
    {<font></font>
        <span class="hljs-keyword">auto</span> could_read = NtReadVirtualMemory(<font></font>
            process_handle, module_entry.modBaseAddr + <span class="hljs-number">0x48338</span>, vgui_buffer, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>) &gt;= <span class="hljs-number">0</span><font></font>
<font></font>
        <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> pattern_offset = <span class="hljs-number">0x48378</span><font></font>
<font></font>
        <span class="hljs-comment">// IF READ DID NOT FAIL AND PATTERN IS FOUND</span>
        <span class="hljs-keyword">if</span> (could_read &amp;&amp; equals(vgui_buffer, <span class="hljs-string">"6A46A06A26A"</span>))<font></font>
        {<font></font>
            vgui_report.unknown_1 = <span class="hljs-number">0</span>
            vgui_report.report_id = <span class="hljs-number">0x3B</span>
            vgui_report.unknown_2 = <span class="hljs-number">0</span><font></font>
            vgui_report.address = LODWORD(module_entry.modBaseAddr) + pattern_offset<font></font>
<font></font>
            <span class="hljs-comment">// READ TARGET BUFFER INTO REPORT</span><font></font>
            NtReadVirtualMemory(<font></font>
              process_handle,<font></font>
              module_entry.modBaseAddr + pattern_offset,<font></font>
              vgui_report.buffer,<font></font>
              <span class="hljs-keyword">sizeof</span>(vgui_report.buffer),
              <span class="hljs-number">0</span><font></font>
<font></font>
            battleye::report(&amp;vgui_report, <span class="hljs-keyword">sizeof</span>(vgui_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
            <span class="hljs-comment">// READ ADDRESS FROM CODE</span>
            NtReadVirtualMemory(process_handle, *(<span class="hljs-keyword">int</span>*)&amp;vgui_buffer[<span class="hljs-number">9</span>], vgui_buffer, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp;
            <span class="hljs-comment">// READ POINTER TO CLASS</span>
            NtReadVirtualMemory(process_handle, *(<span class="hljs-keyword">int</span>*)vgui_buffer, vgui_buffer, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; 
            <span class="hljs-comment">// READ POINTER TO VIRTUAL TABLE</span>
            NtReadVirtualMemory(process_handle, *(<span class="hljs-keyword">int</span>*)vgui_buffer, vgui_buffer, <span class="hljs-keyword">sizeof</span>(vgui_buffer), <span class="hljs-number">0</span>) &gt;= <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">for</span> (vtable_index = <span class="hljs-number">0</span> vtable_index &lt; <span class="hljs-number">984</span> vtable_index += <span class="hljs-number">4</span> )      <span class="hljs-comment">// 984/4 VTABLE ENTRY COUNT</span><font></font>
        {<font></font>
            NtReadVirtualMemory(process_handle, *(<span class="hljs-keyword">int</span>*)&amp;vgui_buffer[vtable_index], &amp;vtable_entry, <span class="hljs-keyword">sizeof</span>(vtable_entry), <span class="hljs-number">0</span><font></font>
<font></font>
            <span class="hljs-keyword">if</span> (*(<span class="hljs-keyword">int</span>*)&amp;vgui_buffer[vtable_index] &lt; module_entry.modBaseAddr ||<font></font>
                *(<span class="hljs-keyword">int</span>*)&amp;vgui_buffer[vtable_index] &gt;= module_entry.modBaseAddr + module_entry.modBaseSize ||<font></font>
                vtable_entry == <span class="hljs-number">0xCC</span> )<font></font>
            {<font></font>
                vgui_vtable_report.unknown = <span class="hljs-number">0</span>
                vgui_vtable_report.report_id = <span class="hljs-number">0x3B</span><font></font>
                vgui_vtable_report.vtable_index = vtable_index<font></font>
                vgui_vtable_report.address = *(<span class="hljs-keyword">int</span>*)&amp;vgui_buffer[vtable_index<font></font>
                battleye::report(&amp;vgui_vtable_report, <span class="hljs-keyword">sizeof</span>(vgui_vtable_report), <span class="hljs-number">0</span><font></font>
            }<font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£</font></font><code>48378</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€ã‚³ãƒ¼ãƒ‰é ˜åŸŸã®å ´æ‰€ã§ã‚ã‚‹</font><font style="vertical-align: inherit;">ã‚ªãƒ•ã‚»ãƒƒãƒˆã®å¤‰æ›´ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">push    <span class="hljs-number">04</span>
push    offset aCBuildslaveSte_4 ; <span class="hljs-string">"c:\buildslave\steam_rel_client_win32"</span>...<font></font>
push    offset aAssertionFaile_7 ; <span class="hljs-string">"Assertion Failed: IsValidIndex(elem)"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã“ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã¯éå¸¸ã«å…·ä½“çš„ã§ä¸€è¦‹ä¸è¦ãªå¤‰æ›´ãŒãªã„ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">push    <span class="hljs-number">04</span>
push    <span class="hljs-number">00</span>
push    <span class="hljs-number">02</span>
push    ??</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®2ã¤ã®ãƒã‚§ãƒƒã‚¯ã®ã†ã¡æœ€åˆã®ãƒã‚§ãƒƒã‚¯ã¨ä¸€è‡´ã—ãªã„vgui2_s.dllã®ã‚³ãƒ”ãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ããªã‹ã£ãŸãŸã‚ã€ãƒã‚§ãƒƒã‚¯ã™ã‚‹vtableã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚¹ãƒˆãƒªãƒ¼ãƒ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Steamã‚²ãƒ¼ãƒ ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ä¸­ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚‚ç§»å‹•ã•ã‚Œã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gameoverlay::check_thread</span><span class="hljs-params">(THREADENTRY32 thread_entry)</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> tread_handle = OpenThread(THREAD_SUSPEND_RESUME|THREAD_GET_CONTEXT, <span class="hljs-number">0</span>, thread_entry.th32ThreadID
    <span class="hljs-keyword">if</span> (thread_handle)<font></font>
    {<font></font>
        suspend_count = ResumeThread(thread_handle<font></font>
        <span class="hljs-keyword">if</span> (suspend_count &gt; <span class="hljs-number">0</span>)<font></font>
        {<font></font>
            SuspendThread(thread_handle<font></font>
            gameoverlay_thread_report.unknown = <span class="hljs-number">0</span>
            gameoverlay_thread_report.report_id = <span class="hljs-number">0x3B</span><font></font>
            gameoverlay_thread_report.suspend_count = suspend_count<font></font>
            battleye::report(&amp;gameoverlay_thread_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_thread_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (GetThreadContext(thread_handle, &amp;context) &amp;&amp; context.Dr7)<font></font>
        {<font></font>
            gameoverlay_debug_report.unknown = <span class="hljs-number">0</span>
            gameoverlay_debug_report.report_id = <span class="hljs-number">0x3B</span><font></font>
            gameoverlay_debug_report.debug_register = context.Dr0<font></font>
            battleye::report(&amp;gameoverlay_debug_report, <span class="hljs-keyword">sizeof</span>(gameoverlay_debug_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LSASS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windowsã®</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lsass.exe</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚»ã‚¹</font><font style="vertical-align: inherit;">ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿé–¢</font><font style="vertical-align: inherit;">ãƒ—ãƒ­ã‚»ã‚¹</font><font style="vertical-align: inherit;">ã¨ã‚‚å‘¼ã°ã‚Œ</font><font style="vertical-align: inherit;">ã¾ã™ï¼‰ã®ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¹ãƒšãƒ¼ã‚¹</font><font style="vertical-align: inherit;">ã‚‚ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã€å‰ã®2ã¤ã®ãƒã‚§ãƒƒã‚¯ã®å ´åˆã¨åŒæ§˜ã«ã€ã™ã¹ã¦ã®ç•°å¸¸ãŒã‚µãƒ¼ãƒãƒ¼ã«å ±å‘Šã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (equals(process_entry.executable_path, <span class="hljs-string">"lsass.exe"</span>))<font></font>
{<font></font>
    <span class="hljs-keyword">auto</span> lsass_handle = OpenProcess(QueryInformation, <span class="hljs-number">0</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)process_entry.th32ProcessID
    <span class="hljs-keyword">if</span> (lsass_handle)<font></font>
    {<font></font>
        <span class="hljs-keyword">for</span> (address = <span class="hljs-number">0</span>
              NtQueryVirtualMemory(lsass_handle, address, <span class="hljs-number">0</span>, &amp;lsass_memory_info, <span class="hljs-number">0x30</span>, &amp;bytes_needed) &gt;= <span class="hljs-number">0</span><font></font>
              address = lsass_memory_info.base_address + lsass_memory_info.region_size)<font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (lsass_memory_info.state == MEM_COMMIT<font></font>
              &amp;&amp; lsass_memory_info.type == MEM_PRIVATE<font></font>
              &amp;&amp; (lsass_memory_info.protect == PAGE_EXECUTE<font></font>
               || lsass_memory_info.protect == PAGE_EXECUTE_READ<font></font>
               || lsass_memory_info.protect == PAGE_EXECUTE_READWRITE))<font></font>
            {<font></font>
                <span class="hljs-comment">// FOUND EXECUTABLE MEMORY OUTSIDE OF MODULES</span>
                lsass_report.unknown = <span class="hljs-number">0</span>
                lsass_report.report_id = <span class="hljs-number">0x42</span><font></font>
                lsass_report.base_address = lsass_memory_info.base_address<font></font>
                lsass_report.region_size = lsass_memory_info.region_size<font></font>
                lsass_report.memory_info = <font></font>
                    lsass_memory_info.type | lsass_memory_info.protect | lsass_memory_info.state<font></font>
                battleye::report(&amp;lsass_report, <span class="hljs-keyword">sizeof</span>(lsass_report), <span class="hljs-number">0</span><font></font>
            }<font></font>
        }<font></font>
        CloseHandle(lsass_handle<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LSASSã¯ã“ã‚Œã¾ã§ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã§ãƒ¡ãƒ¢ãƒªã‚’ä½¿ç”¨ã—ãŸæ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’å¿…è¦ã¨ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€LSASSã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚</font><font style="vertical-align: inherit;">ç¾åœ¨ã€BattlEyeã¯ã€èª­ã¿å–ã‚Š/æ›¸ãè¾¼ã¿æ“ä½œã‹ã‚‰ãƒ—ãƒ­ã‚»ã‚¹ãƒãƒ³ãƒ‰ãƒ«ã‚’æ‰‹å‹•ã§ã‚¯ãƒªã‚¢ã—ã€æ¬¡ã«</font></font><code>ReadProcessMemory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font><font style="vertical-align: inherit;">ã‚’</font></font><code>WriteProcessMemory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ã‚¿ãƒƒãƒã—ã¦ã€BEDaisyãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¸ã®å‘¼ã³å‡ºã—ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã“ã¨</font><font style="vertical-align: inherit;">ã«ã‚ˆã‚Šã€ã“ã®å•é¡Œã«å¯¾å‡¦ã—ã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã«ã€BEDaisyã¯ãƒ¡ãƒ¢ãƒªæ“ä½œãŒæ­£å½“ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ“ä½œãŒåˆæ³•ã§ã‚ã‚‹ã¨å½¼ãŒä¿¡ã˜ã‚‹ãªã‚‰ã°ã€å½¼ã¯ãã‚Œã‚’ç¶šã‘ã¾ã™ã€ã•ã‚‚ãªã‘ã‚Œã°ã€æ„å›³çš„ã«ãƒã‚·ãƒ³ã«ãƒ–ãƒ«ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚’ã¤ã‘ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã•ã¾ã–ã¾ãªé€šçŸ¥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã•ã¾ã–ã¾ãªæƒ…å ±ã‚’åé›†ã—ã€é€šçŸ¥IDã¨ã¨ã‚‚ã«ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã™</font></font><code>3C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã®æƒ…å ±ã¯ã€æ¬¡ã®è¦ç´ ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WS_EX_TOPMOST</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ãƒ©ã‚°</font><font style="vertical-align: inherit;">ã¾ãŸã¯ãã®é¡ä¼¼ç‰©ã‚’</font><font style="vertical-align: inherit;">æŒã¤ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</font><font style="vertical-align: inherit;">ï¼š</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ†ã‚­ã‚¹ãƒˆï¼ˆUnicodeï¼‰</font></font></li>
<li>   (Unicode)</li>
<li>Window style</li>
<li>Window extended style</li>
<li> </li>
<li>   -</li>
<li>  -</li>
</ul></li>
<li>       (VM_WRITE|VM_READ)<ul>
<li> </li>
<li>  </li>
<li> </li>
<li>  </li>
</ul></li>
<li>   :<br>
<ul>
<li>â€¦.ContentPaksTslGame-WindowsNoEditor_assets_world.pak</li>
<li>â€¦.ContentPaksTslGame-WindowsNoEditor_ui.pak</li>
<li>â€¦.ContentPaksTslGame-WindowsNoEditor_sound.pak</li>
</ul><br>
</li>
<li>   :<br>
<ul>
<li>â€¦.BLGameCookedContentScriptBLGame.u</li>
</ul></li>
<li>   NtGetContextThread<br>
<ul>
<li>    (E9),      </li>
</ul></li>
</ul><br>
<h2>NoEye</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€NoEyeã¨å‘¼ã°ã‚Œã‚‹ã“ã®ã‚¢ãƒ³ãƒãƒãƒ¼ãƒˆã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã€å…¬ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ«ãƒ¼ãƒˆã‚­ãƒƒãƒˆã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ã‹ãªã‚Šé…å»¶ã—ãŸãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…</font><font style="vertical-align: inherit;">ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒãƒ‡ã‚£ã‚¹ã‚¯ã«ã‚ã‚‹å ´åˆ</font><font style="vertical-align: inherit;">ã€ã‚·ã‚¹ãƒ†ãƒ </font><font style="vertical-align: inherit;">ã¯</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetFileAttributesExA</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’ãƒã‚§ãƒƒã‚¯</font><font style="vertical-align: inherit;">ã—</font><font style="vertical-align: inherit;">ã¾ã™</font></font><code>BE_DLL.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">noeye::detect</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-function">WIN32_FILE_ATTRIBUTE_DATA file_information
    <span class="hljs-title">if</span> <span class="hljs-params">(GetFileAttributesExA(<span class="hljs-string">"BE_DLL.dll"</span>, <span class="hljs-number">0</span>, &amp;file_information))</span>
    </span>{<font></font>
      noeye_report.unknown = <span class="hljs-number">0</span>
      noeye_report.report_id = <span class="hljs-number">0x3D</span><font></font>
      noeye_report.file_size = file_information.nFileSizeLow<font></font>
      battleye::report(&amp;noeye_report, <span class="hljs-keyword">sizeof</span>(noeye_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®å¯ç”¨æ€§</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ“ãƒ¼ãƒ—éŸ³ã¨ãƒŒãƒ«ã®ãƒ‡ãƒã‚¤ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚‚ã—ã‚ã‚Œã°ã€é€šçŸ¥ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ã®çŠ¶æ…‹ã§ã¯ã€ã“ã‚Œã‚‰ã®2ã¤ã®ãƒ‡ãƒã‚¤ã‚¹ã¯ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€èª°ã‹ãŒãƒ‡ãƒã‚¤ã‚¹ã‚’æ‰‹å‹•ã§ã‚ªãƒ³ã«ã—ãŸã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®æ‰‹æ³•ã¯ã€ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãƒ‡ãƒã‚¤ã‚¹ã®ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ã¨å‘¼ã°ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€ã“ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ç”¨ã®å€‹åˆ¥ã®ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¿…è¦ã¨ã›ãšã«ã€IOCTLãƒ‡ãƒ¼ã‚¿ãŒæ‚ªæ„ã®ã‚ã‚‹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã¨ç¢ºå®Ÿã«äº¤æ›ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">driver::check_beep</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> handle = CreateFileA(<span class="hljs-string">"\\.\Beep"</span>, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="hljs-number">0</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> (handle != INVALID_HANDLE_VALUE)<font></font>
    {<font></font>
      beep_report.unknown = <span class="hljs-number">0</span>
      beep_report.report_id = <span class="hljs-number">0x3E</span>
      battleye::report(&amp;beep_report, <span class="hljs-keyword">sizeof</span>(beep_report), <span class="hljs-number">0</span><font></font>
      CloseHandle(handle<font></font>
    }<font></font>
}</code></pre><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">driver::check_null</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> handle = CreateFileA(<span class="hljs-string">"\\.\Null"</span>, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="hljs-number">0</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> (handle != INVALID_HANDLE_VALUE)<font></font>
    {<font></font>
      null_report.unknown = <span class="hljs-number">0</span>
      null_report.report_id = <span class="hljs-number">0x3E</span>
      battleye::report(&amp;null_report, <span class="hljs-keyword">sizeof</span>(null_report), <span class="hljs-number">0</span><font></font>
      CloseHandle(handle<font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¡çœ ãƒ‡ãƒ«ã‚¿</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã•ã‚‰ã«ã€BattlEyeã¯ç¾åœ¨ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«å¯¾ã—ã¦1ç§’é–“éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç…§ä¼šã—ã€éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆã‚¹ãƒªãƒ¼ãƒ—ï¼‰ã®å‰å¾Œã®ã‚µã‚¤ã‚¯ãƒ«æ•°ã®é•ã„ã‚’æ¸¬å®šã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sleep::check_delta</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> tick_count = GetTickCount<font></font>
    Sleep(<span class="hljs-number">1000</span>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> tick_delta = GetTickCount() - tick_count
    <span class="hljs-keyword">if</span> (tick_delta &gt;= <span class="hljs-number">1200</span>)<font></font>
    {<font></font>
        sleep_report.unknown = <span class="hljs-number">0</span>
        sleep_report.report_id = <span class="hljs-number">0x45</span><font></font>
        sleep_report.delta = tick_delta<font></font>
        battleye::report(&amp;sleep_report, <span class="hljs-keyword">sizeof</span>(sleep_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7zip</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éå¸¸ã«é…å»¶ã—ãŸæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ãŒBattlEyeã«è¿½åŠ ã•ã‚ŒãŸãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯7zipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚²ãƒ¼ãƒ ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ­ãƒ¼ãƒ‰ã—ã¦é ˜åŸŸã‚’ä¸Šæ›¸ãã§ãã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€å‰è¿°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¹ã‚­ãƒ£ãƒ³ã¨ç•°å¸¸æ¤œå‡ºã®é‡å¤§åº¦ã‚’è»½æ¸›ã™ã‚‹ãŸã‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">BattlEyeã¯ã“ã®ç‰¹å®šã®7zipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">module::check_7zip</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> sz_7zipdll = <span class="hljs-string">"..\..\Plugins\ZipUtility\ThirdParty\7zpp\dll\Win64\7z.dll"</span>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(sz_7zipdll
    <span class="hljs-keyword">if</span> (module_handle &amp;&amp; *(<span class="hljs-keyword">int</span>*)(module_handle + <span class="hljs-number">0x1000</span>) != <span class="hljs-number">0xFF1441C7</span>)<font></font>
    {<font></font>
      sevenzip_report.unknown_1 = <span class="hljs-number">0</span>
      sevenzip_report.report_id = <span class="hljs-number">0x46</span>
      sevenzip_report.unknown_2 = <span class="hljs-number">0</span>
      sevenzip_report.data1 = *(__int64*)(module_handle + <span class="hljs-number">0x1000</span>
      sevenzip_report.data2 = *(__int64*)(module_handle + <span class="hljs-number">0x1008</span>
      battleye::report(&amp;sevenzip_report, <span class="hljs-keyword">sizeof</span>(sevenzip_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚¢ãƒ–ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€å‹•çš„ã«ãƒªãƒ³ã‚¯ã•ã‚ŒãŸWindowsãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚¢ãƒ–ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆhal.dllï¼‰ã®å­˜åœ¨ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ã‚²ãƒ¼ãƒ å†…ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€šçŸ¥ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">module::check_hal</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"hal.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
        hal_report.unknown_1 = <span class="hljs-number">0</span>
        hal_report.report_id = <span class="hljs-number">0x46</span>
        hal_report.unknown_2 = <span class="hljs-number">2</span>
        hal_report.data1 = *(__int64*)(module_handle + <span class="hljs-number">0x1000</span>
        hal_report.data2 = *(__int64*)(module_handle + <span class="hljs-number">0x1008</span>
        battleye::report(&amp;hal_report, <span class="hljs-keyword">sizeof</span>(hal_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”»åƒãƒã‚§ãƒƒã‚¯</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã¯ã€ã‚²ãƒ¼ãƒ ã«èª­ã¿è¾¼ã¾ã‚ŒãŸã•ã¾ã–ã¾ãªç”»åƒã‚‚ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€ä½•ã‚‰ã‹ã®æ–¹æ³•ã§æ“ä½œã•ã‚Œã€ãã®å‹•ä½œãŒæ‚ªæ„ã®ã‚ã‚‹ã‚‚ã®ã«å¤‰æ›´ã•ã‚ŒãŸç½²åæ¸ˆã¿ã®ç”»åƒã§ã‚ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ãŒã€ãã‚Œã‚‰ã«ã¤ã„ã¦ã¯ä½•ã‚‚è¨€ãˆã¾ã›ã‚“ã€‚æ¤œå‡ºã«ã¤ã„ã¦ã®ã¿ã§ã™ã€‚</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvToolsExt64_1</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_nvtoolsext64_1<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"nvToolsExt64_1.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
      nvtools_report.unknown = <span class="hljs-number">0</span>
      nvtools_report.report_id = <span class="hljs-number">0x48</span>
      nvtools_report.module_id = <span class="hljs-number">0x5A8</span><font></font>
      nvtools_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage<font></font>
      battleye::report(&amp;nvtools_report, <span class="hljs-keyword">sizeof</span>(nvtools_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ws2detour_x96</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_ws2detour_x96<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"ws2detour_x96.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
      ws2detour_report.unknown = <span class="hljs-number">0</span>
      ws2detour_report.report_id = <span class="hljs-number">0x48</span>
      ws2detour_report.module_id = <span class="hljs-number">0x5B5</span><font></font>
      ws2detour_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage<font></font>
      battleye::report(&amp;ws2detour_report, <span class="hljs-keyword">sizeof</span>(ws2detour_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">networkdllx64</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_networkdllx64<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"networkdllx64.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> dos_header = (DOS_HEADER*)module_handle
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> pe_header = (PE_HEADER*)(module_handle + dos_header-&gt;e_lfanew
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> size_of_image = pe_header-&gt;SizeOfImage<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (size_of_image &lt; <span class="hljs-number">0x200000</span> || size_of_image &gt;= <span class="hljs-number">0x400000</span>)<font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (pe_header-&gt;sections[DEBUG_DIRECTORY].size == <span class="hljs-number">0x1B20</span>)<font></font>
            {<font></font>
                networkdll64_report.unknown = <span class="hljs-number">0</span>
                networkdll64_report.report_id = <span class="hljs-number">0x48</span>
                networkdll64_report.module_id = <span class="hljs-number">0x5B7</span><font></font>
                networkdll64_report.data = pe_header-&gt;TimeDatestamp<font></font>
                battleye::report(&amp;networkdll64_report, <span class="hljs-keyword">sizeof</span>(networkdll64_report), <span class="hljs-number">0</span><font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">else</span><font></font>
        {<font></font>
            networkdll64_report.unknown = <span class="hljs-number">0</span>
            networkdll64_report.report_id = <span class="hljs-number">0x48</span>
            networkdll64_report.module_id = <span class="hljs-number">0x5B7</span><font></font>
            networkdll64_report.data = pe_header-&gt;sections[DEBUG_DIRECTORY].size<font></font>
            battleye::report(&amp;networkdll64_report, <span class="hljs-keyword">sizeof</span>(networkdll64_report), <span class="hljs-number">0</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nxdetours_64</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_nxdetours_64<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"nxdetours_64.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
      nxdetours64_report.unknown = <span class="hljs-number">0</span>
      nxdetours64_report.report_id = <span class="hljs-number">0x48</span>
      nxdetours64_report.module_id = <span class="hljs-number">0x5B8</span><font></font>
      nxdetours64_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage<font></font>
      battleye::report(&amp;nxdetours64_report, <span class="hljs-keyword">sizeof</span>(nxdetours64_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvcompiler</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_nvcompiler<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"nvcompiler.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
      nvcompiler_report.unknown = <span class="hljs-number">0</span>
      nvcompiler_report.report_id = <span class="hljs-number">0x48</span>
      nvcompiler_report.module_id = <span class="hljs-number">0x5BC</span>
      nvcompiler_report.data = *(<span class="hljs-keyword">int</span>*)(module_handle + <span class="hljs-number">0x1000</span>
      battleye::report(&amp;nvcompiler_report, <span class="hljs-keyword">sizeof</span>(nvcompiler_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wmp</font></font></h1><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> <span class="hljs-keyword">module</span>::check_wmp<font></font>
{<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> module_handle = GetModuleHandleA(<span class="hljs-string">"wmp.dll"</span>
    <span class="hljs-keyword">if</span> (module_handle)<font></font>
    {<font></font>
      wmp_report.unknown = <span class="hljs-number">0</span>
      wmp_report.report_id = <span class="hljs-number">0x48</span>
      wmp_report.module_id = <span class="hljs-number">0x5BE</span>
      wmp_report.data = *(<span class="hljs-keyword">int</span>*)(module_handle + <span class="hljs-number">0x1000</span>
      battleye::report(&amp;wmp_report, <span class="hljs-keyword">sizeof</span>(wmp_report), <span class="hljs-number">0</span><font></font>
    }<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ—æŒ™è­˜åˆ¥å­</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‚è€ƒã¾ã§ã«ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åˆ—æŒ™IDã‚’ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">enum</span> module_id<font></font>
{<font></font>
    nvtoolsext64    = <span class="hljs-number">0x5A8</span>,<font></font>
    ws2detour_x96   = <span class="hljs-number">0x5B5</span>,<font></font>
    networkdll64    = <span class="hljs-number">0x5B7</span>,<font></font>
    nxdetours_64    = <span class="hljs-number">0x5B8</span>,<font></font>
    nvcompiler      = <span class="hljs-number">0x5BC</span>,<font></font>
    wmp             = <span class="hljs-number">0x5BE</span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BattlEyeã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®TCPæ¥ç¶šã®ãƒªã‚¹ãƒˆï¼ˆTCPãƒ†ãƒ¼ãƒ–ãƒ«ã¨å‘¼ã°ã‚Œã‚‹ï¼‰ã‚’æ¤œç´¢ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‰ã‚¤ãƒ„ã®æ”¯æ‰•ã„å…ˆã®Webã‚µã‚¤ãƒˆã«å±ã™ã‚‹Cloudflareã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®å°‘ãªãã¨ã‚‚1ã¤ã«æ¥ç¶šã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’å ±å‘Šã—ã¾ã™-cheatã¯xera.phã¨å‘¼ã°ã‚Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€ã‚²ãƒ¼ãƒ ã®å®Ÿè¡Œä¸­ã«ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã«è¿½åŠ ã•ã‚Œã¦ãŠã‚Šã€ç°¡å˜ã«èªè­˜ã§ãã¾ã™ã€‚ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®å”¯ä¸€ã®å•é¡Œã¯ã€Cloudflareã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå¾Œã§æ‰€æœ‰è€…ã‚’å¤‰æ›´ã§ãã‚‹ã“ã¨ã§ã™ã€‚ã¾ãŸã€æ–°ã—ã„æ‰€æœ‰è€…ãŒç‰¹å®šã®ãƒãƒ¼ãƒˆã‚’ä»‹ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’é…å¸ƒã™ã‚‹å ´åˆã€ç–‘ã„ãªããƒãƒ¼ãƒˆã®èª¤æ¤œçŸ¥ãŒç™ºç”Ÿã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pay-to- </font><em><font style="vertical-align: inherit;">Cheat xera.ph</font></em><font style="vertical-align: inherit;">ã‚µãƒ¼ãƒ“ã‚¹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½¼ã‚‰ã¯é•·ã„é–“ã€å½¼ã‚‰ãŒæ•ã¾ãˆã‚‰ã‚Œã¦ã„ã‚‹ã¨å ±å‘Šã—ã¦ãŠã‚Šã€é–‹ç™ºè€…ã¯ãã‚Œã‚’ã©ã†ã«ã‹ã—ã¦å¯¾å‡¦ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xera.ph</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®é–‹ç™ºè€…ã«</font><font style="vertical-align: inherit;">å½¼ã‚‰ã®æ„šã‹ãªæŒ¯ã‚‹èˆã„ã‚’çŸ¥ã‚‰ã›ã‚‹ãŸã‚ã«</font><font style="vertical-align: inherit;">é€£çµ¡ã‚’å–ã£ãŸãŒã€</font><font style="vertical-align: inherit;">å½¼ã‚‰ã¯ç§ãŸã¡ã‚’èª¤è§£ã—ã€ãƒãƒƒã‚¯ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã§ãã‚‹ã¨ã¯è€ƒãˆãšã«ç„¡æ–™ã®ã‚³ãƒ”ãƒ¼ã‚’é€ã£ãŸã€‚</font><font style="vertical-align: inherit;">ç§ãŸã¡ã¯ã“ã‚Œã‚’è¡Œã„ã¾ã›ã‚“ãŒã€ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã«é–¢ä¸ã—ã¦ã„ã‚‹äººã€…ã«è‘—ä½œæ¨©ã§ä¿è­·ã•ã‚ŒãŸãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç„¡æ–™ã§é€ä¿¡ã—ãªã„ã§ãã ã•ã„ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> network::scan_tcp_table<font></font>
{<font></font>
    <span class="hljs-built_in">memset</span>(local_port_buffer, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(local_port_buffer<font></font>
<font></font>
    <span class="hljs-keyword">for</span> (iteration_index = <span class="hljs-number">0</span> iteration_index &lt; <span class="hljs-number">500</span> ++iteration_index)<font></font>
    {<font></font>
        <span class="hljs-comment">// GET NECESSARY SIZE OF TCP TABLE</span>
        <span class="hljs-keyword">auto</span> table_size = <span class="hljs-number">0</span>
        GetExtendedTcpTable(<span class="hljs-number">0</span>, &amp;table_size, <span class="hljs-literal">false</span>, AF_INET, TCP_TABLE_OWNER_MODULE_ALL, <span class="hljs-number">0</span><font></font>
<font></font>
        <span class="hljs-comment">// ALLOCATE BUFFER OF PROPER SIZE FOR TCP TABLE</span>
        <span class="hljs-keyword">auto</span> allocated_ip_table = (MIB_TCPTABLE_OWNER_MODULE*)<span class="hljs-built_in">malloc</span>(table_size<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (GetExtendedTcpTable(allocated_ip_table, &amp;table_size, <span class="hljs-literal">false</span>, AF_INET, TCP_TABLE_OWNER_MODULE_ALL, <span class="hljs-number">0</span>) != NO_ERROR)
            <span class="hljs-keyword">goto</span> cleanup<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (entry_index = <span class="hljs-number">0</span> entry_index &lt; allocated_ip_table-&gt;dwNumEntries ++entry_index)<font></font>
        {<font></font>
            <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> ip_address_match_1 = <font></font>
                allocated_ip_table-&gt;table[entry_index].dwRemoteAddr == <span class="hljs-number">0x656B1468</span> <span class="hljs-comment">// 104.20.107.101</span><font></font>
<font></font>
            <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> ip_address_match_2 = <font></font>
                allocated_ip_table-&gt;table[entry_index].dwRemoteAddr == <span class="hljs-number">0x656C1468</span> <span class="hljs-comment">// 104.20.108.101</span><font></font>
<font></font>
            <span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> port_match = <font></font>
                allocated_ip_table-&gt;table[entry_index].dwRemotePort == <span class="hljs-number">20480</span><font></font>
<font></font>
            <span class="hljs-keyword">if</span> ( (!ip_address_match_1 &amp;&amp; !ip_address_match_2) || !port_match)
                <span class="hljs-keyword">continue</span><font></font>
<font></font>
            <span class="hljs-keyword">for</span> (port_index = <span class="hljs-number">0</span> 
                 port_index &lt; <span class="hljs-number">10</span> &amp;&amp; <font></font>
                 allocated_ip_table-&gt;table[entry_index].dwLocalPort != <font></font>
                    local_port_buffer[port_index <font></font>
                 ++port_index)<font></font>
            {<font></font>
                <span class="hljs-keyword">if</span> (local_port_buffer[port_index])
                    <span class="hljs-keyword">continue</span><font></font>
<font></font>
                tcp_table_report.unknown = <span class="hljs-number">0</span>
                tcp_table_report.report_id = <span class="hljs-number">0x48</span>
                tcp_table_report.module_id = <span class="hljs-number">0x5B9</span><font></font>
                tcp_table_report.data = <font></font>
                    BYTE1(allocated_ip_table-&gt;table[entry_index].dwLocalPort) | <font></font>
                    (LOBYTE(allocated_ip_table-&gt;table[entry_index.dwLocalPort) &lt;&lt; <span class="hljs-number">8</span><font></font>
<font></font>
                battleye::report(&amp;tcp_table_report, <span class="hljs-keyword">sizeof</span>(tcp_table_report), <span class="hljs-number">0</span><font></font>
<font></font>
                local_port_buffer[port_index] = allocated_ip_table-&gt;table[entry_index].dwLocalPort<font></font>
                <span class="hljs-keyword">break</span><font></font>
<font></font>
            }<font></font>
        }<font></font>
<font></font>
cleanup:<font></font>
        <span class="hljs-comment">// FREE TABLE AND SLEEP</span>
        <span class="hljs-built_in">free</span>(allocated_ip_table<font></font>
        Sleep(<span class="hljs-number">10</span><font></font>
    }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥ã®ã‚¿ã‚¤ãƒ—</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥ä¸‹ã¯ã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã®ã™ã¹ã¦ã®æ—¢çŸ¥ã®ã‚¿ã‚¤ãƒ—ã®é€šçŸ¥ã‚’å‚ç…§ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">enum</span> BATTLEYE_REPORT_ID<font></font>
{<font></font>
    MEMORY_GUARD            = <span class="hljs-number">0x21</span>,<font></font>
    MEMORY_SUSPICIOUS       = <span class="hljs-number">0x2F</span>,<font></font>
    WINDOW_TITLE            = <span class="hljs-number">0x33</span>,<font></font>
    MEMORY                  = <span class="hljs-number">0x35</span>,<font></font>
    PROCESS_ANOMALY         = <span class="hljs-number">0x38</span>,<font></font>
    DRIVER_BEEP_PRESENCE    = <span class="hljs-number">0x3E</span>,<font></font>
    DRIVER_NULL_PRESENCE    = <span class="hljs-number">0x3F</span>,<font></font>
    MISCELLANEOUS_ANOMALY   = <span class="hljs-number">0x3B</span>,<font></font>
    PROCESS_SUSPICIOUS      = <span class="hljs-number">0x40</span>,<font></font>
    LSASS_MEMORY            = <span class="hljs-number">0x42</span>,<font></font>
    SLEEP_ANOMALY           = <span class="hljs-number">0x45</span>,<font></font>
    MEMORY_MODULE_SPECIFIC  = <span class="hljs-number">0x46</span>,<font></font>
    GENERIC_ANOMALY         = <span class="hljs-number">0x48</span>,<font></font>
    MEMORY_MODULE_SPECIFIC2 = <span class="hljs-number">0x5B</span>,<font></font>
}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483054/index.html">ã€Œè™æ®ºã¯ã‚ã‚Šã¾ã›ã‚“ã€-ãƒ¯ãƒ¼ãƒ ã®ç¿»è¨³ã®ç‰©èª</a></li>
<li><a href="../ja483056/index.html">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è«–ç†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€è§£æ¯’å‰¤ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja483058/index.html">ä¼‘æ—¥èª¿æŸ»çµæœ</a></li>
<li><a href="../ja483064/index.html">ã™ã¹ã¦ã®ã‚«ãƒãƒ³ã§æœ€å°ã®åˆ¥åå°ã•ãªãƒ–ãƒ­ã‚°ã®Vue</a></li>
<li><a href="../ja483066/index.html">ãƒ“ãƒ«ãƒ»ã‚²ã‚¤ãƒ„ã®ä¼çµ±çš„ãª5å†Šã®æœ¬</a></li>
<li><a href="../ja483074/index.html">TensorRT 6.xxx-ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã®é«˜æ€§èƒ½æ¨è«–ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ¤œå‡ºã¨ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</a></li>
<li><a href="../ja483078/index.html">æ·±å±¤å¼·åŒ–å­¦ç¿’ï¼šã‚¯ãƒ¢ã«æ­©ãæ–¹ã‚’æ•™ãˆã‚‹æ–¹æ³•</a></li>
<li><a href="../ja483082/index.html">è„†å¼±æ€§ãƒãƒ³ãƒ†ã‚£ãƒ³ã‚°ã¯7ï¼…åŠ¹æœçš„</a></li>
<li><a href="../ja483084/index.html">ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æ©Ÿèƒ½ä»˜ãã‚«ãƒ¡ãƒ©</a></li>
<li><a href="../ja483086/index.html">2019å¹´ã®çµæœï¼šãƒ­ã‚·ã‚¢ã®æŠ•è³‡å®¶ã«ã¨ã£ã¦æœ€ã‚‚åç›Šæ€§ã®é«˜ã„è³‡ç”£ã¯ã©ã‚Œã‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>