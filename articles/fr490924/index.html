<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🎤 🙆🏿 ❣️ Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 2: Introduction au langage de programmation 🙏 📃 🤴🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Historiquement, les utilitaires de ligne de commande sur les systèmes Unix sont mieux développés que sur Windows, cependant, avec l'avènement d'une no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Qu'est-ce que Windows PowerShell et que mange-t-il? Partie 2: Introduction au langage de programmation</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490924/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Historiquement, les utilitaires de ligne de commande sur les systèmes Unix sont mieux développés que sur Windows, cependant, avec l'avènement d'une nouvelle solution, la situation a changé.</font></font></i></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour PowerShell, vous pouvez écrire des scripts dans un langage multi-paradigme interprété qui contient des éléments de programmation procédurale classique, orientée objet et même fonctionnelle: ramification conditionnelle, boucles, variables, tableaux, tables de hachage, classes, gestion des erreurs, ainsi que fonctions, applets de commande et pipelines . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'article précédent</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> était consacré aux bases du travail dans un environnement, et maintenant nous proposons à nos lecteurs un petit guide pour les programmeurs.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table des matières:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaires </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables et leurs types </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables système </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portées </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Variables d' </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">environnement ( </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arithmétique </font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">) </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateurs </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">arithmétiques et de comparaison </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Opérateurs d'affectation </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateurs logiques </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transition conditionnelle </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boucles </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableaux </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tables de hachage </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion des erreurs Vous</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
pouvez écrire du code dans n'importe quel éditeur de texte ou en utilisant l'environnement de développement intégré - la façon la plus simple de prendre Windows PowerShell ISE inclus avec les systèmes d'exploitation Microsoft Server. </font><font style="vertical-align: inherit;">Cela n'est nécessaire que pour des scripts assez complexes: les ensembles courts de commandes sont plus faciles à exécuter de manière interactive.</font></font><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commentaires</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de commentaires est considérée comme faisant partie d'un bon style de programmation avec une indentation et des espaces appropriés:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-comment">#       —     .</span><font></font>
<font></font>
<span class="hljs-comment">&lt;# 

             . 
            .

#&gt;</span></code></pre><br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables et leurs types</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables dans PowerShell sont des objets nommés. </font><font style="vertical-align: inherit;">Leurs noms peuvent inclure un trait de soulignement, ainsi que des lettres et des chiffres. </font><font style="vertical-align: inherit;">Le symbole $ est toujours utilisé avant le nom, et pour déclarer une variable, il suffit d'indiquer à l'interpréteur un nom valide: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/f_/bo/jwf_bojczpfg_r16puek7uuo4r0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour initialiser la variable (lui attribuer une valeur), l'opérateur d'affectation (symbole =) est utilisé:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span> = <span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez déclarer une variable en indiquant son type entre crochets (opérateur de conversion de type) avant le nom ou la valeur:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span><font></font>
<font></font>
<span class="hljs-variable">$test</span> = [<span class="hljs-built_in">int</span>]<span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de comprendre que les variables dans PowerShell sont des objets (classes) complets avec des propriétés et des méthodes dont les types sont basés sur ceux disponibles dans .NET Core. </font><font style="vertical-align: inherit;">Nous listons les principaux:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type (classe .NET)</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La description</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de code</font></font><br>
</th>
</tr>
<tr>
<td>[string]<br>
System.String<br>
</td>
<td> Unicode&nbsp;<br>
</td>
<td>$test = «»<br>
$test = ''<br>
</td>
</tr>
<tr>
<td>[char]<br>
System.Char<br>
</td>
<td> Unicode (16 )<br>
</td>
<td>[char]$test = 'c'<br>
</td>
</tr>
<tr>
<td>[bool]<br>
System.Boolean<br>
</td>
<td>  (  True  False)<br>
</td>
<td>[bool]$test = $true<br>
</td>
</tr>
<tr>
<td>[int]<br>
System.Int32<br>
</td>
<td>   (32 )<br>
</td>
<td>[int]$test = 123456789<br>
</td>
</tr>
<tr>
<td>[long]<br>
System.Int64<br>
</td>
<td>   (64 )<br>
</td>
<td>[long]$test = 12345678910<br>
</td>
</tr>
<tr>
<td>[single]<br>
System.Single<br>
</td>
<td>      32 <br>
</td>
<td>[single]$test = 12345.6789<br>
</td>
</tr>
<tr>
<td>[double]<br>
System.Double<br>
</td>
<td>      64  (8 )<br>
</td>
<td>[double]$test = 123456789.101112<br>
</td>
</tr>
<tr>
<td>[decimal]<br>
System.Decimal<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nombre à virgule flottante de 128 bits (assurez-vous d'inclure d à la fin)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[décimal] $ test = 12345.6789d</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[DateTime] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.DateTime</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">date et l'heure&nbsp;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = Get-Date</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tableau] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Object []</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un tableau dont l'indice d'élément commence à 0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_array = 1, 2, "test", 3, 4</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[table de hachage] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Collections.Hashtable</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tables de hachage - tableaux associatifs avec des clés nommées, construits sur le principe: @ {key = "value"}</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_hashtable = @ {one = "one"; </font><font style="vertical-align: inherit;">deux = "deux"; </font><font style="vertical-align: inherit;">trois = "trois"}</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell prend en charge la conversion de type implicite, en outre, le type de la variable peut changer à la volée (par exemple, en utilisant l'opérateur d'affectation) si elle n'est pas spécifiée de force - dans ce cas, l'interpréteur générera une erreur. </font><font style="vertical-align: inherit;">Vous pouvez déterminer le type d'une variable à partir de l'exemple précédent en appelant la méthode GetType ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span>.GetType().FullName</code></pre><br>
<img src="https://habrastorage.org/webt/j5/qf/vp/j5qfvplzg-n84l33ie1ogez8gp4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe un certain nombre d'applets de commande pour la gestion des variables. </font><font style="vertical-align: inherit;">Leur liste sous une forme pratique est affichée à l'aide de la commande:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Noun</span> Variable | <span class="hljs-built_in">ft</span> <span class="hljs-literal">-Property</span> Name, Definition <span class="hljs-literal">-AutoSize</span> <span class="hljs-literal">-Wrap</span></code></pre><br>
<img src="https://habrastorage.org/webt/za/qc/1t/zaqc1t0hf3-onpravup8_h0euou.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour afficher les variables déclarées et leurs valeurs, vous pouvez utiliser l'applet de commande spéciale:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette méthode semble trop lourde, il est beaucoup plus pratique de travailler avec des variables via des opérateurs ou en accédant directement à leurs propriétés et méthodes. </font><font style="vertical-align: inherit;">Cependant, les applets de commande ont le droit d'exister car elles vous permettent de spécifier des paramètres supplémentaires. </font><font style="vertical-align: inherit;">Il est important de comprendre que les variables utilisateur ne sont définies que dans la session en cours. </font><font style="vertical-align: inherit;">Après avoir fermé la console ou terminé le script, ils sont supprimés.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables système</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de celles déclarées par l'utilisateur, il existe des variables (système) intégrées qui ne sont pas supprimées après la fin de la session en cours. </font><font style="vertical-align: inherit;">Ils sont divisés en deux types, tandis que les données d'état PowerShell sont stockées dans des variables automatiques, auxquelles aucune valeur arbitraire ne peut être attribuée par elles-mêmes. </font><font style="vertical-align: inherit;">Ceux-ci incluent, par exemple, $ PWD:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PWD</span>.Path</code></pre><br>
<img src="https://habrastorage.org/webt/8u/-5/p1/8u-5p10pygkqcoql1kymnbl3q-g.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour stocker les paramètres utilisateur, vous avez besoin de variables de préférence dont les valeurs peuvent être modifiées. </font><font style="vertical-align: inherit;">Par exemple, à l'aide de $ ErrorActionPreference, la réponse de l'interpréteur de commandes à l'apparition d'erreurs non critiques est définie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des opérateurs et des applets de commande, le pseudo-accumulateur Variable: existe pour accéder aux variables déclarées. </font><font style="vertical-align: inherit;">Vous pouvez travailler avec lui par analogie avec d'autres lecteurs, et les variables dans ce cas ressemblent aux objets du système de fichiers:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Variable: | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">ls</span> Variable: | more</code></pre><br>
<img src="https://habrastorage.org/webt/h4/03/9e/h4039eawh2tpbuqpyqsidabwkyk.png" alt="image"><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portées</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les variables dans PowerShell, il y a la notion de portée. </font><font style="vertical-align: inherit;">L'action de la zone globale (Global) s'étend à toute la session en cours - elle inclut, par exemple, les variables système. </font><font style="vertical-align: inherit;">Les variables locales ne sont disponibles que dans la zone où elles ont été définies: disons à l'intérieur de la fonction. </font><font style="vertical-align: inherit;">Il y a aussi le concept d'une portée de script, mais pour les commandes de script, c'est essentiellement local. </font><font style="vertical-align: inherit;">Par défaut, lors de la déclaration de variables, on leur donne une portée locale, et pour changer cela, nous avons besoin d'une construction spéciale du formulaire: $ Global: variable = value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, comme ceci:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$Global:test</span> = <span class="hljs-number">100</span></code></pre><br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables d'environnement</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre pseudo-lecteur Env est disponible auprès de PowerShell, qui peut être utilisé pour accéder aux variables d'environnement. </font><font style="vertical-align: inherit;">Lorsque le shell démarre, ils sont copiés à partir du processus parent (c'est-à-dire du programme qui a lancé la session en cours) et généralement leurs valeurs initiales coïncident avec les valeurs du panneau de contrôle. </font><font style="vertical-align: inherit;">Pour afficher les variables d'environnement, utilisez l'applet de commande Get-ChildItem ou ses alias (liaisons): ls et dir.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> Env:</code></pre><br>
<img src="https://habrastorage.org/webt/rf/3d/19/rf3d19syyr5ouu4jnrnnf68gul4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces variables sont des séquences d'octets (ou des caractères, si vous le souhaitez), dont l'interprétation ne dépend que du programme qui les utilise. </font><font style="vertical-align: inherit;">* -Les applets de commande variables ne fonctionnent pas avec les variables d'environnement. </font><font style="vertical-align: inherit;">Pour y accéder, vous devrez utiliser le préfixe de disque:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$env:TEST</span> = <span class="hljs-string">"Hello, World!"</span></code></pre><br>
<img src="https://habrastorage.org/webt/iq/fk/zv/iqfkzvl82gwr-uxadfpudoladtg.png" alt="image"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateurs arithmétiques et de comparaison</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell possède les opérateurs arithmétiques suivants: + (addition), - (soustraction), * (multiplication), / (division) et% (module ou reste de division). </font><font style="vertical-align: inherit;">Le résultat d'une expression arithmétique est calculé de gauche à droite conformément à l'ordre d'opérations généralement accepté, et des parenthèses sont utilisées pour regrouper des parties de l'expression. </font><font style="vertical-align: inherit;">Les espaces entre opérateurs sont ignorés, ils ne sont utilisés que pour faciliter la perception. </font><font style="vertical-align: inherit;">L'opérateur + concatène également et l'opérateur * répète les lignes. </font><font style="vertical-align: inherit;">Si vous essayez d'ajouter un nombre à une chaîne, il sera converti en chaîne. </font><font style="vertical-align: inherit;">De plus, PowerShell possède de nombreux opérateurs de comparaison qui vérifient la correspondance entre deux valeurs et renvoient un booléen True ou False:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateur</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La description</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de code</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-eq</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Égal (analogique = ou == dans d'autres langues)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -eq 123&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ne</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pas égal (analogique &lt;&gt; ou! =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ne 123&nbsp;&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supérieur à / Plus (analogique&gt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -gt 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ge</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supérieur ou égal / Supérieur ou égal (analogique&gt; =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ge 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-lt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moins de (analogique &lt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -lt 123&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-le</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inférieur ou égal / Inférieur ou égal (analogique &lt;=)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -le 123</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe d'autres opérateurs similaires qui permettent, par exemple, de comparer des chaînes avec un caractère générique ou d'utiliser des expressions régulières pour faire correspondre des modèles. </font><font style="vertical-align: inherit;">Nous les examinerons en détail dans les articles suivants. </font><font style="vertical-align: inherit;">Les symboles &lt;,&gt; et = ne sont pas utilisés pour la comparaison, car ils sont utilisés à d'autres fins.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateurs d'affectation</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de l'opérateur le plus courant =, il existe d'autres opérateurs d'affectation: + =, - =, * =, / = et% =. </font><font style="vertical-align: inherit;">Ils changent la valeur avant l'affectation. </font><font style="vertical-align: inherit;">Les opérateurs unaires ++ et - se comportent de manière similaire, qui augmentent ou diminuent la valeur d'une variable - ils concernent également les opérateurs d'affectation.</font></font><br>
<br>
<a name="section8"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opérateurs logiques</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comparaison n'est pas suffisante pour décrire des conditions difficiles. </font><font style="vertical-align: inherit;">Vous pouvez écrire toutes les expressions logiques à l'aide des opérateurs suivants: -et, -ou, -xor, -pas et! .. Ils fonctionnent comme dans d'autres langages de programmation, tandis que vous pouvez utiliser des parenthèses pour spécifier l'ordre de calcul:</font></font><br>
<br>
<pre><code class="powershell hljs">(<span class="hljs-string">""</span> <span class="hljs-operator">-eq</span> <span class="hljs-string">""</span>) <span class="hljs-operator">-and</span> (<span class="hljs-number">100</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>)<font></font>
<font></font>
<span class="hljs-operator">-not</span> (<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>) <font></font>
<font></font>
!(<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>)</code></pre><br>
<a name="section9"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saut conditionnel</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les opérateurs de branchement dans PowerShell sont standard: IF (IF ... ELSE, IF ... ELSEIF ... ELSE) et SWITCH. </font><font style="vertical-align: inherit;">Considérez leur utilisation avec des exemples:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">50</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt;&gt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">5</span>
<span class="hljs-keyword">switch</span> (<span class="hljs-variable">$test</span>) {
     <span class="hljs-number">0</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 0"</span>}
     <span class="hljs-number">1</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 1"</span>}
     <span class="hljs-number">2</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 2"</span>}
     <span class="hljs-number">3</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 3"</span>}
     <span class="hljs-number">4</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 4"</span>}
     <span class="hljs-number">5</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 5"</span>}<font></font>
     default {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 5    "</span>}<font></font>
}<font></font>
</code></pre><br>
<a name="section10"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycles</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe plusieurs types de boucles dans PowerShell: WHILE, DO WHILE, DO UNTIL, FOR et FOREACH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La boucle de précondition fonctionne si / pendant son exécution:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les boucles avec une postcondition fonctionneront au moins une fois, car la condition est vérifiée après l'itération. </font><font style="vertical-align: inherit;">Dans ce cas, DO WHILE fonctionne tant que la condition est vraie, et DO UNTIL - alors qu'elle est fausse:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>)<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">until</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">9</span>)
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le nombre d'itérations de la boucle FOR est connu à l'avance:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>; <span class="hljs-variable">$test</span>++) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span><font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans une boucle FOREACH, itère sur les éléments d'un tableau ou d'une collection (table de hachage):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_collection</span> = <span class="hljs-string">"item1"</span>, <span class="hljs-string">"item2"</span>, <span class="hljs-string">"item3"</span>
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$item</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$test_collection</span>)<font></font>
{<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$item</span><font></font>
}<font></font>
</code></pre><br>
<a name="section11"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableaux</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables PowerShell stockent non seulement des objets uniques (nombre, chaîne, etc.), mais également plusieurs. </font><font style="vertical-align: inherit;">Les variétés les plus simples de ces variables sont les tableaux. </font><font style="vertical-align: inherit;">Un tableau peut être composé de plusieurs éléments, un élément ou être vide, c'est-à-dire </font><font style="vertical-align: inherit;">ne contiennent pas d'éléments. </font><font style="vertical-align: inherit;">Pour le déclarer, utilisez l'opérateur @ (), dont nous aurons besoin dans l'article suivant - il est très important pour ajouter d'autres tableaux au tableau (créer des tableaux multidimensionnels), passer des tableaux à des fonctions comme arguments et des tâches similaires:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>() <span class="hljs-comment">#  </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque le tableau est initialisé, ses valeurs sont répertoriées avec une virgule (opérateur spécial,): </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>) <span class="hljs-comment">#      </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la plupart des cas, l'opérateur @ () peut être omis:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, un tableau d'un élément est initialisé comme suit</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = , <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour accéder aux éléments du tableau, un index entier commençant à zéro et un opérateur d'index (crochets) sont utilisés:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez spécifier plusieurs indices, séparés par des virgules, y compris </font><font style="vertical-align: inherit;">dupliquer:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/vw/5t/qb/vw5tqbcl5agy4603ummtyg984es.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'opérateur </font></font><code>..</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(deux points - l'opérateur de plage) renvoie un tableau d'entiers sur un segment défini par les limites supérieure et inférieure. </font><font style="vertical-align: inherit;">Par exemple, l'expression 1..4 affiche un tableau de quatre éléments @ (1, 2, 3, 4) et l'expression 8..5 affiche un tableau @ (8, 7, 6, 5). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/sk/1h/r-sk1h628lw2hraptfbcukhekgs.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant l'opérateur de plage, vous pouvez initialiser un tableau ($ test_array = 1..4) ou obtenir une tranche, c'est-à-dire </font><font style="vertical-align: inherit;">une séquence d'éléments dans un tableau avec des indices d'un autre. </font><font style="vertical-align: inherit;">Dans ce cas, un nombre négatif -1 indique le dernier élément du tableau, -2 - l'avant-dernier, etc.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..2</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">2</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">1</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">2</span><span class="hljs-type">..1</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que les valeurs du tableau d'entiers peuvent être supérieures à la valeur maximale de l'index du tableau de données. </font><font style="vertical-align: inherit;">Dans ce cas, toutes les valeurs sont renvoyées à la dernière:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..100</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous essayez d'accéder à un seul élément de tableau inexistant, $ null est renvoyé. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/oq/7v/qtoq7vdu_7qt710eszjme9s54rq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans PowerShell, les tableaux peuvent contenir des éléments de différents types ou être fortement typés:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">""</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>
<span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$test_array</span>.count; <span class="hljs-variable">$i</span>++)<font></font>
{<font></font>
          <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test_array</span>[<span class="hljs-variable">$i</span>]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Où la propriété $ test_array.count est le nombre d'éléments dans le tableau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple de création d'un tableau fortement typé:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$test_array</span> = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span></code></pre><br>
<a name="section12"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tables de hachage</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre type de base de variable dans PowerShell est les tables de hachage, également appelées tableaux associatifs. </font><font style="vertical-align: inherit;">La table de hachage est similaire à l'objet JSON et est construite sur une base de valeurs-clés. </font><font style="vertical-align: inherit;">Contrairement aux tableaux ordinaires, l'accès à leurs éléments s'effectue à l'aide de clés nommées, qui sont des propriétés d'objet (vous pouvez également utiliser l'opérateur d'index - crochets). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une table de hachage vide est déclarée à l'aide du symbole de service @ et des crochets de l'opérateur:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la déclaration, vous pouvez immédiatement créer des clés et leur attribuer des valeurs:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{one=<span class="hljs-string">""</span>; two=<span class="hljs-string">""</span>; three=<span class="hljs-string">""</span>; <span class="hljs-string">"some key"</span>=<span class="hljs-string">"some value"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter un élément à la table de hachage, vous devez lui affecter une clé qui n'existe pas encore ou utiliser la méthode Add (). </font><font style="vertical-align: inherit;">Si l'affectation est effectuée avec une clé existante, sa valeur changera. </font><font style="vertical-align: inherit;">Pour supprimer un élément d'une table de hachage, utilisez la méthode Remove ().</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span>.<span class="hljs-string">"some key"</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">"some key"</span>]
<span class="hljs-variable">$test_hashtable</span>.Add(<span class="hljs-string">"four"</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable">$test_hashtable</span>.five = <span class="hljs-string">""</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">'five'</span>] = <span class="hljs-string">" "</span>
<span class="hljs-variable">$test_hashtable</span>.Remove(<span class="hljs-string">"one"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/tm/lu/rr/tmlurrhp6hctdugfaqilt06j3le.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les variables de ce type peuvent être transmises en tant qu'arguments aux fonctions et applets de commande - dans l'article suivant, nous allons apprendre à le faire, et également considérer un autre type similaire - PSCustomObject. </font></font><br>
<br>
<a name="section13"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fonctions</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell possède tous les éléments nécessaires à la programmation procédurale, y compris les fonctions. </font><font style="vertical-align: inherit;">Le mot fonction Function est utilisé pour les décrire, après quoi il est nécessaire d'indiquer le nom de la fonction et le corps entre crochets opérateur. </font><font style="vertical-align: inherit;">Si nécessaire, passez des arguments à la fonction, vous pouvez les spécifier immédiatement après le nom entre parenthèses.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> - <span class="hljs-params">(1, ..., N)</span></span> <font></font>
{ <font></font>
        - <font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fonction renvoie toujours un résultat - il s'agit d'un tableau des résultats de toutes ses instructions, s'il y en a plusieurs. </font><font style="vertical-align: inherit;">S'il existe une instruction, une seule valeur du type correspondant est renvoyée. </font><font style="vertical-align: inherit;">La construction return $ value ajoute un élément avec la valeur $ value au tableau de résultats et abandonne la liste d'instructions, et une fonction vide renvoie $ null. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, créez une fonction pour mettre au carré un nombre:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sqr</span> <span class="hljs-params">(<span class="hljs-variable">$number</span>)</span></span><font></font>
{<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$number</span> * <span class="hljs-variable">$number</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez que dans le corps de la fonction, vous pouvez utiliser toutes les variables déclarées avant son appel, et les fonctions d'appel dans PowerShell peuvent sembler inhabituelles: les arguments (le cas échéant) ne sont pas placés entre parenthèses et sont séparés par des espaces. </font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou alors:</font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-literal">-number</span> <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En raison de la façon dont les arguments sont passés, la fonction elle-même doit parfois être placée entre crochets:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_func</span> <span class="hljs-params">(<span class="hljs-variable">$n</span>)</span></span> {}<font></font>
test_func <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>     <span class="hljs-comment">#   </span>
(test_func) <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>   <span class="hljs-comment">#   — $true</span></code></pre><br>
<img src="https://habrastorage.org/webt/df/kv/mx/dfkvmx4lst2rmo68c0disf_ovl0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la description d'une fonction, vous pouvez affecter des valeurs par défaut aux arguments:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span> <span class="hljs-params">(<span class="hljs-variable">$arg</span> = value)</span></span> {
         <span class="hljs-comment"># </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe une autre syntaxe pour décrire les arguments de la fonction, en outre, les paramètres peuvent être lus à partir du pipeline - tout cela sera utile dans le prochain article lorsque nous considérons les modules exportés et créons vos propres applets de commande.</font></font><br>
<br>
<a name="section14"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erreur de traitement</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell a un mécanisme Try ... Catch ... Enfin pour gérer les exceptions. </font><font style="vertical-align: inherit;">Le bloc Try contient du code dans lequel une erreur peut se produire et le bloc Catch contient son gestionnaire. </font><font style="vertical-align: inherit;">S'il n'y a pas eu d'erreur, il n'est pas exécuté. </font><font style="vertical-align: inherit;">Le bloc Final est exécuté après le bloc Try, quelle que soit l'occurrence d'une erreur, et il peut y avoir plusieurs blocs Catch pour des exceptions de différents types. </font><font style="vertical-align: inherit;">L'exception elle-même est écrite dans la variable de non-déclaration par défaut ($ _) et peut être facilement récupérée. </font><font style="vertical-align: inherit;">Dans l'exemple ci-dessous, nous implémentons une protection contre la saisie d'une valeur incorrecte:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
        [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-string">" "</span>
        <span class="hljs-number">100</span> / <span class="hljs-variable">$test</span><font></font>
<font></font>
} <span class="hljs-keyword">catch</span> {<font></font>
<font></font>
         <span class="hljs-built_in">Write-Warning</span> <span class="hljs-string">" "</span>
         <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$_</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/tc/3s/e0/tc3se0iqqbes07g8jm0_zitavgw.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C’est là que les bases de la programmation PowerShell sont concernées. </font><font style="vertical-align: inherit;">Dans les articles suivants, nous étudierons plus en détail le travail avec des variables de différents types, collections, expressions régulières, la création de fonctions, de modules et d'applets de commande personnalisées, ainsi que la programmation orientée objet. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie 1: les principales fonctionnalités de Windows PowerShell </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie 3: passage de paramètres aux scripts et fonctions, création d'applets de commande </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie 4: Utilisation d'objets, de classes personnalisées</font></font><br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490908/index.html">Stockage des données de zone</a></li>
<li><a href="../fr490912/index.html">Comment nous, chez Sportmaster, avons choisi un système de mise en cache. Partie 1</a></li>
<li><a href="../fr490916/index.html">Problèmes d'interaction avec des équipes externes sur de grands projets</a></li>
<li><a href="../fr490918/index.html">Andrei Zaretsky, Alexander Trukhanov (suite): "Nous n'avions pas de nom, mais il y avait de l'arrogance"</a></li>
<li><a href="../fr490920/index.html">Accélérez votre recherche dans Have I Been Pwned à 49 microsecondes (C ++)</a></li>
<li><a href="../fr490926/index.html">Trajectoire Unity Ball 2D pour les débutants</a></li>
<li><a href="../fr490932/index.html">[Prévision] Motornet - un réseau d'échange de données pour les véhicules robotisés</a></li>
<li><a href="../fr490936/index.html">Créer ML sur iOS</a></li>
<li><a href="../fr490938/index.html">Nous écrivons des milliers de fichiers journaux à la fois</a></li>
<li><a href="../fr490940/index.html">Faire un quadricoptère à l'aide d'une imprimante 3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>