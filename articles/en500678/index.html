<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❤️ 👩🏻‍🤝‍👨🏼 🎣 ClickHouse for Advanced Users in Questions and Answers 👐 🕜 🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In April, Avito engineers gathered for online gatherings with ClickHouse chief developer Alexei Milovidov and Kirill Shvakov, a Golang developer from ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ClickHouse for Advanced Users in Questions and Answers</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avito/blog/500678/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In April, Avito engineers gathered for online gatherings with ClickHouse chief developer Alexei Milovidov and Kirill Shvakov, a Golang developer from Integros. </font><font style="vertical-align: inherit;">They discussed how we use the database management system and what difficulties we are having.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Based on the meeting, we collected an article with expert answers to our and audience questions about backups, data resharding, external dictionaries, the Golang driver and ClickHouse version updates. </font><font style="vertical-align: inherit;">It may be useful to developers who are already actively working with Yandex DBMS and are interested in its present and future. </font><font style="vertical-align: inherit;">The default answer is Alexey Milovidov, unless otherwise written.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caution, under the cut a lot of text. </font><font style="vertical-align: inherit;">We hope that the content with questions will help you navigate.</font></font></p><br>
<p><img src="https://habrastorage.org/webt/uv/ix/ou/uvixouffnzvqs2ff5pen32ojsc8.png"></p><a name="habracut"></a><br>
<h2 id="soderzhanie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClickHouse is constantly updated, but our data is not. </font><font style="vertical-align: inherit;">What to do with it?</font></font></a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are the best practices for backing up data from ClickHouse at the moment?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Will it be possible to organize a controlled lag of replicas in the shafts?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What if the table structure has changed?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are the best practices for data resharding now?</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> ClickHouse   clickhouse-copier.  &nbsp; ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    ,   .  &nbsp;?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">       &nbsp; &nbsp; ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  &nbsp;  ClickHouse,      ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Kill query   ,     . ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    &nbsp; ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  &nbsp;ClickHouse,     &nbsp;?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   storage_configuration    ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">      Low Cardinality?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">   &nbsp;  &nbsp; &nbsp;  ?</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    &nbsp;ClickHouse &nbsp;  ?</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">       ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  &nbsp;    ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> ClickHouse  .     ,   &nbsp; &nbsp;?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  &nbsp;,     &nbsp;OOM?</a> </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    Golang- &nbsp;ClickHouse?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">    &nbsp; &nbsp;  lazy_load.  ?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  &nbsp;,  system reload dictionaries     &nbsp; ,     &nbsp;  &nbsp;?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">     &nbsp; ClickHouse,     &nbsp;?</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">:    &nbsp;</a></li>
</ul><br>
<blockquote>    ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">&nbsp; -</a>.  — &nbsp;  &nbsp;.</blockquote><br>
<h2 id="anchorold-dataanchorclickhouse-postoyanno-obnovlyaetsya-a-nashi-dannyenbsp-net-chto-snbspetim-delat"><a name="old-data"></a>ClickHouse  ,   &nbsp;— .  &nbsp; ?</h2><br>
<blockquote>ClickHouse  ,   ,   optimize final ,     &nbsp; . <br>
<br>
, &nbsp;  - ,    .   ,  ,   ,   &nbsp; &nbsp; ,    &nbsp; &nbsp;   ClickHouse.   &nbsp; ,    ?</blockquote><p>, &nbsp;   &nbsp;  &nbsp; ,  &nbsp;    , .   &nbsp;,    &nbsp;ClickHouse    .   ,    &nbsp;,    -   . ,   &nbsp;,   ClickHouse    .  . </p><br>
<h2 id="anchorbackup-best-practiciesanchorkakie-luchshie-praktiki-est-nanbspdannyy-moment-ponbsprezervnomu-kopirovaniyu-dannyh-iznbspclickhouse"><a name="backup-best-practicies"></a>    &nbsp;  &nbsp;   &nbsp;ClickHouse?</h2><br>
<blockquote>    &nbsp; ,  &nbsp;   optimize final,    &nbsp;,  ,  , , &nbsp;  ,   &nbsp;    ? <br>
<br>
      &nbsp; :  -  -   .  ,    ,    ? </blockquote><p>&nbsp; &nbsp;  .     &nbsp; &nbsp; &nbsp;  &nbsp; «.»,     .    ,    . </p><br>
<p> , &nbsp;   &nbsp;ClickHouse, &nbsp; .   ,   .    ,     ,    &nbsp; .</p><br>
<p> &nbsp;       &nbsp;      .    —    .</p><br>
<p>  &nbsp;    ,    : </p><br>
<ol>
<li>  ,    — <strong>show create table</strong>.</li>
<li>  &nbsp; ClickHouse  — <strong>select</strong> * <strong>from table</strong> &nbsp;. &nbsp;    &nbsp; TabSeparated.     —  &nbsp; Native. </li>
</ol><br>
<p>   ,        .    ,    &nbsp;  ClickHouse.   ,  &nbsp;        &nbsp;MySQL &nbsp;. </p><br>
<p>    &nbsp;ClickHouse      &nbsp;  .    &nbsp;  <strong>alter table freeze partition</strong>.   <strong>alter table freeze</strong> —    . </p><br>
<p>    &nbsp;  &nbsp; ,          .  &nbsp;    ,   &nbsp;       .   &nbsp;       .      &nbsp;-  &nbsp;,   &nbsp;.</p><br>
<p>    . &nbsp;—   &nbsp;  .      &nbsp;Directory-Detached &nbsp;     <strong>attach partition</strong>.     &nbsp;   . </p><br>
<p>  -  &nbsp;— &nbsp; ,  &nbsp;      &nbsp;    .   ,    &nbsp; &nbsp;«.».       —    ,    . </p><br>
<p>     &nbsp;  .  &nbsp;    ClickHouse     ,        &nbsp;  .    &nbsp;      ,    .    .  &nbsp;—  LVM ,  &nbsp;— ZFS &nbsp;Linux. </p><br>
<p>      ,      - . ,   ,  &nbsp;    .     &nbsp;    ,    .       &nbsp;,      .</p><br>
<h2 id="anchorreplicationanchormozhno-li-budet-organizovat-kontroliruemoe-otstavanie-replik-vnbspvalah"><a name="replication"></a>       &nbsp;?</h2><br>
<blockquote>       &nbsp;ClickHouse.    &nbsp;    ?    &nbsp;    &nbsp;  &nbsp;   . <br>
<br>
   - roll back  ? , &nbsp;    ,  &nbsp;   ,  &nbsp;    ?<br>
<br>
 &nbsp;      ,  &nbsp;    &nbsp;  ,    ,       &nbsp; ,      &nbsp;   ? </blockquote><p>  &nbsp;  .   &nbsp; ,    issue &nbsp; &nbsp;: « -  ,  ,  ».   ,  issue .   ,      ,  ClickHouse. ,   &nbsp;&nbsp;20.3.</p><br>
<p>ClickHouse  &nbsp;   &nbsp;— .   ,      &nbsp;  . &nbsp;  ,   ,   &nbsp; &nbsp;  .</p><br>
<p>-,    &nbsp; ,    select,   , &nbsp;    .  select   &nbsp; .</p><br>
<p>-,     &nbsp;&nbsp;—     &nbsp;  .         &nbsp; .     &nbsp;: &nbsp; &nbsp;  ,  &nbsp;      ,    &nbsp;  .    &nbsp;   ClickHouse   &nbsp; .</p><br>
<p>  ,    &nbsp;.    ,   &nbsp;  ClickHouse    ,     .    &nbsp;- ,   , , <strong>alter drop column</strong>.      &nbsp; .</p><br>
<p>  &nbsp; 20.3,     ,      .    &nbsp;—      ,  .  ,    &nbsp;,   . &nbsp;  ,   ,  , ,    - ,     &nbsp; .    &nbsp;   ,     , &nbsp;  . </p><br>
<p>     .    <strong>alter delete</strong>  <strong>alter update</strong>,    ,   .    .</p><br>
<h2 id="anchorsoooo-changeableanchorkak-byt-esli-struktura-tablicy-pomenyalas"><a name="soooo-changeable"></a> ,    ?</h2><br>
<blockquote>  ,    &nbsp; ?    &nbsp; &nbsp;    .    Btrfs  ZFS &nbsp;Linux LVM?</blockquote><p>   <strong>attach partition</strong>  &nbsp; ,  ClickHouse  ,   .  . &nbsp;—     MergeTree &nbsp; ,    &nbsp; attach,   alter.           attach ,    <strong>alter table move partition</strong>.</p><br>
<p>  &nbsp;—    Btrfs.  ,  &nbsp;  LVM,   LVM ,       ext4,    . &nbsp;Btrts   &nbsp;   .    ,       &nbsp; ,    &nbsp; &nbsp; .      ,  &nbsp;  Btrfs &nbsp;.</p><br>
<h2 id="anchorresharding-best-practicesanchorkakie-seychas-luchshie-praktiki-vnbspreshardinge-dannyh"><a name="resharding-best-practices"></a>    &nbsp; ?</h2><br>
<p> &nbsp;   .      .   &nbsp;    &nbsp;— &nbsp;ClickHouse    .   ,     .    &nbsp;   ,  &nbsp;ClickHouse     . </p><br>
<p>   &nbsp;     &nbsp;,    .    &nbsp; ,  &nbsp; ,    .    ,      &nbsp;,  &nbsp;, .</p><br>
<p> ,    ,&nbsp;—     &nbsp;  &nbsp;  <strong>alter table fetch partition</strong>. ,     &nbsp;,      2017&nbsp;   &nbsp; ,  —    &nbsp;-   .   ,    - .</p><br>
<p>    &nbsp; ,    &nbsp;. &nbsp;    ,      .       &nbsp;.   ,       . &nbsp;     ,        .</p><br>
<p>&nbsp;    ,    &nbsp; ,    &nbsp;  ,      . &nbsp;  &nbsp; &nbsp;  &nbsp;—   &nbsp;.  &nbsp;  select &nbsp;Distributed ,    &nbsp;      . </p><br>
<p> ,   &nbsp;   ,   &nbsp;  .  ,   &nbsp;   &nbsp; ,    ,  . &nbsp;      ,   &nbsp; select  &nbsp;—   ,  ,     &nbsp;—    .</p><br>
<p>     .  &nbsp;     &nbsp;  ,     &nbsp;- ,      ,   &nbsp;Distributed .       ClickHouse    <strong>optimize skip unused shards</strong>. &nbsp;  &nbsp;  select  &nbsp; where  ,   , &nbsp;      .   &nbsp;,     &nbsp; &nbsp;  .     ,   .</p><br>
<p>,    .     ,  ,   .</p><br>
<p><strong> , lead system administrator  </strong>: ,  ,       ,     &nbsp;    .    ,        &nbsp; ,     &nbsp; ,     .      ,  , &nbsp; , &nbsp; -    &nbsp;    .</p><br>
<p><strong> :</strong>    — , ,    . ,  .   &nbsp; ,   &nbsp; .    ,     ,      &nbsp; . </p><br>
<p>   ,   ,    ,    .      &nbsp; .  ,      &nbsp;      ,    &nbsp;    .   &nbsp; , &nbsp;,   &nbsp;  .</p><br>
<p>  &nbsp;     &nbsp; 2019&nbsp;.  ,     &nbsp;2019&nbsp;,    &nbsp; 2019&nbsp;&nbsp;— &nbsp;  ,   &nbsp;-  .        .  &nbsp;    ,    ad hoc ,      .</p><br>
<p>&nbsp;       &nbsp;.  &nbsp;  ,      ,  &nbsp;   .    .</p><br>
<p>, &nbsp;   .    &nbsp; . &nbsp;—   . &nbsp;—  .  &nbsp;—    ,   &nbsp;.     ,   . </p><br>
<p>,  &nbsp;      &nbsp; &nbsp;—    .  &nbsp;    &nbsp; ,    &nbsp;select.   &nbsp;select,  ,   &nbsp;  .</p><br>
<p>,  CPU &nbsp;-  - . ,     , &nbsp;    .    &nbsp; ,  ,     &nbsp; .  &nbsp; , &nbsp;. ,    .</p><br>
<p><strong> :</strong>  &nbsp;,        ,    &nbsp;      &nbsp;.  &nbsp;     &nbsp;  ,  ClickHouse &nbsp;  .</p><br>
<p>  ,   &nbsp;   &nbsp; ,     .  &nbsp; &nbsp;     .  &nbsp; &nbsp; ,        ClickHouse: «   &nbsp;  .   -  &nbsp; -  ,      &nbsp;». </p><br>
<p>   ,    &nbsp;        , &nbsp;      ,     &nbsp;.          .</p><br>
<p><strong> :</strong> &nbsp;, &nbsp;    ,          ,    ,    &nbsp;  . </p><br>
<p>   &nbsp; «.». &nbsp;—   ,   .    &nbsp; -.    «.»,     — avito.ru,  &nbsp;,    &nbsp; .</p><br>
<p>    &nbsp;—   ,    . &nbsp;  ,       &nbsp; «».    ,   «»    &nbsp; .    &nbsp; ,  &nbsp;  .</p><br>
<p>    ,   &nbsp;    ,    ?    &nbsp;,    &nbsp;ClickHouse &nbsp; «» —   &nbsp;. &nbsp;  , ,   &nbsp;   ClickHouse  .</p><br>
<p> &nbsp;—  &nbsp;- .  &nbsp;    Distributed       ,    ,    &nbsp; . &nbsp; ,  &nbsp;,    ,      &nbsp; ,  .</p><br>
<p>   . ,      &nbsp;,   &nbsp;   &nbsp; .         &nbsp;,  &nbsp;  -      .      &nbsp; .     avito.ru.    ,  ,  &nbsp;—   &nbsp;   &nbsp;.    &nbsp;    .</p><br>
<p>      .    &nbsp;  ,    .    &nbsp; &nbsp;  .      . </p><br>
<p>   ?    &nbsp;—       ,   .    &nbsp;      &nbsp;  .    &nbsp; &nbsp;—  &nbsp;   &nbsp;-,     ,   &nbsp; ,     &nbsp;MySQL.  &nbsp;— &nbsp; .      &nbsp; .</p><br>
<p>&nbsp;    &nbsp; &nbsp;  .  &nbsp;     ,   ,  &nbsp; &nbsp; &nbsp; .  ,     -  &nbsp; ,   &nbsp; .    &nbsp;,    .  &nbsp;   &nbsp;Distributed ,   &nbsp;   &nbsp; .    .</p><br>
<p>    ,    ,  &nbsp;   . &nbsp;         &nbsp; clickhouse-copier.</p><br>
<p>&nbsp;     &nbsp; &nbsp;—   .   ,    ,  &nbsp;  ,     &nbsp; ,  120&nbsp; &nbsp;  &nbsp;&nbsp;—   360&nbsp;.    ,      &nbsp; .    &nbsp;«.»     &nbsp;avito.ru,   &nbsp;120&nbsp;.   &nbsp; .      &nbsp;,    .     Distributed ,   &nbsp;  120&nbsp;.</p><br>
<p>  &nbsp;— &nbsp; .    &nbsp; ,      &nbsp; .</p><br>
<h2 id="anchorclickhouse-copieranchorv-clickhouse-est-utilita-clickhouse-copier-mozhete-pronbspneyo-rasskazat"><a name="clickhouse-copier"></a> ClickHouse   clickhouse-copier.  &nbsp; ?</h2><br>
<p> ,         .  &nbsp;,        ,   .    &nbsp;,      .    &nbsp;   &nbsp;  .</p><br>
<p> ,  &nbsp;       .     &nbsp; , ,   ,     ,   . </p><br>
<p>,   ,  .   &nbsp;   Distributed ,      clickhouse-copier,  &nbsp;  ,     ,        .   &nbsp;    &nbsp;  ,   ,      &nbsp; ,   &nbsp;   &nbsp;   .     &nbsp;,       ,    .</p><br>
<p>   clickhouse-copier?     &nbsp;  &nbsp;     &nbsp; .      ,  clickhouse-copier    &nbsp;  &nbsp; ,  ,    &nbsp; &nbsp;—      insert select.  , , ,   ,  -, .    .</p><br>
<h2 id="anchorresharding-toolanchoru-vas-byla-pilotnaya-shtuka-kotoraya-nazyvalas-resharding-chto-snbspney"><a name="resharding-tool"></a>    ,   .  &nbsp;?</h2><br>
<blockquote>    &nbsp;2017   ,   .    &nbsp;ClickHouse.   ,   .  ,   ?     .</blockquote><p>  &nbsp;,  &nbsp;   &nbsp;     &nbsp;,    .     &nbsp;,     ,  ,    .       ,       &nbsp;  &nbsp; ,      —   .</p><br>
<h2 id="anchormove-to-slow-diskanchormozhno-li-slivat-vse-chasti-dannyh-voedino-perednbspperemescheniem-nanbspmedlennye-diski"><a name="move-to-slow-disk"></a>       &nbsp; &nbsp; ?</h2><br>
<blockquote> &nbsp;TTL &nbsp; move to slow disk &nbsp; .   ,   &nbsp;cron,    &nbsp; &nbsp; &nbsp; ?</blockquote><p> &nbsp;,   -     &nbsp; &nbsp; &nbsp;— .  , &nbsp;  .       &nbsp;,    &nbsp;,     &nbsp;  . </p><br>
<p>     . &nbsp;— &nbsp; .  &nbsp;    -   ,        &nbsp;  .    ,  &nbsp;—  .</p><br>
<p>  — &nbsp;.  &nbsp;  .     &nbsp;  &nbsp; ,     .</p><br>
<h2 id="anchorup-to-dateanchorkak-pereezzhat-nanbspnovye-versii-clickhouse-esli-net-vozmozhnosti-zaranee-proverit-sovmestimost"><a name="up-to-date"></a>  &nbsp;  ClickHouse,      ?</h2><br>
<blockquote>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">&nbsp;- ClickHouse</a> &nbsp;  ,   .    &nbsp; 19.11 &nbsp;19.16 , , &nbsp;19.16 &nbsp;20.3.    &nbsp; ,       &nbsp;?</blockquote><p>  «» . &nbsp;— <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> changelog</a>.  ,      &nbsp;  .    &nbsp;   &nbsp; .    ,   &nbsp;  , ,  ,    .</p><br>
<p>&nbsp;—      &nbsp;,      &nbsp;,  &nbsp;—    .     .    ,   ,  ,    ,       &nbsp;   &nbsp; ,    .       &nbsp; .   -    ,     &nbsp;—      . </p><br>
<p>  &nbsp;—   &nbsp;     &nbsp;   &nbsp;    .   &nbsp;  ClickHouse,   . </p><br>
<p>  20.3.4.  20&nbsp;  &nbsp;— 2020. &nbsp;  ,  ,     ,     &nbsp;  . &nbsp;— 20.3.  &nbsp;—    3 —    ,    &nbsp;-  .     &nbsp;ClickHouse - ,     .   &nbsp; 20.4 ClickHouse    .  &nbsp;— 20.3.4. &nbsp;4 —   -, &nbsp;     ,   - .  4&nbsp;,      .</p><br>
<p>  ,   - .       ,     &nbsp;-  &nbsp; &nbsp;.  ,  &nbsp;-  &nbsp; ,      ,      .    .    -,  ClickHouse  .</p><br>
<p> &nbsp; ClickHouse  &nbsp;,     ClickHouse &nbsp;  — ,&nbsp;20.4.1 —  ,     &nbsp; &nbsp;  .    ?      ClickHouse,     , ,  ,   .   ClickHouse   ,   &nbsp;  &nbsp;—    .</p><br>
<p><strong> :</strong>    &nbsp; .       - , ,       ClickHouse,            &nbsp;  .    .</p><br>
<p>  &nbsp; . &nbsp;  ,    ClickHouse.     &nbsp;&nbsp;—    &nbsp;Hetzner &nbsp; ,    .   ,      &nbsp;Ansible,   &nbsp;  ,   — &nbsp;     &nbsp;.</p><br>
<p>  ?     &nbsp; ClickHouse ,   &nbsp;  &nbsp;— &nbsp;Docker, &nbsp;LXC, ,  Ansible playbook,   &nbsp;   .   .     &nbsp;   ,    &nbsp;- .   ,    &nbsp; ,    &nbsp;—   &nbsp;.   ,   .    &nbsp;&nbsp;— .</p><br>
<p><strong> , senior backend engineer :</strong>   &nbsp;  &nbsp;   . &nbsp;     ClickHouse, &nbsp;      ,   &nbsp;.    &nbsp;   &nbsp; .      &nbsp;-,     &nbsp; .     &nbsp;—  &nbsp;,  &nbsp;, , &nbsp;, &nbsp;   &nbsp;    .      &nbsp;       &nbsp;.  ,   ,   &nbsp;  &nbsp;. </p><br>
<p><strong> :</strong> ,        &nbsp;«.».    &nbsp;600 &nbsp;- ,  &nbsp;360,       .   &nbsp;  &nbsp;—     &nbsp;  &nbsp;.   ?    .     .    ,    .</p><br>
<p>           - -.       ,   ,      &nbsp;.</p><br>
<p> .     ClickHouse.   &nbsp; ,    &nbsp; «.»,    &nbsp;   &nbsp;,   .  ,    CI.        .</p><br>
<p> .   &nbsp;.   ,  &nbsp;   &nbsp; .   .   &nbsp;  :    &nbsp;  &nbsp; ,   ,  .     .            .    &nbsp;—   &nbsp;  ,  .</p><br>
<p>     -   .  : « , .  ,   .    &nbsp;,   . ».  ,   ,   —   &nbsp;.     &nbsp;    .</p><br>
<h2 id="anchorkill-queryanchorkill-query-dolzhen-ubivat-zaprosy-no-on-etogo-ne-delaet-pochemu"><a name="kill-query"></a>Kill query   ,     . ?</h2><br>
<blockquote>   , - ,    ,     ClickHouse. -    &nbsp;— &nbsp; &nbsp;, &nbsp;     .  ,    &nbsp;CPU &nbsp;  &nbsp;,  .    ClickHouse &nbsp; .   : « , , process list,     ».<br>
<br>
       kill.  ,    .   &nbsp;, ClickHouse    - , ,   ,   .  &nbsp;  &nbsp;  ,   &nbsp; &nbsp;ClickHouse,   kill query  . ?  ,  kill query   ,    .</blockquote><p>    .  &nbsp;,  kill query   . </p><br>
<p>Kill query    &nbsp; « ,     ».    &nbsp;    &nbsp; .   ,   . ,     ,       .     &nbsp; ,    &nbsp;   .     ,    .</p><br>
<p>   &nbsp;,    &nbsp;- . ,  ,    ,  , &nbsp; ,     . ,     &nbsp;     &nbsp; .  &nbsp;    ,  .  ,   ,&nbsp;—  ClickHouse.</p><br>
<h2 id="anchorreading-timeanchorkak-rasschitat-vremya-otveta-pri-chitayuschey-nagruzke"><a name="reading-time"></a>      ?</h2><br>
<blockquote> , &nbsp;   &nbsp;item&nbsp;—  .  &nbsp;—   .    &nbsp;  ,   1K&nbsp;RPS &nbsp;1K&nbsp;item’? </blockquote><p> &nbsp;,   &nbsp; ,   &nbsp;  &nbsp;—  ,   ,        . </p><br>
<p>    . &nbsp;select&nbsp;1 ClickHouse       &nbsp;,    &nbsp;     .      ,  &nbsp;- key-value  ,   &nbsp;      &nbsp;.  &nbsp;    ,   .      &nbsp;— &nbsp;8192  &nbsp;.       &nbsp;64&nbsp; &nbsp;1&nbsp;.      &nbsp; .     .</p><br>
<p>    .     &nbsp;,   .      &nbsp; ,     ,   &nbsp;   .     1000&nbsp;RPS ClickHouse   ,  &nbsp; ,  .</p><br>
<p>    ClickHouse &nbsp;  ,     &nbsp;—       &nbsp; .    &nbsp;    &nbsp;,   ,  &nbsp;    .</p><br>
<p>, ,   ClickHouse  &nbsp;   .  &nbsp; ? &nbsp;—   . &nbsp;     &nbsp;,  &nbsp;,    &nbsp;       &nbsp;.  &nbsp;   ,  &nbsp;    64.</p><br>
<p>    . &nbsp;   <strong>min compress block size</strong>, <strong>max compress block size</strong>.   ,  ,      .    ClickHouse&nbsp;—   key-value  .    &nbsp;—   .</p><br>
<p><strong> :</strong>   &nbsp;,    .    ,  &nbsp;ClickHouse  - .    ,  &nbsp;- ,  -  ,    - .  MySQL,   &nbsp;— &nbsp;MySQL  duplicate key,   PostgreSQL  conflict&nbsp;—   .     . </p><br>
<p> &nbsp;  ,   ClickHouse  .    ,    &nbsp; . </p><br>
<h2 id="anchorpimp-my-clickhouseanchorchto-podtyunit-v-clickhouse-chtoby-bolshe-dannyh-bylo-vnbspkeshe"><a name="pimp-my-clickhouse"></a>   ClickHouse,     &nbsp;?</h2><br>
<blockquote> &nbsp;— &nbsp;  256&nbsp;&nbsp;, &nbsp;  ClickHouse   60—80&nbsp;, &nbsp; — &nbsp;130.     ,     &nbsp; , ,    &nbsp;?</blockquote><p> , page cache     &nbsp; .     ,   cached  free&nbsp;—   ,  &nbsp;—   ,      &nbsp;.    &nbsp;    &nbsp;,  &nbsp;.     ,    ,      .</p><br>
<p>  ,         ,     ClickHouse  &nbsp; .   <strong>uncompressed cache</strong>.    config.xml  uncompressed cache size    &nbsp;—       ,     &nbsp;page cache. </p><br>
<p> ,     .   — <strong>use uncompressed cache</strong> —   .    &nbsp; ,  ,          .    —  -     &nbsp; .     ,     .</p><br>
<h2 id="anchorstorage-configurationanchorkak-mozhno-nastroit-storage_configuration-dlya-hraneniya-v-operativke"><a name="storage-configuration"></a>   storage_configuration    ?</h2><br>
<blockquote>   ClickHouse   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">&nbsp;data storage</a>. &nbsp;   &nbsp;fast SSD. <br>
<br>
,       &nbsp;volume hot memory.    .   select &nbsp;  ,         ,   &nbsp;,      &nbsp;?     prewhere &nbsp;  ?</blockquote><p>   &nbsp;  ,      .<br>
  . </p><br>
<p>   &nbsp; . ,   &nbsp;&nbsp;—   .   tmpfs ,   &nbsp;-  &nbsp; .    &nbsp;  &nbsp;  &nbsp;  ,       ,  . </p><br>
<p>      -&nbsp; , ,  &nbsp;    &nbsp; -,  .  ,   . ,       .   ,   . ClickHouse  &nbsp; ,  &nbsp;   , ,   ZooKeeper   .  ,     ,    .     . </p><br>
<p>     &nbsp;    &nbsp;  &nbsp;,   &nbsp;  &nbsp;     &nbsp;page cache    .   &nbsp;   .  &nbsp;  ,  ClickHouse   fsync &nbsp;insert.</p><br>
<p>   &nbsp;  &nbsp;   ,   &nbsp;.  select     ,   , &nbsp;    ,   .  prewhere    ,  &nbsp;,   &nbsp;  &nbsp;.</p><br>
<h2 id="anchorlow-cardinalityanchordo-kakogo-kolichestva-unikalnyh-znacheniy-effektiven-low-cardinality"><a name="low-cardinality"></a>      Low Cardinality?</h2><br>
<p>Low Cardinality  .    ,   . -,   &nbsp; , -,         &nbsp; .       &nbsp;— -,  &nbsp;—   ,   .</p><br>
<p> &nbsp;: &nbsp;   — , &nbsp;  — - &nbsp;   Low Cardinality .    fallback,       ,   .      ,     string,  ,   ,      . </p><br>
<h2 id="anchorfulltext-searchanchorkakie-luchshie-praktiki-ponbsppolnotekstovomu-poisku-ponbsptablice-snbsppyatyu-milliardami-strok"><a name="fulltext-search"></a>   &nbsp;  &nbsp; &nbsp;  ?</h2><br>
<p>   . &nbsp;— ,  ClickHouse&nbsp;—    &nbsp; . &nbsp;    , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Elasticsearch</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">Sphinx</a>.   ,     ,  ,   &nbsp;Elasticsearch &nbsp;ClickHouse.</p><br>
<p>  ?    ,  Elasticsearch  &nbsp;   &nbsp;,  &nbsp;,    .    , ,     &nbsp;ClickHouse, ,    &nbsp;   &nbsp;. &nbsp;      ,    &nbsp;   -  &nbsp; ,   . ,  &nbsp;   &nbsp; &nbsp;-  .</p><br>
<p>    &nbsp;ClickHouse  ,   &nbsp;   &nbsp;.        &nbsp; .     ,  ,      - &nbsp; like.  like &nbsp;ClickHouse&nbsp;—     like,    .   &nbsp;—  . </p><br>
<p>   like&nbsp;—  full scan.  full scan      &nbsp;CPU,   &nbsp;.   &nbsp;    &nbsp;,   &nbsp;  - ,    .    &nbsp;  ,  &nbsp;    ,   &nbsp;  &nbsp;SSH  .</p><br>
<p>         .  &nbsp; &nbsp;—  ,   .  ClickHouse    &nbsp;  -.   &nbsp; Arenadata    ,      ,  .</p><br>
<p>     ,   ,    :  &nbsp;   -     .  ,    &nbsp; &nbsp;-  , ,    &nbsp;. &nbsp;  &nbsp;   ,     .</p><br>
<p> &nbsp;ClickHouse      &nbsp; . , -,     &nbsp; , &nbsp;   &nbsp; , &nbsp; , &nbsp; UTF-8   &nbsp;ASCII.   ,   . </p><br>
<p>      &nbsp; .     X&nbsp;like   or&nbsp;X&nbsp;like  .  ,     .</p><br>
<p> —         .  -   &nbsp;,    &nbsp; .</p><br>
<h2 id="anchorhello-and-welcomeanchorkak-luchshe-organizovat-dostup-vnbspclickhouse-dlyanbspbolshogo-kolichestva-polzovateley"><a name="hello-and-welcome"></a>    &nbsp;ClickHouse &nbsp;  ?</h2><br>
<blockquote>,     &nbsp;    .   ,   max concurrent queries,   ?</blockquote><p>   ,        ,     &nbsp;.      &nbsp;  ,      ,  ,  &nbsp;    . &nbsp;   &nbsp;   &nbsp; .      &nbsp;  ,     &nbsp; .</p><br>
<p>     ,    &nbsp;   &nbsp; .     &nbsp; ,       .</p><br>
<p>  &nbsp;,   &nbsp;  .     &nbsp; «.»      <strong>select count from hits</strong>,      ,      .   ,    ,&nbsp;—   ,   &nbsp;    &nbsp; .   . </p><br>
<p>,    &nbsp; ,    .     &nbsp;—   <strong>force index by date</strong>.     ,      .     ,      .  &nbsp;—    where event date between .       ,   and  or — or URL match.   ,     URL     .</p><br>
<p> ,  ClickHouse    . &nbsp;,   .    <strong>priority</strong>.  priority&nbsp;≠&nbsp;0,    &nbsp;- ,  &nbsp;   &nbsp;,    ,     ,   &nbsp;  ,     ,        &nbsp; .</p><br>
<p>   ,     &nbsp; ,  &nbsp;   .   &nbsp; ,   ,  &nbsp;  ,   .</p><br>
<p>    <strong>OS thread priority</strong>.    &nbsp;     nice &nbsp; Linux.    ,  - .      nice&nbsp;—     ,     &nbsp;—  &nbsp; &nbsp;   -19,  CPU      &nbsp;  ,  . </p><br>
<p>      &nbsp;— ,  .    &nbsp;—   .    ,   ,    ,  ClickHouse  ,    .</p><br>
<p>,  :  -       &nbsp;&nbsp;—   .     ,    .    .  &nbsp;   .   <strong>min execution speed</strong> — &nbsp; &nbsp;,    timeout before checking min execution speed&nbsp;—    .     ,  ,  ,     —  .</p><br>
<p>   . &nbsp;ClickHouse    ,    . , &nbsp;,     CPU, ,  &nbsp;—   ,    .   , ,    &nbsp;      &nbsp;.</p><br>
<p>  ?          &nbsp;ClickHouse .    .   &nbsp; &nbsp;  ,   ,  &nbsp;   .     &nbsp;,    &nbsp; . &nbsp;   .</p><br>
<h2 id="anchorsmorgasbordanchormozhno-li-otdat-rezultaty-odnogo-zaprosa-desyati-klientam"><a name="smorgasbord"></a>       ?</h2><br>
<blockquote>    ,    &nbsp;   &nbsp;     .  ,  &nbsp; ,  - ,     ,   .       ,     ,   ,      ?</blockquote><p> &nbsp;,         &nbsp; .  page cache  ,      &nbsp; , , &nbsp;,     ,    . </p><br>
<p>  -   ,    ,     &nbsp;-     .  &nbsp;     pull request,    ,       in  join —    .</p><br>
<p>  , &nbsp;    .   &nbsp;—   &nbsp;.  , &nbsp;   ,    limit 10.    ,  limit 10,10.    .  ,       ?    ,     .</p><br>
<p>  ,     &nbsp;ClickHouse — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">ClickHouse Proxy</a>.</p><br>
<p><strong> :</strong> &nbsp;ClickHouse Proxy        .     ,     . Proxy   ,   &nbsp;,  ,  &nbsp;   .     , Proxy    ,   &nbsp;ClickHouse  .</p><br>
<p> Nginx      ,     . &nbsp;Nginx   , ,    ,    ,    .   &nbsp;ClickHouse Proxy    .    &nbsp;ClickHouse,    ,   .    . </p><br>
<h2 id="anchorasynchronousanchorkak-byt-snbspasinhronnymi-operaciyami-i-materializovannymi-predstavleniyami"><a name="asynchronous"></a>  &nbsp;    ?</h2><br>
<blockquote>  ,   &nbsp;- &nbsp;—   ,    .  &nbsp;    &nbsp;- ,   &nbsp; .    -  ,    .    &nbsp;?<br>
<br>
  &nbsp;—   &nbsp;   &nbsp;  .   - « »,  &nbsp;  ?</blockquote><p>  &nbsp;,   . , &nbsp;   ,   &nbsp;,  &nbsp;   &nbsp; .</p><br>
<p>  &nbsp;      .         ,         &nbsp;   ,   .   “Ok” &nbsp; &nbsp;insert,       ,     .</p><br>
<p>  &nbsp;.  &nbsp;  &nbsp; “Ok”,    .     &nbsp;ClickHouse,    ,    .   &nbsp;   ,    ,    .  &nbsp;—    .   &nbsp;   ,     ,   .   &nbsp; . </p><br>
<p>  ,    &nbsp; .     &nbsp; &nbsp; ,  &nbsp;     .</p><br>
<p> &nbsp; . &nbsp;   ,       .      ,    ,   &nbsp; . ,    &nbsp; ,  &nbsp;    ,  &nbsp;  &nbsp;   .    &nbsp;—       &nbsp;insert. &nbsp;    &nbsp;  .</p><br>
<p>      .      &nbsp; . ,   &nbsp;     ,   ,  ,    .   ,  .   ,   . </p><br>
<p><strong> :</strong> &nbsp;   &nbsp;    .  ,    ,    ,     &nbsp; —   .    , ,   ,      .   ,   &nbsp;—     .       .</p><br>
<p>    ?  ,   &nbsp;—   &nbsp; ,   &nbsp;.  &nbsp;-     ,     .     ,      ,    ,   &nbsp;   .  &nbsp;-    ,   &nbsp;,    . </p><br>
<p>   API — &nbsp;ClickHouse     .  API :  &nbsp;     &nbsp;,     , ,     &nbsp;   &nbsp; . &nbsp;   &nbsp;  ,  &nbsp;  ,    .   ,     ClickHouse.</p><br>
<p> &nbsp; API - &nbsp;— &nbsp;, &nbsp; —  &nbsp;,  .   ,  .     &nbsp;   &nbsp;- .   &nbsp;  ,       .</p><br>
<h2 id="anchordashboardanchorv-clickhouse-mnogo-logov-kak-ya-mogu-videt-vsyo-chto-proishodit-s-serverom-vnbspmomente"><a name="dashboard"></a> ClickHouse  .     ,    , &nbsp;?</h2><br>
<blockquote> ClickHouse     ,    . &nbsp;  - &nbsp;    , &nbsp;     &nbsp;.   ,     .    &nbsp; ,      &nbsp;,  , &nbsp;-  . <br>
<br>
    &nbsp; ClickHouse,  &nbsp;  ,      ,      &nbsp;   ? &nbsp; ,     &nbsp;ClickHouse —  .   ,      &nbsp;  .   &nbsp; . </blockquote><p> ,    . &nbsp; &nbsp; - 60&nbsp;  ClickHouse,   ,    &nbsp; ,     ,  - .      «.».     ,     . &nbsp; . </p><br>
<p>   &nbsp;«»    &nbsp;Grafana,      &nbsp;  .        &nbsp; .     ,     .     &nbsp;  ,   Graphite-web.   .    &nbsp;    ,  Grafana, ,     . </p><br>
<p>  &nbsp; .    &nbsp;: CPU, , , . &nbsp;—   ,   ,   &nbsp;,    &nbsp;  MergeTree,  ,   ,    &nbsp;,    &nbsp;.  ,    &nbsp;,  &nbsp;.</p><br>
<p><strong> :</strong> ,     .  Grafana. &nbsp;Grafana  datasource,   ClickHouse.     &nbsp;Grafana    &nbsp;ClickHouse. &nbsp;ClickHouse   &nbsp;,  &nbsp; .   &nbsp; &nbsp;Grafana  &nbsp;      ,    .      .</p><br>
<p>   .     &nbsp;—    ,  Grafana   ,  &nbsp;«»    ?</p><br>
<p><strong> :</strong> &nbsp;  datasource,  &nbsp;ClickHouse,   Altinity.      ,     .   &nbsp;,   «» -  ClickHouse,     . Altinity&nbsp;—   ,    ClickHouse.    ,   .   &nbsp;,    &nbsp; Grafana,      &nbsp;—   . </p><br>
<p><strong> :</strong>    &nbsp;ClickHouse    &nbsp; .   &nbsp;  &nbsp; .         ,  ,     .     ,        ,    .   -    ,  . </p><br>
<p>  ,   , &nbsp;  &nbsp;—    ,  &nbsp; .  &nbsp;-,    ,    .    .    , ,    : «,  -    Grafana?»,  : « &nbsp; Grafana,   “”,      ,   &nbsp;.   ,   ,    ».</p><br>
<h2 id="anchorzenanchorkak-vozdeystvovat-na-merdzhi-chtoby-server-ne-padal-vnbspoom"><a name="zen"></a>   ,     &nbsp;OOM?</h2><br>
<blockquote>   , &nbsp;   ,  ReplacingMergeTree.  &nbsp;   &nbsp;  .     &nbsp;    - .<br>
<br>
  ,  &nbsp;        &nbsp;  ,        OOM.     ,       ,   ,    &nbsp;OOM.       .     .<br>
<br>
 ,   &nbsp;  ,   .   ,  .  - .  ,    &nbsp;,      &nbsp;, &nbsp;  &nbsp;—        &nbsp;  -  ? ,   &nbsp;   ,  &nbsp; &nbsp; ,      .<br>
<br>
   ,   «»,   , , &nbsp; .        ,  &nbsp;.  ,  &nbsp;    ,  &nbsp;,   ,   .   ?    ,  -   &nbsp;,  &nbsp;   - ,  - ,     &nbsp;  ,     &nbsp;  .      &nbsp;OOM &nbsp;.     ,    .</blockquote><p> , &nbsp;     &nbsp;OOM,   &nbsp;     &nbsp;   .       &nbsp; .</p><br>
<p><strong> :</strong> .   ,   ,    ,     ,  &nbsp; ,  ,   ,   .  &nbsp;  &nbsp;    100&nbsp;  .    150&nbsp;, 100&nbsp;,    &nbsp;50&nbsp;,   &nbsp;OOM  .</p><br>
<p>  &nbsp;    ,     &nbsp;OOM,     &nbsp;100&nbsp;  ?   &nbsp;,     &nbsp; ?</p><br>
<p><strong> :</strong>   ,      &nbsp;  .     &nbsp;, ,  -   ,    ,     &nbsp; .  &nbsp;—   ,  ,    &nbsp; .     ,      ,  ,   , .</p><br>
<p>,       &nbsp;,  «  »   &nbsp;OOM.     ,    ,  &nbsp;- ,  ,    &nbsp;—   &nbsp;  .  &nbsp;      .</p><br>
<h2 id="anchorgoanchorkak-budet-proishodit-razrabotka-golang-drayvera-dlya-clickhouse"><a name="go"></a>    Golang-  ClickHouse?</h2><br>
<blockquote>Golang-,    ,       ClickHouse.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  ClickHouse</a>,     .<br>
<br>
 .           —  Vertica.       python-,    Vertica.     ,         ,    -   .   .    ,  ,   «» —    issue,    .<br>
<br>
   .  Golang-  —       Golang  ClickHouse.   -  http     ,     .      ?      - breaking changes   ?     issue? </blockquote><p><strong> :</strong> &nbsp;—    .    ,    .</p><br>
<p>  &nbsp; &nbsp;issue,    .   &nbsp;, &nbsp;   .     &nbsp;  ,    - .  &nbsp;-   ClickHouse.    ,      ,   ClickHouse .     ,     . </p><br>
<p>    &nbsp;  ClickHouse,     -   .   &nbsp;—   ,  .     ,       .</p><br>
<p>    &nbsp;Go,  ,    &nbsp;Go.     &nbsp;—     . &nbsp;-    ,      ,  -     .   CloudFlare  &nbsp;  ,   -   &nbsp;   ,          .      &nbsp;ClickHouse ,  &nbsp;. </p><br>
<p> -      ,     &nbsp;  ClickHouse  &nbsp;  .  issues  .  &nbsp;  ,   - .    pull request    -  ,    .</p><br>
<p>   .   ,     , ClickHouse     &nbsp; .    ,   ,   .   ,  &nbsp;2  &nbsp;   -&nbsp; . </p><br>
<p>   ,   .       .  -    ,      ,  .     «» &nbsp;     . </p><br>
<p><strong> :</strong> &nbsp;      &nbsp;  . &nbsp;—   &nbsp; ,        &nbsp; &nbsp;Go.  -  ,    . </p><br>
<p>     &nbsp;  . &nbsp;—      ,  &nbsp;  ,  &nbsp;  -,    - . </p><br>
<h2 id="anchorlazy-loadanchorvneshniy-slovar-ne-podnimaetsya-posle-perezagruzki-snbspvklyuchennoy-nastroykoy-lazy_load-chto-delat"><a name="lazy-load"></a>      &nbsp;  lazy_load.  ?</h2><br>
<blockquote>    lazy_load,        .     ,    &nbsp; .  &nbsp;   .   -   ClickHouse  ,       ,     ?<br>
<br>
 &nbsp;   ClickHouse,     .   ?</blockquote><p>-,     &nbsp;  <strong>system reload dictionaries</strong>. -, &nbsp;  —    ,     &nbsp; ,   .      ,      &nbsp; .</p><br>
<p>&nbsp;     . ,     &nbsp;MySQL. -   select,   select      .    . &nbsp;—  lazy_load. &nbsp;—   ,  ,   &nbsp; ,  <strong>system reload dictionary</strong>    ,   .    .      &nbsp;  lazy_load,    ClickHouse   .</p><br>
<p>   &nbsp;—    ,    . </p><br>
<h2 id="anchorreload-dictionariesanchorkak-byt-snbsptem-chto-system-reload-dictionaries-ne-podgruzhaet-ni-odin-iznbspmnozhestva-slovarey-esli-hotya-by-odin-iznbspnih-padaet-snbsposhibkoy"><a name="reload-dictionaries"></a>  &nbsp;,  system reload dictionaries     &nbsp; ,     &nbsp;  &nbsp;?</h2><br>
<blockquote>   &nbsp; system reload dictionaries. &nbsp;  &nbsp;—   ,  . System reload dictionaries &nbsp;      ,      &nbsp;  c&nbsp; system reload dictionary.    &nbsp; ClickHouse?</blockquote><p> .   . ,    ClickHouse,    .       <strong>system reload dictionaries</strong>, ,   ,    &nbsp; .</p><br>
<h2 id="anchorconnectionanchorest-li-sposob-konfigurirovat-rekvizity-vnbspkonfige-clickhouse-no-ne-svetit-ih-prinbsposhibkah"><a name="connection"></a>     &nbsp; ClickHouse,     &nbsp;?</h2><br>
<blockquote>  &nbsp;,  &nbsp;,   .     &nbsp; ClickHouse &nbsp;,  &nbsp;       &nbsp;. <br>
<br>
      &nbsp;  ODBC.   -    &nbsp; ClickHouse,      &nbsp;?</blockquote><p>  &nbsp;—   credentials &nbsp;odbc.ini,  &nbsp; ClickHouse   ODBC Data Source Name. &nbsp;     &nbsp;—    &nbsp;MySQL,  &nbsp;      &nbsp;  . &nbsp;ODBC    —   ,    .</p><br>
<h2 id="anchorzoom-backgroundsanchorbonus-fony-dlya-zuma-snbspposidelok"><a name="zoom-backgrounds"></a>:    &nbsp;</h2><br>
<p>  &nbsp; &nbsp;      &nbsp;.    &nbsp;  ,  &nbsp; &nbsp;         &nbsp; &nbsp; .</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/ir/9v/k9/ir9vk9hblhloemqnwftbbatwaao.jpeg"></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500666/index.html">Microsoft online certification - you, your space, and your computer</a></li>
<li><a href="../en500668/index.html">Wireless motor control from Lego using Steam Controller</a></li>
<li><a href="../en500670/index.html">How we create our product. Part One, Research</a></li>
<li><a href="../en500672/index.html">Continuation of the stream for testers and not only</a></li>
<li><a href="../en500676/index.html">Announcement of an online workshop on test automation</a></li>
<li><a href="../en500688/index.html">Working with a database in Flask: from June to June</a></li>
<li><a href="../en500692/index.html">3D game rendering: introduction</a></li>
<li><a href="../en500694/index.html">68 unsolicited tips</a></li>
<li><a href="../en500696/index.html">How running shoes are trying to adapt to the female foot</a></li>
<li><a href="../en500698/index.html">Evgeny Katyshev: “OpenStreetMap is not suitable for any information”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>