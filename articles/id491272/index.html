<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛀🏽 🧑🏽‍🤝‍🧑🏽 🅰️ Pengembangan situs web dalam pascal (backend) 🌏 🌇 💍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini saya akan berbicara tentang mengapa, mengapa, dan bagaimana saya mulai membuat situs di Pascal: Delphi / FPC. 
 Mungkin "situs Pascal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pengembangan situs web dalam pascal (backend)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491272/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada artikel ini saya akan berbicara tentang mengapa, mengapa, dan bagaimana saya mulai membuat situs di Pascal: Delphi / FPC. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin "situs Pascal" dikaitkan dengan sesuatu seperti:</font></font><br>
<br>
<pre><code class="delphi">writeln('Content-type: text/html');</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi tidak, semuanya jauh lebih menarik! </font><font style="vertical-align: inherit;">Namun, kode sumber situs nyata (hampir semua) tersedia di GitHub.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk apa?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, saya tidak pernah menjadi pengembang web profesional - saya membuat game. Gim, terutama gim daring, membutuhkan situs web. Oleh karena itu, kebetulan saya mulai membuat lebih banyak situs untuk permainan saya. Menggunakan CGI pada Perl - pada awal / pertengahan 2000-an itu populer. Semuanya baik-baik saja sampai muncul masalah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahun 2013, kami mulai mengadakan turnamen online untuk game </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spectromancer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untuk melakukan ini, saya membuat halaman turnamen di situs web permainan, yang menunjukkan siapa yang akan bermain dengan siapa, hasil saat ini, dll. Di awal turnamen, halaman pemain telah diperbarui dan ... tidak dimuat. Orang-orang menekan F5, semakin memperburuk masalah. Ternyata bahkan 4-5 permintaan per detik ke skrip CGI, berjalan sebagai proses Perl terpisah, secara signifikan memperlambat server, dan&gt; 10 permintaan per detik membuatnya benar-benar tidak dapat diakses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sangat bagus bahwa stress test ini terjadi selama turnamen latihan: nanti saya sudah menggunakan halaman statis yang diperbarui untuk turnamen. </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, ketika perlu muncul untuk membuat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">situs ini untuk permainan baru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pertanyaan muncul - pada apa? </font><font style="vertical-align: inherit;">Rem CGI pada Perl bukan opsi. </font><font style="vertical-align: inherit;">FastCGI dalam Perl? </font><font style="vertical-align: inherit;">Saya tidak bisa membayangkan bagaimana menulis dan men-debug program multithreaded di Perl, saya punya cukup banyak masalah dengan skrip biasa. </font><font style="vertical-align: inherit;">Node.js? </font><font style="vertical-align: inherit;">Mungkin itu akan menjadi pilihan terbaik, jika bukan karena permusuhan dengan JS. </font><font style="vertical-align: inherit;">Dan karena permainan itu sendiri dan servernya ditulis dalam Pascal (sebenarnya Delphi, tetapi FPC juga bagus), muncul ide - haruskah kita membuat situs dalam bahasa yang sama? </font><font style="vertical-align: inherit;">Ini akan menyederhanakan integrasi dengan server game. </font><font style="vertical-align: inherit;">"Berusaha bukanlah penyiksaan!" </font><font style="vertical-align: inherit;">Saya berpikir, dan memutuskan untuk mencobanya.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memilih SimpleCGI (SCGI) sebagai antarmuka: ini lebih sederhana daripada FastCGI, dan kelebihan yang terakhir tidak relevan bagi saya - tidak perlu mendistribusikan backend ke server yang berbeda, semuanya berjalan di server yang sama. </font><font style="vertical-align: inherit;">Jadi tugas bermuara pada pengembangan kerangka kerja SCGI tertentu yang memproses permintaan dari server dan menghasilkan halaman HTML sebagai respons dari beberapa templat kosong. </font><font style="vertical-align: inherit;">Hasilnya adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kerangka kerja modul</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini terdiri dari bagian-bagian berikut:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loop utama</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : menerima koneksi yang masuk, membaca permintaan dan menempatkannya dalam antrian untuk diproses. </font><font style="vertical-align: inherit;">Menulis tanggapan siap pakai untuk permintaan yang diproses ke soket koneksi dan menutupnya.</font></font></li>
<li><b>  (N )</b>:    ,         .   worker' —      . </li>
<li><b>  </b>:    HTML- (   )    .     .</li>
<li><b>  </b>:      (  CGI.pm  Perl).  ,    ..</li>
</ul><br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fitur yang sangat nyaman dari skrip Perl adalah sangat mudah untuk membuat perubahan kecil ke situs: cukup mengedit kode skrip dan hanya itu. Tidak perlu mengkompilasi, menyebarkan. Tentu saja, pascal adalah bahasa yang dikompilasi, itu tidak akan berhasil seperti itu, tapi tetap saya ingin dapat membuat perubahan bila memungkinkan tanpa memulai kembali proses. Karena itu, saya mencoba membuat sistem template cukup fleksibel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dia bekerja seperti itu. File templat ada di folder "templat": mereka dimuat saat proses dimulai dan juga dimuat kembali saat diubah - dengan cara ini Anda dapat mengubah konten dinamis tanpa memulai ulang proses. Setiap file dapat memiliki satu atau beberapa templat. Bersama-sama, mereka membentuk kamus (atau hash) templat: {"name" -&gt; "value"}. Ini adalah kamus templat statis - umum untuk semua permintaan dan kontennya tidak berubah (hingga konten file berubah). Ada satu lagi - kamus dinamis, dibuat kosong untuk setiap permintaan dan diisi dengan penangan data dinamis - misalnya, dari database. Menggabungkan data statis dan dinamis, hasil akhir terbentuk. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh pernyataan template:</font></font><br>
<br>
<pre><code class="xml">#NEWSFEED_ITEM:<font></font>
&lt;div class=NewsHeader&gt;<font></font>
 &lt;a href='/$LANG_LC/forum/thread/$NEWS_ID'&gt;&lt;IF_NEWS_PINNED&gt;[TOP] &nbsp;&lt;/IF_NEWS_PINNED&gt;$NEWS_DATE &nbsp; $NEWS_TITLE&lt;/a&gt;<font></font>
&lt;/div&gt;<font></font>
&lt;div class=NewsText&gt;$NEWS_TEXT<font></font>
 &lt;div align=right&gt;<font></font>
  &lt;a href='/$LANG_LC/forum/thread/$NEWS_ID'&gt;$COMMENTS&lt;/a&gt;<font></font>
 &lt;/div&gt;<font></font>
&lt;/div&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah templat statis untuk umpan berita dengan nama NEWSFEED_ITEM, di dalamnya berisi beberapa templat lainnya, misalnya NEWS_TEXT - templat dinamis yang berisi teks berita yang diunduh dari database. </font><font style="vertical-align: inherit;">Terjemahan adalah bahwa semua substring dari bentuk $ TEMPLATE_NAME diganti secara rekursif dengan nilai templat ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini Anda juga dapat melihat pseudotag untuk terjemahan bersyarat: &lt;IF_TEMPLATE_NAME&gt; - selama terjemahan, tag tersebut dihapus dan isinya dibiarkan atau juga dihapus, tergantung pada nilai templat yang ditentukan. </font><font style="vertical-align: inherit;">Saya secara khusus memilih format kondisi ini - dalam bentuk tag HTML, sehingga ketika mengedit dalam editor teks, penyorotan sintaks berfungsi dan mudah untuk melihat tag berpasangan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode pembuatan umpan menggunakan templat ini terlihat seperti ini:</font></font><br>
<br>
<pre><code class="delphi"><font></font>
    result:='';<font></font>
    //       NEWSFEED_ITEM      result<font></font>
    for i:=0 to n-1 do begin<font></font>
      id:=StrToIntDef(sa[i*c],0);<font></font>
      title:=sa[i*c+1];<font></font>
      cnt:=StrToIntDef(sa[i*c+2],1)-1;<font></font>
      flags:=StrToIntDef(sa[i*c+3],0);<font></font>
      //     <font></font>
      db.Query('SELECT msg,created FROM messages WHERE topic=%d ORDER BY id LIMIT 1', <font></font>
        [id]);<font></font>
      if db.lastErrorCode&lt;&gt;0 then continue;<font></font>
      text:=db.Next;<font></font>
      date:=db.NextDate;<font></font>
      //    ( temp)<font></font>
      temp.Put('NEWS_ID',id,true);<font></font>
      temp.Put('NEWS_DATE',FormatDate(date,true),true);<font></font>
      temp.Put('NEWS_TITLE',title,true);<font></font>
      temp.Put('NEWS_PINNED',flags and 4&gt;0,true);<font></font>
      comLink:='$LNK_READ_MORE | ';<font></font>
      if cnt&gt;0 then comLink:=comLink+inttostr(cnt)+' $LNK_COMMENTS'<font></font>
        else comLink:=comLink+'$LNK_LEAVE_COMMENT';<font></font>
      temp.Put('NEWS_TEXT',text,true);<font></font>
      temp.Put('COMMENTS',comLink,true);<font></font>
      //   <font></font>
      result:=result+BuildTemplate('#NEWSFEED_ITEM');<font></font>
    end;<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lokalisasi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Template juga nyaman digunakan untuk pelokalan. </font><font style="vertical-align: inherit;">Untuk melakukan ini, gunakan variabel clientLang global (dalam konteks permintaan). </font><font style="vertical-align: inherit;">Kerjanya seperti ini: jika penangan permintaan mengetahui bahwa klien membutuhkan halaman dalam bahasa Rusia, ia menulis nilai "RU" di clientLang, setelah penerjemah templat, setelah menemukan $ TEMPLATE_NAME dalam teks, selalu mencoba menerapkan pertama $ TEMPLATE_NAME. </font><font style="vertical-align: inherit;">Jadi, untuk pelokalan, Anda hanya perlu membuat opsi untuk bahasa lain untuk setiap templat dengan teks:</font></font><br>
<br>
<pre><code class="plaintext">#TITLE_NEWS:News<font></font>
#TITLE_NEWS_RU:<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh menggunakan framework</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh kode situs sederhana:</font></font><br>
<br>
<pre><code class="delphi">program website;<font></font>
uses SysUtils, SCGI;<font></font>
<font></font>
//    <font></font>
function IndexPage:AnsiString; stdcall;<font></font>
 begin<font></font>
   result:=FormatHeaders('text/html')+BuildTemplate('#INDEX.HTM');<font></font>
 end;<font></font>
<font></font>
begin<font></font>
 SetCurrentDir(ExtractFileDir(ParamStr(0)));<font></font>
 SCGI.Initialize; //  <font></font>
 AddHandler('/',IndexPage); //     '/'<font></font>
 SCGI.RunServer; //      <font></font>
end.<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menulis kerangka yang dijelaskan dalam proses pembuatan situs nyata </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">astralheroes.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada akhir 2015. </font><font style="vertical-align: inherit;">Seperti yang biasanya terjadi, pancake pertama keluar sedikit kental - kode itu ternyata agak berantakan dan membingungkan, situs berikutnya semakin baik. </font><font style="vertical-align: inherit;">Namun demikian, saya puas dengan proses dan hasilnya: situs berfungsi dengan baik, mudah didebug dan diperbarui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temuan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya berharap dibandingkan dengan Perl yang ringkas, kode situs sangat membengkak, tetapi tidak - fungsionalitas yang sama yang ditulis dalam Pascal hanya membutuhkan sekitar dua kali lipat dari pada Perl. </font><font style="vertical-align: inherit;">Tapi itu terlihat lebih jelas.</font></font></li>
<li> ! Perl —  ,    -   100 , ,    .      - -  —    .  Delphi      .</li>
<li>     Perl.   -,       ,     ,      .  -,          Perl,       ,     .</li>
<li>    :    ,     ,   .    .</li>
<li> .         ,  ,    (    ),      ,         . ,        ,      —      .     .<br>
<br>
             ,           .          —      . ,         :<br>
<br>
<img src="https://habrastorage.org/webt/ha/tm/xk/hatmxk0csqkmgbofbwug-e3qcew.png"><br>
<br>
       ,    —   .     ,    .</li>
</ul><br>
<h3>    ?</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sumber di GitHub: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Cooler2/ApusEngineExamples</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Perhatikan bahwa ada submodule dalam repositori, jadi lebih baik untuk mengkloning dengan parameter </font><font style="vertical-align: inherit;">"- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recursive</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proyek situs ada dalam file: "AH-Website \ Backend \ src \ website.dpr" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini bukan salinan lengkap dari situs saat ini: jelas bahwa saya tidak dapat mempublikasikan konten database dengan data para pemain, saya juga tidak mempublikasikan skrip CGI, karena mereka tidak terkait dengan topik. Namun demikian, proyek ini sedang dirakit, diluncurkan dan bekerja, sepenuhnya menunjukkan kerja kerangka kerja. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publikasi kode situs, serta kode mesin yang digunakannya, dimungkinkan berkat dukungan yang saya terima </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di Patreon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Saya mengucapkan terima kasih kepada semua yang mendukung saya dan mendorong Anda untuk bergabung - masih ada banyak hal menarik di depan :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih atas perhatian Anda!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id491260/index.html">Normalisasi teks dalam tugas pengenalan ucapan</a></li>
<li><a href="../id491262/index.html">Mata untuk mata. Masalah Biometrik</a></li>
<li><a href="../id491264/index.html">Pengantar SSD. Bagian 4. Fisik</a></li>
<li><a href="../id491266/index.html">SurfingAttack: kompromi smartphone dengan asisten suara [+ video]</a></li>
<li><a href="../id491268/index.html">Metode Monte Carlo untuk Rantai Markov (MCMC). pengantar</a></li>
<li><a href="../id491276/index.html">Bagaimana saya menghindari larangan pada API Pesan melalui dokumentasi Vkontakte</a></li>
<li><a href="../id491278/index.html">CLRium # 7: Laporan, Latihan, Mentor</a></li>
<li><a href="../id491280/index.html">Kisah bagaimana saya mengembangkan bahasa pemrograman</a></li>
<li><a href="../id491282/index.html">Cara meningkatkan produktivitas tim (dan mengurangi kesalahan) menggunakan aksi unjuk rasa</a></li>
<li><a href="../id491284/index.html">Analisis: apa itu analisis fundamental</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>