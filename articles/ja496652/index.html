<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ”¬ ğŸ¤ğŸ¼ ğŸ˜„ ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦Laravelã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³• ğŸ‘¨ğŸ»â€ğŸ“ ğŸ‘§ğŸ¼ ğŸ¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç‰¹ã«ã€ŒFramework Laravelã€ã‚³ãƒ¼ã‚¹ã®å­¦ç”Ÿå‘ã‘ã«è¨˜äº‹ã®ç¿»è¨³ãŒç”¨æ„ã•ã‚Œã¾ã—ãŸã€‚
 
 
 
 æœ€è¿‘ã®Webãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ç™ºç”Ÿã™ã‚‹ã™ã¹ã¦ã®ã“ã¨ã«ã¤ã„ã¦çŸ¥ã‚‰ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚é€šçŸ¥ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã•ãˆã‚‚ãªã„Webã‚µã‚¤ãƒˆã«ãªã‚ŠãŸããªã„ã§ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ç¾åœ¨ã€ã™ã¹ã¦ã®ã‚½...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦Laravelã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/496652/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰¹ã«</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ŒFramework Laravelã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ã‚¹ã®å­¦ç”Ÿå‘ã‘ã«è¨˜äº‹ã®ç¿»è¨³ãŒç”¨æ„ã•ã‚Œã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/sm/tj/qn/smtjqnftoocvtc4fzn0gm6ttfje.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€è¿‘ã®Webãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ç™ºç”Ÿã™ã‚‹ã™ã¹ã¦ã®ã“ã¨ã«ã¤ã„ã¦çŸ¥ã‚‰ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">é€šçŸ¥ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã•ãˆã‚‚ãªã„Webã‚µã‚¤ãƒˆã«ãªã‚ŠãŸããªã„ã§ã—ã‚‡ã†ã€‚ã“ã‚Œã¯ç¾åœ¨ã€ã™ã¹ã¦ã®ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚µã‚¤ãƒˆã ã‘ã§ãªãã€ä¸€èˆ¬ã«æœ€è¿‘ã¯ã©ã“ã§ã‚‚è¦‹ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¸ã„ã€Laravelã¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusherã‚’ä½¿ç”¨ã™ã‚‹ã¨</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã“ã®æ©Ÿèƒ½</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã®</font></a><font style="vertical-align: inherit;">å®Ÿè£…ã¯éå¸¸ã«ç°¡å˜ã§ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¿«é©ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’æä¾›ã™ã‚‹ã«ã¯ã€é€šçŸ¥ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">1ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€AJAXãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®šæœŸçš„ã«ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã€æœ€æ–°ã®é€šçŸ¥ãŒã‚ã‚‹å ´åˆã¯ãã‚Œã‚’å—ä¿¡ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å–„ã®æ–¹æ³•ã¯ã€WebSocketã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ã€é€ä¿¡æ™‚ã«é€šçŸ¥ã‚’å—ã‘å–ã‚‹ã“ã¨ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã¾ã•ã«ã“ã®è¨˜äº‹ã§å®Ÿè£…ã™ã‚‹ã‚‚ã®ã§ã™ã€‚</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒƒã‚·ãƒ£ãƒ¼</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã¯ã€WebSocketsã‚’ä»‹ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®åŒæ–¹å‘æ©Ÿèƒ½ã‚’WebãŠã‚ˆã³ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«çµ±åˆã™ã‚‹ãŸã‚ã®Webã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªAPIã‚’å‚™ãˆã¦ã„ã¾ã™ãŒã€Laravel Broadcastingã¨Laravel Echoã§ã•ã‚‰ã«ç°¡å˜ã«ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®è¨˜äº‹ã§ã¯ã€æ—¢å­˜ã®ãƒ–ãƒ­ã‚°ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‹æ¥­</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆæœŸåŒ–</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ç°¡å˜ãªLaravelãƒ–ãƒ­ã‚°ã‚’è¤‡è£½ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">git <span class="hljs-keyword">clone</span>   https:<span class="hljs-comment">//github.com/marslan-ali/laravel-blog</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã€ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸå¤‰æ•°ã‚’</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ”ãƒ¼</font></font><code>env.example</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—</font></font><code>.env</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦æ›´æ–°ã—ã¦</font><font style="vertical-align: inherit;">ã¿ã¾ã—ã‚‡ã†</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs">cp .env.example .envDB_HOST=localhost<font></font>
DB_DATABASE=homestead<font></font>
DB_USERNAME=homestead<font></font>
DB_PASSWORD=secret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã—ã‚‡ã†</font></font><br>
<br>
<pre><code class="plaintext hljs">composer install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">php artisan migrate --seed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã«ç§»å‹•ã™ã‚‹ã¨</font></font><code>/posts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ç”Ÿæˆã•ã‚ŒãŸæŠ•ç¨¿ã®ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²ã—ã¦ã€ã„ãã¤ã‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯éå¸¸ã«å˜ç´”ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ãŒã€ãƒ‡ãƒ¢ã«ã¯æœ€é©ã§ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«äº’ã„ã«ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã™ã‚‹æ©Ÿä¼šã‚’æä¾›ã—ãŸã„ã®ã§ã€ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã«å¤šå¯¾å¤šã®é–¢ä¿‚ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒªãƒ³ã‚¯ã™ã‚‹ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">æ–°ã—ã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†</font></font><code>followers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:migration create_followers_table --create=followers</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ç§»è¡Œã«ã„ãã¤ã‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¡¨ã™ãŸã‚</font></font><code>user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã€</font></font><code>follows_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¡¨ã™</font><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚ˆã†ã«ç§»è¡Œã‚’æ›´æ–°ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    Schema::create(<span class="hljs-string">'followers'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Blueprint $table</span>) </span>{<font></font>
        $table-&gt;increments(<span class="hljs-string">'id'</span>);<font></font>
        $table-&gt;integer(<span class="hljs-string">'user_id'</span>)-&gt;index();<font></font>
        $table-&gt;integer(<span class="hljs-string">'follows_id'</span>)-&gt;index();<font></font>
        $table-&gt;timestamps();<font></font>
    });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan migrate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«ã«é–¢ä¿‚ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Authenticatable</span>
</span>{
    <span class="hljs-comment">// ...</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">followers</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;belongsToMany(<span class="hljs-built_in">self</span>::class, <span class="hljs-string">'followers'</span>, <span class="hljs-string">'follows_id'</span>, <span class="hljs-string">'user_id'</span>)<font></font>
                    -&gt;withTimestamps();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follows</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;belongsToMany(<span class="hljs-built_in">self</span>::class, <span class="hljs-string">'followers'</span>, <span class="hljs-string">'user_id'</span>, <span class="hljs-string">'follows_id'</span>)<font></font>
                    -&gt;withTimestamps();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¢ãƒ‡ãƒ«</font></font><code>User</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«å¿…è¦ãªé–¢ä¿‚ãŒè¨­å®šã•ã‚ŒãŸ</font><font style="vertical-align: inherit;">ã®ã§ã€ãƒ¢ãƒ‡ãƒ«</font><font style="vertical-align: inherit;">ã¯</font></font><code>followers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã™ã¹ã¦ã®ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã‚’</font></font><code>follows</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¦ã„ã‚‹</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã‚’</font><font style="vertical-align: inherit;">è¿”ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¦</font></font><code>follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèª</font><font style="vertical-align: inherit;">ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã„ãã¤ã‹ã®è£œåŠ©æ©Ÿèƒ½ãŒå¿…è¦</font><font style="vertical-align: inherit;">ã«ãªã‚Šã¾ã™</font></font><code>isFollowing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Authenticatable</span>
</span>{
    <span class="hljs-comment">// ...</span><font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">$userId</span>) 
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;attach($userId);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unfollow</span>(<span class="hljs-params">$userId</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;detach($userId);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFollowing</span>(<span class="hljs-params">$userId</span>) 
    </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">boolean</span>) <span class="hljs-keyword">$this</span>-&gt;follows()-&gt;where(<span class="hljs-string">'follows_id'</span>, $userId)-&gt;first([<span class="hljs-string">'id'</span>]);<font></font>
    }<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã„ã„ã‚ˆ </font><font style="vertical-align: inherit;">ãƒ¢ãƒ‡ãƒ«ã‚’æº–å‚™ã—ãŸã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¹ãƒˆ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¿…è¦ãªãƒ«ãƒ¼ãƒˆã‚’ç‰¹å®šã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs">/...<font></font>
Route::group([<span class="hljs-string">'middleware'</span> =&gt; <span class="hljs-string">'auth'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<font></font>
    Route::get(<span class="hljs-string">'users'</span>, <span class="hljs-string">'UsersController@index'</span>)-&gt;name(<span class="hljs-string">'users'</span>);<font></font>
    Route::post(<span class="hljs-string">'users/{user}/follow'</span>, <span class="hljs-string">'UsersController@follow'</span>)-&gt;name(<span class="hljs-string">'follow'</span>);<font></font>
    Route::delete(<span class="hljs-string">'users/{user}/unfollow'</span>, <span class="hljs-string">'UsersController@unfollow'</span>)-&gt;name(<span class="hljs-string">'unfollow'</span>);<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨ã®æ–°ã—ã„ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:controller UsersController</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™</font></font><code>index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">User</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">//..</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        $users = User::where(<span class="hljs-string">'id'</span>, <span class="hljs-string">'!='</span>, auth()-&gt;user()-&gt;id)-&gt;get();
        <span class="hljs-keyword">return</span> view(<span class="hljs-string">'users.index'</span>, compact(<span class="hljs-string">'users'</span>));<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å°å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ“ãƒ¥ãƒ¼</font></font><code>users.index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ä½œæˆã—ã¦</font><font style="vertical-align: inherit;">ã€æ¬¡ã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã‚’ãã®ä¸­ã«å…¥ã‚Œ</font><font style="vertical-align: inherit;">ã¾ã—ã‚‡ã†</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs">@<span class="hljs-keyword">extends</span>(<span class="hljs-string">'layouts.app'</span>)<font></font>
<font></font>
@section(<span class="hljs-string">'content'</span>)<font></font>
    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">container</span>"&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-<span class="hljs-title">offset</span>-2 <span class="hljs-title">col</span>-<span class="hljs-title">sm</span>-8"&gt;

            &lt;!-- <span class="hljs-title">Following</span> --&gt;
            &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span> <span class="hljs-title">panel</span>-<span class="hljs-title">default</span>"&gt;
                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">heading</span>"&gt;
                    <span class="hljs-title">All</span> <span class="hljs-title">Users</span>
                &lt;/<span class="hljs-title">div</span>&gt;

                &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">panel</span>-<span class="hljs-title">body</span>"&gt;
                    &lt;<span class="hljs-title">table</span> <span class="hljs-title">class</span>="<span class="hljs-title">table</span> <span class="hljs-title">table</span>-<span class="hljs-title">striped</span> <span class="hljs-title">task</span>-<span class="hljs-title">table</span>"&gt;
                        &lt;<span class="hljs-title">thead</span>&gt;
                        &lt;<span class="hljs-title">th</span>&gt;<span class="hljs-title">User</span>&lt;/<span class="hljs-title">th</span>&gt;
                        &lt;<span class="hljs-title">th</span>&gt; &lt;/<span class="hljs-title">th</span>&gt;
                        &lt;/<span class="hljs-title">thead</span>&gt;
                        &lt;<span class="hljs-title">tbody</span>&gt;
                        @<span class="hljs-title">foreach</span> ($<span class="hljs-title">users</span> <span class="hljs-title">as</span> $<span class="hljs-title">user</span>)
                            &lt;<span class="hljs-title">tr</span>&gt;
                                &lt;<span class="hljs-title">td</span> <span class="hljs-title">clphpass</span>="<span class="hljs-title">table</span>-<span class="hljs-title">text</span>"&gt;&lt;<span class="hljs-title">div</span>&gt;</span>{{ $user-&gt;name }}&lt;/div&gt;&lt;/td&gt;<font></font>
                                @<span class="hljs-keyword">if</span> (auth()-&gt;user()-&gt;isFollowing($user-&gt;id))<font></font>
                                    &lt;td&gt;<font></font>
                                        &lt;form action=<span class="hljs-string">"{{route('unfollow', ['id' =&gt; $user-&gt;id])}}"</span> method=<span class="hljs-string">"POST"</span>&gt;<font></font>
                                            {{ csrf_field() }}<font></font>
                                            {{ method_field(<span class="hljs-string">'DELETE'</span>) }}<font></font>
<font></font>
                                            &lt;button type=<span class="hljs-string">"submit"</span> id=<span class="hljs-string">"delete-follow-{{ $user-&gt;id }}"</span> <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">btn</span> <span class="hljs-title">btn</span>-<span class="hljs-title">danger</span>"&gt;
                                                &lt;<span class="hljs-title">i</span> <span class="hljs-title">class</span>="<span class="hljs-title">fa</span> <span class="hljs-title">fa</span>-<span class="hljs-title">btn</span> <span class="hljs-title">fa</span>-<span class="hljs-title">trash</span>"&gt;&lt;/<span class="hljs-title">i</span>&gt;<span class="hljs-title">Unfollow</span>
                                            &lt;/<span class="hljs-title">button</span>&gt;
                                        &lt;/<span class="hljs-title">form</span>&gt;
                                    &lt;/<span class="hljs-title">td</span>&gt;
                                @<span class="hljs-title">else</span>
                                    &lt;<span class="hljs-title">td</span>&gt;
                                        &lt;<span class="hljs-title">form</span> <span class="hljs-title">action</span>="</span>{{route(<span class="hljs-string">'follow'</span>, [<span class="hljs-string">'id'</span> =&gt; $user-&gt;id])}}<span class="hljs-string">" method="</span>POST<span class="hljs-string">"&gt;
                                            {{ csrf_field() }}

                                            &lt;button type="</span>submit<span class="hljs-string">" id="</span>follow-user-{{ $user-&gt;id }}<span class="hljs-string">" class="</span>btn btn-success<span class="hljs-string">"&gt;
                                                &lt;i class="</span>fa fa-btn fa-user<span class="hljs-string">"&gt;&lt;/i&gt;Follow
                                            &lt;/button&gt;
                                        &lt;/form&gt;
                                    &lt;/td&gt;
                                @endif
                            &lt;/tr&gt;
                        @endforeach
                        &lt;/tbody&gt;
                    &lt;/table&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
@endsection</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ãƒšãƒ¼ã‚¸</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«</font><font style="vertical-align: inherit;">ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦</font><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚©ãƒ­ãƒ¼ã¨ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã§</font></font><code>UsersController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸è¶³ã—ã¦ã„ã‚‹æ–¹æ³•</font></font><code>follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><code>unfollow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã‚Œã‚‰ã‚’å®Ÿè£…ã—ã¦ã€ã“ã®éƒ¨åˆ†ã‚’å®Œæˆã•ã›ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">//...</span></code></pre><br>
<pre><code class="php hljs">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span> ($follower-&gt;id == $user-&gt;id) {
            <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You can't follow yourself"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span>(!$follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;follow($user-&gt;id);<font></font>
<font></font>
            <span class="hljs-comment">//  </span>
            $user-&gt;notify(<span class="hljs-keyword">new</span> UserFollowed($follower));<font></font>
<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are now friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You are already following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unfollow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span>($follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;unfollow($user-&gt;id);<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are no longer friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withError(<span class="hljs-string">"You are not following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã“ã®æ©Ÿèƒ½ã¯çµ‚äº†ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã§ã€ãƒšãƒ¼ã‚¸ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã€ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã‚’è§£é™¤ã§ãã¾ã™</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŠçŸ¥ã‚‰ã›</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laravelã¯ã€è¤‡æ•°ã®ãƒãƒ£ãƒãƒ«ã«é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã®APIã‚’æä¾›ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">é›»å­ãƒ¡ãƒ¼ãƒ«ã€SMSã€Webé€šçŸ¥ã€ãŠã‚ˆã³ãã®ä»–ã®ç¨®é¡ã®é€šçŸ¥ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¦é€ä¿¡ã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ç¨®é¡ã®é€šçŸ¥ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥ï¼šåˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ãŸã¨ãã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠ•ç¨¿é€šçŸ¥ï¼šæ–°ã—ã„æŠ•ç¨¿ãŒå…¬é–‹ã•ã‚ŒãŸã¨ãã«ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è·äººã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€é€šçŸ¥ã®ç§»è¡Œã‚’ç”Ÿæˆã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan notifications:table</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§»è¡Œã‚’è¡Œã£ã¦ã€ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan migrate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é€šçŸ¥ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€é€šçŸ¥ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:notification UserFollowed</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ä½œæˆã—ãŸé€šçŸ¥ã‚¯ãƒ©ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFollowed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">Queueable</span>;<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> $follower;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">User $follower</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;follower = $follower;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>];<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDatabase</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'follower_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;id,
            <span class="hljs-string">'follower_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;name,<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®æ•°è¡Œã®ã‚³ãƒ¼ãƒ‰ã§ã€ã™ã§ã«å¤šãã®ã“ã¨ã‚’é”æˆã§ãã¾ã™ã€‚ã¾ãšã€</font></font><code>$follower</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®é€šçŸ¥ãŒç”Ÿæˆã•ã‚ŒãŸã¨ãã«</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</font><font style="vertical-align: inherit;">ã‚’å®Ÿè£…</font><font style="vertical-align: inherit;">ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—</font></font><code>via</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¦ã€ãƒãƒ£ãƒãƒ«ã‚’é€šã˜ã¦ã“ã®é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹ã‚ˆã†ã«Laravelã«æŒ‡ç¤ºã—ã¾ã™</font></font><code>database</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ Laravelã¯ã“ã‚Œã‚’æ¤œå‡ºã™ã‚‹ã¨ã€é€šçŸ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„ã‚¨ãƒ³ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<code>user_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦ã€</font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥ãŒè‡ªå‹•çš„ã«è¨­å®šã•ã‚Œã€åŠ ãˆã¦ã€æˆ‘ã€…ã¯ã€è¿½åŠ ã®ãƒ‡ãƒ¼ã‚¿ã¨ã®é€šçŸ¥ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚ŒãŒç›®çš„</font></font><code>toDatabase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ã€‚è¿”ã•ã‚ŒãŸé…åˆ—ã¯</font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥</font><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¿½åŠ ã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦æœ€å¾Œã«ã€å®Ÿè£…ã®ãŠã‹ã’ã§</font></font><code>ShouldQueue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Laravelã¯ã“ã®é€šçŸ¥ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚­ãƒ¥ãƒ¼ã«è‡ªå‹•çš„ã«é…ç½®ã—ã€å¿œç­”ã‚’é«˜é€ŸåŒ–ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€å¾Œã§Pusherã‚’ä½¿ç”¨ã™ã‚‹ã¨ãã«HTTPå‘¼ã³å‡ºã—ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã€ç†ã«ã‹ãªã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²é€šçŸ¥ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">UserFollowed</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">follow</span>(<span class="hljs-params">User $user</span>)
    </span>{<font></font>
        $follower = auth()-&gt;user();<font></font>
        <span class="hljs-keyword">if</span> ( ! $follower-&gt;isFollowing($user-&gt;id)) {<font></font>
            $follower-&gt;follow($user-&gt;id);<font></font>
<font></font>
            <span class="hljs-comment">//  ,   </span>
            $user-&gt;notify(<span class="hljs-keyword">new</span> UserFollowed($follower));<font></font>
<font></font>
            <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are now friends with {$user-&gt;name}"</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> back()-&gt;withSuccess(<span class="hljs-string">"You are already following {$user-&gt;name}"</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Userãƒ¢ãƒ‡ãƒ«ã¯ã™ã§ã«Notifiableãƒˆãƒ¬ã‚¤ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€notifyãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šçŸ¥ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã¯ã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦ã€é€šçŸ¥ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥ã«æ—¢èª­ã®ãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã¾ã™ã€‚</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é€šçŸ¥ã«ã¯ã€æƒ…å ±ã¨ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ãƒªãƒ³ã‚¯ãŒå«ã¾ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é–¢ã™ã‚‹é€šçŸ¥ã‚’å—ã‘å–ã£ãŸå ´åˆã€é€šçŸ¥ã«ã¯æœ‰ç›Šãªãƒ†ã‚­ã‚¹ãƒˆãŒå«ã¾ã‚Œã€æŠ¼ã•ã‚ŒãŸã¨ãã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã€æ—¢èª­ã¨ã—ã¦ãƒãƒ¼ã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ªã‚«ãƒ¬ãƒ³ã‚¹ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€</font></font><code>?read=notification_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã‚Œã‚’æ—¢èª­ã¨ã—ã¦ãƒãƒ¼ã‚¯</font><font style="vertical-align: inherit;">ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆ</font><font style="vertical-align: inherit;">ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ã“ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:middleware MarkNotificationAsRead</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’</font></font><code>handle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸­é–“</font><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰ã«é…ç½®ã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MarkNotificationAsRead</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">$request, <span class="hljs-built_in">Closure</span> $next</span>)
    </span>{
        <span class="hljs-keyword">if</span>($request-&gt;has(<span class="hljs-string">'read'</span>)) {<font></font>
            $notification = $request-&gt;user()-&gt;notifications()-&gt;where(<span class="hljs-string">'id'</span>, $request-&gt;read)-&gt;first();
            <span class="hljs-keyword">if</span>($notification) {<font></font>
                $notification-&gt;markAsRead();<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> $next($request);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ã«è¿½åŠ ã—</font></font><code>$middlewareGroups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Kernel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpKernel</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">protected</span> $middlewareGroups = [
        <span class="hljs-string">'web'</span> =&gt; [
            <span class="hljs-comment">//...</span><font></font>
            \App\Http\Middleware\MarkNotificationAsRead::class,<font></font>
        ],<font></font>
        <span class="hljs-comment">// ...</span><font></font>
    ];<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®å¾Œã€é€šçŸ¥ã‚’è¡¨ç¤ºã•ã›ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AJAXã‚’ä½¿ç”¨ã—ã¦é€šçŸ¥ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã€Pusherã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãšã€</font></font><code>notifications</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«</font><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">è¿½åŠ ã—ã¾ã—ã‚‡ã†</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notifications</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> auth()-&gt;user()-&gt;unreadNotifications()-&gt;limit(<span class="hljs-number">5</span>)-&gt;get()-&gt;toArray();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æœ€å¾Œã®5ã¤ã®æœªèª­é€šçŸ¥ã‚’è¿”ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ãƒ«ãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã ã‘ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
Route::group([ <span class="hljs-string">'middleware'</span> =&gt; <span class="hljs-string">'auth'</span> ], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// ...</span>
    Route::get(<span class="hljs-string">'/notifications'</span>, <span class="hljs-string">'UsersController@notifications'</span>);<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã«é€šçŸ¥ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">&lt;head&gt;<font></font>
    &lt;!-- <span class="hljs-comment">// ... // --&gt;</span><font></font>
    &lt;!-- Scripts --&gt;<font></font>
    &lt;script&gt;<font></font>
        window.Laravel = <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> json_encode([
            <span class="hljs-string">'csrfToken'</span> =&gt; csrf_token(),<font></font>
        ]); <span class="hljs-meta">?&gt;</span><font></font>
    &lt;/script&gt;<font></font>
    &lt;!--   id     JavaScript --&gt;<font></font>
    @<span class="hljs-keyword">if</span>(!auth()-&gt;guest())<font></font>
        &lt;script&gt;<font></font>
            window.Laravel.userId = <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> auth()-&gt;user()-&gt;id; <span class="hljs-meta">?&gt;</span><font></font>
        &lt;/script&gt;<font></font>
    @<span class="hljs-keyword">endif</span><font></font>
&lt;/head&gt;<font></font>
&lt;body&gt;<font></font>
    &lt;!-- <span class="hljs-comment">// ... // --&gt;</span>
    @<span class="hljs-keyword">if</span> (Auth::guest())<font></font>
        &lt;li&gt;&lt;a href=<span class="hljs-string">"{{ url('/login') }}"</span>&gt;Login&lt;/a&gt;&lt;/li&gt;<font></font>
        &lt;li&gt;&lt;a href=<span class="hljs-string">"{{ url('/register') }}"</span>&gt;Register&lt;/a&gt;&lt;/li&gt;<font></font>
    @<span class="hljs-keyword">else</span>
        &lt;!-- <span class="hljs-comment">// add this dropdown // --&gt;</span>
        &lt;li <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">dropdown</span>"&gt;
            &lt;<span class="hljs-title">a</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">toggle</span>" <span class="hljs-title">id</span>="<span class="hljs-title">notifications</span>" <span class="hljs-title">data</span>-<span class="hljs-title">toggle</span>="<span class="hljs-title">dropdown</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">haspopup</span>="<span class="hljs-title">true</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">expanded</span>="<span class="hljs-title">true</span>"&gt;
                &lt;<span class="hljs-title">span</span> <span class="hljs-title">class</span>="<span class="hljs-title">glyphicon</span> <span class="hljs-title">glyphicon</span>-<span class="hljs-title">user</span>"&gt;&lt;/<span class="hljs-title">span</span>&gt;
            &lt;/<span class="hljs-title">a</span>&gt;
            &lt;<span class="hljs-title">ul</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">menu</span>" <span class="hljs-title">aria</span>-<span class="hljs-title">labelledby</span>="<span class="hljs-title">notificationsMenu</span>" <span class="hljs-title">id</span>="<span class="hljs-title">notificationsMenu</span>"&gt;
                &lt;<span class="hljs-title">li</span> <span class="hljs-title">class</span>="<span class="hljs-title">dropdown</span>-<span class="hljs-title">header</span>"&gt;<span class="hljs-title">No</span> <span class="hljs-title">notifications</span>&lt;/<span class="hljs-title">li</span>&gt;
            &lt;/<span class="hljs-title">ul</span>&gt;
        &lt;/<span class="hljs-title">li</span>&gt;
&lt;!-- // ... // --&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸ</font></font><code>window.Laravel.userId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«</font><font style="vertical-align: inherit;">ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">è¿½åŠ </font><font style="vertical-align: inherit;">ã—ã¦ã€ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—ã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScriptã¨SASS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laravel Mixã‚’ä½¿ç”¨ã—ã¦JavaScriptã¨SASSã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãšã€npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">npm install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†</font></font><code>app.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>._ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash'</span>);
<span class="hljs-built_in">window</span>.$ = <span class="hljs-built_in">window</span>.jQuery = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">'bootstrap-sass'</span>);
<span class="hljs-keyword">var</span> notifications = [];
<span class="hljs-keyword">const</span> NOTIFICATION_TYPES = {
    <span class="hljs-attr">follow</span>: <span class="hljs-string">'App\\Notifications\\UserFollowed'</span>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯åˆæœŸåŒ–ã§ã™ã€‚</font><font style="vertical-align: inherit;">é€šçŸ¥ã‚’ä½¿ç”¨ã—ã¦ã€AJAXã¾ãŸã¯Pusherã®ã©ã¡ã‚‰ã‹ã‚‰å–å¾—ã—ãŸã‹ã«ã‹ã‹ã‚ã‚‰ãšã€ã™ã¹ã¦ã®é€šçŸ¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ ¼ç´ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŠãã‚‰ãã”æƒ³åƒã®ã¨ãŠã‚Šã€</font></font><code>NOTIFICATION_TYPES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šçŸ¥ã‚¿ã‚¤ãƒ—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€AJAXã‚’ä»‹ã—ã¦ï¼ˆã€ŒGETã€ï¼‰é€šçŸ¥ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// ,      </span>
    <span class="hljs-keyword">if</span>(Laravel.userId) {<font></font>
        $.get(<span class="hljs-string">'/notifications'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{<font></font>
            addNotifications(data, <span class="hljs-string">"#notifications"</span>);<font></font>
        });<font></font>
    }<font></font>
});<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addNotifications</span>(<span class="hljs-params">newNotifications, target</span>) </span>{<font></font>
    notifications = _.concat(notifications, newNotifications);<font></font>
    <span class="hljs-comment">//    5 </span>
    notifications.slice(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);<font></font>
    showNotifications(notifications, target);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚³ãƒ¼ãƒ‰ã®ãŠã‹ã’ã§ã€APIã‹ã‚‰æœ€æ–°ã®é€šçŸ¥ã‚’å—ã‘å–ã‚Šã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã«é…ç½®ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å†…éƒ¨ã§</font></font><code>addNotifications</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€æ—¢å­˜ã®é€šçŸ¥ã‚’</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lodash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„é€šçŸ¥ã¨çµ„ã¿åˆã‚ã›</font><font style="vertical-align: inherit;">ã€è¡¨ç¤ºã•ã‚Œã‚‹æœ€å¾Œã®5ã¤ã ã‘ã‚’å–å¾—ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¸ãƒ§ãƒ–ã‚’å®Œäº†ã™ã‚‹ã«ã¯ã€ã•ã‚‰ã«ã„ãã¤ã‹ã®é–¢æ•°ãŒå¿…è¦ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showNotifications</span>(<span class="hljs-params">notifications, target</span>) </span>{
    <span class="hljs-keyword">if</span>(notifications.length) {
        <span class="hljs-keyword">var</span> htmlElements = notifications.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">notification</span>) </span>{
            <span class="hljs-keyword">return</span> makeNotification(notification);<font></font>
        });<font></font>
        $(target + <span class="hljs-string">'Menu'</span>).html(htmlElements.join(<span class="hljs-string">''</span>));<font></font>
        $(target).addClass(<span class="hljs-string">'has-notifications'</span>)<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        $(target + <span class="hljs-string">'Menu'</span>).html(<span class="hljs-string">'&lt;li class="dropdown-header"&gt;No notifications&lt;/li&gt;'</span>);<font></font>
        $(target).removeClass(<span class="hljs-string">'has-notifications'</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®é–¢æ•°ã¯ã€ã™ã¹ã¦ã®é€šçŸ¥ã®è¡Œã‚’ä½œæˆã—ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã«é…ç½®ã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šçŸ¥ã‚’å—ä¿¡ã—ã¦â€‹â€‹ã„ãªã„å ´åˆã¯ã€ã€Œé€šçŸ¥ãªã—ã€ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒœã‚¿ãƒ³ã«ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã¯ã€é€šçŸ¥ãŒã‚ã‚‹ã¨è‰²ãŒå¤‰ã‚ã‚‹ã ã‘ã§ã™ã€‚</font><font style="vertical-align: inherit;">Githubé€šçŸ¥ã«å°‘ã—ä¼¼ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«ã€é€šçŸ¥æ–‡å­—åˆ—ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//...</span>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = routeNotification(notification);
    <span class="hljs-keyword">var</span> notificationText = makeNotificationText(notification);
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;li&gt;&lt;a href="'</span> + to + <span class="hljs-string">'"&gt;'</span> + notificationText + <span class="hljs-string">'&lt;/a&gt;&lt;/li&gt;'</span>;<font></font>
}<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">routeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = <span class="hljs-string">'?read='</span> + notification.id;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {<font></font>
        to = <span class="hljs-string">'users'</span> + to;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/'</span> + to;<font></font>
}<font></font>
<span class="hljs-comment">//        </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotificationText</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {
        <span class="hljs-keyword">const</span> name = notification.data.follower_name;<font></font>
        text += <span class="hljs-string">'&lt;strong&gt;'</span> + name + <span class="hljs-string">'&lt;/strong&gt; followed you'</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> text;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã™ã‚‹ã ã‘ã§ã™</font></font><code>app.scss</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//... </span>
<span class="hljs-comment">#notifications.has-notifications {</span>
  color: <span class="hljs-comment">#bf5329</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ã‚»ãƒƒãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="php hljs">npm run dev</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥ãŒå±Šãã¾ã™ã€‚</font><font style="vertical-align: inherit;">å½¼ãŒãã‚Œã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å½¼ã¯ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œ</font></font><code>/users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€é€šçŸ¥è‡ªä½“ãŒæ¶ˆãˆã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ã—ã„æŠ•ç¨¿ã®é€šçŸ¥</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ–°ã—ã„æŠ•ç¨¿ã‚’å…¬é–‹ã—ãŸã¨ãã«è³¼èª­è€…ã«é€šçŸ¥ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šçŸ¥ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs">php artisan make:notification NewPost</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”Ÿæˆã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ..</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">User</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewArticle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">// ..</span>
    <span class="hljs-keyword">protected</span> $following;
    <span class="hljs-keyword">protected</span> $post;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">User $following, Post $post</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;following = $following;
        <span class="hljs-keyword">$this</span>-&gt;post = $post;<font></font>
    }<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>];<font></font>
    }<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toDatabase</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'following_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;id,
            <span class="hljs-string">'following_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;name,
            <span class="hljs-string">'post_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;post-&gt;id,<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eloquentã‚¦ã‚©ãƒƒãƒãƒ£ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒå¥½ãã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Postã®ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ¼ã‚’ä½œæˆã—ã¦ã€ãã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒªãƒƒã‚¹ãƒ³ã—ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><code>app/Observers/PostObserver.php</code><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Observers</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Notifications</span>\<span class="hljs-title">NewPost</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PostObserver</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">created</span>(<span class="hljs-params">Post $post</span>)
    </span>{<font></font>
        $user = $post-&gt;user;<font></font>
        <span class="hljs-keyword">foreach</span> ($user-&gt;followers <span class="hljs-keyword">as</span> $follower) {<font></font>
            $follower-&gt;notify(<span class="hljs-keyword">new</span> NewPost($user, $post));<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ¼ã‚’ã«ç™»éŒ²ã—</font></font><code>AppServiceProvider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Observers</span>\<span class="hljs-title">PostObserver</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Post</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppServiceProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ServiceProvider</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boot</span>(<span class="hljs-params"></span>)
    </span>{<font></font>
        Post::observe(PostObserver::class);<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€JSã§è¡¨ç¤ºã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹ã ã‘ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-keyword">const</span> NOTIFICATION_TYPES = {
    <span class="hljs-attr">follow</span>: <span class="hljs-string">'App\\Notifications\\UserFollowed'</span>,
    <span class="hljs-attr">newPost</span>: <span class="hljs-string">'App\\Notifications\\NewPost'</span><font></font>
};<font></font>
<span class="hljs-comment">//...</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">routeNotification</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> to = <span class="hljs-string">`?read=<span class="hljs-subst">${notification.id}</span>`</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {<font></font>
        to = <span class="hljs-string">'users'</span> + to;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.newPost) {
        <span class="hljs-keyword">const</span> postId = notification.data.post_id;<font></font>
        to = <span class="hljs-string">`posts/<span class="hljs-subst">${postId}</span>`</span> + to;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/'</span> + to;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeNotificationText</span>(<span class="hljs-params">notification</span>) </span>{
    <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.follow) {
        <span class="hljs-keyword">const</span> name = notification.data.follower_name;<font></font>
        text += <span class="hljs-string">`&lt;strong&gt;<span class="hljs-subst">${name}</span>&lt;/strong&gt; followed you`</span>;<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(notification.type === NOTIFICATION_TYPES.newPost) {
        <span class="hljs-keyword">const</span> name = notification.data.following_name;<font></font>
        text += <span class="hljs-string">`&lt;strong&gt;<span class="hljs-subst">${name}</span>&lt;/strong&gt; published a post`</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> text;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦å‡ºæ¥ä¸ŠãŒã‚Šï¼</font><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¨æ–°ã—ã„æŠ•ç¨¿ã‚’é€šçŸ¥ã•ã‚Œã¾ã™ï¼</font><font style="vertical-align: inherit;">ãœã²ãŠè©¦ã—ãã ã•ã„ï¼</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§çµ‚äº†</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€Webã‚½ã‚±ãƒƒãƒˆçµŒç”±ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹æ™‚ãŒæ¥ã¾ã—ãŸã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">pusher.comã§</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç„¡æ–™ã®Pusherã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç™»éŒ²ã—ã€</font><font style="vertical-align: inherit;">æ–°ã—ã„ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="php hljs">...<font></font>
BROADCAST_DRIVER=pusher<font></font>
PUSHER_KEY=<font></font>
PUSHER_SECRET=<font></font>
PUSHER_APP_ID=</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’è¨­å®šã—ã¾ã™</font></font><code>broadcasting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
    <span class="hljs-string">'connections'</span> =&gt; [
            <span class="hljs-string">'pusher'</span> =&gt; [
                <span class="hljs-comment">//...</span>
                <span class="hljs-string">'options'</span> =&gt; [
                    <span class="hljs-string">'cluster'</span> =&gt; <span class="hljs-string">'eu'</span>,
                    <span class="hljs-string">'encrypted'</span> =&gt; <span class="hljs-literal">true</span><font></font>
                ],<font></font>
            ],<font></font>
    <span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«</font></font><code>App\Providers\BroadcastServiceProvider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€é…åˆ—ã«</font><font style="vertical-align: inherit;">ç™»éŒ²</font><font style="vertical-align: inherit;">ã—</font></font><code>providers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-string">'providers'</span> =&gt; [
    <span class="hljs-comment">// ...</span><font></font>
    App\Providers\BroadcastServiceProvider<font></font>
    <span class="hljs-comment">//...</span><font></font>
],<font></font>
<span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€Pusherã‹ã‚‰PHP SDKã¨Laravel Echoã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">composer <span class="hljs-keyword">require</span> pusher/pusher-php-server<font></font>
npm install --save laravel-<span class="hljs-keyword">echo</span> pusher-js</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”¾é€ç”¨ã®é€šçŸ¥ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">é€šçŸ¥ã‚’å¤‰æ›´ã—ã¾ã—ã‚‡ã†</font></font><code>UserFollowed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFollowed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">// ..</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>, <span class="hljs-string">'broadcast'</span>];<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;id,
            <span class="hljs-string">'read_at'</span> =&gt; <span class="hljs-literal">null</span>,
            <span class="hljs-string">'data'</span> =&gt; [
                <span class="hljs-string">'follower_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;id,
                <span class="hljs-string">'follower_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;follower-&gt;name,<font></font>
            ],<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦</font></font><code>NewPost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//...</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NewPost</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Notification</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ShouldQueue</span>
</span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">via</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'database'</span>, <span class="hljs-string">'broadcast'</span>];<font></font>
    }<font></font>
    <span class="hljs-comment">//...</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params">$notifiable</span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;id,
            <span class="hljs-string">'read_at'</span> =&gt; <span class="hljs-literal">null</span>,
            <span class="hljs-string">'data'</span> =&gt; [
                <span class="hljs-string">'following_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;id,
                <span class="hljs-string">'following_name'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;following-&gt;name,
                <span class="hljs-string">'post_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;post-&gt;id,<font></font>
            ],<font></font>
        ];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«ã€JSã‚’æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><code>app.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’</font><font style="vertical-align: inherit;">é–‹ã„</font><font style="vertical-align: inherit;">ã¦è¿½åŠ ã—ã¾ã™</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// ...</span>
<span class="hljs-built_in">window</span>.Pusher = <span class="hljs-built_in">require</span>(<span class="hljs-string">'pusher-js'</span>);
<span class="hljs-keyword">import</span> Echo <span class="hljs-keyword">from</span> <span class="hljs-string">"laravel-echo"</span>;
<span class="hljs-built_in">window</span>.Echo = <span class="hljs-keyword">new</span> Echo({
    <span class="hljs-attr">broadcaster</span>: <span class="hljs-string">'pusher'</span>,
    <span class="hljs-attr">key</span>: <span class="hljs-string">'your-pusher-key'</span>,
    <span class="hljs-attr">cluster</span>: <span class="hljs-string">'eu'</span>,
    <span class="hljs-attr">encrypted</span>: <span class="hljs-literal">true</span><font></font>
});<font></font>
<span class="hljs-keyword">var</span> notifications = [];
<span class="hljs-comment">//...</span>
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span>(Laravel.userId) {
        <span class="hljs-comment">//...</span>
        <span class="hljs-built_in">window</span>.Echo.private(<span class="hljs-string">`App.User.<span class="hljs-subst">${Laravel.userId}</span>`</span>)<font></font>
            .notification(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> {<font></font>
                addNotifications([notification], <span class="hljs-string">'#notifications'</span>);<font></font>
            });<font></font>
    }<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã™ã¹ã¦ã§ã™ã€‚</font><font style="vertical-align: inherit;">é€šçŸ¥ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¿½åŠ ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã§ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ“ä½œã—ã¦ã€é€šçŸ¥ãŒæ›´æ–°ã•ã‚Œã‚‹æ–¹æ³•ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµè«–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ã¯éå¸¸ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªAPIã‚’å‚™ãˆã¦ãŠã‚Šã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã®å®Ÿè£…ã‚’éå¸¸ã«ç°¡å˜ã«ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">Laravelé€šçŸ¥ã¨çµ„ã¿åˆã‚ã›ã¦ã€1ã¤ã®å ´æ‰€ã‹ã‚‰è¤‡æ•°ã®ãƒãƒ£ãƒãƒ«ï¼ˆãƒ¡ãƒ¼ãƒ«ã€SMSã€Slackãªã©ï¼‰ã‚’ä»‹ã—ã¦é€šçŸ¥ã‚’é€ä¿¡ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ–ãƒ­ã‚°ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½è·¡ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ä¸Šè¨˜ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦æ”¹å–„ã—ã€ã‚¹ãƒ ãƒ¼ã‚ºãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pusherã¨Laravelã«ã¯ã€ã•ã‚‰ã«å¤šãã®é€šçŸ¥ãŒã‚ã‚Šã¾ã™ã€‚ã‚¿ãƒ³ãƒ‡ãƒ ã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã€æºå¸¯é›»è©±ã€IOTãƒ‡ãƒã‚¤ã‚¹ã«ãƒ‘ãƒ–/ã‚µãƒ–ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€ä¿¡ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®APIã‚‚ã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pusherã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ—ãƒƒã‚·ãƒ£ãƒ¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laravel docs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€ãã®ä½¿ç”¨æ³•ã¨çœŸã®å¯èƒ½æ€§ã«ã¤ã„ã¦è©³ã—ãå­¦ç¿’ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ¡ãƒ³ãƒˆã€è³ªå•ã€æ¨å¥¨äº‹é …ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã§è‡ªç”±ã«å…±æœ‰ã—ã¦ãã ã•ã„ï¼</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ã‚¹ã®è©³ç´°ã‚’ã”è¦§ãã ã•ã„ã€‚</font></font><br>
</a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja496634/index.html">ç”³è«‹è€…ã®ãŸã‚ã®å­¦æ ¡21</a></li>
<li><a href="../ja496638/index.html">Fï¼ƒã€æ¥ç¶šã•ã‚ŒãŸç”»åƒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒãƒ¼ã‚­ãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a></li>
<li><a href="../ja496640/index.html">Covid-19ï¼šãƒ­ã‚·ã‚¢ã§ã®ãƒ“ã‚¸ãƒã‚¹ã«ä½•ãŒèµ·ã“ã‚‹ã‹[ãã—ã¦ãã‚ŒãŒã„ã¤çµ‚ã‚ã‚‹ã‹]</a></li>
<li><a href="../ja496642/index.html">æœ€æ–°ã®é™çš„UPSã¨å›è»¢UPSã®æ¯”è¼ƒã€‚ã‚¹ã‚¿ãƒ†ã‚£ãƒƒã‚¯UPSãŒé™ç•Œã«é”ã—ã¾ã—ãŸã‹ï¼Ÿ</a></li>
<li><a href="../ja496650/index.html">FarSee-Netã®è¨˜äº‹ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼-ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</a></li>
<li><a href="../ja496654/index.html">å•é¡Œï¼ƒ35ï¼šITãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°-ä¸»è¦ä¼æ¥­ã®ç¾åœ¨ã®å•é¡Œã¨èª²é¡Œ</a></li>
<li><a href="../ja496664/index.html">ã•ã¾ã–ã¾ãªä»•äº‹ã€é»’ã€ç™½ã€èµ¤</a></li>
<li><a href="../ja496666/index.html">Mediastreamer2 VoIPã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç ”ç©¶ã—ã¾ã™ã€‚ãƒ‘ãƒ¼ãƒˆ8</a></li>
<li><a href="../ja496670/index.html">ãƒ‘ãƒ³ãƒ‡ãƒŸãƒƒã‚¯å¾Œã€ç¤¾ä¼šã¯å¤‰ã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ</a></li>
<li><a href="../ja496672/index.html">IDA FREEãŠã‚ˆã³ãã®ä»–ã®ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ãŸæ´»ç”¨ã¨é€†è»¢ã®ç´¹ä»‹ã€‚ç¬¬2ç« </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>