<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤴🏼 🙏🏾 🍘 STM32搭載のSSD1283Aで半透過型TFTディスプレイを発売 ⚔️ ⛰️ 💅🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き
 表示モデルはH016IT01と呼ばれます。このディスプレイは、主に半透過型であるため興味深いものです。これは、明るい太陽の下でも画像が見えることを意味します。また、これは有名な中国のサイトでこの機能を使用できるほぼ唯一のモデルです。
 
 しかし、SSD1283Aコントローラーに関する情報...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>STM32搭載のSSD1283Aで半透過型TFTディスプレイを発売</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482610/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表示モデルはH016IT01と呼ばれます。このディスプレイは、主に半透過型であるため興味深いものです。これは、明るい太陽の下でも画像が見えることを意味します。また、これは有名な中国のサイトでこの機能を使用できるほぼ唯一のモデルです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、SSD1283Aコントローラーに関する情報がほとんどないため（ロシア語とネットワークの西側セグメントの両方で）、この記事はリリースされました。また、マニュアルをどこにも見たことがありません。ネットワークでデータシートを見つけることができますが、ディスプレイの初期化と操作に関する情報はなく、レジスターの説明のみが役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はこの資料が確かに究極の真実ではないことを強調したいと思います。</font><font style="vertical-align: inherit;">私はデバイスとの対話の私の経験のみを与えます。</font><font style="vertical-align: inherit;">この記事の主な目的は単純です。このディスプレイを使用して決定、作業、または作業を行うすべての人を支援することです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p0/gd/1j/p0gd1jufxnqryrfftzkjnqwaldk.png" alt="画像"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ディスプレイには8つのピンがあります</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。1）GND </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）VCC-5または3.3V </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）CS-SPIチップセレクト</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4）RST-"0"-ディスプレイをオフにし、 "1"-オンにします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5）A0 / DC -データコマンド（「0」 -コマンド、「1」 -データ）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6）SDA - SPI MOSI </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7）SCK - SPI SCK </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8）LED - 3.3から5VのVCCのようなバックライト出力は、</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラム表示SPIが必要です。stm32f407のディスカバリーボードがこれに役立ちます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はSPI経由でSSD1283Aを操作しましたが、コントローラーがパラレルインターフェイスも提供していることは注目に値しますが、このディスプレイモデルはサポートしていません。</font><font style="vertical-align: inherit;">彼のSPIも普通ではなく、SDAデータラインは1つしかありません。</font><font style="vertical-align: inherit;">実際、これはMOSI行です。つまり、データシートが伝えている表示から何も数えることができません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/v1/0r/kj/v10rkj930c35sxs3jaiyqrpuvsm.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初にSPIを構成します。このため、SPI1とGPIOを攻撃し、SDAとSCKのレッグを代替機能として構成します（MISOも行いましたが、これは必須ではありません）。</font><font style="vertical-align: inherit;">動作モードは、単方向送信機マスターとして構成されています。</font></font><br>
<br>
<pre><code class="cpp hljs">BIT_BAND_PER(RCC-&gt;AHB1ENR ,RCC_AHB1ENR_GPIOAEN) = <span class="hljs-literal">true</span>; 
 <span class="hljs-keyword">if</span>(SPI_NUM::_1 == spi)<font></font>
  {<font></font>
    <span class="hljs-comment">/*!&lt;-------------Enable spi clocking---------------&gt;!*/</span>
     BIT_BAND_PER(RCC-&gt;APB2ENR, RCC_APB2ENR_SPI1EN) = <span class="hljs-literal">true</span>;<font></font>
     <font></font>
     <span class="hljs-comment">/*!&lt;----PA5 - SCK, PA6 - MISO, PA7 - MOSI----&gt;!*/</span><font></font>
     GPIOA-&gt;MODER |= (GPIO_MODER_MODE5_1 | GPIO_MODER_MODE6_1 | GPIO_MODER_MODE7_1);<font></font>
     GPIOA-&gt;OSPEEDR |= (GPIO_OSPEEDR_OSPEED5_1 | GPIO_OSPEEDR_OSPEED7_1);<font></font>
     GPIOA-&gt;AFR[<span class="hljs-number">0</span>] |= (GPIO_AFRL_AFSEL5_0 | GPIO_AFRL_AFSEL5_2 | GPIO_AFRL_AFSEL6_0 | GPIO_AFRL_AFSEL6_2 | GPIO_AFRL_AFSEL7_0 | GPIO_AFRL_AFSEL7_2);<font></font>
     <font></font>
     <span class="hljs-comment">/*!&lt;-----customize SPI------&gt;!*/</span>
     SPI1-&gt;CR1 |= (SPI_CR1_BIDIMODE | SPI_CR1_BIDIOE | SPI_CR1_SSM | SPI_CR1_SSI <span class="hljs-comment">/*| SPI_CR1_DFF*/</span> | SPI_CR1_MSTR); <font></font>
     BIT_BAND_PER(SPI1-&gt;CR1 ,SPI_CR1_SPE) = <span class="hljs-literal">true</span>;<font></font>
  }</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、SPIによって単純なバイト転送関数を記述します。</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stm32f407_spi::stm32f407_spi_send</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> data)</span>
</span>{<font></font>
  SPI1-&gt;DR = data;<font></font>
  <span class="hljs-keyword">while</span>((SPI1-&gt;SR &amp; SPI_SR_BSY)) <span class="hljs-keyword">continue</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、SPIが必要なモードで動作し、可能な限り最高の速度でデータを送信するのに十分です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディスプレイの初期化</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今こそディスプレイを初期化する時です。</font><font style="vertical-align: inherit;">これを行うには、一連のコマンドを送信します。</font><font style="vertical-align: inherit;">コマンドは3バイトで構成され、1バイトはコマンド番号で、他の2バイトはデータです。</font><font style="vertical-align: inherit;">また、コマンドバイトを「0」に送信するとき、およびデータが「1」の場合は、ピンA0を切り替える必要があります。</font><font style="vertical-align: inherit;">便宜上、ディスプレイのRST、A0、CSピンの状態を切り替えるインライン関数を作成しました。</font></font><br>
<br>
<pre><code class="cpp hljs">  
<span class="hljs-keyword">enum</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DC</span> :</span> <span class="hljs-keyword">uint8_t</span> <font></font>
{<font></font>
  COMMAND,<font></font>
  DATA<font></font>
}; <font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> inline=forced </span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd_rst</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> rst)</span> </span>{BIT_BAND_PER(GPIOA-&gt;ODR , GPIO_ODR_OD2) = rst;}
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> inline=forced </span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd_dc</span><span class="hljs-params">(DC dc)</span> </span>{BIT_BAND_PER(GPIOA-&gt;ODR , GPIO_ODR_OD3) = <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">bool</span>&gt;(dc);}
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> inline=forced </span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd_cs</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> cs)</span> </span>{BIT_BAND_PER(GPIOA-&gt;ODR , GPIO_ODR_OD4) = cs;}</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドを送信すると、次のようになります。</font></font><br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd::tft_lcd_send</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> addr, <span class="hljs-keyword">uint16_t</span> data)</span>
</span>{
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_dc(DC::COMMAND);<font></font>
  stm32f407_spi_send(addr);<font></font>
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_dc(DC::DATA);<font></font>
  stm32f407_spi_send(<span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;(data &gt;&gt; <span class="hljs-number">8</span>));<font></font>
  stm32f407_spi_send(<span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;(data)); <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初期化するには、次の一連のコマンドを送信する必要があります。これらのコマンドは、この画面のarduinoライブラリで調べました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期化コマンド</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">uint8_t</span> TFT_DELAY = <span class="hljs-number">0xFF</span>;
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">constexpr</span> t_tft_regs tft_regs[]=<font></font>
  {<font></font>
    { <span class="hljs-number">0x10</span>, <span class="hljs-number">0x2F8E</span> },<font></font>
    { <span class="hljs-number">0x11</span>, <span class="hljs-number">0x000C</span> },<font></font>
    { <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0021</span> },<font></font>
    { <span class="hljs-number">0x28</span>, <span class="hljs-number">0x0006</span> },<font></font>
    { <span class="hljs-number">0x28</span>, <span class="hljs-number">0x0005</span> },<font></font>
    { <span class="hljs-number">0x27</span>, <span class="hljs-number">0x057F</span> },<font></font>
    { <span class="hljs-number">0x29</span>, <span class="hljs-number">0x89A1</span> },<font></font>
    { <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0001</span> },<font></font>
    { TFT_DELAY, <span class="hljs-number">100</span> },<font></font>
    { <span class="hljs-number">0x29</span>, <span class="hljs-number">0x80B0</span> },<font></font>
    { TFT_DELAY, <span class="hljs-number">30</span> },<font></font>
    { <span class="hljs-number">0x29</span>, <span class="hljs-number">0xFFFE</span> },<font></font>
    { <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0223</span> },<font></font>
    { TFT_DELAY, <span class="hljs-number">30</span> },<font></font>
    { <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0233</span> },<font></font>
    { <span class="hljs-number">0x01</span>, <span class="hljs-number">0x2183</span> },<font></font>
    { <span class="hljs-number">0x03</span>, <span class="hljs-number">0x6830</span> },<font></font>
    { <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFFFF</span> },<font></font>
    { <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x8000</span> },<font></font>
    { <span class="hljs-number">0x27</span>, <span class="hljs-number">0x0570</span> },<font></font>
    { <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0300</span> },<font></font>
    { <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x580C</span> },<font></font>
    { <span class="hljs-number">0x12</span>, <span class="hljs-number">0x0609</span> },<font></font>
    { <span class="hljs-number">0x13</span>, <span class="hljs-number">0x3100</span> },<font></font>
  };</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、TFT_DELAYは、指定された量のミリ秒の単純なスリープを意味します。</font><font style="vertical-align: inherit;">データシートを詳しく調べると、多くのアドレスが予約ビットに書き込むため、一部のアドレスのデータは奇妙に見えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初期化するには、CSを「0」にして、ディスプレイを再起動し（RSTピン）、コマンドの表を確認します。</font></font><br>
<br>
<pre><code class="cpp hljs">  tft_lcd_rst(<span class="hljs-literal">false</span>);<font></font>
  delay(<span class="hljs-number">5</span>, mS);<font></font>
  tft_lcd_rst(<span class="hljs-literal">true</span>);<font></font>
  delay(<span class="hljs-number">200</span>, mS);<font></font>
    <font></font>
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_cs(<span class="hljs-literal">false</span>);<font></font>
  delay(<span class="hljs-number">5</span>, mS);
  <span class="hljs-comment">/*!&lt;--------Init display----------&gt;!*/</span> <font></font>
<font></font>
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">uint8_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(tft_regs)/<span class="hljs-keyword">sizeof</span>(tft_regs[<span class="hljs-number">0</span>]) ;i++)<font></font>
  {<font></font>
    (TFT_DELAY != tft_regs[i].address) ? (<span class="hljs-keyword">this</span>-&gt;tft_lcd_send(tft_regs[i].address, tft_regs[i].value)): (delay(tft_regs[i].value, mS));<font></font>
  } <font></font>
  delay(<span class="hljs-number">5</span>, mS);
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_cs(<span class="hljs-literal">true</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、ディスプレイはテレビの干渉を白からグレーに変更します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jf/i5/yk/jfi5yk1wxjfkjgukmvf3al_xlz0.jpeg" alt="画像"> <br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長方形を描く</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSD1283Aコントローラーを使用すると、4つのコマンドが使用される長方形でイメージを描画できます。 0x44コマンドには、横座標軸に沿った長方形の最後と最初の座標が、それぞれ上位と下位のデータバイトに含まれています。 0x45コマンドは、縦軸でも同じです。 0x21コマンドには、初期レンダリングの座標が、yの上位バイト、xの下位バイトに含まれています。 0x22コマンドには、現在のピクセルの色が含まれています。これは</font><font style="vertical-align: inherit;">、現在の四角形のピクセル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ごと</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に繰り返す必要があることを意味し</font><font style="vertical-align: inherit;">ます。ディスプレイにも機能がありますが、それ自体の解像度は130x130ですが、その仮想座標グリッドのサイズは132x132で、座標は2x2の点からカウントを開始します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、たとえば、開始点が（</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
30、45）にある20 x </font><font style="vertical-align: inherit;">20の黒い正方形を描画する場合、次の一連のコマンドを送信する必要があります：</font><font style="vertical-align: inherit;">0x44 0x3320（30 + 20 + 2-1、30 + 2）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0x45 0x422F（45 + 20 + </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2-1、45 </font><font style="vertical-align: inherit;">+ 2）</font><font style="vertical-align: inherit;">0x21 0x2F20 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0x22 0x0000、およびこのコマンドは400（20 * 20）回送信する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すると、長方形の描画関数は次のようになります（ただし、座標がすでに2シフトしている場合）。</font></font><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd::draw_rect</span><span class="hljs-params">(<span class="hljs-keyword">const</span> t_rect&amp; rec)</span>
</span>{
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_send(<span class="hljs-number">0x44</span>, ((rec.x1 - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">8</span>) | rec.x0);
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_send(<span class="hljs-number">0x45</span>, ((rec.y1 - <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">8</span>) | rec.y0);
  <span class="hljs-keyword">this</span>-&gt;tft_lcd_send(<span class="hljs-number">0x21</span>, (rec.y0 &lt;&lt; <span class="hljs-number">8</span>) | rec.x0);<font></font>
  <font></font>
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">uint16_t</span> i = <span class="hljs-number">0</span>; i &lt; ((rec.x1 - rec.x0) * (rec.y1 - rec.y0)); i++)<font></font>
  {<font></font>
    <span class="hljs-keyword">this</span>-&gt;tft_lcd_send(<span class="hljs-number">0x22</span>, rec.col);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長方形を描くには、その角の座標と色を指定するだけです。</font><font style="vertical-align: inherit;">画面全体をピンクで埋める例は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">
  t_rect rect = {<span class="hljs-number">0x02</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x84</span>, <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">uint16_t</span>&gt;(COLOUR::MAGENTA)};
  <span class="hljs-keyword">this</span>-&gt;draw_rect(rect);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/w-/l1/ubw-l18pd4pkgsav5k07vmx_d60.jpeg" alt="画像"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字と数字を描く</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文字の座標を含む配列のリストを作成します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字と数字の座標の配列</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">
<span class="hljs-keyword">namespace</span> rect_coord_lit<font></font>
{<font></font>
<span class="hljs-keyword">const</span> t_rect_coord comma[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">3</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">28</span>}};
<span class="hljs-keyword">const</span> t_rect_coord dot[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord space[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _0[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _1[] = {{<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _2[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _3[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _4[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _5[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _6[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _7[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _8[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>}};
<span class="hljs-keyword">const</span> t_rect_coord _9[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>}};
<span class="hljs-keyword">const</span> t_rect_coord a[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord b[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord c[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord d[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord e[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">8</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord f[] = {{<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>}};
<span class="hljs-keyword">const</span> t_rect_coord g[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>}};
<span class="hljs-keyword">const</span> t_rect_coord h[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord i[] = {{<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord j[] = {{<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">30</span>}};
<span class="hljs-keyword">const</span> t_rect_coord k[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">20</span> , <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord l[] = {{<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord m[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">4</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">7</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">13</span>, <span class="hljs-number">10</span>, <span class="hljs-number">17</span>,<span class="hljs-number">25</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">5</span> , <span class="hljs-number">12</span>, <span class="hljs-number">10</span>}};
<span class="hljs-keyword">const</span> t_rect_coord n[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">5</span> , <span class="hljs-number">10</span>, <span class="hljs-number">10</span>}};
<span class="hljs-keyword">const</span> t_rect_coord o[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord p[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">30</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>}};
<span class="hljs-keyword">const</span> t_rect_coord q[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>}};
<span class="hljs-keyword">const</span> t_rect_coord r[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}};
<span class="hljs-keyword">const</span> t_rect_coord s[] = {{<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">13</span>}, {<span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">17</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">17</span>, <span class="hljs-number">15</span>, <span class="hljs-number">22</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord t[] = {{<span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord u[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>},{<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord v[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">15</span>}, {<span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">9</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord w[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">20</span>},{<span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">13</span>, <span class="hljs-number">5</span>, <span class="hljs-number">17</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">4</span>, <span class="hljs-number">20</span> , <span class="hljs-number">7</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">20</span> , <span class="hljs-number">13</span>, <span class="hljs-number">25</span>}};
<span class="hljs-keyword">const</span> t_rect_coord x[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>},{<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">20</span> , <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">10</span> , <span class="hljs-number">10</span>, <span class="hljs-number">20</span>}};
<span class="hljs-keyword">const</span> t_rect_coord y[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>}};
<span class="hljs-keyword">const</span> t_rect_coord z[] = {{<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>}, {<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>}, {<span class="hljs-number">5</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">18</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">17</span>, <span class="hljs-number">5</span>, <span class="hljs-number">20</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>}};<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キャラクター自体（ASCII）、長方形の数、および座標を関連付けるテーブルを作成します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">座標ポインターテーブル</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span>
{</span>
	<span class="hljs-keyword">char</span> lit;
        <span class="hljs-keyword">uint8_t</span> size;
	<span class="hljs-keyword">const</span> t_rect_coord *rec_coord;<font></font>
}t_rect_coord_table;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITERAL_COORD(x)  sizeof(x)/ sizeof(x[0]), x  </span><font></font>
<font></font>
<span class="hljs-keyword">const</span> t_rect_coord_table rect_coord_table[] = <font></font>
{<font></font>
  {<span class="hljs-string">','</span>, LITERAL_COORD(rect_coord_lit::comma)},<font></font>
  {<span class="hljs-string">'.'</span>, LITERAL_COORD(rect_coord_lit::dot)},<font></font>
  {<span class="hljs-string">'.'</span>, LITERAL_COORD(rect_coord_lit::dot)},<font></font>
  {<span class="hljs-string">' '</span>, LITERAL_COORD(rect_coord_lit::space)},<font></font>
  {<span class="hljs-string">'0'</span>, LITERAL_COORD(rect_coord_lit::_0)},<font></font>
  {<span class="hljs-string">'1'</span>, LITERAL_COORD(rect_coord_lit::_1)},<font></font>
  {<span class="hljs-string">'2'</span>, LITERAL_COORD(rect_coord_lit::_2)},<font></font>
  {<span class="hljs-string">'3'</span>, LITERAL_COORD(rect_coord_lit::_3)},<font></font>
  {<span class="hljs-string">'4'</span>, LITERAL_COORD(rect_coord_lit::_4)},<font></font>
  {<span class="hljs-string">'5'</span>, LITERAL_COORD(rect_coord_lit::_5)},<font></font>
  {<span class="hljs-string">'6'</span>, LITERAL_COORD(rect_coord_lit::_6)},<font></font>
  {<span class="hljs-string">'7'</span>, LITERAL_COORD(rect_coord_lit::_7)},<font></font>
  {<span class="hljs-string">'8'</span>, LITERAL_COORD(rect_coord_lit::_8)},<font></font>
  {<span class="hljs-string">'9'</span>, LITERAL_COORD(rect_coord_lit::_9)},<font></font>
  {<span class="hljs-string">'a'</span>, LITERAL_COORD(rect_coord_lit::a)}, <font></font>
  {<span class="hljs-string">'b'</span>, LITERAL_COORD(rect_coord_lit::b)},<font></font>
  {<span class="hljs-string">'c'</span>, LITERAL_COORD(rect_coord_lit::c)},<font></font>
  {<span class="hljs-string">'d'</span>, LITERAL_COORD(rect_coord_lit::d)},<font></font>
  {<span class="hljs-string">'e'</span>, LITERAL_COORD(rect_coord_lit::e)},<font></font>
  {<span class="hljs-string">'f'</span>, LITERAL_COORD(rect_coord_lit::f)},<font></font>
  {<span class="hljs-string">'g'</span>, LITERAL_COORD(rect_coord_lit::g)},<font></font>
  {<span class="hljs-string">'h'</span>, LITERAL_COORD(rect_coord_lit::h)},<font></font>
  {<span class="hljs-string">'i'</span>, LITERAL_COORD(rect_coord_lit::i)},<font></font>
  {<span class="hljs-string">'j'</span>, LITERAL_COORD(rect_coord_lit::j)},<font></font>
  {<span class="hljs-string">'k'</span>, LITERAL_COORD(rect_coord_lit::k)},<font></font>
  {<span class="hljs-string">'l'</span>, LITERAL_COORD(rect_coord_lit::l)},<font></font>
  {<span class="hljs-string">'m'</span>, LITERAL_COORD(rect_coord_lit::m)},<font></font>
  {<span class="hljs-string">'n'</span>, LITERAL_COORD(rect_coord_lit::n)},<font></font>
  {<span class="hljs-string">'o'</span>, LITERAL_COORD(rect_coord_lit::o)},<font></font>
  {<span class="hljs-string">'p'</span>, LITERAL_COORD(rect_coord_lit::p)},<font></font>
  {<span class="hljs-string">'q'</span>, LITERAL_COORD(rect_coord_lit::q)},<font></font>
  {<span class="hljs-string">'r'</span>, LITERAL_COORD(rect_coord_lit::r)},<font></font>
  {<span class="hljs-string">'s'</span>, LITERAL_COORD(rect_coord_lit::s)},<font></font>
  {<span class="hljs-string">'t'</span>, LITERAL_COORD(rect_coord_lit::t)},<font></font>
  {<span class="hljs-string">'u'</span>, LITERAL_COORD(rect_coord_lit::u)},<font></font>
  {<span class="hljs-string">'v'</span>, LITERAL_COORD(rect_coord_lit::v)},<font></font>
  {<span class="hljs-string">'w'</span>, LITERAL_COORD(rect_coord_lit::w)},<font></font>
  {<span class="hljs-string">'x'</span>, LITERAL_COORD(rect_coord_lit::x)},<font></font>
  {<span class="hljs-string">'y'</span>, LITERAL_COORD(rect_coord_lit::y)},<font></font>
  {<span class="hljs-string">'z'</span>, LITERAL_COORD(rect_coord_lit::z)}<font></font>
};<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、1つの文字の描画関数は次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd::draw_lit</span><span class="hljs-params">(<span class="hljs-keyword">char</span> ch, <span class="hljs-keyword">const</span> t_rect_coord *rect_coord, <span class="hljs-keyword">uint16_t</span> colour, <span class="hljs-keyword">uint16_t</span> x0, <span class="hljs-keyword">uint16_t</span> y0, <span class="hljs-keyword">uint8_t</span> size)</span>
</span>{<font></font>
  t_rect rec = {<span class="hljs-number">0</span>};<font></font>
  rec.col = colour;<font></font>
  <span class="hljs-keyword">uint8_t</span> ctr = size;
  <span class="hljs-keyword">uint8_t</span> i = <span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-keyword">while</span>(ctr--)<font></font>
  {<font></font>
    rec.x0 = x0 + rect_coord[i].x0;<font></font>
    rec.y0 = y0 + rect_coord[i].y0;<font></font>
    rec.x1 = x0 + rect_coord[i].x1;<font></font>
    rec.y1 = y0 + rect_coord[i].y1;<font></font>
    i++;<font></font>
    <span class="hljs-keyword">this</span>-&gt;draw_rect(rec);<font></font>
  }<font></font>
  <font></font>
  <font></font>
}<font></font>
                        <font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd::draw_char</span><span class="hljs-params">(<span class="hljs-keyword">char</span> ch, <span class="hljs-keyword">uint16_t</span> colour, <span class="hljs-keyword">uint16_t</span> x0, <span class="hljs-keyword">uint16_t</span> y0)</span>
</span>{<font></font>
  x0 += <span class="hljs-number">2</span>;<font></font>
  y0 +=<span class="hljs-number">2</span>;<font></font>
  <font></font>
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span> &amp;field : rect_coord_table)<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span>(field.lit == ch)<font></font>
    {<font></font>
      draw_lit(ch, field.rec_coord, colour, x0, y0, field.size);<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
draw_char関数は有限状態機械を表し、forループは座標テーブルの各フィールドを通過し、シンボルによる一致を探します。</font><font style="vertical-align: inherit;">一致が見つかった場合、データはdraw_lit関数に転送され、指定された座標に必要な数の長方形が描画されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
線画は次のようになります。</font></font><br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tft_lcd::draw_string</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *ch, COLOUR colour, <span class="hljs-keyword">uint16_t</span> x0, <span class="hljs-keyword">uint16_t</span> y0)</span>
</span>{
  <span class="hljs-keyword">while</span>(*ch)<font></font>
  {<font></font>
    <span class="hljs-keyword">this</span>-&gt;draw_char(*ch, <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">uint16_t</span>&gt;(colour), x0, y0);<font></font>
    x0+= <span class="hljs-number">20</span>;<font></font>
    ch++;<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、線、その初期位置、色を設定するだけで十分です。</font><font style="vertical-align: inherit;">新しい文字を追加するには、座標の配列を作成してテーブルに追加するだけです。</font><font style="vertical-align: inherit;">コードによるランダムな行の例：</font></font><br>
<br>
<pre><code class="cpp hljs">
  <span class="hljs-keyword">this</span>-&gt;draw_string(<span class="hljs-string">"123456"</span>, COLOUR::GREEN, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">this</span>-&gt;draw_string(<span class="hljs-string">"habr,."</span>, COLOUR::WHITE, <span class="hljs-number">5</span>, <span class="hljs-number">30</span>);
  <span class="hljs-keyword">this</span>-&gt;draw_string(<span class="hljs-string">"abcdef"</span>, COLOUR::RED, <span class="hljs-number">5</span>, <span class="hljs-number">60</span>);
  <span class="hljs-keyword">this</span>-&gt;draw_string(<span class="hljs-string">"stwxyz"</span>, COLOUR::YELLOW, <span class="hljs-number">5</span>, <span class="hljs-number">90</span>);
</code></pre> <br>
<img src="https://habrastorage.org/webt/wb/dm/bu/wbdmbutkcu8_pd68fgq08sx5mjq.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモードでは、表示は高速で、目は描画プロセスに気づきません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ある方は、リンクからプロジェクトコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全体を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ご覧いただけます</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482594/index.html">花火の禁止：問題があるようです</a></li>
<li><a href="../ja482596/index.html">星間オペレーティングシステム</a></li>
<li><a href="../ja482598/index.html">ディアトロフグループの偽造写真</a></li>
<li><a href="../ja482604/index.html">1920年の5つのキャラクター、100年後に雲に昇った</a></li>
<li><a href="../ja482608/index.html">Habr＃15のAMA 新年と最短リリース！チャット</a></li>
<li><a href="../ja482612/index.html">触れるエンジニアのバスボード、新年、ボランティア</a></li>
<li><a href="../ja482614/index.html">DoomでBSPを使用することは本当に天才的な動きですか？</a></li>
<li><a href="../ja482616/index.html">Foreve Elon 2019/2020（NY2020オンライン会議）</a></li>
<li><a href="../ja482620/index.html">スラム：ハブル、幸せな休日...</a></li>
<li><a href="../ja482622/index.html">雨の中を走るシミュレーション</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>