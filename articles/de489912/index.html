<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüåæ üë®üèæ‚Äçüî¨ ‚úÇÔ∏è Die Schmerzen und Leiden beim Debuggen von Microservices in der Webentwicklung üòñ üëßüèæ üë©üèº‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der IT sehen Sie selten eine Person, die noch nichts von Microservices geh√∂rt hat. Im Internet und auf speziellen Websites zu diesem Thema gibt es ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Die Schmerzen und Leiden beim Debuggen von Microservices in der Webentwicklung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489912/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der IT sehen Sie selten eine Person, die noch nichts von Microservices geh√∂rt hat. Im Internet und auf speziellen Websites zu diesem Thema gibt es viele Artikel, die die Unterschiede zwischen dem Monolithen und den Mikrodiensten im Allgemeinen gut erkl√§ren. Ein unerfahrener Java-Entwickler, der Artikel aus der Kategorie ‚ÄûWas sind Microservices f√ºr Webanwendungen und womit sie essen‚Äú gelesen hat, ist voller Freude und Zuversicht, dass jetzt alles wunderbar wird. Schlie√ülich besteht das Hauptziel darin, den monstr√∂sen Monolithen (das letzte Artefakt, bei dem es sich in der Regel um eine Kriegs- / Ohr-Datei handelt) zu ‚Äûdurchschauen‚Äú, der eine Reihe von Dingen f√ºr eine Reihe von separat lebenden Diensten ausf√ºhrt, von denen jeder eine streng definierte Funktion erf√ºllt, die nur mit ihm zusammenh√§ngt. und wird es gut machen. Hinzu kommt die horizontale Skalierbarkeit - </font><b><font style="vertical-align: inherit;">skalieren Sie</font></b><font style="vertical-align: inherit;"> einfach</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entsprechende Knoten, und alles wird gro√üartig sein. </font><font style="vertical-align: inherit;">Es sind mehr Benutzer angekommen oder es sind mehr Kapazit√§ten erforderlich - es wurden nur 5-10 neue Dienstinstanzen hinzugef√ºgt. </font><font style="vertical-align: inherit;">Grob gesagt funktioniert das im Allgemeinen so, aber wie Sie wissen, steckt der Teufel im Detail, und was bei n√§herer Betrachtung zun√§chst recht einfach schien, kann zu Problemen werden, die anfangs niemand ber√ºcksichtigt hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beitrag teilen Kollegen aus der Java-Praxis von Rexoft ihre Erfahrungen mit dem Debuggen von Microservices f√ºr das Web.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/ls/xd/silsxdh5v-rwgybittlu4bvbcz0.png"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So erreichen Sie die Integrit√§t von Transaktionsdaten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Versuch, die Architektur von einem Monolithen auf Microservices zu √ºbertragen, beginnen Teams, die zuvor keine solche Erfahrung hatten, h√§ufig, Services in Objekte der obersten Ebene des Dom√§nenmodells aufzuteilen, z. B.: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer / Client / Mitarbeiter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usw. In Zukunft wird mit einer detaillierteren Studie Verst√§ndnis angezeigt. Dies ist bequemer, um in gr√∂√üere Bl√∂cke zu zerlegen, die mehrere Objekte der Dom√§nendom√§ne in sich zusammenfassen. Auf diese Weise k√∂nnen Sie unn√∂tige Anrufe bei Diensten von Drittanbietern vermeiden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite wichtige Punkt ist die Unterst√ºtzung der Integrit√§t von Transaktionsdaten. Im Monolithen wird dieses Problem durch den Anwendungsserver gel√∂st, auf dem sich Krieg / Ohr dreht, in dem der Container tats√§chlich die Grenzen von Transaktionen umrei√üt. Im Fall von Microservices verschwimmen die Grenzen von Transaktionen, und es besteht neben dem Schreiben von Gesch√§ftslogikcode die Notwendigkeit, die Datenintegrit√§t zu verwalten und ihre Konsistenz zwischen verschiedenen Teilen des Systems aufrechtzuerhalten. Dies ist eine ziemlich nicht triviale Aufgabe. Empfehlungen zur L√∂sung dieser Art von Architekturproblemen finden Sie im Internet und in den relevanten Fachgemeinschaften.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werden wir versuchen, bestimmte technische Schwierigkeiten zu beschreiben, die auftreten, wenn Teams versuchen, mit Microservices zu arbeiten, und M√∂glichkeiten, diese zu l√∂sen. Ich stelle sofort fest, dass die vorgeschlagenen Optionen nicht die einzig wahren sind. Vielleicht gibt es elegantere Dienstleistungen, aber die Empfehlungen, die ich geben werde, werden in der Praxis getestet und l√∂sen die bestehenden Schwierigkeiten genau, und ob sie genutzt werden sollen oder nicht, ist eine pers√∂nliche Angelegenheit f√ºr alle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Hauptproblem bei Microservices besteht darin, dass sie lokal sehr einfach ausgef√ºhrt werden k√∂nnen (mit </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spring.io</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intellij Idea</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kann dies beispielsweise in nur 5 Minuten oder sogar weniger erledigt werden). Wenn Sie jedoch versuchen, dasselbe in </font><b><font style="vertical-align: inherit;">Kubernetes</font></b><font style="vertical-align: inherit;"> zu tun</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Cluster (wenn Sie zuvor wenig Erfahrung damit hatten) kann ein einfacher Start des Controllers, der </font><font style="vertical-align: inherit;">beim Zugriff auf einen bestimmten Endpunkt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄûHello World‚Äú</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> druckt, einen halben Tag dauern. </font><font style="vertical-align: inherit;">Im Fall eines Monolithen ist die Situation einfacher. </font><font style="vertical-align: inherit;">Jeder Entwickler hat einen lokalen Anwendungsserver. </font><font style="vertical-align: inherit;">Der Bereitstellungsprozess ist ebenfalls recht einfach: Sie m√ºssen das endg√ºltige Kriegs- / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ohrartefakt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> manuell oder mithilfe der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an die richtige Stelle im </font><b><font style="vertical-align: inherit;">Anwendungsserver</font></b><font style="vertical-align: inherit;"> kopieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Normalerweise ist dies kein Problem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuancen debuggen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite wichtige Punkt ist das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debuggen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In Situationen mit einem Monolithen wird davon ausgegangen, dass der Entwickler einen Anwendungsserver auf seinem Computer hat, auf dem sein </font><b><font style="vertical-align: inherit;">Krieg / Ohr</font></b><font style="vertical-align: inherit;"> bereitgestellt wird</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sie k√∂nnen jederzeit debuggen, da alles, was Sie ben√∂tigen, zur Hand ist. Bei Microservices ist alles etwas komplizierter, ein Service ist normalerweise eine Sache f√ºr sich. In der Regel verf√ºgt er √ºber ein eigenes Datenbankschema, in dem sich seine Daten befinden, bestimmte f√ºr ihn spezifische Funktionen ausf√ºhren und die gesamte Kommunikation mit anderen Diensten √ºber synchrone HTTP-Aufrufe (z. B. √ºber RestTemplate oder Feign), asynchron (z. B. Kafka oder RabbitMQ) organisiert wird. Daher wird die im Wesentlichen einfache Aufgabe des Speicherns oder Validierens eines bestimmten Objekts, das zuvor an einem Ort innerhalb einer einzelnen Kriegs- / Ohr-Datei implementiert wurde, im allgemeinen Fall mit einem Microservice-Ansatz in der Form darstellbar: Gehen Sie zu einem oder N benachbarten Diensten, sei es Datenerfassungsoperationen B. einige Referenzwerte oder die Operation zum Speichern benachbarter Entit√§ten,deren Daten ben√∂tigt werden, um Gesch√§ftslogik in unserem Service auszuf√ºhren. Das Schreiben von Gesch√§ftslogik wird in diesem Fall viel schwieriger.</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dementsprechend sind die L√∂sungsoptionen wie folgt</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schreiben Sie Ihren Gesch√§ftslogikcode. </font><font style="vertical-align: inherit;">Gleichzeitig werden alle externen Anrufe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verspottet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - externe Vertr√§ge werden emuliert, Tests werden unter der Annahme geschrieben, dass externe Vertr√§ge einfach so sind, und anschlie√üend wird sie zur √úberpr√ºfung in der Leitung bereitgestellt. </font><font style="vertical-align: inherit;">Manchmal ist es ein Gl√ºcksfall und die Integration funktioniert sofort, manchmal ist es ungl√ºcklich - Sie m√ºssen den Gesch√§ftslogikcode ein n-mal mehrmals wiederholen, da w√§hrend der Zeit, in der wir die Funktionalit√§t implementiert haben, der Code im benachbarten Dienst aktualisiert wurde, die API-Signaturen ge√§ndert wurden und wir ihn wiederholen m√ºssen Ein Teil der Aufgabe ist auf seiner Seite.</font></font></li>
<li>     <b></b>.     ,  ,         <b>Kubernetes</b>, . .  ,       ‚Äî     ,     <b>remote debug</b>  .      ,     <b>runtime</b> ,   ,    . -,      ,          2‚Äì5 , . .         ,  <b>Kubernetes</b> ,        . -,           (<b>Per thread</b>),    ,      .</li>
</ol><br>
<h2>     Kubernetes</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine L√∂sung f√ºr dieses Problem ist in der Tat die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telepr√§senz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es gibt wahrscheinlich andere Programme dieser Art, aber pers√∂nliche Erfahrung war nur mit ihm, und er etablierte sich positiv. </font><font style="vertical-align: inherit;">Im Allgemeinen lautet das Funktionsprinzip wie folgt: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem lokalen Computer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installiert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Entwickler </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telepresenc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e, konfiguriert </font><b><font style="vertical-align: inherit;">kubectl</font></b><font style="vertical-align: inherit;"> f√ºr den Zugriff auf den entsprechenden Kubernetes-Cluster (f√ºgt die Schleifenkonfiguration zu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / .kube / config hinzu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Danach beginnt </font><font style="vertical-align: inherit;">die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telepr√§senz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die tats√§chlich als </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proxy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zwischen dem lokalen Entwicklercomputer und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes fungiert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es gibt verschiedene Startoptionen. Es ist besser, im offiziellen Handbuch genauer nachzuschauen, aber im einfachsten Fall sind es zwei Schritte:</font></font><br>
<br>
<ol>
<li><b>Sudo telepresence</b> (,     Linux-  ,     sudo  .  ,        root/).          Kubernetes    deployment   <b>telepresence</b>  .  deployment          Kubernetes.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Starten Ihrer Dienstinstanz erfolgt wie gewohnt auf dem lokalen Computer des Entwicklers. </font><font style="vertical-align: inherit;">In diesem Fall hat er jedoch Zugriff auf die gesamte Infrastruktur des Kubernetes-Clusters, sei es </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Service Discovery (Eureka, Consul), Api Gateway (Zuul), Kafka</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und gegebenenfalls die Warteschlangen usw. </font><font style="vertical-align: inherit;">Das hei√üt, wir haben Zugriff auf alle ben√∂tigten Clusterumgebungen, jedoch lokal. </font><font style="vertical-align: inherit;">Der Bonus ist die M√∂glichkeit des lokalen Debuggens, jedoch in einer Clusterumgebung, und es wird bereits viel schneller sein, da wir uns tats√§chlich in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (durch den Tunnel) befinden und nicht von au√üen √ºber einen Port f√ºr das Remote-Debuggen darauf zugreifen.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese L√∂sung hat mehrere Nachteile:</font></font><br>
<br>
<ol>
<li><b>Telepresence</b>    Linux  Mac,   Windows     VFS,  ,  issue  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">GitHub</a>.          .   ,    - Linux/Mac,      .</li>
<li>      ,      <b>Service Discovery (Eureka, Consul) </b>      ‚Äî                 <b>Round Robin</b>  ,         endpoint  ,  ,   ,    : </li>
</ol><br>
<ul>
<li>       kubernetes -&gt;   .   <b>telepresence</b>      deployment  ,      ¬´¬ª     Eureka   <b>ip-address:port/service-name</b>  <b>dns-name:port/service-name</b>    ,  . .   Kubernetes        ,      timeout;</li>
<li>      deployment     -  Kubernetes    , <b> </b>      (   )           (Round Robin),    ;</li>
<li>  endpoint,      <b>feature</b>,     HTTP 404    endpoint  <b>Gateway</b>,          <b>Service Discovery</b>     ,    <b>Round Robin</b> .         Service Discovery  endpoint  ,    HTTP 404.</li>
<li> ,    ,        <b> </b> .</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter dynamischem Routing einer Anforderung verstehen wir, dass das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API-Gateway (Zuul)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zwischen mehreren Instanzen desselben Dienstes w√§hlen kann, die wir ben√∂tigen. Im allgemeinen Fall kann dieses Problem gel√∂st werden, indem ein Pr√§dikat hinzugef√ºgt wird, mit dem Sie in der Anforderungsverarbeitungsphase den gew√ºnschten Dienst aus dem gemeinsamen Dienstpool mit demselben Namen ausw√§hlen k√∂nnen. Nat√ºrlich muss jeder Dienst unter denen, mit denen wir dynamisch routen m√∂chten, √ºber eine Art Metainformation verf√ºgen, die Daten enth√§lt, anhand derer bestimmt wird, ob dieser Dienst ben√∂tigt wird oder nicht. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit Spring Cloud</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (im Fall von Eureka) k√∂nnen Sie dies beispielsweise tun, indem Sie in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.yml</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in einem speziellen Metadatenblock Folgendes </font><b><font style="vertical-align: inherit;">angeben</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">eureka:<font></font>
  instance:<font></font>
    preferIpAddress: true<font></font>
    metadata-map:<font></font>
      service.label: develop</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der </font><font style="vertical-align: inherit;">Registrierung einen solchen Dienst in Service Discovery in seiner </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.netflix.appinfo.InstanceInfo # getMetadata es</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird ein Etikett mit dem Schl√ºssel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">service.label</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und den Wert </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entwickeln</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die in der </font><font style="vertical-align: inherit;">Laufzeit erhalten werden kann. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein wichtiger Punkt zu Beginn eines Dienstes ist die √úberpr√ºfung,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ob in Service Discovery eine Dienstinstanz mit solchen Metainformationen vorhanden ist oder nicht, um m√∂gliche Kollisionen zu vermeiden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Routing-Optionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach kann die L√∂sung des Problems auf zwei Optionen reduziert werden:</font></font><br>
<br>
<ol>
<li>API Gateway        .         , ,          , ,  Headers: <b>DestionationService: feature/PRJ-001</b>.     ,       ,           Header        .       ,         ‚Äî - API Gateway.</li>
<li>  API Gateway,        , . ., ,    ,     <b>Zuul 1</b>    endpoint-  <b>/api/users/</b>‚Ä¶       user,      <b>feature/PRJ-001</b>,    <b>Zuul 2</b>    endpoint- <b> /api/users/</b>‚Ä¶       user,      <b>feature/PRJ-002</b>.       ,         N API Gateway  N , . .        , . .   feature ‚Äî ,  ,  ,             ,    ,     ,        .          <b>API Gateway</b>, , . .,  ,   ,     ‚Äî   ,     .</li>
</ol><br>
<img src="https://habrastorage.org/webt/si/ls/xd/silsxdh5v-rwgybittlu4bvbcz0.png"><br>
<br>
<i>   </i><br>
<br>
<h2>       </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Teil der Gateway-API lohnt es sich auch, einen Mechanismus bereitzustellen, mit dem Sie Routing-Regeln zur Laufzeit √§ndern k√∂nnen. Am besten platzieren Sie diese Einstellungen in der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurationszuordnung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In diesem Fall reicht es aus, die neuen Routen neu zu schreiben und entweder die Gateway-API in Kubernetes neu zu starten, um das Routing zu aktualisieren, oder den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Boot Actuator zu verwenden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (vorausgesetzt, die Gateway-API enth√§lt eine entsprechende Abh√§ngigkeit) - rufen Sie den Endpunkt / die Aktualisierung auf, der im Wesentlichen neu gelesen wird Daten von config-map und aktualisiert Routen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wichtiger Punkt ist auch, dass es relativ gesehen eine Referenzinstanz des Dienstes geben sollte (z. B. mit der Bezeichnung " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwickeln")</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(die vom Hauptzweig der Serviceentwicklung gesammelt werden) und eine separate Haupt-Gateway-API, die immer in den Einstellungen angegeben wird, in denen auf diesen Service zugegriffen wird. Im Wesentlichen stellen wir uns eine unabh√§ngige </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Staging-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Umgebung zur Verf√ºgung, die im Rahmen des dynamischen Routings immer betriebsbereit ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel f√ºr einen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurationszuordnungsblock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr die Gateway-API, der Einstellungen f√ºr das Routing enth√§lt (hier nur ein Beispiel f√ºr das Aussehen, f√ºr den ordnungsgem√§√üen Betrieb ist eine entsprechende Bindung in Form von Code auf der Backend-Seite des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API-Gateway-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstes erforderlich </font><b><font style="vertical-align: inherit;">)</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">{<font></font>
  "kind": "ConfigMap",<font></font>
  "apiVersion": "v1",<font></font>
  "metadata": {<font></font>
    ...<font></font>
  },  <font></font>
"data": {<font></font>
    ...        <font></font>
    "rules.meta.user": "develop",<font></font>
    "rules.meta.client": "develop",<font></font>
    "rules.meta.notification": "feature/PRJ-010",<font></font>
    ...    <font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rules.meta</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine Karte mit Routing-Regeln f√ºr Dienste. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer / Kunde / Benachrichtigung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Der Name des Dienstes, unter dem er in Eureka registriert ist. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Develop / Feature / PRJ-010</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Service-Label aus </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.yml des</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entsprechenden Service, auf dessen Grundlage der gew√ºnschte Service unter allen verf√ºgbaren Services mit demselben Namen aus </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Service Discovery ausgew√§hlt wird</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wenn mehr als eine Instanz eines solchen Service vorhanden ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie alles auf dieser Welt sind die Tools und L√∂sungen in der IT nicht perfekt. </font><font style="vertical-align: inherit;">Denken Sie nicht, dass alle Probleme sofort enden, wenn Sie die Architektur √§ndern. </font><font style="vertical-align: inherit;">Nur ein detailliertes Eintauchen in die verwendeten Technologien und Ihre eigenen Erfahrungen geben Ihnen ein reales Bild davon, was passiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieses Material hilft Ihnen bei der L√∂sung Ihres Problems. </font><font style="vertical-align: inherit;">Interessante Aufgaben und verkaufen ohne Fehler!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de489898/index.html">Ein weiterer Artikel √ºber WC</a></li>
<li><a href="../de489900/index.html">PostgreSQL Antipatterns: √Ñndern von Daten unter Umgehung eines Triggers</a></li>
<li><a href="../de489902/index.html">So messen Sie die Effektivit√§t eines Anlageportfolios: 3 praktische Ans√§tze</a></li>
<li><a href="../de489904/index.html">Warum und wie testen wir das Update?</a></li>
<li><a href="../de489906/index.html">Virtuelle Umkleidekabine in OpenCV</a></li>
<li><a href="../de489914/index.html">Clustering in Proxmox VE</a></li>
<li><a href="../de489916/index.html">Protobuf- oder JSON-strukturiertes Front-End-Kommunikationsprotokoll?</a></li>
<li><a href="../de489918/index.html">Wie wir das virtuelle Tankkartenprojekt umgesetzt haben</a></li>
<li><a href="../de489920/index.html">Sites, gehen Sie zu IPv6, zwei</a></li>
<li><a href="../de489924/index.html">Wo beginnt Elasticsearch?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>