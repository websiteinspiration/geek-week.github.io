<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¨ ğŸ‘š ğŸ§˜ğŸ¼ PostgreSQLãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ–¹æ³•ã€‚ã‚¢ãƒ³ãƒ‰ãƒ¬ã‚¤ãƒ»ã‚µãƒ«ãƒ‹ã‚³ãƒ• ğŸ§šğŸ¼ ğŸ ğŸ’ªğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Andrei Salnikovã«ã‚ˆã‚‹2018å¹´ã®ãƒ¬ãƒãƒ¼ãƒˆã€ŒPostgreSQLã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°ã™ã‚‹æ–¹æ³•ã€ã®è§£èª­ã«æ…£ã‚Œã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™
 

ã»ã¨ã‚“ã©ã®å ´åˆã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã¨DBAã¯ã€ç‰¹ã«ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒç¨¼åƒä¸­ã§è² è·ãŒã‹ãªã‚Šé«˜ã„å ´åˆã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆRDBMSï¼‰ã«å¤§ããªæ›´æ–°ã‚’åŠ ãˆã‚‹ã“...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PostgreSQLãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ–¹æ³•ã€‚ã‚¢ãƒ³ãƒ‰ãƒ¬ã‚¤ãƒ»ã‚µãƒ«ãƒ‹ã‚³ãƒ•</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495262/"><p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrei Salnikovã«ã‚ˆã‚‹2018å¹´ã®ãƒ¬ãƒãƒ¼ãƒˆã€ŒPostgreSQLã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°ã™ã‚‹æ–¹æ³•ã€ã®è§£èª­ã«æ…£ã‚Œã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™</font></font></strong></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã»ã¨ã‚“ã©ã®å ´åˆã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã¨DBAã¯ã€ç‰¹ã«ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒç¨¼åƒä¸­ã§è² è·ãŒã‹ãªã‚Šé«˜ã„å ´åˆã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆRDBMSï¼‰ã«å¤§ããªæ›´æ–°ã‚’åŠ ãˆã‚‹ã“ã¨ã‚’æã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®ä¸»ãªç†ç”±ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã§ã‚ã‚Šã€ã“ã®ã‚ˆã†ãªä½œæ¥­ã®è¨ˆç”»ã«ã¯å¸¸ã«æš—ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®Ÿéš›ã«ã¯ã€ã“ã®ç¨®ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ã¯éå¸¸ã«é•·ã„æ™‚é–“ãŒã‹ã‹ã‚Šã€å¤šãã®å ´åˆã€ãã®ã‚ˆã†ãªæ“ä½œã®çµŒé¨“ãŒã»ã¨ã‚“ã©ãªã„ç®¡ç†è€…ã¯ã€æº–å‚™æ®µéšã§å›é¿ã§ããŸã‹ãªã‚Šäº›ç´°ãªã‚¨ãƒ©ãƒ¼ã®ãŸã‚ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Egretã§ã¯ã€ã‚¨ãƒ©ãƒ¼ã®ä½™åœ°ã®ãªã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§PostgreSQLã®ä¸»è¦ãªã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãŸçµŒé¨“ã‚’è“„ç©ã—ã¦ãã¾ã—ãŸã€‚ç§ã®çµŒé¨“ã‚’å…±æœ‰ã—ã€ãƒ—ãƒ­ã‚»ã‚¹ã®æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«ã¤ã„ã¦è©±ã—ã¾ã™ï¼šPostgreSQLã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®æº–å‚™æ–¹æ³•ï¼Ÿæº–å‚™æ®µéšã§ä½•ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰è‡ªä½“ã®ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨ˆç”»ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æˆ»ã•ãšã«ã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ‰‹é †ã‚’æ­£å¸¸ã«å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ä¸­ã®ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’æœ€å°åŒ–ã¾ãŸã¯å›é¿ã™ã‚‹æ–¹æ³•PostgreSQLã‚’æ­£å¸¸ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ãŸå¾Œã€ã©ã®æ‰‹é †ã‚’å®Œäº†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿã¾ãŸã€æœ€ã‚‚ä¸€èˆ¬çš„ãª2ã¤ã®PostgreSQLã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ‰‹é †-pg_upgradeã¨pg_dump / pg_restoreã«ã¤ã„ã¦ã€å„æ–¹æ³•ã®é•·æ‰€ã¨çŸ­æ‰€ã«ã¤ã„ã¦èª¬æ˜ã—ã€ã“ã®æ‰‹é †ã®ã™ã¹ã¦ã®æ®µéšã§ã®ã™ã¹ã¦ã®å…¸å‹çš„ãªå•é¡Œã¨ãã‚Œã‚‰ã‚’å›é¿ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯ã€åˆå¿ƒè€…ã¨PostgreSQLã‚’é•·ã„é–“ä½¿ç”¨ã—ã¦ããŸDBAã®ä¸¡æ–¹ã«ã¨ã£ã¦èˆˆå‘³æ·±ã„ã‚‚ã®ã§ã™ãŒã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’é©åˆ‡ã«è¨ˆç”»ã—ã€ã§ãã‚‹ã ã‘ç°¡å˜ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãçŸ¥ã‚ŠãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/qh/px/xd/qhpxxdul2aseoxu2_ohgojxftpu.png"></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚“ã«ã¡ã¯ï¼</font><font style="vertical-align: inherit;">ç§ã¯Data Egretã§åƒã„ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">PostgreSQLã‚µãƒ¼ãƒãƒ¼ã®ã‚µãƒãƒ¼ãƒˆã¨PostgreSQLã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€å®Ÿéš›ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ›´æ–°ã™ã‚‹äººã¯ã»ã¨ã‚“ã©ã„ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">å½¼ã‚‰ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç«‹ã¡ä¸Šã’ã€ãã®æ™‚ç‚¹ã§ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€ã¾ã ä½œæ¥­ã—ã¦ã„ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ãƒãƒ¼ãƒˆã¯3ã¤ã®éƒ¨åˆ†ã§æ§‹æˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æœ€åˆã¯ä¸€èˆ¬çš„ãªç”¨èªã«åˆ°é”ã™ã‚‹ãŸã‚ã®å…¥é–€çš„ãªã‚‚ã®ã§ã™ã€‚</font><font style="vertical-align: inherit;">2ã¤ç›®ã¯ã€ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«é–¢ã™ã‚‹ã‚‚ã®ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãã—ã¦3ã¤ç›®ã¯ãƒ¡ã‚¸ãƒ£ãƒ¼ã«ã¤ã„ã¦ã§ã™ã€‚</font></font></p><br>
<p><img src="https://habrastorage.org/webt/yb/wk/bv/ybwkbvbiywdppdk19sky8vxd_vk.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ãƒãƒ¼ãƒˆã®ç›®çš„ã¯è³ªå•ã«ç­”ãˆã‚‹ã“ã¨ã§ã™ã€‚</font></font></p><br>
<ul>
<li>  ?   ,  Postgres    .     ,  - .            ,  .       ,    .    .</li>
<li>,       . </li>
<li> ,             ,   .</li>
<li>  ,   : Â«         ?Â».   . </li>
<li>       ,          .     ,     production   .</li>
</ul><br>
<p>     ,         Postgres.</p><br>
<p><img src="https://habrastorage.org/webt/9n/6v/uo/9n6vuovta77udhortpo17qcbhqw.png"></p><br>
<p>    ,   ,    .  10        .   ,  ,    ,   â€“   .</p><br>
<p><img src="https://habrastorage.org/webt/zz/ua/ku/zzuakuky0bgkb0_8pnyuxv56f3q.png"></p><br>
<p>  10-      .     ,  .   â€“    ,   â€“   . </p><br>
<p><img src="https://habrastorage.org/webt/o9/rg/d6/o9rgd6cwxfxj2ysv6rrnskysrt8.png"></p><br>
<p>    ?</p><br>
<p> .   ,    â€“       .      9.6      ,  ,  ,    .    .   . </p><br>
<p> 10-     .   ,      .</p><br>
<p> .    .                ,   . </p><br>
<p>        .             . </p><br>
<p>     â€“  ,     .  6.    .     ,        . . .    9.2.    ,   ,  9.2  .     9.2,     .</p><br>
<p>       :     .</p><br>
<p><img src="https://habrastorage.org/webt/mk/mj/fo/mkmjfozpligyczlzq19b4u7pudw.png"></p><br>
<p>  .   ,         ,       production :</p><br>
<ul>
<li>    release notes.     ? ,     release notes,   release notes    ,      .   ,    .   - .      ,              ,          .  ,         10- ,     -.   ,  ,   .</li>
<li>       ?  .  ,          .     release notes,      . ,      -  .  , Postgres      ,  ,  .         ,       Postgres,   .</li>
<li>    - ,        ,     ,        ,       production .</li>
<li> ,             â€“  ,      .    â€”  ,     ,          ,    .      .</li>
</ul><br>
<p> ,   ,  , .</p><br>
<p><img src="https://habrastorage.org/webt/ft/wd/sx/ftwdsxjongoxcwtzmofeol4flxs.png"></p><br>
<p>    .            .</p><br>
<p>   ,        .         ,      Postgres.     Postgres.</p><br>
<p>  :</p><br>
<ul>
<li>     PostgreSQL.    ,     -  ,   ,  , Postgres   .      .             .         ,   .  Ubuntu, ,       ,  .   start.conf.          .      .</li>
<li>    PostgreSQL  .      ,           ,  common-       .   .</li>
<li> â€“ checkpoint.    checkpoint?      ,        .         ,      ,    ,   .      ,  ,       , , 250 GB,         .         checkpoint,                 Postgres.</li>
<li>  ?    pgbouncer,             ,          .    pgbouncer,  pgbouncer    .  pgbouncerâ€™    â€“    ,      -       .       latency   . . .     ,      pgbouncer,     .     checkpoint,   pgbouncer,                .</li>
<li>   ,      .            .     ,      .</li>
<li> ,     extensions,    -  extensions.    â€“          extensions    .   .       .     .      .     . </li>
<li>    (  ,     release notes)      release notes.         â€“    -  . ,     9.6.1  9.6.6,   ,     release notes  9.6.2 â€“ 9.6.6.      - ,    ,       ,       .</li>
<li>    standby ,   ,          .     ,      14-  ,    2.3     .     .       ,     .    .</li>
</ul><br>
<p>   ,    release notes.</p><br>
<p><img src="https://habrastorage.org/webt/r7/po/fw/r7pofwu2d6pd3sfzov_zbnw-lsq.png"></p><br>
<p>      Postgres.org.    9.6.2.      ,         .</p><br>
<p>    ?        ,                 ,              .           ,                   .         .</p><br>
<p>         .       .  . , , release notes.   .</p><br>
<p><img src="https://habrastorage.org/webt/tp/fm/y4/tpfmy4cemzde9czdxxsr0pljldm.png"></p><br>
<p>    ,      .       . ,  ,     9.6.5.         9.6.1.     ,      .    -   .      ,   â€“    .     â€“   .</p><br>
<p>  ,     . . .    bash- ,         .     alter extension, update     .</p><br>
<p><img src="https://habrastorage.org/webt/r0/r8/ek/r0r8ekgtztzazijacgoii-0qpss.png"></p><br>
<p>   ?</p><br>
<ul>
<li> .     .   ,           ,           . </li>
<li>      . ,        ,        ,   release notes.</li>
<li>      . ,     - ,     .    .   .       . </li>
<li>   , . .        .   ,     checkpoint,         30   . </li>
</ul><br>
<p><img src="https://habrastorage.org/webt/ga/ph/cc/gaphcci6ovprvx85tkdq4ahzvve.png"></p><br>
<p>      â€“   .</p><br>
<p>    .   ,    .       .</p><br>
<ul>
<li>Pg_dump  restore â€“      .       ,      .     -    .</li>
<li>Pg_upgrade â€“    ,   , ,  95 % ,      .      . </li>
<li>     .</li>
</ul><br>
<p>       .</p><br>
<p><img src="https://habrastorage.org/webt/nv/6c/6t/nv6c6tqljcr8ergpes79hmwrjrg.png"></p><br>
<p>   pg_dump      ?</p><br>
<ul>
<li>     .     ,     .   9.5,  ,   10.  Ubuntu   ,  RedHat     â€“   Postgres.  ,        .</li>
<li>      locale,       .</li>
<li>   Postgres,  ,    ,  ,  ,         .</li>
<li>    ,            pg_dumop.       PostgreSQL.     ?   pg_dump    ,      ,   ,           .    ,             ,       .       .    PostgreSQL, . .  ,  .    ,    .</li>
<li>     .     pg_dump,         .         .    ,       .</li>
<li>        .               .</li>
<li>  ,       ,   ,        PostgreSQL.</li>
</ul><br>
<p>   ,   ,      ,  .</p><br>
<p><img src="https://habrastorage.org/webt/yg/wy/_z/ygwy_zlxpezpbldwtlfbzkfb_ce.png"></p><br>
<p>  pg_dump:</p><br>
<ul>
<li>      .   â€“ .      .</li>
<li>  .    .</li>
<li>   .   :   ,   ,   .    ,    .</li>
<li>      ,      ,              .     .</li>
<li>     .     ,      .       .    SSD-,  SSD-  .                ,     ,  .       .</li>
<li>    .    ,              .        ,   . ,   ,  .     ,          ,       .     .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/0_/qe/9o/0_qe9onjahbwmv3gajs4i5gdbus.png"></p><br>
<p>     ,  pg_upgrade.</p><br>
<ul>
<li>Pg_upgrade        .       , . . ,    .   .</li>
<li>        .       , ,     .</li>
<li>     PostgreSQL.         -,        .</li>
<li>    .      .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/j_/wo/jc/j_wojcl1m25krfsyc4qkq_fjmdo.png"></p><br>
<p> ,   pg_upgrade.        : ,         ,   .</p><br>
<p>,    pg_upgrade,       ,             ,            .    ,     ,         .      .</p><br>
<p>   ,     â€“ pg_upgrade  dump  restore ,   pg_dump, restore     ,       ,      ,      .   .</p><br>
<p>       .      ,       ,           8.4.  Postgres        .</p><br>
<p>    ,            (, 9.0  10)      -.       ,       ,       .      .      ,     .</p><br>
<p><img src="https://habrastorage.org/webt/7l/9t/6a/7l9t6aqjizxpby0hca5onk0d4ci.png"></p><br>
<p>    ,         production. . .      ,    â€“      .</p><br>
<ul>
<li>     PostgreSQL.</li>
<li>     locace.   .</li>
<li> pg_upgrade.    Â«checkÂ». Check   ,      .   ,     -    ,      ,   , ,                .       ,     .      ,         .</li>
<li>Pg_dumpall â€” schema-only.     check   .       pg_dumpall â€“ schema-only,     .     ,       .    ,    ,  check      ,  dump .</li>
<li>   extensions   .    â€“  PostGIS,   PostGIS    Postgres.  extension      Postgres,    Postgres.   changelog   â€“      ,  pg_upgrade ,         .    dump restore .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/3g/4x/f7/3g4xf7lyqcnvv3hi-bs0fra4wj4.png"></p><br>
<p>  ,  ,   ,  .</p><br>
<ul>
<li><p>    locale,    pg_dumpall only, restore.</p><br>
</li>
<li><p>   .      ,  pgbouncer       , . .    ,   .</p><br>
</li>
<li><p>   checkpoints,          ,     .</p><br>
</li>
<li><p>     pg_upgrade.     ,      .               .      45 .       ,    45 ,    .        15 ,     .         .</p><br>
<p><img src="https://habrastorage.org/webt/et/sy/er/etsyeryqtvdimdjivvq0jx_lrjw.png"></p><br>
</li>
<li><p>   ,       .    hard links.        .</p><br>
<p><img src="https://habrastorage.org/webt/cs/eo/sc/cseoscbeymrk5pjlzwbj9grk_rm.png"></p><br>
</li>
<li><p>    PostgreSQL.        .          PostgreSQL?     .  , pg_upgrade    .</p><br>
</li>
<li><p>     .</p><br>
</li>
<li><p>        .            10 .      ,    .</p><br>
</li>
</ul><br>
<p>     :</p><br>
<ul>
<li><p> pg_upgrade     .    ,          :   ,  10     .</p><br>
</li>
<li><p>         ,       ,   .</p><br>
</li>
<li><p>   9.5     .    ,                .</p><br>
<p><img src="https://habrastorage.org/webt/gi/dm/uk/gidmuk_tnbcrxet3qoghxfvpkd4.png"></p><br>
</li>
<li><p>    .    .        ,    ,     .   ,    vacuumdb    1, 10 .         ,      .  -      .  - .    ,     ,     .</p><br>
</li>
<li><p>    .         ,     .      - .     ,     ,  .         ,  ,         .</p><br>
</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/kr/dh/y9/krdhy9toj4rsxvmlbokhhjaahno.png"></p><br>
<p>     .</p><br>
<p><img src="https://habrastorage.org/webt/o0/-v/_-/o0-v_-tammgsfm23g7spto9w080.png"></p><br>
<ul>
<li>Pg_upgrade   extensions.    ,   .</li>
<li>   release notes  .</li>
<li> ,   ,      extensions      â€“ alter extension EXTENSION_NAME update.  .    pg_stat_statements,   -     .    pg_upgrade,         pg_stat_statements.      .     .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/ri/50/6n/ri506n_tl93nkyy_m1-9gtrdtt4.png"></p><br>
<p>    â€“   ?   :</p><br>
<ul>
<li>  -  - .</li>
<li>  ,     ,    ,    ,  ,  .      .  ,   ,           .</li>
<li>   ?     Postgres.       .     . ,  , , 10  .</li>
<li>          PostgreSQL.</li>
<li> pg_basebackup        .      .</li>
<li>     PostgreSQL.</li>
<li>   ,       rsync,       .   , ,  ,            .   rsync   ,   .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/fe/s_/_i/fes__isx8gdxhkejzomqabxytxc.png"></p><br>
<p>    .   :</p><br>
<ul>
<li>-,        PostgreSQL.</li>
<li>    .   .</li>
</ul><br>
<p>  9.4    .     .   ,    10   11        .</p><br>
<p>   ,   .  Slony-l, Londiste, Bucardo  . .   .</p><br>
<p><img src="https://habrastorage.org/webt/uy/yn/rd/uyynrdnjuv8_go1ttq3rsmsn2ns.png"></p><br>
<p>       ?</p><br>
<ul>
<li>    PostgreSQL.</li>
<li>-         Postgres    Postgres.</li>
<li>  ,  ,        .       .</li>
<li> ,        .    .    ,         Postgres.   ,     , . .     .    ,    .</li>
<li>      Postgres, ,     .</li>
<li>         Postgres,    . ,  ,    .     -  .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/8g/tv/of/8gtvofu-acouuounr5zfnjozen4.png"></p><br>
<p>     ?</p><br>
<ul>
<li>        ,      .  -  .</li>
<li> ,    .     . . . ,    .</li>
<li>     sequences,       -.</li>
<li>    DDL,    .   DDL  ,  ,  .          ,  .</li>
<li>     ,         ,  .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/2a/db/rv/2adbrv0193cxs8sglbod0f8jfnu.png"></p><br>
<p>   ,            .     pg_upgrade      ,      .</p><br>
<p>   ?  ,     3 TB,       2 SSD RAID  3 TB.    .         .</p><br>
<p>         .    .</p><br>
<p> ,    ,      99  - 9-  .    15 .       15    .  .        - .</p><br>
<p><img src="https://habrastorage.org/webt/bq/sl/ie/bqsliego7mt3nyx__tfzyrrlwb8.png"></p><br>
<p>     ,       pg_upgrade.      .         .</p><br>
<p>    .</p><br>
<p></p><br>
<p><em> !    pgbouncer     ,       , , ,    ,   .      ?</em></p><br>
<p>       ,        SSD  .         SSD   , . .     .       . , , ,  ,    .  ,     ,      .    ,      Postgres.      ,   .</p><br>
<p><em>   pg_worm  pg_hibernate,    ?</em></p><br>
<p> ,       ,      .</p><br>
<p><em>  !        pg_upgrade?</em></p><br>
<p> , .        ,   .       ,    .    ,     ,  -  ,    .        ,     ,    .        ,    .</p><br>
<p><em>  rsync -?</em></p><br>
<p>  rsync? Rsync     .  ,       ,   , , .    ?      pg_upgrate   .  ,  .     â€“ pg_start_backup.     rsync    .     -  ,    rsync   ,   .   ,          , ,  tablespace  HDD,  rsync  ,      .     â€“  ,  .    ,         .  â€“  pg_basebackup.</p><br>
<p><em>  !   ,     â€¦</em></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«é©ç”¨ã•ã‚Œã¾ã™ã€‚</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja495248/index.html">è‡ªå·±åˆ†é›¢ã¨æ‰‹æ´—ã„ã®å½¹å‰²</a></li>
<li><a href="../ja495250/index.html">ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã«ã¯æœªæ¥ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja495254/index.html">æ¨™çš„å‹ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã€è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ã€‚ã•ã¾ã–ã¾ãªæ–¹æ³•ã®é•·æ‰€ã¨çŸ­æ‰€</a></li>
<li><a href="../ja495256/index.html">ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã®ãƒãƒ¼ãƒˆã¨æš—å·åŒ–ã«ã¤ã„ã¦</a></li>
<li><a href="../ja495258/index.html">ã‚ºãƒ¼ãƒ ãŒã‚³ãƒ­ãƒŠã‚¦ã‚¤ãƒ«ã‚¹ã®æ™‚ä»£ã§æœ€ã‚‚é‡è¦ãªä¼æ¥­ã«ãªã£ãŸçµŒç·¯</a></li>
<li><a href="../ja495266/index.html">ãƒ«ãƒã‚µãƒ³ã‚¹eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã€‚2020å¹´ã«é éš”æ•™è‚²ã®ã™ã¹ã¦ã®åˆ©ç‚¹ãŒç¤ºã•ã‚Œã‚‹ç†ç”±</a></li>
<li><a href="../ja495268/index.html">UI / UXã‚±ãƒ¼ã‚¹ï¼šç©ºæ¸¯é§è»Šå ´ã®è‡ªå‹•åŒ–</a></li>
<li><a href="../ja495272/index.html">SNESã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€å®Œå…¨ãªå®Œæˆã‹ã‚‰ã‚ãšã‹æ•°ãƒ”ã‚¯ã‚»ãƒ«é›¢ã‚Œã¦ã„ã¾ã™ã€‚</a></li>
<li><a href="../ja495274/index.html">ãƒ«ãƒ¼ãƒˆãƒªãƒ¼ã‚¯ã‚’ä¿®æ­£ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja495276/index.html">ãã—ã¦ã€Uptime Instituteã§ã®é‹ç”¨ã®æŒç¶šå¯èƒ½æ€§ç›£æŸ»ã«ã©ã®ã‚ˆã†ã«åˆæ ¼ã—ãŸã‹ã‚’ç¤ºã—ã¾ã™ã€‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>