<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏫 ✋🏼 🍘 Puis-je écrire des scripts en C ++? 🍄 👐🏽 ❣️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Récemment, j'ai dû plonger à nouveau dans le monde merveilleux de la programmation de scripts Linux. En principe, la question n'est pas très délicate,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Puis-je écrire des scripts en C ++?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488962/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-7/xg/my/-7xgmyrtvd5lv6l5kws9xiaulvg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Récemment, j'ai dû plonger à nouveau dans le monde merveilleux de la programmation de scripts Linux. En principe, la question n'est pas très délicate, mais comme je rencontre souvent de telles tâches, je les étudie à chaque fois. Je sais avec certitude que demain j'oublierai beaucoup et dans un mois je vais à nouveau google comment faire ceci ou cela. Le problème se révèle toujours que souvent vous n’écrivez pas à nouveau le script, mais vous modifiez celui déjà écrit par quelqu'un. Et ce n'est peut-être pas bash, mais sh ou autre chose ... Il y a des différences dans la syntaxe, ce qui fonctionne dans sh devrait fonctionner dans bash, mais pas toujours l'inverse. Et s'il y a du tiret ou de la cendre? Je ne sais pas ... Il y a encore des différences dans ces langages de script, et ils prêtent à confusion. Et bien sûr, pour moi personnellement, la cerise sur le gâteau lorsque le script appelle un sed ou un awk et qu'il y a de tels paramètres sur la ligne de commande que vous les regardez et vous vous demandez.Il est clair que tout cela dépend des qualifications du programmeur, mais tout ne rentre pas dans ma tête. Et maintenant ma patience est partie et je pensais qu'à partir de maintenant je veux essayer d'écrire des scripts en c ++ ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je comprends que pour un vrai administrateur système, ma pensée peut sembler séditieuse. </font><font style="vertical-align: inherit;">Mais pourquoi pas?</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'idée est donc très simple. </font><font style="vertical-align: inherit;">Je veux écrire des scripts c ++ de la même manière que les scripts réguliers sont écrits, c'est-à-dire que la première ligne du script devrait contenir shebang et une indication du chemin vers "l'interpréteur":</font></font><br>
<br>
<pre><code class="plaintext hljs">#!/bin/c++</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes suivantes du script ne seront qu'un programme c ++ normal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je dois préparer "l'interpréteur" du script c ++. </font><font style="vertical-align: inherit;">Vous pouvez l'écrire sur n'importe quoi, au moins sur bash (c'est la dernière fois, mais pas exactement). </font><font style="vertical-align: inherit;">Bien sûr, ce ne sera pas un interprète, mais un compilateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est ce que j'ai fait:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash
</span><font></font>
msg_file=/dev/null<font></font>
<span class="hljs-comment">#msg_file=/dev/stdout</span><font></font>
<font></font>
tmp_path=<span class="hljs-variable">$HOME</span><span class="hljs-string">"/.cache/c++/"</span>
mkdir -p <span class="hljs-variable">$tmp_path</span>
tmp_file=<span class="hljs-variable">$1</span><span class="hljs-string">".c++"</span>
exe_file=<span class="hljs-variable">$1</span><span class="hljs-string">".bin"</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> <span class="hljs-variable">$1</span> -nt  <span class="hljs-variable">$tmp_path</span><span class="hljs-variable">$exe_file</span>; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Need to recompile.."</span> &gt; <span class="hljs-variable">$msg_file</span>
    tail -n +2 <span class="hljs-variable">$1</span> &gt; <span class="hljs-variable">$tmp_path</span><span class="hljs-variable">$tmp_file</span>
    <span class="hljs-built_in">eval</span> <span class="hljs-string">"g++ -o <span class="hljs-variable">$tmp_path</span><span class="hljs-variable">$exe_file</span> <span class="hljs-variable">$tmp_path</span><span class="hljs-variable">$tmp_file</span> &gt; /dev/null 2&gt;&amp;1"</span>
    <span class="hljs-keyword">if</span> [ $? -eq 0 ]
    <span class="hljs-keyword">then</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Compiled ok"</span> &gt; <span class="hljs-variable">$msg_file</span>
    <span class="hljs-keyword">else</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Compile error"</span> &gt; <span class="hljs-variable">$msg_file</span>
	<span class="hljs-built_in">exit</span> 255
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-built_in">eval</span> <span class="hljs-string">"<span class="hljs-variable">$tmp_path</span><span class="hljs-variable">$exe_file</span> <span class="hljs-variable">$@1</span>"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce script fait tout ce dont vous avez besoin. En tant que dossier temporaire, j'ai choisi le dossier ~ / .cache / c ++. Le script d'origine sera copié dans ce dossier, mais sans la première ligne avec shebang. Cela se fait par la commande tail. Le nom du nouveau fichier sera comme le script d'origine, mais avec l'extension c ++. Le binaire avec l'extension .bin sera collecté dans le même dossier. Mais d'abord, bien sûr, une vérification «si test» est effectuée au moment de la création du binaire. La compilation ne se produit que si le binaire existant est obsolète dans le temps par rapport au «script» d'origine. Le binaire est lancé avec la commande eval et tous les paramètres initiaux lui sont passés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce fichier c ++ doit être copié dans le dossier / bin et rendu exécutable (chmod a + x). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais essayer d'écrire mon premier "script c ++":</font></font><br>
<br>
<pre><code class="cpp hljs">#!/bin/c++<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">( <span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[] )</span>
</span>{
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"hello world!\n"</span>;
    <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;argc; i++)<font></font>
    {<font></font>
	<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">"Param"</span> &lt;&lt; i &lt;&lt;  <span class="hljs-string">" is "</span> &lt;&lt; argv[i] &lt;&lt; <span class="hljs-string">"\n"</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">60</span>+argc;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce programme imprime simplement une liste de paramètres d'entrée et renvoie leur nombre + 60. Je </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lance mon "script": </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1y/0c/ks/1y0cksrwf2niluhqf-adbf2cfwy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ça marche !!! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous faites une erreur dans le code c ++, le programme ne démarrera pas, car il ne compilera pas, mais écho $? reviendra 255. Mais c'était ce qui était prévu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation de c ++ offre d'énormes opportunités. Tout d'abord, la syntaxe familière. Deuxièmement, les classes standard comme std :: vector, std :: map ou std :: string et d'autres sont des choses irremplaçables. La même ligne - tout ce que vous voulez en faire, regardez dans la ligne, divisez-la en sous-chaînes, déconnectez-vous et conquérez, obtenez des tableaux. Et je n'ai besoin ni de sed ni d'awk. Troisièmement, le débogueur - Dieu! quelle bénédiction! J'ai un débogueur gdb pour le script! De plus, vous pouvez utiliser std :: filesystem (si le compilateur le permet). Vous pouvez continuer ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, il m'arrive souvent de le faire en premier, puis je pense: "Et si quelqu'un l'a déjà fait?" </font><font style="vertical-align: inherit;">Et en fait, je ne suis pas le premier à avoir l'idée de faire de même. </font><font style="vertical-align: inherit;">Voici un exemple: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/dimgel/cpp-linux-scripts l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> idée est la même, l'implémentation est différente. </font><font style="vertical-align: inherit;">Ensuite, il s'est avéré qu'il existe d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autres implémentations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En général, j'ai vécu une légère déception dans ma propre non-exclusivité. </font><font style="vertical-align: inherit;">Cependant, j'ai cherché Habr - je n'en ai pas trouvé un semblable. </font><font style="vertical-align: inherit;">Peut-être que quelqu'un semble au moins curieux?</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr488950/index.html">Temps dans une machine cellulaire</a></li>
<li><a href="../fr488952/index.html">Analyse des sentiments d'expression à l'aide de réseaux de neurones</a></li>
<li><a href="../fr488956/index.html">Organisation de la documentation et de la traduction, par exemple, iondv. cadre</a></li>
<li><a href="../fr488958/index.html">Transcription de mon entretien avec l'auteur Ruby</a></li>
<li><a href="../fr488960/index.html">Programmation, immunité et armée</a></li>
<li><a href="../fr488964/index.html">Tâches urgentes. Que le Sauveur vienne</a></li>
<li><a href="../fr488982/index.html">Présentation de la sécurité du logiciel du processeur S905X (démarrage sécurisé)</a></li>
<li><a href="../fr488990/index.html">Vue d'ensemble du masque complet d'UNIX 5100, des filtres pour celui-ci, comparaison avec les modèles UNIX 5000, 6100 et le masque PPM-88</a></li>
<li><a href="../fr488994/index.html">DDR5? Oui, nous avons à peine rencontré DDR4</a></li>
<li><a href="../fr488998/index.html">Pourquoi les exigences de l'IA ne peuvent qu'empirer les choses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>