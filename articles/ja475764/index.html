<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏻 🤸🏽 🤘 手続き型建物生成のためのマルコフ連鎖 🏦 🌏 🍝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="注：このプロジェクトの完全なソースコードは[ こちら ]にあります。これはより大きなプロジェクトの一部であるため、この記事のリリース時のコミットまたはファイル/source/helpers/arraymath.hも確認することをお勧めします/source/world/blueprint.cpp。
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>手続き型建物生成のためのマルコフ連鎖</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475764/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/152/06b/acc/15206bacc91b6635a0f286fa21998363.gif" alt="画像"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：このプロジェクトの完全なソースコードは[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]にあります。これはより大きなプロジェクトの一部であるため、この記事のリリース時のコミットまたはファイル</font></font><code>/source/helpers/arraymath.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も確認</font><font style="vertical-align: inherit;">することをお勧め</font><font style="vertical-align: inherit;">します</font></font><code>/source/world/blueprint.cpp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、マルコフ連鎖を使用する原理と、3Dの建物やその他のシステムの手続き型生成のための統計について詳しく説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムの数学的な基礎を説明し、この概念を他の状況、たとえば2Dダンジョンを生成するために適用できるように、できるだけ一般的な説明にするようにします。説明は画像とソースコードを伴います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法は、特定の要件を満たすシステムを手続き的に生成するための一般化された方法です。このため、この手法があなたの場合に役立つかどうかを理解できるように、少なくとも最初のセクションの最後まで読むことをお勧めします。以下では、必要な要件について説明します。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボクセルエンジン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で使用される</font><font style="vertical-align: inherit;">ため、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクボット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は建物を構築し、次に都市を構築</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">する</font></a><font style="vertical-align: inherit;">ことができます。</font><font style="vertical-align: inherit;">記事の最後に例があります！</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="http://weigert.vsos.ethz.ch/wp-content/uploads/2019/10/buildings.mp4" type="video/mp4"></video></div></div></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果のいくつかの例。</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基礎</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフ連鎖</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルコフチェーンは、システムが移動する一連の状態であり、時間の遷移によって記述されます。</font><font style="vertical-align: inherit;">状態間の遷移は確率的です。つまり、システムの特性である確率によって記述されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムは、可能なすべてのシステム構成のスペースである状態スペースによって定義されます。</font><font style="vertical-align: inherit;">システムが正しく記述されている場合、状態間の遷移を離散ステップとして記述することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムの1つの状態から、いくつかの可能な個別の遷移がしばしば存在し、そのそれぞれがシステムの異なる状態につながることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態iから状態jへの遷移の確率は次のようになります。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.969ex" height="2.634ex" viewBox="0 -755.5 1278.5 1134.2" role="img" focusable="false" style="vertical-align: -0.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">P_{ij}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルコフ過程は、転送された確率を利用してこの状態空間を研究する過程です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なことは、マルコフプロセスが「メモリを持たない」ことです。</font><font style="vertical-align: inherit;">これは、現在の状態から新しい状態に遷移する確率が現在の状態にのみ依存し、以前にアクセスした他の条件には依存しないことを意味します。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.417ex" height="2.759ex" viewBox="0 -809.3 5346.2 1188" role="img" focusable="false" style="vertical-align: -0.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="345" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-3D" x="1556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-50" x="2612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="3364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="3753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-2C" x="4099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="4544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="4956" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">P_{ij} = P(i, j)</script></p><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：テキスト生成</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムは一連のビットです。</font><font style="vertical-align: inherit;">状態空間はすべて可能なビットのシーケンスです。</font><font style="vertical-align: inherit;">離散遷移は、1ビットを0から1または1から0に変更します。システムにnビットがある場合、各状態から新しい状態への可能な遷移がnあります。</font><font style="vertical-align: inherit;">マルコフプロセスは、特定の確率を使用してシーケンス内のビットの値を変更することによる状態空間の研究で構成されます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：天気予報</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムは、現在の気象条件です。</font><font style="vertical-align: inherit;">状態空間は、天候が起こりうるすべての可能な状態です（たとえば、「雨」、「曇り」、「晴れ」など）。</font><font style="vertical-align: inherit;">遷移は、任意の状態から、遷移の確率を設定できる別の状態に切り替わります（たとえば、「今日の天気が晴れの場合、明日の天気に関係なく、明日は雨が降る確率はどれくらいですか？」）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルコフ連鎖のモンテカルロ法</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態間の遷移は確率によって決定されるため、「安定」状態が任意の状態になる確率（または時間が無限大になる場合は、特定の状態になる平均時間）を設定することもできます。これは州の内部分布です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、マルコフ連鎖のモンテカルロアルゴリズム（マルコフチェーンモンテカルロ、MCMC）は、状態空間からサンプルを取得するための手法です。サンプリング（サンプリング）とは、内部分布を考慮して、選択の確率に基づいて状態を選択することを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らは、システムが存在する確率は、システムが置かれている現在の状態の「推定値」を与える特定のコスト関数に*比例すると言います。</font><font style="vertical-align: inherit;">コストが低い場合、この状態になる確率は高く、この比率は単調であると考えられています。</font><font style="vertical-align: inherit;">コスト関数は次のように定義されます。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.376ex" height="2.634ex" viewBox="0 -809.3 1884 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="1494" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">R(i)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：「比例」という言葉が正しく使用されているかどうかはわかりません。比率は必ずしも線形ではないためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、状態分布のサンプルは、低コスト（または適切な「見積もり」）の構成を高い確率で返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常に大きな状態空間（無限である可能性がありますが、「無限大」である）でも、システムの複雑さに関係なく、MCMCアルゴリズムは、収束に十分な時間を与えると、低コストのソリューションを見つけます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような状態空間研究のパフォーマンスは、確率的最適化の標準的な手法であり、機械学習などの分野で多くの用途があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ギブス分布</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：このセクションが明確でない場合は、スキップしてかまいません。システムの実装を引き続き利用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考えられる状態のコストを決定した後、この状態の可能性をどのように決定しますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解決策：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ギブス分布</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、特定の制約セットの最大エントロピーの分布です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本質的に、これは、システムの確率に多くの制約を設定した場合、ギブス分布は、分布の形状に関する「最小量の仮定」を作成することを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：ギブス分布は、制約の変動に対する感度が最も低い分布でもあります（カルバックライブラーダイバージェンスメトリックによる）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態の分布に課す唯一の制限はコスト関数であるため、ギブス分布でそれを使用して状態間の遷移の確率を計算します。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2212;</mo><mfrac><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mi>T</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mfrac><mn>1</mn><msub><mi>Z</mi><mi>i</mi></msub></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.239ex" height="5.759ex" viewBox="0 -1562.8 13450.2 2479.7" role="img" focusable="false" style="vertical-align: -2.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="345" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-3D" x="1556" y="0"></use><g transform="translate(2612,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-65"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-78" x="444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-70" x="973" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="4142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-2212" x="4531" y="0"></use><g transform="translate(5310,0)"><g transform="translate(120,0)"><rect stroke="none" width="5177" height="60" x="0" y="220"></rect><g transform="translate(60,725)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="1561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-2212" x="2173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-52" x="3173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="3933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="4322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="4668" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-54" x="2236" y="-686"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="10727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-2217" x="11339" y="0"></use><g transform="translate(11840,0)"><g transform="translate(342,0)"><rect stroke="none" width="1147" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-31" x="323" y="676"></use><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-5A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="966" y="-213"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mfrac><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo>−</mo><mi>R</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mi>T</mi></mfrac><mo stretchy="false">)</mo><mo>∗</mo><mfrac><mn>1</mn><msub><mi>Z</mi><mi>i</mi></msub></mfrac></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">P_{ij} = \exp(-\frac{R(j)-R(i)}{T})*\frac{1}{Z_i}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、Zは状態iからの遷移のセットのパーティション関数です。</font><font style="vertical-align: inherit;">これは正規化係数であり、任意の状態からの遷移確率の合計が1になるようにします。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>j</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.619ex" height="5.634ex" viewBox="0 -1024.6 5863.8 2425.9" role="img" focusable="false" style="vertical-align: -3.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-5A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="966" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-3D" x="1305" y="0"></use><g transform="translate(2361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="815" y="-1536"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-28" x="3806" y="0"></use><g transform="translate(4195,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMATHI-6A" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/475764/&amp;usg=ALkJrhi6z3oU1a6ZOX9JLQS5A6BRW-4v9w#MJMAIN-29" x="5474" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">Z_i = \sum_j(P_{ij})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の状態が同じ状態になると決定した場合、相対コストはゼロになります。つまり、正規化後の確率は非ゼロになります（インジケーター付きの分布の形状により）。つまり、多くの遷移では、変化しない状態の確率を含める必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ギブス分布が「計算温度」Tによってパラメーター化されていることも注目に値します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態空間の研究で確率を使用する主な利点の1つは、システムがより高価な状態への遷移を実行できることです（遷移確率がゼロでないため）。貪欲でない「最適化方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
温度が無限大になる傾向があるため、状態からのすべての遷移の確率のセットが正規化されると、それらのコストが大きいにもかかわらず、確率が等しくなる（またはギブス分布が正規分布に近づく）ように、個々の遷移の確率は1になる傾向があることに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計算温度がゼロに近づくと、コストが低い遷移が発生する可能性が高くなります。つまり、優先遷移の確率が高くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
状態空間の研究・最適化を行う場合、徐々に温度を下げていきます。このプロセスは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「シミュレーテッドアニーリング」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます。このおかげで、最初は極小値から簡単に抜け出すことができ、最終的には最適なソリューションを選択できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
温度が十分に低い場合、遷移がない確率を除いて、すべての確率がゼロになる傾向があります！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、遷移が存在しない場合にのみコストの差がゼロになるためです。つまり、同じ状態であることは温度に依存しません。 T = 0での指数関数の形状により、これはゼロ以外の値を持つ唯一の確率であることがわかります。つまり、正規化の後、それは1に変わります。その結果、システムは安定したポイントに収束し、それ以上の冷却は必要なくなります。これは、ギブス分布を使用した確率生成の積分特性です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムの収束プロセスは、冷却速度を変更することで調整できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
冷却が遅い場合、結果として、通常、ある程度のコストの低いソリューションになりますが、収束のステップが増えるという犠牲が伴います。冷却が速いと、初期段階のシステムがより大きなコストでサブリージョンの罠に陥る可能性が高くなります。つまり、「最適ではない」結果が得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、マルコフプロセスはランダムな結果を生成するだけでなく、「良い」結果を生成しようとし、高い確率で成功します！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
任意のコスト関数の定義により、固有の最適値が存在する必要はありません。</font><font style="vertical-align: inherit;">確率的最適化のこの方法では、コスト関数を最小化しようとして、最適に近づくだけが生成されます。サンプリングにより、毎回異なる結果が生成されます（乱数ジェネレーターのシードが異なる場合）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サンプリングプロセス自体は、遷移の離散セットの質量分布関数に対して逆変換法を使用して実行できます。</font><font style="vertical-align: inherit;">後で、これがどのように行われるかを示します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手続き型生成</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法は、手続き型生成にどのように役立ちますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のシステムでは、特に複雑なシステムの場合に、良い結果を生成する単純なアルゴリズムを定義することがしばしば困難です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
任意の生成ルールを設定することは難しいだけでなく、想像力と境界ケースの処理によってのみ制限されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムが特定の要件を満たす場合、MCMCを使用すると、アルゴリズムやルールの選択について心配する必要がなくなります。</font><font style="vertical-align: inherit;">代わりに、可能な結果を​​生成する方法を定義し、その「評価」に基づいて意識的に適切な結果を選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の要件が提示されます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムは、離散（場合によっては無限）状態の構成になっている可能性があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態間の離散遷移を定義できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムの現在の状態を推定するコスト関数を設定できます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下では、この方法を適用できる他の例をいくつか紹介します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">疑似コード</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この実装では、次のことを実現したいと考えています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムステータスを設定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての可能な遷移を次の状態に設定します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在の状態のコストを計算します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての可能な次の状態（またはそれらのサブセット）のコストを計算します。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ギブス分布を使用して、遷移の確率を計算します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確率を使用した遷移のサンプル（サンプル）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプル遷移を実行します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算温度を下げます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">満足のいく結果が得られるまで手順を繰り返します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
擬似コードの形式では、MCMCアルゴリズムは次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// MCMC   </span><font></font>
<font></font>
T = <span class="hljs-number">200</span>; <span class="hljs-comment">//    </span><font></font>
State s = initialState();<font></font>
Transitions t[n] = {...} <span class="hljs-comment">//n  </span>
thresh = <span class="hljs-number">0.01</span>; <span class="hljs-comment">//  ( )</span><font></font>
<font></font>
<span class="hljs-comment">// ,     </span>
<span class="hljs-keyword">while</span>(T &gt; thresh){<font></font>
<font></font>
  <span class="hljs-comment">//   </span><font></font>
  curcost = costfunc(s);<font></font>
  newcost[n] = {<span class="hljs-number">0</span>};     <span class="hljs-comment">// newcost   0</span>
  probability[n] = {<span class="hljs-number">0</span>}; <span class="hljs-comment">//     0</span><font></font>
<font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; n; i++){<font></font>
    newcost[i] = costfunc(doTransition(s, t[i]));<font></font>
    probability[i] = <span class="hljs-built_in">exp</span>(-(newcost[i] - curcost)/T);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">// </span><font></font>
  probability /= sum(probability);<font></font>
<font></font>
  <span class="hljs-comment">// </span><font></font>
  sampled = sample_transition(t, probability);<font></font>
<font></font>
  <span class="hljs-comment">// </span><font></font>
  s = doTransition(s, sampled);<font></font>
<font></font>
  <span class="hljs-comment">// </span>
  T *= <span class="hljs-number">0.975</span>;<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3D建物の生成</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態空間と遷移</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
建物を3Dで生成するために、境界ボックスで指定された体積で多くの部屋を生成します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Volume</span>{</span>
  <span class="hljs-comment">//  </span><font></font>
  glm::vec3 a;<font></font>
  glm::vec3 b;<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">translate</span><span class="hljs-params">(glm::vec3 shift)</span></span>;
  <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getVol</span><span class="hljs-params">()</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Volume::getVol</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>((b.x-a.x)*(b.y-a.y)*(b.z-a.z));<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Volume::translate</span><span class="hljs-params">(glm::vec3 shift)</span></span>{<font></font>
  a += shift;<font></font>
  b += shift;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n個の部屋を生成すると、システムの状態は3D空間の境界ボックスの構成になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのボリュームの可能な構成は無限ですが、数え切れないほどあることに注意してください（無限の時間でリストされる可能性があります）！</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//  (  !)</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;Volume&gt; rooms;<font></font>
<font></font>
<span class="hljs-comment">// N </span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++){
  <span class="hljs-comment">// </span><font></font>
  Volume x;<font></font>
  x.a = glm::vec3(<span class="hljs-number">0</span>);<font></font>
  x.b = glm::vec3(rand()%<span class="hljs-number">4</span>+<span class="hljs-number">5</span>); <span class="hljs-comment">//  </span><font></font>
<font></font>
  <span class="hljs-comment">//  .</span><font></font>
  rooms.push_back(x);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの可能な遷移は、遷移の欠如を含め、6つの空間方向の1つで部屋が1ステップ移動することです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//...  </span><font></font>
<font></font>
<span class="hljs-comment">//  </span>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;glm::vec3, 7&gt; moves = {<font></font>
    glm::vec3( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),  <span class="hljs-comment">//   !</span>
    glm::vec3( <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),<font></font>
    glm::vec3(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),<font></font>
    glm::vec3( <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>),<font></font>
    glm::vec3( <span class="hljs-number">0</span>,<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>),<font></font>
    glm::vec3( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>),<font></font>
    glm::vec3( <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<span class="hljs-number">-1</span>),<font></font>
  };<font></font>
<font></font>
<span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：システムを現在の状態に維持できるようにすることが重要です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コスト関数</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3D空間のボリュームが「磁石」のように動作することを望みました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらのボリュームが交差する場合、これは悪いことです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らの表面が接触している場合、これは良いことです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らがまったく触れなければ、これは悪いことです。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らが床に触れれば、それは良いことです。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3D空間の2つの直方体の場合、境界ボックスを簡単に定義できます。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">Volume <span class="hljs-title">boundingBox</span><span class="hljs-params">(Volume v1, Volume v2)</span></span>{
  <span class="hljs-comment">//  </span><font></font>
  Volume bb;<font></font>
<font></font>
  <span class="hljs-comment">//  </span><font></font>
  bb.a.x = (v1.a.x &lt; v2.a.x)?v1.a.x:v2.a.x;<font></font>
  bb.a.y = (v1.a.y &lt; v2.a.y)?v1.a.y:v2.a.y;<font></font>
  bb.a.z = (v1.a.z &lt; v2.a.z)?v1.a.z:v2.a.z;<font></font>
<font></font>
  <span class="hljs-comment">//  </span><font></font>
  bb.b.x = (v1.b.x &gt; v2.b.x)?v1.b.x:v2.b.x;<font></font>
  bb.b.y = (v1.b.y &gt; v2.b.y)?v1.b.y:v2.b.y;<font></font>
  bb.b.z = (v1.b.z &gt; v2.b.z)?v1.b.z:v2.b.z;<font></font>
<font></font>
  <span class="hljs-keyword">return</span> bb;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボリュームのバウンディングボックスを使用して、2つのボリュームの交差に関する情報を提供する1つの3Dベクトルを計算できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つの側面に沿った平行六面体の長さが、この側面に沿った2つのボリュームの長さの合計よりも大きい場合、この側面からは接触しません。</font><font style="vertical-align: inherit;">それらが等しい場合、サーフェスは接触し、それ以下の場合、ボリュームは交差します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    3 </span>
<span class="hljs-function">glm::vec3 <span class="hljs-title">overlapVolumes</span><span class="hljs-params">(Volume v1, Volume v2)</span></span>{
  <span class="hljs-comment">//     </span><font></font>
  Volume bb = boundingBox(v1, v2);<font></font>
<font></font>
  <span class="hljs-comment">// </span>
  glm::vec3 ext1 = glm::<span class="hljs-built_in">abs</span>(v1.b - v1.a);  <span class="hljs-comment">// v1  3 </span>
  glm::vec3 ext2 = glm::<span class="hljs-built_in">abs</span>(v2.b - v2.a);  <span class="hljs-comment">// v2  3 </span>
  glm::vec3 extbb = glm::<span class="hljs-built_in">abs</span>(bb.b - bb.a); <span class="hljs-comment">//  </span><font></font>
<font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">return</span> ext1 + ext2 - extbb;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードは、重み付けされた量を形成する数量の数を計算するために使用されます。これは、最終的にコストとして使用されます。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">volumeCostFunction</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;Volume&gt; rooms)</span></span>{
  <span class="hljs-comment">//</span>
  <span class="hljs-keyword">int</span> metric[<span class="hljs-number">6</span>] = {
    <span class="hljs-number">0</span>, <span class="hljs-comment">//  </span>
    <span class="hljs-number">0</span>, <span class="hljs-comment">//  </span>
    <span class="hljs-number">0</span>, <span class="hljs-comment">//    </span>
    <span class="hljs-number">0</span>, <span class="hljs-comment">//    </span>
    <span class="hljs-number">0</span>, <span class="hljs-comment">// ,  </span>
    <span class="hljs-number">0</span>};<span class="hljs-comment">//   </span><font></font>
<font></font>
  <span class="hljs-keyword">int</span> weight[<span class="hljs-number">6</span>] = {<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">-5</span>, <span class="hljs-number">5</span>};<font></font>
<font></font>
  <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rooms.size(); i++){<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; rooms.size(); j++){
      <span class="hljs-comment">//    ,  .</span>
      <span class="hljs-keyword">if</span>(i == j) <span class="hljs-keyword">continue</span>;<font></font>
<font></font>
      <span class="hljs-comment">//    .</span><font></font>
      glm::vec3 overlap = overlapVolumes(rooms[i], rooms[j]);<font></font>
<font></font>
      <span class="hljs-comment">//  </span>
      glm::vec3 posOverlap = glm::clamp(overlap, glm::vec3(<span class="hljs-number">0</span>), overlap);<font></font>
      metric[<span class="hljs-number">0</span>] += glm::<span class="hljs-built_in">abs</span>(posOverlap.x*posOverlap.y*posOverlap.z); <span class="hljs-comment">//  </span><font></font>
<font></font>
      <span class="hljs-comment">//  </span>
      glm::vec3 negOverlap = glm::clamp(overlap, overlap, glm::vec3(<span class="hljs-number">0</span>));<font></font>
      metric[<span class="hljs-number">1</span>] += glm::<span class="hljs-built_in">abs</span>(negOverlap.x*negOverlap.y*negOverlap.z); <span class="hljs-comment">//  </span><font></font>
<font></font>
      <span class="hljs-comment">//  </span>
      <span class="hljs-keyword">if</span>(overlap.y == <span class="hljs-number">0</span>){<font></font>
        metric[<span class="hljs-number">2</span>] += overlap.x*overlap.z;<font></font>
      }<font></font>
      <span class="hljs-comment">//   (X)</span>
      <span class="hljs-keyword">if</span>(overlap.x == <span class="hljs-number">0</span>){
        <span class="hljs-comment">//      0,   , .. overlap.z = 0</span>
        metric[<span class="hljs-number">3</span>] += overlap.z*overlap.y;<font></font>
      }<font></font>
      <span class="hljs-comment">//   (Z)</span>
      <span class="hljs-keyword">if</span>(overlap.z == <span class="hljs-number">0</span>){
        <span class="hljs-comment">//      0,   , .. overlap.x = 0</span>
        metric[<span class="hljs-number">4</span>] += overlap.x*overlap.y;<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//  ,   -   .</span>
    <span class="hljs-keyword">if</span>(rooms[i].a.y == <span class="hljs-number">0</span>){
      <span class="hljs-comment">//  ,  ,    .</span>
      metric[<span class="hljs-number">4</span>] += rooms[i].a.x*rooms[i].a.z;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//,     !</span>
    <span class="hljs-keyword">if</span>(rooms[i].a.y &lt; <span class="hljs-number">0</span>){
      <span class="hljs-comment">//,       </span>
      <span class="hljs-keyword">if</span>(rooms[i].b.y &lt; <span class="hljs-number">0</span>){<font></font>
        metric[<span class="hljs-number">5</span>] += rooms[i].getVol();<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span>{<font></font>
        metric[<span class="hljs-number">5</span>] += <span class="hljs-built_in">abs</span>(rooms[i].a.y)*(rooms[i].b.z-rooms[i].a.z)*(rooms[i].b.x-rooms[i].a.x);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">// Metric * Weights</span>
  <span class="hljs-keyword">return</span> metric[<span class="hljs-number">0</span>]*weight[<span class="hljs-number">0</span>] + metric[<span class="hljs-number">1</span>]*weight[<span class="hljs-number">1</span>] + metric[<span class="hljs-number">2</span>]*weight[<span class="hljs-number">2</span>] + metric[<span class="hljs-number">3</span>]*weight[<span class="hljs-number">3</span>] + metric[<span class="hljs-number">4</span>]*weight[<span class="hljs-number">4</span>] + metric[<span class="hljs-number">5</span>]*weight[<span class="hljs-number">5</span>];<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注：「正の交差ボリューム」とは、ボリュームが実際に交差することを意味します。</font><font style="vertical-align: inherit;">「負の交差ボリューム」とは、それらがまったく接触せず、交差が3D空間内の2つの直方体の2つの最も近い点の間にある空間内のボリュームによって定義されることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重みは、あるものを優先し、他のものを優先するように選択されます。</font><font style="vertical-align: inherit;">たとえば、ここでは床の下にある部屋を厳密に細かくし、表面積が接触する部屋の優先度を上げています（ボリュームの交差部分を細かくします）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分とペアになっている部屋を無視して、すべての部屋のペアのコストを生成します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">低コストのソリューションを見つける</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
収束は、疑似コードで説明されているように実行されます。移行するときは、一度に1つの部屋のみを移動します。つまり、n個の部屋と7つの可能な遷移で、7 * nの確率を計算する必要があり、それらすべてから選択して、その部屋のみを移動します。これが</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も望ましい方法です。</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">float</span> T = <span class="hljs-number">250</span>;<font></font>
<font></font>
  <span class="hljs-keyword">while</span>(T &gt; <span class="hljs-number">0.1</span>){
    <span class="hljs-comment">//  </span>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;<span class="hljs-keyword">double</span>, moves.size()&gt;&gt; probabilities;<font></font>
    <font></font>
    <span class="hljs-comment">//   ()</span>
    <span class="hljs-keyword">int</span> curEnergy = volumeCostFunction(rooms);<font></font>
<font></font>
    <span class="hljs-comment">//      ...</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++){
      <span class="hljs-comment">//    </span>
      <span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;<span class="hljs-keyword">double</span>, moves.size()&gt; probability;<font></font>
<font></font>
      <span class="hljs-comment">//      ,    </span>
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> m = <span class="hljs-number">0</span>; m &lt; moves.size(); m++){
        <span class="hljs-comment">//        .</span><font></font>
        rooms[i].translate(moves[m]);<font></font>
<font></font>
        <span class="hljs-comment">//      !</span>
        probability[m] = <span class="hljs-built_in">exp</span>(-(<span class="hljs-keyword">double</span>)(volumeCostFunction(rooms) - curEnergy)/T);<font></font>
<font></font>
        <span class="hljs-comment">//  </span><font></font>
        rooms[i].translate(-moves[m]);<font></font>
      }<font></font>
<font></font>
      <span class="hljs-comment">//      </span><font></font>
      probabilities.push_back(probability);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//  ( )</span>
    <span class="hljs-keyword">double</span> Z = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; probabilities.size(); i++){
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; probabilities[i].size(); j++){<font></font>
        Z += probabilities[i][j];<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// </span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; probabilities.size(); i++){
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; probabilities[i].size(); j++){<font></font>
        probabilities[i][j] /= Z;<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    (CDF) ( )</span>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt; cdf;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; probabilities.size(); i++){
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; probabilities[i].size(); j++){
        <span class="hljs-keyword">if</span>(cdf.empty()) cdf.push_back(probabilities[i][j]);
        <span class="hljs-keyword">else</span> cdf.push_back(probabilities[i][j] + cdf.back());<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//     </span>
    <span class="hljs-built_in">std</span>::random_device rd;
    <span class="hljs-function"><span class="hljs-built_in">std</span>::mt19937 <span class="hljs-title">e2</span><span class="hljs-params">(rd())</span></span>;
    <span class="hljs-function"><span class="hljs-built_in">std</span>::uniform_real_distribution&lt;&gt; <span class="hljs-title">dist</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)</span></span>;
    <span class="hljs-keyword">double</span> uniform = dist(e2);
    <span class="hljs-keyword">int</span> sampled_index = <span class="hljs-number">0</span>;<font></font>
<font></font>
    <span class="hljs-comment">//   CDF</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cdf.size(); i++){
      <span class="hljs-comment">//    ,   ...</span>
      <span class="hljs-keyword">if</span>(cdf[i] &gt; uniform){<font></font>
        sampled_index = i;<font></font>
        <span class="hljs-keyword">break</span>;<font></font>
      }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-keyword">int</span> _roomindex = sampled_index/moves.size();
    <span class="hljs-keyword">int</span> _moveindex = sampled_index%moves.size();<font></font>
<font></font>
    <span class="hljs-comment">// </span><font></font>
    rooms[_roomindex].translate(moves[_moveindex]);<font></font>
<font></font>
    <span class="hljs-comment">// T</span>
    T *= <span class="hljs-number">0.99</span>; <font></font>
<font></font>
    <span class="hljs-comment">// !!!</span><font></font>
  }<font></font>
<span class="hljs-comment">//!!</span><font></font>
<font></font>
<span class="hljs-comment">//...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サンプリングは、すべての可能な遷移の質量分布関数に対する累積分布関数の形成によって実行されます。この操作は「逆変換サンプリング」と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、遷移確率の累積合計を生成することで行われ、累積分布関数（CDF）が得られます。サンプリングでは、0と1の間の一様分布を持つ確率変数を生成します。CDFの最初の要素は0で最後の要素は1であるため、「CDF配列のどのインデックスに一様分布のサンプル変数があるか」を見つけるだけで、これは次のようになります。サンプリングされた遷移インデックス。これがイラストです：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/960/9fe/3cd/9609fe3cdc3a514c34ed2d8e128d8629.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">連続関数の代わりに、個別のステップがあります。</font><font style="vertical-align: inherit;">詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、3D空間に空間ボリュームデータを持っています！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はそれらを使用して、既知のバルクデータにテーマを適用し、ブループリントクラスを使用して「スキーマ」を生成します。</font><font style="vertical-align: inherit;">だから家はその外観を得る。</font><font style="vertical-align: inherit;">ブループリントクラスは、以前の記事[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]（</font><font style="vertical-align: inherit;">Habréの</font><font style="vertical-align: inherit;">[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">translation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]）で</font><font style="vertical-align: inherit;">説明されています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらのボリュームから家を完全に生成するには、ソースコードを参照してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような一般化された方法の結果は非常に良好です。</font><font style="vertical-align: inherit;">私が設定しなければならない唯一のことは、コスト関数の正しい優先度とペナルティの重みでした。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/152/06b/acc/15206bacc91b6635a0f286fa21998363.gif" width="562" height="562"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このアルゴリズムを使用して生成を構築するいくつかの例と、それらに適用されるテーマ。</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/62d/1ee/92c/62d1ee92c2f422d79c27c14532346855.gif"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">側面図（その他の建物）。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
境界ボックスの計算とコスト関数の推定が非常に簡単であるため、収束自体は非常に高速で、特に少数の部屋（3〜5）の場合は高速です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在のバージョンでは、家にはドアや窓がありませんが、これは、MCMCアルゴリズムのタスクというよりは、3Dボリュームデータの解釈の問題です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは確率的なプロセスであるため、この方法では醜い結果が得られることがあります。そのため、世界に建物を配置する前に、特にコスト関数の信頼性が低い場合は、その正確性を確認する必要があります。</font><font style="vertical-align: inherit;">醜さは、主に気温が高い最初の数ステップで発生するのではないかと思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、欠陥は部屋または建物から分離した部屋として表示されます。</font><font style="vertical-align: inherit;">空中にぶら下がっています（高床に）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拡張機能とその他のシステム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
明らかに、3Dボリュームを使用した私の手法は、タスクの次元を1つ減らすだけで、2Dの世界に簡単に移行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、ダンジョンの手続き型生成や、平面図のある2Dゲームの部屋などのタスクに使用できます。部屋を相互にアタッチすることは、上記と同様のコスト関数を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
生成をより面白くするための可能な方法は、最初にそれぞれ独自のタイプを持つ部屋のグラフを生成し、次に物理サーフェス上のグラフで接続されている部屋の接続を刺激するコスト関数を設定することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グラフ自体は、MCMCアルゴリズムを使用して生成できます。部屋間の接続の作成と破棄は、特定のタイプの部屋間の接続を刺激する個別の遷移と見なされます（寝室は廊下に接続する可能性が高く、環境に接続する可能性は低いなど）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その他の可能なアプリケーション：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迷宮の世代; </font><font style="vertical-align: inherit;">コストは迷路の蛇行に応じて設定され、遷移は壁または廊下の配置/削除です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">道路のネットワーク、距離、地形、またはコストとして使用されるその他の要素に基づく、グラフのノード間の接続のインストールと破棄。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく他にもたくさん！</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深いメモ：シミュレーテッドアニーリングとMCMCアルゴリズムは、有名なNP困難問題である「巡回セールスマン問題」などのタスクに使用できます。</font><font style="vertical-align: inherit;">システムステータスはルートであり、遷移はルートノードの切り替えであり、コストは合計距離である可能性があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクボットの申請</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシステムのおかげで、タスクボットは自分のニーズに合わせて将来自分の知識を作れるようになることを期待しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、ボットがこのアルゴリズムによって生成された家をどのように構築するかのビデオです。</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="http://weigert.vsos.ethz.ch/wp-content/uploads/2019/10/bot_the_builder3.mp4" type="video/mp4"></video></div></div></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建物のドラフトの作成はほぼ瞬時に行われます（ボットが角を曲がったときに準備が整います）。</font><font style="vertical-align: inherit;">構築にはもっと時間がかかります。</font><font style="vertical-align: inherit;">ドアがない場合、ボットは建物内にロックされ（場合によってはこれが起こらない）、建設プロセスはテレパシーで続行されます。</font><font style="vertical-align: inherit;">また、建物の外観を内側から見ることもできます。</font><font style="vertical-align: inherit;">ボットはパスの検索を使用しようとして成功しなかったため、最後に向かって処理が少し遅くなります。</font><font style="vertical-align: inherit;">この問題はどうにかして解決する必要がありますが、まだ方法はわかりません。</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja475754/index.html">スクラムに関するショーツ</a></li>
<li><a href="../ja475756/index.html">フードデザインダイジェスト2019年10月</a></li>
<li><a href="../ja475758/index.html">iOSアプリの自動更新サブスクリプションレベル</a></li>
<li><a href="../ja475760/index.html">ジュニア開発者-なぜ彼らを雇うのか、そして彼らとどのように協力するのか</a></li>
<li><a href="../ja475762/index.html">写真付きの履歴書が骨壷に飛んでいきます。アメリカでの就職活動の特徴</a></li>
<li><a href="../ja475770/index.html">スタンフォード大学-訪問とレビュー</a></li>
<li><a href="../ja475772/index.html">産業用モノのインターネットの6つのポイント</a></li>
<li><a href="../ja475774/index.html">「これらは皆を困らせる愚かなルールです」：パスワードフィールドの実践に関する議論</a></li>
<li><a href="../ja475776/index.html">日曜大工は3つのギターのスタンド</a></li>
<li><a href="../ja475778/index.html">WebAssembly：何をどのように</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>