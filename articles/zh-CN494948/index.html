<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏿 👨🏾‍🔬 👦🏻 在Zimbra协作开源版中创建VIP邮箱 🎎 🧕🏾 💸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在企业中，经常需要创建所谓的VIP邮箱，只有特定圈子的人才能向其发送信件。这样的邮箱对于任何拥有私人秘书的高级管理人员都是典型的。秘书会收到所有电子邮件，而不是最高经理，然后秘书会从总流中选择真正重要和必要的邮件，然后将其重定向到经理的邮箱。企业的普通员工在尝试向VIP邮箱发送消息时，应该收到一条通...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>在Zimbra协作开源版中创建VIP邮箱</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/494948/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在企业中，经常需要创建所谓的VIP邮箱，只有特定圈子的人才能向其发送信件。这样的邮箱对于任何拥有私人秘书的高级管理人员都是典型的。秘书会收到所有电子邮件，而不是最高经理，然后秘书会从总流中选择真正重要和必要的邮件，然后将其重定向到经理的邮箱。企业的普通员工在尝试向VIP邮箱发送消息时，应该收到一条通知，通知他的消息尚未传递。使用称为Amavis和cbpolicyd的内置邮件过滤工具，可以在Zimbra开源版中轻松实现这种VIP邮箱。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/op/xi/ie/opxiieyaijocgswpkt2td6f4-u0.png" alt="图片"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Amavis协调Postfix电子邮件转发代理，垃圾邮件刺客垃圾邮件过滤器，ClamAV防病毒软件和其他几个软件的动作。所有这些实用程序一起提供了可靠的防护，可抵御垃圾邮件和病毒以及网络钓鱼电子邮件，这些邮件对企业的信息安全构成了严重威胁。默认情况下，Amavis会毫无例外地过滤所有电子邮件，但是内置的策略限制功能不仅允许对任何邮箱禁用此过滤，而且原则上还可以限制可以向邮箱发送电子邮件的人员列表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，使用CEO ceo@example.ru的邮箱，有必要限制可以直接发送消息的人员的圈子。该名单将以CTO，CIO和CFO的形式仅限于公司的最高管理层以及个人秘书。为此，我们将利用Amavis的政策限制。使用命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov ma ceo@example.ru + amavisWhitelistSender Secretary@example.ru cto@example.ru cio@example.ru cfo@example.ru，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将添加到白名单地址，该地址可以直接向CEO发送电子邮件，并带有使用命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov ma ceo@example.ru amavisBlacklistSender example.ru，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们将其余的添加到黑名单中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了确保一切都正确完成，您可以运行以下命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov -l ga ceo@example.ru | grep amavis | grep发送者</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。团队的输出将显示允许向CEO发送消息的人员，以及禁止向其电子邮件地址发送消息的人员。但是，除了企业域的用户外，CEO邮箱的信件也可以来自外部Internet上的域。因此，一个合理的步骤将是引入无条件禁止该邮箱从外部Internet接收电子邮件的操作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以使用cbpolicyd（Zimbra Collaboration Suite开源版内置的策略服务）引入这些限制。为了使用它，您必须首先激活Zimbra OSE中的相应模块。为此，输入命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov ms mail.example.ru + zimbraServiceEnabled cbpolicyd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。如果您的Zimbra OSE在多服务器基础结构上运行，请在MTA主机上运行此命令。您还需要通过Web界面打开对cbpolicyd的访问。为此，请输入命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ln -s / opt / zimbra / data / cbpolicyd / share / webui / opt / zimbra / httpd / htdocs /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它将在Apache服务器中创建符号链接。另外，您需要将</font><font style="vertical-align: inherit;">有关您要连接的数据库</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">信息</font><font style="vertical-align: inherit;">添加到文件</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/opt/zimbra/cbpolicyd/share/webui/includes/config.php中</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。为此，在任何文本编辑器中，将行</font><b><font style="vertical-align: inherit;">$ DB_DSN =“ sqlite：/opt/zimbra/data/cbpolicyd/db/cbpolicyd.sqlitedb”</font></b><font style="vertical-align: inherit;">添加到此文件</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;。之后，剩下的就是使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmcontrol restart</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmapachectl restart命令</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重启Zimbra OSE和Apache Web服务器</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mail.example.ru：7780</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">webui</font></a><font style="vertical-align: inherit;"> / index.php上</font><font style="vertical-align: inherit;">找到用于管理cbpolicyd的Web界面</font><font style="vertical-align: inherit;">，但是，应注意的是，由于防火墙设置，它可能不可用。配置它以访问cbpolicyd Web界面。进入cbpolicyd Web界面后，您需要创建两个组：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">users_local_only（仅</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于只能从本地域的用户以及</font><b><font style="vertical-align: inherit;">local_domain</font></b><font style="vertical-align: inherit;">接收邮件的用户）</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地域，并通过取消选中“禁用”来启用它们。之后，您需要将参与者添加到组中。在本例中，我们将ceo@example.ru添加到</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">users_local_only</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">，并将example.ru域添加到</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">local_domain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/wr/qi/zrwrqig_whywr6pyw7fo7qdwkdg.png"><br>
<br>
<img src="https://habrastorage.org/webt/xa/fd/11/xafd11cwayuoukj5mh6moi7lpis.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在让我们进入策略设置。我们将其称为“仅接收本地”，并在其中指示将其分发到的用户组以及被视为本地的域。应该将</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user_local_only</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><b><font style="vertical-align: inherit;">local_domain</font></b><font style="vertical-align: inherit;">组指定为它们</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并指出应用该政策的优先级。对于将多个策略同时应用于同一邮箱的情况，这是必需的。根据优先级，cbpolicyd决定将应用哪个策略，而忽略哪个策略。在我们的情况下，您可以将优先级设置为100，将来，如果出现其他重叠策略，请对其进行调整。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/go/px/it/gopxits8bjhued_4dom3c3hyr2i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个要点是触发策略时操作的配置。换句话说，如果我们禁止首席执行官的邮箱接收来自任何外部域的信件，那么我们需要确定将继续发送到他的邮箱的信件将会发生什么情况。我们建议您使用</font><b><font style="vertical-align: inherit;">REJECT</font></b><font style="vertical-align: inherit;">选项简单地拒绝此类电子邮件</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">进行更改后，仅需应用策略并使用命令</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmprov ms mail.example.ru zimbraCBPolicydAccessControlEnabled TRUE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zmcbpolicydctl restart重新启动cbpolicyd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，使用Zimbra Collaboration Suite开源版的内置工具，我们创建了一个VIP邮箱，只有几个人可以向其发送信件。</font><font style="vertical-align: inherit;">使用此模板，您可以扩展VIP邮箱的数量，以及可以向其发送信件的帐户数量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有关Zextras Suite的所有问题，您可以通过电子邮件katerina@zextras.com与“ Zextras” Ekaterina Triandafilidi公司的代表联系。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN494932/index.html">操作大型分布式系统：我学到的知识</a></li>
<li><a href="../zh-CN494934/index.html">英语单词中的6个令人发指的错误</a></li>
<li><a href="../zh-CN494938/index.html">备份日快乐！别忘了他</a></li>
<li><a href="../zh-CN494940/index.html">DevOps-它是什么，为什么，需求量是多少？</a></li>
<li><a href="../zh-CN494942/index.html">使用虚幻引擎和iPhone在家中使用CGI</a></li>
<li><a href="../zh-CN494950/index.html">需要注意的一些存储趋势</a></li>
<li><a href="../zh-CN494956/index.html">数据字节寿命</a></li>
<li><a href="../zh-CN494964/index.html">神经网络和交易。实际实施</a></li>
<li><a href="../zh-CN494966/index.html">SCRUM：关于爱情和痛苦的诗</a></li>
<li><a href="../zh-CN494968/index.html">水下Internet电缆：谁来布线</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>