<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßúüèæ üé∫ üë®üèº‚Äçüî¨ Qu√£o estranho c√≥digo oculta erros? An√°lise do TensorFlow.NET üíó üë©üèø‚Äçüè≠ üòè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A an√°lise est√°tica √© uma ferramenta extremamente √∫til para qualquer desenvolvedor, pois ajuda a encontrar a tempo n√£o apenas erros, mas tamb√©m apenas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Qu√£o estranho c√≥digo oculta erros? An√°lise do TensorFlow.NET</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/496250/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/bb4/d84/765bb4d84187d986358a301bbeed082f.png" alt="TensorFlow.NET e PVS-Studio"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A an√°lise est√°tica √© uma ferramenta extremamente √∫til para qualquer desenvolvedor, pois ajuda a encontrar a tempo n√£o apenas erros, mas tamb√©m apenas peda√ßos de c√≥digo suspeitos e estranhos que podem causar confus√£o para os programadores que precisariam trabalhar com ele no futuro. Essa id√©ia ser√° demonstrada por uma an√°lise do projeto aberto C # do TensorFlow.NET, que est√° sendo desenvolvido para trabalhar com a popular biblioteca de aprendizado de m√°quina do TensorFlow.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu nome √© Nikita Lipilin. </font><font style="vertical-align: inherit;">H√° algum tempo, entrei para o departamento de programadores em C # do PVS-Studio. </font><font style="vertical-align: inherit;">Tradicionalmente, todos os rec√©m-chegados √† equipe escrevem artigos que discutem os resultados da verifica√ß√£o de v√°rios projetos abertos usando o analisador est√°tico PVS-Studio. </font><font style="vertical-align: inherit;">Esses artigos ajudam os novos funcion√°rios a conhecer melhor o produto e, ao mesmo tempo, fornecem benef√≠cios adicionais em termos de populariza√ß√£o da metodologia de an√°lise est√°tica. </font><font style="vertical-align: inherit;">Sugiro que voc√™ se familiarize com meu primeiro trabalho sobre o t√≥pico de an√°lise de projetos abertos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdu√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A variedade de poss√≠veis erros no c√≥digo do programa √© incr√≠vel. Alguns deles se revelam imediatamente, ap√≥s um exame superficial do aplicativo criado, outros podem ser dif√≠ceis de perceber, mesmo ao realizar uma revis√£o de c√≥digo por uma equipe de desenvolvedores experientes. No entanto, tamb√©m acontece que, devido ao descuido ou por algum outro motivo, o programador √†s vezes escreve simplesmente c√≥digo estranho e il√≥gico, que, no entanto, (parece) cumpre com √™xito sua fun√ß√£o. Por√©m, somente depois, ao retornar ao que foi escrito ou quando outros estudam esse c√≥digo, come√ßam a surgir perguntas que n√£o podem ser respondidas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A refatora√ß√£o de c√≥digo antigo pode se transformar em problemas, especialmente se outras partes do programa dependem dele; portanto, quando voc√™ encontra at√© mesmo algumas constru√ß√µes francamente curvadas, o ‚Ä≥ Funciona? N√£o toque! ‚Ä≥. Posteriormente, isso dificulta o estudo da fonte e, portanto, torna-se dif√≠cil expandir os recursos dispon√≠veis. A base de c√≥digo est√° entupida, h√° uma probabilidade de que algum problema interno pequeno e invis√≠vel, mas potencialmente muito desagrad√°vel, n√£o seja corrigido a tempo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em algum momento, as consequ√™ncias desse erro ser√£o sentidas, mas sua pesquisa levar√° muito tempo, porque as suspeitas do desenvolvedor caem em um grande n√∫mero de fragmentos de c√≥digo estranhos que n√£o foram refatorados ao mesmo tempo. Daqui resulta que v√°rios problemas e esquisitices em um fragmento espec√≠fico devem ser corrigidos imediatamente ap√≥s a sua escrita. No caso de existirem raz√µes razo√°veis ‚Äã‚Äãpara deixar tudo como est√° (por exemplo, se o c√≥digo for escrito como algum tipo de espa√ßo em branco ‚Ä≥ para mais tarde ‚Ä≥), esse fragmento dever√° ser acompanhado por um coment√°rio explicativo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m √© importante notar que, independentemente das qualifica√ß√µes do desenvolvedor, alguns momentos problem√°ticos e simplesmente sem sucesso podem escapar do seu olhar e, √†s vezes, uma "solu√ß√£o tempor√°ria" pode ser aplicada em algum lugar, que logo ser√° esquecido e se tornar√° "permanente". Posteriormente, a an√°lise desse c√≥digo (provavelmente outro desenvolvedor se envolver√° nisso) exigir√° um esfor√ßo inaceit√°vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesses casos, a revis√£o de c√≥digo pode ajudar. No entanto, se a tarefa for bastante s√©ria, essa op√ß√£o exigir√° muito tempo. Al√©m disso, quando existem muitos pequenos erros ou defici√™ncias, o inspetor pode n√£o perceber erros de alto n√≠vel por tr√°s deles. A verifica√ß√£o do c√≥digo se torna uma rotina tediosa e, gradualmente, a efic√°cia da revis√£o diminui.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, as tarefas rotineiras ser√£o muito melhor transferidas de pessoa para computador. Essa abordagem √© usada em muitas √°reas da modernidade. A automa√ß√£o de v√°rios processos √© a chave para a prosperidade. O que √© automa√ß√£o no contexto deste t√≥pico? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um assistente confi√°vel para resolver o problema de escrever c√≥digo de trabalho razo√°vel e est√°vel √© a an√°lise est√°tica. Cada vez antes de enviar os resultados de suas atividades para a revis√£o, o programador poder√° realizar uma verifica√ß√£o automatizada e n√£o sobrecarregar outros desenvolvedores (e ele pr√≥prio) com trabalho desnecess√°rio. O c√≥digo ser√° enviado para verifica√ß√£o somente depois que todos os avisos do analisador forem levados em considera√ß√£o: erros foram corrigidos e momentos estranhos foram reescritos, ou pelo menos explicados por um coment√°rio.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, a necessidade de revis√£o de c√≥digo n√£o desaparece, mas a an√°lise est√°tica complementa e simplifica bastante sua implementa√ß√£o. </font><font style="vertical-align: inherit;">Uma parte suficientemente grande dos erros ser√° corrigida gra√ßas ao analisador, e momentos estranhos definitivamente n√£o ser√£o esquecidos e marcados de acordo. </font><font style="vertical-align: inherit;">Assim, com uma revis√£o de c√≥digo, ser√° poss√≠vel focar na verifica√ß√£o da corre√ß√£o da implementa√ß√£o de intera√ß√µes l√≥gicas complexas e na localiza√ß√£o de problemas subjacentes que, infelizmente, n√£o podem ser detectados pelo analisador (at√© o momento).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow.NET</font></font></h2><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d02/39d/72d/d0239d72ded7154a696d5c975a0555d1.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este artigo foi inspirado no projeto TensorFlow.NET. Representa a implementa√ß√£o da capacidade de trabalhar com a funcionalidade da popular biblioteca de aprendizado de m√°quina TensorFlow por meio de c√≥digo C # (a prop√≥sito, tamb√©m </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">testamos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Essa ideia parecia bastante interessante, porque no momento da reda√ß√£o, o trabalho com a biblioteca estava dispon√≠vel apenas em Python, Java e Go. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo fonte dispon√≠vel no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° sendo constantemente atualizado e agora seu volume √© um pouco mais de cem mil linhas. Ap√≥s um estudo superficial, houve um desejo de realizar a verifica√ß√£o usando an√°lise est√°tica. O PVS-Studio foi usado como uma ferramenta espec√≠fica, que provou sua efic√°cia em um n√∫mero bastante grande de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projetos diferentes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/261/70b/247/26170b247e9b81a3643bd5682b7d5203.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o TensorFlow.NET, o analisador exibia v√°rios alertas: 39 n√≠veis altos, 227 n√≠veis m√©dios e 154 n√≠veis baixos (voc√™ pode ler sobre os n√≠veis de aviso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na subse√ß√£o "N√≠veis de aviso e conjuntos de regras de diagn√≥stico"). Uma an√°lise detalhada de cada um deles tornaria este artigo gigantesco; portanto, apenas os que me pareciam mais interessantes s√£o descritos abaixo. Tamb√©m √© importante notar que alguns dos problemas encontrados s√£o encontrados v√°rias vezes no projeto, e a an√°lise de cada parte desse c√≥digo est√° al√©m do escopo deste artigo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O projeto define uma tarefa bastante s√©ria e, infelizmente, a apar√™ncia de v√°rios tipos de fragmentos de c√≥digo estranhos √© inevit√°vel. </font><font style="vertical-align: inherit;">Neste artigo, tentarei mostrar que o uso da an√°lise est√°tica pode simplificar bastante o trabalho dos programadores, apontando para √°reas que podem causar perguntas. </font><font style="vertical-align: inherit;">Nem sempre um aviso indica um erro, mas muitas vezes indica um c√≥digo que causaria perguntas a uma pessoa. </font><font style="vertical-align: inherit;">Consequentemente, a probabilidade de um c√≥digo estranho ser redesenhado ou, em qualquer caso, comentado em conformidade √© significativamente aumentada.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmentos que atra√≠ram a aten√ß√£o ao estudar o relat√≥rio do analisador</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, um n√∫mero razoavelmente grande de avisos do analisador para este projeto pode ser chamado de n√£o muitos erros, mas um c√≥digo estranho. Ao visualizar as linhas para as quais um aviso √© emitido, surgem pelo menos confus√£o. Obviamente, alguns dos exemplos abaixo s√£o provavelmente "solu√ß√µes tempor√°rias", mas n√£o comentam esse problema, o que significa que algu√©m que trabalhar√° com esse c√≥digo no futuro ter√° perguntas, procurando respostas para as quais levar√° tempo extra.</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/3fc/e7c/2633fce7cba470cd8a0c16e6751b3513.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, alguns avisos apontam para um c√≥digo que obviamente n√£o √© apenas estranho, mas apenas errado. </font><font style="vertical-align: inherit;">Esse √© o principal perigo do "c√≥digo estranho" - √© extremamente dif√≠cil perceber um erro real se aqui e ali voc√™ v√™ solu√ß√µes incompreens√≠veis e se acostuma gradualmente ao fato de que o c√≥digo parece estar incorreto.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tour sofisticado de coleta</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> _RemoveDefaultAttrs(....)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
  producer_op_list.Op.Select(op =&gt;<font></font>
  {<font></font>
    producer_op_dict[op.Name] = op;<font></font>
    <span class="hljs-keyword">return</span> op;<font></font>
  }).ToArray();           <font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O valor de retorno da fun√ß√£o 'ToArray' deve ser utilizado. importer.cs 218 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O analisador considera a chamada para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neste momento a ser suspeito, uma vez que o valor retornado por esta fun√ß√£o n√£o √© atribu√≠do a uma vari√°vel. No entanto, esse c√≥digo n√£o √© um erro. Essa constru√ß√£o √© usada para preencher o dicion√°rio </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">producer_op_dict</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com </font><font style="vertical-align: inherit;">valores correspondentes aos elementos da lista </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">producer_op_list.Op</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Uma chamada para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> necess√°ria para que a fun√ß√£o passada como argumento para o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seja </font><font style="vertical-align: inherit;">chamada para todos os elementos da cole√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na minha opini√£o, o c√≥digo n√£o parece o melhor. </font><font style="vertical-align: inherit;">O preenchimento do dicion√°rio √© um tanto √≥bvio, e alguns desenvolvedores podem querer remover a chamada "desnecess√°ria" do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Seria muito mais simples e compreens√≠vel usar o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loop foreach</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aqui </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
<font></font>
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> op <span class="hljs-keyword">in</span> producer_op_list.Op)<font></font>
{<font></font>
  producer_op_dict[op.Name] = op;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o c√≥digo parece o mais simples poss√≠vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro momento semelhante √© assim:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  inference_graph.Node.Select(x =&gt; map_name_to_node[x.Name] = x).ToArray();<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O valor de retorno da fun√ß√£o 'ToArray' deve ser utilizado. </font><font style="vertical-align: inherit;">graph_util_impl.cs 48 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica diferen√ßa √© que esse registro parece mais conciso, mas apenas a tenta√ß√£o de remover a chamada do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aqui n√£o desaparece e ainda parece n√£o √≥bvia.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solu√ß√£o tempor√°ria</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> source_op_name = get_input_name(node);
  <span class="hljs-keyword">while</span>(map_name_to_node[source_op_name].Op == <span class="hljs-string">"Identity"</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException);<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um 'lan√ßamento' incondicional dentro de um loop. graph_util_impl.cs 73 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No projeto em considera√ß√£o, a seguinte abordagem √© frequentemente usada: se algum comportamento precisar ser implementado posteriormente, uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException ser√°</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lan√ßada no local apropriado </font><font style="vertical-align: inherit;">. Est√° claro por que o analisador alerta para um poss√≠vel erro nesta pe√ßa: usar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while em</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vez de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o parece muito razo√°vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este n√£o √© o √∫nico aviso que aparece devido ao uso de solu√ß√µes tempor√°rias. Por exemplo, existe um m√©todo:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _SoftmaxCrossEntropyWithLogitsGrad(<font></font>
  Operation op, Tensor[] grads<font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> grad_loss = grads[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> grad_grad = grads[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> softmax_grad = op.outputs[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> grad = _BroadcastMul(grad_loss, softmax_grad);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> logits = op.inputs[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span>(grad_grad != <span class="hljs-literal">null</span> &amp;&amp; !IsZero(grad_grad)) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"_SoftmaxCrossEntropyWithLogitsGrad"</span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[] <font></font>
  {<font></font>
    grad,<font></font>
    _BroadcastMul(grad_loss, -nn_ops.log_softmax(logits))<font></font>
  };<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'grad_grad! = Null &amp;&amp;! IsZero (grad_grad)' √© sempre falsa. </font><font style="vertical-align: inherit;">nn_grad.cs 93 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException ("_ SoftmaxCrossEntropyWithLogitsGrad")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nunca ser√° lan√ßada, pois esse c√≥digo √© simplesmente inacess√≠vel. </font><font style="vertical-align: inherit;">Para desvendar o motivo, voc√™ deve acessar o c√≥digo da fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsZero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsZero</span>(<span class="hljs-params">Tensor g</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>[] { <span class="hljs-string">"ZerosLike"</span>, <span class="hljs-string">"Zeros"</span> }.Contains(g.op.type))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"IsZero"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O m√©todo retorna </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou lan√ßa uma exce√ß√£o. </font><font style="vertical-align: inherit;">Este c√≥digo n√£o √© um erro - obviamente, a implementa√ß√£o aqui √© deixada para mais tarde. </font><font style="vertical-align: inherit;">O principal √© que "ent√£o" realmente chegou. </font><font style="vertical-align: inherit;">Bem, resultou com muito sucesso que o PVS-Studio n√£o permitir√° que voc√™ esque√ßa que existe uma imperfei√ß√£o aqui :)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor √© Tensor?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Tensor[] _ExtractInputShapes(Tensor[] inputs)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> sizes = <span class="hljs-keyword">new</span> Tensor[inputs.Length];
  <span class="hljs-keyword">bool</span> fully_known = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inputs.Length; i++)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> x = inputs[i];<font></font>
<font></font>
    <span class="hljs-keyword">var</span> input_shape = array_ops.shape(x);
    <span class="hljs-keyword">if</span> (!(input_shape <span class="hljs-keyword">is</span> Tensor) || input_shape.op.type != <span class="hljs-string">"Const"</span>)<font></font>
    {<font></font>
      fully_known = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
<font></font>
    sizes[i] = input_shape;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uma verifica√ß√£o de tipo excessiva. </font><font style="vertical-align: inherit;">O objeto j√° √© do tipo 'Tensor'. </font><font style="vertical-align: inherit;">array_grad.cs 154 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tipo de retorno do m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Portanto, a entrada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">input_shape √© Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parece pelo menos estranha. </font><font style="vertical-align: inherit;">Talvez, uma vez que o m√©todo retornou um valor de um tipo diferente e a verifica√ß√£o fizesse sentido, mas tamb√©m √© poss√≠vel que, em vez de Tensor, a condi√ß√£o especifique algum tipo de herdeiro para essa classe. </font><font style="vertical-align: inherit;">De uma forma ou de outra, o desenvolvedor deve prestar aten√ß√£o a esse fragmento.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifica√ß√£o Completa</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _BaseFusedBatchNormGrad(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> results = grad_fun(<span class="hljs-keyword">new</span> FusedBatchNormParams<font></font>
  {<font></font>
    YBackprop = grad_y,<font></font>
    X = x,<font></font>
    Scale = scale,<font></font>
    ReserveSpace1 = pop_mean,<font></font>
    ReserveSpace2 = pop_var,<font></font>
    ReserveSpace3 = version == <span class="hljs-number">2</span> ? op.outputs[<span class="hljs-number">5</span>] : <span class="hljs-literal">null</span>,<font></font>
    Epsilon = epsilon,<font></font>
    DataFormat = data_format,<font></font>
    IsTraining = is_training<font></font>
  });<font></font>
<font></font>
  <span class="hljs-keyword">var</span> (dx, dscale, doffset) = (results[<span class="hljs-number">0</span>], results[<span class="hljs-number">1</span>], results[<span class="hljs-number">2</span>]);
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avisos do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existem duas instru√ß√µes 'if' com express√µes condicionais id√™nticas. </font><font style="vertical-align: inherit;">A primeira instru√ß√£o 'if' cont√©m retorno de m√©todo. </font><font style="vertical-align: inherit;">Isso significa que a segunda declara√ß√£o 'if' n√£o faz sentido nn_grad.cs 231</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'data_format == "NCHW"' √© sempre falsa. </font><font style="vertical-align: inherit;">nn_grad.cs 247</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao contr√°rio de alguns dos exemplos anteriores, h√° claramente algo errado com o c√≥digo. </font><font style="vertical-align: inherit;">A segunda verifica√ß√£o n√£o faz nenhum sentido, pois se a condi√ß√£o for verdadeira, a execu√ß√£o do programa n√£o a alcan√ßar√°. </font><font style="vertical-align: inherit;">Talvez algum erro de digita√ß√£o seja permitido aqui, ou uma das verifica√ß√µes geralmente seja sup√©rflua.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A ilus√£o da escolha</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Tensor <span class="hljs-title">Activate</span>(<span class="hljs-params">Tensor x, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  ....<font></font>
  Tensor negative_part;<font></font>
  <span class="hljs-keyword">if</span> (Math.Abs(_threshold) &gt; <span class="hljs-number">0.000001f</span>)<font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  } <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">instru√ß√£o</font></a><font style="vertical-align: inherit;"> 'then' √© equivalente √† instru√ß√£o 'else'. gen_nn_ops.activations.cs 156 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma demonstra√ß√£o bastante divertida da efic√°cia do uso da an√°lise est√°tica no desenvolvimento. √â dif√≠cil encontrar uma raz√£o razo√°vel pela qual o desenvolvedor escreveu esse c√≥digo espec√≠fico - provavelmente esse √© um erro t√≠pico de copiar e colar (embora esse, √© claro, possa ser outro "para mais tarde"). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem outros fragmentos de um plano semelhante, por exemplo:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Operation _GroupControlDeps(
  <span class="hljs-keyword">string</span> dev, Operation[] deps, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span><font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">return</span> tf_with(ops.control_dependencies(deps), ctl =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (dev == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
  });<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">instru√ß√£o</font></a><font style="vertical-align: inherit;"> 'then' √© equivalente √† instru√ß√£o 'else'. </font><font style="vertical-align: inherit;">control_flow_ops.cs 135 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Talvez uma vez que o sentido cheque, mas com o tempo ela desapareceu, ou algumas altera√ß√µes adicionais est√£o previstas no futuro. </font><font style="vertical-align: inherit;">No entanto, nenhuma dessas op√ß√µes parece ser justificativa suficiente para deixar algo semelhante no c√≥digo, sem explicar essa estranheza de forma alguma. </font><font style="vertical-align: inherit;">Com um alto grau de probabilidade, um erro de copiar e colar foi feito exatamente da mesma maneira.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cheque tardio</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] <span class="hljs-title">Input</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[] batch_shape = <span class="hljs-literal">null</span>,
  TF_DataType dtype = TF_DataType.DtInvalid,
  <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">bool</span> sparse = <span class="hljs-literal">false</span>,
  Tensor tensor = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> batch_size = batch_shape[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> shape = batch_shape.Skip(<span class="hljs-number">1</span>).ToArray(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
  InputLayer input_layer = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (batch_shape != <span class="hljs-literal">null</span>)                   <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
  <span class="hljs-keyword">else</span><font></font>
    ....<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O objeto 'batch_shape' foi usado antes de ser verificado como nulo. </font><font style="vertical-align: inherit;">Verifique as linhas: 39, 42. keras.layers.cs 39 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um erro cl√°ssico e bastante perigoso do uso potencial de uma vari√°vel, que √© um link para lugar nenhum. </font><font style="vertical-align: inherit;">Nesse caso, o c√≥digo implica explicitamente a possibilidade de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_shape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - isso fica claro na lista de argumentos e na verifica√ß√£o subsequente da mesma vari√°vel. </font><font style="vertical-align: inherit;">Portanto, o analisador aqui indica um erro claro.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outro ‚Ä≥ para depois ‚Ä≥?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MnistDataSet</span>(<span class="hljs-params">
  NDArray images, NDArray labels, Type dataType, <span class="hljs-keyword">bool</span> reshape // &lt;=
</span>)</span> <font></font>
{<font></font>
  EpochsCompleted = <span class="hljs-number">0</span>;<font></font>
  IndexInEpoch = <span class="hljs-number">0</span>;<font></font>
<font></font>
  NumOfExamples = images.shape[<span class="hljs-number">0</span>];<font></font>
<font></font>
  images = images.reshape(<font></font>
    images.shape[<span class="hljs-number">0</span>], images.shape[<span class="hljs-number">1</span>] * images.shape[<span class="hljs-number">2</span>]<font></font>
  );<font></font>
  images = images.astype(dataType);<font></font>
  <span class="hljs-comment">// for debug np.multiply performance</span>
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> Stopwatch();<font></font>
  sw.Start();<font></font>
  images = np.multiply(images, <span class="hljs-number">1.0f</span> / <span class="hljs-number">255.0f</span>);<font></font>
  sw.Stop();<font></font>
  Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{sw.ElapsedMilliseconds}</span>ms"</span>);<font></font>
  Data = images;<font></font>
<font></font>
  labels = labels.astype(dataType);<font></font>
  Labels = labels;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">O par√¢metro do construtor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'remodelar' n√£o √© usado. </font><font style="vertical-align: inherit;">MnistDataSet.cs 15 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como algumas outras esquisitices, isso provavelmente ocorre devido ao fato de que a funcionalidade est√° longe de ser totalmente implementada e √© bem poss√≠vel que o par√¢metro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remodelar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seja usado de alguma forma neste construtor no futuro. </font><font style="vertical-align: inherit;">Mas, por enquanto, parece que ele est√° sendo jogado aqui exatamente assim. </font><font style="vertical-align: inherit;">Se isso for realmente feito ‚Ä≥ para mais tarde ‚Ä≥, seria sensato marcar isso com algum coment√°rio. </font><font style="vertical-align: inherit;">Caso contr√°rio, verifica-se que o c√≥digo que constr√≥i o objeto precisar√° lan√ßar um par√¢metro extra no construtor, e √© bem poss√≠vel que seria mais conveniente n√£o fazer isso.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poss√≠vel derefer√™ncia nula indescrit√≠vel</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _GatherV2Grad(Operation op, Tensor[] grads)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">int</span>)axis_static == <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> params_tail_shape = params_shape.slice(<span class="hljs-keyword">new</span> NumSharp.Slice(start:<span class="hljs-number">1</span>));
    <span class="hljs-keyword">var</span> values_shape = array_ops.concat(
      <span class="hljs-keyword">new</span>[] { indices_size, params_tail_shape }, <span class="hljs-number">0</span><font></font>
    );<font></font>
    <span class="hljs-keyword">var</span> values = array_ops.reshape(grad, values_shape);<font></font>
    indices = array_ops.reshape(indices, indices_size);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[]<font></font>
    {<font></font>
      <span class="hljs-keyword">new</span> IndexedSlices(values, indices, params_shape), <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-literal">null</span>,
      <span class="hljs-literal">null</span><font></font>
    };<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3146</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Poss√≠vel desrefer√™ncia nula do primeiro argumento 'valores' dentro do m√©todo. O '_outputs.FirstOrDefault ()' pode retornar o valor nulo padr√£o. array_grad.cs 199 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender qual √© o problema, voc√™ deve primeiro recorrer ao </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> construtor </font><i><font style="vertical-align: inherit;">indexedSlices</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">IndexedSlices</span>(<span class="hljs-params">
  Tensor values, Tensor indices, Tensor dense_shape = <span class="hljs-literal">null</span>
</span>)</span><font></font>
{<font></font>
  _values = values;<font></font>
  _indices = indices;<font></font>
  _dense_shape = dense_shape;<font></font>
<font></font>
  _values.Tag = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// &lt;=</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, passar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para esse construtor gerar√° uma exce√ß√£o. No entanto, por que o analisador considera que a vari√°vel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode conter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O PVS-Studio usa a t√©cnica de An√°lise de fluxo de dados, que permite encontrar os conjuntos de poss√≠veis valores de vari√°veis ‚Äã‚Äãem diferentes partes do c√≥digo. Um aviso informa que nulo na vari√°vel especificada pode ser retornado com a seguinte linha: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No entanto, observando o c√≥digo acima, voc√™ pode descobrir que o valor da vari√°vel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font><font style="vertical-align: inherit;">obtido chamando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ent√£o, onde √© que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault () ent√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O fato √© que, ao analisar o fluxo de dados, n√£o apenas a fun√ß√£o atual √© considerada, mas tamb√©m todas chamadas; </font><font style="vertical-align: inherit;">O PVS-Studio obt√©m informa√ß√µes sobre o conjunto de valores poss√≠veis de qualquer vari√°vel em qualquer lugar. </font><font style="vertical-align: inherit;">Portanto, um aviso significa que a implementa√ß√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape (grad, values_shape)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cont√©m uma chamada para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cujo resultado √© finalmente retornado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para verificar isso, v√° para a implementa√ß√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remodelagem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
            =&gt; gen_array_ops.reshape(tensor, shape, <span class="hljs-literal">null</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, v√° para o m√©todo de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reformula√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado dentro:</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> _op = _op_def_lib._apply_op_helper(
    <span class="hljs-string">"Reshape"</span>, name, <span class="hljs-keyword">new</span> { tensor, shape }<font></font>
  );<font></font>
  <span class="hljs-keyword">return</span> _op.output;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_apply_op_helper</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retorna um objeto da classe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que cont√©m a propriedade de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sa√≠da</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â ap√≥s o recebimento de seu valor que o c√≥digo descrito no aviso √© chamado:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> Tensor output =&gt; _outputs.FirstOrDefault();</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©, obviamente, um tipo de refer√™ncia; portanto, o valor padr√£o para ele ser√° </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por tudo isso, pode-se ver que o PVS-Studio analisa meticulosamente a estrutura l√≥gica do c√≥digo, penetrando profundamente na estrutura das chamadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O analisador concluiu seu trabalho, indicando um local potencialmente problem√°tico. </font><font style="vertical-align: inherit;">O programador deve verificar se uma situa√ß√£o pode surgir quando elementos nos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√£o ausentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, a an√°lise est√°tica for√ßar√° pelo menos o desenvolvedor a prestar aten√ß√£o ao fragmento suspeito, a fim de avaliar se o erro pode realmente ocorrer l√°. </font><font style="vertical-align: inherit;">Com essa abordagem, o n√∫mero de erros que passam despercebidos ser√° reduzido rapidamente.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espera n√£o confi√°vel?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> (LoopVar&lt;TItem&gt;, Tensor[]) _BuildLoop&lt;TItem&gt;(<font></font>
  ....<font></font>
) <span class="hljs-keyword">where</span> ....<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-comment">// Finds the closest enclosing non-None control pivot.</span>
  <span class="hljs-keyword">var</span> outer_context = _outer_context;
  <span class="hljs-keyword">object</span> control_pivot = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">while</span> (outer_context != <span class="hljs-literal">null</span> &amp;&amp; control_pivot == <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (control_pivot != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3032 A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> espera dessa express√£o n√£o √© confi√°vel, pois o compilador pode otimizar algumas das vari√°veis. </font><font style="vertical-align: inherit;">Use vari√°veis ‚Äã‚Äãvol√°teis ou primitivas de sincroniza√ß√£o para evitar isso. </font><font style="vertical-align: inherit;">WhileContext.cs 212 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O analisador indica que essa implementa√ß√£o de espera pode ser otimizada pelo compilador, mas duvido que eles realmente tenham tentado implementar a espera aqui - provavelmente, o c√≥digo simplesmente n√£o foi adicionado e ser√° desenvolvido no futuro. </font><font style="vertical-align: inherit;">Pode valer a pena lan√ßar uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException aqui</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j√° que essa pr√°tica √© usada em outras partes do projeto. </font><font style="vertical-align: inherit;">De um jeito ou de outro, acredito que algum coment√°rio explicativo obviamente n√£o faria mal.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quebrando fronteiras</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TensorShape</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[][] dims</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span>(dims.Length == <span class="hljs-number">1</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">switch</span> (dims[<span class="hljs-number">0</span>].Length)<font></font>
    {<font></font>
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: shape = <span class="hljs-keyword">new</span> Shape(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: shape = Shape.Vector((<span class="hljs-keyword">int</span>)dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: shape = Shape.Matrix(dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], dims[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]); <span class="hljs-keyword">break</span>; <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">default</span>: shape = <span class="hljs-keyword">new</span> Shape(dims[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"TensorShape int[][] dims"</span>);<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possivelmente o √≠ndice est√° fora dos limites. O √≠ndice '1' est√° apontando al√©m do limite 'dims'. TensorShape.cs 107 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre os trechos estranhos de c√≥digo que vi, houve um erro real, o que √© muito dif√≠cil de notar. O fragmento a seguir est√° errado aqui: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escurece [1] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Obter um elemento com o √≠ndice 1 a partir de uma matriz de um elemento √© obviamente um erro. Ao mesmo tempo, se voc√™ alterar o fragmento para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , outro erro ser√° exibido - obtendo um elemento com o √≠ndice 2 da matriz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cujo comprimento nesse caso √© ramifica√ß√£o 2. Portanto, esse problema acabou sendo como se estivesse com um "fundo duplo".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De qualquer forma, esse fragmento de c√≥digo deve ser estudado e corrigido pelo desenvolvedor. </font><font style="vertical-align: inherit;">Na minha opini√£o, este exemplo √© uma excelente ilustra√ß√£o do desempenho da An√°lise de Fluxo de Dados no PVS-Studio.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olepatka?</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> _init_from_args(<span class="hljs-keyword">object</span> initial_value = <span class="hljs-literal">null</span>, ....) <span class="hljs-comment">// &lt;=</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> init_from_fn = initial_value.GetType().Name == <span class="hljs-string">"Func`1"</span>; <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
  tf_with(...., scope =&gt;<font></font>
  {<font></font>
    ....<font></font>
    tf_with(...., <span class="hljs-keyword">delegate</span><font></font>
    {<font></font>
      initial_value = ops.convert_to_tensor(  <span class="hljs-comment">// &lt;=</span>
        init_from_fn ? (initial_value <span class="hljs-keyword">as</span> Func&lt;Tensor&gt;)():initial_value,<font></font>
        name: <span class="hljs-string">"initial_value"</span>,<font></font>
        dtype: dtype<font></font>
      );<font></font>
    });<font></font>
    _shape = shape ?? (initial_value <span class="hljs-keyword">as</span> Tensor).TensorShape;<font></font>
    _initial_value = initial_value <span class="hljs-keyword">as</span> Tensor; <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
    _dtype = _initial_value.dtype.as_base_dtype(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_in_graph_mode)<font></font>
    {<font></font>
      ....<font></font>
<font></font>
      <span class="hljs-keyword">if</span> (initial_value != <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      {<font></font>
        ....<font></font>
      }<font></font>
<font></font>
      ....<font></font>
    }<font></font>
<font></font>
    ....<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender o c√≥digo acima, tamb√©m vale a pena trazer a implementa√ß√£o da fun√ß√£o tf_with:</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">DebuggerStepThrough</span>] <span class="hljs-comment">// with "Just My Code" enabled this lets the </span>
[<span class="hljs-meta">DebuggerNonUserCode()</span>]  <span class="hljs-comment">//debugger break at the origin of the exception</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> tf_with&lt;T&gt;(<font></font>
  T py, Action&lt;T&gt; action<font></font>
) <span class="hljs-keyword">where</span> T : ITensorFlowObject<font></font>
{<font></font>
  <span class="hljs-keyword">try</span><font></font>
  {<font></font>
    py.__enter__();<font></font>
    action(py);<font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span><font></font>
  {<font></font>
    py.__exit__();<font></font>
    py.Dispose();<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do analisador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : V3019 Possivelmente, uma vari√°vel incorreta √© comparada a nula ap√≥s a convers√£o do tipo usando a palavra-chave 'as'. Verifique as vari√°veis ‚Äã‚Äã'valor_inicial', 'valor_inicial'. ResourceVariable.cs 137 </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_init_from_args</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© uma fun√ß√£o bastante volumosa; muitos fragmentos foram omitidos. Voc√™ pode v√™-lo completamente clicando no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Embora o aviso no in√≠cio n√£o parecesse realmente s√©rio para mim, depois de estudar, percebi que algo estava definitivamente errado com o c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiramente, deve-se notar que o m√©todo pode ser chamado sem passar par√¢metros e, por padr√£o, </font><font style="vertical-align: inherit;">ser√° </font><i><font style="vertical-align: inherit;">nulo</font></i><font style="vertical-align: inherit;"> no </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor_inicial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nesse caso, uma exce√ß√£o ser√° lan√ßada na primeira linha. </font><font style="vertical-align: inherit;">
Em segundo lugar, a verifica√ß√£o</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor_inicial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para a desigualdade </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nula</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parece estranho: se </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor_inicial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realmente se tornar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ap√≥s chamar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ops.convert_to_tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seria </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o que significa que chamar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value.dtype.as_base_dtype ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tamb√©m geraria uma exce√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O analisador sugere que voc√™ pode precisar verificar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas, como observado acima, a refer√™ncia a essa vari√°vel ocorre antes deste teste, portanto, essa op√ß√£o tamb√©m estaria incorreta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse pequeno erro seria percebido em uma fun√ß√£o t√£o gigante sem o PVS-Studio? </font><font style="vertical-align: inherit;">Eu duvido muito.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em um projeto com muitos exemplos de c√≥digo estranho, muitos problemas podem ser ocultados. O programador, acostumado a ver o incompreens√≠vel, deixa de notar erros ao mesmo tempo. As consequ√™ncias podem ser muito tristes. De fato, entre os avisos do analisador, tamb√©m existem falsos; no entanto, na maioria dos casos, os avisos indicam pelo menos fragmentos de c√≥digo que podem causar perguntas quando vistos por uma pessoa. No caso em que o c√≥digo estranho √© escrito intencionalmente, vale a pena deixar explica√ß√µes para que o fragmento fique claro para o desenvolvedor que trabalhar√° com esse c√≥digo no futuro (mesmo que isso signifique deixar coment√°rios para si mesmo).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, ferramentas de an√°lise est√°tica, como o PVS-Studio, podem ser de grande ajuda para encontrar poss√≠veis erros e esquisitices, para que sejam vis√≠veis e n√£o esquecidos, e todas as solu√ß√µes tempor√°rias sejam posteriormente refinadas e transformadas em um trabalho limpo, estruturado e est√°vel o c√≥digo.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ deseja compartilhar este artigo com um p√∫blico que fala ingl√™s, use o link para a tradu√ß√£o: Nikita Lipilin. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como o c√≥digo estranho oculta erros? </font><font style="vertical-align: inherit;">An√°lise TensorFlow.NET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt496232/index.html">Como melhorar a seguran√ßa da automa√ß√£o industrial</a></li>
<li><a href="../pt496238/index.html">Vinte e oito etapas para sobreviver e ter sucesso em crise</a></li>
<li><a href="../pt496240/index.html">Descoberta do produto 101 para gerente de produtos</a></li>
<li><a href="../pt496242/index.html">O Cyberpunk j√° est√° aqui: crian√ßas em idade escolar estudam no Minecraft e estudantes fazem testes f√≠sicos no CS: GO</a></li>
<li><a href="../pt496248/index.html">Desafios, carecas e vinho. Como n√≥s da HFLabs enfrentamos o auto-isolamento</a></li>
<li><a href="../pt496252/index.html">Aeronaves de centragem aerodinamicamente offset</a></li>
<li><a href="../pt496254/index.html">Como a Rostelecom redirecionou por engano o tr√°fego para o Google, AWS, Cloudflare etc.</a></li>
<li><a href="../pt496256/index.html">Aprendizado de m√°quina em R: t√©cnicas especializadas para an√°lise preditiva</a></li>
<li><a href="../pt496258/index.html">Holivar online: um novo formato para a troca de experi√™ncias. Este s√°bado</a></li>
<li><a href="../pt496260/index.html">Dicas de seguran√ßa cibern√©tica para trabalhar em casa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>