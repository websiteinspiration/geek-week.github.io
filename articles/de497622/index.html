<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍⚖️ 🚛 🆕 Automatisierter COVID-19-Detektor aus Fluorographiebildern 🎉 👆 👴</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Handbuch erfahren Sie, wie Sie COVID-19 in einem speziell ausgewählten Datensatz mithilfe von Keras, TensorFlow und Deep Learning automatisc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Automatisierter COVID-19-Detektor aus Fluorographiebildern</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497622/"><img src="https://habrastorage.org/getpro/habr/post_images/e21/f41/a1d/e21f41a1d483179326c7822160c6beb8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Handbuch erfahren Sie, wie Sie COVID-19 in einem speziell ausgewählten Datensatz mithilfe von Keras, TensorFlow und Deep Learning automatisch erkennen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie die meisten Menschen auf der Welt bin ich aufrichtig besorgt über COVID-19. </font><font style="vertical-align: inherit;">Ich bemerke, dass ich ständig meine persönliche Gesundheit analysiere und vermute, dass ich bereits infiziert bin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je mehr ich mir darüber Sorgen mache, desto schmerzhafter manifestiert sich eine schmerzhafte Kombination von echten Symptomen mit Hypochondrien:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich bin morgens aufgewacht und fühle mich ein wenig überwältigt.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als ich aus dem Bett kam, hatte ich bereits ein Leck in der Nase (obwohl </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jetzt bekannt ist,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass eine laufende Nase kein Symptom für COVID-19 ist).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Während er im Badezimmer eine Serviette nahm, hustete er auch.</font></font></li>
</ul><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anfangs habe ich dem nicht viel Bedeutung beigemessen - ich bin allergisch gegen Pollen und wegen des warmen Wetters an der Ostküste kam der Frühling Anfang dieses Jahres. Höchstwahrscheinlich ist meine Allergie gerade ausgebrochen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber die Symptome besserten sich nicht den ganzen Tag. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und hier sitze ich hier und schreibe dieses Handbuch mit einem Thermometer im Mund; und der Blick nach unten zeigt 37,4 ° C. Die Temperatur ist höher als meine üblichen 36,3 ° C. Alles über 37,2 ° C, ich betrachte bereits ein leichtes Fieber. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Husten und ein bisschen Fieber? Es könnte COVID-19 sein ... oder nur meine Allergie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist unmöglich, es ohne einen Test herauszufinden, und genau diese „Unwissenheit“ macht diese Situation für das geistige Gleichgewicht so gefährlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Menschen gibt es nichts Schrecklicheres als das Unbekannte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotz aller Ängste versuche ich, sie auf rationale Weise loszuwerden. Ich bin über dreißig, in guter Verfassung, mein Immunsystem ist sehr stark. Ich werde in die Quarantäne gehen (nur für den Fall), ich werde mich ausruhen und mich normal erholen. COVID-19 macht mir keine Angst vor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meiner persönlichen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gesundheit (zumindest sage ich mir das immer wieder). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mache mir jedoch Sorgen um meine älteren Verwandten, einschließlich derer, die an chronischen Krankheiten leiden, und derer, die in einem Pflegeheim oder Krankenhaus sind. Sie sind verletzlich und es wird wirklich traurig sein, wenn wir sie aufgrund dieser Infektion verlieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um nicht untätig zu sitzen und nicht der Schwäche zu erliegen (sei es Allergie, COVID-19 oder nur Angst), habe ich beschlossen, das zu tun, was ich am besten kann -</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dienen Sie der gesamten Community von Machine Vision und Deep Learning, indem Sie Code schreiben, Experimente durchführen und anderen beibringen, wie man Computer Vision und Deep Learning in praktischen, realen Anwendungen einsetzt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um ehrlich zu sein, ist dies jedoch nicht der wissenschaftlichste Artikel, den ich jemals geschrieben habe. </font><font style="vertical-align: inherit;">In der Tat weit von den meisten. </font><font style="vertical-align: inherit;">Die verwendeten Methoden und Datensätze verdienen keine Veröffentlichung. </font><font style="vertical-align: inherit;">Aber sie können der Ausgangspunkt für diejenigen sein, die helfen wollen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber ich möchte alles in meiner Macht stehende tun. </font><font style="vertical-align: inherit;">Dieser Artikel ist einfach mein Weg, um schwierige Zeiten mental zu überwinden und gleichzeitig anderen in einer ähnlichen Situation zu helfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe du verstehst mich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der heutigen Lektion werden wir Folgendes tun:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden eine Reihe offener Daten aus Fluorogrammen von Patienten mit einem positiven COVID-19-Test sammeln.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir sammeln eine Auswahl von Fluorogrammen gesunder Patienten.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden das Faltungs-Neuronale Netzwerk trainieren, um COVID-19 in den Bildern aus dem erstellten Satz automatisch zu erkennen.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir werden die Ergebnisse aus pädagogischer Sicht bewerten.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Haftungsausschluss: Ich habe bereits angedeutet, aber ich werde es unverblümt sagen. </font><font style="vertical-align: inherit;">Die Methoden und Techniken in diesem Artikel dienen nur zu Bildungszwecken. </font><font style="vertical-align: inherit;">Dies ist keine echte wissenschaftliche Studie und wird nicht in einer Zeitschrift veröffentlicht. </font><font style="vertical-align: inherit;">Der Artikel richtet sich an Leser, die an (1) Computer Vision / Deep Learning interessiert sind und mit praktischen Methoden lernen möchten und (2) sich über aktuelle Ereignisse Gedanken machen. </font><font style="vertical-align: inherit;">Ich bitte Sie, sich auf diese Weise darauf zu beziehen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19 auf Fluorogrammen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im ersten Teil diskutieren wir, wie COVID-19 auf Röntgenaufnahmen des Brustkorbs nachgewiesen werden kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann betrachten Sie unseren Datensatz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anschließend zeige ich Ihnen, wie Sie das Deep-Learning-Modell mit Keras und TensorFlow trainieren, um COVID-19 in unserem Bilddatensatz zu definieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meine Aufgabe ist es, Sie zu inspirieren und zu zeigen, dass das Studium von Computer Vision / Deep Learning und die anschließende Anwendung dieses Wissens im medizinischen Bereich einen großen Einfluss auf die Welt haben können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einfach ausgedrückt: Sie benötigen keinen medizinischen Abschluss, um zur Medizin beizutragen. Deep-Learning-Spezialisten, die eng mit Ärzten und Gesundheitsdienstleistern zusammenarbeiten, können komplexe Probleme lösen, Leben retten und die Welt zu einem besseren Ort machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieser Leitfaden inspiriert Sie dazu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trotz alledem </font><font style="vertical-align: inherit;">
sind wissenschaftliche Zeitschriften und Expertenbewertungssysteme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voller</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Materialien mit Prognosemodellen von COVID-19 von zweifelhafter Qualität. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitte nehmen Sie den Code / das Modell nicht aus diesem Artikel und senden Sie ihn nicht an die Zeitschrift oder stellen Sie ihn auf wissenschaftlichen Websites öffentlich zugänglich - Sie werden nur etwas Lärm hinzufügen.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn Sie diesen Artikel (oder einen anderen COVID-19-Artikel aus dem Internet) für Ihre eigenen Recherchen verwenden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">möchten, lesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie außerdem die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TRIPOD-Regeln zum Erstellen von Prognoseberichtsmodellen</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie wahrscheinlich wissen, führt der Einsatz von KI in der Medizin zu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehr realen Konsequenzen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Veröffentlichen oder verwenden Sie solche Modelle nur nach enger Absprache mit einem medizinischen Experten.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f74/c2b/450/f74c2b450fa7308154dca67ad2692309.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. 1. Ein Beispiel eines Fluorogramms eines Patienten mit einem positiven COVID-19-Test. Mit Keras und TensorFlow in solchen Bildern kann der Klassifikator auf die Erkennung von COVID-19 trainiert werden. COVID-19-</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tests sind derzeit schwer zu finden -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sie reichen einfach nicht aus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und können nicht schnell genug durchgeführt werden, was zu Panik führt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es eine Panik gibt, nutzen einige abscheuliche Leute dies und</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verkaufen gefälschte Testkits COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um Opfer in sozialen Netzwerken und Instant Messenger zu finden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Anzahl der COVID-19-Testkits begrenzt ist, sollten Sie sich auf andere Diagnosemethoden verlassen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ärzte verlassen sich häufig auf Röntgenaufnahmen des Brustkorbs (allgemein als Fluorogramme bezeichnet), um Lungenentzündung, Lungenentzündung, Abszesse und / oder vergrößerte Lymphknoten zu diagnostizieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19 greift das Epithel der Atemwege an und Röntgenstrahlen helfen bei der Untersuchung des Lungenzustands des Patienten. Röntgengeräte sind in den meisten Krankenhäusern installiert, daher ist es logisch, COVID-19 ohne spezielle Testkits mithilfe der Fluorographie zu testen. Der Nachteil ist, dass eine solche Analyse einen Spezialisten für Radiologie erfordert und viel Zeit in Anspruch nimmt. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daher wird die Entwicklung eines automatisierten Systems sehr wertvoll sein, um die wertvolle Zeit von Medizinern auf der ganzen Welt zu sparen. </font></font></b><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Einige neuere Veröffentlichungen legen nahe, dass die Computertomographie für die Diagnose von COVID-19 besser geeignet ist. In dieser Lektion arbeiten wir jedoch nur mit Fluorogrammen.</font></font></i> <br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datensatz</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/855/213/e50/855213e505792a063cef8c831820dd7a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. </font><font style="vertical-align: inherit;">2. Links sind positive Proben (von infizierten Patienten) und rechts sind negative Proben. </font><font style="vertical-align: inherit;">Diese Bilder werden verwendet, um ein Modell zu trainieren, um das Vorhandensein einer Krankheit automatisch vorherzusagen.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Unser Datensatz wurde von</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , einem Doktoranden an der Universität von Montreal, zusammengestellt. </font><font style="vertical-align: inherit;">Anfang März begann er, Fluorogramme von Patienten mit COVID-19, MERS, SARS und SARS zu sammeln und im</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Repository auf GitHub zu veröffentlichen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir müssen eine Datei aus dem Repository herunterladen</font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Zeilen auswählen, in denen sie angegeben ist</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positives Ergebnis bei COVID-19.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art der Lunge 'posterior-anterior' (PA). </font><font style="vertical-align: inherit;">Soweit ich weiß, ist dies die Art von Bild, die in „gesunden“ Bildern verwendet wird.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei positiven Fällen von COVID-19 wurden insgesamt 25 Fluorogramme gefunden (Abb. 2, links). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für gesunde Patienten habe ich den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuggle-Datensatz (Lungenentzündung) verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und 25 Bilder von gesunden Patienten ausgewählt (Abb. 2, rechts). </font><font style="vertical-align: inherit;">Dieser Datensatz weist eine Reihe von Problemen auf, nämlich verrauschte / falsche Beschriftungen, reicht jedoch für eine konzeptionelle Überprüfung des automatischen Detektors COVID-19 aus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projektstruktur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Bereich Downloads meiner Website können Sie Ihre E-Mail-Adresse eingeben und einen Link zum Archiv mit Code, Skripten und anderen Dateien für dieses Projekt finden. </font><font style="vertical-align: inherit;">Extrahieren Sie die Dateien und Sie sehen die Verzeichnisstruktur:</font></font><br>
<br>
<pre><code class="bash hljs">$ tree --dirsfirst --filelimit 10<font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [25 entries]<font></font>
│   └── normal [25 entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
3 directories, 5 files</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fluorogramme befinden sich in einem Verzeichnis, </font></font><code>dataset/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dem zwei Datenklassen in Verzeichnisse </font></font><code>covid/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">unterteilt sind </font></font><code>normal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beide Skripte werden zum Erstellen eines Datensatzes vorgestellt, aber wir werden sie heute nicht berücksichtigen. </font><font style="vertical-align: inherit;">Betrachten Sie stattdessen ein Skript </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, das unseren COVID-19-Detektor lehrt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren wir mit dem Aufbau eines neuronalen Faltungsnetzwerks fort. </font><font style="vertical-align: inherit;">Öffnen Sie die Datei </font></font><code>train_covid19.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und fügen Sie den folgenden Code ein:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Skript verwendet eine Reihe von Deep-Learning-Bibliotheken von TensorFlow 2.0 und Keras. </font><font style="vertical-align: inherit;">Darüber hinaus verwenden wir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die Standard-Python-Bibliothek für maschinelles Lernen, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">grafische</font></a><font style="vertical-align: inherit;"> Darstellung und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Laden und Verarbeiten von Bildern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Befolgen Sie zum Installieren von TensorFlow 2.0 (einschließlich der entsprechenden Scikit-Learn-, OpenCV- und Matplotlib-Bibliotheken) einfach meine Anweisungen für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes analysieren wir die Befehlszeilenargumente und initialisieren die Hyperparameter:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
	help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
	help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Drei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehlszeilenargumente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Pfad zum Eingabedatensatz</font></font><br>
</li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Ein optionaler Pfad zum Exit-Zeitplan für Ihre Lernhistorie. </font><font style="vertical-align: inherit;">Sofern nicht anders angegeben, ist die Standardeinstellung</font></font><code>plot.png</code><br>
</li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: optionaler Pfad zum Ausgabemodell; </font><font style="vertical-align: inherit;">Default</font></font><code>covid19.model</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die nächsten Zeilen initialisieren die anfängliche Lerngeschwindigkeit, die Anzahl der Epochen und die Hyperparameter der Paketgröße. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können wir die Fluorogramme herunterladen und vorverarbeiten:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
	<span class="hljs-comment"># extract the class label from the filename</span>
	label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]
	<span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
	<span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
	image = cv2.imread(imagePath)<font></font>
	image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
	image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))
	<span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
	data.append(image)<font></font>
	labels.append(label)<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span>
labels = np.array(labels)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Daten zu laden, erfassen wir alle Pfade zu den Bildern im Katalog </font></font><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dann für jeden </font></font><code>imagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir rufen die Klassenbezeichnung ( </font></font><code>covid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">vom Pfad ab </font><font style="vertical-align: inherit;">.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir laden es </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und verarbeiten es vor, konvertieren es in RGB und ändern die Größe auf 224 × 224 Pixel, damit es für das neuronale Netzwerk bereit ist.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktualisieren von Listen </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skalieren Sie dann die Pixelintensität auf den Bereich [0, 1] und konvertieren Sie die Daten und Beschriftungen in das NumPy-Array-Format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes führen wir eine direkte Codierung </font></font><code>labels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch, indem </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">die Daten in Sätze für Training / Test aufteilen:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels)<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
	test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
	rotation_range=<span class="hljs-number">15</span>,<font></font>
	fill_mode=<span class="hljs-string">"nearest"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Direkte Codierung bedeutet, dass die Daten in das folgende Format konvertiert werden:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jedes codierte Label besteht aus einem Array mit zwei Elementen: 'hot' (1) oder 'not' (0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den folgenden Zeilen werden unsere Daten getrennt, sodass 80% für Schulungen und 20% für Tests übrig bleiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um sicherzustellen, dass das Modell verallgemeinert ist, erweitern wir die Daten, indem wir das Bild so einstellen, dass es zufällig um 15 ° im oder gegen den Uhrzeigersinn gedreht wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die letzten drei Zeilen initialisieren das Datenerweiterungsgeneratorobjekt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialisieren Sie nun unser VGGNet-Modell und optimieren Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
	input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
	layer.trainable = <span class="hljs-literal">False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die ersten beiden Zeilen erstellen eine Instanz des VGG16-Netzwerks mit Gewichten, die zuvor in ImageNet trainiert wurden, ohne die vollständig verbundene Schicht (FC) zu berühren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann erstellen wir eine neue vollständig verbundene Ebene, die aus Ebenen besteht </font></font><code>POOL =&gt; FC = SOFTMAX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und fügen sie über VGG16 hinzu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann frieren wir die Gewichte </font></font><code>CONV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für VGG16 ein, sodass </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die FC-Schicht </font><font style="vertical-align: inherit;">trainiert wird </font><font style="vertical-align: inherit;">. Damit ist die Einrichtung abgeschlossen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können wir unser Deep-Learning-Modell für COVID-19 kompilieren und trainieren:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
	metrics=[<span class="hljs-string">"accuracy"</span>])
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
	trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
	steps_per_epoch=len(trainX) // BS,<font></font>
	validation_data=(testX, testY),<font></font>
	validation_steps=len(testX) // BS,<font></font>
	epochs=EPOCHS)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die ersten Zeilen kompilieren das neuronale Netzwerk mit der Option, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Lerngeschwindigkeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und den Optimierer </font><font style="vertical-align: inherit;">zu </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">reduzieren</font></a></font><code>Adam</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Da dies ein Zwei-Klassen-Problem ist, verwenden wir </font></font><code>"binary_crossentropy"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eher </font><font style="vertical-align: inherit;">Verlust </font><font style="vertical-align: inherit;">als Kreuzentropie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Lernprozess zu starten, rufen wir die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fit_generator </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">in Keras auf</font></a><font style="vertical-align: inherit;"> und leiten die Fluorogramme durch unser Datenerweiterungsobjekt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir bewerten das Modell:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
	target_names=lb.classes_))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Auswertung erstellen wir zunächst Prognosen für den Testsatz, wobei die Prognoseindizes beibehalten werden. </font><font style="vertical-align: inherit;">Anschließend erstellen und zeigen wir mit scikit-learn einen Klassifizierungsbericht an, in dem eine solche Hilfsfunktion vorhanden ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes berechnen wir die Matrix der Ungenauigkeiten für die weitere statistische Auswertung:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier machen wir folgendes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir erzeugen eine Matrix von Ungenauigkeiten.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit seiner Hilfe berechnen wir Genauigkeit, Empfindlichkeit und Spezifität, indem wir alle diese Metriken drucken.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Selbsttest erstellen wir ein Diagramm mit einer Historie der Trainingsgenauigkeit und -verluste und geben es in eine Grafikdatei aus:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speichern Sie abschließend das Klassifikatormodell </font></font><code>tf.keras</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf der Festplatte:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detektortraining</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Öffnen Sie nach dem Herunterladen aller Dateien aus dem Archiv mit den oben genannten Quellen und Skripten die Konsole und führen Sie den folgenden Befehl aus, um den Detektor zu trainieren:</font></font><br>
<br>
<pre><code class="bash hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch 1/25<font></font>
5/5 [==============================] - 20s 4s/step - loss: 0.7169 - accuracy: 0.6000 - val_loss: 0.6590 - val_accuracy: 0.5000<font></font>
Epoch 2/25<font></font>
5/5 [==============================] - 0s 86ms/step - loss: 0.8088 - accuracy: 0.4250 - val_loss: 0.6112 - val_accuracy: 0.9000<font></font>
Epoch 3/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.6809 - accuracy: 0.5500 - val_loss: 0.6054 - val_accuracy: 0.5000<font></font>
Epoch 4/25<font></font>
5/5 [==============================] - 1s 100ms/step - loss: 0.6723 - accuracy: 0.6000 - val_loss: 0.5771 - val_accuracy: 0.6000<font></font>
...<font></font>
Epoch 22/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3271 - accuracy: 0.9250 - val_loss: 0.2902 - val_accuracy: 0.9000<font></font>
Epoch 23/25<font></font>
5/5 [==============================] - 0s 99ms/step - loss: 0.3634 - accuracy: 0.9250 - val_loss: 0.2690 - val_accuracy: 0.9000<font></font>
Epoch 24/25<font></font>
5/5 [==============================] - 27s 5s/step - loss: 0.3175 - accuracy: 0.9250 - val_loss: 0.2395 - val_accuracy: 0.9000<font></font>
Epoch 25/25<font></font>
5/5 [==============================] - 1s 101ms/step - loss: 0.3655 - accuracy: 0.8250 - val_loss: 0.2522 - val_accuracy: 0.9000<font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
       covid       0.83      1.00      0.91         5<font></font>
      normal       1.00      0.80      0.89         5<font></font>
    accuracy                           0.90        10<font></font>
   macro avg       0.92      0.90      0.90        10<font></font>
weighted avg       0.92      0.90      0.90        10<font></font>
[[5 0]<font></font>
 [1 4]]<font></font>
acc: 0.9000<font></font>
sensitivity: 1.0000<font></font>
specificity: 0.8000<font></font>
[INFO] saving COVID-19 detector model...</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatische Diagnose von COVID-19 nach den Ergebnissen der Fluorographie</font></font></h2><br>
<i><b>  :</b>      ,  «»   COVID-19.        .              ,        ,    ,    (  ,        ).  ,  /       COVID-19.</i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie aus den obigen Ergebnissen ersichtlich ist, hat unser automatischer Detektor eine Genauigkeit von etwa 90-92% bei einem vorhandenen Probensatz. </font><font style="vertical-align: inherit;">Diese Bewertung basiert nur auf der Bildanalyse. </font><font style="vertical-align: inherit;">Während des Trainings wurden keine Daten mehr verwendet, einschließlich geografischer Lage, Bevölkerungsdichte usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Sensitivität betrug 100% und die Spezifität 80%, was bedeutet:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wirklich infizierte Patienten werden in 100% der Fälle erkannt.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesunde Patienten werden mit einer Wahrscheinlichkeit von 80% als gesund anerkannt.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie die Grafik zur Trainingshistorie zeigt, ist unser Netzwerk trotz eines </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehr begrenzten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datensatzes </font><font style="vertical-align: inherit;">nicht zu umgeschult </font><font style="vertical-align: inherit;">: Die </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cf5/53a/b9f/cf553ab9faf7bf72c58b885e016809c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fähigkeit, COVID-19 mit absoluter Genauigkeit zu erkennen, ist großartig, obwohl die Rate falsch positiver Ergebnisse ein wenig besorgniserregend ist, da viele gesunde Menschen an gesendet werden Quarantäne bei wirklich infizierten Patienten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Gleichgewicht zwischen Sensitivität und Spezifität ist bei medizinischen Anwendungen unglaublich schwierig, insbesondere bei Infektionskrankheiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es um Computer Vision und tiefes Training in der Medizin geht, sollten Sie immer daran denken, dass unsere Vorhersagemodelle sehr reale Konsequenzen haben können - eine verpasste Diagnose kann einen Lebensunterhalt kosten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch diese Ergebnisse werden nur zu Bildungszwecken gesammelt. </font><font style="vertical-align: inherit;">Dieser Artikel und die dazugehörigen Ergebnisse sind nicht für die Veröffentlichung in einer wissenschaftlichen Zeitschrift vorgesehen und entsprechen nicht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den TRIPOD-Regeln für die Erstellung von Prognosemodellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einschränkungen, Verbesserungen und zukünftige Arbeit</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/cc9/625/a5c/cc9625a5cdbe14b0b74d42eed54945cc.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feige. 4. Derzeit leiden Spezialisten für künstliche Intelligenz (KI) und Deep Learning unter einem Mangel an Qualitätsdaten für das effektive Training von automatischen COVID-19-Erkennungssystemen für Bilder ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bildquelle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eine der Haupteinschränkungen für die Erstellung solcher Systeme sind Daten. Wir haben einfach nicht genug (zuverlässige) Daten, um den COVID-19-Detektor zu trainieren. Krankenhäuser sind mit COVID-19-Patienten überfüllt, aber aufgrund ihrer Rechte und ihrer Privatsphäre wird es</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> noch schwieriger</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qualitativ hochwertige medizinische Bilder rechtzeitig zu sammeln.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich nehme an, dass das Problem in den nächsten 12 bis 18 Monaten gelöst sein wird, aber im Moment sind wir zufrieden mit dem, was wir haben. Ich habe mein Bestes getan (unter Berücksichtigung meiner aktuellen geistigen und körperlichen Verfassung), um einen Leitfaden für diejenigen zu erstellen, die daran interessiert sind, Computer Vision und tiefes Lernen im Kampf gegen COVID-19 unter Berücksichtigung von Zeit- und Ressourcenbeschränkungen einzusetzen. Aber ich muss Sie daran erinnern, dass ich kein medizinischer Experte bin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein echter COVID-19-Detektor muss strengen Tests durch ausgebildete Mediziner unterzogen werden, die Hand in Hand mit erfahrenen Deep-Learning-Praktikern arbeiten. Die hier beschriebene Methode ist natürlich nicht für den praktischen Gebrauch geeignet und nur für Bildungszwecke gedacht. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Außerdem müssen wir uns fragen, was dieses Modell tatsächlich „lernt“.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wie ich schon sagte</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">dem Grad-CAM-Leitfaden der</font></a><font style="vertical-align: inherit;"> letzten Woche ist es durchaus möglich, dass unser Modell Muster untersucht, die nicht mit COVID-19 zusammenhängen, sondern lediglich Variationen zwischen zwei Datensätzen sind (d. h. zwischen Patienten mit und ohne COVID-19). Um die Ergebnisse zu bestätigen, sind gründliche Tests und fachkundige Unterstützung erforderlich. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schließlich werden zukünftige (und beste) Detektoren multimodal sein.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jetzt betrachten wir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bilder (zum Beispiel Röntgenstrahlen). Die besten automatischen COVID-19-Detektoren sollten mehrere Datenquellen verwenden, nicht nur Bilder, einschließlich Vitalindikatoren für Patienten, Bevölkerungsdichte, geografische Lage usw. Bilder allein reichen für diese Art der Anwendung normalerweise nicht aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieser Leitfaden dient als Ausgangspunkt für alle, die sich für die automatische Erkennung von COVID-19 mithilfe von Computer Vision und Deep Learning interessieren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was weiter?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Normalerweise beende ich meine Blog-Artikel mit einer Empfehlung aus einem meiner Bücher oder Kurse, damit Sie mehr über die Verwendung von Computer Vision und Deep Learning erfahren können. </font><font style="vertical-align: inherit;">Aus Respekt vor der Schwere des Coronavirus werde ich dies nicht tun - jetzt ist nicht die Zeit oder der Ort. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stattdessen werde ich sagen, dass wir uns jetzt in einer sehr schrecklichen Lebensphase befinden. </font><font style="vertical-align: inherit;">Wie die Jahreszeiten wird alles vergehen, aber jetzt müssen Sie sich hocken und sich auf den kalten Winter vorbereiten - es ist wahrscheinlich, dass das Schlimmste noch bevorsteht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe mehrere Briefe von PyImageSearch-Lesern erhalten, die diese Ausfallzeit nutzen möchten, um Computer Vision und Deep Learning zu studieren, anstatt in ihren Häusern verrückt zu werden. </font><font style="vertical-align: inherit;">Dies ist ein nützlicher Gedanke.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Handbuch haben Sie gelernt, wie Sie mit Keras und TensorFlow den automatischen Detektor COVID-19 an einem Fluorogrammsatz trainieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt (noch) keine hochwertigen, von Experten geprüften Bilddatensätze für COVID-19, daher mussten wir mit dem arbeiten, was wir hatten, nämlich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joseph Cohens Repository auf GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben 25 Bilder aus dem Cohen-Datensatz ausgewählt, wobei nur die Ansicht von hinten nach vorne (PA) und eine bestätigte Diagnose ausgewählt wurden.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dann wurden 25 Bilder von gesunden Patienten aus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem Datensatz mit Kaggle-Fluorographiebildern (Lungenentzündung) ausgewählt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben Keras und TensorFlow verwendet, um den COVID-19-Detektor zu trainieren, der eine Genauigkeit von 90-92%, eine Empfindlichkeit von 100% und eine Spezifität von 80% des Testsatzes aufweist (angesichts unseres begrenzten Datensatzes). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beachten Sie, dass der beschriebene COVID-19-Detektor nur zu Ausbildungszwecken dient.</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de497612/index.html">Die Geschichte, wie mich die unsichtbare Hand des Marktes an einen abgelegenen Ort brachte</a></li>
<li><a href="../de497614/index.html">Gedankenexperimente, Paradoxien und Grenzen der Logik // Wir sind zum Scheitern verurteilt # 2</a></li>
<li><a href="../de497616/index.html">Interview mit Alexander Makarov (Yii) über Opensource, Konferenzen und Yii</a></li>
<li><a href="../de497618/index.html">Umsetzung des Konzepts des hochsicheren Fernzugriffs</a></li>
<li><a href="../de497620/index.html">Schreiben eines Chrome-Telegramm-Alarm-Plugins</a></li>
<li><a href="../de497624/index.html">Digital Banking Campus - Ergebnisse des Praktikumsprogramms</a></li>
<li><a href="../de497628/index.html">Wie man viel Zeit mit einem kleinen Skript oder dem Verlauf einer Pull-Anfrage verbringt</a></li>
<li><a href="../de497632/index.html">Web HighLoad - wie wir den Datenverkehr von Zehntausenden von Domains verwalten</a></li>
<li><a href="../de497634/index.html">Regenbogenfarben sind die besten Freunde der Mathematiker</a></li>
<li><a href="../de497636/index.html">Wie sich der Mangel an Rechenleistung auf Seeschlachten in Weltkriegen auswirkte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>