<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôÇÔ∏è üëç üëàüèº Raiz de confian√ßa Intel x86: perda de confian√ßa ü§ôüèø üë¥üèª üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagem: shutterstock
 
 Chegou o momento em que os arquitetos, engenheiros e especialistas em seguran√ßa da Intel podem ter mais medo: foi encontrado u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Raiz de confian√ßa Intel x86: perda de confian√ßa</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/490730/"><img src="https://habrastorage.org/webt/hg/oy/c4/hgoyc4kd5xlruwd43mkczw6v0ui.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagem: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shutterstock</font></font></a></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Chegou o momento em que os arquitetos, engenheiros e especialistas em seguran√ßa da Intel podem ter mais medo: foi encontrado um erro na √°rea de mem√≥ria n√£o grav√°vel (ROM) do Intel Converged Security and Management Engine, e esse erro lan√ßa d√∫vidas sobre todos os esfor√ßos da empresa para criar a raiz da confian√ßa e a base da seguran√ßa em suas plataformas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o ponto aqui n√£o √© nem que os erros do firmware (firmware), que s√£o "conectados" na mem√≥ria interna da ROM ROM dos microprocessadores e chipsets Mask, n√£o podem ser corrigidos, mas que o erro encontrado destr√≥i a cadeia de confian√ßa de toda a plataforma como um todo, permitindo comprometer sua base de hardware.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os especialistas da Positive Technologies encontraram um erro de hardware no hardware Intel, bem como um erro no firmware Intel CSME, que se manifesta em um est√°gio muito inicial deste subsistema, na ROM de inicializa√ß√£o (ROM de inicializa√ß√£o). Sabe-se que o Intel CSME fornece autentica√ß√£o inicial de um sistema baseado em chips Intel, baixando e verificando todo o restante do firmware das plataformas modernas. Por exemplo, o Intel CSME, interagindo com o microc√≥digo da CPU, garante a autenticidade do firmware UEFI BIOS via tecnologia BootGuard. Al√©m disso, o Intel CSME baixa e verifica o firmware do Power Management Controller, que controla a fonte de voltagem para cada unidade de hardware nos chips Intel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais importante, por√©m, √© o Intel CSME que √© respons√°vel pela base criptogr√°fica de tais tecnologias de prote√ß√£o de hardware desenvolvidas pela Intel e usadas em todos os lugares, como DRM, fTPM e Intel Identity Protection. O firmware Intel CSME implementa um sistema de certifica√ß√£o remota para sistemas confi√°veis ‚Äã‚Äãchamado EPID (ID de privacidade aprimorada), que permite identificar de forma exclusiva e an√¥nima cada inst√¢ncia espec√≠fica de um sistema de computa√ß√£o (computador), encontrando muitos aplicativos √∫teis, como proteger conte√∫do digital, garantir a seguran√ßa das transa√ß√µes financeiras, certifica√ß√£o da Internet das coisas. Al√©m disso, o firmware do Intel CSME possui um m√≥dulo de software TPM que permite us√°-lo para armazenar chaves de criptografia sem um chip TPM adicional, que est√° longe de qualquer computador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E a Intel tentou tornar essa raiz de confian√ßa o mais segura poss√≠vel. O sistema de seguran√ßa das plataformas Intel √© projetado de tal maneira que mesmo um erro arbitr√°rio de execu√ß√£o de c√≥digo em qualquer um dos m√≥dulos de firmware Intel CSME n√£o corre o risco de perder a chave raiz de seguran√ßa (tamb√©m conhecida como Chipset Key), mas apenas p√µe em risco as fun√ß√µes espec√≠ficas pelas quais o m√≥dulo vulner√°vel √© respons√°vel quando Isso permite reduzir facilmente o risco alterando as chaves de criptografia usando o mecanismo de n√∫mero de vers√£o seguro do SVN. Isso foi claramente demonstrado em 2017, quando um erro de execu√ß√£o arbitr√°ria de c√≥digo foi encontrado no m√≥dulo de firmware BringUP (bup), descrito na Intel SA-00086. Em seguida, a Intel simplesmente executou a regenera√ß√£o de chaves aumentando o SVN e, assim, facilmente evitou o risco de comprometer as tecnologias baseadas em EPID.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, por√©m, n√£o existem sistemas de seguran√ßa perfeitos e, como qualquer outro, a arquitetura de seguran√ßa da Intel tem seu calcanhar de Aquiles - ROM inicializ√°vel. Um erro na ROM nos est√°gios iniciais de execu√ß√£o permite realmente controlar a leitura da chave do chipset e a gera√ß√£o de todas as outras chaves de criptografia. Uma dessas chaves √© usada para criptografar uma matriz de dados ICVB (Integrity Control Value Blob). Com essa chave, voc√™ pode falsificar o c√≥digo de qualquer m√≥dulo de firmware Intel CSME - e o sistema de autentica√ß√£o n√£o poder√° reconhec√™-lo. Isso equivale a vazar a chave privada da assinatura digital de firmware Intel CSME, mas para esta plataforma espec√≠fica.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento, a situa√ß√£o com o EPID √© atenuada pelo fato de a Chipset Key estar armazenada dentro da plataforma (em mem√≥ria OTP especial, One-Time Programmable Memory) em um formato criptografado e para comprometer completamente o EPID, tamb√©m √© necess√°rio extrair a chave de hardware na qual o Chipset Key est√° armazenado, criptografado em armazenamento SKS especial (Secure Key Storage). Mas essa chave n√£o √© exclusiva da plataforma, mas √© uma para toda a gera√ß√£o de chipsets Intel. E como um erro encontrado na ROM permite interceptar a execu√ß√£o do c√≥digo at√© bloquear o mecanismo de gera√ß√£o de chave de hardware no SKS, e o erro na pr√≥pria ROM n√£o pode ser corrigido, acreditamos que isso √© apenas uma quest√£o de tempo - quando essa chave ser√° extra√≠da. E ent√£o o caos completo ocorrer√°: a identifica√ß√£o do hardware ser√° falsificada, o conte√∫do digital ser√° extra√≠do, as informa√ß√µes criptografadas da m√≠dia permanente ser√£o descriptografadas.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, os especialistas da Positive Technologies encontraram um erro na ROM de inicializa√ß√£o do Intel CSME em todos os chipsets e SoC da Intel lan√ßados atualmente, exceto Ice Point (10¬™ gera√ß√£o de processadores). Este erro permite extrair a chave do chipset, bem como manipular parte da chave de hardware e o processo de sua gera√ß√£o, n√£o permitindo, no entanto, no momento, obter diretamente seu componente de hardware (conectado ao SKS). Al√©m disso, esse erro na ROM permite que voc√™ organize a execu√ß√£o arbitr√°ria de c√≥digo no n√≠vel de privil√©gio zero do Intel CSME. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais detalhadamente, descreveremos os detalhes t√©cnicos em um white paper completo dedicado a esse erro, que planejamos publicar um pouco mais tarde. Observe que, depois que nossos especialistas entraram em contato com o Intel PSIRT com um relat√≥rio sobre esse erro, a Intel informou que o erro j√° era conhecido ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-0090</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) A Intel entende que √© imposs√≠vel corrigir um erro na ROM em equipamentos j√° lan√ßados e, portanto, eles simplesmente bloqueiam todas as formas poss√≠veis de opera√ß√£o. O patch para o CVE-2019-0090 corrige apenas um dos poss√≠veis vetores de ataque - por meio do hub de sensores integrado (Integrated Sensors Hub, ISH). Acreditamos que existem potencialmente muitas maneiras de explorar essa vulnerabilidade na ROM. Alguns deles podem exigir acesso local, outros f√≠sicos. Para abrir um pouco o v√©u do segredo, digamos algumas palavras sobre a pr√≥pria vulnerabilidade:</font></font><br>
<br>
<ol>
<li>    ,    boot ROM:    IOMMU   MISA (Minute IA System Agent),    SRAM ( ) Intel CSME   DMA-, <b>  </b>.  ,     ,     .</li>
<li> Intel CSME  boot ROM     (page directory),          IOMMU.  ,  ,    SRAM    DMA-   (DMA    CSME,      )       SRAM      Intel CSME.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os par√¢metros MISA IOMMU s√£o redefinidos quando a redefini√ß√£o √© executada para o Intel CSME, que ap√≥s a redefini√ß√£o inicia a execu√ß√£o novamente a partir da ROM de inicializa√ß√£o.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, qualquer dispositivo de plataforma que possa executar transa√ß√µes de DMA na mem√≥ria est√°tica do Intel CSME e, ao mesmo tempo, reiniciar o Intel CSME (ou apenas aguardar a ativa√ß√£o do Intel CSME) pode modificar as tabelas de sistema das p√°ginas do Intel CSME e, portanto, interceptar execu√ß√£o. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postado por Mark Ermolov, Especialista L√≠der, Divis√£o de Pesquisa em Tecnologias de SO e Solu√ß√µes de Hardware, Positive Technologies.</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt490718/index.html">O que √© o "c√≥digo limpo" em 2020?</a></li>
<li><a href="../pt490720/index.html">Motor! ou O que √© f√≠sica de jogo</a></li>
<li><a href="../pt490722/index.html">F√©rias de g√™nero em TI. Como observar</a></li>
<li><a href="../pt490726/index.html">Autentica√ß√£o em equipamentos de rede por SSH usando chaves p√∫blicas</a></li>
<li><a href="../pt490728/index.html">Semana 10 de seguran√ßa: Confer√™ncia RSA e conscientiza√ß√£o sobre seguran√ßa cibern√©tica</a></li>
<li><a href="../pt490732/index.html">Reconhecimento de Fala: Um Curso Introdut√≥rio Muito Curto</a></li>
<li><a href="../pt490734/index.html">Ovos de P√°scoa nos mapas topogr√°ficos da Su√≠√ßa</a></li>
<li><a href="../pt490736/index.html">9 ferramentas claras para aprender e aprimorar o vocabul√°rio em ingl√™s</a></li>
<li><a href="../pt490738/index.html">Princ√≠pio de substitui√ß√£o de Lisk</a></li>
<li><a href="../pt490740/index.html">Deserte *** *** n√£o √© apenas randomiza√ß√£o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>