<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖🏾 🧙🏽 👩🏾‍💻 DIY DeepFake [パート1] 😻 📿 🚿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="インターネットのすべての喜びにもかかわらず、それは多くの不利な点を持っています、そして最もひどいの1つは誤解を招く人々です。クリックベイト、写真編集、虚偽のニュース-これらのツールはすべて、グローバルネットワーク上の一般ユーザーを欺くために積極的に使用されていますが、近年、DeepFakeと呼ばれる...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>DIY DeepFake [パート1]</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470323/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターネットのすべての喜びにもかかわらず、それは多くの不利な点を持っています、そして最もひどいの1つは誤解を招く人々です。クリックベイト、写真編集、虚偽のニュース-これらのツールはすべて、グローバルネットワーク上の一般ユーザーを欺くために積極的に使用されていますが、近年、DeepFakeと呼ばれる新しい潜在的に危険なツールが勢いを増しています。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近この技術に興味がありました。 「AI Conference 2018」での講演者の報告から初めて知りました。そこにビデオが表示され、オーディオ録音によると、アルゴリズムはバラクオバマの魅力を備えたビデオを生成しました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このテクノロジーを使用して作成された一連の動画へのリンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">結果は私に大いに刺激を与えました、そして私はこの技術に将来反対するためにこの技術をよりよく理解することにしました。</font><font style="vertical-align: inherit;">これを行うために、私はC＃でDeepFakeを書くことにしました。</font><font style="vertical-align: inherit;">その結果、こんな結果になりました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w1/bw/lp/w1bwlpk1ulrf5srvffcrow1i_gm.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読書を楽しむ！</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般原則</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
出発点は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトでした。</font><font style="vertical-align: inherit;">それから、ビデオの顔置換がどのように機能するかを正確に学びました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔写真のアップロード</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔抽出</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3Dマスクの作成 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビデオはフレーム化されています</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレーム内の顔のローカライズの面積が計算されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">角度と表情が計算されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回転と顔の表情を3Dモデルに転送する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レンダリング</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレーム上の実在の人物をレンダリングの結果で置き換える</font></font></li>
</ol><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FaceSwapプロジェクトの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
作業を示すビデオ</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yZRuSsyxvos" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作品を3つの部分に分けることにしました</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。1）3Dマスクを使用せずに、1つの写真の顔を別の写真の顔に置き換える</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）</font><font style="vertical-align: inherit;">3Dマスクを使用し</font><font style="vertical-align: inherit;">て置き換えを変更する</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）ビデオ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を</font><font style="vertical-align: inherit;">処理</font><font style="vertical-align: inherit;">する写真内の人物を置き換えると、次の点に分解できます。 ：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔写真のアップロード</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔を投影する画像を読み込んでいます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔抽出</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像2から取得した顔を画像1のアスペクト比にスケーリング</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像1の顔を画像2の顔に置き換える</font></font></li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ある画像を別の画像に</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
埋め込む私が最初に始めたことは、ある画像を別の画像に埋め込むことでした。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zad1.py</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトは、元のプロジェクトへの埋め込みを示すために使用され</font><font style="vertical-align: inherit;">ます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、目が手の中に埋め込まれた「eyeHandBlend.jpg」というファイルが作成されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hq/lh/kh/hqlhkh0sbobhcknnoazomtpucag.jpeg" width="309" alt="eyeHandBlend.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアルゴリズムは2つの部分で構成され、最初の部分は元の画像の顔のある領域から挿入する必要のある顔に色を転送します。</font><font style="vertical-align: inherit;">2番目の方法では、目的の面を含む画像のエッジを透明にし、画像の中心に近づくにつれて透明度を下げます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のプロジェクトの最初の部分を完全に転送しました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonコード</font></font></b><div class="spoiler_text"><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">colorTransfer</span>(<span class="hljs-params">src, dst, mask</span>):</span><font></font>
    transferredDst = np.copy(dst)<font></font>
    <span class="hljs-comment">#indeksy nie czarnych pikseli maski</span>
    maskIndices = np.where(mask != <span class="hljs-number">0</span>)
    <span class="hljs-comment">#src[maskIndices[0], maskIndices[1]] zwraca piksele w nie czarnym obszarze maski</span><font></font>
<font></font>
    maskedSrc = src[maskIndices[<span class="hljs-number">0</span>], maskIndices[<span class="hljs-number">1</span>]].astype(np.int32)<font></font>
    maskedDst = dst[maskIndices[<span class="hljs-number">0</span>], maskIndices[<span class="hljs-number">1</span>]].astype(np.int32)<font></font>
<font></font>
    meanSrc = np.mean(maskedSrc, axis=<span class="hljs-number">0</span>)<font></font>
    meanDst = np.mean(maskedDst, axis=<span class="hljs-number">0</span>)<font></font>
<font></font>
    maskedDst = maskedDst - meanDst<font></font>
    maskedDst = maskedDst + meanSrc<font></font>
    maskedDst = np.clip(maskedDst, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<font></font>
<font></font>
    transferredDst[maskIndices[<span class="hljs-number">0</span>], maskIndices[<span class="hljs-number">1</span>]] = maskedDst<font></font>
<font></font>
    <span class="hljs-keyword">return</span> transferredDst</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cに移植されたコード＃</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> Bitmap <span class="hljs-title">NewColor</span>(<span class="hljs-params">Bitmap src, Bitmap ins, Rectangle r</span>)</span><font></font>
        {<font></font>
<font></font>
            List&lt;Vector&gt; srV = <span class="hljs-keyword">new</span> List&lt;Vector&gt;();<font></font>
            List&lt;Vector&gt; inV = <span class="hljs-keyword">new</span> List&lt;Vector&gt;(); ;<font></font>
<font></font>
<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r.X; i &lt; r.X + r.Width<span class="hljs-number">-2</span>; i+=<span class="hljs-number">3</span>)<font></font>
            {<font></font>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = r.Y; j &lt; r.Y + r.Height<span class="hljs-number">-3</span>; j+=<span class="hljs-number">4</span>)<font></font>
                {<font></font>
                    Color color = src.GetPixel(i, j);<font></font>
                    Color color2 = ins.GetPixel(i, j);<font></font>
                    srV.Add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[] { color.R, color.G, color.B }.ToVector());<font></font>
                    inV.Add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">double</span>[] { color2.R, color2.G, color2.B }.ToVector());<font></font>
                }<font></font>
            }<font></font>
<font></font>
            Vector meanSrc = Vector.Mean(srV.ToArray()) / <span class="hljs-number">255</span>;<font></font>
            Vector meanInk = Vector.Mean(inV.ToArray()) / <span class="hljs-number">255</span>;<font></font>
<font></font>
            Tensor tensor = ImgConverter.BmpToTensor<font></font>
            (ins.Clone(r, PixelFormat.Format32bppArgb));<font></font>
<font></font>
<font></font>
            tensor = tensor.DivD(meanInk);<font></font>
            tensor = tensor.PlusD(meanSrc);<font></font>
<font></font>
            tensor = tensor.TransformTensor(x =&gt;<font></font>
            {<font></font>
                <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">0</span>) x = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">1</span>) x = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">return</span> x;<font></font>
            });<font></font>
<font></font>
            <span class="hljs-keyword">return</span> ImgConverter.TensorToBitmap(tensor);<font></font>
        }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像の中央部分よりもエッジをより透明にするために、アルファチャネルを計算するために、次の形式の動径基底関数が導入されました。</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mspace linebreak=&quot;newline&quot; /><mi>k</mi><mo>=</mo><mn>190</mn><mspace linebreak=&quot;newline&quot; /><mi>n</mi><mo>=</mo><mn>3</mn><mspace linebreak=&quot;newline&quot; /><mi>r</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mfrac><mrow><mi>i</mi><mo>&amp;#x2212;</mo><msub><mi>C</mi><mi>w</mi></msub></mrow><mrow><mn>1.2</mn><mo>&amp;#x22C5;</mo><mi>W</mi></mrow></mfrac><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mfrac><mrow><mi>j</mi><mo>&amp;#x2212;</mo><msub><mi>C</mi><mi>h</mi></msub></mrow><mi>H</mi></mfrac><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mspace linebreak=&quot;newline&quot; /><mi>&amp;#x03B1;</mi><mo>=</mo><mn>255</mn><mo>&amp;#x22C5;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>k</mi><mo>&amp;#x22C5;</mo><mi>r</mi></mrow><mi>n</mi></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.632ex" height="12.509ex" viewBox="0 -755.5 9744.4 5385.9" role="img" focusable="false" style="vertical-align: -10.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-3D" x="799" y="0"></use><g transform="translate(1855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-39" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-30" x="1001" y="0"></use></g><g transform="translate(0,-1200)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-3D" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-33" x="1934" y="0"></use></g><g transform="translate(0,-2709)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-28" x="1785" y="0"></use><g transform="translate(2175,0)"><g transform="translate(120,0)"><rect stroke="none" width="1963" height="60" x="0" y="220"></rect><g transform="translate(116,522)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-2212" x="345" y="0"></use><g transform="translate(794,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-77" x="1011" y="-213"></use></g></g><g transform="translate(60,-395)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-2E" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-32" x="779" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-22C5" x="1279" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-57" x="1558" y="0"></use></g></g></g><g transform="translate(4378,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-32" x="550" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-2B" x="5443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-28" x="6444" y="0"></use><g transform="translate(6833,0)"><g transform="translate(120,0)"><rect stroke="none" width="1827" height="60" x="0" y="220"></rect><g transform="translate(60,555)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-2212" x="412" y="0"></use><g transform="translate(842,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-68" x="1011" y="-213"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-48" x="847" y="-559"></use></g></g><g transform="translate(8901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-32" x="550" y="513"></use></g></g><g transform="translate(0,-4302)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-3B1" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-3D" x="918" y="0"></use><g transform="translate(1974,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-22C5" x="3698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-65" x="4199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-78" x="4665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-70" x="5238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-28" x="5741" y="0"></use><g transform="translate(6131,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-2212" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-6B" x="778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-22C5" x="1522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-72" x="2022" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-6E" x="3499" y="596"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMAIN-29" x="9130" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mspace linebreak="newline"></mspace><mi>k</mi><mo>=</mo><mn>190</mn><mspace linebreak="newline"></mspace><mi>n</mi><mo>=</mo><mn>3</mn><mspace linebreak="newline"></mspace><mi>r</mi><mo>=</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>i</mi><mo>−</mo><msub><mi>C</mi><mi>w</mi></msub></mrow><mrow><mn>1.2</mn><mo>⋅</mo><mi>W</mi></mrow></mfrac><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>j</mi><mo>−</mo><msub><mi>C</mi><mi>h</mi></msub></mrow><mi>H</mi></mfrac><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mspace linebreak="newline"></mspace><mi>α</mi><mo>=</mo><mn>255</mn><mo>⋅</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>k</mi><mo>⋅</mo><mi>r</mi></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">\\k = 190 \\n = 3 \\r= (\frac{i-C_w}{1.2 \cdot W})^2+(\frac{j-C_h}{H})^2 \\ \alpha = 255 \cdot exp({-k\cdot r}^n)</script><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kとnは経験的に選択されました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
i-OX軸に</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
沿ったピクセルインデックスj-OY軸に沿ったピクセルインデックス</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mi>w</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.071ex" height="2.384ex" viewBox="0 -809.3 1322.1 1026.6" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-77" x="1011" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">C_w</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -画像の中心のコンポーネントx</font></font><br>
<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>C</mi><mi>h</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.841ex" height="2.384ex" viewBox="0 -809.3 1223.1 1026.6" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/470323/&amp;usg=ALkJrhgYi8C3IpvRdaLCVHDls-1HHK3lzQ#MJMATHI-68" x="1011" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mi>h</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">C_h</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-画像の中心のコンポーネントy </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果として、次の結果が得られました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/w9/ab/wqw9abniw6gptbn_kk4_q5zq3t4.jpeg" width="309" alt="eyeHandBlend.jpg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顔</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
検索写真内の顔を検索するためのアルゴリズムは多数あります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Viola-Jonesアルゴリズム（Haar Cascades）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 豚+ SVM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R-CNN</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 高速r-cnn</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> より高速なr-cnn</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ヨロ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初はViola-Jonesアルゴリズムが使用されていましたが、次の理由により、十分に正確ではないことが判明しました。</font><font style="vertical-align: inherit;">正確にではない面を強調表示。</font><font style="vertical-align: inherit;">1人の選択領域は2番目の選択領域と一致しませんでした。そのため、置換が欠陥で発生しました。このアルゴリズムを使用した顔の選択の例を以下に示します。</font><font style="vertical-align: inherit;">顔は移動できます。</font><font style="vertical-align: inherit;">一方の画像では両方の耳をキャプチャし、もう一方の画像では一方のみをキャプチャします。</font><font style="vertical-align: inherit;">そのような欠陥は最終結果にかなり悪い影響を与えます（写真では、DLibでの作業で、以前のライブラリは常に顔を見つけられませんでしたが、残念ながらスクリーンショットは保存されませんでした）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lk/6p/sg/lk6psgjhiqyispratrubpxk8afw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Dlibライブラリのランドマークを使用することにしました。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">DlibDotNetが</font></a><font style="vertical-align: inherit;">見つかり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.Net Coreで記述されています。</font><font style="vertical-align: inherit;">.Net Frameworkで使用するために、顔検索とランドマーク選択の基本機能を備えた.Net Standard 2.0の中間プロジェクトが作成されました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＃コード</font></font></b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] <span class="hljs-title">Face</span>(<span class="hljs-params"><span class="hljs-keyword">byte</span>[] bts, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> col, <span class="hljs-keyword">int</span> st</span>)</span><font></font>
{<font></font>
       <span class="hljs-keyword">var</span> img = Dlib.LoadImageData&lt;RgbPixel&gt;<font></font>
       (ImagePixelFormat.Bgr, bts, (<span class="hljs-keyword">uint</span>)row, (<span class="hljs-keyword">uint</span>)col, (<span class="hljs-keyword">uint</span>)st );
       <span class="hljs-keyword">var</span> face = faceDetector.Operator(img)[<span class="hljs-number">0</span>];
       <span class="hljs-keyword">int</span>[] rect = { face.Left, face.Top, (<span class="hljs-keyword">int</span>)face.Width, (<span class="hljs-keyword">int</span>)face.Height};
       <span class="hljs-keyword">return</span> rect;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> List&lt;<span class="hljs-keyword">int</span>[]&gt; FacePoints(<span class="hljs-keyword">byte</span>[] bts, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> col, <span class="hljs-keyword">int</span> st)<font></font>
 {<font></font>
            List&lt;<span class="hljs-keyword">int</span>[]&gt; points = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-keyword">int</span>[]&gt;();
            <span class="hljs-keyword">var</span> img = Dlib.LoadImageData&lt;RgbPixel&gt;<font></font>
            (ImagePixelFormat.Bgr, bts, (<span class="hljs-keyword">uint</span>)row, (<span class="hljs-keyword">uint</span>)col, (<span class="hljs-keyword">uint</span>)st);
            <span class="hljs-keyword">var</span> face = faceDetector.Operator(img)[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">var</span> shape = shapePredictor.Detect(img, face);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; shape.Parts; i++)<font></font>
            {<font></font>
                <span class="hljs-keyword">var</span> point = shape.GetPart((<span class="hljs-keyword">uint</span>)i);<font></font>
                points.Add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[] { point.X, point.Y });<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> points;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、彼は.Net Framework 4.6.1でライブラリを作成し、その中にすべてのロジックを実装しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ラングマークを取得する例：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ha/k_/rq/hak_rq1nx58hnrlwrevqw1_bygw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
左端、右端、上端、下端のポイントを見つけ、その上にフレームを構築することで、人をより正確に区別できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/te/pw/-x/tepw-xziyju0zs60bbawi4_wnpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、画面の右下隅の顔が切り取られ、上記のアルゴリズムを使用して、「Caballero de la mano en el pecho」という画像に挿入されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の結果が得られた。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w1/bw/lp/w1bwlpk1ulrf5srvffcrow1i_gm.jpeg" alt="画像"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズムのデモンストレーションに使用される人物は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このプロジェクト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から取得され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中古ライブラリー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">形状予測子（68ポイント）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトへのリンク</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の記事では、写真から3Dマスクを作成することを検討する予定です。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja470309/index.html">Xamarin.Formsシェル</a></li>
<li><a href="../ja470311/index.html">木製おもちゃ、パート7-1993</a></li>
<li><a href="../ja470313/index.html">木製おもちゃ、パート8-1994</a></li>
<li><a href="../ja470317/index.html">C ++の省略に関するチートシートなど。パート2：「そしてそれだけではない」</a></li>
<li><a href="../ja470321/index.html">木製おもちゃ、パート9-1995</a></li>
<li><a href="../ja470327/index.html">InSys JSCによって製造された装置を備えたアプリケーションMATLAB / Simulink</a></li>
<li><a href="../ja470331/index.html">インデックス付けされたISI、Scopus、またはScimagoのログを識別する方法は？</a></li>
<li><a href="../ja470333/index.html">プログラマー、マネージャー、MVC、受け入れ基準</a></li>
<li><a href="../ja470337/index.html">Y. Marketで3か月間働いた方法</a></li>
<li><a href="../ja470347/index.html">ここのAPIを短時間で学ぶ方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>