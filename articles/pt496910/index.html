<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👇🏿 🍨 🚔 Crie e personalize sua CDN 😆 👨🏻‍🔧 🧒🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As redes de entrega de conteúdo (CDNs) são usadas em sites e aplicativos principalmente para acelerar o carregamento de elementos estáticos. Isso acon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Crie e personalize sua CDN</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496910/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As redes de entrega de conteúdo (CDNs) são usadas em sites e aplicativos principalmente para acelerar o carregamento de elementos estáticos. Isso acontece devido ao armazenamento em cache de arquivos em servidores CDN localizados em diferentes regiões geográficas. Após solicitar os dados via CDN, o usuário os recebe do servidor mais próximo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O princípio de operação e funcionalidade de todas as redes de entrega de conteúdo é aproximadamente o mesmo. Depois de receber uma solicitação para baixar um arquivo, o servidor CDN o pega no servidor original e o entrega ao usuário, ao mesmo tempo em cache por um determinado período de tempo. Todas as solicitações subsequentes são respondidas do cache. Todas as CDNs têm opções para pré-carregar arquivos, limpar o cache, definir seu período de retenção e muito mais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ocorre que, por um motivo ou outro, você precisa organizar sua própria rede de entrega de conteúdo e, em seguida, deixe-nos ajudá-lo a construir outra bicicleta. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/rw/ss/qfrwss0k86-bdbbbpztdh3d0nkq.jpeg"><br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonte: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infográfico vetor criado por pikisuperstar - www.freepik.com</font></font></a></i></sup></font><a name="habracut"></a><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando você precisa do seu próprio CDN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere os casos em que iniciar seu próprio CDN faz sentido:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quando você deseja economizar, e os custos de operação, mesmo ao usar CDNs baratas como o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BunnyCDN,</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> são várias centenas de dólares por mês</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se queremos obter um cache permanente ou um cache sem vizinhos no servidor e no canal</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na região que você precisa, os serviços CDN não têm pontos de presença</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quaisquer configurações especiais de entrega de conteúdo necessárias</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">queremos acelerar a entrega de conteúdo dinâmico, aproximando-nos dos usuários do servidor de produção</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existe a preocupação de que um serviço CDN de terceiros possa coletar ou usar ilegalmente informações sobre o comportamento do usuário (para serviços sem conformidade com o GDPR) ou se envolver em outras ações ilegais</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na maioria dos outros casos, é melhor usar as soluções prontas existentes.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que você precisa para executar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É maravilhoso se você tiver seu próprio sistema autônomo (AS). </font><font style="vertical-align: inherit;">Com ele, você pode atribuir o mesmo IP a vários servidores e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguir estas instruções</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no nível da rede para direcionar os usuários para o </font><font style="vertical-align: inherit;">servidor </font><font style="vertical-align: inherit;">mais próximo. </font><font style="vertical-align: inherit;">Vale dizer que, mesmo com o bloco de endereços / 24, é possível construir uma rede de entrega de conteúdo. </font><font style="vertical-align: inherit;">Alguns provedores de servidores permitem que você faça um anúncio para uso em todas as regiões disponíveis para eles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você não é um proprietário feliz de um bloco de endereços IP, para executar uma CDN simples, será necessário:</font></font><br>
<br>
<ul>
<li>   </li>
<li>     .     ,   </li>
<li>geoDNS .    ,   ,     </li>
</ul><br>
<br>
<h2>    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com o registro de domínio, tudo é simples - registre-se em qualquer zona com qualquer registrador. Você também pode usar um subdomínio para uma CDN, como algo como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.namedomain.com</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Na verdade, em nosso exemplo, faremos isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto ao pedido de servidores, eles devem ser alugados nas regiões e nos países em que seu público-alvo está localizado. Se o projeto for intercontinental, é conveniente escolher provedores de hospedagem que ofereçam servidores em todo o mundo imediatamente. Exemplos: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OVH</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaseweb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100Tb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para servidores dedicados, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vultr</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DigitalOcean</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para nuvem virtual *. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para nossa CDN privada, solicitamos 3 servidores virtuais em diferentes continentes. At </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vultr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no servidor por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 5 / mês,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> temos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 GB de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> espaço </font><b><font style="vertical-align: inherit;">SSD</font></b><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 TB de tráfego</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ao instalar, selecione o último Debian. </font><font style="vertical-align: inherit;">Nossos servidores: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/di/f1/jydif1phgm45zpwjbety-fw_d-g.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frankfurt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ip: 199.247.18.199 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/wh/v1/ukwhv1lwwsr8snoiqc_yyzquo5s.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chicago</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ip: 149.28.121.123 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/qk/6e/3fqk6endcgzeybs-yjlkkphep50.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cingapura</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ip: 157.230.240.216 </font></font><br>
<br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* A Vultr e a DigitalOcean prometem um empréstimo de US $ 100 aos usuários registrados usando os links do artigo imediatamente após adicionar um método de pagamento. </font><font style="vertical-align: inherit;">O autor também recebe um pequeno elogio disso, o que é muito significativo para ele agora. </font><font style="vertical-align: inherit;">Por favor, seja compreensivo.</font></font></i></sup></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar geoDNS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que quando um usuário acessa um domínio ou subdomínio CDN, ele é direcionado para o servidor desejado (mais próximo a ele), precisamos de um servidor DNS com a função geoDNS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O princípio e o procedimento do geoDNS são os seguintes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Define o IP do cliente que enviou a solicitação DNS ou o IP do servidor DNS recursivo usado para processar a solicitação do cliente. </font><font style="vertical-align: inherit;">Esses servidores recursivos geralmente são provedores de DNS.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por IP, o cliente conhece seu país ou região. </font><font style="vertical-align: inherit;">Para isso, são utilizadas as bases GeoIP, das quais existem muitas hoje. </font><font style="vertical-align: inherit;">Existem algumas boas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opções gratuitas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependendo da localização do cliente, ele fornece o endereço IP do servidor CDN mais próximo.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criar um</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> servidor DNS com a função geoDNS </font><font style="vertical-align: inherit;">, mas é melhor usar soluções prontas com uma rede de servidores DNS ao redor do mundo e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anycast</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pronto para uso </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">louDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> US $ 9,95 / mês</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tarifa GeoDNS, por padrão, há um failover de DNS</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zilore</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> US $ 25 / mês</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , failover de DNS ativado</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Route 53</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> US $ 35 / mês</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para solicitações geográficas líquidas de 50 milhões. </font><font style="vertical-align: inherit;">O failover de DNS é cobrado separadamente</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS facilitado a</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir de</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> US $ 125 / mês</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , há 10 failover de DNS</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudflare</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , recurso de direção geográfica disponível em tarifas corporativas</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao fazer o pedido do geoDNS, você deve prestar atenção ao número de solicitações incluídas na tarifa e levar em consideração que o número real de chamadas para o domínio pode exceder as expectativas várias vezes. Milhões de aranhas, scanners, spammers e outros espíritos malignos trabalham incansavelmente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quase todos os serviços DNS incluem um indispensável para a criação de um serviço CDN - Failover DNS. Com ele, você pode configurar o monitoramento de seus servidores e, na ausência de sinais de vida, substituir automaticamente o endereço do servidor que não está funcionando por um servidor de backup nas respostas DNS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para construir nossa CDN, usaremos o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClouDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a tarifa do GeoDNS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione uma nova zona DNS à sua conta, indicando seu domínio. </font><font style="vertical-align: inherit;">Se criarmos a CDN em um subdomínio e o domínio principal já estiver em uso, imediatamente após adicionar a zona, não esqueça de adicionar os registros DNS em funcionamento existentes. </font><font style="vertical-align: inherit;">O próximo passo é criar para o domínio / subdomínio CDN vários registros A, cada um dos quais será aplicado à região que definimos. </font><font style="vertical-align: inherit;">Você pode especificar continentes ou países como regiões; as sub-regiões estão disponíveis para os EUA e o Canadá. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, o CDN será levantado na </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> subdomínio </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Adicionando a zona </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , crie o primeiro registro A para o subdomínio e direcione toda a América do Norte para o servidor em Chicago:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/z_/zt/0xz_ztazcrmz8wqlruylrz4iqh4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repita o procedimento para outras regiões, lembrando-se de criar uma entrada para as regiões padrão. </font><font style="vertical-align: inherit;">Aqui está o resultado:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/js/zy/iojszykgez_pu7wf3mzd8lvmffa.jpeg" width="600"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O último registro padrão na captura de tela significa que todas as regiões indeterminadas (como Europa, África, usuários de Internet via satélite etc.) serão enviadas para um servidor em Frankfurt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso completa a configuração básica do DNS. </font><font style="vertical-align: inherit;">Resta acessar o site do registrador de domínios e substituir os NSs de domínio atuais pelos emitidos pelo ClouDNS. </font><font style="vertical-align: inherit;">E enquanto os NSs serão atualizados, prepararemos o servidor.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalar certificados SSL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nossa CDN funcionará em HTTPS; portanto, se você já possui certificados SSL para um domínio ou subdomínio, faça o upload para todos os servidores, por exemplo, no diretório </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / ssl / yourdomain /</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Se não houver certificados, você pode obter um grátis em Let's Encrypt. O </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script ACME Shell é</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perfeito para isso </font><font style="vertical-align: inherit;">. O cliente é conveniente, fácil de configurar e, o mais importante - permite validar o domínio / subdomínio do DNS por meio da API do ClouDNS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instalaremos o acme.sh somente em um dos servidores - europeu 199.247.18.199, a partir do qual os certificados serão copiados para todos os outros. Para instalar, faça:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# wget -O - https://get.acme.sh | bash; source ~/.bashrc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante a instalação do script, uma tarefa CRON será criada para renovação adicional de certificados sem a nossa participação. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A verificação do domínio ao emitir um certificado será realizada usando DNS usando a API. Portanto, na conta pessoal ClouDNS no menu API do revendedor, você precisa criar uma nova API de usuário e definir uma senha para ela. </font><font style="vertical-align: inherit;">O auth-id resultante com a senha será gravada no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / .acme.sh / DnsApi / dns_cloudns.sh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (para não ser confundido com o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dns_clou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arquivo dns.sh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Aqui estão as linhas para remover o comentário e editar:</font></font><br>
<br>
<pre><code class="plaintext hljs">CLOUDNS_AUTH_ID=&lt;auth-id&gt;<font></font>
CLOUDNS_AUTH_PASSWORD="&lt;&gt;"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora </font><b><font style="vertical-align: inherit;">pedimos</font></b><font style="vertical-align: inherit;"> um certificado SSL para </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></b><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# acme.sh --issue --dns dns_cloudns -d cdn.sayt.in --reloadcmd "service nginx reload"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos parâmetros para o futuro, especificamos um comando para recarregar automaticamente a configuração do servidor da web após cada renovação do período de validade do certificado no futuro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo o processo de obtenção de um certificado pode levar até 2 minutos, não o interrompa. </font><font style="vertical-align: inherit;">Se ocorrer um erro de validação de domínio, tente executar o comando novamente. </font><font style="vertical-align: inherit;">No final, veremos onde os certificados foram carregados: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l6/qv/16/l6qv16mchqhhaokxuvbwmnnw6xu.png" width="952"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembre </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">se desses caminhos, eles precisarão ser especificados ao copiar o certificado para outros servidores, bem como nas configurações do servidor web. </font><font style="vertical-align: inherit;">Não prestamos atenção ao erro ao recarregar os arquivos de configuração do Nginx - em um servidor totalmente configurado, ele não estará presente ao renovar certificados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo o que resta para nós através do SSL é copiar o certificado recebido para dois outros servidores, salvando o caminho para os arquivos. </font><font style="vertical-align: inherit;">Crie os mesmos diretórios em cada um deles e faça uma cópia:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# mkdir -p /root/.acme.sh/cdn.sayt.in/<font></font>
root@cdn:~# scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que a renovação do certificado seja regular, criaremos uma tarefa CRON diária nos dois servidores com o comando:</font></font><br>
<blockquote><code>scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/ &amp;&amp; service nginx reload</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o acesso ao servidor de origem remoto deve ser configurado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por chave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, </font><font style="vertical-align: inherit;">sem digitar uma senha. </font><font style="vertical-align: inherit;">Não se esqueça de fazê-lo.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instale e configure o Nginx</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para retornar conteúdo estático, usaremos o Nginx, configurado como um servidor proxy de cache. </font><font style="vertical-align: inherit;">Atualize a lista de pacotes e instale-a nos três servidores:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# apt update<font></font>
root@cdn:~# apt install nginx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez do padrão, use a configuração do spoiler abaixo:</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.conf</font></font></b><div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-attribute">user</span> www-data;
<span class="hljs-attribute">worker_processes</span> auto;
<span class="hljs-attribute">pid</span> /run/nginx.pid;<font></font>
<font></font>
<span class="hljs-section">events</span> {
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">4096</span>;
    <span class="hljs-attribute">multi_accept</span> <span class="hljs-literal">on</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-section">http</span> {
    <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nopush</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nodelay</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">types_hash_max_size</span> <span class="hljs-number">2048</span>;<font></font>
<font></font>
    <span class="hljs-attribute">include</span> /etc/nginx/mime.types;
    <span class="hljs-attribute">default_type</span> application/octet-stream;<font></font>
<font></font>
    <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;
    <span class="hljs-attribute">error_log</span> /var/log/nginx/error.log;<font></font>
<font></font>
    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">"msie6"</span>;
    <span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;
    <span class="hljs-attribute">gzip_proxied</span> any;
    <span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/javascript text/css application/json application/xml text/xml application/rss+xml;
    <span class="hljs-attribute">gunzip</span> <span class="hljs-literal">on</span>;            <font></font>
<font></font>
    <span class="hljs-attribute">proxy_temp_path</span>    /var/cache/tmp;
    <span class="hljs-attribute">proxy_cache_path</span>   /var/cache/cdn levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cdn:<span class="hljs-number">64m</span> max_size=<span class="hljs-number">20g</span> inactive=<span class="hljs-number">7d</span>;
    <span class="hljs-attribute">proxy_cache_bypass</span> <span class="hljs-variable">$http_x_update</span>;<font></font>
<font></font>
<span class="hljs-section">server</span> {
  <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;
  <span class="hljs-attribute">server_name</span> cdn.sayt.in;<font></font>
<font></font>
  <span class="hljs-attribute">ssl_certificate</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.cer;
  <span class="hljs-attribute">ssl_certificate_key</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.key;<font></font>
<font></font>
  <span class="hljs-attribute">location</span> / {
    <span class="hljs-attribute">proxy_cache</span> cdn;
    <span class="hljs-attribute">proxy_cache_key</span> <span class="hljs-variable">$uri</span><span class="hljs-variable">$is_args</span><span class="hljs-variable">$args</span>;
    <span class="hljs-attribute">proxy_cache_valid</span> <span class="hljs-number">90d</span>;
    <span class="hljs-attribute">proxy_pass</span> https://sayt.in;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na configuração, edite:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max_size</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tamanho do cache que não excede o espaço em disco disponível</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inativo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tempo de armazenamento para dados em cache que ninguém acessou</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - caminhos para o certificado SSL e os arquivos de chave</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tempo de armazenamento para dados em cache</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_pass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - o endereço do servidor original do qual a CDN solicitará arquivos para armazenamento em cache. </font><font style="vertical-align: inherit;">No nosso exemplo, isso é </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, tudo é simples. </font><font style="vertical-align: inherit;">A complexidade só pode surgir na configuração do tempo de cache devido à semelhança das </font><i><font style="vertical-align: inherit;">diretivas </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inativas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vamos analisá-los em nosso exemplo. </font><font style="vertical-align: inherit;">Aqui está o que acontece com </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inactive = 7d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid 90d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se a solicitação não for repetida dentro de sete dias, os dados serão excluídos do cache após esse período</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se a solicitação for repetida pelo menos uma vez a cada 7 dias, os dados no cache serão considerados desatualizados após 90 dias e, na próxima solicitação, o Nginx os atualizará retirando-os do servidor original</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Após terminar de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editar o nginx.conf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , recarregue a configuração:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# service nginx reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nossa CDN está completamente pronta. </font><font style="vertical-align: inherit;">Por US $ 15 / mês </font><font style="vertical-align: inherit;">temos pontos de presença em três continentes e 3 TB de tráfego: 1 TB em cada local.</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificando o funcionamento da CDN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vejamos os pings para nossa CDN de diferentes localizações geográficas. </font><font style="vertical-align: inherit;">Para isso, qualquer serviço de ping é adequado.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ponto de lançamento</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hospedeiro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IP</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo médio, ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alemanha Berlim</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Holanda, Amsterdã</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">França Paris</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16,3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grã-Bretanha, Londres</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14,9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canadá Toronto</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16,2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EUA, São Francisco</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52,7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EUA, Dallas</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23,1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EUA, Chicago</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EUA, Nova Iorque</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19,8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cingapura</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Japão Tóquio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74,8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Austrália, Sydney</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95,9</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os resultados são bons. </font><font style="vertical-align: inherit;">Agora, colocaremos a imagem de teste </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test.jpg</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na raiz do site principal </font><font style="vertical-align: inherit;">e verificaremos a velocidade do seu download via CDN. </font><font style="vertical-align: inherit;">Mal disse o que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fez</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O conteúdo é entregue rapidamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escreveremos um pequeno script caso desejemos limpar o cache no ponto CDN.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">purge.sh</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging all cache"</span><font></font>
    rm -rf /var/cache/cdn/*<font></font>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging <span class="hljs-variable">$1</span>"</span>
    FILE=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | md5sum | awk <span class="hljs-string">'{print $1}'</span>`<font></font>
    FULLPATH=/var/cache/cdn/<span class="hljs-variable">${FILE:31:1}</span>/<span class="hljs-variable">${FILE:29:2}</span>/<span class="hljs-variable">${FILE}</span>
    rm -f <span class="hljs-string">"<span class="hljs-variable">${FULLPATH}</span>"</span>
<span class="hljs-keyword">fi</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para excluir todo o cache, basta executá-lo, um arquivo separado pode ser limpo assim:</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# ./purge.sh /test.jpg</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em vez de conclusões</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, quero dar algumas dicas úteis para passar imediatamente pelo rake, o que ao mesmo tempo deixou minha cabeça dolorida:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para aumentar a tolerância a falhas da CDN, é recomendável configurar o Failover de DNS, o que ajuda a alterar rapidamente um registro A em caso de falha do servidor. </font><font style="vertical-align: inherit;">Isso é feito no painel de controle dos registros DNS do domínio</font></font></li>
<li>           CDN,    .            CDN,      6-7 : ,   (),   (), , ,   </li>
<li>         CDN. ,          ,       -</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">  </a>,  ,           </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tente verificar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pings de diferentes lugares</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos seus servidores. </font><font style="vertical-align: inherit;">Assim, você pode ver as regiões mais próximas aos pontos CDN e configurar o GeoDNS corretamente</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependendo das tarefas, não é impróprio configurar o Nginx para requisitos específicos de armazenamento em cache e levando em consideração a carga no servidor. </font><font style="vertical-align: inherit;">Os artigos sobre o cache do Nginx - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a aceleração do trabalho sob cargas pesadas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">aqui</font></a><font style="vertical-align: inherit;"> me ajudaram bastante.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt496886/index.html">Elon Musk revelou o objetivo da câmera sobre o espelho retrovisor no Tesla Model 3</a></li>
<li><a href="../pt496888/index.html">Inicialização usa IA para procurar moléculas que ajudarão a combater o coronavírus</a></li>
<li><a href="../pt496892/index.html">Todo o Habr em uma base. Comentários e aplicativo da web</a></li>
<li><a href="../pt496894/index.html">Backlog perfeito do produto</a></li>
<li><a href="../pt496900/index.html">Importe USRLE por meio do Apache NiFi. Etapa 1 - Baixar arquivos via HTTPS</a></li>
<li><a href="../pt496912/index.html">ThinkPad E480 Intel no Windows VS ThinkPad E495 AMD no Ubuntu existe alguma diferença?</a></li>
<li><a href="../pt496914/index.html">O menor programa decimal</a></li>
<li><a href="../pt496916/index.html">Ensinando, negociando e consultando remotamente - Parte 3: Yealink Meeting Server e 4 ofertas especiais</a></li>
<li><a href="../pt496920/index.html">Construindo uma casa inteligente com o ASP.NET Core e o Arduino</a></li>
<li><a href="../pt496922/index.html">Guia sobre cliente-servidor reverso apk no exemplo do trabalho NeoQUEST-2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>