<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕸️ 🤙🏼 👐 How did we do the core of Alfa-Bank's investment business based on Tarantool 👩🏿‍🤝‍👩🏾 😼 🈶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A shot from the film “Our Secret Universe: The Hidden Life of the Cell”
 
 Investment business is one of the most difficult areas in the banking world...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How did we do the core of Alfa-Bank's investment business based on Tarantool</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/495326/"><img src="https://habrastorage.org/webt/tc/or/26/tcor26cmqrsph9b0nioj_ic4cwa.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A shot from the film “Our Secret Universe: The Hidden Life of the Cell”</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Investment business is one of the most difficult areas in the banking world, because there are not only loans, loans and deposits, but also securities, currency, goods, derivatives and all sorts of difficulties in the form of structural products.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recently, we have seen an increase in the financial literacy of the population. More and more people are involved in trading in the securities markets. Individual investment accounts appeared not so long ago. They allow you to trade in the securities markets and at the same time either receive tax deductions or not pay taxes. And all the customers who come to us want to manage their portfolio and see real-time reporting. Moreover, most often this portfolio is multi-product, that is, people are customers of various business lines. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, the requirements of regulators, both Russian and foreign, are growing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To meet current needs and lay the foundation for future upgrades, we have developed the core of the investment business based on Tarantool.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some statistics. </font><font style="vertical-align: inherit;">Alfa-Bank’s investment business provides brokerage services for individuals and legal entities providing the opportunity to trade in various securities markets, custody services for the storage of securities, trust management services for individuals with private and large capital, securities issuing services for other companies. </font><font style="vertical-align: inherit;">Alfa-Bank’s investment business is more than 3 thousand quotes per second, which are downloaded from various trading platforms. </font><font style="vertical-align: inherit;">During the working day, more than 300 thousand transactions are concluded on the markets on behalf of the bank or its customers. </font><font style="vertical-align: inherit;">On external and internal platforms, up to 5 thousand orders are executed per second. </font><font style="vertical-align: inherit;">At the same time, all customers, both internal and external, want to see their positions in real time.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Background</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somewhere from the beginning of the 2000s, our areas of investment business have developed independently: exchange trading, brokerage services, currency trading, over-the-counter trading in securities and various derivatives. As a result, we fell into the trap of functional wells. What it is? Each line of business has its own systems that duplicate each other's functions. Each system has its own data model, although they operate on the same concepts: transactions, instruments, counterparties, quotes and more. And since each system developed independently, a diverse zoo of technologies arose. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, the code base of systems is already out of date, because some products originated in the mid-1990s. And in some areas, it slowed down the development process, there were problems with productivity.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New Solution Requirements</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Business realized that technological development is vital for further development. </font><font style="vertical-align: inherit;">We were assigned the tasks:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Collect all business data in a single fast storage and in a single data model. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We must not lose or modify this information. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is necessary to version the data, because at any time the regulator may ask for statistics for previous years. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We should not just bring some new, fashionable DBMS, but create a platform for solving business problems. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, our architects set their conditions: </font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The new solution should be enterprise-class, that is, it should already be tested in some large companies. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The mode of operation of the solution must be mission critical. </font><font style="vertical-align: inherit;">This means that we must be present at the same time in several data centers and calmly experience the disconnection of one data center.</font></font></li>
<li>    .   ,        ,       -    .   ,         . </li>
<li>    ,     . </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We went the standard way: formulated requirements and contacted the procurement department. From there we got a list of companies that, in general, are ready for us to do this. They told everyone about the task, and six of them received an assessment of the solutions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We at the bank do not believe anyone’s word, we love to test everything on our own. Therefore, a prerequisite of our tender competition was passing stress tests. We formulated test tasks for the load, and already three out of six companies agreed at their own expense to implement a prototype of the solution based on in-memory technologies to test it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I won’t tell how we tested everything and how long it took, I’ll summarize only: the best performance in load tests was shown by the prototype of the Tarantool-based solution from the Mail.ru Group development team. </font><font style="vertical-align: inherit;">We signed a contract and started development. </font><font style="vertical-align: inherit;">Four people were from Mail.ru Group, and from Alfa-Bank there were three developers, three system analysts, a solution architect, a product owner, and a Scrum master. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, I’ll talk about how our system grew, how it evolved, what we did and why.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Development</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First of all, we wondered how to get data from our current systems. We decided that HTTP is quite suitable for us, because all current systems communicate with each other, sending XML or JSON over HTTP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We use the built-in Tarantool HTTP server, because we do not need to terminate SSL sessions, and its performance is enough for us.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As I already said, we have all systems living in different data models, and at the input we need to bring the object to the model that we will describe at home. A language was needed to transform data. We chose the imperative Lua. We run all the code for data conversion in the sandbox - this is a safe place, beyond which the running code does not go beyond. To do this, simply do a loadstring of the necessary code, creating an environment with functions that cannot block anything or drop something.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e3/04c/45f/4e304c45ff56974d624be577ebb8258d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the conversion, the data must be checked for compliance with the model that we are creating. </font><font style="vertical-align: inherit;">We discussed for a long time what a model should be, what language to use to describe it. </font><font style="vertical-align: inherit;">We stopped at Apache Avro, because the language is simple and it has support from Tarantool. </font><font style="vertical-align: inherit;">New versions of the model and user code can be put into operation several times a day, even under load, even without, at any time of the day, and very quickly adapt to changes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d28/172/bea/d28172beab19e37ef1fd30597d21d321.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After verification, the data must be saved. </font><font style="vertical-align: inherit;">We do this with vshard (we have geo-spaced replicas of shards).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5a/619/7b4/d5a6197b44b2d8f1f43b33004241f221.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, the specifics are such that for most systems that send us data, it does not matter if we received them or not. Therefore, from the very beginning we implemented the repair line. What it is? If for some reason the object did not pass the data transformation or verification, then we still confirm receipt, but at the same time we save the object in the repair queue. It is consistent, located in the main repository with business data. We immediately wrote an admin interface for it, various metrics and alerts. As a result, we do not lose data. Even if something has changed in the source, if the data model has changed, we will immediately find it and can adapt.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ad/2a7/c23/7ad2a7c235467068ccec89b9eb025b12.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now you need to learn how to retrieve stored data. We carefully analyzed our systems and saw that on the classic stack from Java and Oracle there is always some kind of ORM that converts data from a relational view to an object one. So why not immediately give objects to systems in the form of a graph? Therefore, we gladly took GraphQL, which met all our needs. It allows you to receive data in the form of graphs, to pull out only what you need right now. You can even version the API with enough flexibility.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d90/636/a7a/d90636a7ac34c91eefd299a88d902d44.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Almost immediately, we realized that the extracted data was not enough for us. </font><font style="vertical-align: inherit;">We made functions that can be attached to objects in the model - in fact, calculated fields. </font><font style="vertical-align: inherit;">That is, we attach a certain function to the field, which, for example, considers the average price of a quote. </font><font style="vertical-align: inherit;">And the external consumer who requests the data does not even know that this field is calculated.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f77/51f/ce9/f7751fce9a424fa80aba0c701cb9295e.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implemented an authentication system. </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/768/d24/2f7/768d242f7825460594a79ff0c3e07449.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then they noticed that several roles crystallized in our solution. </font><font style="vertical-align: inherit;">A role is a kind of aggregator of functions. </font><font style="vertical-align: inherit;">As a rule, roles have different profiles of equipment use:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T-Connect: handles incoming connections, limited by processor, consumes little memory, does not store state.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IB-Core: transforms the data that it receives via the Tarantool protocol, that is, it operates with tablets. </font><font style="vertical-align: inherit;">Also does not store state and can be scaled.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Storage: only saves data, does not use any logic. </font><font style="vertical-align: inherit;">The simplest interfaces are implemented in this role. </font><font style="vertical-align: inherit;">Scalable thanks to vshard.</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/292/66e/613/29266e613da2a34c5df9463884873267.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That is, with the help of roles, we untied from each other different parts of the cluster that can be scaled independently of each other. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we created an asynchronous record of a transactional data stream and a repair queue with an administrator interface. </font><font style="vertical-align: inherit;">Recording is asynchronous from a business point of view: if we are guaranteed to record data to ourselves, no matter where, then we will confirm this. </font><font style="vertical-align: inherit;">If not confirmed, then something went wrong, the data needs to be sent. </font><font style="vertical-align: inherit;">This is asynchronous recording.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testing</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the very beginning of the project it was decided that we would try to instill test driven development. We write unit tests in Lua using the tarantool / tap framework, integration tests in Python using the pytest framework. At the same time, both developers and analysts are involved in writing integration tests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How do we apply test driven development? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we want some new feature, we first try to write a test for it. Having discovered the bug, we must first write to the test, and only then fix it. At first, it’s hard to work like that, there is a misunderstanding on the part of employees, even sabotage: “Let's quickly fix it now, do something new, and then cover it with tests.” Only this “later” almost never occurs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Therefore, you must first force yourself to write tests, ask others to do it. Believe me, test driven development is beneficial even in the short term. You will feel that it has become easier for you to live. According to our feelings, 99% of the code is covered by tests now. It seems like a lot, but we have no problems: tests are run on every commit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, most of all we love stress testing, we consider it the most important and regularly conduct it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I’ll tell you a short story about how we conducted the first stage of load testing of one of the first versions. We put the system on the developer's laptop, turned on the load and received 4 thousand transactions per second. Good result for a laptop. We put on a virtual load stand of four servers, weaker than in production. Deployed to a minimum. We start it, and we get a worse result than on a laptop in one thread. Shock content. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We were very sad. We look at the server load, and they turn out to be idle.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a0b/eba/0fa/a0beba0fad0ba7e8f0cf333ef8366948.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We call the developers, and they explain to us, people who have come from the Java world, that Tarantool is single-threaded. </font><font style="vertical-align: inherit;">It can be effectively used by only one processor core under load. </font><font style="vertical-align: inherit;">Then we deployed the maximum possible number of Tarantool instances on each server, turned on the load and received already 14.5 thousand transactions per second.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/67f/8ca/e14/67f8cae14bea588f5018d4406f99c23c.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I’ll explain it again. </font><font style="vertical-align: inherit;">Due to the division into roles that use resources differently, our roles that were responsible for processing connections and data transformation only loaded the processor, and it was strictly proportional to the load.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d1/822/cb3/9d1822cb3dcacd91f3f9fd7dbb7c9f7c.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1f0/566/1b4/1f05661b4e5b7806867849b060dc23b7.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, the memory was used only for processing incoming connections and temporary objects.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16e/e79/f9f/16ee79f9fbfd6157c7df6edd66b90535.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the contrary, on storage servers, the processor load grew, but much more slowly than on servers that handle connections. </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/18b/0ad/d2d/18b0add2da6deda36388ca9b0f07594b.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And memory consumption grew in direct proportion to the loaded amount of data. </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e21/697/e05/e21697e0521f54530aa7c50227297af1.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Services</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To develop our new product specifically as an application platform, we made a component for deploying services and libraries on it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Services are not just small pieces of code that operate on some fields. </font><font style="vertical-align: inherit;">They can be quite large and complex designs that are part of the cluster, check the reference data, twist the business logic and give answers. </font><font style="vertical-align: inherit;">We also export the service scheme to GraphQL, and the consumer receives a universal data access point, with introspection throughout the model. </font><font style="vertical-align: inherit;">It is very comfortable.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since services contain much more functions, we decided that there should be libraries in which we will take out frequently used code. </font><font style="vertical-align: inherit;">We added them to a safe environment, after checking that this does not break anything for us. </font><font style="vertical-align: inherit;">And now we can set functions for additional environments in the form of libraries. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We wanted us to have a platform not only for storage, but also for computing. </font><font style="vertical-align: inherit;">And since we already had a bunch of replicas and shards, we implemented a semblance of distributed computing and called it map reduce, because it turned out to be like the original map reduce.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Old systems</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not all of our old systems can call us via HTTP and use GraphQL, although they support this protocol. </font><font style="vertical-align: inherit;">Therefore, we made a mechanism to replicate data to these systems.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f5d/6e5/e33/f5d6e5e33b10e605cf7c6c5befd4aa07.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If something changes for us, peculiar triggers work in the Storage role and the message with the changes falls into the processing queue. </font><font style="vertical-align: inherit;">It is sent to an external system using a separate replicator role. </font><font style="vertical-align: inherit;">This role does not store state.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New improvements</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you recall, from a business perspective, we made asynchronous recording. </font><font style="vertical-align: inherit;">But then they realized that it would not be enough, because there is a class of systems that need to immediately receive an answer about the status of the operation. </font><font style="vertical-align: inherit;">Therefore, we have expanded our GraphQL and added mutations. </font><font style="vertical-align: inherit;">They organically fit into the existing paradigm of working with data. </font><font style="vertical-align: inherit;">We have a single point of both reading and writing for another class of systems.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/395/562/ef7/395562ef7191842f4dc9526dae8c0661.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also realized that services alone would not be enough for us, because there are quite heavy reports that need to be built once a day, a week, a month. This can take a long time, and reports can even block the Tarantool event loop. Therefore, we made separate roles: scheduler and runner. Runners do not store state. They launch difficult tasks, which we cannot count on the fly. And the scheduler role monitors the schedule for launching these tasks, which is described in the configuration. The tasks themselves are stored in the same place as the business data. When the right time comes, scheduler takes the task, gives it to some runner, he considers it and saves the result.</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb1/bbf/123/fb1bbf12343d40bab27a87b5f1021f0d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not all tasks need to be run on schedule. </font><font style="vertical-align: inherit;">Some reports need to be read on demand. </font><font style="vertical-align: inherit;">As soon as this requirement arrives, a task is formed in the sandbox and sent to runner for execution. </font><font style="vertical-align: inherit;">After a while, the user receives an answer asynchronously that everything was calculated, the report is ready.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13f/27e/db0/13f27edb0711b735602d77c7c54c4d38.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, we adhered to the paradigm of saving all data, versioning and not deleting them. </font><font style="vertical-align: inherit;">But in life, from time to time, you still have to delete something, mainly some raw or intermediate information. </font><font style="vertical-align: inherit;">Based on expirationd, we made a mechanism for cleaning the storage of obsolete data.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d9/1aa/e8d/4d91aae8daf9c27437ca9ed57574e349.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also understand that sooner or later a situation will come when there will be not enough space for storing data in memory, but nevertheless the data must be stored. </font><font style="vertical-align: inherit;">For these purposes, we will soon make disk storage.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13a/10e/7da/13a10e7da6c77907d88504ee20fbb62c.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We started with the task of loading data into a single model, spent three months on its development. We had six data provider systems. The entire transformation code into a single model is about 30 thousand lines in Lua. And most of the work is yet to come. Sometimes there is a lack of motivation for neighboring teams, a lot of complicating the work of circumstances. If you ever face a similar problem, then the time that you think is normal for its implementation, multiply by three, or even four.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also remember that existing problems in business processes cannot be solved with the help of a new DBMS, even if it is very productive. What I mean? At the start of our project, we created an impression among customers that now we will bring a new fast database and live! The processes will go faster, everything will be fine. In fact, technology does not solve the problems that exist in business processes, because business processes are people. And you need to work with people, not technology. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Development through testing in the initial stages can be painful and time consuming. But the positive effect of it will be noticeable even in the short term, when you do not need to do anything to conduct regression testing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is extremely important to carry out load testing at all stages of development. The sooner you notice some kind of flaw in the architecture, the easier it will be to fix it, this will save you a lot of time in the future. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is nothing wrong with Lua. Anyone can learn to write on it: a Java developer, a JavaScript developer, a Python developer, a front-end or back-end. We even have analysts writing on it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When we talk about the fact that we don’t have SQL, this terrifies people. “How do you get data without SQL?” Is that possible? ” Of course. On an OLTP class system, SQL is not needed. There is an alternative in the form of a language that returns you immediately document-oriented view. For example, GraphQL. And there is an alternative in the form of distributed computing.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you understand that you will need to scale, then design your solution on Tarantool, immediately so that it can work in parallel on dozens of Tarantool instances. </font><font style="vertical-align: inherit;">If you do not, then it will be difficult and painful, since Tarantool can efficiently use only one processor core.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495308/index.html">Rake on the way to keep-alive</a></li>
<li><a href="../en495310/index.html">Electronic walk-through: biometrics and multi-format</a></li>
<li><a href="../en495312/index.html">Perimeter security - the future is now</a></li>
<li><a href="../en495314/index.html">How to filter misinformation if it comes from official sources?</a></li>
<li><a href="../en495324/index.html">Writing a random stock generator of Mosbirzhe in JavaScript</a></li>
<li><a href="../en495330/index.html">Deserved popularity in numbers</a></li>
<li><a href="../en495332/index.html">Quartet 9: Allegro | TypeScript</a></li>
<li><a href="../en495336/index.html">Discord as a corporate messenger and not only</a></li>
<li><a href="../en495338/index.html">Best practices and guidelines for launching containers and Kubernetes in production environments</a></li>
<li><a href="../en495340/index.html">How to change the work of an administrator in a restaurant for a good job in IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>