<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‼️ 👩‍👩‍👧‍👦 🍡 奇怪的代码如何隐藏错误？TensorFlow.NET分析 ☝️ 🎐 😅</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="静态分析对于任何开发人员都是非常有用的工具，因为它不仅可以及时发现错误，而且还可以及时发现可疑和奇怪的代码片段，这些代码可能会使将来不得不与他合作的程序员感到困惑。将通过对TensorFlow.NET开放C＃项目进行分析来证明这一想法，该项目正在开发中，可与流行的TensorFlow机器学习库一起使...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>奇怪的代码如何隐藏错误？TensorFlow.NET分析</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/496250/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/bb4/d84/765bb4d84187d986358a301bbeed082f.png" alt="TensorFlow.NET和PVS-Studio"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态分析对于任何开发人员都是非常有用的工具，因为它不仅可以及时发现错误，而且还可以及时发现可疑和奇怪的代码片段，这些代码可能会使将来不得不与他合作的程序员感到困惑。将通过对TensorFlow.NET开放C＃项目进行分析来证明这一想法，该项目正在开发中，可与流行的TensorFlow机器学习库一起使用。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我叫Nikita Lipilin。</font><font style="vertical-align: inherit;">前一段时间，我加入了PVS-Studio的C＃程序员部门。</font><font style="vertical-align: inherit;">传统上，团队的所有新手都会撰写文章，讨论使用PVS-Studio静态分析器检查各种打开的项目的结果。</font><font style="vertical-align: inherit;">这些文章可帮助新员工更好地了解产品，同时在推广静态分析方法方面提供更多好处。</font><font style="vertical-align: inherit;">我建议您使自己熟悉有关开放项目分析的第一篇工作。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
程序代码中各种可能的错误是惊人的。在对所创建的应用程序进行表面检查后，其中一些会立即显示出来，即使在由经验丰富的开发人员团队进行代码审查时，也可能很难注意到其他人。但是，由于疏忽大意或其他原因，程序员有时还会编写简单而又不合逻辑的代码，尽管如此，这些代码（似乎）已成功完成其功能。但只有更进一步，当返回到所写内容时，或当其他人学习该代码时，就会出现无法回答的问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重构旧代码可能会导致问题，尤其是在程序的其他部分依赖于旧代码的情况下，因此，即使您发现某些坦率的弯曲结构，也可以解决问题。别碰它！ ”。随后，这使得难以研究源，因此，变得难以扩展可用功能。代码库被阻塞，有可能无法及时解决一些小而看不见但潜在的非常不愉快的内部问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在某个时候，会感觉到该错误的后果，但是它的搜索将花费很多时间，因为开发人员的怀疑将取决于大量无法一次重构的奇怪代码片段。由此得出结论，特定片段中的各种问题和奇怪之处应在写入后立即予以纠正。如果有合理的理由将所有内容保留为原样（例如，如果代码在以后的“''中写为某种空白“”），则此片段应附有解释性注释。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还要注意的是，不管开发人员的资格如何，某些有问题的，仅是不成功的时刻都可能从他的视线中溜走，有时可以在某个地方应用“临时解决方案”，该解决方案很快就会被人们遗忘并成为“永久性”。随后，对此类代码的分析（很可能将由其他开发人员参与）将花费大量的精力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，代码审查会有所帮助。但是，如果任务很严重，则此选项将需要大量时间。此外，当存在许多小错误或不足时，检查人员可能很可能不会注意到高级错误。检查代码成为繁琐的例程，并且审查的有效性逐渐降低。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显然，例行任务将更好地从人转移到计算机。这种方法被用于许多现代领域。各种过程的自动化是繁荣的关键。在本主题中，自动化是什么？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态分析是解决编写合理且稳定的工作代码的可靠助手。每次在将活动结果发送给评论之前，程序员都将能够进行自动检查，而不会给其他开发人员（和他本人）带来不必要的工作负担。仅在考虑了所有分析仪警告之后，才将代码发送给验证：错误已修复，奇怪的时刻已被重写，或至少由注释解释。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，对代码审阅的需求并没有消失，但是静态分析补充并大大简化了其实现。</font><font style="vertical-align: inherit;">借助分析仪，可以修复大部分错误，并且绝对不会忘记并标记相应的奇怪时刻。</font><font style="vertical-align: inherit;">因此，通过代码审查，将有可能集中精力验证复杂逻辑交互的实现的正确性，并发现不幸的是，到目前为止，分析器无法检测到潜在的问题。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow.NET</font></font></h2><br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d02/39d/72d/d0239d72ded7154a696d5c975a0555d1.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本文的灵感来自TensorFlow.NET项目。它表示通过C＃代码使用流行的TensorFlow机器学习库的功能的能力的实现（顺便说一下，我们也</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对其进行了测试</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。这个想法似乎很有趣，因为在编写本文时，仅在Python，Java和Go中可以使用库。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">GitHub上</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
可用的源代码</font><font style="vertical-align: inherit;">正在不断更新，现在其数量略超过十万行。经过初步研究后，人们希望使用静态分析进行验证。 PVS-Studio被用作特定工具，已在许多</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">不同项目中</font></a><font style="vertical-align: inherit;">证明了其有效性</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/261/70b/247/26170b247e9b81a3643bd5682b7d5203.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于TensorFlow.NET，分析器显示许多警报：39个高级别，227个中级别和154个低级别（您可以</font><font style="vertical-align: inherit;">在“警告级别和诊断规则集”小节中</font><font style="vertical-align: inherit;">了解有关警告级别的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信息</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。对它们每个人的详细分析都会使这篇文章巨大，因此下面仅描述对我来说最有趣的内容。还值得注意的是，在项目中几次遇到了一些发现的问题，对每个这样的代码段的分析不在本文的讨论范围之内。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该项目为自己设定了一个相当严肃的任务，不幸的是，不可避免地会出现各种奇怪的代码片段。</font><font style="vertical-align: inherit;">在本文中，我将尝试表明静态分析的使用可以大大简化程序员的工作，并指出可能引起问题的领域。</font><font style="vertical-align: inherit;">警告并不总是表示错误，但是很多时候，它表示会导致人为问题的代码。</font><font style="vertical-align: inherit;">因此，显着增加了重新设计或在任何情况下进行相应注释的奇怪代码的可能性。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究分析仪报告时引起关注的片段</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，针对该项目的大量分析器警告可以称为不是很多错误，而可以称为奇怪的代码。当查看发出警告的行时，至少会产生困惑。当然，下面的一些示例可能是“临时解决方案”，但它们未对此问题发表任何评论，这意味着将来将使用此代码的人会提出疑问，并寻找答案。将花费额外的时间。</font></font><br>
<br>
<p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/263/3fc/e7c/2633fce7cba470cd8a0c16e6751b3513.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同时，一些警告指向的代码显然不仅奇怪，而且是错误的。</font><font style="vertical-align: inherit;">这是“奇怪代码”的主要危险-如果您到处都看到奇怪的解决方案并逐渐习惯于代码似乎是错误的事实，那么很难注意到真正的错误。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精致的收藏之旅</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> _RemoveDefaultAttrs(....)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
  producer_op_list.Op.Select(op =&gt;<font></font>
  {<font></font>
    producer_op_dict[op.Name] = op;<font></font>
    <span class="hljs-keyword">return</span> op;<font></font>
  }).ToArray();           <font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要使用函数“ ToArray”的返回值。 importer.cs 218 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析器认为此时对</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的调用</font><font style="vertical-align: inherit;">可疑，因为此函数返回的值未分配给变量。但是，这样的代码不是错误。该结构用于使用与</font><i><font style="vertical-align: inherit;">producer_op_list.Op</font></i><font style="vertical-align: inherit;">列表的元素相对应的值</font><font style="vertical-align: inherit;">来填充</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">producer_op_dict</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字典</font><font style="vertical-align: inherit;">。必须调用</font><i><font style="vertical-align: inherit;">ToArray，</font></i><font style="vertical-align: inherit;">以便</font><font style="vertical-align: inherit;">为集合中的所有元素调用</font><font style="vertical-align: inherit;">作为参数传递给</font><i><font style="vertical-align: inherit;">Select</font></i><font style="vertical-align: inherit;">方法的函数</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我认为该代码看起来并不是最好的。</font><font style="vertical-align: inherit;">填写字典有些不明显，有些开发人员可能希望删除</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的“不必要”调用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这里使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foreach循环</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会更容易理解</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> producer_op_dict = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, OpDef&gt;();<font></font>
<font></font>
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> op <span class="hljs-keyword">in</span> producer_op_list.Op)<font></font>
{<font></font>
  producer_op_dict[op.Name] = op;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，代码看起来尽可能简单。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个类似的时刻看起来像这样：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  inference_graph.Node.Select(x =&gt; map_name_to_node[x.Name] = x).ToArray();<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要使用函数“ ToArray”的返回值。</font><font style="vertical-align: inherit;">graph_util_impl.cs 48 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
唯一的区别是，这样的记录看起来更加简洁，但是只有删除</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用的诱惑</font><font style="vertical-align: inherit;">并没有消失，并且看起来仍然不明显。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">临时解决方案</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> GraphDef <span class="hljs-title">convert_variables_to_constants</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> source_op_name = get_input_name(node);
  <span class="hljs-keyword">while</span>(map_name_to_node[source_op_name].Op == <span class="hljs-string">"Identity"</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException);<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">循环内无条件的“抛出”。 graph_util_impl.cs 73 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在所考虑的项目中，通常使用以下方法：如果以后要实现某些行为，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在适当的位置</font><i><font style="vertical-align: inherit;">抛出NotImplementedException</font></i><font style="vertical-align: inherit;">。很明显，为什么分析器会在这篇文章中警告可能的错误：使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来并不太合理。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这不是由于使用临时解决方案而出现的唯一警告。例如，有一个方法：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _SoftmaxCrossEntropyWithLogitsGrad(<font></font>
  Operation op, Tensor[] grads<font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> grad_loss = grads[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> grad_grad = grads[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> softmax_grad = op.outputs[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> grad = _BroadcastMul(grad_loss, softmax_grad);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> logits = op.inputs[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span>(grad_grad != <span class="hljs-literal">null</span> &amp;&amp; !IsZero(grad_grad)) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"_SoftmaxCrossEntropyWithLogitsGrad"</span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[] <font></font>
  {<font></font>
    grad,<font></font>
    _BroadcastMul(grad_loss, -nn_ops.log_softmax(logits))<font></font>
  };<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式'grad_grad！= Null &amp;&amp;！IsZero（grad_grad）'始终为false。</font><font style="vertical-align: inherit;">nn_grad.cs 93 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，</font><font style="vertical-align: inherit;">将永远不会引发</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NotImplementedException（“ _ SoftmaxCrossEntropyWithLogitsGrad”）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为此代码根本无法访问。</font><font style="vertical-align: inherit;">为了阐明原因，您必须转到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsZero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数的代码</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsZero</span>(<span class="hljs-params">Tensor g</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>[] { <span class="hljs-string">"ZerosLike"</span>, <span class="hljs-string">"Zeros"</span> }.Contains(g.op.type))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"IsZero"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该方法返回</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或引发异常。</font><font style="vertical-align: inherit;">此代码不是错误-显然，此处的实现留待以后使用。</font><font style="vertical-align: inherit;">最主要的是“那么”真的到了。</font><font style="vertical-align: inherit;">好吧，事实证明，PVS-Studio不会让您忘记这里有这样的缺陷是非常成功的:)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">张量是张量吗？</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Tensor[] _ExtractInputShapes(Tensor[] inputs)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> sizes = <span class="hljs-keyword">new</span> Tensor[inputs.Length];
  <span class="hljs-keyword">bool</span> fully_known = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inputs.Length; i++)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> x = inputs[i];<font></font>
<font></font>
    <span class="hljs-keyword">var</span> input_shape = array_ops.shape(x);
    <span class="hljs-keyword">if</span> (!(input_shape <span class="hljs-keyword">is</span> Tensor) || input_shape.op.type != <span class="hljs-string">"Const"</span>)<font></font>
    {<font></font>
      fully_known = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
<font></font>
    sizes[i] = input_shape;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型检查过多。</font><font style="vertical-align: inherit;">该对象已经是“张量”类型。</font><font style="vertical-align: inherit;">array_grad.cs 154 </font><i><font style="vertical-align: inherit;">shape</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
方法的返回类型</font><font style="vertical-align: inherit;">为</font><i><font style="vertical-align: inherit;">Tensor</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">所以</font><i><font style="vertical-align: inherit;">input_shape是Tensor</font></i><font style="vertical-align: inherit;">检查</font><font style="vertical-align: inherit;">看起来至少很奇怪。</font><font style="vertical-align: inherit;">也许，一旦方法返回了不同类型的值并且验证就有意义了，但条件也有可能代替该Tensor来指定此类的继承人。</font><font style="vertical-align: inherit;">开发人员应以某种方式注意此片段。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彻底检查</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _BaseFusedBatchNormGrad(....)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> results = grad_fun(<span class="hljs-keyword">new</span> FusedBatchNormParams<font></font>
  {<font></font>
    YBackprop = grad_y,<font></font>
    X = x,<font></font>
    Scale = scale,<font></font>
    ReserveSpace1 = pop_mean,<font></font>
    ReserveSpace2 = pop_var,<font></font>
    ReserveSpace3 = version == <span class="hljs-number">2</span> ? op.outputs[<span class="hljs-number">5</span>] : <span class="hljs-literal">null</span>,<font></font>
    Epsilon = epsilon,<font></font>
    DataFormat = data_format,<font></font>
    IsTraining = is_training<font></font>
  });<font></font>
<font></font>
  <span class="hljs-keyword">var</span> (dx, dscale, doffset) = (results[<span class="hljs-number">0</span>], results[<span class="hljs-number">1</span>], results[<span class="hljs-number">2</span>]);
  <span class="hljs-keyword">if</span> (data_format == <span class="hljs-string">"NCHW"</span>) <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">""</span>);<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析仪警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有两个带有相同条件表达式的'if'语句。</font><font style="vertical-align: inherit;">第一个'if'语句包含方法return。</font><font style="vertical-align: inherit;">这意味着第二个“ if”语句是毫无意义的nn_grad.cs 230</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式'data_format ==“ NCHW”'始终为false。</font><font style="vertical-align: inherit;">nn_grad.cs 247</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与前面的一些示例不同，代码显然有问题。</font><font style="vertical-align: inherit;">第二次检查没有任何意义，因为如果条件为真，那么程序的执行将根本无法实现。</font><font style="vertical-align: inherit;">也许这里允许打错字，或者检查中的一项通常是多余的。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择的幻想</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Tensor <span class="hljs-title">Activate</span>(<span class="hljs-params">Tensor x, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  ....<font></font>
  Tensor negative_part;<font></font>
  <span class="hljs-keyword">if</span> (Math.Abs(_threshold) &gt; <span class="hljs-number">0.000001f</span>)<font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  } <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    negative_part = gen_ops.relu(-x + _threshold);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004'then</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '语句等效于'else'语句。 gen_nn_ops.activations.cs 156 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个相当有趣的演示，说明了在开发中使用静态分析的有效性。很难找到一个合理的理由来说明开发人员编写此特定代码的原因-很可能是典型的复制粘贴错误（尽管这当然可能是另一个“稍后”）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
类似计划的其他部分，例如：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Operation _GroupControlDeps(
  <span class="hljs-keyword">string</span> dev, Operation[] deps, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span><font></font>
)<font></font>
{<font></font>
  <span class="hljs-keyword">return</span> tf_with(ops.control_dependencies(deps), ctl =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (dev == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> gen_control_flow_ops.no_op(name);<font></font>
    }<font></font>
  });<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004'then</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '语句等效于'else'语句。</font><font style="vertical-align: inherit;">control_flow_ops.cs 135 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也许一旦检查有意义，但随着时间的流逝，它就消失了，或者将来计划进行一些进一步的更改。</font><font style="vertical-align: inherit;">但是，任何一个选项似乎都没有足够的理由在代码中留下类似内容，而无需以任何方式解释这种奇怪之处。</font><font style="vertical-align: inherit;">极有可能以完全相同的方式犯下复制粘贴错误。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迟来的支票</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] <span class="hljs-title">Input</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[] batch_shape = <span class="hljs-literal">null</span>,
  TF_DataType dtype = TF_DataType.DtInvalid,
  <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>,
  <span class="hljs-keyword">bool</span> sparse = <span class="hljs-literal">false</span>,
  Tensor tensor = <span class="hljs-literal">null</span></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> batch_size = batch_shape[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> shape = batch_shape.Skip(<span class="hljs-number">1</span>).ToArray(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
  InputLayer input_layer = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span> (batch_shape != <span class="hljs-literal">null</span>)                   <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
  <span class="hljs-keyword">else</span><font></font>
    ....<font></font>
<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在对null进行验证之前，已使用'batch_shape'对象。</font><font style="vertical-align: inherit;">检查行：39，42。keras.layers.cs 39 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一个潜在的变量潜在使用的经典且相当危险的错误，它是无处链接。</font><font style="vertical-align: inherit;">在这种情况下，代码明确暗示</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">batch_shape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的可能性</font><font style="vertical-align: inherit;">-从参数列表和随后对同一变量的验证中都可以清楚地看出。</font><font style="vertical-align: inherit;">因此，分析仪在此指示明显的错误。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另一个“待会儿”？</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MnistDataSet</span>(<span class="hljs-params">
  NDArray images, NDArray labels, Type dataType, <span class="hljs-keyword">bool</span> reshape // &lt;=
</span>)</span> <font></font>
{<font></font>
  EpochsCompleted = <span class="hljs-number">0</span>;<font></font>
  IndexInEpoch = <span class="hljs-number">0</span>;<font></font>
<font></font>
  NumOfExamples = images.shape[<span class="hljs-number">0</span>];<font></font>
<font></font>
  images = images.reshape(<font></font>
    images.shape[<span class="hljs-number">0</span>], images.shape[<span class="hljs-number">1</span>] * images.shape[<span class="hljs-number">2</span>]<font></font>
  );<font></font>
  images = images.astype(dataType);<font></font>
  <span class="hljs-comment">// for debug np.multiply performance</span>
  <span class="hljs-keyword">var</span> sw = <span class="hljs-keyword">new</span> Stopwatch();<font></font>
  sw.Start();<font></font>
  images = np.multiply(images, <span class="hljs-number">1.0f</span> / <span class="hljs-number">255.0f</span>);<font></font>
  sw.Stop();<font></font>
  Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{sw.ElapsedMilliseconds}</span>ms"</span>);<font></font>
  Data = images;<font></font>
<font></font>
  labels = labels.astype(dataType);<font></font>
  Labels = labels;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未使用构造函数参数“ reshape”。</font><font style="vertical-align: inherit;">MnistDataSet.cs 15 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与其他一些</font><font style="vertical-align: inherit;">奇怪现象</font><font style="vertical-align: inherit;">一样，这很可能是由于该功能远未完全实现，并且</font><font style="vertical-align: inherit;">将来</font><font style="vertical-align: inherit;">很有可能</font><font style="vertical-align: inherit;">在此构造函数中使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reshape</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是就目前而言，似乎他正被这样扔在这里。</font><font style="vertical-align: inherit;">如果确实做到“稍后”，那么最好在注释中加上一些标记。</font><font style="vertical-align: inherit;">如果不是，那么事实证明构造该对象的代码将不得不向构造函数中添加一个额外的参数，并且很可能不这样做会更方便。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">难以捉摸的null取消引用</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor[] _GatherV2Grad(Operation op, Tensor[] grads)<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span>((<span class="hljs-keyword">int</span>)axis_static == <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">var</span> params_tail_shape = params_shape.slice(<span class="hljs-keyword">new</span> NumSharp.Slice(start:<span class="hljs-number">1</span>));
    <span class="hljs-keyword">var</span> values_shape = array_ops.concat(
      <span class="hljs-keyword">new</span>[] { indices_size, params_tail_shape }, <span class="hljs-number">0</span><font></font>
    );<font></font>
    <span class="hljs-keyword">var</span> values = array_ops.reshape(grad, values_shape);<font></font>
    indices = array_ops.reshape(indices, indices_size);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tensor[]<font></font>
    {<font></font>
      <span class="hljs-keyword">new</span> IndexedSlices(values, indices, params_shape), <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-literal">null</span>,
      <span class="hljs-literal">null</span><font></font>
    };<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3146</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法中的第一个参数'values'可能为空取消引用。 “ _outputs.FirstOrDefault（）”可以返回默认的空值。 array_grad.cs 199 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要了解问题所在，您应该首先查看</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexedSlices</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数</font><i><font style="vertical-align: inherit;">代码</font></i><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">IndexedSlices</span>(<span class="hljs-params">
  Tensor values, Tensor indices, Tensor dense_shape = <span class="hljs-literal">null</span>
</span>)</span><font></font>
{<font></font>
  _values = values;<font></font>
  _indices = indices;<font></font>
  _dense_shape = dense_shape;<font></font>
<font></font>
  _values.Tag = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// &lt;=</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显然，将</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递</font><font style="vertical-align: inherit;">给此构造函数将引发异常。但是，为什么分析器认为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">可能包含</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio使用数据流分析技术，该技术可让您在代码的不同部分中找到变量的可能值集。警告告诉您，可以通过以下行返回指定变量中的null：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。但是，查看上面的代码，您可以发现</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">values</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量的</font><i><font style="vertical-align: inherit;">值</font></i><font style="vertical-align: inherit;">是</font><font style="vertical-align: inherit;">通过调用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape（grad，values_shape）获得的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。那么</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在哪里</font><font style="vertical-align: inherit;">呢？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实是，在分析数据流时，不仅要考虑当前函数，还要考虑所有函数；</font><font style="vertical-align: inherit;">PVS-Studio可获取有关任何位置的任何变量的可能值集的信息。</font><font style="vertical-align: inherit;">因此，警告表示</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array_ops.reshape（grad，values_shape）的实现</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含对</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs.FirstOrDefault（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的调用，</font><font style="vertical-align: inherit;">最终将返回其结果。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要验证这一点，请转到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重塑</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
            =&gt; gen_array_ops.reshape(tensor, shape, <span class="hljs-literal">null</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后转到</font><font style="vertical-align: inherit;">内部调用</font><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重塑</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">：</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Tensor reshape&lt;T1, T2&gt;(T1 tensor, T2 shape, <span class="hljs-keyword">string</span> name = <span class="hljs-literal">null</span>)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> _op = _op_def_lib._apply_op_helper(
    <span class="hljs-string">"Reshape"</span>, name, <span class="hljs-keyword">new</span> { tensor, shape }<font></font>
  );<font></font>
  <span class="hljs-keyword">return</span> _op.output;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_apply_op_helper</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
函数</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">包含</font><i><font style="vertical-align: inherit;">输出</font></i><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类的对象</font><font style="vertical-align: inherit;">。在收到其值后，警告中描述的代码将被调用：</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> Tensor output =&gt; _outputs.FirstOrDefault();</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当然是引用类型，因此其默认值将为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">从所有这些可以看出，PVS-Studio精心分析了代码的逻辑结构，深入到了调用的结构中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析仪完成工作，表明存在潜在问题的地方。</font><font style="vertical-align: inherit;">程序员必须检查</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_outputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">缺失</font><font style="vertical-align: inherit;">时是否会出现这种情况</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，静态分析将至少迫使开发人员注意可疑片段，以便评估错误是否可能实际上在那里发生。</font><font style="vertical-align: inherit;">使用这种方法，可以迅速减少未被注意到的错误数量。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待不可靠？</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> (LoopVar&lt;TItem&gt;, Tensor[]) _BuildLoop&lt;TItem&gt;(<font></font>
  ....<font></font>
) <span class="hljs-keyword">where</span> ....<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-comment">// Finds the closest enclosing non-None control pivot.</span>
  <span class="hljs-keyword">var</span> outer_context = _outer_context;
  <span class="hljs-keyword">object</span> control_pivot = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">while</span> (outer_context != <span class="hljs-literal">null</span> &amp;&amp; control_pivot == <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
  {<font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (control_pivot != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3032</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待该表达式不可靠，因为编译器可能会优化某些变量。</font><font style="vertical-align: inherit;">使用易失性变量或同步原语可以避免这种情况。</font><font style="vertical-align: inherit;">WhileContext.cs 212 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析器指示可以通过编译器优化这种等待的实现，但是我怀疑他们是否真的在此处尝试实现等待-很可能没有添加代码，并且将来会进一步开发。</font><font style="vertical-align: inherit;">考虑到这种做法在项目的其他地方使用</font><font style="vertical-align: inherit;">，可能值得</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处抛出NotImplementedException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">无论如何，我相信一些解释性评论显然不会受到伤害。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打破边界</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TensorShape</span>(<span class="hljs-params"><span class="hljs-keyword">int</span>[][] dims</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span>(dims.Length == <span class="hljs-number">1</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">switch</span> (dims[<span class="hljs-number">0</span>].Length)<font></font>
    {<font></font>
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: shape = <span class="hljs-keyword">new</span> Shape(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: shape = Shape.Vector((<span class="hljs-keyword">int</span>)dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: shape = Shape.Matrix(dims[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], dims[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]); <span class="hljs-keyword">break</span>; <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">default</span>: shape = <span class="hljs-keyword">new</span> Shape(dims[<span class="hljs-number">0</span>]); <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotImplementedException(<span class="hljs-string">"TensorShape int[][] dims"</span>);<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能索引超出范围。索引“ 1”指向“点心”范围之外。 TensorShape.cs 107 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我看到的奇怪代码段中，有一个真正的错误，很难注意到。以下片段在这里是错误的：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [1] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。从一个元素的数组中获取索引为1的元素显然是错误的。同时，如果将片段更改为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0] [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则会出现另一个错误-从</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dims [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数组获取索引为2的元素，该数组</font><font style="vertical-align: inherit;">的长度在这种情况下为2。因此，这个问题原来是好像是“双底”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论如何，开发人员应研究并纠正此代码片段。</font><font style="vertical-align: inherit;">我认为，该示例很好地说明了PVS-Studio中数据流分析的性能。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olepatka？</font></font></h3><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> _init_from_args(<span class="hljs-keyword">object</span> initial_value = <span class="hljs-literal">null</span>, ....) <span class="hljs-comment">// &lt;=</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> init_from_fn = initial_value.GetType().Name == <span class="hljs-string">"Func`1"</span>; <span class="hljs-comment">// &lt;=</span><font></font>
  ....<font></font>
  tf_with(...., scope =&gt;<font></font>
  {<font></font>
    ....<font></font>
    tf_with(...., <span class="hljs-keyword">delegate</span><font></font>
    {<font></font>
      initial_value = ops.convert_to_tensor(  <span class="hljs-comment">// &lt;=</span>
        init_from_fn ? (initial_value <span class="hljs-keyword">as</span> Func&lt;Tensor&gt;)():initial_value,<font></font>
        name: <span class="hljs-string">"initial_value"</span>,<font></font>
        dtype: dtype<font></font>
      );<font></font>
    });<font></font>
    _shape = shape ?? (initial_value <span class="hljs-keyword">as</span> Tensor).TensorShape;<font></font>
    _initial_value = initial_value <span class="hljs-keyword">as</span> Tensor; <span class="hljs-comment">// &lt;=</span><font></font>
    ....<font></font>
    _dtype = _initial_value.dtype.as_base_dtype(); <span class="hljs-comment">// &lt;=</span><font></font>
<font></font>
    <span class="hljs-keyword">if</span> (_in_graph_mode)<font></font>
    {<font></font>
      ....<font></font>
<font></font>
      <span class="hljs-keyword">if</span> (initial_value != <span class="hljs-literal">null</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      {<font></font>
        ....<font></font>
      }<font></font>
<font></font>
      ....<font></font>
    }<font></font>
<font></font>
    ....<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了理解上面的代码，还值得介绍tf_with函数的实现：</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">DebuggerStepThrough</span>] <span class="hljs-comment">// with "Just My Code" enabled this lets the </span>
[<span class="hljs-meta">DebuggerNonUserCode()</span>]  <span class="hljs-comment">//debugger break at the origin of the exception</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> tf_with&lt;T&gt;(<font></font>
  T py, Action&lt;T&gt; action<font></font>
) <span class="hljs-keyword">where</span> T : ITensorFlowObject<font></font>
{<font></font>
  <span class="hljs-keyword">try</span><font></font>
  {<font></font>
    py.__enter__();<font></font>
    action(py);<font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span><font></font>
  {<font></font>
    py.__exit__();<font></font>
    py.Dispose();<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分析器警告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：V3019类型转换后使用'as'关键字可能会将不正确的变量与null进行比较。检查变量“ initial_value”，“ _ initial_value”。 ResourceVariable.cs 137 </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_init_from_args</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是相当庞大的函数，因此已省略了许多片段。您可以通过单击</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全看到它</font><font style="vertical-align: inherit;">。尽管起初警告对我来说似乎并不严重，但经过研究，我意识到代码肯定有问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，应注意，可以在不传递参数的情况下调用该方法，默认情况下，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的该方法</font><font style="vertical-align: inherit;">为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。在这种情况下，第一行将引发异常。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其次，验证</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不等式</font><font style="vertical-align: inherit;">看起来很奇怪：如果</font><font style="vertical-align: inherit;">在调用</font><i><font style="vertical-align: inherit;">ops.convert_to_tensor</font></i><font style="vertical-align: inherit;">之后</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initial_value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实变为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则</font><i><font style="vertical-align: inherit;">_initial_value</font></i><font style="vertical-align: inherit;">将为</font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">，这意味着调用</font><i><font style="vertical-align: inherit;">_initial_value.dtype.as_base_dtype（）</font></i><font style="vertical-align: inherit;">也将引发异常。</font><font style="vertical-align: inherit;">
分析器提示您可能需要检查</font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">是否为</font><i><font style="vertical-align: inherit;">_initial_value</font></i><font style="vertical-align: inherit;">，但如上所述，引用此变量发生在此测试之前，因此此选项也将不正确。</font><font style="vertical-align: inherit;">
如果没有PVS-Studio，在如此庞大的功能中会注意到这个小错误吗？</font><font style="vertical-align: inherit;">我非常怀疑。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在一个包含许多奇怪代码示例的项目中，很多问题都可能被隐藏。程序员习惯于看到不可理解的事物，不再同时注意到错误。其后果可能是非常可悲的。的确，在分析器警告中也有错误的警告，但是，在大多数情况下，警告至少指示当人们查看时可能引起问题的代码片段。在故意编写奇怪的代码的情况下，值得留下一些解释，以便该片段对于以后将使用此代码的开发人员来说是清楚的（即使这意味着自己留下注释）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同时，静态分析工具（例如PVS-Studio）可以极大地帮助您发现潜在的错误和奇怪之处，使它们可见而不会被遗忘，并且随后对所有临时解决方案进行完善并转化为干净，结构化和稳定的工作方式编码。</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您想与说英语的人分享这篇文章，请使用以下链接：Nikita Lipilin。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">奇怪的代码如何隐藏错误？</font><font style="vertical-align: inherit;">TensorFlow.NET分析</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496234/index.html">为什么不使用Linux的主要原因</a></li>
<li><a href="../zh-CN496238/index.html">在危机中生存和成功的二十八个步骤</a></li>
<li><a href="../zh-CN496240/index.html">产品经理的产品发现101</a></li>
<li><a href="../zh-CN496242/index.html">赛博朋克已经在这里：小学生在Minecraft学习，学生在CS中进行身体测试：GO</a></li>
<li><a href="../zh-CN496248/index.html">挑战，光头和葡萄酒。HFLabs我们如何忍受自我隔离</a></li>
<li><a href="../zh-CN496252/index.html">气动偏置对中飞机</a></li>
<li><a href="../zh-CN496254/index.html">Rostelecom如何错误地将流量重定向到Google，AWS，Cloudflare等。</a></li>
<li><a href="../zh-CN496256/index.html">R上的机器学习：预测分析的专家技术</a></li>
<li><a href="../zh-CN496258/index.html">在线大战：一种新的经验交流形式。这个星期六</a></li>
<li><a href="../zh-CN496260/index.html">在家工作的网络安全提示</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>