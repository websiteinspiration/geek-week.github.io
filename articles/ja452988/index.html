<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✍🏿 👆🏾 🤞🏿 KubernetesダッシュボードとGitLabの統合 👩🏻‍🏫 💀 🧙🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kubernetesダッシュボードは、実行中のクラスターに関する最新情報を取得し、その管理を最小限に抑えるための使いやすいツールです。これらの機能へのアクセスが管理者/ DevOpsエンジニアだけでなく、コンソールにあまり慣れていない人や、kubectlや他のユーティリティとのやり取りのすべての複雑...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>KubernetesダッシュボードとGitLabの統合</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/452988/"><img src="https://habrastorage.org/webt/q9/u2/fc/q9u2fcnbkuqxxf0ii-lfyljnymc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetesダッシュボードは、実行中のクラスターに関する最新情報を取得し、その管理を最小限に抑えるための使いやすいツールです。</font><font style="vertical-align: inherit;">これらの機能へのアクセスが管理者/ DevOpsエンジニアだけでなく、コンソールにあまり慣れていない人や、kubectlや他のユーティリティとのやり取りのすべての複雑さを扱うつもりがない人にも必要な場合は、さらに感謝します。</font><font style="vertical-align: inherit;">つまり、開発者はKubernetesのウェブインターフェースにすばやくアクセスしたいと考えていました。GitLabを使用しているため、ソリューションは自然に生まれました。</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どうしてこれなの？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接の開発者は、タスクをデバッグするためのK8sダッシュボードのようなツールに興味があるかもしれません。ログやリソースを表示したり、ポッドを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">強制終了したり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Deployments / StatefulSetsをスケーリングしたり、コンテナコンソールに移動したりすることもできます（たとえば、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">kubectl-debug</font></a><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">使用</font></a><font style="vertical-align: inherit;">するなど、別の方法があるリクエストもあります</font><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、マネージャーがクラスターを確認したいときに心理的な瞬間があります。「すべてが緑色」であることを確認し、「すべてが機能する」ことを落ち着かせます（もちろん、これはかなり相対的なものですが、これは記事の範囲を超えています。） ）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
標準CIシステムとして、我々は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用します</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitLab：すべての開発者もそれを使用しています。</font><font style="vertical-align: inherit;">したがって、彼らにアクセス権を与えるために、ダッシュボードをGitLabのアカウントと統合することは論理的でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、NGINX Ingressを使用していることにも注意してください。</font><font style="vertical-align: inherit;">他の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イングレスソリューション</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する場合は、承認のためにアノテーションの類似物を個別に見つける必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合を試す</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダッシュボードをインストール</font></font></h3><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以下に説明する手順を繰り返す場合は、不要な操作を回避するために、最初に次の字幕に目を通してください。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
多くのインストールでこの統合を使用しているため、インストールを自動化しました。これに必要なソースは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別なGitHubリポジトリで公開されます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これらは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式のダッシュボードリポジトリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からわずかに変更されたYAML設定と、</font><font style="vertical-align: inherit;">迅速なデプロイのためのBashスクリプトに</font><font style="vertical-align: inherit;">基づいてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスクリプトは、ダッシュボードをクラスターにインストールし、GitLabと統合するように構成します。</font></font><br>
<br>
<pre><code class="bash hljs">$ ./ctl.sh  <font></font>
Usage: ctl.sh [OPTION]... --gitlab-url GITLAB_URL --oauth2-id ID --oauth2-secret SECRET --dashboard-url DASHBOARD_URL<font></font>
Install kubernetes-dashboard to Kubernetes cluster.<font></font>
Mandatory arguments:<font></font>
 -i, --install                install into <span class="hljs-string">'kube-system'</span> namespace<font></font>
 -u, --upgrade                upgrade existing installation, will reuse password and host names<font></font>
 -d, --delete                 remove everything, including the namespace<font></font>
     --gitlab-url             <span class="hljs-built_in">set</span> gitlab url with schema (https://gitlab.example.com)<font></font>
     --oauth2-id              <span class="hljs-built_in">set</span> OAUTH2_PROXY_CLIENT_ID from gitlab<font></font>
     --oauth2-secret          <span class="hljs-built_in">set</span> OAUTH2_PROXY_CLIENT_SECRET from gitlab<font></font>
     --dashboard-url          <span class="hljs-built_in">set</span> dashboard url without schema (dashboard.example.com)<font></font>
Optional arguments:<font></font>
 -h, --<span class="hljs-built_in">help</span>                   output this message</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、使用する前に、GitLab：管理領域→アプリケーションに移動し、将来のパネル用に新しいアプリケーションを追加する必要があります。</font><font style="vertical-align: inherit;">それを「kubernetesダッシュボード」と呼ぼう：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p1/iz/mo/p1izmot-ncabrufaur9vulpqmfc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加の結果として、GitLabはハッシュを提供します：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t_/hy/d-/t_hyd-ueebs_0mnce1xiyujfkq0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらはスクリプトへの引数として使用されます。</font><font style="vertical-align: inherit;">その結果、インストールは次のようになります。</font></font><br>
<br>
<pre><code class="bash hljs">$ ./ctl.sh -i --gitlab-url https://gitlab.example.com --oauth2-id 6a52769e… --oauth2-secret 6b79168f… --dashboard-url dashboard.example.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、すべてが始まったことを確認します。</font></font><br>
<br>
<pre><code class="bash hljs">$ kubectl -n kube-system get pod | egrep <span class="hljs-string">'(dash|oauth)'</span><font></font>
kubernetes-dashboard-76b55bc9f8-xpncp   1/1       Running   0          14s<font></font>
oauth2-proxy-5586ccf95c-czp2v           1/1       Running   0          14s</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅かれ早かれ、すべてが始まりますが、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認証はすぐには機能しません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">！</font><font style="vertical-align: inherit;">実際には、使用されるイメージ（他のイメージの状況も同様）では、コールバックのリダイレクトキャッチプロセスが正しく実装されていません。</font><font style="vertical-align: inherit;">この状況は、oauthがそれ自体（oauth）が提供するCookieを消去するという事実につながります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題は、パッチを使用してoauthイメージをアセンブルすることで解決されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oauthへのパッチと再インストール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、次のDockerfileを使用します。</font></font><br>
<br>
<pre><code class="plaintext hljs">FROM golang:1.9-alpine3.7<font></font>
WORKDIR /go/src/github.com/bitly/oauth2_proxy<font></font>
<font></font>
RUN apk --update add make git build-base curl bash ca-certificates wget \<font></font>
&amp;&amp; update-ca-certificates \<font></font>
&amp;&amp; go get -u github.com/golang/dep/cmd/dep \<font></font>
&amp;&amp; curl -sSO https://raw.githubusercontent.com/pote/gpm/v1.4.0/bin/gpm \<font></font>
&amp;&amp; chmod +x gpm \<font></font>
&amp;&amp; mv gpm /usr/local/bin<font></font>
RUN git clone https://github.com/bitly/oauth2_proxy.git . \<font></font>
&amp;&amp; git checkout fa2771998a98a5bfdfa3c3503757668ac4f1c8ec<font></font>
ADD rd.patch .<font></font>
RUN patch -p1 &lt; rd.patch &amp;&amp; ./dist.sh<font></font>
<font></font>
FROM alpine:3.7<font></font>
RUN apk --update add curl bash  ca-certificates &amp;&amp; update-ca-certificates<font></font>
COPY --from=0 /go/src/github.com/bitly/oauth2_proxy/dist/ /bin/<font></font>
<font></font>
EXPOSE 8080 4180<font></font>
ENTRYPOINT [ "/bin/oauth2_proxy" ]<font></font>
CMD [ "--upstream=http://0.0.0.0:8080/", "--http-address=0.0.0.0:4180" ]</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、これがrd.patchパッチ自体です</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">diff --git a/Gopkg.lock b/Gopkg.lock<font></font>
index 5a3758a..1294a90 100644<font></font>
--- a/Gopkg.lock<font></font>
+++ b/Gopkg.lock<font></font>
@@ -131,7 +131,7 @@<font></font>
   version = "v1.0.0"<font></font>
 <font></font>
 [[projects]]<font></font>
-  name = "gopkg.in/fsnotify.v1"<font></font>
+  name = "gopkg.in/fsnotify/fsnotify.v1"<font></font>
   packages = ["."]<font></font>
   revision = "836bfd95fecc0f1511dd66bdbf2b5b61ab8b00b6"<font></font>
   version = "v1.2.11"<font></font>
@@ -149,6 +149,6 @@<font></font>
 [solve-meta]<font></font>
   analyzer-name = "dep"<font></font>
   analyzer-version = 1<font></font>
-  inputs-digest = "b502c41a61115d14d6379be26b0300f65d173bdad852f0170d387ebf2d7ec173"<font></font>
+  inputs-digest = "cfdd05348394cd0597edb858bdba5681665358a963356ed248d98f39373c33b5"<font></font>
   solver-name = "gps-cdcl"<font></font>
   solver-version = 1<font></font>
diff --git a/Gopkg.toml b/Gopkg.toml<font></font>
index c4005e1..422bd43 100644<font></font>
--- a/Gopkg.toml<font></font>
+++ b/Gopkg.toml<font></font>
@@ -4,7 +4,7 @@<font></font>
 #<font></font>
 <font></font>
 [[constraint]]<font></font>
-  name = "github.com/18F/hmacauth"<font></font>
+  name = "github.com/mbland/hmacauth"<font></font>
   version = "~1.0.1"<font></font>
 <font></font>
 [[constraint]]<font></font>
@@ -36,7 +36,7 @@<font></font>
   name = "google.golang.org/api"<font></font>
 <font></font>
 [[constraint]]<font></font>
-  name = "gopkg.in/fsnotify.v1"<font></font>
+  name = "gopkg.in/fsnotify/fsnotify.v1"<font></font>
   version = "~1.2.0"<font></font>
 <font></font>
 [[constraint]]<font></font>
diff --git a/dist.sh b/dist.sh<font></font>
index a00318b..92990d4 100755<font></font>
--- a/dist.sh<font></font>
+++ b/dist.sh<font></font>
@@ -14,25 +14,13 @@ goversion=$(go version | awk '{print $3}')<font></font>
 sha256sum=()<font></font>
 <font></font>
 echo "... running tests"<font></font>
-./test.sh<font></font>
+#./test.sh<font></font>
 <font></font>
-for os in windows linux darwin; do<font></font>
-    echo "... building v$version for $os/$arch"<font></font>
-    EXT=<font></font>
-    if [ $os = windows ]; then<font></font>
-        EXT=".exe"<font></font>
-    fi<font></font>
-    BUILD=$(mktemp -d ${TMPDIR:-/tmp}/oauth2_proxy.XXXXXX)<font></font>
-    TARGET="oauth2_proxy-$version.$os-$arch.$goversion"<font></font>
-    FILENAME="oauth2_proxy-$version.$os-$arch$EXT"<font></font>
-    GOOS=$os GOARCH=$arch CGO_ENABLED=0 \<font></font>
-        go build -ldflags="-s -w" -o $BUILD/$TARGET/$FILENAME || exit 1<font></font>
-    pushd $BUILD/$TARGET<font></font>
-    sha256sum+=("$(shasum -a 256 $FILENAME || exit 1)")<font></font>
-    cd .. &amp;&amp; tar czvf $TARGET.tar.gz $TARGET<font></font>
-    mv $TARGET.tar.gz $DIR/dist<font></font>
-    popd<font></font>
-done<font></font>
+os='linux'<font></font>
+echo "... building v$version for $os/$arch"<font></font>
+TARGET="oauth2_proxy-$version.$os-$arch.$goversion"<font></font>
+GOOS=$os GOARCH=$arch CGO_ENABLED=0 \<font></font>
+    go build -ldflags="-s -w" -o ./dist/oauth2_proxy || exit 1<font></font>
 <font></font>
 checksum_file="sha256sum.txt"<font></font>
 cd $DIR/dist<font></font>
diff --git a/oauthproxy.go b/oauthproxy.go<font></font>
index 21e5dfc..df9101a 100644<font></font>
--- a/oauthproxy.go<font></font>
+++ b/oauthproxy.go<font></font>
@@ -381,7 +381,9 @@ func (p *OAuthProxy) SignInPage(rw http.ResponseWriter, req *http.Request, code<font></font>
 	if redirect_url == p.SignInPath {<font></font>
 		redirect_url = "/"<font></font>
 	}<font></font>
-<font></font>
+	if req.FormValue("rd") != "" {<font></font>
+		redirect_url = req.FormValue("rd")<font></font>
+	}<font></font>
 	t := struct {<font></font>
 		ProviderName  string<font></font>
 		SignInMessage string<font></font>
diff --git a/watcher.go b/watcher.go<font></font>
index bedb9f8..4b83946 100644<font></font>
--- a/watcher.go<font></font>
+++ b/watcher.go<font></font>
@@ -7,8 +7,7 @@ import (<font></font>
 	"os"<font></font>
 	"path/filepath"<font></font>
 	"time"<font></font>
-<font></font>
-	"gopkg.in/fsnotify.v1"<font></font>
+	"gopkg.in/fsnotify/fsnotify.v1"<font></font>
 )<font></font>
 <font></font>
 func WaitForReplacement(filename string, op fsnotify.Op,<font></font>
<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これでイメージをビルドして、GitLabにプッシュできます。</font><font style="vertical-align: inherit;">次に、</font></font><code>manifests/kube-dashboard-oauth2-proxy.yaml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目的の画像の使用を示します（独自の画像に置き換えてください）。</font></font><br>
<br>
<pre><code class="plaintext hljs"> image: docker.io/colemickens/oauth2_proxy:latest</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
承認によってレジストリが閉鎖されている場合は、イメージをプルするためのシークレットを追加することを忘れないでください。</font></font><br>
<br>
<pre><code class="plaintext hljs">      imagePullSecrets:<font></font>
     - name: gitlab-registry</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そして、レジストリのシークレット自体を追加します。</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
apiVersion: v1<font></font>
data:<font></font>
 .dockercfg: eyJyZWdpc3RyeS5jb21wYW55LmNvbSI6IHsKICJ1c2VybmFtZSI6ICJvYXV0aDIiLAogInBhc3N3b3JkIjogIlBBU1NXT1JEIiwKICJhdXRoIjogIkFVVEhfVE9LRU4iLAogImVtYWlsIjogIm1haWxAY29tcGFueS5jb20iCn0KfQoK<font></font>
=<font></font>
kind: Secret<font></font>
metadata:<font></font>
 annotations:<font></font>
 name: gitlab-registry<font></font>
 namespace: kube-system<font></font>
type: kubernetes.io/dockercfg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意深い読者は、上記の長い行が構成のbase64であることがわかります。</font></font><br>
<br>
<pre><code class="json hljs">{<span class="hljs-attr">"registry.company.com"</span>: {
 <span class="hljs-attr">"username"</span>: <span class="hljs-string">"oauth2"</span>,
 <span class="hljs-attr">"password"</span>: <span class="hljs-string">"PASSWORD"</span>,
 <span class="hljs-attr">"auth"</span>: <span class="hljs-string">"AUTH_TOKEN"</span>,
 <span class="hljs-attr">"email"</span>: <span class="hljs-string">"mail@company.com"</span><font></font>
}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、GitLabのユーザーデータです。これは、Kubernetesがレジストリからイメージをプルするためのコードです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが完了したら、次のコマンドを使用して、現在の（正しく機能していない）ダッシュボードのインストールを削除できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">$ ./ctl.sh -d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...そしてすべてを再インストールします：</font></font><br>
<br>
<pre><code class="plaintext hljs">$ ./ctl.sh -i --gitlab-url https://gitlab.example.com --oauth2-id 6a52769e… --oauth2-secret 6b79168f… --dashboard-url dashboard.example.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダッシュボードに移動して、古風なログインボタンを見つけます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ar/oy/af/aroyafgjtqfn9o57jizhulg1d6o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリックすると、GitLabが私たちに会い、通常のページにログインすることを提案します（もちろん、以前にそこにログインしていなかった場合）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ip/ca/e_/ipcae_0rklsslqgumhnehjf0fq8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GitLab資格情報にログインすると、すべてが起こりました：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ai/_m/cm/ai_mcm4gqbemsi0lvwsf34mvirs.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダッシュボード機能について</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前にKubernetesを使用していなかった開発者の場合、または何らかの理由で以前にダッシュボードに出会ったことがない場合は、その機能のいくつかを説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、「すべてが緑色」であることがわかります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2u/ek/6n/2uek6nwrydcjgctphjcgvsficu8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポッドごとに、環境変数、デフレートされたイメージ、起動引数、それらのステータスなど、より詳細なデータが利用可能です</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/g7/xt/hvg7xtedmnc0scqesqocl3vccym.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。展開ステータスが表示されます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8i/sk/ee/8iskeeib2sfxz84tgq0jpewgp3a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...およびその他の詳細：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9h/j2/mg/9hj2mglvqk-nxhgk90rnpmqaq24.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...デプロイをスケーリングすることも可能</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jd/7y/7i/jd7y7ilc3dfopw0jgnx1dvs4vqa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。この操作の結果：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bp/uq/xb/bpuqxbeam7ha7aqwsix0thed9go.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事の冒頭ですでに述べた他の便利な機能の中に、ログの表示があり</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ep/bf/ko/epbfkognsudoi6zwdofu5e0n-k4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます</font><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">...および選択したポッドのコンテナコンソールに入る機能：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b2/xc/-9/b2xc-9nbeqzfjdhzv6tbh5f2le8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、制限/リクエストも確認できますノード上の：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4x/s-/f7/4xs-f7lpnyokbn8jlgqjkhvq_fi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これはパネルのすべての機能ではありませんが、一般的な考えが発展したことを願っています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統合とダッシュボードの欠点</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明されている統合では、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセス制御</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はありません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これにより、GitLabへのアクセス権を持つすべてのユーザーがダッシュボードにアクセスできます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RBACで定義され</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ているダッシュボード自体の権限に対応して、ダッシュボードへの同じアクセス権があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">明らかに、これはすべての人に適しているわけではありませんが、私たちのケースでは十分であることがわかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダッシュボード自体の目立つマイナスの中で、私は次のことに注意します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initコンテナのコンソールに入るのは不可能です。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ClusterRoleで修正可能ですが、DeploymentsとStatefulSetを編集することはできません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ダッシュボードの最新バージョンのKubernetesとの互換性とプロジェクトの将来には疑問が生じます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後者の問題には特別な注意が必要です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダッシュボードのステータスと代替案</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトの最新バージョン（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1.10.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">で提示された、Kubernetesリリースとのダッシュボード互換性テーブル</font><font style="vertical-align: inherit;">はあまり満足できません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lp/o2/lq/lpo2lq-3uxxc0atra9aqkcvrzm0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それにもかかわらず、（1月にすでに採用されている）</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PR＃</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3476があり、K8s 1.13のサポートを発表しています。</font><font style="vertical-align: inherit;">さらに、プロジェクトの問題の中には、K8s 1.14でパネルを使用しているユーザーに関する記述があります。</font><font style="vertical-align: inherit;">最後</font><font style="vertical-align: inherit;">に、プロジェクトコードベースへの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミット</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は停止しません。</font><font style="vertical-align: inherit;">したがって、（少なくとも！）プロジェクトの実際のステータスは、公式の互換性テーブルから最初に表示されるほど悪くはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、ダッシュボードには代替手段があります。</font><font style="vertical-align: inherit;">その中で：</font></font><br>
<br>
<ol>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">K8Dash</a> —   (     ),    ,           .   «  », ..    ,      .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">OpenShift Console</a> — -  Red Hat OpenShift, , ,        ,    .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Kubernator</a> —  ,     ( Dashboard)       .    ,    .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Polaris</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は先日</font><font style="vertical-align: inherit;">、パネルの機能（クラスターの現在の状態を表示しますが、そのオブジェクトを管理しません）と自動「ベストプラクティス検証」（クラスターで実行されているデプロイメントの正しい構成をチェックします）の機能を組み合わせ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">発表しました</font></a><font style="vertical-align: inherit;">。</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論の代わりに</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダッシュボードは、サービスを提供するKubernetesクラスターの標準ツールです。</font><font style="vertical-align: inherit;">GitLabとの統合も「デフォルトインストール」の一部になっています。多くの開発者がこのパネルでの機会に満足しているからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetesダッシュボードには、オープンソースコミュニティからの代替案が定期的に用意されています（私たちはそれらを検討させていただきます）。しかし、この段階では、この決定を続けています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのブログも読んでください：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubenetes用のKubeboxおよびその他のコンソールシェル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KubernetesとGitLabによるベストCI / CDプラクティス（レビューとビデオレポート）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dappとGitLab CIを使用してKubernetesでアプリケーションをビルドおよびインストールする</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitLab CIは、本番環境で継続的な統合と配信を実現します。</font><font style="vertical-align: inherit;">パート1：パイプライン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD。</font><font style="vertical-align: inherit;">whochレポートによると、パッチでエラーが見つかりました（タブはスペースに置き換えられました）。</font><font style="vertical-align: inherit;">記事のパッチが更新されました。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja452978/index.html">ok.tech：データの説明</a></li>
<li><a href="../ja452980/index.html">AWP KBR-N-非難する準備をしていなかったX日が近づく</a></li>
<li><a href="../ja452982/index.html">MS ProjectとRedmineのシンプルな統合</a></li>
<li><a href="../ja452984/index.html">ArduinoとRaspberryが非合法化</a></li>
<li><a href="../ja452986/index.html">Postgresのロック：ロックを操作するための7つのヒント</a></li>
<li><a href="../ja452990/index.html">「WebスタックとC ++の両方を理解する必要があります」：Chrome DevToolsの開発についてだけでなく、Alexei Kozyatinskyへのインタビュー</a></li>
<li><a href="../ja452992/index.html">CATIA CADプラットフォーム3DEXPERIENCEは、レオナルドダヴィンチの軍艦を再現するのに役立ちました</a></li>
<li><a href="../ja452996/index.html">ヴォロネジでの社内データサイエンストレーニングとテーマ別ミタップ</a></li>
<li><a href="../ja452998/index.html">アンドロイド StackView（Tinderなど）に基づくカード形式の動的ウィジェット</a></li>
<li><a href="../ja453000/index.html">荷物ショップ：BUgHunting。1日あたり200個のバグを見つける方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>