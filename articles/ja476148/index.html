<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’‡ğŸ½ ğŸ¤œğŸ» â˜¸ï¸ FreeBSDã§ã®postfix + dovecot + mysql ğŸ‘©â€ğŸ« ğŸ¤µ ğŸ™ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‰æ›¸ã
 é•·ã„é–“ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’å‹‰å¼·ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€æ‰‹ãŒå±Šã‹ãªããªã£ã¦ã—ã¾ã„ã€ãªã‹ãªã‹æ­£ã—ã„æƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ããªã‹ã£ãŸã®ã§ã€ãªã‚‹ã¹ãè©³ç´°ãªå‡ºç‰ˆç‰©ã‚’æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚ã“ã®ãƒ‘ãƒ–ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€postfixã€dovecotã€mysqlã€postfixadminã ã‘ã§ãªãã€spamassas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>FreeBSDã§ã®postfix + dovecot + mysql</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476148/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰æ›¸ã</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é•·ã„é–“ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’å‹‰å¼·ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€æ‰‹ãŒå±Šã‹ãªããªã£ã¦ã—ã¾ã„ã€ãªã‹ãªã‹æ­£ã—ã„æƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ããªã‹ã£ãŸã®ã§ã€ãªã‚‹ã¹ãè©³ç´°ãªå‡ºç‰ˆç‰©ã‚’æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã®ãƒ‘ãƒ–ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€postfixã€dovecotã€mysqlã€postfixadminã ã‘ã§ãªãã€spamassassinã€clamav-milterï¼ˆãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ç”¨ã®clamavã®ç‰¹åˆ¥ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ã€postgreyã€ãŠã‚ˆã³ã‚¹ãƒ‘ãƒ ã‚’Spamãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«è»¢é€ã™ã‚‹å¯èƒ½æ€§ï¼ˆdovecot-ãƒ”ã‚¸ãƒ§ãƒ³ãƒ›ãƒ¼ãƒ«ï¼‰ã€‚</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ä½œæ¥­ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼ˆpostfixã€dovecotãŠã‚ˆã³dovecot-pigeonholeã¯ãƒãƒ¼ãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚dovecot-sieveã¯åŸå‰‡ã¨ã—ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ãŒã€æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒãƒ¼ãƒˆã«ã‚ã‚Šã€ã“ã®ãŸã‚ã€dovecotã¨dovecot-ã®é–“ã«äº’æ›æ€§ãŒãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãµã‚‹ã„ï¼‰ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">pkg install apache24 php73 mod_php73 php73-extensions php73-mysqli php73-mbstring php73-openssl clamav-milter postgrey spamassassin mysql57-server openssl wget
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€å¿…è¦ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’è‡ªå‹•å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">#postfix  dovecot  ,      <font></font>
sysrc postfix_enable="YES"<font></font>
sysrc dovecot_enable="YES"<font></font>
<font></font>
sysrc mysql_enable="YES"<font></font>
sysrc apache24_enable="YES"<font></font>
<font></font>
sysrc spamd_flags="-u spamd -H /var/spool/spamd"<font></font>
sysrc spamd_enable="YES"<font></font>
<font></font>
sysrc postgrey_enable="YES"<font></font>
<font></font>
sysrc clamav_clamd_enable="YES"<font></font>
sysrc clamav_milter_enable="YES"<font></font>
sysrc clamav_freshclam_enable="YES"<font></font>
#freshclam        12 <font></font>
sysrc clamav_freshclam_flags="--daemon --checks=12"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">service apache24 start<font></font>
service mysql-server start<font></font>
#  spamassassin      <font></font>
sa-update<font></font>
sa-compile<font></font>
service sa-spamd start<font></font>
#   clamav  <font></font>
freshclam<font></font>
service clamav-clamd start<font></font>
service clamav-freshclam start<font></font>
service clamav-milter start<font></font>
#  postgrey    (/usr/local/etc/rc.d/postgrey),       ""   4-   ,    : ${postgrey_flags:=--inet=10023}     :<font></font>
: ${postgrey_flags:=--inet=10023 --auto-whitelist-clients=4}<font></font>
service postgrey start<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
phpãŒApacheã§å‹•ä½œã—ã€postfixadminãŒæ­£ã—ãå‹•ä½œã™ã‚‹ãŸã‚ã«å¿…è¦ãªè¡Œã‚’httpd.confã«è¿½åŠ ã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">&lt;FilesMatch "\.php$"&gt;<font></font>
    SetHandler application/x-httpd-php<font></font>
&lt;/FilesMatch&gt;<font></font>
&lt;FilesMatch "\.phps$"&gt;<font></font>
    SetHandler application/x-httpd-php-source<font></font>
&lt;/FilesMatch&gt;<font></font>
<font></font>
&lt;IfModule dir_module&gt;<font></font>
    DirectoryIndex index.php<font></font>
&lt;/IfModule&gt;<font></font>
<font></font>
#         postfixadmin<font></font>
<font></font>
DocumentRoot "/usr/local/www/apache24/data/postfixadmin-3.2/public"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦postfixadminã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™</font></font><br>
<br>
<pre><code class="plaintext hljs">cd /usr/local/www/apache24/data
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
postfixadminã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆåŸ·ç­†æ™‚ç‚¹ã§ã¯ã€ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯3.2ã§ã—ãŸï¼‰</font></font><br>
<br>
<pre><code class="plaintext hljs">wget --no-check-certificate https://sourceforge.net/projects/postfixadmin/files/postfixadmin/postfixadmin-3.2/postfixadmin-3.2.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®å¾Œã€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è§£å‡ã—ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰€æœ‰è€…ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">gzip -d postfixadmin-3.2.tar.gz<font></font>
tar -xvf postfixadmin-3.2.tar<font></font>
chown -R www:www /usr/local/www/apache24/data<font></font>
service apache24 restart<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€postfixadminã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æº–å‚™ã—ã€mysql-secure-installationã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä½œæˆã™ã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã€alter userã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦mysqlã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚mysqlã®åˆæœŸè¨­å®šã§ã€mysqlã¨å…¥åŠ›ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨æ¨©é™ã‚’ä½œæˆã—ã¾ã™ã€‚å½¼å¥³ã®ãŸã‚ã«ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">mysql -p -r<font></font>
alter user 'root'@'localhost' identified by 'password123';<font></font>
create database postfix;<font></font>
grant all privileges on postfix.* to 'postfix'@'localhost' identified by 'password123';<font></font>
exit<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ§‹æˆã—ãŸã‚‰ã€config.inc.phpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯/usr/local/www/apache24/data/postfixadmin-3.2/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€ã„ãã¤ã‹ã®è¡Œã‚’ç·¨é›†ã—ã¦ã€è¨­å®šã‚’å¤‰æ›´ã—ãŸå¾Œã€Apacheã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚/usr/local/www/apache24/data/postfixadmin-3.2ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«templates_cãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã‚Œã«wwwæ‰€æœ‰è€…ã‚’å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ã‚‚ã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">mkdir /usr/local/www/apache24/data/postfixadmin-3.2/templates_c<font></font>
chown -R www:www /usr/local/www/apache24/data/postfixadmin-3.2/templates_c<font></font>
<font></font>
$CONF['configured'] = true<font></font>
#       postfixadmin     .<font></font>
$CONF['setup_password'] = 'dd28fb2139a3bca426f02f60e6877fd5:13d2703c477b0ab85858e3ac5e076a0a7a477315';<font></font>
$CONF['default_language'] = 'ru'<font></font>
$CONF['database_type'] = 'mysqli';<font></font>
$CONF['database_host'] = 'localhost';<font></font>
$CONF['database_user'] = 'postfix';<font></font>
#          <font></font>
$CONF['database_password'] = 'password123';<font></font>
$CONF['database_name'] = 'postfix';<font></font>
<font></font>
service apache24 restart<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã«ã¯ã€postfix.orgã§ææ¡ˆã•ã‚Œã¦ã„ã‚‹æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ç‹¬è‡ªã®èªè¨¼å±€ã‚’ä½œæˆã—ã€/ etc / sslãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">cd /etc/ssl<font></font>
/usr/local/openssl/misc/CA.pl -newca<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œä¸­ã«ã€è¨¼æ˜æ›¸ã®åå‰ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚ä½•ã‚‚å…¥åŠ›ã›ãšã«Enterã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã£ã¦è¨¼æ˜æ›¸ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã«æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ãã®å¾Œã€è¨¼æ˜æ›¸ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®æ¨™æº–çš„ãªè³ªå•ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ç§˜å¯†éµï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—ï¼‰ã¨ç½²åã•ã‚Œã¦ã„ãªã„å…¬é–‹éµè¨¼æ˜æ›¸ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆçµ„ç¹”å˜ä½åï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ãªã©ï¼‰[]ã¯ã€ä¸Šè¨˜ã§ä½œæˆã—ãŸè¨¼æ˜æ›¸ã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¨ã¯ç•°ãªã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">openssl req -new -newkey rsa:4096 -nodes -keyout foo-key.pem -out foo-req.pem
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¬é–‹éµè¨¼æ˜æ›¸ã«ç½²åã—ã¾ã™ï¼ˆå¿…è¦ãªæ—¥æ•°ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs">openssl ca -out foo-cert.pem -days 365 -infiles foo-req.pem
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œæˆã—ãŸè¨¼æ˜æ›¸ã‚’ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ®‹ã™ã‹ã€ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è»¢é€ã—ã¾ã™ã€‚è¨¼æ˜æ›¸ãŒã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ã¨ã„ã†äº‹å®Ÿã‚’è€ƒæ…®ã—ã¦ã€ã€Œpostfixã€ãŠã‚ˆã³ã€Œdovecoteã€ã®è¨­å®šãŒæ§‹æˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vmailãƒ¦ãƒ¼ã‚¶ãƒ¼</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
postfixã€dovecotã€dovecot-pigeonholeã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—ã¯è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ï¼‰vmailã€ãŠã‚ˆã³ãƒ¡ãƒ¼ãƒ«ãŒé…ç½®ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚ </font></font><br>
<br>
<pre><code class="plaintext hljs">pw useradd -n vmail -s /usr/sbin/nologin -u 1000 -d /var/vmail
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¡ãƒ¼ãƒ«ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€vmailãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€æœ‰è€…ã‚’è¨­å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">mkdir /var/vmail<font></font>
chown -R vmail:vmail /var/vmail<font></font>
chmod -R 744 /var/vmail<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postfixã€dovecotã€dovecot-pigeonhole</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã«æ›¸ã„ãŸã‚ˆã†ã«ã€ãƒãƒ¼ãƒˆã‹ã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã€ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒãƒ¼ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è§£å‡ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">portsnap fetch extract
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒãƒ¼ãƒˆã‚’è§£å‡ã—ãŸå¾Œã€dovecotãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€ãƒãƒ¼ãƒˆã‚’æ§‹æˆã—ï¼ˆmysqlã®ã‚µãƒãƒ¼ãƒˆã«æ³¨æ„ï¼‰ã€ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆBATCH = yesã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«è³ªå•ã—ãªã„ã‚ˆã†ã«makeã«æŒ‡ç¤ºã—ã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">cd /usr/ports/mail/dovecot<font></font>
make config<font></font>
make BATCH=yes install clean<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
postfixã¨dovecot </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-pigeonhole dovecot-pigeonholeã§ã‚‚</font><font style="vertical-align: inherit;">åŒã˜ã‚ˆã†ã«ã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">cd /usr/ports/mail/dovecot-pigeonhole<font></font>
make BATCH=yes install clean<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
postfixï¼šãƒãƒ¼ãƒˆè¨­å®šã®mysqlã‚µãƒãƒ¼ãƒˆã‚‚ç¢ºèªã—ã¦ãã ã•ã„</font></font><br>
<br>
<pre><code class="plaintext hljs">cd  /usr/ports/mail/postfix-sasl<font></font>
make config<font></font>
make BATCH=yes install clean<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dovecotã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ "configs"ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs"> cp -R /usr/local/etc/dovecot/example-config/*  /usr/local/etc/dovecot
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
postfixã¨dovecotã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚‰ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹å§‹ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">service postfix start<font></font>
service dovecot start<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ãƒ‘ãƒ ã‚’spamãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«é€ä¿¡ã™ã‚‹ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚å¿…è¦ã§ã™ã€‚ç§ã®å ´åˆã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯/usr/local/etc/dovecot/conf.dãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚Šã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã¯defã§ã™ã€‚ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç”¨ã®ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™æŒ‡å®šã•ã‚ŒãŸvmailãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰€æœ‰è€…ã‚’è¨­å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">mkdir /usr/local/etc/dovecot/conf.d/def<font></font>
touch /usr/local/etc/dovecot/conf.d/def/default.sieve<font></font>
chown -R vmail:vmail /usr/local/etc/dovecot/conf.d/def<font></font>
chmod -R 744 /usr/local/etc/dovecot/conf.d/def<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«è¡Œã‚’é…ç½®ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">require "fileinto";<font></font>
if header :contains "X-Spam-Flag" "YES" {<font></font>
    fileinto "Junk";<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ§‹æˆ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚³ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã€Œæ§‹æˆã€ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚spamassassinã®ã€Œæ§‹æˆã€ã®ã¿ã‚’ç–‘ã„ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã«æ­£ã—ã„èª¬æ˜ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸãŸã‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Œæ§‹æˆã€ã®ã¾ã¾ã«ã—ã¾ã—ãŸï¼‰ã€spamassassinã‚’ã‚ˆã‚Šé©åˆ‡ã«æ§‹æˆã™ã‚‹æ–¹æ³•ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postfix</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã€ã‚¯ã‚©ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã¨å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">mkdir /usr/local/etc/postfix/mysql<font></font>
touch /usr/local/etc/postfix/mysql/relay_domains.cf<font></font>
touch /usr/local/etc/postfix/mysql/virtual_alias_maps.cf<font></font>
touch /usr/local/etc/postfix/mysql/virtual_alias_domain_maps.cf<font></font>
touch /usr/local/etc/postfix/mysql/virtual_mailbox_maps.cf<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
relay_domains.cfã«</font><font style="vertical-align: inherit;">ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">hosts = 127.0.0.1<font></font>
user = postfix<font></font>
password = password123<font></font>
dbname = postfix<font></font>
query = SELECT domain FROM domain WHERE domain='%s' and backupmx = '1'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
virtual_alias_maps.cf</font></font><br>
<br>
<pre><code class="plaintext hljs">hosts = 127.0.0.1<font></font>
user = postfix<font></font>
password = password123<font></font>
dbname = postfix<font></font>
query = SELECT goto FROM alias WHERE address='%s' AND active ='1'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
virtual_alias_domain_maps.cf</font></font><br>
<br>
<pre><code class="plaintext hljs">hosts = 127.0.0.1<font></font>
user = postfix<font></font>
password = password123<font></font>
dbname = postfix<font></font>
query = SELECT goto FROM alias,alias_domain WHERE alias_domain.alias_domain = '%d' and alias.address = CONCAT('%u', '@', alias_domain.target_domain) AND alias.active = '1'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
virtual_mailbox_maps.cf</font></font><br>
<br>
<pre><code class="plaintext hljs">hosts = 127.0.0.1<font></font>
user = postfix<font></font>
password = password123<font></font>
dbname = postfix<font></font>
query = SELECT maildir FROM mailbox WHERE username='%s' AND  active = '1'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
master.cf</font></font><br>
<br>
<pre><code class="plaintext hljs"># postfix  ,    dovecot   <font></font>
dovecot unix - n n - - pipe<font></font>
    flags=DRhu user=vmail:vmail argv=/usr/local/libexec/dovecot/deliver -f ${sender} -d ${recipient}<font></font>
<font></font>
#  smtpd     sasl,    ,  spamassassin   <font></font>
smtp      inet  n       -       n       -       -       smtpd<font></font>
  -o content_filter=spamassassin<font></font>
  -o smtpd_sasl_auth_enable=yes<font></font>
<font></font>
#  587     sasl<font></font>
submission inet n       -       n       -       -       smtpd<font></font>
 -o smtpd_sasl_auth_enable=yes<font></font>
<font></font>
#  smtp    SASL<font></font>
smtps     inet  n       -       n       -       -       smtpd<font></font>
  -o smtpd_sasl_auth_enable=yes<font></font>
  -o smtpd_tls_wrappermode=yes<font></font>
<font></font>
# Spamassassin<font></font>
spamassassin   unix  -       n       n       -       -       pipe<font></font>
   flags=DROhu user=vmail:vmail argv=/usr/local/bin/spamc -f -e<font></font>
   /usr/local/libexec/dovecot/deliver -f ${sender} -d ${user}@${nexthop}<font></font>
<font></font>
#628       inet  n       -       n       -       -       qmqpd<font></font>
pickup    unix  n       -       n       60      1       pickup<font></font>
cleanup   unix  n       -       n       -       0       cleanup<font></font>
qmgr      unix  n       -       n       300     1       qmgr<font></font>
#qmgr     unix  n       -       n       300     1       oqmgr<font></font>
tlsmgr    unix  -       -       n       1000?   1       tlsmgr<font></font>
rewrite   unix  -       -       n       -       -       trivial-rewrite<font></font>
bounce    unix  -       -       n       -       0       bounce<font></font>
defer     unix  -       -       n       -       0       bounce<font></font>
trace     unix  -       -       n       -       0       bounce<font></font>
verify    unix  -       -       n       -       1       verify<font></font>
flush     unix  n       -       n       1000?   0       flush<font></font>
proxymap  unix  -       -       n       -       -       proxymap<font></font>
proxywrite unix -       -       n       -       1       proxymap<font></font>
smtp      unix  -       -       n       -       -       smtp<font></font>
relay     unix  -       -       n       -       -       smtp<font></font>
        -o syslog_name=postfix/$service_name<font></font>
#       -o smtp_helo_timeout=5 -o smtp_connect_timeout=5<font></font>
showq     unix  n       -       n       -       -       showq<font></font>
error     unix  -       -       n       -       -       error<font></font>
retry     unix  -       -       n       -       -       error<font></font>
discard   unix  -       -       n       -       -       discard<font></font>
local     unix  -       n       n       -       -       local<font></font>
virtual   unix  -       n       n       -       -       virtual<font></font>
lmtp      unix  -       -       n       -       -       lmtp<font></font>
anvil     unix  -       -       n       -       1       anvil<font></font>
scache    unix  -       -       n       -       1       scache<font></font>
postlog   unix-dgram n  -       n       -       1       postlogd<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
main.cf</font></font><br>
<br>
<pre><code class="plaintext hljs">#       dovecot,      <font></font>
local_transport = dovecot<font></font>
<font></font>
#      ,  SMTP-      EHLO  SMTP <font></font>
smtpd_discard_ehlo_keywords = CONNECT GET POST<font></font>
<font></font>
#           <font></font>
smtpd_delay_reject = yes<font></font>
<font></font>
#    <font></font>
smtpd_helo_required = yes<font></font>
<font></font>
#     ,  <font></font>
disable_vrfy_command = yes<font></font>
<font></font>
#      <font></font>
broken_sasl_auth_clients = yes<font></font>
<font></font>
#  <font></font>
smtpd_sasl_security_options = noanonymous noactive nodictionary<font></font>
smtp_sasl_security_options = noanonymous noactive nodictionary<font></font>
<font></font>
# dovecot  (  cyrus)<font></font>
smtpd_sasl_type = dovecot<font></font>
smtp_sasl_type = dovecot<font></font>
<font></font>
#   <font></font>
smtpd_sasl_path = private/auth<font></font>
<font></font>
#  <font></font>
local_recipient_maps = $virtual_mailbox_maps $virtual_alias_maps<font></font>
<font></font>
#   ,   <font></font>
smtpd_reject_unlisted_recipient = yes<font></font>
<font></font>
#  <font></font>
message_size_limit = 10485760<font></font>
<font></font>
#     spamassassin<font></font>
spamassassin_destination_recipient_limit = 1<font></font>
<font></font>
#<font></font>
milter_default_action = accept<font></font>
milter_protocol = 2<font></font>
#   clamav<font></font>
smtpd_milters = unix:/var/run/clamav/clmilter.sock<font></font>
non_smtpd_milters = unix:/var/run/clamav/clmilter.sock<font></font>
<font></font>
<font></font>
#MYSQL<font></font>
relay_domains = mysql:/usr/local/etc/postfix/mysql/relay_domains.cf<font></font>
virtual_alias_maps = mysql:/usr/local/etc/postfix/mysql/virtual_alias_maps.cf, mysql:/usr/local/etc/postfix/mysql/virtual_alias_domain_maps.cf<font></font>
virtual_mailbox_maps = mysql:/usr/local/etc/postfix/mysql/virtual_mailbox_maps.cf<font></font>
<font></font>
# HELO<font></font>
smtpd_helo_restrictions = permit_sasl_authenticated, reject_non_fqdn_helo_hostname, reject_invalid_hostname<font></font>
<font></font>
#   <font></font>
smtpd_data_restrictions = permit_sasl_authenticated reject_unauth_pipelining, reject_multi_recipient_bounce<font></font>
<font></font>
#  <font></font>
smtpd_sender_restrictions = permit_sasl_authenticated reject_sender_login_mismatch,reject_unauthenticated_sender_login_mismatch, reject_non_fqdn_sender, reject_unknown_sender_domain<font></font>
<font></font>
#  (check_policy_service inet:127.0.0.1:10023  postgrey -      )<font></font>
smtpd_recipient_restrictions = permit_sasl_authenticated reject_non_fqdn_recipient, reject_unknown_recipient_domain, reject_multi_recipient_bounce, reject_unknown_client_hostname, reject_unauth_destination, check_policy_service inet:127.0.0.1:10023<font></font>
<font></font>
<font></font>
#  <font></font>
virtual_mailbox_base = /var/vmail<font></font>
<font></font>
#uid  gid vmail<font></font>
virtual_minimum_uid = 1000<font></font>
virtual_uid_maps = static:1000<font></font>
virtual_gid_maps = static:1000<font></font>
<font></font>
#  <font></font>
virtual_transport = devecot<font></font>
dovecot_destination_recipient_limit = 1<font></font>
<font></font>
<font></font>
# <font></font>
smtp_use_tls=yes<font></font>
smtp_tls_note_starttls_offer=yes<font></font>
# smtp_tls_security_level=encrypt       ssl,        ssl,    smtp_tls_security_level=may(    ssl,     )<font></font>
smtp_tls_security_level=encrypt<font></font>
smtp_tls_session_cache_database=btree:$data_directory/smtp_tls_session_cache<font></font>
smtp_tls_CAfile=/etc/ssl/demoCA/cacert.pem<font></font>
smtp_tls_key_file=/etc/ssl/foo-key.pem<font></font>
smtp_tls_cert_file=/etc/ssl/foo-cert.pem<font></font>
smtp_tls_session_cache_timeout=3600s<font></font>
smtp_tls_protocols=!TLSv1.2<font></font>
smtp_tls_loglevel=1<font></font>
<font></font>
# smtpd_tls_security_level=encrypt       ssl,        ssl,    smtpd_tls_security_level=may(    ssl,     )<font></font>
smtpd_tls_security_level=encrypt<font></font>
smtpd_use_tls=yes<font></font>
smtpd_tls_auth_only=yes<font></font>
smtpd_tls_loglevel=1<font></font>
smtpd_tls_received_header=yes<font></font>
smtpd_tls_session_cache_timeout=3600s<font></font>
smtpd_tls_session_cache_database=btree:$data_directory/smtpd_tls_session_cache<font></font>
smtpd_tls_key_file=/etc/ssl/foo-key.pem<font></font>
smtpd_tls_cert_file=/etc/ssl/foo-cert.pem<font></font>
smtpd_tls_CAfile= /etc/ssl/demoCA/cacert.pem<font></font>
smtpd_tls_protocols=!TLSv1.2<font></font>
<font></font>
#     <font></font>
tls_random_source=dev:/dev/urandom<font></font>
<font></font>
# <font></font>
compatibility_level = 2<font></font>
<font></font>
#   ,    ,      ,   <font></font>
soft_bounce = no<font></font>
<font></font>
#   UNIX       postfix<font></font>
mail_owner = postfix<font></font>
<font></font>
#     postfix(        )<font></font>
myhostname = $mydomain<font></font>
<font></font>
#      <font></font>
mydomain = virusslayer.su<font></font>
myorigin = $myhostname<font></font>
<font></font>
#   <font></font>
inet_interfaces = all<font></font>
<font></font>
#       <font></font>
mydestination = $mydomain, localhost, localhost.$mydomain<font></font>
<font></font>
#   550        <font></font>
unknown_local_recipient_reject_code = 550<font></font>
<font></font>
#    localhost<font></font>
mynetworks_style = host<font></font>
<font></font>
#       , -        <font></font>
mynetworks =<font></font>
<font></font>
#  ip<font></font>
inet_protocols = ipv4<font></font>
<font></font>
#  (   )<font></font>
alias_maps = hash:/etc/mail/aliases<font></font>
alias_database = dbm:/etc/mail/aliases.db<font></font>
<font></font>
#         <font></font>
smtpd_banner = $myhostname ESMTP $mail_name<font></font>
<font></font>
#      <font></font>
debug_peer_level = 2<font></font>
<font></font>
#      (   ,    yandex.ru gmail.ru mail.ru  ..)<font></font>
debug_peer_list = 127.0.0.1<font></font>
<font></font>
#  <font></font>
debugger_command =<font></font>
         PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin<font></font>
         ddd $daemon_directory/$process_name $process_id &amp; sleep 5<font></font>
<font></font>
#  sendmail<font></font>
sendmail_path = /usr/local/sbin/sendmail<font></font>
mailq_path = /usr/local/bin/mailq<font></font>
<font></font>
<font></font>
setgid_group = maildrop<font></font>
<font></font>
#   <font></font>
html_directory = /usr/local/share/doc/postfix<font></font>
manpage_directory = /usr/local/man<font></font>
sample_directory = /usr/local/etc/postfix<font></font>
readme_directory = /usr/local/share/doc/postfix<font></font>
meta_directory = /usr/local/libexec/postfix<font></font>
shlib_directory = /usr/local/lib/postfix<font></font>
queue_directory = /var/spool/postfix<font></font>
command_directory = /usr/local/sbin<font></font>
daemon_directory = /usr/local/libexec/postfix<font></font>
data_directory = /var/db/postfix<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‰ã‚³ãƒƒãƒˆ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dovecot.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">#     dovecot<font></font>
protocols = imap pop3<font></font>
<font></font>
#   <font></font>
listen = *, ::<font></font>
<font></font>
#        mysql<font></font>
dict {<font></font>
    quota = mysql:/usr/local/etc/dovecot/dovecot-dict-sql.conf.ext<font></font>
}<font></font>
<font></font>
#  <font></font>
!include conf.d/*.conf<font></font>
!include_try local.conf<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dovecot-dict-sql.conf.ext</font></font><br>
<br>
<pre><code class="plaintext hljs">connect = host=127.0.0.1 dbname=postfix user=postfix password=password123<font></font>
<font></font>
map {<font></font>
  pattern = priv/quota/storage<font></font>
  table = quota2<font></font>
  username_field = username<font></font>
  value_field = bytes<font></font>
}<font></font>
map {<font></font>
  pattern = priv/quota/messages<font></font>
  table = quota2<font></font>
  username_field = username<font></font>
  value_field = messages<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dovecot-sql.conf.ext</font></font><br>
<br>
<pre><code class="plaintext hljs">#    MYSQL<font></font>
driver = mysql<font></font>
connect = host=127.0.0.1 dbname=postfix user=postfix password=password123<font></font>
<font></font>
#    <font></font>
default_pass_scheme = MD5<font></font>
<font></font>
#  ,   <font></font>
user_query = SELECT '/var/mail/%d/%n/' AS  home, 'maildir:/var/vmail/%d/%n' AS mail, 1000 AS uid, 1000 AS gid, concat('*:bytes=',quota) as quota_rule FROM mailbox \<font></font>
    WHERE username ='%u' AND active = '1'<font></font>
<font></font>
password_query = SELECT username as user, password, '/var/vmail/%d/%n' as userdb_home, 'maildir:/var/vmail/%d/%n' as userdb_mail, 1000 as userdb_uid, \<font></font>
 1000 as userdb_gid, concat('*:bytes=',quota) AS userdb_quota_rule FROM mailbox WHERE username ='%u' AND active ='1'<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10-auth.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">#   SSL<font></font>
disable_plaintext_auth = yes<font></font>
<font></font>
#  <font></font>
auth_realms = virusslayer.su<font></font>
auth_default_realm = virusslayer.su<font></font>
<font></font>
#    ( ,         ssl)<font></font>
auth_mechanisms = plain login<font></font>
<font></font>
#   ,  !include auth-sql.conf.ext,        mysql<font></font>
#!include auth-deny.conf.ext<font></font>
#!include auth-master.conf.ext<font></font>
<font></font>
#!include auth-system.conf.ext<font></font>
!include auth-sql.conf.ext<font></font>
#!include auth-ldap.conf.ext<font></font>
#!include auth-passwdfile.conf.ext<font></font>
#!include auth-checkpassword.conf.ext<font></font>
#!include auth-vpopmail.conf.ext<font></font>
#!include auth-static.conf.ext<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10-mail.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">#   <font></font>
mail_location = maildir:/var/vmail/%d/%n<font></font>
<font></font>
#      <font></font>
namespace inbox {<font></font>
  inbox = yes<font></font>
}<font></font>
<font></font>
#uid  gid vmail<font></font>
mail_uid = 1000<font></font>
mail_gid = 1000<font></font>
<font></font>
# ,    quota<font></font>
mail_plugins = quota<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10-master.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">#     ssl<font></font>
service imap-login {<font></font>
  inet_listener imap {<font></font>
    port = 143<font></font>
  }<font></font>
  inet_listener imaps {<font></font>
    port = 993<font></font>
    ssl = yes<font></font>
  }<font></font>
}<font></font>
<font></font>
service pop3-login {<font></font>
  inet_listener pop3 {<font></font>
    port = 110<font></font>
  }<font></font>
  inet_listener pop3s {<font></font>
    port = 995<font></font>
    ssl = yes<font></font>
  }<font></font>
}<font></font>
<font></font>
service submission-login {<font></font>
  inet_listener submission {<font></font>
    port = 587<font></font>
  }<font></font>
}<font></font>
<font></font>
#           (   ,       )<font></font>
service auth {<font></font>
  unix_listener auth-userdb {<font></font>
    mode = 0600<font></font>
    user = vmail<font></font>
    group = vmail<font></font>
  }<font></font>
  # Postfix smtp-auth<font></font>
  unix_listener /var/spool/postfix/private/auth {<font></font>
    mode = 0666<font></font>
    user = postfix<font></font>
    group = postfix<font></font>
  }<font></font>
}<font></font>
<font></font>
#  vmail  <font></font>
service dict {<font></font>
  unix_listener dict {<font></font>
    mode = 0660<font></font>
    user =  vmail<font></font>
    group = vmail<font></font>
    }<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10-ssl.conf</font></font><br>
<br>
<pre><code class="plaintext hljs"># ssl  (    sll  )<font></font>
ssl = required<font></font>
<font></font>
#  <font></font>
ssl_cert = &lt;/etc/ssl/foo-cert.pem<font></font>
ssl_key = &lt;/etc/ssl/foo-key.pem<font></font>
ssl_ca = &lt;/etc/ssl/demoCA/cacert.pem<font></font>
<font></font>
#   <font></font>
ssl_min_protocol = TLSv1.2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
15-lda.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">quota_full_tempfail = no<font></font>
lda_mailbox_autosubscribe = yes<font></font>
protocol lda {<font></font>
 #      sieve,       <font></font>
  mail_plugins = $mail_plugins sieve quota<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
90-plugin.conf</font></font><br>
<br>
<pre><code class="plaintext hljs">#             "",       chown -R vmail:vmail<font></font>
#          ""<font></font>
plugin {<font></font>
  #setting_name = value<font></font>
  sieve = /usr/local/etc/dovecot/conf.d/def/default.sieve<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
auth-sql.conf.ext</font></font><br>
<br>
<pre><code class="plaintext hljs">#      MYSQL<font></font>
passdb {<font></font>
  driver = sql<font></font>
<font></font>
  # Path for SQL configuration file, see example-config/dovecot-sql.conf.ext<font></font>
  args = /usr/local/etc/dovecot/dovecot-sql.conf.ext<font></font>
}<font></font>
<font></font>
userdb {<font></font>
  driver = sql<font></font>
  args = /usr/local/etc/dovecot/dovecot-sql.conf.ext<font></font>
}<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¹ãƒ‘ãƒã‚µã‚·ãƒ³</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã€Œconfigã€spamassassinã¯æ¬¡ã®ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ãŒä¸ååˆ†ã§ã‚ã‚‹ã“ã¨ãŒ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ã‹ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚ã€Œconfigã€ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰‹ä¼ã£ã¦ãã ã•ã„ï¼š</font><font style="vertical-align: inherit;">local.cf</font></font><br>
<br>
<pre><code class="plaintext hljs">rewrite_header Subject *****SPAM*****<font></font>
report_safe 0<font></font>
required_score 5.0<font></font>
use_bayes 1<font></font>
bayes_auto_learn 1<font></font>
ifplugin Mail::SpamAssassin::Plugin::Shortcircuit<font></font>
endif # Mail::SpamAssassin::Plugin::Shortcircuit<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ãƒ‘ãƒ ã®ã‚ã‚‹æ‰‹ç´™ã¨ãªã„æ‰‹ç´™ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚‚è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">sa-learn --spam /path/spam/folder<font></font>
sa-learn --ham /path/ham/folder<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã•ã‚‰ã«</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€pfã«åŸºã¥ã„ã¦ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã‚’æŒ‡å®šã—ã€è‡ªå‹•å®Ÿè¡Œã«pfã‚’è¿½åŠ ã—ã¦ã€ãƒ«ãƒ¼ãƒ«ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">sysrc pf_enable="YES"<font></font>
sysrc pf_rules="/etc/0.pf"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ«ãƒ¼ãƒ«ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">ee /etc/0.pf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ãã‚Œã«ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="plaintext hljs"># (   lo0)    ,    <font></font>
set skip on lo0<font></font>
<font></font>
#      deovecot, postfix, root<font></font>
pass in quick proto { tcp, udp } from any to any port {53,25,465,587,110,143,993,995} user {dovecot,postfix,root} flags S/SA modulate state<font></font>
pass out quick proto { tcp, udp } from any to any port {53,25,465,587,110,143,993,995} user {dovecot,postfix,root}<font></font>
<font></font>
#      root<font></font>
pass out quick proto {tcp,udp} from any to any user root<font></font>
<font></font>
#    <font></font>
pass in quick proto tcp from any to any port 80 flags S/SA modulate state<font></font>
<font></font>
#SSH<font></font>
pass in quick proto tcp from any to any port 22 flags S/SA modulate state<font></font>
<font></font>
#     clamav  spamd <font></font>
pass out quick proto {tcp,udp} from any to any user {clamav,spamd}<font></font>
<font></font>
#DNS  ICMP<font></font>
pass out quick proto {tcp,udp} from any to any port=53 keep state<font></font>
pass out quick proto icmp from any to any<font></font>
<font></font>
block from any to any fragment<font></font>
block from any to any<font></font>
block all<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§pfã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">service pf start
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ†ã‚¹ãƒˆä¸­</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®å¯èƒ½ãªæ¥ç¶šï¼ˆSTARTTLSã€SLLï¼‰ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆç§ã®å ´åˆã¯iosï¼‰â€œ MyOffice Mailâ€ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã‚’æ§‹æˆã™ã‚‹ãŸã‚ã®å¤šãã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
spaassasinã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€GTUBEç½²åã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«æ¬¡ã®è¡Œã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">XJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ãŒæ­£ã—ã„å ´åˆã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã‚¹ãƒ‘ãƒ ã®ãƒãƒ¼ã‚¯ãŒä»˜ã‘ã‚‰ã‚Œã€ãã‚Œã«å¿œã˜ã¦ã‚¹ãƒ‘ãƒ ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã•â€‹â€‹ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¦ã‚¤ãƒ«ã‚¹å¯¾ç­–ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€é›»å­ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯EICARã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰‹ç´™ã¯å½“ç„¶ã€å¤–éƒ¨ã®ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‹ã‚‰é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">tail -f /var/log/maillog
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€å¤–éƒ¨ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ï¼ˆãŸã¨ãˆã°ã€yandex.ruã€mail.ruã€gmail.comãªã©ï¼‰ã«ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹æ­£ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ã«ã¯ã€ãƒªãƒãƒ¼ã‚¹DNSã‚¾ãƒ¼ãƒ³ï¼ˆPTRãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’ç™»éŒ²ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆã‚ãªãŸã¯ç¢ºã‹ã«ã‚ãªãŸè‡ªèº«ã®DNSã‚µãƒ¼ãƒãƒ¼ã‚’æŒã£ã¦ã„ã¾ã›ã‚“ï¼‰ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çµè«–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã¡ã‚ã‚“ã€ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã¯ã‹ãªã‚Šè¤‡é›‘ãªã‚‚ã®ã®ã‚ˆã†ã«æ€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ãã‚Œã‚’ç†è§£ã™ã‚Œã°ã€ã¾ã£ãŸããã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ§‹æˆã«å°‘ã—æ™‚é–“ã‚’è²»ã‚„ã—ãŸã ã‘ã§ã€ã‚¹ãƒ‘ãƒ ã‚„ã‚¦ã‚¤ãƒ«ã‚¹ã‹ã‚‰ä¿è­·ã•ã‚ŒãŸã€ã‹ãªã‚Šæ©Ÿèƒ½çš„ãªãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’å…¥æ‰‹ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PSã‚³ãƒ¡ãƒ³ãƒˆä»˜ãã§ã€Œã‚³ãƒ”ãƒ¼ã‚¢ãƒ³ãƒ‰ãƒšãƒ¼ã‚¹ãƒˆã€ã™ã‚‹å ´åˆã¯ã€ãƒ­ã‚·ã‚¢èªã®ã‚¯ãƒ©ã‚¹ãƒ­ã‚°ã«rootãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆãŠã‚ˆã³ãã‚Œã‚’å¿…è¦ã¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="plaintext hljs">pw usermod root -L russian
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å¾Œã€ãƒ­ã‚·ã‚¢èªã®æ–‡å­—ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja476138/index.html">å¤©æ–‡å­¦è€…ã¯ã€é€šä¿¡è¡›æ˜ŸSpaceXã€OneWebã€ãã®ä»–ã®ä¼æ¥­ãŒå¤©æ–‡å­¦ã®æœªæ¥ã‚’è„…ã‹ã—ã¦ã„ã‚‹ã¨ä¿¡ã˜ã¦ã„ã¾ã™</a></li>
<li><a href="../ja476140/index.html">7000èªã¯çŸ¥ã£ã¦ã„ã‚‹ãŒè€³ã§ç†è§£ã§ããªã„å ´åˆã€ãƒªã‚¹ãƒ‹ãƒ³ã‚°ã‚’æ”¹å–„ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja476142/index.html">Javaã§ãƒ•ãƒ­ãƒ¼ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä¾‹å¤–ã®ä½¿ç”¨ã‚’é¿ã‘ã‚‹ç†ç”±</a></li>
<li><a href="../ja476144/index.html">ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚µãƒ³ã‚¿ã‚’ãƒ—ãƒ¬ã‚¤ã™ã‚‹ãƒœãƒƒãƒˆã®ä¾‹ã‚’ä½¿ç”¨ã—ã¦ã€ãƒœãƒƒãƒˆã®ãƒãƒ£ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å¿…è¦æ€§ã¨ä¸è¦ãªæ–¹æ³•</a></li>
<li><a href="../ja476146/index.html">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã‚’æ‹¡å¼µã™ã‚‹æ–¹æ³•ã€‚Yandexãƒ¬ãƒãƒ¼ãƒˆ</a></li>
<li><a href="../ja476156/index.html">Apache Kafkaã‚’ä½¿ç”¨ã—ãŸåŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹</a></li>
<li><a href="../ja476160/index.html">æ•™è‚²ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®èª•ç”Ÿã¨ãã®æ­´å²ï¼šæ©Ÿæ¢°ã‹ã‚‰æœ€åˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¾ã§</a></li>
<li><a href="../ja476162/index.html">æœ€æ–°ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çŸ¥è­˜ã¨ä»•äº‹ã®æº–å‚™ã€‚ãƒ‘ãƒ¼ãƒˆ1</a></li>
<li><a href="../ja476164/index.html">ã€Œã“ã‚Œã‚‚ãƒ‡ãƒ¼ã‚¿åˆ†æã§ã™ã€‚ã€ãƒŸãƒã‚¤ãƒ«ãƒ»ã‚²ãƒ«ãƒ•ã‚¡ãƒ³ãƒ‰ã¨ãƒã‚¤ã‚ªã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã«ã¤ã„ã¦èªã‚‹</a></li>
<li><a href="../ja476166/index.html">ã€Œãƒªã‚¢ãƒ«ã‚¢ã‚¤ã‚¢ãƒ³ãƒãƒ³ã€ã¯é£›è¡Œé€Ÿåº¦ã®è¨˜éŒ²ã‚’å¡—ã‚Šæ›¿ãˆã¾ã—ãŸ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>