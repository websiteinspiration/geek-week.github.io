<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📽️ 🧑🏽‍🤝‍🧑🏻 🤛🏼 最小のトランザクション分離レベル 👩🏿‍🎤 🏸 🕺🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日、私は非常に興味深いものを紹介したいと思いますが、データベース（DB）の通常の致命的なプログラマのセクション-トランザクション分離レベルの秘密で覆われていることがよくあります。実践が示すように、ITに関連する多くの人々、特にデータベースの操作に携わる人々は、これらのレベルが必要な理由と、それらを...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>最小のトランザクション分離レベル</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469415/"><img src="https://habrastorage.org/webt/v3/-j/65/v3-j65ut9hywvpnw1wmt5q6c2sg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日、私は非常に興味深いものを紹介したいと思いますが、データベース（DB）の通常の致命的なプログラマのセクション-トランザクション分離レベルの秘密で覆われていることがよくあります。</font><font style="vertical-align: inherit;">実践が示すように、ITに関連する多くの人々、特にデータベースの操作に携わる人々は、これらのレベルが必要な理由と、それらを自分の利益のためにどのように使用できるかについてほとんど理解していません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理論のビット</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トランザクション自体は特別な説明を必要としません。トランザクションは、データベースへのN（N≥1）クエリであり、すべて一緒にまたはまったく実行されずに正常に実行されます。</font><font style="vertical-align: inherit;">トランザクションの分離は、並列トランザクションが互いにどの程度影響し合っているかを示します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トランザクションレベルを選択して、トランザクション間のデータの高い一貫性とこれらの同じトランザクションの速度のどちらを選択するかについてコンセンサスを得ようとしています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最高の実行速度と最低の一貫性が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミットされずに読み取られる</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことは注目に値し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">最低の実行速度と最高の一貫性は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリアライズ可能</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境の準備</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、MySQL DBMSが選択されました。</font><font style="vertical-align: inherit;">PostgreSQLも使用できますが、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミットされ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ていない</font><b><font style="vertical-align: inherit;">読み取りの</font></b><font style="vertical-align: inherit;">分離レベルをサポートせず、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに</font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">コミットされ</font></b><font style="vertical-align: inherit;">た</font><b><font style="vertical-align: inherit;">読み取り</font></b><font style="vertical-align: inherit;">レベル</font><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">使用</font></a><font style="vertical-align: inherit;">し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして結局のところ、DBMSが異なれば、分離レベルの認識も異なります。</font><font style="vertical-align: inherit;">彼らは、分離を確実にする上でさまざまなニュアンスを持っているか、追加のレベルを持っているか、よく知られていないことがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Docker Hubで完成したMySQLイメージを使用して環境を作成します。</font><font style="vertical-align: inherit;">そして、データベースに入力します。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker-compose.yaml</font></font></b><div class="spoiler_text"><pre><code class="xml hljs">version: '3.4'<font></font>
services:<font></font>
  db:<font></font>
    image: mysql:8<font></font>
    environment:<font></font>
        - MYSQL_ROOT_PASSWORD=12345<font></font>
    command: --init-file /init.sql<font></font>
    volumes:<font></font>
        - data:/var/lib/mysql<font></font>
        - ./init.sql:/init.sql<font></font>
    expose:<font></font>
        - "3306"<font></font>
    ports:<font></font>
        - "3309:3306"<font></font>
<font></font>
volumes:<font></font>
  data:<font></font>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースへの入力</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">create</span> <span class="hljs-keyword">database</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> bank;<font></font>
<font></font>
<span class="hljs-keyword">use</span> bank;<font></font>
<font></font>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> accounts<font></font>
(<font></font>
	<span class="hljs-keyword">id</span> <span class="hljs-built_in">int</span> <span class="hljs-keyword">unsigned</span> auto_increment<font></font>
		primary <span class="hljs-keyword">key</span>,<font></font>
	login <span class="hljs-built_in">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	balance <span class="hljs-built_in">bigint</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>,<font></font>
	created_at <span class="hljs-built_in">timestamp</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">now</span>()<font></font>
) <span class="hljs-keyword">collate</span>=utf8mb4_unicode_ci;<font></font>
<font></font>
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> accounts (login, balance) <span class="hljs-keyword">values</span> (<span class="hljs-string">'petya'</span>, <span class="hljs-number">1000</span>);
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> accounts (login, balance) <span class="hljs-keyword">values</span> (<span class="hljs-string">'vasya'</span>, <span class="hljs-number">2000</span>);
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> accounts (login, balance) <span class="hljs-keyword">values</span> (<span class="hljs-string">'mark'</span>, <span class="hljs-number">500</span>);
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レベルの機能とその機能を考えてみましょう。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同時に実行される2つのトランザクションで例を実行します。</font><font style="vertical-align: inherit;">条件付きで、左側のウィンドウのトランザクションは、右側のウィンドウでは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トランザクション1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（T1）、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トランザクション2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（T2）</font><font style="vertical-align: inherit;">と呼ばれ</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミットせずに読む</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最悪のデータ整合性を持つレベルですが、トランザクション速度は最高です。レベルの名前はそれ自体を物語っています。各トランザクションは、別のトランザクションでコミットされていない変更を認識します（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダーティリーディングの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現象</font><font style="vertical-align: inherit;">）。このようなトランザクションが互いにどのように影響するかを見てみましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つの並列トランザクションを開始します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/df/8n/xl/df8nxlfhhcshcjodtparllhouba.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初めに持っている情報を確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hd/38/qz/hd38qzflrzu-nnx7hs91yx7zyhm.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ3.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、T1でINSERT、DELETE、UPDATE操作を実行し、別のトランザクションが何を参照しているかを確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ey/k2/sd/eyk2sdewgeir6kmpjchumikl8t4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T2は、まだコミットされていない別のトランザクションからのデータを確認します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ4.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そしてT2はいくつかのデータを取得できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7v/oq/tr/7voqtrzl7ihmkswvkx0tsxao7n8.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手順5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T1への変更をロールバックすると、T2によって取得されたデータは誤ったものになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zp/4r/ja/zp4rjad7h4w67oozlqjhyo7fp1u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレベルでは、アプリケーションにとって重要な結論と重要な決定に基づいてデータを使用することは不可能です。これらの結論は現実とはかけ離れている可能性があるためです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレベルは、たとえば、何かのおおよその計算に使用できます。</font><font style="vertical-align: inherit;">結果の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COUNT（*）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAX（*）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、一部の非厳密レポートで使用できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の例はデバッグモードです。</font><font style="vertical-align: inherit;">トランザクション中に、データベースに何が起こるかを確認したい場合。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミットして読む</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このレベルでは、同時に実行されるトランザクションは、他のトランザクションからコミットされた変更のみを参照します。</font><font style="vertical-align: inherit;">したがって、このレベルは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダーティリーディング</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に対する保護を提供します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手順1と手順2は前の例と同様です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ステップ3.また、accountsテーブル（T1）を使用して3つの簡単な操作を実行し、両方のトランザクションでこれらのテーブルを完全に選択します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5q/v6/oe/5qv6oevjrhcoe2ubmwxvmu5wapy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして</font><font style="vertical-align: inherit;">、T2 </font><font style="vertical-align: inherit;">での</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダーティリーディング</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の現象</font><font style="vertical-align: inherit;">が存在しない</font><font style="vertical-align: inherit;">ことがわかり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ステップ4. T1の変更を修正し、T2が現在何を参照しているかを確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mx/8f/i0/mx8fi0low9lqjenhnl2gx0sg6aq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、T2はT1が行ったすべてを認識します。</font><font style="vertical-align: inherit;">これは、</font><font style="vertical-align: inherit;">更新された行と削除された行（UPDATE、DELETE）が表示されるときの、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非繰り返し読み取りの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いわゆる現象</font><font style="vertical-align: inherit;">、および</font><b><font style="vertical-align: inherit;">ファントム</font></b><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">読み取り</font></b><font style="vertical-align: inherit;">現象です。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加されたレコードが表示されたとき（INSERT）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返し読み取り</font></font></h3><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返し読まない</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
現象を防ぐレベル</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">別のトランザクションの別のトランザクションで変更および削除されたレコードは表示されません。</font><font style="vertical-align: inherit;">ただし、別のトランザクションから挿入されたレコードは引き続き表示されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファントムを読む</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことはどこにも行きません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう一度、ステップ1とステップ2を繰り返し</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ステップ3. T1で、INSERT、UPDATE、およびDELETEクエリを実行します。</font><font style="vertical-align: inherit;">その後、T2で、T1で更新されたのと同じ行を更新しようとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/w5/oj/jaw5ojjrb1m7bi-9lhbifndcvye.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、ロックを取得します。T2は、T1が変更をコミットするかロールバックするまで待機します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ステップ4. T1によって行われた変更を修正します。</font><font style="vertical-align: inherit;">T2のアカウントテーブルからデータを再度読み取ります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/xu/jj/75xujjftplz_b3r8mhjsqcla7zc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どうやら、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">繰り返されない読書</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">ファントムの</font></b><b><font style="vertical-align: inherit;">読書の</font></b><font style="vertical-align: inherit;">現象</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見えません。それはどのようにデフォルトでは、ということである</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反復可能読み取りは、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちが唯一の現象を防止することができます</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読書を非繰り返しの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、MySQL </font><font style="vertical-align: inherit;">には</font><b><font style="vertical-align: inherit;">再現可能な読み取り</font></b><font style="vertical-align: inherit;">レベルの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファントム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">読み取る</font></b><font style="vertical-align: inherit;">効果がありません</font><font style="vertical-align: inherit;">。そしてPostgreSQLでは、彼らはこのレベルのためにそれを取り除きました。このレベルの古典的な表現では、この効果を観察する必要があります。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小さな抽象的な例は、商品券（コード）とその使用を生成するサービスです。</font><font style="vertical-align: inherit;">たとえば、攻撃者は自分のために証明書コードを生成し、それをアクティブ化しようとし、クーポンをアクティブ化するために複数のリクエストを続けて送信しようとしました。</font><font style="vertical-align: inherit;">この場合、同じクーポンを使用して同時に実行されるいくつかのトランザクションを開始します。</font><font style="vertical-align: inherit;">また、状況によっては、クーポンの2倍または3倍のアクティベーションが発生する場合があります（ユーザーは2x / 3xボーナスを受け取ります）。</font><font style="vertical-align: inherit;">で</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反復可能読み取り、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この場合には、ロックが発生し、活性化が一度に行われ、前の2つのレベルで、複数の活性化が可能です。</font><font style="vertical-align: inherit;">同様の問題は</font><font style="vertical-align: inherit;">、更新されたレコード（クーポン）もブロックする</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT FOR UPDATE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クエリを使用して解決することもできます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シリアライズ可能</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トランザクションが他に何も存在しないかのように動作し、相互に影響を与えないレベル。古典的な表現では、このレベルは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファントム</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">読み取り</font></b><font style="vertical-align: inherit;">の影響を排除します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トランザクションを開始します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T2はアカウントテーブルを読み取り、次にT1はT2が読み取ったデータを更新しようとします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ll/kv/yw/llkvywaijh7l7uyfsnqwy1a6ivm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロックを取得します。あるトランザクションのデータを別のトランザクションで読み取ることはできません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステップ3.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> INSERTとDELETEの両方がT1のロックにつながります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/kh/lj/iakhljpnwnxyame2qgxmqrhcyyu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T2が作業を完了するまで、T2は読み取ったデータを操作できません。</font><font style="vertical-align: inherit;">最大のデータ整合性が得られ、追加のデータは記録されません。</font><font style="vertical-align: inherit;">この代償として、頻繁なロックのためにトランザクション速度が遅くなるため、アプリケーションアーキテクチャが貧弱であると、トリックが発生する可能性があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのアプリケーションでは、分離レベルはめったに変更されず、デフォルト値が使用されます（たとえば、MySQLでは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反復可能読み取り</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、PostgreSQLでは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コミット済み読み取り</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、定期的に、高いデータ整合性またはトランザクション速度の間のより良いバランスを見つけることがいくつかのアプリケーション問題の解決に役立つという問題があります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja469405/index.html">ディープラーニングがJavaになりました</a></li>
<li><a href="../ja469407/index.html">ARIES PLC110 [M02] -MS4、HMI、OPC、SCADA、または人がカモミールティーをどれだけ必要とするか。パート1</a></li>
<li><a href="../ja469409/index.html">Performance Analyzerを使用したLinuxプロファイリング</a></li>
<li><a href="../ja469411/index.html">RE：スヴェルト3の痛みと涙</a></li>
<li><a href="../ja469413/index.html">先週フロントエンドの世界からの新鮮な食材のダイジェストNo.382（2019年9月22日〜29日）</a></li>
<li><a href="../ja469417/index.html">分散YESまたは分散NO？6か月間開発者を見つけることができない人のためのインタビュー</a></li>
<li><a href="../ja469421/index.html">自閉症の人にこんにちは</a></li>
<li><a href="../ja469423/index.html">ホリバー。ルネットの歴史。パート2.カウンターカルチャー：ポプリ、マリファナ、クレムリン</a></li>
<li><a href="../ja469425/index.html">Dmitry Matskevich、Dbrain（パート2）：神経生物学、内的自由、「安価なドーパミン」と直感について</a></li>
<li><a href="../ja469427/index.html">木製おもちゃ、パート4-1990</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>