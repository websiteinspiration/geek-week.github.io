<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖖🏼 🚓 🔹 Kasus untuk Menggunakan Alat Analisis Anomali Jaringan: Deteksi Kebocoran ♦️ 👩🏽‍🔬 💟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada salah satu acara, diskusi menarik terjadi pada kegunaan dari solusi NTA (Network Traffic Analysis), yang, dengan menggunakan infrastruktur jaring...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kasus untuk Menggunakan Alat Analisis Anomali Jaringan: Deteksi Kebocoran</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/487346/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada salah satu acara, diskusi menarik terjadi pada kegunaan dari solusi NTA (Network Traffic Analysis), yang, dengan menggunakan infrastruktur jaringan telemetri Netflow (atau protokol aliran lainnya), memungkinkan untuk mendeteksi berbagai serangan. Lawan saya berpendapat bahwa ketika menganalisis header dan informasi terkait (dan NTA tidak menganalisis isi data paket, tidak seperti sistem deteksi serangan klasik, IDS), Anda tidak dapat melihat banyak. Dalam artikel ini saya akan mencoba untuk menyangkal pendapat ini dan membuat percakapan lebih substantif, saya akan memberikan beberapa contoh nyata ketika NTA benar-benar membantu mengidentifikasi berbagai anomali dan ancaman yang hilang pada perimeter atau bahkan melewati perimeter. Dan saya akan mulai dengan ancaman yang datang pertama di peringkat ancaman tahun lalu dan, saya pikir, akan tetap demikian tahun ini.Ini akan mengenai kebocoran informasi dan kemampuan untuk mendeteksi mereka melalui telemetri jaringan.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan mempertimbangkan situasi ini dengan tangan-tangan admin yang bengkok yang meninggalkan Internet tanpa terlihat Elastis atau MongoDB. Mari kita bicara tentang tindakan penyerang yang ditargetkan, seperti halnya dengan kisah biro kredit Equifax yang terkenal. Biarkan saya mengingatkan Anda bahwa dalam kasus ini, para penyerang pertama-tama menembus celah keamanan yang tidak tertandingi ke portal Web publik, dan kemudian ke server basis data internal. Tersisa tanpa diketahui selama beberapa bulan, mereka mampu mencuri data pada 146 juta klien biro kredit. Bisakah insiden seperti itu diidentifikasi menggunakan solusi DLP? Kemungkinan besar tidak, karena DLP klasik tidak dirancang untuk tugas memonitor lalu lintas dari database menggunakan protokol tertentu, dan bahkan di bawah kondisi bahwa lalu lintas ini dienkripsi.Tetapi solusi dari kelas NTA dapat dengan mudah mendeteksi kebocoran tersebut dengan melebihi nilai ambang tertentu dari jumlah informasi yang diunduh dari database. Selanjutnya, saya akan menunjukkan bagaimana ini semua dikonfigurasi dan ditemukan menggunakan solusi Cisco Stealthwatch Enterprise.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, hal pertama yang perlu kita lakukan adalah memahami di mana server basis data kita berada di jaringan, menentukan alamatnya dan mengelompokkannya. Di Cisco Stealthwatch, tugas inventaris dapat dilakukan secara manual atau menggunakan classifier khusus yang menganalisis lalu lintas dan, sesuai dengan protokol yang digunakan dan perilaku node, memungkinkan Anda untuk menghubungkannya ke satu atau kategori lain. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/n5/uy/rin5uykkickqn7znft9qa0ulllu.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah kami memiliki informasi tentang semua server basis data, kami memulai penyelidikan untuk mengetahui apakah kami membocorkan data dalam jumlah besar dari kelompok node yang diinginkan. Kami melihat bahwa dalam kasus kami, basis data paling aktif berkomunikasi dengan server DHCP dan pengontrol domain.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lb/xq/1z/lbxq1znvwtgzs01n4quxfwtgjli.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyerang sering membangun kontrol atas node jaringan dan menggunakannya sebagai jembatan untuk mengembangkan serangan mereka. Pada tingkat lalu lintas jaringan, ini terlihat seperti anomali - pemindaian jaringan dari node ini menjadi lebih sering, data ditangkap dari berbagi file, atau interaksi dengan server mana pun. Oleh karena itu, tugas kita selanjutnya adalah untuk memahami dengan siapa sebenarnya basis data kita paling sering berkomunikasi. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/er/0b/wber0bo8wqxtkswej7n7vmoffc8.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kelompok server DHCP, ternyata ini adalah node dengan alamat 10.201.0.15, interaksi dengan yang menyumbang sekitar 50% dari semua lalu lintas dari server database. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yz/yb/vb/yzybvbnmgicokharg8oxu57lxwm.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertanyaan logis berikutnya yang kami tanyakan pada diri kami sebagai bagian dari penyelidikan adalah: “Dan seperti apa simpul ini pada 10.201.0.15? Dengan siapa dia berinteraksi? Seberapa sering? Protokol apa? "</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/-s/ac/mt-sacge5hjgo2jwerw7omqwmlk.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata simpul yang menarik bagi kami berkomunikasi dengan berbagai segmen dan simpul jaringan kami (yang tidak mengejutkan, karena ini adalah server DHCP), tetapi pertanyaannya menyebabkan terlalu banyak interaksi dengan server terminal dengan alamat 10.201.0.23. Apakah ini normal? Jelas ada semacam anomali. Server DHCP tidak dapat berkomunikasi secara aktif dengan server terminal - 5610 stream dan 23,5 GB data. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4i/mk/jm/4imkjmqkv1eumztrmdyb88etx3c.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan interaksi ini dilakukan melalui NFS. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vl/2a/wo/vl2awoxjk2kijyg494rvz8bqsr4.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengambil langkah berikutnya dan mencoba memahami dengan siapa server terminal kami berinteraksi? Ternyata ia memiliki komunikasi yang cukup aktif dengan dunia luar - dengan simpul-simpul di AS, Inggris Raya, Kanada, Denmark, UEA, Qatar, Swiss, dll.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uw/yr/3s/uwyr3shmwntm1clarsxud2xfcgq.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kecurigaan disebabkan oleh fakta interaksi P2P dengan Puerto Rico, yang merupakan 90% dari semua lalu lintas. Selain itu, server terminal kami mengirimkan lebih dari 17 GB data ke Puerto Riko melalui port 53, yang terhubung dengan protokol DNS. Dapatkah Anda bayangkan bahwa Anda memiliki volume data yang dikirimkan melalui DNS? Dan saya mengingatkan Anda bahwa menurut penelitian Cisco, 92% malware menggunakan DNS untuk menyembunyikan aktivitasnya (mengunduh pembaruan, menerima perintah, mengeluarkan data). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/f1/mm/5b/f1mm5b4rmsqx5butgpw-mlsmk0e.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan jika protokol DNS ITU tidak hanya terbuka, tetapi tidak diperiksa, maka kami memiliki lubang besar di perimeter kami. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/_4/dj/yt_4djyxlui4rzkyvsko1zsejlu.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segera setelah simpul 10.201.0.23 membuat kami curiga, mari kita lihat dengan siapa dia masih berbicara?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zh/ya/7r/zhya7r8umwppjkxvidzpmpca9zy.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Tersangka" kami menukar setengah dari semua lalu lintas dengan simpul 10.201.3.18, yang ditempatkan dalam sekelompok workstation karyawan dari bagian penjualan dan pemasaran. Seberapa khas ini bagi organisasi kami untuk server terminal untuk "berkomunikasi" dengan komputer penjual atau pemasar?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pu/vq/nf/puvqnfekb1fdkqjenprrlsesxpi.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami melakukan penyelidikan dan menemukan gambar berikut. Data dari server database "dituangkan" ke server DHCP dengan transfer mereka selanjutnya melalui NFS ke server terminal di dalam jaringan kami, dan kemudian ke alamat eksternal di Puerto Rico menggunakan protokol DNS. Ini jelas merupakan pelanggaran terhadap kebijakan keamanan. Pada saat yang sama, server terminal juga berinteraksi dengan salah satu workstation dalam jaringan. Apa yang menyebabkan kejadian ini? Akun yang dicuri? Perangkat yang terinfeksi? Kami tidak tahu. Ini akan memerlukan kelanjutan dari penyelidikan, yang didasarkan pada solusi kelas NTA, yang memungkinkan menganalisis anomali lalu lintas jaringan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/wt/vo/gewtvo6-5k-41fdkkxaozhlep7q.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang kami tertarik pada apa yang akan kami lakukan dengan pelanggaran kebijakan keamanan yang teridentifikasi? Anda dapat melakukan analisis rutin sesuai dengan skema di atas, atau Anda dapat mengonfigurasi kebijakan NTA sehingga segera memberi sinyal ketika pelanggaran serupa terdeteksi. Ini dilakukan baik melalui menu umum yang sesuai, atau untuk setiap koneksi yang terdeteksi selama penyelidikan. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cc/rp/qa/ccrpqaqizyxou5zjqqfw36hsl4i.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah yang akan terlihat seperti aturan deteksi interaksi, sumbernya adalah server database, dan tujuannya adalah setiap node eksternal, serta setiap internal, tidak termasuk server Web.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hu/xy/ah/huxyah2skmz8jpc7d3dhtxtl3xe.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika kejadian seperti itu terdeteksi, sistem analisis lalu lintas jaringan segera menghasilkan alarm korespondensi dan, tergantung pada pengaturan, mengirimkannya ke SIEM, menggunakan alat komunikasi dengan administrator, atau bahkan dapat secara otomatis memblokir pelanggaran yang terdeteksi (Cisco Stealthwatch melakukan ini dengan berinteraksi dengan Cisco ISE ) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/ii/rn/ljiirng2huuf6qzjxg-kiagufcu.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingatlah bahwa ketika saya menyebutkan kasus dengan Equifax, saya menyebutkan bahwa para penyerang menggunakan saluran terenkripsi untuk membuang data. Untuk DLP, lalu lintas ini menjadi tugas yang tidak larut, tetapi untuk solusi kelas NTA, mereka tidak - mereka melacak kelebihan lalu lintas atau interaksi yang tidak sah antara node, terlepas dari penggunaan enkripsi.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u2/qg/qg/u2qgqgkkrsk_etuu7nav-k9hndg.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya satu kasus yang ditunjukkan di atas (dalam materi berikut kami akan mempertimbangkan contoh lain menggunakan NTA untuk tujuan keamanan informasi), tetapi pada kenyataannya, solusi modern dari kelas Analisis Lalu Lintas Jaringan memungkinkan Anda untuk membuat aturan yang sangat fleksibel dan mempertimbangkan tidak hanya parameter dasar header paket IP: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/15/ya/uk/15yaukzbimtm-o-yf41wnibz2ik.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tetapi juga melakukan analisis yang lebih dalam, hingga mengaitkan kejadian tersebut dengan nama pengguna dari Active Directory, mencari file berbahaya dengan hash (misalnya, diperoleh sebagai indikator kompromi dari SOSOPKA, FinCERT, Cisco Threat Grid, dll.), dll.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/oe/55/dcoe55wr_luv_kvpjjrqwapc5jc.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mudah diimplementasikan. Sebagai contoh, ini adalah bagaimana aturan yang biasa terlihat untuk mendeteksi semua jenis interaksi antara server database dan node eksternal menggunakan protokol apa pun selama 30 hari terakhir. Kami melihat bahwa basis data kami “dikomunikasikan” dengan node eksternal ke segmen DBMS menggunakan protokol DNS, SMB, dan port 8088. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/70/nh/hn70nhlbp10lmjmgbkjj_8_bs8i.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain bentuk tabel untuk menyajikan hasil investigasi atau pencarian, kami juga dapat memvisualisasikannya. Untuk skenario kami, sebuah fragmen dari diagram alur jaringan mungkin terlihat seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zs/yv/jf/zsyvjfgvrptgxwgv0eefnyz5pju.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan langsung dari peta yang sama kita dapat mengelola kebijakan - memblokir koneksi atau mengotomatiskan proses pembuatan aturan pemantauan untuk aliran yang menarik bagi kita.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/tj/rk/ixtjrkszqelbtsgpwdmdxdluubm.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut ini adalah contoh yang cukup menarik dan hidup menggunakan alat pemantauan Netflow (dan protokol aliran lainnya) untuk keamanan siber. </font><font style="vertical-align: inherit;">Dalam catatan berikut, saya berencana untuk menunjukkan bagaimana Anda dapat menggunakan NTA untuk mendeteksi kode berbahaya (menggunakan contoh Shamoon), server jahat (menggunakan kampanye DNSpionage sebagai contoh), program akses jarak jauh (RAT), melewati proxy perusahaan, dll.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id487346/">https://habr.com/ru/post/id487346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487332/index.html">Uji umbi LED Ergolux yang murah</a></li>
<li><a href="../id487334/index.html">Bagaimana "jarak jauh" meningkatkan kolaborasi</a></li>
<li><a href="../id487336/index.html">Unity - Mengaktifkan Multidex atau Metode Terlalu Banyak</a></li>
<li><a href="../id487340/index.html">Seperti yang kami lakukan perancang obrolan bot berikutnya. Bagian 1</a></li>
<li><a href="../id487342/index.html">Pelajaran # 2 - Pertemuan dan Acara</a></li>
<li><a href="../id487348/index.html">Pemeringkatan tugas prioritas - Aplikasi IL TEMPO</a></li>
<li><a href="../id487356/index.html">Apakah Anda akan berubah? Pikirkan lagi</a></li>
<li><a href="../id487358/index.html">BERT, ELMO and Co. dalam gambar (bagaimana pelatihan transfer datang ke NLP)</a></li>
<li><a href="../id487360/index.html">Anonimisasi data tidak menjamin anonimitas lengkap Anda</a></li>
<li><a href="../id487362/index.html">Angular 9 sekarang tersedia - Ivy telah tiba</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>