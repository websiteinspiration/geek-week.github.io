<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⤵️ 🧑🏿‍🤝‍🧑🏽 🤥 操作TA505、パート2：NetSupport RATによるServHelperバックドアの学習 👨‍🎓 🤛🏼 ⚙️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2019年7月の終わりに、TA505グループからマルウェアの興味深いサンプルを発見しました。2019年7月22日、動的分析のためにANY.RUNにアップロードされました。私たちの注意は、TA505 Servhelperの通常のタグに加えて、公開されたタグの中にnetsupportタグも登場し、ネット...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>操作TA505、パート2：NetSupport RATによるServHelperバックドアの学習</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/471960/"><img src="https://habrastorage.org/webt/tq/ic/md/tqicmdfgz5vzah4oqw6_i6mwan0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年7月の終わりに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、TA505グループから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルウェアの興味深いサンプルを発見しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">2019年7月22日、動的分析のためにANY.RUNにアップロードされました。</font><font style="vertical-align: inherit;">私たちの注意は、TA505 Servhelperの通常のタグに加えて、公開されたタグの中にnetsupportタグも登場し、ネットワーク署名操作の中に識別された、つまり同じ名前のNetSupport RATであるという事実に引き付けられました。</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/cs/sq/uk/cssqukxglw4w6ygse7dzg-kw2jw.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">1.日付VPOと公開タグANY.RUNオンラインアナライザーをアップロードします</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/h9/hd/g8/h9hdg8qo0sxrox1jnippd8ka_zo.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">2. ANY.RUNサンドボックス内のNetSupport RATでネットワーク署名をトリガーする</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
一見すると、これは奇妙に思えるかもしれません。結局のところ、ServHelperグループ自体のバックドアには、被害者のPCを制御するための優れた機能があります。</font><font style="vertical-align: inherit;">マルウェアの動作を詳細に検討する時が来ました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSISおよびPowerShellドロッパー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分析を開始する実行可能PEファイルは、Nullsoft Scriptable Install System（NSIS）プラットフォームに基づくインストーラーです。インストールプロセスを実行するNSISスクリプトは、埋め込まれたPowerShellスクリプトを取得して実行します</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xt/aj/nu/xtajnurxwbyfsilz4yamr5cckmq.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 3. NSISスクリプトの説明実行中の</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PowerShellスクリプトには、Base64でエンコードされたバッファー（明確にするために下の図では省略されています）が含まれています。デコード後、CBCモードのトリプルDES（3DES）によって復号化されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uo/ow/r0/uoowr0t6nf0s2khnk2blkkgdk8c.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 4. PowerShellスクリプト内のデータの復号化スクリプト</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の最初の部分は、名前を話す機能を備えた関数であり、システムの特権を増やし、UAC保護をバイパスする責任があります。これには2つの手法が使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手法No. 1：タスクスケジューラでSilentCleanupタスクを使用します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクはユーザーが起動できますが、管理者特権で動作します。</font><font style="vertical-align: inherit;">タスクプロパティには、％windir％環境変数を使用した実行可能ファイルへのパスが含まれています。</font><font style="vertical-align: inherit;">環境変数の値を変更して（たとえば、PowerShellスクリプトの起動を指定して）、タスクを起動すると、UACに警告することなく、管理者権限でPowerShellスクリプトが実行されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者は、Windows 8およびWindows 10システムでこの手法を使用します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この手法を実行するコード</font><font style="vertical-align: inherit;">は、Metasploitフレームワークのモジュール</font><font style="vertical-align: inherit;">の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じです</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/4n/jo/_s/4njo_svmmajgn-z2xmf5iuddj78.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">5. SilentCleanupタスクバイパス</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
テクニックを使用し</font><i><font style="vertical-align: inherit;">たスクリプトの一部</font></i><font style="vertical-align: inherit;">テクニック2：sysprep.exeシステムユーティリティとサイドローディングDLLテクニックを使用します。</font></font><br>
<br>
<ul>
<li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>   PowerShell-   C:\Windows\Temp.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CAB-</a>,    DLL- CRYPTBASE.dll (PowerShell-   x86-,   x64- ).    wusa.exe      C:\Windows\System32\Sysprep.     sysprep.exe,     DLL-,  ,   ,   .   PowerShell-        UAC.</li>
<li>      Windows 7.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細な説明は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事と、</font><font style="vertical-align: inherit;">Githubの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクト</font><font style="vertical-align: inherit;">などの実装例にあり</font><font style="vertical-align: inherit;">ます。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/9j/lv/cd/9jlvcdqsqskqepj5qxegbsxapky.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">6. sysprep.exeユーティリティをバイパスする手法を使用したスクリプトの一部</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スクリプトには、多くのコメント、未使用のTest-Administrator関数、初期化なしで使用される変数が含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要な権限でスクリプトを実行した後、スクリプトの2番目の部分が実行されます。</font><font style="vertical-align: inherit;">この段階で、ターゲットペイロードがデコードされます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列はBase64によってデコードされ、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deflate</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して拡張されます</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列はBase64によって再デコードされます。</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/er/an/bg/eranbgnpwn2psafs1n0o0i5uv7s.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。</font><font style="vertical-align: inherit;">7.ペイロードデコードアルゴリズム</font></font></i><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その結果、次のファイルがシステムに作成されます。</font></font></li>
<li>%systemroot%\help\hlp11.dat — x86/x64-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">RDP Wrapper Library</a>.      RDP,        .  ,   :     XOR   <b>c:\windows\help\hlp12.dat</b>,      DLL-:</li>
</ul><br>
<img src="https://habrastorage.org/webt/vl/ji/xm/vljixm5vye-ncz-p5hkkl-mfpjw.png"><br>
<br>
<i>. 8.    DLL-   </i><br>
<br>
<ul>
<li>%systemroot%\help\hlp12.dat — x86/x64-  ServHelper,      ;</li>
<li>%systemroot%\help\hlp13.dat —    RDP Wrapper Library,</li>
<li>%systemroot%\system32\rdpclip.exe —   RDP      ;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％systemroot％\ system32 \ rfxvmt.dllは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RemoteFX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジを使用してデータを送信するためのRDPサービスコンポーネントです</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ペイロードを抽出して記録した後、スクリプトはコンポーネントの正しい操作を設定します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rfxvmt.dllコンポーネントの所有者をNT SERVICE \ TrustedInstallerに変更し、必要な権限を付与します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RDP接続のポート値を標準の3389から7201に変更します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカル管理者グループにネットワークサービスアカウントを追加します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hlp11.datをRDPサービスとして登録し、サービスを再起動します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成した一時ファイルを削除します。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServHelper RAT→ドロッパー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドロッパーの結果の1つは、ServHelperマルウェアであるhlp12.dat DLLです。 OSのビットサイズに応じて、ライブラリのx86バージョンとx64バージョンの両方を作成できます（基本的な違いはありません）。どちらのバージョンもDelphiで記述され、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPX 3.95</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（x64）および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PeCompact 2.20</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（x86）</font><font style="vertical-align: inherit;">とともにパッケージ化されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proofpoint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trend Microの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同僚は</font><font style="vertical-align: inherit;">以前、このバックドアの配布と操作の分析を発表しました。サンプルの機能の武器は、すでに知られているものとほぼ一致しています。特に、使用されている文字列を復号化するアルゴリズム（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vigenere暗号</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">は変更されていません</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ul/ms/cy/ulmscymkg-0u1nk02c9kqxz8brs.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 9. Vigenere暗号を使用して文字列を復号化するための擬似コード</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味深いのは、すべての文字列に暗号化が実装されていないことです。たとえば、制御ドメインのアドレスや追加コンポーネントのあるWebリンクは開いたまま</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a-/bd/uu/a-bduux2q7geptwtgyeijtiqpzw.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。 10.暗号化されていないドメインとWebリンク</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これらのリンク（hxxp：//letitbe.icu/2.txt）の1つにアクセスすると、暗号化されたファイルがダウンロードされます（MD5：0528104f496dd13438dd764e747d0778）。 16進エディタでファイルの終わりを分析すると、バイト0x09の値が頻繁に繰り返されることがわかります</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gm/1o/9f/gm1o9ff_vl6w12nr0dfxgxu78zu.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 11.ダウンロードしたファイルでバイト0x09を繰り返します。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
繰り返されるバイト値は、暗号化としてシングルバイトXORを使用することの頻繁な兆候です。この場合、この理論は次のコードによって確認されます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/7k/lq/aw7klqin_brodmhtoy7wccnhw9c.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 12.シングルバイトXOR暗号化機能</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/bv/pt/vd/bvptvd-axazrevfus5vxogr5kuy.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 13.引数として1バイトの値をXOR関数に渡す</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
復号化の結果、次の内容のZIPアーカイブを取得します</font></font><br>
<br>
<img src="https://habrastorage.org/webt/it/oi/w2/itoiw2a-gl6palkqplytqjv4ae4.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 14.復号化されたZIPアーカイブの内容</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
すべてのファイルは</font><font style="vertical-align: inherit;">、さまざまなグループの攻撃者によって繰り返し使用されたNetSupport Manager PCのリモートコントロール用の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正規の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソフトウェアです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qs/1f/1b/qs1f1b0xwk9zrfddvzixc4mizhy.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図。 15. NetSupport Managerソフトウェアの説明</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ファイルの1つ（client32.ini）は</font><font style="vertical-align: inherit;">、被害者のPCが攻撃者に接続する際に経由</font><font style="vertical-align: inherit;">する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中間ゲートウェイの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドレスを含む構成ファイルです</font></font><br>
<br>
<img src="https://habrastorage.org/webt/up/ch/fe/upchfeck-veyfpct418q8h1akre.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 16.攻撃者がNetSupport Managerゲートウェイとしてアドレスする</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションは、被害者がファイアウォールの背後にあり、インターネットアクセスがポートによって制限されている場合に意味があります。インターネットで正しく機能するには、80（HTTP）と443（HTTPS）の少なくとも2つのポートへのアクセスを開く必要があるため、接続が成功する可能性が高くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2019年9月に、オプションの範囲が大幅に限定された類似のServHelperサンプルがいくつか見つかりました。例としてそれらの1つを使用すると（MD5：5b79a0c06aec6126364ce1d5cbfedf66）：実行可能なPEファイルのリソースの中に、繰り返しバイトの形式で同様の特性を持つ暗号化されたデータがあります</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ue/iy/tt/ueiytt_k_swonc2vfbnvcrnylos.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 17. ServHelperリソースの暗号化されたデータ</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、再び1バイトで「詰まった」ZIPアーカイブであり、NetSupport Managerの同じコンポーネントが含まれていますが、今回は中間ゲートウェイが異なります：179 [。] 43.146.90：443。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、TA505バックドアの配信と使用のオプションの1つであるServHelperについて検討しました。メインコンポーネントの操作に先行する興味深い機能（UACのバイパスや特権の昇格など）に加えて、メインバックドアの興味深い変容に気づきました。基本的な機能（データの盗難、スパイ、コマンドの実行）は、PCリモートコントロール用の別のツール（NetSupport RAT）を埋め込むことによって補足されました。さらに、ServHelperの新しいバージョンには、本格的なバックドアを実現する主要な機能がなくなりました。今では、NetSupport RATをインストールするための中間ドロッパーとしてのみ機能します。おそらく攻撃者は、このアプローチが開発と検出機能の両方の点でより効果的であることを発見した。しかし、私たちが興味を持っているグループのツールのリスト、それだけでは終わりません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positive Technologies、Alexey Vishnyakov </font><b><font style="vertical-align: inherit;">による投稿</font></b></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IOC</font></font></b><div class="spoiler_text">hxxp://185.225.17.175/wrkn157.exe — -,    NSIS-<br>
d2a062ca772fa3ace7c7edadbd95eaf7 —  NSIS-<br>
0cacea3329f35e88a4f9619190e3746f — PowerShell- shipkat.ps1<br>
fb609b00e29689db74c853ca7d69f440 — CRYPTBASE.dll (x86)<br>
843288a35906aa90b2d1cc6179588a26 — CRYPTBASE.dll (x64)<br>
445cd6df302610bb640baf2d06438704 — hlp11.dat (x86)<br>
083f66cc0e0f626bbcc36c7f143561bd — hlp11.dat (x64)<br>
40bae264ea08b0fa115829c5d74bf3c1 — hlp12.dat (x86)<br>
ac72ab230608f2dca1da1140e70c92ad — hlp12.dat (x64)<br>
07f1dc2a9af208e88cb8d5140b54e35e — hlp13.dat<br>
1690e3004f712c75a2c9ff6bcde49461 — rdpclip.exe<br>
dc39d23e4c0e681fad7a3e1342a2843c — rfxvmt.dll<br>
ServHelper C2:<br>
179[.]43.156.32<br>
185[.]163.45.124<br>
185[.]163.45.175<br>
185[.]225.17.150<br>
185[.]225.17.169<br>
185[.]225.17.175<br>
185[.]225.17.98<br>
195[.]123.221.66<br>
195[.]123.246.192<br>
37[.]252.8.63<br>
94[.]158.245.123<br>
94[.]158.245.154<br>
94[.]158.245.232<br>
fdguyt5ggs[.]pw<br>
foxlnklnk[.]xyz<br>
gidjshrvz[.]xyz<br>
letitbe[.]icu<br>
pofasfafha[.]xyz<br>
0528104f496dd13438dd764e747d0778 —  ZIP-  NetSupport RAT<br>
 NetSupport Manager:<br>
953896600dfb86750506706f1599d415 — cksini.exe<br>
8d9709ff7d9c83bd376e01912c734f0a — client32.exe<br>
2d3b207c8a48148296156e5725426c7f — HTCTL32.DLL<br>
0e37fbfa79d349d672456923ec5fbbe3 — msvcr100.dll<br>
26e28c01461f7e65c402bdf09923d435 — nskbfltr.inf<br>
88b1dab8f4fd1ae879685995c90bd902 — NSM.ini<br>
7067af414215ee4c50bfcd3ea43c84f0 — NSM.LIC<br>
dcde2248d19c778a41aa165866dd52d0 — pcicapi.dll<br>
a0b9388c5f18e27266a31f8c5765b263 — PCICHEK.DLL<br>
00587238d16012152c2e951a087f2cc9 — PCICL32.DLL<br>
2a77875b08d4d2bb7b654db33a88f16c — remcmdstub.exe<br>
eab603d12705752e3d268d86dff74ed4 — TCCTL32.DLL<br>
185[.]225.17.66:443 — NetSupport RAT GatewayAddress<br>
5b79a0c06aec6126364ce1d5cbfedf66 — ServHelper   NetSupport RAT<br>
179[.]43.146.90:443 — NetSupport RAT GatewayAddress</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja471948/index.html">ボックスで遊ぶ</a></li>
<li><a href="../ja471950/index.html">未来への私のビジョンD</a></li>
<li><a href="../ja471954/index.html">自分のインターネットラジオ</a></li>
<li><a href="../ja471956/index.html">アニメーション化された状態グラフ</a></li>
<li><a href="../ja471958/index.html">バグのあるGAのAmazon EX Windowsですが、誰よりも高速です</a></li>
<li><a href="../ja471964/index.html">オラクルが救いに来る</a></li>
<li><a href="../ja471968/index.html">偽のPayPalサイトからランサムウェアNemtyに出会う</a></li>
<li><a href="../ja471974/index.html">2人の船長が将軍になった方法：白と赤</a></li>
<li><a href="../ja471976/index.html">ITスペシャリストはどのように海外で仕事を得るのですか？</a></li>
<li><a href="../ja471978/index.html">ディープラーニングだけで構築されたAIシステムは信頼できない</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>