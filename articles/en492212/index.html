<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÖ üê± üè¢ Frontend development of portals on open source software: share experience üññüèæ üïØÔ∏è üë©üèΩ‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part of the article on how we create portal solutions for the largest employers in Russia, the architecture was described by the backend....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Frontend development of portals on open source software: share experience</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/492212/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first part of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article on how we create portal solutions for the largest employers in Russia, the architecture was described by the backend. </font><font style="vertical-align: inherit;">In this article we will pass to frontend.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/j5/rj/wzj5rj7alebchimas2cqght5dcq.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As already noted in the first part, our main goal was to develop a platform that can be easily scaled and maintained. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The reusability of the</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Front is mostly written in Vue.js, and since the entire portal is divided into portlets, each of them is a separate Vue instance with its own side (Vuex), route (Vue Router) and components. Each such instance is moved to its own repository. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the portlet is in its repository, the question arises of how not to write a lot of the same type of code for different portlets. To solve this problem, we transfer everything that can be reused to a separate repository, which is then connected via .gitmodules. At the moment there are two such submodules.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One stores common functionality: these are common components, services, constants, etc. We have this module called Vue-common. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second submodule contains settings for assembly, it stores configs for webpack, as well as loaders and helpers needed during assembly. This module is called Vue-bundler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the convenience of working with the API, REST methods were also divided into general and local. In Vue-common, methods were introduced for obtaining a list of portal users, administration methods, access to the portal file system, and others. All API endpoints were moved to separate services that registered at the entry point and connected to the Vue instance. Then they could be used anywhere in the application.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each individual service is registered inside the plugin. </font><font style="vertical-align: inherit;">Vue has a built-in use function for connecting plugins. </font><font style="vertical-align: inherit;">Read more about plugins in Vue </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The plugin itself is initialized like this:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Api</span> </span>{<font></font>
    constructor () {<font></font>
        <span class="hljs-comment">//  http ,   </span>
        <span class="hljs-keyword">this</span>.instance = instance<font></font>
<font></font>
        <span class="hljs-comment">//     </span>
       <span class="hljs-comment">//     this,      http </span>
        Object.keys(commonServices).forEach(name =&gt; commonServices[name](<span class="hljs-keyword">this</span>))<font></font>
        <font></font>
        <span class="hljs-comment">//     </span>
	requireService.keys().forEach(filename =&gt; requireService(filename).<span class="hljs-keyword">default</span>(<span class="hljs-keyword">this</span>))<font></font>
    }<font></font>
<font></font>
    install () {<font></font>
	Vue.prototype.$api= <span class="hljs-keyword">this</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function">export <span class="hljs-keyword">default</span> new <span class="hljs-title">Api</span><span class="hljs-params">()</span>
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to initialization:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The http client instance is created. </font><font style="vertical-align: inherit;">Which sets the baseURL of our backend and the headers</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> instance = axios.create({<font></font>
	baseURL: <span class="hljs-string">'/example/api'</span>,<font></font>
	responseType: <span class="hljs-string">'json'</span>,<font></font>
	headers: {<font></font>
		<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
		<span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'no-cache'</span>,
		<span class="hljs-string">'Pragma'</span>: <span class="hljs-string">'no-cache'</span>,<font></font>
	}<font></font>
})<font></font>
                backend   ,   axios.</code></pre><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Services are created that store the requests themselves</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-comment">// api -   http </span>
export <span class="hljs-keyword">default</span> api =&gt; {<font></font>
	api.exampleService= {<font></font>
		exampleGetRequest(params) {<font></font>
			<span class="hljs-keyword">return</span> api.instance.request({<font></font>
				method: <span class="hljs-string">'get'</span>,<font></font>
				url: `example/get`,<font></font>
				params<font></font>
			})<font></font>
		},<font></font>
		examplePostRequest(data) {<font></font>
			<span class="hljs-keyword">return</span> api.instance.request({<font></font>
				method: <span class="hljs-string">'post'</span>,<font></font>
				url: `example/post`,<font></font>
				data<font></font>
			})<font></font>
		},<font></font>
	}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In vue-common it‚Äôs enough to create only such a service, and it is already registered for each portlet in the Api class</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">General and local services are registered</font></font><br>
<br>
<pre><code class="java hljs">     <span class="hljs-keyword">const</span> requireService = require.context(<span class="hljs-string">'./service'</span>, <span class="hljs-keyword">false</span>, /.service.js$/)
</code></pre></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In components, they are used very simply. </font><font style="vertical-align: inherit;">For instance:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
	<span class="hljs-attr">methods</span>: {<font></font>
		someMethod() {<font></font>
    			<span class="hljs-keyword">this</span>.$api.exampleService.exampleGetRequest()<font></font>
}<font></font>
}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you need to make requests outside the application, you can do this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//    (@ -     )</span>
<span class="hljs-keyword">import</span> api <span class="hljs-keyword">from</span> ‚Äò@/api‚Äô<font></font>
<font></font>
<span class="hljs-comment">//        </span><font></font>
api.exampleService.exampleGetRequest()<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scaling</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
As noted above, a separate bundle is collected for each portal, and each bundle has its own entry points. In each of them, components and assets are registered, authorization is configured for local development, and plug-ins are connected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Components are registered globally for each application, both local and general. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Component registration looks like this:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> _ from ‚Äúlodash‚Äù<font></font>
<font></font>
<span class="hljs-keyword">const</span> requireComponent = require.context(<span class="hljs-string">'@/components'</span>, <span class="hljs-keyword">true</span>, /^[^_].+\.vue$/i)<font></font>
<font></font>
requireComponent.keys().forEach(filename =&gt; {<font></font>
    <span class="hljs-keyword">const</span> componentConfig = requireComponent(filename)<font></font>
<font></font>
    <span class="hljs-comment">// Get PascalCase name of component</span>
    <span class="hljs-keyword">const</span> componentName = _.upperFirst(<font></font>
        _.camelCase(/\/\w+\.vue/.exec(filename)[<span class="hljs-number">0</span>].replace(/^\.\<span class="hljs-comment">//, '').replace(/\.\w+$/, ''))</span><font></font>
    )<font></font>
<font></font>
    Vue.component(componentName, componentConfig.<span class="hljs-keyword">default</span> || componentConfig)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sometimes it becomes necessary for the portal we are developing to add unique functionality, and for this you have to write components that are unique to it, or simply implement a component in a different way. It is enough to create a component in a separate folder, for example / components-portal / * portal name * / *. Vue, and register it in the desired entry point, adding require.context not for one folder, but for several.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> contexts = [<font></font>
    require.context(<span class="hljs-string">'@/components'</span>, <span class="hljs-keyword">true</span>, /^[^_].+\.vue$/i),<font></font>
   require.context(<span class="hljs-string">'@/components-portal/example'</span>, <span class="hljs-keyword">true</span>, /^[^_].+\.vue$/i)<font></font>
]<font></font>
<font></font>
contexts.forEach(requireComponent =&gt; {<font></font>
    requireComponent.keys().forEach(filename =&gt; {<font></font>
        <span class="hljs-keyword">const</span> componentConfig = requireComponent(filename)<font></font>
<font></font>
        <span class="hljs-comment">// Get PascalCase name of component</span>
        <span class="hljs-keyword">const</span> componentName = _.upperFirst(<font></font>
            _.camelCase(/\/\w+\.vue/.exec(filename)[<span class="hljs-number">0</span>].replace(/^\.\<span class="hljs-comment">//, '').replace(/\.\w+$/, ''))</span><font></font>
        )<font></font>
<font></font>
        Vue.component(componentName, componentConfig.<span class="hljs-keyword">default</span> || componentConfig)<font></font>
    })<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you set the same name for the component for a specific portal as from the general library of components, then it will simply be rewritten as an object property and will be used as a component for this portal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assets such as svg icons are also globally registered. </font><font style="vertical-align: inherit;">We use svg-sprite-loader to create a sprite from svg icons and then use them via &lt;use: xlink: href = "# * icon name *" /&gt; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
They are registered like this:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">const</span> requireAll = (r) =&gt; r.keys().forEach(r)<font></font>
<font></font>
<span class="hljs-keyword">const</span> requireContext = require.context(<span class="hljs-string">'@/assets/icons/'</span>, <span class="hljs-keyword">true</span>, /\.svg$/)<font></font>
<font></font>
requireAll(requireContext)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to scale not only functionality, but also component styles, we have implemented a mechanism for changing styles for a particular portal. </font><font style="vertical-align: inherit;">Single-file components specify styles in the &lt;style&gt; tag and are used by default. </font><font style="vertical-align: inherit;">In order to implement styles for a specific portal, you need to register them in another tag</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492194/index.html">Meet a guy selling wireless devices to quickly steal luxury cars</a></li>
<li><a href="../en492200/index.html">Test Automation: Java or Python?</a></li>
<li><a href="../en492202/index.html">–ö–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å COVID-19: —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, –±–µ–∑ –ø–∞–Ω–∏–∫–∏</a></li>
<li><a href="../en492204/index.html">How to work around errors when building reporting in Power BI and come to the construction of an upload system for big data</a></li>
<li><a href="../en492210/index.html">Infinidat Storage Architecture Technical Overview</a></li>
<li><a href="../en492214/index.html">Why is it worth making meetings while walking? Proven by science, confirmed by the mafia</a></li>
<li><a href="../en492216/index.html">Saving Values ‚Äã‚Äãin a .Net Application at the Build Stage</a></li>
<li><a href="../en492218/index.html">Icon Design Rules to Remember</a></li>
<li><a href="../en492220/index.html">5 little-known secrets of Pandas</a></li>
<li><a href="../en492222/index.html">Write-up CTFZone Quals 2019: Chicken</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>