<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌄 🌭 🧝🏽 Symfony 4にSonata Adminをインストールして設定する 👨🏻‍🚀 🗳️ 🍆</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="すべてを歓迎する。この記事では、Symfony 4とSonata Adminについて説明します。
 

インストールプロセス中に、ドキュメントに多くの不正確さがあり、ドキュメント自体がいくつかの場所に散らばっていました。ここでは、プロジェクトの作成から承認、認証までのプロセス全体を検討します。
 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Symfony 4にSonata Adminをインストールして設定する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460345/"><p><img src="https://habrastorage.org/webt/n2/xh/96/n2xh96fzfztxqianwy4t1pehha4.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを歓迎する。</font><font style="vertical-align: inherit;">この記事では、Symfony 4とSonata Adminについて説明します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インストールプロセス中に、ドキュメントに多くの不正確さがあり、ドキュメント自体がいくつかの場所に散らばっていました。</font><font style="vertical-align: inherit;">ここでは、プロジェクトの作成から承認、認証までのプロセス全体を検討します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定の一部は公式ドキュメントから取得され、一部はインストールの問題が議論されたGitHubのコメントから取得されました。</font><font style="vertical-align: inherit;">考えられる落とし穴とその回避策も描かれています。</font></font></p><a name="habracut"></a> <br>
<h2 id="sozdaem-proekt-na-symfony"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">symfonyプロジェクトを作成する</font></font></h2><br>
<pre><code class="bash hljs">$ composer create-project symfony/skeleton sonatademo</code></pre><br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> sonatademo</code></pre><br>
<p>      Symfony   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Symfony Client</a>.</p><br>
<p>.</p><br>
<pre><code class="bash hljs">$ symfony serve</code></pre><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://127.0.0.1:8000/</a>     Symfony.    .</p><br>
<p><img src="https://habrastorage.org/webt/or/fj/is/orfjisfkh5hnvoxwf2nwqrmpkxi.png"></p><br>
<h2 id="ustanavlivaem-sonata-admin"> Sonata Admin</h2><br>
<pre><code class="bash hljs">$ composer require sonata-project/admin-bundle</code></pre><br>
<h3 id="sonata-admin-i-bd">Sonata Admin  </h3><br>
<p> ,           :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SonataDoctrineORMAdminBundle</a> (  Doctrine ORM);</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SonataDoctrineMongoDBAdminBundle</a> (  Doctrine MongoDB ODM);</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SonataDoctrinePhpcrAdminBundle</a> (  Doctrine PHPCR ODM).</li>
</ul><br>
<p>     <code>SonataDoctrineORMAdminBundle</code>,        <code>MySQL</code>  <code>Sqlite</code>.</p><br>
<p> <code>SonataDoctrineORMAdminBundle</code>.</p><br>
<pre><code class="bash hljs">$ composer require sonata-project/doctrine-orm-admin-bundle</code></pre><br>
<p>    <code>Sqlite</code>.</p><br>
<p> .env     <code>###&gt; doctrine/doctrine-bundle ###</code>  <code>DATABASE_URL</code>.</p><br>
<pre><code class="plaintext hljs">DATABASE_URL="sqlite:///%kernel.project_dir%/var/data.db"</code></pre><br>
<p>  Symfony Flex        ,         .</p><br>
<pre><code class="plaintext hljs"># config/packages/framework.yaml<font></font>
framework:<font></font>
    translator: { fallbacks: ['en'] }</code></pre><br>
<p></p><br>
<pre><code class="bash hljs">$ composer dump-env dev</code></pre><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://127.0.0.1:8000/admin</a>      .</p><br>
<p><img src="https://habrastorage.org/webt/mk/d9/th/mkd9thdshpjvqwx4vihqq2faqky.png"></p><br>
<h2 id="sozdanie-suschnostey"> </h2><br>
<p>    ,       .</p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Entity/City.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">Common</span>\<span class="hljs-title">Collections</span>\<span class="hljs-title">ArrayCollection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ORM</span>\Entity
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">City</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Id()
     * <span class="hljs-doctag">@ORM</span>\GeneratedValue()
     * <span class="hljs-doctag">@ORM</span>\Column(type="integer", options={"unsigned":true})
     */</span>
    <span class="hljs-keyword">private</span> $id;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * <span class="hljs-doctag">@ORM</span>\Column(type="string")
     */</span>
    <span class="hljs-keyword">private</span> $title;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * <span class="hljs-doctag">@ORM</span>\Column(type="text")
     */</span>
    <span class="hljs-keyword">private</span> $description;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> bool
     *
     * <span class="hljs-doctag">@ORM</span>\Column(type="boolean")
     */</span>
    <span class="hljs-keyword">private</span> $isBig = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\OneToMany(targetEntity="Address", mappedBy="city")
     */</span>
    <span class="hljs-keyword">private</span> $addresses;<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;addresses = <span class="hljs-keyword">new</span> ArrayCollection();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAddresses</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;addresses;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTitle</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;title;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> string $title
     * <span class="hljs-doctag">@return</span> City
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTitle</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $title</span>): <span class="hljs-title">City</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;title = $title;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDescription</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;description;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> string $description
     * <span class="hljs-doctag">@return</span> City
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDescription</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $description</span>): <span class="hljs-title">City</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;description = $description;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> bool
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBig</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;isBig;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> bool $isBig
     * <span class="hljs-doctag">@return</span> City
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setIsBig</span>(<span class="hljs-params"><span class="hljs-keyword">bool</span> $isBig</span>): <span class="hljs-title">City</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;isBig = $isBig;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;title;<font></font>
    }<font></font>
}</code></pre><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Entity/Address.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ORM</span>\Entity
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Id()
     * <span class="hljs-doctag">@ORM</span>\GeneratedValue()
     * <span class="hljs-doctag">@ORM</span>\Column(type="integer", options={"unsigned":true})
     */</span>
    <span class="hljs-keyword">private</span> $id;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * <span class="hljs-doctag">@ORM</span>\Column(type="string")
     */</span>
    <span class="hljs-keyword">private</span> $title;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@var</span> string
     *
     * <span class="hljs-doctag">@ORM</span>\Column(type="text")
     */</span>
    <span class="hljs-keyword">private</span> $description;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\ManyToOne(targetEntity="City", inversedBy="addresses")
     */</span>
    <span class="hljs-keyword">private</span> $city;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTitle</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;title;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> string $title
     * <span class="hljs-doctag">@return</span> Address
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTitle</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $title</span>): <span class="hljs-title">Address</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;title = $title;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDescription</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;description;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> string $description
     * <span class="hljs-doctag">@return</span> Address
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDescription</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $description</span>): <span class="hljs-title">Address</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;description = $description;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> City
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCity</span>(<span class="hljs-params"></span>): ?<span class="hljs-title">City</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;city;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> City $city
     * <span class="hljs-doctag">@return</span> Address
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setCity</span>(<span class="hljs-params">City $city</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;city = $city;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;title;<font></font>
    }<font></font>
}</code></pre><br>
<p>  .</p><br>
<pre><code class="bash hljs">bin/console doctrine:schema:create</code></pre><br>
<h2 id="nastroyka-suschnostey-dlya-sonata-admin">   Sonata Admin</h2><br>
<p>        ,  Sonata Admin  .</p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">// src/Admin/CityAdmin.php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Admin</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">Address</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">City</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Admin</span>\<span class="hljs-title">AbstractAdmin</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Datagrid</span>\<span class="hljs-title">ListMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Datagrid</span>\<span class="hljs-title">DatagridMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">FormMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">CollectionType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">ModelType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TextType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">CheckboxType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TextareaType</span>;<font></font>
<font></font>
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityAdmin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractAdmin</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureFormFields</span>(<span class="hljs-params">FormMapper $formMapper</span>)
    </span>{<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'title'</span>, TextType::class);<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'description'</span>, TextareaType::class);<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'isBig'</span>, CheckboxType::class);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureDatagridFilters</span>(<span class="hljs-params">DatagridMapper $datagridMapper</span>)
    </span>{<font></font>
        $datagridMapper-&gt;add(<span class="hljs-string">'title'</span>);<font></font>
        $datagridMapper-&gt;add(<span class="hljs-string">'isBig'</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureListFields</span>(<span class="hljs-params">ListMapper $listMapper</span>)
    </span>{<font></font>
        $listMapper-&gt;addIdentifier(<span class="hljs-string">'title'</span>);<font></font>
        $listMapper-&gt;addIdentifier(<span class="hljs-string">'isBig'</span>);<font></font>
    }<font></font>
}</code></pre><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">// src/Admin/AddressAdmin.php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Admin</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">City</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Admin</span>\<span class="hljs-title">AbstractAdmin</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Datagrid</span>\<span class="hljs-title">ListMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Datagrid</span>\<span class="hljs-title">DatagridMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">FormMapper</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">AdminBundle</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">ModelType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TextType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">CheckboxType</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Form</span>\<span class="hljs-title">Extension</span>\<span class="hljs-title">Core</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TextareaType</span>;<font></font>
<font></font>
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddressAdmin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractAdmin</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureFormFields</span>(<span class="hljs-params">FormMapper $formMapper</span>)
    </span>{<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'title'</span>, TextType::class);<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'description'</span>, TextareaType::class);<font></font>
        $formMapper-&gt;add(<span class="hljs-string">'city'</span>, ModelType::class, [
            <span class="hljs-string">'class'</span> =&gt; City::class,
            <span class="hljs-string">'property'</span> =&gt; <span class="hljs-string">'title'</span>,<font></font>
        ]);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureDatagridFilters</span>(<span class="hljs-params">DatagridMapper $datagridMapper</span>)
    </span>{<font></font>
        $datagridMapper-&gt;add(<span class="hljs-string">'title'</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureListFields</span>(<span class="hljs-params">ListMapper $listMapper</span>)
    </span>{<font></font>
        $listMapper-&gt;addIdentifier(<span class="hljs-string">'title'</span>);<font></font>
    }<font></font>
}</code></pre><br>
<p>     <code>service.yaml</code>.</p><br>
<pre><code class="plaintext hljs"># config/service.yaml<font></font>
services:<font></font>
    ...<font></font>
    App\Admin\CityAdmin:<font></font>
        arguments: [~, App\Entity\City, ~]<font></font>
        tags:<font></font>
            - { name: sonata.admin, manager_type: orm, label: City }<font></font>
    App\Admin\AddressAdmin:<font></font>
        arguments: [~, App\Entity\Address, ~]<font></font>
        tags:<font></font>
            - { name: sonata.admin, manager_type: orm, label: Address }</code></pre><br>
<p>       ,  <code>Unable to generate a URL for the named route</code>,        .</p><br>
<pre><code class="bash hljs">bin/console cache:clear</code></pre><br>
<p>,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://127.0.0.1:8000/admin</a>      <code>Address</code>  <code>City</code>,        .</p><br>
<p><img src="https://habrastorage.org/webt/v5/v-/x-/v5v-x-c76ucdru47nfew_kbnhsu.png"></p><br>
<h2 id="avtorizaciya-i-autentifikaciya">  </h2><br>
<p>    .</p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Entity/User.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">UserBundle</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">BaseUser</span> <span class="hljs-title">as</span> <span class="hljs-title">BaseUser</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ORM</span>\Entity
 * <span class="hljs-doctag">@ORM</span>\Table(name="fos_user")
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseUser</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Id
     * <span class="hljs-doctag">@ORM</span>\Column(type="integer", options={"unsigned":true})
     * <span class="hljs-doctag">@ORM</span>\GeneratedValue(strategy="AUTO")
     */</span>
    <span class="hljs-keyword">protected</span> $id;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> int
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getId</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;id;<font></font>
    }<font></font>
}</code></pre><br>
<p>     .</p><br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// src/Entity/Group.php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Entity</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Sonata</span>\<span class="hljs-title">UserBundle</span>\<span class="hljs-title">Entity</span>\<span class="hljs-title">BaseGroup</span> <span class="hljs-title">as</span> <span class="hljs-title">BaseGroup</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Doctrine</span>\<span class="hljs-title">ORM</span>\<span class="hljs-title">Mapping</span> <span class="hljs-title">as</span> <span class="hljs-title">ORM</span>;<font></font>
<font></font>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ORM</span>\Entity
 * <span class="hljs-doctag">@ORM</span>\Table(name="fos_group")
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Group</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseGroup</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@ORM</span>\Id
     * <span class="hljs-doctag">@ORM</span>\Column(type="integer", options={"unsigned":true})
     * <span class="hljs-doctag">@ORM</span>\GeneratedValue(strategy="AUTO")
     */</span>
    <span class="hljs-keyword">protected</span> $id;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> int
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getId</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;id;<font></font>
    }<font></font>
}</code></pre><br>
<p>  Twig   .</p><br>
<pre><code class="plaintext hljs">framework:<font></font>
    ...<font></font>
    templating:<font></font>
        engines: ['twig']</code></pre><br>
<p>       Symfony Flex  FOSUserBundle.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">#2562</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">#2708</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">#2801</a>.</p><br>
<p>    ,        <code>Sonata User Bundle</code>.</p><br>
<pre><code class="plaintext hljs"># config/service.yaml<font></font>
services:<font></font>
    ...<font></font>
    mailer:<font></font>
        alias: fos_user.mailer.noop<font></font>
        public: true</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/fos_user.yaml<font></font>
fos_user:<font></font>
  db_driver: orm<font></font>
  firewall_name: main<font></font>
  user_class: App\Entity\User<font></font>
  registration:<font></font>
    confirmation:<font></font>
      enabled: false<font></font>
  from_email:<font></font>
    address: '%env(MAILER_USER_ADDRESS)%'<font></font>
    sender_name: '%env(MAILER_USER_NAME)%'<font></font>
  service:<font></font>
    user_manager: sonata.user.orm.user_manager<font></font>
    mailer: 'fos_user.mailer.noop'<font></font>
  group:<font></font>
    group_class:   App\Entity\Group<font></font>
    group_manager: sonata.user.orm.group_manager</code></pre><br>
<p> ,   .</p><br>
<pre><code class="bash hljs">$ composer require sonata-project/user-bundle</code></pre><br>
<h3 id="nastroyka-acl"> ACL</h3><br>
<p> Symfony 4 ACL     <code>symfony/acl-bundle</code>.     .</p><br>
<pre><code class="bash hljs">composer require symfony/acl-bundle</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/sonata_user.yaml<font></font>
sonata_user:<font></font>
    security_acl: true<font></font>
    manager_type: orm</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/acl.yaml<font></font>
acl:<font></font>
    connection: default</code></pre><br>
<h3 id="nastroyka-doctrine"> Doctrine</h3><br>
<pre><code class="plaintext hljs"># config/packages/doctrine.yaml<font></font>
doctrine:<font></font>
    orm:<font></font>
         mappings:<font></font>
             SonataUserBundle: ~<font></font>
             FOSUserBundle: ~</code></pre><br>
<h3 id="nastroyka-raboty-s-pochtoy">   </h3><br>
<p>          ,      .</p><br>
<pre><code class="plaintext hljs"># config/packages/sonata_user.yaml<font></font>
<font></font>
sonata_user:<font></font>
    mailer: fos_user.mailer.noop</code></pre><br>
<h3 id="integraciya-user-bundle-v-sonata-admin"> User Bundle  Sonata Admin</h3><br>
<pre><code class="plaintext hljs"># config/routes.yaml<font></font>
sonata_user_admin_security:<font></font>
    resource: '@SonataUserBundle/Resources/config/routing/admin_security.xml'<font></font>
    prefix: /admin<font></font>
<font></font>
sonata_user_admin_resetting:<font></font>
    resource: '@SonataUserBundle/Resources/config/routing/admin_resetting.xml'<font></font>
    prefix: /admin/resetting</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/security.yaml<font></font>
security:<font></font>
    encoders:<font></font>
        FOS\UserBundle\Model\UserInterface: sha512<font></font>
    providers:<font></font>
        fos_userbundle:<font></font>
            id: fos_user.user_provider.username<font></font>
    role_hierarchy:<font></font>
        ROLE_ADMIN:       [ROLE_USER, ROLE_SONATA_ADMIN]<font></font>
        ROLE_SUPER_ADMIN: [ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]<font></font>
    firewalls:<font></font>
        dev:<font></font>
            pattern:  ^/(_(profiler|wdt)|css|images|js)/<font></font>
            security: false<font></font>
<font></font>
        # -&gt; custom firewall for the admin area of the URL<font></font>
        admin:<font></font>
            pattern:            /admin(.*)<font></font>
            context:            user<font></font>
            form_login:<font></font>
                provider:       fos_userbundle<font></font>
                login_path:     /admin/login<font></font>
                use_forward:    false<font></font>
                check_path:     /admin/login_check<font></font>
                failure_path:   null<font></font>
            logout:<font></font>
                path:           /admin/logout<font></font>
                target:         /admin/login<font></font>
            anonymous:          true<font></font>
<font></font>
        # -&gt; end custom configuration<font></font>
<font></font>
        # default login area for standard users<font></font>
<font></font>
        # This firewall is used to handle the public login area<font></font>
        # This part is handled by the FOS User Bundle<font></font>
        main:<font></font>
            pattern:             .*<font></font>
            context:             user<font></font>
            form_login:<font></font>
                provider:       fos_userbundle<font></font>
                login_path:     /login<font></font>
                use_forward:    false<font></font>
                check_path:     /login_check<font></font>
                failure_path:   null<font></font>
            logout:             true<font></font>
            anonymous:          true<font></font>
    access_control:<font></font>
        # Admin login page needs to be accessed without credential<font></font>
        - { path: ^/admin/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }<font></font>
        - { path: ^/admin/logout$, role: IS_AUTHENTICATED_ANONYMOUSLY }<font></font>
        - { path: ^/admin/login_check$, role: IS_AUTHENTICATED_ANONYMOUSLY }<font></font>
        - { path: ^/admin/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }<font></font>
<font></font>
        # Secured part of the site<font></font>
        # This config requires being logged for the whole site and having the admin role for the admin part.<font></font>
        # Change these rules to adapt them to your needs<font></font>
        - { path: ^/admin/, role: [ROLE_ADMIN, ROLE_SONATA_ADMIN] }<font></font>
        - { path: ^/.*, role: IS_AUTHENTICATED_ANONYMOUSLY }<font></font>
</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/sonata_user.yaml<font></font>
sonata_user:<font></font>
  ...<font></font>
  class:<font></font>
    user: App\Entity\User<font></font>
    group: App\Entity\Group</code></pre><br>
<p>   ACL  .</p><br>
<pre><code class="bash hljs">$ bin/console acl:init</code></pre><br>
<pre><code class="bash hljs">$ php bin/console doctrine:schema:update --force</code></pre><br>
<p>  .   <code>demo</code>   <code>demo</code>.</p><br>
<pre><code class="bash hljs">$ bin/console fos:user:create --super-admin<font></font>
Please choose a username:demo<font></font>
Please choose an email:demo@demo.com<font></font>
Please choose a password:<font></font>
Created user demo</code></pre><br>
<p>    Admin    ACL     .</p><br>
<pre><code class="plaintext hljs">sonata_admin:<font></font>
    ...<font></font>
    security:<font></font>
         handler: sonata.admin.security.handler.acl</code></pre><br>
<p>  :</p><br>
<pre><code class="bash hljs">$ bin/console sonata:admin:setup-acl<font></font>
Starting ACL AdminBundle configuration<font></font>
 &gt; install ACL <span class="hljs-keyword">for</span> App\Admin\AddressAdmin<font></font>
   - add role: ROLE_APP\ADMIN\ADDRESSADMIN_GUEST, permissions: [<span class="hljs-string">"LIST"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\ADDRESSADMIN_STAFF, permissions: [<span class="hljs-string">"LIST"</span>,<span class="hljs-string">"CREATE"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\ADDRESSADMIN_EDITOR, permissions: [<span class="hljs-string">"OPERATOR"</span>,<span class="hljs-string">"EXPORT"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\ADDRESSADMIN_ADMIN, permissions: [<span class="hljs-string">"MASTER"</span>]<font></font>
 &gt; install ACL <span class="hljs-keyword">for</span> App\Admin\CityAdmin<font></font>
   - add role: ROLE_APP\ADMIN\CITYADMIN_GUEST, permissions: [<span class="hljs-string">"LIST"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\CITYADMIN_STAFF, permissions: [<span class="hljs-string">"LIST"</span>,<span class="hljs-string">"CREATE"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\CITYADMIN_EDITOR, permissions: [<span class="hljs-string">"OPERATOR"</span>,<span class="hljs-string">"EXPORT"</span>]<font></font>
   - add role: ROLE_APP\ADMIN\CITYADMIN_ADMIN, permissions: [<span class="hljs-string">"MASTER"</span>]<font></font>
 &gt; install ACL <span class="hljs-keyword">for</span> sonata.user.admin.user<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_USER_GUEST, permissions: [<span class="hljs-string">"LIST"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_USER_STAFF, permissions: [<span class="hljs-string">"LIST"</span>,<span class="hljs-string">"CREATE"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_USER_EDITOR, permissions: [<span class="hljs-string">"OPERATOR"</span>,<span class="hljs-string">"EXPORT"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_USER_ADMIN, permissions: [<span class="hljs-string">"MASTER"</span>]<font></font>
 &gt; install ACL <span class="hljs-keyword">for</span> sonata.user.admin.group<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_GROUP_GUEST, permissions: [<span class="hljs-string">"LIST"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_GROUP_STAFF, permissions: [<span class="hljs-string">"LIST"</span>,<span class="hljs-string">"CREATE"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_GROUP_EDITOR, permissions: [<span class="hljs-string">"OPERATOR"</span>,<span class="hljs-string">"EXPORT"</span>]<font></font>
   - add role: ROLE_SONATA_USER_ADMIN_GROUP_ADMIN, permissions: [<span class="hljs-string">"MASTER"</span>]</code></pre><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://127.0.0.1:8000/admin</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">http://127.0.0.1:8000/admin/login</a>.</p><br>
<p><img src="https://habrastorage.org/webt/d_/lp/tb/d_lptbxdgrx4tlwjld8xosducio.png"></p><br>
<p> demo/demo     .</p><br>
<p><img src="https://habrastorage.org/webt/gp/lm/p9/gplmp9c_xk6qvkisevlrit9u3z0.png"></p><br>
<h2 id="itogi"></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての操作の後、Symfony 4のSonata Adminの実際の管理部分と、Sonata User + ACLを使用した認証と承認が得られました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ありがとうございます。</font><font style="vertical-align: inherit;">質問やコメントがありましたら、コメント欄で聞きます。</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460329/index.html">FEDORではなく、Skybot F-850がISSに飛びます</a></li>
<li><a href="../ja460335/index.html">Google ChromeはXSS攻撃からの保護を停止しますか？</a></li>
<li><a href="../ja460339/index.html">Webアプリケーションの競合状態</a></li>
<li><a href="../ja460341/index.html">ASOの継続：傾向、評価、および少しのフィードバック</a></li>
<li><a href="../ja460343/index.html">ゲーム開発が私の人生の一部になった物語</a></li>
<li><a href="../ja460347/index.html">Sophos UEMによるモバイルデバイス管理など</a></li>
<li><a href="../ja460349/index.html">Check Point Falconアクセラレーションカード-トラフィック処理の高速化</a></li>
<li><a href="../ja460351/index.html">werf-KubernetesのCI / CD用ツール（レビューとビデオレポート）</a></li>
<li><a href="../ja460353/index.html">ガラスのニューラルネットワーク。電力を必要とせず、数字を認識します</a></li>
<li><a href="../ja460355/index.html">溺死を救うことは私たちのビジネスです：チームの意欲低下に対処する方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>