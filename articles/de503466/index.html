<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêµ üëü üíé √úber SSH Agent ü¶ç ü§¥ üà¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung
 SSH-Agent ist Teil von OpenSSH. In diesem Beitrag werde ich erkl√§ren, was ein Agent ist, wie er verwendet wird und wie er funktioniert, um...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>√úber SSH Agent</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillfactory/blog/503466/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSH-Agent ist Teil von OpenSSH. </font><font style="vertical-align: inherit;">In diesem Beitrag werde ich erkl√§ren, was ein Agent ist, wie er verwendet wird und wie er funktioniert, um Ihre Schl√ºssel zu sch√ºtzen. </font><font style="vertical-align: inherit;">Ich werde auch die Agentenweiterleitung und deren Funktionsweise beschreiben. </font><font style="vertical-align: inherit;">Ich werde Ihnen dabei helfen, das Risiko der Verwendung der Agentenweiterleitung zu verringern, und eine Alternative zur Agentenweiterleitung vorstellen, die Sie beim Zugriff auf Ihre internen Hosts √ºber Bastionen verwenden k√∂nnen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist ein SSH-Agent?</font></font></h3><br>
<code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist ein Schl√ºsselmanager f√ºr SSH. </font><font style="vertical-align: inherit;">Es speichert Ihre Schl√ºssel und Zertifikate unverschl√ºsselt und einsatzbereit im Speicher </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dadurch m√ºssen Sie nicht jedes Mal ein Kennwort eingeben, wenn Sie eine Verbindung zum Server herstellen. </font><font style="vertical-align: inherit;">Es wird im Hintergrund auf Ihrem System ausgef√ºhrt, getrennt von </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und startet normalerweise beim ersten Start </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der SSH-Agent </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sch√ºtzt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geheime Schl√ºssel, da </font><i><font style="vertical-align: inherit;">dies nicht der Fall ist</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es werden keine Schl√ºsselinformationen auf die Festplatte geschrieben.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen Ihre privaten Schl√ºssel nicht exportieren.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Agent gespeicherte geheime Schl√ºssel k√∂nnen nur f√ºr einen Zweck verwendet werden: das Signieren einer Nachricht. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber wenn ein Agent nur Nachrichten signieren kann, wie verschl√ºsselt und entschl√ºsselt SSH den Datenverkehr? </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der ersten Studie zu √∂ffentlichen und privaten SSH-Schl√ºsseln wird nat√ºrlich davon ausgegangen, dass SSH diese Schl√ºsselpaare zum Ver- und Entschl√ºsseln des Datenverkehrs verwendet. </font><font style="vertical-align: inherit;">Genau das habe ich mir gedacht. </font><font style="vertical-align: inherit;">Dies ist jedoch nicht der Fall. </font><font style="vertical-align: inherit;">Das SSH-Schl√ºsselpaar wird nur zur Authentifizierung w√§hrend der ersten Verbindung verwendet.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So √ºberpr√ºfen Sie beispielsweise einen Benutzerschl√ºssel w√§hrend einer SSH-Verbindung aus Serversicht:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Client stellt dem Server einen √∂ffentlichen Schl√ºssel zur Verf√ºgung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Server generiert und sendet eine kurze zuf√§llige Nachricht, in der er den Client auffordert, sie mit einem privaten Schl√ºssel zu signieren.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Client fordert den SSH-Agenten auf, die Nachricht zu signieren, und sendet das Ergebnis an den Server zur√ºck.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Server √ºberpr√ºft die Signatur mit dem √∂ffentlichen Schl√ºssel des Clients.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt hat der Server den Beweis, dass der Client den privaten Schl√ºssel besitzt.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sp√§ter, w√§hrend des Verbindungsprozesses, wird eine Reihe neuer, kurzlebiger und symmetrischer Schl√ºssel generiert, die zum Verschl√ºsseln des SSH-Sitzungsverkehrs verwendet werden. </font><font style="vertical-align: inherit;">Diese Schl√ºssel dauern m√∂glicherweise nicht einmal eine ganze Sitzung. </font><font style="vertical-align: inherit;">Das Rekey-Ereignis tritt in regelm√§√üigen Abst√§nden auf.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agentenprotokoll</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSH verwendet einen Unix-Dom√§nensocket, um √ºber </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das SSH-Agentenprotokoll</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem Agenten zu kommunizieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die meisten Leute verwenden die </font></font><code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit OpenSSH gelieferte, aber es gibt viele Open-Source-Alternativen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Agentenprotokoll ist so einfach, dass Sie in ein oder zwei Tagen einen einfachen SSH-Agenten schreiben k√∂nnen. </font><font style="vertical-align: inherit;">Es hat nur wenige grundlegende Operationen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºgen Sie ein regul√§res Schl√ºsselpaar hinzu (√∂ffentliche und entschl√ºsselte private Schl√ºssel).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºgen Sie ein begrenztes Schl√ºsselpaar hinzu (√∂ffentliche und entschl√ºsselte private Schl√ºssel).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schl√ºssel (regul√§r oder begrenzt) von der Smartcard hinzuf√ºgen (nur √∂ffentlicher Schl√ºssel)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schl√ºssel l√∂schen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auflistung der im Agenten gespeicherten Schl√ºssel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Signieren einer Nachricht mit einem im Agenten gespeicherten Schl√ºssel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sperren oder entsperren Sie einen gesamten Agenten mit einem Passwort</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Was ist ein begrenzter Schl√ºssel? </font><font style="vertical-align: inherit;">Dies ist normalerweise ein Schl√ºssel, der entweder eine begrenzte Lebensdauer hat oder eine explizite Best√§tigung durch den Benutzer erfordert, wenn er verwendet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Befehl </font></font><code>ssh-add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist Ihr Gateway zum SSH-Agenten. </font><font style="vertical-align: inherit;">Er f√ºhrt alle diese Operationen mit Ausnahme der Unterschrift aus. </font><font style="vertical-align: inherit;">Wenn Sie ssh-add ohne Parameter ausf√ºhren, durchsucht es Ihr Home-Verzeichnis nach einigen Standardschl√ºsseln und f√ºgt sie Ihrem Agenten hinzu. </font><font style="vertical-align: inherit;">Standardm√§√üig wird gesucht nach:</font></font><br>
<br>
<ul>
<li><code>~/.ssh/id_rsa</code></li>
<li><code>~/.ssh/id_ed25519</code></li>
<li><code>~/.ssh/id_dsa</code></li>
<li><code>~/.ssh/id_ecdsa</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobald Sie die Schl√ºssel zum Schl√ºsselbund hinzuf√ºgen, werden sie automatisch verwendet </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><code>ssh-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und der mit macOS gelieferte</font></font></b><br>
<code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS-Schl√ºsselbund kann Passphrasen f√ºr Schl√ºssel im macOS-Schl√ºsselbund speichern, wodurch das erneute Hinzuf√ºgen von Schl√ºsseln zum Agenten nach einem Neustart noch einfacher wird. </font><font style="vertical-align: inherit;">Abh√§ngig von Ihren Schl√ºsselbundeinstellungen m√ºssen Sie sie m√∂glicherweise nach einem Neustart noch entsperren. </font><font style="vertical-align: inherit;">F√ºhren Sie den Befehl aus, um Schl√ºsselpassphrasen im Schl√ºsselbund zu speichern </font></font><code>ssh-add -K [  ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Passphrasen werden normalerweise in ‚ÄûLokalen Elementen‚Äú gespeichert. </font></font><code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verwendet diese gespeicherten Passphrasen bei Bedarf automatisch.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist Agentenweiterleitung?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der Agentenweiterleitungsfunktion kann Ihr lokaler SSH-Agent </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ºber eine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vorhandene SSH-Verbindung </font><font style="vertical-align: inherit;">kommunizieren </font><font style="vertical-align: inherit;">und sich transparent bei einem Remote-Server authentifizieren. </font><font style="vertical-align: inherit;">Angenommen, Sie melden sich √ºber SSH bei EC2 an und m√∂chten von dort aus ein privates GitHub-Repository klonen. </font><font style="vertical-align: inherit;">Ohne Agentenweiterleitung m√ºssen Sie eine Kopie Ihres privaten GitHub-Schl√ºssels auf dem EC2-Host speichern. </font><font style="vertical-align: inherit;">Wenn der Agent umgeleitet wird, kann der SSH-Client auf EC2 die Schl√ºssel auf Ihrem lokalen Computer zur Authentifizierung auf GitHub verwenden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So funktioniert die Agentenweiterleitung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens ein kleiner Hintergrund. SSH-Verbindungen k√∂nnen mehrere Kan√§le haben. Hier ein allgemeines Beispiel: Eine interaktive Verbindung zum Bastion-Host (Sprungbox) wird auf einem Kanal durchgef√ºhrt. Wenn die Agentenweiterleitung f√ºr die Verbindung aktiviert ist (normalerweise √ºber </font></font><code>ssh -A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), wird im Hintergrund ein zweiter Kanal ge√∂ffnet, um alle Agentenanforderungen an Ihren lokalen Computer weiterzuleiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Bezug auf </font></font><code>ssh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt es keinen Unterschied zwischen Remote und lokal </font></font><code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. SSH √ºberpr√ºft immer die Umgebungsvariable </font></font><code>$SSH_AUTH_SOCK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um den Unix-Dom√§nensocket f√ºr den Agenten zu finden. Wenn Sie eine Verbindung zu einem Remote-Host mit aktivierter Agentenweiterleitung herstellen, erstellt SSHD einen Remote-Unix-Dom√§nensocket, der dem Agentenweiterleitungskanal zugeordnet ist, und exportiert diesen </font></font><code>$SSH_AUTH_SOCK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der darauf verweist.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f69/ea9/46b/f69ea946b3478140760c5c3881dcb0af.png" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Weiterleitung von Agenten ist mit einem bestimmten Risiko verbunden</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie einen </font></font><code>ssh-agent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unix- </font><font style="vertical-align: inherit;">Domain-Socket </font><font style="vertical-align: inherit;">auf einen Remote-Host </font><font style="vertical-align: inherit;">umleiten </font><font style="vertical-align: inherit;">, stellt dies ein Sicherheitsrisiko dar: Jeder Benutzer mit Root-Zugriff auf den Remote-Host kann √ºber den Socket diskret auf Ihren lokalen SSH-Agenten zugreifen. </font><font style="vertical-align: inherit;">Sie k√∂nnen Ihre Schl√ºssel verwenden, um sich auf anderen Computern im Netzwerk auszugeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Beispiel, wie dies aussehen k√∂nnte:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7f1/cc1/bb7/7f1cc1bb734605ffb65e003b20cf1566.png" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So reduzieren Sie Ihr Risiko durch Agentenweiterleitung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind einige M√∂glichkeiten, um die Agentenumleitung sicherer zu machen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht </font></font><code>ForwardAgent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standardm√§√üig aktivieren.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Blockieren Sie Ihren SSH-Agenten, wenn Sie die Agentenweiterleitung verwenden. </font></font><code>ssh-add -x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blockiert den Agenten mit einem Passwort und </font></font><code>ssh-add -X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entsperrt es. </font><font style="vertical-align: inherit;">Wenn Sie mit einer Agentenweiterleitung mit einem Remote-Host verbunden sind, kann niemand Ihren Agenten ohne Kennwort eingeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder verwenden Sie einen alternativen SSH-Agenten, der Sie fragt, wann er verwendet wird. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwendet Touch ID unter macOS, um Schl√ºssel in der MacBook Pro-Sicherheitsenklave zu speichern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder verwenden Sie die Agentenweiterleitung √ºberhaupt nicht. </font><font style="vertical-align: inherit;">Wenn Sie versuchen, √ºber Bastion auf interne Hosts zuzugreifen, gibt </font></font><code>ProxyJump</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es f√ºr diesen Anwendungsfall eine viel sicherere Alternative. </font><font style="vertical-align: inherit;">(siehe unten)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwendung </font></font><code> ProxyJump</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: eine sicherere Alternative</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie durch Bastion-Host (Jumpbox) gehen m√∂chten, brauchen Sie wirklich keine Agent'a-Weiterleitung. </font><font style="vertical-align: inherit;">Der beste Ansatz ist die Verwendung der Richtlinie </font></font><code> ProxyJump</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstatt den Agenten √ºber einen separaten Kanal </font></font><code>ProxyJump</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umzuleiten </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">leitet er die Standardeingabe und -ausgabe Ihres lokalen SSH-Clients √ºber Bastion und weiter zum Remote-Host um. </font><font style="vertical-align: inherit;">So funktioniert das:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºhren Sie </font></font><code>ssh -J bastion.example.com cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Verbindung aus, um eine Verbindung </font></font><code>cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ºber Ihren Bastion-Host herzustellen </font></font><code>bastion.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist der Hostname, der durch Suchen von DNS auf gefunden werden kann </font></font><code>bastion.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ihr SSH-Client verwendet die Schl√ºssel Ihres Agenten, um eine Verbindung herzustellen </font></font><code>bastion.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach dem Verbinden von SSHD mit Bastion wird eine </font></font><code>cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbindung zu Ihrem lokalen SSH-Client hergestellt und diese Verbindung an diesen √ºbertragen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ihr lokaler SSH-Client geht die Verbindung erneut durch, diesmal mit </font></font><code>cloud.computer.internal</code></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen es sich als SSH in einer SSH-Sitzung vorstellen. </font><font style="vertical-align: inherit;">au√üer dass ssh niemals auf bastion l√§uft. </font><font style="vertical-align: inherit;">Stattdessen wird eine </font></font><code>sshd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbindung zu </font></font><code>cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieser Verbindung (Standardeingabe und -ausgabe) hergestellt und die Steuerung an Ihre lokale SSH zur√ºckgegeben, die dann eine zweite Verbindung herstellt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProxyJump konfigurieren Sagen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
wir Bastion-Host </font></font><code>bastion.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ich kann meine </font></font><code>~/.ssh/config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so </font><font style="vertical-align: inherit;">konfigurieren </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">Host bastion.example.com<font></font>
	User carl<font></font>
<font></font>
Host *.computer.internal<font></font>
	ProxyJump bastion.example.com<font></font>
	User carl</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann renne ich einfach los </font></font><code>ssh cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um √ºber Bastion eine Verbindung zum internen Ziel herzustellen - ohne Agentenweiterleitung. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn ProxyJump nicht funktioniert ...</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
√Ñltere Versionen von SSH und SSHD (vor Version 7.2, ver√∂ffentlicht im Jahr 2016) werden nicht unterst√ºtzt </font></font><code>ProxyJump</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie k√∂nnen jedoch eine √§quivalente Operation mit </font></font><code>ProxyCommand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netcat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausf√ºhren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Hier ist ein Beispiel:</font></font><br>
<br>
<pre><code class="plaintext hljs">ssh -o ProxyCommand="ssh bastion.example.com nc %h %p" cloud.computer.internal</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Magie hier ist, dass SSH selbst der Proxyserver ist, den Sie f√ºr SSH verwenden. </font><font style="vertical-align: inherit;">Der Teil </font></font><code>nc %h %p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∂ffnet einfach die Raw-Socket-Verbindung zu </font></font><code>cloud.computer.internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port 22. Die Standardeingabe / -ausgabe des √ºbergeordneten ssh-Befehls wird direkt an √ºbergeben, </font></font><code>ProxyCommand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">damit sich der √ºbergeordnete ssh √ºber eine Proxy-Verbindung beim internen Host authentifizieren kann.</font></font><br>
<br>
<hr><br>
<img src="https://habrastorage.org/webt/nk/j2/oz/nkj2oztxanscb6lhq19l-dfv2z8.jpeg" alt="Bild" align="left"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erfahren Sie in SkillFactory-Onlinekursen, wie Sie einen begehrten Beruf von Grund auf neu erlernen oder Ihre F√§higkeiten und Ihr Gehalt verbessern k√∂nnen:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Scientist Profession Course (24 Monate) </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beruf Data Analyst Kurs (18 Monate)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python f√ºr Webentwicklungskurs (9 Monate)</font></font></a></li>
</ul> <br>
<br clear="left">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weiterlesen</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">450 kostenlose Kurse aus der Ivy League</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30 Life Hacks, um den Online-Kurs abzuschlie√üen</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503446/index.html">Wo k√∂nnen Sie 2020 ein Bankkonto f√ºr ein nicht ans√§ssiges Unternehmen aus der Kategorie mit hohem Risiko er√∂ffnen?</a></li>
<li><a href="../de503448/index.html">Wenn Sie ein Data Scientist sind, k√∂nnen Sie sich nicht den Reihen der angehenden Spezialisten anschlie√üen</a></li>
<li><a href="../de503450/index.html">Geschichten √ºber meine Arbeit in den Niederlanden</a></li>
<li><a href="../de503454/index.html">So werden Sie Senior Frontend Developer</a></li>
<li><a href="../de503458/index.html">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç —Å –ø–æ–º–æ–π–∫–∏</a></li>
<li><a href="../de503468/index.html">5 n√ºtzliche und frische Tools f√ºr die Remote-Arbeit in einem verteilten Team</a></li>
<li><a href="../de503472/index.html">Bargeldloses Bezahlen, Podcasts und k√ºnstliches Fleisch: Was andere Unternehmen mit der Coronavirus-Krise gut bew√§ltigen</a></li>
<li><a href="../de503474/index.html">Meine Anwendungsentwicklungserfahrung als PM</a></li>
<li><a href="../de503476/index.html">Nehmen Sie Video-UI-Autotests auf, die in kopflosem Chrome funktionieren</a></li>
<li><a href="../de503480/index.html">Bis zu 40 Tausend: √úber 10 Vinyl Player-Bewertungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>