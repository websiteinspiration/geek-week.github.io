<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÖüèº üôçüèª üìâ Scaling a Redux app with ducks üëÄ üèüÔ∏è üõÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In anticipation of the start of the course "React.js developer" prepared a translation of useful material.
 
 
 
 
 How does the front-end of your app...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Scaling a Redux app with ducks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/492638/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In anticipation of the start of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"React.js developer"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prepared a translation of useful material.</font></font><br>
</i></b><br>
<br>
<img src="https://habrastorage.org/webt/v4/na/xg/v4naxgyec9pamduy0s1qf7gjqyc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How does the front-end of your application scale? How to make your code support six months later? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In 2015, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stormed the front-end development world and established itself as a standard beyond React. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The company I work for has recently finished refactoring a large code base on React, where we implemented redux instead of </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reflux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We had to take this step because moving forward was not possible without a well-structured application and a clear set of rules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code base has been around for more than two years and reflux has been in it from the very beginning. We had to change the code, strongly tied to React components, which no one had touched for more than a year.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on the experience from the work done, I created this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which will help explain our approach to organizing code on redux.</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When you learn more about redux, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , you start with simple examples. </font><font style="vertical-align: inherit;">Many tutorials available today do not go beyond them. </font><font style="vertical-align: inherit;">However, if you are creating something more complex on Redux than a task list, you will need a reasonable way to scale your code base over time. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Someone once said that in computer science there is no more difficult task than giving different things names. </font><font style="vertical-align: inherit;">I could not disagree. </font><font style="vertical-align: inherit;">In this case, folder structuring and file organization will be in second place. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's look at how we used to approach code organization.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function vs Feature</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 There are two generally accepted approaches to organizing applications: function-first and feature-first. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 In the screenshot on the left, the folder structure is organized according to the principle of function-first, and on the right - feature-first. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/le/wb/urlewbt5etkrntpbqzlygb0yzlo.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Function-first means that your top-level directories are named according to the files inside. So you have: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">containers, components, actions, reducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This does not scale at all. As your application grows and new functionality appears, you will add files to the same folders. As a result, you will need to scroll the contents of one of the folders for a long time to find the desired file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another problem is combining folders. One of your application threads will probably require access to files from all folders.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the advantages of this approach is that it can isolate, in our case, React from Redux. Therefore, if you want to change the state management library, you will know which folders you will need. If you need to change the view library, you can leave the folders with redux intact. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Feature-first means that top-level directories will be named in accordance with the main functionality of the application: product, cart, session. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This approach scales much better, since each new feature lies in a new folder. However, you do not have a separation between the Redux and React components. Changing one of them in the long run is not an easy task.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition, you will have files that will not belong to any function. </font><font style="vertical-align: inherit;">As a result, it all comes down to the common or shared folder, because you also want to use your code in different features of your application.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combining the best of two worlds</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Although this is not the topic of the article, I want to say that the state management files from the UI files need to be stored separately. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Think about your application in the long run. Imagine what happens to your code if you switch from React to something else. Or think about how your codebase will use ReactNative in parallel with the web version. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the heart </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of our approach</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the principle of isolation React code in a folder called </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">views</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and code redux in another folder called redux. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This separation at the entry level gives us the flexibility to organize the individual parts of the application in completely different ways. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inside the </font><i><font style="vertical-align: inherit;">views</font></i><font style="vertical-align: inherit;"> folder</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we support the organization of function-first files. </font><font style="vertical-align: inherit;">In the context of React, this looks natural: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pages, layouts, components, enhancers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order not to go crazy about the number of files in a folder, you can use the feature-first approach inside these folders. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meanwhile, in the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> folder </font><font style="vertical-align: inherit;">...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introducing re-ducks</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Each application function must correspond to separate actions and reducers, so that it makes sense to apply the feature-first approach. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The original modular approach </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ducks</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> makes it easy to work with redux and offers a structured way to add new functionality to your application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, you wanted to understand what happens when you scale the application. </font><font style="vertical-align: inherit;">We realized that the way to organize one file per feature clutters the application and makes its support problematic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">re-ducks appeared</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The solution was to split the functionality into duck folders.</font></font><br>
<br>
<pre><code class="javascript hljs">duck/<font></font>
‚îú‚îÄ‚îÄ actions.js<font></font>
‚îú‚îÄ‚îÄ index.js<font></font>
‚îú‚îÄ‚îÄ operations.js<font></font>
‚îú‚îÄ‚îÄ reducers.js<font></font>
‚îú‚îÄ‚îÄ selectors.js<font></font>
‚îú‚îÄ‚îÄ tests.js<font></font>
‚îú‚îÄ‚îÄ types.js<font></font>
‚îú‚îÄ‚îÄ utils.js</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 The duck folder should:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contain all the logic of processing only ONE concept of your application, for example: product, cart, session, etc.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contain the index.js file, which is exported according to duck rules.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Store code in a single file that does similar work, such as reducers, selectors, and actions.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contain tests related to duck.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, in this example, we did not use abstractions built on top of redux. </font><font style="vertical-align: inherit;">When creating software, it is important to start with the least amount of abstraction. </font><font style="vertical-align: inherit;">Thus, you will see that the value of your abstractions does not exceed the benefits of them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to make sure abstraction is bad, watch this </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cheng Lou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> video </font><font style="vertical-align: inherit;">. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's look at the contents of each file.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Types</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">types</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file </font><font style="vertical-align: inherit;">contains the names of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that you execute in your application. </font><font style="vertical-align: inherit;">As a good practice, you should try to cover the namespace corresponding to the function to which they belong. </font><font style="vertical-align: inherit;">This approach will help when debugging complex applications.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> QUACK = <span class="hljs-string">"app/duck/QUACK"</span>;
<span class="hljs-keyword">const</span> SWIM = <span class="hljs-string">"app/duck/SWIM"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    QUACK,<font></font>
    SWIM<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actions</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 This file contains all the functions of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">action creator</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> quack = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.QUACK<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">const</span> swim = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.SWIM,
    <span class="hljs-attr">payload</span>: {<font></font>
        distance<font></font>
    }<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    swim,<font></font>
    quack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Note that all </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions are</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> represented by functions, even if they are not parameterized. </font><font style="vertical-align: inherit;">A consistent approach is the highest priority for a large code base.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operations</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 To represent the chain of operations ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Operations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), you will need the redux </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">middleware</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , to improve the function of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the dispatch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Popular examples are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-saga,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-observable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk is used</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We need to separate </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">action creators,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> even at the cost of writing extra code. Therefore, we will define the operation as a wrapper over </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the operation sends only one </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">action</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, it does not actually use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we send the </font><i><font style="vertical-align: inherit;">action creator</font></i><font style="vertical-align: inherit;"> function</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If the operation uses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it can send a lot of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and link them using </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">promises</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
<span class="hljs-comment">// This is a link to an action defined in actions.js.</span>
<span class="hljs-keyword">const</span> simpleQuack = actions.quack;<font></font>
<font></font>
<span class="hljs-comment">// This is a thunk which dispatches multiple actions from actions.js</span>
<span class="hljs-keyword">const</span> complexQuack = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params"> dispatch </span>) =&gt;</span> {<font></font>
    dispatch( actions.quack( ) ).then( <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> {<font></font>
        dispatch( actions.swim( distance ) );<font></font>
        dispatch( <span class="hljs-comment">/* any action */</span> );<font></font>
    } );<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    simpleQuack,<font></font>
    complexQuack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Call them operations, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sagas, epics, as you want. </font><font style="vertical-align: inherit;">Just identify the principles of naming and stick to them. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the very end, we'll talk about index and see that operations are part of the duck public interface. </font><font style="vertical-align: inherit;">Actions are encapsulated, operations become accessible from the outside.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reducers</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 If you have a more multifaceted function, you should definitely use several </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to handle complex state structures. In addition, do not be afraid to use as many </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as you need. This will allow working with state object structures more freely.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">"redux"</span>;
<span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-comment">/* State Shape
{
    quacking: bool,
    distance: number
}
*/</span><font></font>
<font></font>
<span class="hljs-keyword">const</span> quackReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-literal">false</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.QUACK: <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> distanceReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-number">0</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.SWIM: <span class="hljs-keyword">return</span> state + action.payload.distance;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> reducer = combineReducers( {
    <span class="hljs-attr">quacking</span>: quackReducer,
    <span class="hljs-attr">distance</span>: distanceReducer<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 In a large application, the state tree will consist of at least three levels. </font><font style="vertical-align: inherit;">The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> functions </font><font style="vertical-align: inherit;">should be as small as possible and handle only simple data constructs. </font><font style="vertical-align: inherit;">The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">is all you need to create a flexible and maintainable state structure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check out the full-fledged </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project example</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and see how to use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">combineReducers properly</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , especially in files </font></font><code>reducers.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>store.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where we are </font><i><font style="vertical-align: inherit;">building the</font></i><font style="vertical-align: inherit;"> state tree.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selectors</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Along with the operations selector ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selector</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) are part of the public interface duck. </font><font style="vertical-align: inherit;">The difference between operations and selectors is similar to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CQRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pattern </font><font style="vertical-align: inherit;">. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selector functions take a slice of the application state and return some data based on it. </font><font style="vertical-align: inherit;">They never make changes to the state of the application.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkIfDuckIsInRange</span>(<span class="hljs-params"> duck </span>) </span>{
    <span class="hljs-keyword">return</span> duck.distance &gt; <span class="hljs-number">1000</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    checkIfDuckIsInRange<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Index</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 This file indicates what will be exported from the duck folder. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Is he:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exports the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">from duck by default.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exports selectors and operations as registered exports.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exports types if required in other ducks.</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckSelectors } <span class="hljs-keyword">from</span> <span class="hljs-string">"./selectors"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckOperations } <span class="hljs-keyword">from</span> <span class="hljs-string">"./operations"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tests</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The advantage of using Redux with the ducks framework is that you can write tests right after the code you want to test. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Testing your code on Redux is pretty straight forward:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">"expect.js"</span>;
<span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
describe( <span class="hljs-string">"duck reducer"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
    describe( <span class="hljs-string">"quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{
        <span class="hljs-keyword">const</span> quack = actions.quack( );
        <span class="hljs-keyword">const</span> initialState = <span class="hljs-literal">false</span>;<font></font>
<font></font>
        <span class="hljs-keyword">const</span> result = reducer( initialState, quack );<font></font>
<font></font>
        it( <span class="hljs-string">"should quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
            expect( result ).to.be( <span class="hljs-literal">true</span> ) ;<font></font>
        } );<font></font>
    } );<font></font>
} );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inside this file you can write tests for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , operations, selectors, etc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I could write a whole separate article about the benefits of code testing, but they are already enough, so just test your code!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That's all</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The good news about re-ducks is that you can use the same template for all your redux code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feature-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> based partitioning approach </font><font style="vertical-align: inherit;">for your redux code helps your application stay flexible and scalable as it grows. </font><font style="vertical-align: inherit;">A </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">function-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> based separation approach </font><font style="vertical-align: inherit;">will work well when building small components that are common to different parts of the application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can take a look at the full </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">react-redux-example</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> code base </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Keep in mind that the repository is actively working. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How do you organize your redux applications? </font><font style="vertical-align: inherit;">I look forward to feedback on the described approach. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
See you on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">course</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492616/index.html">Packer, Terraform and Ansible: Kubernetes cluster deployment in an hour</a></li>
<li><a href="../en492622/index.html">‚ÄúHey bully, bring whiskey!‚Äù, Or About English words with Irish roots</a></li>
<li><a href="../en492628/index.html">Confidence interval for the number of patients with coronavirus (mortality calculation)</a></li>
<li><a href="../en492632/index.html">Quarantined small business: panic is the enemy of reason</a></li>
<li><a href="../en492636/index.html">What does it mean to be effective?</a></li>
<li><a href="../en492642/index.html">Create a scalable and resilient architecture with dynamic microservices</a></li>
<li><a href="../en492652/index.html">Card game "Fool" on two M5Stack</a></li>
<li><a href="../en492658/index.html">I went to a remote control - launched a podcast: what to read for beginners - 5 proven books</a></li>
<li><a href="../en492660/index.html">The whole world against coronavirus. Intel Stories</a></li>
<li><a href="../en492662/index.html">How I first streamed a university lecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>