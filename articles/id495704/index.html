<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👩‍👦‍👦 🧚 🦋 Memantau peralatan jaringan melalui SNMPv3 di Zabbix ⚫️ ♎️ 👨‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini membahas fitur pemantauan peralatan jaringan menggunakan protokol SNMPv3. Kami akan berbicara tentang SNMPv3, saya akan membagikan pengala...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Memantau peralatan jaringan melalui SNMPv3 di Zabbix</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zabbix/blog/495704/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel ini membahas fitur pemantauan peralatan jaringan menggunakan protokol SNMPv3. </font><font style="vertical-align: inherit;">Kami akan berbicara tentang SNMPv3, saya akan membagikan pengalaman saya dalam membuat templat lengkap di Zabbix, dan menunjukkan apa yang dapat Anda capai ketika mengatur peringatan yang didistribusikan di jaringan besar. </font><font style="vertical-align: inherit;">SNMP adalah protokol utama untuk memantau peralatan jaringan, dan Zabbix sangat baik untuk memantau sejumlah besar objek dan merangkum volume signifikan dari metrik yang masuk.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa kata tentang SNMPv3</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan penunjukan SNMPv3, dan fitur penggunaannya. </font><font style="vertical-align: inherit;">Tugas SNMP adalah memonitor perangkat jaringan, dan manajemen dasar, dengan mengirimkan perintah sederhana kepada mereka (misalnya, menghidupkan dan mematikan antarmuka jaringan, atau me-reboot perangkat). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perbedaan utama antara protokol SNMPv3 dan versi sebelumnya adalah fitur keamanan klasik [1-3], yaitu:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otentikasi, yang menentukan bahwa permintaan diterima dari sumber tepercaya;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enkripsi, untuk mencegah pengungkapan data yang dikirimkan ketika dicegat oleh pihak ketiga;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integritas, yaitu, jaminan bahwa paket tidak dirusak selama pengiriman.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNMPv3 menyiratkan penggunaan model keamanan di mana strategi otentikasi ditetapkan untuk pengguna tertentu dan grup yang menjadi tempatnya (dalam versi SNMP sebelumnya, dalam permintaan dari server ke objek pemantauan, hanya "komunitas" yang dibandingkan, string teks dengan "kata sandi" yang dikirimkan dalam bentuk yang jelas) (teks biasa)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNMPv3 memperkenalkan konsep tingkat keamanan - tingkat keamanan yang dapat diterima yang menentukan konfigurasi peralatan dan perilaku agen SNMP dari objek pemantauan. Kombinasi dari model keamanan dan tingkat keamanan menentukan mekanisme keamanan mana yang digunakan saat memproses paket SNMP [4]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabel ini menjelaskan kombinasi model dan tingkat keamanan SNMPv3 (saya memutuskan untuk meninggalkan tiga kolom pertama seperti yang asli):</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/5x/ac/qu5xacorpr-q2zreebuvsul87vw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karenanya, kami akan menggunakan SNMPv3 dalam mode otentikasi menggunakan enkripsi.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasikan SNMPv3 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peralatan jaringan pemantauan melibatkan konfigurasi yang sama dari protokol SNMPv3 baik pada server pemantauan dan pada objek yang dipantau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai dengan mengkonfigurasi perangkat jaringan Cisco, konfigurasi minimum yang diperlukan adalah sebagai berikut (untuk konfigurasi kita menggunakan CLI, saya menyederhanakan nama dan kata sandi untuk menghindari kebingungan):</font></font><br>
<br>
<pre><code class="plaintext hljs">snmp-server group snmpv3group v3 priv read snmpv3name <font></font>
snmp-server user snmpv3user snmpv3group v3 auth md5 md5v3v3v3 priv des des56v3v3v3<font></font>
snmp-server view snmpv3name iso included</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris pertama grup snmp-server - menentukan grup pengguna SNMPv3 (snmpv3group), mode baca (baca), dan hak akses grup snmpv3group untuk melihat cabang tertentu dari pohon MIB objek pemantauan (snmpv3name dalam konfigurasi di bawah ini menentukan cabang mana dari pohon MIB grup tersebut. snmpv3group akan dapat mengakses).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris kedua adalah pengguna snmp-server - mendefinisikan pengguna snmpv3user, keanggotaannya di grup snmpv3group, serta penggunaan otentikasi md5 (kata sandi untuk md5 adalah md5v3v3v3) dan des enkripsi (kata sandi untuk des adalah des56v3v3v3). Tentu saja, daripada des lebih baik menggunakan aes, di sini saya memberikannya hanya sebagai contoh. Juga, ketika mendefinisikan pengguna, Anda dapat menambahkan daftar akses (ACL) yang mengatur alamat IP dari server pemantauan yang memiliki hak untuk memantau perangkat ini - ini juga praktik terbaik, tetapi saya tidak akan menyulitkan contoh kita.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris ketiga tampilan server snmp mendefinisikan nama kode yang mendefinisikan cabang-cabang pohon MIB snmpv3name sehingga grup pengguna snmpv3group dapat memintanya. </font><font style="vertical-align: inherit;">ISO, alih-alih secara tegas mendefinisikan cabang tunggal, memungkinkan grup pengguna snmpv3group untuk mengakses semua objek dari pohon MIB objek pemantauan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konfigurasi serupa dari peralatan Huawei (juga di CLI) adalah sebagai berikut:</font></font><br>
<br>
<pre><code class="plaintext hljs">snmp-agent mib-view included snmpv3name iso<font></font>
snmp-agent group v3 snmpv3group privacy read-view snmpv3name<font></font>
snmp-agent usm-user v3 snmpv3user group snmpv3group<font></font>
snmp-agent usm-user v3 snmpv3user authentication-mode md5 <font></font>
            md5v3v3v3<font></font>
snmp-agent usm-user v3 snmpv3user privacy-mode des56<font></font>
            des56v3v3v3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah mengatur perangkat jaringan, Anda perlu memeriksa akses dari server pemantauan melalui protokol SNMPv3, saya akan menggunakan snmpwalk:</font></font><br>
<br>
<pre><code class="plaintext hljs">snmpwalk -v 3 -u snmpv3user -l authPriv -A md5v3v3v3 -a md5 -x des -X des56v3v3v3 10.10.10.252</code></pre><br>
<img src="https://habrastorage.org/webt/dj/zh/jt/djzhjtntle82d3erggwh-beglsq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alat yang lebih visual untuk meminta objek OID spesifik menggunakan file MIB adalah snmpget: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iz/6n/2v/iz6n2vstdjeaxgsw2fhjqlcra3u.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lanjutkan untuk menyiapkan elemen data khas untuk SNMPv3, sebagai bagian dari templat Zabbix. Untuk kesederhanaan dan kemandirian dari MIB, saya menggunakan OID digital: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/ig/-h/awig-hyentp_3pgvn3urihj7fye.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menggunakan makro khusus di bidang utama, karena mereka akan sama untuk semua elemen data dalam templat. Anda dapat mengaturnya sebagai bagian dari template jika semua perangkat jaringan di jaringan Anda memiliki parameter SNMPv3 yang sama, atau di dalam host jika parameter SNMPv3 untuk objek pemantauan berbeda: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/f7/ci/bp/f7cibpnkgslkyj7kq8spsekdi2k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa sistem pemantauan hanya memiliki nama pengguna dan kata sandi untuk otentikasi dan enkripsi . Grup pengguna dan area objek MIB yang memungkinkan aksesnya diatur pada objek pemantauan.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lanjutkan untuk mengisi template.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Templat survei Zabbix</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aturan sederhana saat membuat templat survei adalah membuatnya sedetail mungkin: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/fh/nc/am/fhncamsfgnhkd-h4dy8px17isq4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menaruh perhatian besar pada inventaris sehingga lebih nyaman untuk bekerja dengan jaringan besar. </font><font style="vertical-align: inherit;">Tentang ini sedikit kemudian, tetapi untuk sekarang - pemicu:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/g1/4g/mt/g14gmt7flcx9jhv8q8vgjnee4qe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memudahkan visualisasi dari pemicu, namanya mengandung macro sistem {HOST.CONN}, sehingga tidak hanya nama perangkat, tetapi juga alamat IP yang ditampilkan di dasbor di bagian peringatan, meskipun ini lebih merupakan masalah kenyamanan daripada yang diperlukan. Untuk menentukan tidak tersedianya perangkat, selain permintaan gema biasa, saya menggunakan pemeriksaan tidak tersedianya host SNMP ketika objek dapat diakses melalui ICMP tetapi tidak menanggapi permintaan SNMP - situasi ini mungkin, misalnya, ketika menggandakan alamat IP pada perangkat yang berbeda, karena firewall yang tidak dikonfigurasi dengan benar, atau pengaturan SNMP yang salah pada objek pemantauan. Jika Anda menggunakan kontrol akses host hanya melalui ICMP, pada saat menyelidiki insiden di jaringan, data pemantauan mungkin tidak muncul, jadi tanda terima mereka harus dikontrol.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita beralih ke menemukan antarmuka jaringan - untuk peralatan jaringan, ini adalah fungsi pemantauan yang paling penting. </font><font style="vertical-align: inherit;">Karena mungkin ada ratusan antarmuka pada perangkat jaringan, maka perlu untuk menyaring yang tidak perlu agar tidak mengacaukan visualisasi dan mengacaukan database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menggunakan fungsi deteksi standar untuk SNMP, dengan sejumlah besar parameter yang dapat dideteksi, untuk pemfilteran yang lebih fleksibel:</font></font><br>
<br>
<pre><code class="plaintext hljs">discovery[{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7]</code></pre><br>
<img src="https://habrastorage.org/webt/1m/vp/fu/1mvpfu0kalas5i-w-9uyb5-pk3s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan deteksi ini, Anda dapat memfilter antarmuka jaringan berdasarkan tipenya, deskripsi "deskripsi" pengguna, dan status administratif port. </font><font style="vertical-align: inherit;">Filter dan ekspresi reguler untuk memfilter dalam kasus saya terlihat sebagai berikut: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c1/z_/ym/c1z_ymi8yjcpt-cncmzdfdmynlq.png"><br>
 <br>
<img src="https://habrastorage.org/webt/et/wv/aj/etwvajeuy5h9jwx7bdwyocmhn1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah terdeteksi, antarmuka berikut akan dikecualikan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinonaktifkan secara manual (adminstatus &lt;&gt; 1), terima kasih kepada IFADMINSTATUS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak ada deskripsi teks, terima kasih kepada IFALIAS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki * dalam deskripsi teks, terima kasih kepada IFALIAS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjadi resmi atau berkat teknis untuk IFDESCR (dalam kasus saya, dalam ekspresi reguler IFALIAS dan IFDESCR diperiksa oleh satu alias ekspresi reguler).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Template pengumpulan data SNMPv3 hampir siap. </font><font style="vertical-align: inherit;">Kami tidak akan memikirkan prototipe elemen data untuk antarmuka jaringan, kami akan beralih ke hasil.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil pemantauan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mulai dengan - inventaris jaringan kecil: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bm/s0/h1/bms0h1txizz1lm_p9bdw3iwyvaa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda menyiapkan template untuk setiap seri perangkat jaringan - Anda dapat mencapai tata letak yang nyaman untuk menganalisis data ringkasan pada perangkat lunak saat ini, nomor seri, dan pemberitahuan kedatangan seorang wanita pembersih di server (karena Uptime kecil). </font><font style="vertical-align: inherit;">Kutipan dari daftar templat saya di bawah ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i8/ok/ju/i8okju-_mwfomxxj1quhf1eaifk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang - dasbor utama, dengan pemicu yang didistribusikan menurut tingkat keparahan:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/cr/-t/rscr-tzx6tnsbpjqqnxwyfhu-qg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berkat pendekatan terpadu pada templat untuk setiap model perangkat dalam jaringan, dimungkinkan untuk mencapai bahwa dalam kerangka satu sistem pemantauan, sebuah alat akan diatur untuk memprediksi kerusakan dan kecelakaan (jika ada sensor dan metrik yang sesuai). </font><font style="vertical-align: inherit;">Zabbix sangat cocok untuk memonitor jaringan, server, dan infrastruktur layanan, dan tugas untuk melayani peralatan jaringan dengan jelas menunjukkan kemampuannya.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar sumber yang digunakan:</font></font></b><div class="spoiler_text">1. Hucaby D. CCNP Routing and Switching SWITCH 300-115 Official Cert Guide. Cisco Press, 2014. pp. 325-329.<br>
2. RFC 3410. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tools.ietf.org/html/rfc3410</a><br>
3. RFC 3415. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tools.ietf.org/html/rfc3415</a><br>
4. SNMP Configuration Guide, Cisco IOS XE Release 3SE. Chapter: SNMP Version 3. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.cisco.com/c/en/us/td/docs/ios-xml/ios/snmp/configuration/xe-3se/3850/snmp-xe-3se-3850-book/nm-snmp-snmpv3.html</a><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495694/index.html">Layanan referensi aplikasi seluler</a></li>
<li><a href="../id495696/index.html">Bagaimana Prince of Persia Creator Mengatasi Batas Memori Apple II</a></li>
<li><a href="../id495698/index.html">Arsitektur client-server dalam gambar</a></li>
<li><a href="../id495700/index.html">Doom Boy ESP32</a></li>
<li><a href="../id495702/index.html">Kami mempelajari mesin VoIP Mediastreamer2. Bagian 1</a></li>
<li><a href="../id495706/index.html">Berita dari dunia OpenStreetMap No. 505 (03.17.2020-23.03.2020)</a></li>
<li><a href="../id495708/index.html">Buka server VPN darurat dengan otorisasi dua faktor pada Centos 8</a></li>
<li><a href="../id495712/index.html">Kami menetapkan tujuan pengembangan (dalam perusahaan berdarah dan tidak hanya)</a></li>
<li><a href="../id495716/index.html">Mitos tentang belajar bahasa asing</a></li>
<li><a href="../id495718/index.html">Master JetBrains & ITMO: kami terus belajar secara intensif dan mengumumkan hari terbuka</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>