<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐗 👩🏽‍🔬 🎊 Swift 5.2 - was ist neu? 👸🏽 🌰 👨🏼‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die erste Beta von Swift 5.2 wurde gerade in der Beta von Xcode 11.4 veröffentlicht. Die Sprache wurde geändert, der Code und der verwendete Speicher ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Swift 5.2 - was ist neu?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487552/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die erste Beta von Swift 5.2 wurde gerade in der Beta von Xcode 11.4 veröffentlicht. Die Sprache wurde geändert, der Code und der verwendete Speicher wurden reduziert, und es wurde ein neues Diagnosesystem eingeführt, das eine schnellere Fehlererkennung ermöglicht.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden von KeyPath-Ausdrücken als Funktionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir definieren folgende Struktur:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">User</span> </span>{
    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> age: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">let</span> bestFriend: <span class="hljs-type">String?</span><font></font>
<font></font>
    <span class="hljs-keyword">var</span> canVote: <span class="hljs-type">Bool</span> {<font></font>
        age &gt;= <span class="hljs-number">18</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns einige Instanzen unserer Struktur erstellen und sie in ein Array einfügen:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> eric = <span class="hljs-type">User</span>(name: <span class="hljs-string">"Eric Effiong"</span>, age: <span class="hljs-number">18</span>, bestFriend: <span class="hljs-string">"Otis Milburn"</span>)
<span class="hljs-keyword">let</span> maeve = <span class="hljs-type">User</span>(name: <span class="hljs-string">"Maeve Wiley"</span>, age: <span class="hljs-number">19</span>, bestFriend: <span class="hljs-literal">nil</span>)
<span class="hljs-keyword">let</span> otis = <span class="hljs-type">User</span>(name: <span class="hljs-string">"Otis Milburn"</span>, age: <span class="hljs-number">17</span>, bestFriend: <span class="hljs-string">"Eric Effiong"</span>)
<span class="hljs-keyword">let</span> users = [eric, maeve, otis]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun Achtung: Wenn Sie eine Reihe von Namen aller Benutzer benötigen, können Sie dies wie folgt tun:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> userNames = users.<span class="hljs-built_in">map</span>(\.name)
<span class="hljs-built_in">print</span>(userNames)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuvor mussten wir einen Verschluss verwenden:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> oldUserNames = users.<span class="hljs-built_in">map</span> { $<span class="hljs-number">0</span>.name }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf die gleiche neue Weise können Sie alle Benutzer erhalten, die abstimmen können:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> voters = users.<span class="hljs-built_in">filter</span>(\.canVote)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und hier bekommen wir alle, die einen besten Freund haben:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> bestFriends = users.<span class="hljs-built_in">compactMap</span>(\.bestFriend)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Werte für benutzerdefinierte Typen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie </font><font style="vertical-align: inherit;">eine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Würfelstruktur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> </font><font style="vertical-align: inherit;">mit lowerbound und upperbound Eigenschaften, und fügen Sie </font><font style="vertical-align: inherit;">dann die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">callAsFunction</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jedes Mal, wenn wir den Würfelwert erhalten, erhalten wir einen zufälligen Wert:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Dice</span> </span>{
    <span class="hljs-keyword">var</span> lowerBound: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">var</span> upperBound: <span class="hljs-type">Int</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">callAsFunction</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">Int</span> {<font></font>
        (lowerBound...upperBound).randomElement()!<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">let</span> d6 = <span class="hljs-type">Dice</span>(lowerBound: <span class="hljs-number">1</span>, upperBound: <span class="hljs-number">6</span>)
<span class="hljs-keyword">let</span> roll1 = d6()
<span class="hljs-built_in">print</span>(roll1)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier erhalten wir eine Zufallszahl von 1 bis 6, und dies ist völlig identisch mit einem direkten Aufruf von callAsFunction (). </font><font style="vertical-align: inherit;">Wir könnten das Gleiche tun:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">let</span> d12 = <span class="hljs-type">Dice</span>(lowerBound: <span class="hljs-number">1</span>, upperBound: <span class="hljs-number">12</span>)
<span class="hljs-keyword">let</span> roll2 = d12.callAsFunction()
<span class="hljs-built_in">print</span>(roll2)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swift wählt automatisch den richtigen Aufruf basierend auf der Definition von callAsFunction () aus. </font><font style="vertical-align: inherit;">Sie können beispielsweise mehrere Parameter hinzufügen, den Rückgabewert ändern und die Methode bei Bedarf sogar als mutierend markieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier erstellen wir eine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StepCounter-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Struktur </font><font style="vertical-align: inherit;">, die die Anzahl der durchgeführten Schritte erfasst und signalisiert, ob die Anzahl der abgeschlossenen Schritte 10.000 erreicht hat:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StepCounter</span> </span>{
    <span class="hljs-keyword">var</span> steps = <span class="hljs-number">0</span><font></font>
<font></font>
    <span class="hljs-keyword">mutating</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">callAsFunction</span><span class="hljs-params">(<span class="hljs-built_in">count</span>: Int)</span></span> -&gt; <span class="hljs-type">Bool</span> {<font></font>
        steps += <span class="hljs-built_in">count</span>
        <span class="hljs-built_in">print</span>(steps)
        <span class="hljs-keyword">return</span> steps &gt; <span class="hljs-number">10_000</span><font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">var</span> steps = <span class="hljs-type">StepCounter</span>()
<span class="hljs-keyword">let</span> targetReached = steps(<span class="hljs-built_in">count</span>: <span class="hljs-number">10</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
callAsFunction () unterstützt auch Throws und Rethrows, und Sie können mehrere CallAsFunction () -Methoden definieren, wie bei regulärer Überladung.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Index kann Standardargumente deklarieren</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie einem Typ Indizes hinzufügen, können Sie die Standardargumente verwenden. </font><font style="vertical-align: inherit;">Wenn wir beispielsweise eine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PoliceForce-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Struktur </font><font style="vertical-align: inherit;">mit einem benutzerdefinierten Index zum </font><b><font style="vertical-align: inherit;">Auflisten von</font></b><font style="vertical-align: inherit;"> Beamten in der Einheit haben, können wir einen Standardparameter hinzufügen, um ihn zurückzugeben, wenn das Array außerhalb seiner Grenzen gelesen wird:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">PoliceForce</span> </span>{
    <span class="hljs-keyword">var</span> officers: [<span class="hljs-type">String</span>]<font></font>
<font></font>
    <span class="hljs-keyword">subscript</span>(index: <span class="hljs-type">Int</span>, <span class="hljs-keyword">default</span> <span class="hljs-keyword">default</span>: <span class="hljs-type">String</span> = <span class="hljs-string">"Unknown"</span>) -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">if</span> index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; officers.<span class="hljs-built_in">count</span> {
            <span class="hljs-keyword">return</span> officers[index]<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> `<span class="hljs-keyword">default</span>`<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">let</span> force = <span class="hljs-type">PoliceForce</span>(officers: [<span class="hljs-string">"Amy"</span>, <span class="hljs-string">"Jake"</span>, <span class="hljs-string">"Rosa"</span>, <span class="hljs-string">"Terry"</span>])
<span class="hljs-built_in">print</span>(force[<span class="hljs-number">0</span>])
<span class="hljs-built_in">print</span>(force[<span class="hljs-number">5</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier erhalten wir "Amy" und dann "Unbekannt" in der Ausgabe, da wir kein Array-Element mit Index 5 haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir den Standardwert geschrieben haben, können wir einen benutzerdefinierten Wert festlegen, wie:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-built_in">print</span>(force[-<span class="hljs-number">1</span>, <span class="hljs-keyword">default</span>: <span class="hljs-string">"The Vulture"</span>])</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue und verbesserte Diagnose</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Swift 5.2 führt eine neue Diagnosearchitektur ein, deren Ziel es ist, die Qualität und Genauigkeit von Xcode-Entwicklungsfehlermeldungen zu verbessern. </font><font style="vertical-align: inherit;">Dies macht sich insbesondere bei der Arbeit mit SwiftUI-Code bemerkbar, bei dem Swift häufig falsch positive Fehlermeldungen generiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie beispielsweise den folgenden Code:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> name = <span class="hljs-number">0</span><font></font>
<font></font>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">"What is your name?"</span>)
            <span class="hljs-type">TextField</span>(<span class="hljs-string">"Name"</span>, text: $name)<font></font>
                .frame(maxWidth: <span class="hljs-number">300</span>)<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier versuchen wir, view TextField einer Ganzzahl zuzuordnen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zustand</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigenschaft, die falsch ist. </font><font style="vertical-align: inherit;">In diesem Fall </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generiert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Swift 5.1 </font><b><font style="vertical-align: inherit;">einen</font></b><font style="vertical-align: inherit;"> Fehler für den Frame () -Modifikator </font><b><font style="vertical-align: inherit;">'Int', der nicht in 'CGFloat?' Konvertiert werden kann. </font></b><font style="vertical-align: inherit;">Swift 5.2 und höher erkennen den Fehler bei der Bindung von $ name jedoch korrekt: Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert vom Typ 'Binding' kann nicht in den erwarteten Argumenttyp 'Binding' konvertiert werden.</font></font></b></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487540/index.html">HighLoad ++, Anastasia Tsymbalyuk, Stanislav Tselovalnikov (Sberbank): Wie wir zu MDA wurden</a></li>
<li><a href="../de487542/index.html">PRESENT - Ultraleichte Blockverschlüsselung (Übersetzung des Originals PRESENT: Eine ultraleichte Blockverschlüsselung)</a></li>
<li><a href="../de487544/index.html">.NET-Dokumentation: Was ist neu im Januar?</a></li>
<li><a href="../de487548/index.html">Neues Experiment: Aufrufen von .NET gRPC-Diensten über einen Browser mit gRPC-Web</a></li>
<li><a href="../de487550/index.html">3D-Bild in Python mit (fast) normaler Leistung</a></li>
<li><a href="../de487556/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 497 (21.01.2020 - 27.01.2020)</a></li>
<li><a href="../de487558/index.html">Paul Graham: Kinder und Startups</a></li>
<li><a href="../de487560/index.html">Bank of America: Die Kapitalisierung von Yandex wird um 1,4 Milliarden US-Dollar steigen</a></li>
<li><a href="../de487564/index.html">Paul Graham: "Die beste Idee in Ihrem Kopf"</a></li>
<li><a href="../de487566/index.html">Grundlegendes zum CSS-Raster (1 Teil): Rastercontainer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>