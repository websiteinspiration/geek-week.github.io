<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìº üßõüèΩ üòæ How to help find an organization and not spend a week on it ‚öìÔ∏è üíÜüèø üïã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When people enter the name of a car repair shop, clinic or store in Yandex search, they want to find information about them. For example, a work sched...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How to help find an organization and not spend a week on it</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/489878/"><img src="https://habrastorage.org/webt/up/dz/ui/updzuix_zzsrww4z3buhorphxye.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When people enter the name of a car repair shop, clinic or store in Yandex search, they want to find information about them. For example, a work schedule or a phone number. It depends on the accuracy and relevance of these data whether a person will solve his problem quickly or lose time and nerves. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My name is Alexander, and I represent the team of Geopoisk and Yandex.Directory, the data of which is used by more than 46 million people a month. Today I will briefly talk about how we managed to reduce the time it took to update data in Yandex search from a few days to several hours, sometimes to minutes. You will also find out who Ricardo Milos is and what problems he caused us.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Directory is a database of organizations. Any company or person can add information there: indicate the address, hours of operation, phone and everything else - and Yandex will convey this to users. The Directory data is used in Search, Alice, Maps, Taxi, Navigator, and even in our caller ID, which we already </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">talked about</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on Habr√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And everything would be fine, but the data is becoming outdated: organizations are closing, moving, changing numbers and all that. We ourselves can track changes and make edits, but today we‚Äôll talk about those edits that users or companies send us. To do this, we have forms and other feedback mechanisms. So we get several thousand edits per day. But we cannot just take and publish them.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Errors are found in corrections - due to carelessness or malicious intent. The latter are especially numerous. Some distort the data of competitors and "close" the organization. Other, ordinary vandals add mat and other absurdities to company names and descriptions. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yx/sf/au/yxsfaun0wanzcev2d4ijub2hvx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, if you publish edits as is, users will suffer. Therefore, we check everything. Call center operators call the organization and clarify the changes. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reach companies and verify data live. But such methods are not fast enough, and the stream of edits is large. Therefore, we also came up with a robot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We use the automatic classifier of edits - Auto moderator. This is the machine based on our </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">CatBoost</font></a><font style="vertical-align: inherit;"> technology </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. She is trained on examples of good and bad edits. Fortunately, we have plenty of such data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When an edit arrives, the Auto Moderator takes into account dozens of factors (for example, the history of previous user edits) and decides whether to approve the edit, reject it, or send it to a person for re-examination. The car moderator can check the Directory base and make sure that they are not trying to create a duplicate, or look at the organization‚Äôs website in search of new information, or even call the organization, introduce himself as Snezhana and clarify the changes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One example. In 2018, a wave of ‚Äúrenaming‚Äù schools, monuments and other organizations began in mapping services and reference books: on the maps they were named after Ricardo Milos (there is </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">an article</font></a><font style="vertical-align: inherit;"> on TJ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about this flash mob). So against our will, we met with a popular at that time meme about a Brazilian stripper (not that we wanted it, but who asked us). And it was the combination of the Auto Moderator and other verification mechanisms that helped us defend the true names. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the automatic classifier has reduced the time it takes to update the data. But we did not stop there. Even taking into account the help of the Auto Moderator, edits could reach service users for several days. This is a long time. To reduce this time, it was necessary to solve two technological problems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Previously, the Auto Moderator looked like a batch process, it started on a schedule and required large resources for local computing (working with tables for tens of millions of records). We have changed that.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now this is a service in which editing and information about its sender are received in real time. Then the car moderator calculates the factors and renders a verdict. Before verdicts on applications, we could wait hours. Now, minutes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But this does not mean that the changes will reach the user in minutes. And here the second task awaited us.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The change falls into the Directory base, but it takes time to ‚Äúsprout‚Äù into the service. For example, Search must update the search index to reflect changes from the Directory. To get around this, we developed an outline for storing the states of objects. Simply put, now you can replace the phone number in the object answer of the Search without rebuilding the search index. Now, when building search results, Search knows which objects are outdated, and can pull up more recent information. Of course, there are still situations where a change in data affects the ranking of the organization, but there is no way without rebuilding the index. </font></font><br>
<br>
<img width="800" src="https://habrastorage.org/webt/kw/cr/ry/kwcrry6suyvdo_xgdhyhbrzlb_y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, after improvements and implementations, we were able to reduce the average time for updating data about organizations in Yandex services from a few days to hours, and sometimes to minutes. I want to believe that you noticed this.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Today I put a rather long history of work in a short review post. </font><font style="vertical-align: inherit;">Tell us about which sides or decisions you would like to read in more detail in the future. </font><font style="vertical-align: inherit;">We will be glad to receive feedback and appeals, we will continue to work on the Directory and tell Habr readers about its news.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en489868/index.html">Freezing Mozilla WebThings</a></li>
<li><a href="../en489870/index.html">Free offline intensive by Node.js in Nizhny Novgorod</a></li>
<li><a href="../en489872/index.html">How the DLP system and the OCR module prevented employees from falsifying passport scans</a></li>
<li><a href="../en489874/index.html">Cross compiling Rust for Windows executables from Linux</a></li>
<li><a href="../en489876/index.html">How we solved the problem of three monoliths</a></li>
<li><a href="../en489880/index.html">Code review - improving the process</a></li>
<li><a href="../en489882/index.html">Reducing the response time when transmitting data over UDP</a></li>
<li><a href="../en489884/index.html">Cross-platform OpenCV optimizations</a></li>
<li><a href="../en489886/index.html">We analyze the resume of lawyers on hh.ru without api</a></li>
<li><a href="../en489888/index.html">Generate URLs with parameters on the knee and best practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>