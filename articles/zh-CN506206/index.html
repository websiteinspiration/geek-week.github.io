<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ»â€ğŸŒ¾ ğŸ¢ ğŸŒ ICQæ–°ï¼šæœºå™¨äººç¹æ®–æŒ‡å— â›²ï¸ ğŸ‘¨ğŸ¾â€ğŸ“ ğŸ§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ¯æ¬¡è¿›å…¥Messengerï¼Œæˆ‘ä»¬éƒ½ä¼šé‡åˆ°æœºå™¨äººï¼Œå®ƒä»¬çš„è¡¨ç°å½¢å¼å„ä¸ç›¸åŒã€‚æœ‰äº›äººè°ˆè®ºå¤©æ°”ï¼Œæœ‰äº›äººç©æ±‰å ¡ï¼Œè€Œå¦ä¸€äº›äººåˆ™è¡¨ç¤ºæ¨¡å› ã€‚å½“ç„¶ï¼Œä½ ä»¬ä¸­çš„è®¸å¤šäººçªç„¶å†’å‡ºä¸€ä¸ªå¿µå¤´ï¼šâ€œä½†æ˜¯æˆ‘å¯ä»¥åˆ¶é€ è‡ªå·±çš„æœºå™¨äººå—ï¼Ÿâ€ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ ·çš„æƒ³æ³•å¸¸å¸¸è¢«è¯¯è§£æˆå¯¹å¦‚ä½•åˆ¶é€ æœºå™¨äººçš„è¯¯è§£ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯èƒ½éœ€è¦æˆä¸ºä¸€åå‡ºè‰²çš„ITä¸“å®¶å¹¶äº†è§£æ•°ç™¾...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ICQæ–°ï¼šæœºå™¨äººç¹æ®–æŒ‡å—</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/506206/"><img src="https://habrastorage.org/webt/hz/yl/ac/hzylac6lisykfejesv6dmsxquok.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯æ¬¡è¿›å…¥Messengerï¼Œæˆ‘ä»¬éƒ½ä¼šé‡åˆ°æœºå™¨äººï¼Œå®ƒä»¬çš„è¡¨ç°å½¢å¼å„ä¸ç›¸åŒã€‚æœ‰äº›äººè°ˆè®ºå¤©æ°”ï¼Œæœ‰äº›äººç©æ±‰å ¡ï¼Œè€Œå¦ä¸€äº›äººåˆ™è¡¨ç¤ºæ¨¡å› ã€‚å½“ç„¶ï¼Œä½ ä»¬ä¸­çš„è®¸å¤šäººçªç„¶å†’å‡ºä¸€ä¸ªå¿µå¤´ï¼šâ€œä½†æ˜¯æˆ‘å¯ä»¥åˆ¶é€ è‡ªå·±çš„æœºå™¨äººå—ï¼Ÿâ€ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ ·çš„æƒ³æ³•å¸¸å¸¸è¢«è¯¯è§£æˆå¯¹å¦‚ä½•åˆ¶é€ æœºå™¨äººçš„è¯¯è§£ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯èƒ½éœ€è¦æˆä¸ºä¸€åå‡ºè‰²çš„ITä¸“å®¶å¹¶äº†è§£æ•°ç™¾ä¸‡ç§æŠ€æœ¯ï¼Ÿå¹¶ä¸æ˜¯çš„ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†å°è¯•è¯æ˜åˆ›å»ºæœºå™¨äººç¨‹åºæ˜¯ä¸€ä¸ªç®€å•ä¸”å¯ç†è§£çš„è¿‡ç¨‹ã€‚è®©æˆ‘ä»¬åˆ†æåˆ›å»ºæœºå™¨äººçš„æ•´ä¸ªå‘¨æœŸï¼Œä»ä»Messengerè·å–å¿…è¦çš„æ•°æ®åˆ°ç¼–å†™ä»£ç å¹¶å°†å…¶åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ä¸€æ®µæ—¶é—´ï¼Œè¯¥æœºå™¨äººå¹³å°åœ¨ICQä¸­è¿›è¡Œäº†é‡å¤§æ›´æ–°ã€‚</font><font style="vertical-align: inherit;">å¥¹å˜å¾—æ›´åŠ å‹å¥½ï¼Œå¯ç†è§£å’Œèˆ’é€‚ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨å¼€å‘äººå‘˜çš„Pythonåº“ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªbotã€‚</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€ä»¶äº‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨ICQä¸­æ³¨å†Œã€‚</font><font style="vertical-align: inherit;">å¯ä»¥é€šè¿‡ç”¨äºæ‰‹æœºï¼Œè®¡ç®—æœºçš„åº”ç”¨ç¨‹åºæ¥å®Œæˆæ­¤æ“ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä»Webç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­å®Œæˆã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³¨å†Œåï¼Œæ‚¨å¯ä»¥å¼€å§‹åœ¨ç³»ç»Ÿä¸­å»ºç«‹è‡ªå·±çš„æœºå™¨äººï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯»æ‰¾ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…ƒæœºå™¨äºº</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨ICQä¸Šã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»™ä»–å†™ä¸€ä¸ªå›¢é˜Ÿ</font></font><code>/newbot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæ‚¨çš„æ–°æœºå™¨äººå‘½åï¼ˆåº”è¯¥ä»¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bot</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“å°¾</font><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹åï¼Œè¯¥å…ƒæœºå™¨äººå°†å‘é€æ‚¨çš„æœºå™¨äººæ•°æ®ï¼š</font></font><br>
<br>
<ul>
<li><code>botId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šå”¯ä¸€çš„æ¼«æ¸¸å™¨å·ï¼›</font></font></li>
<li><code>nick</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¦æœç´¢çš„æœºå™¨äººåç§°ï¼›</font></font></li>
<li><code>token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šç”¨äºå‘æœåŠ¡å™¨å‘é€ç½‘ç»œè¯·æ±‚çš„ä»¤ç‰Œã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±æ˜¯è¿™æ ·ï¼Œæœºå™¨äººå·²åˆ›å»ºã€‚åœ¨æœç´¢ä¸­å¯ä»¥æ‰¾åˆ°ä»–ï¼Œç»™ä»–å†™ä¸€æ¡æ¶ˆæ¯ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿æœºå™¨äººæ´»åŠ¨å¹¶åšå‡ºå“åº”ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://icq.com/botapi/#/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡µé¢ä¸Šï¼Œ</font><font style="vertical-align: inherit;">æœ‰APIæ–¹æ³•çš„å®Œæ•´è¯´æ˜ã€‚å®ƒä»¬ç”¨äºä¸æœåŠ¡å™¨äº¤äº’ã€‚è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°ç ”ç©¶å…¶ä¸­çš„ä¸€äº›ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŸºæœ¬æ–¹æ³•æ˜¯</font></font><code>/events/get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å®ƒç”¨äºæ¥æ”¶æ–°çš„æœºå™¨äººäº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰äººç¼–å†™äº†ä¸€ä¸ªæ¼«æ¸¸å™¨ï¼Œåˆ™åœ¨æç¤ºæ—¶å°†ç»™å‡ºæ­¤äº‹ä»¶</font></font><code>/events/get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è®©æˆ‘ä»¬å‘æœºå™¨äººå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶æ£€æŸ¥ç›¸åº”äº‹ä»¶çš„å¤–è§‚ã€‚ä¾‹å¦‚ï¼Œè¿™å¯ä»¥åœ¨æµè§ˆå™¨ä¸­å®Œæˆã€‚ä¸ºæ­¤ï¼Œè¯·è®¿é—®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://api.icq.net/bot/v1/events/get?token=æ‚¨çš„ä»¤ç‰Œï¼†pollTime = 1ï¼†lastEventId = 0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å‚æ•°</font></font><code>pollTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è´Ÿè´£æœåŠ¡å™¨ä¿ç•™è¯·æ±‚çš„æ—¶é—´é•¿åº¦ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥å€¼60ï¼Œåˆ™æœåŠ¡å™¨å°†ç­‰å¾…botäº‹ä»¶60ç§’ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´æ²¡æœ‰äº‹ä»¶ï¼Œåˆ™æœåŠ¡å™¨å°†è¿”å›ç©ºäº‹ä»¶æ•°ç»„ã€‚</font></font><code>lastEventId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è´Ÿè´£æœ€åå¤„ç†çš„äº‹ä»¶ã€‚</font><font style="vertical-align: inherit;">æ¢å¥è¯è¯´ï¼Œå€¼å°äºä¼ è¾“å€¼çš„äº‹ä»¶å°†è¢«è£å‰ªã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è½¬åˆ°è¯¥åœ°å€åï¼Œå±å¹•ä¸Šå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š</font></font><br>
<br>
<pre><code class="json hljs">{
 <span class="hljs-attr">"events"</span>: [<font></font>
  {<font></font>
    <span class="hljs-attr">"eventId"</span>: <span class="hljs-number">41</span>,
     <span class="hljs-attr">"payload"</span>: {
         <span class="hljs-attr">"chat"</span>: {
           <span class="hljs-attr">"chatId"</span>: <span class="hljs-string">"745294945"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"private"</span><font></font>
         },<font></font>
         <span class="hljs-attr">"from"</span>: {
                <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Andrey"</span>,
                <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Shvedov"</span>,
                <span class="hljs-attr">"nick"</span>: <span class="hljs-string">"shvedoff"</span>,
                <span class="hljs-attr">"userId"</span>: <span class="hljs-string">"745294945"</span><font></font>
         },<font></font>
         <span class="hljs-attr">"msgId"</span>: <span class="hljs-string">"6831171945581511151"</span>,
         <span class="hljs-attr">"text"</span>: <span class="hljs-string">""</span>,
         <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1590506161</span><font></font>
     },<font></font>
     <span class="hljs-attr">"type"</span>: <span class="hljs-string">"newMessage"</span><font></font>
  }<font></font>
 ],<font></font>
 <span class="hljs-attr">"ok"</span>: <span class="hljs-literal">true</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒæ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–¹æ³•ä»£è¡¨æœºå™¨äººå‘é€æ¶ˆæ¯</font></font><code>/messages/sendText</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ä¸éœ€è¦æ›´è¯¦ç»†åœ°ç ”ç©¶è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç°æˆçš„Pythonåº“ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ— éœ€è¯¦ç»†è¯´æ˜å°±å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„æœºå™¨äººã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†™ä»£ç ï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¯çš„ï¼Œä½†æ˜¯é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸ºæ­¤å‡†å¤‡ä¸€å°è‡ªå·±çš„è®¡ç®—æœºã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†åœ¨ç¬¬ä¸‰ç‰ˆä¸­ä½¿ç”¨Pythonï¼ˆåœ¨æ­¤å¤„ä¸‹è½½é€‚ç”¨äºæ‚¨æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">//www.python.org/downloads/</font></a><font style="vertical-align: inherit;">ï¼Œåœ¨æ­¤å¤„ä½¿ç”¨pipåŒ…ç®¡ç†å™¨ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">//pip.pypa.io/en/stable/installing/</font></a><font style="vertical-align: inherit;">ï¼‰ï¼Œæ‚¨éœ€è¦å®‰è£…åº“æ‰èƒ½ä¸æœºå™¨äººä¸€èµ·ä½¿ç”¨ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ pip3 install --upgrade mailru-im-bot
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æ‚¨å¯ä»¥ç»§ç»­ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨å†™ï¼</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªæ¸¸æˆæœºå™¨äººï¼Œä»¥æµ‹è¯•ç®€å•çš„æ•°å­¦çŸ¥è¯†ã€‚ä»–å°†åƒè¿™æ ·å·¥ä½œï¼šä¸€ä¸ªäººå‘æœºå™¨äººå†™ä¸€æ¡æ¶ˆæ¯ï¼Œè‡ªæˆ‘ä»‹ç»å¹¶å»ºè®®ç©æ¸¸æˆã€‚åœ¨ç”¨æˆ·åŒæ„åï¼Œæœºå™¨äººä¼šç”Ÿæˆä¸€ä¸ªç®€å•çš„æ•°å­¦ç¤ºä¾‹å’Œ4ä¸ªé€‰é¡¹ä¾›æ‚¨é€‰æ‹©ã€‚å½“ç”¨æˆ·å•å‡»å¸¦æœ‰æ‰€é€‰ç­”æ¡ˆçš„æŒ‰é’®æ—¶ï¼Œæ¼«æ¸¸å™¨ä¼šå›ç­”æ˜¯å¯¹è¿˜æ˜¯é”™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæœºå™¨äººå¿…é¡»é¦–å…ˆä»æœåŠ¡å™¨æ¥æ”¶äº‹ä»¶ã€‚ä¸ºæ­¤ï¼Œé™¤äº†å¯¼å…¥æ‰€æœ‰åº“ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªç±»å¯¹è±¡</font></font><code>Bot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å¼€å§‹æ¥æ”¶æ›´æ–°ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">from</span> bot.bot <span class="hljs-keyword">import</span> Bot<font></font>
<font></font>
<font></font>
logging.basicConfig(format=<span class="hljs-string">'%(asctime)s %(levelname)s %(message)s'</span>,<font></font>
                    datefmt=<span class="hljs-string">'%Y.%m.%d %I:%M:%S %p'</span>, level=logging.DEBUG)<font></font>
<font></font>
TOKEN = <span class="hljs-string">""</span> <span class="hljs-comment">#your token here</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><font></font>
    bot = Bot(token=TOKEN)<font></font>
    bot.start_polling()<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    main()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¼å…¥æ—¥å¿—è®°å½•åº“å¹¶è¿è¡Œå®ƒã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬è¿˜å¯¼å…¥äº†ICQæœºå™¨äººåº“ï¼Œè®¾ç½®äº†å¿…è¦çš„å‚æ•°</font></font><code>token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç±»å¯¹è±¡ï¼Œ</font></font><code>Bot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å¼€å§‹ä»æœåŠ¡å™¨æ¥æ”¶æ›´æ–°ï¼ˆ</font></font><code>bot.start_polling()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬çš„æœºå™¨äººå¯ä»¥æ¥æ”¶äº‹ä»¶ï¼Œä½†æ˜¯æ— æ³•å¤„ç†å®ƒä»¬ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¯¹æœºå™¨äººè¿›è¡Œäº†è¡¥å……ï¼Œä»¥ä¾¿å®ƒå¯ä»¥å“åº”æ¶ˆæ¯ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæ·»åŠ å¿…è¦çš„å¯¼å…¥ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> bot.handler <span class="hljs-keyword">import</span> MessageHandler
</code></pre><br>
<code>json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éœ€è¦æ ¼å¼åŒ–è´Ÿè´£æŒ‰é’®çš„æ¶ˆæ¯éƒ¨åˆ†ã€‚</font></font><code>MessageHandler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éœ€è¦å‘å¤„ç†ç¨‹åºä»£ç ä¸­æ·»åŠ æ–°æ¶ˆæ¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥ä¸ºå“åº”ç¼–å†™ä¸€æ¡æ¶ˆæ¯ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">bot, event</span>):</span><font></font>
    default_markup = [<font></font>
        [{<span class="hljs-string">"text"</span>: <span class="hljs-string">"!"</span>, <span class="hljs-string">"callbackData"</span>: <span class="hljs-string">"start"</span>}]<font></font>
        ]<font></font>
<font></font>
    first_message_text = <span class="hljs-string">"!  -  . ?"</span><font></font>
    bot.send_text(chat_id=event.from_chat,<font></font>
         text=first_message_text,<font></font>
         inline_keyboard_markup=json.dumps(default_markup))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒæ¥æ”¶åˆ›å»ºçš„æœºå™¨äººçš„è¾“å…¥å’Œæ–°æ¶ˆæ¯çš„äº‹ä»¶ã€‚</font></font><code>default_markup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æŒ‰é’®çŸ©é˜µï¼ˆâ€œåˆ—è¡¨â€å¯¹è±¡ï¼Œç”±æŒ‰é’®å­—ç¬¦ä¸²æ•°ç»„ç»„æˆã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯å”¯ä¸€çš„â€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼€å§‹â€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‰é’®</font><i><font style="vertical-align: inherit;">ï¼</font></i><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><code>first_message_text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶æ–‡æœ¬å°†å‘é€ç»™ç”¨æˆ·ã€‚</font><font style="vertical-align: inherit;">è¯¥æ–¹æ³•</font></font><code>send_text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥å—ï¼š</font></font><br>
<br>
<ul>
<li><code>chat_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ï¼ˆæ­£åœ¨å¤„ç†çš„äº‹ä»¶çš„å­—æ®µï¼‰-æ¥æ”¶æ¶ˆæ¯çš„èŠå¤©çš„æ ‡è¯†ç¬¦ï¼Œ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦å‘é€çš„æ¶ˆæ¯æ–‡å­— </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>inline_keyboard_markup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æˆ‘ä»¬çš„æŒ‰é’®ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨å‰©ä¸‹çš„æ˜¯æè¿°æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶å¯¹æ­¤å‡½æ•°çš„è°ƒç”¨ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œè¯¥åº“å…·æœ‰ç‰¹æ®Šçš„è®¾è®¡ï¼š</font></font><br>
<br>
<pre><code class="python hljs">bot.dispatcher.add_handler(MessageHandler(callback=startup))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒä½¿æ‚¨å¯ä»¥åœ¨æ”¶åˆ°æ–°æ¶ˆæ¯æ—¶è‡ªåŠ¨</font></font><code>startup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨å¿…è¦çš„å‚æ•°</font><font style="vertical-align: inherit;">è°ƒç”¨å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¯¥å¤„ç†ç¨‹åºå¿…é¡»æ”¾åœ¨å‡½æ•°ä¸­</font></font><code>main()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·çš„ä»£ç ï¼Œå½“æ‚¨çš„æ¼«æ¸¸å™¨æ”¶åˆ°ä»»ä½•æ¶ˆæ¯æ—¶ï¼Œå®ƒå¯ä»¥è®©æ‚¨å‘é€å¯åŠ¨æ¶ˆæ¯ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> bot.bot <span class="hljs-keyword">import</span> Bot
<span class="hljs-keyword">from</span> bot.handler <span class="hljs-keyword">import</span> MessageHandler<font></font>
<font></font>
logging.basicConfig(format=<span class="hljs-string">'%(asctime)s %(levelname)s %(message)s'</span>,<font></font>
                    datefmt=<span class="hljs-string">'%Y.%m.%d %I:%M:%S %p'</span>, level=logging.DEBUG)<font></font>
<font></font>
TOKEN = Â«Â» <span class="hljs-comment">#your token here</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">bot, event</span>):</span><font></font>
    default_markup = [<font></font>
        [{Â«textÂ»: Â«!Â», Â«callbackDataÂ»: Â«startÂ»}]<font></font>
        ]<font></font>
    first_message_text = Â«!  â€”  . ?Â»<font></font>
    bot.send_text(chat_id=event.from_chat,<font></font>
        text=first_message_text,<font></font>
        inline_keyboard_markup=json.dumps(default_markup))<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><font></font>
    bot = Bot(token=TOKEN)<font></font>
    bot.dispatcher.add_handler(MessageHandler(callback=startup))<font></font>
    bot.start_polling()<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    main()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºç”¨æˆ·ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a4/a51/4b4/6a4a514b4e5629c69a6cb9a1f187de4b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´è¯¦ç»†åœ°è€ƒè™‘æˆ‘ä»¬åœ¨æ¶ˆæ¯ä¸­å‘é€çš„æŒ‰é’®ï¼š</font></font><br>
<br>
<pre><code class="python hljs">[ [{Â«textÂ»: Â«!Â», Â«callbackDataÂ»: Â«startÂ»}]]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é™¤äº†å†™åœ¨æŒ‰é’®ä¸Šçš„æ–‡å­—å¤–ï¼Œæ¶ˆæ¯è¿˜æœ‰ä¸€ä¸ªå­—æ®µ</font></font><code>callbackData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å•å‡»æŒ‰é’®åï¼ŒæœåŠ¡å™¨å°†ç”ŸæˆæŒ‰é’®å•å‡»äº‹ä»¶ã€‚</font><font style="vertical-align: inherit;">åœ¨å…¶ä¸­ï¼Œä»–å°†è¯¥å­—æ®µä½œä¸ºæŒ‰ä¸‹æŒ‰é’®çš„æ ‡è¯†ç¬¦ä¼ é€’ã€‚</font><font style="vertical-align: inherit;">ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ä»æœåŠ¡å™¨æ”¶åˆ°çš„è¿™ä¸€è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­ç”¨æˆ·å•å‡»äº†å“ªä¸ªæŒ‰é’®ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†æŒ‰é’®å•å‡»å¤„ç†é€»è¾‘æ·»åŠ åˆ°æœºå™¨äººã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å†æ¬¡éœ€è¦å¯¼å…¥å¿…è¦çš„æ–¹æ³•ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> bot.handler <span class="hljs-keyword">import</span> BotButtonCommandHandler
<span class="hljs-keyword">from</span> bot.filter <span class="hljs-keyword">import</span> Filter
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€è¡Œæ˜¯æŒ‰é’®å•å‡»äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç¬¬äºŒè¡Œæ˜¯æœ‰åŠ©äºç†è§£æŒ‰ä¸‹å“ªä¸ªæŒ‰é’®çš„è¿‡æ»¤å™¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬è¿˜éœ€è¦æè¿°æŒ‰é’®å•å‡»å“åº”çš„é€»è¾‘ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start</span>(<span class="hljs-params">bot, event</span>):</span>
    question = <span class="hljs-string">''</span>
    operands = [<span class="hljs-string">"+"</span>, <span class="hljs-string">"-"</span>, <span class="hljs-string">"*"</span>]<font></font>
    operations_count = randrange(<span class="hljs-number">3</span>)+<span class="hljs-number">2</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(operations_count):<font></font>
        question += str(randrange(<span class="hljs-number">9</span>))<font></font>
        question += choice(operands)<font></font>
    question = question[:<span class="hljs-number">-1</span>]<font></font>
    answer = eval(question)<font></font>
    buttons = [<font></font>
        [{<span class="hljs-string">'text'</span>: str(answer), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"right"</span>},<font></font>
         {<span class="hljs-string">'text'</span>: str(answer+<span class="hljs-number">1</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>}],<font></font>
        [{<span class="hljs-string">'text'</span>: str(answer<span class="hljs-number">-1</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>},<font></font>
         {<span class="hljs-string">'text'</span>: str(answer+<span class="hljs-number">2</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>}]]<font></font>
    shuffle(buttons[<span class="hljs-number">0</span>])<font></font>
    shuffle(buttons[<span class="hljs-number">1</span>])<font></font>
    shuffle(buttons)<font></font>
    bot.answer_callback_query(<font></font>
        query_id=event.data[<span class="hljs-string">'queryId'</span>],<font></font>
        text=<span class="hljs-string">' '</span>)<font></font>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=question,<font></font>
        inline_keyboard_markup=json.dumps(buttons))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸æ¶ˆæ¯ç±»ä¼¼ï¼Œå‡½æ•°æ¥å—ä¸è¾“å…¥ç›¸åŒçš„å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ç„¶åç”Ÿæˆç¤ºä¾‹å’Œå¸¦æœ‰ç­”æ¡ˆçš„æŒ‰é’®æ•°ç»„ã€‚</font><font style="vertical-align: inherit;">ç­”æ¡ˆä¹‹ä¸€å°†æ˜¯æ­£ç¡®çš„ã€‚</font><font style="vertical-align: inherit;">åœ¨æ­¤åŸºç¡€ä¸Šï¼Œç­”æ¡ˆå°†æœ‰æ‰€ä¸åŒ</font></font><code>callbackData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æœ€åï¼Œæ‚¨å¿…é¡»</font></font><code>answer_callback_query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨å‚æ•°</font><font style="vertical-align: inherit;">æ¥ç»å¯¹è°ƒç”¨è¯¥æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<ul>
<li><code>query_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æŒ‰ä¸‹æŒ‰é’®æ—¶çš„å”¯ä¸€ç¼–å·ï¼Œ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-å°†åœ¨å·¥å…·æç¤ºä¸­æ˜¾ç¤ºï¼Œå½“ä½ ç‚¹å‡»æŒ‰é’®ä¸Šçš„æ–‡æœ¬ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæˆ‘ä»¬å°†å‘ç”¨æˆ·æ˜¾ç¤ºè¯¥æœºå™¨äººå·²æ¥å—å•å‡»æŒ‰é’®ã€‚</font><font style="vertical-align: inherit;">å¦åˆ™ï¼Œä¸‹è½½æŒ‡ç¤ºå™¨å°†åœ¨æŒ‰é’®ä¸Šæ˜¾ç¤ºä¸€æ®µæ—¶é—´ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œ</font></font><code>send_text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨éœ€è¦å‘é€å¸¦æœ‰é—®é¢˜å’Œç­”æ¡ˆæŒ‰é’®çš„æ¶ˆæ¯æœ¬èº«ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ç«‹å³æ·»åŠ ç”¨äºå¤„ç†æ­£ç¡®å’Œé”™è¯¯ç­”æ¡ˆçš„å‡½æ•°ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">right</span>(<span class="hljs-params">bot, event</span>):</span>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=<span class="hljs-string">'!'</span>)<font></font>
    start(bot, event)<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrong</span>(<span class="hljs-params">bot, event</span>):</span>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=<span class="hljs-string">':('</span>)<font></font>
    start(bot, event)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æ‚¨å•å‡»æ­£ç¡®å’Œä¸æ­£ç¡®çš„ç­”æ¡ˆæ—¶ï¼Œå°†è°ƒç”¨è¿™äº›åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">åœ¨å¸¦æœ‰æ­£ç¡®ç­”æ¡ˆçš„æ¶ˆæ¯ä¹‹åï¼Œç”¨æˆ·å°†æ”¶åˆ°ä¸€ä¸ªæ–°é—®é¢˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰©ä¸‹çš„å°±æ˜¯æ·»åŠ æŒ‰é’®å•å‡»å¤„ç†ç¨‹åºï¼š</font></font><br>
<br>
<pre><code class="python hljs">    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=start, filters=Filter.callback_data(Â«startÂ»)))<font></font>
    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=wrong, filters=Filter.callback_data(Â«wrongÂ»)))<font></font>
    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=right, filters=Filter.callback_data(Â«rightÂ»)))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ä¸‰ä¸ªå¤„ç†ç¨‹åºä¸­çš„æ¯ä¸€ä¸ªéƒ½åŒ…å«ä¸€ä¸ªè¿‡æ»¤å™¨</font></font><code>callbackData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆä¾‹å¦‚</font></font><code>filters=Filter.callback_data(Â«startÂ»)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰å’Œä¸€ä¸ªè¦è°ƒç”¨çš„å‡½æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ ·å°±å®Œæˆäº†æœºå™¨äººç¨‹åºçš„ç¼–ç¨‹ã€‚</font><font style="vertical-align: inherit;">äº§ç”Ÿçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> bot.bot <span class="hljs-keyword">import</span> Bot
<span class="hljs-keyword">from</span> bot.handler <span class="hljs-keyword">import</span> BotButtonCommandHandler
<span class="hljs-keyword">from</span> bot.handler <span class="hljs-keyword">import</span> MessageHandler
<span class="hljs-keyword">from</span> bot.filter <span class="hljs-keyword">import</span> Filter
<span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange, choice, random, shuffle<font></font>
<font></font>
logging.basicConfig(format=<span class="hljs-string">'%(asctime)s %(levelname)s %(message)s'</span>,<font></font>
        datefmt=<span class="hljs-string">'%Y.%m.%d %I:%M:%S %p'</span>, level=logging.DEBUG)<font></font>
<font></font>
TOKEN = <span class="hljs-string">""</span> <span class="hljs-comment">#your token here</span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">startup</span>(<span class="hljs-params">bot, event</span>):</span><font></font>
    default_markup = [<font></font>
        [{<span class="hljs-string">"text"</span>: <span class="hljs-string">"!"</span>, <span class="hljs-string">"callbackData"</span>: <span class="hljs-string">"start"</span>}]<font></font>
        ]<font></font>
<font></font>
    first_message_text = <span class="hljs-string">"!  -  . ?"</span><font></font>
    bot.send_text(chat_id=event.from_chat,<font></font>
        text=first_message_text,<font></font>
        inline_keyboard_markup=json.dumps(default_markup))<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start</span>(<span class="hljs-params">bot, event</span>):</span>
    question = <span class="hljs-string">''</span>
    operands = [<span class="hljs-string">"+"</span>, <span class="hljs-string">"-"</span>, <span class="hljs-string">"*"</span>]<font></font>
    operations_count = randrange(<span class="hljs-number">3</span>)+<span class="hljs-number">2</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(operations_count):<font></font>
        question += str(randrange(<span class="hljs-number">9</span>))<font></font>
        question += choice(operands)<font></font>
    question = question[:<span class="hljs-number">-1</span>]<font></font>
    answer = eval(question)<font></font>
    buttons = [<font></font>
        [{<span class="hljs-string">'text'</span>: str(answer), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"right"</span>},<font></font>
         {<span class="hljs-string">'text'</span>: str(answer+<span class="hljs-number">1</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>}],<font></font>
        [{<span class="hljs-string">'text'</span>: str(answer<span class="hljs-number">-1</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>},<font></font>
         {<span class="hljs-string">'text'</span>: str(answer+<span class="hljs-number">2</span>), <span class="hljs-string">'callbackData'</span>: <span class="hljs-string">"wrong"</span>}]]<font></font>
    shuffle(buttons[<span class="hljs-number">0</span>])<font></font>
    shuffle(buttons[<span class="hljs-number">1</span>])<font></font>
    shuffle(buttons)<font></font>
    bot.answer_callback_query(<font></font>
        query_id=event.data[<span class="hljs-string">'queryId'</span>],<font></font>
        text=<span class="hljs-string">' '</span>)<font></font>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=question,<font></font>
        inline_keyboard_markup=json.dumps(buttons))<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">right</span>(<span class="hljs-params">bot, event</span>):</span>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=<span class="hljs-string">'!'</span>)<font></font>
    start(bot, event)<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrong</span>(<span class="hljs-params">bot, event</span>):</span>
    bot.send_text(chat_id=event.data[<span class="hljs-string">'message'</span>][<span class="hljs-string">'chat'</span>][<span class="hljs-string">'chatId'</span>],<font></font>
        text=<span class="hljs-string">':('</span>)<font></font>
    start(bot, event)<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><font></font>
    bot = Bot(token=TOKEN)<font></font>
    bot.dispatcher.add_handler(MessageHandler(callback=startup))<font></font>
    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=start, filters=Filter.callback_data(<span class="hljs-string">"start"</span>)))<font></font>
    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=wrong, filters=Filter.callback_data(<span class="hljs-string">"wrong"</span>)))<font></font>
    bot.dispatcher.add_handler(BotButtonCommandHandler(<font></font>
        callback=right, filters=Filter.callback_data(<span class="hljs-string">"right"</span>)))<font></font>
    bot.start_polling()<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<font></font>
    main()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æ³¨æ„åˆ°å®ƒåŒ…å«å‡½æ•°ç”Ÿæˆé—®é¢˜æ‰€éœ€çš„å¯¼å…¥ã€‚</font><font style="vertical-align: inherit;">é™¤äº†æ­¤åŠŸèƒ½å’Œå…¶ä»–åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ç¼–å†™è‡ªå·±çš„æŸç§é€»è¾‘:)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å“ªé‡Œä»¥åŠå¦‚ä½•è¿è¡Œï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šå¯åŠ¨æœºå™¨äººæœ€æ–¹ä¾¿ã€‚</font><font style="vertical-align: inherit;">æœ‰è®¸å¤šæœåŠ¡ä¸ºè™šæ‹ŸæœåŠ¡å™¨æä¾›äº†è¶³å¤Ÿçš„è®¿é—®æƒæ¥å®‰è£…ç¨‹åºã€‚</font><font style="vertical-align: inherit;">æŸäº›æœåŠ¡æä¾›å…è´¹è¯•ç”¨æœŸã€‚</font><font style="vertical-align: inherit;">ç”±äºæˆ‘ä»¬æ˜¯Mail.ruï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨Mail.ruäº‘è§£å†³æ–¹æ¡ˆç¤ºä¾‹å¯¹å…¶è¿›è¡Œåˆ†æã€‚</font><font style="vertical-align: inherit;">æ³¨å†Œè¿‡ç¨‹å¾ˆç®€å•ï¼Œå¯ä»¥å¿«é€Ÿè®¿é—®æ‚¨çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”å…è´¹è¯•ç”¨ï¼Œè€Œæ— éœ€é“¶è¡Œå¡æˆ–å…¶ä»–éº»çƒ¦ã€‚</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://mcs.mail.ru/ä¸Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨å†Œä¸€ä¸ªå¸æˆ·</font><font style="vertical-align: inherit;">ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºè™šæ‹Ÿæœºçš„å®ä¾‹ã€‚</font><font style="vertical-align: inherit;">æ‰€æœ‰è®¾ç½®ä¿æŒä¸å˜ï¼Œå°±è¶³å¤Ÿäº†ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥æœåŠ¡å°†æä¾›ä¸‹è½½è®¿é—®å¯†é’¥ã€‚</font><font style="vertical-align: inherit;">ä¸‹è½½ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨æˆ‘ä»¬è¿›å…¥è™šæ‹Ÿæœºï¼š</font><font style="vertical-align: inherit;">ä¸‹è½½å¯†é’¥çš„è·¯å¾„</font></font><code>ssh -i ./xxx.pem user@ip</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å“ªé‡Œ</font></font><code>./xxx.pem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å¿…è¦çš„ç¨‹åºå’Œè½¯ä»¶åŒ…ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo curl https://raw.githubusercontent.com/dvershinin/apt-get-centos/master/apt-get.sh -o /usr/<span class="hljs-built_in">local</span>/bin/apt-get<font></font>
$ chmod 0755 /usr/<span class="hljs-built_in">local</span>/bin/apt-get<font></font>
$ sudo apt-get install python3<font></font>
$ curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py<font></font>
$ python3 get-pip.py<font></font>
$ pip3 install --upgrade mailru-im-bot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®‰è£…äº†Pythonå’Œæ‰€æœ‰å¿…è¦çš„åº“ä»¥ä½¿æˆ‘ä»¬çš„æœºå™¨äººèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»ç„¶éœ€è¦å°†Botå¤åˆ¶åˆ°æœåŠ¡å™¨å¹¶è¿è¡Œå®ƒã€‚</font><font style="vertical-align: inherit;">åœ¨å¸¦æœ‰è„šæœ¬çš„æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰§è¡Œï¼š</font></font><code>scp -i ./xxx.pem ./path/to_bot.py user@ip:~</code><br>
<br>
<ul>
<li><code>./xxx.pem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -å¯†é’¥çš„è·¯å¾„ï¼›</font></font></li>
<li><code>./path/to_bot.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -æœºå™¨äººæ–‡ä»¶çš„è·¯å¾„ï¼›</font></font></li>
<li><code>user@ip:~</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -å°†æœºå™¨äººå¤åˆ¶åˆ°çš„ç™»å½•åï¼Œåœ°å€å’Œè·¯å¾„ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹åï¼Œå¸¦æœ‰botçš„æ–‡ä»¶å°†ä½äºè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ä¸»ç›®å½•ä¸­ã€‚ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è¿”å›åˆ°æœåŠ¡å™¨å¹¶è¿è¡Œï¼šï¼Œ</font></font><code>python3 ~/file_name.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä¸­</font></font><code>file_name.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸¦æœ‰botçš„æ–‡ä»¶çš„åç§°</font><font style="vertical-align: inherit;">åœ¨å“ªé‡Œ</font><font style="vertical-align: inherit;">ã€‚</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ä¸ªäººæœåŠ¡å™¨ä¸Šå‘ç°äº†ä¸€ä¸ªè‡ªåŠ¨å·¥ä½œçš„æœºå™¨äººã€‚</font><font style="vertical-align: inherit;">å¦‚æœè¦è¿›ä¸€æ­¥å¼€å‘ICQæœºå™¨äººçš„åˆ›å»ºï¼Œè¯·æ›´è¯¦ç»†åœ°ç ”ç©¶APIæœºå™¨äººçš„æ–‡æ¡£ï¼Œå¹¶ä½¿æœºå™¨äººçš„å†…éƒ¨é€»è¾‘å¤æ‚åŒ–ã€‚</font><font style="vertical-align: inherit;">ICQä¹Ÿæœ‰ä¸€ä¸ªèŠå¤©çª—å£ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­èŠå¤©æœ‰å…³æœºå™¨äººçš„é—®é¢˜ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">//icq.im/botapi_faq</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ç”¨çš„é“¾æ¥</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://icq.com/botapi/#/-ICQ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bot APIã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/mail-ru-im/bot-python-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨äºICQæœºå™¨äººçš„Pythonåº“ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://icq.im/metabot-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·å–ä»¤ç‰Œå¹¶ç¼–è¾‘æœºå™¨äººã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/shvedoff/Icq_buttons-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç§ä½¿ç”¨æŒ‰é’®æ‰§è¡Œæ‰€æœ‰å¯èƒ½åŠ¨ä½œçš„æœºå™¨äººã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://icq.im/AoLE1J5Ecm5DIjZh1gg-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èŠå¤©æœ‰å…³æœºå™¨äººçš„é—®é¢˜ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN506180/index.html">å¦‚ä½•ä¸ºæ‚¨çš„UPSé€‰æ‹©åˆé€‚çš„ç”µæºã€‚æˆ‘ä»¬ä»¥ä¼Šé¡¿ä¸ºä¾‹è¿›è¡Œåˆ†æ</a></li>
<li><a href="../zh-CN506188/index.html">400è¡Œè‡ªå®šä¹‰è¯­æ³•åˆ†æå™¨</a></li>
<li><a href="../zh-CN506190/index.html">å¦‚ä½•å‡å»ä¸€ç³»åˆ—æ—¶é—´é—´éš”å¹¶å°è¯•Bentley-Ottmannç®—æ³•</a></li>
<li><a href="../zh-CN506196/index.html">æˆ‘ä»¬å¦‚ä½•ç ´è§£æ™ºèƒ½å·¥å‚</a></li>
<li><a href="../zh-CN506204/index.html">æŠ½è±¡æ•°æ®ç±»å‹ã€‚ç¬¬2éƒ¨åˆ†ï¼šæ•°æ®ç®¡ç†</a></li>
<li><a href="../zh-CN506208/index.html">ä¿„ç½—æ–¯ç§‘å­¦å®¶åˆ›é€ äº†ä¸–ç•Œä¸Šæœ€è€çƒ­çš„ææ–™</a></li>
<li><a href="../zh-CN506222/index.html">æ¸…å•ï¼šä¸è¦é”™è¿‡ç»†èŠ‚</a></li>
<li><a href="../zh-CN506228/index.html">AdonisJS 5-åœ¨nodeJSä¸Šçš„ç±»ä¼¼Laravelçš„æ¡†æ¶å’Œå¸¦æœ‰Typescriptçš„æ¡†æ¶å€¼å¾—æ‚¨å…³æ³¨</a></li>
<li><a href="../zh-CN506230/index.html">èšå…‰ç¯è®©æˆ‘æ„Ÿåˆ°æƒŠè®¶ã€‚æµ‹è¯•å’Œå®¡æŸ¥é«˜æ–¯QPlus</a></li>
<li><a href="../zh-CN506238/index.html">ç»“è‚ é•œæ£€æŸ¥ å…³äºä¸€ä¸ªæ²¡æœ‰å˜²ç¬‘çš„å¾®å¦™è¯é¢˜</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>