<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏆 🤳🏽 🕺🏼 Django 3.0は非同期になります 🚚 ☕️ 👩🏿‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Andrew GodwinがDEP 0009：Async-capable Djangoを5月9日に公開し、7月21日にDjango 技術評議会によって承認されたため、Django 3.0がリリースされるまでに、興味深いことができるようになることが期待されます。それはHabrのコメントのどこかですでに...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Django 3.0は非同期になります</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461493/"><p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrew Godwinが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEP 0009：Async-capable Django</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を5月9日に</font><font style="vertical-align: inherit;">公開し、</font><font style="vertical-align: inherit;">7月21日に</font><font style="vertical-align: inherit;">Django </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技術評議会によって</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">承認さ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">れた</font></a><font style="vertical-align: inherit;">ため、Django 3.0がリリースされるまでに、興味深いことができるようになることが期待されます。</font><font style="vertical-align: inherit;">それは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habrのコメントのどこかで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでに言及され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ていました</font></a><font style="vertical-align: inherit;">が、私はこのニュースを翻訳してより広い聴衆に伝えることを決めました-主に、私のように、特にDjangoのニュースをフォローしない人のために。</font></font></em></p><br>
<div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1153030952915890177"></twitter-widget>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非同期Pythonは長年開発されており、Djangoエコシステムでは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主にWebソケットのサポートに重点を置い</font><font style="vertical-align: inherit;">て、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">チャネルで</font></a><font style="vertical-align: inherit;">実験を</font><font style="vertical-align: inherit;">行いました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エコシステムが発展するにつれ、Djangoを拡張してWebソケットなどの非HTTPプロトコルをサポートする必要はありませんでしたが、非同期サポートは従来のDjangoモデルビューテンプレートフレームワークに多くのメリットをもたらすことが明らかになりました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">利点は以下の動機のセクションで説明されていますが、私が得た一般的な結論は、非同期のDjangoから多くのことを得るので、それを実行するのは大変な作業に値するということです。</font><font style="vertical-align: inherit;">私はまた、燃え尽きる可能性のある1人または2人の古い貢献者に依存しない、コミュニティがサポートする反復的な方法で変更を加えることが非常に重要であると考えています。</font></font><a name="habracut"></a></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このドキュメントは「機能」DEPと呼ばれていますが、これはすべて、一部がプロセスDEPでもあることを意味します。</font><font style="vertical-align: inherit;">以下に提案する変更の範囲は信じられないほど大きく、従来の単一機能プロセスとしてそれらを起動することは失敗する可能性があります。</font></font></p><br>
<p>,         Django,    ,       .     ,    Django —    ,      ,        ,  ,       .</p><br>
<p>  ? .   ,       Django —        ,   ,      ,    .</p><br>
<p> ,  Django     ,        ,             .     , -       -      .</p><br>
<p> DEP     , ,  ,   .  ,           ,     .         ;     ,    . Django        , ,       ,     .</p><br>
<h2 id="kratkoe-opisanie"> </h2><br>
<p>    Django   , middleware, ORM    .</p><br>
<p>               .  API     ,           .</p><br>
<p> ASGI   Django    .  WSGI    event loop     Django,        .</p><br>
<p>  ORM           (sticky threads)     ORM.</p><br>
<p>  Django    ,        ,     ,       ,    .</p><br>
<p> ,     ,      DEP  ,     .  DEP     HTTP-middleware-view flow   ORM.</p><br>
<p>   .   Django 2.2     Django (  3.0  3.1)  .</p><br>
<p>     ,        master-,               .</p><br>
<p>     .    ,    .     ,     .</p><br>
<h2 id="specifikaciya"></h2><br>
<p>    ,     Django,     —     CPU-bound  —   (   event loop  ).</p><br>
<p>     :</p><br>
<ul>
<li>  (Middleware)</li>
<li> (Views)</li>
<li>ORM</li>
<li></li>
<li></li>
<li></li>
<li> </li>
<li>Email</li>
</ul><br>
<p>     ,  ,       ,   CPU-bound ,      ,  ,       management command.</p><br>
<p>  ,    ,     ,      API ( 2.2)    —       ,    ,   API   .</p><br>
<p> ,    ,  ,         .        Django,       ,       .</p><br>
<p>    , « »,  ,           ,            .</p><br>
<h3 id="tehnicheskiy-obzor"> </h3><br>
<p>,         , —       .</p><br>
<p>      :</p><br>
<ul>
<li>  (  )</li>
<li>    </li>
<li>    </li>
</ul><br>
<h4 id="asinhronnaya-obyortka"> </h4><br>
<p>        ,       .          ,        .</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">asgiref</a>    <code>sync_to_async</code>,        threadlocals (   ).</p><br>
<p>           —   , ,     ,       , —       -      .</p><br>
<p> ,    Django,      <em> </em>    ; ,    .      <code>atomic()</code> - ,      ORM   ,   ,     ,        ,     .</p><br>
<p>    « » ("sticky thread"),                     ,    ORM      .   Django, ,   ,   ,     ORM,    <code>sync_to_async</code>,   ,      .          —  . «ORM» .</p><br>
<h4 id="asinhronnaya-realizaciya"> </h4><br>
<p>  —             ,       event loop.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">asgiref</a>    <code>async_to_sync</code>.</p><br>
<p>          .        ,           ,     Python  ,        ;   .</p><br>
<p>        Django,    ,    ,   Python     ,    .      ,  Django   API   ,    core- Python,       Python.</p><br>
<h3 id="threadlocals">Threadlocals</h3><br>
<p>     Django,         , —  threadlocals.    , threadlocals    ,   Django   <code>HttpRequest</code>   threadlocal,       — ,       .</p><br>
<p> threadlocals      :</p><br>
<ul>
<li>«Context locals»,       stack-based ,   .      .</li>
<li>«True threadlocals»,            .       .</li>
</ul><br>
<p>    ,  «context locals»        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">contextvars</a>  Python,  Django 3.0     Python 3.6,         3.7.  , <code>contextvars</code>      ,   , ,   ,         ,    <code>sync_to_async</code>  <code>async_to_sync</code>     .  Django    3.7  ,       <code>contextvars</code>,        Django.</p><br>
<p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">asgiref</a> <code>Local</code>,      .     <code>contextvars</code>,           3.6   .</p><br>
<p>«True threadlocals»,   ,       .   ,     ,        ;           ,       ORM (   « ,  »),  ,      ,    .</p><br>
<p>            ; ,    ,     .</p><br>
<h3 id="odnovremennaya-podderzhka-sinhronnogo-i-asinhronnogo-interfeysov">     </h3><br>
<p>   ,        Django,   ,  Python              .</p><br>
<p> ,         API,     :</p><br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span>
value = cache.get(<span class="hljs-string">"foo"</span>)
<span class="hljs-comment">#  </span>
value = <span class="hljs-keyword">await</span> cache.get(<span class="hljs-string">"bar"</span>)</code></pre><br>
<p>    ,     Python,      .  - ,   ,    await'  ,    ,    .</p><br>
<p>(:    ,  Python     « callable   »,    -  «  <code>__acall__</code>  ».         ,        <code>__aiter__</code>  <code>__aenter__</code>.)</p><br>
<p>               ,    .          <code>sync=True</code>,       /     <code>async def</code>,        .    ,      , .</p><br>
<p>        Django          — , <code>cache.get_async</code>     <code>cache.get</code>.    ,          (   <code>await</code>  <code>_async</code>-).</p><br>
<h3 id="predstavleniya-i-obrabotka-http">   HTTP</h3><br>
<p> (views), ,     ,   ,           .</p><br>
<p>Django     :</p><br>
<ul>
<li> , ,   ,       <code>__call__</code></li>
<li> ,    ( )     <code>__call__</code>.</li>
</ul><br>
<p>   <code>BaseHandler</code>,    ,   URL resolver,     .       Django,   ,       WSGI,        event loop,  <code>async_to_sync</code>.</p><br>
<p>  (middleware)    <code>ATOMIC_REQUESTS</code>,      -  (,  <code>atomic()</code>),  ,       (,    ORM    <code>atomic()</code>).</p><br>
<p>  <code>StreamingHttpResponse</code>  ,      ,   ,        .    <code>FileResponse</code>.         ,      Response,        <code>__iter__</code>   .</p><br>
<p>WSGI -   Django    ,   WSGI     middleware       event loop. , ,     ,          .</p><br>
<p>   HTTP    WSGI,  long-polling   ,      ,   ,   /   .  ASGI  ,       ,    -HTTP ,   WebSocket,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Channels</a>.</p><br>
<h3 id="promezhutochnye-sloi"> </h3><br>
<p>           request/response,  middleware    - ,     .</p><br>
<p>Django middleware     ,    middleware  <code>get_response</code>      middleware (     middleware  ).         middleware   ,           .</p><br>
<p> ,    middleware,       middleware  get_response,               middleware  ,    .           middleware  Django 1.0    , , ,  API  .</p><br>
<p>    middleware ,         .          ,       middleware     ,  .</p><br>
<h3 id="orm">ORM</h3><br>
<p>ORM —    Django          .</p><br>
<p>     ,          by design,       , ,    .      ,        ,     ,         .</p><br>
<p>  ORM      —    .</p><br>
<h4 id="potoki"></h4><br>
<p>   ORM  ,  Django      <code>connections</code>,          .</p><br>
<p>   —           —    ,    .  -   ,   ORM  ,         .</p><br>
<p> ,       ,         . Django    thread-safety       ORM,             .</p><br>
<p>   <code>connections</code> ,     ,    —      <code>asgiref.local</code>,     .         ,     —     <code>sync_to_async</code>  <code>async_to_sync</code> —          « » ("sticky thread"),           thread-safety.</p><br>
<p> ,               ,  <code>atomic()</code>.        sticky threads         ,      .           <code>connections</code>,      .</p><br>
<p>   Django      ,       ,            « ».    ,   ,       /;        ,     management-    <code>close_old_connections</code>   .</p><br>
<p>  ,        <code>connections</code>       ,        ;  ,      « »,   ,   .</p><br>
<p> ,         <code>transaction.atomic()</code>   <code>transaction.autocommit()</code>           ,         ,  ,       .</p><br>
<p>        <code>db.new_connections()</code>,    ,        ,   ,     <code>atomic()</code>  .</p><br>
<p>      <code>new_connections()</code> Django         .  ,     , ;   ORM                  .       ,      ,  ,         ,  -     .</p><br>
<p> ,     <code>new_connections</code>    <code>atomic()</code>        .       ,   ,   <code>new_connections</code>,    «»      ORM   ,       <code>new_connections</code>.</p><br>
<p>,   API  :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_authors</span>(<span class="hljs-params">pattern</span>):</span>
    <span class="hljs-comment"># Create a new context to call concurrently</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> db.new_connections():
        <span class="hljs-keyword">return</span> [<font></font>
            author.name<font></font>
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> author <span class="hljs-keyword">in</span> Authors.objects.filter(name__icontains=pattern)<font></font>
        ]<font></font>
<font></font>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_books</span>(<span class="hljs-params">pattern</span>):</span>
    <span class="hljs-comment"># Create a new context to call concurrently</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> db.new_connections():
        <span class="hljs-keyword">return</span> [<font></font>
            book.title<font></font>
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> Book.objects.filter(name__icontains=pattern)<font></font>
        ]<font></font>
<font></font>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">my_view</span>(<span class="hljs-params">request</span>):</span>
    <span class="hljs-comment"># Query authors and books concurrently</span>
    task_authors = asyncio.create_task(get_authors(<span class="hljs-string">"an"</span>))<font></font>
    task_books = asyncio.create_task(get_books(<span class="hljs-string">"di"</span>))
    <span class="hljs-keyword">return</span> render(<font></font>
        request,<font></font>
        <span class="hljs-string">"template.html"</span>,<font></font>
        {<font></font>
            <span class="hljs-string">"books"</span>: <span class="hljs-keyword">await</span> task_books,
            <span class="hljs-string">"authors"</span>: <span class="hljs-keyword">await</span> task_authors,<font></font>
        },<font></font>
    )</code></pre><br>
<p>  ,      ,    ,     (     <code>asyncio.ensure_future</code>  Python 3.6  <code>asyncio.create_task</code>  3.7).</p><br>
<p>      « »       ,      ,       ;  ,             ,  <code>yield</code>,      .</p><br>
<h4 id="neyavnye-blokirovki"> </h4><br>
<p>    ORM  ,       (  ) ,     .</p><br>
<p>         <code>model_instance.related_field</code>, Django         .       —        ,       .</p><br>
<p> ,  Django      — <code>select_related</code>,     ,  <code>prefetch_related</code>   «  ».    ORM ,      ,      ,     , ,      .</p><br>
<p>   ,     ,   N    <code>for</code>,         Django.    ,  ,   Django   —  -    ,    (     ,        ).</p><br>
<p><code>QuerySet</code>,  ,          ,  :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">view</span>(<span class="hljs-params">request</span>):</span><font></font>
    data = []<font></font>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> User.objects.all():<font></font>
        data.append(<span class="hljs-keyword">await</span> extract_important_info(user))
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> render(<span class="hljs-string">"template.html"</span>, data)</code></pre><br>
<h4 id="drugoe"></h4><br>
<p> ORM,    ,   ;      management-.       ,         .</p><br>
<h3 id="shablony"></h3><br>
<p>   ,     ,       .     ,      ,     DEP.</p><br>
<p> ,  Jinja2   ,              .</p><br>
<p> ,         Django     ,       .  Jinja2       ,    ,        ,    .</p><br>
<p>      ,     <code>render_async</code>,   <code>render</code>;      ,   ,        .</p><br>
<h3 id="keshirovanie"></h3><br>
<p>   Django      —     <code>_async</code>-  (, <code>get_async</code>, <code>set_async</code>).</p><br>
<p>  ,       API  <code>sync_to_async</code>,    <code>BaseCache</code>.</p><br>
<p>,     thread-safety   API ,   Django,        ,       .    ,     ORM, ,      .</p><br>
<h3 id="formy"></h3><br>
<p>        ,        ,    ,     <code>ModelForm</code>  ORM     .</p><br>
<p> ,   -   <code>clean</code>  <code>save</code>,  ,   . ,      ,  ,                         DEP.</p><br>
<h3 id="email">Email</h3><br>
<p>        Django,      .    <code>send_mail_async</code>  <code>send_mail</code>,   <code>async</code>-        (, <code>mail_admins</code>).</p><br>
<p>        Django  ,    -  SMTP,     .  , ,      ,      ,   .</p><br>
<h3 id="testirovanie"></h3><br>
<p>    ,      Django  .</p><br>
<p>    ASGI-     <code>asgiref.testing.ApplicationCommunicator</code>.             assert'  .</p><br>
<p>   Django        ,    ,      .  ,      —     ,    ,        HTTP    event loop,    WSGI.</p><br>
<p>               .  ,      ,      .</p><br>
<p>  ,     ,      .       <code>async def</code>    <code>@async_to_sync</code>,       , ,    Django test runner.</p><br>
<p>       asyncio (   loop'  ,    )   , , ,   <code>DEBUG=True</code>.          —   ,       ,       .</p><br>
<h3 id="websockets">WebSockets</h3><br>
<p>      Django;      ,   Channels   ,        ASGI,      .</p><br>
<p>   ,         Channels,        ,     ASGI.</p><br>
<h3 id="poryadok-deystviy"> </h3><br>
<p>     ,     ,   .       ,          .</p><br>
<p>  ,                .         ,       —         .</p><br>
<p> ,      ,              .    ,   ORM,       ,  ,          .</p><br>
<p>  :</p><br>
<ul>
<li><p>  (  3.0)</p><br>
<ul>
<li> HTTP,     (    )</li>
<li> async       ORM</li>
<li>  </li>
</ul><br>
</li>
<li><p>  (  3.1)</p><br>
<ul>
<li>ORM (     )</li>
<li> (     )</li>
<li> (     )</li>
</ul><br>
</li>
<li><p>  </p><br>
<ul>
<li>ORM (       )</li>
<li> (    )</li>
<li>Email</li>
<li></li>
</ul><br>
</li>
</ul><br>
<p>         ;      ,    .     ,   ,       , ,            .</p><br>
<p>  ,      -   ;            ,     ,        .    ,      ,  Django,     Django  async-only .</p><br>
<p>   ,  ,    DEP  ,   , , email  .         DBAPI —  ,        core Python , , PEP,         .</p><br>
<h2 id="motivaciya"></h2><br>
<p>    ,  , ,    .   Django      ,   -       ,    -;             .</p><br>
<p>         ,      - .         ,   —  ,       ,       .</p><br>
<p>         Python —   . -  Python       ,     ,       .</p><br>
<p> Python            <code>asyncio</code>,       ,         .     ,     ,     ,  ,      Django-size   .</p><br>
<h3 id="chto-eto-dayot">  </h3><br>
<p>      Django,     «»;    ,    ,      — ,      Django —     .</p><br>
<p>    ,       .      ,    API     ,   Django      -   .</p><br>
<p>     ,      ,  Django     .             ,    Django ORM ,     ,    ,      -.</p><br>
<p> ,   , —             .    -   long-poll   server-sent events.  Django          ,    -      .</p><br>
<h3 id="sinhronnost-vsyo-eschyo-imeet-znachenie">    </h3><br>
<p>    <em></em>    Django;         .   ,  ,             ,          .</p><br>
<p>Django          ,    .    ;  Django-   ,         ,  ,     ,     ,     .</p><br>
<p>     ,       --  Django      .</p><br>
<h3 id="obratnaya-sovmestimost"> </h3><br>
<p> ,    .      « Django»,       ;     ,        ,          .</p><br>
<p> ,      ,     ,        ,    API Django,      ,      ,    Python 3,        API,        Django  Python.</p><br>
<h3 id="pomosch-python"> Python</h3><br>
<p>Python     .           Python,  ,    ,     .</p><br>
<p>  , Django —   - Python   —   ,    Python,        Python   .      ,       ,    ,        .</p><br>
<h3 id="privlechenie-novyh-uchastnikov">  </h3><br>
<p>     ,   Django,              .   ,  Django   ,       .</p><br>
<p>                  —  ,  ,    ,   ,        .</p><br>
<p> ,      —      ,   , —               Django (     ,       Python  ).</p><br>
<h3 id="chto-takoe-django">  Django?</h3><br>
<p>     ,   Django.   ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Lawrence Journal-World</a>    —    ,  , SPA —  , ,    .  , ,   ,     ,     .</p><br>
<p>   ,   Django   ,   - ,    —        —     . , ,        ; ,     Django    , .</p><br>
<p>  ,     Django     .     ,       .    ,         ,    ,    — ,        ,   .</p><br>
<h2 id="obosnovanie"></h2><br>
<p>   Django       django-developers   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a>    ,        ,  ,   ,   DEP.</p><br>
<p>     , ,   ,      :</p><br>
<ul>
<li>:       master-        Django    .</li>
<li> :     Django    ,    ,    ,     ,      Django       .</li>
<li>:    ,    ,      Django,   ,  Django.     ,   ,   ,      ,  .</li>
</ul><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Channels</a>          DEP ;        Django      ,  .</p><br>
<p>  ,   ,     .  DEP    ,   ,       —      Django           .</p><br>
<p>                .     Django, ,     ,    WSGI    ,    event loop     ,      .         10%   —     ,      .     ,      .</p><br>
<p>    ,  ,      (-  ,   Python    ).    ,     Django      ;     ,   ,     ,   Django   master-    .</p><br>
<p> ,           ( ORM,    ..),      ;                 Python.</p><br>
<p>       ,      ,        Django,     «»  .   ,      ,              ,  ,     .</p><br>
<h3 id="alternativy"></h3><br>
<p>      ,   ,  , .</p><br>
<h4 id="asinhronnye-moduli-vmesto-_async-funkciy">   _async </h4><br>
<p>       ,    ,     (, <code>django.core.cache.cache.get_async</code>),               :</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> django.core.cache_async <span class="hljs-keyword">import</span> cache<font></font>
cache.get(<span class="hljs-string">"foo"</span>)</code></pre><br>
<p>  ,           ;   ,    ,        .</p><br>
<p>  ,    ,      ;       .</p><br>
<h4 id="fork-django"> Django</h4><br>
<p>-   ,      ;  ,        ,       ,       —  .</p><br>
<p>          ,   ,     , —   ,      .</p><br>
<h4 id="rasshirenie-channels"> Channels</h4><br>
<p>   ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Channels</a>      , «»  Django. ,     -     ,  ,         Django;      ORM,   HTTP/middleware flow    .</p><br>
<h4 id="ne-asyncio"> asyncio</h4><br>
<p>     event loop'  Python,   <code>asyncio</code>          ,   Django.   <code>await</code>  <code>async</code>  Python     event loop   .</p><br>
<p>  ,   <code>asyncio</code>,     ; Django     ,        ,   .         Django        ;    , ,      async runtime,    ,    .</p><br>
<h4 id="greenletsgevent">Greenlets/Gevent</h4><br>
<p>      Gevent,      ,      Python.</p><br>
<p>       ,       .   <code>yield</code>  <code>await</code> ,   API,    Django,       ,         .               ,     .</p><br>
<p>  ,      ,  ,     .      greenlet-safe   Django ORM   -   new-connection-context,  .</p><br>
<p> ,      .   Django     « »    gevent, , ,      ,   .</p><br>
<h2 id="finansirovanie"></h2><br>
<p>            DEP.</p><br>
<p>  ,        —        , —     ,             (   ).</p><br>
<p> ,       ,  -           .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Django Fellows</a>  ;     —   ,           (  ), ,   ,  - .</p><br>
<p>      — ,   Kickstarter  <code>migrations</code>  <code>contrib.postgres</code>,    MOSS (Mozilla)  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Channels</a>.   ,   Django,  ,          .</p><br>
<p>    , <em></em>     .  —      Python,    Django —    —       .        ,     Django/async,        .</p><br>
<p>               HTTP/middleware/view flow,     ,  ,  ,      « »,      .</p><br>
<p>    ,     ,     ,            (   ,  Fellows, /     ,     Channels,       ,   ),   ,       .</p><br>
<p>        ,         ,   ,        ,       Django,      .</p><br>
<h2 id="obratnaya-sovmestimost-1"> </h2><br>
<p>, ,   ,       ,            API.</p><br>
<p>  , ,        ,  , HTTP/middleware flow. ,    API,       APM,     .</p><br>
<p> ,  ,   Django     ,     ,      .  ,   ORM  , ,   —      ,  ORM             .</p><br>
<h2 id="etalonnaya-realizaciya"> </h2><br>
<p> DEP  ,    ;       Django      .</p><br>
<p>  ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">asgiref</a>,       ,         .      Django         Django.</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Channels</a>,         Django,          Django.</p><br>
<h2 id="avtorskie-prava"> </h2><br>
<p>  <em>(  )</em>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">CC0 1.0 Universal</a>.</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461469/index.html">1000ワード/分でコードを聞くのはどうですか</a></li>
<li><a href="../ja461473/index.html">グラフのアルゴリズムのデバッグ-写真付き</a></li>
<li><a href="../ja461475/index.html">Habr。1011によるAMA</a></li>
<li><a href="../ja461483/index.html">Openstackの負荷分散</a></li>
<li><a href="../ja461487/index.html">ミニCTFテスト</a></li>
<li><a href="../ja461497/index.html">Linuxでの最新のテキストレンダリング：パート1</a></li>
<li><a href="../ja461499/index.html">2019年にゲームを翻訳する言語</a></li>
<li><a href="../ja461501/index.html">なぜ米国で大規模なIT企業の仕事を調査しているのか</a></li>
<li><a href="../ja461503/index.html">データベースをリモート接続で使用できるようにする</a></li>
<li><a href="../ja461505/index.html">あなたがプロになるのを妨げる初心者JavaScript開発者の8つのバグ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>