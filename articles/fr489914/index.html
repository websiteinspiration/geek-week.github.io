<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëõ üïï üç∑ Clustering dans Proxmox VE üìï ü§öüèΩ üóëÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans des articles pr√©c√©dents, nous avons commenc√© √† parler de ce qu'est Proxmox VE et de son fonctionnement. Aujourd'hui, nous allons parler de la fa√ß...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Clustering dans Proxmox VE</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/489914/"><img src="https://habrastorage.org/webt/ba/4_/p0/ba4_p0pjj8nlzulpcdlsdbez4mo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans des articles pr√©c√©dents, nous avons commenc√© √† parler de ce qu'est Proxmox VE et de son fonctionnement. </font><font style="vertical-align: inherit;">Aujourd'hui, nous allons parler de la fa√ßon dont vous pouvez utiliser la fonction de clustering et montrer quels avantages elle offre.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce qu'un cluster et pourquoi est-il n√©cessaire? </font><font style="vertical-align: inherit;">Un cluster (du cluster anglais) est un groupe de serveurs connect√©s par des canaux de communication √† haut d√©bit, travaillant et repr√©sentant l'utilisateur dans son ensemble. </font><font style="vertical-align: inherit;">Il existe plusieurs sc√©narios de base pour l'utilisation d'un cluster:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fournir une tol√©rance aux pannes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (haute disponibilit√©).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âquilibrage de charge</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Load Balancing).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Productivit√© accrue</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (haute performance).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution de l'</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> informatique distribu√©e</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque sc√©nario pr√©sente ses propres exigences pour les composants du cluster. </font><font style="vertical-align: inherit;">Par exemple, pour un cluster effectuant de l'informatique distribu√©e, la principale exigence est une vitesse √©lev√©e des op√©rations en virgule flottante et une faible latence du r√©seau. </font><font style="vertical-align: inherit;">Ces grappes sont souvent utilis√©es √† des fins de recherche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque nous avons abord√© le sujet de l'informatique distribu√©e, je tiens √† noter qu'il existe toujours une chose telle qu'un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">syst√®me de grille</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(de l'anglais. grille - treillis, r√©seau). </font><font style="vertical-align: inherit;">Malgr√© la similitude g√©n√©rale, ne confondez pas le syst√®me de grille et le cluster. </font><font style="vertical-align: inherit;">La grille n'est pas un cluster au sens habituel. </font><font style="vertical-align: inherit;">Contrairement au cluster, les n≈ìuds inclus dans le r√©seau sont le plus souvent h√©t√©rog√®nes et se caract√©risent par une faible disponibilit√©. </font><font style="vertical-align: inherit;">Cette approche simplifie la solution des probl√®mes de calcul distribu√©, mais ne permet pas de cr√©er un seul ensemble √† partir de n≈ìuds.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple frappant d'un syst√®me de grille est la plate-forme informatique populaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BOINC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Berkeley Open Infrastructure for Network Computing). </font><font style="vertical-align: inherit;">Cette plateforme a √©t√© cr√©√©e √† l'origine pour le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projet SETI @ home</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Search for Extra-Terrestrial Intelligence at Home), qui traite du probl√®me de la recherche d'intelligence extraterrestre en analysant les signaux radio.</font></font></blockquote><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment √ßa fonctionne</font></font></b><div class="spoiler_text">  ,   ,     ,      - (  SETI@home      ).              SETI.       ,        .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous comprenons clairement ce qu'est un cluster, nous sugg√©rons d'envisager comment il peut √™tre cr√©√© et d√©ploy√©. </font><font style="vertical-align: inherit;">Nous utiliserons le syst√®me de virtualisation open source </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proxmox VE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer √† cr√©er un cluster, il est particuli√®rement important de bien comprendre les limitations et les exigences syst√®me de Proxmox, √† savoir:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le nombre maximal de n≈ìuds dans un cluster est de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tous les n≈ìuds doivent avoir la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√™me version de Proxmox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (il existe des exceptions, mais ils ne sont pas recommand√©s pour la production);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si √† l'avenir il est pr√©vu d'utiliser la fonctionnalit√© Haute disponibilit√©, le cluster doit avoir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">au moins 3 n≈ìuds</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour que les n≈ìuds communiquent entre eux, les ports </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UDP / 5404</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UDP / 5405</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour corosync et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP / 22</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour SSH </font><font style="vertical-align: inherit;">doivent √™tre ouverts </font><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le retard du r√©seau entre les n≈ìuds ne doit pas d√©passer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 ms</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation de cluster</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important! </font><font style="vertical-align: inherit;">La configuration ci-dessous est une configuration de test. </font><font style="vertical-align: inherit;">Assurez-vous de v√©rifier la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation officielle de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proxmox VE. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de d√©marrer le cluster de test, nous avons pris trois serveurs avec l'hyperviseur Proxmox install√© de la m√™me configuration (2 c≈ìurs, 2 Go de RAM).</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous souhaitez savoir comment installer Proxmox, nous vous recommandons de lire notre article pr√©c√©dent - La </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">magie de la virtualisation: un cours d'introduction √† Proxmox VE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialement, apr√®s l'installation du syst√®me d'exploitation, un seul serveur s'ex√©cute en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode autonome</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2l/b9/1x/2lb91xdrokvieydn63rr9fb7ndo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cr√©ez un cluster en cliquant sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©er un cluster</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la section correspondante.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4k/sr/me/4ksrmekzntmzfig-2ymdwx7oahs.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nommons le futur cluster et s√©lectionnons la connexion r√©seau active.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cy/ww/bt/cywwbtaea7ogttm77ebrwtwo7f8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquez sur le bouton Cr√©er. </font><font style="vertical-align: inherit;">Le serveur g√©n√©rera une cl√© de 2048 bits et l'√©crira avec les param√®tres du nouveau cluster dans les fichiers de configuration.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qv/r3/wy/qvr3wyzqfxrgscstbwz0mzxztv0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'inscription </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TASK OK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indique une op√©ration r√©ussie. </font><font style="vertical-align: inherit;">Maintenant, en regardant les informations g√©n√©rales sur le syst√®me, il est clair que le serveur est pass√© en mode cluster. </font><font style="vertical-align: inherit;">Jusqu'√† pr√©sent, le cluster se compose d'un seul n≈ìud, c'est-√†-dire qu'il n'a pas les capacit√©s pour lesquelles le cluster est n√©cessaire.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cv/zl/17/cvzl17xrzcnv4tbjlgcgutbd6vc.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rejoindre un cluster</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de vous connecter au cluster cr√©√©, nous devons obtenir des informations pour terminer la connexion. </font><font style="vertical-align: inherit;">Pour ce faire, acc√©dez √† la section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et cliquez sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Join Information</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7g/se/mi/7gsemira1cy79g3f9yxopfxc_mo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la fen√™tre qui s'ouvre, nous nous int√©ressons au contenu du champ du m√™me nom. </font><font style="vertical-align: inherit;">Il devra √™tre copi√©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rw/-i/7h/rw-i7hhyo_yqrqy-o9oh2jxmi9g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les param√®tres de connexion n√©cessaires sont encod√©s ici: adresse du serveur pour la connexion et empreinte digitale. </font><font style="vertical-align: inherit;">Nous passons au serveur qui doit √™tre inclus dans un cluster. </font><font style="vertical-align: inherit;">Cliquez sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Join Cluster</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et dans la fen√™tre qui s'ouvre, collez le contenu copi√©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/fh/0v/btfh0vp9foxegb2lcca-d-kww1c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les champs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresse du pair</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Empreinte digitale</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seront remplis automatiquement. </font><font style="vertical-align: inherit;">Saisissez le mot de passe root √† partir du n≈ìud num√©ro 1, s√©lectionnez la connexion r√©seau et cliquez sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rejoindre</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/v-/um/i3/v-umi3rqffairr3yhnn2tz2uafi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous rejoignez un cluster, la page Web GUI peut cesser de se mettre √† jour. </font><font style="vertical-align: inherit;">C'est normal, il suffit de recharger la page. </font><font style="vertical-align: inherit;">De la m√™me mani√®re, nous ajoutons un n≈ìud suppl√©mentaire et, par cons√©quent, nous recevons un cluster √† part enti√®re de 3 n≈ìuds de travail.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tc/wb/mx/tcwbmxrp1umdagapsce7tv4qfie.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons maintenant contr√¥ler tous les n≈ìuds de cluster √† partir d'une seule interface graphique.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e4/at/cb/e4atcbt-_ihvdai9jjjmiamgrds.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisation √† haute disponibilit√©</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proxmox pr√™t √† l'emploi prend en charge la fonctionnalit√© d'organisation HA pour les machines virtuelles et les conteneurs LXC. </font><font style="vertical-align: inherit;">L'utilitaire </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ha-manager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©tecte et traite les erreurs et les √©checs en effectuant un basculement d'un n≈ìud d√©faillant vers un n≈ìud fonctionnel. </font><font style="vertical-align: inherit;">Pour que le m√©canisme fonctionne correctement, il est n√©cessaire que les machines virtuelles et les conteneurs aient un stockage de fichiers commun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois la fonctionnalit√© Haute disponibilit√© activ√©e, la pile logicielle ha-manager commencera √† surveiller en continu l'√©tat de la machine virtuelle ou du conteneur et √† interagir de mani√®re asynchrone avec les autres n≈ìuds du cluster.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attacher un stockage partag√©</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous avons d√©ploy√© un petit stockage de fichiers NFS √† 192.168.88.18. </font><font style="vertical-align: inherit;">Pour que tous les n≈ìuds du cluster puissent l'utiliser, vous devez effectuer les manipulations suivantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous s√©lectionnons dans le menu de l'interface web </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datacenter - Stockage - Ajouter - NFS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vr/pd/3u/vrpd3uedlwasqpg0m19g8pvtb2o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remplissez les champs </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans la liste d√©roulante </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exporter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">s√©lectionnez le r√©pertoire souhait√© parmi ceux disponibles et dans la liste </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les types de donn√©es n√©cessaires. </font><font style="vertical-align: inherit;">Apr√®s avoir cliqu√© sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le </font><font style="vertical-align: inherit;">stockage sera connect√© √† tous les n≈ìuds du cluster.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6d/mu/fy/6dmufyavxpq4dcxaqxarozuughm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la cr√©ation de machines virtuelles et de conteneurs sur l'un des n≈ìuds, nous sp√©cifions notre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stockage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme stockage.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personnaliser HA</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, cr√©ez un conteneur avec Ubuntu 18.04 et configurez-y la haute disponibilit√©. </font><font style="vertical-align: inherit;">Apr√®s avoir cr√©√© et lanc√© le conteneur, acc√©dez √† la section </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datacenter - HA - Ajouter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dans le champ qui s'ouvre, sp√©cifiez l'ID de la machine virtuelle / du conteneur et le nombre maximal de tentatives de red√©marrage et de d√©placement entre les n≈ìuds.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si ce montant est d√©pass√©, l'hyperviseur marquera la machine virtuelle comme ayant √©chou√© et la transf√©rera √† l'√©tat d'erreur, apr√®s quoi elle cessera d'ex√©cuter toutes les actions avec elle.</font></font></blockquote><div style="text-align:center;"><img src="https://habrastorage.org/webt/p4/h9/ng/p4h9nglzk5gtsojtebmvlny9cvq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir cliqu√© sur le bouton </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l' </font><font style="vertical-align: inherit;">utilitaire </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ha-manager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avertira tous les n≈ìuds du cluster que la machine virtuelle avec l'ID sp√©cifi√© est maintenant surveill√©e et si elle tombe, elle doit √™tre red√©marr√©e sur un autre n≈ìud.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ni/6x/q5/ni6xq5soctxwt3-abx9bs0gvo8o.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faire un crash</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de voir comment fonctionne le m√©canisme de commutation, payons anormalement l'alimentation du n≈ìud1. </font><font style="vertical-align: inherit;">Nous regardons d'un autre n≈ìud ce qui arrive au cluster. </font><font style="vertical-align: inherit;">On voit que le syst√®me a enregistr√© une panne.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/df/wc/ve/dfwcve9i2iplppnbexfsomn0w40.png"></div><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fonctionnement du m√©canisme HA ne signifie pas le fonctionnement continu de la machine virtuelle. </font><font style="vertical-align: inherit;">D√®s que le n≈ìud est "tomb√©", le fonctionnement de la machine virtuelle est temporairement arr√™t√© jusqu'au red√©marrage automatique sur un autre n≈ìud.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et ici, la ¬´magie¬ª commence - le cluster a automatiquement r√©affect√© le n≈ìud pour ex√©cuter notre machine virtuelle et en 120 secondes, le travail a √©t√© automatiquement restaur√©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/ep/j6/slepj6ytjfwkdkfx--i7kvrxega.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous √©teignons node2 sur la nutrition. </font><font style="vertical-align: inherit;">Voyons si le cluster peut r√©sister et la machine virtuelle reviendra automatiquement √† son √©tat de fonctionnement.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7c/ge/k6/7cgek6uuanswhta3osmoshozk10.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√©las, comme nous le voyons, nous avons eu un probl√®me avec le fait que le seul n≈ìud survivant n'a plus de quorum, ce qui d√©sactive automatiquement HA. </font><font style="vertical-align: inherit;">Nous donnons la commande pour forcer l'installation du quorum dans la console.</font></font><br>
<br>
<pre><code class="plaintext hljs">pvecm expected 1</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/n6/jw/qkn6jwdgtovfx9ns7kt2veahb0w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s 2 minutes, le m√©canisme HA fonctionnait correctement et ne trouvant pas node2, a lanc√© notre VM sur node3.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6s/z2/xm/6sz2xmx1djx-_rm6k_y3uz6xcpu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√®s que nous avons rallum√© node1 et node2, le cluster a √©t√© enti√®rement restaur√©. </font><font style="vertical-align: inherit;">Notez que la machine virtuelle ne migre pas vers node1, mais cela peut √™tre fait manuellement.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sumer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous vous avons expliqu√© le fonctionnement du m√©canisme de clustering dans Proxmox et montr√© √©galement comment HA est configur√© pour les machines virtuelles et les conteneurs. </font><font style="vertical-align: inherit;">L'utilisation appropri√©e du clustering et de la haute disponibilit√© am√©liore consid√©rablement la fiabilit√© de l'infrastructure et fournit √©galement une reprise apr√®s sinistre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de cr√©er un cluster, vous devez planifier imm√©diatement √† quelles fins il sera utilis√© et combien il devra √™tre mis √† l'√©chelle √† l'avenir. </font><font style="vertical-align: inherit;">Vous devez √©galement v√©rifier la disponibilit√© de l'infrastructure r√©seau avec des d√©lais minimaux afin que le futur cluster fonctionne sans √©checs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dites-nous - utilisez-vous des capacit√©s de clustering dans Proxmox? </font><font style="vertical-align: inherit;">Rendez-vous dans les commentaires. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Articles pr√©c√©dents sur l'hyperviseur Proxmox VE:</font></font></i><br>
<br>
<ul>
<li><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La magie de la virtualisation: un cours d'introduction √† Proxmox VE</font></font></a></i></li>
<li><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos des sauvegardes dans Proxmox VE</font></font></a></i></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr489900/index.html">PostgreSQL Antipatterns: modification des donn√©es en contournant un d√©clencheur</a></li>
<li><a href="../fr489902/index.html">Comment mesurer l'efficacit√© d'un portefeuille d'investissement: 3 approches pratiques</a></li>
<li><a href="../fr489904/index.html">Pourquoi et comment testons-nous la mise √† jour</a></li>
<li><a href="../fr489906/index.html">Cabine d'essayage virtuelle en OpenCV</a></li>
<li><a href="../fr489912/index.html">La douleur et la souffrance lors du d√©bogage des microservices dans le d√©veloppement Web</a></li>
<li><a href="../fr489916/index.html">Protocole de communication frontal structur√© Protobuf ou JSON?</a></li>
<li><a href="../fr489918/index.html">Comment nous avons mis en ≈ìuvre le projet de carte carburant virtuelle</a></li>
<li><a href="../fr489920/index.html">Sites, passez √† IPv6, deux</a></li>
<li><a href="../fr489924/index.html">O√π commence Elasticsearch</a></li>
<li><a href="../fr489926/index.html">Black Friday: un regard sur la charge √† travers les yeux du d√©veloppeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>