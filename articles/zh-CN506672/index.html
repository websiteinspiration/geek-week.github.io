<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸš€ ğŸ‘¨ğŸ¼ ğŸ‘¨ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ½ ä¸Šæ¶çš„SwiftUIï¼šåŠ¨ç”»ï¼Œç¬¬2éƒ¨åˆ† ğŸ¤ ğŸ“ ğŸ†š</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™æ˜¯SwiftUIä¸­åŠ¨ç”»æ•…äº‹çš„ç¬¬äºŒéƒ¨åˆ†ã€‚åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çœ‹äº†ä¸€äº›ç®€å•çš„ç¤ºä¾‹æ¥äº†è§£SwiftUIä¸­åŠ¨ç”»å·¥ä½œåŸç†çš„åŸºç¡€ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è¿›è¡Œæ›´è¿›ä¸€æ­¥ï¼Œå¹¶ä¸”å°†è¯¦ç»†åˆ†æå½©è™¹åŠ¨ç”»æ‰€å®£å¸ƒçš„ç¤ºä¾‹ã€‚
 
 
 
 åœ¨å‰ªåˆ‡ä¸‹ï¼Œæ‚¨å°†å‘ç°åŠ¨ç”»çš„æ—¶åºåˆ†æï¼Œåˆ›å»ºç”¨äºå¾ªç¯çº¿æ€§åŠ¨ç”»çš„è‡ªå·±çš„æ—¶åºæ›²çº¿æœºåˆ¶ï¼Œä¸åŒæ¸å˜çš„å®ç°ç¤ºä¾‹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä¸Šæ¶çš„SwiftUIï¼šåŠ¨ç”»ï¼Œç¬¬2éƒ¨åˆ†</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506672/"><img src="https://habrastorage.org/webt/1u/td/t6/1utdt6xa6tcsov4biwj2ura36s0.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯SwiftUIä¸­åŠ¨ç”»æ•…äº‹çš„ç¬¬äºŒéƒ¨åˆ†ã€‚åœ¨ç¬¬ä¸€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¯‡æ–‡ç« ä¸­ï¼Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬çœ‹äº†ä¸€äº›ç®€å•çš„ç¤ºä¾‹æ¥äº†è§£SwiftUIä¸­åŠ¨ç”»å·¥ä½œåŸç†çš„åŸºç¡€ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è¿›è¡Œæ›´è¿›ä¸€æ­¥ï¼Œå¹¶ä¸”å°†è¯¦ç»†åˆ†æå½©è™¹åŠ¨ç”»æ‰€å®£å¸ƒçš„ç¤ºä¾‹ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d7/am/oa/d7amoa5ktffdezfstl4a1pisyjw.gif" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å‰ªåˆ‡ä¸‹ï¼Œæ‚¨å°†å‘ç°åŠ¨ç”»çš„æ—¶åºåˆ†æï¼Œåˆ›å»ºç”¨äºå¾ªç¯çº¿æ€§åŠ¨ç”»çš„è‡ªå·±çš„æ—¶åºæ›²çº¿æœºåˆ¶ï¼Œä¸åŒæ¸å˜çš„å®ç°ç¤ºä¾‹ä»¥åŠä¸€äº›æœ‰è¶£çš„æŠ€å·§ï¼Œè¿™äº›æŠ€å·§å°†å¸®åŠ©æ‚¨äº†è§£åŠ¨ç”»åœ¨å¹•åçš„å·¥ä½œæ–¹å¼ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘æé†’æ‚¨ï¼Œæˆ‘åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾¦å¯Ÿè¿‡å®ç°è¿™ç§åŠ¨ç”»çš„æƒ³æ³•</font><font style="vertical-align: inherit;">ã€‚åœ¨é‚£å„¿ï¼Œä½œè€…é‡‡å–äº†é˜»åŠ›æœ€å°çš„é€”å¾„ï¼Œå¹¶é€šè¿‡å¯¹å½¢çŠ¶è¿›è¡ŒåŠ¨ç”»å¤„ç†ï¼Œå®ç°äº†æœ€æ˜æ˜¾çš„æ–¹æ³•æ¥å®ç°æ­¤æ¦‚å¿µã€‚åŸç†å¾ˆç®€å•ï¼šæ¯ä¸ªæ³¢éƒ½æ˜¯è´å¡å°”æ›²çº¿æ‰€å‹¾å‹’çš„è½®å»“ï¼Œâ€œæ—¶é—´â€å‚æ•°ä¼šå½±å“è¯¥æ³¢å³è¾¹ç•Œçš„ä½ç½®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯å®Œæˆçš„åŠ¨ç”»çš„å¤–è§‚ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7a7/cbf/7a0/7a7cbf7a05561123ceff4be47fff5ed6.gif" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œæˆ‘å°†æ³¢æµªç¨å¾®å‚ç›´åœ°æ•£å¼€ã€‚è¿™å¾ˆå®¹æ˜“åšåˆ°ï¼Œæˆ‘åªæ˜¯åœ¨NotchWaveçš„ç»“å°¾å¤„æ·»åŠ äº†æ ¹æ®åŠ¨ç”»çš„å½“å‰é˜¶æ®µå°†æ•´ä¸ªè½®å»“å‘ä¸‹ç§»åŠ¨åˆ°æ³¢æµªé«˜åº¦çš„æ–¹æ³•ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">return</span> p.applying(.<span class="hljs-keyword">init</span>(translationX: <span class="hljs-number">0</span>, y: height * <span class="hljs-keyword">self</span>.phase))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒæ ·ï¼Œ.drowingGroupï¼ˆï¼‰ä¹Ÿæœ‰å¿…è¦ä¸è¦å¿˜è®°æ–­å¼€è¿æ¥-è¿™å¹¶ä¸æ„å‘³ç€å›¾åƒè¶…å‡ºäº†å›ºå®šæ¡†æ¶çš„è¾¹ç•Œã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z3/zv/bi/z3zvbiseywno8t1fnt-i0ugcqgm.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ç§æ–¹æ³•å¾ˆç®€å•ï¼Œå¯ä»¥äº§ç”Ÿé¢„æœŸçš„ç»“æœâ€¦â€¦ä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™å¤ªæ— èŠäº†ã€‚</font><font style="vertical-align: inherit;">äº‹å®è¯æ˜ï¼Œæˆ‘çš„é“è·¯è¦é•¿å¾—å¤šï¼Œæˆ‘ä¸ä¼šè¯´æœ€ç»ˆç»“æœè‡³å°‘ä¼šå¥½ä¸€äº›ï¼Œä½†åœ¨æ­¤è¿‡ç¨‹ä¸­ä¼šå¾ˆæœ‰è¶£ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨ä»ç„¶ä¸å¤ªäº†è§£SwiftUIä¸­çš„åŠ¨ç”»å·¥ä½œåŸç†ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨é˜…è¯»</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šä¸€ç¯‡æ–‡ç« </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘æƒ³æ·±å…¥ç ”ç©¶</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šçš„æºä»£ç </font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨æ¸å˜</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€å¼€å§‹ï¼Œæˆ‘é€‰æ‹©äº†å¦ä¸€ç§æ–¹æ³•ã€‚æˆ‘å‘ç°å¤„ç†å¯¹è±¡ä½ç§»çš„åŠ¨ç”»æ¯”å¤„ç†è¡¨å•çš„åŠ¨ç”»è¦æœ‰ç”¨å¾—å¤šï¼ˆæˆ‘ä»ç„¶ç§°å‘¼è¡¨å•çš„å½¢çŠ¶ç»“æ„ï¼‰ã€‚åç§»å¯ä»¥å¤„ç†ä»»ä½•å†…å®¹-å„ç§å½¢çŠ¶ï¼Œå›¾åƒï¼Œå…¶ä»–è§†å›¾ã€‚ä½œä¸ºä¸€é¡¹æ•™è‚²ä»»åŠ¡ï¼Œæˆ‘æƒ³å®ç°ä»ä¸€ä¸ªæ³¢å½¢åˆ°å¦ä¸€ä¸ªæ³¢å½¢çš„å¹³æ»‘é¢œè‰²è¿‡æ¸¡ã€‚åœ¨æœ€åˆçš„æ¦‚å¿µä¸­ï¼Œå°±æ˜¯è¿™æ ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ€»çš„æ¥è¯´ï¼ŒSwiftIUIæä¾›äº†ä¸‰ç§å¯èƒ½çš„æ¸å˜ç”¨æ³•-çº¿æ€§ï¼Œåœ†å½¢å’Œè§’åº¦ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t7/o6/7d/t7o67dwcm_v5svufist7tfp0kwe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä»£ç ä¸­ï¼Œè¿™çœ‹èµ·æ¥åƒæŸç§å—æ„é€ å‡½æ•°ã€‚æ³¨æ„æ•´ä¸ªæ³¢å¦‚ä½•åˆ†å‰²ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wa/af/el/waafeltt9cgiasfzxg1gjexwc8i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çº¿æ€§æ¸å˜çš„ç‰¹å¾æ˜¯æ¸å˜çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚</font><font style="vertical-align: inherit;">è¿™äº›ä¸æ˜¯å…·æœ‰ç»å¯¹åæ ‡ï¼ˆxï¼šy :)çš„CGPointç‚¹ï¼Œè€Œæ˜¯UnitPointç‚¹ï¼Œå³ </font><font style="vertical-align: inherit;">ç›¸å¯¹åæ ‡ï¼Œå…¶ä¸­xï¼šyï¼šä»¥ä¸ºæ­¤è§†å›¾é€‰æ‹©çš„åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦çš„åˆ†æ•°æŒ‡å®šã€‚</font><font style="vertical-align: inherit;">è¿˜å­˜åœ¨å¯¹åº”äºè§’çš„é¢„å®šä¹‰ç‚¹ï¼ˆ.topLeadingï¼Œ.bottomTrailingç­‰ï¼‰å’Œè¾¹çš„ä¸­ç‚¹ï¼ˆ.topï¼Œ.trailingç­‰ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">
<span class="hljs-type">Rectangle</span>()<font></font>
    .fill(<span class="hljs-type">LinearGradient</span>(<font></font>
         gradient: <span class="hljs-type">Gradient</span>(stops: [<font></font>
             .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.end, location: <span class="hljs-number">0</span>),<font></font>
             .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.middle, location: <span class="hljs-number">1</span> - <span class="hljs-keyword">self</span>.middleGradientStop),<font></font>
             .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.start, location: <span class="hljs-number">1</span>)]),<font></font>
          startPoint: .leading,<font></font>
          endPoint: .trailing))<font></font>
    .frame(width: <span class="hljs-keyword">self</span>.gradientLength)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çº¿æ€§æ¢¯åº¦çº¿æ®µæ˜¯â€œæ©¡èƒ¶â€ã€‚</font><font style="vertical-align: inherit;">å®ƒå…·æœ‰å›ºå®šçš„å®½åº¦ï¼Œä½†æœªæŒ‡å®šå…¶é«˜åº¦ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œå®ƒå°†å¡«æ»¡æ‰€æä¾›çš„å…¨éƒ¨é‡‘é¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€ä¸ªç¨å¾®å¤æ‚çš„æ•…äº‹ï¼Œå¸¦æœ‰åœ†å½¢æ¸å˜ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬æŒ‡å‡ºç‚¹-åœ†å¿ƒï¼Œæ¸å˜èµ·ç‚¹çš„åŠå¾„å’Œæ¸å˜ç»ˆç‚¹çš„åŠå¾„ã€‚</font><font style="vertical-align: inherit;">åŠå¾„å·²ç»æ˜¯ç»å¯¹å€¼ï¼Œå³ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‚¹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ†å¿ƒä»è®¾ç½®ä¸ºUnitPointã€‚</font></font><br>
<br>
<pre><code class="swift hljs">
<span class="hljs-type">Rectangle</span>()<font></font>
     .fill(<span class="hljs-type">RadialGradient</span>(<font></font>
          gradient: <span class="hljs-type">Gradient</span>(stops: [<font></font>
              .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.start, location: <span class="hljs-number">0</span>),<font></font>
              .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.middle, location: <span class="hljs-keyword">self</span>.middleGradientStop),<font></font>
              .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.end, location: <span class="hljs-number">1</span>)]),<font></font>
          center: .bottomTrailing,<font></font>
          startRadius: <span class="hljs-keyword">self</span>.topRadius,<font></font>
          endRadius: <span class="hljs-keyword">self</span>.topRadius + <span class="hljs-keyword">self</span>.gradientLength)<font></font>
                )<font></font>
    .frame(height: <span class="hljs-keyword">self</span>.topRadius)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¸¦æœ‰é¡¶éƒ¨åœ†åœˆçš„ç‰‡æ®µå…·æœ‰å›ºå®šçš„é«˜åº¦ï¼Œä½†æ°´å¹³å»¶ä¼¸ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬ä»¥ç‚¹ä¸ºå•ä½è®¾ç½®äº†ç‰¹å®šçš„å›ºå®šåŠå¾„ï¼Œå› æ­¤ä¸éœ€è¦åƒçº¿æ€§æ¸å˜é‚£æ ·ç²˜åˆåŸºæœ¬é¢œè‰²çš„å…¶ä»–æ‹‰ä¼¸çŸ©å½¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€éš¾åº”ç”¨çš„æ˜¯è§’åº¦æ¢¯åº¦ã€‚å®ƒç”±èµ·ç‚¹å’Œç»ˆç‚¹è§’åº¦ä»¥åŠæ–¹å‘ç»™å‡ºã€‚ä»ä»£ç æ¸…å•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨è§’ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨éœ€è¦åœ¨ä¸€ä¸ªç‚¹å¼€å§‹è§’åº¦æ¢¯åº¦å¹¶åœ¨å¦ä¸€ä¸ªç‚¹ç»“æŸï¼Œåˆ™å¿…é¡»è®°ä½ä¸‰è§’å­¦çš„è¯¾ç¨‹ä»¥ä¾¿è®¡ç®—æ‰€éœ€çš„è§’åº¦ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">       
<span class="hljs-type">Rectangle</span>()<font></font>
      .fill(<span class="hljs-type">AngularGradient</span>(<font></font>
            gradient: <span class="hljs-type">Gradient</span>(stops: [<font></font>
                  .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.end, location: <span class="hljs-number">0</span>),<font></font>
                  .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.middle, location: <span class="hljs-number">1</span> - <span class="hljs-keyword">self</span>.angularGradientMiddleStop(blockWidth: geometry.size.width)),<font></font>
                  .<span class="hljs-keyword">init</span>(color: <span class="hljs-keyword">self</span>.start, location: <span class="hljs-number">1</span>)]),<font></font>
            center: .bottomLeading,<font></font>
            startAngle: <span class="hljs-keyword">self</span>.directionTo(gradientPart: <span class="hljs-keyword">self</span>.start, blockWidth: geometry.size.width),<font></font>
            endAngle: <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">360</span>)))<font></font>
<font></font>
...<font></font>
   <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">directionTo</span><span class="hljs-params">(gradientPart: Color, blockWidth: CGFloat)</span></span> -&gt; <span class="hljs-type">Angle</span>{
        <span class="hljs-keyword">let</span> angleOf = gradientAngles(blockWidth: blockWidth)
        <span class="hljs-keyword">var</span> angle = <span class="hljs-type">Angle</span>.zero
        <span class="hljs-keyword">switch</span> gradientPart{
            <span class="hljs-keyword">case</span> start: angle = angleOf.start
            <span class="hljs-keyword">case</span> middle: angle = angleOf.middle
            <span class="hljs-keyword">case</span> end: angle = angleOf.end
            <span class="hljs-keyword">default</span>: <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"there is no gradient stop with that color: \(gradientPart)"</span>)<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> angle<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">gradientAngles</span><span class="hljs-params">(blockWidth: CGFloat)</span></span> -&gt; (start: <span class="hljs-type">Angle</span>, middle: <span class="hljs-type">Angle</span>, end: <span class="hljs-type">Angle</span>){
        <span class="hljs-keyword">let</span> blockHeight = <span class="hljs-keyword">self</span>.bottomRadius
        <span class="hljs-keyword">let</span> center = <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">0</span>, y: blockHeight)
        <span class="hljs-keyword">let</span> topRight = <span class="hljs-type">CGPoint</span>(x: blockWidth, y: blockHeight - <span class="hljs-keyword">self</span>.gradientLength)
        <span class="hljs-keyword">let</span> topGradientStarts = <span class="hljs-type">CGPoint</span>(x: blockWidth, y: blockHeight - <span class="hljs-keyword">self</span>.gradientLength * (<span class="hljs-number">1</span> - <span class="hljs-keyword">self</span>.middleGradientStop))
        <span class="hljs-keyword">let</span> startAngle = center.radialDirection(to: topRight)
        <span class="hljs-keyword">let</span> middleAngle = center.radialDirection(to: topGradientStarts)
        <span class="hljs-keyword">let</span> endAngle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">360</span>)
        <span class="hljs-keyword">return</span> (start: startAngle, middle: middleAngle, end: endAngle)<font></font>
    }<font></font>
<font></font>
...<font></font>
<span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">CGPoint</span></span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">radialDirection</span><span class="hljs-params">(to point: CGPoint)</span></span> -&gt; <span class="hljs-type">Angle</span>{
        <span class="hljs-keyword">let</span> deltaX =  point.x - <span class="hljs-keyword">self</span>.x
        <span class="hljs-keyword">let</span> deltaY =  point.y - <span class="hljs-keyword">self</span>.y
        <span class="hljs-keyword">var</span> angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">0</span>)
        <span class="hljs-keyword">if</span> deltaX == <span class="hljs-number">0</span>{
            <span class="hljs-keyword">if</span> deltaY &gt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">90</span>)<font></font>
            }<span class="hljs-keyword">else</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">270</span>)<font></font>
            }<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> deltaY == <span class="hljs-number">0</span>{
            <span class="hljs-keyword">if</span> deltaX &gt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">0</span>)<font></font>
            }<span class="hljs-keyword">else</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">180</span>)<font></font>
            }<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> deltaX &gt; <span class="hljs-number">0</span> &amp;&amp; deltaY &gt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(radians: atan(<span class="hljs-type">Double</span>(deltaY / deltaX)))<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> deltaX &gt; <span class="hljs-number">0</span> &amp;&amp; deltaY &lt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">270</span>) + <span class="hljs-type">Angle</span>(radians: atan(<span class="hljs-type">Double</span>(deltaX / -deltaY)))<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> deltaX &lt; <span class="hljs-number">0</span> &amp;&amp; deltaY &gt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">90</span>) + <span class="hljs-type">Angle</span>(radians: atan(<span class="hljs-type">Double</span>(-deltaX / deltaY)))<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> deltaX &lt; <span class="hljs-number">0</span> &amp;&amp; deltaY &lt; <span class="hljs-number">0</span>{<font></font>
                angle = <span class="hljs-type">Angle</span>(degrees: <span class="hljs-number">180</span>) + <span class="hljs-type">Angle</span>(radians: atan(<span class="hljs-type">Double</span>(deltaY / deltaX)))<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> angle<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§’æ¢¯åº¦æ˜¯æ³¢æµªçš„å°¾éƒ¨ï¼Œä¹Ÿæ˜¯æ©¡èƒ¶çš„ï¼Œä½†å·²ç»å¾ˆå®½äº†-å å‰©ä½™å¤§å°çš„ä¸€åŠã€‚å®é™…ä¸Šï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸‰è§’å‡½æ•°å¦‚æ­¤ä¹‹å¤šçš„åŸå› ã€‚æˆ‘çŸ¥é“å±å¹•è¾¹ç•Œä¸Šç‰¹å®šé¢œè‰²åº”ä¸ºç‰¹å®šç‚¹çš„ä½ç½®ï¼ˆå› ä¸ºæˆ‘å°†åœ†å½¢æ¸å˜èƒ¶ç²˜åˆ°ä¸€ä¸ªè§’åº¦ï¼‰ã€‚è€Œä¸”ï¼Œè§’åº¦çš„å€¼ä¸ä»…å–å†³äºè¾ƒä½æ¢¯åº¦çš„åŠå¾„ï¼Œè¿˜å–å†³äºå…·æœ‰æ¢¯åº¦çš„å—æœ¬èº«çš„å®½åº¦ã€‚è‡ªä»æ”¾å­¦ä»¥æ¥ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ‹¿èµ·é“…ç¬”ï¼Œå›å¿†èµ·ä»£æ•°:)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰è¿™ä¸‰ä¸ªé€‰é¡¹éƒ½ä½¿ç”¨æ¸å˜ä¸­é¢œè‰²çš„å•ä¸€æè¿°ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ•°ç»„ä¸­é¢œè‰²çš„ç®€å•åˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">å®ƒä»¬åœ¨ç»™å®šæ®µä¸Šçš„åˆ†å¸ƒå°†æ˜¯å‡åŒ€çš„ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä½¿ç”¨Stopå…ƒç´ æ•°ç»„æ¥ä¼˜åŒ–åˆ†å¸ƒã€‚</font><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œè¿™æ˜¯ç›¸åŒçš„é¢œè‰²æšä¸¾ï¼Œåªæ˜¯é’ˆå¯¹æ¯ç§é¢œè‰²ï¼Œè¿˜æŒ‡ç¤ºäº†å°†è¦å®šä½çš„å•ä¸ªçº¿æ®µä¸Šçš„åæ ‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæˆ‘åˆ›é€ äº†ä¸åŸå§‹æ¦‚å¿µå¤§è‡´ç›¸åŒå½¢çŠ¶çš„æ³¢æµªã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œä»ä¸€ç§é¢œè‰²åˆ°å¦ä¸€ç§é¢œè‰²çš„è¿‡æ¸¡ç°åœ¨ä¸æ˜¯å¾ˆé”åˆ©ï¼Œè€Œæ˜¯å¹³æ»‘çš„ï¼Œè¿™å¯èƒ½ä¼šä½¿åŠ¨ç”»æ›´å¹³æ»‘ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢œè‰²ä¸æ˜¯çœ‹èµ·æ¥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰ä¸€ç‚¹ä¸é¢œè‰²æœ‰å…³ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†äº§ç”Ÿæ»šåŠ¨æ³¢çš„æ•ˆæœï¼Œæˆ‘å†³å®šä½¿é¢œè‰²ä¹‹é—´çš„è¿‡æ¸¡ä¸æ˜¯å¾ˆçº¿æ€§ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œæ‚¨ä¼šå‘ç°æ¸å˜åœ¨è¾¹ç¼˜æœ¬èº«å¤„æ›´åŠ å°–é”ï¼Œå¹¶ä¸”è·ç¦»è¾¹ç¼˜è¶Šè¿œï¼Œæ¸å˜åˆ°ä¸»è‰²ä¸­çš„å¹³æ»‘åº¦å°±è¶Šé«˜ã€‚</font></font><br>
<img src="https://habrastorage.org/webt/hb/k-/f-/hbk-f-u1tcrri8furxdgeg8tx50.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘é€šè¿‡è®¡ç®—ä¸­é—´é¢œè‰²å¹¶ä½¿ç”¨æ­¤åˆ†å¸ƒåˆ›å»ºæ¸å˜æ¥å®ç°æ­¤ç›®çš„ï¼š</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆå§‹é¢œè‰²-0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸­é—´é¢œè‰²-0.3 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€ç»ˆé¢œè‰²-1</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é—®é¢˜åœ¨äºè®¡ç®—ä¸¤ç§é¢œè‰²çš„å¹³å‡å€¼ã€‚ SwiftUIçš„æ„æ€æ˜¯å°†Colorå¯¹è±¡ç”¨äºæ¸å˜ï¼Œè¿™å¾ˆå¸å¼•æˆ‘ã€‚å®é™…ä¸Šï¼Œå¦‚æœæ‚¨è¦åƒå¤„ç†RGBå¯¹è±¡ä¸€æ ·ä½¿ç”¨é¢œè‰²ï¼Œè¯·é¦–å…ˆåœ¨æ¨¡å‹ä¸­ä½¿ç”¨UIColorï¼Œå› ä¸ºColoræ— æ³•ç›´æ¥è®¿é—®é¢œè‰²ã€‚æ‚¨ä¹Ÿä¸èƒ½è½»æ˜“å°†å…¶è½¬æ¢å›UIColorã€‚</font><font style="vertical-align: inherit;">æˆ‘åœ¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">è¿™é‡Œ</font></a><font style="vertical-align: inherit;">æ‰¾åˆ°</font><font style="vertical-align: inherit;">çš„å”¯ä¸€</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆä¸æ˜¯ï¼‰</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€‚å½“çš„è§£å†³æ–¹æ¡ˆ</font><font style="vertical-align: inherit;">æ˜¯é€šè¿‡åˆ†æå…¶å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼æ¥è·å¾—Mirroråå°„ã€‚è¿™æ ·çš„æ ·æ¿ï¼Œä½†æ²¡æœ‰å…¶ä»–é€‰æ‹©ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ä¸æ˜¯é”™è¯¯ï¼Œä¹Ÿä¸æ˜¯é—æ¼ã€‚</font><font style="vertical-align: inherit;">å…³é”®æ˜¯Colorå¯¹è±¡ä¸­çš„SwiftUIä¸ä¼šé‡å¤UIColorçš„åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨rgbé¢‘é“-è¯·ä½¿ç”¨å®ƒã€‚</font><font style="vertical-align: inherit;">SwiftUIä¸­çš„é¢œè‰²æ˜¯ä¸€ç§å…·æœ‰ä¸€äº›åŸºæœ¬é¢œè‰²çš„è§†å›¾ï¼Œå…¶ç‰¹å®šå€¼å¯èƒ½ä¼šæ ¹æ®å¤©ç©ºä¸­æ˜Ÿæ˜Ÿçš„ä½ç½®è€Œç•¥æœ‰ä¸åŒ-ç‰¹å®šçš„rgbé¢œè‰²ä»…åœ¨åœ¨å±å¹•ä¸Šç»˜åˆ¶æ—¶æ‰èƒ½ç¡®å®šã€‚</font><font style="vertical-align: inherit;">è¯¥æ–‡ä»¶è¯´</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SwiftUIä»…åœ¨å°†å…¶åœ¨ç»™å®šç¯å¢ƒä¸­ä½¿ç”¨ä¹‹å‰å°†å…¶è§£æä¸ºå…·ä½“å€¼ã€‚</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†ç¯å¢ƒçš„å«ä¹‰æ˜¯ï¼šç”¨æˆ·èƒŒåçš„å¢™é¢é¢œè‰²æˆ–iOSè®¾è®¡ä¸»é¢˜ä¸æ¸…æ¥šã€‚</font><font style="vertical-align: inherit;">å¦‚æœè¿™ä¸é€‚åˆæ‚¨ï¼Œè¯·æœ¬æœºä½¿ç”¨UIColorã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ— å°½çš„åŠ¨ç”»</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŠ¨ç”»ç”±.animationï¼ˆï¼‰ä¿®é¥°ç¬¦æŒ‡å®šï¼Œå¹¶åœ¨</font></font><code>.onAppear()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡æ›´æ”¹</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">åœ¨ä¿®é¥°ç¬¦ä¸­åˆå§‹åŒ–Viewä¹‹åå¼€å§‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç»“æœï¼Œ</font></font><code>.rotationEffect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ç³»ç»Ÿè®¡æ—¶å™¨ä¸€è‡´</font><font style="vertical-align: inherit;">ï¼Œä¿®é¥°ç¬¦</font><font style="vertical-align: inherit;">è®¢é˜…ä»â€œæ˜¯â€åˆ°â€œæˆä¸ºâ€çš„æ—¶é—´é—´éš”æ¥æ”¶animatableDataã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨æœ€åä¸€éƒ¨åˆ†è°ˆåˆ°äº†è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectObservedObject</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> angle: <span class="hljs-type">Double</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
       <span class="hljs-keyword">return</span> <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.green)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: angle))<font></font>
                .animation(<span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>))
            <span class="hljs-type">Spacer</span>()<font></font>
       }<font></font>
       .onAppear{<font></font>
            <span class="hljs-keyword">self</span>.angle += <span class="hljs-number">90</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<img src="https://habrastorage.org/webt/fl/dw/_0/fldw_0xguydvz5fe_-2tpcp3qkm.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡ä»¥è¿™ç§æ–¹å¼è¿è¡Œæ— å°½çš„åŠ¨ç”»ï¼Œæ‚¨åº”è¯¥ç†è§£ï¼Œéšåå¯¹åŠ¨ç”»ä¿®æ”¹å™¨æ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½ä¼šâ€œç ´åâ€å®ƒã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå¦‚æœç”±äºæŸç§åŸå› åœ¨å¯åŠ¨åå°†angleçš„å€¼æ›´æ”¹ä¸º0ï¼Œåˆ™ä¼šå¾—åˆ°ä»¥ä¸‹æ•ˆæœï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ad/vi/iv/adviivgxhwuw0rwwv1itknh2kie.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯ä»ä¸€ç§åŠ¨ç”»è¿‡æ¸¡åˆ°å¦ä¸€ç§åŠ¨ç”»çš„åŠ¨ç”»æœºåˆ¶ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå½“Viewç¬¬ä¸€æ¬¡å‡ºç°åœ¨å±å¹•ä¸Šæ—¶ï¼Œæˆ‘ä»¬å¼€å§‹äº†ä»0åˆ°90çš„åŠ¨ç”»è¿‡æ¸¡ã€‚è¯¥Viewå®é™…ä¸Šä»…å­˜å‚¨æœ€ç»ˆå€¼90ï¼Œè€ŒåŸå§‹å€¼0åˆ™ä¸å­˜å‚¨åœ¨ä»»ä½•åœ°æ–¹ã€‚åŠ¨ç”»å¼•æ“çŸ¥é“åŠ¨ç”»çš„å½“å‰æ—¶é—´ä½ç½®ä»¥åŠAnimatableDataçš„å½“å‰å€¼ã€‚åœ¨æ—¶é—´ç‚¹0.5ï¼Œå®ƒå°†æ˜¯45ã€‚å¦‚æœæ­¤æ—¶ç”¨æˆ·å°†å€¼æ›´æ”¹ä¸º0ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç­”æ¡ˆï¼šå°†å€¼ä»45æ›´æ”¹ä¸º0çš„åŠ¨ç”»å°†å¼€å§‹ï¼Œæ‰€æœ‰å†…å®¹ä»ç„¶å¾ªç¯æ’­æ”¾ã€‚ä½†ä»…åœ¨è§†è§‰ä¸Šï¼Œè¯¥å¾ªç¯ä¸æ˜¯å°é—­çš„ï¼Œè€Œæ˜¯ç ´è£‚çš„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦å¤–ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœæ‚¨çš„è§†å›¾ä½¿ç”¨@ObservedObjectæˆ–å…¶ä»–å¯¼è‡´è§†å›¾é‡æ–°æ¸²æŸ“çš„å‚æ•°ï¼ŒåŠ¨ç”»ä¹Ÿä¼šâ€œä¸­æ–­â€ã€‚è‹¥è¦è§£å†³æ­¤é—®é¢˜ï¼Œ.animationä¿®é¥°ç¬¦å…·æœ‰ä¸€ä¸ª.animationï¼ˆï¼švalue :)å‚æ•°ã€‚åœ¨æ­¤ä¼ é€’å€¼æ—¶ï¼Œæˆ‘ä»¬æŒ‡ç¤ºæ¸²æŸ“å™¨ä»…å½“æ­¤å€¼æ›´æ”¹æ—¶æ‰éœ€è¦é‡æ–°å¯åŠ¨åŠ¨ç”»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬å¼„æ¸…æ¥šå¦‚æœä¸å†éœ€è¦åŠ¨ç”»æ—¶å¦‚ä½•åœæ­¢åŠ¨ç”»ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦æä¾›ä¸¤ä»¶äº‹ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¿…é¡»å‘Šè¯‰SwiftUIä¸å†éœ€è¦æ— å°½çš„åŠ¨ç”»ï¼Œè€Œç”¨é€šå¸¸çš„æœ€ç»ˆåŠ¨ç”»ä»£æ›¿ã€‚ä½†è¿™è¿˜ä¸å¤Ÿã€‚ .animationï¼ˆï¼‰ä¿®é¥°ç¬¦æ˜¯æœ‰å…³è¦ä½¿ç”¨çš„è®¡æ—¶çš„æŒ‡ä»¤ï¼Œä½†æ˜¯æ—‹è½¬æœ¬èº«åœ¨.rotationEffectï¼ˆï¼‰ä¿®é¥°ç¬¦å†…éƒ¨è¿›è¡Œäº†æè¿°ï¼Œå¹¶ä¸”å®ƒå·²ç»è¢«è®¡æ—¶å™¨æ¥æ”¶ä»¥æ¥æ”¶æ–°çš„æ—‹è½¬è§’åº¦å€¼ã€‚è¦åœæ­¢æ—‹è½¬ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ›´æ”¹å…¶å€¼ã€‚</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectStopButton</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> angle: <span class="hljs-type">Double</span> = <span class="hljs-number">0</span>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> animation = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.green)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: angle))<font></font>
                .animation(animation)<font></font>
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Text</span>(<span class="hljs-string">"toggle Animation"</span>).onTapGesture {
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.angle == <span class="hljs-number">90</span>{
                    <span class="hljs-keyword">self</span>.angle = <span class="hljs-number">0</span>
                    <span class="hljs-keyword">self</span>.animation = .<span class="hljs-keyword">default</span>
                }<span class="hljs-keyword">else</span>{
                    <span class="hljs-keyword">self</span>.angle = <span class="hljs-number">90</span>
                    <span class="hljs-keyword">self</span>.animation = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
        .onAppear{<font></font>
            <span class="hljs-keyword">self</span>.angle = <span class="hljs-number">90</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<img src="https://habrastorage.org/webt/-o/-d/ui/-o-dui_0ep12qm5zwovo2iedvjm.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å’Œä»¥å‰ä¸€æ ·ï¼Œæ›´æ”¹è§’åº¦å€¼ä¼šå¯¼è‡´ä¸€ä¸ªæ–°åŠ¨ç”»çš„å¼€å§‹ï¼ˆçœ‹ä¸Šå»å¾ˆç³Ÿï¼‰ï¼Œè¿™ä¸ªå˜åŒ–ä¹Ÿå°†è¢«åŠ¨ç”»åŒ–ï¼Œä½†æ˜¯ç°åœ¨æ˜¯æ­£å¸¸åŠ¨ç”»çš„æ—¶é—´ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ–¹å—ä¸ä¼šç«‹å³åœæ­¢æ—‹è½¬ï¼Œè€Œæ˜¯å¥½åƒå˜æ…¢äº†ä¸€æ ·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨å°†æ‰€æœ‰åŠŸèƒ½æš‚åœ</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨on / offç±»å‹çš„</font><font style="vertical-align: inherit;">ä¸€ä¸ª</font><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">ä¸Šï¼Œåˆ™å¯ä»¥æ›´ç®€æ´åœ°ç¼–å†™ç›¸åŒçš„ä»£ç </font><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectStopButton</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> isStarted = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">let</span> animation = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.green)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: isStarted ? <span class="hljs-number">90</span> : <span class="hljs-number">0</span>))<font></font>
                .animation(isStarted ? animation : .<span class="hljs-keyword">default</span>)
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Text</span>(<span class="hljs-string">"toggle Animation"</span>).onTapGesture {
                <span class="hljs-keyword">self</span>.isStarted.toggle()<font></font>
            }<font></font>
        }<font></font>
        .onAppear{<font></font>
            <span class="hljs-keyword">self</span>.isStarted.toggle()<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½ç›¸å¯¹å®¹æ˜“ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„æ‰€æœ‰äº‹ä»¶éƒ½æ˜¯åœ¨è§†å›¾å†…éƒ¨ç”Ÿæˆçš„ã€‚</font></font><code>.onAppear{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒç”±ç³»ç»Ÿè°ƒç”¨</font></font><code>onTapGesture{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå½“ç„¶ä¹Ÿç”±ç”¨æˆ·</font><font style="vertical-align: inherit;">è°ƒç”¨</font><font style="vertical-align: inherit;">ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦å°†æ•´ä¸ªåŠ¨ç”»å°è£…åœ¨ä¸€ä¸ªViewä¸­ï¼Œä»…å°†å…¶ä¼ é€’/ä¼ é€’ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ SwiftUIå¹¶ä¸æš—ç¤ºçˆ¶è§†å›¾ä¸­å¯èƒ½å­˜åœ¨ä»»ä½•çˆ¶æ–¹æ³•ã€‚ä»ç†è®ºä¸Šè®²ï¼Œæ‚¨å¯ä»¥å°†å­è§†å›¾å­˜å‚¨ä¸ºç»“æ„å¹¶è°ƒç”¨å…¶å˜å¼‚æ–¹æ³•ï¼Œä½†æ˜¯</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ— æ³•ä»¥è¿™ç§æ–¹å¼æ›´æ”¹å­è§†å›¾çš„å˜é‡ï¼Œæˆ‘å°è¯•è¿‡-å®ƒä¸èµ·ä½œç”¨ã€‚åƒåœ¨æœ¬æ–‡ä¸­ä¸€æ ·ï¼Œæ‰§è¡Œæ­¤æ“ä½œçš„å”¯ä¸€æ–¹æ³•æ˜¯ä½¿ç”¨Combineçš„PassthroughSubjectã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œä¸€åˆ‡éƒ½ç®€å•å¾—å¤šã€‚å¦‚æœæ¸…æ¥šåœ°æ”¾åœ¨å¤´ä¸Šçš„æ¶å­ä¸Šï¼Œé‚£</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™æ˜¯Viewçš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œä¸æ˜¯è¯•å›¾ä»å¤–éƒ¨æ“çºµå®ƒï¼Œæ­£ç¡®çš„è§£å†³æ–¹æ¡ˆå°†éå¸¸ç®€å•ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectStopButtonFromOutside</span>: <span class="hljs-title">View</span></span>{
    <span class="hljs-keyword">var</span> isStarted: <span class="hljs-type">Bool</span>
    <span class="hljs-keyword">let</span> animation = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Spacer</span>()
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.green)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: isStarted ? <span class="hljs-number">90</span> : <span class="hljs-number">0</span>))<font></font>
                .animation(isStarted ? animation : .<span class="hljs-keyword">default</span>)
            <span class="hljs-type">Spacer</span>()<font></font>
        }<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectParentView</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> isOn = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">VStack</span>{
            <span class="hljs-type">AnimatedRectStopButtonFromOutside</span>(isStarted: isOn)
            <span class="hljs-type">Text</span>(<span class="hljs-string">"toggle Animation"</span>).onTapGesture {
                <span class="hljs-keyword">self</span>.isOn.toggle()<font></font>
            }<font></font>
        }.onAppear(){<font></font>
            <span class="hljs-keyword">self</span>.isOn = <span class="hljs-literal">true</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¢é˜…å³å¯æ›´æ–°å­è§†å›¾å†…çš„è§†å›¾-å½“å…¶å¤–éƒ¨å‚æ•°æ›´æ”¹æ—¶ï¼Œå®ƒå·²ç»ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œäº†æ›´æ–°ã€‚</font><font style="vertical-align: inherit;">æœ‰æ—¶ä¸æ–¹ä¾¿ã€‚</font><font style="vertical-align: inherit;">æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³å†æ¬¡åˆå§‹åŒ–å­è§†å›¾-ä¾‹å¦‚ï¼Œä¸ºäº†ä¸ç ´ååŠ¨ç”»ï¼Œæˆ–è€…åœ¨initï¼ˆï¼‰ä¸­ä¼šå‘ç”Ÿä¸€äº›å¤æ‚ä¸”å ç”¨å¤§é‡èµ„æºçš„è®¡ç®—ï¼ˆä¾‹å¦‚æŸ¥è¯¢ï¼‰ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæœ€å¥½ä½¿ç”¨å¯¹è±¡å®ä½“ï¼Œå¯ä»¥ä½¿ç”¨onReceiveä¿®é¥°ç¬¦ç›‘è§†å¯¹è±¡çš„æ›´æ”¹ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è§†å›¾æ›´æ–°æœŸé—´ä¿®æ”¹çŠ¶æ€</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜æœ‰å¦ä¸€ä»¶äº‹å€¼å¾—æŠ¥é“ã€‚æˆ‘ä»¬ä»…ä½¿ç”¨0å’Œ90åº¦è¿™ä¸¤ä¸ªå€¼è¿›è¡Œè¿ç®—ã€‚å…³é—­åŠ¨ç”»ä¼šå°†è§’åº¦é‡ç½®ä¸º0ã€‚ä½†æ˜¯æ˜¯å¦å¯ä»¥åœ¨æˆ‘ä»¬å•å‡»æŒ‰é’®æ—¶ç«‹å³æš‚åœåŠ¨ç”»ï¼Œå¹¶åœ¨æ¢å¤æ—¶ä»åŒä¸€ä½ç½®å†æ¬¡ç»§ç»­åŠ¨ç”»ï¼Ÿè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å…è®¸è¿™æ ·åšçš„ä»£ç ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRect</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> startTime: <span class="hljs-type">Date</span> = <span class="hljs-type">Date</span>()<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> angle: <span class="hljs-type">Double</span> = <span class="hljs-number">0</span>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> internalStarted: <span class="hljs-type">Bool</span>
    <span class="hljs-keyword">let</span> externalStarted = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">var</span> animation: <span class="hljs-type">Animation</span> = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-keyword">init</span>(started externalStarted: <span class="hljs-type">Bool</span>){
        <span class="hljs-keyword">self</span>.externalStarted = externalStarted
        <span class="hljs-keyword">self</span>._internalStarted = <span class="hljs-type">State</span>(initialValue: !externalStarted)<span class="hljs-comment">//forse to start animation</span><font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-comment">//thats wrong. It just hiding a problem from SwiftUI not solving it</span>
        <span class="hljs-type">DispatchQueue</span>.main.async {
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.internalStarted &amp;&amp; <span class="hljs-keyword">self</span>.externalStarted == <span class="hljs-literal">false</span>{
                <span class="hljs-comment">// print("stop animation")</span>
                 <span class="hljs-keyword">let</span> timePassed = <span class="hljs-type">Date</span>().timeIntervalSince(<span class="hljs-keyword">self</span>.startTime)
                 <span class="hljs-keyword">let</span> fullSecondsPassed = <span class="hljs-type">Double</span>(<span class="hljs-type">Int</span>(timePassed))
                 <span class="hljs-keyword">let</span> currentStage = timePassed - fullSecondsPassed
                 <span class="hljs-keyword">self</span>.internalStarted = <span class="hljs-literal">false</span>
                 <span class="hljs-keyword">let</span> newAngle = <span class="hljs-keyword">self</span>.angle - <span class="hljs-number">90</span> + currentStage * <span class="hljs-number">90</span>
                 <span class="hljs-keyword">self</span>.angle = newAngle<font></font>
            }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.internalStarted == <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">self</span>.externalStarted {
             <span class="hljs-comment">//    print("start animation")</span>
                 <span class="hljs-keyword">self</span>.startTime = <span class="hljs-type">Date</span>()
                 <span class="hljs-keyword">self</span>.internalStarted = <span class="hljs-literal">true</span>
                 <span class="hljs-keyword">self</span>.angle += <span class="hljs-number">90</span><font></font>
             }<font></font>
       }<font></font>
         <font></font>
       <span class="hljs-keyword">return</span>  <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.red)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: angle))<font></font>
                .animation(internalStarted ? animation : .<span class="hljs-keyword">default</span>)
            <span class="hljs-type">Spacer</span>()<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<img src="https://habrastorage.org/webt/e9/ci/ge/e9cigegcoxid1l9skuw2qxle238.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸»è¦æ€æƒ³æ˜¯åœ¨åŠ¨ç”»å¼€å§‹æ—¶è·Ÿè¸ªæ—¶é—´ã€‚ä¸€æ®µæ—¶é—´åï¼Œå½“æˆ‘ä»¬å†³å®šåœæ­¢åŠ¨ç”»æ’­æ”¾æ—¶ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿæ£€æŸ¥ç»è¿‡äº†å¤šå°‘ä¸ªå®Œæ•´çš„åŠ¨ç”»æ’­æ”¾å‘¨æœŸï¼Œå¹¶çŒœæµ‹å½“å‰æ‰€çœ‹åˆ°çš„æ­£æ–¹å½¢æ—‹è½¬è§’åº¦ã€‚ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ç²¾ç¡®</font><font style="vertical-align: inherit;">åˆ†é…ç»™</font><font style="vertical-align: inherit;">æ—‹è½¬è§’åº¦å˜é‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ä½¿è¿™ç§æ–¹æ³•èµ·ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦è·Ÿè¸ªåŠ¨ç”»çš„å¼€å§‹å’Œç»“æŸã€‚åˆå§‹åŒ–ï¼ˆï¼‰å°†ä¸èµ·ä½œç”¨ã€‚æˆ‘ä»¬æ— æ³•è®¿é—®ç°æœ‰</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°æ¥è·å–åŠ¨ç”»çš„å…ˆå‰å¼€å§‹æ—¶é—´ã€‚è¿™æ˜¯</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">çš„æ ‡è®°</font><font style="vertical-align: inherit;">ã€‚åœ¨initå†…ï¼Œæ‚¨åªèƒ½è®¾ç½®æ­¤å˜é‡çš„åˆå§‹çŠ¶æ€ï¼Œä½†æ˜¯åœ¨åˆå§‹åŒ–ç»“æŸæ—¶ï¼Œå¦‚æœåœ¨initï¼ˆï¼‰ä¹‹å‰å·²ç»å­˜åœ¨Viewï¼Œ</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ™å°†æ¢å¤å˜é‡</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œè¿™é‡Œå®ç°äº†let externalStartedå‚æ•°ï¼ˆç”±å¤–éƒ¨æ§åˆ¶ï¼‰å’Œå†…éƒ¨å‚æ•°</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var internalStartedï¼Œé€šè¿‡å®ƒä»¬æˆ‘ä»¬å¯ä»¥ç›´æ¥æ§åˆ¶åŠ¨ç”»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»…ç¼ºå°‘ä¸€ä¸ª-æŸäº›ä¿®æ”¹å™¨å°†æ£€æŸ¥å…¶ç¬¦åˆæ€§å¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œæ›´æ–°ï¼Œä¾‹å¦‚.onRecieveï¼ˆï¼‰ï¼Œä»…ç”¨äºå¤„ç†æ¯ä¸ªæ¸²æŸ“ã€‚</font><font style="vertical-align: inherit;">ç„¶åæˆ‘æƒ³-æ¯•ç«Ÿï¼Œæ¯å¼ å›¾çº¸éƒ½è¦è°ƒç”¨ä¸»ä½“ï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨å›¾çº¸ä¸­è¿›è¡Œæ£€æŸ¥å‘¢ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº‹å®è¯æ˜ï¼ŒSwiftUIå‘èª“ï¼Œå¦‚æœåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­Viewæ›´æ”¹äº†</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">ï¼Œå®ƒä¼šç»™å‡º</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è§†å›¾æ›´æ–°æœŸé—´ä¿®æ”¹çŠ¶æ€ï¼Œè¿™å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶é˜»æ­¢è¿™ç§å˜åŒ–ã€‚ç„¶åæˆ‘å»äº†ä¸€ä¸ªè‚®è„çš„é»‘å®¢ï¼Œå¹¶ä½¿ç”¨DispatchQueue.main.asyncã€‚ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ä¸ªè‚®è„çš„hackï¼Œä¸ºä»€ä¹ˆä¸åº”è¯¥è¿™æ ·åšå‘¢ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å®é™…ä¸Šæ˜¯é—®é¢˜æ‰€åœ¨ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä½“å†…å†™ä¸€äº›æ˜æ˜¾çš„æ„šè ¢ï¼Œä¾‹å¦‚i + = 1ï¼Œé‚£ä¹ˆæˆ‘å°±æ˜¯æŸç§</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ— é™å¾ªç¯ã€‚åœ¨æ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬ä½¿å†…å­˜ä¸­çš„è§†å›¾ä¸ç›¸å…³-å› ä¸ºæˆ‘ä»¬æ›´æ”¹äº†è¦æ¸²æŸ“çš„åˆå§‹æ•°æ®ã€‚è¿™æ„å‘³ç€æ¸²æŸ“å®Œæˆåï¼Œæˆ‘ä»¬çš„è§†å›¾å°†ç«‹å³æ’é˜Ÿç­‰å¾…é‡æ–°æ¸²æŸ“ï¼Œä½†æ˜¯å³ä½¿é‚£æ ·æˆ‘ä»¬ä¹Ÿå°†ç«‹å³ä½¿å…¶ä¸å†ç›¸å…³ã€‚æˆ‘ä»¬ç”¨è‡ªå·±çš„åŒæ‰‹åˆ›é€ ä¸€ä¸ªæ— å°½çš„å¾ªç¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼‚æ­¥è°ƒç”¨ä¸ä¼šæ›´æ”¹ä»»ä½•å†…å®¹ã€‚å®ƒä»…å°†ä¸‹ä¸€è½®çš„å¼€å§‹ç¨å¾®ç§»è‡³â€œæ¸²æŸ“åç«‹å³â€ã€‚å› æ­¤ï¼Œå¼‚æ­¥è°ƒç”¨ä¸èƒ½è§£å†³é—®é¢˜ï¼Œè€Œåªèƒ½æ©é¥°å®ƒï¼Œä»è€Œé˜»æ­¢SwiftUIç”¨é¼»å­æˆ³æˆ‘ä»¬ã€‚å°±åƒåœ¨æ±½è½¦ä¸Šï¼Œâ€œæ£€æŸ¥å¼•æ“â€ç¯æ³¡è¢«æ’•æ‰äº†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€æ–¹é¢ï¼Œè¿™æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿåœ¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¦‚æœæ‚¨ä¸äº†è§£è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œéƒ½æœ‰æ— æ•°ç§æ–¹æ³•å¯ä»¥ä½¿è‡ªå·±é™·å…¥å›°å¢ƒã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œè¿™ç§æ–¹æ³•æ ¹æœ¬ä¸æ˜¯SwiftUIåº”è¯¥å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨è¿è¡Œæ—¶ä½¿ç”¨Viewæ˜¯ä¸å¥½çš„ã€‚æ˜¯çš„ï¼Œæ‚¨å¯ä»¥åœ¨èƒ¸å‰beatè„šï¼Œç¡®ä¿å§‹ç»ˆç¼–å†™æ­£ç¡®çš„ä»£ç ï¼Œè€Œè¿™äº›ä»£ç æ°¸è¿œä¸ä¼šé™·å…¥æ— ä¼‘æ­¢çš„å¾ªç¯ä¸­â€¦â€¦ä½†è¿™å°±åƒå¯¹é€‰é¡¹çš„ä¸å®‰å…¨æ£€ç´¢ä¸€æ ·ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘æ‰€è¯´ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨Combineï¼Œå¹¶ä½¿ç”¨PassthroughSubjectä¼ é€’æ–°å€¼ã€‚ä½†æ˜¯æ‚¨å¯ä»¥é€šè¿‡è®¢é˜…å®ƒçš„willChangeäº‹ä»¶æ¥ä½¿ç”¨é€šå¸¸çš„ObservableObjectã€‚</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AnimatedRectObservedObject</span>: <span class="hljs-title">View</span></span>{<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> startTime: <span class="hljs-type">Date</span> = <span class="hljs-type">Date</span>()<font></font>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> angle: <span class="hljs-type">Double</span> = <span class="hljs-number">0</span>
    @<span class="hljs-type">ObservedObject</span> <span class="hljs-keyword">var</span> animationHandler: <span class="hljs-type">AnimationHandlerTest</span>
    <span class="hljs-keyword">let</span> animation: <span class="hljs-type">Animation</span> = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-keyword">init</span>(animationHandler: <span class="hljs-type">AnimationHandlerTest</span>){
        <span class="hljs-keyword">self</span>.animationHandler = animationHandler<font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">VStack</span>{
            <span class="hljs-type">Rectangle</span>()<font></font>
                .fill(<span class="hljs-type">Color</span>.green)<font></font>
                .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">200</span>)<font></font>
                .rotationEffect(<span class="hljs-type">Angle</span>(degrees: angle))<font></font>
                .animation(animationHandler.isStarted ? animation : .<span class="hljs-keyword">default</span>)<font></font>
       }.onReceive(animationHandler.objectWillChange){<font></font>
            <span class="hljs-keyword">let</span> newValue = <span class="hljs-keyword">self</span>.animationHandler.isStarted
            <span class="hljs-keyword">if</span> newValue == <span class="hljs-literal">false</span>{
                 <span class="hljs-keyword">let</span> timePassed = <span class="hljs-type">Date</span>().timeIntervalSince(<span class="hljs-keyword">self</span>.startTime)
                 <span class="hljs-keyword">let</span> fullSecondsPassed = <span class="hljs-type">Double</span>(<span class="hljs-type">Int</span>(timePassed))
                 <span class="hljs-keyword">let</span> currentStage = timePassed - fullSecondsPassed
                 <span class="hljs-keyword">let</span> newAngle = <span class="hljs-keyword">self</span>.angle - <span class="hljs-number">90</span> + currentStage * <span class="hljs-number">90</span>
                withAnimation(.<span class="hljs-keyword">none</span>){<span class="hljs-comment">//not working:(((</span>
                 <span class="hljs-keyword">self</span>.angle = newAngle<font></font>
                }<font></font>
            }<span class="hljs-keyword">else</span> {
                 <span class="hljs-keyword">self</span>.startTime = <span class="hljs-type">Date</span>()
                 <span class="hljs-keyword">self</span>.angle += <span class="hljs-number">90</span><font></font>
             }<font></font>
        }<font></font>
       .onAppear{<font></font>
            <span class="hljs-keyword">self</span>.angle += <span class="hljs-number">90</span>
            <span class="hljs-keyword">self</span>.startTime = <span class="hljs-type">Date</span>()<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡Œæœ‰äº‰è®®çš„ä¸€ç‚¹æ˜¯åœ¨è®¢é˜…å¯¹è±¡å°†åªè¢«æ›´æ”¹çš„é€šçŸ¥ä¸­ä½¿ç”¨å¯¹è±¡æœ¬èº«çš„å€¼ã€‚</font><font style="vertical-align: inherit;">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æˆ‘çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘å·²ç»ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ˜¾ç„¶ï¼Œé€šçŸ¥ä¼šæœ‰äº›æ»åã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æˆ‘ä¸èƒ½ä¿è¯ä¼šä¸€ç›´å¦‚æ­¤ï¼Œå› æ­¤æˆ‘å»ºè®®æ‚¨ä½¿ç”¨è‡ªåˆ¶çš„didChangeé€šçŸ¥æˆ–PassthroughSubjectï¼Œå°†æ–°å€¼ä¼ é€’ç»™å®ƒã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/ou/nd/wjoundfihtxhnar7iucx7rrkvnm.gif"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠ¨ç”»åŠ¨ç”»æ›´æ”¹</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æ‚¨åœ¨gifä¸Šçœ‹åˆ°çš„é‚£æ ·ï¼ŒåŠ¨ç”»ä¸ä¼šç«‹å³åœæ­¢ã€‚</font><font style="vertical-align: inherit;">å¥¹éœ€è¦ä¸€äº›æ—¶é—´ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯å› ä¸ºå½“æˆ‘ä»¬ä¸ºè§’åº¦åˆ†é…ä¸­é—´å€¼æ—¶ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†æŸç§åŠ¨ç”»-é»˜è®¤åŠ¨ç”»ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">.animation(animationHandler.isStarted ? animation : .<span class="hljs-keyword">default</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å¯¼è‡´å¼‚å¸¸è¡Œä¸ºã€‚</font><font style="vertical-align: inherit;">å°½ç®¡æˆ‘æ‰€æè¿°çš„ä¸€åˆ‡éƒ½ç›¸å¯¹ç®€å•ï¼Œä½†å³ä½¿åœ¨ç²—å¿ƒçš„ç¨‹åºå‘˜æ²¡æœ‰æŒ‡å‡ºä»»ä½•å†…å®¹çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä»ç„¶ä¿ç•™äº†è®¸å¤šç»†å¾®çš„äº¤äº’ä½œç”¨ï¼Œä»è€Œä½¿ç”»é¢å§‹ç»ˆçœ‹èµ·æ¥å¾ˆå¹³æ»‘ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œé»˜è®¤åŠ¨ç”»æ˜¯springã€‚</font><font style="vertical-align: inherit;">å®ƒæœ€é€‚åˆäºæ¨¡æ‹Ÿç‰©ç†å®šå¾‹ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“çŸ­çš„åŠ¨ç”»ï¼Œå¤§çº¦0.2ç§’ã€‚</font><font style="vertical-align: inherit;">å¦‚æœè¿‡æ¸¡åˆ°æ–°çŠ¶æ€çš„åŠ¨ç”»ï¼ˆç”±æˆ‘ä»¬è®¡ç®—å’ŒæŒ‡ç¤ºçš„è§’åº¦ï¼‰æ²¡æœ‰æ—¶é—´å®Œç¾åœ°é€‚åº”é»˜è®¤çš„0.2ç§’ï¼Œä»¥ä¾¿ä»å½“å‰çš„åŠ¨ç”»é€Ÿåº¦ï¼ˆä»¥ç¼“æ…¢çš„é€Ÿåº¦ï¼‰åˆ‡æ¢åˆ°å®Œå…¨åœæ­¢ï¼Œåˆ™SwiftUIæœ¬èº«å°†æ·»åŠ å¦ä¸€å¾ªç¯çš„æ— å°½åŠ¨ç”»ï¼Œä»¥åŠ é€Ÿç‰ˆæœ¬æ’­æ”¾ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/b0/so/z0b0soljlzjqudxhek_irdxgyoy.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œä¸ä½¿ç”¨é»˜è®¤åŠ¨ç”»å°±è¶³å¤Ÿäº†ã€‚</font><font style="vertical-align: inherit;">å¯¹äºåº•éƒ¨æ­£æ–¹å½¢ï¼Œæˆ‘å…³é—­äº†æ—‹è½¬åœæ­¢åŠ¨ç”»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<pre><code class="swift hljs">                
.animation(animationHandler.isStarted ? animation : <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">0</span>))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨åœæ­¢æ—¶æ›´å‡†ç¡®åœ°è®¡ç®—æ‰€éœ€çš„å‚æ•°å€¼ï¼Œä½†æ˜¯ä¸ºæ­¤ï¼Œæ‚¨ä¸ä»…éœ€è¦å¤§è‡´å‡å®šåŠ¨ç”»çš„å½“å‰æ—¶åˆ»ï¼Œè¿˜éœ€è¦ç¡®åˆ‡åœ°çŸ¥é“å®ƒã€‚</font><font style="vertical-align: inherit;">æˆ‘å°†åœ¨ä¸‹é¢æ˜¾ç¤ºå¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ä¸ªåŠ¨ç”»ä¸­å‡ æ³¢çš„è¿åŠ¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›åˆ°å½©è™¹åŠ¨ç”»ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬æœ¬èº«å°±æœ‰æ³¢æµªï¼Œè®©æˆ‘ä»¬æ•™å®ƒä»¬å‰è¿›ã€‚</font><font style="vertical-align: inherit;">æˆ‘æƒ³åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯è¿è¡Œæ— å°½çš„åŠ¨ç”»ã€‚</font><font style="vertical-align: inherit;">æˆ‘å†³å®šè¿™æ ·åšï¼šæˆ‘å°†æœ‰ä¸€ä¸ª</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡è´Ÿè´£åŠ¨ç”»çš„å½“å‰ä½ç½®ã€‚</font><font style="vertical-align: inherit;">åœ¨çŠ¶æ€0å¤„ï¼Œç¬¬ä¸€ä¸ªæ³¢æµªå°†åœ¨å¼€å§‹å¤„ï¼Œæœ€åä¸€ä¸ªæ³¢æµªå°†åœ¨æœ«ç«¯å¤„ã€‚</font><font style="vertical-align: inherit;">æ³¢æµªæœ¬èº«å°†é‡å ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæ¯ä¸ªæ³¢çš„å¯è§éƒ¨åˆ†çš„é•¿åº¦å°†å–å†³äºæ³¢çš„æ•°é‡ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä½¿ç”¨ZStackï¼ˆåˆ—å‡ºæ‰€æœ‰æ³¢å½¢ï¼‰å’Œæˆ‘è‡ªå·±çš„.wavePositionä¿®æ”¹å™¨å®ç°äº†æ­¤åŠŸèƒ½ï¼Œåœ¨å…¶ä¸­æˆ‘è®¡ç®—äº†åŠ¨ç”»æ—¶æ¯ä¸ªæ³¢å½¢çš„å½“å‰ä½ç½®ä»¥åŠå®ƒä»¬é‡å çš„é¡ºåºã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ˆå¤šä»£ç </font></font></b>
                        <div class="spoiler_text"><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SharpWavePosition</span>: <span class="hljs-title">AnimatableModifier</span> </span>{
    <span class="hljs-keyword">let</span> wave: <span class="hljs-type">WaveDescription</span>
    <span class="hljs-keyword">let</span> animationHandler: <span class="hljs-type">AnimationHandler</span>
    <span class="hljs-keyword">var</span> time: <span class="hljs-type">CGFloat</span>
    <span class="hljs-keyword">var</span> currentPosition: <span class="hljs-type">CGFloat</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> animatableData: <span class="hljs-type">CGFloat</span> {
        <span class="hljs-keyword">get</span> { time}
        <span class="hljs-keyword">set</span> {
                <span class="hljs-keyword">self</span>.time = newValue
            <span class="hljs-keyword">let</span> currentTime = newValue - <span class="hljs-type">CGFloat</span>(<span class="hljs-type">Int</span>(newValue))
            <span class="hljs-keyword">self</span>.currentPosition = <span class="hljs-type">SharpWavePosition</span>.calculate(forWave: wave.ind, ofWaves: wave.totalWavesCount, overTime: currentTime)<font></font>
        }<font></font>
    }<font></font>
    <span class="hljs-keyword">init</span>(wave: <span class="hljs-type">WaveDescription</span>, time: <span class="hljs-type">CGFloat</span>, animationHandler: <span class="hljs-type">AnimationHandler</span>){
        <span class="hljs-keyword">self</span>.wave = wave
        <span class="hljs-keyword">self</span>.time = time
        <span class="hljs-keyword">self</span>.animationHandler = animationHandler
        <span class="hljs-keyword">self</span>.currentPosition = <span class="hljs-number">0</span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">calculate</span><span class="hljs-params">(forWave: Int, ofWaves: Int, overTime: CGFloat)</span></span> -&gt; <span class="hljs-type">CGFloat</span>{<font></font>
<font></font>
        <span class="hljs-keyword">let</span> time = overTime - <span class="hljs-type">CGFloat</span>(<span class="hljs-type">Int</span>(overTime))
        <span class="hljs-keyword">let</span> oneWaveWidth = <span class="hljs-type">CGFloat</span>(<span class="hljs-number">1</span>) / <span class="hljs-type">CGFloat</span>(ofWaves)
        <span class="hljs-keyword">let</span> initialPosition = oneWaveWidth * <span class="hljs-type">CGFloat</span>(forWave)
        <span class="hljs-keyword">let</span> currentPosition = initialPosition + time
        <span class="hljs-keyword">let</span> fullRounds = <span class="hljs-type">Int</span>(currentPosition)
        <span class="hljs-keyword">var</span> result = currentPosition - <span class="hljs-type">CGFloat</span>(fullRounds)
        <span class="hljs-keyword">if</span> fullRounds &gt; <span class="hljs-number">0</span> &amp;&amp; result == <span class="hljs-number">0</span>{
            <span class="hljs-comment">// at the end of the round it should be 1, not 0</span>
            result = <span class="hljs-number">1</span><font></font>
        }<font></font>
 <span class="hljs-comment">//       print("wave \(forWave) in time \(overTime) was at position \(result)")</span>
        <span class="hljs-keyword">return</span> result<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">body</span><span class="hljs-params">(content: Content)</span></span> -&gt; some <span class="hljs-type">View</span> {
        <span class="hljs-keyword">let</span> oneWaveWidth = <span class="hljs-type">CGFloat</span>(<span class="hljs-number">1</span>) / <span class="hljs-type">CGFloat</span>(wave.totalWavesCount)
        <span class="hljs-keyword">var</span> thisIsFirstWave = <span class="hljs-literal">false</span>
        <span class="hljs-keyword">if</span> currentPosition &lt; oneWaveWidth{<font></font>
            thisIsFirstWave = <span class="hljs-literal">true</span><font></font>
        }<font></font>
        <span class="hljs-keyword">return</span>
            <span class="hljs-type">Group</span>{<font></font>
                content<font></font>
                            .offset(x: -wave.width + currentPosition * (wave.width +  wave.gradientLength),<font></font>
                            <span class="hljs-comment">//to watch how waves move uncoment this</span>
                           <span class="hljs-comment">// y: CGFloat(self.waveInd * 20))</span>
                        y:<span class="hljs-number">0</span>)<font></font>
                    .zIndex(-<span class="hljs-type">Double</span>(currentPosition))<font></font>
                    .transition(.identity)<font></font>
                    .animation(<span class="hljs-literal">nil</span>)<font></font>
<font></font>
                <span class="hljs-keyword">if</span> thisIsFirstWave{<font></font>
                    content<font></font>
                        .offset(x: wave.gradientLength, y: <span class="hljs-number">0</span>)<font></font>
                        .zIndex(-<span class="hljs-number">2</span>)<font></font>
                        .transition(.identity)<font></font>
                        .animation(<span class="hljs-literal">nil</span>)<font></font>
                }<font></font>
            }<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">View</span></span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">positionOfSharp</span><span class="hljs-params">(wave: WaveDescription, inTime: CGFloat, animationHandler: AnimationHandler)</span></span> -&gt; some <span class="hljs-type">View</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.modifier(<span class="hljs-type">SharpWavePosition</span>(wave: wave, time: inTime, animationHandler: animationHandler))<font></font>
    }<font></font>
}<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SharpRainbowView</span>: <span class="hljs-title">View</span></span>{
    <span class="hljs-keyword">let</span> waves: [<span class="hljs-type">SharpGradientBorder</span>]
    <span class="hljs-keyword">var</span> animation: <span class="hljs-type">Animation</span> = <span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">1</span>).repeatForever(autoreverses: <span class="hljs-literal">false</span>)
    <span class="hljs-comment">//@ObservedObject</span>
    <span class="hljs-keyword">var</span> animationHandler: <span class="hljs-type">AnimationHandler</span>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> rainbowPosition: <span class="hljs-type">CGFloat</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">init</span>(animationHandler: <span class="hljs-type">AnimationHandler</span>,<font></font>
        backgroundColor: <span class="hljs-type">Color</span> = .clear<font></font>
    ){<font></font>
        <span class="hljs-keyword">self</span>.animationHandler = animationHandler
        <span class="hljs-keyword">let</span> bottomRadius = animationHandler.waveGeometry.bottomRadius
        <span class="hljs-keyword">let</span> topRadius = animationHandler.waveGeometry.topRadius
        <span class="hljs-keyword">let</span> gradientLength = animationHandler.waveGeometry.gradientLength
        <span class="hljs-keyword">let</span> rainbowColors = animationHandler.rainbowColors
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">var</span> lastColor = rainbowColors.last <span class="hljs-keyword">else</span> {<span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"no colors to display in rainbow"</span>)}
        <span class="hljs-keyword">var</span> allWaves = [<span class="hljs-type">SharpGradientBorder</span>]()
        <span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> rainbowColors{
            <span class="hljs-keyword">let</span> view = <span class="hljs-type">SharpGradientBorder</span>(start: color,<font></font>
                                      end: lastColor,<font></font>
                                      bottomRadius: bottomRadius,<font></font>
                                      topRadius: topRadius,<font></font>
                                      gradientLength: gradientLength)<font></font>
            allWaves.append(view)<font></font>
            lastColor = color<font></font>
        }<font></font>
        <span class="hljs-keyword">self</span>.waves = allWaves<font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-type">GeometryReader</span>{geometry <span class="hljs-keyword">in</span>
            <span class="hljs-type">VStack</span>{
                <span class="hljs-type">ZStack</span>{
                    <span class="hljs-type">ForEach</span>(<span class="hljs-keyword">self</span>.waves.<span class="hljs-built_in">indices</span>, id: \.<span class="hljs-keyword">self</span>){ind <span class="hljs-keyword">in</span>
                        <span class="hljs-keyword">self</span>.waves[ind]<font></font>
                            .positionOfSharp(wave: <span class="hljs-type">WaveDescription</span>(ind: ind,<font></font>
                                                    totalWavesCount: <span class="hljs-keyword">self</span>.waves.<span class="hljs-built_in">count</span>,<font></font>
                                                    width: geometry.size.width,<font></font>
                                                    baseColor: <span class="hljs-keyword">self</span>.waves[ind].end,<font></font>
                                                    gradientLength: <span class="hljs-keyword">self</span>.waves[ind].bottomRadius + <span class="hljs-keyword">self</span>.waves[ind].topRadius),<font></font>
                                             inTime: <span class="hljs-keyword">self</span>.rainbowPosition,<font></font>
                                             animationHandler: <span class="hljs-keyword">self</span>.animationHandler)<font></font>
                            .animation(<span class="hljs-keyword">self</span>.animationHandler.isStarted ? <span class="hljs-keyword">self</span>.animation : .linear(duration: <span class="hljs-number">0</span>))<font></font>
                    }<font></font>
                }<font></font>
     <span class="hljs-comment">//           .clipped()</span><font></font>
            }<font></font>
<font></font>
        }<font></font>
        .onAppear(){<font></font>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.animationHandler.isStarted{
                <span class="hljs-keyword">self</span>.rainbowPosition = <span class="hljs-number">1</span><font></font>
            }<font></font>
        }<font></font>
        .onReceive(animationHandler.objectWillChange){<font></font>
             <span class="hljs-keyword">let</span> newValue = <span class="hljs-keyword">self</span>.animationHandler.isStarted
             <span class="hljs-keyword">if</span> newValue == <span class="hljs-literal">false</span>{
                <span class="hljs-keyword">let</span> newPosition = <span class="hljs-keyword">self</span>.animationHandler.currentAnimationPosition
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"animated from \(self.rainbowPosition - 1) to \(self.rainbowPosition) stopped at \(newPosition)"</span>)
                    <span class="hljs-keyword">self</span>.rainbowPosition = newPosition<font></font>
             }<span class="hljs-keyword">else</span> {
                  <span class="hljs-keyword">self</span>.rainbowPosition += <span class="hljs-number">1</span><font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}<font></font>
 </code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€æ¬¡åœ¨å±å¹•ä¸Šæ˜¾ç¤ºâ€œè§†å›¾â€æ—¶ï¼Œæˆ‘ä»¬å°†çŠ¶æ€ä»0æ›´æ”¹ä¸º1ï¼Œè¿™è€ƒè™‘åˆ°å£°æ˜çš„çº¿æ€§åŠ¨ç”»ï¼Œä½¿æ³¢æµªåœ¨å±å¹•ä¸Šæ— é™å¾ªç¯ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bg/vr/ym/bgvrymyoubpekjmpgnsrtxxgco8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æ³¢çš„è¾¹ç¼˜åˆ°è¾¾å³è¾¹ç¼˜æ—¶ï¼Œå…¶ä¸‹ä¸€ä¸ªä½ç½®å°†ä½äºå±å¹•è¾¹ç¼˜çš„æœ€å¼€å§‹ã€‚çœ‹èµ·æ¥å¥½åƒå®ƒåªæ˜¯ä»æ³¢çš„æœ«ç«¯æ¶ˆå¤±äº†ï¼Œæš´éœ²äº†æˆ‘ä»¬æƒ³é¿å…çš„èƒŒæ™¯åº•ç‰©ã€‚ä¸ºæ­¤ï¼Œåœ¨bodyï¼ˆï¼‰å‡½æ•°çš„ä¿®é¥°ç¬¦ä¸­å‡ºç°äº†if {...}å—ï¼Œå…¶ä¸­ç»˜åˆ¶äº†å±å¹•ä¸Šç¼ºå°‘çš„ç¬¬ä¸€ä¸ªwaveçš„å‰¯æœ¬ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/6m/vt/si6mvtiimlv73kxy4c4imperxc4.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯·æ³¨æ„ï¼Œæˆ‘å¿…é¡»ä»¥ä¿®æ”¹å™¨å‚æ•°çš„å½¢å¼ä¼ é€’æ¯ä¸ªæ³¢çš„å‡ ä½•ç‰¹å¾ã€‚</font><font style="vertical-align: inherit;">é—®é¢˜æ˜¯æˆ‘éœ€è¦æ ¹æ®å½“å‰åŠ¨ç”»é˜¶æ®µé‡æ–°å®šä¹‰æ¯ä¸ªæ³¢çš„zç´¢å¼•ã€‚</font><font style="vertical-align: inherit;">æˆ‘å¯ä»¥é€šè¿‡ä½¿ç”¨å†…éƒ¨çš„GeometryReader {}ä¿®é¥°ç¬¦æ¥æå–å¯è§åŒºåŸŸçš„å®½åº¦ï¼Œä½†æ˜¯ï¼Œæˆ‘é¢ä¸´è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³å®ƒä¼šé˜»æ­¢æ›´æ”¹æ³¢çš„å åŠ é¡ºåºã€‚</font><font style="vertical-align: inherit;">.zIndexï¼ˆï¼‰ä¿®é¥°ç¬¦ä»…åœ¨Viewå±‚æ¬¡ç»“æ„ä¸­çš„ç¬¬ä¸€ä¸ªZStack {}å®¹å™¨çš„ä¸Šä¸‹æ–‡ä¸­èµ·ä½œç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GeometryReaderåˆ‡æ–­äº†æ­¤è¿æ¥ï¼Œå¹¶ä¸”zIndexï¼ˆï¼‰åœæ­¢å·¥ä½œã€‚</font><font style="vertical-align: inherit;">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æœæ‚¨è®¤ä¸ºGeometryReaderæ˜¯è·å–æœ‰å…³å½“å‰Viewå¤§å°çš„æ•°æ®çš„ä¸€ç§æ— å®³æ–¹æ³•ï¼Œåˆ™å¹¶ä¸å®Œå…¨æ­£ç¡®ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµåŠ¨ç”»</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦ä¸€ä¸ªè¦ç‚¹æ˜¯äº†è§£æ‚¨è‡ªå·±çš„ä¿®æ”¹å™¨ä¸­å†…ç½®ä¿®æ”¹å™¨çš„åŠ¨ç”»ã€‚åœ¨æŸä¸ªç‚¹ï¼Œæ¯ä¸ªæ³¢éƒ½æ¥è¿‘å±å¹•è¾¹ç¼˜ï¼Œè·å¾—æœ€å¤§çš„æ°´å¹³åç§»ï¼Œç„¶ååˆ°è¾¾èµ·å§‹ä½ç½®ï¼Œè·å¾—æœ€å°çš„åç§»ã€‚æ­¤æ›´æ”¹ä¸å…¶ä»–æ›´æ”¹ç›¸åŒï¼Œå¹¶ä¸”å³ä½¿åœ¨åŠ¨ç”»å†…éƒ¨ä¹Ÿå·²è®¾ç½®åŠ¨ç”»ã€‚æ¯•ç«Ÿï¼ŒåŠ¨ç”»åªæ˜¯å°†é¢‘ç‡å€¼éå¸¸é¢‘ç¹åœ°ä¼ é€’ç»™ä¿®æ”¹å™¨ï¼Œå¹¶ä¸”æ— è®ºå®ƒå¬èµ·æ¥å¤šä¹ˆå¥‡æ€ªï¼Œå®ƒä¹Ÿå°†ä¸åŠ¨ç”»ä¸€èµ·æ‰§è¡Œã€‚äº‹å®è¯æ˜ï¼Œåœ¨åŠ¨ç”»å†…éƒ¨ï¼Œåœ¨æ­¤ä¿®é¥°ç¬¦å†…éƒ¨ä¼ é€’æ–°å€¼ï¼Œæˆ‘ä»¬ä»…æ›´æ”¹å½“å‰è¿åŠ¨åŠ¨ç”»çš„ç»ˆç‚¹ã€‚äº‹å®è¯æ˜ï¼Œæ¯æ¬¡åˆ°è¾¾å±å¹•è¾¹ç¼˜çš„æ³¢æµªéƒ½ä¼šè½¬èº«å¹¶å‘åæ¼‚æµ®ã€‚ä½†æ˜¯å®ƒä¹Ÿæ²¡æœ‰è¾¾åˆ°å¼€å§‹ï¼Œä½†æ˜¯è¿Ÿæ—©è¦èµ¶ä¸Šæ‰€éœ€çš„ä½ç½®ï¼Œç„¶åå†æ¬¡å¼€å§‹ä»å·¦å‘å³ç§»åŠ¨ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aj/xp/ky/ajxpkyp6nxn-e6ixzzrv7y-g-c4.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥é€šè¿‡æ’å…¥.animationï¼ˆnilï¼‰ä¿®é¥°ç¬¦æ¥è§£å†³æ­¤é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘å…³é—­äº†æ–‡æœ¬ä¸­ä¸Šé¢åº”ç”¨çš„æ‰€æœ‰ä¿®æ”¹å™¨çš„åŠ¨ç”»ã€‚è¿™æ˜¯ä»»ä½•ä¿®é¥°ç¬¦å·¥ä½œçš„ä¸€èˆ¬é€»è¾‘ï¼šå®ƒä¼šæ›´æ”¹å…¶è¾“å…¥ä¸Šçš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨è¾“å…¥ä¸Šæˆ‘ä»¬ä¼šè·å¾—æ‰€æœ‰å…ˆå‰ä¿®é¥°ç¬¦çš„ç»“æœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬è€Œè¨€ï¼Œä¸åŒåŠ¨ç”»çš„æ•´ä¸ªå±‚æ¬¡ç»“æ„åœ¨è¿™é‡Œèµ·ä½œç”¨ã€‚é™¤éæ‚¨ä¸ºViewå¦è¡ŒæŒ‡å®šï¼Œå¦åˆ™é»˜è®¤å€¼ä¸ºå°†ç”¨äºæ˜¾ç¤ºæ‰€æœ‰ä¿®æ”¹å™¨çš„æ›´æ”¹çš„é»˜è®¤è®¾ç½®ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹ï¼ˆå‡è®¾è¿™æ˜¯ä¸»çº¿ç¨‹ï¼‰ï¼Œåœ¨å…¶ä¸­è°ƒç”¨äº†ä¸»ä½“ã€‚æˆ‘ä»¬å‡å®šå®ƒå…·æœ‰.animationå‚æ•°ï¼Œæ¯æ¬¡ä¿®æ”¹å™¨æ”¶åˆ°æ–°å€¼æ—¶éƒ½ä¼šæ£€æŸ¥è¯¥å‚æ•°ã€‚å¦‚æœä¿®æ”¹å™¨æ”¯æŒåŠ¨ç”»ï¼ˆç¬¦åˆAnimatableModifieråè®®ï¼‰ï¼Œå¹¶ä¸”ä¸ºæµå¯ç”¨äº†åŠ¨ç”»ï¼ˆä½¿ç”¨äº†æŸäº›ç‰¹å®šçš„åŠ¨ç”»ï¼Œè€Œä¸æ˜¯.noneæˆ–nilï¼‰ï¼Œåˆ™æ›´æ”¹å°†è¢«åŠ¨ç”»åŒ–ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„å·¥ä½œï¼Œ</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨withAnimation {}å—ä¸­</font><font style="vertical-align: inherit;">åŒ…å«äº†ä¸€äº›ç”¨äºæ›´æ”¹</font><font style="vertical-align: inherit;">å‚æ•°çš„</font><font style="vertical-align: inherit;">ä»£ç </font><font style="vertical-align: inherit;">-æˆ‘ä»¬åœ¨å½“å‰çº¿ç¨‹ä¸­å¼€äº†ä¸€ä¸ªç‰¹å®šçš„åŠ¨ç”»ï¼Œç„¶åè¿›è¡ŒæŸç§æ›´æ”¹</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒwithAnimation {}æ˜¯ä¸€ç§ç­‰æ•ˆçš„äº‹åŠ¡ï¼Œå¯¹æ­¤äº‹åŠ¡æ‰€åšçš„æ‰€æœ‰æ›´æ”¹éƒ½å°†è¢«åŠ¨ç”»åŒ–ã€‚ç»“æœï¼Œåœ¨åŒä¸€ä¸ªæµä¸­ï¼Œå°†è¿™äº›æ›´æ”¹è½¬æ¢ä¸ºæ‰€æœ‰ç›¸å…³Viewçš„å‘¨æœŸå¼€å§‹ï¼Œè¿™äº›Viewçš„ä¿®é¥°ç¬¦æ¥æ”¶ä¸€ä¸ªæ–°å€¼ï¼Œå¹¶è®¢é˜…ä»¥æ¥æ”¶AnimatableDataçš„ä¸­é—´å€¼ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼ŒåŠ¨ç”»ä¸Šè¿˜æœ‰ä¸€äº›å…ƒç´ æ— æ³•å½±å“ã€‚ä¾‹å¦‚ï¼Œæ»‘å—çš„ä½ç½®æ˜¯é€šè¿‡è‡ªèº«ï¼Œå†…éƒ¨æœºåˆ¶æ¥è®¾ç½®åŠ¨ç”»çš„ï¼Œå› æ­¤æ— éœ€æ‰§è¡Œä»»ä½•æ“ä½œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼ŒwithAnimationï¼ˆï¼‰æ˜¯ä¸€ç§ä¸ºæ­£åœ¨æ‰§è¡Œçš„åŠ¨ä½œå¯åŠ¨é»˜è®¤åŠ¨ç”»çš„æ–¹æ³•ã€‚ä½†æ˜¯å¯¹äºæŸäº›è§†å›¾ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨.animationï¼ˆï¼‰ä¿®é¥°ç¬¦æ¥æ˜¾å¼æŒ‡å®šè‡ªå·±çš„åŠ¨ç”»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»„æˆä¼ é€’ç»™.animationï¼ˆï¼‰çš„å†…å®¹çš„ä¿®é¥°ç¬¦å’Œå½¢å¼ï¼ˆåº”ç”¨.animationï¼ˆï¼‰ä¹‹å‰ä»£ç ä¸­åˆ—å‡ºçš„æ‰€æœ‰å†…å®¹ï¼‰å°†æ¥æ”¶æ‚¨æè¿°çš„æ—¶é—´ï¼Œå¹¶å¿½ç•¥æµåŠ¨ç”»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘çš„WavePositionä¿®æ”¹å™¨ä¸­ï¼Œæˆ‘ä½¿ç”¨.animationï¼ˆnilï¼‰æ‘†è„±å†…ç½®åç§»åŠ¨ç”»ï¼Œä»è€ŒæŒ‡ç¤ºæˆ‘å¿½ç•¥å½“å‰çš„æµåŠ¨ç”»ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°¾ç›–ä¹Ÿä¸€æ ·ã€‚è®©æˆ‘æé†’æ‚¨ä¸Šä¸€ç¯‡æ–‡ç« çš„ç»“è®ºã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„å†…å­˜ä¸­æœ‰Nä¸ªWavePositionä¿®æ”¹å™¨ç»“æ„ï¼Œæ¯ä¸ªæ³¢å½¢ä¸€ä¸ªã€‚å®ƒä»¬éƒ½ä»ç³»ç»Ÿè®¡æ—¶å™¨ä¸­è·å¾—æ–°çš„ä½ç½®å€¼ï¼Œä»è€Œè®¡ç®—å‡ºæ¯ä¸ªæ³¢åœ¨ç»™å®šæ—¶é—´ç‚¹çš„ä½ç½®ã€‚è¿™æ„å‘³ç€æ¯ä¸ªæ³¢æˆ‘ä»¬ä¹Ÿæœ‰Nä¸ªç«¯ç›–ã€‚å¤šäºäº†if {}å—ï¼Œåœ¨ä»»ä½•ç»™å®šæ—¶é—´ä»…æ˜¾ç¤ºäº†å…¶ä¸­ä¸€ä¸ªã€‚ä½†æ˜¯ï¼ŒåŒä¸€è¡—åŒºç»™æˆ‘ä»¬æ”¾äº†ä¸€å¤´çŒªã€‚è§†å›¾çš„æ¶ˆå¤±å’Œå¤–è§‚ä¹Ÿä¸æµçš„åŠ¨ç”»ä¸€èµ·æ‰§è¡Œã€‚è¿™æ„å‘³ç€.transitionä¿®é¥°ç¬¦ç”¨äºåœ¨æ›´æ”¹æ¡ä»¶åä¸ºè§†å›¾çš„å¤–è§‚å’Œæ¶ˆå¤±è®¾ç½®åŠ¨ç”»ã€‚é€šå¸¸ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨.opacityï¼Œä½†æ˜¯å‡ºäºæŸç§åŸå› ï¼Œæˆ‘ä½¿ç”¨.slideä»£æ›¿ã€‚éƒ½ä¸é€‚åˆæˆ‘ï¼Œæ‰€ä»¥æˆ‘åªæ˜¯å–æ¶ˆäº†è¿™ä¸ªåŠ¨ç”»ï¼Œä½¿ç”¨.transitionï¼ˆ.identityï¼‰ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°ã€‚</font><font style="vertical-align: inherit;">åœ¨å‡†å¤‡æœ¬æ–‡æ—¶ï¼ŒXcode 11.4å‡ºç°äº†ï¼Œå…¶ä¸­ä¼¼ä¹é»˜è®¤æƒ…å†µä¸‹å¯¹è¿‡æ¸¡è¿›è¡Œäº†é‡æ–°è®¾è®¡ã€‚</font><font style="vertical-align: inherit;">è‡³å°‘ç°åœ¨æˆ‘æ³¨é‡Šæ‰.transitionï¼ˆ.identityï¼‰æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰æ”¶åˆ°å¯¼è‡´æˆ‘æ·»åŠ å®ƒçš„é—®é¢˜ã€‚</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠ¨ç”»æ—¶é—´</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬ç»ˆäºå¾—å‡ºäº†ä¸€ä¸ªæœ€æœ‰è¶£çš„é—®é¢˜ï¼šå¦‚ä½•ä½¿æµ·æµªåŠ é€Ÿè¿åŠ¨ï¼Ÿ</font><font style="vertical-align: inherit;">å’Œå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä¼šä»å¾ˆè¿œçš„åœ°æ–¹æ¥ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼ŒåŠ¨ç”»æ˜¯å¯¹ç»™å®šåŠ¨ç”»é€Ÿåº¦çš„æè¿°ã€‚æˆ‘ä»¬å¯ä»¥ç¡®å®šä¿®æ”¹å™¨æœ¬èº«å†…éƒ¨ä»Aç‚¹åˆ°Bç‚¹çš„è·¯çº¿ï¼Œä½†æ˜¯SwiftUIå†³å®šä½•æ—¶ä»¥åŠå°†å“ªç§AnimatableDataå€¼ä¼ é€’ç»™å®ƒã€‚ä»–ç”¨æ—¶é—´æ›²çº¿æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å‡è®¾æˆ‘ä»¬ä»¥Aç‚¹ä¸ºåŸç‚¹ï¼Œå¹¶ä»¥Bç‚¹ä¸ºåæ ‡ï¼ˆ1; 1ï¼‰ã€‚åœ¨æ°´å¹³æ–¹å‘ä¸Šï¼Œæˆ‘ä»¬å°†æ ‡è®°ç»è¿‡çš„æ—¶é—´ï¼ˆä»Aç‚¹åˆ°Bç‚¹çš„è¿åŠ¨æ°å¥½å ç”¨1ä¸ªæ—¶é—´å•ä½ï¼‰ã€‚å‚ç›´-è¡Œè¿›çš„è·ç¦»ï¼Œå•ä½ä¸ºåˆ†æ•°ã€‚å½“ä½¿ç”¨çº¿æ€§åŠ¨ç”»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬æƒ³ä½¿è¿åŠ¨æœ‰ç‚¹ç±»ä¼¼äºç°åœ¨ï¼Œé‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬éœ€è¦èŠ±ä¸€ç‚¹æ—¶é—´åœ¨åŠ é€Ÿä¸Šï¼Œæœ€åèŠ±äº›æ—¶é—´åœ¨åˆ¹è½¦ä¸Šã€‚å°±</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯ä»¥é€šè¿‡ç»˜åˆ¶è‡ªå·±çš„æ›²çº¿å¹¶å°†å…¶è¿åŠ¨åŠ¨ç”»ä¸æ ‡å‡†æ›²çº¿è¿›è¡Œæ¯”è¾ƒæ¥ä½¿ç”¨ä¸åŒçš„é€‰é¡¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨SwiftUIä¸­ï¼Œè´å¡å°”æ›²çº¿ç”¨äºå„ç§ç±»å‹çš„åŠ¨ç”»ã€‚</font><font style="vertical-align: inherit;">æ— è®ºå¦‚ä½•ï¼Œå®ƒéƒ½åº”ä»ï¼ˆ0; 0ï¼‰å¼€å§‹ï¼Œåˆ°ï¼ˆ1; 1ï¼‰ç»“æŸã€‚</font><font style="vertical-align: inherit;">çº¿çš„æ›²ç‡ç”±æ§åˆ¶ç‚¹ç¡®å®šã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çº¿æ€§æ— å°½åŠ¨ç”»ä¸­çš„åµŒå¥—æ—¶åºæ›²çº¿</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‚£ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦åšäº›ä»€ä¹ˆæ¥å®ç°çº¿æ€§å¾ªç¯åŠ¨ç”»ä¸­æ¯ä¸ªæ³¢ï¼ˆeaseInï¼‰çš„åŠ é€Ÿè¿åŠ¨ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘èƒ½æƒ³åˆ°çš„æœ€ç»†åˆ†çš„é€‰é¡¹æ˜¯å®ç°è‡ªå·±çš„æ—¶åºæ›²çº¿ï¼Œå¹¶å°†çº¿æ€§çš„æ—¶é—´æµè½¬æ¢ä¸º.easeInã€‚</font><font style="vertical-align: inherit;">é€šè¿‡æ­¤ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥å¾ˆå¥½åœ°ç†è§£å…¶å·¥ä½œåŸç†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ã€‚æˆ‘ä»¬å°†åŸºäºè·¯å¾„-è´å¡å°”æ›²çº¿åˆ›å»ºè‡ªå·±çš„ç±»ï¼Œé€šè¿‡è¯¥æ›²çº¿æˆ‘ä»¬å°†ç¡®å®šä»Aç‚¹åˆ°Bç‚¹çš„è·ç¦»ï¼Œéœ€è¦åœ¨æ¯ä¸ªç‰¹å®šæ—¶é—´ç‚¹æ˜¾ç¤ºè¯¥è·ç¦»ã€‚å®é™…ä¸Šï¼Œè¿™æ­£æ˜¯åŠ¨ç”»åœ¨SwiftUIå’Œä»»ä½•å…¶ä»–å…·æœ‰ç±»ä¼¼åŠŸèƒ½çš„æ¡†æ¶ä¸­çš„å·¥ä½œæ–¹å¼ã€‚å€ŸåŠ©æ—¶åºæ›²çº¿ï¼Œå°†å®é™…çš„ç§’å’Œæ¯«ç§’ï¼ˆå°½ç®¡æœ€å¸¸è§çš„æ˜¯çº¿æ€§æµåŠ¨çš„ï¼‰è½¬æ¢ä¸ºè·ç¦»çš„åˆ†æ•°ï¼ˆæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯åŠ¨ç”»ç‰‡æ®µçš„åˆ†æ•°-AnimatableDataçŸ¢é‡ï¼Œå®ƒè¡¨ç¤ºæ‰€åšçš„æ›´æ”¹ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå®ç°ï¼š</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getActualPosition</span><span class="hljs-params">(of position: CGFloat)</span></span> -&gt; <span class="hljs-type">CGFloat</span>{
        <span class="hljs-keyword">let</span> correctPosition = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">min</span>(position, <span class="hljs-number">1</span>), <span class="hljs-number">0</span>) / duration
        <span class="hljs-keyword">let</span> trimmingCurve = <span class="hljs-type">TimingCurve</span>.superEaseInPath
        <span class="hljs-keyword">if</span> correctPosition &lt; <span class="hljs-number">0.0000001</span>{
            <span class="hljs-keyword">let</span> reversedCurve = <span class="hljs-type">Path</span>(<span class="hljs-type">UIBezierPath</span>(cgPath: trimmingCurve.cgPath).reversing().cgPath)
            <span class="hljs-comment">//trim to start point is impossible, so reverce the curve and get last point</span>
            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> point = reversedCurve.currentPoint <span class="hljs-keyword">else</span>{<span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"cant get current timing curve start point"</span>)}
            <span class="hljs-keyword">return</span> point.y<font></font>
        }<font></font>
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> point = trimmingCurve.trimmedPath(from: <span class="hljs-number">0</span>, to: correctPosition).currentPoint <span class="hljs-keyword">else</span>{<span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"cant get current timing curve point at \(position)"</span>)}
        <span class="hljs-keyword">return</span> point.y * <span class="hljs-keyword">self</span>.duration<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¾ç„¶ï¼Œæˆ‘æœ‰ç‚¹æ„šè ¢ã€‚æ ¹æ®å®šä¹‰ï¼Œæˆ‘å¿…é¡»åœ¨æ›²çº¿ä¸Šæ‰¾åˆ°ä¸€ä¸ªä¸Xçš„ç»™å®šå€¼ç›¸å¯¹åº”çš„ç‚¹ï¼Œç„¶åå°†å…¶è¿”å›ç»™Yã€‚æˆ‘æ‰¾ä¸åˆ°ä»»ä½•æ ‡å‡†çš„å†…ç½®æ–¹æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œä¹Ÿæ— æ³•æ‰¾åˆ°ä¸€ç§æµè¡Œçš„æ¨¡å¼ï¼Œå› æ­¤æˆ‘å†³å®šå°†ç°æœ‰çš„ä¿®æ•´æ–¹æ³•ç”¨äºè¿™äº›ç›®çš„ï¼ˆ ï¼‰æˆ‘å†³å®šæˆ‘å¯ä»¥å¾ˆå¥½åœ°é‡æ–°è€ƒè™‘è¯¥æ–¹æ³•ï¼Œå¹¶é€šè¿‡è·å–ä¸è¡Œè¿›è·ç¦»çš„åˆ†æ•°ç›¸å¯¹åº”çš„è·¯å¾„éƒ¨åˆ†æ¥è·å¾—æ‰€éœ€çš„ç‚¹ã€‚å¯¹äºé›¶ï¼Œæ­¤æ–¹æ³•å°†è¿”å›0ï¼Œå¯¹äº1ï¼Œå®ƒå°†è¿”å›1ï¼Œé‚£ä¹ˆåœ¨ä¸­é—´ï¼Œå¯èƒ½æ‰€æœ‰å†…å®¹éƒ½å°†å¤§è‡´æ­£ç¡®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘çŸ¥é“è¿™ç§æ–¹æ³•ä¸ä¼šç»™å‡ºéå¸¸å‡†ç¡®çš„ç»“æœï¼Œä½†æ˜¯ï¼Œå½“æˆ‘å°è¯•ä»¥æ ‡å‡†æ–¹å¼å¤åˆ¶å®Œå…¨ç›¸åŒçš„åŠ¨ç”»æ—¶ï¼Œé—®é¢˜çš„ä¸¥é‡æ€§æµ®å‡ºæ°´é¢ã€‚æˆ‘å¾ˆæƒŠè®¶å®ƒçš„ä¸åŒä¹‹å¤„ï¼Œå› æ­¤å†³å®šåœ¨å›¾å½¢ä¸Šæ£€æŸ¥ä»¥è¿™ç§æ–¹å¼è·å¾—çš„ç‚¹è·åŸå§‹æ›²çº¿æœ‰å¤šè¿œã€‚ç»“æœä¸ä»¤æˆ‘æ»¡æ„ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fl/ed/s-/fleds-cdj4f8ellnui32gn-kiyk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™äº›ç‚¹ä¸ä»…è¿œç¦»æ‰€éœ€æ›²çº¿ï¼Œè€Œä¸”æ›²çº¿çš„æœ¬è´¨ä¹Ÿå¤±çœŸäº†ã€‚æœ‰ä¸€ä¸ªé¢å¤–çš„çº½ç»“ï¼Œæˆ‘æ ¹æœ¬ä¸éœ€è¦ã€‚ç»“æœï¼Œæˆ‘ä»ç„¶ä¸å¾—ä¸æƒ³å‡ºä¸€ç§ç›¸å¯¹å‡†ç¡®çš„æ–¹æ³•æ¥åœ¨è´å¡å°”æ›²çº¿ä¸Šæ‰¾åˆ°ä¸€ä¸ªç‚¹ï¼ŒåªçŸ¥é“ä¸€ä¸ªåæ ‡ï¼š</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å¿…é¡»åœ¨å†…å­˜ä¸­å­˜å‚¨è®¸å¤šæ®µï¼Œè¿™äº›æ®µçš„æœ«ç«¯ä½äºç»™å®šçš„æ›²çº¿ä¸Šã€‚ç”¨è¿™ç§æ–¹æ³•é€šè¿‡ç»™å®šçš„Xæœç´¢Yå°±æ˜¯æœç´¢ç›¸åº”çš„æ®µï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå°†å…¶åˆ†æˆä¸¤åŠï¼Œç›´åˆ°è¯¥æ®µçš„è¾¹ç•Œä¹‹ä¸€è¶³å¤Ÿæ¥è¿‘æ‰€éœ€çš„ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°åœ¨è¯¥çº¿æ®µä¸Šå…·æœ‰æ‰€éœ€Xåæ ‡çš„ç‚¹ï¼Œå¹¶å°†å…¶è¿”å›Yã€‚å¦‚æœæ‚¨çŸ¥é“ä½¿ç”¨ç»™å®šçš„åæ ‡åœ¨ä»»æ„Bezieræ›²çº¿ä¸ŠæŸ¥æ‰¾ç‚¹çš„æ›´ç®€å•æ–¹æ³•ï¼Œè¯·åœ¨æ³¨é‡Šä¸­è¾“å…¥ã€‚æˆ‘è®¤ä¸ºè¿™å¯èƒ½å¯¹è®¸å¤šäººæœ‰ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œè¿™äº›ç‚¹éå¸¸æ¥è¿‘å›¾è¡¨ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/bk/qi/wxbkqitda0fmf516tl1vjarqgoq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åˆ›å»ºäº†ä¸€ä¸ªsingltonå¯¹è±¡ï¼Œä»¥åˆ›å»ºæ§åˆ¶ç‚¹çš„æ—¶åºæ›²çº¿å¹¶ç¼“å­˜è¦æœç´¢Yçš„çº¿æ®µé˜µåˆ—ï¼Œå› æ­¤ï¼Œæˆ‘éœ€è¦åœ¨æ›²çº¿ä¸Šæ‰¾åˆ°ç‰¹å®šç‚¹çš„æ–¹æ³•æ˜¯æ‰¾åˆ°è¯¥ç‚¹å°†ä½äºå…¶ä¸­çš„çº¿æ®µï¼Œå¹¶å°†å…¶åˆ†æˆä¸¤åŠç›´åˆ°çº¿æ®µçš„æœ«ç«¯ä¹‹ä¸€è¶³å¤Ÿé è¿‘æ­¤ç‚¹ä»¥è½å…¥ç»™å®šçš„è¯¯å·®ï¼Œç„¶åæ²¿çº¿Xæ²¿ç»™å®šçš„Xçº¿æ€§å†…æ’Yçš„å€¼ï¼Œç”¨è¯¥çº¿æ®µæ›¿æ¢éƒ¨åˆ†æ›²çº¿ã€‚æˆ‘å¹¶ä¸æ˜¯è¯´è¿™æ˜¯æœ€å¥½çš„æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å¯ä»¥ä½¿ç”¨ã€‚åŒæ ·ï¼Œå¦‚æœæ‚¨çŸ¥é“æ›´å¥½çš„æ–¹æ³•ï¼Œè¯·åœ¨è¯„è®ºä¸­å†™ä¸‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å€ŸåŠ©äºè¿™æ ·çš„å·¥å…·ï¼Œçº¿æ€§åŠ¨ç”»åˆ°éçº¿æ€§çš„è½¬æ¢å˜å¾—ç®€å•ã€‚</font><font style="vertical-align: inherit;">æ‰€éœ€è¦çš„åªæ˜¯é€šè¿‡ä¸¤ä¸ªæ§åˆ¶ç‚¹æè¿°æ›²çº¿ï¼Œå¹¶æ ¹æ®è¯¥æ›²çº¿é‡æ–°è®¡ç®—çº¿æ®µä¸Šçš„ä½ç½®ã€‚</font><font style="vertical-align: inherit;">å¦‚æœéœ€è¦åˆ¶ä½œå„ç§æŒç»­æ—¶é—´çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬ä»å°†ä½¿ç”¨å¯¹Xåæ ‡ä½¿ç”¨é€‚å½“ç³»æ•°çš„å•ä½æ›²çº¿ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">        
<span class="hljs-keyword">self</span>.timing = <span class="hljs-type">TimingCurve</span>.superEaseIn(duration: <span class="hljs-number">1</span>)
<span class="hljs-keyword">let</span> animatedPosition = timing.getY(onX: currentPosition)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯åŠ¨ç”»çš„æ ·å­ï¼Œä»¥åŠæˆ‘ä»¬çš„æ—¶åºæ›²çº¿ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vf/f0/fe/vff0fe07bgvlvqhhuok5vy_w8ga.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰å…³å®Œæ•´ä»£ç ï¼Œæ¬¢è¿æ¥åˆ°</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè§‚çœ‹TimingCurveViewæ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº†è§£äº†æ­¤ç¤ºä¾‹ä¹‹åï¼Œæ‚¨å°†100ï¼…ç†è§£åŠ¨ç”»æ—¶é—´çš„å®‰æ’æ–¹å¼ã€‚</font><font style="vertical-align: inherit;">é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨è¿™äº›çŸ¥è¯†ï¼Œå› ä¸ºSwiftUIå…è®¸æ‚¨ä½¿ç”¨TimingCurveï¼ˆï¼‰å‡½æ•°ä¸ºæ§åˆ¶ç‚¹åˆ›å»ºè‡ªå·±çš„æ—¶åºæ›²çº¿ï¼Œå¹¶åƒå…¶ä»–ä»»ä½•åŠ¨ç”»ä¸€æ ·ä½¿ç”¨å®ƒã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿‡æ¸¡</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†å¯ä»¥å¿å—çš„æ— å°½åŠ¨ç”»ã€‚å‰©ä¸‹çš„åªæ˜¯å¼„æ¸…æ¥šåº”è¯¥å¦‚ä½•æ‰“å¼€å’Œå…³é—­å®ƒã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŠ¨ç”»å¤–è§‚çš„æƒ³æ³•æ˜¯ä½¿åŠ¨ç”»å—ä»…å‡ºç°åœ¨å·²ç»æ‰“å¼€çš„ä½ç½®ä¸Šï¼Œä½†æ˜¯çª—å¸˜ä¼šåƒåœ¨å‰§é™¢ä¸­çš„çª—å¸˜ä¸€æ ·ä»ä¸­æ‹‰å›ã€‚å¦‚æœæˆ‘ä»¬å°†çª—å¸˜çš„é€Ÿåº¦ä¸åŠ¨ç”»ä¸­çš„æ³¢é€ŸåŒæ­¥ï¼Œå¹¶ä¸”åœ¨çª—å¸˜æœ¬èº«ä¸­ä»èƒŒæ™¯è‰²åˆ°å½“å‰å…¥å°„æ³¢çš„é¢œè‰²è¿›è¡Œæ¸å˜ï¼Œæˆ‘ä»¬å°†è·å¾—è§†è§‰æ•ˆæœï¼Œå°±å¥½åƒè¯¥çª—å¸˜æ˜¯ç¬¬ä¸€ä¸ªæ»šåŠ¨æ³¢ä¸€æ ·ã€‚ä¸ºäº†ä½¿è¿åŠ¨é€Ÿåº¦åŒæ­¥ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨ä¸ä¸ºæ³¢çš„è¿åŠ¨è®¾ç½®åŠ¨ç”»ç›¸åŒçš„TimingCurveã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚</font></font><br>
<br>
<pre><code class="swift hljs">   <span class="hljs-keyword">let</span> animation = <span class="hljs-type">Animation</span>.timingCurve(<span class="hljs-type">Double</span>(<span class="hljs-type">TimingCurve</span>.control.point1.x),
                                <span class="hljs-type">Double</span>(<span class="hljs-type">TimingCurve</span>.control.point1.y),
                                <span class="hljs-type">Double</span>(<span class="hljs-type">TimingCurve</span>.control.point2.x),
                                <span class="hljs-type">Double</span>(<span class="hljs-type">TimingCurve</span>.control.point2.y),<font></font>
                                duration: <span class="hljs-number">1</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Animation.timingCurveï¼ˆxï¼šy :)å…è®¸æ‚¨æ ¹æ®Bezieræ›²çº¿çš„æ§åˆ¶ç‚¹è®¾ç½®è‡ªå·±çš„åŠ¨ç”»å®šæ—¶ã€‚</font><font style="vertical-align: inherit;">åœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬è·å¾—äº†å®Œæ•´çš„Animationå¯¹è±¡ï¼Œä¾‹å¦‚ç†Ÿæ‚‰çš„.linearï¼ˆæŒç»­æ—¶é—´ï¼š1ï¼‰ï¼Œå¯ä»¥ä¸å—é™åˆ¶åœ°ä½¿ç”¨å®ƒã€‚</font><font style="vertical-align: inherit;">è€ƒè™‘åˆ°æˆ‘å¯¹æ³¢åŠ¨ç”»ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ§åˆ¶ç‚¹ï¼ŒåŠ¨ç”»å°†æ˜¯åŒæ­¥çš„ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»„ç»‡ä»£ç ä¼šæ›´æ–¹ä¾¿...</font></font></b>
                        <div class="spoiler_text">   .<br>
<br>
 ,           ,    ,          â€¦     ,     ,     .  -  ,        â€”    .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¦ç”¨åŠ¨ç”»çš„æ–¹æ³•å¯ä»¥ç›¸åŒï¼Œåªæœ‰çª—å¸˜åº”çˆ¬åˆ°åŠ¨ç”»å—ä¸Šï¼Œç„¶åé€æ¸å°†å…¶å…³é—­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æˆ‘éœ€è¦è·å–åŠ¨ç”»çš„å½“å‰çŠ¶æ€ä»¥é€‰æ‹©çª—å¸˜çš„é¢œè‰²æ—¶ï¼Œå‡ºç°äº†ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªObservableObjectï¼Œå°†å…¶ä¼ é€’åˆ°ä¿®é¥°ç¬¦å†…éƒ¨ï¼Œå¹¶å°†å…¶åœ¨AnimatableData setterå†…éƒ¨è¿›è¡Œæ›´æ”¹ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œå¿…é¡»äº†è§£ï¼Œæ¯ç§’æ›´æ”¹@Publishedå±æ€§60æ¬¡æ ¹æœ¬ä¸æ˜¯æ‚¨æ‰€éœ€è¦çš„ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ›´æ”¹</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸»ä½“å—å†…å˜é‡çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">åŠ¨ç”»çŠ¶æ€æ›´æ”¹æ—¶ï¼Œæˆ‘ä»¬æ— éœ€å¯åŠ¨ä»»ä½•æ“ä½œã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶æ‰¾å‡ºåŠ¨ç”»çš„çŠ¶æ€ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">  <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> animatableData: <span class="hljs-type">CGFloat</span> {
        <span class="hljs-keyword">get</span> { time}
        <span class="hljs-keyword">set</span> {
            <span class="hljs-keyword">if</span> animationHandler.isStarted{
                <span class="hljs-keyword">self</span>.time = newValue
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.time != <span class="hljs-keyword">self</span>.animationHandler.currentAnimationPosition{
                    <span class="hljs-keyword">self</span>.animationHandler.currentAnimationPosition = <span class="hljs-keyword">self</span>.time<font></font>
                }<font></font>
            }<font></font>
            <span class="hljs-keyword">let</span> currentTime = newValue - <span class="hljs-type">CGFloat</span>(<span class="hljs-type">Int</span>(newValue))
            <span class="hljs-keyword">self</span>.currentPosition = <span class="hljs-type">SharpWavePosition</span>.calculate(forWave: wave.ind, ofWaves: wave.totalWavesCount, overTime: currentTime)
            <span class="hljs-keyword">if</span> currentPosition &lt; <span class="hljs-number">0.01</span>{<font></font>
                animationHandler.currentWaveBaseColor = wave.baseColor<font></font>
            }<font></font>
        }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰æ³¨å†ŒSharpRainbowViewæ¥è·Ÿè¸ªAnimationHendleræ›´æ”¹çš„åŸå› ï¼š </font></font><br>
<br>
<pre><code class="swift hljs">   <span class="hljs-comment">//@ObservedObject</span>
    <span class="hljs-keyword">var</span> animationHandler: <span class="hljs-type">AnimationHandler</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†è¯´æ˜è¿™äº›çª—å¸˜çš„æ“ä½œï¼Œæˆ‘å°†é€šè¿‡æ³¨é‡Šæ‰.clippedï¼ˆï¼‰æ¥æ‰“å¼€Viewå¤–éƒ¨æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„æ˜¾ç¤ºã€‚å¦å¤–ï¼Œä¸ºæ¸…æ¥šèµ·è§ï¼Œæˆ‘å°†çª—å¸˜ç§»åˆ°åŠ¨ç”»ä¸Šæ–¹ã€‚ç°åœ¨æ›´æ¸…æ¥šäº†ï¼Œä¸æ˜¯å—ï¼Ÿ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6s/uf/0k/6suf0klfghhgxj95qfnrxd29zpe.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çª—å¸˜å¿…é¡»å¾ˆçŸ­ï¼Œä»¥ä¾¿æ¯ä¸ªæ³¢æµªå’Œçª—å¸˜æ‰€ç»è¿‡çš„è·¯å¾„éƒ½é‡åˆï¼ˆå¦åˆ™å®ƒå°†å˜æˆä¸€ä¸ªå¼‚æ­¥åŠ¨ç”»ï¼‰ï¼Œä½†æ˜¯ä¸æ­¤åŒæ—¶ï¼Œå¥¹è®¾æ³•ä»å±å¹•ä¸Šå®Œå…¨æ¶ˆå¤±äº†ã€‚åŒæ—¶ï¼Œçª—å¸˜ä»¥ä¸‰ç§é¢œè‰²çš„æ¸å˜æ’åˆ—ã€‚è¿™åœ¨å…³é—­çª—å¸˜ä¸Šæ¸…æ™°å¯è§ã€‚è¿™æ˜¯å› ä¸ºä¸€å¼€å§‹æˆ‘éå¸¸å–œæ¬¢é•¿å°¾å·´ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äº‹å®æ˜¯ï¼Œç¬¬ä¸€ä¸ªæ³¢æ˜¯ä¼ è¾“é˜µåˆ—çš„æœ€åä¸€ä¸ªå’Œç¬¬ä¸€ä¸ªé¢œè‰²çš„æ¸å˜ã€‚å®ƒä»¬å‡ä¸èƒ½ä¸èƒŒæ™¯è‰²åŒ¹é…ã€‚å› æ­¤ï¼Œæ€»ä½“ä¸Šéœ€è¦çª—å¸˜ã€‚ä¸ºäº†ä½¿çª—å¸˜å…·æœ‰ä¸¤ä¸ªè‰²è°ƒï¼Œä»èƒŒæ™¯é¢œè‰²åˆ°ç¬¬ä¸€æ³¢çš„åŸºè‰²ï¼Œçª—å¸˜çš„é•¿åº¦ä½¿æˆ‘æ— æ³•ä½¿ç”¨ã€‚å®ƒæ ¹æœ¬ä¸ä¸ç¬¬ä¸€æ³¢çš„é•¿å°¾å·´é‡å ï¼Œå¹¶ä¸”è·å¾—äº†ä¸€ç§é¢œè‰²çš„è¾¹ç•Œï¼Œè€Œå¦ä¸€ç§é¢œè‰²çš„å°¾å·´å¾—åˆ°äº†ã€‚å› æ­¤ï¼Œæˆ‘å¿…é¡»å°†çª—å¸˜åˆ¶æˆå°½å¯èƒ½å¤šçš„ä¸‰è‰²-é¦–å…ˆæ˜¯ä»èƒŒæ™¯åˆ°æœ€åä¸€æ³¢çš„é¢œè‰²ï¼Œç„¶åæ˜¯ä»æœ€åä¸€æ³¢çš„é¢œè‰²åˆ°ç¬¬ä¸€æ³¢ã€‚ç„¶åï¼Œç¬¬ä¸€æ³¢çš„å°¾å·´ä¸çª—å¸˜çš„è¾¹ç¼˜éå¸¸å»åˆã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‡ºäºç›¸åŒçš„åŸå› ï¼Œä»–ä»¬ä¹Ÿå°†å…³é—­çª—å¸˜ä¹Ÿè®¾ä¸ºä¸‰è‰²ã€‚å¦åˆ™ï¼Œè¾¹ç•Œçœ‹èµ·æ¥ä¸è‡ªç„¶ã€‚ä½†æ˜¯ç»“æœæ˜¯ï¼Œç¬¬ä¸€ä¸ªâ€œæ³¢æµªâ€ï¼ˆç°åœ¨æˆ‘ä»¬çŸ¥é“è¿™å®é™…ä¸Šæ˜¯Transition.truncateä¸­æè¿°çš„å¸·å¹•ï¼‰æ˜¾å¾—å¾ˆçŸ­ã€‚å°½ç®¡å®ƒä¸ç¬¬ä¸€æ³¢å®Œå…¨åŒæ­¥ç§»åŠ¨ï¼Œå³å°½ç®¡éšåçš„æ³¢çš„å®½åº¦åœ¨è§†è§‰ä¸Šæœ‰æ‰€å¢åŠ ï¼Œä½†å®ƒçš„å®½åº¦å¹¶æ²¡æœ‰éšæ—¶é—´å˜åŒ–ï¼Œè€Œæ˜¯åŠ é€Ÿä¸”ä¸æ˜¯çº¿æ€§çš„ã€‚å¯ä»¥é€šè¿‡åŠ¨æ€æ›´æ”¹çª—å¸˜çš„å®½åº¦æ¥å…‹æœè¿™ç§æƒ…å†µï¼Œä½†å¦ç‡åœ°è¯´æˆ‘å¾ˆæ‡’ã€‚å¯¹äºé‚£äº›æƒ³æ·±å…¥ç ”ç©¶è¿™äº›æœºåˆ¶å¹¶æŠ½å‡ºä»£ç çš„äººæ¥è¯´ï¼Œè¿™æ˜¯ä¸€é¡¹å®¶åº­ä½œä¸šï¼ˆæˆ‘äº‹å…ˆå‘è¿™ç±»äººè‡´æ­‰ï¼Œæˆ‘çš„å®éªŒä¸­æœ‰å¾ˆå¤šç—•è¿¹å¯èƒ½ä¼šä½¿æ‚¨æ„Ÿåˆ°å›°æƒ‘ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ‰ä¸€ä¸ªé—®é¢˜ã€‚</font><font style="vertical-align: inherit;">å¦‚æœåœ¨ä¸æˆåŠŸçš„æ—¶é—´æŒ‰ä¸‹æŒ‰é’®ï¼Œåˆ™å…³é—­çš„çª—å¸˜å°†å‡ ä¹æ— æ³•é®ç›–ä¸‹ä¸€æ³¢ã€‚</font><font style="vertical-align: inherit;">çœ‹èµ·æ¥ä¸å¤ªå¥½ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥é€šè¿‡åœ¨éšè—å¸¦æœ‰åŠ¨ç”»çš„è§†å›¾æ—¶ç¨åŠ å»¶è¿Ÿæ¥è§£å†³è¯¥é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥æ‰¾å‡ºåŠ¨ç”»çš„å½“å‰ä½ç½®ï¼Œæˆ‘ä»¬åªéœ€è¦ç¨å¾®æ¨è¿Ÿè¿‡æ¸¡çš„å¼€å§‹ï¼Œæœ€åä¸€æµªå°±å°†è¢«å®Œå…¨æ˜¾ç¤ºå‡ºæ¥ã€‚</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-type">Text</span>(<span class="hljs-string">"toggle animation"</span>).onTapGesture {<font></font>
                withAnimation(){<font></font>
                    <span class="hljs-keyword">var</span> delay: <span class="hljs-type">Double</span> = <span class="hljs-number">0</span>
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.isShown{
                        <span class="hljs-keyword">let</span> waveChangeTime: <span class="hljs-type">Double</span> = <span class="hljs-type">Double</span>(<span class="hljs-number">1</span>) /  <span class="hljs-type">Double</span>(<span class="hljs-keyword">self</span>.animationHandler.rainbowColors.<span class="hljs-built_in">count</span>)
                        <span class="hljs-keyword">let</span> currentTime = <span class="hljs-type">Double</span>(<span class="hljs-keyword">self</span>.animationHandler.currentAnimationPosition)
                        <span class="hljs-keyword">let</span> wavesPassed = <span class="hljs-type">Double</span>(<span class="hljs-type">Int</span>(currentTime / waveChangeTime))<font></font>
                        delay =  (wavesPassed + <span class="hljs-number">1</span>) * waveChangeTime - currentTime<font></font>
                        delay = <span class="hljs-built_in">max</span>(delay - <span class="hljs-number">0.05</span>, <span class="hljs-number">0</span>)
                        <span class="hljs-built_in">print</span>(<span class="hljs-string">"currentTime: \(currentTime); delay \(delay)"</span>)<font></font>
                    }<font></font>
                    <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + delay) {
                        <span class="hljs-keyword">self</span>.isShown.toggle()<font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ¶ä½œå¯å˜å®½åº¦çš„çª—å¸˜ï¼Œä»¥äº§ç”ŸèƒŒæ™¯å’Œçª—å¸˜ä¹‹é—´ä»¥åŠè¾¹æ¡†å’Œç¬¬ä¸€æ³¢ä¹‹é—´è¾¹ç•Œé€Ÿåº¦ä¸åŒçš„é”™è§‰ï¼Œä½†æ˜¯ç°åœ¨ç¬¬ä¸€æ³¢çœ‹èµ·æ¥æœ‰ç‚¹ä¸è‡ªç„¶ï¼Œä½†æ˜¯æˆ‘å·²ç»æ‡’å¾—æ‰“æ‰°äº†ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿‡æ¸¡çˆ±è¡¬ä¸€å¤´çŒª</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šå¸¸ï¼Œå¯¹æˆ‘è€Œè¨€ï¼Œå¤–è§‚å’Œæ¶ˆå¤±çš„åŠ¨ç”»æ˜¯éå¸¸é…·çš„å·¥å…·ã€‚ä½†ä¼¼ä¹è¿™ä¸ªæ¦‚å¿µæ˜¯æ–°æ¦‚å¿µï¼Œå¹¶éæ‰€æœ‰å·¥å…·éƒ½èƒ½æ­£å¸¸å¤„ç†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œ.rotation3DEffectï¼ˆï¼‰ä¿®é¥°ç¬¦éå¸¸æˆåŠŸåœ°åè½¬äº†å…¶ä¸­åŒ…å«ä¸€äº›å¤æ‚åŠ¨ç”»çš„Viewï¼Œä½†å®ƒä¸çŸ¥é“å¦‚ä½•åè½¬.transitionã€‚ç¼–å†™ç®€æ´çš„ä»£ç ï¼Œçœ‹åˆ°æ³¢å¦‚ä½•ä»å±å¹•ä¸­å¿ƒæ•£å°„å¼€ï¼Œç„¶ååœ¨å·¦ä¾§çœ‹åˆ°ï¼ŒçœŸæ˜¯ä»¤äººå¤±æœ›ã€‚æŸ¥çœ‹çª—å¸˜ä»å·¦åˆ°å³ã€‚æˆ‘å¿…é¡»å†™ä¸€å †æ ·æ¿æ–‡ä»¶ï¼Œä»¥ä¾¿transitionä¿®æ”¹å™¨å¯ä»¥åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå·¥ä½œã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/3c/fg/pn3cfg8f6zsersnfgdv5_ixrqu8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å¤–ï¼Œæ‚¨æ— æ³•è¿æ¥è¿‡æ¸¡é‡‘å±drowingGroupï¼ˆï¼‰ä¿®é¥°ç¬¦æ¥å°†Metalè¿æ¥åˆ°GPUï¼Œä»¥å°†å…·æœ‰å¤§é‡åµŒå¥—Viewï¼ˆå°¤å…¶æ˜¯å¸¦æœ‰æ¸å˜çš„Viewï¼‰çš„ZStackæ¸²æŸ“ä¼ è¾“åˆ°GPUã€‚</font><font style="vertical-align: inherit;">ä»–ä¸äº†è§£æ‚¨æè¿°çš„å¤–è§‚å’Œæ¶ˆå¤±çš„åŠ¨ç”»ï¼Œå¹¶ç”¨è‡ªå·±çš„åŠ¨ç”»ä»£æ›¿äº†å®ƒã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•éšè—çŠ¶æ€æ ï¼Ÿ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¾ˆç®€å•ã€‚ SwiftUIå…·æœ‰.statisBarï¼ˆéšè—ï¼šï¼‰ä¿®é¥°ç¬¦ã€‚è¿™åªæ˜¯SwiftUIä¸æä¾›çš„ç”¨äºæ§åˆ¶çŠ¶æ€æ è¿‡æ¸¡çš„apiã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸åˆ©ç”¨UIKitçš„åŠŸèƒ½ã€‚ SceneDelegateæ–‡ä»¶ä½¿ç”¨UIHostingControllerå°†SwiftUIè§†å›¾å˜æˆUIKit ViewControllerã€‚åœ¨æ­¤é˜¶æ®µï¼Œä½¿ç”¨æŸäº›å…¨å±€UIKitåŠŸèƒ½æœ€ä¸ºæ–¹ä¾¿ï¼Œä¾‹å¦‚ä½¿ç”¨çŠ¶æ€æ æˆ–ç¦ç”¨ä¸å±å¹•è¾¹ç¼˜å…³è”çš„ç³»ç»Ÿæ‰‹åŠ¿ï¼ˆpreferredScreenEdgesDeferringSystemGesturesï¼‰ã€‚æ‚¨å¯ä»¥ä»UIHostingControllerç»§æ‰¿ï¼Œè¦†ç›–æŸäº›ç³»ç»Ÿå±æ€§çš„å€¼ï¼Œç„¶åä½¿ç”¨æ­¤åä»£å°†Viewä¼ é€’ç»™rootViewControllerã€‚ä¸å¹¸çš„æ˜¯ï¼Œåªæœ‰æœ‰é™æ•°é‡çš„è½¬æ¢å¯ä»¥æ¥å—çŠ¶æ€æ ï¼š.fadeï¼Œ.slideå’Œ.noneã€‚é»˜è®¤å€¼ä¸ºæ·¡å…¥æ·¡å‡ºï¼Œå®ƒæœ€é€‚åˆè¿™é‡Œï¼Œæ‰€ä»¥è®©å®ƒä¿æŒåŸæ ·ã€‚æˆ‘ä»¬å¸Œæœ›è¯¥åŠŸèƒ½å°†ç»§ç»­å¾—åˆ°æ‰©å±•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ä½¿çŠ¶æ€æ çš„éšè—å’Œå¤–è§‚ä¸waveçš„ç§»åŠ¨åŒæ­¥ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå•ç‹¬çš„Viewï¼Œåœ¨å…¶ä¸­ä½¿ç”¨æš‚åœåŠŸèƒ½æ›´æ”¹äº†æ­¤å‚æ•°çš„å€¼ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StatusBarHider</span>: <span class="hljs-title">View</span></span>{
    <span class="hljs-keyword">var</span> isShown: <span class="hljs-type">Bool</span>
    @<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> internalIsShown = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span>{
        <span class="hljs-keyword">if</span> isShown == <span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-keyword">self</span>.internalIsShown == <span class="hljs-literal">true</span>{
            <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + <span class="hljs-number">0.7</span>){
                <span class="hljs-keyword">self</span>.internalIsShown = <span class="hljs-keyword">self</span>.isShown<font></font>
            }<font></font>
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> isShown == <span class="hljs-literal">true</span> &amp;&amp; <span class="hljs-keyword">self</span>.internalIsShown == <span class="hljs-literal">false</span>{
            <span class="hljs-type">DispatchQueue</span>.main.async(){
                <span class="hljs-keyword">self</span>.internalIsShown = <span class="hljs-keyword">self</span>.isShown<font></font>
            }<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-type">Spacer</span>()<font></font>
            .statusBar(hidden: internalIsShown)<font></font>
            .animation(<span class="hljs-type">Animation</span>.linear(duration: <span class="hljs-number">0.3</span>))<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œè¿™é‡Œå·²ç»å½¢æˆäº†ä¸€ä¸ªç®€å•çš„Spacerï¼ˆï¼‰ï¼Œæˆ‘å·²ç»éœ€è¦å®ƒäº†ï¼Œä½†æ˜¯statusBarä¿®é¥°ç¬¦ç¼ ç»•åœ¨å®ƒçš„é¡¶éƒ¨ã€‚å½“ç„¶ï¼Œæ€»çš„æ¥è¯´ï¼ŒAppleå°†æ­¤åŠŸèƒ½è¾“å‡ºåˆ°ä¿®é¥°ç¬¦æ˜¯ä¸åˆé€»è¾‘çš„ï¼Œå› ä¸ºè¿™ä¸é€‚ç”¨äºæ‚¨è¦ä¿®æ”¹çš„ç‰¹å®šè§†å›¾ï¼Œä½†æ˜¯æ˜¾ç„¶åªæ˜¯æ²¡æœ‰å¼„æ¸…æ¥šå¦‚ä½•åšå¾—æ›´å¥½ã€‚æ›´æœ‰è¶£çš„æ˜¯å¦ä¸€ä¸ªã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒä½¿ç”¨äº†æˆ‘ä»¬ä¹‹å‰è€ƒè™‘çš„ç›¸åŒæŠ€å·§ï¼šåœ¨ä½“å†…ï¼Œæˆ‘åœ¨è¿è¡Œæ—¶æ‰§è¡Œä¸€äº›æ“ä½œï¼ŒåŒæ—¶æ›´æ”¹</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">ã€‚æ€»ä½“ä¸Šæ¥è¯´ï¼Œé€»è¾‘æ˜¯ç›¸åŒçš„ï¼Œæœ‰ä¸€ä¸ªä»å¤–éƒ¨ä¼ è¾“çš„ç»“æ„å‚æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ª</font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä¸€æ®µæ—¶é—´åè¢«ä¿®æ”¹</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å˜é‡ï¼Œå¯¼è‡´çŠ¶æ€æ æ¶ˆå¤±æˆ–å‡ºç°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘éœ€è¦æ­¤æŠ€å·§ï¼Œå› ä¸ºæ§åˆ¶çŠ¶æ€æ åŠ¨ç”»æ˜¯ä¸€ç§UIKitåŠŸèƒ½ï¼Œè€Œåœ¨SwiftUIä¸­ä»ç„¶å¼€å‘å¾—å¾ˆå·®ã€‚</font><font style="vertical-align: inherit;">ä»ç†è®ºä¸Šè®²ï¼Œæˆ‘ä¼šå°†å»¶è¿Ÿçš„å¼€å§‹åŠ¨ç”»å›ºå®šåˆ°.statusBarï¼ˆhidden :)ä¿®é¥°ç¬¦ï¼Œä½†è¿™ä¸èµ·ä½œç”¨ã€‚</font><font style="vertical-align: inherit;">éšè—åŠ¨ç”»å’ŒçŠ¶æ€æ å¤–è§‚æ˜¯å›ºå®šçš„ï¼Œä¸èƒ½ç”±SwiftUIæ›´æ”¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢æˆ‘ä»¥æ‰€éœ€çš„å»¶è¿Ÿå¼‚æ­¥åœ°è¿›è¡Œç›¸åŒçš„æ›´æ”¹ï¼Œè€Œä¸æ˜¯åœ¨æ­¤Viewå†…éƒ¨ï¼Œè€Œæ˜¯åœ¨çˆ¶çº§ä¸­ï¼Œå³ä½¿ç”¨æˆ·å•å‡»äº†è¯¥æŒ‰é’®-è¿˜æ˜¯è®©å®ƒä½œä¸ºæˆ‘è¯•å›¾å¼„æ¸…æ¥šæ˜¯ä»€ä¹ˆçš„çºªå¿µç¢‘ï¼ˆè¿˜æœ‰ä¸€ä¸ªç†ç”±æ¥å‘Šè¯‰æˆ‘ï¼‰åˆ™ä¸åº”è¿™æ ·åšï¼‰ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çŠ¶æ€æ çš„å¤§å°å’Œä½ç½®å¦‚ä½•å¡«å……åˆ°@Environmentä¸­ï¼Ÿ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
@Environmentï¼ˆä¸è¦ä¸@EnvironmentObjectæ··æ·†ï¼‰æ˜¯ä¸€ä¸ªåŒ…è£…å™¨ï¼Œå®ƒå¯ä»¥è®¿é—®å›ºå®šçš„å˜é‡åˆ—è¡¨ï¼Œè¿™äº›å˜é‡åˆ—è¡¨åæ˜ äº†æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€‚ä¾‹å¦‚ï¼Œå±å¹•æ–¹å‘æˆ–OSé¢œè‰²ä¸»é¢˜ã€‚ç›¸åŒçš„åŒ…è£…å™¨å…è®¸æ‚¨è®¢é˜…è§†å›¾ä»¥æ›´æ”¹è¿™äº›å‚æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤åˆ—è¡¨å¯ä»¥æ‰©å±•ã€‚æˆ‘è®¤ä¸ºæ‹¥æœ‰@Environmentå¯ä»¥è®¿é—®çŠ¶æ€æ çš„å¤§å°å’Œä½ç½®æ˜¯æ­£ç¡®çš„ã€‚è¿™æ˜¯æˆ‘çš„åšæ³•ï¼š</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StatusBarFrame</span>: <span class="hljs-title">EnvironmentKey</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> defaultValue: <span class="hljs-type">CGRect</span> {
        <span class="hljs-type">CGRect</span>()<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">extension</span> <span class="hljs-title">EnvironmentValues</span> </span>{
    <span class="hljs-keyword">var</span> statusBarFrame: <span class="hljs-type">CGRect</span>{
        <span class="hljs-keyword">get</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>[<span class="hljs-type">StatusBarFrame</span>.<span class="hljs-keyword">self</span>]<font></font>
        }<font></font>
        <span class="hljs-keyword">set</span> {
            <span class="hljs-keyword">self</span>[<span class="hljs-type">StatusBarFrame</span>.<span class="hljs-keyword">self</span>] = newValue<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘åˆ›å»ºäº†å…·æœ‰é™æ€é»˜è®¤å€¼çš„ç»“æ„ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œæˆ‘é€šè¿‡æ·»åŠ è‡ªå·±çš„è®¡ç®—å±æ€§æ¥æ‰©å±•SystemValuesç³»ç»Ÿç»“æ„ï¼Œè¯¥å±æ€§çš„getterå’Œsetterå¼•ç”¨æˆ‘åˆ›å»ºçš„ç±»å‹ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œä½¿ç”¨ç±»å‹ï¼Œå› ä¸ºEnvironmentValueså®ç°ä¸€ä¸ªä¸‹æ ‡ï¼Œæ‚¨å¯ä»¥å°†ç±»å‹ä¼ é€’ç»™è¯¥ä¸‹æ ‡å¹¶è·å–ä¸æ­¤ç±»å‹ç›¸å¯¹åº”çš„å­˜å‚¨å€¼ã€‚</font><font style="vertical-align: inherit;">ä¸æ˜¯æ­¤ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨æ¡ä»¶å­—å…¸ä¸­çš„å€¼ï¼Œå…¶ä¸­ç±»å‹æœ¬èº«æ˜¯é”®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
@Environmentä¸­çš„å€¼ä½¿ç”¨keyPath \ .statusBarFrameè®¿é—®ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œè¦å°†ç¯å¢ƒå€¼ä¼ é€’ç»™å±‚æ¬¡ç»“æ„ä¸­çš„æ‰€æœ‰è§†å›¾ï¼š</font></font><br>
<br>
<pre><code class="swift hljs">.environment(\.statusBarFrame, statusBarFrame) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶åœ¨Viewæœ¬èº«ä¸­ä»å­˜å‚¨ä¸­æ£€ç´¢å€¼ï¼š</font></font><br>
<br>
<pre><code class="swift hljs">@<span class="hljs-type">Environment</span>(\.statusBarFrame) <span class="hljs-keyword">var</span> statusBarframe: <span class="hljs-type">CGRect</span> 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¡ºä¾¿è¯´ä¸€å¥ï¼Œä¸ºäº†ä½¿ç”¨IOS 13ä¸­UIWindowSceneå¯¹è±¡ä¸­çš„çŠ¶æ€æ ï¼Œå·²ç»å‡ºç°äº†statusBarManagerå±æ€§ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥ä»ä¸­å¾—å‡ºä¸€äº›å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ç°åœ¨æ‚¨æ— æ³•ç®¡ç†å®ƒä»¬ã€‚</font><font style="vertical-align: inherit;">æ®æˆ‘äº†è§£ï¼Œä¹‹å‰å¯ä»¥è®¿é—®ViewControllerçŠ¶æ€æ å¹¶ä¸ºå…¶æ·»åŠ ä¸€ä¸ªå­è§†å›¾ã€‚</font><font style="vertical-align: inherit;">æ˜¾ç„¶ï¼Œä»–ä»¬å…³é—­äº†é•¿å‡³ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘å°†å®Œå…¨åœ¨è¿™é‡Œè½¬ç§».statusBarï¼ˆhidden :)ä¿®é¥°ç¬¦çš„åŠŸèƒ½ï¼Œè¿™é‡Œå¯¹æˆ‘æ¥è¯´æ›´åˆé€‚ã€‚</font><font style="vertical-align: inherit;">æˆ‘è®¤ä¸ºå¼€å‘äººå‘˜è¿Ÿæ—©ä¼šè¾¾åˆ°è¿™ä¸€ç‚¹ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“è®º</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¥½å§ï¼Œæˆ‘è®¤ä¸ºåœ¨è¿™ä¸ªå¼•äººå…¥èƒœçš„ç¤ºä¾‹ä¸­ï¼Œå¯ä»¥è®¤ä¸ºä½¿ç”¨SwiftUIå·¥å…·è¿›è¡ŒAnimationä¹‹æ—…æ˜¯å®Œæ•´çš„ã€‚é€šè¿‡ç®€å•çš„ç¤ºä¾‹ï¼Œæˆ‘è®¨è®ºäº†ä¸»è¦çš„åŠ¨ç”»å·¥å…·ï¼Œå¹¶å‘Šè¯‰äº†å®ƒä»¬åœ¨å¼•æ“ç›–ä¸‹çš„å·¥ä½œæ–¹å¼ï¼Œåº”å¦‚ä½•ä½¿ç”¨ä»¥åŠä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ã€‚é€šè¿‡ä½¿ç”¨æ›´å¤æ‚çš„ç¤ºä¾‹ï¼Œæˆ‘å±•ç¤ºäº†æ‚¨å¯èƒ½é‡åˆ°çš„å…¸å‹å›°éš¾ä»¥åŠå…‹æœè¿™äº›å›°éš¾çš„æ–¹æ³•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ä¸Šä¸€ç¯‡æ–‡ç« çš„ç¤ºä¾‹ç›¸æ¯”ï¼Œæˆ‘çš„ä»£ç æ˜¯å¦æ›´å¹²å‡€ï¼Œæ›´æ¸…æ™°ï¼Œæ›´çŸ­ï¼Œæˆ–è€…æ›´æ˜“äºç»´æŠ¤ï¼Ÿä¹Ÿè®¸ä¸æ˜¯ã€‚å®ƒæ¶ˆè€—æ›´å°‘çš„èµ„æºå—ï¼Ÿ lasï¼Œä¸ã€‚ä¹Ÿè®¸æˆ‘çš„æ–¹æ³•æ›´é€šç”¨ï¼Œä½†è¿™å¹¶ä¸å‡†ç¡®ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€é¡¹ä»»åŠ¡ä»–è‚¯å®šè¡¨ç°æ›´å¥½ã€‚å®ƒæ›´æ·±å…¥åœ°è¯´æ˜äº†SwiftUIçš„å¹•åæ“ä½œã€‚æœ‰äº†å®ƒï¼Œæ‚¨å¯ä»¥å°†åŠ¨ç”»æ”¾åœ¨å¤´ä¸Šçš„æ¶å­ä¸Šï¼Œç„¶åå°†å…¶è‡ªç”±åœ°åº”ç”¨åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SwiftUIç§¯ææ´»è·ƒã€‚</font><font style="vertical-align: inherit;">å³ä½¿æ˜¯ç°åœ¨ï¼Œåœ¨ä¸ºç¬¬ä¸€ç¯‡æ–‡ç« ç¼–å†™ä»£ç ä¸¤å‘¨ä¹‹åï¼Œç°åœ¨ï¼Œæ£€æŸ¥å½“å‰ç‰ˆæœ¬çš„Xcodeä¸Šçš„ä»£ç ï¼Œæˆ‘ä»ç„¶çœ‹åˆ°å¦‚ä½•è§£å†³ä¸€äº›æˆ‘å¿…é¡»è§„é¿çš„é”™è¯¯ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘å¯¹è¿™ç¯‡æ–‡ç« ä¿ç•™äº†ä¸€äº›æ„è§ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†ä¸ç›¸å…³ï¼Œå¿…é¡»åˆ å‡æŸäº›å†…å®¹ï¼Œå¹¶è¿›è¡Œå…¶ä»–æ£€æŸ¥-å†æ¬¡æ£€æŸ¥ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”å¾ˆé«˜å…´ã€‚</font><font style="vertical-align: inherit;">SwiftUIç»å¯¹æ˜¯åŸç”ŸiOSå¼€å‘çš„æœªæ¥ï¼Œç«™åœ¨å®ƒçš„èµ·æºå¹¶è§‚å¯Ÿå®ƒçš„å‘å±•æ–¹å¼æ–¹é¢éå¸¸æœ‰å¸®åŠ©ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åè®°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å‡†å¤‡æœ¬æ–‡çš„ææ–™çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘è¿˜åœ¨è„‘æµ·ä¸­æŠ•å…¥äº†å¾ˆå¤šä¸œè¥¿ã€‚</font><font style="vertical-align: inherit;">æˆ‘å‘ç°å¾ˆå¤šç»†å¾®ä¹‹å¤„ï¼Œç”šè‡³åœ¨åˆšå¼€å§‹ç¼–å†™æ—¶éƒ½ä¸çŸ¥é“ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘æ•¦ä¿ƒæ¯ä¸ªå·²ç»æœ‰SwiftUIå¼€å‘ç»éªŒçš„äºº-ä¸è¦å®³ç¾ï¼Œåˆ†äº«æ‚¨çš„ç»éªŒå’ŒçŸ¥è¯†ã€‚</font><font style="vertical-align: inherit;">è¿™å¯¹äºç¤¾åŒºå’Œæ‚¨è‡ªå·±çŸ¥è¯†çš„å®Œæ•´æ€§éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</font><font style="vertical-align: inherit;">è¿™æ¯”</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°é¸­æ–¹æ³•</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦å‡‰çˆ½</font><font style="vertical-align: inherit;">ï¼Œè€Œä¸”è¿˜éœ€è¦åˆ¶å®šç­”æ¡ˆã€‚</font><font style="vertical-align: inherit;">æœ€ä¸»è¦çš„æ˜¯ä¸è¦æ‡’æƒ°åœ°å¯»æ‰¾è¿™æ ·çš„ç­”æ¡ˆï¼Œä»¥å…</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”·å­©å­éœ²é¢</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN506644/index.html">è¿œç¨‹å·¥ä½œä¸­çš„ç»ç†é¢ä¸´çš„æ–°æŒ‘æˆ˜ã€‚ç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN506648/index.html">Laravel Digestï¼ˆ2020å¹´6æœˆ8æ—¥è‡³14æ—¥ï¼‰</a></li>
<li><a href="../zh-CN506662/index.html">äºŒé˜¶å’Œä¸‰é˜¶Bezieræ›²çº¿çš„è‡ªé€‚åº”åˆ’åˆ†</a></li>
<li><a href="../zh-CN506664/index.html">ä¸Šå‘¨ç¬¬419æœŸï¼ˆ2020å¹´6æœˆ8æ—¥è‡³14æ—¥ï¼‰ä»å‰ç«¯ä¸–ç•Œä¸­æå–çš„æ–°é²œææ–™çš„æ‘˜è¦</a></li>
<li><a href="../zh-CN506666/index.html">ORMçº¹ç†ï¼Œä½†è¿™å€¼å¾—å—ï¼Ÿ</a></li>
<li><a href="../zh-CN506676/index.html">å¡å¡”å°”ï¼šä¸–ç•Œç§»æ¤å’Œå¤œåŸä¸­å¿ƒ</a></li>
<li><a href="../zh-CN506680/index.html">.NET Coreä¸Node.js è®ºç‚¹ä¸äº‹å®</a></li>
<li><a href="../zh-CN506684/index.html">æˆ‘å¦‚ä½•å°†dedic.ruè½¬ç§»åˆ°githubé¡µé¢å¹¶æ„Ÿåˆ°æ»¡æ„</a></li>
<li><a href="../zh-CN506686/index.html">6æœˆ15æ—¥è‡³21æ—¥åœ¨è«æ–¯ç§‘ä¸¾è¡Œçš„æ•°å­—æ´»åŠ¨</a></li>
<li><a href="../zh-CN506688/index.html">6æœˆ15æ—¥è‡³21æ—¥åœ¨åœ£å½¼å¾—å ¡ä¸¾è¡Œçš„æ•°å­—æ´»åŠ¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>