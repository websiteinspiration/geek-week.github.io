<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍💼 🌮 🕚 ARでテトリスをプレイ 🧜 🍪 📏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="その家はテトリスをプレイするための良いプラットフォームになるかもしれないと少し不思議に思いました。私からそう遠くないところに、これに適した建物が1つだけありました。結果はビデオで見ることができます：
 
 
 プロジェクトは、既成のソリューションを使用せずに、かなり低いレベルで実装されます。
 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ARでテトリスをプレイ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454664/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その家はテトリスをプレイするための良いプラットフォームになるかもしれないと少し不思議に思いました。</font><font style="vertical-align: inherit;">私からそう遠くないところに、これに適した建物が1つだけありました。</font><font style="vertical-align: inherit;">結果はビデオで見ることができます：</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/eGaokauVQ2o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトは、既成のソリューションを使用せずに、かなり低いレベルで実装されます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、拡張現実を実装するために2つのオプションを使用します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マーカーなし、つまり </font><font style="vertical-align: inherit;">カメラの位置は、ビデオストリームのキーポイントの動きによって決定されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> カメラの位置を基準としたマーカーとしての画像。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの実装では、特別な準備や特別な条件は必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の実装オプションがあります-特定のオブジェクトを認識し、それをマーカーとして使用します。</font><font style="vertical-align: inherit;">これには少なくともその存在が必要ですが、視覚的に制御することができます。</font><font style="vertical-align: inherit;">そのような認識の方法の1つは、エッジによるオブジェクトの検出です。</font><font style="vertical-align: inherit;">これには制限があります-マーカーオブジェクトには明確に定義されたエッジが必要です。</font><font style="vertical-align: inherit;">ほとんどの場合、オブジェクトは固体でなければなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または、この建物の照明のように、エッジを明確に描く必要があります。照明を</font></font><br>
<br>
<img src="https://habrastorage.org/webt/51/y8/nt/51y8ntbjtnm_hdy6iy5v2pmwgsu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像で簡単に分離して、検出に使用できること</font><font style="vertical-align: inherit;">がわかり</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qt。</font><font style="vertical-align: inherit;">このフレームワークを使用すると、C ++でさまざまなプラットフォームで同時に作業できます。</font><font style="vertical-align: inherit;">パフォーマンスは私たちにとって重要であるため、プロは当然の選択のように見えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qtはandroidでうまく機能しませんでしたが（長期的には、デバッグは無効にされました）、デスクトップでアルゴリズムをデバッグする機能によってこれはすべて平準化されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3次元グラフィックスは、Qtに埋め込まれた未加工のOpenGLで視覚化されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カメラの操作はQtツールを介して行われました。</font><font style="vertical-align: inherit;">ビデオはデバッグ用に記録され、カメラのビデオストリームをファイルからのビデオストリームに置き換えるのに十分便利でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出力はqmlツールを介して実行されました。</font><font style="vertical-align: inherit;">友達を作るためにqmlとOpenGLに問題がなかったわけではありませんが、これについては詳しく説明しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像処理のために、OpenCVライブラリが接続されています。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 追跡アルゴリズム </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、最も興味深い部分、つまりオブジェクトをエッジに沿って追跡するアルゴリズムに移りましょう。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、画像のエッジを強調表示することから始めます。私たちの場合、すべてのエッジは直線の形をしているため、最初に頭に浮かぶのは、ライン検出器を使用することです。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハフ変換</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はライン検出器として使用できます</font><font style="vertical-align: inherit;">。ただし、ハフ変換は非常に高価であり、この検出器は信頼性が低いため、この方法はあまり当てはまりません（これは主観的なものであり、すべてがタスクに依存している可能性があります）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代わりに、別のより一般的な方法で進みましょう。直線がまっすぐであることは考慮しませんが、バイナリイメージで作業します。エッジの存在はバイナリイメージにエンコードされます。それら。値がゼロのピクセルは、この場所にエッジがあることを意味します。ピクセル値はゼロより大きく、エッジはありません。このような画像は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、キャニー境界検出器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用するか、単純な</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しきい値変換</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">取得できます</font><font style="vertical-align: inherit;">。これらのアルゴリズムはOpenCVにあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-また、OpenCVのに今私たちのために有用である別の関数がある</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distanceTransform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、最も近いゼロピクセルまでの距離が符号化された画素に、入力で二値画像を受け取り、出力において画像が得られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、モデルを配置する場所の最初の適切な近似がすでにあると仮定します。</font><font style="vertical-align: inherit;">次に、誤差関数について説明します。これは、近似のエッジが結果の画像のエッジと一致しない距離を示します。</font><font style="vertical-align: inherit;">distanceTransformからの画像を使用して、すでにこれを行うことができます。</font><font style="vertical-align: inherit;">次に、関数最適化アルゴリズムを実行して、空間内のオブジェクトの位置の近似のみを変更します。</font><font style="vertical-align: inherit;">結果として、私たちの近似はオブジェクトの実際の位置をかなり正確に表すはずです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、アルゴリズムは2つの段階に分けることができます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像の前処理-2値化、フィルタリング、distanceTransfrom関数の使用。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トラッキング-エラー関数の最適化。</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像の前処理</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点で、画像のエッジを強調表示する必要があります。 Canny境界検出器を使用できますが、この場合、通常のしきい値変換またはその適応バージョンがより適切に機能します（OpenCVでは、これらはしきい値または適応しきい値関数です）。そのような画像にはノイズがあることは明らかなので、フィルタリングが必要です。次のようにしてみましょう</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。OpenCVのfindCountours</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数を使用して輪郭を選択し、</font><font style="vertical-align: inherit;">小さすぎるか線のように十分でないセグメントを削除します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
処理結果は画像で確認できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ef/g9/ts/efg9tspnpbvzqb1gn2o0cricah8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
順次：元の画像-&gt;しきい値変換後-&gt;フィルタリング後。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この画像は、右端があるところとないところをすでにはっきりと示しています。</font><font style="vertical-align: inherit;">その後、distanceTransform関数を使用すると、各ポイントがエッジからどれだけ離れているかに関する情報が得られます。</font><font style="vertical-align: inherit;">結果の画像はとして示され</font></font><img src="https://habrastorage.org/webt/qt/cr/xz/qtcrxzl1ow1zbp0xoducghnxhms.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、正規化して視覚化した場合の外観です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/ll/vm/hollvmy8tp4ozcc424szu5pjjuc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、いくつかの数学ツールが必要です。</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数最適化アルゴリズム</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数の最適化は、関数の最小値を見つけるタスクです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方程式の線形システムを扱っている場合、最小値を見つけるのは非常に簡単です。</font><font style="vertical-align: inherit;">連立方程式を行列形式で表し</font></font><img src="https://habrastorage.org/webt/8o/ib/1o/8oib1oj6a6trr7kkhjozgiy3day.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、次に私たちが決定し</font></font><img src="https://habrastorage.org/webt/ly/rc/qu/lyrcqutfkhebqb6tqlrfix5d1ms.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">我々は方程式の過決定システムを持っている場合は、使用できる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小二乗法を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><img src="https://habrastorage.org/webt/ll/4i/ok/ll4iok4um66gxr9zxre_lxlyylm.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数が非線形の場合、タスクは複雑になります。</font><font style="vertical-align: inherit;">最小値を見つけるには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ガウス・ニュートンアルゴリズムを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">アルゴリズムは次のように機能します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解の初期近似がすでにいくつかあると想定されています</font></font><img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは繰り返し改良されます。</font></font></li>
<li>              .        ,  <img src="https://habrastorage.org/webt/_l/so/zd/_lsozdiipx0ny5krc_nvtsklixq.png">.        ,    ,   .</li>
<li>    <img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png">   <img src="https://habrastorage.org/webt/_l/so/zd/_lsozdiipx0ny5krc_nvtsklixq.png">     2.     ,    <img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png">  <img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png">     . </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムをさらに詳しく分析してみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
する</font></font><img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワーキング機能、</font></font><img src="https://habrastorage.org/webt/i5/uo/zz/i5uozzwwbb4_f-ivitxfs2qferi.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数値のよく知られたベクトル。方程式に理想的な解がある場合</font></font><img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、次のステートメントは真</font></font><img src="https://habrastorage.org/webt/m-/dk/pv/m-dkpv_tnys9clufhps155qfxkq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。しかし、私たちはその近似のみを持っています</font></font><img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。次に、この近似からの誤差ベクトルは次のように表されます</font></font><img src="https://habrastorage.org/webt/_v/d4/n1/_vd4n1yd6irh6smzqcnpswmmbjm.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。一般的なエラーは次の関数です</font></font><img src="https://habrastorage.org/webt/8d/lf/me/8dlfmeklxb1jvlffcyk8w0vb478.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最小値に達する</font><font style="vertical-align: inherit;">ものを見つけ</font></font><img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たので</font></font><img src="https://habrastorage.org/webt/xl/um/pw/xlumpww55az0itxqrtigh2qofqg.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、解のより良い近似を得</font></font><img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
近似から始めて、</font></font><img src="https://habrastorage.org/webt/mg/yf/5k/mgyf5kyuniayj8w1_veck_sgciq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反復ごとに受け取り、繰り返し近似します</font></font><img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これを行うに</font><font style="vertical-align: inherit;">は、関数の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヤコビ行列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を計算</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">する</font></a><font style="vertical-align: inherit;">ために各反復が必要</font><font style="vertical-align: inherit;">です</font></font><img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在のアプローチ、私たちの関数の導関数からなる。</font></font><br>
<img src="https://habrastorage.org/webt/m1/g0/g-/m1g0g-jmv04dlsbyoivbvjbwpwi.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、次の近似値は次式で与えられます</font></font><img src="https://habrastorage.org/webt/lm/xc/y4/lmxcy4rjlhtxgwz_lb8kpi1cpys.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、タスクは、互いに独立した（値からのみ</font></font><img src="https://habrastorage.org/webt/ht/2u/lo/ht2ulowooc32s10ajclpbeug1w4.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">多数のデータを持つように構築されています</font><font style="vertical-align: inherit;">。その結果、一般的なヤコビ行列は非常にスパースです。計算を最適化する方法があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
共通の関数が一連の点から計算されるとします。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j番目の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポイント我々が得ます</font></font><img src="https://habrastorage.org/webt/29/lv/wk/29lvwk822xw4y0xlriuxrxx4gli.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><img src="https://habrastorage.org/webt/fu/vl/ui/fuvluirwbxatvxammyfzrbkxwug.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての関数の</font><font style="vertical-align: inherit;">ヤコビ行列</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">計算するのではなく、</font><font style="vertical-align: inherit;">特別にヤコビ行列を計算し</font></font><img src="https://habrastorage.org/webt/29/lv/wk/29lvwk822xw4y0xlriuxrxx4gli.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それをとして指定します</font></font><img src="https://habrastorage.org/webt/zf/al/h0/zfalh0ntw3nupwu56dhc7u0fzn0.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。次に、次の近似が次のように設定されます</font></font><img src="https://habrastorage.org/webt/hl/2k/d6/hl2kd6neuqqtrclxyf6efubd8by.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。さらに、この変更により、計算を並列化できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の値</font></font><img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がより大きいエラーになる場合があり</font></font><img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この問題を解決するには、アルゴリズムの修正で</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あるLevenberg-Marquardtアルゴリズム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用できます</font><font style="vertical-align: inherit;">。</font></font><img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">式に</font><font style="vertical-align: inherit;">値</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加します</font><font style="vertical-align: inherit;">。</font></font><img src="https://habrastorage.org/webt/d-/jv/hi/d-jvhiklwzbaxqihirj97fnyvg4.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font><img src="https://habrastorage.org/webt/hp/qi/1y/hpqi1yohaku8yblniy_qjap0ghe.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、は単位行列です。</font><font style="vertical-align: inherit;">値は</font></font><img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のように選択されます。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> まず、値がかなり小さい（アルゴリズムが収束するような）。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、のエラーが</font></font><img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より大きい場合</font></font><img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、値</font></font><img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">増やして、</font></font><img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もう一度</font><font style="vertical-align: inherit;">エラーの計算を試みます</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数が非線形</font></font><img src="https://habrastorage.org/webt/vc/j3/mp/vcj3mpo1jjwkew5a0enemocdyoq.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であるほど、値は大きくなります</font></font><img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ただし、値が大きい</font></font><img src="https://habrastorage.org/webt/zi/jx/hs/zijxhs_ibqcwfjnfdefeoh7fwqu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほど、アルゴリズムの収束が遅くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズム</font><font style="vertical-align: inherit;">が十分に小さい値</font><font style="vertical-align: inherit;">で</font></font><img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なる</font><font style="vertical-align: inherit;">場合にアルゴリズムを完了し、</font></font><img src="https://habrastorage.org/webt/n_/t0/bp/n_t0bpjlwogupz25g2toyse8w60.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それ</font></font><img src="https://habrastorage.org/webt/2u/gv/-3/2ugv-3nsnzjslkonizusvzbgbuo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を解決策とします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムは非常に普遍的で、さまざまなタスクに使用できます。</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数学的追跡モデル</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空間の座標を扱っているので、これらの座標を操作できる必要があることは明らかです。いくつかの点のセットがあるとし</font></font><img src="https://habrastorage.org/webt/pi/mv/hb/pimvhb7w8_hegkijjpdddui99ts.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。そして、それらをゼロ座標でポイントの周りに回転させる必要があります。おそらく最も簡単な方法は</font><font style="vertical-align: inherit;">、必要な回転を記述する</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回転行列を使用</font><font style="vertical-align: inherit;">することです</font></font><img src="https://habrastorage.org/webt/dn/qr/lf/dnqrlfvvkeyngvdbbqy8uwnbgyk.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ポイントを移動する必要がある場合は、適切なベクトル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：を</font><font style="vertical-align: inherit;">追加するだけ</font><font style="vertical-align: inherit;">です</font></font><img src="https://habrastorage.org/webt/ds/qc/jc/dsqcjcik5lk13aheb3_q78x8x6s.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、空間内のオブジェクトの位置を任意に変更できます。オブジェクトの座標は、3次元行列</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と3次元ベクトル</font><i><font style="vertical-align: inherit;">t</font></i><font style="vertical-align: inherit;">によって決定されることが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">わかります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまり12パラメータ。さらに、これらのパラメーターは互いに独立しておらず、回転マトリックスのコンポーネントは特定の条件によって相互に関連付けられています。したがって、これらの関数を最適化で使用するという観点からは、これらのパラメーターは最適なソリューションではありません。自由度よりも多くのパラメーターがあり、それらの間には関係があります。回転には別の形式があり</font><font style="vertical-align: inherit;">ます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロドリゲの回転式</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。この回転は、3次元ベクトルを形成する3つのパラメーターによって指定されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正規化されたベクトルは回転軸であり、このベクトルの長さはこの軸の周りの回転角度です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々は、ベクトルの回転の関数定義</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><img src="https://habrastorage.org/webt/kl/hc/cz/klhccza_fs2fv8gmvh3uovdnzvw.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ用い</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rodrigueの式を。これから、次の式を取得します</font></font><img src="https://habrastorage.org/webt/_s/sg/p1/_ssgp1pn5q49yx32g-zkluqkn8u.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最後に、オブジェクトの6次元ベクトルの座標を設定できます</font><font style="vertical-align: inherit;">。</font></font><img src="https://habrastorage.org/webt/mb/mo/dl/mbmodlujklivexjnp7zo0eyup_o.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の式：</font></font><img src="https://habrastorage.org/webt/ih/ls/hx/ihlshxts9oar5kcqw4l0a0ilj1w.png"><font style="vertical-align: inherit;"></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピンホールカメラモデル</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、プロジェクトで使用されるカメラの簡単な数学モデルについて説明します。</font></font><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>p</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mo>=</mo><msup><mrow><mo>(</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>p</mi><mi>x</mi></msub></mtd><mtd><msub><mi>p</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow><mi>T</mi></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mrow><mo>(</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><msub><mi>f</mi><mi>x</mi></msub><mfrac><msub><mi>v</mi><mi>x</mi></msub><msub><mi>v</mi><mi>z</mi></msub></mfrac><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub></mtd><mtd><msub><mi>f</mi><mi>y</mi></msub><mfrac><msub><mi>v</mi><mi>y</mi></msub><msub><mi>v</mi><mi>z</mi></msub></mfrac><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow><mi>T</mi></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.282ex" height="5.134ex" viewBox="-38.5 -1455.1 23801.9 2210.6" role="img" focusable="false" style="vertical-align: -1.755ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="570" y="9"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-3D" x="848" y="0"></use><g transform="translate(1904,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-28"></use><g transform="translate(556,0)"><g transform="translate(-14,0)"><g transform="translate(0,-3)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="712" y="-213"></use></g></g><g transform="translate(1994,0)"><g transform="translate(0,-3)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-79" x="712" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-29" x="3673" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-54" x="5745" y="742"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-3D" x="6843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-63" x="7899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-61" x="8332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-6D" x="8862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-28" x="9740" y="0"></use><g transform="translate(10130,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="505" y="9"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-29" x="10636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-3D" x="11303" y="0"></use><g transform="translate(12360,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJSZ2-28"></use><g transform="translate(764,0)"><g transform="translate(-14,0)"><g transform="translate(0,11)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="693" y="-213"></use><g transform="translate(995,0)"><g transform="translate(120,0)"><rect stroke="none" width="820" height="60" x="0" y="220"></rect><g transform="translate(60,522)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="686" y="-213"></use></g><g transform="translate(86,-345)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-7A" x="686" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-2B" x="2277" y="0"></use><g transform="translate(3278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="613" y="-213"></use></g></g></g><g transform="translate(5202,0)"><g transform="translate(0,11)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-79" x="693" y="-213"></use><g transform="translate(942,0)"><g transform="translate(120,0)"><rect stroke="none" width="782" height="60" x="0" y="220"></rect><g transform="translate(60,619)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-79" x="686" y="-213"></use></g><g transform="translate(67,-345)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-7A" x="686" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-2B" x="2187" y="0"></use><g transform="translate(3187,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-79" x="613" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJSZ2-29" x="10207" y="-1"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-54" x="15280" y="1240"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mover><mi>p</mi><mo stretchy="false">→</mo></mover></mrow><mo>=</mo><msup><mrow><mo>(</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>p</mi><mi>x</mi></msub></mtd><mtd><msub><mi>p</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow><mi>T</mi></msup><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">→</mo></mover></mrow><mo stretchy="false">)</mo><mo>=</mo><msup><mrow><mo>(</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>f</mi><mi>x</mi></msub><mfrac><msub><mi>v</mi><mi>x</mi></msub><msub><mi>v</mi><mi>z</mi></msub></mfrac><mo>+</mo><msub><mi>c</mi><mi>x</mi></msub></mtd><mtd><msub><mi>f</mi><mi>y</mi></msub><mfrac><msub><mi>v</mi><mi>y</mi></msub><msub><mi>v</mi><mi>z</mi></msub></mfrac><mo>+</mo><msub><mi>c</mi><mi>y</mi></msub></mtd></mtr></mtable><mo>)</mo></mrow><mi>T</mi></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">\vec{p} = \begin{pmatrix} p_x & p_y\end{pmatrix} ^ T = cam(\vec{v}) = \begin{pmatrix} f_x \frac{v_x}{v_z} + c_x & f_y \frac{v_y}{v_z} + c_y \end{pmatrix}^T</script></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font><img src="https://habrastorage.org/webt/4y/1n/eo/4y1neonrkqigjzoumocsltdvi-e.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、焦点距離はピクセル単位です。</font></font><img src="https://habrastorage.org/webt/en/zb/z6/enzbz61iibgzcsxm0jtasbuek28.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-光学中心もピクセル単位です。</font><font style="vertical-align: inherit;">これらは、カメラの固有パラメーターと呼ばれる個別のカメラパラメーターです。</font><font style="vertical-align: inherit;">通常、これらのパラメータは事前​​にわかっています。</font><font style="vertical-align: inherit;">このプロジェクトでは、これらのパラメーターは目で選択されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモデルでは、カメラのレンズの歪み（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歪み</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">は考慮されていません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そうではないと仮定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモデルでは、中央の投影が得られます。そのすべてのポイントは、カメラから遠ざかるほど光学中心に近づきます。</font><font style="vertical-align: inherit;">したがって、狭まる鉄道の効果が得られます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3c/a2/gn/3ca2gngkegajdjw25-gm6zgy3_u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。空間では、カメラは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">軸に位置合わせされ</font><font style="vertical-align: inherit;">、画像平面は</font><i><font style="vertical-align: inherit;">xy</font></i><font style="vertical-align: inherit;">平面に平行です。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私たちはモデルを宇宙で動く能力で補完します：</font></font><br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>p</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mi>j</mi></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mi>r</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>v</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></mover></mrow><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.753ex" height="2.884ex" viewBox="-38.5 -809.3 11518.5 1241.8" role="img" focusable="false" style="vertical-align: -1.005ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="570" y="9"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-6A" x="806" y="-326"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-3D" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-63" x="2296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-61" x="2729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-6D" x="3259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-28" x="4137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-72" x="4527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-6F" x="4978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-74" x="5464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-28" x="5825" y="0"></use><g transform="translate(6215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="549" y="8"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-72" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-2C" x="7207" y="0"></use><g transform="translate(7652,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="505" y="9"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-6A" x="715" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-29" x="8549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-2B" x="9161" y="0"></use><g transform="translate(10162,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-20D7" x="549" y="8"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/454664/&amp;usg=ALkJrhgXmwpLUHsq-0VA8qKK-txQGaLx6g#MJMAIN-29" x="11090" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>p</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>=</mo><mi>c</mi><mi>a</mi><mi>m</mi><mo stretchy="false">(</mo><mi>r</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">→</mo></mover></mrow><mi>r</mi></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>v</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">→</mo></mover></mrow><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">\vec{p}_j=cam(rot(\vec{x}_r, \vec{v}_j) + \vec{x}_t)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようにして、外界からカメラ画像への点の投影（世界座標から画面へ）を代数形式でシミュレートできるモデルを取得しました。</font><font style="vertical-align: inherit;">このモデルでは、空間内のカメラの相対位置のパラメータは不明</font></font><img src="https://habrastorage.org/webt/ln/ib/-f/lnib-foisc9iu_aqy0wernf1xgu.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">これらのパラメーターは、カメラの外部パラメーターと呼ばれます。</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追跡</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCVツールなしですでに実装されています。</font><font style="vertical-align: inherit;">まず、上記で説明した近似解の誤差関数を取得する必要があります。</font><font style="vertical-align: inherit;">そして、その計算を段階的に記述します：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 現在の近似のパラメーターに基づいて、表示されているトラッキングモデルのエッジを選択します。</font></font></li>
<li>        ,   . , ,     n-  ,  (  )   ,        .     ( : controlPoint —    controlPixelDistance —      ).</li>
<li>     .  <i>distanceImage</i>           .            , ..       .         : <img src="https://habrastorage.org/webt/aj/yl/of/ajylofx-nqzxqkzyaaxwcczmd6a.png">.</li>
<li>    : <img src="https://habrastorage.org/webt/o8/u-/8w/o8u-8wwvnt2jhgyulfun8kyzh6k.png"> </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の最小値を見つける必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。これを行うには、上記のLevenberg-Marquardtアルゴリズムを使用します。私たちがすでに知っているように、アルゴリズムはヤコビ行列の計算を必要とします。派生関数。導関数の数値微分を使用できます。このアルゴリズムには既製のソリューションを使用することもできます。ただし、このプロジェクトではすべてを手動で記述したため、ソリューション全体の完全な結論について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各制御点について、他の点から独立した方程式を取得します。この場合、これらの方程式を互いに独立して考慮し、具体的にはそれぞれにヤコビ行列を計算することが可能であることは、すでに上記で説明しています。私たちは、複雑な機能の分化のルールを使用して、順番にそれを分析：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/lm/3t/qflm3tr6vrmyirsufolpiwmlte4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
意味を</font></font><img src="https://habrastorage.org/webt/_b/_i/i1/_b_ii1eklzapugxeahtbl7wwuky.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そして</font></font><img src="https://habrastorage.org/webt/tr/pz/a-/trpza-t1j_sr_otvetkquuvnac8.png"><br>
<br>
<img src="https://habrastorage.org/webt/en/k3/2q/enk32qx_j0zgvqzujalzydlfxyi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここから：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ld/nh/s1/ldnhs1vypzpsx_mxlu6wjat4qtm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、意味</font></font><img src="https://habrastorage.org/webt/dl/2z/q0/dl2zq0jren9jpbmbpoaexelsrhw.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして</font></font><img src="https://habrastorage.org/webt/gb/kc/ps/gbkcpsry9q7nmsdz2kqpq-6br6y.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それから：</font></font><br>
<img src="https://habrastorage.org/webt/et/_j/ez/et_jez8fzupc2jtpk3bhteevl7y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distanceImageの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">導関数</font><font style="vertical-align: inherit;">は数値です。そして、ベクトルを計算する</font></font><img src="https://habrastorage.org/webt/iq/ur/_3/iqur_3xmxhxrdeia7bnkmonogxi.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><img src="https://habrastorage.org/webt/z-/fy/qz/z-fyqzcgc19axrhujj5y6v0lxcm.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あなたはRodrigue回転式による誘導体を見つける必要があります。 Iは、刊行物に見出され、この式のヤコビアン</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«の誘導体のためのコンパクトな式3回転D- </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指数座標»Guillermoのガレゴ、アンソニーYezzi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lb/rr/cr/lbrrcr3knmrvyjbessogjsvjyos.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前記</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ロドリゲスの回転ベクトルの式によって得られた回転行列です</font></font><img src="https://habrastorage.org/webt/qz/bd/pe/qzbdpe7zjfanzdyip7acfhwgwvo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><img src="https://habrastorage.org/webt/bn/9c/-b/bn9c-blmg7tsys7l83pbu-2upny.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-私たちが回っているポイント。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は単位行列です。</font></font><img src="https://habrastorage.org/webt/lq/im/g6/lqimg6wecrfth32alae6l435sxk.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ここでわかるように、回転ベクトルの長さによる除算があり、ベクトルがゼロの場合、数式は機能しなくなります。これはおそらく、ゼロベクトルでは回転軸が定義されていないためです。回転ベクトルがゼロに非常に近い場合、次の式を使用します</font></font><img src="https://habrastorage.org/webt/sm/hk/dc/smhkdchm-zr63paet8-nm_jftwo.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ペイントする必要が</font></font><img src="https://habrastorage.org/webt/iq/ur/_3/iqur_3xmxhxrdeia7bnkmonogxi.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あります</font></font><img src="https://habrastorage.org/webt/z-/fy/qz/z-fyqzcgc19axrhujj5y6v0lxcm.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ここでは、インデックス</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">省略されています）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nt/xz/lf/ntxzlffpi42xgp1imuodytk2bqc.png"> <img src="https://habrastorage.org/webt/hx/nz/pb/hxnzpbadbgyhlb2doqetg7f4iea.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、必要な点のヤコビ行列が得られ、上記の最適化アルゴリズムに使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアルゴリズムにはいくつかの問題があります。まず、精度。その結果、カメラのグローバル位置はフレーム間でわずかにジャンプします。少し修正できます。カメラの位置をフレームごとに劇的に変えることはできないという先験的な情報があります。また、関数に方程式を追加することで、このジッターを低減できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、変位ベクトル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カメラのグローバル位置の座標で</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">ない</font><font style="vertical-align: inherit;">ことに注意してください</font><font style="vertical-align: inherit;">。グローバル位置は座標がゼロのローカルポイントであるため、次のように</font><i><font style="vertical-align: inherit;">表示</font></i><font style="vertical-align: inherit;">できます</font><i><font style="vertical-align: inherit;">。prevGlobalPositionで</font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/zk/bk/lyzkbkk1zig1yfqu2shk9ziogbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
前のフレームの位置を覚えておいてください</font><font style="vertical-align: inherit;">。これで、以前の位置はゼロに近くなるはずです。ベクトルの長さ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><img src="https://habrastorage.org/webt/hv/lb/ww/hvlbwwdmw-wcymqnyxvaosx75mc.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十分に小さい必要があります。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">不一致の他の値に加えて、ベクトル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も最小化する必要があります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この変更の影響を判断するために、値を導入し</font></font><img src="https://habrastorage.org/webt/25/ij/uy/25ijuyi5965hui7hbmywcsgfnuy.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、乗算してから、ベクトル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">し</font></font><img src="https://habrastorage.org/webt/25/ij/uy/25ijuyi5965hui7hbmywcsgfnuy.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font><img src="https://habrastorage.org/webt/pc/eo/6_/pceo6_067ezk979vii2pi4ex8k4.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">最適化アルゴリズムでは、さらにベクトル</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d 'を</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小化します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">もちろん、そのためには、そのためのヤコビ行列を計算する必要があります。これは、一般的な誤差関数について既に上記で導出したのと同じ方法で推定されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムの2番目の問題は、アルゴリズムが極小値でスタックする可能性があることです。</font><font style="vertical-align: inherit;">他の作品では、この問題は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティクルフィルター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して解決されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます。</font></a><font style="vertical-align: inherit;">私たちの場合、このオプションは原則として十分であることがわかりました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトの追跡によるボーナス</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オブジェクトの位置と形状がわかっているので、視覚的に操作できます。これをビデオで実演してみました。オブジェクトはOpenGLシェーダーを使用して変形されました。モデルを使用して、オブジェクトの点を画像に投影し、この点の色を受け取りました。次に、このポイントを移動して、モーフィングなどの興味深い効果を得ることができます。ただし、ポイントをシフトする場合、その場所に何かを残す必要があることを覚えておく必要があります。そうしないと、不整合が顕著になります。さらに、追跡の品質とオブジェクトの形状によっては、累積エラーによるさまざまな望ましくない影響が発生しますが、それでも発生します。どういうわけかそれは考慮に入れられる必要があるだけです。上のビデオでは、拡張現実を少し広く使用できることを示しました。画像上に仮想オブジェクトをオーバーレイするだけではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vuforia SDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はオブジェクトの形状による追跡を実装していますが、厳密に定義されたエッジを使用することはできず、建物の照明に関連付けることができないため、このプロジェクトを実装することは不可能だと思います。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454644/index.html">Cisco 200-125 CCNA v3.0のトレーニング。8日目。スイッチの設定</a></li>
<li><a href="../ja454646/index.html">@Pythonetcコンパイル、2019年5月</a></li>
<li><a href="../ja454652/index.html">家庭用3DプリンターのJetエンジン</a></li>
<li><a href="../ja454658/index.html">美容小道具-深刻なビジネス</a></li>
<li><a href="../ja454662/index.html">Осторожный переезд в Нидерланды с женой и ипотекой. Часть 1: поиск работы</a></li>
<li><a href="../ja454666/index.html">ソフトウェア無線-それはどのように機能しますか？パート7</a></li>
<li><a href="../ja454668/index.html">開発者クックブック：DDDレシピ（パート5、プロセス）</a></li>
<li><a href="../ja454670/index.html">シリーズ「チェルノブイリ」：見て、考えて</a></li>
<li><a href="../ja454672/index.html">スタートの鍵：コンピュータフォレンジックに最適なソフトウェアとハ​​ードウェア</a></li>
<li><a href="../ja454674/index.html">コンソールからの貧しい人々の監視またはサーバーの監視</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>