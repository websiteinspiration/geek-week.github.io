<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏺️ 🔎 👨‍🔧 信じられないほど高速なWebアプリケーションを研究するためのパフォーマンスメトリック 💽 ⛹🏼 🤱🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="「測定できないもの、改善できない」ということわざがあります。今日私たちが翻訳を発表している記事の著者は、超人向けです。彼はこの会社が世界最速のメールクライアントを開発していると言います。ここでは、「高速」とは何か、そして非常に高速なWebアプリケーションのパフォーマンスを測定するためのツールを作成す...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>信じられないほど高速なWebアプリケーションを研究するためのパフォーマンスメトリック</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/470872/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「測定できないもの、改善できない」ということわざがあります。</font><font style="vertical-align: inherit;">今日私たちが翻訳を発表している記事の著者は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超人</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向け</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">彼はこの会社が世界最速のメールクライアントを開発していると言います。</font><font style="vertical-align: inherit;">ここでは、「高速」とは何か、そして非常に高速なWebアプリケーションのパフォーマンスを測定するためのツールを作成する方法について説明します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/q6/af/pp/q6afppxtd4rv6r-iqwvk9-6nyai.jpeg"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションの速度測定</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発を改善するために、その速度の測定に多くの時間を費やしました。そして、結局のところ、パフォーマンスメトリックは、理解して適用するのが驚くほど難しい指標です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方では、システムを操作しているときにユーザーが感じる感覚を正確に表すメトリックを設計することは困難です。一方、分析が情報に基づいた意思決定を可能にするほど正確なメトリックを作成することは容易ではありません。その結果、多くの開発チームは、プロジェクトのパフォーマンスに関して収集したデータを信頼できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者が信頼できる正確な指標を持っているとしても、それらを使用することは容易ではありません。</font><font style="vertical-align: inherit;">「高速」という用語の定義方法は？</font><font style="vertical-align: inherit;">速度と一貫性のバランスをどのように見つけるか？</font><font style="vertical-align: inherit;">パフォーマンスの低下をすばやく検出する方法、またはシステムに対する最適化の影響を評価する方法 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、Webアプリケーションのパフォーマンス分析ツールの開発に関するいくつかの考えを共有したいと思います。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.正しい「時計」の使用</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScriptには、タイムスタンプを取得するための2つのメカニズムが</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり</font></font><code>new Date()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらはどう違うのですか？</font><font style="vertical-align: inherit;">次の2つの違いは、私たちの基本です。</font></font><br>
<br>
<ul>
<li> <code>performance.now()</code>  .   <code>new Date()</code> — ± 1 ,      <code>performance.now()</code> —   ± 100  (,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>!).</li>
<li>,   <code>performance.now()</code>,           .      ,     .   <code>new Date()</code>   .    ,    ,   <code>new Date ()</code>,      .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法で表される「クロック」は</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間間隔の測定に明らかに適していますが、どちらも理想的ではありません。</font><font style="vertical-align: inherit;">また</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>new Date()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ問題が発生します。これは、システムがスリープ状態の場合に発生します。測定値には、マシンがアクティブでなかった時間も含まれます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.アプリケーションアクティビティの確認</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webアプリケーションのパフォーマンスを測定している場合、そのタブから他のタブに切り替えると、データ収集プロセスが中断されます。</font><font style="vertical-align: inherit;">どうして？</font><font style="vertical-align: inherit;">事実、ブラウザはバックグラウンドタブにあるアプリケーションを制限します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メトリックが歪む可能性がある状況は2つあります。</font><font style="vertical-align: inherit;">その結果、アプリケーションは実際よりもはるかに遅く見えます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピューターがスリープモードになります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションは、ブラウザのバックグラウンドタブで実行されます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの状況の両方が発生することは珍しいことではありません。</font><font style="vertical-align: inherit;">幸い、それらを解決するための2つのオプションがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、歪んだメトリックを単に無視して、一部の妥当な値と大きく異なる測定結果を破棄できます。</font><font style="vertical-align: inherit;">たとえば、ボタンが押されたときに呼び出されるコードは15分間しか実行できません。</font><font style="vertical-align: inherit;">おそらく、これが上記の2つの問題に対処するために必要な唯一のものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、プロパティ</font></font><code>document.hidden</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visibilitychange</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントを</font><font style="vertical-align: inherit;">使用できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">イベント</font></font><code>visibilitychange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、ユーザーが目的のブラウザータブから別のタブに切り替えたとき、または目的のタブに戻ったときに呼び出されます。これは、コンピューターが動作を開始してスリープモードを終了するときに、ブラウザーウィンドウが最小化または最大化すると呼び出されます。つまり、これがまさに私たちが必要としていることです。また、タブがバックグラウンドにある限り、プロパティ</font></font><code>document.hidden</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はequal </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロパティ</font></font><code>document.hidden</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とイベントの</font><font style="vertical-align: inherit;">使い方を示す簡単な例を次に示し</font></font><code>visibilitychange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="plaintext hljs">let lastVisibilityChange = 0<font></font>
window.addEventListener('visibilitychange', () =&gt; {<font></font>
&nbsp;&nbsp;lastVisibilityChange = performance.now()<font></font>
})<font></font>
//    ,      ,<font></font>
//  ,   ,    <font></font>
if (metric.start &lt; lastVisibilityChange || document.hidden) return</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、一部のデータは破棄されますが、これは問題ありません。</font><font style="vertical-align: inherit;">実際のところ、これはシステムのリソースを完全に使用できないプログラムの期間に関連するデータです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、私たちは興味のない指標について話しています。</font><font style="vertical-align: inherit;">しかし、収集されたデータが非常に興味深い多くの状況があります。</font><font style="vertical-align: inherit;">このデータを収集する方法を見てみましょう。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.イベントが開始した時間を最もよくキャプチャできるインジケーターを検索します</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScriptの最も物議を醸している機能の1つは、この言語のイベントループがシングルスレッドであることです。ある時点で実行できるコードは1つだけで、その実行を中断することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが特定のコードの実行中にボタンを押した場合、プログラムはこのコードの実行が完了するまでそのことを知りません。たとえば、アプリケーションが連続サイクルで1000ミリ秒を費やし、ユーザー</font></font><code>Escape</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がサイクルの開始から100ミリ秒後に</font><font style="vertical-align: inherit;">ボタンを押し</font><font style="vertical-align: inherit;">た場合、イベントはさらに900ミリ秒記録されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはメトリックをひどく歪める可能性があります。ユーザーがプログラムの操作をどのように認識しているかを正確に測定する必要がある場合、これは大きな問題です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸い、この問題の解決はそれほど難しくありません。現在のイベントについて話している場合は、</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（イベントを見た時間）ではなく、</font></font><code>window.event.timeStamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（イベントが作成された時間</font><font style="vertical-align: inherit;">）を使用</font><font style="vertical-align: inherit;">できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
イベントのタイムスタンプは、メインのブラウザプロセスによって設定されます。 JSイベントループがロックされている場合、このプロセスはブロックされないため</font></font><code>event.timeStamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、イベントが実際にいつトリガーされたかについて、はるかに貴重な情報を提供します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメカニズムは理想的ではないことに注意してください。だから、物理的なボタンが押された瞬間と、対応するイベントがChromeで到着した瞬間の間、行方不明の時間が経過するの9-15ミリ秒（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたはこれがなぜ起こるかについて学ぶことができ、そこから優れた記事）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、イベントがChromeに到達するまでの時間を測定できたとしても、この時間を指標に含めるべきではありません。</font><font style="vertical-align: inherit;">どうして？</font><font style="vertical-align: inherit;">実際には、このような遅延に大きな影響を与える可能性のあるコードにそのような最適化を導入することはできません。</font><font style="vertical-align: inherit;">決して改善することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、イベントの開始のタイムスタンプを見つけることについて話す場合、インジケーター</font></font><code>event.timeStamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はここで最も適切に見えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
イベントがいつ終了するかについての最良の見積もりは何ですか？</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. requestAnimationFrame（）でタイマーをオフにします</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScriptのイベントループデバイスの機能から、もう1つの結果が発生します。コードに関連しない一部のコードは、コードの後で、ブラウザーが更新されたバージョンのページを画面に表示する前に実行される可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、Reactについて考えてみます。</font><font style="vertical-align: inherit;">コードが実行されると、ReactはDOMを更新します。</font><font style="vertical-align: inherit;">コードで時間のみを測定する場合、Reactコードの実行にかかった時間は測定しないことを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この余分な時間を測定するために、タイマーをオフにし</font></font><code>requestAnimationFrame()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これは、ブラウザーが次のフレームを出力する準備ができている場合にのみ行われます。</font></font><br>
<br>
<pre><code class="plaintext hljs">requestAnimationFrame(() =&gt; { metric.finish(performance.now()) })</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フレームのライフサイクルは次のとおりです（図は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すばらしい専用の資料</font><font style="vertical-align: inherit;">から取られ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">て</font></a><font style="vertical-align: inherit;">います</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/403/439/0d4/4034390d4dd3060d8653bf03d72d4ca2.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレームのライフサイクル</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この図からわかる</font></font><code>requestAnimationFrame()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ように、プロセッサが完了した後、フレームが表示される直前に呼び出されます。</font><font style="vertical-align: inherit;">ここでタイマーをオフにすると、画面の更新に時間がかかったすべてのものが、収集された時間間隔のデータに確実に含まれることになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまでのところ良好ですが、今では状況はかなり複雑になっています...</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.ページレイアウトの作成とレンダリングに必要な時間を無視する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フレームのライフサイクルを示す前の図は、発生した別の問題を示しています。フレームのライフサイクルの最後には、レイアウトブロック（ページレイアウトを形成）とペイント（ページを表示）があります。これらの操作の実行に必要な時間を考慮しない場合、当社が測定した時間は、更新されたデータが画面に表示されるのに必要な時間よりも短くなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸いにも</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、スリーブには別のエースがあります。</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font><font style="vertical-align: inherit;">関数に渡さ</font><font style="vertical-align: inherit;">れる</font><font style="vertical-align: inherit;">関数を呼び出す</font><font style="vertical-align: inherit;">と、現在のフレーム（図の左端にあるフレーム）の形成の開始時刻を示すタイムスタンプが送信されます。このタイムスタンプは通常、前のフレームの終了時刻に非常に近いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、その瞬間</font></font><code>event.timeStamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から次のフレームの形成が開始されるまでに</font><font style="vertical-align: inherit;">経過した合計時間を測定することにより、上記の欠点を修正することができる</font><font style="vertical-align: inherit;">。入れ子に注意して</font></font><code>requestAnimationFrame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ください：</font></font><br>
<br>
<pre><code class="plaintext hljs">requestAnimationFrame(() =&gt; {<font></font>
&nbsp;&nbsp;requestAnimationFrame((timestamp) =&gt; { metric.finish(timestamp) })<font></font>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上に示したものは問題に対する優れた解決策のように見えますが、結局、この設計を使用しないことにしました。実際、この手法ではより信頼性の高いデータを取得できますが、そのようなデータの精度は低下します。 Chromeのフレームは、16 msの周波数で形成されます。これは、使用可能な最高の精度が±16 msであることを意味します。また、ブラウザーが過負荷でフレームをスキップすると、精度はさらに低下し、この低下は予測できなくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このソリューションを実装する場合、以前に32ミリ秒、最大15ミリ秒実行されたタスクを高速化するなど、コードのパフォーマンスを大幅に改善しても、パフォーマンス測定の結果に影響しない場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページレイアウトとその出力の形成に必要な時間を考慮しないと、制御下にあるコードのはるかに正確なメトリック（±100μs）が得られます。</font><font style="vertical-align: inherit;">その結果、このコードに加えられた改善の数値式を取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、同様のアイデアを検討しました。</font></font><br>
<br>
<pre><code class="plaintext hljs">requestAnimationFrame(() =&gt; {<font></font>
&nbsp;&nbsp;setTimeout(() =&gt; { metric.finish(performance.now()) }<font></font>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにはレンダリング時間が含まれますが、インジケーターの精度は±16 msに制限されません。</font><font style="vertical-align: inherit;">ただし、このアプローチは使用しないことにしました。</font><font style="vertical-align: inherit;">システムが長い入力イベントに遭遇した場合、転送されたものの呼び出しは</font></font><code>setTimeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大幅に遅延し、ユーザーインターフェイスの更新後に行われる可能性があります。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.「目標を下回るイベントの割合」の明確化</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはプロジェクトを開発し、2つの方法でそれを最適化しようとする高パフォーマンスに焦点を当てています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">速度。</font><font style="vertical-align: inherit;">最速のタスクの実行時間は、できるだけ0ミリ秒に近づける必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">均一。</font><font style="vertical-align: inherit;">最も遅いタスクの実行時間は、最も速いタスクの実行時間に可能な限り近くする必要があります。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの指標は時間の経過とともに変化するため、視覚化するのが難しく、議論するのが容易ではありません。速度と均一性の両方を最適化するように私たちを鼓舞するような指標の視覚化システムを作成することは可能ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
典型的なアプローチは、遅延の90パーセンタイルを測定することです。このアプローチでは、Y軸に沿って、ミリ秒単位の時間が節約される線グラフを描くことができます。このグラフから、イベントの90％が折れ線グラフの下にあることがわかります。つまり、折れ線グラフが示す時間よりも速く実行されます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">100ミリ秒</font></a><font style="vertical-align: inherit;">は、「高速」と「低速」との境界</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
として知られてい</font><font style="vertical-align: inherit;">ます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、遅延の90パーセンタイルが103ミリ秒であることがわかっている場合、ユーザーが仕事からどのように感じるかについて何がわかりますか特にありません。ユーザーに仕事の利便性を提供する指標は何ですか？これを確実に知る方法はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、遅延の90パーセンタイルが93 msであることを知っている場合はどうでしょうか。 93は103よりも良いという感じがありますが、これらの指標、およびプロジェクトに対するユーザーの認識の観点からこれらの指標について何も言えません。繰り返しますが、この質問に対する正確な答えはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題の解決策を見つけました。これは、実行時間が100ミリ秒を超えないイベントの割合を測定することです。このアプローチには3つの大きな利点があります。</font></font><br>
<br>
<ul>
<li>   .      ,       ,        .</li>
<li>       ,    - ,     ,    ,      (      №5).  ,     ,     ,  ,     ,    ,  .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このメトリックは計算が簡単です。</font><font style="vertical-align: inherit;">実行時間がターゲットインジケーターを下回るイベントの数を計算し、その後、イベントの総数で除算するだけで十分です。</font><font style="vertical-align: inherit;">パーセンタイルは、数えるのがはるかに困難です。</font><font style="vertical-align: inherit;">効果的な近似がありますが、すべてを正しく行うためには、各次元を考慮する必要があります。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアプローチにはマイナスが1つだけあります。指標が目標よりも悪い場合、その改善に気づくことは容易ではありません。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.指標の分析におけるいくつかのしきい値の使用</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンス最適化の結果を視覚化するために、システムにいくつかの追加のしきい値を導入しました-100ミリ秒以上およびそれ以下。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延を次のようにグループ化しました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50ミリ秒未満（高速）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50〜100 ms（良好）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100〜1000 ms（遅い）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000ミリ秒を超える（ひどく遅い）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ひどく遅い」結果により、どこかで多くのことを逃したことがわかります。したがって、それらを明るい赤で強調表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
50 msに収まるものは、変化に非常に敏感です。ここでは、パフォーマンスの改善は、100ミリ秒に対応するグループで確認できるようになるずっと前に目に見えることがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、次のグラフは、Superhumanでのスレッド表示のパフォーマンスを視覚化しています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eb5/773/9e8/eb57739e82476e3b7a2c9212908ff5bf.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スレッドを表示</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは、パフォーマンスの低下の期間を示し、次に-改善の結果を示します。</font><font style="vertical-align: inherit;">100 msに対応するインジケーター（青い列の上部）だけを見ると、パフォーマンスの低下を評価することは困難です。</font><font style="vertical-align: inherit;">50ミリ秒に収まる結果（緑色の列の上部）を見ると、パフォーマンスの問題がすでにはっきりとわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンスメトリックの調査に従来のアプローチを使用した場合、システムへの影響が前の図に示されている問題に気付かなかったと思われます。</font><font style="vertical-align: inherit;">しかし、測定方法とメトリックの視覚化方法のおかげで、問題を非常に迅速に検出して解決することができました。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンスメトリックを操作するための適切なアプローチを見つけるのは驚くほど難しいことが判明しました。</font><font style="vertical-align: inherit;">私たちは、Webアプリケーションのパフォーマンスを測定するための高品質なツールを作成できる方法を開発することができました。</font><font style="vertical-align: inherit;">つまり、次のことを話しているのです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントの開始時間は、で測定され</font></font><code>event.timeStamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントの終了時間は、</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信</font><font style="vertical-align: inherit;">され</font><font style="vertical-align: inherit;">たコールバック</font><font style="vertical-align: inherit;">を使用し</font><font style="vertical-align: inherit;">て</font><font style="vertical-align: inherit;">測定され</font><font style="vertical-align: inherit;">ます</font></font><code>requestAnimationFrame()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非アクティブなブラウザータブ上にあるアプリケーションで発生するすべてのことは無視されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データは、「目標を下回るイベントの割合」として説明できるインジケーターを使用して集計されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データは、いくつかのレベルのしきい値で視覚化されます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この手法は、信頼できる正確なメトリックを作成するためのツールを提供します。</font><font style="vertical-align: inherit;">パフォーマンスの低下を明確に示すグラフを作成でき、最適化の結果を視覚化できます。</font><font style="vertical-align: inherit;">そして最も重要なことですが、迅速なプロジェクトをさらに迅速に行う機会があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webアプリケーションのパフォーマンスをどのように分析しますか？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/-o/2e/tu/-o2etuqogwhmdnmysb9_vivc9v4.png"></div></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja470856/index.html">Telegram GRAM Wallet：利用規約</a></li>
<li><a href="../ja470858/index.html">骨董品：386番目のプロセッサのベンチマークと90年代のダッシュ</a></li>
<li><a href="../ja470864/index.html">パネルへの切り替えの喜びについてだけでなく、</a></li>
<li><a href="../ja470868/index.html">最初のバイトまでの時間：それは何で、なぜそれが重要なのか</a></li>
<li><a href="../ja470870/index.html">フォントのプリロード</a></li>
<li><a href="../ja470874/index.html">ウィキペディアでのJavaScriptロードの最適化</a></li>
<li><a href="../ja470876/index.html">Babelを使用してカスタムJavaScript構文構造を作成します。パート1</a></li>
<li><a href="../ja470878/index.html">Babelを使用してカスタムJavaScript構文構造を作成します。パート2</a></li>
<li><a href="../ja470880/index.html">ゲームの仕組み。アドベンチャー、ゼロおよび説得力のある言語療法の概念</a></li>
<li><a href="../ja470882/index.html">どうして私のマウスやボードゲームを社会的相互作用のモデルとして捉えたのですか</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>