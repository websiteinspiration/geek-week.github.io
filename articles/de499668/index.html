<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏼 👩🏾‍🚒 💶 Road to Hell JavaScript-Abhängigkeiten 🎭 🥤 🛬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jedes JavaScript-Projekt beginnt mit guten Absichten, nämlich dass sich seine Entwickler versprechen, während seiner Entwicklung nicht zu viele NPM-Pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Road to Hell JavaScript-Abhängigkeiten</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/499668/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jedes JavaScript-Projekt beginnt mit guten Absichten, nämlich dass sich seine Entwickler versprechen, während seiner Entwicklung nicht zu viele NPM-Pakete zu verwenden. Aber selbst wenn die Entwickler erhebliche Anstrengungen unternehmen, um dieses Versprechen einzuhalten, dringen NPM-Pakete nach und nach in ihre Projekte ein. Die Dateigröße </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wächst mit der Zeit. Und seit der </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation von Abhängigkeiten tritt ein echtes Entsetzen auf, das sich in Hinzufügungen und Löschungen von Paketen äußert, was sich besonders bei der nächsten PR bemerkbar macht ... </font><font style="vertical-align: inherit;">
"Alles ist in Ordnung", sagt der Teamleiter. Der Rest des Teams nickt zustimmend. Was sonst zu tun? Wir alle genießen die Tatsache, dass das JavaScript-Ökosystem lebendig und gut ist. Wir müssen das Rad nicht jedes Mal neu erfinden und versuchen, die Probleme zu lösen, die bereits von der Open Source-Community gelöst wurden.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/be/cf/ky/becfkyhkcfavrlygimyyrliz9t4.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, Sie erstellen ein Blog und möchten Gatsby.js verwenden. </font><font style="vertical-align: inherit;">Versuchen Sie, diesen Site-Generator basierend auf Ihrem Projekt hinzuzufügen. </font><font style="vertical-align: inherit;">Nun herzlichen Glückwunsch. </font><font style="vertical-align: inherit;">Ihr Projekt hatte gerade 19.000 zusätzliche Abhängigkeiten. </font><font style="vertical-align: inherit;">Es ist in Ordnung? </font><font style="vertical-align: inherit;">Wie komplex kann ein JavaScript-Abhängigkeitsbaum werden? </font><font style="vertical-align: inherit;">Wie wird ein Abhängigkeitsbaum zur Hölle? </font><font style="vertical-align: inherit;">Lass es uns herausfinden.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist ein JavaScript-Paket?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NPM (Node Package Manager, Node Package Manager) speichert die größte Paketregistrierung der Welt. </font><font style="vertical-align: inherit;">Dies sind JavaScript-Pakete. </font><font style="vertical-align: inherit;">NPM ist mehr als RubyGems, PyPi und Maven zusammen. </font><font style="vertical-align: inherit;">Diese Schlussfolgerung kann auf der Grundlage der Analyse der Daten des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module Counts-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Projekts gezogen werden </font><font style="vertical-align: inherit;">, das die Anzahl der Pakete in populären Registern überwacht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/d83/158/259d831584b0a9a5d1fd6226e3f799b0.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten zur Anzahl der Pakete in gängigen Registern</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sie könnten denken, dass in dieser Grafik sehr große Mengen an Code dargestellt werden. </font><font style="vertical-align: inherit;">Wie es ist. </font><font style="vertical-align: inherit;">Um ein Projekt in ein NPM-Paket umzuwandeln, muss dieses Paket eine Datei enthalten</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ein solches Paket kann an die NPM-Registrierung gesendet werden.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist package.json?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind die Aufgaben, die es löst </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es listet die Pakete auf, von denen Ihr Projekt abhängt (dies ist eine Liste der Projektabhängigkeiten).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Darin werden unter Verwendung der Regeln der semantischen Versionierung Versionen von Abhängigkeitspaketen festgelegt, die Ihr Projekt verwenden kann.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können die Umgebung reproduzieren, die für das Funktionieren des Pakets erforderlich ist, und vereinfachen dadurch die Übertragung des Projekts an andere Entwickler.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Datei </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann als eine </font></font><code>README</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit Steroiden gepumpte </font><font style="vertical-align: inherit;">Datei </font><font style="vertical-align: inherit;">betrachtet werden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Hier können Sie die Abhängigkeiten Ihres Pakets beschreiben, hier können Sie Skripte schreiben, die während der Montage und des Testens des Projekts ausgeführt werden. </font><font style="vertical-align: inherit;">Dieselbe Datei enthält Informationen zur vom Entwickler angegebenen Projektversion und eine Beschreibung des Projekts. </font><font style="vertical-align: inherit;">Wir sind besonders an der Möglichkeit interessiert </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Projektabhängigkeiten anzugeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht sieht die Tatsache, dass die Projektabhängigkeiten in dieser Datei angegeben sind, etwas alarmierend aus. </font><font style="vertical-align: inherit;">Stellen Sie sich vor, es gibt ein Paket, das von einem anderen Paket abhängt, und dieses andere Paket hängt von einem anderen Paket ab. </font><font style="vertical-align: inherit;">Eine solche Abhängigkeitskette kann beliebig lang sein. </font><font style="vertical-align: inherit;">Aus diesem Grund bedeutet die Installation des einzigen Pakets, Gatsby.js, dass das Projekt mit 19.000 zusätzlichen Abhängigkeiten ausgestattet wird.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeitstypen in package.json</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um besser zu verstehen, wie Projektabhängigkeitslisten im Laufe der Zeit wachsen, sprechen wir über die verschiedenen Arten von Abhängigkeiten, die ein Projekt haben kann. </font><font style="vertical-align: inherit;">Es </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">können </font><font style="vertical-align: inherit;">nämlich die </font><font style="vertical-align: inherit;">folgenden Abschnitte gefunden werden, die verschiedene Abhängigkeiten beschreiben:</font></font><br>
<br>
<ul>
<li><code>dependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Dies sind gewöhnliche Abhängigkeiten, deren Funktionalität im Projekt verwendet wird und auf die über den Code zugegriffen wird.</font></font></li>
<li><code>devDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Dies sind Entwicklungsabhängigkeiten. </font><font style="vertical-align: inherit;">Zum Beispiel die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schönere</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek, </font><font style="vertical-align: inherit;">die zum Formatieren von Code verwendet wird.</font></font></li>
<li><code>peerDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Wenn Abhängigkeiten in diesen Abschnitt geschrieben werden, informiert der Paketentwickler den Installateur darüber, dass er eine bestimmte Version des in diesem Abschnitt angegebenen Pakets benötigt.</font></font></li>
<li><code>optionalDependencies</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Sie listen optionale Abhängigkeiten auf, z. B. die Unfähigkeit zur Installation, die den Installationsprozess des Pakets nicht verletzt.</font></font></li>
<li><code>bundledDependencies</code> —    ,    .     ,    NPM,    ,             .</li>
</ul><br>
<h2><font color="#3AC1EF">   package-lock.json</font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir alle wissen, dass die Datei </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Verlauf der Projektarbeit ständig geändert wird. Etwas wird daraus entfernt, etwas wird hinzugefügt. Dies macht sich insbesondere beim Anzeigen von PR mit einer aktualisierten Version dieser Datei bemerkbar. Wir halten es oft für selbstverständlich. Eine Datei wird </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">automatisch generiert, wenn sich eine Datei </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder ein Ordner </font><font style="vertical-align: inherit;">ändert </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Auf diese Weise können Sie den Inhalt des Abhängigkeitsbaums genau so verwalten, wie er bei der Installation der Projektabhängigkeiten war. Auf diese Weise kann bei der Installation des Projekts der Abhängigkeitsbaum reproduziert werden. Dies löst das Problem, unterschiedliche Versionen desselben Pakets von unterschiedlichen Entwicklern zu haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich ein Projekt vor, dessen Abhängigkeiten React enthalten. Der entsprechende Eintrag ist verfügbar unter </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn Sie sich die Datei ansehen</font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Von diesem Projekt können Sie dann Folgendes sehen:</font></font><br>
<br>
<pre><code class="javascript hljs">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"react"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"version"</span>: <span class="hljs-string">"16.13.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"resolved"</span>: <span class="hljs-string">"https://registry.npmjs.org/react/-/react-16.13.0.tgz"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"integrity"</span>: <span class="hljs-string">"sha512-TSavZz2iSLkq5/oiE7gnFzmURKZMltmi193rm5HEoUDAXpzT9Kzw6oNZnGoai/4+fUnm7FqS5dwgUL34TujcWQ=="</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"requires"</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"loose-envify"</span>: <span class="hljs-string">"^1.1.0"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"object-assign"</span>: <span class="hljs-string">"^4.1.1"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"prop-types"</span>: <span class="hljs-string">"^15.6.2"</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Datei </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist eine große Liste von Projektabhängigkeiten. </font><font style="vertical-align: inherit;">Hier finden Sie die Abhängigkeitsversionen, Pfade (URIs) zu den Modulen, Hashes, mit denen die Integrität des Moduls überprüft wird, und die von diesem Modul benötigten Pakete. </font><font style="vertical-align: inherit;">Wenn Sie diese Datei lesen, finden Sie Aufzeichnungen aller Pakete, die React benötigt. </font><font style="vertical-align: inherit;">Hier liegt die wahre Hölle der Abhängigkeiten. </font><font style="vertical-align: inherit;">Hier wird alles beschrieben, was das Projekt benötigt.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundlegendes zu Gatsby.js-Abhängigkeiten</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie kommt es, dass wir, nachdem wir nur eine Abhängigkeit hergestellt haben, dem Projekt bis zu 19.000 Abhängigkeiten hinzufügen? </font><font style="vertical-align: inherit;">Es geht um Abhängigkeiten. </font><font style="vertical-align: inherit;">Deshalb haben wir, was wir haben:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm install --save gatsby<font></font>
<font></font>
...<font></font>
<font></font>
+ gatsby@2.19.28<font></font>
added 1 package from 1 contributor, removed 9 packages, updated 10 packages and audited 19001 packages <span class="hljs-keyword">in</span> 40.382s
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie nachsehen </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, finden Sie dort nur eine Abhängigkeit. Aber wenn Sie es sich ansehen </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, stellt sich heraus, dass vor uns ein fast 14-Kilobyte-Monster steht. Eine detailliertere Antwort darauf, was all diese Codezeilen bedeuten </font></font><code>package-lock.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, finden Sie in der Datei </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository von Gatsby.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt viele direkte Abhängigkeiten, nämlich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nach npm-Berechnungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 132. Wenn jede dieser Abhängigkeiten mindestens eine weitere Abhängigkeit aufweist, verdoppelt sich die Gesamtzahl der Projektabhängigkeiten - und es gibt 264 Abhängigkeiten. In der realen Welt ist das natürlich nicht so. Jede direkte Projektabhängigkeit hat mehr als eine inhärente Abhängigkeit. Infolgedessen ist die Liste der Projektabhängigkeiten sehr lang.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir interessieren uns beispielsweise dafür, wie oft die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lodash-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek als Abhängigkeit für andere Pakete verwendet wird </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm ls lodash<font></font>
example-js-package@1.0.0<font></font>
└─┬ gatsby@2.19.28<font></font>
&nbsp;&nbsp;├─┬ @babel/core@7.8.6<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/generator@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ ├─┬ @babel/types@7.8.6<font></font>
&nbsp;&nbsp;│ │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @babel/traverse@7.8.6<font></font>
&nbsp;&nbsp;│ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ @typescript-eslint/parser@2.22.0<font></font>
&nbsp;&nbsp;│ └─┬ @typescript-eslint/typescript-estree@2.22.0<font></font>
&nbsp;&nbsp;│ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;├─┬ babel-preset-gatsby@0.2.29<font></font>
&nbsp;&nbsp;│ └─┬ @babel/preset-env@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-block-scoping@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-classes@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-define-map@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; ├─┬ @babel/plugin-transform-modules-amd@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; │ └─┬ @babel/helper-module-transforms@7.8.6<font></font>
&nbsp;&nbsp;│ &nbsp; │ &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;│ &nbsp; └─┬ @babel/plugin-transform-sticky-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; └─┬ @babel/helper-regex@7.8.3<font></font>
&nbsp;&nbsp;│ &nbsp; &nbsp; &nbsp; └── lodash@4.17.15&nbsp; deduped<font></font>
&nbsp;&nbsp;...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Glücklicherweise werden die meisten dieser Abhängigkeiten durch dieselbe Version von lodash dargestellt. </font><font style="vertical-align: inherit;">Bei diesem Ansatz gibt </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es nur einen Ordner für die lodash-Bibliothek. </font><font style="vertical-align: inherit;">Dies ist normalerweise nicht ganz der Fall. </font><font style="vertical-align: inherit;">Manchmal benötigen unterschiedliche Pakete unterschiedliche Versionen desselben Pakets. </font><font style="vertical-align: inherit;">Aus diesem Grund tauchten viele Witze über die enorme Größe des Ordners auf </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In unserem Fall ist jedoch nicht alles so schlecht:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh node_modules<font></font>
200M&nbsp; &nbsp; node_modules<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
200 Megabyte sind nicht so schlecht. </font><font style="vertical-align: inherit;">Ich habe gesehen, wie leicht die Größe dieses Ordners 700 MB erreicht. </font><font style="vertical-align: inherit;">Wenn Sie erfahren möchten, welche Module am meisten Platz beanspruchen, können Sie den folgenden Befehl ausführen:</font></font><br>
<br>
<pre><code class="bash hljs">$ du -sh ./node_modules/* | sort -nr | grep <span class="hljs-string">'\dM.*'</span><font></font>
&nbsp;17M&nbsp; &nbsp; ./node_modules/rxjs<font></font>
8.4M&nbsp; &nbsp; ./node_modules/@types<font></font>
7.4M&nbsp; &nbsp; ./node_modules/core-js<font></font>
6.8M&nbsp; &nbsp; ./node_modules/@babel<font></font>
5.4M&nbsp; &nbsp; ./node_modules/gatsby<font></font>
5.2M&nbsp; &nbsp; ./node_modules/eslint<font></font>
4.8M&nbsp; &nbsp; ./node_modules/lodash<font></font>
3.6M&nbsp; &nbsp; ./node_modules/graphql-compose<font></font>
3.6M&nbsp; &nbsp; ./node_modules/@typescript-eslint<font></font>
3.5M&nbsp; &nbsp; ./node_modules/webpack<font></font>
3.4M&nbsp; &nbsp; ./node_modules/moment<font></font>
3.3M&nbsp; &nbsp; ./node_modules/webpack-dev-server<font></font>
3.2M&nbsp; &nbsp; ./node_modules/caniuse-lite<font></font>
3.1M&nbsp; &nbsp; ./node_modules/graphql<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rxjs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein heimtückisches Paket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein einfacher Befehl, mit dem Sie die Größe des Ordners reduzieren </font></font><code>node_modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und seine Struktur vereinfachen können:</font></font><br>
<br>
<pre><code class="bash hljs">$ npm dedup<font></font>
moved 1 package and audited 18701 packages <span class="hljs-keyword">in</span> 4.622s<font></font>
<font></font>
51 packages are looking <span class="hljs-keyword">for</span> funding<font></font>
&nbsp;&nbsp;run `npm fund` <span class="hljs-keyword">for</span> details<font></font>
<font></font>
found 0 vulnerabilities<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deduplizierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versucht npm, die Struktur des Abhängigkeitsbaums zu vereinfachen, indem die von anderen Abhängigkeiten verwendeten Abhängigkeiten ermittelt und verschoben werden, damit sie gemeinsam genutzt werden können. Dies gilt für unser lodash-Beispiel. Viele Pakete werden daher verwendet </font></font><code>lodash @4.17.15</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um ihre Funktionsfähigkeit sicherzustellen. Es reicht aus, diese Version der Bibliothek nur einmal zu installieren. Dies ist natürlich die Situation, in die wir von Anfang an geraten, nur indem wir Abhängigkeiten herstellen. Wenn Sie während der Arbeit an einem Projekt </font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neue Abhängigkeiten hinzufügen, wird manchmal empfohlen, sich an das Team zu erinnern </font></font><code>npm dedup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn Sie den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Garnpaket-</font></a><font style="vertical-align: inherit;"> Manager verwenden, sieht ein ähnlicher Befehl wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Garn-Deduplizierung aus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tatsächlich besteht jedoch keine Notwendigkeit dafür, da die Abhängigkeitsoptimierung automatisch ausgeführt wird, wenn der Befehl ausgeführt wird </font></font><code>yarn install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeitsvisualisierung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interessiert an einer grafischen Darstellung der Abhängigkeiten Ihres Projekts? </font><font style="vertical-align: inherit;">In diesem Fall können Sie eine solche Präsentation mit speziellen Tools erstellen. </font><font style="vertical-align: inherit;">Betrachten wir einige davon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Ergebnis der Abhängigkeitsvisualisierung wurde mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm.anvaka.com/ erhalten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfb/f5d/373/dfbf5d37377bd62f4ea5cf422de62c74.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeitsvisualisierung mit npm.anvaka.com.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Hier sehen Sie die Abhängigkeiten der Abhängigkeiten des Gatsby.js-Projektpakets. Das Ergebnis ähnelt einem riesigen Web. Das Gatsby.js-Projekt hat so viele Abhängigkeiten, dass dieses "Web" meinen Browser fast "hängen" ließ.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nun</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wenn Sie interessiert sind, einen Link zu diesem Diagramm. Es kann in 3D-Form dargestellt werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist eine Visualisierung, die mit</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npm.broofa.com erstellt wurde</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/285/cd6/c52/285cd6c52a00d9e87a7bc2095df6023f.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Fragment einer Abhängigkeitsvisualisierung, die mit npm.broofa.com erstellt wurde.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dies ähnelt einem Flussdiagramm. </font><font style="vertical-align: inherit;">Für Gatsby.js stellt sich heraus, dass sie sehr kompliziert ist. </font><font style="vertical-align: inherit;">Sie können es</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ansehen</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Schaltungselemente können basierend auf Schätzungen von</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> npms.io eingefärbt werden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie können Ihre eigene Datei auf die Site hochladen</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Tool "</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Package Phobia"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können Sie herausfinden, wie viel Speicherplatz benötigt wird, bevor Sie ein Paket installieren.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25c/d26/ae4/25cd26ae4fc708f0c6900c5ad3a5dead.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit Package Phobia empfangene Paketinformationen</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Hier erfahren Sie, wie groß das veröffentlichte Paket ist und wie viel Speicherplatz nach der Installation benötigt wird.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit: Mit großer Kraft geht große Verantwortung einher</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende möchte ich sagen, dass JavaScript und NPM großartige Werkzeuge sind. </font><font style="vertical-align: inherit;">Das Gute ist, dass moderne Entwickler die Möglichkeit haben, eine Vielzahl von Abhängigkeiten zu nutzen. </font><font style="vertical-align: inherit;">Das Ausführen des Befehls </font></font><code>npm install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um sich das Schreiben einiger Codezeilen zu ersparen, ist so einfach, dass wir manchmal die Konsequenzen vergessen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie bis zu diesem Punkt gelesen haben, sollten Sie die Funktionen der Abhängigkeitsbaumstruktur des npm-Projekts besser verstehen. </font><font style="vertical-align: inherit;">Wenn Sie dem Projekt eine Bibliothek hinzufügen, die sehr groß ist, oder wenn Sie nur die Abhängigkeiten Ihres Projekts untersuchen, können Sie immer das nutzen, was wir hier besprochen haben, und die Abhängigkeiten analysieren. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Möchten Sie in Ihren npm-Projekten so wenig Abhängigkeiten wie möglich verwenden?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/a_/bs/aa/a_bsaactpbr8fltzymtkhqbw1d4.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499656/index.html">Simulation des PID-Temperaturreglers</a></li>
<li><a href="../de499658/index.html">Ein Arbeiter statt eines Testers? Lohnt es sich, 2020 Selen zu studieren?</a></li>
<li><a href="../de499662/index.html">Root-of-Trust für IoT und andere IoT-Sicherheitstrends</a></li>
<li><a href="../de499664/index.html">Portieren von APIs nach TypeScript als Problemlöser</a></li>
<li><a href="../de499666/index.html">PEP 572 (Zuweisungsausdrücke in Python 3.8)</a></li>
<li><a href="../de499670/index.html">Я перехожу на JavaScript</a></li>
<li><a href="../de499674/index.html">Ein weiterer Schritt zu optischen Computern</a></li>
<li><a href="../de499676/index.html">Über 90 nützliche Tools für Kubernetes: Bereitstellung, Verwaltung, Überwachung, Sicherheit und mehr</a></li>
<li><a href="../de499680/index.html">Kubernetes lernen: Basic 14.-16. Mai, Advanced 18.-20. Mai</a></li>
<li><a href="../de499682/index.html">Was kann ich beim Hackathon außer einem Geldpreis bekommen?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>