<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘🏽 🕺🏽 🖋️ Travailler avec des cookies en JavaScript pur sans maux de tête 🕍 🤴🏾 👋🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr!
 

J'ai récemment rencontré le besoin de travailler avec des cookies en utilisant JavaScript. Quand j'ai vu à quel point c'était horrib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Travailler avec des cookies en JavaScript pur sans maux de tête</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501724/"><h1 id="privet-habr"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr!</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai récemment rencontré le besoin de travailler avec des cookies en utilisant JavaScript. </font><font style="vertical-align: inherit;">Quand j'ai vu à quel point c'était horrible de travailler avec </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">document.cookie</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en pur JavaScript, je suis allé à la recherche d'une bibliothèque pour la commodité de travailler avec les cookies. </font><font style="vertical-align: inherit;">Il s'est avéré que peu de bibliothèques pour travailler avec les cookies, bien qu'à première vue semblent simples et pratiques, dans le processus de travail avec eux, de nombreux pièges ont été découverts.</font></font><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En voici quelques uns:</font></font></p><br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réception de cookies sur un chemin spécifié</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - certaines des bibliothèques testées ont eu des problèmes d'accès aux cookies avec un chemin: par exemple, je ne pouvais pas obtenir de cookies avec un chemin à partir d'une page de site Web, </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou vice versa, étant à la "racine" d'un site, je l'ai reçu plusieurs fois </font></font><code>undefined</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lorsque j'ai essayé d'obtenir des cookies sur un spécifié le chemin</font></font><code>/order</code></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prise en charge JSON</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cela se produit, mais cela fonctionne de manière tordue: par exemple, lorsque vous recevez un cookie qui stocke JSON, vous obtiendrez une chaîne codée URI que vous devrez décoder et analyser vous-même. </font><font style="vertical-align: inherit;">Connecter la bibliothèque à votre code et ajouter des fonctions pour résoudre ce problème est en quelque sorte faux.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppression des cookies</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - toutes les bibliothèques ont eu des problèmes avec la suppression des cookies. </font><font style="vertical-align: inherit;">Presque tout le monde a effacé la valeur des cookies, mais ne l'a pas supprimée. </font><font style="vertical-align: inherit;">Des problèmes distincts se posaient avec les cookies de session: certaines bibliothèques ne les voyaient pas «à blanc» et aucune d'entre elles ne pouvait supprimer les cookies de session.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ne nommerai pas les bibliothèques que j'ai essayées, car je ne pense pas que ce soit correct par rapport à leurs développeurs, mais je préciserai que j'ai essayé les bibliothèques les plus populaires (selon </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) pour travailler avec les cookies.</font></font><br>
</blockquote></li>
</ul><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le dernier problème m'avait complètement rendu furieux, et j'ai décidé qu'il était temps d'écrire ma propre bibliothèque pour travailler avec les cookies.</font></font></p><br>
<h2 id="cookiejs-npm---cookielibhttpsgithubcomunsstrennencookiejs"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cookie.js (npm - cookielib)</font></font></a></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette bibliothèque a résolu tous les problèmes ci-dessus, en préservant la petite taille de ses prédécesseurs et la facilité d'utilisation des fonctions.</font></font></p><br>
<h3 id="pochemu-sleduet-ispolzovat-eyo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi devriez-vous l'utiliser?</font></font></h3><br>
<ul>
<li>  ,  ,       .</li>
<li>  —  <strong>707 </strong></li>
<li>   -,     </li>
<li>  <strong>JSON</strong> " " (<strong>  JSON,     ,   JSON-,     JSON-</strong>)</li>
<li>      -</li>
<li>  <strong></strong>  (<strong> ES6!</strong>)</li>
<li>   JS (<strong> </strong>)</li>
<li>     <strong>npm</strong>,   <strong>CDN</strong>,         </li>
</ul><br>
<h3 id="nemnogo-o-rabote-s-bibliotekoy">    </h3><br>
<p>  :</p><br>
<pre><code class="javascript hljs">setCookie(<span class="hljs-string">'name'</span>, <span class="hljs-string">'value'</span>);  <span class="hljs-comment">//  </span>
setCookie(<span class="hljs-string">'name'</span>, {<span class="hljs-string">'key'</span>: <span class="hljs-string">'value'</span>});  <span class="hljs-comment">// json </span></code></pre><br>
<p> "" :</p><br>
<pre><code class="javascript hljs">setCookie(<span class="hljs-string">'name'</span>, <span class="hljs-string">'value'</span>, {<span class="hljs-attr">expires</span>: <span class="hljs-built_in">Date</span>(<span class="hljs-number">3</span>)});  <span class="hljs-comment">//   </span>
setCookie(<span class="hljs-string">'name'</span>, {<span class="hljs-string">'key'</span>: <span class="hljs-string">'value'</span>}, {<span class="hljs-attr">expires</span>: <span class="hljs-built_in">Date</span>(<span class="hljs-number">3</span>)});  <span class="hljs-comment">// json  </span></code></pre><br>
<h4 id="s-funkciey-setcookie-mozhno-zadat-lyubye-parametry-kuki-parametry-mozhno-nayti-nizheoptions">  <code>setCookie()</code>     .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>.</h4><br>
<p> :</p><br>
<pre><code class="javascript hljs">getCookie(<span class="hljs-string">'name'</span>)  <span class="hljs-comment">//  </span>
getCookie(<span class="hljs-string">'name'</span>, json=<span class="hljs-literal">true</span>)  <span class="hljs-comment">//   json,    json.   JSON</span></code></pre><br>
<p> :</p><br>
<pre><code class="javascript hljs">deleteCookie(<span class="hljs-string">'name'</span>);  <span class="hljs-comment">// json   -  !</span></code></pre><br>
<h3 id="a-nameoptionsaparametry-kuki"> </h3><br>
<p>   ,   <code>setCookie(name, value, dict)</code>,  <strong>dict</strong>    " ": " "</p><br>
<h4 id="spisok-klyuchey-znacheniy"> -:</h4><br>
<ul>
<li><strong>path</strong> (str) — URL,    </li>
<li><strong>domain</strong> (str) — ,    </li>
<li><strong>expires</strong> (Date object) —  ""  (/   Date-)</li>
<li><strong>max-age</strong> (int) —      (  <strong>expires</strong>)</li>
<li><strong>secure</strong> (bool) —  true,     HTTPS. <strong>   false </strong></li>
<li><strong>samesite</strong> (str) — ,     XSRF-…    strict  lax.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">  </a>,           .<br>
<ul>
<li><strong>httpOnly</strong> (bool) —  true,           JavaScript. <strong>   false </strong></li>
</ul></li>
</ul><br>
<h3 id="zaklyuchenie"></h3><br>
<p>          ,     . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><strong>  GitHub</strong></a>.    .</p><br>
<h3 id="primechaniya"></h3><br>
<p>  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">printf</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">RekGRpth</a>.   !</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501710/index.html">Pour quelles niches la crise 2020 est le meilleur moment pour le développement</a></li>
<li><a href="../fr501712/index.html">Parler de tests: quelques histoires et une enquête</a></li>
<li><a href="../fr501714/index.html">L'école 42 comme principale réponse à la vie informatique, à l'univers de la programmation et à tout cela</a></li>
<li><a href="../fr501716/index.html">Défi accepté ou tâches que les ingénieurs de Lamoda résolvent</a></li>
<li><a href="../fr501722/index.html">Comet - Framework PHP pour les API REST rapides</a></li>
<li><a href="../fr501730/index.html">ProxySQL - un outil pour démultiplexer les connexions</a></li>
<li><a href="../fr501734/index.html">[Style Geektimes] Notre avenir technologique: prédictions d'experts</a></li>
<li><a href="../fr501736/index.html">Comment nous sommes passés à Udalenka il y a six mois en raison de l'optique hachée</a></li>
<li><a href="../fr501738/index.html">13 mai Java Digest</a></li>
<li><a href="../fr501742/index.html">Transport le 13 mai: uiiii, nous avons pris la deuxième place en termes de nombre de patients, il est temps de lever les restrictions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>