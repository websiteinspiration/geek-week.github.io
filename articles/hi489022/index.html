<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯШХ ЁЯШо ЁЯЩОЁЯП┐ MonsterMQ рдкрд╛рд░реНрдЯ 2 рдХреЗ рд╕рд╛рде RabbitMQ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ ЁЯСйЁЯП╝тАНЁЯОд тЮбя╕П ЁЯСВЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(рд╕реЗ рд▓реА рдЧрдИ рдЪрд┐рддреНрд░ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ RabbitMQ рд╡реЗрдмрд╕рд╛рдЗрдЯ )
 
 рдореЗрдВ рдкрд╣рд▓рд╛ рд▓реЗрдЦ, рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдкрдпреЛрдЧ RabbitMQ рджреЛ рдкреАрдПрдЪрдкреА рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдиреЗ рд▓рд┐рдЦрд╛ рд╣реИ: рдПрдХ рднреЗрдЬреЗ рдЧрдП рд╕рдВрджреЗрд╢реЛрдВ, рдЕрдиреНрдп...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MonsterMQ рдкрд╛рд░реНрдЯ 2 рдХреЗ рд╕рд╛рде RabbitMQ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489022/"><img src="https://habrastorage.org/getpro/habr/post_images/640/66e/579/64066e579d113ef3373c9a3c2c3e75ce.png" alt="рдЫрд╡рд┐"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рд╕реЗ рд▓реА рдЧрдИ рдЪрд┐рддреНрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ RabbitMQ рд╡реЗрдмрд╕рд╛рдЗрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рд▓реЗрдЦ,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдкрдпреЛрдЧ RabbitMQ рджреЛ рдкреАрдПрдЪрдкреА рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдиреЗ рд▓рд┐рдЦрд╛ рд╣реИ: рдПрдХ рднреЗрдЬреЗ рдЧрдП рд╕рдВрджреЗрд╢реЛрдВ, рдЕрдиреНрдп рдХрд╛ рд╕реНрд╡рд╛рдЧрдд рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдПрдХ рдХрддрд╛рд░ рдХреИрд╕реЗ рдмрдирд╛рдИ рдЬрд╛рдП рдЬреЛ рдРрд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░реЗрдЧреА рдЬреЛ рдХрдИ рд╢реНрд░рдорд┐рдХреЛрдВ (рд╕рдВрджреЗрд╢ рд╕рдВрдЪрд╛рд▓рдХреЛрдВ) рдХреЗ рдмреАрдЪ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рддреНрд░рд╛ рдореЗрдВ рдЙрдкрднреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░ рдЙрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИ рдЬреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рддреНрд░рд╛ рдореЗрдВ рддреБрд░рдВрдд рдЙрдкрднреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдмрд▓реНрдХрд┐ рдЙрдиреНрд╣реЗрдВ рд╕рдВрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдмрд╛рдж рдореЗрдВ, рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХрд░реНрдордЪрд╛рд░реА рдХреЛ рдХрддрд╛рд░ рд╕реЗ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд╣ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЕрд╡рдзрд╛рд░рдгрд╛ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИ, рдЬрд╣рд╛рдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреБрдЫ рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреА рддреБрд░рдВрдд рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдпрд╛ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдп (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, libcurl рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдкреАрдПрдЪрдкреА)ред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд╛рдирд╛ рдмрдирд╛рдирд╛</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВрдЧреЗ рдЬреЛ рд╢реНрд░рдорд┐рдХреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░реЗрдВрдЧреЗред рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрд╛рд░реНрдп рдирд╣реАрдВ рд╣реИрдВ, рдЬреИрд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдирд╛ рдпрд╛ рдкреАрдбреАрдПрдл рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛, рд╣рдо рджрд┐рдЦрд╛рд╡рд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдВрдж ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╡реНрдпрд╕реНрдд рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рд╣рдо рд╕рдВрджреЗрд╢ рдореЗрдВ рдЕрдВрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрд╛рд░реНрдп рдХреА рдЬрдЯрд┐рд▓рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрдВрдЧреЗред рдкреНрд░рддреНрдпреЗрдХ рдбреЙрдЯ рдХрд╛ рдЕрд░реНрде рд╣реЛрдЧрд╛ рдХрд╛рдо рдХрд╛ рдПрдХ рд╕реЗрдХрдВрдб, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИрд▓реЛ ...</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрджреЗрд╢ </font><font style="vertical-align: inherit;">рддреАрди рд╕реЗрдХрдВрдб рдХрд╛ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдЕрдкрдиреЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдХреНрд░рд┐рдкреНрдЯ </font><font style="vertical-align: inherit;">рдХреЛ рдкрд┐рдЫрд▓реЗ рдкрд╛рда рд╕реЗ </font><font style="vertical-align: inherit;">рдереЛрдбрд╝рд╛ </font><b><font style="vertical-align: inherit;">рд╕рдВрд╢реЛрдзрд┐рдд</font></b><font style="vertical-align: inherit;"> рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдпрд╣ рдордирдорд╛рдирд╛ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХреЗред</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $producer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
<font></font>
   $message = implode(<span class="hljs-string">' '</span>, array_slice($argv, <span class="hljs-number">1</span>));<font></font>
   $message = <span class="hljs-keyword">empty</span>($message) ? <span class="hljs-string">'Hello world!'</span> : $message;<font></font>
<font></font>
   $producer-&gt;publish($message, <span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Sent {$message} \n"</span>;<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реА рдкреНрд░рд╛рдкреНрддред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ </font><font style="vertical-align: inherit;">рднреА рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдСрдкрд░реЗрд╢рди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЪрд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдХреЛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрдХрд░реНрддрд╛</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдирд╛рдо рдкрд░ </font><b><font style="vertical-align: inherit;">рд░рдЦреЗрдВред</font></b><font style="vertical-align: inherit;"> рдЗрд╕рдореЗрдВ рдирд┐рдореНрди рдХреЛрдб рд▓рд┐рдЦреЗрдВ рдФрд░ рд▓рд┐рдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
<font></font>
   $consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $consumer-&gt;wait(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$message, $channelNumber</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$consumer</span>)</span>{
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Received: {$message}"</span>;<font></font>
      sleep(substr_count($message, <span class="hljs-string">'.'</span>));
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Done"</span>;<font></font>
   });<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рджреЛрдиреЛрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯрд░реНрдорд┐рдирд▓реЛрдВ рдореЗрдВ рдЪрд▓рд╛рдПрдВ:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 1</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 2</span>
php send.php <span class="hljs-string">"A very hard task which takes two seconds.."</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд╛рд░реНрдп рдХрддрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд╛рднреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрдИ рд╢реНрд░рдорд┐рдХреЛрдВ рдХреЗ рдмреАрдЪ рдХрд╛рдо рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╣реА рдмрд╛рд░</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯрд░реНрдорд┐рдирд▓реЛрдВ рдореЗрдВ рджреЛ </font><b><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрдХрд░реНрддрд╛.php</font></b><font style="vertical-align: inherit;"> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдФрд░ рддреАрд╕рд░реЗ рдореЗрдВ рд╣рдо </font><b><font style="vertical-align: inherit;">send.php</font></b><font style="vertical-align: inherit;"> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВрдЧреЗ</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 1</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 2</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment"># Shell 3</span><font></font>
php new_task.php First message.<font></font>
php new_task.php Second message..<font></font>
php new_task.php Third message...<font></font>
php new_task.php Fourth message....<font></font>
php new_task.php Fifth message.....<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХреНрдпрд╛ рд▓реЗрдХрд░ рдЖрдП:</font></font><br>
<pre><code class="php hljs"><span class="hljs-comment"># shell 1</span><font></font>
php worker.php<font></font>
<span class="hljs-comment"># Received: First message.</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Third message...</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Fifth message.....</span>
<span class="hljs-comment"># Done</span>
</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment"># shell 2</span><font></font>
php worker.php<font></font>
<span class="hljs-comment"># Received: Second message..</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Fourth message....</span>
<span class="hljs-comment"># Done</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, RabbitMQ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдж рдХреЗ рд╕рдВрджреЗрд╢ рдХреЛ рдЕрдЧрд▓реЗ рдЦрдкрдд рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рдмрджрд▓реЗ рдореЗрдВ рднреЗрдЬ рджреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдФрд╕рддрди, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рд╕рдорд╛рди рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдВрдЧреЗ, рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рдЗрд╕ рддрд░реАрдХреЗ рдХреЛ рд░рд╛рдЙрдВрдб-рд░реЙрдмрд┐рди (рдПрдХ рд╕рд░реНрдХрд▓ рдореЗрдВ) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рддреАрди рдпрд╛ рдЕрдзрд┐рдХ рд╢реНрд░рдорд┐рдХреЛрдВ рдХреЗ рд╕рд╛рде рдпрд╣ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрджреЗрд╢ рдХреА рдкреБрд╖реНрдЯрд┐</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд╛рд░реНрдп рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╢рд╛рдпрдж рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдВрджреЗрд╢ рдХрд╛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рдЖрдк рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЗ рдХрд╛рдо рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдиреЗ рдЗрд╕ рд╕рдВрджреЗрд╢ рдХреЛ рдЕрдВрдд рддрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдирд╣реАрдВ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд╡рд░реНрддрдорд╛рди рдХреЛрдб рдХреЗ рд╕рд╛рде, рд╕рдВрджреЗрд╢ рдХрддрд╛рд░ рдореЗрдВ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ MONMQ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдВрджреЗрд╢ рдкрд╛рд╡рддреА рд╕рдХреНрд╖рдо рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рд╣рдо рд╕рдВрджреЗрд╢ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо RabbitMQ рдХреЛ рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдЗрд╕реЗ рдХрддрд╛рд░ рд╕реЗ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдЕрдзрд┐рдХрд╛рд░ рд╣реИред рдпрджрд┐ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдиреЗ рдкреБрд╖реНрдЯрд┐ рдХрд┐рдП рдмрд┐рдирд╛ рдЕрдкрдирд╛ рдХрд╛рдо рдкреВрд░рд╛ рдХрд┐рдпрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреАрд╕реАрдкреА рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕рдорд╛рдкреНрддрд┐ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк), RabbitMQ рд╕рдордЭ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рд╕рдВрджреЗрд╢ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рд╣реБрдЖ рдерд╛ рдФрд░ рдЗрд╕реЗ рдХрддрд╛рд░ рдореЗрдВ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдЧрд╛, рдЗрд╕реЗ рдЕрдиреНрдп рдЙрдкрд▓рдмреНрдз рд╢реНрд░рдорд┐рдХреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЖрдк рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХреЗ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдмрдВрдж рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рднреА рд╕рдВрджреЗрд╢ рдЦреЛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MonsterMQ рдореЗрдВ рд╕рдВрджреЗрд╢ рдкрд╛рд╡рддреА рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк </font><b><font style="vertical-align: inherit;">рдЙрдкрднреЛрдЧ</font></b><font style="vertical-align: inherit;"> рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИрдВ ()</font></font></b><br>
<br>
<pre><code class="php hljs">$consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>, <span class="hljs-literal">true</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢реЛрдВ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЛ рднреВрд▓рдирд╛ рдХрд╛рдлреА рд╕рд╛рдорд╛рдиреНрдп, рдЖрд╕рд╛рдиреА рд╕реЗ рд╕рд╣рди рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рддреНрд░реБрдЯрд┐ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЧрдВрднреАрд░ рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рдВрджреЗрд╢ рдмрд╛рд░-рдмрд╛рд░ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ рдФрд░ рдЕрдзрд┐рдХ рд╕реЗ рдЕрдзрд┐рдХ рдореЗрдореЛрд░реА рд▓реЗрдиреЗ рд╡рд╛рд▓реА рдХрддрд╛рд░реЛрдВ рдореЗрдВ рднреА рдЬрдорд╛ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдбреАрдмрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rabbitmqctl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ </font><b><font style="vertical-align: inherit;">рдХрд░рдХреЗ </font></b><b><font style="vertical-align: inherit;">messages_unacknowledged</font></b><font style="vertical-align: inherit;"> рдлрд╝реАрд▓реНрдб рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВ</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="bash hljs">sudo rabbitmqctl list_queues name messages_ready messages_unacknowledged</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦрд┐рдбрд╝рдХрд┐рдпреЛрдВ рдкрд░, рд╕реВрдбреЛ рдХреЛ рдЧрд┐рд░рд╛рдПрдВ</font></font><br>
<br>
<pre><code class="bash hljs">rabbitmqctl.bat list_queues name messages_ready messages_unacknowledged</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрддрд╛рд░ рд╕реБрд░рдХреНрд╖рд╛</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рд╣рдорд╛рд░реЗ рд╕рдВрджреЗрд╢ рдЦреЛ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреЗ рдпрджрд┐ рд╢реНрд░рдорд┐рдХреЛрдВ рдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рдЕрдирдкреЗрдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрддрд╛ рд╣реИ, рдлрд┐рд░ рднреА, рд╣рдо рдЕрднреА рднреА рдмрдирд╛рдП рдЧрдП рдХрддрд╛рд░реЛрдВ рдХреЛ рдЦреЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ RabbitMQ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦреБрдж рдХреЛ рдХрддрд╛рд░реЛрдВ рд╕реЗ рдЦреЛрдиреЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХрддрд╛рд░ рдХреЛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯрд┐рдХрд╛рдК</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рд▓рдЧрд╛рддрд╛рд░, рдЯрд┐рдХрд╛рдК) </font><font style="vertical-align: inherit;">рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЪреВрдБрдХрд┐ рдХрддрд╛рд░реЗрдВ рдЙрджрд╛рд╕реАрди рд╣реЛрддреА рд╣реИрдВ, рдЕрд░реНрдерд╛рдд, рд╣рдо рдШреЛрд╖рдгрд╛ рд╡рд┐рдзрд┐ рдХреЛ рдЙрд╕реА рдирд╛рдо рд╕реЗ рдкреБрдХрд╛рд░рддреЗ рд╣реБрдП рдЙрд╕реЗ рдмрджрд▓ рдпрд╛ рдкреБрди: рдирд┐рд░реНрдорд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рд╣рдореЗрдВ рдПрдХ рдирдИ рдХрддрд╛рд░ рдШреЛрд╖рд┐рдд рдХрд░рдиреА рд╣реЛрдЧреАред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд░рддреЗ рд╣реИрдВ</font></font><br>
<br>
<pre><code class="php hljs">$consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░реЗрд╖рдХ рдХреЛрдб рдореЗрдВ рдХрддрд╛рд░ рдШреЛрд╖рдгрд╛ рдХреЛрдб рдХреЛ рдмрджрд▓рдирд╛ рднреА рдпрд╛рдж рд░рдЦреЗрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдЪрд┐рдд рд╡рд┐рддрд░рдг</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдкрдиреЗ рджреЗрдЦрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рд╣рдорд╛рд░реЗ рджреЛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдЕрднреА рднреА рд╕рдВрджреЗрд╢ рдИрдорд╛рдирджрд╛рд░реА рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдирд╣реАрдВ рд╣реБрдП рд╣реИрдВред рдпрджрд┐, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рднреА рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рд╖рдо рд╕рдВрджреЗрд╢ рдЬрд▓реНрджреА рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рдордп-рдЙрдкрднреЛрдХреНрддрд╛ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рд╣рдореЗрд╢рд╛ рд╡реНрдпрд╕реНрдд рд░рд╣реЗрдЧрд╛, рдЬрдмрдХрд┐ рджреВрд╕рд░рд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реЛрдЧрд╛ред рдЗрд╕рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд╡рд╛ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХрд╛</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рдЪрд▓рд┐рдП рд╣рдорд╛рд░реЗ рдХреЛрдб рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ</font></font><br>
<br>
<pre><code class="php hljs">$consumer-&gt;qos()-&gt;prefetchCount(<span class="hljs-number">1</span>)-&gt;perConsumer()-&gt;apply();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд▓рд╛рдЗрди RabbitMQ рдХреЛ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдХрд╣рддреА рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрддрдорд╛рди рд╕рдВрджреЗрд╢ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perConsumer ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЗ рд╕рднреА рдЪреИрдирд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рд╡рд░реНрддрдорд╛рди рдЪреИрдирд▓ рдкрд░ рдХреЗрд╡рд▓ рд╕реЗрд╡рд╛ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perChannel ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/270/e31/4b5/270e314b59a085e186e46b28e2593613.png" alt="рдЫрд╡рд┐"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдЫрд╡рд┐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕рд╛рдЗрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рд▓реА рдЧрдИ рд╣реИ </font><font style="vertical-align: inherit;">)</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрд░реЗ рдХреЛрдб рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдирд╛</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╣рдорд╛рд░реЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдкреНрд░реЗрд╖рдХ) рдХреА </font><font style="vertical-align: inherit;">рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();<font></font>
<font></font>
   $message = implode(<span class="hljs-string">' '</span>, array_slice($argv, <span class="hljs-number">1</span>));<font></font>
   $message = <span class="hljs-keyword">empty</span>($message) ? <span class="hljs-string">'Hello world!'</span> : $message;<font></font>
<font></font>
   $producer-&gt;publish($message, <span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Sent {$message} \n"</span>;<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЗрд╕рд▓рд┐рдП рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ред рдПрдлрдкреА</font></font></b><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();<font></font>
<font></font>
   $consumer-&gt;qos()-&gt;prefetchCount(<span class="hljs-number">1</span>)-&gt;perConsumer()-&gt;apply();<font></font>
<font></font>
   $consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $consumer-&gt;wait(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$message, $channelNumber</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$consumer</span>)</span>{
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Received: {$message}"</span>;<font></font>
      sleep(substr_count($message, <span class="hljs-string">'.'</span>));
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Done"</span>;<font></font>
   });<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╕ рдЗрддрдирд╛ рд╣реА, рдЕрдЧрд▓реЗ рдкрд╛рда рдореЗрдВ рд╣рдо рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рдПрдХ рд╣реА рдХрддрд╛рд░ рд╕реЗ рдХрдИ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рд╕рдВрджреЗрд╢ рдХреИрд╕реЗ рднреЗрдЬреЗрдВред</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi489010/index.html">рд╣рдо рднрд╛рд╖рд╛рд╡рд┐рдЬреНрдЮрд╛рди, рд╡реИрдпрдХреНрддрд┐рдХрд░рдг, рдкреЗрдбрд┐рд╕рд╛рдЗрди, рдПрдордПрд▓ рдореЗрдВ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд╕рд╛рде рдСрдирд▓рд╛рдЗрди рд╕реАрдЦрдиреЗ рдкрд░ рдбреЗрдЯрд╛ рдХреА рд╕рдмрд╕реЗ рдмрдбрд╝реА рд░реВрд╕ рдкрд░рдд рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi489012/index.html">Google рдХреНрд▓рд╛рдЙрдб рд╕реНрдкреИрдирд░: рдЕрдЪреНрдЫрд╛, рдмреБрд░рд╛, рдмреБрд░рд╛</a></li>
<li><a href="../hi489014/index.html">рдкреБрд╕реНрддрдХ "рдкрд░рдлреЗрдХреНрдЯ рдЕрд▓реНрдЧреЛрд░рд┐рдердоред рд▓рд╛рд▓рдЪреА рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдЧрддрд┐рд╢реАрд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ ┬╗</a></li>
<li><a href="../hi489016/index.html">рдЬрд░реНрдорди рдЧреНрд░реАрдл: "рд╣рдордиреЗ рдПрдЬреАрдЖрдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдЪрд░реНрдЪрд╛ рдЖрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдФрд░ рдПрдХ рднреА рд╕реНрд╡рд╛рднрд┐рдорд╛рдиреА рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдЗрд╕рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдЖрдП"</a></li>
<li><a href="../hi489020/index.html">рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛ рдХрд╛ рдЕрдзреНрдпрдпрди</a></li>
<li><a href="../hi489024/index.html">рд╢реБрд░реБрдЖрдд рдХреА рдЖрдБрдЦреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдмрд┐рдХреНрд╕ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реАред рднрд╛рдЧ 5. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрдХреНрд╖ рдкрд░ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ</a></li>
<li><a href="../hi489026/index.html">Google AdSense рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдмрджрд▓рдирд╛ рд╕рд╛рдЗрдЯ рдорд╛рд▓рд┐рдХреЛрдВ рдФрд░ рд╡реЗрдмрдорд╛рд╕реНрдЯрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдиреЗрддреГрддреНрд╡ рдХрд░ рд╕рдХрддрд╛ рд╣реИ</a></li>
<li><a href="../hi489028/index.html">рджреВрд░рд╕реНрде рдХрд╛рд░реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi489034/index.html">рдирдпрд╛ рдпреВрдЖрдИрдПрд╕ рдореЛрдмрд╛рдЗрд▓ рдРрдк - рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЦрд░реАрдж рдХреА рдорд╛рдВрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд╛ рдпрд╛ рдореЛрдХреНрд╖?</a></li>
<li><a href="../hi489038/index.html">рдкреБрд╕реНрддрдХ "рдЬрд╛рд╡рд╛ рдХреЙрдирдПрдЬреЗрдВрд╕реА рдЗрди рдкреНрд░реИрдХреНрдЯрд┐рд╕"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>