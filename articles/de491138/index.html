<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛍️ 🎌 ⛷️ Satelliten- und Ansible Tower-Integration 👩🏾‍🌾 🤛🏽 😓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Verwenden Sie Red Hat Satellite und Red Hat Ansible Automation Platform? Ab Satellite 6.3 können sie miteinander integriert werden, sodass Dynamic Inv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Satelliten- und Ansible Tower-Integration</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/491138/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden Sie Red Hat Satellite und Red Hat Ansible Automation Platform? Ab Satellite 6.3 können sie miteinander integriert werden, sodass Dynamic Inventory in Ansible Tower Hostlisten von Satellite abruft. Wenn die RHEL-Hosts mithilfe von Satellite (dh Bereitstellung) initialisiert werden, kann Ansible Tower in diesen Prozess integriert werden, sodass automatisch Konfigurationsskripts auf den neuen Hosts ausgeführt werden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/4o/so/qq4oso9wx_wxkl81ha7aiy1b18a.jpeg" width="100%"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beitrag werden wir uns ansehen, wie Sie Dynamic Inventory in Ansible Tower so konfigurieren, dass die Hosts von Satellite abgerufen werden, und anhand von Beispielen zeigen, wie Sie es verwenden. Außerdem zeigen wir Ihnen, wie Sie einen automatischen Anruf bei Ansible Tower organisieren, nachdem Sie einen neuen Host von Satellite aus initialisiert haben.</font></font><br>
<a name="habracut"></a><br>
<h3> 1.    Inventory.  Satellite,       Dynamic Inventory  Ansible Tower</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit Ansible Tower auf die Liste der Hosts, Hostgruppen und anderer zugehöriger Informationen zugreifen kann, ist ein Konto in Satellite erforderlich. Dieser Eintrag verfügt über genügend Mindestberechtigungen, sodass wir eine neue Rolle in Satellite erstellen, ihm nur die für Ansible Tower erforderlichen Berechtigungen erteilen, dann ein neues Konto erstellen und ihm diese Rolle zuweisen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satellite 6.6 und höher verfügt bereits über eine Ansible Tower Inventory Reader-Rolle, sodass Sie die folgenden Schritte überspringen können, um eine Rolle zu erstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Satellite 6.3-6.5 muss die Rolle von Hand erstellt werden. Gehen Sie dazu zur Satelliten-Weboberfläche, wechseln Sie zum Bildschirm Verwalten, wählen Sie Rollen aus und klicken Sie auf Rolle erstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nennen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diese Rolle </font><b><font style="vertical-align: inherit;">ansible_tower_integration_role</font></b><font style="vertical-align: inherit;"> und legen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standorte und Organisationen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dafür fest </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/oy/ey/ocoyeyrceo04wboamjmzv_2nnf0.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie auf Senden, um die Rolle zu erstellen. Klicken Sie danach auf ihren Namen und wechseln Sie zur Registerkarte Filter. Klicken Sie auf </font><font style="vertical-align: inherit;">die grüne Schaltfläche Filter Neu und fügen Sie </font><font style="vertical-align: inherit;">die folgenden Filter, einer nach dem anderen: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ressourcentyp: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moderator</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Permission: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">view_hosts</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ressourcentyp: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host - </font><font style="vertical-align: inherit;">Gruppe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Berechtigung: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">view_hostgroups</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ressourcentyp: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fact Wert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Permission: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">view_facts</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Als Ergebnis werden die folgenden Filter eine Rolle haben sollte:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/ia/r-/cciar-m-0-bz63n2lrijzatkbrg.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also haben wir eine Rolle geschaffen. Jetzt starten wir einen neuen Benutzer in Satellite. Gehen Sie dazu zum Menü </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwalten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wählen Sie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer aus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und klicken </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie auf Benutzer erstellen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nennen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diesen Benutzer </font><b><font style="vertical-align: inherit;">ansible_integration</font></b><font style="vertical-align: inherit;"> , ändern den Parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authorized by</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INTERNAL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und legen das Passwort fest. Wählen Sie dann auf den Registerkarten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standorte und Organisationen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die entsprechenden Standorte / Organisationen aus. </font><b><font style="vertical-align: inherit;">Wechseln</font></b><font style="vertical-align: inherit;"> Sie </font><font style="vertical-align: inherit;">schließlich zur Registerkarte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rollen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und weisen Sie diesem Benutzer die neu erstellte Rolle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ansible_tower_integration_role</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (wenn Sie über Satellite 6.3 - 6.5 verfügen) oder die integrierte Rolle </font><b><font style="vertical-align: inherit;">Ansible Tower Inventory Reader</font></b><font style="vertical-align: inherit;"> zu</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Satellit 6.6 und höher). </font><font style="vertical-align: inherit;">Klicken Sie abschließend auf Senden, um ein Konto für diesen Benutzer zu erstellen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passen Sie Ansible Tower an</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie nun zur Weboberfläche von Ansible Tower und zum Bildschirm mit den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmeldeinformationen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Klicken Sie auf das grüne </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ (Hinzufügen)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um einen neuen Eintrag für Anmeldeinformationen zu erstellen. </font><font style="vertical-align: inherit;">Wir nennen es </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satelliten_integration</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und geben im Anmeldeinformationstyp </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat Satellite 6 an</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dann geben wir die URL (in unserem Fall Satellite 6) sowie den Benutzernamen (in unserem Fall </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ansible_integration</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ein und das Passwort ist das, das wir oben in Satellite festgelegt haben:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yb/xd/ws/ybxdws81uadmggdncbl_icg-ig8.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dann auf </font><b><font style="vertical-align: inherit;">Speichern</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie nun zum Bildschirm " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inventare"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , klicken Sie auf die grüne Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ (Hinzufügen)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und wählen Sie " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inventar"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie satelliteninventar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Namen an </font><font style="vertical-align: inherit;">und klicken </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf </font><b><font style="vertical-align: inherit;">Speichern</font></b><font style="vertical-align: inherit;"> , um ein Inventar zu erstellen. Wechseln Sie danach zur Registerkarte Quellen des neu erstellten Inventars und klicken Sie auf die grüne Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ (Hinzufügen)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir verwenden </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Satellit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Quellennamen </font><font style="vertical-align: inherit;">und geben den Quelltyp als </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Red Hat Satellite 6 an</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Geben Sie im Feld Anmeldeinformationen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satellitenintegration an</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die im vorherigen Schritt erstellt wurde. Schalten Sie das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überschreiben Checkbox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überschreiben von Variablen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktualisieren beim Start</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Kontrollgruppe "Aktualisierungsoptionen" (Weitere Informationen zu diesen Optionen erhalten Sie über die Fragezeichen auf der rechten Seite). </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geben Sie außerdem im</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Feld </font><b><font style="vertical-align: inherit;">Cache-Zeitlimit (Sekunden)</font></b><font style="vertical-align: inherit;"> 90 ein und klicken Sie auf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0n/_2/0j/0n_20jc394t3fh9vkxz00cqda3w.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klicken Sie nun auf das Symbol </font><b><font style="vertical-align: inherit;">Synchronisierungsprozess starten</font></b><font style="vertical-align: inherit;"> 
, ohne die Registerkarte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu verlassen </font><font style="vertical-align: inherit;">:</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gz/ys/um/gzysumhr2fghwc0l-xymeofs7cu.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir warten, bis das Symbol grün wird - dies signalisiert einen erfolgreichen Abschluss der Synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können Sie zur Registerkarte Hosts gehen und die Daten anzeigen, die vom Satelliten abgerufen wurden:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/4_/qk/ne4_qk5ne8ohsfx3iriwkkdfbvm.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können sich auch die Registerkarte Gruppen ansehen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oj/sw/af/ojswafnsedywlukqweh3oib_hgu.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, wurden durch die Synchronisierung die Hostlisten nicht nur von Satellite abgerufen, sondern auch entsprechend den entsprechenden Inhaltsansichten in Satellite, Hostgruppen, Lebenszyklusumgebungen, Standorten und Organisationen in Gruppen unterteilt. </font><font style="vertical-align: inherit;">Diese Gruppierung kann verwendet werden, um Ansible-Skripte auf Zielhosts auszurichten, und dies ist eine sehr mächtige Sache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie auf der Registerkarte Hosts einen Host auswählen, werden zwischen Satellite und Ansible Tower viele Zusatzinformationen zum Host synchronisiert, die in Form von Variablen dargestellt werden. </font><font style="vertical-align: inherit;">Diese Variablen können dann in Ansible-Skripten verwendet werden:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/la/6o/fw/la6ofwr3cf91cfxktzok_0eoy7c.png"></div><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden von dynamischem Inventar, das an Satelliten gebunden ist</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also haben wir Satellite und Ansible Tower synchronisiert. Jetzt werden wir überlegen, wie wir es in der Praxis verwenden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am einfachsten ist es, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satelliteninventar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Inventarquelle in der Ansible Tower-Vorlage zu verwenden. Wenn im Skript </font><font style="vertical-align: inherit;">die </font><font style="vertical-align: inherit;">Option </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hosts: all</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angegeben ist </font><font style="vertical-align: inherit;">, wird das Skript auf allen Satellitenhosts ausgeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine erweiterte Option besteht darin, automatisch erstellte Inventargruppen in Skripten zu verwenden (wie sie erstellt werden - siehe oben). Mit anderen Worten, geben Sie die gewünschte Hostgruppe in der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hostzeile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an </font><font style="vertical-align: inherit;">. Beispiel: In diesem Szenario, in dem das Bildschirmpaket installiert ist:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
- name: Install screen package<font></font>
  hosts: "foreman_hostgroup_rhel6"<font></font>
  tasks:<font></font>
  - yum:<font></font>
      name: screen<font></font>
      state: installed<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier haben wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hosts</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registriert </font><b><font style="vertical-align: inherit;">: foreman_hostgroup_rhel6</font></b><font style="vertical-align: inherit;"> , wodurch die Liste der Hosts </font><b><font style="vertical-align: inherit;">angezeigt wird</font></b><font style="vertical-align: inherit;"> , die die rhel6-Hostgruppe im Satelliten bilden. </font><font style="vertical-align: inherit;">Dementsprechend wird das Skript nur auf diesen Hosts ausgeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus können Sie im Skript in der Hostzeile die Variablen angeben, die Ansible Tower während der Synchronisierung mit Satellite empfängt. </font><font style="vertical-align: inherit;">Zum Beispiel können Sie dies tun:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
- name: Install screen package<font></font>
  hosts: "{{ hosts_var }}"<font></font>
  tasks:<font></font>
  - yum:<font></font>
      name: screen<font></font>
      state: installed<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen können wir die Jobvorlage in Ansible Tower im laufenden Betrieb ändern und eine der Inventargruppen über eine externe Variable angeben.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jr/fe/iu/jrfeiulsq6wqesxwt-e1njpt2mm.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel wird die Vorlage nur auf Hosts ausgeführt, die Mitglieder der Gruppe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rhel7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Satellite sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus kann die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jobvorlage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so konfiguriert werden, dass der Benutzer beim Start nach dem Wert der Variablen </font><b><font style="vertical-align: inherit;">hosts_var gefragt</font></b><font style="vertical-align: inherit;"> wird </font><font style="vertical-align: inherit;">(und gleichzeitig die verfügbaren Inventargruppen in Form von Kommentaren angezeigt werden):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ad/lh/gl/adlhglvneyz5ettasl8vh1z_mag.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der obige Bildschirm zeigt die Situation, in der der Benutzer beim Starten der Vorlage aufgefordert wird, den Namen der Satelliteninventargruppe einzugeben, auf deren Hosts Sie das Skript ausführen möchten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus können Sie die Hostvariablen verwenden, die während der Synchronisierung aus Satellite abgerufen wurden. </font><font style="vertical-align: inherit;">So sieht beispielsweise ein Skript aus, das zeigt, wie auf diese Variablen verwiesen wird:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
- name: Show Satellite variables<font></font>
  hosts: all<font></font>
  tasks:<font></font>
  - name: Show subscription_status<font></font>
    debug:<font></font>
      msg: &gt;<font></font>
        Subscription Status: {{ foreman.subscription_status_label }}<font></font>
  - name: Show Errata Counts<font></font>
    debug:<font></font>
      msg: &gt;<font></font>
        Bug fixes: {{ foreman.content_facet_attributes.errata_counts.bugfix }},<font></font>
        Security: {{ foreman.content_facet_attributes.errata_counts.security }},<font></font>
        Enhancement: {{ foreman.content_facet_attributes.errata_counts.enhancement }},<font></font>
        Total: {{ foreman.content_facet_attributes.errata_counts.total }}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie dieses Skript in Ansible Tower ausführen, werden die Werte der Variablen angezeigt:</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/la/3o/ub/la3oubu_3gdoc2o_tvxhuqycyko.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und natürlich können diese Variablen in bedingten Konstruktionen verwendet werden, wenn, so dass Aufgaben nur unter bestimmten Bedingungen gestartet werden. </font><font style="vertical-align: inherit;">Zum Beispiel, wenn der Host keine Sicherheitspatches hat oder wenn das Host-Abonnement ungültig ist.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Red Hat Satellite und Red Hat Ansible selbst sind sehr leistungsfähige Tools, und ihre Integration bietet spürbare Synergien. </font><font style="vertical-align: inherit;">Oben haben wir gezeigt, wie Satellite in Ansible zu einer Datenquelle für Dynamic Inventory gemacht und in der Praxis verwendet werden kann.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 2. Autokonfiguration neuer Hosts durch Bereitstellung eines Rückrufs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neben vielen anderen Funktionen kann Satellite auch Hosts initialisieren, dh die Bereitstellung durchführen. Ansible Tower wiederum dient zum Konfigurieren von Hosts. Durch die Integration können Sie sicherstellen, dass Ansible Tower nach der Initialisierung eines neuen RHEL-Hosts mithilfe von Satellite automatisch eine Verbindung zu diesem Host herstellt und das entsprechende Konfigurationsskript darauf ausführt. Offensichtlich spart ein solches Schema den Systemadministratoren viel Zeit und hilft ihnen, schneller auf die Anforderungen des Unternehmens zu reagieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass dieses Schema nur funktioniert, wenn mehrere Bedingungen erfüllt sind. </font><font style="vertical-align: inherit;">Zunächst sollte Satellite als dynamische Inventardatenquelle in Ansible Tower verwendet werden (wir haben dieses Problem im vorherigen Teil behandelt). </font><font style="vertical-align: inherit;">Zweitens sollte die Hostinitialisierung nicht nur über Satellit erfolgen, sondern auch über den Hostgruppenmechanismus (weitere Informationen finden Sie im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bereitstellungshandbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Folgenden wird gezeigt, wie Satellite und Ansible Tower so konfiguriert werden, dass nach der Initialisierung des Hosts das Ansible-Konfigurationsskript automatisch ausgeführt wird.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überblick</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IT-Automatisierungstools wie Ansible Tower lassen sich normalerweise in zwei Kategorien einteilen: Einige arbeiten nach der Push-Methode, andere nach der Pull-Methode. In Push-Systemen, zu denen Ansible Tower gehört, initiiert der Automatisierungsserver eine Verbindung zum Host. In Pull-Systemen ist der Initiator der Host, der selbst mit dem Automatisierungsserver kommuniziert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserem Fall wird beim automatischen Scripting auf neuen Hosts ein gemischtes Schema verwendet. Der neu initialisierte Host kontaktiert den Automatisierungsserver mit der Aufforderung, ihn zurückzurufen und zu konfigurieren. Danach stellt der Automatisierungsserver eine Verbindung zu diesem Host her und führt das vom Host angeforderte Konfigurationsskript darauf aus. Daher wird dieser Mechanismus in Ansible Tower als Bereitstellungsrückruf bezeichnet, der als "Initialisierungsrückruf" übersetzt werden kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berücksichtigen Sie die folgende Situation, um zu zeigen, warum überhaupt ein Bereitstellungsrückruf erforderlich ist: Wir haben ein bestimmtes Hostkonfigurationsskript, das täglich um Mitternacht ausgeführt wird. Nehmen wir an, wir initialisieren um 8 Uhr morgens mehrere neue Server gleichzeitig über Satellite. Gleichzeitig wird Satellite in Ansible Tower als dynamische Inventardatenquelle verwendet, sodass die erstellten Hosts automatisch in Ansible fallen. Der nächste Start des Automatisierungsskripts erfolgt jedoch erst um Mitternacht, dh nach 16 Stunden. Dies ist natürlich alles andere als ideal, und ich möchte, dass das Skript unmittelbar nach der Initialisierung des neuen Hosts ausgeführt wird. Zu diesem Zweck wird auch ein Rückruf für die Bereitstellung bereitgestellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen ist der Bereitstellungsrückruf konfiguriert und funktioniert wie folgt:</font></font><br>
<br>
<ol>
<li>  Ansible Tower   credential        root,  Satellite           . Tower    ,            .</li>
<li>   Job Template  Ansible Tower   provisioning callback.       URL     Host Config Key,        Ansible. </li>
<li> Satellite      ,       provisioning callback   Ansible Tower,  : URL-  Ansible Tower,  Host Config Key    Ansible.</li>
<li>      Satellite     /etc/systemd/system/ansible-callback.service (  RHEL 7  8;   RHEL 6  ).         provisioning callback   Ansible Tower,  ,     (URL-, Host Config Key   ).</li>
<li>Ansible Tower       Host Config Key.   , Tower       ,      root,    Job Template.   ,      .</li>
</ol><br>
<h4> Ansible Tower  Provisioning Callback</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Erstellung eines Konfigurationsskripts auf dem Ansible Tower-Server, das den Inhalt von / etc / motd ändert, eine Art Benutzer erstellt und ein bestimmtes Paket installiert. </font><font style="vertical-align: inherit;">Dann werden wir dieses Skript verwenden, um neue Hosts unmittelbar nach ihrer Initialisierung zu konfigurieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im wirklichen Leben werden Automatisierungsskripte höchstwahrscheinlich in einem Versionskontrollsystem gespeichert, aber der Einfachheit halber nehmen wir an, dass sie direkt auf dem Ansible Tower-Server liegen. </font><font style="vertical-align: inherit;">Daher rufen wir den Ansible Tower-Server über SSH auf und erstellen das Verzeichnis / var / lib / awx / projects / Bereitstellung für sie, indem wir den folgenden Befehl ausführen:</font></font><br>
<br>
<pre><code class="plaintext hljs"># mkdir /var/lib/awx/projects/provision
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann erstellen wir unser Skript in diesem Verzeichnis, nennen es provision.yaml und schreiben den folgenden Inhalt hinein:</font></font><br>
<br>
<pre><code class="plaintext hljs">---<font></font>
<font></font>
- name: Provision new host<font></font>
<font></font>
  hosts: all<font></font>
<font></font>
  tasks:<font></font>
<font></font>
  - name: Set content in /etc/motd <font></font>
<font></font>
    copy:<font></font>
<font></font>
      content: Authorized use only!<font></font>
<font></font>
      dest: /etc/motd<font></font>
<font></font>
      mode: 644<font></font>
<font></font>
      owner: root<font></font>
<font></font>
      group: root<font></font>
<font></font>
<font></font>
  - name: Create brian user account<font></font>
<font></font>
    user:<font></font>
<font></font>
      name: brian<font></font>
<font></font>
      uid: 10000<font></font>
<font></font>
      state: present<font></font>
<font></font>
<font></font>
  - name: Install tmux package<font></font>
<font></font>
    yum:<font></font>
<font></font>
      name: tmux<font></font>
<font></font>
      state: present<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie nun zur Tower-Weboberfläche und zum Bildschirm Anmeldeinformationen. </font><font style="vertical-align: inherit;">Wir klicken auf die Schaltfläche mit dem grünen Pluszeichen, um einen neuen Berechtigungsnachweisdatensatz zu erstellen, geben ihm den Namen provisioning_root und legen den Berechtigungsnachweistyp als Maschine fest. </font><font style="vertical-align: inherit;">Geben Sie im Feld Benutzername root ein und geben Sie im Feld Kennwort das in Satellite angegebene Kennwort für die Verwendung auf den neuen Hosts der entsprechenden Hostgruppe in Satellite an (der Name befindet sich in der Satellite-Weboberfläche auf der Registerkarte Betriebssystem). </font><font style="vertical-align: inherit;">Mit diesem Eintrag kann sich Ansible Tower bei neuen Hosts anmelden, die während der Initialisierung über Satellit erstellt wurden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zf/b7/lb/zfb7lbondu4unvzqe-h5ex-2e54.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie anschließend in der Ansible Tower-Oberfläche zum Bildschirm Projekte und klicken Sie auf das grüne Pluszeichen, um ein neues Projekt zu erstellen. </font><font style="vertical-align: inherit;">Nennen Sie es Bereitstellung, ändern Sie den SCM-Typ in Manuell und geben Sie die Bereitstellung als Playbook-Verzeichnis an:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yb/aq/ib/ybaqibhcd2nlts3ysjwzfphdr8w.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie dann in der Ansible Tower-Benutzeroberfläche zum Bildschirm Vorlagen, und klicken Sie auf das grüne Pluszeichen, um eine neue Jobvorlage zu erstellen. </font><font style="vertical-align: inherit;">Wir nennen es Bereitstellung, im Feld Inventar schreiben wir Satellit, im Feld Projekt - Bereitstellung, im Playbook-Feld - Bereitstellung.yaml und im Feld Anmeldeinformationen - Bereitstellung_Wurzel. </font><font style="vertical-align: inherit;">Darüber hinaus müssen Sie das Kontrollkästchen Bereitstellen von Rückrufen zulassen aktivieren und auf das Zauberstabsymbol rechts neben dem Feld Host-Konfigurationsschlüssel klicken, um einen geheimen Schlüssel zu generieren. </font><font style="vertical-align: inherit;">Dieser Schlüssel wird benötigt, um einen Bereitstellungsrückruf anzufordern. Es kann sich nicht um jemanden handeln, sondern nur um jemanden, der den Host-Konfigurationsschlüssel kennt. </font><font style="vertical-align: inherit;">Ohne den richtigen Schlüssel antwortet der Ansible Tower-Server einfach nicht auf die Anfrage.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mx/lo/f6/mxlof6mxbd8ny0f0wursfzhqdzy.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt müssen wir uns für die Zukunft den Wert des Host-Konfigurationsschlüssels sowie die Vorlagen-ID merken, die Sie unter der URL dieser Jobvorlage finden: </font></font><br>
<br>
<pre><code class="plaintext hljs">https://tower.example.com/#/templates/job_template/11
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel lautet die ID 11. </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Satelliten für die Bereitstellung von Rückrufen konfigurieren</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie nun zur Satelliten-Weboberfläche, gehen Sie zum Bildschirm Konfigurieren und klicken Sie auf Hostgruppen. </font><font style="vertical-align: inherit;">Wir wählen die vorhandene Hostgruppe aus, die zum Initialisieren neuer Hosts verwendet wird. In unserem Beispiel ist dies RHEL 8. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie auf dem Bearbeitungsbildschirm für die </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hostgruppe </font><font style="vertical-align: inherit;">zur Registerkarte Parameter und erstellen Sie 4 neue Parameter: </font><font style="vertical-align: inherit;">ansible_host_config_key - hier geben Sie den Host-Konfigurationsschlüssel aus unserer Ansible Tower-Vorlage ein. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ansible_job_template_id - hier schreiben wir die Vorlagen-ID, die wir zuvor aus der Vorlagen-URL herausgefunden haben. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ansible_tower_fqdn ist der vollständig qualifizierte Domänenname des Ansible Tower-Servers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ansible_tower_provisioning - true setzen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/th/ji/m8/thjim8rh06qhbq_gdwhxfc4jlue.png"></div><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überprüfen Sie, wie alles funktioniert</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialisieren Sie nun den neuen Host von Satellite und stellen Sie sicher, dass der Bereitstellungsrückruf funktioniert und unser Skript automatisch auf diesem Host ausgeführt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie in der Satellite-Weboberfläche zum Bildschirm Hosts, klicken Sie auf Host erstellen und überprüfen Sie, ob die Gruppe verwendet wird, für die wir gerade 4 neue Parameter erstellt haben, dh die RHEL 8-Gruppe.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xt/mn/yc/xtmnycjplympck_rrh4lag9l2ts.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Abschluss der Hostinitialisierung müssen wir sicherstellen, dass die Vorlage erfolgreich gestartet wurde. </font><font style="vertical-align: inherit;">Gehen Sie dazu zum Bildschirm Vorlagen in der Ansible Tower-Weboberfläche, suchen Sie in der Liste nach unserer Vorlage und prüfen Sie, ob das am weitesten links stehende Quadrat der Anzeige grün wird:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lk/g2/o-/lkg2o-kj5rtuuotxnvyhnxrcr3e.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir klicken auf dieses grüne Kästchen, um die Startdetails anzuzeigen, die in unserem Fall erfolgreich waren. </font><font style="vertical-align: inherit;">Bitte beachten Sie, dass diese Aufgabe ein Limit (Limit) hat - das Starten nur neuer Hosts, die während der Initialisierung erstellt werden. </font><font style="vertical-align: inherit;">Dies ist nicht überraschend, da der Bereitstellungsrückrufmechanismus die Vorlage nur auf den Hosts ausführt, die sie anfordern.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/aa/ll/t1/aallt1qykw1g_z9t_hmsujmtqby.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen wir nun zum neu erstellten Host und prüfen, ob er mit den Angaben im Skript übereinstimmt:</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# rpm -qa | grep tmux<font></font>
tmux-2.7-1.el8.x86_64<font></font>
<font></font>
[root@provision-test-rhel8 ~]# id brian<font></font>
uid=10000(brian) gid=10000(brian) groups=10000(brian)<font></font>
<font></font>
[root@provision-test-rhel8 ~]# cat /etc/motd<font></font>
Authorized use only!<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerbehebung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Ansible Tower-Vorlage auf einem neuen Host, der über Satellit initialisiert wurde, nicht automatisch gestartet wird, müssen einige Dinge überprüft werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Schritt besteht darin, herauszufinden, ob der Ansible Tower eine Anforderung für einen Bereitstellungsrückruf erhalten hat, wie das Skript ausgeführt wurde und ob es überhaupt gestartet wurde. Gehen Sie dazu zum Bildschirm Vorlagen in der Tower-Oberfläche und sehen Sie sich die Farbe des Indikators neben dem Vorlagennamen an: Grün - Der Start war erfolgreich, Rot - Der Start ist fehlgeschlagen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gc/ra/id/gcraidlrqdznksnzfsryp80qbwk.png"></div><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Feld rot ist, klicken wir darauf und suchen nach zusätzlichen Informationen, um zu verstehen, warum der Start fehlgeschlagen ist (dies können sowohl Syntaxfehler im Skript als auch andere Probleme sein). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Quadrat grün ist, klicken wir trotzdem und schauen, da die Aufgabe eine erfolgreiche Ausführung melden konnte, aber auf unserem Host nicht gestartet wurde. Wenn in der Hostzeile des Skripts beispielsweise bestimmte Hosts und Gruppen angegeben sind, die während der Initialisierung erstellten Hosts jedoch nicht enthalten sind, meldet die Aufgabe den Erfolg, in den zusätzlichen Informationen wird jedoch "Überspringen: Keine Hosts übereinstimmen" angezeigt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Indikatorquadrat weder grün noch rot ist, müssen Sie zunächst die Parameter der Hostgruppe in Satellite überprüfen. Stellen Sie sicher, dass die Ansible Tower-Server-URL, der Host-Konfigurationsschlüssel und die Vorlagen-ID dort korrekt angegeben sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie als Nächstes zum neu initialisierten Host und überprüfen Sie, ob eine Datei /etc/systemd/system/ansible-callback.service (auf RHEL 7- oder 8-Systemen) oder eine Datei /root/ansible_provisioning_call.sh (RHEL 6) vorhanden ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Datei nicht vorhanden ist, stellen Sie sicher, dass der Parameter ansible_tower_provisioning für diese Hostgruppe auf true festgelegt ist und dass die Initialisierungsmuster auf dem Satellitenserver nicht geändert wurden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Datei /etc/systemd/system/ansible-callback.service auf dem Host vorhanden ist, öffnen Sie sie und suchen Sie nach der URL, an die die Bereitstellungsrückrufanforderung gesendet wird:</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# cat /etc/systemd/system/ansible-callback.service<font></font>
[Unit]<font></font>
Description=Provisioning callback to Ansible Tower<font></font>
Wants=network-online.target<font></font>
After=network-online.target<font></font>
<font></font>
[Service]<font></font>
Type=oneshot<font></font>
ExecStart=/usr/bin/curl -k -s --data "host_config_key=aa5ebe82-491c-4fbb-bd36-a6657549451e" https://tower.example.com/api/v2/job_templates/11/callback/<font></font>
ExecStartPost=/usr/bin/systemctl disable ansible-callback<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können curl ausführen und die in dieser Datei angegebenen Befehle manuell duplizieren, um einen Bereitstellungsrückruf manuell zu initiieren:</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# /usr/bin/curl -k -s --data "host_config_key=aa5ebe82-491c-4fbb-bd36-a6657549451e" https://tower.example.com/api/v2/job_templates/11/callback/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein ungültiger Host-Konfigurationsschlüssel angegeben wird, wird die folgende Fehlermeldung angezeigt:</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# /usr/bin/curl -k -s --data "host_config_key=wrong-key-here" https://tower.example.com/api/v2/job_templates/11/callback/<font></font>
<font></font>
{"detail":"You do not have permission to perform this action."}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Vorlagen-ID falsch angegeben ist (hier - 43 statt 11), lautet die Antwort wie folgt:</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# /usr/bin/curl -k -s --data "host_config_key=wrong-key-here" https://tower.example.com/api/v2/job_templates/43/callback/<font></font>
<font></font>
{"detail":"Not found."}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können den stillen (-s) Modus auch im Befehl curl deaktivieren, damit Fehler im Zusammenhang mit der Auflösung des Hostnamens angezeigt werden, wie im folgenden Beispiel, in dem wir den korrekten Namen ansible.example.com durch den falschen Namen ansible-tower.example.com ersetzt haben ::</font></font><br>
<br>
<pre><code class="plaintext hljs">[root@provision-test-rhel8 ~]# /usr/bin/curl -k  --data "host_config_key=wrong-key-here" https://ansible-tower.example.com/api/v2/job_templates/11/callback/<font></font>
<font></font>
curl: (6) Could not resolve host: ansible-tower.example.com<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die Fehlerursache herausfinden, kann die Datei /var/log/tower/tower.log auf dem Ansible Tower-Server hilfreich sein. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Datei wird beispielsweise die Verwendung eines ungültigen Host-Konfigurationsschlüssels aufgezeichnet:</font></font><br>
<br>
<pre><code class="plaintext hljs">2019-11-19 23:19:17,371 WARNING  awx.api.generics status 403 received by user AnonymousUser attempting to access /api/v2/job_templates/11/callback/ from 192.168.0.138
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies behebt auch die Verwendung einer ungültigen Vorlagen-ID:</font></font><br>
<br>
<pre><code class="plaintext hljs">2019-11-19 23:19:49,093 WARNING  awx.api.generics status 404 received by user AnonymousUser attempting to access /api/v2/job_templates/43/callback/ from 192.168.0.138<font></font>
<font></font>
2019-11-19 23:19:49,095 WARNING  django.request Not Found: /api/v2/job_templates/43/callback/<font></font>
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Integration von Satellite und Ansible Tower kann die Initialisierung und Konfiguration neuer Hosts erheblich optimiert werden. Dies spart den Systemadministratoren viel Zeit und hilft ihnen, schneller auf die Anforderungen des Unternehmens zu reagieren. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Am 24. März, von 11:00 bis 12:30 Uhr, veranstaltet Red Hat ein Webinar</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
zum Thema </font><b><font style="vertical-align: inherit;">„Was Sie über Automatisierung wissen müssen: Grundlegende Ansible-Fähigkeiten“.</font></b><font style="vertical-align: inherit;"> Automatisierung ist ein Thema, das sich der Popularität und der Anzahl der Anfragen nach digitaler Transformation nähert. Wir werden Sie über unsere Sicht der Automatisierung informieren - zusammen mit Ansible und Ansible Tower - und dies sind die grundlegenden Informationen, die Ihnen die Tür in die schöne neue Welt der deklarativen Automatisierungstools öffnen.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach diesem Webinar werden Sie die grundlegenden Ansible-Entitäten wie Playbook, Inventar und Modul verstehen. </font><font style="vertical-align: inherit;">Zusammen mit Ihnen werden wir die grundlegende YAML-Syntax beherrschen, damit Sie Ihre eigenen Skripte schreiben können. </font><font style="vertical-align: inherit;">Es wird auch erwogen, Skripte zu starten und Berechtigungen zu eskalieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten Sie grundlegende Fähigkeiten, mit denen Sie Dokumentation und andere Literatur erfolgreich studieren können, ohne das ständige Gefühl zu haben, dass Ihnen etwas fehlt. </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registrieren Sie sich</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und kommen Sie!</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491122/index.html">Forensische Analyse von HiSuite-Backups</a></li>
<li><a href="../de491130/index.html">Vue Features zum Erinnern</a></li>
<li><a href="../de491132/index.html">Wenn der Bloom-Filter nicht passt</a></li>
<li><a href="../de491134/index.html">5 Stufen der Unvermeidlichkeit der Annahme der ISO / IEC 27001-Zertifizierung. Negation</a></li>
<li><a href="../de491136/index.html">Projizieren von Inhalten in Angular oder verlorene ng-Inhaltsdokumentation</a></li>
<li><a href="../de491146/index.html">UML für Entwickler</a></li>
<li><a href="../de491150/index.html">Wie ich Betrüger gehackt habe oder nur die Innenseiten von Phishing-Panels</a></li>
<li><a href="../de491154/index.html">Kurssuche: So erstellen Sie einen Lernpfad</a></li>
<li><a href="../de491156/index.html">Messbare Empathie: Vorhersage der Sympathie für die MRT des Gehirns</a></li>
<li><a href="../de491162/index.html">PostgreSQL Antipatterns: Eine Geschichte über die iterative Verfeinerung der Suche nach Namen oder "Optimierung hin und her".</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>