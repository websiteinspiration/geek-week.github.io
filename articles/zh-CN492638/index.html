<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙈 🕛 🤛🏿 用鸭子缩放Redux应用程序 🏧 👨🏻 👴🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="预期课程开始时，“ React.js开发人员”准备了有用材料的翻译。
 
 
 
 
 您的应用程序的前端如何扩展？六个月后如何使您的代码支持？
 
 在2015年，Redux席卷了前端开发领域，并确立了自己的标准，超越了React。
 
 对于最近完成重构大量的代码基础上的反应，我们实现的终极版，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>用鸭子缩放Redux应用程序</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/492638/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预期课程开始时，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ React.js开发人员”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备了有用材料的翻译。</font></font><br>
</i></b><br>
<br>
<img src="https://habrastorage.org/webt/v4/na/xg/v4naxgyec9pamduy0s1qf7gjqyc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您的应用程序的前端如何扩展？六个月后如何使您的代码支持？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在2015年，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">席卷了前端开发领域，并确立了自己的标准，超越了React。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于最近完成重构大量的代码基础上的反应，我们实现的终极版，而不是我公司的工作</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回流</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们必须采取这一步骤，因为如果没有结构良好的应用程序和清晰的规则，就不可能继续前进。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代码库已经存在两年多了，从一开始就存在回流。我们不得不更改与React组件紧密相关的代码，一年以上没有人碰过。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据所做工作的经验，我创建了这个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储库</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这将有助于说明我们在redux上组织代码的方法。</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当您了解有关redux，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">actions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducers的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多信息时</font><font style="vertical-align: inherit;">，您将从简单的示例开始。</font><font style="vertical-align: inherit;">当今可用的许多教程并没有超出它们。</font><font style="vertical-align: inherit;">但是，如果要在Redux上创建比任务列表更复杂的内容，则需要一种合理的方法来随着时间的推移扩展代码库。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
曾经有人说过，在计算机科学中，没有比给不同的事物命名更困难的任务了。</font><font style="vertical-align: inherit;">我不能不同意。</font><font style="vertical-align: inherit;">在这种情况下，文件夹结构和文件组织将排在第二位。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看看我们过去如何进行代码组织。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能与功能</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 有两种公认的组织应用程序的方法：功能优先和功能优先。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 在左侧的屏幕截图中，文件夹结构是按照功能优先的原则组织的，而右侧是功能优先的原则。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ur/le/wb/urlewbt5etkrntpbqzlygb0yzlo.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 “功能优先”意味着您的顶级目录是根据其中的文件命名的。因此，您拥有：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">容器，组件，动作，Reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这根本无法扩展。随着应用程序的增长和新功能的出现，您将文件添加到相同的文件夹中。因此，您需要长时间滚动其中一个文件夹的内容才能找到所需的文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个问题是合并文件夹。您的应用程序线程之一可能需要访问所有文件夹中的文件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这种方法的优点之一是，在我们的例子中，它可以将React与Redux隔离。因此，如果要更改状态管理库，将知道需要哪些文件夹。如果您需要更改视图库，则可以保留带redux的文件夹。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“功能优先”意味着顶层目录将根据应用程序的主要功能进行命名：产品，购物车，会话。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于每个新功能都位于一个新文件夹中，因此该方法的伸缩性更好。但是，在Redux和React组件之间没有分隔。从长远来看，更改其中之一并不是一件容易的事。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，您将拥有不属于任何功能的文件。</font><font style="vertical-align: inherit;">结果，所有这些都归于common或shared文件夹，因为您还想在应用程序的不同功能中使用代码。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结合两全其美</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 尽管这不是本文的主题，但我想说的是，UI文件中的状态管理文件需要单独存储。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从长远来看您的应用程序。想象一下，如果您从React切换到其他代码，代码将会发生什么。或者考虑您的代码库将如何与Web版本并行使用ReactNative。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">我们方法</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
的核心</font><font style="vertical-align: inherit;">是隔离的原理React代码位于名为</font><i><font style="vertical-align: inherit;">views</font></i><font style="vertical-align: inherit;">的文件夹中</font><font style="vertical-align: inherit;">，而redux代码位于另一个名为redux的文件夹中。</font><font style="vertical-align: inherit;">
入门级的这种分离使我们可以灵活地以完全不同的方式组织应用程序的各个部分。</font><font style="vertical-align: inherit;">
在</font><i><font style="vertical-align: inherit;">views</font></i><font style="vertical-align: inherit;">文件夹中</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
 <br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们支持功能优先文件的组织。</font><font style="vertical-align: inherit;">在React的上下文中，这看起来很自然：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页面，布局，组件，增强器</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了不使一个文件夹中的文件数量疯狂，您可以在这些文件夹中使用功能优先的方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同时，在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹中</font><font style="vertical-align: inherit;">...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍新鸭</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 每个应用程序功能必须对应于单独的动作和简化程序，以便应用功能优先的方法是有意义的。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原来的模块化方法</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鸭子</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以很容易地与终极版，并提供工作结构化的方式，以新的功能添加到您的应用程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，您想了解在扩展应用程序时会发生什么。</font><font style="vertical-align: inherit;">我们意识到，为每个功能组织一个文件的方法会使应用程序混乱，并使其支持成为问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
于是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出现了鸭子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">解决方案是将功能拆分为鸭子文件夹。</font></font><br>
<br>
<pre><code class="javascript hljs">duck/<font></font>
├── actions.js<font></font>
├── index.js<font></font>
├── operations.js<font></font>
├── reducers.js<font></font>
├── selectors.js<font></font>
├── tests.js<font></font>
├── types.js<font></font>
├── utils.js</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 duck文件夹应：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含仅处理应用程序一个概念的所有逻辑，例如：产品，购物车，会话等。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含index.js文件，该文件根据鸭子规则导出。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将代码存储在执行类似工作的单个文件中，例如化简器，选择器和操作。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含与鸭子相关的测试。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，在此示例中，我们没有使用基于redux构建的抽象。</font><font style="vertical-align: inherit;">创建软件时，从最少的抽象量入手很重要。</font><font style="vertical-align: inherit;">因此，您将看到抽象的价值不超过抽象的好处。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果要确保抽象性不好，请观看此</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cheng Lou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视频</font><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下每个文件的内容。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">种类</font></font></h4><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 文件</font><font style="vertical-align: inherit;">包含</font><font style="vertical-align: inherit;">您在应用程序中执行</font><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的名称</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">作为一种好习惯，您应该尝试覆盖与它们所属的功能相对应的名称空间。</font><font style="vertical-align: inherit;">这种方法在调试复杂的应用程序时会有所帮助。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> QUACK = <span class="hljs-string">"app/duck/QUACK"</span>;
<span class="hljs-keyword">const</span> SWIM = <span class="hljs-string">"app/duck/SWIM"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    QUACK,<font></font>
    SWIM<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动作</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 该文件包含</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动作创建者的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有功能</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> quack = <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.QUACK<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">const</span> swim = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> ( {
    <span class="hljs-attr">type</span>: types.SWIM,
    <span class="hljs-attr">payload</span>: {<font></font>
        distance<font></font>
    }<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    swim,<font></font>
    quack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 请注意，所有</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">均由函数表示，即使未对其进行参数化也是如此。</font><font style="vertical-align: inherit;">对于大型代码库，一致的方法是最高优先级。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运作方式</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 要表示操作链（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），您将需要redux </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中间件</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以改善</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dispatch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的功能</font><font style="vertical-align: inherit;">。流行的例子是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-saga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-observable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我们的例子中，使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我们需要单独</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行动创造者，</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甚至在编写额外的代码的成本。因此，我们将操作定义为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">action</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的包装</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果该操作仅发送一个</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也就是说，它实际上并没有使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">redux-thunk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么我们将发送</font><i><font style="vertical-align: inherit;">动作创建者</font></i><font style="vertical-align: inherit;">函数</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果操作使用重</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">击</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它可以发送很多</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">promise</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接它们</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
<span class="hljs-comment">// This is a link to an action defined in actions.js.</span>
<span class="hljs-keyword">const</span> simpleQuack = actions.quack;<font></font>
<font></font>
<span class="hljs-comment">// This is a thunk which dispatches multiple actions from actions.js</span>
<span class="hljs-keyword">const</span> complexQuack = <span class="hljs-function">(<span class="hljs-params"> distance </span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params"> dispatch </span>) =&gt;</span> {<font></font>
    dispatch( actions.quack( ) ).then( <span class="hljs-function"><span class="hljs-params">( )</span> =&gt;</span> {<font></font>
        dispatch( actions.swim( distance ) );<font></font>
        dispatch( <span class="hljs-comment">/* any action */</span> );<font></font>
    } );<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    simpleQuack,<font></font>
    complexQuack<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 可以</font><font style="vertical-align: inherit;">根据需要将其称为“ </font><font style="vertical-align: inherit;">操作”，“ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thunks”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，“ sagas”，“史诗”。</font><font style="vertical-align: inherit;">只需确定命名原则并坚持下去即可。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我们将讨论索引并看到操作是Duck公共接口的一部分。</font><font style="vertical-align: inherit;">动作被封装，操作可以从外部访问。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减速器</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 如果您具有更多层面的功能，则绝对应该使用几个化</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简器</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来处理复杂的状态结构。另外，不要害怕根据需要使用尽可能多的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CombineReducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这将允许更自由地使用状态对象结构。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">"redux"</span>;
<span class="hljs-keyword">import</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-comment">/* State Shape
{
    quacking: bool,
    distance: number
}
*/</span><font></font>
<font></font>
<span class="hljs-keyword">const</span> quackReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-literal">false</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.QUACK: <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> distanceReducer = <span class="hljs-function">(<span class="hljs-params"> state = <span class="hljs-number">0</span>, action </span>) =&gt;</span> {
    <span class="hljs-keyword">switch</span>( action.type ) {
        <span class="hljs-keyword">case</span> types.SWIM: <span class="hljs-keyword">return</span> state + action.payload.distance;
        <span class="hljs-comment">/* ... */</span>
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> state;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">const</span> reducer = combineReducers( {
    <span class="hljs-attr">quacking</span>: quackReducer,
    <span class="hljs-attr">distance</span>: distanceReducer<font></font>
} );<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 在大型应用程序中，状态树将至少包含三个级别。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">应尽可能小，并且仅处理简单的数据构造。</font><font style="vertical-align: inherit;">创建一个灵活且可维护的状态结构所需的全部就是</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CombineReducers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查看完整的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目示例，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并查看如何</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><i><font style="vertical-align: inherit;">CombineReducers</font></i><font style="vertical-align: inherit;">，尤其是在文件中</font></font><code>reducers.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font></font><code>store.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在何处</font><i><font style="vertical-align: inherit;">构建</font></i><font style="vertical-align: inherit;">状态树。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择器</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 与操作选择器（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selector</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）一起是公共接口鸭子的一部分。</font><font style="vertical-align: inherit;">操作和选择器之间的区别类似于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CQRS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式</font><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择器函数获取应用程序状态的一部分，并基于该状态返回一些数据。</font><font style="vertical-align: inherit;">他们从不更改应用程序的状态。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkIfDuckIsInRange</span>(<span class="hljs-params"> duck </span>) </span>{
    <span class="hljs-keyword">return</span> duck.distance &gt; <span class="hljs-number">1000</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<font></font>
    checkIfDuckIsInRange<font></font>
};</code></pre><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指数</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 该文件指示将从duck文件夹中导出的内容。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是他：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，从duck </font><font style="vertical-align: inherit;">导出</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将选择器和操作导出为注册的导出。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果需要，可以导出其他鸭子的类型。</font></font></li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckSelectors } <span class="hljs-keyword">from</span> <span class="hljs-string">"./selectors"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckOperations } <span class="hljs-keyword">from</span> <span class="hljs-string">"./operations"</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> duckTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">"./types"</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测验</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将Redux与ducks框架一起使用的优势在于，您可以在要测试的代码之后立即编写测试。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Redux上测试代码非常简单：</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">"expect.js"</span>;
<span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">"./reducers"</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">"./actions"</span>;<font></font>
<font></font>
describe( <span class="hljs-string">"duck reducer"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
    describe( <span class="hljs-string">"quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{
        <span class="hljs-keyword">const</span> quack = actions.quack( );
        <span class="hljs-keyword">const</span> initialState = <span class="hljs-literal">false</span>;<font></font>
<font></font>
        <span class="hljs-keyword">const</span> result = reducer( initialState, quack );<font></font>
<font></font>
        it( <span class="hljs-string">"should quack"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> </span>) </span>{<font></font>
            expect( result ).to.be( <span class="hljs-literal">true</span> ) ;<font></font>
        } );<font></font>
    } );<font></font>
} );</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此文件中，您可以编写用于</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reducer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，操作，选择器等的</font><font style="vertical-align: inherit;">测试</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我可以写一整篇有关代码测试好处的文章，但是它们已经足够了，所以只需测试您的代码即可！</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就这样</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于重新鸭子的好消息是，您可以对所有redux代码使用相同的模板。</font><font style="vertical-align: inherit;">用于Redux代码的</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基于</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的分区方法</font><font style="vertical-align: inherit;">可帮助您的应用程序随着其增长而保持灵活性和可扩展性。</font><font style="vertical-align: inherit;">基于</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的分离方法</font><font style="vertical-align: inherit;">在构建应用程序不同部分共有的小组件时会很好地工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">此处</font></a><font style="vertical-align: inherit;">查看完整的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">react-redux-example</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码库</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请记住，存储库正在正常运行。</font><font style="vertical-align: inherit;">
您如何组织您的redux应用程序？</font><font style="vertical-align: inherit;">我期待收到有关所描述方法的反馈。</font><font style="vertical-align: inherit;">
在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">课程</font></a><font style="vertical-align: inherit;">上见</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN492612/index.html">装饰顶灯韭菜名人</a></li>
<li><a href="../zh-CN492616/index.html">Packer，Terraform和Ansible：在一小时内部署Kubernetes集群</a></li>
<li><a href="../zh-CN492628/index.html">冠状病毒患者数量的置信区间（死亡率计算）</a></li>
<li><a href="../zh-CN492632/index.html">隔离小企业：恐慌是理性的敌人</a></li>
<li><a href="../zh-CN492636/index.html">有效意味着什么？</a></li>
<li><a href="../zh-CN492642/index.html">使用动态微服务创建可扩展的弹性架构</a></li>
<li><a href="../zh-CN492652/index.html">两个M5Stack上的纸牌游戏“傻瓜”</a></li>
<li><a href="../zh-CN492658/index.html">我去了遥控器-发起了播客：初学者应该读的书-5本行之有效的书</a></li>
<li><a href="../zh-CN492660/index.html">全世界对抗冠状病毒。英特尔故事</a></li>
<li><a href="../zh-CN492662/index.html">我是如何第一次流传大学讲座的</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>