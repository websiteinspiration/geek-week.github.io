<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∏ üê° üéØ Rake walking in a clean field or how to collect MAC addresses of nearby Wi-Fi devices üì§ üò∫ üôåüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I start all my public speeches (fortunately, there are not so many of them) by explicitly or implicitly mentioning the thesis ‚ÄúOur industry is complex...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Rake walking in a clean field or how to collect MAC addresses of nearby Wi-Fi devices</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503382/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I start all my public speeches (fortunately, there are not so many of them) by explicitly or implicitly mentioning the thesis ‚ÄúOur industry is complex, problems can be revealed at any, even the most obvious step, and it is optimistic to assume that everything will be simple and easy - naive‚Äù . Oddly enough, this simple idea, obtained by many years of stuffing cones, is sometimes a revelation for more experienced professionals, although it would seem that all the frantic enthusiasm and belief in the infallibility of their own ideas and practices should have been weathered for a long time. I‚Äôll tell you a story about this, an example of a simple, at first sight, project.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One fine day, a friend threw me a link to an </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interesting startup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The guys suggested that representatives of small businesses from the service and sales sectors set up an access point (with a captive portal) for their customers in order to distribute the Internet, simultaneously collecting the MAC addresses of smartphones of people passing by. The purpose of this action is very simple - a large number of advertising networks allow you to target the list of device addresses, therefore, directing the advertising company to users passing by, we will most likely receive new visitors (because it‚Äôs close and ‚Äúsomewhere I already saw it‚Äù) . Those. such distribution of virtual flyers. A friend asked how this is done and whether we can do this again.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A quick googling on the topic revealed the mechanism of such data collection. The WiFi adapter was launched in the air listening mode and ran through the channels, capturing packets, analyzing them and aggregating the received data. There were also ready-made open utilities for this, for example, airodump-ng from </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aircrack-ng</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Those. for repetition, we just need to run this utility, preferably on a separate compact and wearable device, and shove the received data into the database, from which we then get ready-made lists of MAC addresses for ad networks. It seems that the task is simple, solved in one, at most - two evenings of leisurely work, almost everything is ready. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, this was never the case.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you know, what is allowed to Jupiter is not allowed to the bull. </font><font style="vertical-align: inherit;">And when single-payers are used, then you have to sacrifice, first of all, computing resources and memory. </font><font style="vertical-align: inherit;">Further, the sacrifice of resources is followed by the sacrifice of development and debugging convenience - not every system will allow dragging compilation tools to the device. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, we wanted to take something simple and cheap, for example, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Orange Pi Zero</font></a><font style="vertical-align: inherit;"> boxes</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, put airodump-ng there and forward the data spit out by the utility to the server, where they can be safely put into the database. </font><font style="vertical-align: inherit;">I had experience working with such distributed systems with a dedicated center (although, there, virtual machines acted as workhorses lifted through the cloud API through the same center as necessary, but not the point), so part of the code successfully migrated to a new project .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The tool for forwarding data to the server was the simplest Erlang application written, which was supposed to pull data from the ether damper (parsing), serialize it (Erlang's native serialization) and transfer it via the web socket to the server via HTTPS (without causing suspicion DPI systems and not inventing their own protocols). The Allwinner H2 + processors used in the Orange Pi are powerful enough to assemble and debug directly on the device. Again, in theory, everything is fine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The practice has begun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. as it turned out, the built-in WiFi in the Orange Pi was only good for picking up an access point and throwing data into the server. Well, more precisely, not the adapter itself, but the support of its chipset in the kernel. For most IoT projects, this would probably be enough. However, we were ready for this blow, because a preliminary study of the aircrack-ng website gave a very clear and ambiguous ‚Äúit won‚Äôt work everywhere, if that‚Äôs not our fault, we‚Äôll attach a list of tested chipsets‚Äù. Almost all Atheros devices (purchased by Qualcomm) and Ralink (purchased by MediaTek) were found in the list, which inspired some prospects in the case of a transition from voracious Chinese ARMs to more ascetic MIPSs from the chipsets for routers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But, while this is all going from snot and sticks, i.e. prototyped - you need to solve the problem here and now. Therefore, we took advantage of such exotics in our technological time (when wireless communication is in any lighter) as a Wi-Fi USB adapter. Studying the compatibility list and comparing it with the assortment of the nearest store gave the victim - the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLink DWA-160</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in revision C1 (this is important because other hardware revisions used a different chip and caused a headache in terms of enforcing work). Dual-band, which does not require dancing with the driver, since support has long been in the kernel, this whistle came in handy later in operation in other projects, so I bought them, probably all (five pieces) that were available in our provincial city.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bl/7t/z7/bl7tz7yaohb2gfeh1ekkjha31us.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After making sure that the device was working, I connected it to a single-board device and turned off the built-in WiFi adapter with the expectation that the Internet would be available through the Ethernet interface. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/em/nk/cyemnk-n5d2lzg1aximnuzddg4q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second pig was laid by aircrack-ng. This set of utilities was created with the goal of </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacking.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WiFi penetration checks, i.e. was written by hackers for hackers. I don‚Äôt know, thanks to which logic they preferred to use the wireless ether dumper not in the form of a traditional unix-way approach, to spit out structured text for further processing, but to make a full-fledged term interface on which to display information in almost real time (and taking into account the terminal settings) by discovered networks and devices, but they did just that. Yes, I found the Python API of an unknown degree of readiness for all this, but, again, the prototyping spider that lived in my head strictly forbade dragging another language, switching to another (we remember, the server part was already partially ready and written was far from Python-e) or, God forbid, implement airodump-ng yourself on the basis of tcpdump. And consequently,I had to look for workarounds.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortunately, wireless hackers began to suspect something that constantly getting stuck in the interface was such an activity, so they implemented periodic uploading of everything found and aggregated as CSV files. With a set interval. You can already live with it. Of course, the naive option - to run the utility and re-read the file on a timer - was immediately given by hand. Working on a laptop, when transferring to a single-board, it began to fail in the process of reading the file for obvious reasons - sometimes the utility simply did not have time to unload everything and some of the data was irretrievably lost.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The solution to this was the inotify mechanism in the kernel, notifying of file operations - as soon as my code saw the changes to the data file, it initiated its reading with a slight delay (rather, having a purely psychological value, reassure its author). The experiments showed that in this case, reading failures and data loss does not occur. Well, nice, CSV parsim, put into internal structures and send to the server. We save it on the server in PostgreSQL (thanks for jsonb) and after that it is already possible to make queries, form unloads, etc. We will add the simplest authorization using a symmetric key, so that we don‚Äôt get stuffed there and we could bind the data to the point where the device is installed, and everything seems to be fine, you can go to battle.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yeah, now how. The test assembly of this chain (and code writing and debugging really took a couple of evenings) revealed a funny fact - the number of addresses caught per day in our office, quite remote from public passable places, fluctuated around a couple of thousand pieces. Yes, of course, there was a small hotel nearby (it was in pre-quarantine isolation time, do not be surprised), but still, there is a lot of something. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Refreshing the knowledge of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structure of the MAC address</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and recalling the fact that mobile devices often generate local addresses to hide their true MAC addresses, I modified the server part with a simple filter that cleans all broadcast and local addresses at the input. The list was reduced by an order of magnitude and already looked like the truth. Everything was ready for field trials.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you know, when changing locations from a warm and comfortable office to ruthless combat conditions, prototypes tend to cease to function normally, so the implementation process should be accompanied by the supply of a pocket engineer who will correct all emerging issues. On the other hand, it is also well known that a device that does not require additional dancing with a tambourine at the beginning of operation is likely to break soon, and irrevocably. This, for sure, was reflected in Murphy‚Äôs laws, but, alas, the author of these lines is too lazy to check which one, therefore, we will agree on the term ‚Äúmeanness law‚Äù. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first installation immediately revealed a bunch of flaws.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Firstly, most Chinese prototyping boards come with long-term microSD memory as opposed to NAND / NOR flash chips. An exception is made only for powerful SoC, clearly redundant for this task. Alas, MicroSD is the operator‚Äôs immediate headache - oxidation of the pads, failure of SD cards, the dependence of the contacts on the temperature inside the case (which is considerable, the Chinese chips are not very energy efficient, and the boards are often calculated completely based on peak power consumption, so without an additional radiator, well, no way). So it turned out that when the power was pulled out of the device, the system came into an inoperable state - files with the ERTS bytecode were damaged, after the reboot the application refused to work.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second unpleasant moment - at the installation point, the Internet was provided by an LTE router and was, to put it mildly, of mediocre quality, unlike an office wire. The network constantly sparked, the application often reconnected, or even died from accumulated messages in the queues.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, both problems are surmountable, for example, data loss would be eliminated by searching for the optimal combination of a good microSD card and file system settings, and connection instability could be compensated by preliminary data aggregation, short sending sessions, time-out, etc. But the problems that have been revealed are an occasion to reflect on whether the right path has been chosen. The need for a permanent connection to the server put an end to event data collection, when the device is hung on an external battery and thrown into a backpack, the owner of which goes to a mass event, where, of course, you can‚Äôt expect stability of the connection.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accordingly, the next step was to abandon the server part and localize the data warehouse directly on the device. In addition, in order to avoid long and very dreary experiments with SD cards, it was decided to use breadboard models with flash chips in the next iteration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At that moment, I remembered that in my collection there was a wonderful </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carambola 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> board </font><font style="vertical-align: inherit;">from Lithuanian comrades </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8Devices</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . And if you go to their site, you can find an even more compact device on the same chip called </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Centipede</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Previous experiments with this class of devices showed that Erlang completely fits into the allocated 16 MB of flash memory (and a little remains for the application). The only minus (which is rather even a plus) is the low-power MIPS and the need for cross-compilation, which makes building an Erlang application a little more nontrivial. But it was already a well-known route, so I ordered a couple of Centipede, and so far I have ported the existing version that works with the server to Carambol.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ll/x6/sq/llx6sqtfo4vwd4bvbi8tvvcmzsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the components arrived, a new phase began. The AR9331 chip was successfully supported by aircrack-ng from the box, data can be taken from the Ethernet interface, the latest versions of OpenWRT and ERTS have been collected and successfully tested. The application was rewritten - part of the code moved to the device code, data was accumulated in a separate process and periodically dumped to a file in the form of a serialized Erlang term. To this was drawn the simplest web-based interface that receives data via websocket. The ports for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inotify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec are</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> safely compiled with OpenWRT.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Only one thing confused - 300 kilobytes remained on the data. It's not that small if you only store the MAC addresses of client devices, but airodump-ng gives you much more interesting information, including access point addresses, their ESSIDs and so on, which would also be nice to remember. Just in case. Okay, we will act on the circumstances. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We collect, check. A problem is revealed on the fly. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openwrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as we all know, this is such a minimalistic Linux build that is designed specifically for devices with limited memory. As a result, it threw out from there that it was possible to throw out painlessly, and simplified that which could be simplified, including the multiplayer mode. Those. It‚Äôs a common practice when the code starts from root and works with maximum privileges, which, of course, facilitates issues related to groups, users and the control of their actions. Yes, yes, the letter S in the abbreviation IoT is responsible for security. The trouble is that </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which I used to run and manage airodump-ng, cannot perform operations from under the root ‚Äî for this, it needs an additional user, on behalf of which it will spawn the processes assigned to it. And when creating an additional user with a different privilege level ... correctly, it prevents airodump from reaching the network device. Unscrewing this restriction from the library seemed to be a slow process, so erlexec was replaced with ports - the built-in mechanism for starting third-party processes in Erlang. A trifle, but unpleasant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the devices are received, reflashed and even work in greenhouse conditions. We catch the battery, throw the box into the backpack, go to the mall. The next day, we look at the result - a fiasco, a data file of zero length - either there was not enough space, or a distortion of the power did not work at a very good time. We correct the code so that the saving occurs in two stages - first a temporary file was created, then it replaced the current one. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, the hands didn‚Äôt get to check the operability of this option - the next toy - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onion Omega2 +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the Mediatek 7688 came into view. Like their brothers, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the LinkIt Smart 7688 designer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , there were a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lot of things</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but the most important thing is twice as much flash-memory, which means that you can no longer worry about the lack of space for data storage. Okay </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We order, wait. Month. Two. Patience bursts - we write to the Americans on the subject ‚Äúwhere is the goods, Zin‚Äù. Silence. Open a dispute on PayPal. The Americans are waking up. They say, ‚ÄúOh, our order acceptance system has failed, now we‚Äôll send everything.‚Äù They send, we wait three weeks. Fuh, the device is on hand and even works.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/3a/ph/yb3aphpjdskqkkfcqlzw25pobuc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we need to make a small digression - despite the fact that I had several LinkIt Smart boards within walking distance, I did not consider them as a platform, because at the very beginning of the saga, an attempt to use them as capture devices failed. Then the drivers for the chip were supplied in the form of assembled modules for specific versions of the kernel and, apparently, this became the cause of inoperability. In the latest versions of OpenWRT, both native support for 7688 and an open driver appeared, so this is an occasion to reconsider the approach to these devices.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, it was customary to use WiFi directly on the chip for its intended purpose - after all, the device needs at least some control interface, and also in the field, at least in order to understand if it is working or not. To look at the data obtained would also be useful. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Accordingly, we combine the previous approaches - we use the only USB interface displayed on the MiniDoc for a WiFi whistle to scan the space, and the built-in WiFi - to control the device as a low-power access point. We collect, check, everything works.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But the appetite comes with eating. To begin with, the data file in the form of Erlang-serialization is the lot of real maniacs, and a slightly wider range of specially trained professionals needs something simpler. Again, in addition to adding data from airodump, I would also like the exact measurement time, and, preferably, at least some kind of reference to the location of the device in space. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We embed between a WiFi whistle and a USB hub device. Settings (and they depend on the position of the device on the bus in the case of OpenWRT) are forested, but these are minor trifles. Correct. We take out the USB-GPS receiver from the rubble, fortunately, already time-tested and with the written </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NMEA-0183 parsing (the code, of course, had to be corrected anyway). We check - the device is not safely detected by the system, there is clearly a lack of drivers. We collect the USB Serial drivers and drop it onto the device - also silence. Then we recall that in large systems the GPS whistle was detected not as ttyUSBx, but as ttyACMx, i.e. USB GSM modem. Well, fine, the second call to add drivers, success.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We take the code, integrate into the application. </font><font style="vertical-align: inherit;">Add sqlite3 to the application as storage. </font><font style="vertical-align: inherit;">Now it will not be necessary to check the availability of the record in the state, and in general the work with data is simplified to a small number of lines. </font><font style="vertical-align: inherit;">Putting it all together, we teach when adding data to take GPS readings, we correct the JS code on the face to display in case of an incomplete data set (it can happen when GPS has not yet caught satellites, and the air scan data is already coming). </font><font style="vertical-align: inherit;">We check the work - it seems to live. </font><font style="vertical-align: inherit;">You can declare an interim victory.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a couple of weeks of uninterrupted work - a lot of data both on stations on the air and on customers. </font><font style="vertical-align: inherit;">Now I am struggling with the temptation to offer this device to infobes to control broadcasting in the territories entrusted and to the state to control the movement of citizens' phones. </font><font style="vertical-align: inherit;">It‚Äôs a joke, of course, they themselves already know everything.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, all the ordeals described above is just a pet project with very low complexity (it was almost immediately clear what to do and how), the lack of hardware development (hi, physics) and access to a somewhat more or less complete product. </font><font style="vertical-align: inherit;">No, of course, it cannot be ruled out that the author of these lines is a dense amateur, and real gurus go this way in one evening between evening tea and a glass of cognac, but so far experience has shown only one thing: IT is complicated and optimism is punished financially and reputationally and motivationally, and those who say ‚Äúeverything is simple‚Äù are either geniuses or crooks, and the second is more likely.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503364/index.html">HandsAppMVP: iOS architecture for studio development outsourcing</a></li>
<li><a href="../en503366/index.html">Why is a dash becoming a question? Or problems with coding data in SQL</a></li>
<li><a href="../en503368/index.html">Gigantomania: why do modern games weigh so much?</a></li>
<li><a href="../en503372/index.html">Ethereum 2.0 may be delayed again due to errors, problems and competitors</a></li>
<li><a href="../en503380/index.html">Asynchronous Jobs in Django with Celery</a></li>
<li><a href="../en503386/index.html">Agile coach healthy person</a></li>
<li><a href="../en503388/index.html">Digitalization of panic: DIT of Moscow against Muscovites - a round table on May 23</a></li>
<li><a href="../en503390/index.html">Why is Intel betting on chip development for the genius of Jim Keller?</a></li>
<li><a href="../en503394/index.html">Stock Investment Experience</a></li>
<li><a href="../en503398/index.html">How to make thematic modeling of a forum quickly or what bothers people with celiac disease</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>