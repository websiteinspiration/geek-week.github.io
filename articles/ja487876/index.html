<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📟 👶🏻 🛄 Windows PowerShellとは何で、何を食べますか？パート1：主な機能 🙋 💅🏿 🐊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="歴史的に、UnixシステムのコマンドラインユーティリティはWindowsよりも優れていますが、新しいソリューションの登場により状況は変化しました。
 
 Windows PowerShellを使用すると、システム管理者はほとんどのルーチンタスクを自動化できます。その助けを借りて、設定の変更、サービス...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows PowerShellとは何で、何を食べますか？パート1：主な機能</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/487876/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歴史的に、UnixシステムのコマンドラインユーティリティはWindowsよりも優れていますが、新しいソリューションの登場により状況は変化しました。</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellを使用すると、システム管理者はほとんどのルーチンタスクを自動化できます。</font><font style="vertical-align: inherit;">その助けを借りて、設定の変更、サービスの停止と開始、およびインストールされているほとんどのアプリケーションのメンテナンスを実行できます。</font><font style="vertical-align: inherit;">青いウィンドウを別のコマンドインタープリターとして認識するのは誤りです。</font><font style="vertical-align: inherit;">このアプローチは、マイクロソフトによって提案された革新の本質を反映していません。</font><font style="vertical-align: inherit;">実際、Windows PowerShellの可能性ははるかに広くなっています。短い一連の記事では、Microsoftのソリューションがより一般的なツールとどのように異なるかを理解しようとしています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主な特徴&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、Windows PowerShellは主にスクリプト言語を備えたコマンドシェルであり、元々は.NET Frameworkに基づいて作成され、後で.NET Coreに基づいて作成されました。テキストデータを受け入れて返すシェルとは異なり、Windows PowerShellは、プロパティとメソッドを持つ.NETクラスで動作します。 PowerShellを使用すると、通常のコマンドを実行できるほか、COM、WMI、およびADSIオブジェクトにアクセスできます。いわゆるリポジトリへのアクセスには、ファイルシステムやWindowsレジストリなどのさまざまなリポジトリを使用します。サプライヤー（プロバイダー）。実行可能なPowerShellコンポーネントを他のアプリケーションに埋め込んで、次のようなさまざまな操作を実装できることは注目に値しますグラフィカルインターフェースを介して。その逆も当てはまります。多くのWindowsアプリケーションは、PowerShellを介して管理インターフェイスへのアクセスを提供します。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellでは、次のことができます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーティングシステムの設定を変更します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービスとプロセスを管理します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーの役割とコンポーネントを構成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソフトウェアをインストールする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別なインターフェースを介してインストールされたソフトウェアを管理します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サードパーティプログラムに実行可能コンポーネントを埋め込む。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理タスクを自動化するスクリプトを作成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルシステム、Windowsレジストリ、証明書ストアなどを操作します。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シェルと開発環境</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellには2つの方法があります。コマンドシェルを備えたコンソールエミュレーターに加えて、統合スクリプト環境（ISE）があります。</font><font style="vertical-align: inherit;">コマンドラインインターフェイスにアクセスするには、Windowsメニューで適切なショートカットを選択するか、[実行]メニューからpowershell.exeを実行します。</font><font style="vertical-align: inherit;">画面に青いウィンドウが表示され、機能がantediluvian cmd.exeと大きく異なります。</font><font style="vertical-align: inherit;">Unixシステムのコマンドシェルのユーザーには、使い慣れたオートコンプリートやその他の機能があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/gl/te/dsgltei5iog1igfonvgmqrprvpg.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シェルを操作するには、いくつかのキーの組み合わせを覚えておく必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上矢印と下矢印で履歴をスクロールし、以前に入力したコマンドを繰り返します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行末の右矢印は、前のコマンドを1文字ずつリサイクルします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Homeキーを押すと、入力したテキストがカーソル位置から行頭まで削除されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + Endは、カーソルから行末までのテキストを削除します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F7キーを押すと、入力したコマンドのウィンドウが表示され、そのうちの1つを選択できます。</font><font style="vertical-align: inherit;">マウスの選択、コピー、貼り付け、カーソルの配置、削除、バックスペースもコンソールで機能します-すべて私たちが好きです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/dz/8y/4zdz8ycsabniuypzx-tloxc9vk4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShell ISEは、コードエディター、コマンドデザイナー、組み込みデバッガー、およびその他のプログラミングの喜びでタブと構文の強調表示をサポートする、本格的な開発環境です。</font><font style="vertical-align: inherit;">開発環境エディターでコマンド名の後にハイフンを書くと、ドロップダウンリストにタイプのある使用可能なすべてのパラメーターが表示されます。</font><font style="vertical-align: inherit;">PowerShell ISEは、システムメニューのショートカットから、またはpowershell_ise.exe実行可能ファイルを使用して起動できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/4o/wo/yp4owoc2brcx0vrosfgjkkb_vz4.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドレット&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellでは、いわゆるコマンドレットこれらは、さまざまな機能を含む特殊な.NETクラスです。それらは、原則として「アクションオブジェクト」（または「好きなら動詞-名詞」）に従って名前が付けられ、ハイフンで区切られた結合詞は自然言語の文の述語と主語に似ています。たとえば、Get-Helpは文字通り「Get-Help」、またはPowerShellのコンテキストでは「Show-Help」を意味します。実際、これはUnixシステムのmanコマンドに類似しており、-helpまたは/？キーを使用してコマンドレットを呼び出すことによってではなく、PowerShellのマニュアルをこのように要求する必要があります。オンラインのPowerShellドキュメントを忘れないでください。Microsoftには詳細があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Getに加えて、他の動詞（厳密には動詞だけではありません）がコマンドレットで使用され、アクションを示します。以下のリストにいくつかの例を示し</font></font><br>
<br>
<code>Add</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<code>Clear</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 掃除; </font></font><br>
<code>Enable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-有効にします。</font></font><br>
<code>Disable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-スイッチを切る; </font></font><br>
<code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-作成; </font></font><br>
<code>Remove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-削除; </font></font><br>
<code>Set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-尋ねる; </font></font><br>
<code>Start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-実行; </font></font><br>
<code>Stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- やめる; </font></font><br>
<code>Export</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 書き出す; </font></font><br>
<code>Import</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-インポート。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システム、ユーザー、およびオプションのコマンドレットがあります。実行の結果、それらはすべてオブジェクトまたはオブジェクトの配列を返します。大文字と小文字は区別されません。コマンドインタープリターの観点からは、Get-Helpとget-helpの間に違いはありません。 ';'文字は分離に使用されますが、複数のコマンドレットが同じ行で実行される場合にのみ設定する必要があります。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellコマンドレットはモジュール（NetTCPIP、Hyper-Vなど）にグループ化されており、オブジェクトとアクションで検索するGet-Commandコマンドレットが存在します。</font><font style="vertical-align: inherit;">次のようにしてヘルプを表示できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/ek/ub/guekubdaoboz6eitvbzzqppmyvi.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
既定では、コマンドは簡単なヘルプを表示しますが、必要に応じて、パラメーター（引数）がコマンドレットに渡されます。</font><font style="vertical-align: inherit;">たとえば、それらを使用すると、詳細（-Detailedパラメーター）または完全（-Fullパラメーター）のヘルプに加えて、表示例（-Examplesパラメーター）を取得できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Examples</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellのヘルプは、Update-Helpコマンドレットで更新されます。コマンドラインが長すぎる場合は、サービス文字 `` ''を入力してEnterキーを押すことにより、コマンドレットの引数を次の引数に転送できます-ある行でコマンドの書き込みを終了し、別の行で続行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、一般的なコマンドレットの例です。-&nbsp; </font></font><br>
<br>
<code>Get-Process</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムで実行中のプロセスを表示します。</font></font><br>
<code>Get-Service</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-サービスとそのステータスを表示します。</font></font><br>
<code>Get-Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ファイルの内容を表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellで頻繁に使用されるコマンドレットと外部ユーティリティには、短い同義語-エイリアス（英語のエイリアスから）があります。</font><font style="vertical-align: inherit;">たとえば、dirはGet-ChildItemのエイリアスです。</font><font style="vertical-align: inherit;">同義語のリストには、Unixシステムからのコマンドの類似物（ls、psなど）が含まれており、Get-Helpコマンドレットは、helpコマンドによって呼び出されます。</font><font style="vertical-align: inherit;">同義語の完全なリストは、Get-Aliasコマンドレットを使用して表示できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d-/p_/m-/d-p_m-vc7nnwcrq2weryyqbeb8o.png"></div><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShellスクリプト、関数、モジュール、および言語</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellスクリプトは、拡張子が.ps1のプレーンテキストファイルとして保存されます。ダブルクリックでは起動できません。コンテキストメニューを右クリックして、[PowerShellで実行]項目を選択する必要があります。コンソールから、スクリプトへのフルパスを指定するか、適切なディレクトリに移動してファイル名を書き込む必要があります。スクリプトの実行もシステムポリシーによって制限されます。現在の設定を確認するには、Get-ExecutionPolicyコマンドレットを使用できます。これにより、次のいずれかの値</font></font><br>
<br>
<code>Restricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が提供されます。-スクリプトの実行は禁止されています（デフォルト）。</font></font><br>
<code>AllSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-信頼できる開発者によって署名されたスクリプトの起動のみが許可されます。</font></font><br>
<code>RemoteSigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-署名付きスクリプトとカスタムスクリプトの実行が許可されています。</font></font><br>
<code>Unrestricted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-任意のスクリプトの実行が許可されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
管理者には2つのオプションがあります。最も安全なのはスクリプトへの署名ですが、これはかなり深刻な魔術です。次の記事で扱います。次に、最も抵抗の少ない経路をたどり、ポリシーを変更します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Set-ExecutionPolicy</span> RemoteSigned</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/da/gg/k7dagg4xwaerpartpet4k_5eaa4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、PowerShellを管理者として実行する必要がありますが、特別なパラメーターを使用して現在のユーザーのポリシーを変更できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトはオブジェクト指向プログラミング言語で記述されており、そのコマンドの名前は、前に説明したコマンドレットと同じ原則である「Action-Object」（「Verb-Noun」）に基づいています。その主な目的は管理タスクの自動化ですが、条件付き分岐、ループ、変数、配列、オブジェクト、エラー処理など、必要なすべての構造を備えた本格的なインタプリタ言語です。テキストエディターはスクリプトの記述に適していますが、Windows PowerShell ISEを起動するのが最も便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトにパラメーターを渡し、それらを必須にして、デフォルト値を設定することもできます。</font><font style="vertical-align: inherit;">さらに、Windows PowerShellでは、コマンドレットと同じ方法で関数を作成して呼び出すことができます。これには、Function構文と中かっこを使用します。</font><font style="vertical-align: inherit;">関数を含むスクリプトはモジュールと呼ばれ、拡張子は.psm1です。</font><font style="vertical-align: inherit;">モジュールは、PowerShell環境変数で定義されたディレクトリに保存する必要があります。</font><font style="vertical-align: inherit;">次のコマンドを使用してそれらを表示できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Env:\PSModulePath | <span class="hljs-built_in">Format-Table</span> <span class="hljs-literal">-AutoSize</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンベヤー</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の例では、Unixシステムのシェルのユーザーが使い慣れた設計を使用しました。 Windows PowerShellでは、垂直バーを使用して、あるコマンドの出力を別のコマンドの入力に転送することもできますが、パイプラインの実装には大きな違いがあります。これは、文字セットやテキストに関するものではありません。組み込みのコマンドレットまたはユーザー定義関数は、オブジェクトまたはオブジェクトの配列を返し、それらを入力で受け取ることもできます。 Bourneシェルとその多くのフォロワーと同様に、PowerShellはパイプラインを使用して複雑なタスクを簡素化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パイプラインの最も単純な例は次のようになります。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/pm/l0/zmpml0zpq48xqcsbqga7c-lvkfo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、Get-Serviceコマンドレットが実行され、次に、それが受け取るすべてのサービスが、Statusプロパティによる並べ替えのためにSort-Objectコマンドレットに渡されます。</font><font style="vertical-align: inherit;">パイプラインの前のセクションの結果が渡される引数は、そのタイプによって異なります。通常、これはInputObjectです。</font><font style="vertical-align: inherit;">この問題については、PowerShellプログラミング言語に関する記事で詳しく説明します。&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要に応じて、チェーンを続行し、Sort-Objectの結果を別のコマンドレットに渡すことができます（左から右に実行されます）。</font><font style="vertical-align: inherit;">ちなみに、ページング出力用のWindowsファミリのデザインは、すべてのUnixoidsでも利用できます。&nbsp;</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Service</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-property</span> Status | more</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックグラウンドでのタスクの実行&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、シェルセッションでのコマンドの実行結果を待たないように、特定のコマンドをバックグラウンドで実行する必要があります。</font><font style="vertical-align: inherit;">Windows PowerShellには、この場合のためのいくつかのコマンドレットがあります。- </font></font><br>
<br>
<code>Start-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックグラウンドタスクの起動。</font></font><br>
<code>Stop-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックグラウンドタスクを停止します。</font></font><br>
<code>Get-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックグラウンドタスクのリストを表示します。</font></font><br>
<code>Receive-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックグラウンドタスクの結果を表示します。</font></font><br>
<code>Remove-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックグラウンドタスクの削除。</font></font><br>
<code>Wait-Job</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-バックグラウンドタスクをコンソールに転送します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックグラウンドタスクを開始するには、Start-Jobコマンドレットを使用して、コマンドまたはコマンドのセットを中括弧で囲みます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Start-Job</span> {<span class="hljs-built_in">Get-Service</span>}</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_l/v7/31/_lv731nqaggn7kyk7thfu1g4gzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellのバックグラウンドタスクは、名前を知ることで操作できます。</font><font style="vertical-align: inherit;">まず、それらを表示する方法を学びます：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Job</span></code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tu/r4/ha/tur4halfauj3kro8ajjersimf8o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Job1の結果を示します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Receive-Job</span> Job1 | more</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/od/yz/znodyzk81wsadjjacvg9tmeis9g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とても簡単です。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リモートコマンド実行</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows PowerShellを使用すると、ローカルだけでなくリモートコンピューター、さらにはコンピューターのグループ全体でコマンドやスクリプトを実行できます。</font><font style="vertical-align: inherit;">これにはいくつかの方法があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くのコマンドレットにはパラメーターがありますが</font></font><code>-ComputerName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、たとえばパイプラインの作成など、この方法は失敗します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このコマンドレットを</font></font><code>Enter-PSSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、リモートマシンでインタラクティブセッションを作成できます。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドレットを使用すると、</font></font><code>Invoke-Command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つ以上のリモートコンピューターでコマンドまたはスクリプトを実行できます。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerShellバージョン</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2006年の最初のリリース以来、PowerShellは大きく変化しました。このツールは、さまざまなハードウェアプラットフォーム（x86、x86-64、Itanium、ARM）で実行されている多くのシステムで利用できます：Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008/2008 R2、Windows 7、Windows 8、Windows 8.1、Windows RT、Windows RT 8.1、Windows Server 2012/2012 R2、Windows 10、Windows Server 2016、GNU / Linux、OSX。最新リリース6.2は2018年1月10日にリリースされました。以前のバージョン用に作成されたスクリプトは、後のバージョンで機能する可能性が高くなりますが、長年にわたる開発により、PowerShellに多数の新しいコマンドレットが登場したため、逆移植に問題が発生する可能性があります。 $ PSVersionTable組み込み変数のPSVersionプロパティを使用して、コンピューターにインストールされているシェルのバージョンを確認できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PSVersionTable</span>.PSVersion</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/0o/8z/ib0o8zeqxrn7ye3ddykovsckmis.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドレットを使用することもできます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> <span class="hljs-literal">-Name</span> PSVersionTable –ValueOnly</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3m/zc/r4/3mzcr4i_lettn4s_ulrqo_jpm8g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Get-Hostコマンドレットでも同じことが行われます。</font><font style="vertical-align: inherit;">実際、多くのオプションがありますが、それらを使用するには、PowerShellプログラミング言語を学ぶ必要があります。これは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の記事で行い</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。&nbsp;</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要&nbsp;</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoftは、スクリプトを開発するための便利な統合環境を備えた真に強力なコマンドシェルを作成することに成功しました。これは、Windowsオペレーティングシステム、およびそれらのソフトウェアと.NET Coreプラットフォームとの緊密な統合によって、Unixの世界でよく知られている手段とは異なります。コマンドレットとユーザー定義関数はオブジェクトまたはオブジェクトの配列を返し、それらを入力で受け取ることができるため、PowerShellはオブジェクト指向シェルと呼ばれます。私たちは、すべてのWindowsサーバー管理者がこのツールを所有する必要があると考えています。コマンドラインなしで実行できるようになった時代が過ぎました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server Coreを実行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">いる低コストのVPSでは</font></a><font style="vertical-align: inherit;">特に高度なコンソールシェルが必要です</font><font style="vertical-align: inherit;">が、それは別の話です。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> 4:   ,  <br>
</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja487862/index.html">ニャシャはどれくらいですか？</a></li>
<li><a href="../ja487864/index.html">電子パスポート：世界の慣習に参加するか、個人データの漏洩のリスクを取得しますか？</a></li>
<li><a href="../ja487868/index.html">iOS上のVisionKitおよびVision Frameworkによるドキュメントスキャンとテキスト認識</a></li>
<li><a href="../ja487872/index.html">自宅で液体シリコーンから金型を成形</a></li>
<li><a href="../ja487874/index.html">Intel NUC Chaco Canyon-必要な場所で機能</a></li>
<li><a href="../ja487878/index.html">就職の面接のためにデータサイエンティストからよく寄せられる5つのSQLの質問</a></li>
<li><a href="../ja487882/index.html">Chromeは迷惑な動画広告を自動的にブロックします</a></li>
<li><a href="../ja487884/index.html">交流を始める前に知っておきたい5つのこと</a></li>
<li><a href="../ja487888/index.html">Umbraco CMSのCSRF</a></li>
<li><a href="../ja487890/index.html">Speechフレームワークを使用してiOSで音声をテキストに翻訳する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>