<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê¢ üéß üòì Intel x86 Root of Trust: p√©rdida de confianza üë©üèª‚Äçüîß üëµüèª üåÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagen: shutterstock
 
 Aqu√≠ llega el momento en que los arquitectos de sistemas, ingenieros y expertos en seguridad de Intel pueden haber temido m√°s:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Intel x86 Root of Trust: p√©rdida de confianza</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/490730/"><img src="https://habrastorage.org/webt/hg/oy/c4/hgoyc4kd5xlruwd43mkczw6v0ui.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagen: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shutterstock</font></font></a></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Aqu√≠ llega el momento en que los arquitectos de sistemas, ingenieros y expertos en seguridad de Intel pueden haber temido m√°s: se encontr√≥ un error en el √°rea de memoria no escribible (ROM) del motor de gesti√≥n y seguridad convergente de Intel, y este error arroja dudas sobre Todos los esfuerzos de la compa√±√≠a para crear la ra√≠z de la confianza y la base de la seguridad en sus plataformas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y el punto aqu√≠ no es ni siquiera que los errores del firmware (firmware), que est√°n "conectados" en la memoria integrada de Mask ROM de microprocesadores y conjuntos de chips, no pueden repararse, sino que el error encontrado destruye la cadena de confianza de toda la plataforma en su conjunto, permitiendo comprometer su base de hardware.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los expertos de Positive Technologies encontraron un error de hardware en el hardware de Intel, as√≠ como un error en el firmware de Intel CSME, que se manifiesta en una etapa muy temprana de este subsistema, en su ROM de arranque (ROM de arranque). Se sabe que es Intel CSME el que proporciona la autenticaci√≥n inicial de un sistema basado en chips Intel, descargando y verificando el resto del firmware de las plataformas modernas. Por ejemplo, Intel CSME, al interactuar con el microc√≥digo de la CPU, garantiza la autenticidad del firmware UEFI BIOS a trav√©s de la tecnolog√≠a BootGuard. Adem√°s, Intel CSME descarga y verifica el firmware del Controlador de administraci√≥n de energ√≠a, que controla el suministro de voltaje a cada unidad de hardware en chips Intel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero lo que es m√°s importante, es Intel CSME el responsable de la base criptogr√°fica de dichas tecnolog√≠as de protecci√≥n de hardware desarrolladas por Intel y utilizadas en todas partes, como DRM, fTPM e Intel Identity Protection. El firmware Intel CSME implementa un sistema de certificaci√≥n remota para sistemas de confianza llamado EPID (Enhanced Privacy ID), que le permite identificar de forma √∫nica y an√≥nima cada instancia espec√≠fica de un sistema inform√°tico (computadora), encontrando muchas aplicaciones √∫tiles, como proteger el contenido digital, garantizar la seguridad de las transacciones financieras, certificaci√≥n de internet de las cosas. Adem√°s, el firmware Intel CSME tiene un m√≥dulo de software TPM que le permite usarlo para almacenar claves de cifrado sin un chip TPM adicional, que est√° lejos de cualquier computadora.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E Intel ha tratado de hacer que esta ra√≠z de confianza sea lo m√°s segura posible. El sistema de seguridad de las plataformas Intel est√° dise√±ado de tal manera que incluso un error de ejecuci√≥n de c√≥digo arbitrario en cualquiera de los m√≥dulos de firmware Intel CSME no conlleva el riesgo de perder la clave ra√≠z de seguridad (tambi√©n conocida como Chipset Key), sino que solo pone en peligro las funciones espec√≠ficas de las cuales el m√≥dulo vulnerable es responsable cuando Esto le permite mitigar f√°cilmente el riesgo cambiando las claves de cifrado utilizando el mecanismo de n√∫mero de versi√≥n seguro de SVN. Esto se demostr√≥ claramente en 2017, cuando se encontr√≥ un error de ejecuci√≥n de c√≥digo arbitrario en el m√≥dulo de firmware BringUP (bup), descrito en Intel SA-00086. Luego, Intel simplemente realiz√≥ la regeneraci√≥n de claves al aumentar el SVN, y as√≠ evit√≥ f√°cilmente el riesgo de comprometer las tecnolog√≠as basadas en EPID.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero desafortunadamente, no hay sistemas de seguridad perfectos y, como cualquier otro, la arquitectura de seguridad de Intel tiene su tal√≥n de Aquiles: ROM de arranque. Un error en la ROM en las primeras etapas de ejecuci√≥n realmente le permite controlar el proceso de lectura de la clave del chipset y generar todas las dem√°s claves de cifrado. Una de estas claves se usa para cifrar una matriz de datos de Blob de valores de control de integridad (ICVB). Con esta clave, puede falsificar el c√≥digo de cualquiera de los m√≥dulos de firmware Intel CSME, y el sistema de autenticaci√≥n no podr√° reconocer la falsificaci√≥n. Esto equivale a filtrar la clave privada de firma digital del firmware Intel CSME, pero para esta plataforma en particular.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por el momento, la situaci√≥n con EPID se ve mitigada por el hecho de que la clave del chipset se almacena dentro de la plataforma (en memoria OTP especial, memoria programable de una sola vez) en forma cifrada y para comprometer completamente la EPID, tambi√©n es necesario extraer la clave de hardware en la que se almacena la clave del chipset, que est√° cifrada en almacenamiento especial SKS (almacenamiento de clave segura). Pero esta clave no es exclusiva de la plataforma, sino una para toda la generaci√≥n de chipsets Intel. Y dado que un error encontrado en la ROM le permite interceptar la ejecuci√≥n del c√≥digo hasta bloquear el mecanismo de generaci√≥n de la clave de hardware en SKS, y el error en la propia ROM no se puede solucionar, creemos que esto es solo una cuesti√≥n de tiempo, cuando se extraer√° esta clave. Y luego vendr√° el caos completo: se falsificar√° la identificaci√≥n del hardware, se extraer√° el contenido digital, se descifrar√° la informaci√≥n cifrada de los medios permanentes.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, los expertos de Positive Technologies encontraron un error en la ROM de arranque Intel CSME en todos los conjuntos de chips y SoC de Intel lanzados actualmente, excepto Ice Point (d√©cima generaci√≥n de procesadores). Este error le permite extraer la clave del chipset, as√≠ como manipular parte de la clave de hardware y el proceso de su generaci√≥n, sin permitir, sin embargo, en este momento obtener directamente su componente de hardware (cableado en SKS). Adem√°s, este error en ROM le permite organizar la ejecuci√≥n de c√≥digo arbitrario en el nivel de privilegio cero de Intel CSME. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con m√°s detalle describiremos los detalles t√©cnicos en un libro blanco completo dedicado a este error, que planeamos publicar un poco m√°s tarde. Cabe se√±alar que despu√©s de que nuestros especialistas se pusieron en contacto con Intel PSIRT con un informe sobre este error, Intel inform√≥ que el error ya era conocido ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-0090</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Intel entiende que es imposible corregir un error en la ROM en equipos ya lanzados y, por lo tanto, simplemente bloquean todas las formas posibles de su funcionamiento. El parche para CVE-2019-0090 corrige solo uno de los posibles vectores de ataque, a trav√©s del concentrador de sensores integrado (Integrated Sensors Hub, ISH). Creemos que hay potencialmente muchas formas de explotar esta vulnerabilidad en la ROM. Algunos de ellos pueden requerir acceso local, algunos f√≠sicos. Para abrir ligeramente el velo del secreto, digamos algunas palabras sobre la vulnerabilidad en s√≠:</font></font><br>
<br>
<ol>
<li>    ,    boot ROM:    IOMMU   MISA (Minute IA System Agent),    SRAM ( ) Intel CSME   DMA-, <b>  </b>.  ,     ,     .</li>
<li> Intel CSME  boot ROM     (page directory),          IOMMU.  ,  ,    SRAM    DMA-   (DMA    CSME,      )       SRAM      Intel CSME.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los par√°metros de MISA IOMMU se restablecen cuando se realiza el restablecimiento para Intel CSME, que despu√©s del restablecimiento comienza la ejecuci√≥n nuevamente desde la ROM de arranque.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, cualquier dispositivo de plataforma que pueda realizar transacciones DMA en la memoria est√°tica Intel CSME y al mismo tiempo reiniciar Intel CSME (o simplemente esperar que Intel CSME se active) puede modificar las tablas del sistema de las p√°ginas Intel CSME y, por lo tanto, interceptar ejecuci√≥n. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publicado por Mark Ermolov, Especialista l√≠der, Tecnolog√≠as de SO y Soluciones de hardware, Tecnolog√≠as positivas.</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es490718/index.html">¬øQu√© es el "c√≥digo limpio" en 2020?</a></li>
<li><a href="../es490720/index.html">¬°Motor! o ¬øQu√© es la f√≠sica del juego?</a></li>
<li><a href="../es490722/index.html">Vacaciones de g√©nero en TI. C√≥mo anotar</a></li>
<li><a href="../es490726/index.html">Autenticaci√≥n en equipos de red a trav√©s de SSH usando claves p√∫blicas</a></li>
<li><a href="../es490728/index.html">Semana de la Seguridad 10: Conferencia RSA y Conciencia de Ciberseguridad</a></li>
<li><a href="../es490732/index.html">Reconocimiento de voz: un curso introductorio muy corto</a></li>
<li><a href="../es490734/index.html">Huevos de Pascua en mapas topogr√°ficos de Suiza</a></li>
<li><a href="../es490736/index.html">9 herramientas claras para aprender y aprender vocabulario en ingl√©s</a></li>
<li><a href="../es490738/index.html">Principio de sustituci√≥n de Lisk</a></li>
<li><a href="../es490740/index.html">Defectuoso *** s no es solo aleatorizaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>