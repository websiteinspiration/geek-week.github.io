<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤³ ğŸª ğŸš¼ PHPã‚’ä½¿ç”¨ã—ã¦DVRIPçµŒç”±ã§ã‚«ãƒ¡ãƒ©ã‹ã‚‰ãƒ“ãƒ‡ã‚ªã‚’å–å¾—ã—ã¾ã™ ğŸ’†ğŸ¾ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ» ğŸ‘µğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã§ã¯å‰ã®è¨˜äº‹ã€ç§ã¯ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã®æ˜ åƒã‚’å¼•ã£å¼µã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ç´„æŸã—ã¦ã€ä¸€å®šã®æ™‚é–“ãŒçµŒã£ãŸãŒã€ç´„æŸãŒæˆå°±ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã ã‹ã‚‰ç§ã¯ãã‚Œã‚’ã‚„ã£ã¦ã„ã¾ã™ã€‚
 
 å¶ç„¶ã«ã‚‚ã€ã‚µãƒ¼ãƒãƒ¼Webã®ä¸–ç•Œã§ã¯éåŒæœŸã§ã™ã¹ã¦ãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€PHPã¯é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
 
 ãˆãˆã¨ã€ã‚ãªãŸãŒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PHPã‚’ä½¿ç”¨ã—ã¦DVRIPçµŒç”±ã§ã‚«ãƒ¡ãƒ©ã‹ã‚‰ãƒ“ãƒ‡ã‚ªã‚’å–å¾—ã—ã¾ã™</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484518/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰ã®è¨˜äº‹ã€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§ã¯ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã®æ˜ åƒã‚’å¼•ã£å¼µã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ç´„æŸã—ã¦ã€ä¸€å®šã®æ™‚é–“ãŒçµŒã£ãŸãŒã€ç´„æŸãŒæˆå°±ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã ã‹ã‚‰ç§ã¯ãã‚Œã‚’ã‚„ã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¶ç„¶ã«ã‚‚ã€ã‚µãƒ¼ãƒãƒ¼Webã®ä¸–ç•Œã§ã¯éåŒæœŸã§ã™ã¹ã¦ãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ãŒã€PHPã¯é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãˆãˆã¨ã€ã‚ãªãŸãŒçŸ¥ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã®æ­»ã«ã‹ã‘ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã€ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã€ãã—ã¦å®Ÿéš›ã€PHPã«ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stream_selectï¼ˆï¼‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stream_set_blockingï¼ˆï¼‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥å¤–ã¯ä½•ã‚‚ã‚ã‚Šã¾ã›ã‚“</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã©ã“ã‹ã«ã€PECLã«ã¯</font><font style="vertical-align: inherit;">ã€åŸå‰‡ã¨ã—ã¦å…ƒã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å…ƒã®é–¢æ•°ã®å˜ãªã‚‹ãƒ©ãƒƒãƒ‘ãƒ¼</font><font style="vertical-align: inherit;">ã§ã‚ã‚‹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libuv</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒã‚ã‚‹ã®ã§ã€ãã®ã¾ã¾ä½¿ç”¨ã™ã‚‹ã¨ã„ãã¤ã‹ã®èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã¨ã«ã‹ãã€å½¼ã‚‰ã®æ­£ã—ã„å¿ƒã®ä¸­ã§ã“ã‚Œã‚’è¡Œã†ã®ã¯èª°ã§ã™ã‹ï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€PHP4ã®ä¸–ç•Œã§ã®ç”Ÿæ´»ã‚’ã‚„ã‚ã¦ç¾ä»£ã®ç¾å®Ÿã«å°‘ã—æˆ»ã‚‹ã¨ã€ã“ã“æ•°å¹´ã§çŠ¶æ³ãŒå¤šå°‘å¤‰åŒ–ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReactPHP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AmPHP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªã©ã®èˆˆå‘³æ·±ã„ãƒ„ãƒ¼ãƒ«ãŒ</font><font style="vertical-align: inherit;">ã‚ã‚Š</font><font style="vertical-align: inherit;">ã€ãã‚Œã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯Node.jsæ©Ÿèƒ½ã‚’é©åˆ‡ã«ã‚«ãƒãƒ¼ã—ã¾ã™ã€‚ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®å­˜åœ¨ã«ã‚ˆã‚Šã€éåŒæœŸã‚³ãƒ¼ãƒ‰ã‚’</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async / await</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãªã©ã®ä¾¿åˆ©ãªã‚¹ã‚¿ã‚¤ãƒ«ã§è¨˜è¿°ã—ã€</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚„ã‚­ãƒ­</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¡ãƒ¼ã‚¿ãƒ¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚§ãƒ¼ãƒ³ã§ã“ã‚Œã‚‰ã®ç„¡é™ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å›é¿ã§ãã¾ã™ã€‚</font><i><font style="vertical-align: inherit;">ï¼‰.thenï¼ˆï¼‰ã€‚thenï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€ä»Šã€ç§ã«ã¯ã€PHPãŒè§£æ±ºã§ããªã‹ã£ãŸNode.jsã®ä¸–ç•Œã‹ã‚‰ã®ã‚¿ã‚¹ã‚¯ã¯äº‹å®Ÿä¸Šãªã„ã‚ˆã†ã§ã™ã€‚ã—ã‹ã—ã€ã¾ã ã„ãã¤ã‹ã‚ã‚‹å ´åˆã€ã™ã¹ã¦ã¯ã„ãã¤ã‹ã®å€‹åˆ¥ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å­˜åœ¨ã«ã®ã¿ä¾å­˜ã—ã€ãã®ã‚ˆã†ãªæ©Ÿä¼šã®æ¬ å¦‚ã«ã¯ä¾å­˜ã—ã¾ã›ã‚“ã€‚</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHPæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã®éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚‚ã®ãŒã™ã¹ã¦æƒã£ã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã€äººã€…ã‚’é©šã‹ã›ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã“ã®é ˜åŸŸã§ãƒã‚¤ãƒ†ã‚£ãƒ–PHPã®æ©Ÿèƒ½ã®åˆ¶é™ã«é”ã™ã‚‹ã®ã¯ã€åŒæ™‚ã«ä½•åƒã‚‚ã®ãƒ•ã‚¡ã‚¤ãƒ«è¨˜è¿°å­ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã—ã¦IOã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’èª¿ã¹ã‚‹ã‚ˆã†ã«ä¾é ¼ã—ãŸã¨ãã ã‘ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ã“ã®å ´åˆã§ã‚‚ã€éšœå®³ã¯PHPã§ã¯ãªãã€åŸºã«ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®selectï¼ˆï¼‰å‘¼ã³å‡ºã—ã«ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€è² è·ã®å¢—åŠ ã«ä¼´ã†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ä½ä¸‹ã«ç·šå½¢ã§ã™ã€‚</font></font><br>
<br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amphp.org/amp/event-loop</font></font></a></i></blockquote><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã¡ã‚ã‚“ã€ã“ã‚Œã‚’ã™ã¹ã¦æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹ã¨ã„ã†å•é¡Œã¯ã¾ã å®Œå…¨ã«ã¯è§£æ±ºã•ã‚Œã¦ã„ã¾ã›ã‚“ãŒã€ä»–ã®éåŒæœŸãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç’°å¢ƒãŒè¨±ã•ãªã„ã“ã¨ã‚’æ•…æ„ã«é–“é•ãˆãªã„é™ã‚Šã€ã™ã¹ã¦ãŒå•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DVRIP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ç›£è¦–ã‚«ãƒ¡ãƒ©ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã€ãŠãã‚‰ãä¸­å›½ã«ã‚ˆã£ã¦ç™ºæ˜ã•ã‚ŒãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ¤œè¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã¯ã™ã¹ã¦DVRIPï¼ˆæ™‚ã€…ã‚½ãƒ•ã‚£ã‚¢ï¼‰ã¨å‘¼ã°ã‚Œã‚‹TCPã®ä¸Šã§å‹•ä½œã—ã€ç§ãŒãã‚Œã‚’å¿…è¦ã¨ã—ãŸã¨ãã¾ã§ã«ã€ç§ã¯ãŸã£ãŸ2ã¤ã ã‘ã®ã¾ã¨ã‚‚ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ã®èª¬æ˜ã¯ã€ã¨ã¦ã‚‚å½¹ã«ç«‹ã¡ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ç•ªç›®ã®ã‚‚ã®ã¯å°‘ã—é…ã‚Œã¦è¦‹ã¤ã‹ã‚Šã¾ã—ãŸãŒã€ç§ã®ç—‡å€™ç¾¤ã®æ‚ªåŒ–æ™‚ã«ã“ã“ã§ã¯ç™ºæ˜ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬çš„ã«ã€ã‚¹ãƒ‹ãƒ•ã‚¡ãƒ¼ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ã®èª¬æ˜ã‚’æ­¦å™¨ã«ã€ã‚µãƒ¼ãƒãƒ¼ã®ã©ã“ã‹ã§1ã¤ã®å½¢å¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ç‰¹å®šã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç°¡å˜ã«ã‚¹ã‚±ãƒƒãƒã—ã€ã“ã®è¨˜äº‹ã®ç‰¹å®šã®æ¦‚å¿µå®Ÿè¨¼ã§ç´¹ä»‹ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒ­ãƒˆã‚³ãƒ«è‡ªä½“ã¯è¤‡é›‘ã§ã¯ãªãã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20ãƒã‚¤ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã€‚PHPã§ã¯æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã§ãã¾ã™ã€‚ </font></font><br>
<br>
<pre><code class="php hljs">unpack(<span class="hljs-string">'Chead/Cversion/x2/IsessionId/Isequence/x2/SmsgId/Ilen'</span>, $buffer)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ˜ãƒƒãƒ€ãƒ¼ã®å¾Œã«ã¯é•·ã„lenãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç¶šãã€2ãƒã‚¤ãƒˆã®\ x0a \ x00ã§è£œè¶³ã•ã‚ŒãŸjsonã¾ãŸã¯ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
jsonã®ã¿ã‚’é€ä¿¡ã—ã€ä¸¡æ–¹ã‚’å—ä¿¡ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›ç­”ï¼ˆjsonã‚’å«ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å ´åˆï¼‰ã«ã¯é€šå¸¸</font><font style="vertical-align: inherit;">ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æˆåŠŸã‚’ç¤ºã™</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ret</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå«ã¾ã‚Œã¦ã„</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><b><font style="vertical-align: inherit;">100</font></b><font style="vertical-align: inherit;">ã¾ãŸã¯</font><b><font style="vertical-align: inherit;">515ã«</font></b><font style="vertical-align: inherit;">ç­‰ã—ããªã„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ret</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€å¿œç­”ã¯ã€</font><font style="vertical-align: inherit;">æ„å›³çš„ã«èª¤ã£ã¦ã„ã‚‹ã¨è¦‹ãªã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã“ã®åŸºæœ¬çš„ãªçŸ¥è­˜ã‚’èº«ã«ã¤ã‘ã¦ã€ã‚«ãƒ¡ãƒ©ã«æ¥ç¶šã—ã¦ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">
2ã¤ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã€‚amphp/ socket</font></a><font style="vertical-align: inherit;">ã¯å¿…è¦ãªã»ã¼ã™ã¹ã¦ã‚’</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ãƒ—ãƒ«</font></a><font style="vertical-align: inherit;">ã‚¢ãƒƒãƒ—ã—ã¾ã™</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã€‚evenement/ evenementã¯</font></a><font style="vertical-align: inherit;">ã€</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">packagist</font></a><font style="vertical-align: inherit;">ã§ä½¿ç”¨ã§ãã€æ‹¡å¼µæ©Ÿèƒ½ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">
Ampã§ã®TCPã®æ“ä½œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="php hljs">Loop::run(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<font></font>
    $socket = <span class="hljs-keyword">yield</span> connect(<span class="hljs-string">"tcp://{$addr}:{$port}"</span>);<font></font>
    <font></font>
    <span class="hljs-keyword">yield</span> $socket-&gt;write(<span class="hljs-string">'Hello'</span>);<font></font>
    <font></font>
    <span class="hljs-keyword">while</span> ($chunk = <span class="hljs-keyword">yield</span> $socket-&gt;read()) {
        <span class="hljs-keyword">echo</span> $chunk;<font></font>
    }<font></font>
    <font></font>
    $socket-&gt;close();<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DVRIPã¯é€šå¸¸ã€ãƒãƒ¼ãƒˆ34567ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ã“ã®å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ </font></font><br>
<br>
<pre><code class="php hljs">$socket = <span class="hljs-keyword">yield</span> connect(<span class="hljs-string">'tcp://192.168.0.200:34567'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ã‚«ãƒ¡ãƒ©ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ã‚’é€ä¿¡ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚ãƒãƒƒã‚·ãƒ¥ã¯æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sofiaHash</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $password</span>) : <span class="hljs-title">string</span>
</span>{<font></font>
    $md5 = md5($password, <span class="hljs-literal">true</span>);    
    <span class="hljs-keyword">return</span> implode(<span class="hljs-string">''</span>, array_map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$i</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$md5</span>) </span>{<font></font>
        $c = (ord($md5[<span class="hljs-number">2</span> * $i]) + ord($md5[<span class="hljs-number">2</span> * $i + <span class="hljs-number">1</span>])) % <span class="hljs-number">62</span>;<font></font>
        $c += $c &gt; <span class="hljs-number">9</span> ? ($c &gt; <span class="hljs-number">35</span> ? <span class="hljs-number">61</span> : <span class="hljs-number">55</span>) : <span class="hljs-number">48</span>;
        <span class="hljs-keyword">return</span> chr($c);<font></font>
    }, range(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>)));<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰¿èªãŒæˆåŠŸã—ãŸå ´åˆã¯ã€å‹•ç”»ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã€ã‚«ãƒ¡ãƒ©ãŒãã‚Œã‚’æä¾›ã§ãã‚‹å ´åˆã¯ã€é€ä¿¡ã‚’é–‹å§‹ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒ—ã”ã¨ã«ç‹¬è‡ªã®msgIdãŒã‚ã‚‹ãŸã‚ã€ã©ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸã‹ã‚’ç†è§£ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä¸€èˆ¬çš„ã«ã€ã»ã“ã‚Šã£ã½ã„ä»•äº‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾¿å®œä¸Šã€ã¾ãšãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Packet</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> SUCCESS_CODES = [<span class="hljs-number">100</span>, <span class="hljs-number">515</span>];    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> MESSAGE_CODES = [
        <span class="hljs-string">'packet.request.login'</span>      =&gt; <span class="hljs-number">1000</span>,
        <span class="hljs-string">'packet.request.keepAlive'</span>  =&gt; <span class="hljs-number">1006</span>,
        <span class="hljs-string">'packet.request.claim'</span>      =&gt; <span class="hljs-number">1413</span>,<font></font>
        <font></font>
        <span class="hljs-string">'packet.response.login'</span>     =&gt; <span class="hljs-number">1001</span>,
        <span class="hljs-string">'packet.response.keepAlive'</span> =&gt; <span class="hljs-number">1007</span>,
        <span class="hljs-string">'packet.response.claim'</span>     =&gt; <span class="hljs-number">1414</span>,<font></font>
        <font></font>
        <span class="hljs-string">'packet.videoControl'</span>       =&gt; <span class="hljs-number">1410</span>,
        <span class="hljs-string">'packet.binary'</span>             =&gt; <span class="hljs-number">1412</span>,<font></font>
    ];<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $head = <span class="hljs-number">255</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $version = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $sessionId;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $sequence;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $msgId;<font></font>
    <font></font>
    <span class="hljs-keyword">protected</span> ?<span class="hljs-keyword">string</span> $rawData;
    <span class="hljs-keyword">protected</span> ?<span class="hljs-keyword">array</span> $data;<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> $msgId, ?<span class="hljs-keyword">array</span> $data = <span class="hljs-literal">null</span>, <span class="hljs-keyword">int</span> $sequence = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> $sessionId = <span class="hljs-number">0</span></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;msgId = $msgId;
        <span class="hljs-keyword">$this</span>-&gt;data = $data;
        <span class="hljs-keyword">$this</span>-&gt;sequence = $sequence;
        <span class="hljs-keyword">$this</span>-&gt;sessionId = $sessionId;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) : <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;data !== <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">$this</span>-&gt;rawData = json_encode(<span class="hljs-keyword">$this</span>-&gt;data, JSON_THROW_ON_ERROR) . <span class="hljs-string">"\x0a\x00"</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> pack(<span class="hljs-string">'CCx2IIx2SI'</span>, <span class="hljs-keyword">$this</span>-&gt;head, <span class="hljs-keyword">$this</span>-&gt;version, <span class="hljs-keyword">$this</span>-&gt;sessionId, <span class="hljs-keyword">$this</span>-&gt;sequence, <span class="hljs-keyword">$this</span>-&gt;msgId, strlen(<span class="hljs-keyword">$this</span>-&gt;rawData))<font></font>
            . <span class="hljs-keyword">$this</span>-&gt;rawData;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params"></span>) : ?<span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;data;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRawData</span>(<span class="hljs-params"></span>) : ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;rawData;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSession</span>(<span class="hljs-params"></span>) : <span class="hljs-title">int</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;sessionId;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSequence</span>(<span class="hljs-params"></span>) : <span class="hljs-title">int</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;sequence;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMessageType</span>(<span class="hljs-params"></span>) : <span class="hljs-title">string</span>
    </span>{<font></font>
        $types = array_flip(<span class="hljs-built_in">static</span>::MESSAGE_CODES);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($types[<span class="hljs-keyword">$this</span>-&gt;msgId])) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-built_in">Exception</span>(<span class="hljs-string">'Unknown message type: '</span> . <span class="hljs-keyword">$this</span>-&gt;msgId);<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> $types[<span class="hljs-keyword">$this</span>-&gt;msgId];<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰¿èªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã¿ã¦ãã ã•ã„</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.login'</span>], [
    <span class="hljs-string">'EncryptType'</span> =&gt; <span class="hljs-string">'MD5'</span>,
    <span class="hljs-string">'LoginType'</span>   =&gt; <span class="hljs-string">'DVRIP-Web'</span>,
    <span class="hljs-string">'PassWord'</span>    =&gt; sofiaHash(<span class="hljs-string">'admin'</span>),
    <span class="hljs-string">'UserName'</span>    =&gt; <span class="hljs-string">'admin'</span>,<font></font>
]));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãˆãˆç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚</font><font style="vertical-align: inherit;">æ¥ç¶šã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸãŒã€ã‚«ãƒ¡ãƒ©ãŒæ­£ã—ã„ã‹ã©ã†ã‹ã€å°‘ãªãã¨ã‚‚ä½•ã‚‰ã‹ã®å½¢ã§ã‚«ãƒ¡ãƒ©ãŒåå¿œã—ãŸã‹ã©ã†ã‹ã‚‚ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã©ã†ã„ã†ã‚ã‘ã‹ç­”ãˆã‚’èª­ã‚“ã§ï¼ˆéåŒæœŸã§ã‚„ã‚Šã¾ã—ã‚‡ã†ï¼‰ã€ãã®ä¸­ã®ç‰¹å®šã®ãƒ‘ã‚±ãƒƒãƒˆã‚’é¸æŠã—ã¦ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½•ã‚‰ã‹ã®å½¢ã§å¿œç­”ãƒ‘ã‚±ãƒƒãƒˆã®å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã«ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ™ãƒ³ãƒˆ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«æ±ºã‚</font><font style="vertical-align: inherit;">ã€ãã‚Œã«åŸºã¥ã„ã¦ã€ã™ã§ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‘ã‚±ãƒƒãƒˆã‚’ç ´æ£„ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’ã‚¹ã‚±ãƒƒãƒã—ã¾ã—ãŸ</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span>
</span>{
    <span class="hljs-keyword">protected</span> InputStream $socket;<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">InputStream $socket</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;socket = $socket;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params"></span>) : \<span class="hljs-title">Generator</span>
    </span>{<font></font>
        $buffer = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">while</span> (!<span class="hljs-keyword">$this</span>-&gt;socket-&gt;isClosed() &amp;&amp; $result = <span class="hljs-keyword">yield</span> Packet::read(<span class="hljs-keyword">$this</span>-&gt;socket, $buffer)) {<font></font>
            [$packet, $chunk] = $result;<font></font>
            $buffer = $chunk;<font></font>
            $chunk = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">$this</span>-&gt;emit(<span class="hljs-string">'packet'</span>, [$packet]);
            <span class="hljs-keyword">$this</span>-&gt;emit($packet-&gt;getMessageType(), [$packet]);<font></font>
        }<font></font>
        <font></font>
        $buffer = <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€Packetã‚¯ãƒ©ã‚¹ã«ã„ãã¤ã‹ã®é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚å®Ÿéš›ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‹ã‚‰ãƒ‘ã‚±ãƒƒãƒˆã‚’æŠ½å‡ºã—ã¦ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params">InputStream $socket, <span class="hljs-keyword">string</span> $buffer = <span class="hljs-string">''</span></span>) : <span class="hljs-title">Promise</span>
</span>{
    <span class="hljs-keyword">return</span> call(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $buffer</span>) </span>{<font></font>
        $header = <span class="hljs-literal">null</span>;<font></font>
        <font></font>
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">if</span> ($header === <span class="hljs-literal">null</span> &amp;&amp; strlen($buffer) &gt; <span class="hljs-number">20</span>) {<font></font>
                $header = unpack(<span class="hljs-string">'Chead/Cversion/x2/IsessionId/Isequence/x2/SmsgId/Ilen'</span>, substr($buffer, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>));<font></font>
                $buffer = substr($buffer, <span class="hljs-number">20</span>);<font></font>
            }<font></font>
            <font></font>
            <span class="hljs-keyword">if</span> ($header !== <span class="hljs-literal">null</span> &amp;&amp; strlen($buffer) &gt;= (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>]) {
                <span class="hljs-keyword">return</span> [
                    <span class="hljs-built_in">static</span>::fromRaw($header, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>] &gt; <span class="hljs-number">0</span> ? substr($buffer, <span class="hljs-number">0</span>, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>]) : <span class="hljs-literal">null</span>),<font></font>
                    substr($buffer, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>])<font></font>
                ];<font></font>
            }<font></font>
            <font></font>
            $buffer .= <span class="hljs-keyword">yield</span> $socket-&gt;read();                <font></font>
        } <span class="hljs-keyword">while</span> (!$socket-&gt;isClosed());<font></font>
    });<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromRaw</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $header, ?<span class="hljs-keyword">string</span> $rawData</span>) : <span class="hljs-title">self</span>
</span>{<font></font>
    $packet = <span class="hljs-keyword">new</span> <span class="hljs-built_in">static</span>($header[<span class="hljs-string">'msgId'</span>], <span class="hljs-literal">null</span>, $header[<span class="hljs-string">'sequence'</span>], $header[<span class="hljs-string">'sessionId'</span>]);<font></font>
    $packet-&gt;rawData = $rawData;<font></font>
    <font></font>
    $packet-&gt;data = (<span class="hljs-keyword">int</span>) $packet-&gt;msgId === <span class="hljs-built_in">static</span>::MESSAGE_CODES[<span class="hljs-string">'packet.binary'</span>] || $rawData === <span class="hljs-literal">null</span>
        ? <span class="hljs-literal">null</span>
        : json_decode(substr($rawData, <span class="hljs-number">0</span>, <span class="hljs-number">-2</span>), <span class="hljs-literal">true</span>, <span class="hljs-number">512</span>, JSON_THROW_ON_ERROR);<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> $packet;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Evenementã‚’</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã—ã¦ã€</font><font style="vertical-align: inherit;">ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ¬¡ã®å½¢å¼ã§èª¬æ˜ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="php hljs">$reader-&gt;on($packetType, $handler);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ç§ã¯ã“ã®ãƒã‚§ãƒ¼ãƒ³ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ãŸã€ãã“ã§ç§ã¯åˆ¥ã®ã‚­ãƒ¼ãƒ—ã‚¢ãƒ©ã‚¤ãƒ–ã¨SIGINT / SIGTERMå‡¦ç†ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼š</font></font><br>
<br>
<pre><code class="php hljs">$reader = <span class="hljs-keyword">new</span> Reader($socket = <span class="hljs-keyword">yield</span> connect(<span class="hljs-string">'tcp://10.0.5.100:49152'</span>)); <font></font>
<font></font>
$reader-&gt;on(<span class="hljs-string">'packet.response.login'</span>, asyncCoroutine(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>($packet-&gt;getData()[<span class="hljs-string">'Ret'</span>]) || !in_array($packet-&gt;getData()[<span class="hljs-string">'Ret'</span>], Packet::SUCCESS_CODES)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-built_in">Exception</span>(<span class="hljs-string">'Wrong login data'</span>);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.claim'</span>], [
        <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
        <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Claim'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
    ], <span class="hljs-number">1</span>, $packet-&gt;getSession()));<font></font>
}));<font></font>
<font></font>
$reader-&gt;once(<span class="hljs-string">'packet.response.login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{<font></font>
    Loop::unreference(Loop::repeat($packet-&gt;getData()[<span class="hljs-string">'AliveInterval'</span>] * <span class="hljs-number">1000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$watcherId</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $packet</span>) </span>{
        <span class="hljs-keyword">if</span> ($socket-&gt;getResource() === <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> Loop::cancel($watcherId);   <font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.keepAlive'</span>], [
            <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'KeepAlive'</span>, <span class="hljs-string">'SessionID'</span> =&gt; $packet-&gt;getData()[<span class="hljs-string">'SessionID'</span>]<font></font>
        ], <span class="hljs-number">0</span>, $packet-&gt;getSession()));<font></font>
    }));<font></font>
});<font></font>
<font></font>
$reader-&gt;on(<span class="hljs-string">'packet.response.claim'</span>, asyncCoroutine(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{
    <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.videoControl'</span>], [
        <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
        <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Start'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
    ], $packet-&gt;getSequence() + <span class="hljs-number">1</span>, $packet-&gt;getSession()));<font></font>
}));<font></font>
<font></font>
$emitter = <span class="hljs-keyword">new</span> Emitter();    <font></font>
$reader-&gt;on(<span class="hljs-string">'packet.binary'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$emitter</span>) </span>{<font></font>
    $emitter-&gt;emit($packet-&gt;getRawData());<font></font>
});<font></font>
<font></font>
$reader-&gt;once(<span class="hljs-string">'packet.binary'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{<font></font>
    $signalHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $packet</span>) </span>{
        <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.videoControl'</span>], [
            <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
            <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Stop'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
        ], <span class="hljs-number">0</span>, $packet-&gt;getSession()));<font></font>
        <font></font>
        $socket-&gt;close();<font></font>
    };<font></font>
    Loop::unreference(Loop::onSignal(defined(<span class="hljs-string">'SIGINT'</span>)  ? SIGINT  : <span class="hljs-number">2</span>,  $signalHandler, <span class="hljs-string">'SIGINT'</span>));<font></font>
    Loop::unreference(Loop::onSignal(defined(<span class="hljs-string">'SIGTERM'</span>) ? SIGTERM : <span class="hljs-number">15</span>, $signalHandler, <span class="hljs-string">'SIGTERM'</span>));<font></font>
});<font></font>
<font></font>
asyncCall([$reader, <span class="hljs-string">'start'</span>]);<font></font>
<font></font>
<span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.login'</span>], [
    <span class="hljs-string">'EncryptType'</span> =&gt; <span class="hljs-string">'MD5'</span>,
    <span class="hljs-string">'LoginType'</span>   =&gt; <span class="hljs-string">'DVRIP-Web'</span>,
    <span class="hljs-string">'PassWord'</span>    =&gt; sofiaHash(<span class="hljs-string">'123qwea'</span>),
    <span class="hljs-string">'UserName'</span>    =&gt; <span class="hljs-string">'admin'</span>,<font></font>
]));<font></font>
<font></font>
<span class="hljs-keyword">yield</span> pipe(<span class="hljs-keyword">new</span> IteratorStream($emitter-&gt;iterate()), getStdout());</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨€ã†ã¾ã§ã‚‚ãªãã€æ¨™æº–å‡ºåŠ›ã®ä»£ã‚ã‚Šã«ã€ãƒ“ãƒ‡ã‚ªã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ã©ã“ã«ã§ã‚‚ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã§ãã¾ã™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€çµ‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</font></font></b><div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
ini_set(<span class="hljs-string">'display_errors'</span>, <span class="hljs-string">'stderr'</span>);<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">Emitter</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">Loop</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">Promise</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">ByteStream</span>\<span class="hljs-title">InputStream</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">ByteStream</span>\<span class="hljs-title">IteratorStream</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Evenement</span>\<span class="hljs-title">EventEmitter</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">call</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">asyncCall</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">asyncCoroutine</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">ByteStream</span>\<span class="hljs-title">getStderr</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">ByteStream</span>\<span class="hljs-title">getStdout</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">ByteStream</span>\<span class="hljs-title">pipe</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">function</span> <span class="hljs-title">Amp</span>\<span class="hljs-title">Socket</span>\<span class="hljs-title">connect</span>;<font></font>
<font></font>
<span class="hljs-keyword">require</span> <span class="hljs-string">'vendor/autoload.php'</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sofiaHash</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $password</span>) : <span class="hljs-title">string</span>
</span>{<font></font>
    $md5 = md5($password, <span class="hljs-literal">true</span>);    
    <span class="hljs-keyword">return</span> implode(<span class="hljs-string">''</span>, array_map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$i</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$md5</span>) </span>{<font></font>
        $c = (ord($md5[<span class="hljs-number">2</span> * $i]) + ord($md5[<span class="hljs-number">2</span> * $i + <span class="hljs-number">1</span>])) % <span class="hljs-number">62</span>;<font></font>
        $c += $c &gt; <span class="hljs-number">9</span> ? ($c &gt; <span class="hljs-number">35</span> ? <span class="hljs-number">61</span> : <span class="hljs-number">55</span>) : <span class="hljs-number">48</span>;
        <span class="hljs-keyword">return</span> chr($c);<font></font>
    }, range(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>)));<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span>
</span>{
    <span class="hljs-keyword">protected</span> InputStream $socket;<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">InputStream $socket</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;socket = $socket;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params"></span>) : \<span class="hljs-title">Generator</span>
    </span>{<font></font>
        $buffer = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">while</span> (!<span class="hljs-keyword">$this</span>-&gt;socket-&gt;isClosed() &amp;&amp; $result = <span class="hljs-keyword">yield</span> Packet::read(<span class="hljs-keyword">$this</span>-&gt;socket, $buffer)) {<font></font>
            [$packet, $chunk] = $result;<font></font>
            $buffer = $chunk;<font></font>
            $chunk = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">$this</span>-&gt;emit(<span class="hljs-string">'packet'</span>, [$packet]);
            <span class="hljs-keyword">$this</span>-&gt;emit($packet-&gt;getMessageType(), [$packet]);<font></font>
        }<font></font>
        <font></font>
        $buffer = <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Packet</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> SUCCESS_CODES = [<span class="hljs-number">100</span>, <span class="hljs-number">515</span>];    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> MESSAGE_CODES = [
        <span class="hljs-string">'packet.request.login'</span>      =&gt; <span class="hljs-number">1000</span>,
        <span class="hljs-string">'packet.request.keepAlive'</span>  =&gt; <span class="hljs-number">1006</span>,
        <span class="hljs-string">'packet.request.claim'</span>      =&gt; <span class="hljs-number">1413</span>,<font></font>
        <font></font>
        <span class="hljs-string">'packet.response.login'</span>     =&gt; <span class="hljs-number">1001</span>,
        <span class="hljs-string">'packet.response.keepAlive'</span> =&gt; <span class="hljs-number">1007</span>,
        <span class="hljs-string">'packet.response.claim'</span>     =&gt; <span class="hljs-number">1414</span>,<font></font>
        <font></font>
        <span class="hljs-string">'packet.videoControl'</span>       =&gt; <span class="hljs-number">1410</span>,
        <span class="hljs-string">'packet.binary'</span>             =&gt; <span class="hljs-number">1412</span>,<font></font>
    ];<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params">InputStream $socket, <span class="hljs-keyword">string</span> $buffer = <span class="hljs-string">''</span></span>) : <span class="hljs-title">Promise</span>
    </span>{
        <span class="hljs-keyword">return</span> call(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $buffer</span>) </span>{<font></font>
            $header = <span class="hljs-literal">null</span>;<font></font>
            <font></font>
            <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> ($header === <span class="hljs-literal">null</span> &amp;&amp; strlen($buffer) &gt; <span class="hljs-number">20</span>) {<font></font>
                    $header = unpack(<span class="hljs-string">'Chead/Cversion/x2/IsessionId/Isequence/x2/SmsgId/Ilen'</span>, substr($buffer, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>));<font></font>
                    $buffer = substr($buffer, <span class="hljs-number">20</span>);<font></font>
                }<font></font>
                <font></font>
                <span class="hljs-keyword">if</span> ($header !== <span class="hljs-literal">null</span> &amp;&amp; strlen($buffer) &gt;= (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>]) {
                    <span class="hljs-keyword">return</span> [
                        <span class="hljs-built_in">static</span>::fromRaw($header, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>] &gt; <span class="hljs-number">0</span> ? substr($buffer, <span class="hljs-number">0</span>, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>]) : <span class="hljs-literal">null</span>),<font></font>
                        substr($buffer, (<span class="hljs-keyword">int</span>) $header[<span class="hljs-string">'len'</span>])<font></font>
                    ];<font></font>
                }<font></font>
                <font></font>
                $buffer .= <span class="hljs-keyword">yield</span> $socket-&gt;read();                <font></font>
            } <span class="hljs-keyword">while</span> (!$socket-&gt;isClosed());<font></font>
        });<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromRaw</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $header, ?<span class="hljs-keyword">string</span> $rawData</span>) : <span class="hljs-title">self</span>
    </span>{<font></font>
        $packet = <span class="hljs-keyword">new</span> <span class="hljs-built_in">static</span>($header[<span class="hljs-string">'msgId'</span>], <span class="hljs-literal">null</span>, $header[<span class="hljs-string">'sequence'</span>], $header[<span class="hljs-string">'sessionId'</span>]);<font></font>
        $packet-&gt;rawData = $rawData;<font></font>
        <font></font>
        $packet-&gt;data = (<span class="hljs-keyword">int</span>) $packet-&gt;msgId === <span class="hljs-built_in">static</span>::MESSAGE_CODES[<span class="hljs-string">'packet.binary'</span>] || $rawData === <span class="hljs-literal">null</span>
            ? <span class="hljs-literal">null</span>
            : json_decode(substr($rawData, <span class="hljs-number">0</span>, <span class="hljs-number">-2</span>), <span class="hljs-literal">true</span>, <span class="hljs-number">512</span>, JSON_THROW_ON_ERROR);<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> $packet;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $head = <span class="hljs-number">255</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $version = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $sessionId;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $sequence;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> $msgId;<font></font>
    <font></font>
    <span class="hljs-keyword">protected</span> ?<span class="hljs-keyword">string</span> $rawData;
    <span class="hljs-keyword">protected</span> ?<span class="hljs-keyword">array</span> $data;<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> $msgId, ?<span class="hljs-keyword">array</span> $data = <span class="hljs-literal">null</span>, <span class="hljs-keyword">int</span> $sequence = <span class="hljs-number">0</span>, <span class="hljs-keyword">int</span> $sessionId = <span class="hljs-number">0</span></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;msgId = $msgId;
        <span class="hljs-keyword">$this</span>-&gt;data = $data;
        <span class="hljs-keyword">$this</span>-&gt;sequence = $sequence;
        <span class="hljs-keyword">$this</span>-&gt;sessionId = $sessionId;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) : <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;data !== <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">$this</span>-&gt;rawData = json_encode(<span class="hljs-keyword">$this</span>-&gt;data, JSON_THROW_ON_ERROR) . <span class="hljs-string">"\x0a\x00"</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> pack(<span class="hljs-string">'CCx2IIx2SI'</span>, <span class="hljs-keyword">$this</span>-&gt;head, <span class="hljs-keyword">$this</span>-&gt;version, <span class="hljs-keyword">$this</span>-&gt;sessionId, <span class="hljs-keyword">$this</span>-&gt;sequence, <span class="hljs-keyword">$this</span>-&gt;msgId, strlen(<span class="hljs-keyword">$this</span>-&gt;rawData))<font></font>
            . <span class="hljs-keyword">$this</span>-&gt;rawData;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params"></span>) : ?<span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;data;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRawData</span>(<span class="hljs-params"></span>) : ?<span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;rawData;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSession</span>(<span class="hljs-params"></span>) : <span class="hljs-title">int</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;sessionId;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSequence</span>(<span class="hljs-params"></span>) : <span class="hljs-title">int</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;sequence;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMessageType</span>(<span class="hljs-params"></span>) : <span class="hljs-title">string</span>
    </span>{<font></font>
        $types = array_flip(<span class="hljs-built_in">static</span>::MESSAGE_CODES);
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($types[<span class="hljs-keyword">$this</span>-&gt;msgId])) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-built_in">Exception</span>(<span class="hljs-string">'Unknown message type: '</span> . <span class="hljs-keyword">$this</span>-&gt;msgId);<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> $types[<span class="hljs-keyword">$this</span>-&gt;msgId];<font></font>
    }<font></font>
}<font></font>
<font></font>
Loop::run(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) : \<span class="hljs-title">Generator</span> </span>{<font></font>
    $reader = <span class="hljs-keyword">new</span> Reader($socket = <span class="hljs-keyword">yield</span> connect(<span class="hljs-string">'tcp://10.0.5.100:49152'</span>)); <font></font>
    <font></font>
    $reader-&gt;on(<span class="hljs-string">'packet.response.login'</span>, asyncCoroutine(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>($packet-&gt;getData()[<span class="hljs-string">'Ret'</span>]) || !in_array($packet-&gt;getData()[<span class="hljs-string">'Ret'</span>], Packet::SUCCESS_CODES)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> \<span class="hljs-built_in">Exception</span>(<span class="hljs-string">'Wrong login data'</span>);<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.claim'</span>], [
            <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
            <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Claim'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
        ], <span class="hljs-number">1</span>, $packet-&gt;getSession()));<font></font>
    }));<font></font>
    <font></font>
    $reader-&gt;once(<span class="hljs-string">'packet.response.login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{<font></font>
        Loop::unreference(Loop::repeat($packet-&gt;getData()[<span class="hljs-string">'AliveInterval'</span>] * <span class="hljs-number">1000</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$watcherId</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $packet</span>) </span>{
            <span class="hljs-keyword">if</span> ($socket-&gt;getResource() === <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> Loop::cancel($watcherId);   <font></font>
            }<font></font>
            <font></font>
            <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.keepAlive'</span>], [
                <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'KeepAlive'</span>, <span class="hljs-string">'SessionID'</span> =&gt; $packet-&gt;getData()[<span class="hljs-string">'SessionID'</span>]<font></font>
            ], <span class="hljs-number">0</span>, $packet-&gt;getSession()));<font></font>
        }));<font></font>
    });<font></font>
    <font></font>
    $reader-&gt;on(<span class="hljs-string">'packet.response.claim'</span>, asyncCoroutine(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{
        <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.videoControl'</span>], [
            <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
            <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Start'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
        ], $packet-&gt;getSequence() + <span class="hljs-number">1</span>, $packet-&gt;getSession()));<font></font>
    }));<font></font>
    <font></font>
    $emitter = <span class="hljs-keyword">new</span> Emitter();    <font></font>
    $reader-&gt;on(<span class="hljs-string">'packet.binary'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$emitter</span>) </span>{<font></font>
        $emitter-&gt;emit($packet-&gt;getRawData());<font></font>
    });<font></font>
    <font></font>
    $reader-&gt;once(<span class="hljs-string">'packet.binary'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Packet $packet</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket</span>) </span>{<font></font>
        $signalHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$socket, $packet</span>) </span>{
            <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.videoControl'</span>], [
                <span class="hljs-string">'Name'</span> =&gt; <span class="hljs-string">'OPMonitor'</span>,
                <span class="hljs-string">'OPMonitor'</span> =&gt; [<span class="hljs-string">'Action'</span> =&gt; <span class="hljs-string">'Stop'</span>, <span class="hljs-string">'Parameter'</span> =&gt; [<span class="hljs-string">'Channel'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'CombinMode'</span> =&gt; <span class="hljs-string">'NONE'</span>, <span class="hljs-string">'StreamType'</span> =&gt; <span class="hljs-string">'Main'</span>, <span class="hljs-string">'TransMode'</span>  =&gt; <span class="hljs-string">'TCP'</span>]],<font></font>
            ], <span class="hljs-number">0</span>, $packet-&gt;getSession()));<font></font>
            <font></font>
            $socket-&gt;close();<font></font>
        };<font></font>
        Loop::unreference(Loop::onSignal(defined(<span class="hljs-string">'SIGINT'</span>)  ? SIGINT  : <span class="hljs-number">2</span>,  $signalHandler, <span class="hljs-string">'SIGINT'</span>));<font></font>
        Loop::unreference(Loop::onSignal(defined(<span class="hljs-string">'SIGTERM'</span>) ? SIGTERM : <span class="hljs-number">15</span>, $signalHandler, <span class="hljs-string">'SIGTERM'</span>));<font></font>
    });<font></font>
    <font></font>
    asyncCall([$reader, <span class="hljs-string">'start'</span>]);<font></font>
    <font></font>
    <span class="hljs-keyword">yield</span> $socket-&gt;write((<span class="hljs-keyword">string</span>) <span class="hljs-keyword">new</span> Packet(Packet::MESSAGE_CODES[<span class="hljs-string">'packet.request.login'</span>], [
        <span class="hljs-string">'EncryptType'</span> =&gt; <span class="hljs-string">'MD5'</span>,
        <span class="hljs-string">'LoginType'</span>   =&gt; <span class="hljs-string">'DVRIP-Web'</span>,
        <span class="hljs-string">'PassWord'</span>    =&gt; sofiaHash(<span class="hljs-string">'123qwea'</span>),
        <span class="hljs-string">'UserName'</span>    =&gt; <span class="hljs-string">'admin'</span>,<font></font>
    ]));<font></font>
    <font></font>
    <span class="hljs-keyword">yield</span> pipe(<span class="hljs-keyword">new</span> IteratorStream($emitter-&gt;iterate()), getStdout());<font></font>
});</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã§ã€ã“ã®æ–¹æ³•ã§ãƒ“ãƒ‡ã‚ªã‚’éŒ²ç”»ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™</font></font><br>
<br>
<pre><code class="bash hljs">$ php recorder.php &gt; output.h264</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIGINTãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ ã—ãŸã®ã§ã€é£½ããŸã‚‰Ctrl + Cã‚’æŠ¼ã™ã ã‘ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ãƒ“ãƒ‡ã‚ªã®é€ä¿¡ã‚’åœæ­¢ã—ã€æ¥ç¶šã‚’æ­£å¸¸ã«é–‰ã˜ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã¨ãˆã°ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ffmpegã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã€ãã®å ´ã§ãƒˆãƒ©ãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">$ php recorder.php | ffmpeg -nostdin -y -hide_banner -loglevel verbose -f h264 -i pipe:0 -pix_fmt yuv420p -c copy -movflags +frag_keyframe+empty_moov+default_base_moof -reset_timestamps 1 -f mpegts output.mpegts</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ã€ã‚ãªãŸã¯ã®ã‚ˆã†ãªå¿…æ­»ã®é–ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ </font></font><br>
<br>
<pre><code class="bash hljs">$ php recorder.php | ffmpeg ... | curl -d @- ... </code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1æ™‚é–“ã”ã¨ã«å†èµ·å‹•ã™ã‚‹ã‚ã‚‹ç¨®ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã‚’èµ·å‹•ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¿…è¦ã«å¿œã˜ã¦ã€ã‚ªãƒ³ã‚¶ãƒ•ãƒ©ã‚¤ã§1æ™‚é–“æŒç¶šã™ã‚‹ã‚¹ãƒ ãƒ¼ã‚ºãªãƒ”ãƒ¼ã‚¹ã‚’å–å¾—ã§ãã¾ã™ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½•ã®ãŸã‚ã«ï¼Ÿ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ã¯ã“ã®è¨˜äº‹ãŒã€Œãªãœã€ã¨ã„ã†ç–‘å•ã‚’å¤šãã®äººã«æèµ·ã™ã‚‹ã¨ä¿¡ã˜ã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã®ç™»éŒ²ã«ã¯æ—¢è£½ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã€ä¸€èˆ¬çš„ã«ã‚«ãƒ¡ãƒ©ã¯å¤šãã®ã“ã¨ã‚’è‡ªåˆ†ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚å‰ã®è¨˜äº‹ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆã§æ­£å½“ã«åå¯¾ã—ã¦ãŠã‚Šã€ä¸€èˆ¬çš„ã«ã¯ã¯ã‚‹ã‹ã«ç°¡å˜ã«ãªã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã©ã“ã‹ã§ã‚„ã‚‰ãªãã¦ã¯ã„ã‘ãªã‹ã£ãŸæ™‚é–“ã€è‡ªåˆ†ã®é“ã‚’ä½œã£ã¦ã¿ãŸã„ã¨ã„ã†æ¬²æœ›ã€ãã—ã¦å®Ÿé¨“ã«å¯¾ã™ã‚‹é£½ããªãæ¬²æœ›ã ã£ãŸã ã‘ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ãã‚Œã¯æ©Ÿèƒ½ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã¡ã‚ã‚“ã€ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¯ã„ãã¤ã‹ã®å¤‰æ›´ãŒå¿…è¦ãªã®ã§ã€ã“ã®å½¢å¼ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚ç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€ã“ã‚Œã¯æ¦‚å¿µå®Ÿè¨¼ã§ã™ã€‚ãã—ã¦ã€ä¸€èˆ¬çš„ã«ã€ç§ã¯ã‚ãªãŸã®å®¶ã®å®‰å…¨ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã«è†ã®é«˜ã•ã®è‡ªå®¶è£½ã®è£½å“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’å¼·ãè­¦å‘Šã—ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ã®å ´åˆã€ä¿¡é ¼æ€§ã¯ãã‚Œã»ã©é‡è¦ã§ã¯ãªã„ã®ã§ã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ©Ÿèƒ½ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¦ã‚©ãƒƒãƒãƒ£ãƒ¼ãŒã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å›è»¢ã•ã›ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ffmpegã«è»¢é€ã—ã€æ™‚é–“å˜ä½ã§ãƒ”ãƒ¼ã‚¹ã‚’è¨˜éŒ²ã—ã¦VKã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€åˆ‡æ–­ã‚„äºˆæœŸã—ãªã„ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸå ´åˆã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†èµ·å‹•ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€èˆ¬ã«ã€å‰ã®è¨˜äº‹ã®æœ€å¾Œã§ææ¡ˆã—ãŸã‚ˆã†ã«ã€RTSP over TCPã‚’ä»‹ã—ã¦ãƒ“ãƒ‡ã‚ªã‚’å˜ã«å¼•ãå‡ºã™ã“ã¨ã§ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã‚’å›é¿ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸãŒã€ffmpegã¯ã€ãƒ©ãƒ³ãƒ€ãƒ ãªç¬é–“ã«æ„šã‹ã«ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€SIGKILLã«ã®ã¿å¿œç­”ã™ã‚‹ã“ã¨ã‚’å¥½ã¿ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯ã™ã¹ã¦ã€è¦ªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¦ã‚©ãƒƒãƒãŒç‹å† ã«ã‚ˆã£ã¦é–‹å§‹ã•ã‚Œã€å„ªå…ˆåº¦ãŒä½ã„ãŸã‚ã§ã‚ã‚‹ã¨ç–‘ã„å§‹ã‚ã¾ã—ãŸãŒã€å„ªå…ˆåº¦ã‚’ä¸Šã’ã‚‹ã¨å•é¡Œã®é »åº¦ãŒæ¸›ã£ãŸã ã‘ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å ´åˆã€ã™ã¹ã¦ãŒã¯ã‚‹ã‹ã«å®‰å®šã—ã¦æ©Ÿèƒ½ã—ã€ã¾ã ä¸æº€ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja484502/index.html">Facebookã¯ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«åŠ´åƒæ™‚é–“ã‚’ç§’å˜ä½ã§è¨˜éŒ²ã™ã‚‹ã“ã¨ã‚’å¼·åˆ¶ã—ã¾ã™-ãƒˆã‚¤ãƒ¬ã«è¡Œãã“ã¨ã•ãˆ</a></li>
<li><a href="../ja484504/index.html">10ãƒ‰ãƒ«æœªæº€ã§ç©ºæ°—ã‚¤ã‚ªãƒŠã‚¤ã‚¶ãƒ¼ã‚’ä½œã‚‹</a></li>
<li><a href="../ja484506/index.html">ç§ã¯å†™çœŸå®¶ã§ã‚ã‚Šã€è‡ªåˆ†è‡ªèº«ã‚’ä½œæ¥­ãƒ„ãƒ¼ãƒ«ã«ã—ã¾ã™</a></li>
<li><a href="../ja484512/index.html">TOP 25ã®æœ€å¤§ã®ICOï¼šç¾åœ¨ã®å•é¡Œã¯ä½•ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja484514/index.html">Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
<li><a href="../ja484520/index.html">zipã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¯ã©ã®ã‚ˆã†ã«è¦‹ãˆã€ãã‚Œã§ä½•ãŒã§ãã‚‹ã‹ã€‚ãƒ‘ãƒ¼ãƒˆ3-å®Ÿç”¨çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</a></li>
<li><a href="../ja484522/index.html">DEFCONä¼šè­°27.è­¦å¯Ÿã‚’ãƒãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ã€‚ãƒ‘ãƒ¼ãƒˆ2</a></li>
<li><a href="../ja484526/index.html">Androidã§å®Ÿè¡Œã™ã‚‹SDL2ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æº–å‚™</a></li>
<li><a href="../ja484528/index.html">è¶£å‘³ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’k8sã«è»¢é€ã—ãŸæ–¹æ³•</a></li>
<li><a href="../ja484530/index.html">ãƒ—ãƒ©ã‚ºãƒå‡¦ç†/é«˜åˆ†å­ææ–™ã®å¤‰æ›´ã®ãŸã‚ã®CNCãƒã‚·ãƒ³</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>