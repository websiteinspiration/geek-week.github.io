<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👦‍👦 🈵 🥨 Yii2を使用しています。別のCMSを書くか、最小限のオーバーヘッドで開発を大幅にスピードアップする試み 👘 🔉 👩🏿‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="特定のフレームワークを長期間使用してきたほとんどすべての開発者は、サイトの開発をスピードアップできる独自のツールセットを持っています。ただし、多くの場合、それらは十分に構造化されておらず、ドキュメントがなく、生産の「プロセス」で最終決定されています。
 
 yicmsプロジェクトのアイデアは、Yii...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Yii2を使用しています。別のCMSを書くか、最小限のオーバーヘッドで開発を大幅にスピードアップする試み</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454914/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のフレームワークを長期間使用してきたほとんどすべての開発者は、サイトの開発をスピードアップできる独自のツールセットを持っています。ただし、多くの場合、それらは十分に構造化されておらず、ドキュメントがなく、生産の「プロセス」で最終決定されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yicmsプロジェクトのアイデアは、Yii2フレームワークのすべてのベストプラクティスを収集することでした。これは、特定のシステムでは便利そうに見えます。これは、ユーザビリティ、柔軟性、およびツールを使用して標準サイトの開発を大幅に加速する機能に基づいている必要があります。このプロジェクトは私が「魂」のために開発したものですが、現時点ではすでにベータ版です。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yicmsの本質は、フレームワークの機能とCMSの通常の機能の間のどこかにあります。</font><font style="vertical-align: inherit;">これは通常の意味でのCMSではなく、フレームワークの機能に完全に「アクセス」しながら、ツールを使用してサイトの開発を大幅に加速できる一連のモジュールにすぎません。</font><font style="vertical-align: inherit;">yicmsに埋め込まれている主な機能は、オンザフライで生成される管理パネルと、IDEの自動補完を使用して直感的なインターフェイスを持つ自動注釈付きクラスです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インストールとセットアップ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、yicmsをインストールして始めましょう。</font><font style="vertical-align: inherit;">デートの場合、最も簡単な方法はOpen Serverまたは他の同様のサーバープラットフォームを使用することです。</font><font style="vertical-align: inherit;">yicmsはYiiに強く依存しているため、最初にインストールします。</font><font style="vertical-align: inherit;">簡単にするために、基本テンプレートを使用し</font></font><br>
<br>
<code>composer create-project --prefer-dist yiisoft/yii2-app-basic basic</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。composerがフレームワークをインストールした後、4つのyicmsモジュールを含むcomposer.jsonファイルのrequireセクションを追加し、composer updateを実行します。</font></font><br>
<br>
<pre><code class="json hljs">  <span class="hljs-string">"require"</span>: {
      <span class="hljs-attr">"php"</span>: <span class="hljs-string">"&gt;=5.4.0"</span>,
      <span class="hljs-attr">"yiisoft/yii2"</span>: <span class="hljs-string">"~2.0.14"</span>,
      <span class="hljs-attr">"yiisoft/yii2-bootstrap"</span>: <span class="hljs-string">"~2.0.0"</span>,
      <span class="hljs-attr">"yiisoft/yii2-swiftmailer"</span>: <span class="hljs-string">"~2.0.0 || ~2.1.0"</span>,
      <span class="hljs-attr">"iliich246/yii2-yicms-common"</span>: <span class="hljs-string">"dev-master"</span>,
      <span class="hljs-attr">"iliich246/yii2-yicms-pages"</span>: <span class="hljs-string">"dev-master"</span>,
      <span class="hljs-attr">"iliich246/yii2-yicms-essences"</span>: <span class="hljs-string">"dev-master"</span>,
      <span class="hljs-attr">"iliich246/yii2-yicms-feedback"</span>: <span class="hljs-string">"dev-master"</span><font></font>
  },<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各モジュールは、将来的に検討される特定の機能のセットを表します。</font><font style="vertical-align: inherit;">今のところ、それらすべてをインストールします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、サーバーを構成することを忘れないでください。</font><font style="vertical-align: inherit;">Open Serverでは、Apacheを使用して.htaccessを次のように設定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ルート.htaccessファイルの場合：</font></font><br>
<pre><code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span> +FollowSymLinks
<span class="hljs-attribute">IndexIgnore</span> */*
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span> <span class="hljs-literal">on</span><font></font>
<font></font>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_URI}</span> !^/(web)
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^assets/(.*)$ /web/assets/$<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^css/(.*)$ web/css/$<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^js/(.*)$ web/js/$<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^images/(.*)$ web/images/$<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^files/(.*)$ web/files/$<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> (.*) /web/$<span class="hljs-number">1</span><font></font>
<font></font>
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-f
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-d
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> . web/index.php<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webディレクトリの.htaccessファイル</font></font><br>
<br>
<pre><code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-f
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span> <span class="hljs-variable">%{REQUEST_FILENAME}</span> !-d
<span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> . index.php
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のステップは、各yicmsモジュールの移行をデータベースにロールすることです。</font><font style="vertical-align: inherit;">コンソールで、次のコマンドを順番に実行します</font></font><br>
<br>
<code>yii migrate/up --migrationPath=@vendor/iliich246/yii2-yicms-common/Migrations</code><br>
<br>
<code>yii migrate/up --migrationPath=@vendor/iliich246/yii2-yicms-pages/Migrations</code><br>
<br>
<code>yii migrate/up --migrationPath=@vendor/iliich246/yii2-yicms-essences/Migrations</code><br>
<br>
<code>yii migrate/up --migrationPath=@vendor/iliich246/yii2-yicms-feedback/Migrations</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。config / web.phpファイルで設定を開始しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールセクションは次のように構成されます。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-string">'modules'</span> =&gt; [
   <span class="hljs-string">'common'</span> =&gt; [
      <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'Iliich246\YicmsCommon\CommonModule'</span>,<font></font>
   ],<font></font>
   <span class="hljs-string">'pages'</span> =&gt; [
      <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'Iliich246\YicmsPages\PagesModule'</span>,<font></font>
   ],<font></font>
   <span class="hljs-string">'essences'</span> =&gt; [
      <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'Iliich246\YicmsEssences\EssencesModule'</span>,<font></font>
   ],<font></font>
   <span class="hljs-string">'feedback'</span> =&gt; [
      <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'Iliich246\YicmsFeedback\FeedbackModule'</span>,<font></font>
   ],<font></font>
   <span class="hljs-string">'redactor'</span> =&gt; <span class="hljs-string">'yii\redactor\RedactorModule'</span>,<font></font>
],<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブートストラップセクションは次のように構成されています。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-string">'bootstrap'</span> =&gt; [<span class="hljs-string">'log'</span>, <span class="hljs-string">'common'</span>, <span class="hljs-string">'pages'</span>, <span class="hljs-string">'essences'</span>, <span class="hljs-string">'feedback'</span>],</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
userセクションは次のように構成されています。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-string">'user'</span> =&gt; [
    <span class="hljs-string">'identityClass'</span> =&gt; <span class="hljs-string">'Iliich246\YicmsCommon\Base\CommonUser'</span>,
    <span class="hljs-string">'enableAutoLogin'</span> =&gt; <span class="hljs-literal">true</span>,<font></font>
],<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コメントセクションurlManagerを削除します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-string">'urlManager'</span> =&gt; [
    <span class="hljs-string">'enablePrettyUrl'</span> =&gt; <span class="hljs-literal">true</span>,
    <span class="hljs-string">'showScriptName'</span> =&gt; <span class="hljs-literal">false</span>,
    <span class="hljs-string">'rules'</span> =&gt; [<font></font>
    ],<font></font>
],<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yii2フレームワークとyicmsシステムが正常に構成されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初の実行後、すべてが正しく構成されていれば、プロジェクトのルートディレクトリにyicmsディレクトリが作成されます。このディレクトリには、ユーザーが変更を加えるために使用できるファイルが含まれ、自動注釈付きクラスがその中に作成されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/zc/n6/wszcn6cnsn9mjmguj_cq5mwkt8k.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CommonモジュールとPagesモジュールの説明</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yicmsシステムは2つのセクションで構成されています。開発者のみがアクセスできるDevセクション（コードを改ざんすることは可能）とサイト管理者は、Adminセクションにアクセスできる必要があります（コンテンツ管理が行われます）。開始するには、Devセクションに移動する必要があります。これには、次のURLを使用する必要があります。</font></font><br>
<br>
<code>http://&lt;  &gt;/web/common/dev/login-as-dev?hash=123456&amp;asDev</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、Devパネルが開くはずです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/2m/zr/hy2mzrfv8ln9m2jtpk_xbnx4b1q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、yicms機能の処理を開始します。まず、Pagesモジュールで、indexと呼ばれるページを作成します。これは、サイトのメインページになります。ページのリストに移動し、インデックスと呼ばれる新しいページを作成します。デフォルトでは、title、meta_description、meta_keywordsの各フィールドがページに作成されます。さらに、名前がテキストの新しいフィールドの追加ボタンを使用して別のフィールドを作成します。デフォルトでは、すべてのパラメーターをそのままにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンクをクリックする</font></font><br>
<br>
<code>http://&lt;  &gt;/web/pages/admin</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
と、管理セクションが開きます。インデックスページでコンテンツを入力できます。すべてのフィールドにフリーテキストを入力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスページのdevセクションでの作成時に、Indexクラスはyicms / Pages / Modelsディレクトリに作成されました。このディレクトリには、title、meta_description、meta_keywordsフィールド、およびその場で作成したテキストフィールドの注釈も作成されました。フィールドの値を取得するために使用できるこのクラスのオブジェクト。これを行う方法を検討してください。 actionIndexの基本テンプレートの標準SiteControllerコントローラーで、次のように記述します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">/**
 * Displays homepage.
 *
 * <span class="hljs-doctag">@return</span> string
 * <span class="hljs-doctag">@throws</span> \Iliich246\YicmsPages\Base\PagesException
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionIndex</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    $indexPage = \app\yicms\Pages\Models\Index::getInstance();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;render(<span class="hljs-string">'index'</span>, [
        <span class="hljs-string">'indexPage'</span> =&gt; $ indexPage<font></font>
    ]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラス\ app \ yicms \ Pages \ Models \ Indexが自動的に生成されたので、そのオートコンプリートはIDEで機能します。 $ indexPageをインデックスとして使用できるようになりました。次に、インデックスビューを開きます。そこから不要なものをすべて削除して、次のように記述します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $this yii\web\View */</span>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $indexPage \app\yicms\Pages\Models\Index */</span><font></font>
<font></font>
<span class="hljs-keyword">$this</span>-&gt;title = $indexPage-&gt;title;<font></font>
<font></font>
<span class="hljs-keyword">$this</span>-&gt;registerMetaTag([
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'description'</span>,
    <span class="hljs-string">'content'</span> =&gt; $indexPage-&gt;meta_description<font></font>
]);<font></font>
<font></font>
<span class="hljs-keyword">$this</span>-&gt;registerMetaTag([
    <span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'keywords'</span>,
    <span class="hljs-string">'content'</span> =&gt; $indexPage-&gt;meta_keywords<font></font>
]);<font></font>
<span class="hljs-meta">?&gt;</span><font></font>
<font></font>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">site</span>-<span class="hljs-title">index</span>"&gt;
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">jumbotron</span>"&gt;
        &lt;<span class="hljs-title">h1</span>&gt;&lt;?= $<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">text</span> ?&gt;&lt;/<span class="hljs-title">h1</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;

    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">body</span>-<span class="hljs-title">content</span>"&gt;

    &lt;/<span class="hljs-title">div</span>&gt;
&lt;/<span class="hljs-title">div</span>&gt;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDEのオートコンプリートが機能するには、$ indexPage変数の注釈が必要です。 $ indexPageオブジェクトを使用します。インデックスページのdevセクションで作成したすべてのフィールドは、インデックスクラスのオブジェクトで使用できます。これは、自動注釈のおかげで、矢印演算子を入力した後にIDEによって補完されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体として、短時間で、コンテンツを編集するための管理パネルが自動的に作成されるインデックスページを作成しました。プログラミングは、フレームワークの標準コントローラーでページオブジェクトを作成するためにのみ使用し、オートコンプリートと直感的なインターフェイスのおかげで、ページオブジェクトをすばやく使用できる形式で作成しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yicms機能の最小部分のみを調べました。ここで、yicmsを使用してサイトのメインページを少し複雑にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yicmsはそのままで多言語対応をサポートしています。</font><font style="vertical-align: inherit;">共通モジュールのdevセクションで2番目の言語をアクティブ化するには、言語のリストを選択してから、ロシア語を選択してアクティブ化し</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ka/eh/uw/kaehuwkq6y1qeubwmue9obzqtv4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。管理パネルで、複数の言語のフィールドに入力できます。</font><font style="vertical-align: inherit;">システムで新しい言語を作成できます。</font><font style="vertical-align: inherit;">ただし、フレームワークの標準ツールを使用して管理パネルを翻訳する必要があります。</font><font style="vertical-align: inherit;">したがって、新しい言語を作成するときは、ISOに準拠する必要があります。</font><font style="vertical-align: inherit;">コンテンツコントロールの場合、新しい言語の新しいプレートが追加されるだけです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントファイルブロック</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ファイルブロック要素について考えます。インデックスページの開発パネルで、プログラム名がdocumentのファイルブロックを作成します。他のブロック設定はデフォルトで残されます。これで、ドキュメントファイルのインデックスページ編集用の管理パネルで使用できるようになりました。任意のファイルをダウンロードします。これで、それをダウンロードするためのリンクをサイトのインデックスページに表示できます。</font></font><br>
<br>
<pre><code class="php hljs">…<font></font>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">body</span>-<span class="hljs-title">content</span>"&gt;
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">row</span>"&gt;
        &lt;<span class="hljs-title">h3</span>&gt;<span class="hljs-title">Document</span>&lt;/<span class="hljs-title">h3</span>&gt;
        &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>="&lt;?= $<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">document</span>-&gt;<span class="hljs-title">uploadUrl</span>() ?&gt;"&gt;
            &lt;?= $<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">document</span> ?&gt;
        &lt;/<span class="hljs-title">a</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;

…
&lt;/<span class="hljs-title">div</span>&gt;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページ上のリンクは、管理パネルにアップロードしたファイルをロードします。既定では、ファイルブロックはすべての言語で単一ファイルモードで動作します。ただし、開発パネルでは、言語タイプを翻訳可能タイプに切り替えることができます。その後、言語ごとに独自のファイルをアップロードする必要があります。この場合、サイトで現在アクティブな言語のファイルがリンクからダウンロードされます。もちろん、後で説明する特定の言語用にダウンロードすることもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発パネルの次のステップは、タイプを複数のタイプとして指定するレシピファイルブロックを作成することです。このモードでは、1つのファイルブロックに多くのファイルをアップロードできます。これを行うには、管理パネルの表示される[レシピ]タブで、いくつかの任意のファイルをアップロードします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、インデックスの形式で、ファイルをリストします。</font></font><br>
<br>
<pre><code class="php hljs">…<font></font>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">row</span>"&gt;
    &lt;<span class="hljs-title">h3</span>&gt;<span class="hljs-title">Recipes</span>&lt;/<span class="hljs-title">h3</span>&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">foreach</span> ($<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">recipes</span> <span class="hljs-title">as</span> $<span class="hljs-title">recipe</span>): ?&gt;
        &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>="&lt;?= $<span class="hljs-title">recipe</span>-&gt;<span class="hljs-title">uploadUrl</span>() ?&gt;"&gt;
            &lt;?= $<span class="hljs-title">recipe</span> ?&gt;
        &lt;/<span class="hljs-title">a</span>&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endforeach</span>; ?&gt;
&lt;/<span class="hljs-title">div</span>&gt;
…
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルチタイプモードでは、ファイルブロックをforeachまたはイテレータでバイパスできます。 </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像ブロックコンポーネント</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、イメージブロック要素について考えます。</font><font style="vertical-align: inherit;">インデックスページの画像ブロックを作成し、すべてのデフォルト設定をそのままにします。</font><font style="vertical-align: inherit;">ファイルブロックと同様に、管理パネルには画像をアップロードする機能があります。</font><font style="vertical-align: inherit;">任意の画像をアップロードします。</font><font style="vertical-align: inherit;">インデックスの形で、次のように書きます。</font></font><br>
<br>
<pre><code class="php hljs">&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">row</span>"&gt;
    &lt;<span class="hljs-title">h3</span>&gt;<span class="hljs-title">Image</span>&lt;/<span class="hljs-title">h3</span>&gt;
    &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>="&lt;?= $<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">picture</span> ?&gt;" <span class="hljs-title">alt</span>=""&gt;
&lt;/<span class="hljs-title">div</span>&gt;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像ファイルと同様に、1つはデフォルトですべての言語に読み込まれますが、画像の場合、この動作は開発パネルで変更して、言語ごとに独自の画像をアップロードできます。</font><font style="vertical-align: inherit;">1つのブロックで多くの画像をアップロードすることもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発パネルで画像ギャラリーのブロックを作成し、タイプを複数の画像に設定します。画像の場合、テキストフィールドをオンザフライでハングアップすることもできます。したがって、ギャラリーブロックを設定するためのモーダルウィンドウで、[画像ブロックフィールドの表示]セクションに移動しましょう。この画像セクションでは、altとnameという名前のフィールドを作成します。各画像の管理パネルで、altおよびnameテキストフィールドを設定することができます。また、すぐに使用できる画像のyicmsには、サムネイルを「トリミング」して作成する機能があります。たとえば、ギャラリーブロックのサムネイルテンプレートを作成します。画像ブロックのモーダルウィンドウで、[画像サムネイルの設定]セクションに移動します。その中で、「x2」という名前のサムネイルコンフィギュレーターとパラメーターDivider = 2およびQuality = 80を作成します。名前でサムネイルにアクセスでき、Diverterは元の画像のサイズをどれだけ小さくするかを決定します。品質は、サムネイルの圧縮品質を決定します。次に、program_name =“ x5”、divider = 5、quality = 50のパラメーターを使用して別のサムネイルテンプレートを作成します。管理パネルから画像を読み込むと、選択したパラメーターを使用して2つのサムネイルが自動的に作成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ギャラリーグループの管理パネルに画像をアップロードします。</font><font style="vertical-align: inherit;">イメージを作成してアップロードしたら、開発パネルでテンプレートを作成したaltフィールドとnameフィールドに入力できます。</font><font style="vertical-align: inherit;">このすべてをサイトに表示する方法を見てみましょう。</font></font><br>
<br>
<pre><code class="php hljs">&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">row</span>"&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">foreach</span>($<span class="hljs-title">indexPage</span>-&gt;<span class="hljs-title">gallery</span>-&gt;<span class="hljs-title">getImages</span>() <span class="hljs-title">as</span> $<span class="hljs-title">image</span>): ?&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">lg</span>-4"&gt;
            &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>="&lt;?= $<span class="hljs-title">image</span> ?&gt;" <span class="hljs-title">width</span>="100%" 
		  <span class="hljs-title">alt</span>="&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">alt</span> ?&gt;"&gt;
            &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>="&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">outputThumbnail</span>('<span class="hljs-title">x2</span>') ?&gt;" 
		  <span class="hljs-title">alt</span>="&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">alt</span> ?&gt;"&gt;
            &lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>="&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">outputThumbnail</span>('<span class="hljs-title">x5</span>') ?&gt;" 
		  <span class="hljs-title">alt</span>="&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">alt</span> ?&gt;"&gt;
            &lt;<span class="hljs-title">p</span>&gt;&lt;?= $<span class="hljs-title">image</span>-&gt;<span class="hljs-title">name</span> ?&gt;&lt;/<span class="hljs-title">p</span>&gt;
        &lt;/<span class="hljs-title">div</span>&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endforeach</span>; ?&gt;
&lt;/<span class="hljs-title">div</span>&gt;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、getImages（）メソッドは、自動アノテーションクラスapp \ yicms \ Pages \ Models \ Index \ Images \ GalleryImageのオブジェクトの配列を返します。その中に、オンザフライで作成したaltフィールドとnameフィールドのアノテーションが作成され、IDEオートコンプリートを使用できます。</font><font style="vertical-align: inherit;">また、オブジェクトでoutputThumbnailメソッド（&lt;Thumbnail Template Name&gt;）を呼び出して、オブジェクトをサムネイル出力モードに切り替えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像ブロックの場合、フィールドだけでなく、後で検討する条件も作成できます。</font><font style="vertical-align: inherit;">ファイルブロックのフィールドと条件も作成できます。</font><font style="vertical-align: inherit;">同様の原理で動作します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンポーネントの条件</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、次の要素について考えます。</font><font style="vertical-align: inherit;">これらは条件です。</font><font style="vertical-align: inherit;">条件は、管理パネルリスト、チェックボックスなどで作成するのに便利です。</font><font style="vertical-align: inherit;">これは、ページを操作するときの特定の動作を決定します。</font><font style="vertical-align: inherit;">例を考えてみましょう。</font><font style="vertical-align: inherit;">インデックスページの開発パネルでbackgroundという名前の条件を作成します。</font><font style="vertical-align: inherit;">「select dropdown type」を選択して入力します。</font><font style="vertical-align: inherit;">条件を作成したら、「構成条件オプション」セクションに移動します。</font><font style="vertical-align: inherit;">透明、赤、緑の値を持つ3つの条件値を作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、値がTRANSPARENT、RED、GREENのドロップダウンリストを持つ条件が、インデックスページの管理パネルに表示されます。</font><font style="vertical-align: inherit;">作成された自動注釈付きクラスでは定数として表されるため、これらは大文字に変換されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成した条件を使ってみましょう。</font><font style="vertical-align: inherit;">他の可能性を示すために少し異なる方法で使用します。</font><font style="vertical-align: inherit;">インデックスページはサイトのメインページであるため、セマンティック上、サイトの背景色は設定から​​正しく変更されます。</font><font style="vertical-align: inherit;">したがって、サイト全体の背景色を変更することが条件なので、コントローラーのレイアウトに挿入します。</font><font style="vertical-align: inherit;">基本的なYii2フレームワークのレイアウトテンプレートファイルを開き、Indexオブジェクトを作成します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/* <span class="hljs-doctag">@var</span> $this \yii\web\View */</span>
<span class="hljs-comment">/* <span class="hljs-doctag">@var</span> $content string */</span><font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">widgets</span>\<span class="hljs-title">Alert</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">helpers</span>\<span class="hljs-title">Html</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">bootstrap</span>\<span class="hljs-title">Nav</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">bootstrap</span>\<span class="hljs-title">NavBar</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">widgets</span>\<span class="hljs-title">Breadcrumbs</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">assets</span>\<span class="hljs-title">AppAsset</span>;<font></font>
<font></font>
AppAsset::register(<span class="hljs-keyword">$this</span>);<font></font>
<font></font>
$pagesIndex = \app\yicms\Pages\Models\Index::getInstance();<font></font>
<font></font>
<span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">$this</span>-&gt;beginPage() <span class="hljs-meta">?&gt;</span><font></font>
&lt;!DOCTYPE html&gt;<font></font>
&lt;html lang=<span class="hljs-string">"&lt;?= Yii::$app-&gt;language ?&gt;"</span>&gt;<font></font>
&lt;head&gt;<font></font>
    &lt;meta charset=<span class="hljs-string">"&lt;?= Yii::$app-&gt;charset ?&gt;"</span>&gt;<font></font>
    &lt;meta http-equiv=<span class="hljs-string">"X-UA-Compatible"</span> content=<span class="hljs-string">"IE=edge"</span>&gt;<font></font>
    &lt;meta name=<span class="hljs-string">"viewport"</span> content=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;
    <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">$this</span>-&gt;registerCsrfMetaTags() <span class="hljs-meta">?&gt;</span>
    &lt;title&gt;<span class="hljs-meta">&lt;?=</span> Html::encode(<span class="hljs-keyword">$this</span>-&gt;title) <span class="hljs-meta">?&gt;</span>&lt;/title&gt;
    <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">$this</span>-&gt;head() <span class="hljs-meta">?&gt;</span><font></font>
&lt;/head&gt;<font></font>
&lt;body&gt;<font></font>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">$this</span>-&gt;beginBody() <span class="hljs-meta">?&gt;</span><font></font>
…<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indexクラスのオブジェクトはシングルトンのようなものなので、静的なgetInstance（）メソッドを好きなだけ呼び出すことができ、作成時に余分な重複データベースクエリやその他のオーバーヘッドを発生させるリスクがありません。</font><font style="vertical-align: inherit;">$ pagesIndexオブジェクトを使用して、インラインスタイルを追加してタグを変更します。</font></font><br>
<br>
<pre><code class="php hljs">&lt;body style=<span class="hljs-string">"background-color: 
&lt;?php if ($pagesIndex-&gt;background-&gt;value() == \app\yicms\Pages\Models\Index\Conditions\Background::TRANSPARENT):?&gt;
    transparent;
&lt;?php elseif ($pagesIndex-&gt;background-&gt;value() == \app\yicms\Pages\Models\Index\Conditions\Background::RED):?&gt;
    #FFD3D3
&lt;?php else: ?&gt;
    #BBFFC8
&lt;?php endif; ?&gt;
"</span>&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ pagesIndex-&gt;​​ background-&gt; value（）を呼び出し、自動注釈付きクラス\ app \ yicms \ Pages \ Models \ Index \ Conditions \ Backgroundで作成された定数と比較することで、サイトの背景色を選択します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、自動注釈付きクラスの機能を検討します。</font><font style="vertical-align: inherit;">yicmsの実行中に、Yiiフレームワークで処理できる多くのイベントが発生します。</font><font style="vertical-align: inherit;">例を挙げます。</font></font><br>
<br>
<pre><code class="php hljs">app\yicms\Pages\Models\Index\Fields\Text</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このファイルは、開発パネルでインデックスページのテキストフィールドを作成したときに、自動アノテーターによって作成されました。</font><font style="vertical-align: inherit;">&lt;？= $ IndexPage-&gt; text？&gt;を記述すると、テンプレートで、この特定のクラスのシングルトンに似たものが作成され、テンプレートでは、マジック__toString（）を使用して文字列にキャストされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテンツを変更するには、イベントをサブスクライブし、コールバック関数を介して処理します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Text</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Field</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;on(<span class="hljs-built_in">self</span>::EVENT_BEFORE_OUTPUT, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$event</span>) </span>{
            <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $event \Iliich246\YicmsCommon\Base\HookEvent */</span><font></font>
<font></font>
        });<font></font>
    }    <font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EVENT_BEFORE_OUTPUTイベントは、フィールドの内容が表示される前に発生します。</font><font style="vertical-align: inherit;">変更してみましょう。</font><font style="vertical-align: inherit;">これを行うには、\ Iliich246 \ YicmsCommon \ Base \ HookEventイベントオブジェクトを使用します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">$this</span>-&gt;on(<span class="hljs-built_in">self</span>::EVENT_BEFORE_OUTPUT, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$event</span>) </span>{
        <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $event \Iliich246\YicmsCommon\Base\HookEvent */</span><font></font>
<font></font>
        $value = $event-&gt;getHook();<font></font>
        $value = strrev($value);<font></font>
<font></font>
        $event-&gt;setHook($value);<font></font>
    });<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HookEventイベントは、イベントが発生する前にフィールド値を受け取ります。</font><font style="vertical-align: inherit;">イベントでは、$ event-&gt; getHook（）を使用してこの値を取得し、変更して、$ event-&gt; setHook（$ value）を使用してイベントを介してオブジェクトに送り返すことができます。</font><font style="vertical-align: inherit;">したがって、イベントでは、[テキスト]フィールドに表示されるテキストを後方に向けました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどすべての自動レンタルクラスには、同様の方法で接続できる多数のイベントがありますが、それらの考慮事項は事実調査の記事の範囲を超えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体として、この記事では、2つのyicmsモジュール、つまりCommonモジュールとPagesモジュールを調べました。</font><font style="vertical-align: inherit;">Commonモジュールには、フィールド、ファイルブロック、画像ブロック、条件などのコンポーネントが含まれています。</font><font style="vertical-align: inherit;">Pagesモジュールは、Commonモジュールのすべての要素を含むページオブジェクトの作成を担当します。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">すべてのyicmsモジュールは、メインのCommonモジュールに依存しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yii2-yicms-essencesモジュール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Essencesモジュールについて理解しましょう。</font><font style="vertical-align: inherit;">このモジュールは、カテゴリ-&gt;エンティティタイプのエンティティを作成するように設計されています。たとえば、製品カテゴリ-&gt;製品、車両タイプ（自動車、オートバイ）-&gt;特定の車両などです。</font><font style="vertical-align: inherit;">モジュール内では、これらの要素はカテゴリと表現と呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、オンラインストアのcategory-&gt; product typeの単純なカタログの作成を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EssencesモジュールのDevセクションで、エッセンスのリストに移動して、新しいエッセンスの作成セクションに移動します。プログラム名はproductsとし、その他の設定はデフォルトのままにしておきます。デフォルトでは、動作を持つエンティティが作成されます。1つのビューは1つのカテゴリに属する​​ことができます。ただし、他の動作を指定することもできます。カテゴリなしでビューを作成するか、1つのビューを複数のカテゴリに含めることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カテゴリ自体は、ツリーのような原則に基づいて構築されています。それら。カテゴリは、ツリータイプのデータ構造の葉です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作成されたエンティティ製品の合計。</font><font style="vertical-align: inherit;">彼女のために、自動注釈付きのクラスがapp \ yicms \ Essences \ Modelsディレクトリに作成されました。</font><font style="vertical-align: inherit;">次に、開発パネルで、クラステンプレートとプレゼンテーションテンプレートを作成する必要があります。</font><font style="vertical-align: inherit;">これらはすべて、インデックスページ用に作成した方法と似ています。</font><font style="vertical-align: inherit;">フィールド、ファイルブロック、画像ブロック、および条件要素は、オンザフライ作成モードで使用できます。</font><font style="vertical-align: inherit;">管理パネルでのテンプレートの作成が完了すると、開発パネルで設定したテンプレート要素を使用してカテゴリとビューを作成できるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そこで、いくつかのカテゴリーの商品を作成します。</font><font style="vertical-align: inherit;">そして、製品のカテゴリーごとにいくつかの製品があります。</font><font style="vertical-align: inherit;">これが完了すると、すべてがメインサイトに表示されます。</font><font style="vertical-align: inherit;">これがどのように行われるかを検討してください。</font><font style="vertical-align: inherit;">SiteControllerで、actionProcutsアクションを作成します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">/**
 *  
 * <span class="hljs-doctag">@return</span> string
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionProducts</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    $productsEssence = Products::getInstance();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;render(<span class="hljs-string">'products'</span>, [
        <span class="hljs-string">'productsEssence'</span> =&gt; $productsEssence<font></font>
    ]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのための製品ビューを作成する </font></font><br>
<br>
<pre><code class="php hljs">
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $this yii\web\View */</span>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $productsEssence \app\yicms\Essences\Models\Products */</span><font></font>
<font></font>
<span class="hljs-meta">?&gt;</span><font></font>
<font></font>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">body</span>-<span class="hljs-title">content</span>"&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">foreach</span>($<span class="hljs-title">productsEssence</span>-&gt;<span class="hljs-title">categories</span> <span class="hljs-title">as</span> $<span class="hljs-title">category</span>): ?&gt;
        &lt;<span class="hljs-title">h1</span>&gt;: &lt;?= $<span class="hljs-title">category</span>-&gt;<span class="hljs-title">name</span> ?&gt;&lt;/<span class="hljs-title">h1</span>&gt;
        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">foreach</span>($<span class="hljs-title">category</span>-&gt;<span class="hljs-title">represents</span> <span class="hljs-title">as</span> $<span class="hljs-title">product</span>): ?&gt;
            &lt;<span class="hljs-title">h2</span>&gt;: &lt;?= $<span class="hljs-title">product</span>-&gt;<span class="hljs-title">name</span> ?&gt;&lt;/<span class="hljs-title">h2</span>&gt;
        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endforeach</span>; ?&gt;
    &lt;?<span class="hljs-title">php</span> <span class="hljs-title">endforeach</span>; ?&gt;
&lt;/<span class="hljs-title">div</span>&gt;

</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動注釈メカニズムのおかげで、$ productsEssence-&gt; categorysメソッドは、自動注釈クラスapp \ yicms \ Essences \ Models \ ProductsCategoryのオブジェクトの配列を返します。このクラスの以前の自動注釈付きクラスと同様に、オンザフライで作成したフィールドに注釈があり、IDEは自動補完を使用できます。また、自動注釈付きクラスは、ユーザーyicmsが独自のビジネスロジックをそれらに配置できるという考えに基づいて開発されたことも注目に値します。あなたはそれらにあなた自身のコードを書くことができ、自動注釈メカニズムは特別にマークされた領域を変更し、ユーザーコードは影響を受けません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ category-&gt; appearメソッドは、カテゴリの場合と同じ自動注釈の利点をすべて備えたapp \ yicms \ Essences \ Models \ ProductsRepresentsオブジェクトの配列も返します。</font><font style="vertical-align: inherit;">もちろん、アイデアを得るためのより柔軟な方法があります。</font><font style="vertical-align: inherit;">たとえば、$ category-&gt; getRepresentsQuery（）は、Yii2フレームワークのActiveQueryオブジェクトを返します。これをさらにカスタマイズして、ページネーションや遅延読み込みの作成に使用されるデータベースクエリを調整できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体として、Essensesモジュールを使用すると、管理パネルが既に機能している状態で、店舗の機能のスケルトンを非常にすばやく作成できます。</font><font style="vertical-align: inherit;">追加のビジネスロジックは、自動注釈付きクラスで記述できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yii2-yicms-feedbackモジュール</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモジュールは、サイトのゲストおよびユーザーによる情報入力フォームのサイトでの構築を目的としています。作業のイデオロギーは変わりません。最初に、開発パネルでフォームに必要なフィールドを入力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、モジュールの操作を考えます。フィードバックモジュールの開発パネルでプログラム名メッセージを含むレコードを作成します。メッセージ設定ページに、フィードバックページテンプレートボタンが表示されます。このリンクを使用して、メッセージページのコンテンツのスタイルを設定するために使用できるタイプフィールド、ファイルブロック、画像ブロック、条件の要素を作成できます。これらは、ページモジュールで検討したものと同じです。今、私たちはフィードバック入力テンプレートのセクションにもっと興味があります。このセクションでは、入力フィールド、入力ファイル、入力画像、入力条件などのエンティティを作成できます。これらのエンティティは、カスタム入力フォームを作成するために必要なものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前と姓の名前を持つ2つの入力フィールドを作成します。</font><font style="vertical-align: inherit;">写真という名前の入力画像。</font><font style="vertical-align: inherit;">合意という条件を入力します。</font><font style="vertical-align: inherit;">ここでは、これらのエンティティのすべての設定をデフォルトのままにしておきます。</font><font style="vertical-align: inherit;">この例の後半では、これらのエンティティにもオンザフライでハングするバリデーターを構成します（バリデーターは、Commonモジュールのエンティティーでも使用でき、フィードバックモジュールと同じロジックに従って動作します。これについては、後で説明します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、モジュールをWebサイトに適用します。</font><font style="vertical-align: inherit;">まず、SiteControllerで新しいアクションを作成します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@return</span> string
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionMessage</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    $messages = \app\yicms\Feedback\Models\Messages::getInstance();<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;render(<span class="hljs-string">'message'</span>, [
        <span class="hljs-string">'messages'</span> =&gt; $messages<font></font>
    ]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、メッセージビューを作成し、次のように記述します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $this yii\web\View */</span>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $message \app\yicms\Feedback\Models\Messages */</span><font></font>
<font></font>
<span class="hljs-meta">?&gt;</span><font></font>
<font></font>
<span class="hljs-meta">&lt;?php</span> $form = \yii\bootstrap\ActiveForm::begin([
    <span class="hljs-string">'id'</span>      =&gt; <span class="hljs-string">'some-form'</span>,
    <span class="hljs-string">'options'</span> =&gt; [
        <span class="hljs-string">'data-pjax'</span> =&gt; <span class="hljs-literal">true</span>,<font></font>
    ],<font></font>
]);<font></font>
<span class="hljs-meta">?&gt;</span>
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">row</span>"&gt;

&lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">col</span>-<span class="hljs-title">xs</span>-12"&gt;
    &lt;?= \<span class="hljs-title">yii</span>\<span class="hljs-title">helpers</span>\<span class="hljs-title">Html</span>::<span class="hljs-title">submitButton</span>('<span class="hljs-title">Save</span>', ['<span class="hljs-title">class</span>' =&gt; '<span class="hljs-title">btn</span> <span class="hljs-title">btn</span>-<span class="hljs-title">success</span>']) ?&gt;
&lt;/<span class="hljs-title">div</span>&gt;
&lt;/<span class="hljs-title">div</span>&gt;
&lt;?<span class="hljs-title">php</span> \<span class="hljs-title">yii</span>\<span class="hljs-title">bootstrap</span>\<span class="hljs-title">ActiveForm</span>::<span class="hljs-title">end</span>(); ?&gt;
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォームを作成するには、フレームワークの標準ツールを使用します。</font><font style="vertical-align: inherit;">フィードバックモジュールを利用するために、次のように記述します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span>  <span class="hljs-keyword">if</span> ($messages-&gt;input_name-&gt;isActive): <span class="hljs-meta">?&gt;</span>
   <span class="hljs-meta">&lt;?=</span> $form-&gt;field($messages-&gt;input_name, $messages-&gt;input_name-&gt;key) <span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>;  <span class="hljs-meta">?&gt;</span><font></font>
<font></font>
<span class="hljs-meta">&lt;?php</span>  <span class="hljs-keyword">if</span> ($messages-&gt;input_surname-&gt;isActive): <span class="hljs-meta">?&gt;</span>
 <span class="hljs-meta">&lt;?=</span> $form-&gt;field($messages-&gt;input_surname, $messages-&gt;input_surname-&gt;key) <span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>;  <span class="hljs-meta">?&gt;</span><font></font>
<font></font>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> ($messages-&gt;input_photo-&gt;isActive): <span class="hljs-meta">?&gt;</span>
 <span class="hljs-meta">&lt;?=</span> $form-&gt;field($messages-&gt;input_photo, $messages-&gt;input_photo-&gt;key)<font></font>
            -&gt;fileInput() <span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>; <span class="hljs-meta">?&gt;</span><font></font>
<font></font>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> ($messages-&gt;input_agreement-&gt;isActive): <span class="hljs-meta">?&gt;</span>
   <span class="hljs-meta">&lt;?=</span> $form-&gt;field($messages-&gt;input_agreement, $messages-&gt;input_agreement-&gt;key)-&gt;checkbox() <span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">endif</span>; <span class="hljs-meta">?&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイプがinputのエンティティの場合は、input_プレフィックスを使用する必要があります。それ以外の場合、自動注釈は、yicmsの他の部分と同じように機能します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初にフィールドアクティビティのチェックがあり、フィールドが非アクティブの場合はレンダリングされません。フィールドがレンダリングされても、フィールドに入力されたデータはサーバーにアップロードされません。フィールドアクティビティは、開発パネルでオン/オフにできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次は、このように記述する必要があるフレームワークの標準形式です</font></font><br>
<br>
<pre><code class="php hljs">$form-&gt;field($messages-&gt;input_name, $messages-&gt;input_name-&gt;key) </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ messages-&gt; input_nameは、クラスapp \ yicms \ Feedback \ Models \ Message \ InputFields \ Nameのオブジェクトを返します。これは、モデルフレームワークYii2の子孫であり、フォームで使用できます。$ messages-&gt; input_name-&gt;キーは、正しいキー値を順番に返しますフォームをロードできるようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、フォームのあるページに移動すると、すべてのフィールドがレンダリングされますが、サーバーへのロードはまだ機能していません。</font><font style="vertical-align: inherit;">とても簡単です。</font><font style="vertical-align: inherit;">私は、フィードバックの作業用インターフェースを、フレームワーク内のモデルの作業用インターフェースにできるだけ似たものにしようとしました。</font><font style="vertical-align: inherit;">はい、小さなアーキテクチャを「犠牲にする」必要がありましたが、一般的には次のようになりました。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">actionMessage</span>(<span class="hljs-params"></span>)
</span>{<font></font>
    $messages = \app\yicms\Feedback\Models\Messages::getInstance();<font></font>
<font></font>
    <span class="hljs-keyword">if</span> ($messages-&gt;load(Yii::$app-&gt;request-&gt;post()) &amp;&amp; $messages-&gt;validate()) {<font></font>
        $messages-&gt;handle();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;render(<span class="hljs-string">'message'</span>, [
        <span class="hljs-string">'messages'</span> =&gt; $messages<font></font>
    ]);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これでフォームが読み込まれ、検証されてサーバーに保存されます。</font><font style="vertical-align: inherit;">管理セクションでは、フォームに入力された情報を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、自動注釈付きクラスを使用できます。</font></font><br>
<br>
<code>\app\yicms\Feedback\Models\Messages</code><br>
<br>
<pre><code class="php hljs">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Messages</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Feedback</span>
</span>{
    <span class="hljs-comment">/**
    * <span class="hljs-doctag">@return</span> self instance .
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInstance</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">self</span>::getByName(<span class="hljs-string">'messages'</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@inheritdoc</span>
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;on(<span class="hljs-built_in">self</span>::EVENT_AFTER_HANDLE, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$event</span>) </span>{<font></font>
<font></font>
            Yii::$app-&gt;mailer-&gt;compose(<span class="hljs-string">'message'</span>, [
                <span class="hljs-string">'message'</span> =&gt; <span class="hljs-keyword">$this</span>
            ])  -&gt;setFrom(<span class="hljs-string">'from@domain.com'</span>)<font></font>
                -&gt;setTo(<span class="hljs-string">'to@domain.com'</span>)<font></font>
                -&gt;setSubject(<span class="hljs-string">'Message subject'</span>)<font></font>
                -&gt;send();<font></font>
        });<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、EVENT_AFTER_HANDLEイベントをサブスクライブしました。イベントは、フォームデータがサーバーに保存された後に発生します。この場合、保存されたフォームデータを挿入できるテンプレートにレターを送信します。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $this \yii\web\View view component instance */</span>
<span class="hljs-comment">/** <span class="hljs-doctag">@var</span> $message \app\yicms\Feedback\Models\Message  */</span><font></font>
<font></font>
<span class="hljs-meta">?&gt;</span><font></font>
<font></font>
&lt;h1&gt;Mail on message&lt;/h1&gt;<font></font>
<font></font>
&lt;h1&gt;Name: <span class="hljs-meta">&lt;?=</span> $message-&gt;input_name-&gt;value <span class="hljs-meta">?&gt;</span>&lt;/h1&gt;<font></font>
<font></font>
&lt;h2&gt;Surname: <span class="hljs-meta">&lt;?=</span> $message-&gt;input_surname-&gt;value <span class="hljs-meta">?&gt;</span>&lt;/h2&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ message-&gt; input_name-&gt; valueは、単にデータベースに格納された現在のデータを返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、バリデーターがどのように機能するかを見てみましょう。名前がnameの入力フィールドエンティティの開発パネルで、必須バリデーターを追加します。これは、標準のyii \バリデータ\ RequiredValidatorフレームワークバリデータです。追加したときは、名前が付いたボタンが白のため、まだアクティブではありません。これをアクティブにするには、このボタンをクリックする必要があります。バリデーター設定ウィンドウが開きます。そこでチェックボックスをインストールして有効化する必要があります。同時に、すべてのシステム言語のエラーメッセージなど、他のすべてのバリデーターパラメータを設定できます。保存すると、バリデーターアイコンが緑色に変わります。これは、アクティブになり、フォームの検証時に適用されることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前合意のあるinput_conditionで、比較バリデーターをハングします。</font><font style="vertical-align: inherit;">1と比較するように設定し、数値と演算子==を入力します。</font><font style="vertical-align: inherit;">さらに、「オファーの条件に同意する必要があります」などのエラーテキストフィールドにメッセージを書き込むことができます。</font><font style="vertical-align: inherit;">フォーム上で、同意のチェックボックスが選択されている場合にのみ検証が行われます。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、yicmsシステムの主な機能をまとめて検討しました。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja454898/index.html">プログラミングはコーディング以上のものです</a></li>
<li><a href="../ja454900/index.html">サイト上のWebフォームを便利で安全なものにする方法：開発ツールとコンストラクター</a></li>
<li><a href="../ja454904/index.html">Samsungが無料のオンラインコンピュータービジョンニューラルネットワークコースを開始</a></li>
<li><a href="../ja454906/index.html">ITにおける追加の教育サイトの評価：マイサークル調査の結果による</a></li>
<li><a href="../ja454912/index.html">ドワーフ要塞タルンアダムスがゲーム開発について語る</a></li>
<li><a href="../ja454916/index.html">同時に実行するアクションを指定する機能を備えたRLアルゴリズムを実装するためのニューラルネットワークアーキテクチャ</a></li>
<li><a href="../ja454918/index.html">SAP上の2つの小売業者の裏を12時間で組み合わせる方法</a></li>
<li><a href="../ja454920/index.html">フロントエンドのパフォーマンス：重要なメトリックの解析</a></li>
<li><a href="../ja454922/index.html">PD法後の外国人の顧客とロシアでの仕事の特徴に関する物語</a></li>
<li><a href="../ja454924/index.html">Veeam Backup for Microsoft Office 365 v3の認証設定</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>