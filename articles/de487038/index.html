<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçú üåµ üßúüèø Pl√∂tzlich reicht ein M√ºllsammelsystem allein nicht mehr aus üë∏ üë®‚Äçüç≥ üåú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hier ist eine kurze Geschichte √ºber mysteri√∂se Serverausf√§lle, die ich vor einem Jahr debuggen musste (Artikel vom 05. Dezember 2018, ca. pro Jahr). D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pl√∂tzlich reicht ein M√ºllsammelsystem allein nicht mehr aus</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487038/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ist eine kurze Geschichte √ºber mysteri√∂se Serverausf√§lle, die ich vor einem Jahr debuggen musste (Artikel vom 05. Dezember 2018, ca. pro Jahr). </font><font style="vertical-align: inherit;">Die Server funktionierten eine Weile einwandfrei und st√ºrzten dann irgendwann ab. </font><font style="vertical-align: inherit;">Danach schlugen Versuche, fast jedes Programm auszuf√ºhren, das sich auf den Servern befand, mit den Fehlern "Es ist kein Speicherplatz auf dem Ger√§t vorhanden" fehl, obwohl das Dateisystem nur wenige belegte Gigabyte auf ~ 20-GB-Festplatten meldete.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass das Problem durch das Protokollierungssystem verursacht wurde. Dies war eine Ruby-Anwendung, die Protokolldateien aufnimmt, Daten an einen Remote-Server sendet und alte Dateien l√∂scht. Der Fehler war, dass ge√∂ffnete Protokolldateien nicht explizit geschlossen wurden. Stattdessen erlaubte die Anwendung Rubys automatischem Garbage Collector, Dateiobjekte zu bereinigen. Das Problem ist, dass Dateiobjekte nicht viel Speicher belegen, sodass ein Protokollierungssystem theoretisch Millionen von Protokollen offen halten k√∂nnte, bevor eine Speicherbereinigung erforderlich ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* Nix-Dateisysteme trennen Dateinamen und Daten in Dateien. Auf Daten auf einer Festplatte k√∂nnen mehrere Dateinamen verweisen (d. H. Feste Links), und Daten werden nur gel√∂scht, wenn der letzte Link gel√∂scht wird. Ein ge√∂ffneter Dateideskriptor wird als Link betrachtet. Wenn die Datei w√§hrend des Lesens des Programms gel√∂scht wird, verschwindet der Dateiname aus dem Verzeichnis, die Datendaten bleiben jedoch aktiv, bis das Programm sie schlie√üt. Dies ist, was mit dem Logger passiert ist. Der Befehl du ("Datentr√§gerverwendung") sucht mithilfe einer Verzeichnisliste nach Dateien, sodass f√ºr die Tausenden von Protokolldateien, die noch ge√∂ffnet waren, keine Gigabyte an Dateidaten angezeigt wurden. Diese Dateien wurden erst nach dem Ausf√ºhren von lsof ("Liste offener Dateien") entdeckt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich tritt ein √§hnlicher Fehler in anderen √§hnlichen F√§llen auf. Vor ein paar Monaten musste ich auf eine Java-Anwendung sto√üen, die nach einigen Tagen aufgrund eines Netzwerkverbindungslecks ausfiel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe den gr√∂√üten Teil meines Codes in C und dann in C ++ geschrieben. Damals dachte ich, dass manuelles Ressourcenmanagement genug ist. Wie kompliziert war das? Jedes malloc () ben√∂tigt eine free () - Funktion und jedes open () braucht close (). Einfach. Abgesehen davon, dass nicht alle Programme einfach sind, ist die manuelle Ressourcenverwaltung im Laufe der Zeit zu einer Zwangsjacke geworden. Dann entdeckte ich eines Tages die Linkz√§hlung und die Speicherbereinigung. Ich dachte, dass es alle meine Probleme l√∂st, und h√∂rte ganz auf, mich um das Ressourcenmanagement zu k√ºmmern. Auch f√ºr einfache Programme war dies normal, aber nicht alle Programme sind einfach.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen sich nicht auf die Speicherbereinigung verlassen, da dies nur das Problem der Speicherverwaltung l√∂st und komplexe Programme viel mehr als nur Speicher verarbeiten m√ºssen. Es gibt ein beliebtes Mem, das dies mit der Tatsache beantwortet, dass der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicher 95% der Ressourcenprobleme ausmacht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sie k√∂nnen sogar sagen, dass alle Ressourcen 0% Ihrer Probleme ausmachen - bis Ihnen eines davon ausgeht. Dann wird diese Ressource zu 100% Ihrer Probleme.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber ein solches Denken nimmt Ressourcen immer noch als Sonderfall wahr. Ein tieferes Problem ist, dass mit zunehmender Komplexit√§t von Programmen alles zu einer Ressource wird. Nehmen Sie zum Beispiel ein Kalenderprogramm. Mit einem ausgekl√ºgelten Kalenderprogramm k√∂nnen mehrere Benutzer mehrere freigegebene Kalender und Ereignisse verwalten, die f√ºr mehrere Kalender freigegeben werden k√∂nnen. Jeder Teil der Daten wirkt sich letztendlich auf mehrere Teile des Programms aus und sollte relevant und korrekt sein. Daher ben√∂tigen Sie f√ºr alle dynamischen Daten einen Eigent√ºmer und nicht nur f√ºr die Speicherverwaltung. Wenn neue Funktionen hinzugef√ºgt werden, m√ºssen immer mehr Teile des Programms aktualisiert werden. Wenn Sie gesund sind, k√∂nnen Sie jeweils nur Daten von einem Teil des Programms aktualisieren.Damit wird das Recht und die Verantwortung zur Aktualisierung von Daten an sich zu einer begrenzten Ressource. Die Modellierung mutierter Daten unter Verwendung unver√§nderlicher Strukturen f√ºhrt nicht zum Verschwinden dieser Probleme, sondern √ºbersetzt sie nur in ein anderes Paradigma.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Planung des Eigentums und der Lebensdauer von Ressourcen ist ein unvermeidlicher Bestandteil des Entwurfs komplexer Software. Dies ist einfacher, wenn Sie einige g√§ngige Muster verwenden. Eines der Muster sind austauschbare Ressourcen. Ein Beispiel ist die unver√§nderliche Zeichenfolge "foo", die semantisch mit jeder anderen unver√§nderlichen "foo" identisch ist. Diese Art von Ressource ben√∂tigt keine vorgegebene Lebensdauer oder Besitz. Um das System so einfach wie m√∂glich zu gestalten, ist es in der Tat besser, keine vorgegebene Lebensdauer oder Eigent√ºmerschaft zu haben (hi Rust, ca. pro). Ein weiteres Muster sind Ressourcen, die nicht austauschbar sind, aber eine bestimmte Lebensdauer haben. Dies umfasst Netzwerkverbindungen sowie abstraktere Konzepte wie das Recht, einen Teil der Daten zu kontrollieren.Am vern√ºnftigsten ist es, die Lebensdauer solcher Dinge beim Codieren explizit sicherzustellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass die automatische Speicherbereinigung f√ºr die Implementierung des ersten Musters sehr gut ist, nicht jedoch f√ºr das zweite, w√§hrend manuelle Ressourcenverwaltungstechniken (wie RAII) f√ºr die Implementierung des zweiten Musters hervorragend geeignet sind, f√ºr das erste jedoch schrecklich. </font><font style="vertical-align: inherit;">Diese beiden Ans√§tze erg√§nzen sich in komplexen Programmen.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de487012/index.html">Sergey Zaichenko: "Wenn Sie nicht wissen, wo Sie die Daten erhalten k√∂nnen, beziehen Sie sie von OSM."</a></li>
<li><a href="../de487014/index.html">Nichts auf dem Spiel: Kompromisse mit Gewissen</a></li>
<li><a href="../de487020/index.html">Ok Google, danke f√ºr das neue Auto</a></li>
<li><a href="../de487028/index.html">Unser Beispiel: Wie man Elektronik recycelt. Fotobericht</a></li>
<li><a href="../de487032/index.html">Der Sucher lie√ü ihn finden</a></li>
<li><a href="../de487040/index.html">Firefox Preview Nightly f√ºr Android unterst√ºtzt uBlock Origin</a></li>
<li><a href="../de487042/index.html">Der 64-Kern Ryzen Threadripper 3990X besiegt alle Intel-Prozessoren in Tests, einschlie√ülich 20.000 US-Dollar Xeon</a></li>
<li><a href="../de487044/index.html">Privatsph√§re? Nein, nicht geh√∂rt</a></li>
<li><a href="../de487046/index.html">So erstellen Sie eine native Bibliothek f√ºr Android</a></li>
<li><a href="../de487052/index.html">Kaboom: ein ungew√∂hnlicher Pionier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>