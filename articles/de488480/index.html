<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçü§ù‚Äçüë®üèº üë©‚Äçüë©‚Äçüëß‚Äçüëß üß¢ Eine intelligente Lampe f√ºr die "Reichen" mit ihren "faulen" H√§nden. Sie ist "einfach" und praktisch üêï üßïüèΩ üë©üèΩ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung
 Er machte eine ‚Äûmoderne‚Äú Beleuchtung in der K√ºche f√ºr ein Waschbecken, einen Herd und einen Schneidetisch auf der Grundlage eines LED-Stre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Eine intelligente Lampe f√ºr die "Reichen" mit ihren "faulen" H√§nden. Sie ist "einfach" und praktisch</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488480/"><img src="https://habrastorage.org/webt/os/hi/gl/oshiglmjknpmabuu6ivivauqzdw.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er machte eine ‚Äûmoderne‚Äú Beleuchtung in der K√ºche f√ºr ein Waschbecken, einen Herd und einen Schneidetisch auf der Grundlage eines LED-Streifens unter der Kontrolle von Arduino (nennen wir es Lampe 1). </font><font style="vertical-align: inherit;">Dieses Design hat 2 Jahre lang funktioniert, bis sich der Leistungsteil des "Gehirns" verschlechtert hat. </font><font style="vertical-align: inherit;">Dies ist eine hervorragende Gelegenheit, das Rad aus dem ‚Äûimprovisierten M√ºll‚Äú wieder neu zu erfinden (Lampe 2). </font><font style="vertical-align: inherit;">Diesmal ist der "M√ºll" zwar teuer und mit dem Z-Wave-Smart-Home kompatibel. </font><font style="vertical-align: inherit;">Das Folgende ist eine Geschichte √ºber das Ersetzen von Arduino durch ZUNo (ein Arduino-kompatibles Modul zum Erstellen eines Z-Wave-Ger√§ts) mit maximaler Codespeicherung und einer Erl√§uterung der erforderlichen √Ñnderungen.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist passiert, bevor ich dort aufgetaucht bin?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war einmal, um Geschirr zu sp√ºlen oder Essen zu kochen, musste die Lampe √ºber dem Waschbecken eingeschaltet werden. </font><font style="vertical-align: inherit;">Es war eine √ºberarbeitete Tischlampe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wollte den kleinen Schalter nicht mit nassen H√§nden dr√ºcken, weil er 220 Volt an die Gl√ºhlampe schaltete. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/yz/dq/tlyzdqgfcsedxxsswsqlekygins.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch das Licht der Lampe fiel haupts√§chlich auf das Waschbecken, aber ich wollte den Kochtisch und den Herd besser beleuchten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziele:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Machen Sie das Ein / Aus-Licht in der K√ºche ber√ºhrungslos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beleuchten Sie das Waschbecken, den Kochtisch und den Herd gleichm√§√üig.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sparen Sie Energie, indem Sie Gl√ºhlampen durch LEDs ersetzen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er baute die Lampe 1 zusammen. Sie bestand aus einer 2 Meter langen Aluminiumbox mit einem Diffusor f√ºr RGB-Band und einer Steuereinheit. Eine Schachtel und ein Diffusor wurden fertig im Laden gekauft, es gab ein Klebeband, und die Steuereinheit war schon lange in der Ecke und wartete in den Fl√ºgeln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Geh√§use war industriell (staubdicht, wasserdicht). Da das Band 12 Volt hat, befindet sich das Netzteil von 220 V bis 12 V in der Einheit. Die galvanische Trennplatine zur Steuerung des Bandes auf Basis von TLP250 (Optokoppler) hat auch all dieses Arduino in kompaktem Design gesteuert.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Ich habe die galvanische Trennung vom alten Projekt erhalten. Einmal machte ich eine Hintergrundbeleuchtung f√ºr eine Minibar in meinem Nachttisch. Beim √ñffnen der T√ºr zeichnete das Touchpad eine Kapazit√§ts√§nderung auf und schaltete sanft schimmerndes Licht ein. Das hei√üt, das Board war f√ºr das aktuelle Projekt gut geeignet. Alles, was √ºbrig blieb, war, alles Unn√∂tige abzuschneiden. Auf der Platine befand sich ein 5-Volt-Linearwandler, der von ZUNo betrieben wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war geplant, die Lampe mit einer Handablage zum Ultraschall-Entfernungsmesser einzuschalten. Er montierte es in den Deckel und alle anderen Teile kamen in die Schachtel. Alles "zuverl√§ssig" mit Schmelzkleber fixiert. Zum Zeitpunkt des Tests habe ich eine Taste in der N√§he gedr√ºckt, um die Steuereinheit √ºber einen Lichtschalter f√ºr die externe Installation mit Strom zu versorgen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/dn/tj/r2dntjzjoijyn-g7vk4vdkg-d5y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Einschalten der Lichter ist bequemer und sicherer geworden. </font><font style="vertical-align: inherit;">Es war verkehrt herum am Boden des K√ºchenschranks angebracht, und es war schwieriger, Wasser aus nassen H√§nden von innen zu bekommen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerungen aus der vorherigen Steuereinheit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beleuchtung des Arbeitsbereichs der K√ºche wurde gleichm√§√üiger und angenehmer. Aufgrund der unnat√ºrlichen Farbwiedergabe meines LED-Streifens √§nderte sich die Farbe einiger Produkte. </font><font style="vertical-align: inherit;">Zum Beispiel: Karotten wirkten aufgrund der helleren Farbe viel appetitlicher. </font><font style="vertical-align: inherit;">Aber es hat nicht viel gest√∂rt und ich hoffe, es hat nicht viel geschadet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim kontaktlosen Ein- und Ausschalten stellte sich heraus, dass alles schlimmer war. </font><font style="vertical-align: inherit;">Es funktionierte. </font><font style="vertical-align: inherit;">Nach 5 Minuten im ausgeschalteten Zustand begannen die Blitze auf dem LED-Streifen. </font><font style="vertical-align: inherit;">Ich fing nicht an, die Schaltung auf Optokopplern zu wiederholen und lie√ü alles so wie es ist. </font><font style="vertical-align: inherit;">Nur zum Ein- und Ausschalten begann der neue Schalter zu benutzen. </font><font style="vertical-align: inherit;">Jeder mochte seine Lage und Form.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úber zwei Jahre lang sammelten sich Fett und andere Verbindungen, die w√§hrend des Kochens abgesondert wurden, am K√∂rper und im Inneren an. </font><font style="vertical-align: inherit;">Diese Plakette drang teilweise durch die L√∂cher f√ºr den Eintritt von Dr√§hten in das Geh√§use ein. </font><font style="vertical-align: inherit;">Aufgrund der gl√§nzenden Oberfl√§che des K√∂rpers kondensiert diese Substanz jedoch zu einer gallertartigen Masse. </font><font style="vertical-align: inherit;">Es f√ºhlt sich angenehm an, geruchlos und ... (ich habe es nicht probiert). </font><font style="vertical-align: inherit;">Ich habe ein paar Fotos von der Stelle in Form eines Drachenkeims gemacht. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/fr/ys/jzfrystsmthfk7fy5j_o70kkcfm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ot/br/mg/otbrmglxan7uooc1a1e4n88z9iq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An den W√§nden verwandelt sich diese Substanz in einen schrecklichen √úberfall, der nicht nur gewaschen wird.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist geworden</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich in Beh√§ltern gest√∂bert hatte, fand ich ein unvollendetes Erweiterungsmodul f√ºr ZUNo. </font><font style="vertical-align: inherit;">ZUNo ist ein Arduino-√§hnliches Board zum Entwerfen eines eigenen Ger√§ts, das mit dem Z-Wave Smart Home kompatibel ist. </font><font style="vertical-align: inherit;">Es ist aus der Umgebung von Arduino programmiert.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herstellerspezifikationen:</font></font></b><div class="spoiler_text"><ul>
<li>28 kB Flash memory for your sketches</li>
<li>2 kB RAM available</li>
<li>Z-Wave RF transmitter at 9.6/40/100 kbps</li>
<li>26 GPIO (overlaps with special hardware controllers)</li>
<li>4 ADC</li>
<li>5 PWM</li>
<li>2 UART</li>
<li>1 USB (serial port)</li>
<li>16 kB EEPROM</li>
<li>1 SPI (master or slave)</li>
<li>4 IR controllers, 1 IR learn capability</li>
<li>1 TRIAC/ZEROX to control dimmer</li>
<li>3 Interrupts</li>
<li>1 Timer 4 MHz</li>
<li>I2C (software)</li>
<li>1-Wire (software)</li>
<li>8x6 Keypad Scanner (software)</li>
<li>2 service LED, 1 service button</li>
<li>1 user test LED</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Erweiterungsmodul macht ZUNo zu einer vollwertigen Debug-Karte, die nach dem Debuggen des Prototyps als komplettes Ger√§t verwendet werden kann. </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Informationen vom Hersteller:</font></font></b><div class="spoiler_text"><ul>
<li>One 0-10 V analog output ‚Äî control industrial dimmers</li>
<li>Up to four PWM or switch outputs (up to 5 A per channel) ‚Äî control contactors, switches, halogen bulbs or LED strips</li>
<li>Up to eight digital 0/3 V inputs or outputs ‚Äî connect various low voltage digital senors and actors</li>
<li>Up to four digital 0/3, 0/5 or 0/12 V digital or analog inputs ‚Äî connect industrial 10 V sensors or any Arduino-compatible sensor</li>
<li>RS485 or UART ‚Äî for industial meters</li>
<li>OneWire ‚Äî for DS18B20 or other sensors</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr mein Projekt ben√∂tige ich 3 leistungsstarke Transistoren zum Umschalten von 12 Volt auf einen LED-Streifen und einen Wandler von 12 Volt auf 5 Volt, um ZUNo mit Strom zu versorgen. </font><font style="vertical-align: inherit;">Der Rest der Peripherie des Erweiterungsmoduls wird nicht gel√∂tet oder getestet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4j/kr/tt/4jkrtt63ocqqrkugav0nrtfvtn8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Teil der Schaltung ist nicht gen√ºgend Diode f√ºr die Stromversorgung, zum Schutz gegen "Polarit√§tsumkehr" vorhanden, und Widerst√§nde an den Gates von Leistungsfeldeffekttransistoren mussten an das Gate und nicht vor den Begrenzungswiderstand angeschlossen werden. </font><font style="vertical-align: inherit;">Ich werde in den Schlussfolgerungen mehr dar√ºber schreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Erweiterungsmodul wird in einem Geh√§use von Gainta geliefert. </font><font style="vertical-align: inherit;">Mein bisheriges Steuerger√§t war ebenfalls im Fall von dieser Firma, jedoch von anderer Gr√∂√üe. </font><font style="vertical-align: inherit;">Leider passten die Befestigungen am Modul nicht zum alten Geh√§use, und ich wollte kein neues bohren, ich lie√ü das alte Geh√§use. </font><font style="vertical-align: inherit;">Die Platte wurde auf Schmelzkleber "gepflanzt".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wm/ls/ah/wmlsahydh07_hxmpqaryl1atchs.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen √ºber das Programmieren von Arduino und ZUNo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Z-Wave-Ger√§te m√ºssen eine bestimmte Anzahl von Klassen haben. Klassen beschreiben Ger√§tefunktionen und Interaktionsschnittstellen. Zum Beispiel steuert meine Lampe einen LED-Streifen, der aus drei Farben besteht (rot, gr√ºn, blau). Diese Funktionen werden von der mehrstufigen Switch-Klasse ausgef√ºhrt. Wenn wir es der Skizze hinzuf√ºgen, k√∂nnen wir die Helligkeit einer der Farben aus der Ferne √§ndern. Um drei Farben zu steuern, m√ºssen Sie drei Instanzen dieser Klasse erstellen. Ich werde nicht n√§her darauf eingehen. Weil die routinem√§√üige Klassenmanipulation f√ºr ZUNo-Benutzer durch den Begriff ‚ÄûKanal‚Äú verborgen ist. Zum Beispiel ben√∂tige ich drei Klassen von Switch-Multilevels, daher sollten im Code 3 Kan√§le von Switch-Multilevels und mehrere R√ºckruffunktionen f√ºr die Funksteuerung erscheinen. Wie macht man das? Sie m√ºssen auch die Switch-Basisklasse hinzuf√ºgen.Ein- und Ausschalten der Lampe auf Knopfdruck (√ºber die Netzwerkcontroller-Schnittstelle) und nicht jedes Mal 3 Kan√§le konfigurieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie m√ºssen zur Entwickler-Website gehen, auf der Beispiele f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_MULTILEVEL aufgef√ºhrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jede von ZUNo unterst√ºtzte Klasse hat eine Beschreibung und ein Beispiel. </font><font style="vertical-align: inherit;">Kopieren Sie anschlie√üend die vorgeschlagenen Funktionen und f√ºgen Sie sie in Ihre Skizze ein. </font><font style="vertical-align: inherit;">In der Skizze gibt es jetzt drei mehrstufige Schaltkan√§le und 6 R√ºckruffunktionen zum Reagieren auf Befehle im Radio. </font><font style="vertical-align: inherit;">Ich bin in Z-Wave-Klassen nicht sehr anspruchsvoll, daher hat mein vorheriges LED-Streifenger√§t mit diesen Klassen gearbeitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kan√§le wurden wie folgt deklariert:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoiler √úberschrift</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(<font></font>
      ZUNO_SWITCH_MULTILEVEL(getRed, setRed),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getGreen, setGreen),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getBlue, setBlue),<font></font>
      ZUNO_SWITCH_BINARY(switch_getter, switch_setter)<font></font>
);</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies f√ºhrte nach dem Hinzuf√ºgen zum Netzwerk zur Generierung der folgenden Widgets im Controller: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/-y/if/to-yif5eaf9xkuxdk4t2oxp6ph4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Farbe anzupassen, musste jede Farbe im Controller-Men√º separat ge√∂ffnet und konfiguriert werden. </font><font style="vertical-align: inherit;">Es ist nicht bequem und langsam. </font><font style="vertical-align: inherit;">Ich hatte jedoch Gl√ºck. </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass ich nicht allein bin. </font><font style="vertical-align: inherit;">Sie haben an uns gedacht und den Kanal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_COLOR erstellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jetzt enth√§lt die Skizze nur noch einen Kanal und zwei R√ºckruffunktionen. </font><font style="vertical-align: inherit;">Im Men√º des Controllers wird die Farbeinstellung f√ºr jede Farbe sowie f√ºr alle gleichzeitig durch Auswahl aus der Palette vorgenommen.</font></font><br>
<br>
<pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und im Controller-Men√º sieht es so aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m3/zn/qk/m3znqkbwue228cttqmqmhggvwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die n√§chste Funktion reagiert auf Anfragen per Funk. </font><font style="vertical-align: inherit;">M√∂glicherweise wird eine Anforderung zum Lesen des Status eines der Farbkan√§le gesendet.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dies ist eine Funktion zum Einstellen von Farben √ºber die Controller-Oberfl√§che.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist der gesamte Code, den Sie hinzuf√ºgen m√ºssen, um aus einer Arduino-Skizze eine Skizze f√ºr ZUNo zu machen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Montage und Installation wurden alle deklarierten Aufgaben abgeschlossen. </font><font style="vertical-align: inherit;">Die Gewohnheit, das Licht mit dem Schalter einzuschalten, blieb jedoch bestehen (es stellte sich als sehr praktisch heraus). </font><font style="vertical-align: inherit;">Die kontaktlose Einschlussoption funktioniert ebenfalls. </font><font style="vertical-align: inherit;">Unter den M√§ngeln m√∂chte ich das Flackern der LED-Lampe f√ºr eine Sekunde nach dem Einschalten der Steuereinheit bemerken. </font><font style="vertical-align: inherit;">Dies ist auf die lange Initialisierung der ZUNo-Peripherieger√§te zur√ºckzuf√ºhren. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt sind die Beine unvorhersehbar. </font><font style="vertical-align: inherit;">Ich denke, der Pull-up-Widerstand am Gate des Transistors wird die Situation korrigieren, wenn Sie ihn hinter den Begrenzungswiderstand setzen. </font><font style="vertical-align: inherit;">Wenn der Initialisierungscode die Beine an den Ausgang anpasst und die Logikpegel gezielt √§ndert, k√∂nnen Sie mit dem RC-Filter experimentieren, der keine kurzen Impulse durchl√§sst. </font><font style="vertical-align: inherit;">Ich habe es noch nicht getan und vielleicht werde ich es nie tun!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ZUNo und sein Erweiterungsmodul vereinfachen die ‚Äûtechnische Kreativit√§t zu Hause‚Äú erheblich. Ich halte diese Produkte jedoch f√ºr sehr teuer. Wenn ich anderswo arbeiten w√ºrde und Z-Wave-Ger√§te nicht herumliegen w√ºrden, w√ºrde ich alles auf ESP8266 tun. W√§hrend der Entwicklung habe ich einen neuen ‚ÄûStandard‚Äú zum Markieren von Dr√§hten aus dem Netzteil gelernt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sx/c4/4h/sxc44hipyu2ml_agdxtaqthtvrs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist nicht nur die Erde mit einem schwarzen Streifen markiert, sondern wie in meinem Fall der ‚Äûpositive‚Äú Draht. F√ºr das Erweiterungsmodul erwies sich dies als wichtig. Der 5-Volt-LM2594-Wandler ist ausgefallen (der Preis f√ºr Chip und Dip betr√§gt ca. 200 Rubel). Ich hoffe, dass es in der n√§chsten Version des Erweiterungsmoduls eine Schutzdiode gegen ‚ÄûPolarit√§tsumkehr‚Äú geben wird. Und ich werde die Polarit√§t der Versorgungskabel √ºberpr√ºfen. Ein weiterer Nachteil ist mit dem K√∂rper verbunden. Das Geh√§use sieht gut aus, aber ich konnte die Dr√§hte ohne Pinzette nicht an die Klemmenbl√∂cke anschlie√üen. Ich hoffe, dass es eine Version mit anderen Klemmenbl√∂cken gibt (zum Anschlie√üen von Dr√§hten von oben oder in einem Winkel). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mag es nicht, Fotos in Cloud-Diensten zu speichern und oft Backups zu machen. Daher sind die meisten Fotos, die mit dem Entwurfsprozess und der Lampe 1 verbunden sind, unwiederbringlich verf√§lscht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/wz/ov/zzwzovgton7f2yxvy-2bd4zhucu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist alles, was vom Assemblierungs- und Debugging-Prozess √ºbrig bleibt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und es sieht so aus, als w√ºrde die Hintergrundbeleuchtung in Betrieb genommen, wenn Sie sich ein wenig biegen. </font><font style="vertical-align: inherit;">Wenn Sie sich gerade richten, sind die Box und der Schalter nicht sichtbar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ya/qj/hn/yaqjhnpkhd7ge2ohejbp9ywkqpq.jpeg"> <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skizze f√ºr ZUNo. </font><font style="vertical-align: inherit;">Ich f√ºge hinzu, nur um zu best√§tigen, dass alles elementar ist</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPROM.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPR.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">int</span> readPin = <span class="hljs-number">9</span>;
<span class="hljs-keyword">int</span> triggerPin = <span class="hljs-number">10</span>;<font></font>
byte controlState = <span class="hljs-number">0</span>;<font></font>
word lastValue;<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REDPIN   PWM1     <span class="hljs-comment">// pin connection R </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREENPIN PWM2     <span class="hljs-comment">// pin connection G</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BLUEPIN  PWM3     <span class="hljs-comment">// pin connection B</span></span><font></font>
<font></font>
ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> OFF 0</span>
<span class="hljs-keyword">uint8_t</span> switch_=OFF;<font></font>
<font></font>
<span class="hljs-keyword">uint8_t</span> pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmB=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmB=<span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-keyword">enum</span><font></font>
{<font></font>
  DEF_R = <span class="hljs-number">255</span>,<font></font>
  DEF_G = <span class="hljs-number">255</span>,<font></font>
  DEF_B = <span class="hljs-number">255</span><font></font>
};<font></font>
<span class="hljs-keyword">uint8_t</span> radio_action = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> 
</span>{ <font></font>
  init_EEPROM();<font></font>
  Serial.begin();<font></font>
  pinMode(readPin, INPUT);<font></font>
  pinMode(triggerPin, OUTPUT);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  pinMode(REDPIN, OUTPUT);<font></font>
  pinMode(GREENPIN, OUTPUT);<font></font>
  pinMode(BLUEPIN, OUTPUT);<font></font>
  analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
  <font></font>
} <font></font>
<span class="hljs-keyword">int</span> act=<span class="hljs-number">1</span>;
<span class="hljs-keyword">int</span> actf = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> cnt=<span class="hljs-number">57</span>; <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> tmp;
  <span class="hljs-comment">// trigger measurement</span><font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, HIGH);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  <span class="hljs-comment">// read pulse width</span>
  tmp = pulseIn(readPin, HIGH, <span class="hljs-number">100000</span>);<font></font>
  lastValue = tmp / <span class="hljs-number">58</span>;<font></font>
  Serial.print(<span class="hljs-string">" cm= "</span>);<font></font>
  Serial.println(lastValue);<font></font>
  <span class="hljs-keyword">if</span> (lastValue &lt; <span class="hljs-number">30</span>)<font></font>
  {<font></font>
    cnt++;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    cnt--;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">55</span>)<font></font>
  { <font></font>
    act=<span class="hljs-number">1</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">60</span>)<font></font>
    cnt= <span class="hljs-number">60</span>;
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">50</span>)<font></font>
  {<font></font>
    act=<span class="hljs-number">0</span>;<font></font>
    actf=<span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">45</span> )<font></font>
    cnt = <span class="hljs-number">45</span>;<font></font>
  <font></font>
  <span class="hljs-keyword">if</span> ((act == <span class="hljs-number">1</span>) &amp;&amp; (actf == <span class="hljs-number">0</span>))<font></font>
  {  <font></font>
    actf = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (switch_ == OFF)<font></font>
    {<font></font>
      switch_=ON;<font></font>
      b_pwmG = pwmG;<font></font>
      b_pwmB = pwmB;<font></font>
      b_pwmR = pwmR;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      switch_=OFF;<font></font>
      b_pwmR=<span class="hljs-number">0</span>;<font></font>
      b_pwmG=<span class="hljs-number">0</span>;<font></font>
      b_pwmB=<span class="hljs-number">0</span>;<font></font>
    }<font></font>
    analogWrite(REDPIN, b_pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, b_pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, b_pwmB &amp; <span class="hljs-number">0xff</span>); <font></font>
  } <font></font>
  <font></font>
  Serial.print(<span class="hljs-string">"cnt = "</span>);    <font></font>
  Serial.print(cnt);  <font></font>
  Serial.print(<span class="hljs-string">" || "</span>);    <font></font>
  Serial.print(pwmR);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);      <font></font>
  Serial.print(pwmG);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.print(pwmB);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.println(<span class="hljs-string">""</span>);
 <span class="hljs-comment">// delay(10);</span><font></font>
<font></font>
 <span class="hljs-keyword">if</span>(radio_action)<font></font>
 {<font></font>
    radio_action = <span class="hljs-number">0</span>;<font></font>
    eepr_save_col();<font></font>
    analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
 }<font></font>
}<font></font>
<font></font>
<span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488468/index.html">Einf√ºhrung in FastAPI</a></li>
<li><a href="../de488470/index.html">Kim Dotcom: Gefangen, die meistgesuchte Person online. Teil 4</a></li>
<li><a href="../de488472/index.html">Wochenendlesung: 10 Materialien zu Audioger√§ten - von sowjetischen Autoradios bis hin zu ger√§uschunterdr√ºckenden Steckern</a></li>
<li><a href="../de488476/index.html">Tesla-Rohrspule</a></li>
<li><a href="../de488478/index.html">√úbertragen Sie alle MS SQL Server-Datenbanken auf einen anderen Computer</a></li>
<li><a href="../de488482/index.html">Wie viel kostet Appium f√ºr die Menschen?</a></li>
<li><a href="../de488484/index.html">SQL-Start - Microsoft SQL Server 2019-Ereignis</a></li>
<li><a href="../de488488/index.html">F√ºr OpenBSD. Ein bisschen Freude</a></li>
<li><a href="../de488490/index.html">Likbez √ºber Atemschutzmasken. Hilft das Beatmungsger√§t bei Virusinfektionen? √úbersicht √ºber 11 Atemschutzmasken</a></li>
<li><a href="../de488498/index.html">ITMO University Laboratories: LED-Beleuchtung, Mikrowellenoptoelektronik und optische Telekommunikation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>