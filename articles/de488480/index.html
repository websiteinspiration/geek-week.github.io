<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🤝‍👨🏼 👩‍👩‍👧‍👧 🧢 Eine intelligente Lampe für die "Reichen" mit ihren "faulen" Händen. Sie ist "einfach" und praktisch 🐕 🧕🏽 👩🏽‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einführung
 Er machte eine „moderne“ Beleuchtung in der Küche für ein Waschbecken, einen Herd und einen Schneidetisch auf der Grundlage eines LED-Stre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Eine intelligente Lampe für die "Reichen" mit ihren "faulen" Händen. Sie ist "einfach" und praktisch</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488480/"><img src="https://habrastorage.org/webt/os/hi/gl/oshiglmjknpmabuu6ivivauqzdw.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einführung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er machte eine „moderne“ Beleuchtung in der Küche für ein Waschbecken, einen Herd und einen Schneidetisch auf der Grundlage eines LED-Streifens unter der Kontrolle von Arduino (nennen wir es Lampe 1). </font><font style="vertical-align: inherit;">Dieses Design hat 2 Jahre lang funktioniert, bis sich der Leistungsteil des "Gehirns" verschlechtert hat. </font><font style="vertical-align: inherit;">Dies ist eine hervorragende Gelegenheit, das Rad aus dem „improvisierten Müll“ wieder neu zu erfinden (Lampe 2). </font><font style="vertical-align: inherit;">Diesmal ist der "Müll" zwar teuer und mit dem Z-Wave-Smart-Home kompatibel. </font><font style="vertical-align: inherit;">Das Folgende ist eine Geschichte über das Ersetzen von Arduino durch ZUNo (ein Arduino-kompatibles Modul zum Erstellen eines Z-Wave-Geräts) mit maximaler Codespeicherung und einer Erläuterung der erforderlichen Änderungen.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist passiert, bevor ich dort aufgetaucht bin?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war einmal, um Geschirr zu spülen oder Essen zu kochen, musste die Lampe über dem Waschbecken eingeschaltet werden. </font><font style="vertical-align: inherit;">Es war eine überarbeitete Tischlampe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wollte den kleinen Schalter nicht mit nassen Händen drücken, weil er 220 Volt an die Glühlampe schaltete. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tl/yz/dq/tlyzdqgfcsedxxsswsqlekygins.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch das Licht der Lampe fiel hauptsächlich auf das Waschbecken, aber ich wollte den Kochtisch und den Herd besser beleuchten. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziele:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Machen Sie das Ein / Aus-Licht in der Küche berührungslos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beleuchten Sie das Waschbecken, den Kochtisch und den Herd gleichmäßig.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sparen Sie Energie, indem Sie Glühlampen durch LEDs ersetzen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er baute die Lampe 1 zusammen. Sie bestand aus einer 2 Meter langen Aluminiumbox mit einem Diffusor für RGB-Band und einer Steuereinheit. Eine Schachtel und ein Diffusor wurden fertig im Laden gekauft, es gab ein Klebeband, und die Steuereinheit war schon lange in der Ecke und wartete in den Flügeln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Gehäuse war industriell (staubdicht, wasserdicht). Da das Band 12 Volt hat, befindet sich das Netzteil von 220 V bis 12 V in der Einheit. Die galvanische Trennplatine zur Steuerung des Bandes auf Basis von TLP250 (Optokoppler) hat auch all dieses Arduino in kompaktem Design gesteuert.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Ich habe die galvanische Trennung vom alten Projekt erhalten. Einmal machte ich eine Hintergrundbeleuchtung für eine Minibar in meinem Nachttisch. Beim Öffnen der Tür zeichnete das Touchpad eine Kapazitätsänderung auf und schaltete sanft schimmerndes Licht ein. Das heißt, das Board war für das aktuelle Projekt gut geeignet. Alles, was übrig blieb, war, alles Unnötige abzuschneiden. Auf der Platine befand sich ein 5-Volt-Linearwandler, der von ZUNo betrieben wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war geplant, die Lampe mit einer Handablage zum Ultraschall-Entfernungsmesser einzuschalten. Er montierte es in den Deckel und alle anderen Teile kamen in die Schachtel. Alles "zuverlässig" mit Schmelzkleber fixiert. Zum Zeitpunkt des Tests habe ich eine Taste in der Nähe gedrückt, um die Steuereinheit über einen Lichtschalter für die externe Installation mit Strom zu versorgen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/dn/tj/r2dntjzjoijyn-g7vk4vdkg-d5y.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Einschalten der Lichter ist bequemer und sicherer geworden. </font><font style="vertical-align: inherit;">Es war verkehrt herum am Boden des Küchenschranks angebracht, und es war schwieriger, Wasser aus nassen Händen von innen zu bekommen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlussfolgerungen aus der vorherigen Steuereinheit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beleuchtung des Arbeitsbereichs der Küche wurde gleichmäßiger und angenehmer. Aufgrund der unnatürlichen Farbwiedergabe meines LED-Streifens änderte sich die Farbe einiger Produkte. </font><font style="vertical-align: inherit;">Zum Beispiel: Karotten wirkten aufgrund der helleren Farbe viel appetitlicher. </font><font style="vertical-align: inherit;">Aber es hat nicht viel gestört und ich hoffe, es hat nicht viel geschadet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim kontaktlosen Ein- und Ausschalten stellte sich heraus, dass alles schlimmer war. </font><font style="vertical-align: inherit;">Es funktionierte. </font><font style="vertical-align: inherit;">Nach 5 Minuten im ausgeschalteten Zustand begannen die Blitze auf dem LED-Streifen. </font><font style="vertical-align: inherit;">Ich fing nicht an, die Schaltung auf Optokopplern zu wiederholen und ließ alles so wie es ist. </font><font style="vertical-align: inherit;">Nur zum Ein- und Ausschalten begann der neue Schalter zu benutzen. </font><font style="vertical-align: inherit;">Jeder mochte seine Lage und Form.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Über zwei Jahre lang sammelten sich Fett und andere Verbindungen, die während des Kochens abgesondert wurden, am Körper und im Inneren an. </font><font style="vertical-align: inherit;">Diese Plakette drang teilweise durch die Löcher für den Eintritt von Drähten in das Gehäuse ein. </font><font style="vertical-align: inherit;">Aufgrund der glänzenden Oberfläche des Körpers kondensiert diese Substanz jedoch zu einer gallertartigen Masse. </font><font style="vertical-align: inherit;">Es fühlt sich angenehm an, geruchlos und ... (ich habe es nicht probiert). </font><font style="vertical-align: inherit;">Ich habe ein paar Fotos von der Stelle in Form eines Drachenkeims gemacht. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/fr/ys/jzfrystsmthfk7fy5j_o70kkcfm.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/ot/br/mg/otbrmglxan7uooc1a1e4n88z9iq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An den Wänden verwandelt sich diese Substanz in einen schrecklichen Überfall, der nicht nur gewaschen wird.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist geworden</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich in Behältern gestöbert hatte, fand ich ein unvollendetes Erweiterungsmodul für ZUNo. </font><font style="vertical-align: inherit;">ZUNo ist ein Arduino-ähnliches Board zum Entwerfen eines eigenen Geräts, das mit dem Z-Wave Smart Home kompatibel ist. </font><font style="vertical-align: inherit;">Es ist aus der Umgebung von Arduino programmiert.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herstellerspezifikationen:</font></font></b><div class="spoiler_text"><ul>
<li>28 kB Flash memory for your sketches</li>
<li>2 kB RAM available</li>
<li>Z-Wave RF transmitter at 9.6/40/100 kbps</li>
<li>26 GPIO (overlaps with special hardware controllers)</li>
<li>4 ADC</li>
<li>5 PWM</li>
<li>2 UART</li>
<li>1 USB (serial port)</li>
<li>16 kB EEPROM</li>
<li>1 SPI (master or slave)</li>
<li>4 IR controllers, 1 IR learn capability</li>
<li>1 TRIAC/ZEROX to control dimmer</li>
<li>3 Interrupts</li>
<li>1 Timer 4 MHz</li>
<li>I2C (software)</li>
<li>1-Wire (software)</li>
<li>8x6 Keypad Scanner (software)</li>
<li>2 service LED, 1 service button</li>
<li>1 user test LED</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Erweiterungsmodul macht ZUNo zu einer vollwertigen Debug-Karte, die nach dem Debuggen des Prototyps als komplettes Gerät verwendet werden kann. </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Informationen vom Hersteller:</font></font></b><div class="spoiler_text"><ul>
<li>One 0-10 V analog output — control industrial dimmers</li>
<li>Up to four PWM or switch outputs (up to 5 A per channel) — control contactors, switches, halogen bulbs or LED strips</li>
<li>Up to eight digital 0/3 V inputs or outputs — connect various low voltage digital senors and actors</li>
<li>Up to four digital 0/3, 0/5 or 0/12 V digital or analog inputs — connect industrial 10 V sensors or any Arduino-compatible sensor</li>
<li>RS485 or UART — for industial meters</li>
<li>OneWire — for DS18B20 or other sensors</li>
</ul><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für mein Projekt benötige ich 3 leistungsstarke Transistoren zum Umschalten von 12 Volt auf einen LED-Streifen und einen Wandler von 12 Volt auf 5 Volt, um ZUNo mit Strom zu versorgen. </font><font style="vertical-align: inherit;">Der Rest der Peripherie des Erweiterungsmoduls wird nicht gelötet oder getestet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4j/kr/tt/4jkrtt63ocqqrkugav0nrtfvtn8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Teil der Schaltung ist nicht genügend Diode für die Stromversorgung, zum Schutz gegen "Polaritätsumkehr" vorhanden, und Widerstände an den Gates von Leistungsfeldeffekttransistoren mussten an das Gate und nicht vor den Begrenzungswiderstand angeschlossen werden. </font><font style="vertical-align: inherit;">Ich werde in den Schlussfolgerungen mehr darüber schreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Erweiterungsmodul wird in einem Gehäuse von Gainta geliefert. </font><font style="vertical-align: inherit;">Mein bisheriges Steuergerät war ebenfalls im Fall von dieser Firma, jedoch von anderer Größe. </font><font style="vertical-align: inherit;">Leider passten die Befestigungen am Modul nicht zum alten Gehäuse, und ich wollte kein neues bohren, ich ließ das alte Gehäuse. </font><font style="vertical-align: inherit;">Die Platte wurde auf Schmelzkleber "gepflanzt".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wm/ls/ah/wmlsahydh07_hxmpqaryl1atchs.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen über das Programmieren von Arduino und ZUNo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Z-Wave-Geräte müssen eine bestimmte Anzahl von Klassen haben. Klassen beschreiben Gerätefunktionen und Interaktionsschnittstellen. Zum Beispiel steuert meine Lampe einen LED-Streifen, der aus drei Farben besteht (rot, grün, blau). Diese Funktionen werden von der mehrstufigen Switch-Klasse ausgeführt. Wenn wir es der Skizze hinzufügen, können wir die Helligkeit einer der Farben aus der Ferne ändern. Um drei Farben zu steuern, müssen Sie drei Instanzen dieser Klasse erstellen. Ich werde nicht näher darauf eingehen. Weil die routinemäßige Klassenmanipulation für ZUNo-Benutzer durch den Begriff „Kanal“ verborgen ist. Zum Beispiel benötige ich drei Klassen von Switch-Multilevels, daher sollten im Code 3 Kanäle von Switch-Multilevels und mehrere Rückruffunktionen für die Funksteuerung erscheinen. Wie macht man das? Sie müssen auch die Switch-Basisklasse hinzufügen.Ein- und Ausschalten der Lampe auf Knopfdruck (über die Netzwerkcontroller-Schnittstelle) und nicht jedes Mal 3 Kanäle konfigurieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen zur Entwickler-Website gehen, auf der Beispiele für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_MULTILEVEL aufgeführt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jede von ZUNo unterstützte Klasse hat eine Beschreibung und ein Beispiel. </font><font style="vertical-align: inherit;">Kopieren Sie anschließend die vorgeschlagenen Funktionen und fügen Sie sie in Ihre Skizze ein. </font><font style="vertical-align: inherit;">In der Skizze gibt es jetzt drei mehrstufige Schaltkanäle und 6 Rückruffunktionen zum Reagieren auf Befehle im Radio. </font><font style="vertical-align: inherit;">Ich bin in Z-Wave-Klassen nicht sehr anspruchsvoll, daher hat mein vorheriges LED-Streifengerät mit diesen Klassen gearbeitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kanäle wurden wie folgt deklariert:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoiler Überschrift</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(<font></font>
      ZUNO_SWITCH_MULTILEVEL(getRed, setRed),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getGreen, setGreen),<font></font>
      ZUNO_SWITCH_MULTILEVEL(getBlue, setBlue),<font></font>
      ZUNO_SWITCH_BINARY(switch_getter, switch_setter)<font></font>
);</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies führte nach dem Hinzufügen zum Netzwerk zur Generierung der folgenden Widgets im Controller: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/to/-y/if/to-yif5eaf9xkuxdk4t2oxp6ph4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Farbe anzupassen, musste jede Farbe im Controller-Menü separat geöffnet und konfiguriert werden. </font><font style="vertical-align: inherit;">Es ist nicht bequem und langsam. </font><font style="vertical-align: inherit;">Ich hatte jedoch Glück. </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass ich nicht allein bin. </font><font style="vertical-align: inherit;">Sie haben an uns gedacht und den Kanal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z-uno.z-wave.me/Reference/ZUNO_SWITCH_COLOR erstellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jetzt enthält die Skizze nur noch einen Kanal und zwei Rückruffunktionen. </font><font style="vertical-align: inherit;">Im Menü des Controllers wird die Farbeinstellung für jede Farbe sowie für alle gleichzeitig durch Auswahl aus der Palette vorgenommen.</font></font><br>
<br>
<pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und im Controller-Menü sieht es so aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m3/zn/qk/m3znqkbwue228cttqmqmhggvwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die nächste Funktion reagiert auf Anfragen per Funk. </font><font style="vertical-align: inherit;">Möglicherweise wird eine Anforderung zum Lesen des Status eines der Farbkanäle gesendet.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dies ist eine Funktion zum Einstellen von Farben über die Controller-Oberfläche.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist der gesamte Code, den Sie hinzufügen müssen, um aus einer Arduino-Skizze eine Skizze für ZUNo zu machen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Montage und Installation wurden alle deklarierten Aufgaben abgeschlossen. </font><font style="vertical-align: inherit;">Die Gewohnheit, das Licht mit dem Schalter einzuschalten, blieb jedoch bestehen (es stellte sich als sehr praktisch heraus). </font><font style="vertical-align: inherit;">Die kontaktlose Einschlussoption funktioniert ebenfalls. </font><font style="vertical-align: inherit;">Unter den Mängeln möchte ich das Flackern der LED-Lampe für eine Sekunde nach dem Einschalten der Steuereinheit bemerken. </font><font style="vertical-align: inherit;">Dies ist auf die lange Initialisierung der ZUNo-Peripheriegeräte zurückzuführen. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt sind die Beine unvorhersehbar. </font><font style="vertical-align: inherit;">Ich denke, der Pull-up-Widerstand am Gate des Transistors wird die Situation korrigieren, wenn Sie ihn hinter den Begrenzungswiderstand setzen. </font><font style="vertical-align: inherit;">Wenn der Initialisierungscode die Beine an den Ausgang anpasst und die Logikpegel gezielt ändert, können Sie mit dem RC-Filter experimentieren, der keine kurzen Impulse durchlässt. </font><font style="vertical-align: inherit;">Ich habe es noch nicht getan und vielleicht werde ich es nie tun!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ZUNo und sein Erweiterungsmodul vereinfachen die „technische Kreativität zu Hause“ erheblich. Ich halte diese Produkte jedoch für sehr teuer. Wenn ich anderswo arbeiten würde und Z-Wave-Geräte nicht herumliegen würden, würde ich alles auf ESP8266 tun. Während der Entwicklung habe ich einen neuen „Standard“ zum Markieren von Drähten aus dem Netzteil gelernt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sx/c4/4h/sxc44hipyu2ml_agdxtaqthtvrs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist nicht nur die Erde mit einem schwarzen Streifen markiert, sondern wie in meinem Fall der „positive“ Draht. Für das Erweiterungsmodul erwies sich dies als wichtig. Der 5-Volt-LM2594-Wandler ist ausgefallen (der Preis für Chip und Dip beträgt ca. 200 Rubel). Ich hoffe, dass es in der nächsten Version des Erweiterungsmoduls eine Schutzdiode gegen „Polaritätsumkehr“ geben wird. Und ich werde die Polarität der Versorgungskabel überprüfen. Ein weiterer Nachteil ist mit dem Körper verbunden. Das Gehäuse sieht gut aus, aber ich konnte die Drähte ohne Pinzette nicht an die Klemmenblöcke anschließen. Ich hoffe, dass es eine Version mit anderen Klemmenblöcken gibt (zum Anschließen von Drähten von oben oder in einem Winkel). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich mag es nicht, Fotos in Cloud-Diensten zu speichern und oft Backups zu machen. Daher sind die meisten Fotos, die mit dem Entwurfsprozess und der Lampe 1 verbunden sind, unwiederbringlich verfälscht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zz/wz/ov/zzwzovgton7f2yxvy-2bd4zhucu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist alles, was vom Assemblierungs- und Debugging-Prozess übrig bleibt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und es sieht so aus, als würde die Hintergrundbeleuchtung in Betrieb genommen, wenn Sie sich ein wenig biegen. </font><font style="vertical-align: inherit;">Wenn Sie sich gerade richten, sind die Box und der Schalter nicht sichtbar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ya/qj/hn/yaqjhnpkhd7ge2ohejbp9ywkqpq.jpeg"> <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skizze für ZUNo. </font><font style="vertical-align: inherit;">Ich füge hinzu, nur um zu bestätigen, dass alles elementar ist</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPROM.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"EEPR.h"</span></span><font></font>
<font></font>
<span class="hljs-keyword">int</span> readPin = <span class="hljs-number">9</span>;
<span class="hljs-keyword">int</span> triggerPin = <span class="hljs-number">10</span>;<font></font>
byte controlState = <span class="hljs-number">0</span>;<font></font>
word lastValue;<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REDPIN   PWM1     <span class="hljs-comment">// pin connection R </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> GREENPIN PWM2     <span class="hljs-comment">// pin connection G</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BLUEPIN  PWM3     <span class="hljs-comment">// pin connection B</span></span><font></font>
<font></font>
ZUNO_SETUP_CHANNELS(ZUNO_SWITCH_COLOR(SWITCH_COLOR_FLAGS_RED|SWITCH_COLOR_FLAGS_GREEN|SWITCH_COLOR_FLAGS_BLUE, getterFunction, setterFunction));<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> OFF 0</span>
<span class="hljs-keyword">uint8_t</span> switch_=OFF;<font></font>
<font></font>
<span class="hljs-keyword">uint8_t</span> pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> pwmB=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmR=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmG=<span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> b_pwmB=<span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-keyword">enum</span><font></font>
{<font></font>
  DEF_R = <span class="hljs-number">255</span>,<font></font>
  DEF_G = <span class="hljs-number">255</span>,<font></font>
  DEF_B = <span class="hljs-number">255</span><font></font>
};<font></font>
<span class="hljs-keyword">uint8_t</span> radio_action = <span class="hljs-number">0</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> 
</span>{ <font></font>
  init_EEPROM();<font></font>
  Serial.begin();<font></font>
  pinMode(readPin, INPUT);<font></font>
  pinMode(triggerPin, OUTPUT);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  pinMode(REDPIN, OUTPUT);<font></font>
  pinMode(GREENPIN, OUTPUT);<font></font>
  pinMode(BLUEPIN, OUTPUT);<font></font>
  analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
  analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
  <font></font>
} <font></font>
<span class="hljs-keyword">int</span> act=<span class="hljs-number">1</span>;
<span class="hljs-keyword">int</span> actf = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> cnt=<span class="hljs-number">57</span>; <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">int</span> tmp;
  <span class="hljs-comment">// trigger measurement</span><font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, HIGH);<font></font>
  delayMicroseconds(<span class="hljs-number">10</span>);<font></font>
  digitalWrite(triggerPin, LOW);<font></font>
  <span class="hljs-comment">// read pulse width</span>
  tmp = pulseIn(readPin, HIGH, <span class="hljs-number">100000</span>);<font></font>
  lastValue = tmp / <span class="hljs-number">58</span>;<font></font>
  Serial.print(<span class="hljs-string">" cm= "</span>);<font></font>
  Serial.println(lastValue);<font></font>
  <span class="hljs-keyword">if</span> (lastValue &lt; <span class="hljs-number">30</span>)<font></font>
  {<font></font>
    cnt++;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    cnt--;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">55</span>)<font></font>
  { <font></font>
    act=<span class="hljs-number">1</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &gt; <span class="hljs-number">60</span>)<font></font>
    cnt= <span class="hljs-number">60</span>;
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">50</span>)<font></font>
  {<font></font>
    act=<span class="hljs-number">0</span>;<font></font>
    actf=<span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (cnt &lt; <span class="hljs-number">45</span> )<font></font>
    cnt = <span class="hljs-number">45</span>;<font></font>
  <font></font>
  <span class="hljs-keyword">if</span> ((act == <span class="hljs-number">1</span>) &amp;&amp; (actf == <span class="hljs-number">0</span>))<font></font>
  {  <font></font>
    actf = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (switch_ == OFF)<font></font>
    {<font></font>
      switch_=ON;<font></font>
      b_pwmG = pwmG;<font></font>
      b_pwmB = pwmB;<font></font>
      b_pwmR = pwmR;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      switch_=OFF;<font></font>
      b_pwmR=<span class="hljs-number">0</span>;<font></font>
      b_pwmG=<span class="hljs-number">0</span>;<font></font>
      b_pwmB=<span class="hljs-number">0</span>;<font></font>
    }<font></font>
    analogWrite(REDPIN, b_pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, b_pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, b_pwmB &amp; <span class="hljs-number">0xff</span>); <font></font>
  } <font></font>
  <font></font>
  Serial.print(<span class="hljs-string">"cnt = "</span>);    <font></font>
  Serial.print(cnt);  <font></font>
  Serial.print(<span class="hljs-string">" || "</span>);    <font></font>
  Serial.print(pwmR);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);      <font></font>
  Serial.print(pwmG);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.print(pwmB);  <font></font>
  Serial.print(<span class="hljs-string">" "</span>);<font></font>
  Serial.println(<span class="hljs-string">""</span>);
 <span class="hljs-comment">// delay(10);</span><font></font>
<font></font>
 <span class="hljs-keyword">if</span>(radio_action)<font></font>
 {<font></font>
    radio_action = <span class="hljs-number">0</span>;<font></font>
    eepr_save_col();<font></font>
    analogWrite(REDPIN, pwmR &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(GREENPIN, pwmG &amp; <span class="hljs-number">0xff</span>);<font></font>
    analogWrite(BLUEPIN, pwmB &amp; <span class="hljs-number">0xff</span>);<font></font>
 }<font></font>
}<font></font>
<font></font>
<span class="hljs-function">BYTE <span class="hljs-title">getterFunction</span><span class="hljs-params">(BYTE component)</span> </span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:
      <span class="hljs-keyword">return</span> pwmR;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:
      <span class="hljs-keyword">return</span> pwmG;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:
      <span class="hljs-keyword">return</span> pwmB;
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setterFunction</span><span class="hljs-params">(BYTE component, BYTE newValue)</span> 
</span>{
  <span class="hljs-keyword">switch</span>(component)<font></font>
  {<font></font>
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_RED:<font></font>
      pwmR = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_GREEN:<font></font>
      pwmG = newValue;<font></font>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> SWITCH_COLOR_COMPONENT_BLUE:<font></font>
      pwmB = newValue;<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
  }<font></font>
  radio_action = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488468/index.html">Einführung in FastAPI</a></li>
<li><a href="../de488470/index.html">Kim Dotcom: Gefangen, die meistgesuchte Person online. Teil 4</a></li>
<li><a href="../de488472/index.html">Wochenendlesung: 10 Materialien zu Audiogeräten - von sowjetischen Autoradios bis hin zu geräuschunterdrückenden Steckern</a></li>
<li><a href="../de488476/index.html">Tesla-Rohrspule</a></li>
<li><a href="../de488478/index.html">Übertragen Sie alle MS SQL Server-Datenbanken auf einen anderen Computer</a></li>
<li><a href="../de488482/index.html">Wie viel kostet Appium für die Menschen?</a></li>
<li><a href="../de488484/index.html">SQL-Start - Microsoft SQL Server 2019-Ereignis</a></li>
<li><a href="../de488488/index.html">Für OpenBSD. Ein bisschen Freude</a></li>
<li><a href="../de488490/index.html">Likbez über Atemschutzmasken. Hilft das Beatmungsgerät bei Virusinfektionen? Übersicht über 11 Atemschutzmasken</a></li>
<li><a href="../de488498/index.html">ITMO University Laboratories: LED-Beleuchtung, Mikrowellenoptoelektronik und optische Telekommunikation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>