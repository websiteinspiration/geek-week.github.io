<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë• ü§≤ üåª Fazendo um teclado MIDI a partir de um sintetizador de crian√ßas velhas ü§πüèø ‚õÑÔ∏è üíÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um dia, voltando para casa, perto da calha de lixo na entrada, vi um sintetizador de brinquedos para crian√ßas velhas. Passei, j√° que era "pecaminoso" ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fazendo um teclado MIDI a partir de um sintetizador de crian√ßas velhas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500450/"><img src="https://habrastorage.org/webt/-g/1_/nu/-g1_nu7zf-kudqjkv5ygvqjysao.jpeg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dia, voltando para casa, perto da calha de lixo na entrada, vi um sintetizador de brinquedos para crian√ßas velhas. Passei, j√° que era "pecaminoso" tirar do lixo, mas no meu cora√ß√£o eu queria arrast√°-la para fora de l√°. J√° tarde da noite, por volta das duas horas, decidi ver se ela ainda estava l√°. E sim, ela ainda estava l√°! Na apar√™ncia, ela era completamente √≠ntegra e limpa, ent√£o n√£o havia melindrosas para n√£o tom√°-la. Ent√£o sim, eu a peguei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° muito tempo que eu queria um piano para mim, n√£o sou m√∫sico profissional, mas apenas para me entregar - por que n√£o? Comprando algo "por mimos" eu fui "estrangulado por um sapo", e aqui - um brinquedo gr√°tis. Quando o tirei do lixo, nem pensei em us√°-lo como um brinquedo de crian√ßa, pensei imediatamente: "Ohhhh ... uma boa base para tentar criar um teclado MIDI".</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como j√° tenho alguma experi√™ncia em comunica√ß√£o com teclados profissionais e teclados MIDI, entendi imediatamente todas as desvantagens da minha ideia. Ou seja, um brinquedo continuar√° sendo um brinquedo. Com base nisso, ser√° imposs√≠vel perceber o poder das teclas. As pr√≥prias teclas de pl√°stico "leves", que tamb√©m s√£o incompletas, n√£o permitir√£o executar algo digno. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, o sintetizador de brinquedos foi desmontado "ao parafuso", todo o pl√°stico foi bem lavado com sab√£o. As placas e os grupos de chaves de contato tamb√©m s√£o limpos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a desmontagem, surgiu um entendimento do porqu√™ as pessoas a jogaram fora. Um brinquedo (n√£o sei por qu√™: de tempos em tempos, da qualidade dos componentes em chin√™s ou opera√ß√£o dif√≠cil) primeiro: os alto-falantes embutidos desmoronavam e, em segundo lugar: um conector quebrado deles preso no conector do fone de ouvido; portanto, praticamente n√£o havia como retir√°-lo . Provavelmente, depois que o brinquedo parou de brincar com os alto-falantes embutidos, eles o usaram com fones de ouvido e, depois que quebraram o conector, simplesmente o jogaram fora.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No interior, o sintetizador de brinquedo consistia em tr√™s placas interconectadas por um la√ßo de cabo. A diretoria central, respons√°vel por gerar som e outras coisas, foi imediatamente desoldada das outras duas diretorias e deixada de lado. Nas outras duas placas, havia contatos para os bot√µes no painel frontal do brinquedo e as pr√≥prias teclas do piano. Soldamos os conectores PBS a eles, principalmente porque a dist√¢ncia do furo nas placas era de apenas 2,54 mm. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bp/mh/qc/bpmhqcxmblsmtoqy7zu7wfbqwm4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/nj/dr/us/njdrusxpjqa57hm8ezczbzidcu0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, passei algumas horas desenhando diagramas dessas placas com chaves. Como se viu, o esquema √© um teclado matricial simples. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/uh/m6/ytuhm6oamte_d4mo60zuvzucqfm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na figura em c√≠rculos amarelos, os n√∫meros s√£o os n√∫meros dos contatos "horizontais" e os n√∫meros nas teclas s√£o os n√∫meros dos contatos "verticais" no conector PBS-13 na placa do teclado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/m6/qc/lk/m6qclkogjo6vprfkk4ywi2qtqzq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/n0/lz/tf/n0lztfhulhpdeytl2ltfl0zxqna.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/bw/w2/pa/bww2pa-cgsmxubbn2ixa2sr373w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, tudo isso foi jogado em um canto e polvilhado por um ano. E ent√£o o per√≠odo de auto-isolamento come√ßou ... Tornou-se chato e eu queria fazer algo com minhas pr√≥prias m√£os, especialmente porque n√£o h√° para onde ir, e √© imposs√≠vel ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No final, decidi tentar terminar este brinquedo pelo menos um pouco. A placa Arduino foi tomada como base para o controlador e, como o n√∫mero de chaveiros √© maior que o n√∫mero de pinos UNO do Arduino, decidi usar os registros de deslocamento 74HC595 e 74HC165. Como resultado, conseguimos esse esquema.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_j/y9/m9/_jy9m906okczf38_zjmeyvy9qbc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O circuito foi originalmente montado em uma t√°bua de p√£o sem solda. Para testar a operacionalidade do circuito (que n√£o h√° erros nas conex√µes em qualquer lugar), foi desenvolvido um programa de teste que mostrava que tudo parecia funcionar. O algoritmo do programa de teste era simples: uma das sa√≠das do chip de sa√≠da shift √© ativada e os valores s√£o lidos em um ciclo a partir do chip de entrada shift, enquanto pressiona as teclas. √Ä primeira vista, nada prenunciava problemas ... e tudo parecia funcionar bem ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bx/uh/an/bxuhanfuxtixrojargnmaeqv5oe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos pr√≥ximos dias, trabalhei lentamente em "li√ß√£o de casa", ou seja, soldando cuidadosamente todos os componentes da placa em uma t√°bua de p√£o. Eu coletei tudo do que estava na minha casa. Ele pegou o Arduino NANO como placa de controle.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2o/h9/f-/2oh9f-a8fplwk8bqnt5dultsxee.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse ‚Äúsandu√≠che‚Äù das pranchas se deve ao fato de as duas pranchas do brinquedo (uma com bot√µes e a segunda com o teclado) estarem localizadas em n√≠veis diferentes e, antes de soldar tudo, pensei: ‚Äú√â poss√≠vel conect√°-lo de alguma forma usando os componentes que tenho em casa para parecerem mais ou menos bons? ‚Äù E assim resultou o design de duas placas interconectadas por conectores. Do meu ponto de vista, para a op√ß√£o de casa, quando nos sentimos em auto-isolamento, tudo saiu muito bem. Tudo o que eu precisava fazer era cortar a t√°bua de p√£o e modificar levemente o corpo do brinquedo para que voc√™ pudesse conectar o cabo USB √† placa do Arduino.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bb/xz/md/bbxzmdv5zabj-jq6hlyg7jhjpxy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A constata√ß√£o de que o dispositivo n√£o funciona exatamente como eu queria veio quando finalizei o programa de teste. O algoritmo era simples: ligue cada sa√≠da do chip 74HC595, levando em considera√ß√£o o estado das entradas do chip 74HC165 e escreva o resultado em vari√°veis ‚Äã‚Äãseparadas. No total, 5 sa√≠das do 74HC595 est√£o conectadas ao teclado, ent√£o, no final, recebi 40 bits (5 * 8) de dados ap√≥s esta pesquisa. Uma sequ√™ncia de 40 bits foi enviada ao console e as teclas foram pressionadas para ver como o dispositivo lida com pressionamentos simult√¢neos de v√°rias teclas.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d0/ra/o7/d0rao77gsxvrvtbeumy1ufguxsw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foi aqui que surgiu o problema: se voc√™ pressionar uma tecla, tudo estava bem, mas quando voc√™ tenta pressionar mais de duas teclas ao mesmo tempo, surgiu uma situa√ß√£o em que era imposs√≠vel prever o que seria lido. O resultado pode estar correto com uma combina√ß√£o e, com outra, pode ser completamente imprevis√≠vel. O problema era que o recurso desse esquema n√£o foi levado em considera√ß√£o. Quando v√°rias teclas s√£o pressionadas ao mesmo tempo, n√£o apenas v√°rias verticais da varredura do teclado s√£o bloqueadas (isso √© aceit√°vel), mas v√°rias linhas horizontais podem ser fechadas atrav√©s das teclas (o que n√£o √© de forma alguma aceit√°vel). Voc√™ pode ler mais sobre este problema e como resolv√™-lo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eu escolhi a ‚Äúsolu√ß√£o principal‚Äù do problema, a saber: decidi que para cada tecla do teclado haver√° um diodo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na minha cabe√ßa, eu j√° comecei a pensar mentalmente como teria que cortar os trilhos no quadro e colocar o diodo no gabinete SMD na brecha. Entrei em minhas salas de armazenamento e vi que simplesmente n√£o tinha tantos diodos no caso SMD (n√£o se esque√ßa de que todos n√≥s sentamos no auto-isolamento e ir √† loja para componentes de r√°dio n√£o √© muito poss√≠vel - j√° que esses definitivamente n√£o s√£o bens essenciais). Um pouco chateado, decidi olhar mais de perto para o quadro: pode ser poss√≠vel colocar diodos de sa√≠da em algumas das faixas (eu tamb√©m tinha algumas). E ent√£o vi que cada tecla possui um jumper (a placa √© unilateral) e o circuito √© feito para que, em vez desse jumper, voc√™ possa colocar um diodo. Imediatamente pensei: voc√™ nem precisa cortar nada, basta colocar diodos de sa√≠da em vez de jumpers em todos os lugares.Eu tamb√©m n√£o tinha esse n√∫mero de diodos de sa√≠da. Um pensamento passou pela minha cabe√ßa: "talvez LEDs?" O circuito opera em + 5V e, se voc√™ colocar LEDs vermelhos com queda de tens√£o m√≠nima (entre os LEDs), no final deve haver um n√≠vel l√≥gico para a determina√ß√£o correta: a tecla est√° pressionada ou n√£o.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ff/1c/37/ff1c37wrrsclbwl0d7edw1x-ork.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com isso em mente, subi novamente em minhas a√ß√µes e peguei os LEDs vermelhos de onde quer que fosse poss√≠vel. Havia exatamente quantas teclas no teclado! Isso √© um sinal, pensei, e soldou v√°rios LEDs em vez de jumpers para teste. Os resultados dos testes mostraram que a solu√ß√£o est√° funcionando. Depois disso, soldados os LEDs restantes em vez dos jumpers. O programa de teste mostrou que voc√™ pode pressionar pelo menos todas as teclas ao mesmo tempo, e todas s√£o lidas corretamente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g8/i0/-b/g8i0-b1rwc2ykc3oq1hcecu-ohs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidi n√£o colocar diodos nos bot√µes adicionais que est√£o no brinquedo, porque √© improv√°vel que eles sejam pressionados por v√°rias pe√ßas ao mesmo tempo. Al√©m disso, no programa ainda n√£o tenho processamento para clicar nesses bot√µes. Ainda n√£o decidi como us√°-los.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chegou a hora de descobrir como fazer com que este dispositivo apare√ßa no seu computador como um teclado MIDI e em que formato voc√™ precisa enviar dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As informa√ß√µes encontradas na Internet me disseram que √© poss√≠vel criar um teclado MIDI a partir do Arduino com muita facilidade e simplicidade, despejando firmware nele, o que far√° o computador v√™-lo n√£o como uma porta COM, mas como um teclado MIDI. Inicialmente, fui </font><font style="vertical-align: inherit;">guiado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por esta decis√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , n√£o particularmente entrando em como ela √© implementada.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, quando cheguei a ele e o li com aten√ß√£o, percebi que minha placa Nano do Arduino n√£o seria adequada para esta solu√ß√£o, pois possu√≠a uma porta COM baseada no chip CH340. </font><font style="vertical-align: inherit;">Para usar o firmware no link acima, apenas as placas que j√° possuem uma porta USB no controlador (por exemplo: AtMega32u4) s√£o adequadas ou a comunica√ß√£o via porta COM n√£o √© feita em chips de convers√£o do tipo FT232RL ou similares, mas nos microcontroladores AtMega. </font><font style="vertical-align: inherit;">Portanto, o firmware na placa deve enviar os dados no formato MIDI para a porta COM e no computador voc√™ precisar√° instalar e configurar o software que interceptar√° esses dados e os transmitir√° para a porta virtual MIDI. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O algoritmo para ler chaves e gerar comandos MIDI foi o seguinte:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jj/-2/d6/jj-2d67yncypthxguaeyvotcvue.jpeg"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O programa para o controlador NANO do Arduino agora se parece com isso.</font></font></b>
                        <div class="spoiler_text"><pre><code class="plaintext hljs">//    +5V<font></font>
//   ST_CP  74HC595<font></font>
#define latchPin      11<font></font>
//   SH_CP  74HC595<font></font>
#define clockPin      13<font></font>
//   DS  74HC595<font></font>
#define dataPin       12<font></font>
<font></font>
//     +5V<font></font>
#define latchPin_IN   9<font></font>
#define clockPin_IN   10<font></font>
#define dataPin_IN    8<font></font>
<font></font>
// ,       1-16    <font></font>
#define BUT_OUT0      7<font></font>
#define BUT_OUT1      6<font></font>
#define BUT_OUT2      5<font></font>
#define BUT_OUT3      4<font></font>
<font></font>
byte but_out[4] = {BUT_OUT0, BUT_OUT1, BUT_OUT2, BUT_OUT3};<font></font>
//       <font></font>
byte kbd_in[5] = {0, 0, 0, 0, 0};<font></font>
byte kbd_in_new[5] = {0, 0, 0, 0, 0};<font></font>
<font></font>
//       <font></font>
byte btn_in[4] = {0, 0, 0, 0};<font></font>
byte btn_in_new[4] = {0, 0, 0, 0};<font></font>
<font></font>
//  3  -   (1 - , 0 - )<font></font>
byte kbd_out = 0b11100000;<font></font>
<font></font>
//  <font></font>
void init_electronics() {<font></font>
  //  ,   +5V<font></font>
  //  OUTPUT<font></font>
  pinMode(latchPin, OUTPUT);<font></font>
  pinMode(clockPin, OUTPUT);<font></font>
  pinMode(dataPin, OUTPUT);<font></font>
<font></font>
  //  ,   +5V<font></font>
  pinMode(latchPin_IN, OUTPUT);<font></font>
  pinMode(clockPin_IN, OUTPUT);<font></font>
  pinMode(dataPin_IN, INPUT);<font></font>
<font></font>
  //          <font></font>
  for (byte i = 0; i &lt; 4; i++) pinMode(but_out[i], OUTPUT);<font></font>
}<font></font>
<font></font>
//      74HC595<font></font>
void write_5V(byte a) {<font></font>
    digitalWrite(latchPin, LOW);<font></font>
    //    dataPin<font></font>
    shiftOut(dataPin, clockPin, MSBFIRST, a); <font></font>
     //"" ,      <font></font>
    digitalWrite(latchPin, HIGH); <font></font>
}<font></font>
<font></font>
void read_5V(byte *btn, byte *kbd) {<font></font>
  digitalWrite(clockPin_IN, HIGH);<font></font>
  digitalWrite(latchPin_IN, LOW);<font></font>
  digitalWrite(latchPin_IN, HIGH);<font></font>
  <font></font>
  //    -    <font></font>
  *btn = shiftIn(dataPin_IN, clockPin_IN, LSBFIRST);<font></font>
  <font></font>
  //    -    <font></font>
  *kbd = shiftIn(dataPin_IN, clockPin_IN, LSBFIRST);<font></font>
}<font></font>
<font></font>
void setup() {<font></font>
  init_electronics();<font></font>
  write_5V(kbd_out);<font></font>
  Serial.begin(115200);<font></font>
}<font></font>
<font></font>
//       ,   <font></font>
void read_kbd_and_btn_state(byte *btn, byte *kbd) {<font></font>
 byte tmp;<font></font>
  for (byte i = 0; i &lt; 5; i++) {<font></font>
    write_5V(kbd_out | (1 &lt;&lt; i));<font></font>
    read_5V(&amp;tmp, &amp;kbd[i]);<font></font>
  }<font></font>
}<font></font>
<font></font>
void noteOn(int cmd, int pitch, int velocity) {<font></font>
  Serial.write(cmd);<font></font>
  Serial.write(pitch);<font></font>
  Serial.write(velocity);<font></font>
}<font></font>
<font></font>
//     num  ,   <font></font>
// 0 -  0,  0<font></font>
// 1 -  0,  1<font></font>
// 2 -  1,  1<font></font>
// 3 -  1,  0<font></font>
byte compare_bit(byte old_state, byte new_state, byte num) {<font></font>
  byte tmp_old, tmp_new;<font></font>
  tmp_old = (old_state &gt;&gt; num) &amp; 1;<font></font>
  tmp_new = (new_state &gt;&gt; num) &amp; 1;<font></font>
  if ((tmp_old == 0) &amp;&amp; (tmp_new == 0)) return 0;<font></font>
  if ((tmp_old == 0) &amp;&amp; (tmp_new == 1)) return 1;<font></font>
  if ((tmp_old == 1) &amp;&amp; (tmp_new == 1)) return 2; <font></font>
  if ((tmp_old == 1) &amp;&amp; (tmp_new == 0)) return 3;  <font></font>
}<font></font>
<font></font>
void loop() {<font></font>
  read_kbd_and_btn_state(btn_in_new, kbd_in_new);<font></font>
  for (byte i = 0; i &lt; 5; i++) {<font></font>
    for (byte j = 0; j &lt; 8; j++) {<font></font>
      switch (compare_bit(kbd_in[i], kbd_in_new[i], 7 - j)) {<font></font>
        //  <font></font>
        case 1: noteOn(0x90, 0x1D + (8 * i + j), 0x7F);<font></font>
                break;<font></font>
        //  <font></font>
        case 2: //noteOn(0x00, 0x1D + (8 * i + j), 0x7F);<font></font>
                break;<font></font>
        //  <font></font>
        case 3: noteOn(0x90, 0x1D + (8 * i + j), 0x00);<font></font>
                break;<font></font>
      }<font></font>
    }<font></font>
    kbd_in[i] = kbd_in_new[i];<font></font>
  }<font></font>
} <font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o faz sentido pintar em detalhes como trabalhar com dados MIDI, porque eles podem ser lidos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vou abordar mais detalhadamente o software do computador e os problemas que encontrei. Surgiram problemas, simplesmente devido √† falta de documenta√ß√£o normal para este software. Portanto, para que o computador possa receber com √™xito dados MIDI de um dispositivo como o meu, voc√™ precisar√° de dois programas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loopMIDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serial-Midi Converter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para o Serial-MIDI Converter, voc√™ tamb√©m precisa instalar o Java, se n√£o estiver instalado no computador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iniciamos o programa loopMIDI e criamos duas portas virtuais. Eu os chamei de Arduino IN e Arduino OUT. Este programa ser√° um dispositivo MIDI virtual.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/e8/do/hee8doojjloz3jiocd58qpugocg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, execute o Serial-MIDI Converter e, na inicializa√ß√£o, passamos pelo processo de configura√ß√£o. Infelizmente, voc√™ precisa fazer isso toda vez que o inicia, mas n√£o √© muito assustador, √© feito literalmente com quatro pressionamentos de tecla no teclado. O n√∫mero da porta COM pode ser diferente; aparece no computador quando a placa Nano do Arduino est√° conectada. A velocidade da porta √© definida no firmware do Arduino NANO. As setas vermelhas indicam minhas configura√ß√µes, nas quais tudo funcionou para mim. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zu/qj/l0/zuqjl0ruk96yomobfupdvbstgps.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, o processo de instala√ß√£o foi conclu√≠do e voc√™ j√° pode usar algum software que reproduza sons aceitando as teclas do dispositivo. Nas configura√ß√µes do software, voc√™ deve selecionar "Arduino_OUT" como entrada. Na figura abaixo, um exemplo de configura√ß√£o do Kontakt Player. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qs/eu/uu/qseuuugs_lbaywuoplve0qgc2wg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em √∫ltima an√°lise, funciona assim:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/cOnQOAYKlg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qual √© o pr√≥ximo? </font><font style="vertical-align: inherit;">E ent√£o tudo aconteceu exatamente como eu esperava - o brinquedo continua sendo um brinquedo com exatamente todas as defici√™ncias que mencionei no in√≠cio. </font><font style="vertical-align: inherit;">Provavelmente, a crian√ßa tocar√° este em um momento, mas para um adulto, depois de instrumentos de teclado normais ... √â mais f√°cil comprar qualquer teclado MIDI usado mais barato e ser√° muito melhor que este brinquedo. </font><font style="vertical-align: inherit;">Decidi deixar esse brinquedo como est√°, mas fa√ßa algumas modifica√ß√µes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deixe o estojo original.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coloque os alto-falantes em funcionamento e fa√ßa um amplificador para eles.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fa√ßa com que ele funcione no modo ‚Äúbrinquedo infantil‚Äù sem conectar a um computador, ou seja, para que ele possa reproduzir os sons.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Torne poss√≠vel conectar o FootSwitch (o mesmo pedal no piano abaixo) para que voc√™ possa segurar o som depois de soltar as teclas, como em um instrumento normal.</font></font></li>
<li>    ,       .</li>
<li>    ,      -,      .</li>
</ol><br>
<img src="https://habrastorage.org/webt/qa/79/bk/qa79bkjnapd9sf84teo-y_nxn0g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o posso implementar a maioria dos pontos, enquanto todos estamos juntos "em casa", j√° que n√£o tenho todos os componentes necess√°rios para isso em casa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para implementar o par√°grafo 3 na Internet, foi encontrada uma solu√ß√£o chamada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SamplerBox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A ess√™ncia do projeto √© que voc√™ pode conectar qualquer teclado MIDI √† placa Raspberry Pi, que processa comandos MIDI do teclado e reproduz sons ou alterna instrumentos, etc. Resta apenas colocar a placa Raspberry Pi dentro do corpo do brinquedo, sem a possibilidade de substituir o cart√£o SD (sem desmontar o estojo), configurar os bot√µes no corpo do brinquedo para que eles troquem de ferramenta e isso ser√° suficiente para deixar este projeto neste formul√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas tudo isso acontecer√° ap√≥s o t√©rmino do per√≠odo de auto-isolamento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que algu√©m ache minha experi√™ncia √∫til.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt500436/index.html">Vinda de redes neurais bin√°rias baseadas em neur√¥nios aleat√≥rios e fun√ß√µes l√≥gicas</a></li>
<li><a href="../pt500438/index.html">SFTP e FTPS</a></li>
<li><a href="../pt500444/index.html">9 habilidades de programa√ß√£o em Python que distinguem um iniciante de um experiente</a></li>
<li><a href="../pt500446/index.html">Algumas palavras sobre R2DBC e PostgreSQL</a></li>
<li><a href="../pt500448/index.html">Prometheus: monitoramento HTTP atrav√©s do exportador do Blackbox</a></li>
<li><a href="../pt500452/index.html">Alto racioc√≠nio na aprendizagem profunda</a></li>
<li><a href="../pt500454/index.html">"Quais marinas?" ou controlamos o controlador via bluetooth usando um aplicativo m√≥vel no Xamarin (Android)</a></li>
<li><a href="../pt500456/index.html">BpfTrace - finalmente, um substituto completo para o Dtrace no Linux</a></li>
<li><a href="../pt500458/index.html">Recursos t√©cnicos do discurso on-line: Starter Pack</a></li>
<li><a href="../pt500462/index.html">Detectando altera√ß√µes de cena e salvando clipes de v√≠deo h264 no Raspberry Pi sem decodificar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>