<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌔 🔩 🧖🏿 映画の選択に役立つニューラルネットワーク-「あなたの好みは特定」 🔮 🙄 ♟️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは！
 
 あなたは映画を見て、あなたの頭の中に一つだけの質問があります-「私はもう一度クリックベイトに巻き込まれましたか？」私たちはこの問題を解決し、適切な映画だけを見ます。データを少し実験して、映画を評価するための簡単なニューラルネットワークを作成することをお勧めします。
 
 私たちの...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>映画の選択に役立つニューラルネットワーク-「あなたの好みは特定」</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477630/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたは映画を見て、あなたの頭の中に一つだけの質問があります-「私はもう一度クリックベイトに巻き込まれましたか？」私たちはこの問題を解決し、適切な映画だけを見ます。データを少し実験して、映画を評価するための簡単なニューラルネットワークを作成することをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの実験は、商品に対する視聴者の気分を判断する感情分析技術に基づいています。データとして、IMDbフィルムのユーザーレビューのデータセットを取得します。 Google Colab開発環境では、GPU（NVidia Tesla K80）に無料でアクセスできるため、ニューラルネットワークをすばやくトレーニングできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はKerasライブラリーを使用しています。これを使用して、類似の機械学習の問題を解決するためのユニバーサルモデルを構築します。 Colab 1.15.0のデフォルトバージョンであるバックエンドTensorFlowが必要なので、2.0.0にアップグレードします。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> absolute_import, division, print_function, unicode_literals
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
!tf_upgrade_v2 -h</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、データの前処理とモデル構築に必要なすべてのモジュールをインポートします。</font><font style="vertical-align: inherit;">以前の記事では、ライブラリに重点が置かれているので、そこを見ることができます。</font></font><br>
<a name="habracut"></a><br>
<pre><code class="python hljs">%matplotlib inline
<span class="hljs-keyword">import</span> matplotlib
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt</code></pre><br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> models
<span class="hljs-keyword">from</span> keras <span class="hljs-keyword">import</span> layers
<span class="hljs-keyword">from</span> keras.datasets <span class="hljs-keyword">import</span> imdb</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IMDbデータの解析 </font></font></h2><br>
<img src="https://habrastorage.org/webt/4m/gg/mj/4mggmjh34w_zrwpseprbnv8gpwy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IMDbデータセットは、ポジティブ（1）およびネガティブ（0）とマークされたユーザーからの50,000の映画レビューで構成されています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レビューは前処理されており、各レビューは整数形式の一連の単語インデックスによってエンコードされています</font></font></li>
</ul><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レビュー内の単語は、データセット内での総頻度によって索引付けされます。</font><font style="vertical-align: inherit;">たとえば、整数「2」は2番目に頻繁に使用される単語をエンコードします</font></font></li>
</ul><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50,000件のレビューは2つのセットに分かれています。トレーニング用に25,000、テスト用に25,000です。</font></font></li>
</ul> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerasに組み込まれているデータセットをダウンロードします。</font><font style="vertical-align: inherit;">データは50〜50の比率でトレーニングとテストに分割されているので、後で80〜20で除算できるようにそれらを結合します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> keras.datasets <span class="hljs-keyword">import</span> imdb<font></font>
(training_data, training_targets), (testing_data, testing_targets) = imdb.load_data(num_words=<span class="hljs-number">10000</span>)<font></font>
data = np.concatenate((training_data, testing_data), axis=<span class="hljs-number">0</span>)<font></font>
targets = np.concatenate((training_targets, testing_targets), axis=<span class="hljs-number">0</span>)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ探索</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何に取り組んでいるのか見てみましょう。</font></font><br>
<br>
<pre><code class="python hljs">print(<span class="hljs-string">"Categories:"</span>, np.unique(targets))<font></font>
print(<span class="hljs-string">"Number of unique words:"</span>, len(np.unique(np.hstack(data))))</code></pre><br>
<img src="https://habrastorage.org/webt/i4/iv/gq/i4ivgqp7pzmudiozqn5ollfffcu.png"><br>
<br>
<pre><code class="python hljs">length = [len(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data]<font></font>
print(<span class="hljs-string">"Average Review length:"</span>, np.mean(length))<font></font>
print(<span class="hljs-string">"Standard Deviation:"</span>, round(np.std(length)))</code></pre><br>
<img src="https://habrastorage.org/webt/_l/3z/td/_l3ztdm6ma6lanax8rzewdm_nk4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのデータが2つのカテゴリに分類されていることがわかります。0または1は、レビューのムードを表します。</font><font style="vertical-align: inherit;">データセット全体には9998の一意の単語が含まれ、平均レビューサイズは234ワードで、標準偏差は173です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このデータセットからの最初のレビューを見てみましょう。</font></font><br>
<br>
<pre><code class="python hljs">print(<span class="hljs-string">"Label:"</span>, targets[<span class="hljs-number">0</span>])<font></font>
print(data[<span class="hljs-number">0</span>])</code></pre><br>
<img src="https://habrastorage.org/webt/c0/fg/et/c0fgeth2sdc9d0ycekevqesuqwy.png"><br>
<br>
<pre><code class="python hljs">index = imdb.get_word_index()<font></font>
reverse_index = dict([(value, key) <span class="hljs-keyword">for</span> (key, value) <span class="hljs-keyword">in</span> index.items()]) <font></font>
decoded = <span class="hljs-string">" "</span>.join( [reverse_index.get(i - <span class="hljs-number">3</span>, <span class="hljs-string">"#"</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data[<span class="hljs-number">0</span>]] )<font></font>
print(decoded)</code></pre><br>
<img src="https://habrastorage.org/webt/gl/mj/kd/glmjkdqcbp0mha-udlo2g_qgni4.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データの準備</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データを準備する時が来ました。</font><font style="vertical-align: inherit;">各調査をベクトル化してゼロで埋め、ベクトルに正確に10,000個の数値が含まれるようにする必要があります。</font><font style="vertical-align: inherit;">つまり、10,000語より短いレビューはすべてゼロで埋められます。</font><font style="vertical-align: inherit;">最大の概観はほぼ同じサイズであり、ニューラルネットワークの各入力要素は同じサイズでなければならないため、これを行います。</font><font style="vertical-align: inherit;">変数をfloat型に変換する必要もあります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">vectorize</span>(<span class="hljs-params">sequences, dimension = <span class="hljs-number">10000</span></span>):</span><font></font>
 results = np.zeros((len(sequences), dimension))<font></font>
 <span class="hljs-keyword">for</span> i, sequence <span class="hljs-keyword">in</span> enumerate(sequences):<font></font>
  results[i, sequence] = <span class="hljs-number">1</span>
 <span class="hljs-keyword">return</span> results<font></font>
 <font></font>
data = vectorize(data)<font></font>
targets = np.array(targets).astype(<span class="hljs-string">"float32"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、同意したように、データセットをトレーニングデータとテストデータに分割します。4。1。</font></font><br>
<br>
<pre><code class="python hljs">test_x = data[:<span class="hljs-number">10000</span>]<font></font>
test_y = targets[:<span class="hljs-number">10000</span>]<font></font>
train_x = data[<span class="hljs-number">10000</span>:]<font></font>
train_y = targets[<span class="hljs-number">10000</span>:]</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルを作成してトレーニングする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小さなことですが、モデルを作成してトレーニングするだけです。</font><font style="vertical-align: inherit;">タイプを選択することから始めます。</font><font style="vertical-align: inherit;">Kerasでは2種類のモデルを利用できます：シーケンシャルと関数型APIです。</font><font style="vertical-align: inherit;">次に、入力レイヤー、非表示レイヤー、出力レイヤーを追加する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーバーフィッティングを防ぐために、それらの間の「ドロップアウト」を使用します。各レイヤーでは、「密」機能を使用して、レイヤーを相互に完全に接続します。</font><font style="vertical-align: inherit;">隠れ層では、「relu」アクティベーション機能を使用します。これにより、ほとんどの場合、満足のいく結果が得られます。</font><font style="vertical-align: inherit;">出力層では、0から1の範囲の値を再正規化するシグモイド関数を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アダムオプティマイザーを使用</font><font style="vertical-align: inherit;">しています</font><font style="vertical-align: inherit;">。トレーニング中に重みが変更されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
損失関数としてバイナリクロスエントロピーを使用し、測定基準として精度を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、モデルをトレーニングできます。</font><font style="vertical-align: inherit;">モデルがより長くトレーニングされるとモデルが再トレーニングを開始することが判明したため、これを500のバッチサイズと3エポックのみで実行します。</font></font><br>
<br>
<pre><code class="python hljs">model = models.Sequential()
<span class="hljs-comment"># Input - Layer</span>
model.add(layers.Dense(<span class="hljs-number">50</span>, activation = <span class="hljs-string">"relu"</span>, input_shape=(<span class="hljs-number">10000</span>, )))
<span class="hljs-comment"># Hidden - Layers</span>
model.add(layers.Dropout(<span class="hljs-number">0.3</span>, noise_shape=<span class="hljs-literal">None</span>, seed=<span class="hljs-literal">None</span>))<font></font>
model.add(layers.Dense(<span class="hljs-number">50</span>, activation = <span class="hljs-string">"relu"</span>))<font></font>
model.add(layers.Dropout(<span class="hljs-number">0.2</span>, noise_shape=<span class="hljs-literal">None</span>, seed=<span class="hljs-literal">None</span>))<font></font>
model.add(layers.Dense(<span class="hljs-number">50</span>, activation = <span class="hljs-string">"relu"</span>))
<span class="hljs-comment"># Output- Layer</span>
model.add(layers.Dense(<span class="hljs-number">1</span>, activation = <span class="hljs-string">"sigmoid"</span>))<font></font>
model.summary()<font></font>
<span class="hljs-comment"># compiling the model</span><font></font>
model.compile(<font></font>
 optimizer = <span class="hljs-string">"adam"</span>,<font></font>
 loss = <span class="hljs-string">"binary_crossentropy"</span>,<font></font>
 metrics = [<span class="hljs-string">"accuracy"</span>]<font></font>
)<font></font>
results = model.fit(<font></font>
 train_x, train_y,<font></font>
 epochs= <span class="hljs-number">3</span>,<font></font>
 batch_size = <span class="hljs-number">500</span>,<font></font>
 validation_data = (test_x, test_y)<font></font>
)<font></font>
print(<span class="hljs-string">"Test-Accuracy:"</span>, np.mean(results.history[<span class="hljs-string">"val_acc"</span>]))</code></pre><br>
<img src="https://habrastorage.org/webt/fc/ay/fd/fcayfd-sr1jv_ur91nve_ecqm-4.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6層のシンプルなニューラルネットワークを作成しました。これにより、0.89の精度で映画製作者の気分を計算できます。</font><font style="vertical-align: inherit;">もちろん、クールな映画を見るためにニューラルネットワークを作成する必要はまったくありませんが、これは、データを使用する方法のもう1つの例にすぎません。</font><font style="vertical-align: inherit;">ニューラルネットワークは、構造が単純であるために汎用的であり、いくつかのパラメーターを変更することで、完全に異なるタスクに適応させることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コメント欄に自由にアイデアを書いてください。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja477610/index.html">Писатели, пираты и пиастры</a></li>
<li><a href="../ja477616/index.html">Apple Arcadeに入るには？トルトゥーガチームスタジオの創設者へのインタビュー</a></li>
<li><a href="../ja477618/index.html">Reactアプリケーションのローカリゼーション</a></li>
<li><a href="../ja477624/index.html">EXPLAINが何について沈黙しているのか、そしてそれについて話す方法</a></li>
<li><a href="../ja477628/index.html">OpenWhiskに基づくサーバーレスコンピューティング、パート2</a></li>
<li><a href="../ja477634/index.html">マイクロサービスと組織構造。どのタイプのチームが成功を確実にするでしょうか？</a></li>
<li><a href="../ja477638/index.html">Bought！= Yours：John Deereが農家からトラクターを修理する権利を奪う</a></li>
<li><a href="../ja477642/index.html">機械（無線）ビジョンが壁越しに見える</a></li>
<li><a href="../ja477644/index.html">UNIX v0からPDP-7への復元：バックルームの詳細</a></li>
<li><a href="../ja477646/index.html">数学者は方程式の一部を求めて数字を切り取る</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>