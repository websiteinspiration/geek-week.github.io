<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåé üíì ‚úùÔ∏è wc √† D: 712 caract√®res sans une seule branche üë∑üèª üôÖüèø üñ§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apr√®s avoir lu ¬´ Beat With an 80-Line Program at Haskell¬ª, que j'ai trouv√© sur Hacker News , j'ai d√©cid√© que D pourrait √™tre mieux. Et j'ai √©crit wc d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>wc √† D: 712 caract√®res sans une seule branche</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490102/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apr√®s avoir lu ¬´ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beat With an 80-Line Program at Haskell¬ª,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que j'ai trouv√© sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j'ai d√©cid√© que D pourrait √™tre mieux. </font><font style="vertical-align: inherit;">Et j'ai √©crit wc dans D. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note.per. </font><font style="vertical-align: inherit;">J'ai sugg√©r√© de traduire l'article ci-dessus</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xd34df00d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais il a pr√©f√©r√© faire sur la base de son </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Winning With Twenty Lines of Haskell: Writing Your Wc¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et maintenant, les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se multiplient</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme des remaniements de ¬´pi√®ces frapp√©es¬ª.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programme</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se compose d'un fichier - 34 lignes et 712 caract√®res.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code source</font></font></b><div class="spoiler_text"><pre><code class="swift hljs"><span class="hljs-keyword">import</span> std.stdio : writefln, File;
<span class="hljs-keyword">import</span> std.algorithm : map, fold, splitter;
<span class="hljs-keyword">import</span> std.range : walkLength;
<span class="hljs-keyword">import</span> std.typecons : Yes;
<span class="hljs-keyword">import</span> std.uni : byCodePoint;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Line</span> </span>{<font></font>
	size_t chars;<font></font>
	size_t words;<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Output</span> </span>{<font></font>
	size_t lines;<font></font>
	size_t words;<font></font>
	size_t chars;<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Output</span> combine(<span class="hljs-type">Output</span> a, <span class="hljs-type">Line</span> b) pure nothrow {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Output</span>(a.lines + <span class="hljs-number">1</span>, a.words + b.words, a.chars + b.chars);<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Line</span> toLine(char[] l) pure {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Line</span>(l.byCodePoint.walkLength, l.splitter.walkLength);<font></font>
}<font></font>
<font></font>
void main(string[] args) {<font></font>
	auto f = <span class="hljs-type">File</span>(args[<span class="hljs-number">1</span>]);
	<span class="hljs-type">Output</span> o = f<font></font>
		.byLine(<span class="hljs-type">Yes</span>.keepTerminator)<font></font>
		.<span class="hljs-built_in">map</span>!(l =&gt; toLine(l))<font></font>
		.fold!(combine)(<span class="hljs-type">Output</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<font></font>
<font></font>
	writefln!<span class="hljs-string">"%u %u %u %s"</span>(o.lines, o.words, o.chars, args[<span class="hljs-number">1</span>]);<font></font>
}</code></pre><br>
</div></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, il utilise </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phobos, la biblioth√®que standard D</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais pourquoi pas? </font><font style="vertical-align: inherit;">Phobos est magnifique et est fourni avec tous les compilateurs D. Le programme lui-m√™me ne contient aucune instruction if. </font><font style="vertical-align: inherit;">Et dans l'impl√©mentation wc sur Haskell, plusieurs si sont utilis√©s. </font><font style="vertical-align: inherit;">Le programme D, en plus du programme principal, contient trois autres fonctions minuscules. </font><font style="vertical-align: inherit;">Je pourrais facilement mettre toutes les fonctionnalit√©s dans une cha√Æne de gamme, mais cela d√©passerait probablement 80 caract√®res par ligne. </font><font style="vertical-align: inherit;">C'est le principe de base du style de code.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le wc sur D est-il plus rapide que le coreutils wc? </font><font style="vertical-align: inherit;">Non, mais il m'a fallu 15 minutes pour √©crire ma version (j'ai d√ª chercher walkLength car j'avais oubli√© le nom de la fonction).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier de donn√©es</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lignes</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octet</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">46</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">906</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,5 ms ¬± 1,9 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ¬± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,9 ms ¬± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">862</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64k</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,7 ms ¬± 2,0 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ¬± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,8 ms ¬± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,7 M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">96M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">658,6 ms ¬± 24,5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226,4 ms ¬± 29,5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,102 s ¬± 0,022 s</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12,1 millions</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">671M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,4 s ¬± 0,058 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,1 s ¬± 0,039 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,4 s ¬± 0,085 s</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√©moire:</font></font><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier de donn√©es</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2052K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7228K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7708K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2112K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7512K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7616K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2288K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42620K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7712K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2360K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50860K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7736K</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wc sur Haskell plus vite? </font><font style="vertical-align: inherit;">Pour les gros fichiers, certes, mais il utilise le multithreading. </font><font style="vertical-align: inherit;">Pour les petits fichiers, GNU coreutils gagne toujours. </font><font style="vertical-align: inherit;">√Ä ce stade, ma version est tr√®s probablement limit√©e par IO, et en tout cas, elle est assez rapide. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne dirai pas qu'une langue est plus rapide qu'une autre. </font><font style="vertical-align: inherit;">Si vous passez du temps √† optimiser le micro-benchmark, vous gagnerez tr√®s probablement. </font><font style="vertical-align: inherit;">Mais pas dans la vraie vie. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais je dirai que la programmation fonctionnelle en D rattrape presque le FP de Haskell.</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu sur la port√©e en r√©</font></font></h3><br>
<img src="https://habrastorage.org/webt/gp/qe/oo/gpqeookkvehf2hdsowdegomcqai.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">range est une abstraction qui peut √™tre it√©r√©e sans toucher √† la collection sous-jacente (le cas √©ch√©ant). </font><font style="vertical-align: inherit;">Techniquement, la plage peut √™tre une structure ou une classe qui impl√©mente une ou plusieurs interfaces de plage. </font><font style="vertical-align: inherit;">La forme la plus simple, InputRange, n√©cessite une fonction</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et deux membres ou propri√©t√©s </font></font><br>
<br>
<pre><code class="cpp hljs">T front;
<span class="hljs-keyword">bool</span> empty;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T est un type d'√©l√©ment g√©n√©rique que la plage parcourt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les plages D sont des types sp√©cifiques. </font><font style="vertical-align: inherit;">Lorsque la plage tombe dans l'instruction foreach, le compilateur effectue une petite modification.</font></font><br>
<br>
<pre><code class="cpp hljs">foreach (e; range) { ... }</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
se transforme en </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> __r = range; !__r.empty; __r.popFront()) {
    <span class="hljs-keyword">auto</span> e = __r.front;<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
auto e = calcule le type et est √©quivalent √† T e =. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet esprit, il est facile de cr√©er une gamme pouvant √™tre utilis√©e par foreach.</font></font><br>
<br>
<pre><code class="java hljs">struct Iota {
	<span class="hljs-keyword">int</span> front;
	<span class="hljs-keyword">int</span> end;<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.front == <span class="hljs-keyword">this</span>.end;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{<font></font>
		++<span class="hljs-keyword">this</span>.front;<font></font>
	}<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-keyword">import</span> std.stdio;<font></font>
	foreach(it; Iota(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iota est un exemple tr√®s simple de gamme. </font><font style="vertical-align: inherit;">Il fonctionne comme un g√©n√©rateur, sans avoir la collection sous-jacente. </font><font style="vertical-align: inherit;">Il parcourt les entiers du d√©but √† la fin par incr√©ments de un. </font><font style="vertical-align: inherit;">Cet extrait r√©v√®le un peu de syntaxe D.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'attribut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permet d'utiliser la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vide</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la m√™me mani√®re qu'une variable membre (appel d'une fonction sans parenth√®ses). L'attribut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† la fin signifie que nous ne modifions pas les donn√©es d'instance pour lesquelles nous appelons </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vide</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le test unitaire int√©gr√© imprime les nombres de 0 √† 10. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre petite caract√©ristique est le manque d'un constructeur explicite. La structure Iota a deux variables membres int. Dans l'instruction foreach du test, nous cr√©ons une instance Iota comme si elle avait un constructeur qui accepte deux entr√©es. Il s'agit d'un litt√©ral structurel. Lorsque le compilateur D le voit, mais que la structure n'a pas de constructeur correspondant, alors conform√©ment √† l'ordre de d√©claration des variables - les membres de la structure seront affect√©s int.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La relation entre les trois membres est simple. </font><font style="vertical-align: inherit;">Si vide est faux, front est garanti de retourner un nouvel √©l√©ment apr√®s l'it√©ration apr√®s avoir appel√© popFront. </font><font style="vertical-align: inherit;">Apr√®s avoir appel√© popFront, la valeur vide peut changer. </font><font style="vertical-align: inherit;">Si cela est vrai, cela signifie qu'il n'y a plus d'√©l√©ments √† r√©it√©rer et que les appels ult√©rieurs au front ne sont pas valides. </font><font style="vertical-align: inherit;">Selon la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation InputRange</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">front peut √™tre correctement calcul√© si et seulement si vide retourne ou retournerait faux.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">front peut √™tre calcul√© plusieurs fois sans appeler popFront ou autrement muter la plage ou les donn√©es sous-jacentes, et il donne le m√™me r√©sultat pour chaque calcul.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation d'expressions ou de boucles foreach n'est pas tr√®s fonctionnelle. </font><font style="vertical-align: inherit;">Supposons que nous voulons filtrer tous les nombres impairs pour Iota. </font><font style="vertical-align: inherit;">Nous pourrions mettre un if √† l'int√©rieur d'un bloc foreach, mais cela ne ferait qu'empirer les choses. </font><font style="vertical-align: inherit;">Ce serait mieux si nous avions une plage qui prend une plage et un pr√©dicat qui d√©cide si un √©l√©ment convient ou non.</font></font><br>
<br>
<pre><code class="java hljs">struct Filter {<font></font>
	Iota input;<font></font>
	<span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate</span>;<font></font>
<font></font>
	<span class="hljs-keyword">this</span>(Iota input, <span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate) </span>{
		<span class="hljs-keyword">this</span>.input = input;
		<span class="hljs-keyword">this</span>.predicate = predicate;
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testAndIterate</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">while</span>(!<span class="hljs-keyword">this</span>.input.empty<font></font>
				&amp;&amp; !<span class="hljs-keyword">this</span>.predicate(<span class="hljs-keyword">this</span>.input.front))<font></font>
		{<font></font>
			<span class="hljs-keyword">this</span>.input.popFront();<font></font>
		}<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">this</span>.input.popFront();
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">front</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.front;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.empty;<font></font>
	}<font></font>
}<font></font>
<font></font>
<span class="hljs-function">bool <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	foreach(it; Filter(Iota(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>), &amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le filtre est √† nouveau tr√®s simple: Iota et un pointeur de fonction sont n√©cessaires. </font><font style="vertical-align: inherit;">Lors de la construction du filtre, nous appelons testAndIterate, qui prend des √©l√©ments de Iota jusqu'√† ce qu'il soit vide ou que le pr√©dicat renvoie faux. </font><font style="vertical-align: inherit;">L'id√©e est que le pr√©dicat d√©cide quoi filtrer et quoi laisser. </font><font style="vertical-align: inherit;">Les propri√©t√©s avant et vides sont simplement traduites en Iota. </font><font style="vertical-align: inherit;">La seule chose qui fait le travail est popFront. </font><font style="vertical-align: inherit;">Il renvoie l'√©l√©ment actuel et appelle testAndIterate. </font><font style="vertical-align: inherit;">C'est tout. </font><font style="vertical-align: inherit;">Il s'agit d'une impl√©mentation de filtre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, testAndIterate a une boucle while, mais la r√©√©crire en utilisant la r√©cursivit√©, √† mon avis, est tout simplement stupide. Ce qui rend D super, c'est que vous pouvez utiliser la m√©thode appropri√©e pour chaque t√¢che. La programmation fonctionnelle est bonne et fait souvent √©talage, mais parfois elle ne l'est pas. Si un petit assembleur en ligne est n√©cessaire ou plus agr√©able, utilisez.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appel du filtre ne semble toujours pas tr√®s bon. </font><font style="vertical-align: inherit;">En supposant que vous ayez l'habitude de lire de gauche √† droite, le filtre appara√Æt avant Iota, m√™me s'il s'ex√©cute apr√®s Iota. </font><font style="vertical-align: inherit;">D ne fournit pas d'instruction de canal, mais utilise la syntaxe d'appel de fonction unifi√©e (UFCS). </font><font style="vertical-align: inherit;">Si une expression peut √™tre implicitement convertie en le premier param√®tre d'une fonction, alors la fonction peut √™tre appel√©e comme si elle √©tait une fonction membre de cette expression. </font><font style="vertical-align: inherit;">C'est assez compliqu√©, je comprends. </font><font style="vertical-align: inherit;">Un exemple aidera:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-built_in">string</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a ~ <span class="hljs-string">"World"</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-built_in">string</span> a = foo(<span class="hljs-string">"Hello "</span>);
	<span class="hljs-built_in">string</span> b = <span class="hljs-string">"Hello "</span>.foo();<font></font>
	assert(a == b);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple ci-dessus montre deux appels √† la fonction foo. </font><font style="vertical-align: inherit;">Comme l'affirme l'assert, les deux appels sont √©quivalents. </font><font style="vertical-align: inherit;">Qu'est-ce que cela signifie pour notre exemple de filtre Iota? </font><font style="vertical-align: inherit;">UFCS nous permet de r√©√©crire le test unitaire comme ceci:</font></font><br>
<br>
<pre><code class="swift hljs">unittest {<font></font>
	foreach(it; <span class="hljs-type">Iota</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>).<span class="hljs-type">Filter</span>(&amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'impl√©mentation map / transform pour range devrait d√©sormais √™tre accessible √† tous les lecteurs. </font><font style="vertical-align: inherit;">Bien s√ªr, un filtre peut √™tre rendu plus abstrait √† l'aide de mod√®les, mais ce ne sont que des d√©tails, rien de nouveau conceptuellement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, il existe diff√©rents types de plages, par exemple bidirectionnelles. </font><font style="vertical-align: inherit;">Devinez quelles opportunit√©s cela vous offre. </font><font style="vertical-align: inherit;">Un petit conseil: il y a deux nouvelles primitives dans la plage bidirectionnelle appel√©es back et popBack. </font><font style="vertical-align: inherit;">Il existe d'autres types de plage, mais une fois que vous avez compris la plage d'entr√©e indiqu√©e ci-dessus deux fois, vous les reconnaissez presque tous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Pour plus de clart√©, n'impl√©mentez pas votre propre filtre, carte ou pli; </font><font style="vertical-align: inherit;">la biblioth√®que standard Phobos D a tout ce dont vous avez besoin. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetez un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ≈ìil √† </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">std.algorithm</font></a><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std.range</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A propos de l'auteur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Robert Schadeck a obtenu une ma√Ætrise en informatique de l'Universit√© d'Oldenburg. </font><font style="vertical-align: inherit;">Son m√©moire de ma√Ætrise √©tait intitul√© ¬´DMCD - Compilateur D multithread distribu√© avec mise en cache¬ª, o√π il a travaill√© √† la cr√©ation d'un compilateur D √† partir de z√©ro. </font><font style="vertical-align: inherit;">Il √©tait √©tudiant dipl√¥m√© en informatique en 2012-2018. </font><font style="vertical-align: inherit;">√† l'Universit√© d'Oldenburg. </font><font style="vertical-align: inherit;">Sa th√®se de doctorat se concentre sur les syst√®mes de coll√®ge en conjonction avec des graphiques. </font><font style="vertical-align: inherit;">Depuis 2018, il est heureux d'utiliser D dans son travail quotidien, travaillant pour Symmetry Investments.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos d'Investissements Sym√©trie</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetry Investments est une soci√©t√© d'investissement mondiale avec des bureaux √† Hong Kong, Singapour et Londres. </font><font style="vertical-align: inherit;">Nous exer√ßons nos activit√©s depuis 2014 apr√®s nous √™tre s√©par√©s avec succ√®s d'un important hedge fund new-yorkais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chez Symmetry, nous nous effor√ßons de prendre des risques raisonnables pour cr√©er de la valeur pour nos clients, partenaires et employ√©s. Nous b√©n√©ficions de notre capacit√© √† g√©n√©rer des contrats gagnant-gagnant - au sens large du terme. Win-Win est notre principe √©thique et strat√©gique fondamental. En g√©n√©rant des options gagnant-gagnant, nous pouvons cr√©er des solutions uniques qui combinent des perspectives g√©n√©ralement per√ßues comme incompatibles ou oppos√©es, et couvrant tout le meilleur que chacune des parties peut offrir. Nous r√©int√©grons l'arbitrage des titres √† revenu fixe dans les macro-strat√©gies mondiales. Nous inventons et d√©veloppons une technologie qui se concentre sur le potentiel d'int√©gration homme-machine. Nous cr√©ons des syst√®mes dans lesquels les machines font ce qu'elles font le mieux, en aidant lesafin qu'ils fassent ce qu'ils font de mieux. Nous cr√©ons une m√©ritocratie bas√©e sur la collaboration: une culture dans laquelle la contribution individuelle sert des objectifs personnels et collectifs - et est r√©compens√©e en cons√©quence. Nous appr√©cions √† la fois un sentiment d'appartenance et un esprit d'√©quipe de coop√©ration, de r√©alisation de soi et de communaut√©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les gens d'Investissements Sym√©trie sont membres actifs de la communaut√© D depuis 2014. </font><font style="vertical-align: inherit;">Nous avons parrain√© le d√©veloppement d'Excel-D, Dpp, Autowrap, Libmir et d'autres projets. </font><font style="vertical-align: inherit;">Nous avons lanc√© Symmetry Autumn of Code en 2018 et h√©berg√© DConf 2019 √† Londres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Environ. </font><font style="vertical-align: inherit;">Comme le traducteur, comme d'habitude, √©tait ivre, je ne peux pas garantir l'exactitude de certains termes humains, et je ne comprends rien dans la derni√®re section. </font><font style="vertical-align: inherit;">Envoyez donc les corrections dans les communications personnelles.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490088/index.html">Comment continuer √† cr√©er une carte dans UE4</a></li>
<li><a href="../fr490092/index.html">Andrei Zaretsky, Alexander Trukhanov: ¬´Le prix √©tait suffisant pour boire du caf√©¬ª</a></li>
<li><a href="../fr490094/index.html">Retour aux sources: nous pilotons un ordinateur directement depuis le MBR</a></li>
<li><a href="../fr490096/index.html">Un moyen facile de cr√©er un petit concentrateur USB pour Raspberry Pi</a></li>
<li><a href="../fr490100/index.html">D√©velopper un logiciel de location d√©centralis√©e de scooters. Qui a dit que ce serait facile?</a></li>
<li><a href="../fr490104/index.html">Pare-soleil intelligent de Bosch. Test de prototype</a></li>
<li><a href="../fr490110/index.html">Du d√©veloppeur au manager et inversement</a></li>
<li><a href="../fr490112/index.html">–ú–æ–Ω–∞–¥—ã –∫–∞–∫ –ø–∞—Ç—Ç–µ—Ä–Ω –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞</a></li>
<li><a href="../fr490114/index.html">Yandex.Practicum - Analyste de donn√©es. L'obtention du dipl√¥me</a></li>
<li><a href="../fr490118/index.html">10 faits les plus importants sur SERM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>