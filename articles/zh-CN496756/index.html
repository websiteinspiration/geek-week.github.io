<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•§ ğŸ ğŸ™†ğŸ¾ AWS Lambdaå®é™…åº”ç”¨ã€‚ç¬¬2éƒ¨åˆ†ï¼šäº†è§£å¼€å‘å’Œæµ‹è¯•å·¥å…· ğŸ‘º â„¢ï¸ ğŸ‘¨â€âš–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬æŒ‡å—æ˜¯åœ¨å¼€å‘å’Œæµ‹è¯•æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºæ–¹é¢çš„ä¸ªäººç»éªŒçš„ç»“æœï¼Œä»¥åŠåœ¨å°è¯•å¯¹æ‹æ–å’Œè‡ªè¡Œè½¦è¿›è¡Œæ“çºµæ—¶çš„ä¸ªäººç»éªŒã€‚å½“æˆ‘åˆšå¼€å§‹å¼€å‘æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä¸å¾—ä¸åŠ¨æ‰‹è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæ²¡æœ‰ç”¨äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•çš„æ˜ç¡®æŒ‡å—æˆ–ä¾¿æ·å·¥å…·ã€‚
 
 ç°åœ¨æƒ…å†µæ­£åœ¨å‘ç”Ÿå˜åŒ–ï¼šå·¥å…·å¼€å§‹å‡ºç°ï¼Œä½†æ˜¯è¦æ‰¾åˆ°ä½¿ç”¨å®ƒä»¬çš„æ‰‹å†Œå¹¶ä¸å®¹æ˜“ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>AWS Lambdaå®é™…åº”ç”¨ã€‚ç¬¬2éƒ¨åˆ†ï¼šäº†è§£å¼€å‘å’Œæµ‹è¯•å·¥å…·</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/496756/"><img src="https://habrastorage.org/webt/7w/hp/bb/7whpbbwttpekzxdq4-7sgs28rio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æŒ‡å—æ˜¯åœ¨å¼€å‘å’Œæµ‹è¯•æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºæ–¹é¢çš„ä¸ªäººç»éªŒçš„ç»“æœï¼Œä»¥åŠåœ¨å°è¯•å¯¹æ‹æ–å’Œè‡ªè¡Œè½¦è¿›è¡Œæ“çºµæ—¶çš„ä¸ªäººç»éªŒã€‚å½“æˆ‘åˆšå¼€å§‹å¼€å‘æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä¸å¾—ä¸åŠ¨æ‰‹è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæ²¡æœ‰ç”¨äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•çš„æ˜ç¡®æŒ‡å—æˆ–ä¾¿æ·å·¥å…·ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æƒ…å†µæ­£åœ¨å‘ç”Ÿå˜åŒ–ï¼šå·¥å…·å¼€å§‹å‡ºç°ï¼Œä½†æ˜¯è¦æ‰¾åˆ°ä½¿ç”¨å®ƒä»¬çš„æ‰‹å†Œå¹¶ä¸å®¹æ˜“ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ–°åŠŸèƒ½ã€‚æ‚¨å¯ä»¥è½»æ¾æŒæ¡å®ƒå¹¶è§£å†³é‚£äº›æˆ‘å¾ˆå¹¸è¿é‡åˆ°çš„é—®é¢˜å’Œé”™è¯¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨AWSï¼ŒSAM-CLIå’ŒIntelljIDEAæµè§ˆå™¨æ§åˆ¶å°è¿›è¡Œå¼€å‘ã€‚</font><font style="vertical-align: inherit;">æˆ‘è¿˜å°†è®¨è®ºæµ‹è¯•ï¼šé›†æˆï¼Œç«¯åˆ°ç«¯å’Œå•å…ƒæµ‹è¯•ã€‚</font><font style="vertical-align: inherit;">æœ€åï¼Œæˆ‘ä»¬å°†è®¨è®ºè¿™ç§è§£å†³æ–¹æ¡ˆçš„æˆæœ¬ï¼ˆç ´åè€…ï¼šæ‚¨å¯ä»¥èŠ‚çœå¾ˆå¤šé’±ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ¬æ–‡å¯¹é‚£äº›å¼€å§‹å¼€å‘æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºä½†è¿˜ä¸ç†Ÿæ‚‰å…¶å·¥å…·å’Œæ–¹æ³•çš„äººå¾ˆæœ‰ç”¨ã€‚</font></font><br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†è®¨è®ºä»€ä¹ˆ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤§å®¶å¥½ï¼</font><font style="vertical-align: inherit;">æˆ‘çš„åå­—å«Alexander Gruzdevï¼Œæˆ‘å¾ˆé«˜å…´ä»‹ç»æœ‰å…³åŸºäºAWS Lambdaçš„æ— æœåŠ¡å™¨è§£å†³æ–¹æ¡ˆçš„ä½¿ç”¨å’Œå¼€å‘çš„æ–‡ç« çš„ç¬¬äºŒéƒ¨åˆ†ã€‚</font><font style="vertical-align: inherit;">åœ¨åç»­æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»ç¬¬ä¸€éƒ¨åˆ†å¼€å§‹è®¨è®ºå¼€å‘å’Œæµ‹è¯•è§£å†³æ–¹æ¡ˆçš„æ–¹æ³•ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java 11ä¸­çš„AWS Lambda in Actionã€‚æˆ‘ä»¬åœ¨â€œç”Ÿäº§â€ä¸­è®¿é—®Serverless</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡ªä»ä¸Šä¸€ç¯‡æ–‡ç« å‘è¡¨ä»¥æ¥ï¼Œå·²ç»å¯¹æµ‹è¯•åº”ç”¨ç¨‹åºè¿›è¡Œäº†ç¨å¾®çš„é‡æ–°è®¾è®¡ï¼Œä½†æ˜¯ä¸»è¦å«ä¹‰ä¿æŒä¸å˜ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ä¸ªç®€å•çš„HTMLè¡¨å•â€œè”ç³»æˆ‘ä»¬â€ï¼Œè¯¥è¡¨å•é€šè¿‡HTTPè¯·æ±‚å°†æ•°æ®ä»è¡¨å•å‘é€åˆ°Gateway APIï¼Œç„¶åå°†å¤„ç†è¯·æ±‚ä»£ç†åˆ°AWS Lambdaã€‚</font><font style="vertical-align: inherit;">åœ¨å¤„ç†æœŸé—´ï¼Œlambdaå°†æ•°æ®å†™å…¥DynamoDBè¡¨ï¼Œå¹¶é€šè¿‡AWS SESå‘é€ä¸€å°ä¿¡ã€‚</font><font style="vertical-align: inherit;">ç»„ä»¶å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/zp/wd/aczpwdfofm_vp7xqrjdis2gsblu.png" alt="ç»„ä»¶å›¾"><br>
<br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†…å®¹</font></font></h1><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨AWS Browseræ§åˆ¶å°è¿›è¡Œå¼€å‘</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨SAM-CLIè¿›è¡Œå¼€å‘</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨IntelljIDEAè¿›è¡Œå¼€å‘</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµ‹è¯•ç±»å‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ— æœåŠ¡å™¨æˆæœ¬</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ç”¨çš„é“¾æ¥</font></font></a></li>
</ol><br>
<br>
<a name="Part1"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.ä½¿ç”¨AWSæµè§ˆå™¨æ§åˆ¶å°è¿›è¡Œå¼€å‘</font></font></h1><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWSæ§åˆ¶å°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWSæ§åˆ¶å°æä¾›å¯¹ä»»ä½•AWSæœåŠ¡çš„è®¿é—®ï¼Œæ— è®ºæ˜¯æ‚¨çš„è™šæ‹ŸEC2æœåŠ¡å™¨ï¼ŒIAMè¿˜æ˜¯AWS Lambdaè§’è‰²/è®¿é—®ç­–ç•¥è®¾ç½®ï¼Œå…¶æ‰€æœ‰å‚æ•°éƒ½å¯ä»¥å®æ—¶æ›´æ”¹ï¼Œè€Œæ— éœ€é€šè¿‡æŒç»­äº¤ä»˜/æŒç»­éƒ¨ç½²ç³»ç»Ÿè¿›è¡Œé‡æ–°éƒ¨ç½²ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å¤§å¤§åŠ å¿«äº†å¼€å‘è¿‡ç¨‹å’ŒæŸäº›ç±»å‹çš„æµ‹è¯•ã€‚</font><font style="vertical-align: inherit;">å®ƒè¿˜æœ‰åŠ©äºç›´è§‚åœ°æ§åˆ¶åº”ç”¨ç¨‹åºçš„å¯åŠ¨å’Œæ“ä½œå‚æ•°ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIç½‘å…³æ§åˆ¶å°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æ§åˆ¶å°ä½¿æ‚¨å¯ä»¥ç›‘è§†åº”ç”¨ç¨‹åºçš„å½“å‰çŠ¶æ€ï¼Œç®¡ç†ç¯å¢ƒå¹¶æä¾›æ–°ç‰ˆæœ¬ã€‚</font><font style="vertical-align: inherit;">æˆ‘å°†å±•ç¤ºå¦‚ä½•å°†å…¶ç”¨äºéªŒè¯ç¯å¢ƒçš„å¥åº·çŠ¶å†µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬åœ¨â€œè”ç³»æˆ‘ä»¬â€åº”ç”¨ç¨‹åºçš„â€œèµ„æºâ€é€‰é¡¹å¡çš„å±å¹•å¿«ç…§ä¸­çœ‹ä¸€ä¸‹è¿™ä¸ªâ€œé­”æœ¯â€æ§åˆ¶å°çš„å¤–è§‚ï¼š</font><font style="vertical-align: inherit;">
å±å¹•å¿«ç…§æ˜¾ç¤ºäº†å¦‚ä½•é€šè¿‡POST APIè°ƒç”¨å®¢æˆ·ç«¯é€šè¿‡Gateway APIçš„è¯·æ±‚è¿›å…¥lambdaä»¥åŠå¦‚ä½•å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/f7/fe/s2/f7fes2uz9qxcpj9dqmko6zuxalc.png" alt="ç½‘å…³èµ„æº"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•è¯·æ±‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -å¤„ç†è¯·æ±‚çš„ç¬¬ä¸€æ­¥ã€‚</font><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œå®ƒä¸åŒ…å«ä»»ä½•è®¾ç½®ï¼Œä½†å¯èƒ½åŒ…å«ä¾‹å¦‚æˆæƒè®¾ç½®ã€‚</font></font><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é›†æˆè¯·æ±‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ„å‘³ç€HTTPè¯·æ±‚å°†ä»¥ç‰¹æ®Šæ ¼å¼ä¼ è¾“åˆ°lambdaï¼šå®ƒåŒ…å«å®¢æˆ·ç«¯å‘é€çš„æ‰€æœ‰ä¿¡æ¯ä»¥åŠæœ‰å…³è¢«è°ƒç”¨ä¸Šä¸‹æ–‡çš„è¯¦ç»†ä¿¡æ¯ã€‚</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é›†æˆå“åº”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨ç¤ºHTTPå®¢æˆ·ç«¯å°†ç›´æ¥ä»lambdaæ¥æ”¶å“åº”ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæ‚¨è‡ªå·±è´Ÿè´£åœ¨lambdaä¸­å½¢æˆå“åº”ä¸»ä½“ã€‚</font></font></li>
</ul><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¦ç”¨ä»£ç†é›†æˆ</font></font></b>
                        <div class="spoiler_text">     API Gateway  ,    <i>Use Lambda Proxy integration</i>   <i>Integration Request</i>.          . ,          ,     .<br>
<br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•´åˆè¦æ±‚èŒƒä¾‹</font></font></b>
                        <div class="spoiler_text">    SAM init      <i>events</i>,     ,      <i>Integration request</i>.    ,   AWS    ,     .         AWS Lambda.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŒ‰ä¸‹æµ‹è¯•æŒ‰é’®ä»¥éªŒè¯è¯¥åº”ç”¨ç¨‹åºæ­£åœ¨è¿è¡Œã€‚</font><font style="vertical-align: inherit;">è¿™å°†ä½¿æ‚¨å¯ä»¥è®¿é—®HTTPç½‘å…³APIè°ƒç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä»¥ä¸‹å±å¹•æˆªå›¾ä¸­ï¼Œæˆ‘å‘é€äº†ä¸€ä¸ªé¢„çƒ­lambdaçš„è¯·æ±‚ï¼š</font><font style="vertical-align: inherit;">
é™¤äº†å“åº”è¯¥è¯·æ±‚ä¹‹å¤–ï¼ŒGateway APIè¿˜æ˜¾ç¤ºè¯¦ç»†çš„æ—¥å¿—ã€‚</font><font style="vertical-align: inherit;">ä»¥ç›¸åŒçš„æ–¹å¼ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä»¥ä¸‹å½¢å¼æ›¿æ¢JSONè¯·æ±‚ä¸»ä½“æ¥å‘å‡ºçœŸå®è¯·æ±‚ï¼š</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/ia/kf/ga/iakfgafb8t4-9aocr5o-e5dspy0.png" alt="ç½‘å…³æµ‹è¯•è¯·æ±‚"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<pre><code class="javascript hljs">{
    <span class="hljs-string">"subject"</span>: <span class="hljs-string">"Email subject"</span>,
    <span class="hljs-string">"question"</span>: <span class="hljs-string">"Your questionâ€¦"</span>,
    <span class="hljs-string">"username"</span>: <span class="hljs-string">"Your nameâ€¦"</span>,
    <span class="hljs-string">"phone"</span>: <span class="hljs-string">"Your phoneâ€¦"</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"Your emailâ€¦"</span><font></font>
} <font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨æ²¡æœ‰ä»»ä½•UIè¡¨å•å’Œå‰ç«¯åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹æ‰‹åŠ¨æµ‹è¯•æ‚¨çš„APIï¼Œä»è€Œåˆ†ç¦»å‰ç«¯å’Œåç«¯å¼€å‘ã€‚</font><font style="vertical-align: inherit;">ä½œä¸ºå†…ç½®æ§åˆ¶å°çš„æ›¿ä»£ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Postmanæˆ–ä»»ä½•å…¶ä»–HTTPå®¢æˆ·ç«¯ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‚®é€’å‘˜ä½œä¸ºæ›¿ä»£</font></font></b>
                        <div class="spoiler_text">   HTTP-     Postman.         .   ,   API Gateway       AWS ,              API. ,  ,       AWS .<br>
</div>
                    </div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lambdaæ§åˆ¶å°</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºæµ‹è¯•å’Œå¼€å‘ï¼Œé™¤äº†é€šè¿‡ç½‘å…³APIçš„è¯·æ±‚å¤–ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨AWS Lambdaæµè§ˆå™¨æ§åˆ¶å°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒçš„å±å¹•åˆ†ä¸ºå‡ ä¸ªå—ï¼š</font></font><br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Designer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¾ç¤ºç°æœ‰è§¦å‘å™¨å’Œå›¾å±‚ã€‚</font><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè§¦å‘å™¨æ˜¯APIç½‘å…³ã€‚</font><font style="vertical-align: inherit;">å¦‚æœå•å‡»å®ƒï¼Œå°†æ‰“å¼€æ‰€æœ‰å¿…è¦çš„ä¿¡æ¯ï¼šURLï¼Œé˜¶æ®µï¼Œèµ„æºè·¯å¾„ã€‚</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ«å</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆåœ¨é€‰æ‹©ç‰¹å®šçš„lambdaåˆ«åæ—¶å¯ç”¨ï¼‰å…è®¸æ‚¨é…ç½®æŒ‰lambdaç‰ˆæœ¬åˆ’åˆ†çš„æµé‡åˆ†é…ã€‚</font><font style="vertical-align: inherit;">ä¸‹ä¸€èŠ‚å°†å¯¹æ­¤è¿›è¡Œæ›´å¤šä»‹ç»ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png"></a></li>
<li><i>Function code</i> â€”        .      zip-  ,    .       ,   Function code      .         Python/NodeJs. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/1l/p1/0y/1lp10yo_zd7tcbcr7cyu-dyxtlw.png"></a></li>
<li><i>Environment variables.</i> ,      .  ,        ,     .    ,         . ,    ,        .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/hx/sg/z_/hxsgz_-adludvt4phrfgebnjqa4.png"></a></li>
<li><i>Tags</i> â€”  ,       , ,    ,    .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/qm/za/bt/qmzabtb2nt-yo9tedqlxluhop8e.png"></a></li>
<li><i>Execution role</i> â€”      (   ) ,      .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/bf/rk/3s/bfrk3sw8ig7rseuhnwr4mr8o8-c.png"></a></li>
<li><i>Basic settings</i> â€”         .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/ds/lr/cj/dslrcjorhygk_bmfzlxp5ddxqz0.png"></a></li>
<li><i>Network</i>:      -  ,          VPC.    â€”   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  .</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/-i/lz/hm/-ilzhms_ty6b7i7pex7pc1dbcbw.png"></a></li>
<li><i>AWS X-Ray</i>   .           AWS-. <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/pj/l6/qz/pjl6qzbt3133iqwonql03wd96qs.png"></a></li>
<li><i> Reserve concurrency</i>     ,                  .          .<br>
   Provisioned concurrency</li>
<li><i>Provisioned concurrency</i> â€”    .       ,          .     ,     â€”    .          Free Tier .<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/mb/gt/sq/mbgtsqv1iueoy6js88rv4rusi7s.png"></a></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚æ­¥è°ƒç”¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿æ‚¨å¯ä»¥é…ç½®å¼‚æ­¥è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬æŒ‡å‡ºå‘ç”Ÿé”™è¯¯æ—¶è¦è¿›è¡Œå¤šå°‘æ¬¡é‡å¤è°ƒç”¨ï¼Œä»¥åŠè¯·æ±‚å¯ä»¥åœ¨é˜Ÿåˆ—ä¸­æŒ‚èµ·å¤šé•¿æ—¶é—´ã€‚</font><font style="vertical-align: inherit;">ï¼ˆå¯é€‰ï¼‰æ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªé˜Ÿåˆ—æ¥å¤„ç†å¤±è´¥çš„è¯·æ±‚ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/fp/g_/zi/fpg_ziuv-ouv4yeeejmxqlko-za.png"></a><br>
</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®åº“ä»£ç†</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¦ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…è®¸æ‚¨ä»¥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> APIç½‘å…³+ Lambdaçš„å½¢å¼</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">é…ç½®</font></a><font style="vertical-align: inherit;">é€šè¿‡ä»£ç†å¯¹æ•°æ®åº“çš„è®¿é—®ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/bp/f4/fw/bpf4fw1yjd0ayzsolj0vbhnjrfs.png"></a></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä»è¯¥æ§åˆ¶å°è¿›è¡Œå¼€å‘ã€‚</font><font style="vertical-align: inherit;">é™¤äº†æ›´æ”¹å‚æ•°ä¹‹å¤–ï¼Œâ€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®æµ‹è¯•äº‹ä»¶â€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠŸèƒ½</font><font style="vertical-align: inherit;">è¿˜å¯ç”¨äºåˆ›å»ºæµ‹è¯•è¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸€ä¸ªç›¸å½“å¹¿æ³›çš„åˆ—è¡¨ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åˆ©ç”¨æˆ‘å·²ç»åœ¨é¡¹ç›®ä¸­é™„åŠ çš„å†…å®¹ï¼š</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è”ç³»æˆ‘ä»¬çš„è¦æ±‚</font></font></b>
                        <div class="spoiler_text"><pre><code class="javascript hljs">{
  <span class="hljs-string">"body"</span>: <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span>: <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"path"</span>: <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"isBase64Encoded"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"queryStringParameters"</span>: {
    <span class="hljs-string">"foo"</span>: <span class="hljs-string">"bar"</span><font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span>: {
    <span class="hljs-string">"proxy"</span>: <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"stageVariables"</span>: {
    <span class="hljs-string">"baz"</span>: <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"headers"</span>: {
    <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span>,
    <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate, sdch"</span>,
    <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"en-US,en;q=0.8"</span>,
    <span class="hljs-string">"Cache-Control"</span>: <span class="hljs-string">"max-age=0"</span>,
    <span class="hljs-string">"CloudFront-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span>,
    <span class="hljs-string">"CloudFront-Is-Desktop-Viewer"</span>: <span class="hljs-string">"true"</span>,
    <span class="hljs-string">"CloudFront-Is-Mobile-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-SmartTV-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Is-Tablet-Viewer"</span>: <span class="hljs-string">"false"</span>,
    <span class="hljs-string">"CloudFront-Viewer-Country"</span>: <span class="hljs-string">"US"</span>,
    <span class="hljs-string">"Host"</span>: <span class="hljs-string">"1234567890.execute-api.us-east-1.amazonaws.com"</span>,
    <span class="hljs-string">"Upgrade-Insecure-Requests"</span>: <span class="hljs-string">"1"</span>,
    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
    <span class="hljs-string">"Via"</span>: <span class="hljs-string">"1.1 08f323deadbeefa7af34d5feb414ce27.cloudfront.net (CloudFront)"</span>,
    <span class="hljs-string">"X-Amz-Cf-Id"</span>: <span class="hljs-string">"cDehVQoZnx43VYQb9j2-nvCh-9z396Uhbp027Y2JvkCPNLmGJHqlaA=="</span>,
    <span class="hljs-string">"X-Forwarded-For"</span>: <span class="hljs-string">"127.0.0.1, 127.0.0.2"</span>,
    <span class="hljs-string">"X-Forwarded-Port"</span>: <span class="hljs-string">"443"</span>,
    <span class="hljs-string">"X-Forwarded-Proto"</span>: <span class="hljs-string">"https"</span><font></font>
  },<font></font>
  <span class="hljs-string">"requestContext"</span>: {
    <span class="hljs-string">"accountId"</span>: <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"resourceId"</span>: <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"stage"</span>: <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"requestId"</span>: <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"requestTime"</span>: <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span>: <span class="hljs-number">1428582896000</span>,
    <span class="hljs-string">"identity"</span>: {
      <span class="hljs-string">"cognitoIdentityPoolId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accountId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoIdentityId"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"caller"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"accessKey"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"sourceIp"</span>: <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"cognitoAuthenticationType"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userArn"</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-string">"userAgent"</span>: <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span>: <span class="hljs-literal">null</span><font></font>
    },<font></font>
    <span class="hljs-string">"path"</span>: <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"resourcePath"</span>: <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"apiId"</span>: <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"protocol"</span>: <span class="hljs-string">"HTTP/1.1"</span><font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ·»åŠ è¯·æ±‚åï¼Œå•å‡»â€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµ‹è¯•â€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶å</font><font style="vertical-align: inherit;">æŸ¥çœ‹lambdaçš„ç»“æœï¼š</font><font style="vertical-align: inherit;">
Lambdaè¿”å›JSONï¼Œå…¶ä¸­åŒ…å«çŠ¶æ€ä»£ç å’Œå“åº”æ­£æ–‡ã€‚</font><font style="vertical-align: inherit;">ä¸»ä½“å€¼å°†ç›´æ¥è½¬åˆ°è°ƒç”¨ç½‘å…³APIçš„å®¢æˆ·ç«¯ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œå±å¹•æˆªå›¾è¿˜å…·æœ‰è°ƒç”¨çš„ç‰¹å¾ï¼šæ‰§è¡Œæ—¶é—´ï¼Œæˆ‘ä»¬å°†ä¸ºå…¶æ”¯ä»˜çš„æ‰§è¡Œæ—¶é—´ï¼Œlambdaæ¶ˆè€—çš„æœ€å¤§å†…å­˜é‡ã€‚</font><font style="vertical-align: inherit;">ä¾é è¿™äº›æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®æœ€ä½³å†…å­˜é‡ï¼Œä»¥ä¾¿lambdaç¬¦åˆæ‚¨çš„ä»·æ ¼/å“åº”ç‡è¦æ±‚ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/oc/vw/w1/ocvww1tut1fhx0czz5ijzjnpvhg.png" alt="ç½‘å…³èµ„æº"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨AWSæ§åˆ¶å°æµ‹è¯•Canaryéƒ¨ç½²</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆä¸éƒ¨ç½²æ–°ç‰ˆæœ¬çš„lambdaæœ‰å…³çš„ä¸€ä¸ªé‡è¦ç‚¹ã€‚</font><font style="vertical-align: inherit;">æˆ‘åœ¨ç¼–å†™SAMæ¨¡æ¿æ—¶æŒ‡å®šäº†ä»¥ä¸‹å‚æ•°ï¼š</font></font><br>
<pre><code class="plaintext hljs">AutoPublishAlias: live<font></font>
DeploymentPreference:<font></font>
  Type: Canary10Percent10Minutes<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€ä¸ªå‚æ•°è‡ªåŠ¨ä¸ºæ¯ä¸ªæ–°ç‰ˆæœ¬çš„lambdaæ·»åŠ ä¸€ä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ´»</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„åˆ«å</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³äºåˆ«åçš„ä¸€ç‚¹</font></font></b>
                        <div class="spoiler_text">     ,   .    ,         ,       API Gateway.      1, 2, 3   .    <i>LATEST</i>,     .     2  3   API Gateway (Stage   AWS),          Gateway-Lambda.  API Gateway      (ARN ),      <i>LATEST</i>. <br>
 <br>
 â€”    (  ), ,      ,    ARN .      ,         Stage  API Gateway      .  ,    API Gateway: dev, qa  prod       .<br>
<br>
         ,    ,      .       ,        .  , live,    .    live-    , , ,    ,       CloudWatch.<br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦æµ‹è¯•é‡‘ä¸é›€éƒ¨ç½²ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨Gateway APIæ§åˆ¶å°å’ŒLambdaæ§åˆ¶å°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæ‚¨éœ€è¦æ›´æ”¹lambdaä»£ç ï¼Œä»¥ä¾¿å®ƒè¿”å›ä¸åŒçš„ç­”æ¡ˆã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œåœ¨çƒ­èº«å¤„ç†ä¸­ï¼Œåœ¨å“åº”ä¸­æŒ‡å®šç‰ˆæœ¬2è€Œä¸æ˜¯ç‰ˆæœ¬1ï¼Œè¿™å°†æˆä¸ºæˆ‘ä»¬çš„æ ‡è®°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œä½¿ç”¨ç½‘å…³æµ‹è¯•çš„APIåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿åœ¨å‘é€WARM-UPè¯·æ±‚æ—¶çš„ååˆ†é’Ÿå†…ï¼Œåªæœ‰10ï¼…çš„å“åº”åœ¨å“åº”ä¸»ä½“ä¸­å…·æœ‰ç‰ˆæœ¬2ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™æ®µæ—¶é—´ä¹‹åï¼Œç‰ˆæœ¬2å°†è¿”å›100ï¼…çš„è¯·æ±‚ï¼Œ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é™¤äº†å¯ä»¥ä½¿ç”¨Gateway APIæ§åˆ¶å°ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨Lambdaæ§åˆ¶å°ï¼Œåœ¨è¯¥æ§åˆ¶å°ä¸­ï¼Œé€‰æ‹©äº†å¿…è¦çš„åˆ«ååï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¯ä»¥æ§åˆ¶çš„æµé‡åˆ†é…ç­–ç•¥ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/hs/3s/b8/hs3sb8_jvymnm4bnmtn1yvgcamg.png" alt="Lambdaåˆ«å"></a><br>
<br>
<br>
<a name="Part2"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.ä½¿ç”¨SAM-CLIè¿›è¡Œæœ¬åœ°å¼€å‘</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ä¹…å‰ï¼Œä½¿ç”¨lambdaçš„ä¸»è¦ç¼ºç‚¹ä¹‹ä¸€è¢«è®¤ä¸ºæ˜¯åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè¿›è¡Œå¼€å‘å’Œæµ‹è¯•å¸¦æ¥çš„ä¸ä¾¿ã€‚ç°åœ¨æƒ…å†µå‘ç”Ÿäº†å¾ˆå¤§å˜åŒ–ï¼šSAMæ¡†æ¶å·²ç»å‡ºç°ï¼Œå®ƒä¸ä»…å¯ä»¥æ”¶é›†å’Œéƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼Œè¿˜å¯ä»¥ç®€åŒ–æœ¬åœ°å¼€å‘ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ç›´æ¥ä»æ§åˆ¶å°è°ƒç”¨lambdaï¼š</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥å‘½ä»¤ä»å¸¦æœ‰SAMæ¨¡æ¿çš„ç›®å½•ä¸­å¯åŠ¨ï¼Œå¹¶å°†JSONæ–‡ä»¶çš„å†…å®¹ä¼ è¾“åˆ°è¾“å…¥lambda ContactUsFunctionï¼ˆè¿™æ˜¯æ¨¡æ¿ä¸­çš„é€»è¾‘åï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ï¼ŒSAMåœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dockerä¸­</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆé•œåƒ</font><i><font style="vertical-align: inherit;">lambci / lambdaï¼šjava11</font></i><font style="vertical-align: inherit;">ï¼Œå¹¶åœ¨å…¶ä¸­è¿è¡Œä»£ç ã€‚</font><font style="vertical-align: inherit;">è¦è®¿é—®è¯¸å¦‚SESä¹‹ç±»çš„è¿œç¨‹æœåŠ¡ï¼Œå°†ä½¿ç”¨å¸¦æœ‰å¯†é’¥/è®¿é—®å¯†é’¥çš„AWSé…ç½®ï¼Œå› æ­¤å®ƒå¿…é¡»æ˜¯æœ€æ–°çš„ã€‚</font><font style="vertical-align: inherit;">å¦ä¸€ä¸ªé‡è¦ç‚¹ï¼šå¦‚æœæ‚¨ä¸ä¸ºçƒ­èº«æ¨¡å¼æ·»åŠ æ ‡é¢˜ï¼Œåˆ™å°†è°ƒç”¨çœŸå®çš„AWS SESå’ŒDynamoDBæœåŠ¡ã€‚</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œè‡´ç”µè®°å½•</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> invoke -e ./events/warm_up_request.json ContactUsFunction<font></font>
Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2 Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Request was received<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\"subject\": \"Question\",\"question\": \"How much does it cost\",\"username\": \"Alex\",\"phone\": \"+79999999999\",\"email\": \"alex@gmail.com\"}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/{proxy+}"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/{proxy+}"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/prod/path/to/resource"</span>,
    <span class="hljs-string">"protocol"</span> : <span class="hljs-string">"HTTP/1.1"</span>,
    <span class="hljs-string">"requestTime"</span> : <span class="hljs-string">"09/Apr/2015:12:34:56 +0000"</span>,
    <span class="hljs-string">"requestTimeEpoch"</span> : 1428582896000,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : { },
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"X-WARM-UP"</span> : [ <span class="hljs-string">"13"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : {
    <span class="hljs-string">"proxy"</span> : <span class="hljs-string">"/path/to/resource"</span><font></font>
  },<font></font>
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : {
    <span class="hljs-string">"baz"</span> : <span class="hljs-string">"qux"</span><font></font>
  },<font></font>
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/path/to/resource"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:09:17 a86d65fa-1f19-15c5-93b8-d87631c80ee2 INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2?[0m<font></font>
?[32mREPORT RequestId: a86d65fa-1f19-15c5-93b8-d87631c80ee2     Init Duration: 1984.55 ms       Duration: 42.22 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
{<span class="hljs-string">"statusCode"</span>:201,<span class="hljs-string">"multiValueHeaders"</span>:{<span class="hljs-string">"Access-Control-Allow-Origin"</span>:[<span class="hljs-string">"*"</span>]},<span class="hljs-string">"body"</span>:{<span class="hljs-string">"response"</span>:<span class="hljs-string">"Lambda was warmed up. V1"</span>},<span class="hljs-string">"isBase64Encoded"</span>:<span class="hljs-literal">false</span>}
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é™¤äº†lambdaæ—¥å¿—å¤–ï¼Œè¿˜å°†æœ‰å…³å‘¼å«çŠ¶æ€çš„æœåŠ¡ä¿¡æ¯å’ŒJSONæ ¼å¼çš„å“åº”å†™å…¥æ§åˆ¶å°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åƒlambdaä¸€æ ·ï¼Œç½‘å…³APIå¯ä»¥åœ¨æœ¬åœ°è¿è¡Œã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼š</font></font><br>
<pre><code class="bash hljs">sam <span class="hljs-built_in">local</span> start-api
</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯åŠ¨æ—¶çš„æ§åˆ¶å°æ—¥å¿—</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">F:\aws\projects\contact-us-sam-app&gt;sam <span class="hljs-built_in">local</span> start-api<font></font>
Mounting ContactUsFunction at http://127.0.0.1:3000/contact [POST, OPTIONS]<font></font>
You can now browse to the above endpoints to invoke your <span class="hljs-built_in">functions</span>. You <span class="hljs-keyword">do</span> not need to restart/reload SAM CLI <span class="hljs-keyword">while</span> working on your <span class="hljs-built_in">functions</span>, changes will be reflected instantly/automatically. You only need to restart SAM CLI <span class="hljs-keyword">if</span> you update your AWS SAM template<font></font>
2020-01-06 22:20:30  * Running on http://127.0.0.1:3000/ (Press CTRL+C to quit)<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯åŠ¨æœåŠ¡å™¨åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œè¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">æˆ‘å°†ä½¿ç”¨Postmanå¹¶å‘é€è¯·æ±‚ä»¥é¢„çƒ­lambdaã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/_e/hg/vs/_ehgvsftbjygwjcu3iiol-vky68.png"></a><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ§åˆ¶å°ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">Invoking com.gralll.sam.App::handleRequest (java11)<font></font>
Fetching lambci/lambda:java11 Docker container image......<font></font>
Mounting F:\aws\projects\contact-us-sam-app\.aws-sam\build\ContactUsFunction as /var/task:ro,delegated inside runtime container<font></font>
?[32mSTART RequestId: 27868750-3637-1f80-3d80-53a724da16ef Version: <span class="hljs-variable">$LATEST</span>?[0m<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Request was received<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef DEBUG App - {<font></font>
  <span class="hljs-string">"body"</span> : <span class="hljs-string">"{\r\n  \"subject\": \"Question\",\r\n  \"question\": \"How much does it cost\",\r\n  \"username\": \"Alex\",\r\n  \"phone\": \"+79999999999\",\r\n  \"email\": \"alex@gmail.com\"\r\n}"</span>,
  <span class="hljs-string">"resource"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"requestContext"</span> : {
    <span class="hljs-string">"resourceId"</span> : <span class="hljs-string">"123456"</span>,
    <span class="hljs-string">"apiId"</span> : <span class="hljs-string">"1234567890"</span>,
    <span class="hljs-string">"resourcePath"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
    <span class="hljs-string">"requestId"</span> : <span class="hljs-string">"c6af9ac6-7b61-11e6-9a41-93e8deadbeef"</span>,
    <span class="hljs-string">"extendedRequestId"</span> : null,
    <span class="hljs-string">"accountId"</span> : <span class="hljs-string">"123456789012"</span>,
    <span class="hljs-string">"identity"</span> : {
      <span class="hljs-string">"apiKey"</span> : null,
      <span class="hljs-string">"apiKeyId"</span> : null,
      <span class="hljs-string">"userArn"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationType"</span> : null,
      <span class="hljs-string">"caller"</span> : null,
      <span class="hljs-string">"userAgent"</span> : <span class="hljs-string">"Custom User Agent String"</span>,
      <span class="hljs-string">"user"</span> : null,
      <span class="hljs-string">"cognitoIdentityPoolId"</span> : null,
      <span class="hljs-string">"cognitoIdentityId"</span> : null,
      <span class="hljs-string">"cognitoAuthenticationProvider"</span> : null,
      <span class="hljs-string">"sourceIp"</span> : <span class="hljs-string">"127.0.0.1"</span>,
      <span class="hljs-string">"accountId"</span> : null,
      <span class="hljs-string">"accessKey"</span> : null<font></font>
    },<font></font>
    <span class="hljs-string">"authorizer"</span> : null,
    <span class="hljs-string">"stage"</span> : <span class="hljs-string">"Prod"</span>,
    <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
    <span class="hljs-string">"protocol"</span> : null,
    <span class="hljs-string">"requestTime"</span> : null,
    <span class="hljs-string">"requestTimeEpoch"</span> : 0,
    <span class="hljs-string">"elb"</span> : null<font></font>
  },<font></font>
  <span class="hljs-string">"multiValueQueryStringParameters"</span> : null,
  <span class="hljs-string">"multiValueHeaders"</span> : {
    <span class="hljs-string">"Accept"</span> : [ <span class="hljs-string">"application/json"</span> ],
    <span class="hljs-string">"Accept-Encoding"</span> : [ <span class="hljs-string">"gzip, deflate, br"</span> ],
    <span class="hljs-string">"Accept-Language"</span> : [ <span class="hljs-string">"ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7"</span> ],
    <span class="hljs-string">"Cache-Control"</span> : [ <span class="hljs-string">"no-cache"</span> ],
    <span class="hljs-string">"Connection"</span> : [ <span class="hljs-string">"keep-alive"</span> ],
    <span class="hljs-string">"Content-Length"</span> : [ <span class="hljs-string">"150"</span> ],
    <span class="hljs-string">"Content-Type"</span> : [ <span class="hljs-string">"text/plain;charset=UTF-8"</span> ],
    <span class="hljs-string">"Host"</span> : [ <span class="hljs-string">"127.0.0.1:3000"</span> ],
    <span class="hljs-string">"Origin"</span> : [ <span class="hljs-string">"chrome-extension://fhbjgbiflinjbdggehcddcbncdddomop"</span> ],
    <span class="hljs-string">"Postman-Token"</span> : [ <span class="hljs-string">"5cadaccd-6fae-5bc2-b4ef-63900a1725ff"</span> ],
    <span class="hljs-string">"Sec-Fetch-Mode"</span> : [ <span class="hljs-string">"cors"</span> ],
    <span class="hljs-string">"Sec-Fetch-Site"</span> : [ <span class="hljs-string">"cross-site"</span> ],
    <span class="hljs-string">"User-Agent"</span> : [ <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36"</span> ],
    <span class="hljs-string">"X-Forwarded-Port"</span> : [ <span class="hljs-string">"3000"</span> ],
    <span class="hljs-string">"X-Forwarded-Proto"</span> : [ <span class="hljs-string">"http"</span> ],
    <span class="hljs-string">"X-Warm-Up"</span> : [ <span class="hljs-string">"123"</span> ]<font></font>
  },<font></font>
  <span class="hljs-string">"pathParameters"</span> : null,
  <span class="hljs-string">"httpMethod"</span> : <span class="hljs-string">"POST"</span>,
  <span class="hljs-string">"stageVariables"</span> : null,
  <span class="hljs-string">"path"</span> : <span class="hljs-string">"/contact"</span>,
  <span class="hljs-string">"isBase64Encoded"</span> : <span class="hljs-literal">false</span>,
  <span class="hljs-string">"requestSource"</span> : <span class="hljs-string">"API_GATEWAY"</span><font></font>
}<font></font>
2020-01-06 19:28:09 27868750-3637-1f80-3d80-53a724da16ef INFO  App - Lambda was warmed up<font></font>
?[32mEND RequestId: 27868750-3637-1f80-3d80-53a724da16ef?[0m<font></font>
?[32mREPORT RequestId: 27868750-3637-1f80-3d80-53a724da16ef     Init Duration: 1951.87 ms       Duration: 42.91 ms      Billed Duration: 100 ms Memory Size: 256 MB     Max Memory Used: 102 MB ?[0m<font></font>
2020-01-06 22:28:11 127.0.0.1 - - [06/Jan/2020 22:28:11] <span class="hljs-string">"POST /contact HTTP/1.1"</span> 201 -
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“ç„¶ï¼Œæ—¥å¿—å¹¶ä¸æ˜¯ä»¥æœ€ä½³æ–¹å¼æ ¼å¼åŒ–çš„ã€‚</font><font style="vertical-align: inherit;">å¸Œæœ›å°†æ¥ä¼šè§£å†³æ­¤é—®é¢˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é‡è¦æç¤ºï¼šæ›´æ”¹lambdaä»£ç æ—¶ï¼Œæ— éœ€é‡æ–°å¯åŠ¨APIã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sam buildå‘½ä»¤</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡å»ºlambdaå°±è¶³å¤Ÿäº†</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³äºé”™è¯¯çš„ä¸€ç‚¹</font></font></b>
                        <div class="spoiler_text">        Java-  <i>aws-serverless-java-container-core</i>,    :       502 .    :<br>
<pre><code class="bash hljs">Invalid API Gateway Response Keys: {<span class="hljs-string">'base64Encoded'</span>} <span class="hljs-keyword">in</span> {<span class="hljs-string">'statusCode'</span>: 200, <span class="hljs-string">'headers'</span>: {<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/plain'</span>}, <span class="hljs-string">'body'</span>: <span class="hljs-string">'Hello World'</span>, <span class="hljs-string">'base64Encoded'</span>: False} 
</code></pre><br>
  - ,   API Gateway    AWS       JsonProperty.     <i>'isBase64Encoded'</i>   <i>'base64Encoded'</i>, , ,    .   ,       Java- ContactUsProxyResponse  AwsProxyRequest.<br>
</div>
                    </div><br>
<br>
<a name="Part3"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.æ¥è‡ªIDEAçš„æœ¬åœ°ç”µè¯</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šé¢æ®µè½ä¸­æè¿°çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯SAMå·¥å…·çš„åŠŸèƒ½ã€‚å®ƒæ˜¯ä»å‘½ä»¤è¡Œæ§åˆ¶çš„ï¼Œå¯ä»¥é›†æˆåˆ°ä»»ä½•ç•Œé¢ä¸­ã€‚è¿™æ­£æ˜¯IntelljIDEA AWS Toolkitæ’ä»¶ä¸­æ‰€åšçš„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤æ’ä»¶æ·»åŠ äº†ç”¨äºç›´æ¥ä»IDEå¯åŠ¨lambdaçš„å…¶ä»–é…ç½®ã€‚è¿™æ˜¯é…ç½®çª—å£çš„å¤–è§‚ã€‚</font><font style="vertical-align: inherit;">
æ‚¨å¿…é¡»é€‰æ‹©å¸¦æœ‰lambdaæè¿°çš„æ¨¡æ¿ï¼Œæˆ–è€…æ‰‹åŠ¨é…ç½®è®¾ç½®ã€‚</font><font style="vertical-align: inherit;">
åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå°†è‡ªåŠ¨ä»æ¨¡æ¿ä¸­è·å–ç”¨äºç¼–è¯‘çš„å†…å­˜å’Œè¯­è¨€é‡ã€‚åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥è‡ªå·±é…ç½®RAMçš„æ•°é‡ï¼Œå¹¶å¯¹é™åˆ¶è¿›è¡Œè¿‘ä¼¼è®¡ç®—ã€‚</font><font style="vertical-align: inherit;">
å¦ä¸€ä¸ªæ’ä»¶ä½¿æ‚¨å¯ä»¥ç›´æ¥ä»Javaä»£ç ç¼–è¾‘å™¨æˆ–yaml-templateçš„çª—å£ä¸­è¿è¡Œé…ç½®ã€‚å±å¹•æˆªå›¾å¦‚ä¸‹ï¼š</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/2s/8u/xk/2s8uxk8n8gfza3p9z9ewugw-xge.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/8o/um/83/8oum83fe_tkz8suqmxzg-evjpaa.png"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/iw/ma/is/iwmais_steqx3sfhwstdxk7ncwa.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œä»…æ­¤è€Œå·²ã€‚</font><font style="vertical-align: inherit;">é€šè¿‡è¿è¡Œå®šåˆ¶çš„é…ç½®ï¼Œæ‚¨åªéœ€ä»æ§åˆ¶å°è‡ªåŠ¨æ‰§è¡Œé¢‘ç¹çš„lambdaè°ƒç”¨å³å¯ã€‚</font><font style="vertical-align: inherit;">åŒæ„ï¼Œå¾ˆèˆ’æœå—ï¼Ÿ</font></font><br>
<br>
<a name="Part4"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.æµ‹è¯•</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¨è®ºlambdaçš„æµ‹è¯•ç±»å‹ã€‚</font><font style="vertical-align: inherit;">ç”±äºæˆ‘åœ¨ç¤ºä¾‹ä¸­ä½¿ç”¨Javaï¼Œå› æ­¤æµ‹è¯•è¿˜å°†åŒ…æ‹¬ç”¨äºå•å…ƒå’Œé›†æˆæµ‹è¯•çš„ç›¸å½“æ ‡å‡†çš„å·¥å…·ï¼šJunit 4ï¼ŒMockitoå’ŒPowerMockitoã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å•å…ƒæµ‹è¯•</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ç”¨å•å…ƒæµ‹è¯•è¦†ç›–lambdaä»£ç ï¼Œæ‚¨ä¸éœ€è¦å…·æœ‰ç‰¹å®šçš„çŸ¥è¯†ã€‚</font><font style="vertical-align: inherit;">åº”ç”¨æ ‡å‡†çš„Javaåšæ³•å°±è¶³å¤Ÿäº†ï¼šé”å®šç±»ä¸­çš„æ‰€æœ‰ä¾èµ–é¡¹å¹¶å°è¯•æµ‹è¯•è¯·æ±‚å¤„ç†çš„æ‰€æœ‰å¯èƒ½æƒ…å†µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æ²¡æœ‰æ·»åŠ æ‰€æœ‰æµ‹è¯•åœºæ™¯ï¼Œè€Œå°†è‡ªå·±é™åˆ¶åœ¨ä¸¤ä¸ªç§¯æå’Œä¸¤ä¸ªæ¶ˆæçš„åœºæ™¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€ä¸ªé˜³æ€§æµ‹è¯•éªŒè¯æ˜¯å¦å­˜åœ¨X-WARM-UPæ ‡å¤´ï¼Œåˆ™DbServiceå’ŒEmailServiceä¸­æ²¡æœ‰è¯·æ±‚ã€‚</font><font style="vertical-align: inherit;">ç¬¬äºŒç§æƒ…å†µæ£€æŸ¥å¦‚æœè¯·æ±‚æ˜¯çœŸå®çš„ï¼Œåˆ™å°†è°ƒç”¨è¿™äº›æœåŠ¡ã€‚</font><font style="vertical-align: inherit;">è¿™äº›æ˜¯æœ€ç®€å•çš„æµ‹è¯•ï¼Œæˆ‘åœ¨å…¶ä¸­çœç•¥äº†éƒ¨åˆ†æ£€æŸ¥ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è´Ÿæ–¹æ¡ˆæ˜¯åœ¨å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å¤„ç†é”™è¯¯çš„æƒ…å†µä¸‹çš„å“åº”æ£€æŸ¥ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•´åˆæµ‹è¯•</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è‡³äºé›†æˆæµ‹è¯•ï¼Œæˆ‘å†³å®šæ£€æŸ¥DbServiceåŠå…¶ä¸DynamoDBè¡¨çš„é…åˆä½¿ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä½¿ç”¨äº†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Localstack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·¥å…·</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¯¥è§£å†³æ–¹æ¡ˆä¸ºä½œä¸ºdockerå®¹å™¨è¿è¡Œçš„AWSæœåŠ¡æä¾›äº†å…è´¹çš„mokasã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å®‰è£…æ­¤è§£å†³æ–¹æ¡ˆï¼Œåªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</font></font><br>
<pre><code class="bash hljs">pip install localstack<font></font>
localstack start<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker-composeæ–‡ä»¶</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docker-composeä»…å¼•å‘DynamoDB</font></font></b>
                        <div class="spoiler_text"><pre><code class="bash hljs">version: <span class="hljs-string">'2.1'</span><font></font>
services:<font></font>
  localstack:<font></font>
    container_name: <span class="hljs-string">"<span class="hljs-variable">${LOCALSTACK_DOCKER_NAME-localstack_main}</span>"</span><font></font>
    image: localstack/localstack<font></font>
    ports:<font></font>
      - <span class="hljs-string">"4567-4599:4567-4599"</span>
      - <span class="hljs-string">"<span class="hljs-variable">${PORT_WEB_UI-8080}</span>:<span class="hljs-variable">${PORT_WEB_UI-8080}</span>"</span><font></font>
    environment:<font></font>
      - SERVICES=dynamodb<font></font>
      - DEBUG=<span class="hljs-variable">${DEBUG- }</span>
      - DATA_DIR=<span class="hljs-variable">${DATA_DIR- }</span>
      - PORT_WEB_UI=<span class="hljs-variable">${PORT_WEB_UI- }</span>
      - LAMBDA_EXECUTOR=<span class="hljs-variable">${LAMBDA_EXECUTOR- }</span>
      - KINESIS_ERROR_PROBABILITY=<span class="hljs-variable">${KINESIS_ERROR_PROBABILITY- }</span><font></font>
      - DOCKER_HOST=unix:///var/run/docker.sock<font></font>
    volumes:<font></font>
      - <span class="hljs-string">"<span class="hljs-variable">${TMPDIR:-/tmp/localstack}</span>:/tmp/localstack"</span>
      - <span class="hljs-string">"/var/run/docker.sock:/var/run/docker.sock"</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
startå‘½ä»¤é»˜è®¤å¼•å‘æ‰€æœ‰å¯ç”¨çš„AWSæœåŠ¡ã€‚</font><font style="vertical-align: inherit;">è¦ä¸“é—¨æé«˜DynamoDBï¼Œåªéœ€è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</font></font><br>
<pre><code class="bash hljs"><span class="hljs-built_in">set</span> SERVICES=dynamodb
</code></pre><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Junit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æœ‰ä¸€ä¸ªç‰¹æ®Šçš„</font><i><font style="vertical-align: inherit;">LocalstackTestRunnerï¼Œ</font></i><font style="vertical-align: inherit;">å®ƒå…è®¸æ‚¨ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@LocalstackDockerProperties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®å¯åŠ¨å¿…è¦çš„æœåŠ¡</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œä¸ºDbServiceç¼–å†™æµ‹è¯•å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ æµ‹è¯•ç±»ã€‚ </font></font><br>
<pre><code class="java hljs"><span class="hljs-meta">@RunWith(LocalstackTestRunner.class)</span>
<span class="hljs-meta">@LocalstackDockerProperties(services = { "dynamodb" })</span>
</code></pre> <br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å»ºç«‹è¡¨æ ¼ </font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çˆªå“‡</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@Before</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span><span class="hljs-params">()</span> </span>{<font></font>
    AmazonDynamoDB clientDynamoDB = TestUtils.getClientDynamoDB();<font></font>
    dynamoDB = <span class="hljs-keyword">new</span> DynamoDB(clientDynamoDB);<font></font>
    dbService = <span class="hljs-keyword">new</span> DbService(dynamoDB);<font></font>
<font></font>
    dynamoDB.createTable(<font></font>
            <span class="hljs-keyword">new</span> CreateTableRequest()<font></font>
                    .withTableName(<span class="hljs-string">"ContactUsTable"</span>)<font></font>
                    .withKeySchema(<span class="hljs-keyword">new</span> KeySchemaElement(<span class="hljs-string">"Id"</span>, KeyType.HASH))<font></font>
                    .withAttributeDefinitions(<span class="hljs-keyword">new</span> AttributeDefinition(<span class="hljs-string">"Id"</span>, ScalarAttributeType.S))<font></font>
                    .withProvisionedThroughput(<span class="hljs-keyword">new</span> ProvisionedThroughput(<span class="hljs-number">10L</span>, <span class="hljs-number">10L</span>)));<font></font>
}<font></font>
                </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æè¿°æµ‹è¯•åœºæ™¯</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çˆªå“‡</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-comment">// given</span>
ContactUsRequest contactUsRequest = <span class="hljs-keyword">new</span> ContactUsRequest(<span class="hljs-string">"subject"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"+79991234545"</span>, <span class="hljs-string">"123@mail.ru"</span>, <span class="hljs-string">"Qeustion"</span>);<font></font>
<font></font>
<span class="hljs-comment">// when</span>
dbService.putContactUsRequest(<span class="hljs-string">"123"</span>, contactUsRequest);<font></font>
<font></font>
<span class="hljs-comment">// then</span>
Item item = dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).getItem(<span class="hljs-keyword">new</span> PrimaryKey(<span class="hljs-string">"Id"</span>, <span class="hljs-string">"123"</span>));<font></font>
assertEquals(contactUsRequest.getSubject(), item.get(<span class="hljs-string">"Subject"</span>));<font></font>
assertEquals(contactUsRequest.getUsername(), item.get(<span class="hljs-string">"Username"</span>));<font></font>
assertEquals(contactUsRequest.getPhone(), item.get(<span class="hljs-string">"Phone"</span>));<font></font>
assertEquals(contactUsRequest.getEmail(), item.get(<span class="hljs-string">"Email"</span>));<font></font>
assertEquals(contactUsRequest.getQuestion(), item.get(<span class="hljs-string">"Question"</span>));
              </code></pre><br>
 </div>
                    </div><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµ‹è¯•åä¸è¦å¿˜è®°åˆ é™¤è¡¨ã€‚</font></font><br>
 <div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çˆªå“‡</font></font></b>
                        <div class="spoiler_text"> <pre><code class="java hljs"><span class="hljs-meta">@After</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tearDown</span><span class="hljs-params">()</span> </span>{<font></font>
    dynamoDB.getTable(<span class="hljs-string">"ContactUsTable"</span>).delete();<font></font>
}<font></font>
               </code></pre><br>
 </div>
                    </div><br>
 </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œä½¿ç”¨Localstackï¼Œæˆ‘ä»¬è·å¾—äº†ç›¸å½“å¹¿æ³›çš„AWSæ¨¡æ‹Ÿï¼Œå¯è®©æ‚¨æ¨¡æ‹Ÿè¿™äº›æœåŠ¡çš„å·¥ä½œã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç«¯åˆ°ç«¯æµ‹è¯•</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ç©E2Eåœºæ™¯ï¼Œæœ€å¥½æœ‰æœºä¼šä¸“é—¨é’ˆå¯¹è¿è¡Œæµ‹è¯•æ¥æé«˜æµ‹è¯•AWSæœåŠ¡ã€‚</font><font style="vertical-align: inherit;">è¿™å¯ä»¥ä½¿ç”¨å¯é€‰çš„CloudFormationæ¨¡æ¿æ¥å®Œæˆï¼Œå…¶ä¸­èµ„æºå°†æ˜¯ä¸»æ¨¡æ¿çš„å‰¯æœ¬ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯ä»¥é€šè¿‡é€šè¿‡AWS-CLIè°ƒç”¨lambdaå¹¶ä½¿ç”¨ä»»ä½•å¯ç”¨å·¥å…·å¤„ç†ç»“æœæ¥å®Œæˆæµ‹è¯•ã€‚</font><font style="vertical-align: inherit;">æ‚¨ä»ç„¶å¯ä»¥åœ¨å•å…ƒæµ‹è¯•ä¸­æ‰“ç”µè¯ï¼Œä½†æ— éœ€åˆ›å»ºå°æ€ªã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€§èƒ½æµ‹è¯•</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºæ€§èƒ½æµ‹è¯•å€¼å¾—ä¸€æœ¬å•ç‹¬çš„æ–‡ç« ç”šè‡³ä¸€æœ¬ä¹¦ï¼Œå› æ­¤æˆ‘ä¸ä¼šå°è¯•å°†æ‰€æœ‰ä¿¡æ¯æ”¾åœ¨è¿™é‡Œã€‚</font><font style="vertical-align: inherit;">ç®€è€Œè¨€ä¹‹ï¼Œåœ¨è°ˆåˆ°å‹åŠ›æµ‹è¯•æ—¶ï¼Œæ‚¨éœ€è¦è®°ä½ï¼Œå‡ ä¹æ‰€æœ‰çš„AWSæœåŠ¡éƒ½ä¸æ˜¯å…è´¹çš„ï¼Œæ‚¨åº”è¯¥å‡†å¤‡æå‰ä¼°ç®—å¯èƒ½çš„æˆæœ¬ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœè¦è¯„ä¼°Lambdaçš„å¿…è¦èµ„æºï¼Œè¯·ä½¿ç”¨UIæ§åˆ¶å°å¹¶è¿›è¡Œä¸€äº›æµ‹è¯•è°ƒç”¨ã€‚</font><font style="vertical-align: inherit;">æ¥ä¸‹æ¥ï¼Œä½¿ç”¨æ™®é€šé€»è¾‘å’Œæ•°å­¦æ–¹æ³•ï¼Œæ ¹æ®å¯ç”¨èµ„æºçš„æ•°é‡æ¥è¯„ä¼°lambdaçš„æ€§èƒ½æé«˜å¤šå°‘ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸è¦å¿˜è®°CloudWatchã€‚</font><font style="vertical-align: inherit;">å€ŸåŠ©å®ƒçš„å¸®åŠ©ï¼Œæ‚¨å¯ä»¥æ„å»ºå…·æœ‰æŒ‡ç¤ºæ€§çš„ä»ªè¡¨æ¿ï¼Œå¹¶åŸºäºå®ƒä»¬æ¥ç¡®å®šå¯ä»¥è´Ÿæ‹…çš„lambdaå‚æ•°å’Œæ”¯å‡ºã€‚</font></font><br>
<br>
<a name="Part5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.æ— æœåŠ¡å™¨è§£å†³æ–¹æ¡ˆçš„æˆæœ¬</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è§£å†³æ–¹æ¡ˆçš„è¯„ä¼°å§‹ç»ˆæ˜¯ç‰¹å®šçš„ï¼Œå› ä¸ºæ‚¨ä¸ä»…éœ€è¦è€ƒè™‘ä¸€ä¸ªå‘¼å«çš„æˆæœ¬ï¼Œè€Œä¸”è¿˜è¦è€ƒè™‘ä¼ å…¥/ä¼ å‡ºæµé‡ï¼Œç¼“å­˜ï¼Œæ—¥å¿—è®°å½•å’Œç›‘è§†çš„æˆæœ¬ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨æ­£åœ¨è€ƒè™‘ä½¿ç”¨lambdaï¼Œè¯·å°è¯•é¢„æµ‹æœåŠ¡å°†å¤„ç†çš„è´Ÿè½½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœè¿™äº›æ˜¯å•æ¬¡è°ƒç”¨æˆ–æ¯éš”å‡ ä¸ªå°æ—¶/å¤©è¿è¡Œä¸€æ¬¡çš„ETLæµç¨‹ï¼Œåˆ™lambdaæ›´æœ‰å¯èƒ½è·å¾—å›æŠ¥ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨é¢„æµ‹æ¯ç§’æœ‰å‡ ä¸ªæŸ¥è¯¢çš„è´Ÿè½½ï¼Œè¯·ç¡®ä¿è¿›è¡Œå‡†ç¡®çš„ä¼°ç®—ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹é¢æˆ‘å¯¹lambdaå’Œæœ€ä¾¿å®œçš„EC2æœåŠ¡å™¨çš„æˆæœ¬è¿›è¡Œå¤§æ¦‚ä¼°ç®—ï¼Œä»¥ä¾¿æ‚¨äº†è§£æœ‰ä»€ä¹ˆé—®é¢˜ï¼š</font><font style="vertical-align: inherit;">
lambdaçš„ä»¥ä¸‹å‚æ•°ç”¨äºè®¡ç®—ï¼š</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/p_/0w/ij/p_0wij6j_z2xop6dbt185485llc.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº¤è´§æ—¶é—´ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 150æ¯«ç§’</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»·æ ¼ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0.00001667çš„1GB-s</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®°å¿†ä½“ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 256 MB</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºEC2 t2.nanoï¼š</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»·æ ¼ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯æœˆ4.75ç¾å…ƒ</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†…å­˜ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 512 MB</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vCPUï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å¤§è´Ÿè½½ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯æœˆ5ï¼…çš„CPU</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»è¿™é‡Œè·å–</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EC2è´Ÿè½½æ•°æ®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ï¼Œ</font></a><font style="vertical-align: inherit;">æ ¹æ®è¿™äº›è®¡ç®—ï¼ŒæŒ‡å®šçš„æœåŠ¡å™¨å¯ä»¥æ‰¿å—æ¯ç§’0.3ä¸ªè¯·æ±‚çš„æ’å®šè´Ÿè½½ã€‚éšç€è´Ÿè½½çš„å¢åŠ ï¼Œå“åº”æ—¶é—´å°†å¢åŠ ï¼Œè¿™å°†é™ä½è¯¥æœåŠ¡å™¨çš„æ•ˆç‡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰è¿™äº›è®¡ç®—éƒ½æ˜¯éå¸¸æŠ½è±¡çš„ï¼Œæ²¡æœ‰è€ƒè™‘å¾ˆå¤šå› ç´ ï¼šé¢„ä»˜æ¬¾æˆ–å¤§é‡è¯·æ±‚çš„æŠ˜æ‰£ï¼Œlambdaæ‰§è¡Œæ—¶é—´ç­‰ç­‰ã€‚ä½†æ˜¯ä»–ä»¬è¡¨æ˜ï¼Œæ¯ç§’è´Ÿè½½å°‘äº1ä¸ªè¯·æ±‚ï¼Œlambdaçš„æˆæœ¬ä½äºæœ€ä¾¿å®œçš„EC2æœåŠ¡å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœæ‚¨éœ€è¦ä¿ç•™å¤šä¸ªåº”ç”¨ç¨‹åºå‰¯æœ¬æˆ–å¼¹æ€§IPï¼Œè¯·ä¸è¦å¿˜è®°å°†ALBçš„ä»·æ ¼æ·»åŠ åˆ°EC2ä»·æ ¼ä¸­ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/wc/md/grwcmd0t5swk3uwf-shmglewttu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ç›¸åŒçš„å¾®æœåŠ¡ç›¸æ¯”ï¼Œæ— æœåŠ¡å™¨è§£å†³æ–¹æ¡ˆçš„æµ‹è¯•å’Œæœ¬åœ°å¼€å‘ä¸é‚£ä¹ˆå—æ¬¢è¿ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œè¶Šæ¥è¶Šå¤šçš„äººç ”ç©¶å’Œåº”ç”¨è¿™äº›æŠ€æœ¯ï¼Œå¹¶ä¸ºå„ç§å¼€æºäº§å“æä¾›äº†å˜å¾—æ›´å¥½ï¼Œæ›´é«˜æ•ˆçš„æœºä¼šã€‚</font><font style="vertical-align: inherit;">è¿™æ ·çš„è§£å†³æ–¹æ¡ˆæå¤§åœ°ç®€åŒ–äº†éœ€è¦å°½å¿«å‘å¸ƒäº§å“è€Œä¸å¿…é…ç½®æ•´ä¸ªåŸºç¡€æ¶æ„çš„å…¬å¸çš„ç”Ÿå‘½ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå³ä½¿åœ¨å·²ç»å¼€å‘çš„äº§å“ä¸­ï¼Œæˆ‘è®¤ä¸ºä¹Ÿå­˜åœ¨æ— æœåŠ¡å™¨æ•°æ®åº“æˆ–lambdaçš„åœ°æ–¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å¹¶æ²¡æœ‰å£°ç§°è‡ªå·±æ˜¯æ— æœåŠ¡å™¨è§£å†³æ–¹æ¡ˆæµ‹è¯•é¢†åŸŸçš„ä¸“å®¶ï¼Œä½†æ˜¯ï¼Œæ ¹æ®æˆ‘ä¸ªäººçš„ç§¯æç»éªŒï¼Œæˆ‘å†³å®šé‡ç‚¹ä»‹ç»æœ¬æ–‡çš„è¦ç‚¹ã€‚</font><font style="vertical-align: inherit;">æˆ‘å¸Œæœ›å®ƒä»¬å¯¹æŸäººæœ‰ç”¨ï¼Œä¹Ÿè®¸ä½ ä»¬ä¸­çš„ä¸€äº›äººå¯ä»¥è¡¥å……ç”šè‡³çº æ­£æˆ‘ï¼Œå¯¹æ­¤æˆ‘å°†éå¸¸é«˜å…´ã€‚</font></font><br>
<br>
<a name="Part6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ç”¨çš„é“¾æ¥</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambdaå®é™…åº”ç”¨ã€‚</font><font style="vertical-align: inherit;">ç¬¬1éƒ¨åˆ†</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  GitHub</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Localstack Git </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> docker-compose   Localstack</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   EC2  AWS Lambda</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> SAM-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> AWS-CLI</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> SAM-</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   AWS Lambda</a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496742/index.html">å…³äºåœ¨çº¿æ•™è‚²æœåŠ¡ç³»ç»Ÿä¸­çš„å°å·å’Œå¦“å¥³é—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN496744/index.html">é¢å¯¹å¸‚åœºä¸‹è·Œï¼Œå¦‚ä½•èŠ‚çœèµ„é‡‘ç”šè‡³èµšé’±ï¼šç»“æ„æ€§äº§å“</a></li>
<li><a href="../zh-CN496750/index.html">åˆ†å±‚æˆ–å¦‚ä½•å­¦ä¹ ä¿¡ä»»æ•°æ®</a></li>
<li><a href="../zh-CN496752/index.html">åŸƒåšæ‹‰ç—…æ¯’å¦‚ä½•æ•™ä¼šæˆ‘ä»¬å¦‚ä½•å¤„ç†æ„ŸæŸ“æ•°æ®ï¼Œè€Œæˆ‘ä»¬å¿˜è®°äº†ä»–çš„æ‰€æœ‰æ•™è®­</a></li>
<li><a href="../zh-CN496754/index.html">æ¥è‡ªä¸–ç•Œå¼€æ”¾åœ°å›¾506å·çš„æ–°é—»ï¼ˆ03.24.2020-30.03.2020ï¼‰</a></li>
<li><a href="../zh-CN496758/index.html">æ•°å­—ä¸­ä¸–çºªåŒ»ç–—ä¿å¥ã€‚COVID-19ä¹‹åçš„å…¨çƒæŠ€æœ¯è½¬å‹</a></li>
<li><a href="../zh-CN496760/index.html">ç”¨æˆ·æµç¨‹ï¼šå¦‚ä½•åˆ›å»ºæµè¡Œçš„åº”ç”¨ç¨‹åºå’Œç½‘ç«™</a></li>
<li><a href="../zh-CN496762/index.html">åŸºäºç²’å­çš„è¡¨é¢ä¾µèš€æ¨¡æ‹Ÿ</a></li>
<li><a href="../zh-CN496764/index.html">å°è€Œè‡ªè±ªï¼šDuckDuckGoä¸å¹¿å‘Šæ€ªå…½</a></li>
<li><a href="../zh-CN496766/index.html">ä»€ä¹ˆæ˜¯Azure Stack HCIåŠå…¶å·¥ä½œæ–¹å¼</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>