<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ—‚ï¸ ğŸ—¯ï¸ ğŸ”” å¸¦æœ‰å¸¸è§„æ ‡å¿—çš„ç¡¬æ°”åŠŸæˆ–ä¸ºä»€ä¹ˆéœ€è¦å‡ ä½•ç”Ÿæˆå™¨ âœ¡ï¸ â™»ï¸ ğŸ‘¨ğŸ¾â€ğŸ“</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å®¢æˆ·å¯¹åœ°å›¾ä¸Šç¬¦å·çš„è¦æ±‚å¯¹æ‚¨æ¥è¯´ä¼¼ä¹ä¸åˆ‡å®é™…ï¼Ÿæ­¤å¤–ï¼Œæ‚¨è¿˜å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨å‡ ä½•ç”Ÿæˆå™¨ï¼ŒQGISå’ŒPythonä½¿æ‚¨çš„æŠ¤å‘ç´ æˆä¸ºæœ€ä½³æŠ¤å‘ç´ ã€‚
 ä»‹ç»
 

 ! , , , , , QGIS Python PyQt. , , () . QGIS , geometry generator â€” . . , .
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>å¸¦æœ‰å¸¸è§„æ ‡å¿—çš„ç¡¬æ°”åŠŸæˆ–ä¸ºä»€ä¹ˆéœ€è¦å‡ ä½•ç”Ÿæˆå™¨</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504986/"><p><img src="https://habrastorage.org/getpro/habr/post_images/070/b4a/b4d/070b4ab4d68fa8fa7238acdc2d7567a0.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®¢æˆ·å¯¹åœ°å›¾ä¸Šç¬¦å·çš„è¦æ±‚å¯¹æ‚¨æ¥è¯´ä¼¼ä¹ä¸åˆ‡å®é™…ï¼Ÿ</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæ‚¨è¿˜å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨å‡ ä½•ç”Ÿæˆå™¨ï¼ŒQGISå’ŒPythonä½¿æ‚¨çš„æŠ¤å‘ç´ æˆä¸ºæœ€ä½³æŠ¤å‘ç´ ã€‚</font></font></p><a name="habracut"></a><br>
<h1 id="vvedenie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»‹ç»</font></font></h1><br>
<p> !   ,    ,    ,   , ,    QGIS  Python  PyQt.  ,   ,      ()      .           QGIS    ,    <strong>geometry generator</strong> â€”  .                 .             ,      .</p><br>
<h1 id="a-zachem-ono-nado">  Â«Â» ?</h1><br>
<p>QGIS     MVC      .   ,  .. ,   Model-Based  PyQt  .         ,    .    ,      .</p><br>
<p>       QGIS:</p><br>
<p><img src="https://habrastorage.org/webt/nz/m5/rs/nzm5rswhv7f0bo5b4ehqzlbzupk.png" alt="ç‚¹ï¼Œçº¿å’Œé¢çš„æ ·ä¾‹æ ·å¼"></p><br>
<p>      ?</p><br>
<p>     99%  . !     ,       (, ),       (, ),         ,     .</p><br>
<p>,       :</p><br>
<p><img src="https://habrastorage.org/webt/dg/ek/mw/dgekmwb9lbfg6yv8v9vfvzgkomu.png"></p><br>
<p>  Â«Â»       :</p><br>
<p><img src="https://habrastorage.org/webt/td/vp/_c/tdvp_cxxniah6msvxpaomoe1h7y.png" alt="â€œç‰™é½¿â€"></p><br>
<p>     .       ,     ,  ,  (       ).         QGIS  Python.</p><br>
<h2 id="liricheskoe-zamechanie"> </h2><br>
<p> , , -,    ,  <strong>,    ,         (!)         ,   ,   </strong>!        ,      .</p><br>
<h2 id="dopuscheniya"></h2><br>
<ul>
<li>     QGIS  3.10.6  Ubuntu 18.04.</li>
<li>   Â«Â»   UTM  37N,               . </li>
<li>    GitHub   .</li>
<li> Â«Â»     ,     .</li>
<li> , ,          ,   .</li>
</ul><br>
<h2 id="tipy-geometrii-geometry-generator">  geometry generator</h2><br>
<p>   â€”    .<br>
    ,   : /, /, /. ,  ,     ,     ,     .   :  ,  ,         .</p><br>
<h2 id="kak-gotovit"> Â«Â»?</h2><br>
<p> ,        ,    <strong></strong>  (expression),    .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Expressions</a>,    Python    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Expressions, Filtering and Calculating Values</a>.</p><br>
<p> , ,   .   â€”   ,   .       Python,       .       QGIS.      , a        .</p><br>
<p>      :      .  -     ,     .</p><br>
<p>     ,    ,      QGIS, ,  ,  ,    .&nbsp;.     .</p><br>
<h2 id="tochki-v-">  ...</h2><br>
<p>   ,         .</p><br>
<p>,     ( ,    ),   ,         ,           ,  ,  ,   :</p><br>
<p><img src="https://habrastorage.org/webt/nt/yi/zg/ntyizgzyexsp8syw3ep_a99zq58.png" alt="ä¸€ä¸ªå…·æœ‰ä¸åŒæ ·å¼çš„å¯¹è±¡ã€‚"></p><br>
<p>    : ,   ,   ; ,  ,         â€” ,  .      <strong>points</strong>.</p><br>
<p>      <code>geometry_n()</code>,        :</p><br>
<pre><code class="lua hljs">geometry_n($geometry, <span class="hljs-number">1</span>)</code></pre><br>
<p> <code>$geometry</code> â€”   ,       .</p><br>
<p>    ,      :</p><br>
<pre><code class="lua hljs"><span class="hljs-keyword">if</span>(<font></font>
    @geometry_part_num &gt; <span class="hljs-number">1</span>, <span class="hljs-comment">--     </span>
    geometry_n($geometry,  @geometry_part_num ), <span class="hljs-comment">--   </span><font></font>
    NULL<font></font>
)</code></pre><br>
<p>   , <code>if()</code>â€”  .   2  <code>@geometry_part_num</code>,    ,      (      <code>@</code>).      <code>NULL</code>            .    ,         ,  ,    .</p><br>
<p>    â€” ,       :</p><br>
<pre><code class="lua hljs"><span class="hljs-keyword">if</span>(<font></font>
    @geometry_part_num &gt; <span class="hljs-number">1</span>, <span class="hljs-comment">--       </span><font></font>
    with_variable(<font></font>
        <span class="hljs-string">'inputs'</span>,<font></font>
        array(<font></font>
            <span class="hljs-number">10000</span>, <span class="hljs-comment">--        </span>
            length( <span class="hljs-comment">--       </span><font></font>
                make_line(<font></font>
                    start_point($geometry),<font></font>
                    geometry_n($geometry, @geometry_part_num)<font></font>
                )<font></font>
            ),<font></font>
            azimuth( <span class="hljs-comment">--       </span><font></font>
                geometry_n($geometry, @geometry_part_num),<font></font>
                start_point($geometry)<font></font>
            )<font></font>
        ),<font></font>
        <span class="hljs-keyword">if</span>(<font></font>
            @inputs[<span class="hljs-number">0</span>] &lt; @inputs[<span class="hljs-number">1</span>], <span class="hljs-comment">--    </span><font></font>
            make_line(<font></font>
                geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span><font></font>
                project(<font></font>
                    geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span>
                    @inputs[<span class="hljs-number">1</span>] - @inputs[<span class="hljs-number">0</span>], <span class="hljs-comment">--  </span>
                    @inputs[<span class="hljs-number">2</span>] <span class="hljs-comment">-- </span><font></font>
                )<font></font>
            ),<font></font>
            NULL <span class="hljs-comment">--     ,   .</span><font></font>
        )<font></font>
    ),<font></font>
    NULL<font></font>
)</code></pre><br>
<p>   .   ,      ,    ,           <code>NULL</code>. </p><br>
<p>       â€”     .         ,        .         ,        .  ,             .</p><br>
<p>     <code>with_variable()</code>,      :  ,  , .     ,   -    ,     <code>with_variable</code>,    .     .</p><br>
<p>      â€”     <code>inputs</code>    <code>array()</code> â€”    0.    â€”    ,      .     â€”       ,        :</p><br>
<pre><code class="lua hljs">...<font></font>
length( <span class="hljs-comment">--       </span><font></font>
    make_line(<font></font>
        start_point($geometry),<font></font>
        geometry_n($geometry, @geometry_part_num)<font></font>
    )<font></font>
),<font></font>
azimuth( <span class="hljs-comment">--       </span><font></font>
    geometry_n($geometry, @geometry_part_num),<font></font>
    start_point($geometry)<font></font>
)<font></font>
...</code></pre><br>
<p>     <code>length()</code>,   ,   <code>make_line()</code>       â€” <code>start_point($geometry)</code>,   (    ).  <code>azimuth()</code>        ,    !</p><br>
<p>   ,   .    <code>if()</code>  ,          ,    .      <code>@inputs</code>    ,  ,  Â«Â»   <code>NULL</code>.</p><br>
<p>    :</p><br>
<pre><code class="lua hljs">...<font></font>
make_line(<font></font>
    geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--     </span><font></font>
    project(<font></font>
        geometry_n($geometry, @geometry_part_num), <span class="hljs-comment">--  </span>
        @inputs[<span class="hljs-number">1</span>] - @inputs[<span class="hljs-number">0</span>], <span class="hljs-comment">--  </span>
        @inputs[<span class="hljs-number">2</span>] <span class="hljs-comment">-- </span><font></font>
    )<font></font>
)<font></font>
...</code></pre><br>
<p>    <code>project()</code>,   ,         .      ,     .</p><br>
<h2 id="dopolnyaem-horoshee"> </h2><br>
<p>          ,      Klas Karlsson,  QGIS.     ,    ,  ,       ,  :</p><br>
<p><img src="https://habrastorage.org/webt/dh/qm/fp/dhqmfp-7oy2buplka-yktz80wto.png" alt="è·¯çº¿"></p><br>
<p>    ,   . ,      WKT    ,     ,      Â«||Â»,      .     ,   ,     .    :</p><br>
<ul>
<li>     ,         ;</li>
<li>   ,       .</li>
</ul><br>
<p> ( <strong>lines1</strong>).   ,      :</p><br>
<ul>
<li>     (           ).</li>
<li> .</li>
</ul><br>
<p>   :</p><br>
<pre><code class="lua hljs">collect_geometries(<font></font>
    array_foreach(<font></font>
        generate_series(<span class="hljs-number">1</span>, num_points($geometry)),<font></font>
        point_n($geometry, @element)<font></font>
    )<font></font>
)</code></pre><br>
<p> Â«Â» .        .      <code>generate_series()</code>,   ()   1  <code>num_points($geometry)</code>, .&nbsp;.      .         <code>array_foreach()</code>.  <code>array_foreach</code>  ,     <code>point_n($geometry, @element)</code>, .&nbsp;.     (<code>point_n()</code> â€”      ), <code>@element</code> â€”        .     ,        .         â€” ,   <code>collect_geometries()</code>.       (  ).</p><br>
<p>  .         Â«/Â».    :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'minimal_length'</span>,  <span class="hljs-comment">--  ,     </span>
    <span class="hljs-number">7000.0</span>,<font></font>
    collect_geometries(  <span class="hljs-comment">--  </span><font></font>
        array_foreach(<font></font>
            generate_series(<span class="hljs-number">1</span>, num_points($geometry) - <span class="hljs-number">1</span>),  <span class="hljs-comment">--   </span><font></font>
            with_variable(<font></font>
                <span class="hljs-string">'inputs'</span>,<font></font>
                array(<font></font>
                    azimuth( <span class="hljs-comment">--      </span><font></font>
                        point_n($geometry, @element),<font></font>
                        point_n($geometry, @element + <span class="hljs-number">1</span>)<font></font>
                    ),<font></font>
                    length( <span class="hljs-comment">--      </span><font></font>
                        make_line(<font></font>
                            point_n($geometry, @element),<font></font>
                            point_n($geometry, @element + <span class="hljs-number">1</span>)<font></font>
                        )<font></font>
                    )<font></font>
                ),<font></font>
                <span class="hljs-keyword">if</span>(<font></font>
                    @inputs[<span class="hljs-number">1</span>] - @minimal_length * <span class="hljs-number">2</span> &gt; <span class="hljs-number">0</span>,  <span class="hljs-comment">-- .  </span>
                    line_substring( <span class="hljs-comment">--     </span><font></font>
                        make_line(<font></font>
                            point_n($geometry, @element),<font></font>
                            point_n($geometry, @element+<span class="hljs-number">1</span>)<font></font>
                        ),<font></font>
                        @minimal_length, @inputs[<span class="hljs-number">1</span>] - @minimal_length<font></font>
                    ),<font></font>
                    geom_from_wkt(<span class="hljs-string">'LINESTRING EMPTY'</span>) <span class="hljs-comment">--  </span><font></font>
                )<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>      ,    .                <code>@minimal_length</code>.       <code>collect_geometries</code>  ,     <code>array_foreach</code>     ,  .   ,    ,       <code>@inputs</code>:          .</p><br>
<p>   .     ,       <code>@minimal_length</code> (   ).     ,    ,     <strong>  </strong>:</p><br>
<pre><code class="lua hljs">geom_from_wkt(<span class="hljs-string">'LINESTRING EMPTY'</span>)</code></pre><br>
<p>,       ,       <code>NULL</code>,     .      ,     .       WKT  Â«LINESTRING EMPTYÂ»,    WKT    QGIS    <code>geom_from_wkt()</code>.</p><br>
<p>   .          <code>line_subtring()</code>,       .         ,                    .</p><br>
<h2 id="linii-v-poligony">  </h2><br>
<p>        ?       ,    ,  .     (.  <strong>lines2</strong>).</p><br>
<p>  ,     <code>buffer()</code>,     :    ,               1. ..    :</p><br>
<p><img src="https://habrastorage.org/webt/qx/md/_u/qxmd_uapra_v94as_8zwxp_lz6s.png"></p><br>
<p>       ,    .</p><br>
<p><img src="https://habrastorage.org/webt/iv/2c/ef/iv2cef47_pfu5aymfmjt192i8iy.png"></p><br>
<p> ,    ,   ,     .    ,     .           ,       .  :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'distance'</span>,
    <span class="hljs-number">4000</span>, <span class="hljs-comment">--  </span><font></font>
    with_variable(<font></font>
        <span class="hljs-string">'offset_lines'</span>, <span class="hljs-comment">--     </span><font></font>
        array(<font></font>
            extend(<font></font>
                offset_curve($geometry, @distance, join:=<span class="hljs-number">2</span>),<font></font>
                @distance, @distance<font></font>
            ),<font></font>
            extend(<font></font>
                offset_curve($geometry, -@distance, join:=<span class="hljs-number">2</span>),<font></font>
                @distance, @distance<font></font>
            )<font></font>
        ),<font></font>
        collect_geometries(<font></font>
            @offset_lines[<span class="hljs-number">0</span>], <span class="hljs-comment">--  1</span>
            @offset_lines[<span class="hljs-number">1</span>], <span class="hljs-comment">--  2</span>
            make_line( <span class="hljs-comment">--     1   2</span>
                start_point(@offset_lines[<span class="hljs-number">0</span>]),<font></font>
                start_point(@offset_lines[<span class="hljs-number">1</span>])<font></font>
            ),<font></font>
            make_line( <span class="hljs-comment">--     1   2</span>
                end_point(@offset_lines[<span class="hljs-number">0</span>]),<font></font>
                end_point(@offset_lines[<span class="hljs-number">1</span>])<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>,   <code>with_variable</code>, , ,    .    .   <code>@offset_lines</code>   ,  ,  (    <code>offset_curve()</code>),        <code>extend()</code>.      ,   â€”  <code>start_point()</code>    â€”  <code>end_point()</code>.</p><br>
<h2 id="pervyy--poshel-vtoroy--poshel"> â€” ,  â€” </h2><br>
<p>    ,      ,   .     (.  <strong>lines3</strong>).      ,    :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'lines'</span>,<font></font>
    segments_to_lines($geometry),<font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            generate_series(<span class="hljs-number">2</span>, num_geometries(@<span class="hljs-built_in">lines</span>), <span class="hljs-number">2</span>),<font></font>
            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p> <code>segments_to_lines()</code>    ,        â€”  ,  .      ,          <code>generate_series</code>.   :</p><br>
<p><img src="https://habrastorage.org/webt/vm/b_/ui/vmb_uiguoulfsqxf8kx6fxnhns4.png"></p><br>
<h2 id="krestiki"></h2><br>
<p>  .  ,         ( <strong>poly2</strong>).</p><br>
<p><img src="https://habrastorage.org/webt/eu/5a/mn/eu5amnxzyzgue-ji3ll3yt3ii6i.png"></p><br>
<p>       Â«/Â»   :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'points_num'</span>,
    <span class="hljs-comment">--     </span>
    num_points($geometry) - <span class="hljs-number">1</span>, <span class="hljs-comment">-- </span><font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            <span class="hljs-comment">--     </span>
            generate_series(<span class="hljs-number">1</span>, round(@points_num / <span class="hljs-number">2.0</span>)),<font></font>
            make_line(<font></font>
                point_n( <span class="hljs-comment">--  </span><font></font>
                    $geometry,<font></font>
                    @element<font></font>
                ), <font></font>
                point_n( <span class="hljs-comment">--  </span><font></font>
                    $geometry,<font></font>
                    @element + <span class="hljs-built_in">floor</span>(@points_num / <span class="hljs-number">2.0</span>)<font></font>
                )<font></font>
            )<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>    Â«Â»   ,   <code>generate_series()</code>        .        .</p><br>
<h2 id="zvezdochki"></h2><br>
<p> ,   ( <strong>poly3</strong>):<br>
<img src="https://habrastorage.org/webt/3n/uz/fy/3nuzfydrnxb84cymt1jjdhfvlsk.png"></p><br>
<p> :</p><br>
<pre><code class="lua hljs">collect_geometries(<font></font>
    array_foreach(<font></font>
        generate_series(<span class="hljs-number">1</span>, num_points($geometry) - <span class="hljs-number">1</span>),<font></font>
        make_line(<font></font>
            centroid($geometry),<font></font>
            point_n($geometry, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p> ,   <code>centroid()</code>,     ,        ,      .</p><br>
<h2 id="poligon-v-liniyu">  </h2><br>
<p>                 â€”  <strong>poly4</strong>.  ,     ,      Â«Â»,      . Â«Â»  â€”   , ,   <em></em>  ,  .     :</p><br>
<p><img src="https://habrastorage.org/webt/g6/e3/cs/g6e3cs0j0m-h-zhlshdcnm-dp5m.png"></p><br>
<p>     ,           , .&nbsp;.       .       ,  :</p><br>
<pre><code class="lua hljs">with_variable(
    <span class="hljs-string">'lines'</span>,<font></font>
    segments_to_lines($geometry), <span class="hljs-comment">--    </span><font></font>
    collect_geometries(<font></font>
        array_foreach(<font></font>
            segments_between_sides_nums( <span class="hljs-comment">--   Python</span><font></font>
                array_foreach(<font></font>
                    generate_series(<span class="hljs-number">1</span>, num_geometries(@<span class="hljs-built_in">lines</span>)),
                    <span class="hljs-comment">--   [ ,  ]</span><font></font>
                    array(<font></font>
                        @element,<font></font>
                        length(<font></font>
                            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
                        )<font></font>
                    )<font></font>
                )<font></font>
            ),<font></font>
            geometry_n(@<span class="hljs-built_in">lines</span>, @element)<font></font>
        )<font></font>
    )<font></font>
)</code></pre><br>
<p>   ,               .         ,   ,             .</p><br>
<p>        <code>segments_between_sides_num()</code>.      QGIS      Python ( <strong>custom.py</strong>     <strong>~/.local/share/QGIS/QGIS3/profiles/default/python/expressions</strong>):</p><br>
<pre><code class="python hljs"><span class="hljs-meta">@qgsfunction(args="auto", group="")</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">segments_between_sides_nums</span>(<span class="hljs-params">sides, feature, parent</span>):</span>
    <span class="hljs-string">"""
            
    .
    sides -     ( ,  )
    """</span>
    sorted_sides = sorted(sides, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">return</span> list(range(int(sorted_sides[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) + <span class="hljs-number">1</span>, int(sorted_sides[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])))</code></pre><br>
<p>   Python         , ..    (   ),       .</p><br>
<p>    .  ,      Python?</p><br>
<h2 id="naivnyy-benchmarking"> </h2><br>
<p>   ,    :  QGIS     Python?        .   ,          .</p><br>
<p><strong> </strong></p><br>
<ul>
<li> <strong>test_poly</strong>  100000 ,        3  20.</li>
</ul><br>
<p>     <strong>create_poly_lyr.py</strong>,        (   ).</p><br>
<p><strong></strong></p><br>
<ul>
<li>      ,            ,      Â«<strong></strong>Â».      ,          (     ).</li>
</ul><br>
<p>    Python,       QGIS,         Python.   <strong>expression_benchmarking.py</strong>:</p><br>
<pre><code class="python hljs">EXPRESSION = <span class="hljs-string">"""
collect_geometries(
    array_foreach(
        generate_series(1, num_points($geometry)),
        make_line(
            centroid($geometry),
            point_n($geometry, @element)
        )
    )
)
"""</span><font></font>
â€¦<font></font>
<span class="hljs-keyword">for</span> counter, poly <span class="hljs-keyword">in</span> enumerate(lyr_polys.getFeatures()):<font></font>
    exp = QgsExpression(EXPRESSION)<font></font>
    context = QgsExpressionContext()<font></font>
    context.setFeature(poly)<font></font>
    star = exp.evaluate(context)</code></pre><br>
<p>  <strong>python_benchmarking.py</strong>:</p><br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> counter, poly <span class="hljs-keyword">in</span> enumerate(lyr_polys.getFeatures()):<font></font>
    centroid = QgsPoint(poly.geometry().centroid().asPoint())<font></font>
    star = QgsMultiLineString()<font></font>
    <span class="hljs-keyword">for</span> vertex <span class="hljs-keyword">in</span> poly.geometry().vertices():<font></font>
        line = QgsLineString(centroid, vertex)<font></font>
        star.addGeometry(line)</code></pre><br>
<p><strong></strong><br>
<img src="https://habrastorage.org/webt/bo/xe/f1/boxef1u9kphkummosqk_m2t6p-4.png"></p><br>
<p>      Python  <strong>5,3</strong> ,    <strong>23,16</strong> . Python       <strong>4,5</strong> .    , ,  ,    .</p><br>
<h3 id="interpretaciya-rezultatov"> </h3><br>
<p><strong> :</strong></p><br>
<ul>
<li> .   Â«Â»   ,  ,      Â«- 1Â»    ,   Python,    .</li>
<li>    QGIS, .&nbsp;.    ,       .</li>
</ul><br>
<p><strong> :</strong></p><br>
<ul>
<li>       Python.</li>
<li>   .</li>
</ul><br>
<p><strong> Python:</strong></p><br>
<ul>
<li>         .</li>
<li>  Python.</li>
</ul><br>
<p><strong> Python:</strong></p><br>
<ul>
<li>  () *.py   .</li>
<li>  Python    ,     .</li>
<li>    Python,     ,          (  Windows).</li>
</ul><br>
<p>   ,         QGIS       .  ,   ,  , ,       .          ,     Â«Â»    Python.</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>     ?  .</p><br>
<p> :     WGS84 (/),   â€” .     ,         ,          .          ,  . ,     :</p><br>
<p><img src="https://habrastorage.org/webt/h1/i6/jb/h1i6jbxfnnvxd3und1nlso-ajjm.png" alt="ç¼“å†²åº¦"></p><br>
<p>  : ,  ,    .       ,     .    <strong>poly3</strong>   Â«Â»   :</p><br>
<p><img src="https://habrastorage.org/webt/fb/ef/qr/fbefqrimeuzwhm3d5r3wn01gmri.png" alt="å­”å¤šè¾¹å½¢"></p><br>
<p>  ,    .</p><br>
<p>    ,          ,       /? ,        :</p><br>
<p><img src="https://habrastorage.org/webt/_j/dz/gl/_jdzglxcy8-9hhrx_i16hhjxequ.png" alt="å¹³è¡Œå­µåŒ–"></p><br>
<p>       Â«Â»     ,         ?   ,       ,  .</p><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Â«Â»</a>,     ?</p><br>
<p> ,      ,     .         ,     ,           .</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘ç”Ÿå™¨å‡ ä¹æä¾›äº†æ— é™çš„å¯èƒ½æ€§ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¯èƒ½æ€§ä»…å—æ€§èƒ½çš„é™åˆ¶ï¼Œå¹¶ä¸”æ˜¯åˆ›å»ºçœŸæ­£å¤æ‚çš„ä¼ ç»Ÿæ ‡ç‰Œçš„å¿…ä¸å¯å°‘çš„å·¥å…·ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« ä¼šæœ‰ç”¨ï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘å¤æ‚çš„æƒ…å†µã€‚</font><font style="vertical-align: inherit;">è°¢è°¢æ‚¨çš„å…³æ³¨ã€‚</font></font></p><br>
<h2 id="ssylki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚è€ƒæ–‡çŒ®</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ ä½•ç”Ÿæˆå™¨ç¬¦å·å›¾å±‚å¿«é€ŸæŒ‡å—</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸¦æœ‰é”¥å½¢çº¿çš„æ›´å¥½çš„æ²³æµé£æ ¼</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FOSS4G / QGISå‡ ä½•ç”Ÿæˆå™¨</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QGIS Geometry Generatorç¤ºä¾‹</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klas Karlssoné¢‘é“ï¼Œè§†é¢‘ç”Ÿæˆå™¨0010å’Œ0012</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®˜æ–¹è¡¨è¾¾æ–‡ä»¶</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQGISä¸­çš„æ­£å¼è¡¨è¾¾æ–‡æ¡£</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸¦æœ‰ç¤ºä¾‹çš„é¡¹ç›®çš„å­˜å‚¨åº“</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN504966/index.html">5ä¸ªäººæ•ˆèƒ½é™·é˜±</a></li>
<li><a href="../zh-CN504968/index.html">å¼€å‘äººå‘˜è™šæ‹Ÿæ´»åŠ¨</a></li>
<li><a href="../zh-CN504972/index.html">ä»Šå¤©åœ¨å“ªé‡Œåº”ç”¨å¤§æ•°æ®æŠ€æœ¯ï¼Ÿ</a></li>
<li><a href="../zh-CN504976/index.html">è¡Œäººvsè‡ªä¸»ç´§æ€¥åˆ¶åŠ¨ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN504980/index.html">ç®—æ³•ç³»ç»Ÿçš„å›½å®¶ç›‘ç£å®è·µï¼Œä»¥åŠ æ‹¿å¤§å’Œæ¬§ç›Ÿä¸ºä¾‹</a></li>
<li><a href="../zh-CN504988/index.html">åˆ†æå¸ˆè®¿è°ˆ-Skyeng B2Båˆ†æä¸»ç®¡äº§å“ç»ç†Denis Sobolev</a></li>
<li><a href="../zh-CN504996/index.html">BazarBackdoorï¼šä¼ä¸šç³»ç»Ÿçš„æ–°åˆ‡å…¥ç‚¹</a></li>
<li><a href="../zh-CN505016/index.html">å…è´¹æ•™è‚²è¯¾ç¨‹ï¼šç®¡ç†</a></li>
<li><a href="../zh-CN505018/index.html">ç¡’çš„å·¥ä½œåŸç†ï¼šç¬¬1-2é›†</a></li>
<li><a href="../zh-CN505024/index.html">YouTrackç°åœ¨å…·æœ‰çŸ¥è¯†åº“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>