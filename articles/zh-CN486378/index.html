<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥂 🌔 👍🏻 太阳能家庭服务器工作了15个月：正常运行时间为95.26％ 🈺 🏂🏿 👩🏾‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="第一台带有充电控制器的原型太阳能服务器。照片：solar.lowtechmagazine.com
 
 在2018年9月，来自《低科技》杂志的狂热者发起了一个“低科技”网络服务器项目。目标是降低功耗，以使单个太阳能电池板足以满足家用自托管服务器的需求。这并不容易，因为该站点应该一天24小时工作。让我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>太阳能家庭服务器工作了15个月：正常运行时间为95.26％</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dcmiran/blog/486378/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/eh/th/2d/ehth2dv7ykrf9lj6lrozxqzmdei.jpeg"></a><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一台带有充电控制器的原型太阳能服务器。</font><font style="vertical-align: inherit;">照片：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solar.lowtechmagazine.com</font></font></a></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
在2018年9月，来自</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">《低科技》</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杂志的狂热者</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">发起了一个“低科技”网络服务器项目</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">目标是降低功耗，以使单个太阳能电池板足以满足家用自托管服务器的需求。</font><font style="vertical-align: inherit;">这并不容易，因为该站点应该一天24小时工作。</font><font style="vertical-align: inherit;">让我们看看最终发生了什么。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以转到服务器</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solar.lowtechmagazine.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，检查当前功耗和电池电量。</font><font style="vertical-align: inherit;">该网站针对页面的最少请求数和最小流量进行了优化，因此它必须承受来自Habr的流量激增。</font><font style="vertical-align: inherit;">根据开发人员的计算，每位唯一访问者的能耗为0.021 Wh。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
黎明前不久，即2020年1月31日，他还剩下42％的电池电量。</font><font style="vertical-align: inherit;">当地时间8:04在巴塞罗那黎明，之后电流应从太阳能电池板流出。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/dt/c5/umdtc5ymatrymminfcex-rt8k-y.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">做什么的？</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
十年前，专家</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预测</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，互联网的发展有助于社会的“非物质化”，普遍的数字化，并因此减少了总体能源消耗。他们弄错了。实际上，Internet本身需要</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大量的能量</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且这些量还在不断增长。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IT公司已经发起了改用替代电源的计划，但是现在这是不可能的。所有数据中心的能耗比世界上所有太阳能和风能设备的能耗高三倍。更糟糕的是，生产和定期更换太阳能电池板和风车</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也需要能源</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，今天根本不可能放弃化石生物多样性（石油，天然气，铀）。但是这些储备在很长一段时间内还不够，因此我们不可避免地不得不考虑如何生活在可再生资源上。包括运行计算机基础设施在内的Web服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
《低科技杂志》</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">认为</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网页膨胀过快的问题。</font><font style="vertical-align: inherit;">据保守估计</font><font style="vertical-align: inherit;">，从2010年到2018年，平均页面大小</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从0.45 MB增加到1.7 MB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而移动网站</font><font style="vertical-align: inherit;">的平均页面大小</font><font style="vertical-align: inherit;">从0.15 MB增加到1.6 MB。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在提高</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">能效之前</font></a><font style="vertical-align: inherit;">增加流量</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（传输1兆字节信息所需的能量），这导致Internet的能耗不断增加。</font><font style="vertical-align: inherit;">越来越重的站点不仅增加了网络基础架构的负担，而且缩短了计算机和智能手机的“生命周期”，而这些生命周期通常不得不丢弃并进行更新，这也是一个</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常耗能的过程</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，增加负担是由生活方式本身造成的：人们几乎所有时间都花在Internet上，并且严重依赖各种Web服务。</font><font style="vertical-align: inherit;">很难想象没有云IT基础设施（社交网络，即时通讯程序，邮件等）的现代社会。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器和网站配置</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本文</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中详细描述了硬件配置和软件堆栈Web服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olimex Olinuxino A20 Lime 2单板计算机是</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为其低功耗和有用的附加功能，例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AXP209</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源管理</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">芯片</font></a><font style="vertical-align: inherit;">。它允许您从开发板和电池中请求有关当前电压和电流强度的统计信息。该芯片会自动在电池和DC连接器之间切换电源，在此处，电流从太阳能电池板流出。因此，有电池支持的服务器可以不间断地供电。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/cca/d9c/9b5/ccad9c9b5fc2e6fc310922253ed1c37a.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olimex Olinuxino A20青柠2</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初，选择容量为6600 mAh（约24 Wh）的锂聚合物电池作为电池，然后将酸铅电池置于84.4 Wh。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
操作系统从SD卡引导。</font><font style="vertical-align: inherit;">尽管操作系统占用的内存不超过1 GB，并且静态网站的内存约为30 MB，但从经济上考虑，没有理由购买小于Class 10 16 GB的卡。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器通过巴塞罗那的100 MB家庭连接和标准的消费者路由器连接到网络。</font><font style="vertical-align: inherit;">为其保留一个静态IP地址。</font><font style="vertical-align: inherit;">几乎每个人都可以在自己的公寓中建立这样的站点，您需要稍微更改防火墙设置以将端口转发到本地IP：</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP的端口80到80</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTPS的端口443至443</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSH的端口22到22</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于Debian发行版和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">SUNXI</font></a><font style="vertical-align: inherit;">内核的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armbian Stretch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
操作系统</font><font style="vertical-align: inherit;">，专为具有AllWinner芯片的单板卡而设计。</font><i><font color="gray"><font style="vertical-align: inherit;">一个50瓦的太阳能电池板用于Web服务器，一个10瓦的太阳能板用于照明作者公寓的客厅，</font></font></i><font style="vertical-align: inherit;"> 
静态站点由</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Pelican</font></a><font style="vertical-align: inherit;">系统</font><font style="vertical-align: inherit;">（Python网站生成器）生成。静态站点加载速度更快，并且不会给CPU造成负担，因此从能耗的角度来看，静态站点比动态生成的页面效率更高。请在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">此处</font></a><font style="vertical-align: inherit;">查看主题的源代码</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/603/eea/b83/603eeab833004b93a0258646f7623716.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"></font></font></i><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常重要的一点是图像压缩，因为如果没有这种优化，几乎不可能使网页小于1 MB。为了进行优化，决定将照片转换为灰度图像。例如，这是上个世纪</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">253 KB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的女性电话接线员在交换机上的照片</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hp/l3/lk/hpl3lkomognem_svsjd42i7bmty.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，优化后的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">36.5 KB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">灰度图像</font><font style="vertical-align: inherit;">具有三种颜色（黑色，白色，灰色）。由于视觉上的错觉，观看者似乎拥有三种以上的颜色。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ba6/cc2/5ec/ba6cc25ec6f908ba504405983f264072.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择半色调照片不仅是为了优化尺寸（解决方案相当可疑），也是出于美学考虑。这种旧的图像处理技术具有某些风格，因此该网站以一种独特的设计方式出现。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
经过优化后，《低端技术》杂志网站上的623个插图的大小从194.2 MB减少到21.3 MB，即89％。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有旧文章都被转换为Markdown，以便于撰写新文章以及通过</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行备份</font><font style="vertical-align: inherit;">。所有脚本和跟踪器以及徽标均已从站点中删除。客户端浏览器中使用默认字体。作为“徽标”-杂志的名称以大写字母显示，并带有左箭头：LOW←TECH MAGAZINE。只有16个字节而不是图片。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果发生停机，则组织“离线阅读”的可能性：将文本和图片导出到RSS feed。包括100％内容的缓存，包括HTML。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个优化是nginx中包含HTTP2设置，与HTTP / 1.1相比，它可以稍微减少流量并缩短页面加载时间。</font><font style="vertical-align: inherit;">该表比较了五个不同页面的结果。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">FP | </font><font style="vertical-align: inherit;">我们| </font><font style="vertical-align: inherit;">Hs | </font><font style="vertical-align: inherit;">Fw | </font><font style="vertical-align: inherit;">CW |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| ---------- | ------- | ------- | ------- | ------- | ------ -|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HTTP / 1.1 | </font><font style="vertical-align: inherit;">1.46秒| </font><font style="vertical-align: inherit;">1.87秒| </font><font style="vertical-align: inherit;">1.54秒| </font><font style="vertical-align: inherit;">1.86秒| </font><font style="vertical-align: inherit;">1.89秒|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HTTP2 | </font><font style="vertical-align: inherit;">1.30秒| </font><font style="vertical-align: inherit;">1.49秒| </font><font style="vertical-align: inherit;">1.54秒| </font><font style="vertical-align: inherit;">1.79秒| </font><font style="vertical-align: inherit;">1.55秒|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">图片| </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">21 | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">19 | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">储蓄| </font><font style="vertical-align: inherit;">11％| </font><font style="vertical-align: inherit;">21％| </font><font style="vertical-align: inherit;">0％| </font><font style="vertical-align: inherit;">4％| </font><font style="vertical-align: inherit;">18％|</font></font></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完整的nginx配置：</font></font><br>
<br>
<pre><code class="nginx hljs">root@solarserver:/var/log/nginx<span class="hljs-comment"># cat /etc/nginx/sites-enabled/solar.lowtechmagazine.com</span><font></font>
<font></font>
<span class="hljs-comment"># Expires map</span>
<span class="hljs-attribute">map</span> <span class="hljs-variable">$sent_http_content_type</span> <span class="hljs-variable">$expires</span> {
<span class="hljs-attribute">default</span> <span class="hljs-literal">off</span>;<font></font>
text/<span class="hljs-attribute">html</span> <span class="hljs-number">7d</span>;<font></font>
text/<span class="hljs-attribute">css</span> max;<font></font>
application/<span class="hljs-attribute">javascript</span> max;<font></font>
~image/ max;<font></font>
}<font></font>
<font></font>
<span class="hljs-section">server</span> {
<span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;
<span class="hljs-attribute">server_name</span> solar.lowtechmagazine.com;<font></font>
<font></font>
<span class="hljs-attribute">location</span> / {
<span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://<span class="hljs-variable">$server_name</span><span class="hljs-variable">$request_uri</span>;<font></font>
}<font></font>
}<font></font>
<font></font>
server{<font></font>
<span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;
<span class="hljs-attribute">server_name</span> solar.lowtechmagazine.com;<font></font>
<font></font>
<span class="hljs-attribute">charset</span> UTF-<span class="hljs-number">8</span>; <span class="hljs-comment">#improve page speed by sending the charset with the first response.</span><font></font>
<font></font>
<span class="hljs-attribute">location</span> / {
<span class="hljs-attribute">root</span> /var/www/html/;
<span class="hljs-attribute">index</span> index.html;
<span class="hljs-attribute">autoindex</span> <span class="hljs-literal">off</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment">#Caching (save html pages for 7 days, rest as long as possible, no caching on frontpage)</span>
<span class="hljs-attribute">expires</span> <span class="hljs-variable">$expires</span>;<font></font>
<font></font>
<span class="hljs-attribute">location</span> <span class="hljs-variable">@index</span> {
<span class="hljs-attribute">add_header</span> Last-Modified <span class="hljs-variable">$date_gmt</span>;
<span class="hljs-attribute">add_header</span> Cache-Control <span class="hljs-string">'no-cache, no-store'</span>;
<span class="hljs-attribute">etag</span> <span class="hljs-literal">off</span>;
<span class="hljs-attribute">expires</span> <span class="hljs-literal">off</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">#error_page 404 /404.html;</span><font></font>
<font></font>
<span class="hljs-comment"># redirect server error pages to the static page /50x.html</span>
<span class="hljs-comment">#error_page 500 502 503 504 /50x.html;</span>
<span class="hljs-comment">#location = /50x.html {</span>
<span class="hljs-comment"># root /var/www/;</span>
<span class="hljs-comment">#}</span><font></font>
<font></font>
<span class="hljs-comment">#Compression</span><font></font>
<font></font>
<span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
<span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">"msie6"</span>;
<span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
<span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;
<span class="hljs-attribute">gzip_buffers</span> <span class="hljs-number">16</span> <span class="hljs-number">8k</span>;
<span class="hljs-attribute">gzip_http_version</span> <span class="hljs-number">1</span>.<span class="hljs-number">1</span>;
<span class="hljs-attribute">gzip_types</span> text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;<font></font>
<font></font>
<font></font>
<span class="hljs-comment">#Caching (save html page for 7 days, rest as long as possible)</span>
<span class="hljs-attribute">expires</span> <span class="hljs-variable">$expires</span>;<font></font>
<font></font>
<span class="hljs-comment"># Logs</span>
<span class="hljs-attribute">access_log</span> /var/log/nginx/solar.lowtechmagazine.com_ssl.access.log;
<span class="hljs-attribute">error_log</span> /var/log/nginx/solar.lowtechmagazine.com_ssl.<span class="hljs-literal">error</span>.log;<font></font>
<font></font>
<span class="hljs-comment"># SSL Settings:</span>
<span class="hljs-attribute">ssl_certificate</span> /etc/letsencrypt/live/solar.lowtechmagazine.com/fullchain.pem;
<span class="hljs-attribute">ssl_certificate_key</span> /etc/letsencrypt/live/solar.lowtechmagazine.com/privkey.pem;<font></font>
<font></font>
<span class="hljs-comment"># Improve HTTPS performance with session resumption</span>
<span class="hljs-attribute">ssl_session_cache</span> shared:SSL:<span class="hljs-number">10m</span>;
<span class="hljs-attribute">ssl_session_timeout</span> <span class="hljs-number">5m</span>;<font></font>
<font></font>
<span class="hljs-comment"># Enable server-side protection against BEAST attacks</span>
<span class="hljs-attribute">ssl_prefer_server_ciphers</span> <span class="hljs-literal">on</span>;
<span class="hljs-attribute">ssl_ciphers</span> ECDH+AESGCM:ECDH+AES256:ECDH+AES128:DH+3DES:!ADH:!AECDH:!MD5;<font></font>
<font></font>
<span class="hljs-comment"># Disable SSLv3</span>
<span class="hljs-attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="hljs-number">1</span> TLSv1.<span class="hljs-number">2</span>;<font></font>
<font></font>
<span class="hljs-comment"># Lower the buffer size to increase TTFB</span>
<span class="hljs-attribute">ssl_buffer_size</span> <span class="hljs-number">4k</span>;<font></font>
<font></font>
<span class="hljs-comment"># Diffie-Hellman parameter for DHE ciphersuites</span>
<span class="hljs-comment"># $ sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 4096</span>
<span class="hljs-attribute">ssl_dhparam</span> /etc/ssl/certs/dhparam.pem;<font></font>
<font></font>
<span class="hljs-comment"># Enable HSTS (https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security)</span>
<span class="hljs-attribute">add_header</span> Strict-Transport-Security <span class="hljs-string">"max-age=63072000; includeSubdomains"</span>;<font></font>
<font></font>
<span class="hljs-comment"># Enable OCSP stapling (http://blog.mozilla.org/security/2013/07/29/ocsp-stapling-in-firefox)</span>
<span class="hljs-attribute">ssl_stapling</span> <span class="hljs-literal">on</span>;
<span class="hljs-attribute">ssl_stapling_verify</span> <span class="hljs-literal">on</span>;
<span class="hljs-attribute">ssl_trusted_certificate</span> /etc/letsencrypt/live/solar.lowtechmagazine.com/fullchain.pem;
<span class="hljs-attribute">resolver</span> <span class="hljs-number">87.98.175.85</span> <span class="hljs-number">193.183.98.66</span> valid=<span class="hljs-number">300s</span>;
<span class="hljs-attribute">resolver_timeout</span> <span class="hljs-number">5s</span>;<font></font>
}</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15个月的工作结果</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从2018年12月12日到2019年11月28日，服务器的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正常运行时间为95.26％</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这意味着由于天气恶劣，全年的停机时间为399小时。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果您不考虑最近两个月的时间，则开发人员写道，正常运行时间为98.2％，停机时间仅为152小时。过去两个月，由于软件更新导致功耗增加，正常运行时间已降至80％。每天晚上，该站点停机了几个小时。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据统计数据，该年（从2018年12月3日到2019年11月24日）的服务器功耗为9.53 kWh。由于电压转换和电池放电，在光伏系统中记录了重大损失。该太阳能控制器的年耗电量为18.10 kWh，这意味着系统效率约为50％。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/441/110/3a1/4411103a1f1e5471afafe13fe10dc66c.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简化方案。它没有显示12V至5V的电压转换器和电池安培小时表，</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
在研究期间，有865,000位唯一身份的访客访问了该站点。包括太阳能装置中的所有能量损失，每位唯一访问者的能量消耗为0.021 Wh。因此，一千瓦时产生的太阳能足以满足将近50,000位唯一身份访问者的需求。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在实验过程中，测试了不同尺寸的太阳能电池板。下表显示了使用不同尺寸的太阳能电池板时，要为不同容量的电池充电多长时间的计算。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/vw/qv/ckvwqvclfxmgjpw8kcpqm8wojmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一年中，Web服务器的平均功耗（包括所有能量损耗）为1.97瓦。计算结果表明，要在一年中最短的夜晚（6月21日8小时50分钟）晚上维护网站，则需要17.40瓦时的存储功率，而在最长的夜晚（12月21日14小时49分钟）则需要存储功率。 ，19 Wh</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_c/el/qi/_celqiqryiici5sqzanuis4gobc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于铅酸电池的放电量不应低于容量的一半，因此服务器需要60 Wh的电池才能在最佳的日光条件下（2×29.19 Wh）寿命最长。</font><font style="vertical-align: inherit;">在一年中的大部分时间里，该系统都使用86.4 Wh / h电池和50瓦太阳能电池板工作，然后实现了上述95-98％的正常运行时间。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正常运行时间100％</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于正常运行时间，100％需要增加电池容量。为了补偿一天的恶劣天气（没有大量发电），您需要47.28瓦时（24小时×1.97瓦）的存储。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从2019年12月1日到2020年1月12日，系统中安装了168瓦电池，实际存储容量为84瓦时。此存储足以将站点维护两晚零一天。该配置在一年中最黑暗的时期进行了测试，但天气相对良好-在此期间，正常运行时间为100％。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，为了保证几年内100％的正常运行时间，有必要预见最坏的情况，即恶劣天气持续数天。计算结果表明：为了使网站保持低能耗或零能耗的状态持续四天，您将需要容量为440瓦时的铅酸电池，即汽车电池的大小。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，在天气良好的情况下，三月至九月的夜晚将为服务器提供48 Wh铅酸电池。 24 Wh电池将使服务器最多保持6个小时的时间，也就是说，它将每天晚上关闭，尽管在不同的时间（取决于月份）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据《低科技》杂志的报道，总的来说，有些网站不需要在夜间访问，因为访客数量很少。例如，如果是地区性城市出版物，则其他时区的访问者不会去，而只有本地居民才去。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也就是说，对于交通流量和正常运行时间不同的站点，需要使用不同容量的电池和不同尺寸的太阳能电池板。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nr/4w/ad/nr4wad7udwyrcx3wtawthytkzjy.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/is/fg/bc/isfgbcit1chetwg-8fe_ymodglq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作者计算出</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生产</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">太阳能电池板本身</font><font style="vertical-align: inherit;">需要多少能量</font><font style="vertical-align: inherit;">（实际能量），如果将其除以预期的10年使用寿命，则可以获取多少能量。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0e/aa/i4/0eaai4fbjyx-j0jm4szb6uxy8t8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，可以计算化石燃料的类似物，该化石燃料用于板的生产和操作。</font><font style="vertical-align: inherit;">在Low-tech Magazine上，事实证明，在运行的第一年，他们的系统（50 W面板，86.4 Wh电池）“产生”了约9千克的排放物或相当于燃烧3升汽油的量：与乘用车时的排放量大致相同，为50公里的进度。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a0/kb/qn/a0kbqn9ctp-qa99mgs9sdznp7sq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果服务器不是由太阳能电池板供电，而是由通用电网供电，则等效排放量似乎要低六倍：1.54千克（替代能源和核电站在西班牙能源中所占的比例很高）。</font><font style="vertical-align: inherit;">作者写道，但这并不是一个完全正确的比较，因为它考虑了太阳能基础设施的已实施能源，但没有考虑到整个能源网络的指标，即其建设和支持的成本。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进一步改进</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在过去的时间里，已经进行了许多优化，这些优化降低了服务器的功耗。例如，在某个时候，开发人员注意到RSS提要的一种不正确实现产生了11.15 TB的总流量中的6.63 TB，这每隔几分钟就会提取一次内容。修复此错误后，服务器的功耗（不包括能量损失）从1.14瓦降至约0.95瓦。增益看似很小，但0.19瓦的差异意味着每天4.56瓦时，相当于超过2.5个小时的电池寿命。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第一年，效率仅为50％。在对电池充电和放电（22％）以及将电压从12 V（太阳能光伏系统）转换为5 V（USB）时观察到损耗，其中损耗高达28％。开发人员承认他没有最佳的电压转换器（不带内置USB的控制器），因此您可以优化这一时刻或切换到5V太阳能装置。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了提高能量存储效率，可以用更便宜的锂离子电池代替铅酸电池，因为锂离子电池的充电/放电损耗较小（&lt;10％）。现在，设计者正在考虑一种紧凑的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统，以压缩空气的形式存储电能</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（CAES），具有十年的使用寿命，这意味着更少的碳足迹。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/0e6/bf0/fe7/0e6bf0fe70967f6ecb67ae11b3b1eaab.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">压缩空气中的紧凑型蓄能器，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来源</font></font></a></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
我们正在考虑安装额外的风力涡轮机（可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由木头制成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并安装太阳能跟踪器以将太阳能电池板转向太阳。追踪器可让您将发电量提高30％。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/d_/ua/ya/d_uayatij5brhpt1wnilp1pqnti.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提高系统效率的另一种方法是扩展系统规模。在服务器上增加更多网站并运行更多服务器。这样，每个站点的能源消耗将减少。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kq/zt/46/kqzt46ilxzjajy0calw5n3k7r00.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">太阳能托管公司。插图：Diego Marmolejo</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您用太阳能电池板覆盖公寓的整个阳台并开设一家太阳能网络托管公司，那么每个客户的成本将大大低于单个网站：规模经济。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
总的来说，该实验表明，在一定的限制下，计算机基础设施可能会很好地适用于可再生能源。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从理论上讲，如果您在世界其他地方进行镜像，则这样的服务器甚至可以不用电池。</font><font style="vertical-align: inherit;">例如，在新西兰和智利放置镜子。</font><font style="vertical-align: inherit;">晚上在巴塞罗那，那里的太阳能电池板将工作。</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN486360/index.html">如何通过15个简单的步骤从摩卡咖啡迁移到玩笑-以及为什么</a></li>
<li><a href="../zh-CN486362/index.html">在Product Univercity Moreynis和Chernyak接受培训后，我如何没有成为产品经理</a></li>
<li><a href="../zh-CN486368/index.html">〜SMAK〜-使用MicroPython上的asyncio库的智能家居可编程控制器</a></li>
<li><a href="../zh-CN486372/index.html">捷克程序员免费编写了一个价值1600万欧元的网站吗？真相？</a></li>
<li><a href="../zh-CN486376/index.html">关卡设计师如何使用架构理论来创建游戏关卡</a></li>
<li><a href="../zh-CN486380/index.html">产品经理应实际做什么</a></li>
<li><a href="../zh-CN486382/index.html">海豹和Scrum</a></li>
<li><a href="../zh-CN486388/index.html">MyVPN开源非营利项目概述</a></li>
<li><a href="../zh-CN486390/index.html">赖特在阴影中</a></li>
<li><a href="../zh-CN486392/index.html">SDS架构的简要比较或找到合适的存储平台（GlusterVsCephVsVirtuozzoStorage）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>