<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✴️ 🎍 ↕️ Xbox 360の保護とハッキング（パート3） ⛄️ 🏇🏿 👩‍👩‍👧‍👧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Xbox 360ゲームコンソールのリリースから6年後の2011年に、研究者たちは興味深い事実を発見しました。信号「0」が中央プロセッサのRESET出力に非常に短時間送信された場合、プロセッサは（本来の状態で）状態をリセットしませんが、代わりにあなたの行動を変えてください！この「機能」に基づいて、Re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Xbox 360の保護とハッキング（パート3）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500246/"><img src="https://habrastorage.org/webt/ly/33/lc/ly33lcab4l10ezi7uwxcjouyzw8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xbox 360ゲームコンソールのリリースから6年後の2011年に、研究者たちは興味深い事実を発見しました。信号「0」が中央プロセッサのRESET出力に非常に短時間送信された場合、プロセッサは（本来の状態で）状態をリセットしませんが、代わりにあなたの行動を変えてください！</font><font style="vertical-align: inherit;">この「機能」に基づいて、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset Glitch Hack（RGH）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が開発されました</font><font style="vertical-align: inherit;">。これにより、Xbox 360の保護を完全に危険にさらし、署名されていないコードを実行し、システム自体をハッキングし、「壊れない」</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DG-16D5Sドライブ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を打ち負かすことができました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RGHがどのように機能したか、開発者がどのように穴にパッチを当てたか、そしてこれらのパッチがどのように回避できたかを詳しく見てみましょう！</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチ攻撃とは何ですか？</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マーケティング担当者が何を言っても、プロセッサーはかなり馬鹿げています。</font><font style="vertical-align: inherit;">プログラマーによって記述されたすべての高水準コードは、単純なコマンドの実行（数値を含む算術演算、データの移動、条件付きおよび無条件ジャンプ）に削減されます。</font><font style="vertical-align: inherit;">プロセッサは常にこれらのコマンドをエラーなしで実行し、結果はドキュメントと一致すると想定されています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/ae/ik/aeaeiktfaf_phbyprnjmqmwu0y4.png"></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確かに、コードをコンパイルする</font></font><br>
<pre><code class="cpp hljs">i = i + <span class="hljs-number">2</span>;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数iの値が正確に2増加するという事実に依存します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
グリッチ攻撃はこの信頼に違反します。彼らの目標は、プロセッサが「バギー」であり、正しく動作しないことを確認することです。</font><font style="vertical-align: inherit;">プロセッサを「グリッチ」する方法はいくつかあります。たとえば、</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPU電圧を引き下げる</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPUの基準周波数に追加の衝動を与えるには</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーセント放射線の「輝き」</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような攻撃を実行するための特別なデバイスがあります。たとえば、ChipWhispererは、周波数とパワーにおいて幅広い攻撃を提供します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/uy/bu/ycuybuxustoyjxpu590edtbyjz0.jpeg" width="550"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xbox 360の場合、RESETラインへの露出の結果として「グリッチ」が発生します。</font><font style="vertical-align: inherit;">プロセッサはリセット手順を開始しますが、信号の持続時間が非常に短いため、信号を完了する時間がないため、何も起こらなかったかのように動作し続けます。</font><font style="vertical-align: inherit;">しかし、この短い時間だけ、RESET信号がアクティブである間、その動作は変化します！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グリッチプロセッサ</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360の保護は、チェーン内でお互いをチェックするブートローダーに依存しています。最終的に、各段階での検証は、ハッシュ和を「パターン」と比較する関数を呼び出すことになります。その後、グリッチアタックを適用して、プロセッサに不一致を無視させました。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロシージャを呼び出した直後のRESET行へのインパルス</font><font style="vertical-align: inherit;">は、ハッシュ合計が正しくない場合でも、プロセッサを強制的に別のブランチに沿って移動させ、ロードを続行します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/8a/i7/e68ai7t_wy0-har4u49gddcfwh4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃に最適な場所は、第2ステージのブートローダー「CB」にありました。</font><font style="vertical-align: inherit;">後の段階は攻撃が難しく（修正も簡単）ですが、ロードの最初の段階（「1BL」、ROM）では、プログラムコードの構成がわずかに異なるため、攻撃は失敗しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単に聞こえますが、実際、攻撃を実行しようとすると、多くのニュアンスが発見されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、グリッチアタックを正常に実行するには、RESETパルスを適用する必要がある時点を非常に正確に決定する必要があります。</font><font style="vertical-align: inherit;">少なくとも1マイクロ秒間間違えた場合、短すぎるまたは長すぎるインパルスを送信すると、攻撃は機能しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸い、Xbox 360では、各ブートステップで</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">POST_OUT</font></a><font style="vertical-align: inherit;">デバッグバスの値が変更されます</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さらに、デバッグ出力は頻繁に調整されるため、ハッシュ合計を比較する直前に新しいPOST値が設定されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/o_/pz/hn/o_pzhn6nqueomzmzvlv2vkkfazw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、攻撃サイトからのデバッグ出力の場所を閉じることは、非常に便利なトリガーでした。</font><font style="vertical-align: inherit;">POST_OUTはパラレルバスであり、プリント基板上の8つのテストサイトに出力されます。各テストサイトは、値のビットの1つを担当します。</font><font style="vertical-align: inherit;">システムが起動してからの1ビットのみを使用して、その状態の変化の数を数えることで、接続スキームを簡略化することもできました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ci/zg/qm/cizgqmpbnxyy2jnhoy5fmqovkde.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、プロセッサの周波数が高いため、正確さと継続時間に関して適切なタイミングに到達することはほぼ不可能であることが判明しました。</font><font style="vertical-align: inherit;">露出時間は、プロセッサによる1つの命令の実行時間のオーダーで、非常に短くする必要があります。</font><font style="vertical-align: inherit;">ただし、プロセッサの実行速度が遅いほど、時間間隔が長くなります。</font><font style="vertical-align: inherit;">したがって、プロセッサを取り、速度を落とします！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常のPCでは、CPU周波数は外部の「基準」周波数と乗数の積として定義されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5h/vb/oo/5hvbooyj4elvow6nxit04kc4ypk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、Xbox 360では、基準周波数の外部ラインがプロセッサに適しており、この周波数の内部が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によって乗算され</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">また、セットトップボックスの古い「シック」リビジョンでは、PLLメカニズムをオフにして、プロセッサを128倍も遅くすることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/4w/yt/sp4wytmvkymnu5geqbdp0jwgtag.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「スリム」バージョンでは、PLLトリックを実行できません（ボード上でラインが分離されていません）。「スリム」係数に影響を与えることができないため、「基準」周波数を下げます！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはHANAチップによって生成され、I2Cバスを介して構成できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u0/mv/h3/u0mvh32w0mjhaeylbllspnsiwwc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、「低速で」多くを減らすことはできず、最終的なプロセッサ周波数が強く「水泳」し始め、成功の可能性が減少しました。</font><font style="vertical-align: inherit;">最も安定したオプションは3.17倍のスローダウンでした。</font><font style="vertical-align: inherit;">128回ではなく、少なくとも何か。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべて？</font><font style="vertical-align: inherit;">いいえ、すべてではありません。</font><font style="vertical-align: inherit;">攻撃が初めて（特にスリムで）機能するという事実にはほど遠い。</font><font style="vertical-align: inherit;">起動に失敗した場合、プレフィックスが再起動し、再度起動しようとします。</font><font style="vertical-align: inherit;">開始は5回だけ試行され、その後、接頭辞が停止し、「赤い死のリング」が点滅し始めます。</font><font style="vertical-align: inherit;">したがって、サウスブリッジファームウェア（SMC）にもパッチを適用し、ガベージの影響を受けないようにし、プレフィックスが青になるまで再起動します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4s/em/3z/4sem3zqaipwaskszcy_nzntxdvu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、アルゴリズムを取得します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッチSMC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーセントを遅くする（PLLまたはI2C経由）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POSTトリガーを待機しています</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nマイクロ秒待機</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RESETにインパルスを送信</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーセントバックスピードアップ</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計算の精度を高めるために、同じHANA（48 MHz）から周波数を取得します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/cg/em/dqcgemuy43cr24pzdnor6sl2zpy.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、私たちは安価なCPLDザイリンクスXC2C64Aに基づいたそのようなデザインを手に入れました：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/uf/5m/yxuf5mhm9uohsh7axeb_trevnue.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RESETの配線の長さと位置を確認して（写真の下部にある「コイル」に注意してください）先に進むことを忘れないでください。打ち上げが1分以内に完了することを期待してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これはハードウェア側のみです。</font><font style="vertical-align: inherit;">ブートローダーにパッチを当ててコードを詰め込むにはどうすればよいですか？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パッチローダー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、第2レベルのブートローダー「CB」が攻撃されています。このブートローダーは固定キーで暗号化され、すべてのコンソールで同じですが、「CB」だけを変更することはできず、攻撃するだけです。ただし、次のものは、各セットトップボックスに固有のCPUキーで既に暗号化されています。そして、それを変更するには、このキーを知っている必要があります... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そうでないのですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xbox 360の古い「シック」リビジョンでは、コンソールの製造段階で使用される、いわゆる「ゼロペアリング」モードがCBローダーでサポートされていました。オフセット0x10の各ブートローダーのヘッダーには、復号化のキーの一部として使用されるランダムなペアリングデータセットが含まれています。このデータセットが完全にゼロで構成されている場合（「ゼロペアリング」）、プロセッサキーは無視され、代わりに固定のゼロキーが使用されました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s6/yd/tc/s6ydtc65_pqwl6vqimx88x7j4ws.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このトリックを使用して、元の「CB」でイメージをアセンブルし、次のブートローダー「CD」（独自のコードを使用）をゼロキーで暗号化して、RGHを使用して実行することができました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s5/mg/9y/s5mg9ynt52prplbrelkmas-3hqg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールでは、「スリム」がこのトリックをラップし、「ゼロペアリング」モードを削除し、「CB」を2つの部分に分割しました。</font><font style="vertical-align: inherit;">ここで、「CB」は非常にシンプルで小さな「CB_A」に分割され、プロセッサキー「CB_B」によって暗号化されています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/kw/fr/iokwfrhtycw2bg8fd8qnuzq9c-c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、RC4アルゴリズムを使用した暗号化（つまり、CB_Bはこのアルゴリズムを使用して暗号化されます）には、1つの特徴があります。</font><font style="vertical-align: inherit;">鍵に基づく暗号化のプロセスでは、元のデータとバイナリ「加算」（操作「排他的論理和」、「xor」）する疑似ランダムデータストリームが生成されます。</font><font style="vertical-align: inherit;">したがって、復号化するときに同じことが起こり、同じ擬似ランダムストリームで追加すると、データが元の値に戻ります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mw/_3/da/mw_3da2ixwvjpwa3wmxion8bjvk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、バイナリ加算演算は可換的かつ連想的です。つまり、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と必要なパッチを使用した暗号化コード</font><font style="vertical-align: inherit;">に対してのみ、キーを知らなくても暗号化データを変更でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uc/hk/mr/uchkmrjc4tjpy5sepvgm_pv-jo4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、「CB_A」を暗号化し、暗号化された「CB_B」にパッチを適用して（復号化がまったく実行されないように）、そのコードをプレーンテキスト「CD」に入れることができます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_q/g1/hg/_qg1hghntkm59bnmg1bv5xp4h_8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、まとめると、起動は次のように</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なります（XeLLは、homebrew、Linuxのブートローダーで、CPUキーも表示されます）。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JOiPjlWDA1A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイクロソフトの反撃</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、マイクロソフトはすべてにパッチを当てようとしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいシステムアップデートでは、すべての古いコンソールが「CB_A」と「CB_B」から「個別の」ブートに転送され、最終的に「ゼロペア」モードが閉じました。</font><font style="vertical-align: inherit;">Slimでは、ブートローダーも更新されています。</font><font style="vertical-align: inherit;">新しいブートローダーはRGHから保護するために大幅に変更されており、CB_Aの保護に最も重点が置かれています。</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POSTでデバッグ出力を完全に削除</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信頼性を高めるために、ハッシュ検証がやり直され、複製されました</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード全体で、sleep（）はランダムな時間に設定されました（CPUキーによって異なります!!）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CB_Aを取り消すためのCBLDVフュージョンチェックを追加</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/zh/ak/rozhaks1oyb4q0ck6f_2mbzmwmi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
イノベーションのリストは、RGHにチャンスを与えません。</font><font style="vertical-align: inherit;">しかし、リストの最後の項目に注目してみましょう-その前に、CB_Aにはフュージョンチェックがありませんでした！</font><font style="vertical-align: inherit;">致命的な欠陥。</font><font style="vertical-align: inherit;">さらに、覚えているように、プロセッサキーは「CB_A」のデコードには関与しません。</font><font style="vertical-align: inherit;">これは、RGHに対して脆弱なCB_Aローダーが任意のコンソールで起動できることを意味し、これを禁止することはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、この脆弱な「CB_A」の助けを借りて何かを開始するには、少し回避する必要があります。</font><font style="vertical-align: inherit;">CPUキーがわからない場合は、既存の「CB_B」にパッチを適用するだけです。</font><font style="vertical-align: inherit;">しかし、個々のセクションを変更するのではなく、ブートローダー全体を完全に上書きするとどうなるでしょうか。</font><font style="vertical-align: inherit;">これが原因で、パッチを当てる方法をすでに知っている古いブートローダーを「書き込み」、新しいブートローダーを置き換えますか？</font><font style="vertical-align: inherit;">だから彼らはしました：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脆弱なCB_Aを元の画像と同じ方法で暗号化します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいCB_BとXORして、「違い」を得る</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化した「CB_B」に載せます！</font></font></li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rt/4t/7c/rt4t7ct5vu1vfnvexya_4yjp_oc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しになりますが、鍵を知らなくても、暗号化されたコンテンツを正常に置き換え、脆弱なブートローダーを配置しました。</font><font style="vertical-align: inherit;">コンソールはハック、マイクロソフトは驚いています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者は懸命に働き、次のシステムアップデートで暗号化方式「CB_B」をわずかに変更しました。暗号化キーも「CB_A」のバージョンに依存するようになりました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2_/zy/kq/2_zykqm27pplqsop8gquppheo4g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実行して、古いバージョンの脆弱な「CB_A」にデータを移動</font><font style="vertical-align: inherit;">しようとする</font><font style="vertical-align: inherit;">と、ブートローダーがキーの違いによりガベージを復号化しました。</font><font style="vertical-align: inherit;">また、新しいブートローダーはハッキングできず、グリッチ攻撃から十分に保護されています。</font><font style="vertical-align: inherit;">これまでのところ、マイクロソフトの勝利！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コロナが問題を投げる</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一方、Xbox 360の新しいリビジョンであるCoronaが市場に出て、改造者の問題を引き起こしました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/zj/b1/fszjb1roudnv3rix_uf3usnwml4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボードに十分なチップがありません、それを見つけることができますか？</font><font style="vertical-align: inherit;">その通り、HANAチップはサウスブリッジに「隠されていました」。</font><font style="vertical-align: inherit;">modチップに48 MHzの周波数を使用する場所は他にありません。以前のI2Cスローダウンコマンドは機能しません。</font><font style="vertical-align: inherit;">しかし、これは何年もの間Xbox 360システムストレージとして機能していた16 MB NANDフラッシュが、eMMCインターフェイスを備えた4 GBチップに不法に置き換えられたのです。</font><font style="vertical-align: inherit;">（本当、コンソールのより安価なバージョンでのみですが、それでも）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ho/pv/dl/hopvdl-wilvzq4pzvndoogihru4.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、何も、すべてが扱われました。</font><font style="vertical-align: inherit;">カードリーダーを介してフラッシュメモリを読み書きする方法を理解しました：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oo/sz/pj/ooszpjupnf_mgzwpkc-vry0ovou.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいI2Cスローダウンコマンドが見つかりました。外部の48 MHz水晶発振器がHANAに置き換わりました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/88/lm/ic/88lmicizuembheqjiod-uff7jau.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成したビルドスクリプト、4 GB NANDのサポートの追加...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qm/7a/tk/qm7atka28kaj3anjmoq2cgoalz0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、Microsoftはスティックを車輪に付け続けました。</font><font style="vertical-align: inherit;">たとえば、新しいボードでは、いくつかの抵抗が消え、これがないとmodチップが機能しなくなりました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/ji/wg/kvjiwggxf9dncmv8rehaqhpzuy4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、これははんだごてでジャンパーをインストールすることで修正されました：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/7x/sv/ku7xsv8rpu2fov8upv6g-osgfm8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
POST_OUTトラックがボードから消えると、事態はさらに深刻になります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lu/lo/0m/lulo0m01ihmy34glpcoeriz4ojo.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ここではマイクロソフトは幸運ではありませんでした。RGHに必要なCPUの「ボール」は極端な列にありました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/nk/e2/hcnke2-7eh_xgrz0bmpf2ewtzro.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてもちろん、彼らは彼らに接続することができました。</font><font style="vertical-align: inherit;">まず、最もスリーブ状のもの、プロセッサの端を少しドリルアップして、配線でボールに直接はんだ付けします。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/-t/k_/gk-tk_mzrvo5suirxpk_d_kknru.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/ue/ai/dwueaifiz18-tfgrylfhdgkpats.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、中国人は、針がばね式で、正確にボールの上にあるフレームワークをリリースし、他のすべての人のために問題が解決されました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/sd/xj/k7sdxjysbtq9ofcadfby2jpdf-i.jpeg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラストフロンティア</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「クラウン」を打ち負かした後、1つの問題がありました。システムの新しいバージョンはハッキングに屈しませんでした。 RGHを起動するには、CPUキーを知っている必要があり、CPUキーを見つけるには、少なくとも1回はRGHを実行する必要があります。一般的に鶏と卵の問題。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、考えが浮かびました。「グリッチ」認証でチェックするだけでなく、復号もスキップします！問題がなければ、キーを知る必要はありません。「CB_B」を平文で入力してください。それだけです。このアイデアは、ダブルグリッチハック（DGX）の基礎を形成しました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/28/h2/yh/28h2yheods_vx8jptciovob9yby.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このチップは2パーセント「バギー」であり、最初のパルスはブートローダーの復号化フェーズをスキップし、2番目のパルスは認証をスキップしました。</font><font style="vertical-align: inherit;">少なくとも1回は正常に起動する必要があったため、安定性はかなり低下しました。その後、CPUキーを取得して、以前と同様に続行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DGXは長い間関係がありませんでした。3か月後、中国人は「DGX RIP」のリリースをスローし、どのセットトップボックスでも実行され、標準のRGHで動作し、もちろん、はるかに安定した画像を提供しました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ig/yv/fy/igyvfysfq1qsiyyefeqsknjiz1e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのイメージには、Xbox 360の製造で使用されるCB_Aブートローダーの特別なバージョンが含まれており、実際には、古き良き「ゼロペアリング」モードの完全な類似物です。</font><font style="vertical-align: inherit;">プロセッサキーの代わりに、この「CB_A_mfg」は固定nullキーで「CB_B」を復号化しました：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_2/3k/n1/_23kn1nx7eydggdpskbzkudinv4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてここにマイクロソフトがあります。</font><font style="vertical-align: inherit;">この「CB_A」の「サービス」バージョンでは、フュージョンチェックも行われず、禁止することは不可能でした。</font><font style="vertical-align: inherit;">Xbox 360のリビジョンに従って画像を記録し、チップをはんだ付けするだけで十分でした。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fa/_9/hd/fa_9hdfa5kgwphr69k6xpdnyaia.jpeg" width="550"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンチェスター！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RGHは、コンソールの新しいリビジョン（コードネームWinchester）でのみ完全に修正されました。</font><font style="vertical-align: inherit;">初めて、CPUとGPUプロセッサが1つのチップに統合され、ボードが可能な限り簡素化されました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/of/ps/1g/ofps1gt_gevcpmlz39aj97ukquc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
POST_OUTトラックが削除されただけではありません。</font><font style="vertical-align: inherit;">プロセッサの下のプラットフォームにはんだ付けした場合でも、</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ha/vg/c6/havgc6afvvs4nt5pn8lihldlspq.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nz/si/lc/nzsilch-pq6gun98tbugnx89owi.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、開発者向けの特別バージョンのボードであるXDKにプロセッサーをはんだ付けしたとしても、これらのトラックはまだそこにあります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m2/di/n4/m2din48-hbqpbs2aw_if-uorx0g.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
POST_OUTでは、コンソールの起動時に1つのパルスのみが表示されます。</font><font style="vertical-align: inherit;">バスロック：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/6q/5c/kq6q5cngontmkypyxrsfbke-atw.png" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、生産段階でのみ遮断されます。</font><font style="vertical-align: inherit;">ヒューズをまだ焼いていない工場から「クリーンな」プロセッサを入手すると、POST_OUTが機能します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p0/ke/au/p0keau_qpxnl61bmosmxcv5unya.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、RGHは機能しなくなります。</font><font style="vertical-align: inherit;">どのようにRESETパルスを出そうとしても、プロセッサはリセットを正しく実行するか、または持続時間が短すぎるために信号を無視します。</font><font style="vertical-align: inherit;">どうやら、特別なロジックモジュールがプロセッサに追加され、RESETラインをフィルタリングして、ハードウェアエラーを最終的に修正しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">後記</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Xbox 360の最新リビジョンをハッキングするのは不可能であることが判明しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はいといいえ。</font><font style="vertical-align: inherit;">現在のところ、Winchesterのリビジョンで変更されたシステムを実行する方法は1つしか知られていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソフトウェア開発キット（XDK）には、コンパイル済みコードに署名するためのさまざまな秘密鍵が含まれています。</font><font style="vertical-align: inherit;">その結果、XDKシステムの第3レベルのブートローダーである署名キー「shadowboot」が乱雑になっていることがわかりました。</font><font style="vertical-align: inherit;">そして、それを使用して、変更されたファームウェアで正当な署名済みイメージを収集できます。</font><font style="vertical-align: inherit;">通常の「ストア」コンソールで作業するだけですが、彼はしません。</font><font style="vertical-align: inherit;">XDKバージョンのコンソールを搭載したプロセッサ、または非ヒューズのヒューズを備えた「クリーン」CPUが必要です（Aliexpressで確認できます）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/sl/fz/rrslfzrmohmrxuagyadwvojnpvq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そうして初めて、カスタムシェルの「システム情報」にそのような表記を検討する機会が与えられます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/te/g7/ggteg7iezt2c-hw-h_mczs132fe.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、それだけです！</font><font style="vertical-align: inherit;">いつものように、コメントで質問にお答えします:) </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360の保護とハッキング、パート1 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360の保護とハッキング、パート2 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360の保護とハッキング、パート3</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja500228/index.html">ギャツビーがNext.jsをどのように回避したか</a></li>
<li><a href="../ja500232/index.html">Akka.NETの学習：簡単なオンラインゲームのサーバー</a></li>
<li><a href="../ja500234/index.html">Git + JSの個人経費会計プロジェクトを作成した理由</a></li>
<li><a href="../ja500238/index.html">何が気になるのか教えて</a></li>
<li><a href="../ja500244/index.html">アレイの外側</a></li>
<li><a href="../ja500248/index.html">FOSSニュースNo. 14-2020年4月27日〜5月3日の無料およびオープンソースニュースのレビュー</a></li>
<li><a href="../ja500250/index.html">OpenStreetMap No.509の世界からのニュース（2020年4月14日〜2020年4月20日）</a></li>
<li><a href="../ja500252/index.html">カスペルスキーセキュリティセンター-新しいレベル</a></li>
<li><a href="../ja500254/index.html">動作するフロントエンドを書きます。または、開発者からエンジニアになる方法。パート2</a></li>
<li><a href="../ja500256/index.html">ドミトリー・レベデフ：「数年前、もう少しするとOpenStreetMapが沈むことを私は明確に理解しました」</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>