<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖🏼 🖐🏽 🎿 Entwicklung einer Unternehmensbibliothek von React-Komponenten. Plattformübergreifender Ansatz 🤷🏻 🍚 🚾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel erzählt die Geschichte der erfolgreichen Implementierung des Designsystems in der Gesellschaft eines der größten Heimwerker. Die Prinzi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Entwicklung einer Unternehmensbibliothek von React-Komponenten. Plattformübergreifender Ansatz</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/luxoft/blog/501656/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Artikel erzählt die Geschichte der erfolgreichen Implementierung des Designsystems in der Gesellschaft eines der größten Heimwerker. </font><font style="vertical-align: inherit;">Die Prinzipien und Ansätze der plattformübergreifenden Entwicklung von UI-Komponenten unter Verwendung der React- und React Native-Bibliotheken sowie die Lösung des Problems der Wiederverwendung von Code zwischen Projekten für verschiedene Plattformen werden beschrieben.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst ein paar Worte darüber, wie alles begann und warum die Idee zur Implementierung eines Systemdesigns aufkam. Alles begann mit einer mobilen Android-Anwendung für Verkäufer in Geschäften. Die Anwendung basiert auf dem React-Native-Framework. Die Startfunktionalität wurde durch nur wenige Module dargestellt, z. B. die Suche nach Produkten im Katalog und in der Produktkarte, Verkaufsbeleg. Übrigens ist dies jetzt eine ziemlich leistungsfähige Anwendung, die die Funktionalität von Informationsschaltern in Geschäften bereits weitgehend ersetzt hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes wurden Webanwendungsprojekte für Mitarbeiter der Logistikabteilung sowie verschiedene Konfiguratoren gestartet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zeitpunkt zeigte sich ein Verständnis der allgemeinen Ansätze für das Design dieser Anwendungen sowie des Vorhandenseins einer ziemlich großen Codebasis. Und es war logisch, den anderen für die weitere Wiederverwendung zu systematisieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um UI / UX zu systematisieren, wurde beschlossen, ein Design-System zu entwickeln. Ich werde nicht ins Detail gehen, was es ist. Im Internet finden Sie viele Artikel zu diesem Thema. Zum Beispiel kann auf Habré die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeit von Andrei Sundiev</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Lesen empfohlen werden </font><font style="vertical-align: inherit;">.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warum Design System und was sind seine Vorteile? Das erste ist eine gemeinsame Erfahrung und das Gefühl, Produkte zu verwenden. Benutzer erhalten unabhängig von der Anwendung eine vertraute Benutzeroberfläche: Die Schaltflächen sehen aus und funktionieren wie gewohnt, das Menü wird an der richtigen Stelle geöffnet und mit der richtigen Dynamik funktionieren die Eingabefelder wie gewohnt. Der zweite Vorteil ist die Einführung bestimmter Standards und gemeinsamer Ansätze sowohl von der Design- als auch von der Entwicklungsseite. Jede neue Funktionalität wird nach bereits etablierten Kanonen und Ansätzen entwickelt. Neue Mitarbeiter erhalten ab den ersten Tagen eine klare Arbeitslinie. Das nächste ist die Wiederverwendung von Komponenten und die Vereinfachung der Entwicklung. Es ist nicht notwendig, das Rad jedes Mal neu zu erfinden. Sie können Schnittstellen aus vorgefertigten Blöcken mit dem erwarteten Endergebnis erstellen.Der Hauptvorteil für den Kunden besteht darin, Geld und Zeit zu sparen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, was haben wir getan? Tatsächlich haben wir nicht nur eine Komponentenbibliothek erstellt, sondern ein ganzes plattformübergreifendes Framework. Das Framework basiert auf einem Batch-Schema. Wir haben 5 Kern-npm-Pakete. Es ist der Kern für die Bereitstellung plattformübergreifender Web- und Android-Anwendungen. Pakete von Modulen, Dienstprogrammen und Diensten. Und ein Paket von Komponenten, die später besprochen werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unten sehen Sie das UML-Diagramm des Komponentenpakets. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/kn/xs/wiknxsuqj_n4jze72crt4c4u10g.jpeg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es enthält die Komponenten selbst, von denen einige unabhängig sind (Elemente) und einige miteinander verbunden sind, sowie den inneren Kern oder „Unterkern“.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns genauer betrachten, was im „Sub-Core“ enthalten ist. Die erste ist die visuelle Ebene des Systemdesigns. Hier dreht sich alles um Farbpalette, Typografie, Einrückungssystem, Gitter usw. Der nächste Block sind die Dienste, die für das Funktionieren der Komponenten erforderlich sind, z. B.: ComponentsConfig (Konfiguration der Komponenten), StyleSet (auf dieses Konzept werde ich später näher eingehen) und Device (eine Methode zum Arbeiten mit der Geräte-API). Und der dritte Block besteht aus allen Arten von Helfern (Resolver, Stilgeneratoren usw.).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/7l/f6/fx7lf6zz7n8olddc2yuf7576s6a.jpeg" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Entwicklung der Bibliothek haben wir einen atomaren Ansatz für das Design von Komponenten verwendet. Alles begann mit der Erstellung elementarer Komponenten oder Elemente. Sie sind elementare „Teilchen“, die voneinander unabhängig sind. Die wichtigsten sind Ansicht, Text, Bild, Symbol. Als nächstes folgen die komplexeren Komponenten. Jeder von ihnen verwendet ein oder mehrere Elemente, um seine Struktur aufzubauen. Zum Beispiel Schaltflächen, Eingabefelder, Auswahlmöglichkeiten usw. Die nächste Ebene sind Muster. Sie sind eine Kombination von Komponenten zur Lösung eines UI-Problems. Zum Beispiel ein Autorisierungsformular, eine Kopfzeile mit Parametern und Einstellungen oder eine von einem Designer entworfene Produktkarte, die in verschiedenen Modulen verwendet werden kann. Die letzte und schwierigste und zugleich wichtige Ebene ist das sogenannte Verhalten. Dies sind gebrauchsfertige Module,Implementierung bestimmter Geschäftslogiken und möglicherweise einschließlich der erforderlichen Back-End-Anforderungen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/00/jv/e3/00jve3iwyh64n0tifikfxtoz0v4.jpeg" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fahren wir also mit der Implementierung der Komponentenbibliothek fort. </font><font style="vertical-align: inherit;">Wie bereits erwähnt, haben wir zwei Zielplattformen - Web und Android (React-Native). </font><font style="vertical-align: inherit;">Wenn es sich im Web um Elemente handelt, die allen Webentwicklern wie div, span, img, header usw. bekannt sind, handelt es sich bei den reaktionsbezogenen Elementen um die Komponenten Ansicht, Text, Bild, Modal. </font><font style="vertical-align: inherit;">Und als erstes haben wir uns auf den Namen der Komponenten geeinigt. </font><font style="vertical-align: inherit;">Wir haben uns für ein System im React-Native-Stil entschieden </font><font style="vertical-align: inherit;">Erstens wurde bereits eine Komponentenbasis in den Projekten implementiert, und zweitens sind diese Namen sowohl für Web- als auch für reaktionsnative Entwickler am universellsten und verständlichsten. </font><font style="vertical-align: inherit;">Betrachten Sie beispielsweise die View-Komponente. </font><font style="vertical-align: inherit;">Die Methode der bedingten Renderkomponente für das Web sieht ungefähr so ​​aus:</font></font><br>
<br>
<pre><code class="javascript hljs">render() {
	<span class="hljs-keyword">return</span>(
		<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> {<span class="hljs-attr">...props</span>}&gt;</span>
			{children}
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><font></font>
	)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jene. </font><font style="vertical-align: inherit;">Unter der Haube ist dies nichts weiter als ein Div mit den notwendigen Requisiten und Nachkommen. </font><font style="vertical-align: inherit;">In React-Native ist die Struktur sehr ähnlich, nur die View-Komponente wird anstelle von divs verwendet:</font></font><br>
<br>
<pre><code class="javascript hljs">render() {
	<span class="hljs-keyword">return</span>(
		<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> {<span class="hljs-attr">...props</span>}&gt;</span>
			{children}
		<span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span><font></font>
	)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich die Frage: Wie kann man dies zu einer Komponente kombinieren und gleichzeitig das Rendering aufteilen? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier kommt ein Reaktionsmuster namens HOC oder Component höherer Ordnung zur Rettung. </font><font style="vertical-align: inherit;">Wenn Sie versuchen, ein UML-Diagramm dieses Musters zu zeichnen, erhalten Sie ungefähr Folgendes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/73/sz/tb/73sztbbrwdkvgknh3edlwk93gyo.jpeg" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit besteht jede Komponente aus einem sogenannten Delegaten, der Requisiten von außen empfängt und für die beiden Plattformen gemeinsame Logik verantwortlich ist, sowie zwei Plattformteilen, in denen die für jede Plattform spezifischen Methoden bereits gekapselt sind, und dem wichtigsten Rendering. </font><font style="vertical-align: inherit;">Betrachten Sie beispielsweise den Schaltflächen-Delegatencode:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buttonDelegate</span>(<span class="hljs-params">ReactComponent: ComponentType&lt;Props&gt;</span>): <span class="hljs-title">ComponentType</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ButtonDelegate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{<font></font>
        <font></font>
        <span class="hljs-comment">// Button common methods</span><font></font>
<font></font>
        render() {<font></font>
           <span class="hljs-keyword">const</span> { onPress, onPressIn, onPressOut } = <span class="hljs-keyword">this</span>.props;
            <span class="hljs-keyword">const</span> delegate = {
                <span class="hljs-attr">buttonContent</span>: <span class="hljs-keyword">this</span>.buttonContent,
                <span class="hljs-attr">buttonSize</span>: <span class="hljs-keyword">this</span>.buttonSize,
                <span class="hljs-attr">iconSize</span>: <span class="hljs-keyword">this</span>.iconSize,
                <span class="hljs-attr">onClick</span>: onPress,
                <span class="hljs-attr">onMouseUp</span>: onPressIn,
                <span class="hljs-attr">onMouseDown</span>: onPressOut,
                <span class="hljs-attr">onPress</span>: <span class="hljs-keyword">this</span>.onPress,
                <span class="hljs-attr">textColor</span>: <span class="hljs-keyword">this</span>.textColor,<font></font>
            };<font></font>
            <span class="hljs-keyword">return</span> (<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReactComponent</span> {<span class="hljs-attr">...this.props</span>} <span class="hljs-attr">delegate</span>=<span class="hljs-string">{delegate}</span> /&gt;</span></span>);<font></font>
        }<font></font>
    };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Delegat erhält als Argument den Plattformteil der Komponente, implementiert Methoden, die beiden Plattformen gemeinsam sind, und übergibt sie an den Plattformteil. </font><font style="vertical-align: inherit;">Der Plattformteil der Komponente selbst ist wie folgt:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">WebProps</span>, <span class="hljs-title">State</span>&gt; </span>{<font></font>
    <font></font>
   <span class="hljs-comment">// Web specific methods</span><font></font>
<font></font>
    render() {<font></font>
        <span class="hljs-keyword">const</span> { <span class="hljs-attr">delegate</span>: { onPress, buttonContent } } = <span class="hljs-keyword">this</span>.props;
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                <span class="hljs-attr">className</span>=<span class="hljs-string">{this.classes}</span>
                {<span class="hljs-attr">...buttonProps</span>}
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onPress}</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>
            &gt;</span>
                {buttonContent(this.spinner, this.iconText)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> buttonDelegate(Button);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist eine Rendermethode mit all ihren Plattformfunktionen. Die allgemeine Funktionalität des Delegaten erfolgt in Form eines Objekts durch einen Requisitendelegierten. Ein Beispiel für den Plattformteil einer Schaltfläche für eine reaktionsnative Implementierung:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">NativeProps</span>, <span class="hljs-title">State</span>&gt; </span>{<font></font>
<font></font>
    <span class="hljs-comment">// Native specific methods</span><font></font>
<font></font>
    render() {<font></font>
        <span class="hljs-keyword">const</span> { <span class="hljs-attr">delegate</span>: { onPress, buttonContent } } = <span class="hljs-keyword">this</span>.props;
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">styleSet</span>=<span class="hljs-string">{this.styles}</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span>
                    {<span class="hljs-attr">...butonProps</span>}
                    <span class="hljs-attr">onPress</span>=<span class="hljs-string">{onPress}</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">{this.touchableStyles}</span>
                    {<span class="hljs-attr">...touchableProps</span>}    
                &gt;</span>
                    {buttonContent(this.spinner, this.iconText)}
                <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span><font></font>
        );<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> buttonDelegate(Button);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall ist die Logik ähnlich, es werden jedoch reaktionsnative Komponenten verwendet. In beiden Listen ist buttonDelegate ein HOC mit gemeinsamer Logik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei diesem Ansatz bei der Implementierung von Komponenten stellt sich die Frage nach der Trennung von Plattformteilen während der Montage des Projekts. Es muss sichergestellt werden, dass das von uns in Webprojekten verwendete Webpack nur Teile von Komponenten sammelt, die für das Web bestimmt sind, während der Metro-Bundler in React-Native seine Plattformteile „einhaken“ sollte, ohne auf die Komponente für das Web zu achten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu lösen, verwendeten sie die integrierte Metro-Bundler-Funktion, mit der Sie das Präfix für die Plattform-Dateierweiterung angeben können. In unserem Fall sieht metro.config.js folgendermaßen aus:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">resolver</span>: {
        <span class="hljs-attr">useWatchman</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">platforms</span>: [<span class="hljs-string">'native'</span>],<font></font>
    },<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher sucht die Metro beim Erstellen des Bundles zuerst nach Dateien mit der Erweiterung native.js und hakt die Datei dann mit der Erweiterung .js ein, wenn sie sich nicht im aktuellen Verzeichnis befindet. Diese Funktionalität ermöglichte es, die Plattformteile der Komponenten in separaten Dateien zu platzieren: Der Teil für das Web befindet sich in der .js-Datei, der reaktionsnative Teil wird in der Datei mit der Erweiterung .native.js platziert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webpack hat übrigens die gleiche Funktionalität mit NormalModuleReplacementPlugin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiteres Ziel des plattformübergreifenden Ansatzes bestand darin, einen einzigen Mechanismus für das Styling von Komponenten bereitzustellen. Bei Webanwendungen haben wir uns für den sass-Präprozessor entschieden, der letztendlich zu regulärem CSS kompiliert wird. Jene. Für Webkomponenten haben wir die bekannten React ClassName-Entwickler verwendet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reaktiv native Komponenten werden durch Inline-Stile und Requisitenstil gestaltet. </font><font style="vertical-align: inherit;">Diese beiden Ansätze mussten kombiniert werden, um die Verwendung von Stilklassen für Android-Anwendungen zu ermöglichen. </font><font style="vertical-align: inherit;">Zu diesem Zweck wurde das Konzept von styleSet eingeführt, das nichts weiter als ein Array von Zeichenfolgen ist - Klassennamen:</font></font><br>
<br>
<pre><code class="javascript hljs">styleSet: <span class="hljs-built_in">Array</span>&lt;string&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig wurde der gleichnamige StyleSet-Dienst für react-native implementiert, mit dem Klassennamen registriert werden können:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> StyleSet.define({
    <span class="hljs-string">'lmui-Button'</span>: {
        <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">6</span>,<font></font>
    },<font></font>
    <span class="hljs-string">'lmui-Button-buttonSize-md'</span>: {
        <span class="hljs-attr">paddingTop</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">paddingBottom</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">paddingLeft</span>: <span class="hljs-number">12</span>,
        <span class="hljs-attr">paddingRight</span>: <span class="hljs-number">12</span>,<font></font>
    },<font></font>
    <span class="hljs-string">'lmui-Button-buttonSize-lg'</span>: {
        <span class="hljs-attr">paddingTop</span>: <span class="hljs-number">8</span>,
        <span class="hljs-attr">paddingBottom</span>: <span class="hljs-number">8</span>,
        <span class="hljs-attr">paddingLeft</span>: <span class="hljs-number">16</span>,
        <span class="hljs-attr">paddingRight</span>: <span class="hljs-number">16</span>,<font></font>
    },<font></font>
})</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für Webkomponenten ist styleSet ein Array von CSS-Klassennamen, die mithilfe der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klassennamenbibliothek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> „geklebt“ werden </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da das Projekt plattformübergreifend ist, ist es offensichtlich, dass mit dem Wachstum der Codebasis auch die Anzahl der externen Abhängigkeiten zunimmt. Darüber hinaus sind die Abhängigkeiten für jede Plattform unterschiedlich. Für Webkomponenten werden beispielsweise Bibliotheken wie Style-Loader, React-Dom, Klassennamen, Webpack usw. benötigt. Für React-Native-Komponenten wird eine große Anzahl ihrer "nativen" Bibliotheken verwendet, z. B. React-Native selbst. Wenn ein Projekt, in dem die Komponentenbibliothek verwendet werden soll, nur eine Zielplattform hat, ist die Installation aller Abhängigkeiten auf einer anderen Plattform irrational. Um dieses Problem zu lösen, haben wir den Postinstall-Hook von npm selbst verwendet, in dem ein Skript installiert wurde, um Abhängigkeiten für die angegebene Plattform zu installieren. Die Abhängigkeiten selbst wurden im entsprechenden Abschnitt von package.json des Pakets registriert.und die Zielplattform sollte im Projekt package.json als Array angegeben werden.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Ansatz zeigte jedoch einen Nachteil, der später bei der Montage im CI-System zu mehreren Problemen führte. Die Wurzel des Problems war, dass mit package-lock.json das in postinstall angegebene Skript nicht alle registrierten Abhängigkeiten installiert hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich musste nach einer anderen Lösung für dieses Problem suchen. Die Lösung war einfach. Es wurde ein Zwei-Paket-Schema angewendet, bei dem alle Plattformabhängigkeiten im Abschnitt Abhängigkeiten des entsprechenden Plattformpakets platziert wurden. Im Fall des Webs heißt das Paket beispielsweise Komponenten-Web, in dem sich eine einzige Datei package.json befindet. Es enthält alle Abhängigkeiten für die Webplattform sowie das Hauptpaket mit Komponentenkomponenten. Dieser Ansatz ermöglichte es uns, die Trennung von Abhängigkeiten beizubehalten und die Funktionalität von package-lock.json beizubehalten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abschließend werde ich ein Beispiel für JSX-Code unter Verwendung unserer Komponentenbibliothek geben:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;View row&gt;
   <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>
      <span class="hljs-attr">col-xs</span>=<span class="hljs-string">{12}</span>
      <span class="hljs-attr">col-md</span>=<span class="hljs-string">{8}</span>
      <span class="hljs-attr">col-lg</span>=<span class="hljs-string">{4}</span>
      <span class="hljs-attr">col-xl</span>=<span class="hljs-string">{4}</span>
      <span class="hljs-attr">middle-xs</span>
      <span class="hljs-attr">col-md-offset-3</span>
   /&gt;</span></span>
     <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">size</span>=<span class="hljs-string">”fs1”</span>&gt;</span>Sample text<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span><font></font>
   &lt;/View&gt;<font></font>
&lt;/View&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Code-Snippet ist plattformübergreifend und funktioniert in einer React-Anwendung für das Web und in einer Android-Anwendung auf React-Native gleich. </font><font style="vertical-align: inherit;">Bei Bedarf kann derselbe Code unter iOS "abgewickelt" werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit war die Hauptaufgabe gelöst, mit der wir konfrontiert waren - die maximale Wiederverwendung beider Entwurfsansätze und der Codebasis zwischen verschiedenen Projekten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte geben Sie in den Kommentaren an, welche Fragen zu diesem Thema im nächsten Artikel interessant waren.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501646/index.html">Go, Vue und 3 Tage zu entwickeln: ein Echtzeitsystem zur Überwachung von Patienten</a></li>
<li><a href="../de501648/index.html">10 Erweiterungen für VS Code, ohne die ich nicht programmieren kann</a></li>
<li><a href="../de501650/index.html">Was befindet sich in einer .wasm-Datei? Einführung in wasm-decompile</a></li>
<li><a href="../de501652/index.html">Nuxt als Fullstack-Server: Frontend + Backend-API-Server (Teil 1)</a></li>
<li><a href="../de501654/index.html">Erstellen Sie Arbeitsprozesse an einem entfernten Standort: praktische Empfehlungen</a></li>
<li><a href="../de501658/index.html">So richten Sie einen Workflow "in der Ferne" ein: 7 praktische Schritte</a></li>
<li><a href="../de501662/index.html">Warum Axure Sketch und Figma biegen konnte, aber nicht bog</a></li>
<li><a href="../de501664/index.html">Videokonferenzen sind jetzt ein Markt und neue Technologien. Longrid, Teil zwei</a></li>
<li><a href="../de501668/index.html">Bereitstellung der Kommunikation von sich bewegenden Objekten und Werkzeugen zur Erhöhung der Zuverlässigkeit</a></li>
<li><a href="../de501670/index.html">Wie viel kostet das Leben oder 2,1 Millionen US-Dollar pro Injektion: eine wunderbare Gentherapie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>