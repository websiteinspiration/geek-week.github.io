<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🔧 🧙🏼 🧚🏾 Panduan untuk bekerja dengan OpenAL di C ++. Bagian 1: mainkan suara 🏯 🤷🏽 🐖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Game Anda membutuhkan suara! Anda mungkin sudah menggunakan OpenGL untuk menggambar di layar. Anda mengetahui API-nya, dan Anda beralih ke OpenAL kare...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Panduan untuk bekerja dengan OpenAL di C ++. Bagian 1: mainkan suara</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488744/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Game Anda membutuhkan suara! </font><font style="vertical-align: inherit;">Anda mungkin sudah menggunakan OpenGL untuk menggambar di layar. </font><font style="vertical-align: inherit;">Anda mengetahui API-nya, dan Anda beralih ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> karena nama itu tampak familier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, kabar baiknya adalah bahwa OpenAL juga memiliki API yang sangat akrab. </font><font style="vertical-align: inherit;">Awalnya dirancang untuk mensimulasikan API spesifikasi OpenGL. </font><font style="vertical-align: inherit;">Itulah sebabnya saya memilihnya di antara banyak sistem suara untuk game; </font><font style="vertical-align: inherit;">selain itu, ini adalah cross-platform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada artikel ini, saya akan berbicara secara rinci tentang kode apa yang diperlukan untuk menggunakan OpenAL dalam game yang ditulis dalam C ++. </font><font style="vertical-align: inherit;">Kami akan membahas suara, musik, dan posisi suara dalam ruang 3D dengan contoh kode.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sejarah OpenAL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan mencoba untuk singkat. Seperti disebutkan di atas, itu sengaja dirancang sebagai tiruan dari OpenGL API, dan ada alasan untuk ini. Ini adalah API yang nyaman yang dikenal banyak orang, dan jika grafiknya satu sisi dari mesin game, maka suaranya harus berbeda. Awalnya, OpenAL seharusnya open-source, tetapi kemudian sesuatu terjadi ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Orang-orang tidak begitu tertarik pada suara seperti grafik, jadi Kreatif akhirnya menjadikan OpenAL sebagai propertinya, dan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementasi referensi</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sekarang menjadi milik dan tidak gratis. Tapi! </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spesifikasi</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenAL masih merupakan standar "terbuka", yaitu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diterbitkan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari waktu ke waktu, spesifikasi diubah, tetapi tidak banyak. Suara tidak berubah secepat grafik, karena tidak ada kebutuhan khusus untuk ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spesifikasi terbuka memungkinkan orang lain untuk membuat implementasi spesifikasi sumber terbuka. Salah satu implementasi tersebut adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan terus terang, tidak masuk akal untuk mencari yang lain. Ini adalah implementasi yang akan saya gunakan, dan saya sarankan Anda menggunakannya juga.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dia adalah lintas platform. </font><font style="vertical-align: inherit;">Ini diterapkan dengan cukup aneh - pada kenyataannya, di dalam perpustakaan menggunakan API suara lain yang ada di sistem Anda. </font><font style="vertical-align: inherit;">Di Windows, ia menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectSound</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di Unix, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Berkat ini, dia bisa menjadi cross-platform; </font><font style="vertical-align: inherit;">pada dasarnya, ini adalah nama besar untuk API pembungkus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda mungkin khawatir tentang kecepatan API ini. </font><font style="vertical-align: inherit;">Tapi jangan khawatir. </font><font style="vertical-align: inherit;">Ini adalah suara yang sama, dan tidak menghasilkan beban yang besar, sehingga tidak memerlukan optimisasi besar yang diperlukan oleh API grafik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi cukup cerita, mari kita beralih ke teknologi.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang Anda butuhkan untuk menulis kode di OpenAL?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda perlu membuat OpenAL Soft di toolchain pilihan Anda. Ini adalah proses yang sangat sederhana yang dapat Anda ikuti sesuai dengan instruksi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di bagian Instalasi Sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saya tidak pernah memiliki masalah dengan ini, tetapi jika Anda memiliki kesulitan, tulis komentar di bawah artikel asli atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tulis ke milis OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, Anda akan memerlukan beberapa file suara dan cara untuk mengunduhnya. Memuat data audio ke dalam buffer dan detail halus dari berbagai format audio berada di luar ruang lingkup artikel ini, tetapi Anda dapat membaca tentang </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengunduh dan streaming file Ogg / Vorbis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mengunduh file WAV sangat sederhana, sudah ada ratusan artikel di Internet tentang ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugas menemukan file audio Anda harus memutuskan sendiri. </font><font style="vertical-align: inherit;">Ada banyak suara dan ledakan di Internet yang bisa Anda unduh. </font><font style="vertical-align: inherit;">Jika Anda memiliki rumor, maka Anda dapat mencoba untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menulis musik chiptune Anda sendiri</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terjemahan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di Habré]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga, jaga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panduan Programmer dari OpenALSoft berguna</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dokumentasi ini adalah pdf yang jauh lebih baik dengan spesialisasi "resmi". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faktanya, itu saja. </font><font style="vertical-align: inherit;">Kami akan menganggap bahwa Anda sudah tahu cara menulis kode, menggunakan IDE dan toolchain.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ikhtisar OpenAL API</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya katakan beberapa kali, ini mirip dengan OpenGL API. Kesamaan terletak pada kenyataan bahwa itu didasarkan pada keadaan dan Anda berinteraksi dengan deskriptor / pengidentifikasi, dan bukan dengan objek itu sendiri secara langsung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada perbedaan antara konvensi API di OpenGL dan OpenAL, tetapi tidak signifikan. Di OpenGL, Anda perlu membuat panggilan OS khusus untuk menghasilkan konteks rendering. Tantangan-tantangan ini berbeda untuk berbagai OS dan </font><font style="vertical-align: inherit;">tidak </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar-benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bagian dari spesifikasi OpenGL. Dalam OpenAL, semuanya berbeda - fungsi pembuatan konteks adalah bagian dari spesifikasi dan sama terlepas dari sistem operasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat berinteraksi dengan API, ada tiga jenis objek utama yang berinteraksi dengan Anda. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pendengar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">("Pendengar") adalah lokasi "telinga" yang terletak di ruang 3D (selalu ada hanya satu pendengar). </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ("sumber") adalah "speaker" yang menghasilkan suara, sekali lagi dalam ruang 3D. </font><font style="vertical-align: inherit;">Pendengar dan sumber dapat dipindahkan dalam ruang dan tergantung pada ini, apa yang Anda dengar melalui speaker dalam permainan berubah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Objek terakhir adalah </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mereka menyimpan sampel suara yang akan diputar sumber untuk pendengar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada juga </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang digunakan gim untuk mengubah cara audio diproses melalui OpenAL.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti disebutkan di atas, objek-objek ini adalah sumber suara. </font><font style="vertical-align: inherit;">Mereka dapat mengatur posisi dan arah, dan mereka terkait dengan buffer data audio pemutaran.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pendengar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu-satunya set "telinga" dalam game. </font><font style="vertical-align: inherit;">Apa yang didengar pendengar direproduksi melalui pengeras suara komputer. </font><font style="vertical-align: inherit;">Dia juga punya posisi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buffer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di OpenGL, padanannya adalah Texture2D. </font><font style="vertical-align: inherit;">Intinya, ini adalah data audio yang direproduksi oleh sumber.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipe data</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk dapat mendukung kode lintas platform, OpenAL melakukan urutan tindakan tertentu dan mendefinisikan beberapa tipe data. </font><font style="vertical-align: inherit;">Bahkan, ia mengikuti OpenGL sehingga kita bahkan dapat langsung mengkonversi tipe OpenAL ke tipe OpenGL. </font><font style="vertical-align: inherit;">Tabel di bawah mencantumkan mereka dan padanannya.</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketikkan openal</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketik openalc</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketik opengl</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++ Typedef</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALboolean</code></td>
<td><code>ALCboolean</code></td>
<td><code>GLboolean</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai boolean 8-bit</font></font></td>
</tr>
<tr>
<td><code>ALbyte</code></td>
<td><code>ALCbyte</code></td>
<td><code>GLbyte</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai integer 8-bit dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode tambahan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan tanda</font></font></td>
</tr>
<tr>
<td><code>ALubyte</code></td>
<td><code>ALCubyte</code></td>
<td><code>GLubyte</code></td>
<td><code>std::uint8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai integer 8-bit yang tidak ditandatangani</font></font></td>
</tr>
<tr>
<td><code>ALchar</code></td>
<td><code>ALCchar</code></td>
<td><code>GLchar</code></td>
<td><code>char</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simbol</font></font></td>
</tr>
<tr>
<td><code>ALshort</code></td>
<td><code>ALCshort</code></td>
<td><code>GLshort</code></td>
<td><code>std::int16_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai integer bertanda 16-bit</font></font></td>
</tr>
<tr>
<td><code>ALushort</code></td>
<td><code>ALCushort</code></td>
<td><code>GLushort</code></td>
<td><code>std::uint16_t</code></td>
<td>16-    </td>
</tr>
<tr>
<td><code>ALint</code></td>
<td><code>ALCint</code></td>
<td><code>GLint</code></td>
<td><code>std::int32_t</code></td>
<td>32-      </td>
</tr>
<tr>
<td><code>ALuint</code></td>
<td><code>ALCuint</code></td>
<td><code>GLuint</code></td>
<td><code>std::uint32_t</code></td>
<td>32-    </td>
</tr>
<tr>
<td><code>ALsizei</code></td>
<td><code>ALCsizei</code></td>
<td><code>GLsizei</code></td>
<td><code>std::int32_t</code></td>
<td> 32-   </td>
</tr>
<tr>
<td><code>ALenum</code></td>
<td><code>ALCenum</code></td>
<td><code>GLenum</code></td>
<td><code>std::uint32_t</code></td>
<td> 32- </td>
</tr>
<tr>
<td><code>ALfloat</code></td>
<td><code>ALCfloat</code></td>
<td><code>GLfloat</code></td>
<td><code>float</code></td>
<td>32-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">IEEE 754</a></td>
</tr>
<tr>
<td><code>ALdouble</code></td>
<td><code>ALCdouble</code></td>
<td><code>GLdouble</code></td>
<td><code>double</code></td>
<td>64-     IEEE 754</td>
</tr>
<tr>
<td><code>ALvoid</code></td>
<td><code>ALCvoid</code></td>
<td><code>GLvoid</code></td>
<td><code>void</code></td>
<td> </td>
</tr>
</tbody>
</table></div><br>
<h2>  OpenAL</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada sebuah artikel tentang bagaimana </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyederhanakan pengenalan kesalahan OpenAL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi demi kelengkapan, saya akan mengulanginya di sini. Ada dua </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jenis</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> panggilan API OpenAL: reguler dan kontekstual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Panggilan konteks dimulai dengan </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mirip dengan panggilan OpenGL win32 untuk mendapatkan konteks rendering atau rekan-rekan mereka di Linux. Suara adalah hal yang cukup sederhana untuk semua sistem operasi memiliki panggilan yang sama. Panggilan biasa dimulai dengan </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Untuk mendapatkan kesalahan dalam panggilan kontekstual, kami memanggil </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; dalam hal panggilan biasa, kami menelepon </font></font><code>alGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mereka mengembalikan nilai </font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau nilai </font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang hanya daftar kemungkinan kesalahan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita akan mempertimbangkan hanya satu kasus, tetapi dalam segala hal lainnya mereka hampir sama. </font><font style="vertical-align: inherit;">Mari kita ambil tantangan yang biasa </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pertama, buat makro preprocessor untuk melakukan pekerjaan membosankan dengan melewatkan detail:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alCall(function, ...) alCallImpl(__FILE__, __LINE__, function, __VA_ARGS__)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara teoritis, compiler Anda mungkin tidak mendukung </font></font><code>__FILE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baik </font></font><code>__LINE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tapi, jujur, aku akan terkejut jika itu ternyata begitu. </font></font><code>__VA_ARGS__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunjukkan sejumlah variabel argumen yang dapat diteruskan ke makro ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami menerapkan fungsi yang secara manual menerima kesalahan terakhir yang dilaporkan dan menampilkan nilai yang jelas ke aliran kesalahan standar.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_al_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line)</span>
</span>{<font></font>
    ALenum error = alGetError();<font></font>
    <span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> AL_INVALID_NAME:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_NAME: a bad name (ID) was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_ENUM: an invalid enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_OPERATION:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_OPERATION: the requested operation is not valid"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_OUT_OF_MEMORY: the requested operation resulted in OpenAL running out of memory"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN AL ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak banyak kesalahan yang mungkin terjadi. </font><font style="vertical-align: inherit;">Penjelasan yang saya tulis dalam kode adalah satu-satunya informasi yang akan Anda terima tentang kesalahan ini, tetapi spesifikasi menjelaskan mengapa fungsi tertentu dapat mengembalikan kesalahan tertentu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kami menerapkan dua fungsi templat berbeda yang akan membungkus semua panggilan OpenGL kami.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                alFunction function, 
                Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;
</span>{
    <span class="hljs-keyword">auto</span> ret = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);<font></font>
    check_al_errors(filename,line);<font></font>
    <span class="hljs-keyword">return</span> ret;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada dua di antaranya, karena yang pertama digunakan untuk fungsi OpenAL yang kembali </font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan yang kedua digunakan ketika fungsi mengembalikan nilai yang tidak kosong. </font><font style="vertical-align: inherit;">Jika Anda tidak terlalu familiar dengan templat metaprogramming di C ++, lihat bagian-bagian dari kode c </font></font><code>std::enable_if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mereka menentukan fungsi templat mana yang diimplementasikan oleh kompiler untuk setiap panggilan fungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang sama untuk panggilan </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alcCall(function, device, ...) alcCallImpl(__FILE__, __LINE__, function, device, __VA_ARGS__)</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_alc_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, ALCdevice* device)</span>
</span>{<font></font>
    ALCenum error = alcGetError(device);<font></font>
    <span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> ALC_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_DEVICE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_DEVICE: a bad device was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_CONTEXT:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_CONTEXT: a bad context was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_ENUM: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_OUT_OF_MEMORY: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN ALC ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span> ReturnType, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename,
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line,
                 alcFunction function,
                 ReturnType&amp; returnValue,
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    returnValue = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perubahan terbesar adalah penyertaan </font></font><code>device</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang digunakan semua panggilan </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, serta penggunaan kesalahan gaya </font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>ALC_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mereka terlihat sangat mirip, dan untuk waktu yang sangat lama perubahan kecil dari </font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke </font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rusak parah kode saya dan pemahaman, jadi aku hanya terus membaca tepat di atas itu </font></font><code>c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu saja. </font><font style="vertical-align: inherit;">Biasanya, panggilan OpenAL di C ++ terlihat seperti salah satu opsi berikut:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
alGenSources(<span class="hljs-number">1</span>, &amp;source);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span><font></font>
alcCaptureStart(&amp;device);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz = alGetString(param);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz = alcGetString(&amp;device, param);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi sekarang kita bisa melakukannya seperti ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
<span class="hljs-keyword">if</span>(!alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span>
<span class="hljs-keyword">if</span>(!alcCall(alcCaptureStart, &amp;device))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz;
<span class="hljs-keyword">if</span>(!alCall(alGetString, sz, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz;
<span class="hljs-keyword">if</span>(!alcCall(alcGetString, sz, &amp;device, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini mungkin terlihat aneh bagi Anda, tetapi lebih nyaman bagi saya. </font><font style="vertical-align: inherit;">Tentu saja, Anda dapat memilih struktur yang berbeda.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unduh file .wav</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat mengunduhnya sendiri, atau menggunakan perpustakaan. </font><font style="vertical-align: inherit;">Berikut ini adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementasi open-source untuk memuat file .wav</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Saya gila, jadi saya melakukannya sendiri:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> <span class="hljs-title">convert_to_int</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* buffer, <span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> len)</span>
</span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> a = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::endian::native == <span class="hljs-built_in">std</span>::endian::little)
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">memcpy</span>(&amp;a, buffer, len);
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i)
            <span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">char</span>*&gt;(&amp;a)[<span class="hljs-number">3</span> - i] = buffer[i];
    <span class="hljs-keyword">return</span> a;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">load_wav_file_header</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::ifstream&amp; file,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
                          ALsizei&amp; size)</span>
</span>{
    <span class="hljs-keyword">char</span> buffer[<span class="hljs-number">4</span>];
    <span class="hljs-keyword">if</span>(!file.is_open())
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-comment">// the RIFF</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read RIFF"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"RIFF"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't begin with RIFF)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the size of the file</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read size of file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the WAVE</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read WAVE"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"WAVE"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't contain WAVE)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// "fmt/0"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read fmt/0"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// this is always 16, the size of the fmt data chunk</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read the 16"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// PCM should be 1?</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read PCM"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the number of channels</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read number of channels"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    channels = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// sample rate</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read sample rate"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    sampleRate = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">// (sampleRate * bitsPerSample * channels) / 8</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read (sampleRate * bitsPerSample * channels) / 8"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// ?? dafaq</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read dafaq"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// bitsPerSample</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read bits per sample"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    bitsPerSample = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// data chunk header "data"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data chunk header"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"data"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (doesn't have 'data' tag)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// size of data</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data size"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    size = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">/* cannot be at the end of file */</span>
    <span class="hljs-keyword">if</span>(file.eof())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: reached EOF on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(file.fail())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: fail state set on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">load_wav</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
               ALsizei&amp; size)</span>
</span>{
    <span class="hljs-function"><span class="hljs-built_in">std</span>::ifstream <span class="hljs-title">in</span><span class="hljs-params">(filename, <span class="hljs-built_in">std</span>::ios::binary)</span></span>;
    <span class="hljs-keyword">if</span>(!in.is_open())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not open \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(!load_wav_file_header(in, channels, sampleRate, bitsPerSample, size))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav header of \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">char</span>* data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[size];<font></font>
<font></font>
    in.read(data, size);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> data;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan menjelaskan kodenya, karena ini tidak sepenuhnya dalam subjek artikel kami; </font><font style="vertical-align: inherit;">tetapi sangat jelas jika Anda membacanya secara paralel dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spesifikasi file WAV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inisialisasi dan Penghancuran</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama kita perlu menginisialisasi OpenAL, dan kemudian, seperti programmer yang baik, selesaikan ketika kita selesai bekerja dengannya. </font><font style="vertical-align: inherit;">Hal ini digunakan selama inisialisasi </font></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(catatan bahwa ini </font></font><code>ALC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak</font></font></i> <code>AL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), yang pada dasarnya merupakan sesuatu pada komputer Anda untuk bermain musik dan menggunakan itu latar belakang </font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mirip dengan memilih kartu grafis. </font><font style="vertical-align: inherit;">di mana game OpenGL Anda akan ditampilkan. </font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mirip dengan konteks render yang ingin Anda buat (unik untuk sistem operasi) untuk OpenGL.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alcdevice</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perangkat OpenAL adalah apa suara keluar melalui, apakah itu kartu suara atau chip, tetapi secara teoritis itu bisa menjadi banyak hal yang berbeda. Mirip dengan bagaimana output standar </font></font><code>iostream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat menjadi printer, bukan layar, perangkat dapat berupa file atau bahkan aliran data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, untuk permainan pemrograman, ini akan menjadi perangkat suara, dan biasanya kami ingin itu menjadi perangkat output suara standar dalam sistem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mendapatkan daftar perangkat yang tersedia di sistem, Anda dapat meminta mereka dengan fungsi ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">get_available_devices</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;&amp; devicesVec, ALCdevice* device)</span>
</span>{
    <span class="hljs-keyword">const</span> ALCchar* devices;
    <span class="hljs-keyword">if</span>(!alcCall(alcGetString, devices, device, <span class="hljs-literal">nullptr</span>, ALC_DEVICE_SPECIFIER))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ptr = devices;<font></font>
<font></font>
    devicesVec.clear();<font></font>
<font></font>
    <span class="hljs-keyword">do</span><font></font>
    {<font></font>
        devicesVec.push_back(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(ptr));<font></font>
        ptr += devicesVec.back().size() + <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">while</span>(*(ptr + <span class="hljs-number">1</span>) != <span class="hljs-string">'\0'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini sebenarnya hanya pembungkus pembungkus panggilan </font></font><code>alcGetString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nilai kembali adalah penunjuk ke daftar string yang dipisahkan oleh nilai </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan diakhiri dengan dua nilai </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Di sini, pembungkus hanya mengubahnya menjadi vektor yang nyaman bagi kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untungnya, kita tidak perlu melakukan ini! Dalam kasus umum, seperti yang saya duga, sebagian besar game hanya bisa mengeluarkan suara ke perangkat secara default, apa pun itu. Saya jarang melihat opsi untuk mengubah perangkat audio di mana Anda ingin menghasilkan suara. Karena itu, untuk menginisialisasi Perangkat OpenAL, kami menggunakan panggilan </font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Panggilan ini sedikit berbeda dari yang lainnya, karena tidak menentukan status kesalahan yang dapat diperoleh </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, jadi kami menyebutnya seperti fungsi normal:</font></font><br>
<br>
<pre><code class="cpp hljs">ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
<span class="hljs-keyword">if</span>(!openALDevice)<font></font>
{<font></font>
    <span class="hljs-comment">/* fail */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda telah terdaftar perangkat seperti yang ditunjukkan di atas, dan Anda ingin pengguna untuk memilih salah satu dari mereka, maka Anda perlu untuk mentransfer nama menjadi </font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gantinya </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mengirim </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pesanan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk membuka perangkat secara default</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nilai kembali adalah perangkat yang sesuai, atau </font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika terjadi kesalahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bergantung pada apakah Anda telah menyelesaikan enumerasi atau tidak, kesalahan dapat menghentikan program pada trek. No device = No OpenAL; tidak ada OpenAL = tidak ada suara; tidak ada suara = tidak ada permainan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal terakhir yang kami lakukan ketika menutup program adalah menyelesaikannya dengan benar.</font></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean closed;
<span class="hljs-keyword">if</span>(!alcCall(alcCloseDevice, closed, openALDevice, openALDevice))<font></font>
{<font></font>
    <span class="hljs-comment">/* do we care? */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, jika penyelesaian tidak memungkinkan, maka ini tidak lagi penting bagi kami. Sebelum menutup perangkat, kita harus menutup semua konteks yang dibuat, namun, menurut pengalaman saya, panggilan ini juga melengkapi konteks. Tapi kami akan melakukannya dengan benar. Jika Anda menyelesaikan semua sebelum melakukan panggilan </font></font><code>alcCloseDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka seharusnya tidak ada kesalahan, dan jika karena alasan tertentu mereka muncul, maka Anda tidak dapat melakukan apa-apa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda mungkin telah memperhatikan bahwa panggilan dari </font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengirim dua salinan perangkat. Itu terjadi karena cara fungsi templat bekerja - satu diperlukan untuk pengecekan kesalahan, dan yang kedua digunakan sebagai parameter fungsi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara teoritis, saya dapat meningkatkan fungsi templat sehingga melewati parameter pertama untuk pengecekan kesalahan dan tetap mengirimkannya ke fungsi; </font><font style="vertical-align: inherit;">tapi aku malas melakukannya. </font><font style="vertical-align: inherit;">Saya akan meninggalkan ini sebagai pekerjaan rumah Anda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konteks ALC kami</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian kedua dari inisialisasi adalah konteks. </font><font style="vertical-align: inherit;">Seperti sebelumnya, ini mirip dengan konteks render dari OpenGL. </font><font style="vertical-align: inherit;">Mungkin ada beberapa konteks dalam satu program dan kita dapat beralih di antara mereka, tetapi kita tidak membutuhkan ini. </font><font style="vertical-align: inherit;">Setiap konteks memiliki </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pendengar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumbernya sendiri</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan mereka tidak dapat dilewatkan di antara konteks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin ini berguna dalam perangkat lunak pengolah suara. </font><font style="vertical-align: inherit;">Namun, untuk game dalam 99,9% kasus, hanya satu konteks yang cukup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Membuat konteks baru sangat sederhana:</font></font><br>
<br>
<pre><code class="cpp hljs">ALCcontext* openALContext;
<span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit program */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita perlu berkomunikasi untuk apa yang </font></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ingin kita ciptakan konteks; </font><font style="vertical-align: inherit;">kita juga dapat memberikan daftar pilihan kunci dan nilai </font></font><code>ALCint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang </font><font style="vertical-align: inherit;">diakhiri null </font><font style="vertical-align: inherit;">, yang merupakan atribut yang dengannya konteks harus dibuat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jujur, saya bahkan tidak tahu dalam situasi apa atribut passing berguna. </font><font style="vertical-align: inherit;">Game Anda akan berjalan di komputer biasa dengan fitur suara biasa. </font><font style="vertical-align: inherit;">Atribut memiliki nilai default, tergantung pada komputer, jadi ini tidak terlalu penting. </font><font style="vertical-align: inherit;">Tetapi jika Anda masih membutuhkannya:</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nama atribut</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALC_FREQUENCY</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frekuensi pencampuran ke buffer output, diukur dalam Hz</font></font></td>
</tr>
<tr>
<td><code>ALC_REFRESH</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interval pembaruan, diukur dalam Hz</font></font></td>
</tr>
<tr>
<td><code>ALC_SYNC</code></td>
<td><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunjukkan apakah itu harus konteks yang sinkron atau asinkron</font></font></td>
</tr>
<tr>
<td><code>ALC_MONO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai yang membantu memberi tahu Anda berapa banyak sumber yang akan Anda gunakan yang membutuhkan kemampuan untuk memproses data audio monaural. </font><font style="vertical-align: inherit;">Itu tidak membatasi jumlah maksimum, itu hanya memungkinkan Anda untuk menjadi lebih efektif ketika Anda mengetahui hal ini sebelumnya.</font></font></td>
</tr>
<tr>
<td><code>ALC_STEREO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sama, tetapi untuk data stereo.</font></font></td>
</tr>
</tbody>
</table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda mendapatkan kesalahan, kemungkinan besar ini karena atribut yang Anda inginkan tidak mungkin atau Anda tidak dapat membuat konteks lain untuk perangkat yang didukung; </font><font style="vertical-align: inherit;">ini akan menghasilkan kesalahan </font></font><code>ALC_INVALID_VALUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jika Anda melewati perangkat yang tidak valid, Anda akan mendapatkan kesalahan </font></font><code>ALC_INVALID_DEVICE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi, tentu saja, kami sudah memeriksa kesalahan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menciptakan konteks tidak cukup. </font><font style="vertical-align: inherit;">Kita masih harus membuatnya tetap terkini - sepertinya Windows OpenGL Rendering Context, kan? </font><font style="vertical-align: inherit;">Sama.</font></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
   || contextMadeCurrent != ALC_TRUE)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit or give up on having sound */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penting untuk membuat konteks saat ini untuk operasi lebih lanjut dengan konteks (atau dengan sumber dan pendengar di dalamnya). </font><font style="vertical-align: inherit;">Operasi akan kembali </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, satu-satunya nilai kesalahan yang mungkin ditransmisikan </font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah apa </font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang jelas dari namanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menyelesaikan dengan konteks, mis. </font><font style="vertical-align: inherit;">ketika keluar dari program, perlu bahwa konteksnya tidak lagi saat ini, dan kemudian hancurkan.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>))<font></font>
{<font></font>
    <span class="hljs-comment">/* what can you do? */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span>(!alcCall(alcDestroyContext, openALDevice, openALContext))<font></font>
{<font></font>
    <span class="hljs-comment">/* not much you can do */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu-satunya kesalahan yang mungkin dari </font></font><code>alcDestroyContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah sama dengan </font></font><code>alcMakeContextCurrent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">jika Anda melakukan semuanya dengan benar, maka Anda tidak akan mendapatkannya, tetapi jika Anda melakukannya, maka tidak ada yang dapat dilakukan tentang hal itu.</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa memeriksa kesalahan yang tidak dapat dilakukan oleh sesuatu? </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena saya ingin pesan tentang mereka setidaknya muncul dalam aliran kesalahan, yang bagi kita tidak. </font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalkan itu tidak pernah memberi kita kesalahan, tetapi akan berguna untuk mengetahui bahwa kesalahan seperti itu terjadi pada komputer orang lain. </font><font style="vertical-align: inherit;">Berkat ini, kami dapat mempelajari masalahnya, dan mungkin </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melaporkan bug ke pengembang OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mainkan suara pertama kami</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cukup semua ini, mari kita mainkan suaranya. </font><font style="vertical-align: inherit;">Untuk memulainya, kita jelas membutuhkan file suara. </font><font style="vertical-align: inherit;">Misalnya, yang ini, dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">game yang pernah saya selesaikan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="oembed"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://indiegamedev.net/wp-content/uploads/2020/02/iamtheprotectorofthissystem.wav</font></font></a></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya adalah pelindung sistem ini!</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Jadi, buka IDE dan gunakan kode berikut. Ingatlah untuk memasukkan OpenAL Soft dan menambahkan kode unggah file dan kode pemeriksaan kesalahan yang ditunjukkan di atas.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
    <span class="hljs-keyword">if</span>(!openALDevice)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    ALCcontext* openALContext;<font></font>
    <span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
       || contextMadeCurrent != ALC_TRUE)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
    <span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    ALuint buffer;<font></font>
    alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    ALenum format;<font></font>
    <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_MONO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_MONO16;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_STEREO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_STEREO16;<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
            &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
            &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
            &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
    soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span><font></font>
<font></font>
    ALuint source;<font></font>
    alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
    alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
    alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
    alCall(alSourcei, source, AL_BUFFER, buffer);<font></font>
<font></font>
    alCall(alSourcePlay, source);<font></font>
<font></font>
    ALint state = AL_PLAYING;<font></font>
<font></font>
    <span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
    {<font></font>
        alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
    }<font></font>
<font></font>
    alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>);<font></font>
    alcCall(alcDestroyContext, openALDevice, openALContext);<font></font>
<font></font>
    ALCboolean closed;<font></font>
    alcCall(alcCloseDevice, closed, openALDevice, openALDevice);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilasi! </font><font style="vertical-align: inherit;">Kami menulis! </font><font style="vertical-align: inherit;">Meluncurkan! </font></font><em><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya adalah pengawas sistem ini</font></font></strong></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika Anda tidak mendengar suara, periksa kembali semuanya. </font><font style="vertical-align: inherit;">Jika ada sesuatu yang ditulis di jendela konsol, maka ini harus menjadi output standar dari aliran kesalahan, dan itu penting. </font><font style="vertical-align: inherit;">Fungsi pelaporan kesalahan kami harus memberi tahu kami baris kode sumber yang menghasilkan kesalahan. </font><font style="vertical-align: inherit;">Jika Anda menemukan </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kesalahan, baca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panduan Programmer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spesifikasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk memahami kondisi di mana kesalahan ini dapat dihasilkan oleh suatu fungsi. </font><font style="vertical-align: inherit;">Ini akan membantu Anda mengetahuinya. </font><font style="vertical-align: inherit;">Jika tidak berhasil, maka tinggalkan komentar di bawah artikel asli, dan saya akan mencoba membantu.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unduh data RIFF WAVE</font></font></h3><br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
<span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini mengacu pada kode boot gelombang. </font><font style="vertical-align: inherit;">Yang penting adalah kami menerima data, baik sebagai penunjuk atau dikumpulkan dalam vektor: jumlah saluran, laju pengambilan sampel, dan jumlah bit per sampel.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generasi penyangga</font></font></h3><br>
<pre><code class="cpp hljs">ALuint buffer;<font></font>
alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin terlihat akrab bagi Anda jika Anda pernah membuat buffer data tekstur di OpenGL. Intinya, kami membuat buffer dan berpura-pura hanya ada di kartu suara. Bahkan, kemungkinan besar akan disimpan dalam RAM biasa, tetapi spesifikasi OpenAL mengabstraksi semua operasi ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, nilainya </font></font><code>ALuint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pegangan untuk</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buffer kita. Ingatlah bahwa </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada dasarnya adalah data suara dalam memori kartu suara. Kami tidak lagi memiliki </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akses langsung</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke data ini, karena kami mengambilnya dari program (dari RAM biasa) dan memindahkannya ke kartu suara / chip, dll. OpenGL bekerja dengan cara yang sama, memindahkan data tekstur dari RAM ke VRAM. </font><em><font style="vertical-align: inherit;">Deskriptor</font></em></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ini</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menghasilkan </font></font><code>alGenBuffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini memiliki beberapa kemungkinan nilai kesalahan, yang paling penting adalah </font></font><code>AL_OUT_OF_MEMORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang berarti bahwa kita tidak dapat lagi menambahkan data suara ke kartu suara. </font><font style="vertical-align: inherit;">Anda tidak akan mendapatkan </font><font style="vertical-align: inherit;">kesalahan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika, misalnya, Anda menggunakan buffer tunggal, tetapi Anda perlu mempertimbangkan ini jika Anda </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membuat mesin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentukan format data audio</font></font></h3><br>
<pre><code class="cpp hljs">ALenum format;<font></font>
<font></font>
<span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_MONO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_MONO16;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_STEREO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_STEREO16;<font></font>
<span class="hljs-keyword">else</span><font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
        &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
        &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
        &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data suara berfungsi seperti ini: ada beberapa </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saluran</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan ada ukuran </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit per sampel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Data terdiri dari banyak </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sampel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menentukan jumlah </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sampel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam data audio, kami melakukan hal berikut:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int_fast32_t</span> numberOfSamples = dataSize / (numberOfChannels * (bitsPerSample / <span class="hljs-number">8</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang dapat dikonversi dengan mudah untuk menghitung </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durasi</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data audio:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> duration = numberOfSamples / sampleRate;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi sementara kita tidak perlu tahu juga </font></font><code>numberOfSamples</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, juga </font></font><code>duration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penting untuk mengetahui bagaimana semua informasi ini digunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kembali ke </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- kita perlu memberi tahu OpenAL format data audio. Itu tampak jelas, bukan? Mirip dengan bagaimana kita mengisi buffer tekstur OpenGL, mengatakan bahwa data dalam urutan BGRA dan terdiri dari nilai 8-bit, kita perlu melakukan hal yang sama dalam OpenAL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memberi tahu OpenAL bagaimana menafsirkan data yang ditunjuk oleh pointer yang akan kami lewati nanti, kita perlu mendefinisikan format data. Di bawah </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu dimaksudkan sebagaimana dipahami oleh OpenAL. Hanya ada empat kemungkinan arti. Ada dua nilai yang mungkin untuk jumlah saluran: satu untuk mono, dua untuk stereo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain jumlah saluran, kami memiliki jumlah bit per sampel. </font><font style="vertical-align: inherit;">Itu sama dengan atau </font></font><code>8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, atau </font></font><code>16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan pada dasarnya kualitas suara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi dengan menggunakan nilai-nilai saluran dan bit per sampel, yang telah diinformasikan fungsi beban gelombang kepada kami, kami dapat menentukan mana yang akan </font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan untuk parameter di masa mendatang </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengisi buffer</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan ini, semuanya harus sederhana. </font><font style="vertical-align: inherit;">Kami memuat ke dalam Penyangga OpenAL, yang ditunjuk oleh </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deskriptor</font></font></em> <code>buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">data ditunjukkan oleh ptr </font></font><code>soundData.data()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam ukuran </font></font><code>size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang ditentukan </font></font><code>sampleRate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami juga akan memberi tahu OpenAL format data ini melalui parameter </font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada akhirnya, kami cukup menghapus data yang diterima pemuat gelombang. </font><font style="vertical-align: inherit;">Mengapa? </font><font style="vertical-align: inherit;">Karena kami sudah menyalinnya ke kartu suara. </font><font style="vertical-align: inherit;">Kita tidak perlu menyimpannya di dua tempat dan menghabiskan sumber daya berharga. </font><font style="vertical-align: inherit;">Jika kartu suara kehilangan data, maka kami hanya akan mengunduhnya dari disk dan kami tidak perlu menyalinnya ke CPU atau orang lain.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengaturan sumber</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingatlah bahwa OpenAL pada dasarnya adalah </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pendengar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang mendengarkan suara yang dibuat oleh satu atau lebih </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumber</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nah, sekarang saatnya membuat sumber suara.</font></font><br>
<br>
<pre><code class="cpp hljs">ALuint source;<font></font>
alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
alCall(alSourcei, source, AL_BUFFER, buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejujurnya, tidak perlu mengatur beberapa parameter ini, karena nilai defaultnya cukup cocok untuk kita. Tetapi ini menunjukkan kepada kami beberapa aspek yang dapat Anda coba dan lihat apa yang mereka lakukan (Anda bahkan dapat bertindak dengan cerdik dan mengubahnya dari waktu ke waktu). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama kita menghasilkan sumber - ingat, ini lagi merupakan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pegangan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk sesuatu di dalam OpenAL API. Kami mengatur pitch (nada) agar tidak berubah, gain (volume) dibuat sama dengan nilai asli dari data audio, posisi dan kecepatan diatur ulang; kami </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak mengulang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suara, karena jika tidak, program kami tidak akan pernah berakhir, dan menunjukkan buffer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingat bahwa sumber yang berbeda dapat menggunakan buffer yang sama. </font><font style="vertical-align: inherit;">Misalnya, musuh yang menembak pemain dari tempat yang berbeda dapat memainkan suara tembakan yang sama, jadi kami tidak memerlukan banyak salinan data suara, tetapi hanya beberapa tempat di ruang 3D dari mana suara itu dibuat.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memainkan suara</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alSourcePlay, source);<font></font>
<font></font>
ALint state = AL_PLAYING;<font></font>
<font></font>
<span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
{<font></font>
    alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, kita perlu mulai bermain sumber. </font><font style="vertical-align: inherit;">Cukup telepon </font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu kami membuat nilai untuk menyimpan kondisi </font></font><code>AL_SOURCE_STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumber saat ini dan memperbaruinya tanpa henti. </font><font style="vertical-align: inherit;">Ketika tidak lagi sama, </font></font><code>AL_PLAYING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kita bisa melanjutkan. </font><font style="vertical-align: inherit;">Anda dapat mengubah status </font></font><code>AL_STOPPED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saat selesai membuat suara dari buffer (atau ketika kesalahan terjadi). </font><font style="vertical-align: inherit;">Jika Anda mengatur nilai untuk perulangan </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, suara akan diputar selamanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kita dapat mengubah buffer sumber dan memainkan suara lain. </font><font style="vertical-align: inherit;">Atau memutar ulang suara yang sama, dll. </font><font style="vertical-align: inherit;">Atur saja buffer, gunakan </font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan mungkin </font></font><code>alSourceStop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, jika perlu. </font><font style="vertical-align: inherit;">Dalam artikel berikut kami akan mempertimbangkan ini secara lebih rinci.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembersihan</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kami hanya memutar data audio sekali dan keluar, kami akan menghapus sumber dan buffer yang dibuat sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sisa kode dapat dimengerti tanpa penjelasan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ke mana harus pergi selanjutnya?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengetahui semua yang dijelaskan dalam artikel ini, Anda sudah dapat membuat game kecil! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cobalah untuk membuat Pong</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permainan klasik lainnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bagi mereka lebih banyak tidak diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi ingat! </font><font style="vertical-align: inherit;">Buffer ini hanya cocok untuk suara pendek, kemungkinan besar untuk beberapa detik. </font><font style="vertical-align: inherit;">Jika Anda membutuhkan musik atau akting suara, Anda perlu mengalirkan audio ke OpenAL. </font><font style="vertical-align: inherit;">Kami akan membicarakan ini di salah satu bagian berikut dari serangkaian tutorial.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id488730/index.html">Standar baru Rusia untuk Internet hal-hal, manufaktur pintar dan kota pintar</a></li>
<li><a href="../id488732/index.html">Berbakat Pak Simon: Bagaimana Kemampuan Unik dan Pencetakan 3D Dapat Mengubah Proses Produksi</a></li>
<li><a href="../id488736/index.html">Pekerjaan jarak jauh mendapatkan momentum</a></li>
<li><a href="../id488740/index.html">Panduan Tag HTML Kustom untuk Google Pengelola Tag oleh Simo Ahava</a></li>
<li><a href="../id488742/index.html">Lihat arsitekturnya? Dan saya tidak melihat, tetapi dia</a></li>
<li><a href="../id488748/index.html">Buat aplikasi Todo menggunakan Django. Bagian 1</a></li>
<li><a href="../id488750/index.html">Dinosaur Walk: Dua Komputer Besar abad ke-20</a></li>
<li><a href="../id488752/index.html">Golang + Phaser3 = MMORPG - Kami membuat dasar untuk generasi dunia tanpa akhir</a></li>
<li><a href="../id488754/index.html">Sekaligus: pemeriksaan otomatis ukuran bundel</a></li>
<li><a href="../id488756/index.html">Cara bekerja dengan Google Sheets API (Google Sheets API v4) di R menggunakan paket googlesheets4 baru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>