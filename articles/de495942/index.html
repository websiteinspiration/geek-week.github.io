<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèª ‚ùáÔ∏è üñ§ Sparen Sie Zeit, Nerven und Arbeitsstunden üé¢ üî¨ üç∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unsere Projekte sind in der Regel regional und Kunden in der Regel Ministerien. Neben dem √∂ffentlichen Sektor nutzen aber auch private Organisationen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sparen Sie Zeit, Nerven und Arbeitsstunden</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/barsgroup/blog/495942/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unsere Projekte sind in der Regel regional und Kunden in der Regel Ministerien. </font><font style="vertical-align: inherit;">Neben dem √∂ffentlichen Sektor nutzen aber auch private Organisationen unsere Systeme. </font><font style="vertical-align: inherit;">Es gibt praktisch keine Probleme mit ihnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptprojekte sind also regional und manchmal gibt es Probleme mit ihnen. </font><font style="vertical-align: inherit;">Zum Beispiel sind unsere wertvollen Benutzer mit der Leistung in Regionen ab 20.000 im Begriff, neue Funktionen f√ºr Produktserver bereitzustellen. </font><font style="vertical-align: inherit;">Es ist ein Schmerz ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mein Name ist Ruslan und ich bin daran beteiligt, die Informationssysteme der BARS Group zu eskortieren und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen Killer-Bot f√ºr brutale serielle Datenbankadministratoren zu entwickeln</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Fasten ist nichts f√ºr schwache Nerven - viele Buchstaben und Bilder.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_2/kf/av/_2kfavets7hbt3nwzvy_bd9mqos.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige unserer Anwendungen laufen unter Oracle DBMS. Es gibt Projekte im PostgreSQL-DBMS. Oracle hat eine wunderbare Sache - das Sammeln von Statistiken √ºber die Belastung des DBMS, die die vorhandenen Probleme hervorheben und sogar Empfehlungen zur Beseitigung geben - Automatic Workload Repository (AWR). Zu einem bestimmten Zeitpunkt (n√§mlich zum Zeitpunkt des Schmerzes) baten die Entwickler st√§ndig darum, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWR-Berichte f√ºr die Leistungsanalyse</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu sammeln </font><font style="vertical-align: inherit;">. Wir gingen ehrlich zum DBMS-Server, sammelten Berichte, zogen sie zu uns und schickten sie zur Analyse an die Produktion. Einmal nach dem 5. begann es sich zu belasten ... nach dem 10. - um Irritationen zu verursachen ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eines Tages √§u√üerte einer meiner Kollegen die Idee, dass alles, was mehr als einmal gemacht wird, automatisiert werden sollte. Um ehrlich zu sein, habe ich bis zum Moment des √Ñrgers nicht dar√ºber nachgedacht und versucht, alles zu automatisieren, was automatisiert werden kann, aber oft war es nicht gefragt und eher eine Forschung als eine angewandte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann dachte ich: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Administratoren werden nicht ben√∂tigt, um einen Bericht zu erstellen ..."</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Um einen Bericht zu sammeln, m√ºssen Sie schlie√ülich das SQL-Skript @ $ ORACLE_HOME / rdbms / admin / awrrpt.sql ausf√ºhren und den Bericht vom Server zu uns nehmen ... Oh ja, wir lassen die Entwicklung nicht in den Verkauf gehen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann habe ich die notwendigen Informationen gegoogelt, auf Testbasis eine Funktion aus dem Artikel erstellt, das Skript und ein Wunder gezogen - der Bericht wurde gesammelt und kann lokal gespeichert werden. Erstellte Funktionen, bei denen h√§ufig AWR-Berichte ben√∂tigt wurden, und erkl√§rte den Entwicklern, wie sie verwendet werden sollen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Zeit habe ich in meiner Freizeit nach einem Gespr√§ch mit @BotFather einen Telegramm-Bot f√ºr mich erstellt, nur zum Spa√ü. Ich habe dort eine einfache Funktion vermasselt - um die aktuelle Zeit, die Wechselkurse und das Wetter anzuzeigen, und ihm beigebracht, meiner Frau (damals ein M√§dchen) nach einem Zeitplan Komplimente zu schicken. Vielleicht war das Versenden von Komplimenten zu dieser Zeit die gefragteste Funktion meines Bots, sch√§tzte meine Frau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit. Die Entwickler schreiben uns in Telegramm, wir senden ihnen einen Bericht in Telegramm ... Aber was ist, wenn sie nicht an uns, sondern an den Bot schreiben? In der Tat wird es f√ºr alle besser sein, der Bericht wird schneller und vor allem von uns eingehen. So entstand f√ºr meinen Bot die Idee der ersten begehrten Funktionalit√§t. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe mit der Implementierung begonnen. Ich habe es getan, wie ich es geschafft habe, in PHP (tats√§chlich ist unsere Anwendung in PHP, ich verstehe es mehr als Python). Der Encoder ist so lala von mir, dass ich meinen Code nicht zeige :) Der </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bot lebt in unserem Unternehmensnetzwerk und hat Zugriff auf bestimmte Projekte, einschlie√ülich Zieldatenbanken. Um mich nicht mit den Parametern im Befehl oder im Men√º zu besch√§ftigen, habe ich diese Funktionalit√§t mit einem Gruppenchat mit √úberwachungsbenachrichtigungen verkn√ºpft. So wei√ü der Bot sofort, in welcher Datenbank der Bericht erfasst werden soll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie einen Befehl des Formulars </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ awr N erhalten haben</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn N die Anzahl der vollen Stunden ist, f√ºr die ein Bericht ben√∂tigt wird (standardm√§√üig - 1 Stunde), selbst wenn die Datenbank nicht neu gestartet wird, beginnt der Bot sofort mit der Arbeit, sammelt den Bericht, ver√∂ffentlicht ihn als Webseite und genau dort (fast) genau dort) gibt einen Link zu einem dringend ben√∂tigten Bericht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir folgen dem Link und hier ist der AWR-Bericht: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/yr/tk/kiyrtktigm4qjsumovp2vl4roa0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie erwartet haben die Entwickler diese Berichtsgenerierung bew√§ltigt, jemand hat sich sogar bedankt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Projektmanager aus anderen Regionen die Bequemlichkeit des Teams gesch√§tzt hatten, wollten sie dasselbe, weil sie vor allem </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vom Kunden Luli erhalten, die</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sich um die Leistung und Verf√ºgbarkeit der Systeme sorgen. Anderen Chats wurde ein Bot hinzugef√ºgt. Sie benutzen es immer noch und ich bin froh dar√ºber.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sp√§ter schrieben Kollegen vom CIT dar√ºber, wie wir Berichte sammeln, sie wollten es auch. </font><font style="vertical-align: inherit;">Ich habe sie nicht zu unseren Chats hinzugef√ºgt, sondern einen separaten Chat mit der Erstellung von Berichten nach Zeitplan und auf Anfrage erstellt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ pgBadger</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben andere Anwendungen in PHP in Verbindung mit PostgreSQL. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung der Sammlung des pgBadger-Berichts f√ºr Bed√ºrftige nach demselben Prinzip - in Gruppenchats. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuerst benutzten sie es, aber dann h√∂rten sie auf. </font><font style="vertical-align: inherit;">Funktionsausschnitt als unn√∂tig.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Pflicht</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserer Abteilung gibt es Nachtschichten und dementsprechend gibt es einen Zeitplan. </font><font style="vertical-align: inherit;">Es ist in Google Tables. </font><font style="vertical-align: inherit;">Es ist nicht immer bequem, nach einem Link zu suchen, einen Zeitplan zu √∂ffnen, sich selbst zu √ºberzeugen ... Einer der ehemaligen Kollegen spielte auch mit seinem Telegramm-Bot und f√ºhrte in den Chat unserer Abteilungsbenachrichtigungen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ºber den Beginn einer Dienstschicht f√ºr die Abteilungsmitarbeiter ein.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Bot analysiert den Zeitplan, bestimmt die Telefonzentrale anhand des aktuellen Datums und meldet gem√§√ü Zeitplan oder auf Anfrage, wer heute im Dienst ist. </font><font style="vertical-align: inherit;">Es stellte sich heraus, gro√üartig, bequem. </font><font style="vertical-align: inherit;">Das Nachrichtenformat hat mir zwar nicht wirklich gefallen. </font><font style="vertical-align: inherit;">F√ºr Mitarbeiter einer anderen Abteilung (z. B. Business Center ‚ÄûMedizin‚Äú) sind Informationen zum Dienst in anderen Bereichen nicht unbedingt erforderlich. Sie m√ºssen jedoch wissen, wer bei Problemen in ‚ÄûMedizin‚Äú im Dienst ist. </font><font style="vertical-align: inherit;">Ich beschloss, die Funktionalit√§t auszuleihen, aber zu √§ndern, was mir nicht gefiel. </font><font style="vertical-align: inherit;">Ich habe ein Nachrichtenformat f√ºr mich und andere erstellt und redundante Informationen entfernt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ tnls</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem ‚ÄûTest des Stiftes‚Äú der Automatisierung durch den Telegramm-Bot tauchten viele verschiedene Ideen auf, aber ich wollte die unbedingt notwendigen Dinge tun. Ich beschloss, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statistiken √ºber Berufungen zu f√ºhren.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um auf die Projekte unserer Kunden zugreifen zu k√∂nnen, haben wir den sogenannten ‚ÄûHop Server‚Äú oder den Forwarding Server implementiert. Es werden VPN-Verbindungen hergestellt und dann √ºber ssh Anwendungsports, Datenbanken und andere Zusatzpr√ºfungen an unser lokales Netzwerk weitergeleitet, um den Zugriff auf die Projekte unserer Mitarbeiter ohne Probleme mit VPN-Verbindungen zu erleichtern. Es reicht aus, eine VPN-Verbindung zu unserem Unternehmensnetzwerk herzustellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Statistik der Anrufe deutete darauf hin, dass sie h√§ufig nach dem Fall eines der Tunnel (bei Netzwerkproblemen, z. B. durch Zeit√ºberschreitung) den Zugriff auf das Projekt wiederherstellen. </font><font style="vertical-align: inherit;">In den meisten F√§llen reicht es aus, nur die Verbindung neu zu starten, und alles wird gut. </font><font style="vertical-align: inherit;">Lass es uns selbst machen. </font><font style="vertical-align: inherit;">Hier ist der Befehl: </font></font><br>
<img src="https://habrastorage.org/webt/pq/th/ad/pqthadwkyi0tegqd7tn2qzrpxws.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Durchfallen" zum gew√ºnschten Men√ºpunkt, w√§hlen Sie Ihr Projekt aus, warten Sie eine Minute und alle sind gl√ºcklich und zufrieden ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein Befehl durch eine leichte Bewegung </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bytes und Bits </font><font style="vertical-align: inherit;">empfangen wird, </font><font style="vertical-align: inherit;">stellt der Bot eine Verbindung zum Weiterleitungsserver her und wei√ü im Voraus, welche Weiterleitung neu gestartet werden muss. und macht seinen Job - stellt die Verbindung zum Projekt wieder her. </font><font style="vertical-align: inherit;">Ich habe Anweisungen geschrieben, um solche Probleme selbst zu l√∂sen. </font><font style="vertical-align: inherit;">Und wir wurden nur kontaktiert, wenn das bereitgestellte Tool nicht funktioniert ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ecp_to_pem</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√ºber hinaus haben Statistiken gezeigt, dass es h√§ufig erforderlich ist, die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digitale Signatur von Crypto Pro</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr verschiedene Integrationen </font><b><font style="vertical-align: inherit;">in das PEM-Format</font></b><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">zu konvertieren </font><font style="vertical-align: inherit;">, und wir haben viele davon. Aufgabe: Sie nehmen den Container, kopieren ihn auf einen Windows-Computer mit installiertem P12FromGostCSP-Dienstprogramm (√ºbrigens kostenpflichtig), konvertieren ihn in pfx und konvertieren pfx mit OpenSSL (mit Unterst√ºtzung f√ºr GOST-Verschl√ºsselung) in pem. Nicht sehr praktisch, aber ich m√∂chte es auf Knopfdruck. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google kam wieder zur Rettung. Fand den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nutzen einer freundlichen Person</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Gesammelt, wie in README geschrieben - verdient. Er brachte dem Bot bei, mit dem Dienstprogramm zu arbeiten, und bekam fast sofort eine Konvertierung.</font></font><br>
<img src="https://habrastorage.org/webt/aq/qo/yu/aqqoyu8qmwsrjbske46acai6bie.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Zeitpunkt der endg√ºltigen Implementierung wurde der Befehl erteilt, auf ein neues Verschl√ºsselungsformat umzusteigen - gost-2012. </font><font style="vertical-align: inherit;">Soweit ich mich erinnere, funktionierte das Dienstprogramm in diesem Moment nur mit dem alten GOST (2001). Vielleicht war es im Allgemeinen ein √§hnliches Dienstprogramm eines anderen guten Menschen, an das ich mich nicht genau erinnere. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem √úbergang zum neuen GOST wurde die Funktionalit√§t des Bots aus Sicherheitsgr√ºnden entfernt. </font><font style="vertical-align: inherit;">Implementierte es in einem Docker-Container.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerfile, pl√∂tzlich wer braucht:</font></font></b><div class="spoiler_text"><pre><code class="plaintext hljs">FROM ubuntu:16.04                                                                                                                                                                        <font></font>
RUN apt update &amp;&amp; apt -y install git sudo wget unzip gcc g++ make &amp;&amp; \                       <font></font>
   cd /srv/ &amp;&amp; git clone https://github.com/kov-serg/get-cpcert.git &amp;&amp; \                    <font></font>
   cd get-cpcert &amp;&amp; chmod +x *.sh &amp;&amp; ./prepare.sh &amp;&amp; ./build.sh &amp;&amp; \                        <font></font>
   mkdir -p /srv/{in,out} &amp;&amp; \                                                              <font></font>
   echo '#!/bin/bash' &gt; /srv/getpem.sh &amp;&amp; \                                                 <font></font>
   echo 'cd /srv/get-cpcert' &gt;&gt; /srv/getpem.sh &amp;&amp; \                                         <font></font>
   echo './get-cpcert /srv/in/$CONT.000 $PASS &gt; /srv/out/$CONT.pem' &gt;&gt; /srv/getpem.sh &amp;&amp; \  <font></font>
   chmod +x /srv/getpem.sh                                                                  ENTRYPOINT /srv/getpem.sh</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Konvertieren m√ºssen Sie den Quellcontainer (ein Verzeichnis der Form xxx.000) im Verzeichnis / srv / in ablegen und das fertige PEM in / srv / out abholen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Umwandeln:</font></font><br>
<br>
<pre><code class="plaintext hljs"> docker run -t -i -e CONT='&lt;   ( ".000")&gt;' -e PASS='&lt;  &gt;' -v /srv/in:/srv/in -v /srv/out:/srv/out --name ecptopem &lt;  &gt;/med/ecptopem:latest </code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop und / emstart</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einmal bekam unser Unternehmen einen sehr coolen Oracle-DBA mit mehr Erfahrung in der Verwaltung des DBMS und in der Entwicklung. Und es ist nicht sofort mit einer SSH-Verbindung zu den DBMS-Servern passiert: Entweder wei√ü es nicht, wo und wie eine Verbindung hergestellt werden soll, dann sind die Zugriffe nicht klar beschrieben, es ist unm√∂glich, etwas an sich selbst weiterzuleiten. Wir helfen Ihnen gerne weiter, haben dar√ºber gesprochen, wie eine Verbindung hergestellt werden kann, und haben den Enterprise Manager daf√ºr weitergeleitet. Aber mit ssh hat es immer noch nicht geklappt. Einer der Kollegen erkl√§rte es einfach: DBA Vollblut :) Wir haben uns entschieden, wenn wir etwas auf dem Server festziehen m√ºssen, werden wir es selbst tun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EM st√ºrzt unter starker Last ab und startet es neu ... Sie m√ºssen eine Verbindung √ºber ssh herstellen und √ºber das Terminal neu starten. </font><font style="vertical-align: inherit;">"Administratoren wissen das gut", entschied unser neuer Kollege. </font><font style="vertical-align: inherit;">Gro√üe Belastungen des DBMS sind bei uns keine Seltenheit, auch Anfragen zum Neustart von EM sind h√§ufig. </font><font style="vertical-align: inherit;">Dann das gleiche Szenario: Spannung, Irritation und die Suche nach einer L√∂sung f√ºr das Problem. </font><font style="vertical-align: inherit;">In derselben Gruppe erschienen also Chats mit dem Befehl: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ emstop und / emstart.</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/kk/yd/8j/kkyd8jikdyflvrkkoqvyens8dym.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich t√∂te</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei starker Konkurrenz an der Basis, und dies passiert manchmal, m√ºssen Sie die Datenbank schnell entladen. </font><font style="vertical-align: inherit;">Der schnellste Weg ist, den problematischen Prozess zu beenden ... Um dies zu tun, verbinden Sie sich √ºber ssh, t√∂ten Sie -9 ... Der Bot wird helfen! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jb/8q/cs/jb8qcsft8ce6jp5e7rijqtvcjti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexey sch√§tzte das Team und gab ihm einen liebevollen Namen - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Kilyalka"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder eine Waffe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einmal, nachdem ich gesehen hatte, wie Alex es versucht und leidet, entschied ich mich jedes Mal, wenn ich xxx f√ºr jeden der Prozesse betrete / t√∂tete, unserer Waffe ‚ÄûMultilateralismus‚Äú hinzuzuf√ºgen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/sc/kh/5dsckh_3qe5lhmvhop1pmxkt1hk.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist besser! </font><font style="vertical-align: inherit;">Alles f√ºr dich, Alex, arbeite einfach, Liebes! </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich wurde der Zugriff auf einen so wichtigen Befehl </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch user_id - "Schutz gegen den Narren" - eingeschr√§nkt.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Als Lesha sah, wie geschickt Prozesse auf dem Datenbankserver ausgef√ºhrt wurden, versuchten mehrere Personen, einen Befehl mit einer zuf√§lligen Prozessnummer einzugeben, aber Sie k√∂nnen meinen intelligenten Bot nicht t√§uschen. Er lehnte dies sofort ab.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, nur f√ºr den Fall, ich habe einen Befehl gegeben: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ alertlog &lt;Anzahl der Zeilen&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die angegebene Anzahl der Zeilen abrufen alertlog'a Der </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bot </font><font style="vertical-align: inherit;">ruft das </font><font style="vertical-align: inherit;">Alertlog ab und sendet es an unseren Dienst, z. B. Pastebin, genannt pyste, und sendet einen Link zum Einf√ºgen an den Anforderungs-Chat.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ pr√ºft</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann kam eine Anfrage, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um die tats√§chliche Leistung unserer Anwendung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu </font><b><font style="vertical-align: inherit;">√ºberwachen.</font></b><font style="vertical-align: inherit;"> Bisher hat der technische Support des Projekts diese Daten von Hand gesammelt. Kein Deal! Unsere tapferen Tester haben hierf√ºr Testf√§lle entwickelt. Das resultierende Testprotokoll ist nicht sehr bequem zu lesen, ein unerfahrener Benutzer wird es lange verstehen und nicht die Tatsache, dass er die erforderlichen Informationen hervorhebt. Und wir machen nicht gerne mit unseren H√§nden, was wir nicht mit unseren H√§nden machen k√∂nnen ... Eine neue Aufgabe f√ºr den Bot! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/--/u6/1l/--u61ld0yk0fljkwuerjn3g8zsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Befehl / tests zeigt ein einfaches und eindeutiges Men√º an. Diesmal haben unsere Jungs gelernt, wie man diesen Befehl ohne Anweisungen verwendet! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie anstelle des Men√ºs das gew√ºnschte Element ausw√§hlen, wird eine Benachrichtigung √ºber den Start des Tests angezeigt, damit ungeduldige Benutzer unseren Test nicht 100500 Mal ausf√ºhren:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/xv/sv/j7xvsv_byo8gdw7y3qweig15msq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abh√§ngig vom ausgew√§hlten Men√ºpunkt wird ein bestimmter Test von unserem Netzwerk aus gestartet, und zwar von der Maschine, auf der sich der Bot befindet (jmeter ist dort vorkonfiguriert, die erforderlichen Tests werden platziert ...) oder sofort vom Rechenzentrum (von der vorbereiteten Maschine neben der Anwendung), so dass beim Testen Beseitigen Sie Netzwerkverz√∂gerungen oder minimieren Sie sie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Abschluss des Tests und Erhalt des Protokolls analysiert der Bot es und zeigt das Ergebnis in einer f√ºr Menschen lesbaren Form an:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7w/xp/s8/7wxps8jupg80bbq_uuywyz1-gag.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metriksammlung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktionalit√§t wurde ‚Äûeingegeben‚Äú und die Projektmanager, die dies w√ºnschen, haben eine solche Funktion f√ºr ihre Regionen erhalten. Und ein mitf√ºhlender Projektmanager sagte: ‚ÄûIch m√∂chte Statistiken rechtzeitig haben!‚Äú Jemand vom CIT sagte ihr, dass es bequem w√§re, all dies in Zabbix zu √ºberwachen. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zabbix, also Zabbix ...</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ich dachte, es w√§re notwendig, sich auf die Notwendigkeit vorzubereiten, die L√∂sung zu duplizieren ... Ich entwarf die Idee in einem Docker-Container. Im Container wird gem√§√ü dem Zeitplan (alle 10 Minuten) jmeter gestartet, das Protokoll an einer bestimmten Stelle hinzugef√ºgt, von PHP analysiert und die erforderlichen Daten in Form einer Webseite angezeigt. Zabbix verwendet den Schl√ºssel web.page.get, um diese Seite abzurufen, w√§hlt regelm√§√üig die erforderlichen Daten f√ºr bestimmte abh√§ngige Elemente aus und erstellt ein Diagramm.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oq/aq/cd/oqaqcdqj2mjodianmnwmrucyix8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint, dass es nicht schlecht geworden ist. </font><font style="vertical-align: inherit;">Wenn wir das Diagramm betrachten, sehen wir zun√§chst die ungef√§hre Geschwindigkeit der Anwendung. Wenn im Diagramm Spitzen festgestellt werden, wissen wir ungef√§hr, wo sich der ‚ÄûStecker‚Äú befindet. </font><font style="vertical-align: inherit;">Alles ist einfach. </font><font style="vertical-align: inherit;">Bisher hat sich herausgestellt, dass es nur f√ºr eine Region gefragt ist, aber ich bin bereit, es f√ºr diejenigen zu replizieren, die es w√ºnschen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anwendungsentwicklung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Statistiken √ºber Aufgaben des gleichen Typs haben vor nicht allzu langer Zeit Ideen zur Vereinfachung und Erleichterung der Arbeit hervorgebracht. Bei einigen Projekten auf Anwendungsservern m√ºssen die wichtigsten Crypto Pro-Container installiert werden. Es gibt viele davon, und die digitale Signatur l√§uft mit der Zeit ab. Manchmal ‚Äûfliegen‚Äú 2 Aufgaben pro Tag. Ich hielt es jedoch f√ºr unsicher, den Bot f√ºr diese Zwecke zu verwenden, und entschied, dass ich die Funktionalit√§t direkt in der Anwendung ausf√ºhren w√ºrde. Nat√ºrlich mit Autorisierung und Zugangskontrolle. Wenn Sie √ºber die erforderlichen Berechtigungen verf√ºgen, steht ein zus√§tzlicher Men√ºpunkt zum Arbeiten mit digitalen Signaturen, Installieren, Entfernen, Anzeigen von Informationen usw. zur Verf√ºgung. Derzeit befindet sich die Funktionalit√§t in der Entwicklung. Wie sich herausstellte, ist dies nicht sehr schwierig. Sie m√ºssen die Anweisungen ein wenig lesen, sich Codebeispiele ansehen, erfahrenere Kollegen in der Entwicklung fragen und los geht's.W√§hrend des Forschungsprozesses tauchten Ideen f√ºr die Erg√§nzung der Anwendung auf. Ich werde keine napoleonischen Pl√§ne aufbauen - es gibt Entwicklung, lassen Sie jeden sein eigenes Ding machen. Aber im Moment ist es interessant - ich mache es selbst.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pl√§ne</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie gesagt, viele verschiedene Ideen wurden f√ºr die Verwendung unseres Bots geboren und nicht nur - im Allgemeinen, sagen wir, Ideen f√ºr ‚ÄûAutomatisierungspunkte‚Äú, viele davon wurden vergessen, weil ich keine Zeit hatte, sie aufzuschreiben. </font><font style="vertical-align: inherit;">Jetzt versuche ich, alles aufzuschreiben, was mir in den Sinn kommt, und ich empfehle anderen, dasselbe zu tun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber Alex vergisst nicht, seine Wunschliste zu werfen. </font><font style="vertical-align: inherit;">Von letzterem: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_sql SQL_ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - alle Sitzungen mit einer solchen SQL_ID-Abfrage beenden </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ kill_block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die Root-Blocking-Sitzung </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beenden / show_em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Performance-Bild </font><b><font style="vertical-align: inherit;">anzeigen</font></b><font style="vertical-align: inherit;"> EM </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trick, DBA-Stich vom Telefon aus = = </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So arbeiten wir zum Wohl des Mutterlandes! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wie retten Sie sich vor routinem√§√üigen und uninteressanten Aufgaben?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, die Lekt√ºre erwies sich als interessant und vielleicht sogar f√ºr jemanden n√ºtzlich, und ich hatte keine Zeit, den Leser zu erm√ºden ... Viel Gl√ºck f√ºr uns alle.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495924/index.html">Warum ist es so verdammt schwierig, ein gutes COVID-19-Verteilungsmodell zu erstellen?</a></li>
<li><a href="../de495926/index.html">Wir schreiben Firmware f√ºr TI cc2530 auf Z-Stack 3.0 f√ºr ZigBee Sonoff BASICZBR3 Relais mit ds18b20 Sensor</a></li>
<li><a href="../de495932/index.html">Was ist die verborgene Bedeutung der Autoren im SCRUM-Handbuch? Teil 1. √úber den Prozess</a></li>
<li><a href="../de495934/index.html">DataGovernance zu Hause</a></li>
<li><a href="../de495938/index.html">Eine Auswahl von Artikeln zum maschinellen Lernen: F√§lle, Leitf√§den und Studien f√ºr M√§rz 2020</a></li>
<li><a href="../de495944/index.html">Aktualisiert TOP50 (Bewertung von CIS-Supercomputern): Dynamik und Trends</a></li>
<li><a href="../de495946/index.html">Norbert Wiener: der abgelenkte Vater der Kybernetik</a></li>
<li><a href="../de495948/index.html">Rost eingebettet. Entwicklung f√ºr Cortex-M3-Prozessoren mit der Debug-Karte STM32F103C8T6 (Black Pill)</a></li>
<li><a href="../de495954/index.html">Wie arbeitet Cisco seit 20 Jahren im Fernzugriffsmodus und ohne Perimeter?</a></li>
<li><a href="../de495956/index.html">Muss schnell los. Optimieren von IMAP-E-Mail-Inhaltsanforderungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>