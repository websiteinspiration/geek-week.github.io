<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö∂üèæ üëâüèæ üë©üèª‚Äçüî¨ ¬øQu√© es Windows PowerShell y qu√© come? Parte 5: acceso a objetos externos üß• üí∞ ‚òòÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los sistemas operativos Windows admiten una variedad de infraestructuras de objetos. Puede utilizar interfaces de programaci√≥n de aplicaciones (API) p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>¬øQu√© es Windows PowerShell y qu√© come? Parte 5: acceso a objetos externos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/498478/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los sistemas operativos Windows admiten una variedad de infraestructuras de objetos. </font><font style="vertical-align: inherit;">Puede utilizar interfaces de programaci√≥n de aplicaciones (API) para acceder a ellas, pero el desarrollo de aplicaciones completas no siempre est√° justificado. </font><font style="vertical-align: inherit;">PowerShell tiene cmdlets especiales que le permiten acceder a objetos .NET, COM, WMI (CIM) y ADSI de forma interactiva. </font><font style="vertical-align: inherit;">En la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuarta parte de la serie,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aprendimos los conceptos b√°sicos con un enfoque en las clases de .NET Core, y ahora queremos profundizar en el tema y comprender las caracter√≠sticas de la interacci√≥n de PowerShell con objetos externos.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabla de contenido:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con JSON, XML y CSV </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con WMI y CIM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con objetos COM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con servicio de directorio ADSI </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formateo de salida</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabaja con JSON, XML y CSV</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los scripts de PowerShell, a menudo tiene que analizar datos JSON, XML y CSV. Por lo general, esta necesidad surge cuando se trabaja con servicios de Internet o con archivos de configuraci√≥n. Algunos administradores intentan analizar datos usando expresiones regulares, pero no es necesario hacer tales sacrificios: PowerShell tiene cmdlets especiales para la conversi√≥n, adem√°s, en ambas direcciones.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ep/q6/tr/epq6trkxgw_sfw21p1wmfixyrfk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El formato JSON le permite describir una variedad de objetos y, en esencia, es una tabla hash que se puede anidar. </font><font style="vertical-align: inherit;">Convertir un objeto JSON en un objeto .NET en consecuencia usando PowerShell es f√°cil. </font><font style="vertical-align: inherit;">Dado que los servicios de Internet generalmente dan una l√≠nea muy larga en lugar de un archivo con un formato hermoso, esta conversi√≥n tambi√©n puede ser √∫til para trabajar en modo interactivo. </font><font style="vertical-align: inherit;">En el siguiente ejemplo, utilizamos una variable de texto de varias l√≠neas para describir el objeto JSON:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-string">@"
{
   "firstName": "Ivan",
   "lastName": "Danko",
   "address": {
       "streetAddress": "Kremlin",
       "city": "Moscow"
   },
   "phoneNumbers": [
       "+7 495 1234567",
       "+7 499 1234567"
   ]
}
"@</span> | <span class="hljs-built_in">ConvertFrom-Json</span>
</code></pre><br>
<img src="https://habrastorage.org/webt/vu/2j/x6/vu2jx6vrks90qvsuoehs6ky43ke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El problema inverso se resuelve de manera similar:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$file</span> = <span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\notepad.exe
<span class="hljs-variable">$file</span>.VersionInfo | <span class="hljs-built_in">ConvertTo-Json</span></code></pre><br>
<img src="https://habrastorage.org/webt/rd/tb/dq/rdtbdqlfwsepqmnggw_2uk7omkw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La cadena de formato JSON resultante es f√°cil de enviar a otra aplicaci√≥n a trav√©s de la red. </font><font style="vertical-align: inherit;">Puede ser, por ejemplo, alg√∫n servicio RESTful. </font><font style="vertical-align: inherit;">Trabajar con los cmdlets ConvertFrom-Csv, ConvertTo-Csv y ConvertTo-Xml est√° construido de la misma manera, sugerimos a los lectores que lo estudien ellos mismos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para trabajar con XML y CSV, necesitaremos otros cmdlets: con </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jz/hy/m7/jzhym7nqvb5id7fvdys9ao59meq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
estas herramientas, debe comprender que la conversi√≥n de un objeto binario a un formato de texto solo guarda el valor de sus propiedades, pero no los m√©todos. </font><font style="vertical-align: inherit;">La conversi√≥n de datos JSON, XML o CSV a un objeto .NET usando PowerShell solo es posible si es v√°lida.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabaja con WMI y CIM</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows Management Instrumentation (WMI) es una implementaci√≥n desarrollada por Microsoft y adaptada a Windows del est√°ndar WBEM (Web-Based Enterprise Management). Se basa en la idea de crear una soluci√≥n universal para monitorear el entorno de informaci√≥n distribuida de una empresa y administrar sus componentes. La estructura de datos WBEM, a su vez, se basa en el Modelo de Informaci√≥n Com√∫n (CIM), que implementa un enfoque orientado a objetos para la representaci√≥n de sistemas inform√°ticos. Se ha descontinuado el desarrollo y soporte de WMI en Windows; Microsoft recomienda usar un mecanismo similar para administrar la infraestructura: los objetos CIM. Para trabajar con ellos, aparecieron cmdlets especiales en PowerShell 3.0, que consideraremos en paralelo con sus hom√≥logos de WMI. Si el c√≥digo contiene llamadas de cmdlet para trabajar con WMI, debe reescribirse si es posible.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h6/io/mw/h6iomwnjjrssdkl_tw7gi0mwjhm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro del marco del modelo CIM (tambi√©n se usa en WMI), los datos del sistema operativo se presentan en forma de clases con propiedades y m√©todos. Las clases se agrupan en orden jer√°rquico y l√≥gicamente relacionado por tecnolog√≠a de espacio de nombres o √°rea de gesti√≥n. Hay un espacio de nombres ra√≠z ra√≠z que tiene subespacios: CIMv2, Predeterminado, Secutiry y WMI. Para la identificaci√≥n inequ√≠voca de una instancia de una clase (objeto) y la descripci√≥n del estado del recurso correspondiente, se utilizan las propiedades de clase, que generalmente son de solo lectura. Los m√©todos se utilizan para administrar el recurso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede acceder a la instancia de clase mediante la ruta completa, que tiene la siguiente forma:</font></font><br>
<br>
<pre><code class="powershell hljs">[\\<span class="hljs-type">ComputerName</span>\<span class="hljs-type">NameSpace</span>][:<span class="hljs-type">ClassName</span>][<span class="hljs-type">.KeyProperty1</span>=<span class="hljs-type">Value1</span>][,<span class="hljs-type">KeyProperty2</span>=<span class="hljs-type">Value2</span>]‚Ä¶]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
donde </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ComputerName es el nombre de la computadora; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NameSpace - espacio de nombres; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ClassName: el nombre de la clase; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KeyProperty1 = Value1, KeyProperty2 = Value2: las propiedades del objeto y los valores con los que se identifica.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de PowerShell, no exist√≠a una herramienta WMI simple. </font><font style="vertical-align: inherit;">Para acceder a los objetos, ten√≠a que escribir programas bastante complejos en lenguajes de alto nivel (C ++, Visual Basic, Java Script) o estudiar el shell WMIC (l√≠nea de comandos WMI, que tambi√©n se descontinu√≥) con su propio lenguaje. </font><font style="vertical-align: inherit;">A trav√©s de PowerShell, el usuario promedio puede acceder a los objetos WMI desde la l√≠nea de comandos o en scripts. </font><font style="vertical-align: inherit;">Primero, con√©ctese al subsistema WMI y obtenga una lista de clases disponibles mediante el cmdlet Get-WmiObject (alias gwmi). </font><font style="vertical-align: inherit;">Para obtener una lista de clases CIM, use el cmdlet Get-CimClass.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-List</span></code></pre><br>
<img src="https://habrastorage.org/webt/g7/1z/wz/g71zwzueejpnyrgwqkoqpxlwn7a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hemos enumerado las clases en la computadora local, pero puede conectarse al control remoto:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> IP- 
<span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-ComputerName</span> _</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> IP- <span class="hljs-literal">-List</span>
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-ComputerName</span> _ <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De forma predeterminada, los cmdlets Get-CimClass y Get-WmiObject se conectan al espacio de nombres Root \ CIMV2, que almacena una gran cantidad de clases para administrar el sistema. </font><font style="vertical-align: inherit;">Para cambiar el espacio de nombres, use el par√°metro -Namespace:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimClass</span> <span class="hljs-literal">-Namespace</span> Root
<span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Namespace</span> Root <span class="hljs-literal">-List</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conociendo el nombre de la clase, no es dif√≠cil obtener instancias de ella. </font><font style="vertical-align: inherit;">El siguiente comando devuelve todas las instancias de Win32_Service, es decir </font><font style="vertical-align: inherit;">Servicios registrados en la m√°quina local:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al igual que con otros tipos de objetos, se muestra una lista de propiedades y m√©todos con Get-Member. </font><font style="vertical-align: inherit;">Se puede acceder a los m√©todos de objetos WMI directamente o mediante el cmdlet Invoke-WmiMethod. </font><font style="vertical-align: inherit;">Tambi√©n puede usar cmdlets para objetos WMI para ordenar, filtrar, agrupar, etc.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> Win32_Service | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/pq/rn/nk/pqrnnkbv1abfqzn5hlnsgunzamu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obtener objetos CIM (instancias de clases), use el cmdlet Get-CimInstance. </font><font style="vertical-align: inherit;">A diferencia de WMI, los objetos CIM resultantes (objeto resultante o instancias de clase) no contienen m√©todos de clase. </font><font style="vertical-align: inherit;">Como no puede extraer directamente un m√©todo, debe invocar el cmdlet Invoke-CimMethod. </font><font style="vertical-align: inherit;">Considere la clase Win32_Service (servicios que se ejecutan en el sistema) y su instancia para el servicio de cola en la m√°quina local:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> </code></pre><br>
<img src="https://habrastorage.org/webt/qm/jf/cz/qmjfcz-_u-le6js9tibb3qc5y2i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos la estructura del objeto resultante:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-CimInstance</span> Win32_service <span class="hljs-literal">-filter</span> <span class="hljs-string">"Name='spooler'"</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/t4/uo/ub/t4uoublc7mxrlb6khyrycfozod4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este punto, los beneficios de los cmdlets para trabajar con objetos CIM no son obvios. </font><font style="vertical-align: inherit;">Se relacionan principalmente con el trabajo remoto en un entorno distribuido y se discutir√°n en detalle en el √∫ltimo art√≠culo de la serie dedicado a resolver problemas pr√°cticos de administraci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n hay un kit de herramientas espec√≠fico de WMI: WMI Query Language (WQL), un lenguaje de consulta similar a SQL. </font><font style="vertical-align: inherit;">Una consulta WQL para buscar todas las nuevas empresas al iniciar un sistema de servicio se ve as√≠:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">select</span> * from win32_service <span class="hljs-built_in">where</span> startmode=<span class="hljs-string">"Auto"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde PowerShell, se ejecutan de la siguiente manera:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-WmiObject</span> <span class="hljs-literal">-Query</span> <span class="hljs-string">'select * from win32_service where startmode="Auto"'</span></code></pre><br>
<img src="https://habrastorage.org/webt/wc/y7/wf/wcy7wfk7619yx_9es0cjz9bi4vw.png"><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajar con objetos COM</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para garantizar la interacci√≥n entre aplicaciones en Windows, se desarroll√≥ una tecnolog√≠a para vincular e incrustar objetos (Object Linking and Embedded u OLE). M√°s tarde, apareci√≥ la tecnolog√≠a de automatizaci√≥n OLE, con la ayuda de la cual las aplicaciones cliente de automatizaci√≥n pod√≠an llamar funciones de otras aplicaciones: servidores de automatizaci√≥n. OLE y OLE Automation se basaron en la tecnolog√≠a central del Modelo de objetos componentes (COM), que ofrece un √∫nico est√°ndar binario para componentes de software. Los objetos creados con √©l y registrados en el sistema operativo se pueden usar en otras aplicaciones usando archivos ejecutables o bibliotecas din√°micas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mediados de los noventa, en lugar de OLE, comenz√≥ a usarse otro t√©rmino: ActiveX. </font><font style="vertical-align: inherit;">Antes de la llegada de la plataforma .NET, la tecnolog√≠a ActiveX se consideraba clave, y los objetos COM todav√≠a se utilizan activamente para integrar aplicaciones en Windows: muchos productos de Microsoft y de terceros son servidores de automatizaci√≥n y proporcionan acceso a sus servicios a trav√©s de ellos. </font><font style="vertical-align: inherit;">Para acceder a los objetos, se utiliza ProgID, un identificador simb√≥lico que se les asigna al registrarse en el registro de Windows. </font><font style="vertical-align: inherit;">Tiene la siguiente forma:</font></font><br>
<br>
<pre><code class="powershell hljs">_..</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La versi√≥n generalmente no est√° indicada:</font></font><br>
<br>
<pre><code class="powershell hljs">_.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algunos ejemplos de ProgID disponibles son: InternetExplorer.Application (aplicaci√≥n de Internet Explorer), Word.Application (aplicaci√≥n de Microsoft Word), WScript.Shell (clase Shell del modelo de objeto de servidor de script de Windows o WSH). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede crear una instancia del objeto con el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmdlet New-Object</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descrito en el art√≠culo anterior </font><font style="vertical-align: inherit;">y ver su estructura con Get-Member:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> WScript.Shell
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/bk/s5/fh/bks5fhq3q-yhle1fwb4-vjkqpk0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para trabajar con objetos, se utilizan propiedades y m√©todos. </font><font style="vertical-align: inherit;">Digamos, para crear un acceso directo en el escritorio del usuario, debe llamar al m√©todo CreateShortcut ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> = <span class="hljs-variable">$myshell</span>.CreateShortcut(<span class="hljs-string">"<span class="hljs-variable">$Home</span>\Desktop\Home.lnk"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que el acceso directo tambi√©n es un objeto COM:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/05/d8/4_/05d84_-mbzmfuffczrmr76khfyg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos queda completar sus propiedades y guardar:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$link</span>.TargetPath = <span class="hljs-variable">$Home</span>
<span class="hljs-variable">$link</span>.Save()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De esta manera, creamos un acceso directo en el escritorio del usuario activo, y ahora analizaremos el trabajo con servicios de automatizaci√≥n externos utilizando el ejemplo del objeto COM Shell.Application. </font><font style="vertical-align: inherit;">Con √©l, puede automatizar algunas acciones en el Explorador de Windows:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-ComObject</span> Shell.Application</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
o para abreviar:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>=<span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-com</span> Shell.Application
<span class="hljs-variable">$myshell</span> | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/__/iu/qy/__iuqyjf29nliwugz-jybihkfj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El objeto Shell.Application tiene bastantes m√©todos diferentes de administraci√≥n de ventanas. </font><font style="vertical-align: inherit;">Por ejemplo, para mostrar el contenido de un directorio dado, se utiliza Explore ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Explore(<span class="hljs-string">"c:\"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se llama al sistema de ayuda utilizando el m√©todo Ayuda ():</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Help()</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n hay tres m√©todos para invocar cuadros de di√°logo de b√∫squeda: FindFiles (), FindComputer () y FindPrinter ().</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.FindFiles()
<span class="hljs-variable">$myshell</span>.FindComputer()
<span class="hljs-variable">$myshell</span>.FindPrinter()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede abrir el cuadro de di√°logo de inicio del programa utilizando el m√©todo FileRun (), y para llamar a la ventana de configuraci√≥n de fecha / hora, necesita el m√©todo SetTime (). </font><font style="vertical-align: inherit;">Existen, por ejemplo, m√©todos para abrir la ventana de configuraci√≥n de la barra de tareas, elementos del panel de control que indican uno de los archivos cpl disponibles, para administrar ventanas abiertas:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.MinimizeAll()
<span class="hljs-variable">$myshell</span>.UndoMinimizeAll()
<span class="hljs-variable">$myshell</span>.TileHorizontally()
<span class="hljs-variable">$myshell</span>.TileVertically()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El m√©todo Windows () le permite acceder a la colecci√≥n de ventanas abiertas en Explorer o en Internet Explorer. </font><font style="vertical-align: inherit;">Veamos las propiedades y m√©todos disponibles para esta colecci√≥n:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$myshell</span>.Windows() | <span class="hljs-built_in">Get-Member</span></code></pre><br>
<img src="https://habrastorage.org/webt/dq/ls/yo/dqlsyokgkrtk6rc-okuskmpwsvo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay otros objetos COM √∫tiles, cuyo n√∫mero depende del software instalado en el sistema. </font><font style="vertical-align: inherit;">√ârase una vez, la principal herramienta de automatizaci√≥n en Windows se consideraba el servidor de script WSH, cuyo modelo de objetos incluye objetos COM: dise√±ado para trabajar con las funciones de red de WScript.Network y WScript.Shell que ya mencionamos. </font><font style="vertical-align: inherit;">Este √∫ltimo no solo crea accesos directos en el escritorio, con su ayuda puede, por ejemplo, mostrar ventanas de informaci√≥n con mensajes y botones, cambiar entre aplicaciones, iniciar programas o simular pulsaciones de teclas.</font></font><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajando con el servicio de directorio ADSI</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, un cat√°logo se refiere a una fuente de informaci√≥n en la que se almacenan datos sobre algunos objetos. Por servicio de directorio, nos referimos a parte de un sistema inform√°tico distribuido que le permite acceder y manipular objetos almacenados. Un servicio de directorio puede combinar datos sobre objetos de red y los servicios que los manipulan: representa un √∫nico punto de entrada para interactuar con los recursos de la red. Puede haber muchos de estos servicios en una red inform√°tica heterog√©nea: un SAM (Security Account Manager) local para computadoras que no son de dominio, Active Directory, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La interacci√≥n con diferentes servicios de directorio requiere diferentes herramientas, lo que crea ciertos inconvenientes. A partir de Windows 2000, Microsoft introdujo la tecnolog√≠a unificada de Interfaz de servicio de Active Directory (ADSI) para sistemas operativos que no depende de un protocolo de acceso a la red espec√≠fico. Para buscar objetos, se define un espacio de nombres para el directorio. Debido a que diferentes servicios de directorio usan diferentes m√©todos de nomenclatura, ADSI define una convenci√≥n que identifica de manera √∫nica cualquier objeto. Se introduce el concepto de cadenas de enlace de dos partes o ADsPath. La primera parte del nombre define el servicio de directorio (proveedor ADSI) y la segunda, la ubicaci√≥n del objeto en el directorio. Aqu√≠ hay ejemplos de designaci√≥n de diferentes proveedores ADSI: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDAP: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilizado para servicios de directorio basados ‚Äã‚Äãen LDAP, incluidos </font><font style="vertical-align: inherit;">para Active Directory; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinNT: //</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usado para computadoras locales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay cmdlets especiales para trabajar con ADSI en PowerShell. </font><font style="vertical-align: inherit;">En su lugar, se utiliza el operador de conversi√≥n [ADSI] seguido de una cadena de enlace. </font><font style="vertical-align: inherit;">Por ejemplo, para conectarse al usuario Ivanov desde el dominio test.ru, se necesita la siguiente construcci√≥n:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"LDAP://CN=Ivanov,DC=TEST,DC=RU"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para trabajar con cuentas locales, deber√° conectarse a la computadora con el nombre correspondiente (para conectarse a la computadora local, solo use el punto en lugar del nombre):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$computer</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://."</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, cree un nuevo usuario, Ivanov, en la m√°quina local:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user</span> = <span class="hljs-variable">$computer</span>.Create(<span class="hljs-string">"user"</span>,<span class="hljs-string">"Ivanov"</span>)
<span class="hljs-variable">$user</span>.Put(<span class="hljs-string">"Description"</span>,<span class="hljs-string">"  PowerShell"</span>)
<span class="hljs-variable">$user</span>.SetInfo()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora con√©ctese a √©l:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$user1</span> = [<span class="hljs-type">ADSI</span>]<span class="hljs-string">"WinNT://./Ivanov,user"</span>
<span class="hljs-variable">$user1</span>.Description</code></pre><br>
<img src="https://habrastorage.org/webt/pb/9l/5m/pb9l5mpw09oocoetnw3x4iawzmm.png"><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formato de salida</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El trabajo interactivo a menudo requiere mostrar datos. En otros shells, los comandos y las utilidades se dedican a formatear la salida, pero los objetos binarios devueltos por las funciones y los cmdlets generalmente no saben c√≥mo hacerlo. En PowerShell, la salida est√° formateada por cuatro cmdlets especiales que alimentan objetos a trav√©s de la tuber√≠a. Se puede obtener informaci√≥n m√°s detallada utilizando Get-Help: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Table</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> formatea la salida en forma de una tabla cuyas columnas contienen los valores de las propiedades del objeto o los valores calculados. Se admite la capacidad de agrupar datos; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-List</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muestra el objeto como una lista de propiedades, cada una de las cuales se muestra en una nueva l√≠nea. Se admite la capacidad de agrupar datos; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formato personalizado</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formatea la salida usando una vista personalizada; </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format-Wide</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> formatea objetos en forma de una tabla ancha en la que solo se muestra una propiedad de cada objeto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si no se llama a ninguno de los cmdlets enumerados, se utiliza el m√≥dulo de formato apropiado para el tipo de datos que se muestra. Las reglas de visualizaci√≥n se almacenan en archivos de configuraci√≥n en formato XML con la extensi√≥n .ps1xml, que se encuentran en el directorio $ PSHome. Se puede obtener una lista de ellos con el siguiente comando:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> <span class="hljs-variable">$pshome</span>\*format*.ps1xm</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No se recomienda editar manualmente los archivos de configuraci√≥n; es mejor crear los suyos e incluirlos en la lista de archivos descargados mediante el cmdlet Update-FormatData. Si el formateador predeterminado para el tipo que desea no est√° definido, PowerShell muestra las propiedades del objeto en la pantalla en una lista. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto concluye la descripci√≥n del trabajo con objetos en PowerShell, y el art√≠culo final de la serie estar√° dedicado a resolver problemas pr√°cticos de gesti√≥n de un entorno de informaci√≥n distribuida de una empresa. En √©l, todas las herramientas descritas son √∫tiles para nosotros. El enfoque principal estar√° en los objetos CIM y su comparaci√≥n con WMI. Las partes pasadas se pueden encontrar en los enlaces a continuaci√≥n.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 1:   Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 3:      ,  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 4:   ,  </a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es498458/index.html">Videollamadas con fondo virtual y herramientas de c√≥digo abierto</a></li>
<li><a href="../es498462/index.html">Desplazamiento infinito con pancartas, o C√≥mo hacer con tres vistas</a></li>
<li><a href="../es498466/index.html">C√≥mo los l√°seres y los sensores ayudan a mantener nerviosos a los jueces</a></li>
<li><a href="../es498472/index.html">Imagen de Docker de aplicaci√≥n de p√°gina √∫nica</a></li>
<li><a href="../es498476/index.html">Accesibilidad C√≥mo hacer que la aplicaci√≥n sea accesible para usuarios con discapacidades</a></li>
<li><a href="../es498482/index.html">Situaci√≥n: se pide a los proveedores de EE. UU. Que eliminen los umbrales para descargar datos, que al final</a></li>
<li><a href="../es498484/index.html">Wi-Fi 6 y Huawei P40: ¬ød√≥nde est√° la conexi√≥n?</a></li>
<li><a href="../es498486/index.html">C√≥mo ampliar la sem√°ntica en ingl√©s para la publicidad de b√∫squeda en un nicho estrecho</a></li>
<li><a href="../es498490/index.html">Un sistema de certificaci√≥n efectivo que le permitir√° convertirse en un mejor l√≠der.</a></li>
<li><a href="../es498492/index.html">Cari√±o, matamos a la burocracia: c√≥mo la digitalizaci√≥n est√° cambiando el di√°logo entre proveedores y X5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>