<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍⚕️ 👙 🧖🏿 「データベース。信頼性工学 🌒 🔇 🧚🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、habrozhiteli！ITの分野では、本当の革命が起こりました。彼らはコードと同じようにインフラストラクチャーで作業を始めました。このプロセスは、新しい問題だけでなく、データベースの稼働時間を確保する機会も生み出します。著者は、最新のデータベース信頼性エンジニア（DBRE）のコミュニ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>「データベース。信頼性工学</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/493844/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/w8/jj/ef/w8jjefhrq7lvulblnrwsyrgfzri.jpeg" align="left" alt="画像"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、habrozhiteli！</font><font style="vertical-align: inherit;">ITの分野では、本当の革命が起こりました。彼らはコードと同じようにインフラストラクチャーで作業を始めました。</font><font style="vertical-align: inherit;">このプロセスは、新しい問題だけでなく、データベースの稼働時間を確保する機会も生み出します。</font><font style="vertical-align: inherit;">著者は、最新のデータベース信頼性エンジニア（DBRE）のコミュニティーに参加したい人のために、この実用的なガイドを用意しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この本では、•ストレージ要件とリスク管理要件。</font><font style="vertical-align: inherit;">•透過的なデータベースサポートを提供するアーキテクチャの作成と開発。</font><font style="vertical-align: inherit;">•リリース管理プロセスの合理化。</font><font style="vertical-align: inherit;">•データの保存、インデックス作成、複製。</font><font style="vertical-align: inherit;">•データウェアハウスの特性を決定し、その使用に最適なオプションを選択する。</font><font style="vertical-align: inherit;">•アーキテクチャコンポーネントの研究とビッグデータ処理を指向したアーキテクチャの作成。</font></font><br>
<a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この本は誰のためのものですか。</font></font></b><div class="spoiler_text"> ,   ,      .   ,            .     ,     .      ,     ,       .               .<br>
<br>
 ,              Linux/Unix,   - /  .  ,         —       —              —  . ,   ,              .<br>
<br>
    ,     ,      ,       .     ,         ,        .<br>
<br>
, ,      .  ,   -     ,       .      ,      Excel,       .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開構造</font></font></b><div class="spoiler_text">       .          .     ,    ,      ,      .       :  , , ,      .  ,      .    !<br>
<br>
   ,       :          (DBRE),        (RE).     ,     .  DBR-        ,     ,     .<br>
<br>
   ,       .      .       ,       .    —    ,               .   ,       ,     ,       ,   ,   ,    ,      . .<br>
   ,   .<br>
<br>
 1        .     ,        —  ,    DBRE, — , ,      DBRE      .<br>
<br>
 2      .    ,      .     ,         , —      ,  .  ,           .<br>
  3        .                  .       .<br>
<br>
  4    .    .  ,    ,        .        ,    .<br>
<br>
  5  6        .       .      ,  ,   ,        ,    ,        .<br>
<br>
 7      . , ,     DBE.   — ,  .       ,         ,        ,    .<br>
<br>
  8    .  ,       ?           SQL?   — ,   .<br>
<br>
 9  .        .              .<br>
<br>
  10   ,    .  ,    ,           .    ,    .<br>
<br>
 11       .      ,          ,      .     ,        ,    ,     .<br>
<br>
  12         (),      ,  ,    .    ,     « » ()  ,      ,           .      —     .<br>
<br>
,   13         .   ,                  .<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">復元する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5章と6章では、インフラストラクチャの設計と管理に焦点を当てました。これは、データベースが機能する分散インフラストラクチャを作成および展開する方法と、それらを管理する方法についての良いアイデアがあることを意味します。新しいノードをすばやく追加して容量を増やしたり、障害が発生したノードを交換したりする方法を検討しました。次に、最も重要なこと、つまりデータのバックアップと復元について説明します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それに直面しましょう：退屈で退屈な活動のバックアップと復元を誰もが検討します。ほとんどの場合、これらの手順はルーチンの縮図です。チームは、ジュニアエンジニアや外部の請負業者とやり取りしたり、サードパーティのツールを使用したりしません。以前は、ひどいバックアップソフトウェアに対処する必要がありました。私たちは正直にあなたに共感します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それにもかかわらず、これはあなたの仕事の中で最も重要なプロセスの1つです。ノード、データセンター間で重要なデータを移動し、それを長期アーカイブに転送することは、ビジネスの最も貴重な資産である情報の絶え間ない移動です。リカバリおよびバックアップ操作をセカンドクラスの操作と見なさず、VIP操作として扱うことを強くお勧めします。誰もがデータ回復の目的を理解するだけでなく、この作業とプロセス監視の原則に精通している必要があります。 DevOpsの哲学は、誰もがコードを記述して実際に機能するシステムに実装できることを前提としています。各エンジニアに、重要なデータ復旧プロセスに少なくとも1回参加することを勧めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特定のニーズを満たす手段として、データのコピー（バックアップとアーカイブ）を作成して保存します。それらは回復に必要です。たとえば、監査人のための環境を作成したり、別の環境を設定したりする場合など、回復は快適でのんびりしていることがあります。しかし、ほとんどの場合、障害が発生したノードをすばやく交換するか、既存のクラスターの容量を増やす必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日、分散環境では、データのバックアップとリカバリにおいて新たな課題に直面しています。</font><font style="vertical-align: inherit;">以前と同様に、ほとんどのローカルデータセットは、最大数テラバイトまでの妥当な制限内で配布されます。</font><font style="vertical-align: inherit;">違いは、これらのローカルデータセットは大規模な分散セットの一部にすぎないことです。</font><font style="vertical-align: inherit;">サイトの回復は比較的制御されたプロセスですが、クラスター内の状態を維持することはより困難なタスクです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本原則</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、データのバックアップとリカバリの基本原則について説明します。</font><font style="vertical-align: inherit;">経験豊富なデータベーススペシャリストやシステムエンジニアにとっては、初心者に思えるかもしれません。</font><font style="vertical-align: inherit;">その場合、複数のページを簡単にスクロールできます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物理的か論理的か？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースの物理バックアップは、データが保存されている実際のファイルをバックアップします。これは、データベースの一般的なファイル形式がサポートされていることを意味します。通常、データベースには、ファイルとその中のデータベース構造を決定する一連のメタデータがあります。ファイルのバックアップコピーを作成するときに、別のデータベースインスタンスがそれらを使用できることが期待される場合は、バックアップを作成し、このデータベースが依存するメタデータを保存して、バックアップを移植できるようにする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
論理バックアップを作成すると、データはデータベースから理論的には任意のシステムに転送できる形式にエクスポートされます。通常、メタデータも保存されますが、ほとんどの場合、バックアップが実行された瞬間に関連します。例としては、空のデータベースを更新するときにデータを入力するために必要なすべての挿入ステートメントのエクスポートがあります。別の例は、JSON文字列です。結果として、これは物理的なコピーおよび書き込み操作ではなく、行ごとのデータ抽出であるため、論理バックアップには、通常、長い時間がかかります。同様に、リカバリには、REDOおよびUNDOログのロックや作成など、通常のデータベースオーバーヘッドがすべて伴います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この分離の良い例は、行ベースのレプリケーションとステートメントベースのレプリケーションの違いです。</font><font style="vertical-align: inherit;">多くのリレーショナルデータベースでは、エージェントベースのレプリケーションとは、バージョンコントロールシステムに書き込んだ後、データ操作言語（DML、または挿入、更新、置換、削除）のオペレーターのジャーナルが追加されることを意味します。</font><font style="vertical-align: inherit;">これらのステートメントは、それらが再生されるレプリカに渡されます。</font><font style="vertical-align: inherit;">レプリケーションへの別のアプローチは、文字列またはChange Data Capture（CDC）に基づいています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自律的か運用可能か？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オフライン（またはコールド）バックアップは、ファイルを使用するデータベースインスタンスが無効になっているバックアップです。これにより、他のプロセスがデータを読み書きしている間、現在の状態を維持することを心配することなく、ファイルをすばやくコピーできます。これは理想的ですが、非常にまれな状態です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オンライン（またはホット）バックアップでは、引き続きすべてのファイルをコピーしますが、バックアップの実行時に存在している必要があるデータの一貫したスナップショットを取得する必要があるため、さらに複雑になります。</font><font style="vertical-align: inherit;">さらに、バックアップ中に現在のトラフィックがデータベースにアクセスする場合は、ストレージレベルでI / Oサブシステムのスループットを超えないように注意する必要があります。</font><font style="vertical-align: inherit;">負荷を制限したとしても、一貫性を維持するために使用されるメカニズムがアプリケーションに不当な遅延をもたらすことがあります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全、増分、差分</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フルバックアップを作成すると、作成方法に関係なく、ローカルデータセットが完全に予約されます。小さなデータセットの場合、これはかなり一般的です。 10 TBの場合、これには信じられないほどの時間がかかる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
差分バックアップでは、最後の完全バックアップ以降に変更されたデータのみをバックアップできます。ただし、実際には、データは特定のサイズの構造-ページの形式で編成されているため、通常は変更されたデータよりも多くのデータがバックアップされます。たとえば、ページサイズは16または64 KBであり、ページには多数のデータ行が含まれています。差分バックアップでは、データが変更されたすべてのページがバックアップされます。したがって、大きなページサイズでは、変更されたデータのみがそこに格納されている場合よりもはるかに大きなサイズのバックアップが取得されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
増分バックアップは、変更されたデータが参照する最後のバックアップの日付が増分または完全であることを除いて、差分バックアップに似ています。</font><font style="vertical-align: inherit;">したがって、増分バックアップから復元する場合、現在のポイントに到達するには、最後の完全バックアップと1つ以上の増分バックアップを復元する必要がある場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを理解した上で、効果的なバックアップおよびデータ復旧戦略を選択する際に考慮すべきいくつかのポイントについて説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ回復に関する考慮事項</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
効果的な戦略を初めて選択するときは、第2章で説明したサービス品質目標（SLO）を再度考慮する必要があります。特に、可用性と信頼性の指標を考慮する必要があります。最終的にどの戦略を選択しても、事前に定義された稼働時間の制限内でデータを回復する機能が含まれているはずです。また、信頼性の仕様に確実に準拠するには、迅速にバックアップする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
毎日バックアップし、トランザクションログをノードレベルのストレージ内のバックアップ間で保持すると、次のバックアップまでこれらのトランザクションを簡単に失う可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、データセットが全体的なエコシステム内でどのように機能するかを考慮する必要があります。たとえば、注文はリレーショナルデータベースに保存でき、すべてがトランザクションの形式で修正されるため、このデータベースに保存されている他のデータとの関連で簡単に復元できます。ただし、注文が成立した後、ワークフローは、キューシステムに格納されたイベントまたは「キー-値」タイプのストレージによってトリガーできます。これらのシステムでは、必要に応じてリレーショナルデータベースを参照したり、それをリカバリに使用したりすることで、データの整合性をたまにまたは一時的に（一時的なものに）保証できます。リカバリ中にこれらのワークフローをどのように考慮するか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
急速な開発が進んでいる環境を扱っている場合、バックアップに保存されたデータがアプリケーションの1つのバージョンによって書き込まれて使用され、復元後に別のバージョンが実行されることがあります。アプリケーションは古いデータとどのように相互作用しますか？まあ、データがバージョン管理されている場合-これは考慮に入れることができますが、この可能性を認識し、そのような場合に備える必要があります。そうしないと、アプリケーションがこのデータを論理的に損傷する可能性があり、将来さらに大きな問題が発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データ回復を計画するときは、これらすべてと予測できない多くのその他のニュアンスを考慮する必要があります。</font><font style="vertical-align: inherit;">3章で述べたように、いかなる状況にも備えることは不可能です。</font><font style="vertical-align: inherit;">しかし、それを試みることは非常に重要です。</font><font style="vertical-align: inherit;">データ復旧は、データベースの信頼性を確保するためのエンジニアの最も重要な職務の1つです。</font><font style="vertical-align: inherit;">したがって、データ回復計画はできる限り広範囲で、可能な限り多くの潜在的な問題を考慮に入れる必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回復シナリオ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のすべてを考慮に入れて、すべてのニーズを計画できるように、データ回復を必要とする可能性があるインシデントと操作のタイプについて説明します。まず、すべてのシナリオを計画済みと計画外に分けることができます。データ復旧を緊急事態を解決するためのツールとしてのみ検討すると、チームのツールを緊急時のケアと事故のシミュレーションのみに制限します。逆に、日常の活動にデータ復旧が含まれている場合、緊急事態のより高い程度の認識と成功した解決が期待できます。さらに、リカバリ戦略がSLOをサポートしているかどうかを判断するためのより多くのデータがあります。スクリプトを毎日数回実行すると、一連のサンプルを取得するのが簡単になります。これには限界値が含まれており、計画に非常に自信を持って使用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケジュールされた回復シナリオ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
復元プロセスが統合できる毎日のタスクは何ですか？</font><font style="vertical-align: inherit;">以下は、さまざまなサイトで最も頻繁に会ったリストです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">産業運用環境での新しいノードとクラスターの作成。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さまざまな環境の作成。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">順次配置されたストレージのデータ処理技術プロセスの抽出、変換、ロード（抽出、変換およびロード、ETL）およびステージの実行。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能試験。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの操作を実行するときは、必ず操作制御スタックに回復プロセスを含めてください。</font><font style="vertical-align: inherit;">以下の指標を検討してください。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間。</font><font style="vertical-align: inherit;">各コンポーネントとプロセス全体を完了するにはどのくらい時間がかかりますか？</font><font style="vertical-align: inherit;">開梱？</font><font style="vertical-align: inherit;">コピーしますか？</font><font style="vertical-align: inherit;">ログの実行？</font><font style="vertical-align: inherit;">テスト？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズ。</font><font style="vertical-align: inherit;">バックアップには、圧縮および非圧縮でどのくらいのスペースが必要ですか？</font></font></li>
<li> .     ?</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この情報は、帯域幅の問題を回避するのに役立ち、回復プロセスの安定性を確保するのに役立ちます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">産業用運用環境の新しいノードとクラスター</font></font><br>
</b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
データベースが不変のインフラストラクチャの一部であるかどうかに関係なく、必要に応じて回復手順を使用する定期的な再構築の機会があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいノードの初期ロードとクラスターへの配置に必要な時間のため、データベースがシステムの自動スケーリングに含まれることはほとんどありません。それでも、これらのプロセスをテストするために定期的に新しいノードをクラスターに追加するスケジュールをチームが作成できない理由はありません。カオスモンキー（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://bit.ly/2zy1qsE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）-システムをランダムにシャットダウンするNetflixによって開発されたツールです。これにより、監視、通知の発行、並べ替え、復元のプロセス全体をテストできるようになります。まだ行っていない場合は、これを、運用部門が定期的に実行する必要があるプロセスのチェックリストの計画に含めると、すべての従業員が手順に慣れることができます。これらのアクションを使用すると、完全リカバリと増分リカバリだけでなく、レプリケーションの包含とノードを稼働させるプロセスもテストできます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なる環境を作成する</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デモンストレーションやその他の目的のために、開発、統合、運用テスト環境を作成する必要があります。これらの環境の一部では完全なデータ回復が必要であり、ノードの回復と完全なクラスターの回復を実装する必要があります。一部の環境には、機能テストの部分的な回復サポートやユーザーのプライバシーを確​​保するためのデータクレンジングなど、他の要件があります。これにより、特定の時点でのデータ回復や、特定のオブジェクトの回復をテストできます。これはすべて、標準の完全復旧とは大きく異なり、オペレーターのアクションやアプリケーションエラーによって引き起こされた損傷を修復するのに役立ちます。 APIを作成することにより、施設レベルおよび特定の時点でのデータ回復を提供することで、従業員の自動化とこれらのプロセスへの慣れを促進できます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイプラインのさらに下にあるデータウェアハウスのためのETLとパイプラインプロセスの</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さらなる分析のために、ストリームストレージにパイプラインに取り組んでデータベースからデータを転送する場合、スナップショットから、または個々のオブジェクトのレベルでのプロセスと回復APIが正常に適用することが可能な環境を構築するタスクについて。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドテスト</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さまざまなテストシナリオの実行中に、データのコピーが必要になります。容量や負荷などの一部のテストでは、完全なリカバリに最適な完全なデータセットが必要です。機能テストでは、より小さなデータセットが必要になる場合があります。これにより、特定の時点および施設レベルでのリカバリが可能になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データ回復テスト自体は、継続的な操作である場合があります。</font><font style="vertical-align: inherit;">日常的なシナリオでデータ回復プロセスを使用することに加えて、継続的な回復操作を構成できます。</font><font style="vertical-align: inherit;">これにより、テストと検証が自動化され、バックアッププロセスが中断された場合に発生する可能性のある問題をすばやく特定できます。</font><font style="vertical-align: inherit;">このプロセスの実装に関しては、多くの人がリカバリの成功を確認する方法を尋ねます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バックアップを作成すると、次のような多くのデータを取得して、テストに使用できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動インクリメントシーケンスの最新の識別子</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトの行カウンター。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">挿入されるだけで不変と見なすことができるデータのサブセットのチェックサム。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキーマ定義ファイルのチェックサム。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他のテストと同様に、アプローチはマルチレベルでなければなりません。</font><font style="vertical-align: inherit;">成功するか、すぐに失敗するテストがいくつかあります。</font><font style="vertical-align: inherit;">これはテストの最初のレベルになるはずです。</font><font style="vertical-align: inherit;">例としては、メタデータ/オブジェクト定義のチェックサムの比較、データベースインスタンスの正常な開始、レプリケーションストリームへの正常な接続があります。</font><font style="vertical-align: inherit;">チェックサムの計算やテーブルのカウントなど、時間がかかる操作は、チェック中に後で実行する必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計画外のスクリプト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用できるすべての毎日の計画シナリオを考慮に入れて、データ回復プロセスは十分にデバッグ、文書化、解決し、エラーや問題がないようにする必要があります。</font><font style="vertical-align: inherit;">このため、計画外のシナリオが、恐ろしいほど恐ろしいものになることはめったにありません。</font><font style="vertical-align: inherit;">チームは、計画された回復と計画外の回復の違いを見るべきではありません。</font><font style="vertical-align: inherit;">回復プロセスの実行が必要になる可能性のある状況を詳細にリストして検討します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーエラー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションエラー;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インフラストラクチャサービスの可用性</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーティングシステムエラーとハードウェアエラー。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードウェア障害;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセンターの障害。</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
エラー理想的には、ユーザーエラーはほとんど発生しないはずです。エンジニアのための「手すり」と「障壁」を構築することで、これらの状況の多くを防ぐことができます。ただし、オペレーターが誤って損傷を与える可能性は常にあります。典型的な例は、データベースクライアントアプリケーションでUPDATEまたはDELETEを実行するときに、忘れられていたすべてのWHERE句です。または、たとえば、データクリーニングスクリプトの実行はテスト環境ではなく、動作中の「本番」システムで行われます。多くの場合、操作は正しく実行されますが、それらのホストに対しては間違ったタイミングで行われるかどうかが異なります。これはすべてユーザーエラーに関連しています。多くの場合、それらはすぐに識別され、修正されます。ただし、そのような変更の結果は、数日または数週間気付かれない場合があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションエラー</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションエラーは、非常に油断ならない可能性があるため、説明したシナリオの中で最悪です。アプリケーションは、データウェアハウスとの対話方法を常に変化させています。多くのアプリケーションは、参照整合性と、ファイルやサードパーティの識別子などのリソースへの外部ポインタも管理します。データを損なったり、削除したり、誤ったデータを追加したりして、しばらくの間気付かれないように変更するとどうなるかを想像するのは恐ろしいことです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インフラサービス</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第6章では、インフラストラクチャ管理サービスの魔法を紹介しました。残念ながら、これらのシステムは有用なだけ破壊的であることが判明し、ファイルの編集、別の環境へのポイント、または誤った構成設定に関連する大規模な結果につながる可能性があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSエラーとハードウェアエラー</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらが相互作用するオペレーティングシステムと機器も人間によって作成されたシステムであるため、ドキュメントに記載されていないか、あまり知られていない構成が原因で予期しない結果をもたらす可能性のあるエラーが発生する可能性があります。データリカバリーのコンテキストでは、これは、データがデータベースからOSキャッシュを介してファイルシステム、コントローラー、そして最終的にはディスクに転送される方法に関して特に当てはまります。データの損傷や損失は、私たちが思っているよりもはるかに頻繁に起こります。残念ながら、これらのメカニズムに対する私たちの信頼と依存は、それについての懐疑論ではなく、データの完全性の期待を引き起こします。</font></font><br>
<br>
<blockquote>  <br>
<br>
        Netflix  2008 .            (ECC). ECC       .  , ECC-   ,    ,    . ,    46     512-     92  . ,   ,    ,       « »  S.M.A.R.T.    92        .     . , ?<br>
<br>
             .        ,        ,      .        ,      .   —  .<br>
<br>
      ,   ZFS,      ,    .    RAID-,      ,     .<br>
</blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードウェア障害</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ハードウェアコンポーネントは原則として</font><b><font style="vertical-align: inherit;">障害を</font></b><font style="vertical-align: inherit;">起こし、分散システムではこれが定期的に発生します。ディスク、メモリ、プロセッサ、コントローラ、およびネットワークデバイスの障害が常に発生します。これらのハードウェア障害の結果として、ノードの障害やノードの遅延が発生し、システムが使用できなくなる可能性があります。ネットワークデバイスなどの共有システムは、クラスター全体に影響を与え、それらにアクセスできなくなったり、ネットワークが分割されていることを認識しない小さなクラスターに分割したりできます。これにより、結合して修正する必要のあるデータに迅速かつ重大な不一致が生じる可能性があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセンターの障害</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ネットワークレベルでハードウェアの問題が発生すると、データセンターがクラッシュすることがあります。</font><font style="vertical-align: inherit;">2012年のアマゾンウェブサービス（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://bit.ly/2zxSpzR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">の場合と同様に、ストレージバックプレーンの過負荷によりカスケード障害が発生することがあります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ハリケーン、地震、その他の災害により、データセンター全体が故障することがあります。</font><font style="vertical-align: inherit;">その後の回復では、最も信頼できる回復戦略でさえも強度をテストします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトのスコープ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
復旧が必要になる可能性のある計画的シナリオと計画外シナリオを列挙したので、これらのイベントにもう1つのディメンションを追加して、プレゼンテーションが膨大になるようにします。</font><font style="vertical-align: inherit;">これは、最も適切な応答方法を選択するのに役立ちます。</font><font style="vertical-align: inherit;">以下のオプションを検討してください。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単一のノードに限定された障害。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスタ全体の障害。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセンター全体または複数のクラスターに影響を与える障害。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ローカルまたは単一サイトで障害が発生した場合、回復は1つのホストに制限されます。</font><font style="vertical-align: inherit;">クラスターに新しいノードを追加して、容量を増やしたり、障害が発生したノードを交換したりできます。</font><font style="vertical-align: inherit;">または、システムは継続的な更新を実装し、ノードごとに復元が実行されます。</font><font style="vertical-align: inherit;">いずれにせよ、これはローカル回復です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラスターレベルでは、回復の必要性はこのクラスターのすべてのメンバーに共通です。</font><font style="vertical-align: inherit;">おそらく、すべてのノードにカスケードされたデータの破壊的な変更または削除がありました。</font><font style="vertical-align: inherit;">または、容量をテストするために新しいクラスターを導入する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセンターまたはいくつかのクラスターの規模で障害が発生した場合は、物理的な場所の場所または障害の領域全体にすべてのデータを復元する必要があることを意味します。</font><font style="vertical-align: inherit;">これは、共有データウェアハウスの障害、またはデータセンターの壊滅的な障害の原因となった障害が原因である可能性があります。</font><font style="vertical-align: inherit;">このような回復は、新しいセカンダリサイトの計画的な展開中にも必要になる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スコープに加えて、データセットスコープがあります。</font><font style="vertical-align: inherit;">ここでは、3つの可能なオプションをリストできます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのオブジェクト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">複数のオブジェクト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベースのメタデータ。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのオブジェクトの規模では、この特定のオブジェクトのみが一部またはすべてのデータ回復を必要とします。</font><font style="vertical-align: inherit;">前述のケースでは、DELETE操作が実行されたときに、計画より多くのデータが削除されたため、同じオブジェクト内の障害を示しています。</font><font style="vertical-align: inherit;">複数のオブジェクトに障害が発生すると、特定のデータベース内の複数のオブジェクト、または場合によってはすべてのオブジェクトが影響を受けます。</font><font style="vertical-align: inherit;">これは、アプリケーションが破損している場合に発生し、更新またはセグメントの移行が失敗します。</font><font style="vertical-align: inherit;">最後に、データベースに格納されたデータがすべて正常である場合、データベースメタデータの規模に障害が発生しますが、ユーザーデータ、セキュリティ権限、OSファイルのコンプライアンスなど、メタデータを使用可能にするメタデータが失われます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトの結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回復へのアプローチを選択するときに重要になるため、回復が必要なシナリオを特定し、障害の領域を特定するだけでなく、起こり得る結果を特定することも重要です。</font><font style="vertical-align: inherit;">データの損失がSLOに影響を与えない場合は、結果の拡大を最小限に抑える方法論的で遅いアプローチを選択できます。</font><font style="vertical-align: inherit;">SLOの中断につながるよりグローバルな変更には注意してアプローチし、迅速なサービス回復を選択してから、長期的なクリーンアップに進む必要があります。</font><font style="vertical-align: inherit;">すべてのアプローチは、次の3つのカテゴリに分類できます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SLOへの影響、アプリケーション障害は、ほとんどのユーザーに影響を及ぼしました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脅威SLO、一部のユーザーが苦しんでいます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SLOを脅かさない機能が影響を受けます。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者について</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Campbell Lane</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（レインキャンベル）は、デザイン会社Fastlyのシニアマネージャー（シニアディレクター）です。彼女はまた、PalominoDB / Blackbirdの創設者兼CEOであり、アメリカのオバマ氏、Activision Call of Duty、Adobe Echosign、Technorati、Livejournal、Zendeskなど、多くの企業のデータベースを提供するコンサルティングサービスです。彼女は、データベースとスケーラブルな分散システムの操作に18年の経験があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チェリティー専攻</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（チャリティーメジャーズ）は、honeycom.ioのCEO兼共同創設者です。ログアグリゲータの精度、時系列の速度メトリック、およびアプリケーションパフォーマンスメトリック（APM）の柔軟性を組み合わせたハニカムは、世界初の真に新世代の分析サービスです。 Cheritiは、以前はParse / Facebookの運用スペシャリストであり、MongoDBレプリカセットの巨大なフリート、Redis、Cassandra、MySQLを管理していました。彼女はまた、FacebookのRocksDBチームと緊密に連携し、ストレージプラグインAPIを使用した世界初のMongo + Rocksインストールの開発と展開に参加しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
»本の詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出版社のウェブサイトをご覧ください</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目次</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抜粋</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Khabrozhiteleyの場合、クーポンの25％割引- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
書籍の紙のバージョンの支払い時に、電子書籍が電子メールで送信されます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493828/index.html">インターフェイスがビデオゲームのストーリーを伝える方法</a></li>
<li><a href="../ja493830/index.html">最初のインタビューでジュニアiOS開発者が尋ねる質問</a></li>
<li><a href="../ja493832/index.html">コロナウイルスCOVID-19配布ダッシュボード（React + Chart.js + BootstrapTable）</a></li>
<li><a href="../ja493840/index.html">レビュー：アサナ、ジラ、ビトリックス-24、トレロ、ユージャイル。何が好きで何が激怒しますか？</a></li>
<li><a href="../ja493842/index.html">Check Pointソリューション+無料ライセンスによる安全なリモートアクセス</a></li>
<li><a href="../ja493848/index.html">ブログを始めたいのですが、自分のチームはありません。コピーライティング請負業者の選び方は？</a></li>
<li><a href="../ja493850/index.html">同じ都市に住んでいる開発者のうち、収入が多いのはどれですか。リモートで作業するのか、オフィスで作業するのですか。</a></li>
<li><a href="../ja493852/index.html">CloudFlare-インターネット癌</a></li>
<li><a href="../ja493856/index.html">Linux Strace：歴史、設計、および使用法</a></li>
<li><a href="../ja493858/index.html">ITサービス管理に関する有用な10冊の本</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>