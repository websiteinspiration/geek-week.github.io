<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≥üèæ üç† üßëüèæ‚Äçü§ù‚ÄçüßëüèΩ REPL in√∫til. Informe Yandex üó≥Ô∏è üññ üéë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="REPL (bucle read-eval-print) es in√∫til en Python, incluso si es IPython m√°gico. Hoy ofrecer√© una de las posibles soluciones a este problema. En primer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>REPL in√∫til. Informe Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/490788/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REPL (bucle read-eval-print) es in√∫til en Python, incluso si es IPython m√°gico. </font><font style="vertical-align: inherit;">Hoy ofrecer√© una de las posibles soluciones a este problema. </font><font style="vertical-align: inherit;">En primer lugar, el informe y mi extensi√≥n TheREPL ser√°n √∫tiles para aquellos que est√©n interesados ‚Äã‚Äãen un desarrollo m√°s r√°pido y m√°s eficiente, as√≠ como para aquellos que escriben sistemas con estado.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Mi nombre es Alexander, trabajo como programador en Yandex. Estamos escribiendo en mi equipo en Python, a√∫n no hemos cambiado a Go. Pero en mi tiempo libre, curiosamente, tambi√©n programo y lo hago en un lenguaje muy din√°mico: Common Lisp. Es quiz√°s incluso m√°s din√°mico que Python. Su peculiaridad radica en el hecho de que el proceso de desarrollo en s√≠ est√° organizado de manera algo diferente. Es m√°s interactivo e iterativo, porque en REPL en Lisp puedes hacer todo: crear m√≥dulos nuevos y eliminar viejos, agregar m√©todos, clases y eliminarlos, redefinir clases, etc.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/0p/ld/xo/0pldxop8ymqyuvlwarowoynh_44.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En Python, esto es a√∫n m√°s dif√≠cil. Cuenta con IPython. Por supuesto, IPython mejora REPL de alguna manera, agrega autocompletado y permite usar diferentes extensiones. Pero para el desarrollo iterativo, no encaja muy bien. En √©l puedes descargar el c√≥digo, probarlo un poco y listo. Y a veces quiere m√°s interactividad para que realmente pueda usar este REPL en el desarrollo, cambiar entre m√≥dulos, cambiar funciones y clases dentro de ellos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Me sucede a m√≠: ejecutas, por ejemplo, IPython REPL en el entorno de producci√≥n y comienzas a ejecutar algunos comandos all√≠, investigas algo, y luego resulta que hay un error en el m√≥dulo y quieres solucionarlo r√°pidamente. Pero esto no funciona, porque necesita construir una nueva imagen de Docker, ponerla en producci√≥n, volver a este REPL, alcanzar el estado deseado all√≠ nuevamente, iniciar todo lo que cay√≥ nuevamente. E idealmente, tendr√≠a que arreglar la funci√≥n, ejecutarla inmediatamente y obtener el resultado al instante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© se puede hacer con esto? </font><font style="vertical-align: inherit;">¬øC√≥mo puedo recargar el c√≥digo en IPython? </font><font style="vertical-align: inherit;">Intent√© usar la recarga autom√°tica y no me gust√≥ por varias razones. </font><font style="vertical-align: inherit;">En primer lugar, cuando se reinicia el m√≥dulo, pierde el estado que estaba en las variables globales dentro de este m√≥dulo. </font><font style="vertical-align: inherit;">Y puede haber un valor en cach√© con los resultados de algunas funciones. </font><font style="vertical-align: inherit;">O podr√≠a, por ejemplo, cargar datos a trav√©s de la red all√≠, para luego poder trabajar con ellos m√°s r√°pido. </font><font style="vertical-align: inherit;">Es decir, la recarga autom√°tica pierde estado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, como experimento, hice mi extensi√≥n simple para IPython y la llam√© TheREPL.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Llegu√© a usted con este informe como una idea de lo que se puede hacer con REPL en Python. </font><font style="vertical-align: inherit;">Y realmente espero que te guste esta idea, la llevar√°s a la mente y seguir√°s creando cosas que har√°n que Python sea a√∫n m√°s eficiente y conveniente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© es TheREPL? Esta es la extensi√≥n que descarga, despu√©s de lo cual aparece un concepto como el espacio de nombres en IPython, y puede tomar y cambiar a cualquier m√≥dulo de Python, ver qu√© variables, funciones, etc. Y lo m√°s importante, puede escribir directamente def, el nombre de la funci√≥n, redefinir la funci√≥n o clase, y cambiar√° en todos los m√≥dulos donde se import√≥. Pero al mismo tiempo, el m√≥dulo en s√≠ no se reinicia, por lo que se guarda el estado. Adem√°s, TheREPL le permite evitar algunos artefactos m√°s que se encuentran en la recarga autom√°tica y que ahora veremos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h0/ob/lo/h0obloylvllg9wciqqyvg3yhqam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, en la recarga autom√°tica, la actualizaci√≥n del c√≥digo solo ocurre cuando se guarda el archivo. Pero al mismo tiempo, debe ingresar algo en el REPL, y solo entonces la recarga autom√°tica detectar√° estos cambios. Este es el problema n√∫mero 1. Es decir, si tiene alg√∫n tipo de proceso en segundo plano en un hilo separado (por ejemplo, el servidor se est√° ejecutando), no puede simplemente tomar y corregir el c√≥digo. La recarga autom√°tica no aplicar√° estos cambios hasta que ingrese algo en IPython REPL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso de mi extensi√≥n, presionas el acceso directo directamente en el editor, y la funci√≥n que est√° debajo del cursor se aplica inmediatamente y comienza a funcionar. Es decir, usando TheREPL, puede cambiar el c√≥digo de forma m√°s granular. Tambi√©n puede escribir def en IPython.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/gf/5h/8cgf5hocolkvqgirby2kq730eus.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cambiar entre m√≥dulos, como dije, la recarga autom√°tica no es compatible de ninguna manera. Solo puede encontrar el archivo en el sistema de archivos, cambiarlo y esperar que la recarga autom√°tica resuelva todo lo que haya all√≠. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h-/4t/sr/h-4tsrp2ncyufazpguvh0qmjxum.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s lejos. La recarga autom√°tica pierde variables globales, TheREPL guarda y le permite continuar investigando el funcionamiento de su aplicaci√≥n, cambiar su c√≥digo interno y as√≠ desarrollarlo r√°pidamente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/md/o_/tbmdo_pag196om9zw0heb1rtvy4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La recarga autom√°tica todav√≠a tiene esta caracter√≠stica. Con mucha astucia aplica cambios al m√≥dulo que se recarga. En particular, hace un truco muy interesante all√≠. Si la funci√≥n en este m√≥dulo se ha actualizado, para cambiarla donde se import√≥, utiliza el recolector de basura para encontrarla y todas estas instancias de funciones y cambiar el c√≥digo dentro de ellas. Adem√°s, veremos ejemplos de c√≥mo sucede esto. Debido a esto, el c√≥digo de funci√≥n cambia, incluso si entra en el cierre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øSabes qu√© es un cierre? Esto es algo muy √∫til. Los desarrolladores de JavaScript usan esto todo el tiempo. Usted, muy probablemente, simplemente nunca prest√≥ atenci√≥n. Pero dado que la carga autom√°tica hace lo que describ√≠ anteriormente, es posible que se encuentre en una situaci√≥n en la que el c√≥digo anterior usa un c√≥digo nuevo que puede funcionar de manera diferente. Por ejemplo, una funci√≥n puede devolver no un valor, sino dos, tupla en lugar de cadena, etc. El c√≥digo anterior se romper√° en esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL no hace algo tan complicado espec√≠ficamente para garantizar que todo sea m√°s consistente. Es decir, cambia la funci√≥n o clase en el m√≥dulo en el que se define. Encuentra esta clase en todos los dem√°s m√≥dulos y la cambia all√≠ tambi√©n. Despu√©s de eso, todo funciona de una manera nueva.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-j/fv/xo/-jfvxo93yhfdk69oyhb9xsybvom.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo funciona la sustituci√≥n de la funci√≥n de autocarga? Tenemos dos funciones, una y dos. Cada funci√≥n tiene un conjunto de atributos: documentaci√≥n, c√≥digo, argumentos, etc. Aqu√≠ en la diapositiva hay un ejemplo de reemplazo de los atributos en los que se almacena el c√≥digo de bytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de que la carga autom√°tica lo cambie, la funci√≥n llamada comienza a funcionar de manera diferente. Pero este es un ejemplo sint√©tico que acabo de reproducir con mis manos para que entiendan lo que est√° sucediendo. La funci√≥n se llama de una manera, pero el c√≥digo all√≠ es realmente diferente. Y si desmonta, tambi√©n muestra que devuelve un deuce. ¬øA qu√© conduce esto? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bt/u7/qt/btu7qtygtpvagsnxat-tngwtvle.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay un ejemplo de cierre. En la segunda l√≠nea, creamos un cierre en el que capturamos la funci√≥n foo. El cierre en s√≠ mismo espera que esta funci√≥n que pasamos devuelve una l√≠nea, la codifica en utf-8 y todo funciona.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tu/mx/b8/tumxb8ifcxw_yh5o2veg8sfrtbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero suponga que cambia el m√≥dulo en el que se define foo, y la recarga autom√°tica recoge el cambio. Y lo cambia para que no devuelva una cadena, sino un n√∫mero. Entonces el cierre ya funcionar√° incorrectamente, porque la funci√≥n en √©l ha cambiado por dentro, pero el cierre no espera esto, no ha cambiado. Y tales problemas con la recarga autom√°tica pueden "disparar" en lugares inesperados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/eq/k0/mseqk0r8rxsiji38ypx3drsloaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo se autocargan las clases de actualizaci√≥n? Muy simple. Actualiza todos los m√©todos de la clase de la misma manera que las funciones, y tambi√©n actualiza el atributo __class__ para todas las instancias, de modo que la resoluci√≥n de los m√©todos (determinar qu√© m√©todo debe llamarse) comienza a funcionar de una manera nueva.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo es un poco m√°s complicado en TheREPL, porque cuando actualiza _class_, puede resultar que tenga algunos descendientes, clases secundarias, que tambi√©n deben actualizarse, porque algo ha cambiado en la lista de clases base. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resolver este problema, puede reconstruir la clase. Pero primero veamos qu√© sucede con la recarga autom√°tica cuando recarga un m√≥dulo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p-/xc/jg/p-xcjggcwk7h30knymqvqsl9_ue.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay un buen ejemplo. Hay dos m√≥dulos: a y b. En el m√≥dulo a, se define una clase principal, en el m√≥dulo b una clase secundaria, y creamos una instancia de la clase secundaria. Y la l√≠nea 10 muestra que s√≠, esta es una instancia de la clase Foo, el padre. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nm/aj/gu/nmajgupfumnuw-igpxdk-_fbvlw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, simplemente tomamos y cambiamos el m√≥dulo a. Por ejemplo, agregue documentaci√≥n a la clase Foo. Luego, la recarga autom√°tica recoge estos cambios. ¬øQu√© crees que en este caso volver√° de Bar?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3t/kz/iw/3tkziw2mnozaraudax0vm4ndzii.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y devuelve falso, porque la recarga autom√°tica ha cambiado la clase Foo, y ahora es una clase completamente diferente, no de la que se hereda la clase Bar. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/o5/mt/jyo5mtiwfcsw1vuvuegmz-ynxbm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y una sorpresa! En los dos m√≥dulos ayb, la clase Foo es una clase diferente y Bar hereda de uno de ellos. Debido a tales jambas, es muy dif√≠cil predecir c√≥mo funcionar√° su c√≥digo despu√©s de que la recarga autom√°tica solucione algo en √©l. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g3/cj/3e/g3cj3enddiaxo02tzn5zr3jqaa8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algo como esto, actualiza las clases. Voy a comentar sobre la foto. Inicialmente, la clase Foo se importa al m√≥dulo b, por lo que permanece all√≠. Al reemplazar la recarga autom√°tica, este m√≥dulo se reubica, y aparece una nueva clase all√≠, y en el m√≥dulo b no se actualiza.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/mg/pk/jamgpkvsohlnphdstlwz9_dbyig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL hace un poco diferente. Inyecta una clase modificada en cada m√≥dulo donde fue importado. Por lo tanto, todo funciona correctamente all√≠. Adem√°s, si hubiera objetos en la clase, se conservar√°n. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/72/hk/cq/72hkcql64u5ap4p0dzhiwyoxicc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y as√≠ es como TheREPL resuelve el problema con las clases secundarias. Es decir, cuando la clase padre ha cambiado, define la lista de clases base a trav√©s del atributo m√°gico mro (orden de resoluci√≥n del m√©todo). Este atributo contiene una lista de clases en el orden en que desea buscar m√©todos o atributos en ellos. Y cada vez que llame al m√©todo get_name en su objeto, por ejemplo, Python lo comprobar√° primero en la clase Bar, luego en la clase Foo, luego en la clase de objeto, si no lo encuentra. Act√∫a de acuerdo con el procedimiento de orden de resoluci√≥n del m√©todo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL usa este chip. </font><font style="vertical-align: inherit;">Toma una lista de clases base, cambia all√≠ la clase que acaba de cambiar a una nueva. </font><font style="vertical-align: inherit;">Crea un nuevo tipo secundario, este es el segundo paso. </font><font style="vertical-align: inherit;">Con la funci√≥n type, puedes crear clases. </font><font style="vertical-align: inherit;">Si nunca lo ha usado, pru√©belo, es divertido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simplemente diga el nombre de la clase, diga cu√°l es su clase base. </font><font style="vertical-align: inherit;">En el caso m√°s simple, por ejemplo, objeto. </font><font style="vertical-align: inherit;">Y - un diccionario con m√©todos y atributos de clase. </font><font style="vertical-align: inherit;">Todo, tiene una nueva clase que puede instanciar, como de costumbre. </font><font style="vertical-align: inherit;">TheREPL aprovecha este chip. </font><font style="vertical-align: inherit;">Genera una clase secundaria y le cambia punteros en todos los objetos de la antigua clase Bar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todav√≠a tengo una demostraci√≥n, echemos un vistazo a c√≥mo funciona. </font><font style="vertical-align: inherit;">Primero, veamos una cosa tan simple.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primera demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dije que puedes cambiar el c√≥digo dentro del m√≥dulo. Supongamos que tenemos un servidor. Lo ejecutar√© ahora. En alg√∫n momento, encontramos que por alguna raz√≥n crea directorios temporales. O comenz√≥ a crear, pero antes de eso no cre√≥. Luego podemos conectarnos a este servidor y, suponiendo que probablemente crea estos directorios usando la funci√≥n mkdtemp del m√≥dulo de archivos, puede ir directamente a este m√≥dulo de Python. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ver - en la esquina el nombre del m√≥dulo actual ha cambiado. Ahora dice archivo temporal. Y puedo ver qu√© caracter√≠sticas hay. Los vemos y, lo que es m√°s importante, podemos redefinirlos. He preparado un contenedor especial que le permite decorar cualquier funci√≥n para que con todas sus llamadas pueda ver el rastro desde donde se llama. Ahora los importaremos y aplicaremos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es decir, envuelvo la funci√≥n est√°ndar de Python, sin siquiera tener acceso al c√≥digo fuente de este m√≥dulo. </font><font style="vertical-align: inherit;">Puedo tomarlo y envolverlo. </font><font style="vertical-align: inherit;">Y en la pr√≥xima salida, veremos Traceback y encontraremos desde d√≥nde se llama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Del mismo modo, estos cambios se pueden revertir para que no nos env√≠e spam. </font><font style="vertical-align: inherit;">Es decir, vemos que este servidor dentro del trabajador en la octava l√≠nea llama a mkdtemp y contin√∫a produciendo directorios temporales para nosotros, abarrotando el sistema de archivos. </font><font style="vertical-align: inherit;">Esta es una aplicaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos otro ejemplo de por qu√© la recarga autom√°tica a veces no funciona muy bien. </font><font style="vertical-align: inherit;">Tengo preparado un bot de telegramas:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segunda demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora activamos la recarga autom√°tica y vemos c√≥mo nos ayuda. Eso es todo, ahora puedes iniciar el bot y hablar con √©l. Para que pueda ver mejor, comenzaremos un di√°logo con √©l. Conozca el bot. Entonces. Hay alg√∫n tipo de error. Se concibi√≥ un error completamente diferente, y decid√≠ hacer cambios en el √∫ltimo momento. Pero no importa. Ahora lo arreglaremos, la recarga autom√°tica nos ayudar√° con esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos cambiando al bot. Y ahora comentar√© temporalmente sobre esto, si es as√≠. Guardo el archivo La recarga autom√°tica, en teor√≠a, tuvo que atrapar estos cambios. Inicie el bot nuevamente. El bot me reconoci√≥. Hablemos con el.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro error. Ella ya est√° concebida. Vamos a arreglarlo. Dejar√© el bot, funcionar√° en segundo plano, cambiar√© al editor y en el editor encontraremos este error. Es solo un error tipogr√°fico, y olvid√© que mi variable se llama user_name. Guard√© el archivo. se supon√≠a que la recarga autom√°tica la atrapar√≠a, y ahora lo veremos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero la recarga autom√°tica, como ya mencion√©, no sabe nada sobre el hecho de que el archivo ha cambiado hasta que ingresas algo en √©l. Con un proceso tan largo ... Necesita ser interrumpido, reiniciado. Hecho. Vuelve a nuestro bot, escr√≠bele. Bueno, ya ves, el bot olvid√≥ que mi nombre es Sasha. ¬øPor qu√©? autoreload lo recre√≥ nuevamente porque recarga todo el m√≥dulo por completo. Y necesito volver a escribir en el bot para restaurar su estado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y si est√° depurando alg√∫n tipo de error que ocurre en cierto estado, entonces el estado no puede perderse, porque de lo contrario pasar√° mucho tiempo nuevamente para lograr este estado. TheREPL ayuda en esos casos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos c√≥mo se actualizar√° el bot en caso de usar TheREPL. Para la pureza del experimento, reiniciar√© IPython y lo repetiremos nuevamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora descargo TheREPL. Inmediatamente comienza a escuchar en un puerto espec√≠fico para que pueda enviar un c√≥digo dentro de √©l. Por cierto, esto se puede hacer incluso si IPython se ejecuta en alg√∫n lugar del servidor y el editor se ejecuta localmente, lo que tambi√©n puede ayudarlo en algunos casos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importamos el bot, lo iniciamos y volvemos a escribir. Est√° claro aqu√≠: reiniciamos Python, por lo que no recuerda qui√©n soy. Verifique que haya un error adentro. Si, hay un error. Bueno, hag√°moslo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vuelvo al editor, corrijo el error. Ni siquiera tenemos que guardar el archivo, presiono Ctrl-C, Ctrl-C, este es un acceso directo mediante el cual Emacs toma la descripci√≥n actual de la funci√≥n que est√° justo debajo del cursor y la env√≠a al proceso de Python al que est√° conectado. Eso es todo, ahora podemos pasar y verificar c√≥mo nuestro bot responde a mis mensajes all√≠. Ahora, recuerda que yo soy Sasha, y honestamente responde que no sabe c√≥mo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intentemos agregar directamente una nueva funcionalidad all√≠. Para hacer esto, regrese al editor. Por ejemplo, agregue el comando de ayuda. Por ahora, que responda que no sabe nada de ayuda. Nuevamente, presione Ctrl-C, Ctrl-C, se aplica el c√≥digo. Vamos al bot. Vea si √©l entiende este comando. S√≠, el equipo ha aplicado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, √©l todav√≠a tiene tal cosa, ahora veremos c√≥mo cambiar√° la clase. Tiene un comando de estado, un comando de depuraci√≥n especial para ver el estado del bot. Entonces, algunos Oleg se conectaron. Interesante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando el bot ejecuta este comando, llama a responder para ver la representaci√≥n del bot. Podemos ir y corregir, por ejemplo, esta respuesta con otra cosa. Por ejemplo, haga que se ingresen solo los nombres. Puedes hacerlo Volvemos a nuestro mensajero, nuevamente ejecutamos estado. Y eso es todo. Ahora la respuesta funciona de una manera nueva, pero el objeto es el mismo, ha conservado su estado, ya que nos recuerda a todos: Oleg, Sasha, kek y "DROP TABLE Users, Alex". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, puede escribir y depurar c√≥digo directamente sobre la marcha, sin cambiar a este ciclo, cuando necesite recolectar un paquete, enr√≥llelo en alg√∫n lugar. Puede probar r√°pidamente algo, cambiar todo lo que necesita, y solo entonces todos estos cambios deben empaquetarse correctamente y desplegarse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, no debe hacer esto en la producci√≥n real, porque con este enfoque, qu√© tipo de problema puede ser. Puede olvidar que el c√≥digo que acaba de iniciar en el servidor debe guardarse y luego implementarse como deber√≠a. Este enfoque requiere disciplina. Pero en el proceso de desarrollo y depuraci√≥n de alg√∫n tipo de prueba, esto es simplemente una gran cosa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aseg√∫rese de hacer un complemento para PyCharm. Si hay un voluntario que me ayudar√° con Kotlin y el complemento PyCharm, me complacer√° hablar. Escr√≠beme </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el correo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telegrama</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* * * </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conectar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para el desarrollo de TheREPL. </font><font style="vertical-align: inherit;">Hay muchas m√°s fichas que se te ocurran. </font><font style="vertical-align: inherit;">Por ejemplo, puede encontrar una manera de actualizar las instancias de clase cuando se actualizan, agregar nuevos atributos all√≠ o actualizar su estado de alguna manera. </font><font style="vertical-align: inherit;">Del mismo modo, actualizaremos la base de datos. </font><font style="vertical-align: inherit;">Ahora esto no es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede crear un c√≥digo de recarga en caliente para la producci√≥n, de modo que cuando reciba nuevos cambios, no tenga que reiniciar el servidor. </font><font style="vertical-align: inherit;">Puedes llegar a mucho m√°s. </font><font style="vertical-align: inherit;">Esto es solo una idea, y quiero que lo saques de aqu√≠. </font><font style="vertical-align: inherit;">Debemos ajustar todo por nosotros mismos y hacerlo conveniente. </font><font style="vertical-align: inherit;">Eso es todo para mi.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es490778/index.html">Las personas que entienden el trabajo de un programador se pueden encontrar en cualquier lugar</a></li>
<li><a href="../es490780/index.html">Intel Xeon escalable Gen2: gran venta de n√∫cleos</a></li>
<li><a href="../es490782/index.html">Conferencia AnalogBytes: Roskomnadzor, media, highload y all-all-all</a></li>
<li><a href="../es490784/index.html">Soy desarrollador de Android y no me gustaba hacer trabajo manual.</a></li>
<li><a href="../es490786/index.html">An√°lisis de fugas de segundo orden: cuando se filtra de quienes roban datos de un banco</a></li>
<li><a href="../es490790/index.html">Archivos Zip: historial, explicaci√≥n e implementaci√≥n</a></li>
<li><a href="../es490792/index.html">VXLAN en NSX-V - Base subyacente con problemas</a></li>
<li><a href="../es490796/index.html">C√≥mo automatizar la seguridad de los contenedores al estilo de Pol√≠tica como C√≥digo usando CRD</a></li>
<li><a href="../es490804/index.html">C√≥mo la madre de un hacker entr√≥ en prisi√≥n e infect√≥ la computadora del jefe</a></li>
<li><a href="../es490808/index.html">Matem√°ticas en astron√°utica: motor de detonaci√≥n rotacional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>