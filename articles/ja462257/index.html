<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤡 👤 ♍️ KubernetesのKafka-それは良いですか？ 👩‍💻 👎🏻 💲</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ようこそ、ハブル！
 
 かつて、私たちはカフカのテーマをロシア市場に導入し、その発展を監視し続けた最初の人物でした。特に、KafkaとKubernetesの間の相互作用のトピックは私たちにとって興味深いようでした。このトピックに関するレビュー（および慎重な）記事は、Gwen Shapiraが執筆し...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>KubernetesのKafka-それは良いですか？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/462257/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ようこそ、ハブル！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
かつて、私たちは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カフカの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーマをロシア市場に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">導入し、</font></a><font style="vertical-align: inherit;">その発展</font><font style="vertical-align: inherit;">を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">監視</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">続け</font><font style="vertical-align: inherit;">た最初の人物でした</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特に、Kafkaと</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetesの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">間の相互作用のトピックは私たちにとって興味深いよう</font><font style="vertical-align: inherit;">でした。</font><font style="vertical-align: inherit;">このトピック</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レビュー（および慎重な）</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">記事</font></a><font style="vertical-align: inherit;">は、Gwen Shapiraが執筆した昨年10月にConfluent社のブログで公開されました。</font><font style="vertical-align: inherit;">今日、私たちはあなたの注意をヨハン・ジャイガーによるより最近の4月の記事に注目したいと思います。</font><font style="vertical-align: inherit;">「カオスモンキー」の無料翻訳はご容赦ください！</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/m7/ok/p4/m7okp40yxxxkzul5qq3blkj0qak.png" alt="画像"></div></a><br>
<a name="habracut"></a> <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetesは、ステートレスな負荷を処理するように設計されています。原則として、このようなワークロードはマイクロサービスアーキテクチャの形式で提示され、軽量で水平スケーリングに適し、12要素アプリケーションの原則に従い、回路ブレーカーやカオスモンキーでの作業を可能にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、Kafkaは本質的に分散データベースとして機能します。したがって、動作するときは、条件に対処する必要があり、マイクロサービスよりもはるかに重いです。 Kubernetesはステートフルロードをサポートしますが、Kelsey Hightowerが彼の2つのツイートで指摘しているように、それらは慎重に処理する必要があります。</font></font><br>
<blockquote> , ,   Kubernetes     ,       ,    RDS.   .  ,   ,       SRE-,    RDS  Kubernetes.</blockquote> <blockquote>     ,       Kubernetes.   ,  , «     Kubernetes    »        Kubernetes,   –    ,   .</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、KubernetesでKafkaを実行する必要がありますか？</font><font style="vertical-align: inherit;">反問：KafkaはKubernetesなしでよりよく機能しますか？</font><font style="vertical-align: inherit;">そのため、この記事では、KafkaとKubernetesがどのように互いに補完しあうのか、そして組み合わせるとどのような落とし穴が生じる可能性があるのか​​を強調したいと思います。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完了時間</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本的なことについて話しましょう-ランタイム環境自体それ自体</font><font style="vertical-align: inherit;">
は、CPUを操作するときに</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kafkaブローカーが便利です。 TLSではオーバーヘッドが発生する場合があります。同時に、暗号化を使用する場合、KafkaクライアントはCPUをより多くロードできますが、これはブローカーには影響しません。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモリー</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kafkaブローカーは</font><i><b><font style="vertical-align: inherit;">メモリーを</font></b></i><font style="vertical-align: inherit;">消費します。通常、JVMヒープサイズは4〜5 GBに制限されていますが、Kafkaはページキャッシュを非常に頻繁に使用するため、大量のシステムメモリも必要になります。 Kubernetesで、リソースとリクエストのコンテナ制限を適切に設定します。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ウェアハウスコンテナー内</font><i><b><font style="vertical-align: inherit;">のデータ</font></b></i><font style="vertical-align: inherit;">ウェアハウスは短命です-データは再起動時に失われます。 Kafkaデータにボリュームを使用できます</font></font><code>emptyDir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、効果も同様です。ブローカーのデータは完了後に失われます。メッセージはレプリカとして他のブローカーに保存できます。したがって、再起動後、失敗したブローカーは最初にすべてのデータを複製する必要があり、このプロセスには多くの時間がかかる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが、長期間のデータストレージを使用する必要がある理由です。 XFSファイルシステム、より正確にはext4を使用した非ローカルの長期的なストレージにします。 NFSは使用しないでください。私は警告した。 NFSバージョンv3またはv4は機能しません。要するに、Kafkaブローカーは、NFSに関連する「愚かな名前変更」の問題によりデータディレクトリを削除できない場合に終了します。それでも確信が持てない場合は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">この記事を</font></a><font style="vertical-align: inherit;">よく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読んでください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">再起動または再配置後にKubernetesが新しいノードをより柔軟に選択できるように、データウェアハウスは非​​ローカルである必要があります。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ほとんどの分散システムと同様に、Kafkaのパフォーマンスは、ネットワーク遅延が最小で帯域幅が最大であることに大きく依存します。</font><font style="vertical-align: inherit;">可用性を低下させるため、すべてのブローカーを同じノードに配置しないでください。</font><font style="vertical-align: inherit;">Kubernetesノードが失敗すると、Kafkaクラスター全体も失敗します。</font><font style="vertical-align: inherit;">また、データセンター全体にKafkaクラスターを分散させないでください。</font><font style="vertical-align: inherit;">Kubernetesクラスターの場合も同様です。</font><font style="vertical-align: inherit;">この場合の適切な妥協策は、異なるアクセスゾーンを選択することです。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成</font></font></h4><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常のマニフェスト</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kubernetes Webサイトには、</font><font style="vertical-align: inherit;">マニフェストを使用してZooKeeperを構成する方法に関する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に優れたガイド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。</font><font style="vertical-align: inherit;">ZooKeeperはKafkaの一部であるため、ここから適用できるKubernetesの概念について理解し始めるのが便利です。</font><font style="vertical-align: inherit;">これを理解したら、Kafkaクラスターで同じ概念を使用できます。</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sub</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：subは、Kubernetesでデプロイ可能な最小のユニットです。</font><font style="vertical-align: inherit;">ポッドにはワークロードが含まれており、ポッド自体がクラスター内のプロセスに対応しています。</font><font style="vertical-align: inherit;">囲炉裏には1つ以上のコンテナが含まれています。</font><font style="vertical-align: inherit;">アンサンブル内の各ZooKeeperサーバーとKafkaクラスター内の各ブローカーは、別々のアプローチで動作します。</font></font></li>
<li><i>StatefulSet</i>: StatefulSet –   Kubernetes,     ,  ,     . StatefulSet        .</li>
<li><i>Headless-</i>:          . Kubernetes       . ,     ,  ,     ZooKeeper  Kafka,       .      headless-:          ,        . </li>
<li><i>   </i>:         ,   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yolean</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、包括的なマニフェストのセットを提供します。その助けを借りて、KubernetesでKafkaを使い始めるのが便利です。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helm図</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
HelmはKubernetesのパッケージマネージャーであり、yum、apt、Homebrew、ChocolateyなどのOSのパッケージマネージャーと比較できます。 Helmダイアグラムで説明されている定義済みのソフトウェアパッケージをインストールすると便利です。 Helmダイアグラムを適切に選択すると、KubernetesでKafkaを使用するためのすべてのパラメーターを適切に構成するという難しいタスクが容易になります。いくつかのカフカ図があります。公式の図</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はインキュベーター状態で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Confluent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から1つ、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitnami</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から1つ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">です</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーター</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Helmには特定の欠陥があるため、Kubernetesオペレーターという別のツールがかなりの人気を得ています。オペレーターはKubernetesのソフトウェアをパックするだけでなく、そのようなソフトウェアをデプロイして管理することもできます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">素晴らしいオペレーター</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
のリストには</font><font style="vertical-align: inherit;">、Kafkaの2つのオペレーターが記載されています。それらの1つは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Strimzi</font></a><font style="vertical-align: inherit;">です。 Strimziの助けを借りて、数分でKafkaクラスターを上げることは難しくありません。実質的に構成は必要ありません。さらに、オペレーター自体がいくつかの優れた機能を提供します。例えば、クラスター内の「ポイントツーポイント」タイプのTLS暗号化です。 Confluentは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">独自の演算子</font></a><font style="vertical-align: inherit;">も提供します</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">パフォーマンス</font></b></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストールされているKafkaインスタンスにコントロールポイントを提供して、パフォーマンスをテストすることは非常に重要です。</font><font style="vertical-align: inherit;">これらのテストは、問題が発生する前に潜在的なボトルネックを特定するのに役立ちます。</font><font style="vertical-align: inherit;">幸いなことに、カフカはすでに2つの性能テストツールを提供しています</font></font><code>kafka-producer-perf-test.sh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>kafka-consumer-perf-test.sh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それらを積極的に使用してください。</font><font style="vertical-align: inherit;">参考までに、</font><font style="vertical-align: inherit;">Jay Kreps </font><font style="vertical-align: inherit;">が</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この投稿で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明した結果を参照する</font><font style="vertical-align: inherit;">か</font><font style="vertical-align: inherit;">、ガイドとしてStéphaneMaarekによる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Amazon MSK </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">レビューを</font></a><font style="vertical-align: inherit;">使用でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーション</font></font></h4><br>
<i><b><font style="vertical-align: inherit;"></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムの透明性を</font><i><b><font style="vertical-align: inherit;">監視</font></b></i><font style="vertical-align: inherit;">することは非常に重要です。そうしないと、システムで何が起こっているのか理解できません。今日、クラウドネイティブのスタイルのメトリックに基づいてモニタリングを提供する堅固なツールキットがあります。この目的でよく使用される2つのツールは、PrometheusとGrafanaです。 Prometheusは、JMXエクスポーターを使用して、すべてのJavaプロセス（Kafka、Zookeeper、Kafka Connect）から最も簡単な方法でメトリックを収集できます。 cAdvisorメトリックを追加すると、Kubernetesでのリソースの使用方法をよりよく理解できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Strimziには、Kafka用の非常に便利なGrafanaダッシュボードの例があります。たとえば、レプリケートされていないセクターやオフラインのセクターに関する主要なメトリックを視覚化します。すべてが非常に明確です。これらのメトリックは、リソースの使用とパフォーマンスに関する情報、および安定性インジケータによって補足されます。したがって、理由もなくKafkaクラスターの基本的な監視を取得できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rc/pl/wz/rcplwz2iz4iw7ujogarvaacoffe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出典：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strimzi.io/docs/master/#kafka_dashboard</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
顧客モニタリング（消費者と生産者によるメトリック）、ラグモニタリング（これには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Burrow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります</font><font style="vertical-align: inherit;">）とエンドツーエンドモニタリング-これには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kafka Monitorを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">して補完するとよいでしょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロギング</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロギングは別の重要なタスクです。必ずあなたのカフカのインストールのすべてのコンテナは、ログインしていることを確認</font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><code>stderr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そしてあなたのKubernetesクラスタを中心にすべてのログを集約していることを確認し</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ロギング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などのインフラ、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Elasticsearch</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康診断</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kubernetesは、活性プローブと準備プローブを使用して、ポッドが適切に動作しているかどうかを確認します。ライブテストが失敗すると、Kubernetesはこのコンテナを停止し、再起動ポリシーが適切に設定されている場合は自動的に再起動します。可用性チェックが失敗した場合、Kubernetesはこれをリクエストサービスから分離します。したがって、このような場合、手動による介入はまったく不要になり、これは大きなプラスです。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新のロールアウト</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
StatefulSetは自動更新をサポート</font><i><b><font style="vertical-align: inherit;">しています</font></b></i><font style="vertical-align: inherit;">。RollingUpdate戦略を選択すると、Kafkaの下にあるそれぞれが順番に更新されます。このようにして、ダウンタイムをゼロに減らすことができます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケーリング</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kafkaクラスターのスケーリングは簡単な作業ではありません。ただし、Kubernetesでは、ポッドを特定の数のレプリカにスケーリングするのは非常に簡単です。つまり、必要な数のKafkaブローカーを宣言的に識別することができます。この場合、最も難しいのは、スケールアップ後またはスケールダウン前のセクターの再割り当てです。繰り返しますが、Kubernetesがこのタスクを支援します。</font><font style="vertical-align: inherit;">
Kafkaクラスターの管理に関連する</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク、特にトピックの作成とセクターの再割り当ては、既存のシェルスクリプトを使用して実行できます。ポッドでコマンドラインインターフェースを開きます。ただし、このソリューションは美しすぎません。 Strimziは、別の演算子を使用したトピックの管理をサポートしています。ここで変更するものがあります。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックアップとリカバリ</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
現在、Kafkaの可用性は、Kubernetesの可用性に依存します。</font><font style="vertical-align: inherit;">Kubernetesクラスターが落ちると、最悪の場合、Kafkaクラスターも落ちます。</font><font style="vertical-align: inherit;">マーフィーの法則の下では、これが起こり、データを失うことになります。</font><font style="vertical-align: inherit;">このリスクを軽減するには、適切なバックアップの概念を用意してください。</font><font style="vertical-align: inherit;">MirrorMakerを使用できます。別のオプションは</font><font style="vertical-align: inherit;">、Zalandoからの</font><font style="vertical-align: inherit;">この</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投稿で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明されているように、S3を使用すること</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
中小規模のKafkaクラスターを使用する場合は、Kubernetesを使用することをお勧めします。Kubernetesを使用すると、柔軟性が高まり、オペレーターとの作業が簡単になります。</font><font style="vertical-align: inherit;">レイテンシやスループットに関する非常に深刻な非機能要件がある場合は、他の展開オプションを検討することをお勧めします。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462221/index.html">Google Playでの失望感</a></li>
<li><a href="../ja462227/index.html">8月9日、モスクワ-バックエンドストーリー4.0</a></li>
<li><a href="../ja462245/index.html">Linuxカーネルの例としての自動git bisect</a></li>
<li><a href="../ja462251/index.html">ブラウザのシークレットモードはフィクションですか？</a></li>
<li><a href="../ja462253/index.html">ReddコンプレックスのFPGAでのCPUおよびプロセッサ通信の例でストリーミングプロトコルを使用した最初の実験</a></li>
<li><a href="../ja462259/index.html">スマートホーム用のコントローラーを作る</a></li>
<li><a href="../ja462263/index.html">床へのペダル：PC用の別の足のマニピュレーターを作成する</a></li>
<li><a href="../ja462265/index.html">Pythonとキューブ</a></li>
<li><a href="../ja462269/index.html">ジョン・ロメロからドゥーム：80年代のゲーム開発</a></li>
<li><a href="../ja462271/index.html">iOSでコードをロックする：Appleが防御から防御へと切り替わった方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>