<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∂ üè™ ü§± Inexprimablement attrayant: comment nous avons cr√©√© un haniot qui ne peut pas √™tre expos√© üöù üë®üèΩ‚Äçüî¨ üòö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", - - ‚Äî , ¬´ ¬ª . , : , . , , , . , , ¬´Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats¬ª. ‚Äî . 
 
  : -
 La t√¢che principa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Inexprimablement attrayant: comment nous avons cr√©√© un haniot qui ne peut pas √™tre expos√©</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="image"><br>
<i> , -       - ‚Äî ,  ¬´  ¬ª        .    ,      :   ,        .     ,    ,        ,    .  ,   ,      ¬´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</a>¬ª.     ‚Äî   . </i><br>
<a name="habracut"></a><br>
<h3> : -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La t√¢che principale dans la cr√©ation de notre super pi√®ge √©tait de nous emp√™cher d'√™tre expos√©s par des pirates qui s'y int√©ressaient. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai d√ª faire beaucoup de travail:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ez une l√©gende r√©aliste sur l'entreprise, y compris le nom et la photo des employ√©s, les num√©ros de t√©l√©phone et les e-mails.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inventer et mettre en ≈ìuvre un mod√®le d'infrastructure industrielle qui correspond √† la l√©gende de notre entreprise. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©cidez quels services r√©seau seront disponibles √† l'ext√©rieur, mais ne vous impliquez pas dans l'ouverture de ports vuln√©rables afin que cela ne ressemble pas √† un pi√®ge pour les coots. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisez l'apparition de fuites d'informations sur le syst√®me vuln√©rable et diffusez ces informations aupr√®s des attaquants potentiels.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre en place une surveillance discr√®te des pirates dans l'infrastructure des pi√®ges. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, tout d'abord.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©er une l√©gende</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les cybercriminels sont d√©j√† habitu√©s au fait qu'ils rencontrent beaucoup de manipulations, donc la partie la plus avanc√©e d'entre eux m√®ne une √©tude approfondie de chaque syst√®me vuln√©rable pour s'assurer que ce n'est pas un pi√®ge. Pour la m√™me raison, nous nous sommes efforc√©s d'atteindre non seulement le r√©alisme du hanipot en termes de design et d'aspects techniques, mais aussi de cr√©er l'apparence d'une v√©ritable entreprise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se mettant √† la place d'un kulhaker hypoth√©tique, nous avons d√©velopp√© un algorithme de v√©rification qui distinguerait un syst√®me r√©el d'un pi√®ge. Cela comprenait la recherche d'adresses IP de l'entreprise dans les syst√®mes de r√©putation, la recherche invers√©e de l'historique des adresses IP, la recherche de noms et de mots cl√©s li√©s √† l'entreprise, ainsi que ses contreparties et bien d'autres choses. En cons√©quence, la l√©gende s'est av√©r√©e assez convaincante et attrayante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©cid√© de positionner l'usine de trappes comme une petite boutique de prototypage industriel, travaillant pour de tr√®s gros clients anonymes du secteur militaire et a√©ronautique. Cela a √©limin√© les difficult√©s juridiques li√©es √† l'utilisation d'une marque existante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous avons d√ª trouver une vision, une mission et le nom de l'organisation. Nous avons d√©cid√© que notre entreprise serait une startup avec un petit nombre d'employ√©s, dont chacun est fondateur. Cela a ajout√© de la cr√©dibilit√© √† la l√©gende de la sp√©cialisation de notre entreprise, ce qui lui permet de travailler avec des projets d√©licats pour des clients importants et importants. Nous voulions que notre entreprise semble faible en termes de cybers√©curit√©, mais en m√™me temps, il √©tait √©vident que nous travaillions avec des actifs importants dans des syst√®mes cibles.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'√©cran du site MeTech Hanipot. Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons choisi le mot MeTech comme nom de l'entreprise. Le site a √©t√© r√©alis√© sur la base d'un mod√®le gratuit. Les images ont √©t√© prises √† partir de banques de photos, en utilisant les plus impopulaires et les plus raffin√©es pour les rendre moins reconnaissables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voulions que l'entreprise ait l'air r√©elle, nous avons donc d√ª ajouter des employ√©s avec des comp√©tences professionnelles correspondant au profil de l'entreprise. Nous avons trouv√© des noms et des personnalit√©s pour eux, puis nous avons essay√© de s√©lectionner des images dans des banques de photos en fonction de leur origine ethnique. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="image"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'√©cran du site MeTech Hanipot. Source: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas nous r√©v√©ler, nous recherchions des photos de groupe de bonne qualit√© parmi lesquelles nous pourrions choisir les visages dont nous avions besoin. </font><font style="vertical-align: inherit;">Cependant, nous avons ensuite abandonn√© cette option, car un pirate potentiel pourrait tirer parti de la recherche d'image invers√©e et constater que nos ¬´employ√©s¬ª ne vivent que dans des banques de photos. </font><font style="vertical-align: inherit;">Au final, nous avons profit√© de photographies de personnes inexistantes cr√©√©es √† l'aide de r√©seaux de neurones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les profils des employ√©s publi√©s sur le site contenaient des informations importantes sur leurs comp√©tences techniques, mais nous avons √©vit√© les instructions d'√©tablissements d'enseignement et de villes sp√©cifiques. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cr√©er des bo√Ætes aux lettres, nous avons utilis√© le serveur du fournisseur d'h√©bergement, puis lou√© plusieurs num√©ros de t√©l√©phone aux √âtats-Unis et les avons combin√©s en un central t√©l√©phonique virtuel avec un menu vocal et un r√©pondeur.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastructure Hanipot</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour √©viter d'√™tre expos√©, nous avons d√©cid√© d'utiliser une combinaison d'√©quipements industriels r√©els, d'ordinateurs physiques et de machines virtuelles s√©curis√©es. </font><font style="vertical-align: inherit;">Pour l'avenir, nous disons que nous avons v√©rifi√© le r√©sultat de nos efforts en utilisant le moteur de recherche Shodan, et il a montr√© que le hanipot ressemble √† un v√©ritable syst√®me industriel. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©sultat de la num√©risation d'un hanipot √† l'aide de Shodan. </font><font style="vertical-align: inherit;">Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons utilis√© quatre automates comme mat√©riel pour notre pi√®ge:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces automates ont √©t√© s√©lectionn√©s pour leur popularit√© sur le march√© mondial des syst√®mes de contr√¥le. </font><font style="vertical-align: inherit;">Et chacun de ces contr√¥leurs utilise son propre protocole, ce qui nous permet de v√©rifier lesquels des automates attaqueront le plus souvent et s'ils int√©resseront en principe quiconque. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'√©quipement de notre pi√®ge ¬´usine¬ª. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous n'avons pas simplement mis des morceaux de fer et les avons connect√©s √† Internet. </font><font style="vertical-align: inherit;">Nous avons programm√© chaque contr√¥leur pour effectuer des t√¢ches, parmi lesquelles</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©lange</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande du br√ªleur et de la bande transporteuse,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">palettisation √† l'aide d'un bras robotis√©.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour rendre le processus de production r√©aliste, nous avons programm√© la logique pour modifier al√©atoirement les param√®tres de r√©troaction, simuler le d√©marrage et l'arr√™t des moteurs, allumer et √©teindre le br√ªleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre usine avait trois ordinateurs virtuels et un physique. Les machines virtuelles ont √©t√© utilis√©es pour contr√¥ler l'usine, le robot de palettisation et comme lieu de travail automatis√© de l'ing√©nieur logiciel PLC. L'ordinateur physique fonctionnait comme un serveur de fichiers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de surveiller les attaques sur l'automate, nous voulions surveiller l'√©tat des programmes t√©l√©charg√©s sur nos appareils. Pour ce faire, nous avons cr√©√© une interface qui nous a permis de d√©terminer rapidement comment les √©tats de nos actionneurs et installations virtuelles ont √©t√© modifi√©s. D√©j√† au stade de la planification, nous avons constat√© qu'il est beaucoup plus facile de mettre en ≈ìuvre cela avec un programme de contr√¥le que par une programmation directe de la logique du contr√¥leur. Nous avons ouvert l'acc√®s √† l'interface de gestion des appareils de notre hanipot via VNC sans mot de passe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les robots industriels sont un √©l√©ment cl√© de la fabrication intelligente moderne. √Ä cet √©gard, nous avons d√©cid√© d'ajouter un robot et un AWP pour le contr√¥ler dans l'√©quipement de notre usine-pi√®ge. Pour rendre "l'usine" plus r√©aliste, nous avons install√© de vrais logiciels sur la commande AWP, que les ing√©nieurs utilisent pour programmer graphiquement la logique du robot. Eh bien, comme les robots industriels sont g√©n√©ralement situ√©s dans un r√©seau interne isol√©, nous avons d√©cid√© de laisser l'acc√®s VNC non prot√©g√© uniquement √† la gestion des postes de travail. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement RobotStudio avec un mod√®le 3D de notre robot. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur une machine virtuelle avec un poste de travail de contr√¥le de robot, nous avons install√© l'environnement de programmation RobotStudio d'ABB Robotics. </font><font style="vertical-align: inherit;">Apr√®s avoir install√© RobotStudio, nous y avons ouvert un fichier de simulation avec notre robot afin que son image 3D soit visible √† l'√©cran. </font><font style="vertical-align: inherit;">En cons√©quence, Shodan et d'autres moteurs de recherche, apr√®s avoir d√©couvert un serveur VNC non prot√©g√©, recevront cette image de l'√©cran et la montreront √† ceux qui recherchent des robots industriels avec un acc√®s ouvert au contr√¥le. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sens d'une telle attention aux d√©tails √©tait de cr√©er un objectif attrayant et le plus r√©aliste pour les attaquants qui, l'ayant d√©couvert, y reviendraient encore et encore.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ing√©nieur AWP</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour programmer la logique PLC, nous avons ajout√© un ordinateur d'ing√©nierie √† l'infrastructure. </font><font style="vertical-align: inherit;">Un logiciel industriel de programmation PLC y a √©t√© install√©:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portail TIA pour Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix pour contr√¥leur Allen-Bradley,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One pour Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons d√©cid√© que le poste d'ing√©nierie ne serait pas accessible en dehors du r√©seau. </font><font style="vertical-align: inherit;">Au lieu de cela, nous avons d√©fini le m√™me mot de passe pour le compte administrateur sur celui-ci que sur les postes de travail du robot et les postes de travail de l'usine accessibles depuis Internet. </font><font style="vertical-align: inherit;">Cette configuration est assez courante dans de nombreuses entreprises. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, malgr√© tous nos efforts, pas un seul attaquant n‚Äôa atteint le AWP de l‚Äôing√©nieur.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur de fichiers</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous en avions besoin comme leurre pour les intrus et comme moyen de sauvegarder notre propre ¬´travail¬ª dans une fabrique de pi√®ges. Cela nous a permis de partager des fichiers avec notre haniot √† l'aide de p√©riph√©riques USB, sans laisser de traces dans le pi√®ge r√©seau. En tant qu'OS pour le serveur de fichiers, nous avons install√© Windows 7 Pro, dans lequel nous avons cr√©√© un dossier partag√© accessible pour la lecture et l'√©criture √† tout le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, nous n'avons pas fait de hi√©rarchie de dossiers et de documents sur le serveur de fichiers. Cependant, il s'est av√©r√© que les attaquants √©tudiaient activement ce dossier, nous avons donc d√©cid√© de le remplir avec divers fichiers. Pour ce faire, nous avons √©crit un script python qui a cr√©√© un fichier de taille al√©atoire avec l'une des extensions sp√©cifi√©es, formant un nom bas√© sur le dictionnaire. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un script pour g√©n√©rer des noms de fichiers attrayants. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir ex√©cut√© le script, nous avons obtenu le r√©sultat souhait√© sous la forme d'un dossier rempli de fichiers avec des noms tr√®s int√©ressants. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©sultat du script. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement de surveillance</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir consacr√© tant d'efforts √† cr√©er une entreprise r√©aliste, nous ne pouvions tout simplement pas nous permettre de nous injecter dans l'environnement pour surveiller nos ¬´visiteurs¬ª. Nous devions obtenir toutes les donn√©es en temps r√©el afin que les attaquants ne remarquent pas qu'ils √©taient surveill√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous l'avons impl√©ment√© √† l'aide de quatre adaptateurs USB-Ethernet, de quatre coupleurs Ethernet SharkTap, de Raspberry Pi 3 et d'un grand disque externe. Le sch√©ma de notre r√©seau ressemblait √† ceci: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sch√©ma d'un r√©seau de hanipot avec √©quipement de surveillance. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons organis√© trois prises SharkTap pour surveiller tout le trafic externe vers les API accessibles uniquement √† partir du r√©seau interne. Le quatri√®me SharkTap a suivi le trafic des invit√©s de la machine virtuelle vuln√©rable.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coupleur Ethernet SharkTap et routeur Sierra Wireless AirLink RV50. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi a effectu√© une capture quotidienne du trafic. </font><font style="vertical-align: inherit;">Nous avons √©tabli une connexion Internet √† l'aide du routeur cellulaire Sierra Wireless AirLink RV50, souvent utilis√© dans les entreprises industrielles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, ce routeur n'a pas permis le blocage s√©lectif des attaques qui ne correspondaient pas √† nos plans, nous avons donc ajout√© le pare-feu Cisco ASA 5505 en mode transparent au r√©seau pour effectuer un blocage avec un impact minimal sur le r√©seau.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse du trafic</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark et tcpdump sont appropri√©s pour r√©soudre rapidement les probl√®mes actuels, mais dans notre cas, leurs capacit√©s n'√©taient pas suffisantes, car nous avions beaucoup de gigaoctets de trafic, qui ont √©t√© analys√©s par plusieurs personnes. </font><font style="vertical-align: inherit;">Nous avons utilis√© l'analyseur open source Moloch d√©velopp√© par AOL. </font><font style="vertical-align: inherit;">En termes de fonctionnalit√©s, il est comparable √† Wireshark, mais il a plus de fonctionnalit√©s pour la collaboration, la description et le balisage des packages, l'exportation et d'autres t√¢ches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous ne voulions pas traiter les donn√©es collect√©es sur les ordinateurs hanipot, les vidages PCAP √©taient export√©s tous les jours vers AWS, d'o√π nous les avions d√©j√† import√©s vers la machine avec Moloch.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrement d'√©cran </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour documenter les actions des crackers dans notre hanipot, nous avons √©crit un script qui a pris des captures d'√©cran de la machine virtuelle √† un intervalle donn√© et, en comparant avec la capture d'√©cran pr√©c√©dente, d√©termin√© si quelque chose se passait l√† ou non. </font><font style="vertical-align: inherit;">Lorsqu'une activit√© a √©t√© d√©tect√©e, le script comprenait un enregistrement d'√©cran. </font><font style="vertical-align: inherit;">Cette approche s'est av√©r√©e la plus efficace. </font><font style="vertical-align: inherit;">Nous avons √©galement essay√© d'analyser le trafic VNC √† partir du vidage PCAP afin de comprendre les changements survenus dans le syst√®me, mais au final, l'enregistrement d'√©cran que nous avons mis en place s'est av√©r√© √™tre plus simple et plus visuel.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surveillance des sessions VNC</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cela, nous avons utilis√© Chaosreader et VNCLogger. </font><font style="vertical-align: inherit;">Les deux utilitaires extraient les s√©quences de touches du vidage PCAP, mais VNCLogger g√®re plus correctement les touches telles que Retour arri√®re, Entr√©e, Ctrl. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger a deux inconv√©nients. </font><font style="vertical-align: inherit;">Premi√®rement: il ne peut extraire des cl√©s qu'en ¬´√©coutant¬ª le trafic sur l'interface, nous avons donc d√ª simuler une session VNC pour celui-ci en utilisant tcpreplay. </font><font style="vertical-align: inherit;">Le deuxi√®me inconv√©nient de VNCLogger est commun avec Chaosreader: ils ne montrent pas tous les deux le contenu du presse-papiers. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai d√ª utiliser Wireshark.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pirates de leurre</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons cr√©√© un hanipot pour √™tre attaqu√©. </font><font style="vertical-align: inherit;">Pour y parvenir, nous avons organis√© une fuite d'informations destin√©e √† attirer l'attention des crackers potentiels. </font><font style="vertical-align: inherit;">Les ports suivants ont √©t√© ouverts sur le hanipot: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="image"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le port RDP a d√ª √™tre ferm√© peu de temps apr√®s le d√©but des travaux, car en raison de l'√©norme quantit√© de trafic de num√©risation dans notre r√©seau, il y avait des probl√®mes de performances. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les terminaux VNC ont d'abord fonctionn√© en mode "affichage uniquement" sans mot de passe, puis nous les avons "par erreur" pass√©s en mode d'acc√®s complet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour attirer les attaquants, nous avons publi√© deux messages contenant des informations divulgu√©es sur le syst√®me industriel disponible sur PasteBin. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'un des messages publi√©s sur PasteBin pour attirer les attaques. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attaques</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les Hanipot ont v√©cu en ligne pendant environ sept mois. La premi√®re attaque a eu lieu un mois apr√®s la publication en ligne de Hanipot. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Il y avait beaucoup de trafic provenant de scanners d'entreprises bien connues - ip-ip, Rapid, Shadow Server, Shodan, ZoomEye et autres. Il y en avait tellement que nous devions exclure leurs adresses IP de l'analyse: 610 sur 9452 ou 6,45% de toutes les adresses IP uniques appartenaient √† des scanners compl√®tement l√©gitimes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fraudeurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'un des plus grands risques auxquels nous avons √©t√© confront√©s √©tait l'utilisation de notre syst√®me √† des fins criminelles: acheter des smartphones via un compte d'abonn√©, encaisser des miles a√©riens avec des cartes-cadeaux et d'autres types de fraude </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mineurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des premiers visiteurs de notre syst√®me s'est av√©r√© √™tre un mineur. Il y a t√©l√©charg√© le logiciel d'exploitation Monero. Il n'aurait pas pu gagner beaucoup sur notre syst√®me sp√©cifique en raison de sa faible productivit√©. Cependant, si nous combinons les efforts de plusieurs dizaines, voire centaines de tels syst√®mes, cela pourrait tr√®s bien aboutir. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extorsionnistes</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant le fonctionnement du hanipot, nous avons rencontr√© √† deux reprises de vrais virus ran√ßongiciels. Dans le premier cas, c'√©tait Crysis. Ses op√©rateurs se sont connect√©s au syst√®me via VNC, mais ont ensuite install√© TeamViewer et ont d√©j√† effectu√© d'autres actions avec lui. Apr√®s avoir attendu un message de ransomware demandant une ran√ßon de 10 000 $ en BTC, nous avons entam√© une correspondance avec les criminels, leur demandant de d√©crypter l'un des fichiers pour nous. Ils ont r√©pondu √† la demande et r√©p√©t√© la demande de ran√ßon. Nous avons r√©ussi √† n√©gocier jusqu'√† 6 000 dollars, apr√®s quoi nous avons simplement recharg√© le syst√®me sur une machine virtuelle, car nous avons obtenu toutes les informations n√©cessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxi√®me ransomware √©tait Phobos. Le pirate qui l'a install√© pendant une heure a parcouru le syst√®me de fichiers du hanipot et a analys√© le r√©seau, puis a encore install√© le ransomware.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisi√®me attaque de ransomware s'est av√©r√©e √™tre fausse. </font><font style="vertical-align: inherit;">Un "pirate informatique" inconnu a t√©l√©charg√© le fichier haha.bat sur notre syst√®me, apr√®s quoi nous avons observ√© pendant un certain temps comment il essayait de le faire fonctionner. </font><font style="vertical-align: inherit;">Une tentative a √©t√© de renommer haha.bat en haha.rnsmwr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hacker" augmente la nocivit√© du fichier bat, en changeant son extension en .rnsmwr. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lorsque le fichier de commandes a finalement commenc√© √† s'ex√©cuter, le pirate l'a modifi√©, augmentant la ran√ßon de 200 $ √† 750 $. </font><font style="vertical-align: inherit;">Apr√®s cela, il a ¬´crypt√©¬ª tous les fichiers, laiss√© un message de ran√ßongiciel sur le bureau et disparu, changeant les mots de passe sur notre VNC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s quelques jours, le pirate est revenu et pour se rappeler, il a lanc√© un fichier batch, qui a ouvert de nombreuses fen√™tres avec un site porno. </font><font style="vertical-align: inherit;">Apparemment, de cette fa√ßon, il a essay√© d'attirer l'attention sur sa demande.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de l'√©tude, il s'est av√©r√© que d√®s que des informations sur la vuln√©rabilit√© ont √©t√© publi√©es, le hanipot a attir√© l'attention et l'activit√© a augment√© de jour en jour. Pour que le pi√®ge attire l'attention, nous avons d√ª admettre de nombreuses failles de s√©curit√© de notre soci√©t√© fictive. Malheureusement, cette situation est loin d'√™tre rare parmi de nombreuses entreprises r√©elles qui ne disposent pas de personnel informatique et de s√©curit√© de l'information √† temps plein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas g√©n√©ral, les organisations devraient utiliser le principe du moindre privil√®ge, tandis que nous avons mis en place exactement le contraire pour attirer les intrus. Et plus nous observions les attaques, plus elles devenaient sophistiqu√©es par rapport aux m√©thodes de test de p√©n√©tration standard.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et surtout: toutes ces attaques √©choueraient si des mesures de s√©curit√© ad√©quates √©taient mises en place lors de la configuration du r√©seau. </font><font style="vertical-align: inherit;">Les organisations doivent s'assurer que leurs √©quipements et composants d'infrastructure industrielle ne sont pas accessibles depuis Internet, comme nous l'avons fait sp√©cifiquement dans notre pi√®ge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que nous n'ayons enregistr√© aucune attaque sur le poste de travail de l'ing√©nieur, malgr√© l'utilisation du m√™me mot de passe d'administrateur local sur tous les ordinateurs, nous devons √©viter cette pratique afin de minimiser les risques d'intrusions. </font><font style="vertical-align: inherit;">En effet, une s√©curit√© m√©diocre constitue une invitation suppl√©mentaire √† attaquer des syst√®mes industriels qui int√©ressent depuis longtemps les cybercriminels.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490392/index.html">Catchain: algorithme de consensus TON Blockchain</a></li>
<li><a href="../fr490394/index.html">Commodore Amiga 500+: ne laissez personne s'en offusquer</a></li>
<li><a href="../fr490398/index.html">Poudlard rouge. Officiers, ou pourquoi un historien est comme un d√©tective</a></li>
<li><a href="../fr490400/index.html">Utilisation de la biblioth√®que OpenCV pour reconna√Ætre des arcs elliptiques dans des sections 2D de nuages ‚Äã‚Äãde points 3D</a></li>
<li><a href="../fr490404/index.html">Pourquoi et comment la 5G changera tout: technologie, mise en ≈ìuvre progressive et base d'√©l√©ments pour l'√©quipement d'abonn√©</a></li>
<li><a href="../fr490408/index.html">FreeBSD: –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ GNU/Linux</a></li>
<li><a href="../fr490410/index.html">Neurones vivants et artificiels connect√©s via Internet</a></li>
<li><a href="../fr490412/index.html">Peut-√™tre qu'on devrait se calmer un peu avec JavaScript?</a></li>
<li><a href="../fr490416/index.html">Vid√©o de conf√©rence du Computer Science Club</a></li>
<li><a href="../fr490418/index.html">G√©n√©ration Y et g√©n√©ration Alpha VS Enseignement sup√©rieur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>