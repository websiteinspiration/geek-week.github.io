<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐶 🏪 🤱 Inexprimablement attrayant: comment nous avons créé un haniot qui ne peut pas être exposé 🚝 👨🏽‍🔬 😚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", - - — , « » . , : , . , , , . , , «Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats». — . 
 
  : -
 La tâche principa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Inexprimablement attrayant: comment nous avons créé un haniot qui ne peut pas être exposé</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="image"><br>
<i> , -       - — ,  «  »        .    ,      :   ,        .     ,    ,        ,    .  ,   ,      «<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</a>».     —   . </i><br>
<a name="habracut"></a><br>
<h3> : -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tâche principale dans la création de notre super piège était de nous empêcher d'être exposés par des pirates qui s'y intéressaient. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai dû faire beaucoup de travail:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créez une légende réaliste sur l'entreprise, y compris le nom et la photo des employés, les numéros de téléphone et les e-mails.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inventer et mettre en œuvre un modèle d'infrastructure industrielle qui correspond à la légende de notre entreprise. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Décidez quels services réseau seront disponibles à l'extérieur, mais ne vous impliquez pas dans l'ouverture de ports vulnérables afin que cela ne ressemble pas à un piège pour les coots. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisez l'apparition de fuites d'informations sur le système vulnérable et diffusez ces informations auprès des attaquants potentiels.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre en place une surveillance discrète des pirates dans l'infrastructure des pièges. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, tout d'abord.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer une légende</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les cybercriminels sont déjà habitués au fait qu'ils rencontrent beaucoup de manipulations, donc la partie la plus avancée d'entre eux mène une étude approfondie de chaque système vulnérable pour s'assurer que ce n'est pas un piège. Pour la même raison, nous nous sommes efforcés d'atteindre non seulement le réalisme du hanipot en termes de design et d'aspects techniques, mais aussi de créer l'apparence d'une véritable entreprise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se mettant à la place d'un kulhaker hypothétique, nous avons développé un algorithme de vérification qui distinguerait un système réel d'un piège. Cela comprenait la recherche d'adresses IP de l'entreprise dans les systèmes de réputation, la recherche inversée de l'historique des adresses IP, la recherche de noms et de mots clés liés à l'entreprise, ainsi que ses contreparties et bien d'autres choses. En conséquence, la légende s'est avérée assez convaincante et attrayante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons décidé de positionner l'usine de trappes comme une petite boutique de prototypage industriel, travaillant pour de très gros clients anonymes du secteur militaire et aéronautique. Cela a éliminé les difficultés juridiques liées à l'utilisation d'une marque existante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous avons dû trouver une vision, une mission et le nom de l'organisation. Nous avons décidé que notre entreprise serait une startup avec un petit nombre d'employés, dont chacun est fondateur. Cela a ajouté de la crédibilité à la légende de la spécialisation de notre entreprise, ce qui lui permet de travailler avec des projets délicats pour des clients importants et importants. Nous voulions que notre entreprise semble faible en termes de cybersécurité, mais en même temps, il était évident que nous travaillions avec des actifs importants dans des systèmes cibles.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'écran du site MeTech Hanipot. Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons choisi le mot MeTech comme nom de l'entreprise. Le site a été réalisé sur la base d'un modèle gratuit. Les images ont été prises à partir de banques de photos, en utilisant les plus impopulaires et les plus raffinées pour les rendre moins reconnaissables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voulions que l'entreprise ait l'air réelle, nous avons donc dû ajouter des employés avec des compétences professionnelles correspondant au profil de l'entreprise. Nous avons trouvé des noms et des personnalités pour eux, puis nous avons essayé de sélectionner des images dans des banques de photos en fonction de leur origine ethnique. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="image"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'écran du site MeTech Hanipot. Source: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas nous révéler, nous recherchions des photos de groupe de bonne qualité parmi lesquelles nous pourrions choisir les visages dont nous avions besoin. </font><font style="vertical-align: inherit;">Cependant, nous avons ensuite abandonné cette option, car un pirate potentiel pourrait tirer parti de la recherche d'image inversée et constater que nos «employés» ne vivent que dans des banques de photos. </font><font style="vertical-align: inherit;">Au final, nous avons profité de photographies de personnes inexistantes créées à l'aide de réseaux de neurones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les profils des employés publiés sur le site contenaient des informations importantes sur leurs compétences techniques, mais nous avons évité les instructions d'établissements d'enseignement et de villes spécifiques. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour créer des boîtes aux lettres, nous avons utilisé le serveur du fournisseur d'hébergement, puis loué plusieurs numéros de téléphone aux États-Unis et les avons combinés en un central téléphonique virtuel avec un menu vocal et un répondeur.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastructure Hanipot</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour éviter d'être exposé, nous avons décidé d'utiliser une combinaison d'équipements industriels réels, d'ordinateurs physiques et de machines virtuelles sécurisées. </font><font style="vertical-align: inherit;">Pour l'avenir, nous disons que nous avons vérifié le résultat de nos efforts en utilisant le moteur de recherche Shodan, et il a montré que le hanipot ressemble à un véritable système industriel. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le résultat de la numérisation d'un hanipot à l'aide de Shodan. </font><font style="vertical-align: inherit;">Source: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons utilisé quatre automates comme matériel pour notre piège:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces automates ont été sélectionnés pour leur popularité sur le marché mondial des systèmes de contrôle. </font><font style="vertical-align: inherit;">Et chacun de ces contrôleurs utilise son propre protocole, ce qui nous permet de vérifier lesquels des automates attaqueront le plus souvent et s'ils intéresseront en principe quiconque. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'équipement de notre piège «usine». </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous n'avons pas simplement mis des morceaux de fer et les avons connectés à Internet. </font><font style="vertical-align: inherit;">Nous avons programmé chaque contrôleur pour effectuer des tâches, parmi lesquelles</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mélange</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande du brûleur et de la bande transporteuse,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">palettisation à l'aide d'un bras robotisé.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour rendre le processus de production réaliste, nous avons programmé la logique pour modifier aléatoirement les paramètres de rétroaction, simuler le démarrage et l'arrêt des moteurs, allumer et éteindre le brûleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre usine avait trois ordinateurs virtuels et un physique. Les machines virtuelles ont été utilisées pour contrôler l'usine, le robot de palettisation et comme lieu de travail automatisé de l'ingénieur logiciel PLC. L'ordinateur physique fonctionnait comme un serveur de fichiers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de surveiller les attaques sur l'automate, nous voulions surveiller l'état des programmes téléchargés sur nos appareils. Pour ce faire, nous avons créé une interface qui nous a permis de déterminer rapidement comment les états de nos actionneurs et installations virtuelles ont été modifiés. Déjà au stade de la planification, nous avons constaté qu'il est beaucoup plus facile de mettre en œuvre cela avec un programme de contrôle que par une programmation directe de la logique du contrôleur. Nous avons ouvert l'accès à l'interface de gestion des appareils de notre hanipot via VNC sans mot de passe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les robots industriels sont un élément clé de la fabrication intelligente moderne. À cet égard, nous avons décidé d'ajouter un robot et un AWP pour le contrôler dans l'équipement de notre usine-piège. Pour rendre "l'usine" plus réaliste, nous avons installé de vrais logiciels sur la commande AWP, que les ingénieurs utilisent pour programmer graphiquement la logique du robot. Eh bien, comme les robots industriels sont généralement situés dans un réseau interne isolé, nous avons décidé de laisser l'accès VNC non protégé uniquement à la gestion des postes de travail. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement RobotStudio avec un modèle 3D de notre robot. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur une machine virtuelle avec un poste de travail de contrôle de robot, nous avons installé l'environnement de programmation RobotStudio d'ABB Robotics. </font><font style="vertical-align: inherit;">Après avoir installé RobotStudio, nous y avons ouvert un fichier de simulation avec notre robot afin que son image 3D soit visible à l'écran. </font><font style="vertical-align: inherit;">En conséquence, Shodan et d'autres moteurs de recherche, après avoir découvert un serveur VNC non protégé, recevront cette image de l'écran et la montreront à ceux qui recherchent des robots industriels avec un accès ouvert au contrôle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le sens d'une telle attention aux détails était de créer un objectif attrayant et le plus réaliste pour les attaquants qui, l'ayant découvert, y reviendraient encore et encore.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingénieur AWP</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour programmer la logique PLC, nous avons ajouté un ordinateur d'ingénierie à l'infrastructure. </font><font style="vertical-align: inherit;">Un logiciel industriel de programmation PLC y a été installé:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portail TIA pour Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix pour contrôleur Allen-Bradley,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One pour Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons décidé que le poste d'ingénierie ne serait pas accessible en dehors du réseau. </font><font style="vertical-align: inherit;">Au lieu de cela, nous avons défini le même mot de passe pour le compte administrateur sur celui-ci que sur les postes de travail du robot et les postes de travail de l'usine accessibles depuis Internet. </font><font style="vertical-align: inherit;">Cette configuration est assez courante dans de nombreuses entreprises. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, malgré tous nos efforts, pas un seul attaquant n’a atteint le AWP de l’ingénieur.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur de fichiers</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous en avions besoin comme leurre pour les intrus et comme moyen de sauvegarder notre propre «travail» dans une fabrique de pièges. Cela nous a permis de partager des fichiers avec notre haniot à l'aide de périphériques USB, sans laisser de traces dans le piège réseau. En tant qu'OS pour le serveur de fichiers, nous avons installé Windows 7 Pro, dans lequel nous avons créé un dossier partagé accessible pour la lecture et l'écriture à tout le monde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, nous n'avons pas fait de hiérarchie de dossiers et de documents sur le serveur de fichiers. Cependant, il s'est avéré que les attaquants étudiaient activement ce dossier, nous avons donc décidé de le remplir avec divers fichiers. Pour ce faire, nous avons écrit un script python qui a créé un fichier de taille aléatoire avec l'une des extensions spécifiées, formant un nom basé sur le dictionnaire. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un script pour générer des noms de fichiers attrayants. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir exécuté le script, nous avons obtenu le résultat souhaité sous la forme d'un dossier rempli de fichiers avec des noms très intéressants. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le résultat du script. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement de surveillance</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir consacré tant d'efforts à créer une entreprise réaliste, nous ne pouvions tout simplement pas nous permettre de nous injecter dans l'environnement pour surveiller nos «visiteurs». Nous devions obtenir toutes les données en temps réel afin que les attaquants ne remarquent pas qu'ils étaient surveillés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous l'avons implémenté à l'aide de quatre adaptateurs USB-Ethernet, de quatre coupleurs Ethernet SharkTap, de Raspberry Pi 3 et d'un grand disque externe. Le schéma de notre réseau ressemblait à ceci: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schéma d'un réseau de hanipot avec équipement de surveillance. Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nous avons organisé trois prises SharkTap pour surveiller tout le trafic externe vers les API accessibles uniquement à partir du réseau interne. Le quatrième SharkTap a suivi le trafic des invités de la machine virtuelle vulnérable.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coupleur Ethernet SharkTap et routeur Sierra Wireless AirLink RV50. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi a effectué une capture quotidienne du trafic. </font><font style="vertical-align: inherit;">Nous avons établi une connexion Internet à l'aide du routeur cellulaire Sierra Wireless AirLink RV50, souvent utilisé dans les entreprises industrielles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, ce routeur n'a pas permis le blocage sélectif des attaques qui ne correspondaient pas à nos plans, nous avons donc ajouté le pare-feu Cisco ASA 5505 en mode transparent au réseau pour effectuer un blocage avec un impact minimal sur le réseau.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse du trafic</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark et tcpdump sont appropriés pour résoudre rapidement les problèmes actuels, mais dans notre cas, leurs capacités n'étaient pas suffisantes, car nous avions beaucoup de gigaoctets de trafic, qui ont été analysés par plusieurs personnes. </font><font style="vertical-align: inherit;">Nous avons utilisé l'analyseur open source Moloch développé par AOL. </font><font style="vertical-align: inherit;">En termes de fonctionnalités, il est comparable à Wireshark, mais il a plus de fonctionnalités pour la collaboration, la description et le balisage des packages, l'exportation et d'autres tâches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous ne voulions pas traiter les données collectées sur les ordinateurs hanipot, les vidages PCAP étaient exportés tous les jours vers AWS, d'où nous les avions déjà importés vers la machine avec Moloch.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrement d'écran </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour documenter les actions des crackers dans notre hanipot, nous avons écrit un script qui a pris des captures d'écran de la machine virtuelle à un intervalle donné et, en comparant avec la capture d'écran précédente, déterminé si quelque chose se passait là ou non. </font><font style="vertical-align: inherit;">Lorsqu'une activité a été détectée, le script comprenait un enregistrement d'écran. </font><font style="vertical-align: inherit;">Cette approche s'est avérée la plus efficace. </font><font style="vertical-align: inherit;">Nous avons également essayé d'analyser le trafic VNC à partir du vidage PCAP afin de comprendre les changements survenus dans le système, mais au final, l'enregistrement d'écran que nous avons mis en place s'est avéré être plus simple et plus visuel.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surveillance des sessions VNC</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cela, nous avons utilisé Chaosreader et VNCLogger. </font><font style="vertical-align: inherit;">Les deux utilitaires extraient les séquences de touches du vidage PCAP, mais VNCLogger gère plus correctement les touches telles que Retour arrière, Entrée, Ctrl. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger a deux inconvénients. </font><font style="vertical-align: inherit;">Premièrement: il ne peut extraire des clés qu'en «écoutant» le trafic sur l'interface, nous avons donc dû simuler une session VNC pour celui-ci en utilisant tcpreplay. </font><font style="vertical-align: inherit;">Le deuxième inconvénient de VNCLogger est commun avec Chaosreader: ils ne montrent pas tous les deux le contenu du presse-papiers. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai dû utiliser Wireshark.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pirates de leurre</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons créé un hanipot pour être attaqué. </font><font style="vertical-align: inherit;">Pour y parvenir, nous avons organisé une fuite d'informations destinée à attirer l'attention des crackers potentiels. </font><font style="vertical-align: inherit;">Les ports suivants ont été ouverts sur le hanipot: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="image"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le port RDP a dû être fermé peu de temps après le début des travaux, car en raison de l'énorme quantité de trafic de numérisation dans notre réseau, il y avait des problèmes de performances. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les terminaux VNC ont d'abord fonctionné en mode "affichage uniquement" sans mot de passe, puis nous les avons "par erreur" passés en mode d'accès complet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour attirer les attaquants, nous avons publié deux messages contenant des informations divulguées sur le système industriel disponible sur PasteBin. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'un des messages publiés sur PasteBin pour attirer les attaques. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attaques</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les Hanipot ont vécu en ligne pendant environ sept mois. La première attaque a eu lieu un mois après la publication en ligne de Hanipot. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Il y avait beaucoup de trafic provenant de scanners d'entreprises bien connues - ip-ip, Rapid, Shadow Server, Shodan, ZoomEye et autres. Il y en avait tellement que nous devions exclure leurs adresses IP de l'analyse: 610 sur 9452 ou 6,45% de toutes les adresses IP uniques appartenaient à des scanners complètement légitimes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fraudeurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'un des plus grands risques auxquels nous avons été confrontés était l'utilisation de notre système à des fins criminelles: acheter des smartphones via un compte d'abonné, encaisser des miles aériens avec des cartes-cadeaux et d'autres types de fraude </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mineurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des premiers visiteurs de notre système s'est avéré être un mineur. Il y a téléchargé le logiciel d'exploitation Monero. Il n'aurait pas pu gagner beaucoup sur notre système spécifique en raison de sa faible productivité. Cependant, si nous combinons les efforts de plusieurs dizaines, voire centaines de tels systèmes, cela pourrait très bien aboutir. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extorsionnistes</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant le fonctionnement du hanipot, nous avons rencontré à deux reprises de vrais virus rançongiciels. Dans le premier cas, c'était Crysis. Ses opérateurs se sont connectés au système via VNC, mais ont ensuite installé TeamViewer et ont déjà effectué d'autres actions avec lui. Après avoir attendu un message de ransomware demandant une rançon de 10 000 $ en BTC, nous avons entamé une correspondance avec les criminels, leur demandant de décrypter l'un des fichiers pour nous. Ils ont répondu à la demande et répété la demande de rançon. Nous avons réussi à négocier jusqu'à 6 000 dollars, après quoi nous avons simplement rechargé le système sur une machine virtuelle, car nous avons obtenu toutes les informations nécessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le deuxième ransomware était Phobos. Le pirate qui l'a installé pendant une heure a parcouru le système de fichiers du hanipot et a analysé le réseau, puis a encore installé le ransomware.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième attaque de ransomware s'est avérée être fausse. </font><font style="vertical-align: inherit;">Un "pirate informatique" inconnu a téléchargé le fichier haha.bat sur notre système, après quoi nous avons observé pendant un certain temps comment il essayait de le faire fonctionner. </font><font style="vertical-align: inherit;">Une tentative a été de renommer haha.bat en haha.rnsmwr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hacker" augmente la nocivité du fichier bat, en changeant son extension en .rnsmwr. </font><font style="vertical-align: inherit;">Source: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Lorsque le fichier de commandes a finalement commencé à s'exécuter, le pirate l'a modifié, augmentant la rançon de 200 $ à 750 $. </font><font style="vertical-align: inherit;">Après cela, il a «crypté» tous les fichiers, laissé un message de rançongiciel sur le bureau et disparu, changeant les mots de passe sur notre VNC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après quelques jours, le pirate est revenu et pour se rappeler, il a lancé un fichier batch, qui a ouvert de nombreuses fenêtres avec un site porno. </font><font style="vertical-align: inherit;">Apparemment, de cette façon, il a essayé d'attirer l'attention sur sa demande.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de l'étude, il s'est avéré que dès que des informations sur la vulnérabilité ont été publiées, le hanipot a attiré l'attention et l'activité a augmenté de jour en jour. Pour que le piège attire l'attention, nous avons dû admettre de nombreuses failles de sécurité de notre société fictive. Malheureusement, cette situation est loin d'être rare parmi de nombreuses entreprises réelles qui ne disposent pas de personnel informatique et de sécurité de l'information à temps plein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas général, les organisations devraient utiliser le principe du moindre privilège, tandis que nous avons mis en place exactement le contraire pour attirer les intrus. Et plus nous observions les attaques, plus elles devenaient sophistiquées par rapport aux méthodes de test de pénétration standard.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et surtout: toutes ces attaques échoueraient si des mesures de sécurité adéquates étaient mises en place lors de la configuration du réseau. </font><font style="vertical-align: inherit;">Les organisations doivent s'assurer que leurs équipements et composants d'infrastructure industrielle ne sont pas accessibles depuis Internet, comme nous l'avons fait spécifiquement dans notre piège. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que nous n'ayons enregistré aucune attaque sur le poste de travail de l'ingénieur, malgré l'utilisation du même mot de passe d'administrateur local sur tous les ordinateurs, nous devons éviter cette pratique afin de minimiser les risques d'intrusions. </font><font style="vertical-align: inherit;">En effet, une sécurité médiocre constitue une invitation supplémentaire à attaquer des systèmes industriels qui intéressent depuis longtemps les cybercriminels.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr490392/index.html">Catchain: algorithme de consensus TON Blockchain</a></li>
<li><a href="../fr490394/index.html">Commodore Amiga 500+: ne laissez personne s'en offusquer</a></li>
<li><a href="../fr490398/index.html">Poudlard rouge. Officiers, ou pourquoi un historien est comme un détective</a></li>
<li><a href="../fr490400/index.html">Utilisation de la bibliothèque OpenCV pour reconnaître des arcs elliptiques dans des sections 2D de nuages ​​de points 3D</a></li>
<li><a href="../fr490404/index.html">Pourquoi et comment la 5G changera tout: technologie, mise en œuvre progressive et base d'éléments pour l'équipement d'abonné</a></li>
<li><a href="../fr490408/index.html">FreeBSD: гораздо лучше GNU/Linux</a></li>
<li><a href="../fr490410/index.html">Neurones vivants et artificiels connectés via Internet</a></li>
<li><a href="../fr490412/index.html">Peut-être qu'on devrait se calmer un peu avec JavaScript?</a></li>
<li><a href="../fr490416/index.html">Vidéo de conférence du Computer Science Club</a></li>
<li><a href="../fr490418/index.html">Génération Y et génération Alpha VS Enseignement supérieur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>