<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💯 🤸🏾 🦗 本「実際の予測モデリング」 🕺 🧗🏻 👼🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、habrozhiteli！ 「実際の予測モデリング」では、データ前処理、データ分割、モデル調整の基本原則の主要な段階から始めて、予測のすべての側面をカバーしています。モデリングのすべての段階は、実際の実例に基づいて検討されています。各章では、R言語で詳細なコードを示しています。
 
 こ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>本「実際の予測モデリング」</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/462833/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/6z/8t/vz/6z8tvzrupg6sctybnofbe97w9ks.jpeg" align="left" alt="画像"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、habrozhiteli！ 「実際の予測モデリング」では、データ前処理、データ分割、モデル調整の基本原則の主要な段階から始めて、予測のすべての側面をカバーしています。モデリングのすべての段階は、実際の実例に基づいて検討されています。各章では、R言語で詳細なコードを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この本は、予測モデルの紹介とそのアプリケーションのガイドとして使用できます。数学のトレーニングを受けていない読者は、特定の方法の直感的な説明に感謝し、実際のデータで実際の問題を解決することに注意を払うことで、スキルを向上させたいスペシャリストを支援します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
著者は複雑な式を避けようとしましたが、基本的な資料を習得するために、相関や線形回帰分析などの基本的な統計概念の理解で十分ですが、高度なトピックを研究するには数学的な研究が必要です。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抜粋。</font><font style="vertical-align: inherit;">7.5。</font><font style="vertical-align: inherit;">計算</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このセクションでは、R caret、earth、kernlab、およびnnetパッケージの関数を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rには、ニューラルネットワークを作成するための多くのパッケージと関数があります。</font><font style="vertical-align: inherit;">これらには、nnet、ニューラル、およびRSNNSパッケージが含まれます。</font><font style="vertical-align: inherit;">主な焦点はnnetパッケージにあります。これは、1レベルの隠し変数、軽量化を備えたニューラルネットワークの基本モデルをサポートし、比較的単純な構文を特徴としています。</font><font style="vertical-align: inherit;">RSNNSは、幅広いニューラルネットワークをサポートしています。</font><font style="vertical-align: inherit;">BergmeirとBenitez（2012）は、Rのさまざまなニューラルネットワークパッケージについて簡単に説明しています。RSNNSに関するチュートリアルも提供しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニューラルネットワーク</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4月の回帰モデルの近似では、nnet関数はモデルの式と行列インターフェイスの両方を受け取ることができます。</font><font style="vertical-align: inherit;">回帰の場合、非表示の変数と予測の間の線形関係がlinout = TRUEパラメーターで使用されます。</font><font style="vertical-align: inherit;">ニューラルネットワーク関数の最も単純な呼び出しは次のようになります。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; nnetFit &lt;- nnet(predictors, outcome,<font></font>
+                        size = <span class="hljs-number">5</span>,<font></font>
+                        decay = <span class="hljs-number">0.01</span>,<font></font>
+                        linout = TRUE,<font></font>
+                        ##  <font></font>
+                        trace = FALSE,<font></font>
+                        ##     <font></font>
+                        ##  ..<font></font>
+                        maxit = <span class="hljs-number">500</span>,<font></font>
+                        ##   ,  <font></font>
+                        MaxNWts = <span class="hljs-number">5</span> * (ncol(predictors) + <span class="hljs-number">1</span>) + <span class="hljs-number">5</span> + <span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この呼び出しにより、5つの非表示変数を持つ1つのモデルが作成されます。</font><font style="vertical-align: inherit;">予測変数のデータは単一のスケールで標準化されたと想定されています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルを平均化するには、キャレットパッケージのavNNet関数を使用します。これは同じ構文です。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; nnetAvg &lt;- avNNet(predictors, outcome,<font></font>
+                              size = <span class="hljs-number">5</span>,<font></font>
+                              decay = <span class="hljs-number">0.01</span>,<font></font>
+                              ##   <font></font>
+                              repeats = <span class="hljs-number">5</span>,<font></font>
+                              linout = TRUE,<font></font>
+                              ##  <font></font>
+                              trace = FALSE,<font></font>
+                              ##   <font></font>
+                              ##    ..<font></font>
+                              maxit = <span class="hljs-number">500</span>,<font></font>
+                              ##   ,  <font></font>
+                              MaxNWts = <span class="hljs-number">5</span> * (ncol(predictors) + <span class="hljs-number">1</span>) + <span class="hljs-number">5</span> + <span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいデータポイントはコマンドによって処理されます</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; predict(nnetFit, newData)<font></font>
&gt; ## <font></font>
&gt; predict(nnetAvg, newData)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
隠れた変数の数と繰り返しサンプリングによる減量の量を選択する前述の方法を再現するには、最初に予測子を削除して（予測子間の最大絶対ペア相関が超えないように）、method =“ nnet”またはmethod =“ avNNet”パラメーターでtrain関数を適用します。 0.75）：</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; ## findCorrelation     <font></font>
&gt; ##  ,      <font></font>
&gt; ##      <font></font>
&gt; tooHigh &lt;- findCorrelation(cor(solTrainXtrans), cutoff = <span class="hljs-number">.75</span>)<font></font>
&gt; trainXnnet &lt;- solTrainXtrans[, -tooHigh]<font></font>
&gt; testXnnet &lt;- solTestXtrans[, -tooHigh]<font></font>
&gt; ##   -  :<font></font>
&gt; nnetGrid &lt;- expand.grid(.decay = c(<span class="hljs-number">0</span>, <span class="hljs-number">0.01</span>, <span class="hljs-number">.1</span>),<font></font>
+                                     .size = c(<span class="hljs-number">1</span>:<span class="hljs-number">10</span>),<font></font>
+                                     ##   —  <font></font>
+                                     ## (.  )  <font></font>
+                                     ##  .<font></font>
+                                     .bag = FALSE)<font></font>
&gt; set.seed(<span class="hljs-number">100</span>)<font></font>
&gt; nnetTune &lt;- train(solTrainXtrans, solTrainY,<font></font>
+                            method = <span class="hljs-string">"avNNet"</span>,<font></font>
+                            tuneGrid = nnetGrid,<font></font>
+                            trControl = ctrl,<font></font>
+                            ##   <font></font>
+                            ##    <font></font>
+                            preProc = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>),<font></font>
+                            linout = TRUE,<font></font>
+                            trace = FALSE,<font></font>
+                            MaxNWts = <span class="hljs-number">10</span> * (ncol(trainXnnet) + <span class="hljs-number">1</span>) + <span class="hljs-number">10</span> + <span class="hljs-number">1</span>,<font></font>
+                            maxit = <span class="hljs-number">500</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多次元適応回帰スプライン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MARSモデルはいくつかのパッケージに含まれていますが、最も広範な実装はearthパッケージにあります。</font><font style="vertical-align: inherit;">ダイレクトパスと打ち切りの公称フェーズを使用するMARSモデルは、次のように呼び出すことができます。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; marsFit &lt;- earth(solTrainXtrans, solTrainY)<font></font>
<font></font>
&gt; marsFit<font></font>
   Selected <span class="hljs-number">38</span> <span class="hljs-keyword">of</span> <span class="hljs-number">47</span> terms, and <span class="hljs-number">30</span> <span class="hljs-keyword">of</span> <span class="hljs-number">228</span> predictors
   <span class="hljs-attr">Importance</span>: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ...<font></font>
   Number <span class="hljs-keyword">of</span> terms at each degree <span class="hljs-keyword">of</span> interaction: <span class="hljs-number">1</span> <span class="hljs-number">37</span> (additive model)<font></font>
   GCV <span class="hljs-number">0.3877448</span> RSS <span class="hljs-number">312.877</span> GRSq <span class="hljs-number">0.907529</span> RSq <span class="hljs-number">0.9213739</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内部実装のこのモデルは、GCVメソッドを使用してモデルを選択するため、その構造は、この章で前述したモデルとは多少異なります。</font><font style="vertical-align: inherit;">summaryメソッドは、より広範な出力を生成します。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; summary(marsFit)
   <span class="hljs-attr">Call</span>: earth(x=solTrainXtrans, y=solTrainY)<font></font>
                                                  coefficients<font></font>
   (Intercept)                                    <span class="hljs-number">-3.223749</span>
   FP002                                            <span class="hljs-number">0.517848</span>
   FP003                                           <span class="hljs-number">-0.228759</span>
   FP059                                           <span class="hljs-number">-0.582140</span>
   FP065                                           <span class="hljs-number">-0.273844</span>
   FP075                                            <span class="hljs-number">0.285520</span>
   FP083                                          <span class="hljs-number">-0.629746</span>
   FP085                                          <span class="hljs-number">-0.235622</span>
   FP099                                            <span class="hljs-number">0.325018</span>
   FP111                                          <span class="hljs-number">-0.403920</span>
   FP135                                            <span class="hljs-number">0.394901</span>
   FP142                                            <span class="hljs-number">0.407264</span>
   FP154                                          <span class="hljs-number">-0.620757</span>
   FP172                                          <span class="hljs-number">-0.514016</span>
   FP176                                            <span class="hljs-number">0.308482</span>
   FP188                                            <span class="hljs-number">0.425123</span>
   FP202                                            <span class="hljs-number">0.302688</span>
   FP204                                          <span class="hljs-number">-0.311739</span>
   FP207                                            <span class="hljs-number">0.457080</span>
   h(MolWeight<span class="hljs-number">-5.77508</span>)                           <span class="hljs-number">-1.801853</span>
   h(<span class="hljs-number">5.94516</span>-MolWeight)                             <span class="hljs-number">0.813322</span>
   h(NumNonHAtoms<span class="hljs-number">-2.99573</span>)                        <span class="hljs-number">-3.247622</span>
   h(<span class="hljs-number">2.99573</span>-NumNonHAtoms)                          <span class="hljs-number">2.520305</span>
   h(<span class="hljs-number">2.57858</span>-NumNonHBonds)                        <span class="hljs-number">-0.564690</span>
   h(NumMultBonds<span class="hljs-number">-1.85275</span>)                        <span class="hljs-number">-0.370480</span>
   h(NumRotBonds<span class="hljs-number">-2.19722</span>)                         <span class="hljs-number">-2.753687</span>
   h(<span class="hljs-number">2.19722</span>-NumRotBonds)                          <span class="hljs-number">0.123978</span>
   h(NumAromaticBonds<span class="hljs-number">-2.48491</span>)                    <span class="hljs-number">-1.453716</span>
   h(NumNitrogen<span class="hljs-number">-0.584815</span>)                          <span class="hljs-number">8.239716</span>
   h(<span class="hljs-number">0.584815</span>-NumNitrogen)                        <span class="hljs-number">-1.542868</span>
   h(NumOxygen<span class="hljs-number">-1.38629</span>)                             <span class="hljs-number">3.304643</span>
   h(<span class="hljs-number">1.38629</span>-NumOxygen)                           <span class="hljs-number">-0.620413</span>
   h(NumChlorine<span class="hljs-number">-0.46875</span>)                         <span class="hljs-number">-50.431489</span>
   h(HydrophilicFactor- <span class="hljs-number">-0.816625</span>)                  <span class="hljs-number">0.237565</span>
   h(<span class="hljs-number">-0.816625</span>-HydrophilicFactor)                 <span class="hljs-number">-0.370998</span>
   h(SurfaceArea1<span class="hljs-number">-1.9554</span>)                           <span class="hljs-number">0.149166</span>
   h(SurfaceArea2<span class="hljs-number">-4.66178</span>)                        <span class="hljs-number">-0.169960</span>
   h(<span class="hljs-number">4.66178</span>-SurfaceArea2)                        <span class="hljs-number">-0.157970</span><font></font>
<font></font>
   Selected <span class="hljs-number">38</span> <span class="hljs-keyword">of</span> <span class="hljs-number">47</span> terms, and <span class="hljs-number">30</span> <span class="hljs-keyword">of</span> <span class="hljs-number">228</span> predictors
   <span class="hljs-attr">Importance</span>: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ...<font></font>
   Number <span class="hljs-keyword">of</span> terms at each degree <span class="hljs-keyword">of</span> interaction: <span class="hljs-number">1</span> <span class="hljs-number">37</span> (additive model)<font></font>
   GCV <span class="hljs-number">0.3877448</span> RSS <span class="hljs-number">312.877</span> GRSq <span class="hljs-number">0.907529</span> RSq <span class="hljs-number">0.9213739</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この導出では、h（・）はヒンジ関数です。</font><font style="vertical-align: inherit;">提示された結果では、分子量が5.77508未満の場合、成分h（MolWeight-5.77508）はゼロに等しくなります（図7.3の上部）。</font><font style="vertical-align: inherit;">反射ヒンジ関数の形式はh（5.77508-MolWeight）です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
earthパッケージのplotmo関数を使用して、図1に示すような図を作成できます。</font><font style="vertical-align: inherit;">7.5。</font><font style="vertical-align: inherit;">trainを使用して、外部リサンプリングを使用してモデルを構成できます。</font><font style="vertical-align: inherit;">次のコードは、図1に示す結果を再現します。</font><font style="vertical-align: inherit;">7.4：</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; #  -  <font></font>
&gt; marsGrid &lt;- expand.grid(.degree = <span class="hljs-number">1</span>:<span class="hljs-number">2</span>, .nprune = <span class="hljs-number">2</span>:<span class="hljs-number">38</span>)<font></font>
&gt; #     <font></font>
&gt; set.seed(<span class="hljs-number">100</span>)<font></font>
&gt; marsTuned &lt;- train(solTrainXtrans, solTrainY,<font></font>
+ method = <span class="hljs-string">"earth"</span>,<font></font>
+ #   -  <font></font>
+ tuneGrid = marsGrid,<font></font>
+ trControl = trainControl(method = <span class="hljs-string">"cv"</span>))<font></font>
&gt; marsTuned<font></font>
   <span class="hljs-number">951</span> samples
   <span class="hljs-number">228</span> predictors<font></font>
No pre-processing<font></font>
<span class="hljs-attr">Resampling</span>: Cross-Validation (<span class="hljs-number">10</span>-fold)<font></font>
<font></font>
Summary <span class="hljs-keyword">of</span> sample sizes: <span class="hljs-number">856</span>, <span class="hljs-number">857</span>, <span class="hljs-number">855</span>, <span class="hljs-number">856</span>, <span class="hljs-number">856</span>, <span class="hljs-number">855</span>, ...<font></font>
<font></font>
Resampling results across tuning parameters:<font></font>
<font></font>
    degree nprune RMSE   Rsquared RMSE SD  Rsquared SD<font></font>
    <span class="hljs-number">1</span>      <span class="hljs-number">2</span>      <span class="hljs-number">1.54</span>   <span class="hljs-number">0.438</span>    <span class="hljs-number">0.128</span>    <span class="hljs-number">0.0802</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">3</span>      <span class="hljs-number">1.12</span>   <span class="hljs-number">0.7</span>      <span class="hljs-number">0.0968</span>   <span class="hljs-number">0.0647</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">4</span>      <span class="hljs-number">1.06</span>   <span class="hljs-number">0.73</span>     <span class="hljs-number">0.0849</span>   <span class="hljs-number">0.0594</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">5</span>      <span class="hljs-number">1.02</span>   <span class="hljs-number">0.75</span>     <span class="hljs-number">0.102</span>    <span class="hljs-number">0.0551</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">6</span>      <span class="hljs-number">0.984</span>  <span class="hljs-number">0.768</span>    <span class="hljs-number">0.0733</span>   <span class="hljs-number">0.042</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">7</span>      <span class="hljs-number">0.919</span>  <span class="hljs-number">0.796</span>    <span class="hljs-number">0.0657</span>   <span class="hljs-number">0.0432</span>
    <span class="hljs-number">1</span>      <span class="hljs-number">8</span>      <span class="hljs-number">0.862</span>  <span class="hljs-number">0.821</span>    <span class="hljs-number">0.0418</span>   <span class="hljs-number">0.0237</span><font></font>
    :      :      :      :        :        :<font></font>
    <span class="hljs-number">2</span>      <span class="hljs-number">33</span>     <span class="hljs-number">0.701</span>  <span class="hljs-number">0.883</span>    <span class="hljs-number">0.068</span>    <span class="hljs-number">0.0307</span>
    <span class="hljs-number">2</span>      <span class="hljs-number">34</span>     <span class="hljs-number">0.702</span>  <span class="hljs-number">0.883</span>    <span class="hljs-number">0.0699</span>   <span class="hljs-number">0.0307</span>
    <span class="hljs-number">2</span>      <span class="hljs-number">35</span>     <span class="hljs-number">0.696</span>  <span class="hljs-number">0.885</span>    <span class="hljs-number">0.0746</span>   <span class="hljs-number">0.0315</span>
    <span class="hljs-number">2</span>      <span class="hljs-number">36</span>     <span class="hljs-number">0.687</span>  <span class="hljs-number">0.887</span>    <span class="hljs-number">0.0604</span>   <span class="hljs-number">0.0281</span>
    <span class="hljs-number">2</span>      <span class="hljs-number">37</span>     <span class="hljs-number">0.696</span>  <span class="hljs-number">0.885</span>    <span class="hljs-number">0.0689</span>   <span class="hljs-number">0.0291</span>
    <span class="hljs-number">2</span>      <span class="hljs-number">38</span>     <span class="hljs-number">0.686</span>  <span class="hljs-number">0.887</span>    <span class="hljs-number">0.0626</span>   <span class="hljs-number">0.029</span><font></font>
<font></font>
   RMSE was used to select the optimal model using the smallest value.<font></font>
   The final values used <span class="hljs-keyword">for</span> the model were degree = <span class="hljs-number">1</span> and nprune = <span class="hljs-number">38.</span><font></font>
<font></font>
&gt; head(predict(marsTuned, solTestXtrans))<font></font>
   [<span class="hljs-number">1</span>] <span class="hljs-number">0.3677522</span> <span class="hljs-number">-0.1503220</span> <span class="hljs-number">-0.5051844</span> <span class="hljs-number">0.5398116</span> <span class="hljs-number">-0.4792718</span> <span class="hljs-number">0.7377222</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MARSモデルの各予測子の重要性を評価するために、2つの関数が使用されます。earthパッケージからのevimpと、キャレットパッケージからのvarImp（2番目は最初の呼び出し）：</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; varImp(marsTuned)<font></font>
   earth variable importance<font></font>
<font></font>
      only <span class="hljs-number">20</span> most important variables shown (out <span class="hljs-keyword">of</span> <span class="hljs-number">228</span>)<font></font>
<font></font>
                       Overall<font></font>
   MolWeight            <span class="hljs-number">100.00</span>
   NumNonHAtoms         <span class="hljs-number">89.96</span>
   SurfaceArea2         <span class="hljs-number">89.51</span>
   SurfaceArea1         <span class="hljs-number">57.34</span>
   FP142                <span class="hljs-number">44.31</span>
   FP002                <span class="hljs-number">39.23</span>
   NumMultBond s        <span class="hljs-number">39.23</span>
   FP204                <span class="hljs-number">37.10</span>
   FP172                <span class="hljs-number">34.96</span>
   NumOxygen            <span class="hljs-number">30.70</span>
   NumNitrogen          <span class="hljs-number">29.12</span>
   FP083                <span class="hljs-number">28.21</span>
   NumNonHBonds         <span class="hljs-number">26.58</span>
   FP059                <span class="hljs-number">24.76</span>
   FP135                <span class="hljs-number">23.51</span>
   FP154                <span class="hljs-number">21.20</span>
   FP207                <span class="hljs-number">19.05</span>
   FP202                <span class="hljs-number">17.92</span>
   NumRotBonds          <span class="hljs-number">16.94</span>
   FP085                <span class="hljs-number">16.02</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの結果は、表に示されている結果とは異なり、0〜100の範囲でスケーリングされます。</font><font style="vertical-align: inherit;">7.1（表7.1に示すモデルは、成長と切り捨ての完全なプロセスを通過していませんでした）。</font><font style="vertical-align: inherit;">最初のいくつかの変数に続く変数は、モデルにとってそれほど重要ではないことに注意してください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVM、サポートベクター法</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SVMモデルの実装は、いくつかのR.パッケージに含まれています。ChangおよびLin（ChangおよびLin、2011）は、e1071パッケージのsvm関数を使用して、回帰用にLIBSVMライブラリへのインターフェイスを使用します。</font><font style="vertical-align: inherit;">Karatsogl回帰用のSVMモデルのより完全な実装（Karatzoglou et al。、2004）は、回帰モデルのksvm関数と多数の核関数を含むkernlabパッケージに含まれています。</font><font style="vertical-align: inherit;">デフォルトでは、放射基底関数が使用されます。</font><font style="vertical-align: inherit;">コストと核パラメータの値がわかっている場合、モデルの近似は次のように実行できます。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; svmFit &lt;- ksvm(x = solTrainXtrans, y = solTrainY,<font></font>
+                         kernel =<span class="hljs-string">"rbfdot"</span>, kpar = <span class="hljs-string">"automatic"</span>,<font></font>
+                         C = <span class="hljs-number">1</span>, epsilon = <span class="hljs-number">0.1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
σを推定するために、自動分析が使用されました。</font><font style="vertical-align: inherit;">yは数値ベクトルであるため、関数は明らかに（分類モデルではなく）回帰モデルを近似します。</font><font style="vertical-align: inherit;">多項式（kernel = "polydot"）や線形（kernel = "vanilladot"）などの他のカーネル関数を使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値が不明な場合は、再サンプリングによって推定できます。</font><font style="vertical-align: inherit;">トレインでは、メソッドパラメータの「svmRadial」、「svmLinear」、または「svmPoly」の値により、さまざまなカーネル関数が選択されます。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; svmRTuned &lt;- train(solTrainXtrans, solTrainY,<font></font>
+                               method = <span class="hljs-string">"svmRadial"</span>,<font></font>
+                               preProc = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>),<font></font>
+                               tuneLength = <span class="hljs-number">14</span>,<font></font>
+                               trControl = trainControl(method = <span class="hljs-string">"cv"</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tuneLength引数は14のデフォルト値を使用します</font></font><img src="https://habrastorage.org/webt/tj/ey/rh/tjeyrh-jsrh2bavjcscm784t7d0.png" alt="画像"><br>
<img src="https://habrastorage.org/webt/8a/67/hy/8a67hygcgz4_re1ru2xxpg_a0io.png" alt="画像"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。σのデフォルトの推定は、自動分析によって行われます。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; svmRTuned
   <span class="hljs-number">951</span> samples
   <span class="hljs-number">228</span> predictors<font></font>
<font></font>
   Pre-processing: centered, scaled<font></font>
   <span class="hljs-attr">Resampling</span>: Cross-Validation (<span class="hljs-number">10</span>-fold)<font></font>
<font></font>
   Summary <span class="hljs-keyword">of</span> sample sizes: <span class="hljs-number">855</span>, <span class="hljs-number">858</span>, <span class="hljs-number">856</span>, <span class="hljs-number">855</span>, <span class="hljs-number">855</span>, <span class="hljs-number">856</span>, ...<font></font>
<font></font>
   Resampling results across tuning parameters:<font></font>
<font></font>
       C       RMSE    Rsquared   RMSE SD   Rsquared SD<font></font>
       <span class="hljs-number">0.25</span>    <span class="hljs-number">0.793</span>   <span class="hljs-number">0.87</span>       <span class="hljs-number">0.105</span>     <span class="hljs-number">0.0396</span>
       <span class="hljs-number">0.5</span>     <span class="hljs-number">0.708</span>   <span class="hljs-number">0.889</span>      <span class="hljs-number">0.0936</span>    <span class="hljs-number">0.0345</span>
       <span class="hljs-number">1</span>       <span class="hljs-number">0.664</span>   <span class="hljs-number">0.898</span>      <span class="hljs-number">0.0834</span>    <span class="hljs-number">0.0306</span>
       <span class="hljs-number">2</span>       <span class="hljs-number">0.642</span>   <span class="hljs-number">0.903</span>      <span class="hljs-number">0.0725</span>    <span class="hljs-number">0.0277</span>
       <span class="hljs-number">4</span>       <span class="hljs-number">0.629</span>   <span class="hljs-number">0.906</span>      <span class="hljs-number">0.067</span>     <span class="hljs-number">0.0253</span>
       <span class="hljs-number">8</span>       <span class="hljs-number">0.621</span>   <span class="hljs-number">0.908</span>      <span class="hljs-number">0.0634</span>    <span class="hljs-number">0.0238</span>
       <span class="hljs-number">16</span>      <span class="hljs-number">0.617</span>   <span class="hljs-number">0.909</span>      <span class="hljs-number">0.0602</span>    <span class="hljs-number">0.0232</span>
       <span class="hljs-number">32</span>      <span class="hljs-number">0.613</span>   <span class="hljs-number">0.91</span>       <span class="hljs-number">0.06</span>      <span class="hljs-number">0.0234</span>
       <span class="hljs-number">64</span>      <span class="hljs-number">0.611</span>   <span class="hljs-number">0.911</span>      <span class="hljs-number">0.0586</span>    <span class="hljs-number">0.0231</span>
       <span class="hljs-number">128</span>     <span class="hljs-number">0.609</span>   <span class="hljs-number">0.911</span>      <span class="hljs-number">0.0561</span>    <span class="hljs-number">0.0223</span>
       <span class="hljs-number">256</span>     <span class="hljs-number">0.609</span>   <span class="hljs-number">0.911</span>      <span class="hljs-number">0.056</span>     <span class="hljs-number">0.0224</span>
       <span class="hljs-number">512</span>     <span class="hljs-number">0.61</span>    <span class="hljs-number">0.911</span>      <span class="hljs-number">0.0563</span>    <span class="hljs-number">0.0226</span>
       <span class="hljs-number">1020</span>    <span class="hljs-number">0.613</span>   <span class="hljs-number">0.91</span>       <span class="hljs-number">0.0563</span>    <span class="hljs-number">0.023</span>
       <span class="hljs-number">2050</span>    <span class="hljs-number">0.618</span>   <span class="hljs-number">0.909</span>      <span class="hljs-number">0.0541</span>    <span class="hljs-number">0.023</span><font></font>
<font></font>
   Tuning parameter <span class="hljs-string">'sigma'</span> was held constant at a value <span class="hljs-keyword">of</span> <span class="hljs-number">0.00387</span><font></font>
   RMSE was used to select the optimal model using the smallest value.<font></font>
   The final values used <span class="hljs-keyword">for</span> the model were C = <span class="hljs-number">256</span> and sigma = <span class="hljs-number">0.00387</span>.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
finalModelサブオブジェクトには、ksvm関数によって作成されたモデルが含まれています。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; svmRTuned$finalModel<font></font>
   Support Vector Machine object <span class="hljs-keyword">of</span> <span class="hljs-class"><span class="hljs-keyword">class</span> "<span class="hljs-title">ksvm</span>"

   <span class="hljs-title">SV</span> <span class="hljs-title">type</span>: <span class="hljs-title">eps</span>-<span class="hljs-title">svr</span> (<span class="hljs-title">regression</span>)
       <span class="hljs-title">parameter</span> : <span class="hljs-title">epsilon</span> </span>= <span class="hljs-number">0.1</span> cost C = <span class="hljs-number">256</span><font></font>
<font></font>
   Gaussian Radial Basis kernel <span class="hljs-keyword">function</span>.<font></font>
     Hyperparameter : sigma = <span class="hljs-number">0.00387037424967707</span><font></font>
<font></font>
   <span class="hljs-built_in">Number</span> <span class="hljs-keyword">of</span> Support Vectors : <span class="hljs-number">625</span><font></font>
<font></font>
   Objective <span class="hljs-built_in">Function</span> Value : <span class="hljs-number">-1020.558</span>
   Training error : <span class="hljs-number">0.009163</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
参照ベクトルとして、モデルはトレーニングセットの625データポイントを使用します（つまり、トレーニングセットの66％）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
kernlabパッケージには、rvm関数の回帰用のRVMモデルの実装が含まれています。</font><font style="vertical-align: inherit;">その構文は、ksvmの例で示したものと非常に似ています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KNNメソッド</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
carenパッケージknnregはKNN回帰モデルを近似します。</font><font style="vertical-align: inherit;">関数trainはモデルをKに設定します。</font></font><br>
<br>
<pre><code class="javascript hljs">&gt; #      .<font></font>
&gt; knnDescr &lt;- solTrainXtrans[, -nearZeroVar(solTrainXtrans)]<font></font>
&gt; set.seed(<span class="hljs-number">100</span>)<font></font>
&gt; knnTune &lt;- train(knnDescr,<font></font>
+                           solTrainY,<font></font>
+                           method = <span class="hljs-string">"knn"</span>,<font></font>
+                           #     <font></font>
+                           #   <font></font>
+                           preProc = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>),<font></font>
+                           tuneGrid = data.frame(.k = <span class="hljs-number">1</span>:<span class="hljs-number">20</span>),<font></font>
+                           trControl = trainControl(method = <span class="hljs-string">"cv"</span>))</code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者について：</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Max Kun</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ファイザーグローバルの統計非臨床研究開発部門の責任者です。彼は15年以上にわたって予測モデルを使用しており、R言語のいくつかの特殊パッケージの作成者です。実際の予測モデリングは、データの前処理、データ分割、および</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデル調整の</font><font style="vertical-align: inherit;">基本原則の主要な段階から始まる、予測のすべての側面をカバーしています</font><font style="vertical-align: inherit;">。モデリングのすべての段階は、実際の実例に基づいて検討されてい</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。各章では、R。</font><b><font style="vertical-align: inherit;">ケルジョンソンの</font></b><font style="vertical-align: inherit;">言語で詳細なコードを示しています</font></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-製薬研究の統計および予測モデリングの分野で10年以上働いています。</font><font style="vertical-align: inherit;">予測モデリングを専門とする会社であるArbor Analyticsの共同創設者。</font><font style="vertical-align: inherit;">以前はファイザーグローバルの統計研究開発部門を率いていました。</font><font style="vertical-align: inherit;">彼の科学的研究は、統計的方法論と学習アルゴリズムの応用と開発に専念しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
»本の詳細については</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、出版社のWebサイトを参照してください</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目次</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
» </font><font style="vertical-align: inherit;">
ハブロジテリーの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抜粋</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クーポンの25％割引- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測モデルの適用</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
本の紙のバージョンを支払うと、電子ブックが電子メールで送信されます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja462819/index.html">CISにおける言語教育の欠陥：ポリグロットビュー</a></li>
<li><a href="../ja462821/index.html">まだ存在しないコンピューターを評価する方法</a></li>
<li><a href="../ja462825/index.html">Summer Droid Meetupからのビデオレポート</a></li>
<li><a href="../ja462827/index.html">オラクルの創設者、ラリー・エリソンの生涯と成功</a></li>
<li><a href="../ja462831/index.html">Web 3.0 Waveに乗る</a></li>
<li><a href="../ja462835/index.html">Unityの自動レイアウトとスタイル：UIの新しいパイプラインとツール</a></li>
<li><a href="../ja462837/index.html">ブラックボックステスト</a></li>
<li><a href="../ja462843/index.html">Unityでの8ビットゲームとその正確な再現の制限</a></li>
<li><a href="../ja462845/index.html">あなたの脳のためのマッサージ：ASMRについて話す</a></li>
<li><a href="../ja462847/index.html">2019年8月から10月のHewlett Packard Enterpriseウェビナー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>