<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍⚕️ 👲🏻 👨🏼‍⚕️ 螺旋：高性能PHP / Go框架 👩🏼‍✈️ 🕵🏻 👨🏿‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha 我叫Anton Titov，螺旋侦察兵CTO。今天，我想向您介绍我们的PHP大象。更确切地说，关于开源全栈PHP / Go框架的第二版-Spiral。
 
 Spiral是由我公司开发超过11年的组件完整堆栈框架，可为100个实际项目提供服务。该软件包基于许多开放和专有的库，包括RoadRu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>螺旋：高性能PHP / Go框架</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495224/"><img src="https://habrastorage.org/webt/1_/ku/gu/1_kugualputdvwq2gxujopusshg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
哈Ha </font><font style="vertical-align: inherit;">我叫Anton Titov，螺旋侦察兵CTO。</font><font style="vertical-align: inherit;">今天，我想向您介绍我们的PHP大象。</font><font style="vertical-align: inherit;">更确切地说，关于开源全栈PHP / Go框架的第二版</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Spiral</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spiral是由我公司开发超过11年的组件完整堆栈框架，可为100个实际项目提供服务。</font><font style="vertical-align: inherit;">该软件包基于许多开放和专有的库，包括</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RoadRunner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycle ORM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该框架与大多数PSR建议兼容，支持MVC，运行速度比Laravel / Symfony快5-10倍。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您从未听说过Spiral，并且想知道PHP / Go框架是什么以及第一个版本的发布地，那么欢迎加入。</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于框架</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
螺旋开发始于2008/09年，是针对自由职业者应用程序的便携式内核。 2010年，我们终于成立了一家外包公司，此后一直致力于改善我们的堆栈。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，该框架被转换为一组独立的组件，并由一个公共集成层联合在一起。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一版的唯一公告是于2017年在Reddit上发布的，并向我们表明，从技术上讲，Spiral当时并没有真正击败竞争对手。我们考虑了收到的反馈，更复杂项目的经验，并于2019年5月完成了第二版。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
经过一年的文档编制并在实际项目上运行，我们准备将这一开发成果提交给公众。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与上一代框架的Spiral 2.0以及可能与所有其他现有PHP框架之间的主要区别在于集成的应用程序服务器RoadRunner，以及针对长期执行模型（守护程序模式）进行的体系结构调整。 </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杂种兰特海姆</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该框架的主要概念是用Golang编写的应用服务器和PHP核心之间的共生。</font><font style="vertical-align: inherit;">PHP应用程序代码仅一次加载到内存中-这样，您可以节省大量资源，但会失去运行WordPress的能力。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/88/-o/fw/88-ofwfx3p83cjgqkkwuqmkuxk0.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读有关混合模型的更多信息</font><font style="vertical-align: inherit;">。</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器负责整个基础架构部分：HTTP / FastCGI，与队列代理，GRPC，WebSockets，发布/订阅，缓存，指标等的通信。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，为Spiral编写代码与任何其他框架的代码没有什么不同。</font><font style="vertical-align: inherit;">但是，SOLID原则将必须承担更多责任。</font><font style="vertical-align: inherit;">如果以前以单例形式缓存用户数据仅导致代码检查时非常痛苦，那么现在这样的代码将无法正常工作。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该平台不需要Golang知识。</font><font style="vertical-align: inherit;">但是，学习了第二语言后，您就可以与Golang库建立几乎无缝的集成。</font><font style="vertical-align: inherit;">例如，嵌入全文搜索引擎或编写自己的Kafka驱动程序。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用腿射击要困难一些，因此决定放弃事件和钩子系统，并以显式的形式优先处理调用堆栈。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该框架提供了一组工具，例如IoC闭包，中间件，域层破坏者和不可变服务。</font></font><br>
<br>
<pre><code class="php hljs">$container-&gt;runScope(<font></font>
    [UserContext::class =&gt; $user],<font></font>
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) <span class="hljs-title">use</span> (<span class="hljs-params">$container</span>) </span>{<font></font>
        dump($container-&gt;get(UserContext::class);<font></font>
    }<font></font>
);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管这种方法带来了额外的开销，但是不卸载程序核心，从数据库到数据库的连接以及套接字的能力远远超过了这些限制。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在PHP框架的全栈类中，Spiral主要与基于Swoole的程序集和一些微框架竞争。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nw/a5/tz/nwa5tzv_osg63cq6l2ha2xpbs2c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完整的基准测试可</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处获得</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对我们来说，性能是所选架构的副作用。我们确信，通过适当的配置并用更浅的抽象替换PSR-7，可以将生产率提高50-80％（这已在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubiquity-roadrunner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例中得到了证明</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<blockquote> Swoole. Swoole     RoadRunner,     PHP        ++.       ,     Go.     ,   .<br>
<br>
   RoadRunner   (   ),    ,       Windows.<br>
<br>
   Spiral     Swoole,     !</blockquote><br>
<h4>PSR-*  </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大多数Spiral组件对于您的构建都是可选的，微型构建和完整构建之间的区别仅在于内容</font></font><code>composer.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如有必要，您可以使用接口将标准库替换为替代实现。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
编写框架的HTTP层时要考虑到PSR-7 / 15/17标准，您可以安全地</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://spiral.dev/docs/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改路由器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，消息的实现等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大多数框架库都可以在框架之外使用。</font><font style="vertical-align: inherit;">例如，RoadRunner可以与</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symfony</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laravel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一起</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">很好地工作</font></a><font style="vertical-align: inherit;">，而Cycle ORM将在Yii3中可用。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器组件</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了PHP组件之外，RoadRunner程序集还包含几个用Golang编写的库。</font><font style="vertical-align: inherit;">大多数服务器服务都可以在PHP中进行管理。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特别是，存在一个队列组件，该组件支持与代理AMQP，Amazon SQS和Beanstalk一起使用。</font><font style="vertical-align: inherit;">该库可以正确停止，重新连接并将任意数量的传入队列分配给多个工作程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开箱即用的是对Prometheus和运行状况检查点的监视，热重启和内存限制。</font><font style="vertical-align: inherit;">对于分布式项目，有一个GRPC服务器和客户端。</font><font style="vertical-align: inherit;">
有Web套接字，可以从PHP应用程序授权它们，并连接到pub-sub总线（在内存中或Redis上）。</font><font style="vertical-align: inherit;">键值驱动程序当前正在测试中。</font></font><br>
<br>
<code>INFO[0154] 10.42.5.55:51990 Ok {2.28ms} /images.Service/GetFiles<br>
INFO[0155] 10.42.3.95:50926 Ok {11.3ms} /images.Service/GetFiles<br>
INFO[0156] 10.42.5.55:52068 Ok {3.60ms} /images.Service/GetFiles<br>
INFO[0158] 10.42.5.55:52612 Ok {2.30ms} /images.Service/GetFiles<br>
INFO[0166] 10.42.5.55:52892 Ok {2.23ms} /images.Service/GetFiles<br>
INFO[0167] 10.42.3.95:49938 Ok {2.37ms} /images.Service/GetFiles<br>
INFO[0169] 10.42.5.55:52988 Ok {2.22ms} /images.Service/GetFiles</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可移植性</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该框架不需要PHP-FPM和NGINX。</font><font style="vertical-align: inherit;">并且所有Golang组件都具有无需外部依赖即可工作的驱动程序。</font><font style="vertical-align: inherit;">因此，您可以使用队列，WebSocket，指标，而无需安装外部代理或程序。</font></font><br>
<br>
<pre><code class="plaintext hljs">./spiral serve -v -d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您在后台编写大型分布式应用程序或发送“写信给我们”的小型网站，螺旋式技术都没关系。</font><font style="vertical-align: inherit;">无论如何，您都可以使用相同的工具来统一本地和生产环境的行为。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于HTTP层是可选的，因此您可以编写使用队列程序包在后台处理数据的控制台应用程序。</font><font style="vertical-align: inherit;">我们使用此类程序进行数据迁移。</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">循环ORM</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作为开箱即用的ORM，请输入</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycle ORM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该Data Mapper引擎的功能与Doctrine非常相似，但在体系结构上却非常不同。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Doctrine一样，Cycle可以与纯领域模型一起使用，独立生成迁移并安排外键。</font><font style="vertical-align: inherit;">映射方案可以用代码描述或从注释中收集。</font><font style="vertical-align: inherit;">但是使用经典的查询生成器代替DQL。</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-comment">//    </span>
<span class="hljs-comment">//        </span><font></font>
$users = $orm-&gt;getRepository(User::class)<font></font>
    -&gt;select()<font></font>
    -&gt;where(<span class="hljs-string">'active'</span>, <span class="hljs-literal">true</span>)<font></font>
    -&gt;load(<span class="hljs-string">'orders'</span>, [
        <span class="hljs-string">'method'</span> =&gt; Select::SINGLE_QUERY, <span class="hljs-comment">// force LEFT JOIN</span>
        <span class="hljs-string">'load'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$query</span>) </span>{<font></font>
            $query-&gt;where(<span class="hljs-string">'paid'</span>, <span class="hljs-literal">true</span>)-&gt;orderBy(<span class="hljs-string">'timeCreated'</span>, <span class="hljs-string">'DESC'</span>);<font></font>
        }<font></font>
    ])<font></font>
    -&gt;fetchAll();<font></font>
<font></font>
$transaction = <span class="hljs-keyword">new</span> Transaction($orm);<font></font>
<font></font>
<span class="hljs-keyword">foreach</span>($users <span class="hljs-keyword">as</span> $user) {<font></font>
    $transaction-&gt;persist($user);<font></font>
}<font></font>
<font></font>
$transaction-&gt;run();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在选择中，</font><font style="vertical-align: inherit;">
循环的运行</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">速度比</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Doctrine </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">要快</font></a><font style="vertical-align: inherit;">，但在持久性方面，</font><font style="vertical-align: inherit;">运行</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">速度要</font></a><font style="vertical-align: inherit;">慢。</font><font style="vertical-align: inherit;">该引擎通过几种加载策略，代理类，嵌入支持复杂的查询，并提供可移植的事务而不是全局EntityManager。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关更多详细信息，请参见</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Russia 2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ORM的主要“功能”是在运行时更改数据和链接的映射的能力。</font><font style="vertical-align: inherit;">简而言之，您可以允许用户独立定义数据模式（DBAL支持数据库模式的自省和声明）。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读有关比较“周期”，“口才”和“教义2”的更多</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">信息</font></a><font style="vertical-align: inherit;">。</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快速成型</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spiral包括多种工具，可以加快和简化开发。</font><font style="vertical-align: inherit;">主要包括自动依赖注入，自动配置和使用静态分析的自动模型搜索。</font><font style="vertical-align: inherit;">控制台命令使您可以生成大多数必需的类，并且可以轻松自定义。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了集成到IDE中，有一个快速的原型制作系统。</font><font style="vertical-align: inherit;">使用神奇的PrototypeTrait，您可以快速访问IDE中的提示。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/33/9u/_a/339u_ac_8gelzkarpyljtgtisck.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该特征会自动找到ORM存储库，标准组件，并可以通过注释为您的服务建立索引。</font><font style="vertical-align: inherit;">在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后台</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用了神奇的</font><b><font style="vertical-align: inherit;">__get</font></b><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">，可以确保您快速进行代码检查。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只需运行命令php app.php prototype：inject -r，原型系统将自动删除所有魔术：</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Controller</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Repository</span>\<span class="hljs-title">UserRepository</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Spiral</span>\<span class="hljs-title">Views</span>\<span class="hljs-title">ViewsInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomeController</span>
</span>{
    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> ViewsInterface */</span>
    <span class="hljs-keyword">private</span> $views;<font></font>
<font></font>
    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> UserRepository */</span>
    <span class="hljs-keyword">private</span> $users;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> ViewsInterface $views
     * <span class="hljs-doctag">@param</span> UserRepository $users
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">ViewsInterface $views, UserRepository $users</span>)
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;users = $users;
        <span class="hljs-keyword">$this</span>-&gt;views = $views;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">index</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;views-&gt;render(<span class="hljs-string">'profile'</span>, [
            <span class="hljs-string">'user'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;users-&gt;findByName(<span class="hljs-string">'Antony'</span>)<font></font>
        ]);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在后台，使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP-Parser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于我们的大多数应用程序都是针对B2B领域开发的，因此必须认真考虑安全问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
验证复杂请求（请求过滤器），CSRF和加密（基于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">defuse / php-encryption</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的组件</font><font style="vertical-align: inherit;">将向您提供</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用cookie和会话支持服务器端数据的防篡改和签名。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该框架提供了</font><font style="vertical-align: inherit;">一个基于令牌的过期</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">身份验证组件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">作为驱动程序，您可以使用会话，数据库甚至纯JWT。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或同时所有类型的令牌（如果要求“紧急连接SAML / SSO / 2FA！”）突然发给您 </font><font style="vertical-align: inherit;">:(</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
访问授权通过</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RBAC组件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行，并进行</font><font style="vertical-align: inherit;">了一些改进，以允许在DAC和ABAC模式下运行。</font><font style="vertical-align: inherit;">支持许多角色，用于保护控制器方法的注释以及规则系统。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
域层的工作是通过中间</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拦截器层进行的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，您可以在一组控制器上创建特殊限制，预先验证数据并包装错误。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板引擎</font></font></h4><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果只喜欢Twig，则可以滚动浏览此部分，只需安装扩展程序并使用熟悉的工具即可。</font><font style="vertical-align: inherit;">:)</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开箱即用的是Stemper模板引擎，或者说是一个用于创建自己的DSL标记的库。特别是，有一个完整的词法分析器，几种语法，一个解析器和对AST的访问（类似于Nikita的PHP解析器）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以解析几个嵌套的语法。因此，例如，您可以在同一模板中使用Laravel Blade指令和您自己的DSL（以HTML标签的形式）标记。事实证明，服务器端类似Web组件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们使用此组件使用简单的原语和规则来描述复杂的接口。</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">extends:admin.layout.tabs</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Information"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">use:bundle</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"admin/bundle"</span>/&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">ui:tab</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"info"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Information"</span>&gt;</span><font></font>
  User, {{ $user-&gt;name }}<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">ui:tab</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;<span class="hljs-name">ui:tab</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Settings"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">grid:table</span> <span class="hljs-attr">for</span>=<span class="hljs-string">{{</span> $<span class="hljs-attr">user-</span>&gt;</span>settings }}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">grid:cell</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Key"</span>&gt;</span>{{ $key }}<span class="hljs-tag">&lt;/<span class="hljs-name">grid:cell</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">grid:cell</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Value"</span>&gt;</span>{{ $value }}<span class="hljs-tag">&lt;/<span class="hljs-name">grid:cell</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">grid:table</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ui:tab</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它支持带有上下文支持的自动转义（例如，JS块内的PHP输出自动将数据转换为JSON），用于处理错误的源映射。</font><font style="vertical-align: inherit;">模板被编译成优化的PHP代码，然后直接从应用程序内存中给出。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stemper可以完全使用文档的DOM（如果使用专用工具，则速度会较慢）。</font></font></blockquote><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框架开发</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，在开发此工具的十多年中，我们犯了许多错误。其中一些已针对第二个版本的发布进行了更正，而其他部分则需要对某些组件的概念进行修订。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们也不会否认某些事情需要文件。有些问题可能是我们第一次听到。尽管文档试图涵盖最多的组件，但它仍可能在某些地方下垂。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们愿意接受批评和建议，因为我们自己一直在积极使用此工具。我们的团队和社区正在逐步整理出大量积压的改进。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据最新的RFC，需要大量工作来改善和加快周期，以及重写请求过滤器。</font><font style="vertical-align: inherit;">正在开发中的是用于工作和模拟键值数据库的组件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们只是没有设法翻译第一版中的许多内容。</font><font style="vertical-align: inherit;">计划是还原ODM软件包，管理面板，编写良好的分析器等。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区与链接</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以登录到我们的小型</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discord</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电报频道</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框架网站</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github框架</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github标准应用</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有代码均根据MIT许可分发，并且对商业用途没有任何限制。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
谢谢您的关注。</font><font style="vertical-align: inherit;">希望我们的工具在您的项目中派上用场！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN495210/index.html">Runet的欺诈者如何对冠状病毒做出反应</a></li>
<li><a href="../zh-CN495212/index.html">Quarkus中的本机编译-为什么重要</a></li>
<li><a href="../zh-CN495214/index.html">在没有人的办公室中：在远程站点上开发游戏</a></li>
<li><a href="../zh-CN495216/index.html">学习，协商，远程咨询-第2部分：Vinteo Server-3个月的免费视频会议</a></li>
<li><a href="../zh-CN495220/index.html">太阳系形成后不久便获得了当前的配置</a></li>
<li><a href="../zh-CN495226/index.html">在大多数公司网络中，可能存在黑客和相关漏洞的痕迹</a></li>
<li><a href="../zh-CN495228/index.html">WebStorm 2020.1：界面改进，Vuex支持以及保存文件时启动Prettier</a></li>
<li><a href="../zh-CN495230/index.html">面试技巧“ MoSt”</a></li>
<li><a href="../zh-CN495232/index.html">在RuCode节的框架下，4月4-5日将是在线强化课程的选择</a></li>
<li><a href="../zh-CN495234/index.html">具有BigQuery SQL的Google Cloud Platform上的OpenStreetMap公共数据集。OSM层分类器</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>