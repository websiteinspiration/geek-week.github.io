<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🏭 👃🏽 🙌🏻 Dominando o desenvolvimento por meio de testes no Android usando testes de interface do usuário 👨‍💻 🤜🏼 ⛹🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Olá a todos. Antecipando o lançamento de um novo conjunto de cursos básicos e avançados sobre o desenvolvimento do Android, preparamos uma tradução de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Dominando o desenvolvimento por meio de testes no Android usando testes de interface do usuário</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/492712/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olá a todos. </font><font style="vertical-align: inherit;">Antecipando o lançamento de um novo conjunto de </font><font style="vertical-align: inherit;">cursos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">básicos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avançados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre o desenvolvimento do Android, preparamos uma tradução de material interessante.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/0i/ef/lj/0iefljfwnqnrpvgj9hizrlqeatg.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante o último ano do trabalho da equipe de desenvolvimento do Android no Buffer, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conversamos muito sobre a limpeza do nosso projeto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e sobre a melhoria de sua estabilidade. </font><font style="vertical-align: inherit;">Um dos fatores foi a introdução () de testes, que, como já descobrimos, nos ajudam a evitar regressões em nosso código e nos dão mais confiança nos recursos que fornecemos. </font><font style="vertical-align: inherit;">E agora, quando lançamos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">novos produtos no Buffer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , queremos garantir que a mesma abordagem seja aplicada quando se trata deles - apenas para que não fiquemos na mesma situação de antes.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fundo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao escrever testes de unidade para aplicativos Buffer, sempre aderimos à prática de desenvolvimento por meio de testes (Test-Driven-Development - doravante TDD). </font><font style="vertical-align: inherit;">Existem muitos recursos sobre o que é TDD, sobre suas vantagens e de onde eles vêm, mas não vamos nos concentrar neste tópico, pois há muita informação na Internet. </font><font style="vertical-align: inherit;">Em um nível alto, eu pessoalmente observo alguns deles:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tempo de desenvolvimento reduzido</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Código mais simples, mais limpo e mais sustentável</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Código mais confiável e com mais confiança em nosso trabalho.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maior cobertura de teste (isso parece óbvio)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas até recentemente, só seguíamos os princípios do TDD apenas na forma de testes de unidade para nossas implementações que não eram baseadas na interface do usuário ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c8/df/_w/c8df_wzud2rosic5vw82xx1axyg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
eu sei, eu sei ... sempre tínhamos o hábito de escrever testes de interface do usuário depois que o que foi implementado era concluído - e isso não faz sentido. Monitoramos o TDD para o back-end para que o código que escrevemos atendesse aos requisitos que os testes definem, mas quando se trata de testes de interface do usuário, escrevemos testes que satisfazem a implementação de um recurso específico. Como você pode ver, isso é um pouco controverso e, de certa forma, é por isso que o TDD é usado em primeiro lugar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, aqui quero considerar por que isso é assim e como estamos experimentando mudanças. Mas por que prestamos atenção a isso em primeiro lugar?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sempre foi difícil trabalhar com atividades existentes em nosso aplicativo devido à forma como elas são gravadas. </font><font style="vertical-align: inherit;">Esta não é uma desculpa completa, mas suas muitas dependências, responsabilidades e laços estreitos os tornam extremamente difíceis de testar. </font><font style="vertical-align: inherit;">Para as novas atividades que adicionamos, por hábito, eu sempre escrevi testes de interface do usuário após a implementação - além do hábito, não havia outro motivo para isso. </font><font style="vertical-align: inherit;">No entanto, ao criar nosso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">código de modelo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pronto para novos projetos, pensei em uma mudança. </font><font style="vertical-align: inherit;">E você ficará feliz em saber que esse hábito foi quebrado, e agora estamos trabalhando juntos, explorando o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font><font style="vertical-align: inherit;">testes de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><b><font style="vertical-align: inherit;">usuário</font></b></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiros passos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que vamos explorar aqui é um exemplo bastante simples, para que o conceito seja mais fácil de seguir e entender - espero que isso seja suficiente para ver algumas das vantagens dessa abordagem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos começar criando uma atividade básica. Precisamos fazer isso para que possamos executar nosso teste de interface do usuário - imagine que essa configuração seja a base da nossa implementação, e não a própria implementação. Veja como é nossa atividade básica:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginActivity</span>: <span class="hljs-title">AppCompatActivity</span>(), <span class="hljs-title">LoginContract</span>.<span class="hljs-title">View</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@Inject</span> lateinit <span class="hljs-keyword">var</span> loginPresenter: LoginContract.<span class="hljs-function">Presenter

    override fun <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: Bundle?)</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<font></font>
        setContentView(R.layout.activity_login)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">setPresenter</span><span class="hljs-params">(presenter: LoginContract.Presenter)</span> </span>{<font></font>
        loginPresenter = presenter<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showServerErrorMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showGeneralErrorMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showProgress</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideProgress</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showInvalidEmailMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideInvalidEmailMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">showInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function">override fun <span class="hljs-title">hideInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
        TODO(<span class="hljs-string">"not implemented"</span>)<font></font>
    }<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode perceber que essa atividade não faz nada além da configuração inicial, necessária para a atividade. No método onCreate (), simplesmente configuramos um link para o layout, também temos um link para nossa interface View, que é implementada usando a atividade, mas elas ainda não têm implementações. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma das coisas mais comuns que encontramos nos testes do Espresso são as visualizações e cadeias de referência por IDs de recursos encontrados em nosso aplicativo. Nesse sentido, precisamos novamente fornecer um arquivo de layout para uso em nossa atividade. Isso se deve ao fato de que: a) nossa atividade precisa de um arquivo de layout para exibir o layout durante os testes eb) precisamos de uma visualização de ID para links em nossos testes. Vamos seguir em frente e criar um layout muito simples para nossa atividade de login:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">EditText</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/input_email"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">EditText</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/input_password"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/button_login"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui você pode ver que não estávamos preocupados com nenhum estilo ou posição, lembre-se - enquanto criamos a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e não a implementação. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E para a última parte da configuração, vamos definir as linhas que serão usadas neste exercício. </font><font style="vertical-align: inherit;">Novamente, precisaremos fazer referência a eles em testes - até você adicioná-los ao seu layout XML ou classe de atividade, basta defini-los no arquivo </font></font><code>strings.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="java hljs">&lt;string name=<span class="hljs-string">"error_message_invalid_email”&gt;…&lt;/string&gt;
&lt;string name="</span>error_message_invalid_password”&gt;…&lt;/string&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode perceber que, nessa configuração, escrevemos o mínimo possível, mas fornecemos detalhes suficientes sobre nossa atividade e seu layout para escrever testes para ela. </font><font style="vertical-align: inherit;">Atualmente, nossa atividade não funciona, mas é aberta e possui uma visão que pode ser referenciada. </font><font style="vertical-align: inherit;">Agora que temos o mínimo necessário para trabalhar, vamos continuar e adicionar alguns testes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando testes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, temos três situações que devemos implementar, por isso vamos escrever alguns testes para elas.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando um usuário digita um endereço de email inválido no campo de entrada de email, precisamos exibir uma mensagem de erro. </font><font style="vertical-align: inherit;">Portanto, vamos escrever um teste que verifique se essa mensagem de erro é exibida.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando o usuário começa a inserir dados no campo de entrada de e-mail novamente, a mensagem de erro acima deve desaparecer - portanto, vamos escrever um teste para isso.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente, quando a API retorna uma mensagem de erro, ela deve ser exibida em uma caixa de diálogo de aviso - portanto, adicionaremos um teste para isso.</font></font></li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">invalidEmailErrorHidesWhenUserTypes</span><span class="hljs-params">()</span> </span>{<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withId(R.id.input_email))<font></font>
            .perform(typeText(<span class="hljs-string">"j"</span>))<font></font>
<font></font>
    onView(withText(R.string.error_message_invalid_email))<font></font>
            .check(doesNotExist())<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">invalidPasswordErrorDisplayed</span><span class="hljs-params">()</span> </span>{<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withText(R.string.error_message_invalid_password))<font></font>
            .check(matches(isDisplayed()))<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">@Test</span>
<span class="hljs-function">fun <span class="hljs-title">serverErrorMessageDisplays</span><span class="hljs-params">()</span> </span>{<font></font>
    val response = ConnectResponseFactory.makeConnectResponseForError()<font></font>
    stubConnectRepositorySignIn(Single.just(response))<font></font>
    activity.launchActivity(<span class="hljs-keyword">null</span>)<font></font>
<font></font>
    onView(withId(R.id.input_email))<font></font>
            .perform(typeText(<span class="hljs-string">"joe@example.com"</span>))<font></font>
<font></font>
    onView(withId(R.id.input_password))<font></font>
            .perform(typeText(DataFactory.randomUuid()))<font></font>
<font></font>
    onView(withId(R.id.button_login))<font></font>
            .perform(click())<font></font>
<font></font>
    onView(withText(response.message))<font></font>
            .check(matches(isDisplayed()))<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, agora temos testes escritos - vamos continuar e executá-los. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2x/ac/bv/2xacbvdf2rumlv9asggjp9mwsp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E não é de surpreender que eles tenham falhado - isso é porque ainda não temos uma implementação, portanto isso deve ser esperado.Em qualquer caso, devemos ficar felizes em ver o vermelho nos testes agora mesmo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, agora precisamos adicionar implementações para nossa atividade até que os testes passem. Enquanto escrevemos testes focados que testam apenas um conceito (ou pelo menos deveria ser!), Podemos adicionar implementações uma por uma e também assistir nossos testes ficarem verdes um após o outro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, vamos olhar para um dos testes com falha, vamos começar com o teste </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">invalidPasswordErrorDisplayed ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sabemos algumas coisas:</font></font><br>
<br>
<ul>
<li>     ,    ,       ,          ,       :</li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> fun <span class="hljs-title">setupLoginButtonClickListener</span><span class="hljs-params">()</span> </span>{<font></font>
    button_login.setOnClickListener {<font></font>
        loginPresenter.performSignIn(input_email.text.toString(),<font></font>
                input_password.text.toString()) }<font></font>
}</code></pre><br>
<ul>
<li>       ,          .    TextInputLayout,             ,    :</li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function">override fun <span class="hljs-title">showInvalidPasswordMessage</span><span class="hljs-params">()</span> </span>{<font></font>
    layout_input_password.error = getString(R.string.error_message_invalid_password)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora que adicionamos a lógica para essa situação, vamos continuar e executar nossos testes novamente! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/4-/et/jq4-etd3rfq9tddsy4x0lusrti0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ótimo, parece que o cheque </font></font><code>invalidPassworrdErrorDisplays()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foi bem-sucedido. Mas ainda não terminamos, ainda temos dois testes que não foram aprovados para as partes da nossa função de login que devemos implementar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, consideraremos o teste </font></font><code>serverErrorMessageDisplays()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso é bastante simples, sabemos que quando a API retorna uma resposta de erro (e não um erro geral da nossa biblioteca de rede), o aplicativo deve exibir uma mensagem de erro para o usuário em uma caixa de diálogo de aviso. Para fazer isso, basta criar uma instância da caixa de diálogo usando a mensagem de erro do servidor no texto da caixa de diálogo:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function">override fun <span class="hljs-title">showServerErrorMessage</span><span class="hljs-params">(message: String)</span> </span>{<font></font>
    DialogFactory.createSimpleInfoDialog(<span class="hljs-keyword">this</span>, R.string.error_message_login_title, message, <font></font>
            R.string.error_message_login_ok).show()<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos continuar e executar nossos testes novamente: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/td/le/m2/tdlem2qq8vgtq9wcggplu-dra_0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hurra! </font><font style="vertical-align: inherit;">Estamos avançando, agora temos apenas um teste, este é um teste </font></font><code>invalidEmailErrorHidesWhenUserTypes()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Novamente, este é um caso simples, mas vamos dar uma olhada:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando o usuário clica no botão de login e o endereço de e-mail está ausente ou incorreto, mostramos ao usuário uma mensagem de erro. </font><font style="vertical-align: inherit;">Já implementamos isso, apenas descartei por simplicidade</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, quando o usuário começa a inserir dados no campo novamente, a mensagem de erro deve ser removida da exibição. </font><font style="vertical-align: inherit;">Para fazer isso, precisamos ouvir quando o conteúdo do texto do campo de entrada é alterado:</font></font></li>
</ul><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> fun <span class="hljs-title">setupOnEmailTextChangedListener</span><span class="hljs-params">()</span> </span>{<font></font>
    input_email.addTextChangedListener(object : TextWatcher {<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">afterTextChanged</span><span class="hljs-params">(s: Editable)</span> </span>{}<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">beforeTextChanged</span><span class="hljs-params">(s: CharSequence, start: Int,
                                       count: Int, after: Int)</span> </span>{<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function">override fun <span class="hljs-title">onTextChanged</span><span class="hljs-params">(s: CharSequence, start: Int,
                                   before: Int, count: Int)</span> </span>{<font></font>
            loginPresenter.handleEmailTextChanged(s)<font></font>
        }<font></font>
    })<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora isso deve ser suficiente para garantir que nossa mensagem de erro seja oculta ao alterar o conteúdo do campo de entrada. </font><font style="vertical-align: inherit;">Mas temos testes para confirmar nossas alterações: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/du/ni/aa/duniaa83g3b84ennz4ljp03uez8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ótimo! </font><font style="vertical-align: inherit;">Nossos requisitos de implementação são atendidos à medida que passamos nos testes - é ótimo ver a luz verde</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusão</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É importante notar que o exemplo ao qual aplicamos TDD é extremamente primitivo. Imagine que estamos desenvolvendo uma tela complexa, como um feed de conteúdo, na qual você pode executar várias ações com elementos de feed (por exemplo, como no aplicativo Buffer para Android) - nesses casos, usaremos muitas funções diferentes que devem ser implementadas na atividade especificada / fragmento. São situações em que o TDD nos testes de interface do usuário será revelado ainda mais, porque o que pode levar ao fato de escrevermos código muito complexo para essas funções pode ser reduzido a implementações que satisfazem os testes que escrevemos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para resumir, compartilharei alguns pontos aprendidos com minha experiência:</font></font><br>
<br>
<ul>
<li>  ,   ,  TDD  .   ,        .   ,  Espresso     (/,     ),         .       activity,  ,      ,        .                .</li>
<li>  ,   ,     ,   , ,  ,   ,       .  ,        , ,      ,  ,      ( ,      !). -         .           , , ,  - .</li>
<li> ,   Ui-              ,   ,          . ,   , ,   ,       ,      ,    .</li>
<li> ,      .       ,        —      ,      ,        ,     - .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parece mais natural. </font><font style="vertical-align: inherit;">Devido ao fato de o TDD já ser usado para testes de unidade, você se sente um pouco atrasado ao escrever testes de unidade, seguidos de implementações, seguidos de testes de interface do usuário. </font><font style="vertical-align: inherit;">Você se sentirá mais natural dando um passo completo com o TDD, e não na metade.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você já está usando o TDD ao escrever testes de interface do usuário e está fazendo algo semelhante ou completamente diferente? </font><font style="vertical-align: inherit;">Ou você quer saber um pouco mais e fazer algumas perguntas? </font><font style="vertical-align: inherit;">Sinta-se livre para comentar abaixo ou twittar-nos em </font></font><code>@bufferdevs</code> <br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso é tudo. </font><font style="vertical-align: inherit;">Estamos esperando por você nos cursos:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançado</font></font></a></li>
</ul></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492702/index.html">Tradução automática. Da guerra fria ao presente</a></li>
<li><a href="../pt492704/index.html">Aumentar a eficácia da sobrevivência do implante em 5-7 vezes - como isso é possível?</a></li>
<li><a href="../pt492706/index.html">Arquivos da memória: como o cérebro codifica e reproduz memórias</a></li>
<li><a href="../pt492708/index.html">Internet via satélite global - há novidades em campo?</a></li>
<li><a href="../pt492710/index.html">Caminho espinhoso do candidato através de vários sistemas de GRH</a></li>
<li><a href="../pt492714/index.html">Trabalho eficaz em casa: geral e pessoal</a></li>
<li><a href="../pt492718/index.html">Segurança através da restrição do usuário ou como criar uma vulnerabilidade</a></li>
<li><a href="../pt492720/index.html">diskussion: serviço de arquivo do projeto</a></li>
<li><a href="../pt492724/index.html">Björn Straustrup responde às 5 principais perguntas sobre C ++ com estouro de pilha</a></li>
<li><a href="../pt492726/index.html">OS Sivelkiriya: processo de desenvolvimento de software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>