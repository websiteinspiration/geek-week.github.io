<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî∞ üéÇ ‚ùï Neural network language models as a multi-purpose medical AI ü•î ü•Ç üëõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neural network language models are large neural networks that are trained to predict the next word (or part of a word) in the text, taking into accoun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Neural network language models as a multi-purpose medical AI</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506042/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neural network language models are large neural networks that are trained to predict the next word (or part of a word) in the text, taking into account the previous context. Despite the apparent simplicity of the problem, it turned out that such a statement of the problem leads to the emergence of a very multifunctional neural network. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some researchers even suggested that language models could be the way to AGI - a strong artificial intelligence of the human level. This assumption is based on the fact that the very task of predicting the next word is AI-complete (requiring thinking) at the human level. In this article I will give some examples of what can be done with a language model trained on medical data.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The idea that language models can learn to perform a variety of tasks has existed for a long time, but until very recently, they were rarely taken seriously. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The situation has changed with the advent of large computing power. OpenAI‚Äôs well-known GPT neural models can perform machine translation, answer questions and other tasks without a specialized training set, while the recently released huge GPT-3 model [1], containing 170 billion parameters, can ‚Äúguess‚Äù about several examples that they want from her and begin to solve the necessary problem (although, as the authors note, this does not work with all tasks and not in all cases).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In practice, such huge models are still difficult to use due to limited resources; therefore, in most tasks, traditional approaches continue to dominate. However, there are areas where their application can now bring useful results. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One such area is medicine. There are relatively few open training data sets in this area because of the high costs of creating and annotating them, as well as because of problems with protecting personal data.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article I will give some examples of what a language model can do in the medical field. To study this issue, we trained a rather large language model based on a biomedical literature data set consisting of all PubMed annotations + 2 million free full-text articles + discussions on medical forums on the Internet. Our model has 800 million parameters, which is much smaller than the OpenAI GPT-3, but comparable in size to the average GPT-2.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since this was done for research purposes, for the experiments we used a model working at the symbol level, that is, it receives an input sequence of letters that is not divided into words and predicts the next symbol. </font><font style="vertical-align: inherit;">With this approach, from an ‚Äúabsolute zero‚Äù understanding of the text is much more difficult, since you first need to understand that there are words, that words denote concepts, which in turn are interconnected. </font><font style="vertical-align: inherit;">Can such a model learn some serious laws in the field of medicine?</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text Generation Samples</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, we found that a model can generate coherent fragments of text by describing fairly reasonable experiments. Here are two examples: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. The present study was designed to evaluate the effect of a single intravenous injection of a single dose of recombinant human erythropoietin (rhEPO) on the serum levels of the pro-inflammatory cytokines IL-1, IL-6, IL -8, IL-10, IL-12p40, and TNF-Œ± in patients with acute and chronic inflammatory arthritis. The study included 10 patients with rheumatoid arthritis (RA) and 10 healthy controls.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. The present study was designed to evaluate the effect of the anti-inflammatory drug cyclosporine A (CsA) on the proliferation of human primary keratinocytes and to explore the possible mechanisms of the anti-inflammatory effect of CsA on the proliferation of keratinocytes. The experiments were performed in the presence of CsA (10 mM) and the combination of CsA and prednisolone (10 mM).</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
(Translation into Russian:</font></font><br>
<br>
<i>1.                (rhEPO)      IL-1, IL-6, IL-8, IL-10., IL-12p40  TNF-Œ±        .     10     ()  10  .<br>
<br>
2.            (CsA)             CsA   .     CsA (10 )   CsA   (10 ).)<br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that the generated text is completely original and yet reasonable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, we searched for annotations that are most similar to the </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 closest real example found </font><font style="vertical-align: inherit;">above in PubMed </font><font style="vertical-align: inherit;">: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cyclosporin A (CsA) has been shown to inhibit, in vitro, the proliferation of cultured normal and neoplastic keratinocytes and to exert also in vivo an antiproliferative effect on keratinocytes of normal human skin xenografted onto nude mice. To gain further insight into the effects of CsA on human skin we investigated the immunohistochemical expression of several epidermal proliferation- and differentiation-associated antigens in the same model</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(It was shown that cyclosporin A (CsA) inhibits in vitro proliferation of cultured normal and neoplastic keratinocytes and also has an in vivo antiproliferative effect on keratinocytes of normal human skin, xenotransplanted on nude mice. To obtain a more complete picture of the effect of CsA on human skin, we studied immunohistochemical expression of several antigens associated with the proliferation and differentiation of the epidermis in the same model) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, the model does not just copy this text from its training set. </font><font style="vertical-align: inherit;">Nevertheless, the text makes sense, since it seems that the model ‚Äúknows‚Äù that cyclosporin A has some effect on the proliferation of keratinocytes, and therefore it and its mechanisms can be studied.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiple Choice Answers</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we presented our model with a test set of 50 questions with multiple choice answers. Our first test kit was based on questions about clinical laboratory methods. Examples of questions (translated from English): </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What test can be used for rheumatoid arthritis? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and. anti-CCP antibodies </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
b. monoamine oxidase </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c. Western blotting </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e. Folin-Wu method </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e. serum glucose </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What diagnostic marker can be used to detect Crohn's disease? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and. calprotectin in feces </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
b. anti-CCP antibodies </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c. Folina-Wu method </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e. C-reactive protein </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d interleukin-1 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
adrenaline is ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
a. adrenergic receptor agonist </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
b. antihistamine</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
with. </font><font style="vertical-align: inherit;">anti-inflammatory agent </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e. tyrosine kinase inhibitor</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Random answers selected in this test give 26% correct answers, while our model was 75% accurate. </font><font style="vertical-align: inherit;">The model apparently learned something about laboratory methods.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is relationship extraction a side effect of a drug or treatment?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skeptics may notice that the answers to the above questions only mean that the model has learned that some words are found together more often than others. Therefore, let us consider a problem that cannot be solved in this way. The essence of the problem is knowing the drug to determine what diseases it treats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on the joint occurrence of words, they do it poorly. For example, a similarity search based on word2vec returns aspirin as a treatment for gastritis, because aspirin is often mentioned along with gastritis. Can language models solve this problem?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We found that the phrase ‚Äúgastritis is caused by aspirin‚Äù is 10 times more likely than ‚Äúgastritis is treated with aspirin,‚Äù which indicates that the model has learned real relationships and can differentiate side effects from treated diseases. In our test, consisting of 500 pairs of "disease / pair of drugs", the accuracy of determining the ratio was 75%. For comparison, word2vec similarity was only at a random level of 52%.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The picky reader may notice that this is again a variant of the joint occurrence of words, not just single words, but trigrams. </font><font style="vertical-align: inherit;">However, just searching for the given trigrams in the training set gives an accuracy of only 58%, for many drug / disease pairs these are precisely the formulations in the data that are missing. </font><font style="vertical-align: inherit;">Thus, our model has learned to make some generalization, moreover, we recall that as a input our model sees not words, but only individual letters.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagnosis of prognosis: a language model as a means of checking symptoms</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symptom checker is a patient-oriented program that can suggest possible diseases based on the user's symptoms. Basically, these applications now work asking questions with answer options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When studying language models, it was found that they can make meaningful assumptions simply on the basis of text containing descriptions of user complaints. Such descriptions are common in online medical forums, as well as in medical history records, which allows one to theoretically use the system to ‚Äúbackground‚Äù check medical records in order to identify possible omissions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The technical details of the method are described in our article [2], as well as in the patent for the invention, there is a systematic assessment of the quality of its work, but for a smaller model and trained in Russian texts. Immediately I want to talk about some unusual results, which showed an English model of a larger size. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the symptoms of an allergic rhinitis ‚Äù </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itchy watery and red eyes, constant runny nose sneezing, but no fever, usually starts outdoors</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äù, The model proposed a fourth option for gastritis. This seems like a strange funny thing, because gastritis clearly causes completely different symptoms. But after studying the question more deeply, I found that it turns out that there is a known statistical relationship between allergic rhinitis and the frequency of gastritis [3], that is, a patient with a chronic runny nose is more likely to have gastritis. In a number of cases, perhaps for the doctor it makes sense to see one disease to question the patient if he has symptoms and the second. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In another example, if we add the following description to the model: ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Severe frequent headaches starting in the morning, prolonged, fatigue, eye pain</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"(" Severe frequent headaches starting in the morning, prolonged, fatigue, pain in the eyes "), we get the expected migraine and tension headaches in the top 2, but, for example, in fifth place was manifested multiple sclerosis. </font><font style="vertical-align: inherit;">This seems like an illogical assumption, but multiple sclerosis is indeed accompanied in some cases by headaches [4,5], and moreover, headaches may in some cases precede the appearance of other symptoms. </font><font style="vertical-align: inherit;">Thus, the model seems to be able to create relationships that are not always obvious even to specialists.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Answers on questions</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interestingly, the resulting model also has the ability to answer questions by sequentially generating an answer. So far we have not explored these possibilities in detail, but here are some interesting examples (for ease of reading everything has been translated into Russian): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question: I have a question about the ears, nose and throat. Since last year, I have a continuous postpartum drop and a sore throat. I tried to take OTC antihistamines and mucus thinner, but they did not help. I also have a click in my ear. What could it be? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Model answer: the most common reason for this is a cold or allergy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question: Is it normal for a child to have a fever after vaccination?</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Model answer: yes. </font><font style="vertical-align: inherit;">Often there is fever after vaccination. </font><font style="vertical-align: inherit;">Often there is fever after vaccination. </font><font style="vertical-align: inherit;">If you have a fever or if you have a fever, you should consult a doctor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question: what is monocytosis? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Model Response: Monoclonal Gammopathy of Uncertain Value (MGUS) is a rare autoimmune disease that can be caused by various infections, including mononucleosis, myeloma, and others. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some answers sound reasonable, but there are completely erroneous options, so this model does not reach the doctor-consultant yet, however, what we got already seems rather interesting.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Literature</font></font></b>
                        <div class="spoiler_text"> <br>
1. Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan, J., Dhariwal, P.,‚Ä¶ &amp; Agarwal, S. (2020). Language Models are Few-Shot Learners. arXiv preprint arXiv:2005.14165.<br>
2. Matveeva, T., and N. Galiullina. ¬´Language models for unsupervised acquisition of medical knowledge from natural language texts: application for diagnosis prediction¬ª (2019) Proceedings of the International Conference ‚ÄúDialogue 2019‚Äù, Moscow May 29‚ÄîJune 1, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">www.dialog-21.ru/media/4632/tarasovdplusetal-069.pdf</a> <br>
3. Locatelli, Francesca, et al. ¬´The association between gastritis/gastroesophageal reflux and rhinitis/rhinosinusitis.¬ª (2016): PA4255.<br>
4. Freedman, Mark S., and Trevor A. Gray. ¬´Vascular headache: a presenting symptom of multiple sclerosis.¬ª Canadian journal of neurological sciences 16.1 (1989): 63-66.<br>
5. D'Amico, Domenico, et al. ¬´Prevalence of primary headaches in people with multiple sclerosis.¬ª Cephalalgia 24.11 (2004): 980-984.<br>
<br>
</div>
                    </div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en506022/index.html">Hosting and dedicated servers: answer questions. Stories with real customers. Conflict situations. Part 5</a></li>
<li><a href="../en506024/index.html">The book ‚ÄúPure Agile. The Basics of Flexibility</a></li>
<li><a href="../en506026/index.html">The problem of obsolete root certificates. Next in line Let's Encrypt and smart TVs</a></li>
<li><a href="../en506032/index.html">Generative Adversarial Network (GAN) Enhancements</a></li>
<li><a href="../en506034/index.html">Oracle Glossary: ‚Äã‚ÄãHistory</a></li>
<li><a href="../en506044/index.html">Assessment of market risk (Value at Risk) of a bond portfolio (theory)</a></li>
<li><a href="../en506050/index.html">Unit tests in uVision Keil (and not only)</a></li>
<li><a href="../en506054/index.html">MskDotNet Meetup at Raiffeisenbank 11/06</a></li>
<li><a href="../en506064/index.html">Develop an interactive web application in C # with zero knowledge of JavaScript</a></li>
<li><a href="../en506066/index.html">Building a digital model of a successful securities trading strategy. Description. Evidence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>