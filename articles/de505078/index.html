<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🔬 👩🏽‍🤝‍👩🏼 👩🏿‍💼 BLE unter dem Mikroskop (ATT GATT ...) 👊🏼 🎢 🎛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BLE unter dem Mikroskop (ATT GATT ...) Teil 1, Übersicht
 
 Es ist schon eine Weile her, seit die erste Spezifikation für Bluetooth 4.0 veröffentlicht...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BLE unter dem Mikroskop (ATT GATT ...)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505078/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jc/9m/ea/jc9meakt15qji8lrruuauk5z_fw.png" alt="Bild"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE unter dem Mikroskop (ATT GATT ...)</font></font></h2> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teil 1, Übersicht</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es ist schon eine Weile her, seit die erste Spezifikation für Bluetooth 4.0 veröffentlicht wurde. </font><font style="vertical-align: inherit;">Und obwohl das BLE-Thema sehr interessant ist, schiebt es viele Entwickler aufgrund seiner Komplexität immer noch weg. </font><font style="vertical-align: inherit;">In meinen vorherigen Artikeln habe ich mich hauptsächlich mit der Verbindungsschicht auf der niedrigsten Ebene und der physischen Schicht befasst. </font><font style="vertical-align: inherit;">Dies ermöglichte es uns, solche komplexen und verwirrenden Konzepte wie das Attributprotokoll (ATT) und das Allgemeine Attributprofil (GATT) nicht anzusprechen. </font><font style="vertical-align: inherit;">Ohne sie zu verstehen, ist es jedoch unmöglich, kompatible Geräte zu entwickeln. </font><font style="vertical-align: inherit;">Heute möchte ich dieses Wissen mit Ihnen teilen. </font><font style="vertical-align: inherit;">In meinem Artikel werde ich auf eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von der nordischen Website zurückgreifen. </font><font style="vertical-align: inherit;">Also lasst uns anfangen.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum ist alles so schwierig?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meiner Meinung nach war sofort klar, dass die Geräteverwaltung über Smartphones ein vielversprechendes und langwieriges Thema ist. Deshalb haben sie beschlossen, es sofort und maximal zu strukturieren. Damit Hersteller verschiedener Geräte keine eigenen Protokolle entwickeln, die dann nicht kompatibel sind. Daher die Komplexität. Bereits in der ersten Phase versuchten sie, alles Mögliche in das BLE-Protokoll zu integrieren. Und es spielt keine Rolle, ob es nützlich ist oder nicht. Darüber hinaus boten sie die Möglichkeit, die Liste der Geräte für die Zukunft zu erweitern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns das Bild an, auf dem das Diagramm des BLE-Protokolls gezeichnet ist. Es besteht aus mehreren Schichten. Die unterste physikalische Schicht (PHY) ist für den Funkkanal des Geräts verantwortlich. Link Layer (LL) enthält die gesamte Folge von Bytes in der übertragenen Nachricht. In früheren Artikeln haben wir es studiert. Host Controller Interface (HCI) ist ein Protokoll für den Austausch zwischen Schichten oder BLE-Chips, wenn Controller und Host auf verschiedenen Chips implementiert sind. Das Logical Link Control and Adaptation Protocol (L2CAP) ist für die Bildung von Paketen, die Teilung durch Frames, die Fehlerkontrolle und die Paketzusammenstellung verantwortlich. Die Paketverschlüsselung liegt in der Verantwortung des Security Manager Protocol (SMP). Ein Shared Access-Profil (GAP) ist für die anfängliche Kommunikation zwischen Geräten verantwortlich, um festzustellen, wer wer ist. Es umfasst auch Scannen und Werbung.In diesem Artikel werde ich mich auf die beiden verbleibenden Teile des Protokolls konzentrieren - GATT und ATT. GATT ist ein Add-On für ATT, daher sind sie eng miteinander verbunden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/51/qi/ms/51qimsv8ccop7bncjcrllcc7tcg.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Geschichte zu vereinfachen, möchte ich mich einer Analogie zuwenden. Ich habe sie irgendwo gehört und würde sie gerne unterstützen. Stellen Sie sich ein BLE-Gerät als Bücherregal mit mehreren Regalen vor. Jedes Regal ist ein eigenes Thema. Zum Beispiel haben wir Regale mit Belletristik, Mathematik und Enzyklopädien. In jedem Regal befinden sich Bücher mit einem bestimmten Thema. Und in einigen Büchern gibt es sogar Lesezeichen aus Papier mit Notizen. Zusätzlich haben wir einen kleinen Papierkatalog aller Bücher. Wenn Sie sich an Schulbibliotheken erinnern, ist dies eine schmale Schachtel mit Papierkarten. Mit dieser Analogie ist der Schrank das Profil unseres Geräts. Regale sind Dienste, Bücher sind Funktionen und ein Verzeichnis ist eine Attributtabelle. Lesezeichen in Büchern sind Deskriptoren, auf die ich später noch näher eingehen werde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jeder, der das Gerät entwickelt hat, weiß, dass viele Projekte ähnliche Codeteile haben. Tatsache ist, dass viele Geräte ähnliche Funktionen haben. Wenn die Geräte beispielsweise mit Batterien betrieben werden, ist das Problem beim Laden und Steuern des Füllstands dasselbe. Gleiches gilt für Sensoren. Tatsächlich bietet der objektorientierte Programmieransatz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„die Möglichkeit, Objekte zu erstellen, die Eigenschaften und Verhaltensweisen zu einer unabhängigen Vereinigung kombinieren, die dann wiederverwendet werden kann“.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Meiner Meinung nach wurde in BLE ein ähnlicher Ansatz versucht. Die Bluetooth Special Interest Group (SIG) hat Profile entwickelt. Geräte verschiedener Hersteller mit denselben Profilen sollten problemlos miteinander arbeiten können. Profile bestehen wiederum aus Diensten und Diensten mit Merkmalen, ergänzt durch Deskriptoren. Im Allgemeinen kann es so aussehen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yv/7v/w-/yv7vw-vhvlnavelyabkxtwe8p0e.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie als Beispiel das Profil des Herzfrequenzmesser-Profils (Fitness-Armband). Es besteht aus zwei Diensten und mehreren Merkmalen. Daraus wird sofort die Profilhierarchie deutlich. Die Checkpoint-Eigenschaft setzt die Gesamtkalorienzahl auf Null zurück. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Der Herzfrequenzdienst umfasst drei Merkmale (0x180D): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;a) Obligatorisches Merkmal der Herzfrequenz (0x2A37)</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;b) Optionale Kennlinie der Position des Körpersensors (0x2A38) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;c) Bedingte Kennlinie des Herzfrequenzreferenzpunkts (0x2A39) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Batterieservice (0x180F): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;a) Obligatorische Kennlinie des Batteriestands (0x2A19)</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uuid</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit wir uns eindeutig auf die Profilelemente (Dienste, Merkmale und Deskriptoren) beziehen können, müssen wir sie alle irgendwie nummerieren. Zu diesem Zweck wird ein Konzept wie UUID (Universally Unique ID) oder Universal Unique Identifier eingeführt. In Klammern jeder Zeile wird nur die UUID angegeben. Und es gibt eine Funktion. Für die UUID haben wir uns für eine Codelänge von 16 und 128 Bit entschieden. Warum fragst du? Im BLE-Protokoll unterliegt alles der Energieeinsparung. Daher ist die Dimension von 16 Bit durchaus sinnvoll. Es ist unwahrscheinlich, dass in naher Zukunft mehr als 65.000 geschaffen werden. einzigartige Dienstleistungen und Funktionen. Im Moment alles, was sie bereits hätten zählen können (denken Sie daran, woher es kam - „er hat Sie auch gezählt“ :-)) Nummerierte Elemente von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profilen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diensten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merkmalen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskriptoren können</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie sich die Links ansehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich denke jedoch, dass sich jeder mit 4 Bytes IP-Adresse im Internet an die Geschichte erinnert. Zuerst dachten sie, das sei genug, aber jetzt gehen wir immer noch nicht zur 6-Byte-Adresse. Um diesen Fehler nicht zu wiederholen und den verspielten Händen hausgemachter Hersteller Raum zu geben, entschied sich SIG sofort, auch 128-Bit-UUIDs einzuführen. Dies erinnert mich persönlich an das nicht lizenzierte 433-MHz-Band, das vom Radiosender an alle Arten von Kulibin abgegeben wurde. In unserem Fall wurde eine 128-Bit-Kennung von Diensten und Merkmalen vergeben. Dies bedeutet, dass wir für unsere Dienste und Geräte fast jeden 128-Bit-Wert verwenden können. Wie auch immer, die Wahrscheinlichkeit, dieselbe UUID zu finden, tendiert gegen Null.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich haben kurze 16-Bit-UUIDs eine Erweiterung auf 128-Bit-Werte. </font><font style="vertical-align: inherit;">In der Spezifikation wird diese Erweiterung als Bluetooth-Basis-UUID bezeichnet und hat den Wert 00000000-0000-1000-8000-00805F9B34FB. </font><font style="vertical-align: inherit;">Wenn beispielsweise die 16-Bit-Attribut-UUID den Wert 0x1234 hat, hat die entsprechende 128-Bit-UUID den Wert 00001234-0000-1000-8000-00805F9B34FB. </font><font style="vertical-align: inherit;">Und sogar die entsprechende Formel wird angegeben: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;128_bit_value = 16_bit_value * 2 ^ 96 + Bluetooth_Base_UUID </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich weiß nicht, woher diese magische Zahl stammt. </font><font style="vertical-align: inherit;">Wenn einer der Leser es weiß, lassen Sie ihn in die Kommentare schreiben. </font><font style="vertical-align: inherit;">Für die Erfindung von 128-Bit-UUIDs können Sie grundsätzlich einen speziellen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generator verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der dies für Sie erledigt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATT GATT ...</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Eigentlich beginnt der Spaß. Ich erinnere mich, dass ATT auf einer Client-Server-Beziehung basiert. Jetzt betrachten wir das Servergerät. Es enthält Informationen wie Sensorwerte, Lichtschalterstatus, Standortdaten usw. Nachdem alle "Teilnehmer unserer Parade" nummeriert sind, müssen wir sie irgendwie im Speicher des Geräts ablegen. Dazu legen wir sie in einer Tabelle ab, die als Attributtabelle bezeichnet wird. Erinnere dich gut daran. Dies ist das Herzstück von BLE. Wir werden es in Zukunft in Betracht ziehen. Jetzt nennen wir jede Zeile ein Attribut. Diese Tabelle befindet sich tief im Stapel und wir haben in der Regel keinen direkten Zugriff darauf. Wir initialisieren es und wenden uns ihm zu, aber was im Inneren passiert, ist uns hinter sieben Siegeln verborgen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie das Bild aus der Spezifikation, aber vorher möchte ich sofort auf die häufige Verwirrung in Bezug auf Begriffe, nämlich in Deskriptoren, aufmerksam machen. Die Rolle des Deskriptors besteht darin, die Beschreibung des Merkmals zu ergänzen. Wenn es notwendig ist, seine Fähigkeiten zu erweitern, verwenden sie Deskriptoren. Sie sind auch Attribute und befinden sich ebenso wie Dienste und Merkmale in der Attributtabelle. Wir werden sie im zweiten Teil des Artikels detailliert analysieren. Manchmal werden Deskriptoren jedoch als Zeilennummer in der Attributtabelle bezeichnet. Dies muss berücksichtigt werden. Um nicht verwirrt zu werden, verwenden wir für diese Zwecke den Begriff „Attributzeiger“. </font></font><br>
<img src="https://habrastorage.org/webt/a5/rl/lk/a5rllkmo7i3doe3ripvpjd2ztwy.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Attribut ist also ein diskreter Wert, dem die folgenden Eigenschaften zugeordnet sind: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Attributhandle ist der Index der Tabelle, die dem Attribut entspricht</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Attributtyp ist die UUID, die ihren Typ beschreibt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Attributwert sind die vom Attributzeiger indizierten Daten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Attributberechtigungen sind Teil des Attributs, Berechtigungen, die nicht sein können Lesen oder Schreiben mit dem Attributprotokoll </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie kann man das alles verstehen? Der Attributzeiger ist relativ gesehen seine Nummer in unserer Tabelle.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ermöglicht dem Client, in Lese- oder Schreibanforderungen auf ein Attribut zu verweisen. Wir können unsere Zeilen (Attribute) von 0x0001 bis 0xFFFF nummerieren. In unserer Verbindung mit einem Bücherregal ist dies die Kartennummer im Papierkatalog. Ähnlich wie im Bibliothekskatalog sind die Karten in aufsteigender Reihenfolge angeordnet. Die Anzahl jeder nachfolgenden Zeile muss größer sein als die vorherige. Wie in der Bibliothek gehen manchmal einige Karten verloren, also haben wir - es kann Lücken in der Zeilennummerierung geben. Dies ist erlaubt. Die Hauptsache ist, dass sie weiter zunehmen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Attributtyp bestimmt, was dieses Attribut ist. In Analogie zur C-Sprache, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
in der es boolesche, numerische Variablen und Zeichenfolgen gibt, also hier. An der Art des Attributs erkennen wir</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
womit wir es zu tun haben und wie wir mit diesem Attribut weiterarbeiten können. Nachfolgend sehen wir uns einige spezifische Arten von Attributen an. Zum Beispiel "Dienstdeklaration" (0x2800), "Merkmaldeklaration" (0x2803), "Deskriptordeklaration" (0x2902). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Wert des Attributs ist tatsächlich sein Wert, entschuldigen Sie die Tautologie. Wenn der Attributtyp eine Zeichenfolge ist, kann der Attributwert beispielsweise der Slogan „Hallo Welt !!!“ sein. Wenn der Attributtyp eine "Dienstdeklaration" ist, ist sein Wert der Dienst selbst. Und manchmal sind dies Informationen darüber, wo andere Attribute und ihre Eigenschaften zu finden sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit Attributberechtigungen kann der Server verstehen, ob Lese- oder Schreibzugriff zulässig ist.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass diese Berechtigungen nur für den Attributwert gelten und nicht für das Zeiger-, Typ- und Berechtigungsfeld selbst. </font><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Wenn die Aufzeichnung von Attributen zulässig ist, können wir beispielsweise die Zeile „Hallo Welt !!!“ ändern. </font><font style="vertical-align: inherit;">auf der Linie "Guten Morgen". </font><font style="vertical-align: inherit;">Wir können jedoch die Aufzeichnung einer neuen Zeile nicht verbieten oder den Attributtyp ändern und die Zeile als "Dienstdeklaration" kennzeichnen. </font><font style="vertical-align: inherit;">Wenn ein Client auf den Server zugreift, fordert der Client seine Attribute an. </font><font style="vertical-align: inherit;">Auf diese Weise kann der Client herausfinden, was der Server bereitstellen kann. </font><font style="vertical-align: inherit;">Es ist zwar nicht erforderlich, Werte zu lesen und zu schreiben.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sieht es aus</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Konzept von GATT besteht darin, Attribute in einer Attributtabelle in einer sehr spezifischen und logischen Reihenfolge zu gruppieren. Schauen wir uns das Herzfrequenzprofil unten genauer an. Die Spalte ganz links in dieser Tabelle ist optional. Er beschreibt uns einfach, was diese Zeile (Attribut) ist. Alle anderen Spalten sind uns bereits bekannt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6k/vt/4l/6kvt4lzc9h6ll9kwdu9g6qps22c.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Anfang jeder Gruppe steht immer ein Attribut für Servicewerbung. Der Typ ist immer 0x2800 und der Zeiger hängt davon ab, wie viele Attribute bereits in der Tabelle vorhanden sind. Die Berechtigungen sind immer schreibgeschützt, ohne Authentifizierung oder Autorisierung. Wir werden etwas später über diese Konzepte sprechen. Ein Wert ist eine andere UUID, die bestimmt, um welche Art von Dienst es sich handelt. In der Tabelle ist der Wert 0x180D, der von Bluetooth SIG als Herzfrequenzdienst definiert wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Ankündigung des Dienstes die Ankündigung des Merkmals. In der Form ähnelt es einer Serviceerklärung. Die UUID lautet immer 0x2803, und Berechtigungen sind auch ohne Authentifizierung oder Autorisierung immer schreibgeschützt. Schauen wir uns das Feld Attributwert an, das einige Daten enthält. Es enthält immer einen Zeiger, eine UUID und eine Reihe von Eigenschaften. Diese drei Elemente beschreiben die nachfolgende Deklaration des Merkmalswertes. Der Zeiger gibt natürlich den Ort der Deklaration des Merkmalswerts in der Attributtabelle an. Die UUID beschreibt, welche Art von Informationen oder Wert wir erwarten können. Zum Beispiel der Temperaturwert, der Zustand des Lichtschalters oder ein anderer beliebiger Wert. Und schließlich Eigenschaften, die beschreiben, wie Sie mit einem charakteristischen Wert interagieren können.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier warten wir auf eine weitere Falle. Es ist Attributberechtigungen und Eigenschaften zugeordnet. Schauen wir uns das Bild der Eigenschaften des Bitfeldes aus der Spezifikation an. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ko/co/5y/koco5ykz3gqkfwww1k48ssxvjug.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, gibt es hier auch Felder, die Lese- und Schreibfunktionen bieten. Sie fragen sich vielleicht, warum wir Lese- / Schreibberechtigungen für das Attribut und </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lese- / Schreibeigenschaften für den Merkmalswert haben? Sollten sie nicht immer gleich sein? Tatsache ist, dass die Eigenschaften für den charakteristischen Wert tatsächlich nur Empfehlungen für den Client sind, die in der GATT- und der Anwendungsebene verwendet werden. Dies sind nur Hinweise darauf, was ein Kunde von einem Feature-Anzeigenattribut erwarten kann. Lassen Sie uns dies genauer behandeln. Welche Arten von Berechtigungen hat das Attribut? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Zugriffsberechtigungen:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Lesen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Schreiben </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Lesen und Schreiben </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Authentifizierungsberechtigung: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Authentifizierung ist erforderlich </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Authentifizierung ist nicht erforderlich </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Autorisierungsberechtigung: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Autorisierung ist erforderlich </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp; - Autorisierung ist nicht erforderlich</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Hauptunterschied zwischen Attributauflösung und Eigenschaften von Merkmalen besteht darin, dass sich die ersteren auf Server und die letzteren auf Clients beziehen. </font><font style="vertical-align: inherit;">Der Server kann möglicherweise den Wert des Merkmals lesen, es besteht jedoch gleichzeitig eine Authentifizierungs- oder Autorisierungsanforderung. </font><font style="vertical-align: inherit;">Wenn der Client Eigenschaften des Merkmals anfordert, erhalten wir daher, dass das Lesen zulässig ist. </font><font style="vertical-align: inherit;">Aber wenn wir versuchen zu lesen, bekommen wir einen Fehler. </font><font style="vertical-align: inherit;">Daher können wir sicher über die Priorität von Berechtigungen gegenüber Eigenschaften sprechen. </font><font style="vertical-align: inherit;">Wir können keine Informationen über die Berechtigungen des Attributs auf der Clientseite erhalten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskriptor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zurück zu unserem Tisch. Nach dem Deklarieren eines Merkmalswerts sind die folgenden Attributdeklarationen möglich: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Neue Deklaration eines Merkmals (es können viele Merkmale in einem Dienst vorhanden sein) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Neue Dienstdeklaration (es können viele davon in einer Tabelle enthalten sein) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Deklaration eines Handles</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei einem Merkmal, das die Herzfrequenz misst, wird in unserer Tabelle die Angabe des Wertes des Merkmals von der Angabe eines Deskriptors begleitet. Ein Deskriptor ist ein Attribut mit zusätzlichen Informationen zum Merkmal. Es gibt verschiedene Arten von Deskriptoren. Wir werden im zweiten Teil dieses Artikels ausführlich darauf eingehen. Jetzt werden wir nur den Client Characteristic Configuration Descriptor (CCCD) berühren. Es hat eine UUID von 0x2902. Mit diesem Deskriptor kann der Client die Anzeige oder Benachrichtigung auf dem Server aktivieren. Der Unterschied zwischen ihnen ist gering, aber immer noch da. Für die Benachrichtigung ist keine Bestätigung des Eingangs beim Kunden erforderlich. Die Anzeige erfordert dies, obwohl es auf GATT-Ebene auftritt und nicht die Anwendungsebene erreicht. Warum, fragst du? Leider weiß ich es nicht.Ich kann nur sagen, dass nordische Experten die Verwendung von Benachrichtigungen empfehlen. Darüber hinaus erfolgt in beiden Fällen eine Paketintegritätsprüfung (unter Verwendung von CRC).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Ende des Artikels möchte ich dies sagen. </font><font style="vertical-align: inherit;">Der letzte Tisch ist etwas verwirrend. </font><font style="vertical-align: inherit;">Ich habe mich jedoch dafür entschieden, weil es in dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel angegeben ist,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf den ich mich verlasse. </font><font style="vertical-align: inherit;">Im zweiten Teil meines Artikels möchte ich mich mit der BlueTooth 4.0-Spezifikation befassen. </font><font style="vertical-align: inherit;">Dort warten wir auf korrektere Schemata und Zeichnungen. </font><font style="vertical-align: inherit;">Im dritten Teil möchte ich das mit Hilfe des Wireshark-Programms von einem der Geräte erhaltene Protokoll analysieren und die gesamte Theorie, die wir studieren, „live“ sehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mitarbeiter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Caesar Satellite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unternehmensgruppe </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pecherskikh Vladimir</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de505052/index.html">Schnelltests von Motionia.js und Consoleimg.js</a></li>
<li><a href="../de505060/index.html">Fügen Sie das numpy-Array über Python in die MySQL-Datenbank ein</a></li>
<li><a href="../de505064/index.html">Mikrotik split-dns: sie haben es geschafft</a></li>
<li><a href="../de505070/index.html">Intellektuelle Masturbation über gutes Schreiben</a></li>
<li><a href="../de505074/index.html">Hosting und dedizierte Server: Beantworten Sie Fragen. Teil 2. Warum so ein teures Internet im Rechenzentrum?</a></li>
<li><a href="../de505080/index.html">Mutex in der Welt des asynchronen Codes</a></li>
<li><a href="../de505090/index.html">Über das Übersetzen der Wörter "nützlich" / "verwenden" ohne Verwendung / nützlich</a></li>
<li><a href="../de505092/index.html">Wie ich einen Job bei Microsoft bekam</a></li>
<li><a href="../de505098/index.html">Snom D717 IP-Telefon Bewertung</a></li>
<li><a href="../de505104/index.html">Wie wir einen Service entwickelt haben, der in die Top 5 der größten Apothekenstandorte der Welt aufgenommen wurde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>