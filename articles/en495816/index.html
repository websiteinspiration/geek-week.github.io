<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèª üíΩ üï• Regularization? Orthogonalization! Improving compact networks üëèüèø üìø ‚Ü©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While other companies are discussing managing the team remotely, we at Smart Engines continue to share our technology stack with you. Today about the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Regularization? Orthogonalization! Improving compact networks</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/smartengines/blog/495816/"><img src="https://habrastorage.org/webt/jn/gi/4m/jngi4mnuto0wqg0wgq6bg7bauzm.png" width="250" align="right"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
While other companies are discussing managing the team remotely, we at Smart Engines continue to share our technology stack with you. Today about the optimization of neural networks. To make a recognition system based on neural networks that could quickly work on smartphones and other mobile devices is extremely difficult. And to make sure that the quality is high is even more difficult. In this article, we will talk about a simple method of regularizing neural networks that we use in Smart Engines to improve the quality of "mobile" networks with a small number of parameters. The idea of ‚Äã‚Äãthe method is based on a gradual decrease in the linear dependence of the filters in the convolutional layers during training, due to which each neuron works more efficiently, and therefore, the generalizing ability of the model is improved.To do this, we present filters in the form of one-dimensional vectors and orthogonalize a pair with the longest projection length onto each other.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When designing most modern neural networks, it is understood that they will be performed somewhere remotely on the server, and the data for processing will come through the client on a PC or mobile device. However, this approach is unacceptable when it comes to the security of personal data that you don‚Äôt want to transfer somewhere (for example, a passport photo or a bank card for recognition). Fortunately for us, mobile devices today have sufficient capacity to run neural networks, so you can avoid sending data to third parties. Another thing is that these networks should be small and contain a small number of operations so as not to test the patience of the user. Such conditions limit the maximum achievable quality of their work,and how to improve lightweight networks without sacrificing runtime is an open question. Reflecting on this, we came up with a new method of regularization in neural networks, focused on compact networks and consisting in the orthogonalization of convolutional filters.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The post is a short version of the report "Convolutional neural network weights regularization via orthogonalization", presented in November 2019 at the international conference ICMV 2019, Amsterdam, Netherlands.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The idea of ‚Äã‚Äãregularization using orthogonalization</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the proposed method relates to regularization, we first recall briefly what it is. Regularization consists in imposing some restrictions on the model based on our ideas about how the task should be solved. As a result, the generalizing ability of the network is increased. For example, L1 regularization contributes to the zeroing of part of the balance by making the network discharged, L2 - holds coefficients within small numbers, Dropout eliminates the dependence of individual neurons, etc. These methods are an integral part of the learning process of many modern networks, especially if they contain a large number of parameters - regularization allows you to deal fairly well with retraining.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now back to our method. </font><font style="vertical-align: inherit;">We make a reservation right away that, first of all, we consider the problem of classifying images with a convolutional neural network. </font><font style="vertical-align: inherit;">The assumption, on the basis of which we came to the use of orthogonalization, is the following: if the network is extremely limited in its resources for the concept of patterns in the data, then each neuron in it must be made to work as efficiently as possible, and so that it performs the function strictly assigned to it. </font><font style="vertical-align: inherit;">In other words, so that it ‚Äúhooks up‚Äù such features that any other neuron is unable to detect. </font><font style="vertical-align: inherit;">We solve this problem by gradually reducing the linear relationship between the neuron weight vectors during training. </font><font style="vertical-align: inherit;">To do this, we modified the classical orthogonalization algorithm, adapting it to the realities of the learning process.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convolution filter orthogonalization</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Define the convolutional layer filters as a set of vectors </font></font><img src="https://habrastorage.org/webt/_d/gd/_l/_dgd_lsccqslwex9nbmw_mjgcqe.png" width="113"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the index of the convolutional layer, and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the number of filters in it. After the weights were updated during the back propagation of the error, in each individual convolutional layer we look for a pair of vectors with a maximum projection length on top of each other: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p9/ll/jy/p9lljy3d6hqq6zx1winyzy2idma.png" width="319"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The projection of the vector </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> onto </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be calculated as </font></font><img src="https://habrastorage.org/webt/4z/ng/sq/4zngsqbavo-xttuhor2pr8ajt7e.png" width="127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Then, in order to orthogonalize the filters </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we replace the first step from the Gram-Schmidt algorithm with the </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-2/o5/zd/-2o5zd8h5qajfjuopfh9lv-z27w.png" width="121"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
following formula: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-w/2e/hm/-w2ehmsvfheeifgphlsogdm7y-m.png" width="180"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the learning speed and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">orthogonalization coefficient, the values ‚Äã‚Äãof which lie on the interval [0.0, 1.0]. </font><font style="vertical-align: inherit;">The introduction of the orthogonalization coefficient is due to the fact that the ‚Äúinstantaneous‚Äù orthogonalization of filters greatly breaks down the learning process, negating the systematic changes in weights over past iterations. </font><font style="vertical-align: inherit;">Small </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> values </font><font style="vertical-align: inherit;">preserve the dynamics of learning and contribute to a smooth decrease in the linear relationship between the filters in each layer separately. </font><font style="vertical-align: inherit;">We note once again an important point in the method: in one iteration we modify only one vector so as not to harm the optimization algorithm. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jn/gi/4m/jngi4mnuto0wqg0wgq6bg7bauzm.png" width="300"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">Visualization of one iteration.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We consider orthogonalization of convolutional filters only, since in modern neural networks convolutional layers make up a large part of the architecture. </font><font style="vertical-align: inherit;">However, the algorithm is easily generalized to the weights of neurons in fully connected layers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experiments</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We pass from theory to practice. </font><font style="vertical-align: inherit;">For experiments, we decided to use the 2 most popular datasets for evaluating neural networks in the field of computer vision - MNIST (classification of images of handwritten numbers) and CIFAR10 (photos of 10 classes - boats, trucks, horses, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since we assume that orthogonalization will be useful primarily for compact networks, we took a LeNet-like architecture in 3 modifications, which differ from each other in the number of filters in convolutional layers. </font><font style="vertical-align: inherit;">The architecture of our network, which will be called LeNet 1.0 for convenience, is shown in Table 1. The LeNet 2.0 and LeNet 3.5 architectures derived from it are distinguished by a large number of filters in convolutional layers, 2 and 3.5 times, respectively.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choosing the activation function, we stopped at ReLU not only because it is the most popular and computationally efficient function (we remind you that we are still talking about fast networks). </font><font style="vertical-align: inherit;">The fact is that the use of non-piecewise linear functions negates the effect of orthogonalization: for example, the hyperbolic tangent strongly distorts the input vectors since it has a pronounced nonlinearity in regions close to saturation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Table 1. LeNet 1.0 network architecture used in the experiments.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layers</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A type</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameters</font></font></td>
<td><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Activation </font><font style="vertical-align: inherit;">function</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 filters 3x3, stride 1x1, no padding</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 filters 5x5, stride 2x2, padding 2x2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 filters 3x3, stride 1x1, padding 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filters 5x5, stride 2x2, padding 2x2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filters 3x3, stride 1x1, padding 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filters 3x3, stride 1x1, padding 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fully connected</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 neurons</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Softmax</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We tried 3 values ‚Äã‚Äãof the orthogonalization coefficient </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 0.01, 0.05, 0.1. </font><font style="vertical-align: inherit;">All experiments were carried out 10 times, and the results were averaged (standard deviation ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> shown in the table with the results). </font><font style="vertical-align: inherit;">We also calculated how many percent the number of errors ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">decreased </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The experimental results confirmed that the improvement from orthogonalization is greater, the smaller the parameters in the network (tables 2 and 3). </font><font style="vertical-align: inherit;">We also obtained an interesting result that the use of orthogonalization in the case of ‚Äúheavy‚Äù networks leads to poor quality. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Table 2. Experimental results for MNIST</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mnist</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 1.0 (52k params)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 2.0 (179k params)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 3.5 (378k params)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baseline</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.402%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.033</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.366%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.026</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.361%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.028</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.379%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.027</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.72%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.355%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.01%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.359%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.026</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.55%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.05</font></font></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.36%</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.022</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.45%</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.354%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.018</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.28%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.356%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.034</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.39%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.368%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.015</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.46%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.53%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.024</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.55%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.353%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.018</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.22%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Table 3. Experimental Results for CIFAR10</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cifar10</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 1.0 (52k params)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 2.0 (179k params)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 3.5 (378k params)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error rate</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benefit</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baseline</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22.09%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.65</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18.49%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.08%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.47</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21.56%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.86</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.38%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18.14%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.65</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.89%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.33%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.49</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1.46%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.05</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21.59%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.48</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.24%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18.30%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.57</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.03%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.59%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.31</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-3.02%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wort = 0.1</font></font></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21.54%</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.41</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.48%</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18.15%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.53</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.85%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.53%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-2.63%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, LeNet networks are now rare and more modern models are usually used. Therefore, we also experimented with the ResNet model, facilitated by the number of filters, consisting of 25 convolutional layers. The first 7 layers contained 4 filters, the next 12 by 8 filters, and the last 6 by 16 filters. The total number of trained parameters of this model was 21 thousand. The result was similar: orthogonalization improves the quality of the network. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nq/va/fx/nqvafx4up03rmco1l7hpopikllg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fig. Comparison of ResNet learning dynamics at MNIST with and without orthogonalization.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite the achieved improvements in quality, for complete confidence in the correct operation of the proposed method, you need to see what changes have occurred in the filters themselves. </font><font style="vertical-align: inherit;">For this, the values ‚Äã‚Äãof the maximum filter projection length in 2, 12 and 25 ResNet layers were written off for all eras of training. </font><font style="vertical-align: inherit;">We give the dynamics of changes in the graphs below. </font><font style="vertical-align: inherit;">The most important thing here is that in all layers there is a decrease in the linear dependence of the filters. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/g3/2a/gwg32aillxqsf-mrg0owpybr0yq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. </font><font style="vertical-align: inherit;">Dynamics of changes in the maximum projection length of filters in a convolutional layer using ResNet as an example. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Orthogonalization-based regularization is extremely easy to implement: on python using the numpy module it takes less than 10 lines of code. </font><font style="vertical-align: inherit;">At the same time, it does not slow down training and is compatible with other regularization methods.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite its simplicity, orthogonalization helps to improve the quality of ‚Äúlightweight‚Äù networks, which impose restrictions on the size and speed of execution. </font><font style="vertical-align: inherit;">Due to the proliferation of mobile technologies, such restrictions are increasingly common: a neural network should not run somewhere in the cloud, but directly on a device with a weak processor and low memory. </font><font style="vertical-align: inherit;">The training of such networks runs counter to modern trends in neural network science, where ensembles of models with millions of trained parameters that no smartphone can pull are actively used. </font><font style="vertical-align: inherit;">That is why, in the framework of solving industrial problems, it is extremely important to invent and develop methods for improving the quality of simple and fast networks.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List of sources used</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexander V. Gayer, Alexander V. Sheshkus, ‚ÄúConvolutional neural network weights regularization via orthogonalization,‚Äù Proc. </font><font style="vertical-align: inherit;">SPIE 11433, Twelfth International Conference on Machine Vision (ICMV 2019), 1143326 (January 31, 2020); </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://doi.org/10.1117/12.2559346</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en495804/index.html">DIY arcade machine at home</a></li>
<li><a href="../en495806/index.html">Carnegie University - Mellon Develops COVID-19 Patient Voice Analysis Application</a></li>
<li><a href="../en495808/index.html">How to model an aircraft fuselage - depends on the geometric core</a></li>
<li><a href="../en495812/index.html">Blazor Client Side Online Store: Part 5 - View the Recycle Bin and Work with Stateful</a></li>
<li><a href="../en495814/index.html">A bunch of SaaS services for communicating in an organization remotely</a></li>
<li><a href="../en495820/index.html">We transfer students to udalenka in 1 day</a></li>
<li><a href="../en495822/index.html">What to think about when implementing duty</a></li>
<li><a href="../en495826/index.html">Angular for Vue Developers</a></li>
<li><a href="../en495832/index.html">Virus and antibiotics: a gentle educational program for panicking</a></li>
<li><a href="../en495834/index.html">Digital events in Moscow from April 6 to 12</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>