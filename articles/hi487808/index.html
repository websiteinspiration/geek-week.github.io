<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЧЮя╕П ЁЯЪ╡ЁЯП╛ ЁЯдЮЁЯП╗ рдХреЗрд░рд╕ рдХреЗ рд╕рд╛рде рдЖрд╡рд░реНрддрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ (рдЖрд░рдПрдирдПрди) ЁЯЪ╢ЁЯП╜ ЁЯЪ╖ ЁЯзЫЁЯП╗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensorflow.org рд╕реЗ рдкреБрдирд░рд╛рд╡рд░реНрддреА рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд╛рдЗрдб рдХрд╛ рдЕрдиреБрд╡рд╛рджред рд╕рд╛рдордЧреНрд░реА рддреНрд╡рд░рд┐рдд рдореЗрд╢рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреЗрд░рд╕ / рдЯреЗрдиреНрд╕рд░рдлреНрд▓реЛ 2.0 рдХреА рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдкрд░рдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдХреЗрд░рд╕ рдХреЗ рд╕рд╛рде рдЖрд╡рд░реНрддрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ (рдЖрд░рдПрдирдПрди)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487808/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensorflow.org рд╕реЗ рдкреБрдирд░рд╛рд╡рд░реНрддреА рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд╛рдЗрдб рдХрд╛ рдЕрдиреБрд╡рд╛рджред </font><font style="vertical-align: inherit;">рд╕рд╛рдордЧреНрд░реА рддреНрд╡рд░рд┐рдд рдореЗрд╢рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреЗрд░рд╕ / рдЯреЗрдиреНрд╕рд░рдлреНрд▓реЛ 2.0 рдХреА рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдкрд░рддреЛрдВ рдФрд░ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рджреЛрдиреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">CuDNN рдХреЛрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдорд▓реЛрдВ рдФрд░ рд╕реАрдорд╛рдУрдВ рдХреЛ рднреА рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/xt/_q/nj/xt_qnjgfjengqoqd4gizkq4j_wk.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд░рд┐рдХрд░реНрд╕рд┐рд╡ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ (RNN) рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдПрдХ рд╡рд░реНрдЧ рд╣реИ рдЬреЛ рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ рдбреЗрдЯрд╛, рдЬреИрд╕реЗ рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ рдпрд╛ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдпреЛрдЬрдирд╛рдмрджреНрдз рд░реВрдк рд╕реЗ, рдЖрд░рдПрдирдПрди рдкрд░рдд </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рдордп-рдХреНрд░рдо рдХреЗ рдХреНрд░рдо рдореЗрдВ рдкреБрдирд░рд╛рд╡реГрддрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдПрдХ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рдЖрдВрддрд░рд┐рдХ рдЕрд╡рд╕реНрдерд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╕рдордп, рдЙрди рдЪрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдПрдиреНрдХреЛрдбреЗрдб рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдиреЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦ рд▓рд┐рдП рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
: Keras RNN рдПрдкреАрдЖрдИ рдкрд░ рдзреНрдпрд╛рди рджреЗрдиреЗ рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХреА рдЖрд╕рд╛рдиреА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рд░реНрдорд┐рдд рдкрд░рддреЛрдВ: </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>tf.keras.layers.LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>tf.keras.layers.GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдЬрд▓реНрджреА рд╕реЗ рдЬрдЯрд┐рд▓ рд╡рд┐рдиреНрдпрд╛рд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд┐рдирд╛ рдПрдХ рдкреБрдирд░рд╛рд╡рд░реНрддреА рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╕рд╛рди рдЕрдиреБрдХреВрд▓рди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : рдЖрдк рдЖрд░рдПрдирдПрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ (рд▓реВрдк рдХреЗ рдЖрдВрддрд░рд┐рдХ рднрд╛рдЧ) рдХреА рдЕрдкрдиреА рдкрд░рдд рдХреЛ рднреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ</font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдХрд╕реНрдЯрдо рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд╕рд╛рде рдФрд░ `tf.keras.layers.RNN` (` рд▓реВрдк рдХреЗ рд▓рд┐рдП `) рдХреА рдПрдХ рдЖрдо рдкрд░рдд рдХреЗ рд╕рд╛рде рдЗрд╕рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдкрдХреЛ рдХрдо рд╕реЗ рдХрдо рдХреЛрдб рдХреЗ рд╕рд╛рде рд▓рдЪреАрд▓реЗ рддрд░реАрдХреЗ рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдЕрдиреБрд╕рдВрдзрд╛рди рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рдкрдирд╛</font></font></h2><br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> absolute_import, division, print_function, unicode_literals<font></font>
<font></font>
<span class="hljs-keyword">import</span> collections
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
<font></font>
<span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<font></font>
<font></font>
<span class="hljs-keyword">from</span> tensorflow.keras <span class="hljs-keyword">import</span> layers</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдореЙрдбрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЗрд░рд╕ рдореЗрдВ рддреАрди рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЖрд░рдПрдирдПрди рдкрд░рддреЗрдВ рд╣реИрдВ:</font></font><br>
<br>
<ol>
<li><code>tf.keras.layers.SimpleRNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рдЖрд░рдПрдирдПрди рдЬрд┐рд╕рдореЗрдВ рдкрд┐рдЫрд▓реЗ рд╕рдордп рдХреЗ рдХрджрдо рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдЕрдЧрд▓реЗ рдЪрд░рдг рдореЗрдВ рдкрд╛рд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font></li>
<li><code>tf.keras.layers.GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдкрд╣рд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж рдХреЗ рд▓рд┐рдП RNN рдХреЛрдбреЗрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди</font></font></a></li>
<li><code>tf.keras.layers.LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдкрд╣рд▓реА рдмрд╛рд░ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рджреАрд░реНрдШрдХрд╛рд▓реАрди рдЕрд▓реНрдкрдХрд╛рд▓рд┐рдХ рд╕реНрдореГрддрд┐</font></a><font style="vertical-align: inherit;"> рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2015 рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдХреЗрд░рд╕ рдиреЗ рдкрд╣рд▓рд╛ рдкреБрди: рдкреНрд░рдпреЛрдЬреНрдп рдЦреБрд▓рд╛ рд╕реНрд░реЛрдд рдкрд╛рдпрдерди рдФрд░ рдПрд▓рдПрд╕рдЯреАрдПрдо рдФрд░ рдЬреАрдЖрд░рдпреВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╢реБрд░реВ рдХрд┐рдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХ </font></font><code>Sequential</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЙрдбрд▓ </font><font style="vertical-align: inherit;">рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬреЛ </font><font style="vertical-align: inherit;">64-рдЖрдпрд╛рдореА рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдХреЛ рдШреЛрдВрд╕рд▓реЗ рджреНрд╡рд╛рд░рд╛ рдкреВрд░реНрдгрд╛рдВрдХ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдПрдХ рдкрд░рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реИрдХреНрдЯрд░ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ </font></font><code>LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential()
<span class="hljs-comment">#   Embedding      1000, </span>
<span class="hljs-comment">#     64.</span>
model.add(layers.Embedding(input_dim=<span class="hljs-number">1000</span>, output_dim=<span class="hljs-number">64</span>))<font></font>
<font></font>
<span class="hljs-comment">#   LSTM  128  .</span>
model.add(layers.LSTM(<span class="hljs-number">128</span>))<font></font>
<font></font>
<span class="hljs-comment">#   Dense  10    softmax.</span>
model.add(layers.Dense(<span class="hljs-number">10</span>))<font></font>
<font></font>
model.summary()</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЙрдЯрдкреБрдЯ рдФрд░ рд╕реНрдЯреЗрдЯреНрдпреВрдЬрд╝</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, RNN рдкрд░рдд рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдкреНрд░рддрд┐ рддрддреНрд╡ рдПрдХ рд╡реЗрдХреНрдЯрд░ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рд╡реЗрдХреНрдЯрд░ рдкреВрд░реЗ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рдЕрдВрддрд┐рдо рдЖрд░рдПрдирдПрди рд╕реЗрд▓ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╣реИред рдЗрд╕ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдЖрдпрд╛рдо </font></font><code>(batch_size, units)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬрд╣рд╛рдВ </font><font style="vertical-align: inherit;">рд▓реЗрдпрд░ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЛ рджрд┐рдП </font></font><code>units</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрдП рддрд░реНрдХ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ </font></font><code>units</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдЖрдк рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрд░рдПрдирдПрди рдкрд░рдд рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ (рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реЗрдХреНрдЯрд░) рдХреЗ рд▓рд┐рдП рдкреВрд░реЗ рдЖрдЙрдЯрдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рднреА рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддреА рд╣реИ </font></font><code>return_sequences=True</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЗрд╕ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдЖрдпрд╛рдо рд╣реИ </font></font><code>(batch_size, timesteps, units)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential()<font></font>
model.add(layers.Embedding(input_dim=<span class="hljs-number">1000</span>, output_dim=<span class="hljs-number">64</span>))<font></font>
<font></font>
<span class="hljs-comment">#  GRU  3D   (batch_size, timesteps, 256)</span>
model.add(layers.GRU(<span class="hljs-number">256</span>, return_sequences=<span class="hljs-literal">True</span>))<font></font>
<font></font>
<span class="hljs-comment">#  SimpleRNN  2D   (batch_size, 128)</span>
model.add(layers.SimpleRNN(<span class="hljs-number">128</span>))<font></font>
<font></font>
model.add(layers.Dense(<span class="hljs-number">10</span>))<font></font>
<font></font>
model.summary()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, RNN рдкрд░рдд рдЕрдкрдиреА рдЕрдВрддрд┐рдо рдЖрдВрддрд░рд┐рдХ рд╕реНрдерд┐рддрд┐ (рдУрдВ) рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реМрдЯреЗ рд░рд╛рдЬреНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рдж рдореЗрдВ рдЖрд░рдПрдирдПрди рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдиреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдХрд┐рд╕реА рдЕрдиреНрдп рдЖрд░рдПрдирдПрди рдХреЛ рдЖрд░рдВрднреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ</font></a><font style="vertical-align: inherit;"> рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдЖрдорддреМрд░ рдкрд░ рдПрдирдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдореЙрдбрд▓, рд╕реАрдХреНрд╡реЗрдВрд╕ рд╕реАрдХреНрд╡реЗрдВрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ рдбрд┐рдХреЛрдбрд░ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрд╡рд╕реНрдерд╛ рдХреЗ рд▓рд┐рдП рдПрдирдХреЛрдбрд░ рдХреА рдЕрдВрддрд┐рдо рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RNN рдкрд░рдд рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдЖрдВрддрд░рд┐рдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рд▓реМрдЯрд╛рдиреЗ рдХреЗ </font></font><code>return_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдП </font></font><code>True</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдкрд░рдд рдмрдирд╛рддреЗ рд╕рдордп </font><font style="vertical-align: inherit;">рдкреИрд░рд╛рдореАрдЯрд░ </font><font style="vertical-align: inherit;">рдХреЛ рдорд╛рди рдкрд░ </font><font style="vertical-align: inherit;">рд╕реЗрдЯ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ </font></font><code>LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 рд░рд╛рдЬреНрдп рдЯреЗрдВрд╕рд░реНрд╕ рд╣реИрдВ, рдФрд░ </font></font><code>GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдПрдХред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдкрд░рдд рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдкрд░рдд рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рддрд░реНрдХ рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░реЗрдВ </font></font><code>initial_state</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдпрд╛рдо рдХреЛ рдкрд░рдд рддрддреНрд╡ рдХреЗ рдЖрдпрд╛рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">encoder_vocab = <span class="hljs-number">1000</span>
decoder_vocab = <span class="hljs-number">2000</span><font></font>
<font></font>
encoder_input = layers.Input(shape=(<span class="hljs-literal">None</span>, ))<font></font>
encoder_embedded = layers.Embedding(input_dim=encoder_vocab, output_dim=<span class="hljs-number">64</span>)(encoder_input)<font></font>
<font></font>
<span class="hljs-comment">#       </span><font></font>
output, state_h, state_c = layers.LSTM(<font></font>
    <span class="hljs-number">64</span>, return_state=<span class="hljs-literal">True</span>, name=<span class="hljs-string">'encoder'</span>)(encoder_embedded)<font></font>
encoder_state = [state_h, state_c]<font></font>
<font></font>
decoder_input = layers.Input(shape=(<span class="hljs-literal">None</span>, ))<font></font>
decoder_embedded = layers.Embedding(input_dim=decoder_vocab, output_dim=<span class="hljs-number">64</span>)(decoder_input)<font></font>
<font></font>
<span class="hljs-comment">#  2     LSTM    </span><font></font>
decoder_output = layers.LSTM(<font></font>
    <span class="hljs-number">64</span>, name=<span class="hljs-string">'decoder'</span>)(decoder_embedded, initial_state=encoder_state)<font></font>
output = layers.Dense(<span class="hljs-number">10</span>)(decoder_output)<font></font>
<font></font>
model = tf.keras.Model([encoder_input, decoder_input], output)<font></font>
model.summary()<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд░рдПрдирдПрди рдкрд░рдд рдФрд░ рдЖрд░рдПрдирдПрди рд╕реЗрд▓</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрд░рдПрдирдПрди рдПрдкреАрдЖрдИ, рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЖрд░рдПрдирдПрди рдкрд░рддреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реЗрд▓-рд╕реНрддрд░реАрдп рдПрдкреАрдЖрдИ рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрд░рдПрдирдПрди рдкрд░рддреЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬреЛ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЗ рдкреВрд░реЗ рдкреИрдХреЗрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рдЖрд░рдПрдирдПрди рд╕реЗрд▓ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрджрдо рдЙрдард╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрд▓ </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RNN рдкрд░рдд </font><font style="vertical-align: inherit;">рдХреЗ рдЪрдХреНрд░ рдХреЗ рдЕрдВрджрд░ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдПрдХ рдкрд░рдд рдХреЗ рд╕рд╛рде рдПрдХ рд╕реЗрд▓ рд▓рдкреЗрдЯрдирд╛ </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЛ </font><font style="vertical-align: inherit;">рдПрдХ рдкрд░рдд </font><font style="vertical-align: inherit;">рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЕрдиреБрдХреНрд░рдо рдкреИрдХреЗрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдЙрджрд╛ред </font></font><code>RNN(LSTMCell(10))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЧрдгрд┐рддреАрдп рд░реВрдк рд╕реЗ, </font></font><code>RNN(LSTMCell(10))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдЙрд╕реА рддрд░рд╣ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрддрд╛ рд╣реИ рдЬреИрд╕реЗ </font></font><code>LSTM(10)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, TF v1.x рдХреЗ рдЕрдВрджрд░ рдЗрд╕ рдкрд░рдд рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗрд╡рд▓ рд╕рдВрдмрдВрдзрд┐рдд RNN рд╕реЗрд▓ рдмрдирд╛рдиреЗ рдФрд░ RNN рдкрд░рдд рдореЗрдВ рд▓рдкреЗрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдерд╛ред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдореНрдмреЗрдбреЗрдб рдкрд░рддреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ </font></font><code>GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CuDNN рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд┐ рдЖрдк рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреАрди рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЖрд░рдПрдирдПрди рдХреЛрд╢рд┐рдХрд╛рдПрдВ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрдкрдиреА рдЖрд░рдПрдирдПрди рдкрд░рдд рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред</font></font><br>
<br>
<ul>
<li><code>tf.keras.layers.SimpleRNNCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рдд рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ </font></font><code>SimpleRNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
<li><code>tf.keras.layers.GRUCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рдд рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ </font></font><code>GRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
<li><code>tf.keras.layers.LSTMCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рдд рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ </font></font><code>LSTM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рд╕реЗрд▓ рдХреЛ рдПрдХ рдЖрдо рд╡рд░реНрдЧ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдиреЗ рд╕реЗ </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЗ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЖрд░рдПрдирдПрди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрд░реЙрд╕-рдмреИрдЪ рд╕реЗрд╡ рд╕реНрдЯреЗрдЯ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓рдВрдмреЗ рдЕрдиреБрдХреНрд░рдореЛрдВ (рд╕рдВрднрд╡рддрдГ рдЕрдВрддрд╣реАрди) рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп, рдЖрдк </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрд░реЙрд╕-рдмреИрдЪ рд╕реНрдЯреЗрдЯрдлреБрд▓рдиреЗрд╕</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреИрдЯрд░реНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдорддреМрд░ рдкрд░, RNN рдкрд░рдд рдХреА рдЖрдВрддрд░рд┐рдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдирдП рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд░реАрд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╛рдиреА рдкреНрд░рддреНрдпреЗрдХ рдЙрджрд╛рд╣рд░рдг рдЬреЛ рдкрд░рдд рдХреЛ рдЕрддреАрдд рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ) рджреЗрдЦрддрд╛ рд╣реИред рдЗрд╕ рддрддреНрд╡ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП рдкрд░рдд рдХреЗрд╡рд▓ рд░рд╛рдЬреНрдп рдмрдирд╛рдП рд░рдЦреЗрдЧреАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдмрд╣реБрдд рд▓рдВрдмреЗ рдХреНрд░рдо рд╣реИрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдХрдорддрд░ рдЕрд╡рд╕реНрдерд╛ рдореЗрдВ рддреЛрдбрд╝рдирд╛ рдФрд░ рдкрд░рдд рдЕрд╡рд╕реНрдерд╛ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд┐рдП рдмрд┐рдирд╛ RNN рдкрд░рдд рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдПрдХ рдкрд░рдд рдкреВрд░реЗ рдЕрдиреБрдХреНрд░рдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддреА рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдПрдХ рдмрд╛рдж рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ `рд╕реНрдЯреЗрдЯрдлреБрд▓ = рдЯреНрд░реВ` рд╕реЗрдЯ рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ `s = [t0, t1, ... t1546, t1547]` рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">s1 = [t0, t1, ... t100]<font></font>
s2 = [t101, ... t201]<font></font>
...<font></font>
s16 = [t1501, ... t1547]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрдм рдЖрдк рдЗрд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="python hljs">lstm_layer = layers.LSTM(<span class="hljs-number">64</span>, stateful=<span class="hljs-literal">True</span>)
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> sub_sequences:<font></font>
  output = lstm_layer(s)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рдЖрдк рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рд╛рдл рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font></font><code>layer.reset_states()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЛрдЯ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ </font></font><code>i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдкреИрдХреЗрдЬ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг </font></font><code>i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рдкреИрдХреЗрдЬ </font><font style="vertical-align: inherit;">рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХреА рдирд┐рд░рдВрддрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рднреА рдкреИрдХреЗрдЬреЛрдВ рдореЗрдВ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рддрддреНрд╡ (рдкреИрдХреЗрдЬ рдЖрдХрд╛рд░) рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ </font></font><code>[sequence_A_from_t0_to_t100, sequence_B_from_t0_to_t100]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреИрдХреЗрдЬ рд╕рдореНтАНрдорд┐рд▓рд┐рдд рд╣реИ, рддреЛ рдЕрдЧрд▓рд╛ рдкреИрдХреЗрдЬ рд╕рдорд╛рд╣рд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>[sequence_A_from_t101_to_t200, sequence_B_from_t101_to_t200]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдПрдХ рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг рд╣реИ:</font></font><br>
<br>
<pre><code class="python hljs">paragraph1 = np.random.random((<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>)).astype(np.float32)<font></font>
paragraph2 = np.random.random((<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>)).astype(np.float32)<font></font>
paragraph3 = np.random.random((<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>)).astype(np.float32)<font></font>
<font></font>
lstm_layer = layers.LSTM(<span class="hljs-number">64</span>, stateful=<span class="hljs-literal">True</span>)<font></font>
output = lstm_layer(paragraph1)<font></font>
output = lstm_layer(paragraph2)<font></font>
output = lstm_layer(paragraph3)<font></font>
<font></font>
<span class="hljs-comment"># reset_states()      initial_state.</span>
<span class="hljs-comment">#  initial_state   ,      .</span>
lstm_layer.reset_states()</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдЖрд░рдПрдирдПрди</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдордп рд╢реНрд░реГрдВрдЦрд▓рд╛ (рдЬреИрд╕реЗ рдЧреНрд░рдВрдереЛрдВ) рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЕрдиреНрдп рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЕрдХреНрд╕рд░ рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЖрд░рдПрдирдПрди рдореЙрдбрд▓ рдмреЗрд╣рддрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЕрдЧрд░ рдпрд╣ рди рдХреЗрд╡рд▓ рд╢реБрд░реВ рд╕реЗ рдЕрдВрдд рддрдХ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд╛рдХреНрдп рдореЗрдВ рдЕрдЧрд▓реЗ рд╢рдмреНрдж рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╢рдмреНрдж рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдХреЗ рд╕рдВрджрд░реНрдн рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рди рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рд╕рд╛рдордиреЗ рдХреЗ рд╢рдмреНрджред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЗрд░реЗрд╕ рдРрд╕реЗ рджреНрд╡рд┐рджрд┐рд╢ RNN: рдПрдХ рдЖрд╡рд░рдг рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рд▓ рдПрдкреАрдЖрдИ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </font></font><code>tf.keras.layers.Bidirectional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="python hljs">model = tf.keras.Sequential()<font></font>
<font></font>
model.add(layers.Bidirectional(layers.LSTM(<span class="hljs-number">64</span>, return_sequences=<span class="hljs-literal">True</span>), <font></font>
                               input_shape=(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>)))<font></font>
model.add(layers.Bidirectional(layers.LSTM(<span class="hljs-number">32</span>)))<font></font>
model.add(layers.Dense(<span class="hljs-number">10</span>))<font></font>
<font></font>
model.summary()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реБрдб рдХреЗ рддрд╣рдд, </font></font><code>Bidirectional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд RNN рдкрд░рдд </font></font><code>go_backwards</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ </font><font style="vertical-align: inherit;">рдФрд░ </font><font style="vertical-align: inherit;">рдирдИ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХреА рдЧрдИ рдкрд░рдд </font><font style="vertical-align: inherit;">рдХреЗ рдХреНрд╖реЗрддреНрд░ рдХреЛ рдкрд▓рдЯ рджрд┐рдпрд╛ </font><font style="vertical-align: inherit;">рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗ ` </font></font><code>Bidirectional</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд░рдПрдирдПрди </font><font style="vertical-align: inherit;">' </font><font style="vertical-align: inherit;">рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдлреЙрд░рд╡рд░реНрдб рд▓реЗрдпрд░ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдФрд░ рд░рд┐рд╡рд░реНрд╕ рд▓реЗрдпрд░ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдпреЛрдЧ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдкрдХреЛ рдЕрдиреНрдп рдорд░реНрдЬ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрджрд╛ред </font><font style="vertical-align: inherit;">рд╕рдВрдШрдирди, `рдмрд┐рдЬрдиреИрд╢рдирд▓` рд░реИрдкрд░ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ` рдорд░реНрдЬ_рдореЛрдб` рдкреИрд░рд╛рдореАрдЯрд░ рдмрджрд▓реЗрдВред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TensorFlow 2.0 рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди рдЕрдиреБрдХреВрд▓рди рдФрд░ CuDNN рдХреЛрд░</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow 2.0 рдореЗрдВ, рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд LSTM рдФрд░ GRU рдкрд░рддреЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ CuDNN рдХреЛрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдпреЛрдЧ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддреА рд╣реИрдВ рдпрджрд┐ рдХреЛрдИ рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдкреНрд░реЛрд╕реЗрд╕рд░ рдЙрдкрд▓рдмреНрдз рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдмрджрд▓рд╛рд╡ рдХреЗ рд╕рд╛рде, рдкрд┐рдЫрд▓реА рдкрд░рддреЗрдВ </font></font><code>keras.layers.CuDNNLSTM/CuDNNGRU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреБрд░рд╛рдиреА рд╣реИрдВ, рдФрд░ рдЖрдк рдЙрди рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдЪрд┐рдВрддрд╛ рдХрд┐рдП рдмрд┐рдирд╛ рдЕрдкрдирд╛ рдореЙрдбрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рди рдкрд░ рдпрд╣ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ CuDNN рдХрд░реНрдиреЗрд▓ рдХреБрдЫ рдорд╛рдиреНрдпрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд LSTM рдпрд╛ GRU рдкрд░рддреЛрдВ рдХреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдкрд░рдд CuDNN рдХрд░реНрдиреЗрд▓ рдкрд░рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧреА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдЬреИрд╕реЗ</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдлрд╝рдВрдХреНрд╢рди </font><font style="vertical-align: inherit;">рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪреАрдЬрд╝ </font></font><code>activation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗ </font><font style="vertical-align: inherit;">рдмрджрд▓рдирд╛ </font></font><code>tanh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдлрд╝рдВрдХреНрд╢рди </font><font style="vertical-align: inherit;">рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪреАрдЬрд╝ </font></font><code>recurrent_activation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗ </font><font style="vertical-align: inherit;">рдмрджрд▓рдирд╛ </font></font><code>sigmoid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ </font></font><code>recurrent_dropout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 0ред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ </font></font><code>unroll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">True рдкрд░ </font><font style="vertical-align: inherit;">рд╕реЗрдЯ рдХрд░рдирд╛ </font><font style="vertical-align: inherit;">, рдЬреЛ LSTM / GRU рдХреЛ рдЖрдВрддрд░рд┐рдХ </font></font><code>tf.while_loop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рддреИрдирд╛рдд рд▓реВрдк рдореЗрдВ </font><font style="vertical-align: inherit;">рд╡рд┐рдШрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИ </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>use_bias</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЭреВрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рд╕реЗрдЯ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рд╕рд╣реА рдирд╣реАрдВ рд╣реЛрдиреЗ рдкрд░ рдорд╛рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рдпрджрд┐ рдорд╛рд╕реНрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрд░реЗрдЦрд┐рдд рдбреЗрдЯрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ CuDNN рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдмрд╕реЗ рдЖрдо рдорд╛рдорд▓рд╛ рд╣реИ)ред</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рд╕рдВрднрд╡ рд╣реЛ рддреЛ CuDNN рдЧреБрдард▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</font></font></h3><br>
<pre><code class="python hljs">batch_size = <span class="hljs-number">64</span>
<span class="hljs-comment">#    MNIST    (batch_size, 28, 28).</span>
<span class="hljs-comment">#     (28, 28) (   ).</span>
input_dim = <span class="hljs-number">28</span><font></font>
<font></font>
units = <span class="hljs-number">64</span>
output_size = <span class="hljs-number">10</span>  <span class="hljs-comment">#   0  9</span><font></font>
<font></font>
<span class="hljs-comment">#  RNN </span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_model</span>(<span class="hljs-params">allow_cudnn_kernel=True</span>):</span>
  <span class="hljs-comment"># CuDNN     ,     .</span>
  <span class="hljs-comment">#   `LSTM(units)`    CuDNN,</span>
  <span class="hljs-comment">#   RNN(LSTMCell(units))   non-CuDNN .</span>
  <span class="hljs-keyword">if</span> allow_cudnn_kernel:
    <span class="hljs-comment">#  LSTM      CuDNN.</span>
    lstm_layer = tf.keras.layers.LSTM(units, input_shape=(<span class="hljs-literal">None</span>, input_dim))
  <span class="hljs-keyword">else</span>:
    <span class="hljs-comment">#  LSTMCell  RNN    CuDNN.</span><font></font>
    lstm_layer = tf.keras.layers.RNN(<font></font>
        tf.keras.layers.LSTMCell(units),<font></font>
        input_shape=(<span class="hljs-literal">None</span>, input_dim))<font></font>
  model = tf.keras.models.Sequential([<font></font>
      lstm_layer,<font></font>
      tf.keras.layers.BatchNormalization(),<font></font>
      tf.keras.layers.Dense(output_size)]<font></font>
  )<font></font>
  <span class="hljs-keyword">return</span> model
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MNIST рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ</font></font></h3><br>
<pre><code class="python hljs">mnist = tf.keras.datasets.mnist<font></font>
<font></font>
(x_train, y_train), (x_test, y_test) = mnist.load_data()<font></font>
x_train, x_test = x_train / <span class="hljs-number">255.0</span>, x_test / <span class="hljs-number">255.0</span>
sample, sample_label = x_train[<span class="hljs-number">0</span>], y_train[<span class="hljs-number">0</span>]</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдордиреЗ </font></font><code>sparse_categorical_crossentropy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдШрд╛рдЯреЗ рдХреЗ рдПрдХ рдХрд╛рд░реНрдп рдХреЗ рд░реВрдк </font><font style="vertical-align: inherit;">рдореЗрдВ рдЪреБрдирд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдПрдХ рдЖрдпрд╛рдо рд╣реИ </font></font><code>[batch_size, 10]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдХрд╛ рдЙрддреНрддрд░ рдкреВрд░реНрдгрд╛рдВрдХ рд╡реЗрдХреНрдЯрд░ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрдЦреНрдпрд╛ 0 рд╕реЗ 9 рддрдХ рдХреА рд╕реАрдорд╛ рдореЗрдВ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">model = build_model(allow_cudnn_kernel=<span class="hljs-literal">True</span>)<font></font>
<font></font>
model.compile(loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>), <font></font>
              optimizer=<span class="hljs-string">'sgd'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])
</code></pre><br>
<pre><code class="python hljs">model.fit(x_train, y_train,<font></font>
          validation_data=(x_test, y_test),<font></font>
          batch_size=batch_size,<font></font>
          epochs=<span class="hljs-number">5</span>)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CuDNN рдХреЛрд░ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдирдпрд╛ рдореЙрдбрд▓ рдмрдирд╛рдПрдБ</font></font></h3><br>
<pre><code class="python hljs">slow_model = build_model(allow_cudnn_kernel=<span class="hljs-literal">False</span>)<font></font>
slow_model.set_weights(model.get_weights())<font></font>
slow_model.compile(loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=<span class="hljs-literal">True</span>), <font></font>
                   optimizer=<span class="hljs-string">'sgd'</span>, <font></font>
                   metrics=[<span class="hljs-string">'accuracy'</span>])<font></font>
slow_model.fit(x_train, y_train, <font></font>
               validation_data=(x_test, y_test), <font></font>
               batch_size=batch_size,<font></font>
               epochs=<span class="hljs-number">1</span>)  <span class="hljs-comment">#         .</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рд╛рдорд╛рдиреНрдп TensorFlow рдХреЛрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдореЙрдбрд▓ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ CuDNN рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдореЙрдбрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рддреЗрдЬ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CuDNN рд╕рдорд░реНрдерди рд╡рд╛рд▓рд╛ рдПрдХ рд╣реА рдореЙрдбрд▓ рдПрдХрд▓-рдкреНрд░реЛрд╕реЗрд╕рд░ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдиреЛрдЯреЗрд╢рди </font></font><code>tf.device</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╕ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЧрдП рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ GPU рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рдореЙрдбрд▓ CPU рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЪрд▓реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдмрд╕ рдЙрд╕ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЖрдк рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдпрд╣ рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рд╣реИ?</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">with</span> tf.device(<span class="hljs-string">'CPU:0'</span>):<font></font>
  cpu_model = build_model(allow_cudnn_kernel=<span class="hljs-literal">True</span>)<font></font>
  cpu_model.set_weights(model.get_weights())<font></font>
  result = tf.argmax(cpu_model.predict_on_batch(tf.expand_dims(sample, <span class="hljs-number">0</span>)), axis=<span class="hljs-number">1</span>)<font></font>
  print(<span class="hljs-string">'Predicted result is: %s, target result is: %s'</span> % (result.numpy(), sample_label))<font></font>
  plt.imshow(sample, cmap=plt.get_cmap(<span class="hljs-string">'gray'</span>))
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RNN рд╕реВрдЪреА / рд╢рдмреНрджрдХреЛрд╢ рдЗрдирдкреБрдЯ, рдпрд╛ рдиреЗрд╕реНрдЯреЗрдб рдЗрдирдкреБрдЯ рдХреЗ рд╕рд╛рде</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдиреЗрд╕реНрдЯреЗрдб рд╕рдВрд░рдЪрдирд╛рдПрдВ рдЖрдкрдХреЛ рдПрдХ рд╕рдордп рдХрджрдо рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡реАрдбрд┐рдпреЛ рдлреНрд░реЗрдо рдореЗрдВ рдПрдХ рд╕рд╛рде рдСрдбрд┐рдпреЛ рдФрд░ рд╡реАрдбрд┐рдпреЛ рдЗрдирдкреБрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдХрд╛ рдЖрдпрд╛рдо рдирд┐рдореНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">[batch, timestep, {\"video\": [height, width, channel], \"audio\": [frequency]}]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рд╕реНрддрд▓рд┐рдЦрд┐рдд рдбреЗрдЯрд╛ рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдХрд▓рдо рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП x рдФрд░ y рджреЛрдиреЛрдВ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА рджрдмрд╛рд╡ рдХреА рдЬрд╛рдирдХрд╛рд░реА рднреА рд╣реЛ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рдбреЗрдЯрд╛ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">[batch, timestep, {\"location\": [x, y], \"pressure\": [force]}]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рдореНрди рдХреЛрдб рдХрд╕реНрдЯрдо RNN рд╕реЗрд▓ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рдВрд░рдЪрд┐рдд рдЗрдирдкреБрдЯ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрд╕реНрдЯреЗрдб рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ</font></font></h3><br>
<pre><code class="python hljs">NestedInput = collections.namedtuple(<span class="hljs-string">'NestedInput'</span>, [<span class="hljs-string">'feature1'</span>, <span class="hljs-string">'feature2'</span>])<font></font>
NestedState = collections.namedtuple(<span class="hljs-string">'NestedState'</span>, [<span class="hljs-string">'state1'</span>, <span class="hljs-string">'state2'</span>])<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NestedCell</span>(<span class="hljs-params">tf.keras.layers.Layer</span>):</span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, unit_1, unit_2, unit_3, **kwargs</span>):</span><font></font>
    self.unit_1 = unit_1<font></font>
    self.unit_2 = unit_2<font></font>
    self.unit_3 = unit_3<font></font>
    self.state_size = NestedState(state1=unit_1, <font></font>
                                  state2=tf.TensorShape([unit_2, unit_3]))<font></font>
    self.output_size = (unit_1, tf.TensorShape([unit_2, unit_3]))<font></font>
    super(NestedCell, self).__init__(**kwargs)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self, input_shapes</span>):</span>
    <span class="hljs-comment"># #  input_shape  2 , [(batch, i1), (batch, i2, i3)]</span>
    input_1 = input_shapes.feature1[<span class="hljs-number">1</span>]<font></font>
    input_2, input_3 = input_shapes.feature2[<span class="hljs-number">1</span>:]<font></font>
<font></font>
    self.kernel_1 = self.add_weight(<font></font>
        shape=(input_1, self.unit_1), initializer=<span class="hljs-string">'uniform'</span>, name=<span class="hljs-string">'kernel_1'</span>)<font></font>
    self.kernel_2_3 = self.add_weight(<font></font>
        shape=(input_2, input_3, self.unit_2, self.unit_3),<font></font>
        initializer=<span class="hljs-string">'uniform'</span>,<font></font>
        name=<span class="hljs-string">'kernel_2_3'</span>)<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">call</span>(<span class="hljs-params">self, inputs, states</span>):</span>
    <span class="hljs-comment">#     [(batch, input_1), (batch, input_2, input_3)]</span>
    <span class="hljs-comment">#     [(batch, unit_1), (batch, unit_2, unit_3)]</span><font></font>
    input_1, input_2 = tf.nest.flatten(inputs)<font></font>
    s1, s2 = states<font></font>
<font></font>
    output_1 = tf.matmul(input_1, self.kernel_1)<font></font>
    output_2_3 = tf.einsum(<span class="hljs-string">'bij,ijkl-&gt;bkl'</span>, input_2, self.kernel_2_3)<font></font>
    state_1 = s1 + output_1<font></font>
    state_2_3 = s2 + output_2_3<font></font>
<font></font>
    output = [output_1, output_2_3]<font></font>
    new_states = NestedState(state1=state_1, state2=state_2_3)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> output, new_states
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрд╕реНрдЯреЗрдб рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд╕рд╛рде рдПрдХ RNN рдореЙрдбрд▓ рдмрдирд╛рдПрдБ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рдПрдХ рдХреЗрд░рд╕ рдореЙрдбрд▓ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдкрд░рдд </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдПрдХ рдХрд╕реНрдЯрдо рд╕реЗрд▓ </font><font style="vertical-align: inherit;">рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЕрднреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="python hljs">unit_1 = <span class="hljs-number">10</span>
unit_2 = <span class="hljs-number">20</span>
unit_3 = <span class="hljs-number">30</span><font></font>
<font></font>
input_1 = <span class="hljs-number">32</span>
input_2 = <span class="hljs-number">64</span>
input_3 = <span class="hljs-number">32</span>
batch_size = <span class="hljs-number">64</span>
num_batch = <span class="hljs-number">100</span>
timestep = <span class="hljs-number">50</span><font></font>
<font></font>
cell = NestedCell(unit_1, unit_2, unit_3)<font></font>
rnn = tf.keras.layers.RNN(cell)<font></font>
<font></font>
inp_1 = tf.keras.Input((<span class="hljs-literal">None</span>, input_1))<font></font>
inp_2 = tf.keras.Input((<span class="hljs-literal">None</span>, input_2, input_3))<font></font>
<font></font>
outputs = rnn(NestedInput(feature1=inp_1, feature2=inp_2))<font></font>
<font></font>
model = tf.keras.models.Model([inp_1, inp_2], outputs)<font></font>
<font></font>
model.compile(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mse'</span>, metrics=[<span class="hljs-string">'accuracy'</span>])unit_1 = <span class="hljs-number">10</span>
unit_2 = <span class="hljs-number">20</span>
unit_3 = <span class="hljs-number">30</span><font></font>
<font></font>
input_1 = <span class="hljs-number">32</span>
input_2 = <span class="hljs-number">64</span>
input_3 = <span class="hljs-number">32</span>
batch_size = <span class="hljs-number">64</span>
num_batch = <span class="hljs-number">100</span>
timestep = <span class="hljs-number">50</span><font></font>
<font></font>
cell = NestedCell(unit_1, unit_2, unit_3)<font></font>
rnn = tf.keras.layers.RNN(cell)<font></font>
<font></font>
inp_1 = tf.keras.Input((<span class="hljs-literal">None</span>, input_1))<font></font>
inp_2 = tf.keras.Input((<span class="hljs-literal">None</span>, input_2, input_3))<font></font>
<font></font>
outputs = rnn(NestedInput(feature1=inp_1, feature2=inp_2))<font></font>
<font></font>
model = tf.keras.models.Model([inp_1, inp_2], outputs)<font></font>
<font></font>
model.compile(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mse'</span>, metrics=[<span class="hljs-string">'accuracy'</span>])
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдбреЗрдЯрд╛ рдкрд░ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЗрд╕ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдЪреНрдЫрд╛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП Numpy рд▓рд╛рдЗрдмреНрд░реЗрд░реА рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="python hljs">input_1_data = np.random.random((batch_size * num_batch, timestep, input_1))<font></font>
input_2_data = np.random.random((batch_size * num_batch, timestep, input_2, input_3))<font></font>
target_1_data = np.random.random((batch_size * num_batch, unit_1))<font></font>
target_2_data = np.random.random((batch_size * num_batch, unit_2, unit_3))<font></font>
input_data = [input_1_data, input_2_data]<font></font>
target_data = [target_1_data, target_2_data]<font></font>
<font></font>
model.fit(input_data, target_data, batch_size=batch_size)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдкрд░рдд рдХреЗ рд╕рд╛рде, </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЕрдиреБрдХреНрд░рдо рдХреЗ рднреАрддрд░ рдПрдХ рдПрдХрд▓ рдЪрд░рдг рдХреЗ рдЧрдгрд┐рддреАрдп рддрд░реНрдХ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдкрд░рдд </font></font><code>tf.keras.layers.RNN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреНрд░рдо рдХреЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЛ рд╕рдВрднрд╛рд▓ рд▓реЗрдЧреАред </font><font style="vertical-align: inherit;">рдпрд╣ рдирдП рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрд░рдПрдирдПрди (рдЬреИрд╕реЗ рдПрд▓рдПрд╕рдЯреАрдПрдо рд╕рдВрд╕реНрдХрд░рдг) рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд░реВрдк рд╕реЗ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рддрд░реАрдХрд╛ рд╣реИред </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд╛рдж, рдЕрдиреБрд╡рд╛рдж Tensorflow.org рдкрд░ рднреА рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рд░реВрд╕реА рдореЗрдВ Tensorflow.org рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЗ рдкреНрд░рд▓реЗрдЦрди рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдпрд╛ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдХрд┐рд╕реА рднреА рд╕реБрдзрд╛рд░ рдФрд░ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреА рд╕рд░рд╛рд╣рдирд╛ рдХреА рдЬрд╛рддреА рд╣реИред</font></font></i></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi487798/index.html">рд╣рдо Oracle JDK рдФрд░ Java Web Start рд╕реЗ AdoptOpenJDK рдФрд░ OpenWebStart рдореЗрдВ рдХреИрд╕реЗ рдЪрд▓реЗ рдЧрдП</a></li>
<li><a href="../hi487800/index.html">рдЖрд╡реЗрджрдХ рдХреЛ рдпрд╣ рдмрддрд╛рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрдпреЛрдВ рд╣реИ рдХрд┐ рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░ рдХреЗ рджреМрд░рд╛рди рдХреНрдпрд╛ рдЧрд▓рдд рд╣реБрдЖ (рдФрд░ рдЗрд╕реЗ рд╕рд╣реА рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП)</a></li>
<li><a href="../hi487802/index.html">рдирд┐рд░реНрдмрд╛рдз рдПрдкреАрд╕реА рд╕реНрдорд╛рд░реНрдЯ рдпреВрдкреАрдПрд╕, рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рдкрдХрд╛рдиреЗ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi487804/index.html">рдЧреНрд░реЛрде рдЯреАрдореНрд╕ рдореАрдЯрдЕрдк рд░рд╛рдпрдлреЗрдиреАрдмреИрдВрдХ рдореЗрдВ</a></li>
<li><a href="../hi487806/index.html">рдПрдХ рдЫреЛрдЯрд╛ Deno API рдмрдирд╛рдирд╛</a></li>
<li><a href="../hi487812/index.html">рдкрд░реАрдХреНрд╖рдг рдкреЛрд▓рд┐рд╢ рдПрд▓рдИрдбреА рд╕реНрдкреЗрдХреНрдЯреНрд░рдо рдПрд▓рдИрдбреА E27</a></li>
<li><a href="../hi487814/index.html">рдЧрддрд┐ рдФрд░ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдЕрдзрд┐рдХ рд╣реИ, рдФрд░ рдХреАрдордд рдХрдо рд╣реИред рдирдИ рдХрд┐рдВрдЧреНрд╕реНрдЯрди KC2000 рдареЛрд╕ рд░рд╛рдЬреНрдп рдбреНрд░рд╛рдЗрд╡</a></li>
<li><a href="../hi487822/index.html">AvitoTech рдСрди рдЯреВрд░: рдирд┐рдЬрд╝рдиреА рдиреЛрд╡рдЧреЛрд░реЛрдб рдореЗрдВ рдПрдВрдбреНрд░реЙрдЗрдб рдореАрдЯрдЕрдк</a></li>
<li><a href="../hi487824/index.html">рдпреВрд░реЛрдк рд╕реЗ рдПрд▓рдИрдбреА рд▓реИрдВрдк рд╕реНрдкреЗрдХреНрдЯреНрд░рдо рдПрд▓рдИрдбреА GU10 рдХрд╛ рдЕрд╡рд▓реЛрдХрди</a></li>
<li><a href="../hi487826/index.html">рдкреЛрд▓реИрдВрдб рд╕реНрдкреЗрдХреНрдЯреНрд░рдо рдПрд▓рдИрдбреА рдИ 14 рд╕реЗ рдПрд▓рдИрдбреА рд▓реИрдВрдк рдХрд╛ рдЕрд╡рд▓реЛрдХрди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>