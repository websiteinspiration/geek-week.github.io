<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÅ üëèüèæ üë©üèæ‚Äçüè≠ Apprentissage automatique: par o√π commencer ou comment construire le premier mod√®le üóª ü§∞üèΩ üë®üèº‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En tant que premi√®re t√¢che de l'apprentissage automatique, nous prenons quelque chose de clair et simple, par exemple, une pr√©vision du co√ªt du logeme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apprentissage automatique: par o√π commencer ou comment construire le premier mod√®le</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505516/"><img src="https://habrastorage.org/webt/cn/mg/fr/cnmgfrvs-ej5ldlqz9cmmdjdcrk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que premi√®re t√¢che de l'apprentissage automatique, nous prenons quelque chose de clair et simple, par exemple, une pr√©vision du co√ªt du logement. L'ensemble de donn√©es pr√™t peut √™tre trouv√© sur le site Web de kaggle. Dans les premi√®res √©tapes de la formation, vous ne devez pas prendre d'ensembles de donn√©es avec un grand nombre de variables, par exemple, "Prix des maisons: Techniques de r√©gression avanc√©es" comprend 80 variables et r√©gression avanc√©e, nous nous arr√™terons √† "Ventes de maisons dans le comt√© de King, √âtats-Unis" avec 21 param√®tres. T√©l√©chargez les donn√©es et analysez la description fournie. Date disponible, prix, nombre de chambres, salles de bains, surface totale et habitable, nombre d'√©tages, √©valuation de la vue, vue sur la mer, √©valuation de l'√©tat g√©n√©ral, grade (√©valuation de la construction et de la conception), surface au-dessus et en dessous du niveau du sol, ann√©e de construction, derni√®re ann√©e r√©paration, indicatif r√©gional, coordonn√©es (longitude et latitude), donn√©es sur la superficie des maisons de 15 voisins.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc choisi une t√¢che et sommes pr√™ts √† commencer √† la r√©soudre. La solution comprendra deux √©tapes: l'analyse des donn√©es et la construction du mod√®le. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Travaillez avec les donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âcartons-nous et notons s√©par√©ment l'importance de l'analyse des donn√©es. Actuellement, tous les algorithmes plus ou moins populaires sont d√©j√† √©crits sous forme de biblioth√®ques et la construction directe du mod√®le est r√©duite √† plusieurs lignes de code, par exemple, k-voisins les plus proches de sklearn en python:</font></font><a name="habracut"></a><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn .neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<font></font>
clf_KNN = KNeighborsClassifier()       <span class="hljs-comment"># </span>
clf_KNN.fit(X_train, Y_train)          <span class="hljs-comment"># </span>
Y_KNN = clf_KNN.predict(X_test)        <span class="hljs-comment">#    </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seulement quatre lignes de code pour obtenir le r√©sultat. Quelle est donc la difficult√©? La difficult√© r√©side dans l'obtention du tr√®s X_train - les donn√©es qui sont fournies √† l'entr√©e du mod√®le. Le principe bien connu ¬´garbage in¬ª = ¬´garbage in¬ª (Eng. Garbage in - garbage out (GIGO)) dans la mod√©lisation fonctionne √† plus de 100% et la qualit√© de la solution obtenue au probl√®me d'apprentissage automatique d√©pendra largement du travail avec les donn√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant - √† la bataille! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'analyse des donn√©es, nous utiliserons des pandas, pour comprendre et √©valuer ¬´√† l'≈ìil¬ª, nous utilisons des graphiques simples de seaborn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous importons les biblioth√®ques, lisons les donn√©es, d√©rivons plusieurs enregistrements du tableau de donn√©es, examinons les types de donn√©es et leurs omissions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code et sortie</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<font></font>
df = pd.read_csv(<span class="hljs-string">'‚Ä¶/train.csv'</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/1q/cy/og/1qcyogx0fmdgtibrhx1l2b5mdty.png"><br>
<br>
<pre><code class="python hljs">df.info()</code></pre><br>
<pre><code class="plaintext hljs">RangeIndex: 21613 entries, 0 to 21612<font></font>
Data columns (total 21 columns):<font></font>
id 21613 non-null int64<font></font>
date 21613 non-null object<font></font>
price 21613 non-null float64<font></font>
bedrooms 21613 non-null int64<font></font>
bathrooms 21613 non-null float64<font></font>
sqft_living 21613 non-null int64<font></font>
sqft_lot 21613 non-null int64<font></font>
floors 21613 non-null float64<font></font>
waterfront 21613 non-null int64<font></font>
view 21613 non-null int64<font></font>
condition 21613 non-null int64<font></font>
grade 21613 non-null int64<font></font>
sqft_above 21613 non-null int64<font></font>
sqft_basement 21613 non-null int64<font></font>
yr_built 21613 non-null int64<font></font>
yr_renovated 21613 non-null int64<font></font>
zipcode 21613 non-null int64<font></font>
lat 21613 non-null float64<font></font>
long 21613 non-null float64<font></font>
sqft_living15 21613 non-null int64<font></font>
sqft_lot15 21613 non-null int64<font></font>
dtypes: float64(5), int64(15), object(1)<font></font>
memory usage: 3.5+ MB</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le tableau de donn√©es se compose de 21613 enregistrements sans lacunes dans les donn√©es et contient une seule date de champ de texte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous travaillerons avec chaque signe plus en d√©tail et commencerons par le plus simple - jetez l'identifiant (ne contient pas d'informations utiles), le code postal (le code de la zone o√π se trouve la maison) et les coordonn√©es (lat et long), car nous ne nous familiarisons qu'avec l'apprentissage automatique et la conversion correcte de la g√©ographie Les donn√©es sont trop sp√©cifiques pour un sp√©cialiste d√©butant.</font></font><br>
<br>
<pre><code class="python hljs">df=df.drop([<span class="hljs-string">'id'</span>,<span class="hljs-string">'zipcode'</span>,<span class="hljs-string">'lat'</span>,<span class="hljs-string">'long'</span>], axis=<span class="hljs-number">1</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant la date de l'annonce. Le format de date est d√©fini sur YYYYMMDDTT000000, en g√©n√©ral, il peut √©galement √™tre supprim√© du jeu de donn√©es, mais nous avons les champs ann√©e de construction (yr_built) et derni√®re ann√©e de r√©paration (yr_renovated), qui sont sp√©cifi√©s au format ann√©e (YYYY), ce qui n'est pas tr√®s informatif. En utilisant la date d'annonce, vous pouvez convertir l'ann√©e en √¢ge par soustraction (ann√©e d'annonce - ann√©e de construction / ann√©e de r√©paration). Nous notons que l'ann√©e de r√©paration est 0 pour certaines maisons, et en supposant que cela signifie qu'il n'y a pas de r√©paration du b√¢timent, nous rempla√ßons les z√©ros de l'ann√©e de r√©paration par l'ann√©e de construction, en nous assurant d'abord que les donn√©es ne contiennent pas d'enregistrements incorrects lorsque l'ann√©e de r√©paration est inf√©rieure √† l'ann√©e de construction:</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">'yr_renovated'</span>]&lt;df[<span class="hljs-string">'yr_built'</span>])&amp;df[<span class="hljs-string">'yr_renovated'</span>]!=<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/l7/wo/ii/l7woii1rk3buxzexbab2i4uokmq.png"><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'yr_renovated'</span>]==<span class="hljs-number">0</span>, [<span class="hljs-string">'yr_renovated'</span>]]=df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_built'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_built'</span>]<font></font>
df[<span class="hljs-string">'yr_renovated'</span>]=df[<span class="hljs-string">'date'</span>].str[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>].astype(int)-df[<span class="hljs-string">'yr_renovated'</span>]<font></font>
df=df.drop(<span class="hljs-string">'date'</span>, axis=<span class="hljs-number">1</span>)<font></font>
df.head(<span class="hljs-number">5</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4z/za/uw/4zzauwyidq18e0lq_8x5-up5e88.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous analyserons le prix avec le param√®tre suivant et utiliserons le ¬´Box plot¬ª pour cela. Une bo√Æte √† moustache est un graphique simple et pratique montrant une distribution de probabilit√© unidimensionnelle ou, plus simplement, la concentration des donn√©es. Dessine la m√©diane (ligne au centre), les quartiles sup√©rieur et inf√©rieur (c√¥t√©s de la bo√Æte), les bords de l'√©chantillon statistiquement significatif ("moustache") et les valeurs aberrantes (points derri√®re la "moustache"). Il est facile √† comprendre √† partir de l'image sur la distribution normale (√† droite). Le graphique vous permet d'√©valuer rapidement o√π se trouvent la plupart des donn√©es (50% sont √† l'int√©rieur de la bo√Æte), leur sym√©trie (le d√©calage m√©dian d'un c√¥t√© de la bo√Æte et / ou la longueur de la "moustache") et le degr√© de dispersion - variance (taille de la bo√Æte, taille de la moustache et nombre de points - √©missions).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/bh/uw/bibhuwyeeexpszcl7sahfpdo8le.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est possible de construire une distribution de cette caract√©ristique uniquement sur l'ensemble du tableau, mais il sera plus informatif d'utiliser 2 axes - par exemple, le prix et le nombre de chambres, qui √† leur tour montrera √©galement la pr√©sence d'une connexion entre les signes:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'price'</span>, data=df)			<span class="hljs-comment"># price</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)	<span class="hljs-comment">#price &amp; bedrooms</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prix ‚Äã‚Äãet chambres: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/oh/ta/zaohtajsfsedoz8lagkzjto-oa0.png"><br>
<br>
<img src="https://habrastorage.org/webt/fn/em/4g/fnem4gwwbubwzkrhi25i4ly3j4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le graphique montre imm√©diatement la pr√©sence de valeurs extr√™mes de prix et de chambres (imaginez une maison avec 33 chambres! J). La pr√©sence de telles valeurs (autrement appel√©es valeurs aberrantes) dans le prix cible de l'attribut conduit souvent √† un recyclage du mod√®le, car elles donneront une grosse erreur, que les algorithmes tentent de minimiser. On peut voir sur le graphique que la majorit√© (si calcul√©e - 93,22%) se situe dans la plage de 0-1mn, et sur 2 mln - seulement 198 valeurs (0,92%). Vous pouvez vous d√©barrasser de 1% de l'ensemble de donn√©es presque sans douleur, donc, apr√®s avoir appel√© une simple visualisation de 217 enregistrements, apr√®s les avoir tri√©s par prix, nous verrons le prix souhait√© de 19655000 et supprimer tout ce qui est sup√©rieur √† ce prix.</font></font><br>
<br>
<pre><code class="python hljs">df.sort_values (by=<span class="hljs-string">'price'</span>, ascending=<span class="hljs-literal">False</span>).head(<span class="hljs-number">217</span>) <font></font>
df=df[df[<span class="hljs-string">'price'</span>]&lt;=<span class="hljs-number">1965000</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R√©fl√©chissons un peu au signe des chambres. </font><font style="vertical-align: inherit;">Nous voyons 13 maisons avec chambres = 0, ainsi qu'un √©trange record d'une maison avec 33 chambres. </font><font style="vertical-align: inherit;">Nous ferons la m√™me chose que pour le prix, en supprimant les z√©ros des chambres (et des salles de bain en m√™me temps):</font></font><br>
<br>
<pre><code class="python hljs">df=df[(df[<span class="hljs-string">'bedrooms'</span>]!=<span class="hljs-number">0</span>)&amp;(df[<span class="hljs-string">'bathrooms'</span>]!=<span class="hljs-number">0</span>)]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ce qui concerne la maison avec 33 chambres - compte tenu du prix, nous pouvons supposer qu'il s'agit d'une faute de frappe et que les chambres sont en fait 3. Comparons la surface habitable de cette maison (1620) avec la surface habitable moyenne des maisons de 3 chambres (1798.2), ce qui est probablement notre supposition, par cons√©quent, remplacez simplement cette valeur par 3 et g√©n√©rez √† nouveau le diagramme √† cases pr√©c√©dent:</font></font><br>
<br>
<pre><code class="python hljs">df.loc[df[<span class="hljs-string">'bedrooms'</span>]==<span class="hljs-number">33</span>,[<span class="hljs-string">'bedrooms'</span>]]=<span class="hljs-number">3</span> 
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/qi/wd/fs/qiwdfscthapolbucfyjqy-uoggc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, beaucoup mieux. </font><font style="vertical-align: inherit;">De m√™me, les chambres regardent les salles de bains. </font><font style="vertical-align: inherit;">Nous avons supprim√© les valeurs nulles, il n'y a pas d'autres valeurs extr√™mes dans le champ:</font></font><br>
<br>
<pre><code class="python hljs">sns.boxplot(y=<span class="hljs-string">'bathrooms'</span>, x=<span class="hljs-string">'bedrooms'</span>, data=df)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les champs sqft_living, √©tages, front de mer, vue, √©tat, grade, sqft_living15 √©galement toutes les valeurs sont plus ou moins r√©elles, nous ne les toucherons pas:</font></font><br>
<br>
<pre><code class="python hljs">plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">2</span>,<span class="hljs-number">3</span> 			<span class="hljs-comment"># </span>
sns.boxplot(y=<span class="hljs-string">'sqft_living'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'floors'</span>,color=<span class="hljs-string">'#2ecc71'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'sqft_living15'</span>,color=<span class="hljs-string">'#9b59b6'</span>, data=df) <font></font>
plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">4</span>,<span class="hljs-number">4</span>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'waterfront'</span>, data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'view'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'condition'</span> , data=df)<font></font>
sns.boxplot(y=<span class="hljs-string">'price'</span>, x=<span class="hljs-string">'grade'</span> , data=df)</code></pre><br>
<img src="https://habrastorage.org/webt/oq/uw/h8/oquwh8x-cln4tbaz9xrzqyk9szs.png"><br>
<br>
<img src="https://habrastorage.org/webt/yl/ns/bz/ylnsbzq_kx2dtvrvjy8iytxudve.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais avec sqft_lot et sqft_lot15, vous devez trouver quelque chose et en raison des grandes valeurs, le logarithme est tout √† fait appropri√©:</font></font><br>
<br>
<pre><code class="python hljs">df[<span class="hljs-string">'sqft_lot'</span>]=np.log(df[<span class="hljs-string">'sqft_lot'</span>])<font></font>
df[<span class="hljs-string">'sqft_lot15'</span>]=np.log(df[<span class="hljs-string">'sqft_lot15'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_lot avant et apr√®s: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yr/up/g2/yrupg24jwmfsptci9hf8uaq6wmu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sqft_above et sqft_basement sont des composants de sqft_living, nous ne les toucherons donc pas non plus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cela, nous terminerons par une analyse pr√©liminaire et examinerons la carte thermique des corr√©lations:</font></font><br>
<br>
<pre><code class="python hljs">sns.heatmap(df.corr(),  cmap = <span class="hljs-string">'viridis'</span>,annot = <span class="hljs-literal">True</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/ny/yi/uq/nyyiuqa9zbilc9l6gqzljfe35xu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir examin√© la carte de corr√©lation, nous constatons que parfois les attributs sont fortement corr√©l√©s les uns avec les autres, nous supprimons donc certains des attributs avec une forte corr√©lation - sqft_lot15 (laissez sqft_lot), yr_built (laissez yr_renovated), sqft_above (sqft_living). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci termine le travail avec les donn√©es et proc√®de √† la cr√©ation du mod√®le. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Mod√©lisation </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette partie, nous allons construire 2 mod√®les: r√©gression lin√©aire et arbre de d√©cision. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les mod√®les dont nous avons besoin sont contenus dans la biblioth√®que sklearn. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premi√®rement, nous s√©parons la variable cible du reste des donn√©es pour la formation, et divisons √©galement les √©chantillons en formation (70%) et test (30%, sur lesquels nous v√©rifierons le fonctionnement du mod√®le):</font></font><br>
<br>
<pre><code class="python hljs">Y=df[<span class="hljs-string">'price'</span>]<font></font>
X=df.drop (<span class="hljs-string">'price'</span>,axis=<span class="hljs-number">1</span>) 
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<font></font>
X_train, X_test, Y_train, Y_test  = train_test_split(X, Y, test_size = <span class="hljs-number">0.3</span>, shuffle = <span class="hljs-literal">True</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, √† partir de sklearn, pour √©valuer le mod√®le, nous t√©l√©chargeons 3 mesures: mean_absolute_error (erreur absolue moyenne), mean_squared_error (√©cart-type), r2_score (coefficient de d√©termination):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_absolute_error, mean_squared_error, r2_score</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par la r√©gression lin√©aire:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression<font></font>
LR = LinearRegression() 				<span class="hljs-comment"># </span>
LR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_LR = LR.predict(X_test)				<span class="hljs-comment">#       </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_LR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_LR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_LR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 124477.452 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 175205.645 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.627 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arbre de </font><font style="vertical-align: inherit;">d√©cision </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor<font></font>
TR = DecisionTreeRegressor()				<span class="hljs-comment"># </span>
TR.fit(X_train, Y_train)				<span class="hljs-comment"># </span>
Y_TR=TR.predict(X_test)  				<span class="hljs-comment">#   </span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'MAE:'</span>, round (mean_absolute_error(Y_test, Y_TR),<span class="hljs-number">3</span>))		<span class="hljs-comment">#</span>
<span class="hljs-keyword">print</span> (<span class="hljs-string">'‚àöMSE:'</span>, round (mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>),<span class="hljs-number">3</span>))
<span class="hljs-keyword">print</span> (<span class="hljs-string">'R2_score:'</span>, round (r2_score(Y_test, Y_TR),<span class="hljs-number">3</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAE: 151734.906 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚àöMSE 220856.721 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
R2_score: 0.407 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base des m√©triques, nous pouvons conclure que la r√©gression lin√©aire a montr√© le meilleur r√©sultat, il est donc plus logique de le choisir. Cependant, nous n'avons pas demand√© en quoi consiste l'erreur de mod√®le, si le mod√®le est recycl√©, etc. Il est fort probable que ce soit un recyclage qui a conduit √† la d√©t√©rioration du r√©sultat de DecisionTreeRegressor, car nous n'avons m√™me pas limit√© la profondeur de l'arbre dans les param√®tres du mod√®le. Nous pouvons facilement v√©rifier cela en triant la profondeur des arbres dans un cycle court:</font></font><br>
<br>
<pre><code class="python hljs">dep,score=[],[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>,<span class="hljs-number">16</span>):<font></font>
    TR = DecisionTreeRegressor(max_depth=i)<font></font>
    TR.fit(X_train, Y_train)<font></font>
    Y_TR=TR.predict(X_test)<font></font>
    dep.append(i)<font></font>
    score.append(mean_squared_error(Y_test, Y_TR)**(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>))	<span class="hljs-comment">#  ‚àöMSE</span>
		plt.rcParams[<span class="hljs-string">'figure.figsize'</span>]=<span class="hljs-number">6</span>,<span class="hljs-number">3</span>
		plt.plot(dep, score)</code></pre><br>
<img src="https://habrastorage.org/webt/ar/fn/yt/arfnytm068lhpknk_ifnpshupgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âvidemment, le meilleur indicateur est √† max_depth = 7, et, en regardant les m√©triques (MAE: 124861.441, ‚àöMSE 175322.737, R2_score: 0.626), il devient clair qu'un mod√®le avec une telle restriction est similaire √† une r√©gression lin√©aire de la qualit√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons √©galement essayer d'√©valuer quels attributs √©taient les plus importants pour le mod√®le de pr√©vision des co√ªts: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x1/qx/qw/x1qxqwlhqbfotpp45hhyr4nz0uc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sur la base du graphique, il est clair que la note affecte le plus le co√ªt - une √©valuation subjective g√©n√©rale de la maison par la soci√©t√© immobili√®re (qui, en passant, indique la comp√©tence de l'√©valuation :-))), en deuxi√®me place se trouve la surface de la maison et en troisi√®me - l'ann√©e de la derni√®re r√©paration. Les indicateurs ont consid√©r√© le nombre de chambres, salles de bains, √©tages que le mod√®le consid√©rait comme non significatif pour la pr√©vision.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mieux comprendre les r√©sultats, nous calculons l'erreur moyenne en% - selon la r√©gression lin√©aire, l'erreur moyenne est de 27,5%, c'est-√†-dire que le mod√®le fait un peu plus d'erreur qu'un quart lors de la pr√©vision du co√ªt d'une maison, ce qui est beaucoup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les r√©sultats peuvent-ils √™tre am√©lior√©s? </font><font style="vertical-align: inherit;">Oui, bien s√ªr, au stade actuel, nous n'avons re√ßu qu'une solution de base - un point de d√©part pour la comparaison sera des mod√®les meilleurs ou pires que nous pouvons cr√©er avec des m√©thodes plus sophistiqu√©es ou en utilisant un traitement de donn√©es plus complexe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous n'avons abord√© que l√©g√®rement la question du recyclage et n'avons pas du tout abord√© en quoi consiste l'erreur de mod√®le et de nombreux autres aspects de la cr√©ation de mod√®le. </font><font style="vertical-align: inherit;">En r√®gle g√©n√©rale, diff√©rentes m√©thodes de validation de mod√®le sont utilis√©es pour r√©pondre √† ces questions et trouver la solution optimale, mais nous √©crirons √† ce sujet dans les articles suivants.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr505498/index.html">Comment nous r√©solvons le probl√®me de la m√©moire de pile non initialis√©e dans Windows</a></li>
<li><a href="../fr505502/index.html">Omnicanal dans le service client: que rechercher et comment tout faire correctement?</a></li>
<li><a href="../fr505506/index.html">Il ne mord pas: comment rendre les robots industriels s√ªrs pour les travailleurs</a></li>
<li><a href="../fr505508/index.html">Non seulement la technologie sans pilote: l'avenir de l'industrie automobile</a></li>
<li><a href="../fr505510/index.html">Rationalisation de l'API Check Point avec le SDK Python</a></li>
<li><a href="../fr505522/index.html">Mon√©tisation dans les jeux en ligne: comment utiliser l'exp√©rience de quelqu'un d'autre pour vos propres besoins</a></li>
<li><a href="../fr505528/index.html">La chose la plus importante dans le Wi-Fi 6. Non, s√©rieusement</a></li>
<li><a href="../fr505530/index.html">Google fabrique son processeur et AMD s'appr√™te √† d√©truire Qualcomm</a></li>
<li><a href="../fr505532/index.html">Cha√Ænes de t√©l√©gramme sur le d√©veloppement de jeux: partie 2</a></li>
<li><a href="../fr505536/index.html">Comment cuisiner le suivi des appels: l'exp√©rience cyan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>