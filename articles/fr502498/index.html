<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õèÔ∏è üòì üê∑ Meilleures pratiques pour am√©liorer les performances en C # üîú üéè üëÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. Nous avons pr√©par√© une traduction d'un autre mat√©riel utile √† la veille du d√©but du cours "D√©veloppeur C #" . Bonne lecture.
 
 
 
 De...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Meilleures pratiques pour am√©liorer les performances en C #</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/502498/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour √† tous. </font><font style="vertical-align: inherit;">Nous avons pr√©par√© une traduction d'un autre mat√©riel utile √† la veille du d√©but du cours </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"D√©veloppeur C #"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bonne lecture.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/q4/xs/kv/q4xskv5-ia4gfwlhgm1hx5e1gdc.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis que j'ai r√©cemment fait une liste des meilleures pratiques en C # pour Criteo, j'ai pens√© que ce serait bien de la partager publiquement. Le but de cet article est de fournir une liste incompl√®te de mod√®les de code √† √©viter, soit parce qu'ils sont discutables, soit parce qu'ils fonctionnent mal. La liste peut sembler un peu al√©atoire, car elle est l√©g√®rement hors contexte, mais </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tous</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ses √©l√©ments ont √©t√© trouv√©s dans notre code √† un moment donn√© et ont caus√© des probl√®mes de production. J'esp√®re que cela servira de bonne pr√©vention et √©vitera vos erreurs √† l'avenir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez √©galement que les services Web Criteo reposent sur du code haute performance, d'o√π la n√©cessit√© d'√©viter un code inefficace. Dans la plupart des applications, il n'y aura pas de diff√©rence tangible notable par rapport au remplacement de certains de ces mod√®les.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin et surtout, certains points (par exemple </font></font><code>ConfigureAwait</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ont d√©j√† √©t√© abord√©s dans de nombreux articles, je ne m'√©tendrai donc pas sur eux en d√©tail. </font><font style="vertical-align: inherit;">L'objectif est de former une liste compacte de points auxquels vous devez pr√™ter attention, et non de donner un calcul technique d√©taill√© pour chacun d'eux.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attente synchrone de code asynchrone</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne vous attendez jamais √† des t√¢ches inachev√©es de mani√®re synchrone. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela vaut, mais ne se </font><font style="vertical-align: inherit;">limite pas √†: </font></font><code>Task.Wait, Task.Result, Task.GetAwaiter().GetResult(), Task.WaitAny, Task.WaitAll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral: toute relation synchrone entre deux threads de pool peut entra√Æner l'√©puisement du pool. </font><font style="vertical-align: inherit;">Les causes de ce ph√©nom√®ne sont d√©crites dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cet article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConfigureAwait</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si votre code peut √™tre appel√© √† partir d'un contexte de synchronisation, utilisez-le </font></font><code>ConfigureAwait(false)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour chacun de vos appels en attente. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que cela n'est </font></font><code>ConfigureAwait</code> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utile que lorsque vous utilisez un mot cl√© </font></font><code>await</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, le code suivant n'a pas de sens:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">//  ConfigureAwait        </span>
<span class="hljs-keyword">var</span> result = ProcessAsync().ConfigureAwait(<span class="hljs-literal">false</span>).GetAwaiter().GetResult();</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async void</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne jamais utiliser</font></font><code>async void</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'exception lev√©e dans la </font></font><code>async void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©thode se propage au contexte de synchronisation et provoque g√©n√©ralement le blocage de l'application enti√®re. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous ne pouvez pas renvoyer la t√¢che dans votre m√©thode (par exemple, parce que vous impl√©mentez l'interface), d√©placez le code asynchrone vers une autre m√©thode et appelez-la:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">interface</span> <span class="hljs-title">IInterface</span><font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DoSomething</span>(<span class="hljs-params"></span>)</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">class</span> <span class="hljs-title">Implementation</span> : <span class="hljs-title">IInterface</span><font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoSomething</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        <span class="hljs-comment">//      ,</span>
        <span class="hljs-comment">//      </span><font></font>
        _ = DoSomethingAsync();<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DoSomethingAsync</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">100</span>);<font></font>
    }<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez l'async autant que possible </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par habitude ou √† cause de la m√©moire musculaire, vous pouvez √©crire quelque chose comme:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">CallAsync</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> Client();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> client.GetAsync();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que le code soit s√©mantiquement correct, l'utilisation d'un mot cl√© </font></font><code>async</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'est pas n√©cessaire ici et peut entra√Æner une surcharge importante dans un environnement tr√®s charg√©. </font><font style="vertical-align: inherit;">Essayez de l'√©viter autant que possible:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">CallAsync</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> Client();
    <span class="hljs-keyword">return</span> _client.GetAsync();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, gardez √† l'esprit que vous ne pouvez pas recourir √† cette optimisation lorsque votre code est encapsul√© dans des blocs (par exemple, </font></font><code> try/catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>using</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Correct</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> Client())<font></font>
    {<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> client.GetAsync();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">Incorrect</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> Client())<font></font>
    {<font></font>
        <span class="hljs-keyword">return</span> client.GetAsync();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la mauvaise version ( </font></font><code>Incorrect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), le client peut √™tre supprim√© avant la fin de l' </font></font><code>GetAsync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appel, car la t√¢che √† l'int√©rieur du bloc using n'est pas attendue par wait.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparaisons r√©gionales</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez aucune raison d'utiliser des comparaisons r√©gionales, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisez toujours des comparaisons ordinales</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bien qu'en raison des optimisations internes, cela n'a pas beaucoup d'importance pour les formulaires de pr√©sentation des donn√©es en-US, la comparaison est un ordre de grandeur plus lent pour les formulaires de pr√©sentation des autres r√©gions (et jusqu'√† deux ordres de grandeur sur Linux!). </font><font style="vertical-align: inherit;">√âtant donn√© que la comparaison de cha√Ænes est une op√©ration fr√©quente dans la plupart des applications, la surcharge augmente consid√©rablement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ConcurrentBag </font></font><code>&lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font><code>&gt;</code></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne jamais utiliser </font></font><code><code>ConcurrentBag&lt;</code>T&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans analyse comparative</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cette collection a √©t√© con√ßue pour des cas d'utilisation tr√®s sp√©cifiques (lorsque la plupart du temps l'√©l√©ment est exclu de la file d'attente par le thread qui l'a mis en file d'attente) et souffre de graves probl√®mes de performances s'il est utilis√© √† d'autres fins. Si vous avez </font><font style="vertical-align: inherit;">besoin d' </font><font style="vertical-align: inherit;">une collection thread-safe, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©f√®rent ConcurrentQueue </font></font><code>&lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font><code>&gt;</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReaderWriterLock / ReaderWriterLockSlim </font></font><code>&lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font><code>&gt;</code><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne jamais utiliser </font><font style="vertical-align: inherit;">sans analyse comparative. </font></font><code><code>ReaderWriterLock&lt;T&gt;</code>/ReaderWriterLockSlim&lt;T<code>&gt;</code></code><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien que l'utilisation de ce type de primitive de synchronisation sp√©cialis√©e lorsque vous travaillez avec des lecteurs et des √©crivains puisse √™tre tentante, son co√ªt est beaucoup plus √©lev√© que le simple </font></font><code>Monitor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(utilis√© avec le mot-cl√© </font></font><code>lock</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Si le nombre de lecteurs ex√©cutant la section critique en m√™me temps n'est pas tr√®s √©lev√©, la simultan√©it√© ne sera pas suffisante pour absorber la surcharge accrue et le code fonctionnera moins bien.</font></font><br>
<br>
</h3><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©f√©rez les fonctions lambda au lieu des groupes de m√©thodes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez le code suivant:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetItems</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> _list.Where(i =&gt; Filter(i));<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Filter</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> element</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resharper sugg√®re de r√©√©crire du code sans fonction lambda, ce qui pourrait sembler un peu plus propre:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetItems</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> _list.Where(Filter);<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Filter</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> element</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malheureusement, cela conduit √† l'allocation de m√©moire dynamique pour chaque appel. </font><font style="vertical-align: inherit;">En fait, l'appel se compile comme:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetItems</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> _list.Where(<span class="hljs-keyword">new</span> Predicate&lt;<span class="hljs-keyword">int</span>&gt;(Filter));<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Filter</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> element</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela peut avoir un impact significatif sur les performances si le code est appel√© dans une section fortement charg√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation des fonctions lambda d√©marre l'optimisation du compilateur, qui met en cache le d√©l√©gu√© dans un champ statique, en √©vitant l'allocation. </font><font style="vertical-align: inherit;">Cela ne fonctionne que si </font></font><code>Filter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statique. </font><font style="vertical-align: inherit;">Sinon, vous pouvez mettre en cache le d√©l√©gu√© vous-m√™me:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> Predicate&lt;<span class="hljs-keyword">int</span>&gt; _filter;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Constructor</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    _filter = <span class="hljs-keyword">new</span> Predicate&lt;<span class="hljs-keyword">int</span>&gt;(Filter);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerable&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetItems</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> _list.Where(_filter);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">Filter</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> element</span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertir les √©num√©rations en cha√Ænes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L' appel </font></font><code>Enum.ToString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en </font></font><code>.net</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est assez cher, parce que la </font><font style="vertical-align: inherit;">r√©flexion est utilis√© pour convertir l' </font><font style="vertical-align: inherit;">int√©rieur, et appelant la m√©thode virtuelle sur la structure provoque emballage. </font><font style="vertical-align: inherit;">Cela devrait √™tre √©vit√© autant que possible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les √©num√©rations peuvent souvent √™tre remplac√©es par des cha√Ænes constantes:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">//       Numbers.One, Numbers.Two, ...</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Numbers<font></font>
{<font></font>
    One,<font></font>
    Two,<font></font>
    Three<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Numbers</span><font></font>
{<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">string</span> One = <span class="hljs-string">"One"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">string</span> Two = <span class="hljs-string">"Two"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">string</span> Three = <span class="hljs-string">"Three"</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous devez vraiment utiliser une √©num√©ration, pensez √† mettre en cache la valeur convertie dans un dictionnaire pour amortir les frais g√©n√©raux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparaison d'√©num√©ration</font></font></h2><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque: cela n'est plus pertinent dans le noyau .net, depuis la version 2.1, l'optimisation est effectu√©e automatiquement par JIT.</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous utilisez des √©num√©rations comme indicateurs, il peut √™tre tentant d'utiliser la m√©thode </font></font><code>Enum.HasFlag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">Flags</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Options<font></font>
{<font></font>
    Option1 = <span class="hljs-number">1</span>,<font></font>
    Option2 = <span class="hljs-number">2</span>,<font></font>
    Option3 = <span class="hljs-number">4</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> Options _option;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsOption2Enabled</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> _option.HasFlag(Options.Option2);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce code provoque deux packages avec allocation: un pour la conversion </font></font><code>Options.Option2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en </font></font><code>Enum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et l'autre pour un appel virtuel </font></font><code>HasFlag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour la structure. </font><font style="vertical-align: inherit;">Cela rend ce code excessivement cher. </font><font style="vertical-align: inherit;">Au lieu de cela, vous devez sacrifier la lisibilit√© et utiliser des op√©rateurs binaires:</font></font><br>
 <br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsOption2Enabled</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">return</span> (_option &amp; Options.Option2) == Options.Option2;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise en place de m√©thodes de comparaison des structures</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous utilisez une structure dans des comparaisons (par exemple, lorsqu'elle est utilis√©e comme cl√© pour un dictionnaire), vous devez remplacer les m√©thodes </font></font><code>Equals/GetHashCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">L'impl√©mentation par d√©faut utilise la r√©flexion et est tr√®s lente. </font><font style="vertical-align: inherit;">L'impl√©mentation g√©n√©r√©e par Resharper est g√©n√©ralement assez bonne. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez en savoir plus √† ce sujet ici: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devblogs.microsoft.com/premier-developer/performance-implications-of-default-struct-equality-in-c</font></font></a></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvitez les emballages inappropri√©s lorsque vous utilisez des structures avec des interfaces</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez le code suivant:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IntValue</span> : <span class="hljs-title">IValue</span><font></font>
{<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoStuff</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">value</span> = <span class="hljs-keyword">new</span> IntValue();<font></font>
<font></font>
    LogValue(<span class="hljs-keyword">value</span>);<font></font>
    SendValue(<span class="hljs-keyword">value</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SendValue</span>(<span class="hljs-params">IValue <span class="hljs-keyword">value</span></span>)</span><font></font>
{<font></font>
    <span class="hljs-comment">// ...</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogValue</span>(<span class="hljs-params">IValue <span class="hljs-keyword">value</span></span>)</span><font></font>
{<font></font>
    <span class="hljs-comment">// ...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rendre </font></font><code>IntValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">structur√© peut √™tre tentant d'√©viter d'allouer de la m√©moire dynamique. </font><font style="vertical-align: inherit;">Mais puisque l' </font><font style="vertical-align: inherit;">interface est </font></font><code>AddValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>SendValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont attendues, et que les interfaces ont une s√©mantique de r√©f√©rence, la valeur sera emball√©e √† chaque appel, annulant les avantages de cette "optimisation". </font><font style="vertical-align: inherit;">En fait, il y aura encore plus d'allocations de m√©moire que s'il </font></font><code>IntValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'agissait d'une classe, car la valeur sera mise en package ind√©pendamment pour chaque appel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous √©crivez une API et que certaines valeurs sont des structures, essayez d'utiliser des m√©thodes g√©n√©riques:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> IntValue : IValue<font></font>
{<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoStuff</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">value</span> = <span class="hljs-keyword">new</span> IntValue();<font></font>
<font></font>
    LogValue(<span class="hljs-keyword">value</span>);<font></font>
    SendValue(<span class="hljs-keyword">value</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> SendValue&lt;T&gt;(T <span class="hljs-keyword">value</span>) <span class="hljs-keyword">where</span> T : IValue<font></font>
{<font></font>
    <span class="hljs-comment">// ...</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> LogValue&lt;T&gt;(T <span class="hljs-keyword">value</span>) <span class="hljs-keyword">where</span> T : IValue<font></font>
{<font></font>
    <span class="hljs-comment">// ...</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que la conversion de ces m√©thodes en universelles semble inutile √† premi√®re vue, elle permet en fait d'√©viter le packaging avec allocation dans le cas o√π il </font></font><code>IntValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'agit d'une structure.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abonnements CancellationToken toujours en ligne</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous annulez </font></font><code>CancellationTokenSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tous les abonnements seront ex√©cut√©s dans le thread actuel. </font><font style="vertical-align: inherit;">Cela peut entra√Æner des pauses impr√©vues ou m√™me des blocages implicites.</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">var</span> cts = <span class="hljs-keyword">new</span> CancellationTokenSource();<font></font>
cts.Token.Register(() =&gt; Thread.Sleep(<span class="hljs-number">5000</span>));<font></font>
cts.Cancel(); <span class="hljs-comment">//     5 </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous ne pouvez pas √©chapper √† ce comportement. </font><font style="vertical-align: inherit;">Par cons√©quent, lors de l'annulation </font></font><code>CancellationTokenSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, demandez-vous si vous pouvez autoriser la capture de votre thread actuel en toute s√©curit√©. </font><font style="vertical-align: inherit;">Si la r√©ponse est non, encapsulez l'appel √† l' </font></font><code>Cancel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int√©rieur </font></font><code>Task.Run</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour l'ex√©cuter dans le pool de threads.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les continuations de TaskCompletionSource sont souvent en ligne</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme les abonnements </font></font><code>CancellationToken</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, les continuations </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont souvent en ligne. </font><font style="vertical-align: inherit;">Il s'agit d'une bonne optimisation, mais elle peut provoquer des erreurs implicites. </font><font style="vertical-align: inherit;">Par exemple, consid√©rez le programme suivant:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><font></font>
{<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ManualResetEventSlim _mutex = <span class="hljs-keyword">new</span> ManualResetEventSlim();<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Deadlock</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        <span class="hljs-keyword">await</span> ProcessAsync();<font></font>
        _mutex.Wait();<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Task <span class="hljs-title">ProcessAsync</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        <span class="hljs-keyword">var</span> tcs = <span class="hljs-keyword">new</span> TaskCompletionSource&lt;<span class="hljs-keyword">bool</span>&gt;();<font></font>
        <font></font>
        Task.Run(() =&gt;<font></font>
        {<font></font>
            Thread.Sleep(<span class="hljs-number">2000</span>); <span class="hljs-comment">//  - </span>
            tcs.SetResult(<span class="hljs-literal">true</span>);<font></font>
            _mutex.Set();<font></font>
        });<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> tcs.Task;<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span><font></font>
    {<font></font>
        Deadlock().Wait();<font></font>
        Console.WriteLine(<span class="hljs-string">"Will never get there"</span>);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appel </font></font><code>tcs.SetResult</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">provoque l' </font></font><code>await ProcessAsync()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ex√©cution de </font><font style="vertical-align: inherit;">la continuation </font><font style="vertical-align: inherit;">dans le thread actuel. </font><font style="vertical-align: inherit;">Par cons√©quent, l'instruction </font></font><code>_mutex.Wait()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est ex√©cut√©e par le m√™me thread qu'elle doit appeler </font></font><code>_mutex.Set()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce qui conduit √† un blocage. </font><font style="vertical-align: inherit;">Cela peut √™tre √©vit√© en passant le param√®tre </font></font><code>TaskCreationsOptions.RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous n'avez aucune bonne raison de le n√©gliger, utilisez toujours l'option </font></font><code>TaskCreationsOptions.RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de la cr√©ation </font></font><code>TaskCompletionSource</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Attention: le code sera √©galement compil√© si vous l'utilisez √† la </font></font><code><b>TaskContinuationOptions</b>.RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">place </font></font><code><b>TaskCreationOptions</b>.RunContinuationsAsynchronously</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais les param√®tres seront ignor√©s et les suites seront toujours en ligne. </font><font style="vertical-align: inherit;">Il s'agit d'une erreur √©tonnamment courante car elle </font></font><code>TaskContinuationOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©c√®de la </font></font><code>TaskCreationOptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saisie semi-automatique.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Task.Run / Task.Factory.StartNew</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez aucune raison de l'utiliser </font></font><code>Task.Factory.StartNew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, choisissez toujours </font></font><code>Task.Run</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'ex√©cuter une t√¢che en arri√®re-plan. </font></font><code>Task.Run</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilise des valeurs par d√©faut plus s√ªres, et plus important encore, il d√©compresse automatiquement la t√¢che renvoy√©e, ce qui peut √©viter les erreurs non √©videntes avec les m√©thodes asynchrones. </font><font style="vertical-align: inherit;">Consid√©rez le programme suivant:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span><font></font>
{<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ProcessAsync</span>(<span class="hljs-params"></span>)</span><font></font>
    {<font></font>
        <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">2000</span>);<font></font>
        Console.WriteLine(<span class="hljs-string">"Processing done"</span>);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span><font></font>
    {<font></font>
        <span class="hljs-keyword">await</span> Task.Factory.StartNew(ProcessAsync);<font></font>
        Console.WriteLine(<span class="hljs-string">"End of program"</span>);<font></font>
        Console.ReadLine();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© son apparence, la fin du programme sera affich√©e plus t√¥t que le traitement termin√©. </font><font style="vertical-align: inherit;">En effet, il </font></font><code>Task.Factory.StartNew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reviendra </font></font><code><code>Task&lt;Task&gt;</code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et le code n'attend qu'une t√¢che externe. </font><font style="vertical-align: inherit;">Le code correct pourrait √™tre soit </font></font><code>await Task.Factory.StartNew(ProcessAsync).Unwrap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, soit </font></font><code>await Task.Run(ProcessAsync)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a que trois cas d'utilisation valides </font></font><code>Task.Factory.StartNew</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution d'une t√¢che dans un autre planificateur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ex√©cution d'une t√¢che dans un thread d√©di√© (√† l'aide de </font></font><code>TaskCreationOptions.LongRunning</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font></li>
<li>       (  <code>TaskCreationOptions.PreferFairness</code>).</li>
</ul><br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   .</a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502486/index.html">Le livre "Race with the epidemic. Antibiotiques contre les superbact√©ries "</a></li>
<li><a href="../fr502490/index.html">Clignotant des croyances restrictives. Pour quoi et qu'est-ce que √ßa donne</a></li>
<li><a href="../fr502492/index.html">Innovations dans Zextras Suite et Zimbra OSE</a></li>
<li><a href="../fr502494/index.html">7 erreurs d'un Black Friday et comment fonctionne Magento Cloud - vid√©o</a></li>
<li><a href="../fr502496/index.html">Acc√®s Web facile aux applications LabVIEW VI PHP via le serveur ActiveX</a></li>
<li><a href="../fr502500/index.html">L'√©volution d'un scanner de passeport: de l'artisanat du contreplaqu√© √† la vraie entreprise</a></li>
<li><a href="../fr502504/index.html">Entourez le chiffre de l'utilisateur</a></li>
<li><a href="../fr502508/index.html">Trolley Robot 2.0. Partie 2. Gestion dans rviz et sans √©l√©ments de beaut√© dans rviz</a></li>
<li><a href="../fr502510/index.html">Quoi √©conomiser dans le cloud</a></li>
<li><a href="../fr502512/index.html">R√©sultats du concours des experts du canap√©: les r√®gles du piquant scientifique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>