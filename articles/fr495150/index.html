<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçï üôçüèΩ üëßüèæ Docker et VMWare Workstation sur la m√™me machine Windows üöØ üåê üåì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La t√¢che √©tait simple, mettez Docker sur votre ordinateur portable de travail avec Windows, qui a d√©j√† un zoo. Livr√© Docker Desktop a cr√©√© des contene...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Docker et VMWare Workstation sur la m√™me machine Windows</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495150/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La t√¢che √©tait simple, mettez Docker sur votre ordinateur portable de travail avec Windows, qui a d√©j√† un zoo. </font><font style="vertical-align: inherit;">Livr√© Docker Desktop a cr√©√© des conteneurs, tout va bien, mais vient de d√©couvrir rapidement que VMWare Workstation a cess√© d'ex√©cuter des machines virtuelles avec une erreur:</font></font><br>
<br>
<pre><code class="plaintext hljs">VMware Workstation and Device/Credential Guard are not compatible. VMware Workstation can be run after disabling Device/Credential Guard.</code></pre><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le travail s'est lev√©, un besoin urgent d'√™tre r√©par√©</font></font></h3><br>
<img src="https://habrastorage.org/webt/b1/t1/zb/b1t1zbtgf0ryh6x4bfeocywnkig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant Google, il a √©t√© constat√© que cette erreur se produit en raison de l'incompatibilit√© de VMWare Workstation et Hyper-V sur la m√™me machine. </font><font style="vertical-align: inherit;">Le probl√®me est connu et il existe une solution officielle VMWare sur la fa√ßon de le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©soudre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , en r√©f√©rence √† la base de connaissances Microsoft </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manage Windows Defender Credential Guard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La solution consiste √† d√©sactiver Defender Credential Guard (le paragraphe 4 de la section D√©sactiver Windows Defender Credential Guard m'a aid√©):</font></font><br>
<br>
<pre><code class="plaintext hljs">mountvol X: /s<font></font>
copy %WINDIR%\System32\SecConfig.efi X:\EFI\Microsoft\Boot\SecConfig.efi /Y<font></font>
bcdedit /create {0cb3b571-2f2e-4343-a879-d86a476d7215} /d "DebugTool" /application osloader<font></font>
bcdedit /set {0cb3b571-2f2e-4343-a879-d86a476d7215} path "\EFI\Microsoft\Boot\SecConfig.efi"<font></font>
bcdedit /set {bootmgr} bootsequence {0cb3b571-2f2e-4343-a879-d86a476d7215}<font></font>
bcdedit /set {0cb3b571-2f2e-4343-a879-d86a476d7215} loadoptions DISABLE-LSA-ISO<font></font>
bcdedit /set {0cb3b571-2f2e-4343-a879-d86a476d7215} device partition=X:<font></font>
mountvol X: /d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le red√©marrage, Windows vous demandera s'il est vraiment possible de d√©sactiver Defender Credential Guard. </font><font style="vertical-align: inherit;">Oui! </font><font style="vertical-align: inherit;">Ainsi, VMWare Workstation reviendra √† son fonctionnement normal, et nous serons au m√™me endroit qu'avant l'installation du docker. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai jamais trouv√© de solutions pour r√©concilier Hyper-V et VMWare Workstation, j'esp√®re qu'ils se feront des amis dans les nouvelles versions.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai longtemps √©t√© accroch√© √† VMWare Workstation √† diverses fins, j'ai essay√© de descendre sur Hyper-V et VirtualBox, mais la fonctionnalit√© ne satisfaisait pas mes t√¢ches, alors je reste assis. </font><font style="vertical-align: inherit;">Il s'est av√©r√© qu'il existe une solution pour r√©unir VMWare, Docker et VSCode dans un environnement de travail. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker Machine</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - vous permet d'ex√©cuter le Docker Engine sur un h√¥te virtuel et de vous y connecter √† distance et localement. </font><font style="vertical-align: inherit;">Et pour lui il y a un pilote de compatibilit√© avec VMWare Workstation, un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien vers GitHub</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
je ne reviendrai pas particuli√®rement sur les instructions d'installation, seulement une liste d'ingr√©dients:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker Toolbox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker Machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inclus)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilote Docker Machine VMware Workstation</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bureau Docker</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, Docker Desktop, malheureusement, est √©galement n√©cessaire. </font><font style="vertical-align: inherit;">Si vous l'avez d√©moli, r√©installez-le, mais en supprimant cette fois la case √† cocher pour apporter des modifications au syst√®me d'exploitation afin de ne plus casser VMWare Workstation. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je veux noter tout de suite que tout fonctionne bien pour un simple utilisateur, les programmes d'installation demanderont une escalade des droits quand ils en auront besoin, mais toutes les commandes de la ligne de commande et les scripts sont ex√©cut√©s par l'utilisateur actuel. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, l'√©quipe:</font></font><br>
<pre><code class="powershell hljs"><span class="hljs-variable">$</span> docker<span class="hljs-literal">-machine</span> create -<span class="hljs-literal">-driver</span>=vmwareworkstation dev</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√† partir de Boot2Docker, un d√©veloppeur virtuel sera cr√©√© √† l'int√©rieur duquel il y aura un Docker. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez attacher cette machine virtuelle √† l'interface graphique de VMWare Workstation en ouvrant le fichier vmx correspondant. </font><font style="vertical-align: inherit;">Mais ce n'est pas n√©cessaire, car VSCode devra maintenant √™tre ex√©cut√© par PowerShell avec un script (pour une raison quelconque, docker-machine et docker-machine-driver-vmwareworkstation s'est av√©r√© √™tre dans le dossier bin):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">cd</span> ~/bin<font></font>
./docker<span class="hljs-literal">-machine</span> env dev | <span class="hljs-built_in">Invoke-Expression</span>
code</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VSCode s'ouvre pour fonctionner avec le code sur la machine locale et le docker dans la machine virtuelle. Le plug-in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker pour Visual Studio Code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permet de g√©rer facilement les conteneurs dans une machine virtuelle sans grimper dans la console. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Difficult√©s:</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dans le processus de cr√©ation de docker-machine, mon processus se bloque:</font></font><br>
<br>
<pre><code class="powershell hljs">Waiting <span class="hljs-keyword">for</span> SSH to be available...</code></pre><br>
<img src="https://habrastorage.org/webt/sf/4a/a7/sf4aa7bnmnh4zwmtccicwm4yong.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et apr√®s un certain temps, cela s'est termin√© par des tentatives excessives d'√©tablir une connexion avec la machine virtuelle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout tourne autour de la politique des certificats. Lors de la cr√©ation d'une machine virtuelle, vous verrez le r√©pertoire ~ \ .docker \ machine \ machines \ dev dans ce r√©pertoire, il y aura des fichiers de certificats pour la connexion via SSH: id_rsa, id_rsa.pub. OpenSSH peut refuser de les utiliser car il pense qu'ils ont des probl√®mes de droits d'acc√®s. Seulement ici, docker-machine ne vous dira rien √† ce sujet, mais se reconnectera simplement jusqu'√† ce qu'il s'ennuie. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solution:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√®s que la cr√©ation d'une nouvelle machine virtuelle d√©marre, acc√©dez au r√©pertoire ~ \ .docker \ machine \ machines \ dev et modifiez les droits sur les fichiers sp√©cifi√©s, un par un.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le propri√©taire du fichier doit √™tre l'utilisateur actuel, un acc√®s complet uniquement √† l'utilisateur actuel et au SYST√àME, tous les autres utilisateurs, y compris le groupe d'administrateurs et les administrateurs eux-m√™mes, doivent √™tre supprim√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il peut √©galement y avoir des probl√®mes avec la conversion de chemins absolus du format Windows vers Posix et avec les volumes de liaison contenant un lien symbolique. </font><font style="vertical-align: inherit;">Mais c'est une autre histoire.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495130/index.html">Tri √† Scala - un exemple sur les chats</a></li>
<li><a href="../fr495138/index.html">Comment la soci√©t√© et la technologie changeront-elles apr√®s le coronavirus. Opinions d'experts</a></li>
<li><a href="../fr495140/index.html">Les 10 meilleurs m√®mes de la derni√®re d√©cennie</a></li>
<li><a href="../fr495146/index.html">Alimentation √©lectrique ininterrompue des centres commerciaux ou Shopping Must Go On</a></li>
<li><a href="../fr495148/index.html">Dell XPS 13 7390 "2 en 1": un transformateur m√©tallique l√©ger avec un √©cran lumineux et Intel Ice Lake</a></li>
<li><a href="../fr495154/index.html">Serveur √©ternel - comment se d√©barrasser des paiements d'h√©bergement mensuels</a></li>
<li><a href="../fr495156/index.html">Incroyable, votre produit fonctionne toujours</a></li>
<li><a href="../fr495158/index.html">D√©veloppeurs Perekrestok.ru. Ce que nous faisons et qui nous recherchons en √©quipe</a></li>
<li><a href="../fr495160/index.html">Du monolithe au syst√®me distribu√©</a></li>
<li><a href="../fr495162/index.html">Ce que vous devez savoir sur l'impact des actualit√©s sur les cours boursiers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>