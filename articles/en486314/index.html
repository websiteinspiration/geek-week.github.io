<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧛🏻 🏏 🎬 [Workshop] DMA attacks in practice. Exploit through direct memory access 🧑🏿‍🤝‍🧑🏽 📩 😉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This Saturday, February 1, 2020, a master class on the practical use of DMA attacks will be held in our Hackspace Neuron in Moscow. Together we will h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>[Workshop] DMA attacks in practice. Exploit through direct memory access</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neuronspace/blog/486314/"><img src="https://habrastorage.org/webt/cx/lb/o4/cxlbo4zplotbs9n6rjibkkl33aw.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This Saturday, February 1, 2020, a </font><font style="vertical-align: inherit;">master class on the practical use of DMA attacks will be held </font><font style="vertical-align: inherit;">in our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hackspace Neuron</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Moscow. </font><font style="vertical-align: inherit;">Together we will hack into a real computer with an encrypted file system that mimics an ATM or payment terminal. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leading workshop </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ValdikSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Goryachy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Behind the bar, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pavel Zhovner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></b> <br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img width="270" src="https://habrastorage.org/webt/st/t3/6a/stt36a42onq46vh0etgnqtsfs8g.png"></div></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Direct Memory Access (DMA) - a low-level mode of operation of computer devices, involving direct access to the computer's RAM. </font><font style="vertical-align: inherit;">It is required for PCIe, Thunderbolt, and some other devices to work. </font><font style="vertical-align: inherit;">Under normal conditions, DMA is used for faster access to memory so as not to occupy the processor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using a special “evil” device, an attacker can take control of the PCIe bus and gain full read and write access to the memory of a working computer, even if the system is protected from penetration by software.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DMA attacks allow</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unbeknownst to the operating system and antiviruses, read and modify data in computer memory;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inject your code into OS and running programs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retrieve any data from running programs: keys, passwords</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bypass authentication and authorization of the operating system</font></font></li>
<li>    </li>
<li>     .</li>
</ul><br>
<h2>   </h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1 - Theory</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
First, on the fingers we will figure out how the PCIe bus works and memory access, why such attacks are possible and what modern means of protection against such attacks exist. Let's consider what tools exist for conducting DMA attacks and how best to design secure systems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ValdikSS will talk about its experience of using a DMA attack to crack the protection of a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Japanese slot machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 2 - practical lesson</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
To conduct an attack, we will use two computers: the attacker and the victim. A special “evil” device is inserted into the victim’s PCIe port, which implements the physical layer of PCIe and sends commands from the attacker. The attacking computer connects to the "evil" board via USB, and through it sends commands to the victim's PCIe bus.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/af/ba/hp/afbahp6eynp5y_lufdbx594bcfq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An ordinary X86 computer will act as a victim, and the USB3380 board will act as an “evil” device. </font><font style="vertical-align: inherit;">The attacker side will use the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pcileech</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> framework </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let’s figure out which devices supports pcileech as attackers, and what is better to choose. </font><font style="vertical-align: inherit;">We’ll set up an attacker’s stand from scratch based on the USB3380 board. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tx/ck/rl/txckrlnkdfivovxvptonsvxs46u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initially, the victim computer will have a hard disk encrypted with bitlocker and locked to enter the operating system. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will perform the following attacks:</font></font></b><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Authentication Bypass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Logging into your account without resetting passwords</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access to victim files</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Despite file system encryption, access to files is still possible from within the OS</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We extract valuable data from memory</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - keys from a Bitcoin wallet, passwords and typed text</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We install an imitation of a trojan immediately in memory</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> without intermediate files on the disk</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For whom is this occupation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The lesson will be useful to developers of embedded systems, those who design terminals, ATMs, machines, game and gambling machines. </font><font style="vertical-align: inherit;">You will need basic knowledge of computer hardware. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The pcileech framework is quite simple and has several convenient plug-ins for typical attacks, so any advanced computer user will be able to learn how to use it.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the authors</font></font></h2><br>
<img align="left" width="200" src="https://habrastorage.org/webt/aq/l6/97/aql697p48xt1jdrozpngvxhhwlm.jpeg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ValdikSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a security researcher and open source enthusiast. The author of the program for bypassing DPI </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GoodByeDPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> systems </font><font style="vertical-align: inherit;">, and the services JustVPN and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anti-Ban</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . He worked at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digital Security</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ </font></font></font><br>
<br>
<img align="left" width="200" src="https://habrastorage.org/webt/is/by/i4/isbyi40hrlpb5mga5ht3p3vwucw.jpeg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Hot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Embedded Developer and Security Researcher at Positive Technologies. </font><font style="vertical-align: inherit;">He is interested in cryptography, virtualization technologies, reverse engineering and everything related to hardware. </font><font style="vertical-align: inherit;">He performed at 33C3, 34C3, Black Hat. </font><font style="vertical-align: inherit;">Together with Mark Ermolov, he found vulnerabilities in Intel ME, Apple MacOS Firmware. </font></font><font color="white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_________________________________________________________________________________________________________________________________________________________________________________________</font></font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Venue - Hackspace Neuron</font></font></h2><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hackspace Neuron</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a community of geeks and techno-enthusiasts in the center of Moscow. </font><font style="vertical-align: inherit;">Workplaces with professional equipment and a creative atmosphere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zb/_j/br/zb_jbrtkw3jlq8r0g41raegk7ys.jpeg"><br>
<img width="70" src="https://habrastorage.org/getpro/habr/post_images/15c/75a/00f/15c75a00f31a7d58a6d5b67ca84e86a5.gif"> <font color="9999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All the money raised will go towards paying rent and developing Huxspace. </font><font style="vertical-align: inherit;">If you want to support us additionally, you can embrace and offer your help. </font></font></font><br>
<br>
<font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention: all information presented at the master class is for research purposes only. </font><font style="vertical-align: inherit;">The test bench for vulnerability analysis is not a real-life system and was created specifically for training purposes. </font><font style="vertical-align: inherit;">The author does not urge to use the acquired knowledge to commit unlawful acts.</font></font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img width="270" src="https://habrastorage.org/webt/st/t3/6a/stt36a42onq46vh0etgnqtsfs8g.png"></div></a></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486298/index.html">Ketogenic diet: from the treatment of epilepsy to an unhealthy fashion</a></li>
<li><a href="../en486302/index.html">NSIS: problem with $ 0- $ 9, $ R0- $ R9</a></li>
<li><a href="../en486304/index.html">Thousands of Forgotten TODOs in Kubernetes Code</a></li>
<li><a href="../en486306/index.html">Product Management Digest for December and January</a></li>
<li><a href="../en486310/index.html">How to get a thermoelectric 7 times faster</a></li>
<li><a href="../en486318/index.html">How to make money on emotion recognition</a></li>
<li><a href="../en486320/index.html">Domain Driven Design Meetup at Raiffeisenbank: Broadcast + Presentations</a></li>
<li><a href="../en486322/index.html">OSINT on Telegram</a></li>
<li><a href="../en486326/index.html">Who is who in world microelectronics</a></li>
<li><a href="../en486328/index.html">Privacy policy and terms of use as a mandatory attribute of an IT product</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>