<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤟 👩🏾 💬 再次关于433 MHz发射机和接收机 🚻 📦 👣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最简单的433 MHz ISM接收机和发射机组在电子爱好者中赢得了应有的欢迎。这些工具包很便宜（即使在Chip-Deep中，您也可以花300卢布买到它们，而在Ali上，他们说，通常是50美元），它们简单可靠。此外（您可能不会怀疑），这是无线数据交换的最远距离且最深入的方法-433 MHz频率的信号比...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>再次关于433 MHz发射机和接收机</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491530/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最简单的</font><font style="vertical-align: inherit;">433 MHz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接收机和发射机组</font><font style="vertical-align: inherit;">在电子爱好者中赢得了应有的欢迎。这些工具包很便宜（即使在Chip-Deep中，您也可以花300卢布买到它们，而在Ali上，他们说，通常是50美元），它们简单可靠。此外（您可能不会怀疑），这是无线数据交换的最远距离且最深入的方法-433 MHz频率的信号比障碍物更好地通过障碍物，并且其工作距离比流行的2.4 GHz频段（433 </font><font style="vertical-align: inherit;">半米的混凝土墙</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全延迟了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MHz </font><font style="vertical-align: inherit;">，而Wi-Fi已经死了10厘米）。我承认最近出现了</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">MBee-868</font></a><font style="vertical-align: inherit;">模块</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它们配备了合适的（定向）天线，可以进一步“射击”，但是它们至少要贵一个数量级，而且连接难度更大，需要节能管理和预配置。</font><font style="vertical-align: inherit;">此外，868 MHz的频率穿过障碍物的频率是正常情况的两倍（当然，它比2.4 GHz的频率好得多）。</font><font style="vertical-align: inherit;">当然，</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a04/2bb/c3c/a042bbc3ca312c739041b507e7ca4b5e.png" width="500"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关于433 MHz发送器和接收器（包括</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集线器）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的文章很多。</font><font style="vertical-align: inherit;">但是，似乎没有人出于某种奇怪的原因而知道如何在电路中正确包含该套件。</font><font style="vertical-align: inherit;">当我再次</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读</font><font style="vertical-align: inherit;">该套件时，“该套件</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在视线范围内达到了8米，因此无法掌握9米</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“，我的耐心突然响起。</font><font style="vertical-align: inherit;">还有什么8米？</font><font style="vertical-align: inherit;">我可能以40至50的比例相信，尽管实际上，范围可能更大。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
值得注意的是，我进一步解决了创建一条线来传输任意数据的问题，而不仅仅是控制任何智能插座或马达模型船。我的任务比较复杂，但是可靠操作的距离仍然更大。此外，在这样的任务中，不仅重要而且对视线内的距离不重要（它仅用于比较），而且对穿透各种障碍的能力也很重要。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的工具包在城外以与原木壁成锐角的大约25-30米的距离工作，因此，信号路径中的墙壁和隔断（总共约一米）（部分被箔绝缘层屏蔽）总计。在更短的距离（几乎直接在墙后面），WiFi已经完全失去了信号。在城市中，信号从一个三居室城市公寓的一端通过两个内部隔断以及从阳台结束，在阳台上，发射器和接收器之间的直线上至少有80厘米的砖砌和一个石膏隔断。我没有使用上述评论中提到的任何更昂贵的套件选项。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该套件的另一个优点是，在暂停期间，发射机仅根据其设备原理就不会消耗任何东西，并且没有任何特殊的休眠模式（静止时的消耗电流可与锁定晶体管的集电极泄漏电流相当，即大约100 nA）。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看看陷阱是什么。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变送器连接</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如下图所示，该发射机（称为FS1000A）是基于433 MHz SAW谐振器的最简单的发生器。</font><font style="vertical-align: inherit;">发生器组装在晶体管Q1上，而晶体管Q2就是数字输入的基础，在输入端存在高电平（逻辑单元）时，晶体管Q2只是将发生器连接到电源（到GND总线）的键。</font><font style="vertical-align: inherit;">功率可以在5到12伏之间，根据制造商的说法，功率越高，连接的作用就越远。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a21/50c/737/a2150c737eb648ed465e060aa2d178ae.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我没有注意到增加营养作为工作的基本好处。但是，不应忽略这里没有特殊电源要求的事实，并且随着电压的升高，该设备将只能更好地工作。通过9-12伏适配器，电池或一组6个电池（Vin Arduino引脚）将变送器直接连接到电压很方便。在不稳定的电源（可能超过12伏）（例如电池）的情况下，我通常使用单独的9伏稳定器（您可以使用最简单的78L09）将变送器与主电路断开连接，并且在9伏和12伏之间看不到任何工作差异。使用Uno或Nano，您可以使用内置的5伏稳定器为控制器本身和其他电路（例如传感器）供电对于Mini（尤其是便宜的克隆），我建议您放置一个单独的5伏稳定器，并将其连接到5V引脚。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
应该注意的是，最近出现的发射机看起来有些非标准（参见下图）。事实证明，没有L1节气门（三转），只有孔才留下，这是一种虚构，仅由相应的SMD组件代替。更糟糕的是，此选项有所不同：草率打印可能会误导数据引脚和电源的连接。正确的连接如图所示，所有选项均相同：</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/db4/cfc/e17/db4cfce176c768cc5f3504edfbf91513.png" width="250"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这件事上最引人注目的是，当数据和电源混合在一起时，发送器继续在短距离内工作！</font><font style="vertical-align: inherit;">如果看一下电路，您将了解它是什么：通过电阻将Q2基极连接到电源，晶体管始终处于打开状态，并且不影响电路的操作。</font><font style="vertical-align: inherit;">电源总线上的逻辑高电平仅在适当的时间为发电机供电。</font><font style="vertical-align: inherit;">荒谬之处始于一定距离-从逻辑结论可以明显看出，电源是坏的。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接收器连接</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
购买接收器（可能称为MX-RM-5V或XD-RF-5V）时，请注意端子的长度-我碰巧碰到了一批短针，这导致</font><font style="vertical-align: inherit;">接收</font><font style="vertical-align: inherit;">器</font><font style="vertical-align: inherit;">以最小的失真</font><font style="vertical-align: inherit;">从标准</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PBS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接</font><font style="vertical-align: inherit;">器中掉出来</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我必须特别重视董事会。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接收器电路要复杂得多（我不会播放它，但是您可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到它</font><font style="vertical-align: inherit;">）。它应该接收并放大高频信号，滤除433 MHz的频率，隔离脉冲串并将其转换为逻辑电平。接收器有一个扼流圈（位于板的中间），但是由于没有用于测量幅度-频率特性的精确仪器，我不建议扭曲它-最有可能的是，您不会改善任何东西，而只会破坏它。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于信号已经很近了，因此干扰将大大减少，因此很明显，我们必须处理所有方面的干扰：电路和软件方法。图书馆对我们来说是最后一件事，但是无论软件处理中使用什么数学方法，建议都先做所有事情，以使输出的逻辑单元仅在有用信号突发时出现，并且在没有干扰的情况下才出现。换句话说，最好是在接收期间从干扰中调到最大。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的时间对每个组装至少一个收音机或放大器的学生都知道，降低噪声的标准方法是，对于对干扰敏感的节点，必须制造一个独立的电源，该电源应与其他电路最大隔离。您可以用不同的方法来做到这一点：一旦安装了一个单独的齐纳二极管，现在它们通常会使用LC滤波器隔离问题节点的电源（例如，对于ADC推荐这样做，请参见AVR控制器的数据手册）。但是在我们的条件下，当现代组件又小又便宜时，将稳定器与接收器上的其余部分分开放置会更容易。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/bd3/85b/94a/bd385b94af583fa8c188053297965c1b.png" width="400"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，一个LP2950-5.0型稳定器，再加上两个最便宜的必需电容器（当两个电容器都是陶瓷的时，在1-3微法拉范围内），将使电路成本增加60倍。但我不想省钱：在输出处放普通陶瓷，在输入处放电解质（10-100微法拉），此外，还放固态（聚合物）或钽。如果7-12伏的输入电压来自电池或另一个模拟稳定器，则陶瓷电容器可以在任何地方和那里都省掉。脉冲稳定源和最简单的不稳定整流器需要额外的滤波。如果将0.1微法拉的陶瓷平行放置，则可以使用便宜的铝电解质，最好在几分之一或几毫单位的输入端放置一个串联电感。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
稳定器应直接安装在接收器附近，导体的长度应最短。代替LP2950，您可以使用具有低直通电压的LM2931或类似产品（如果电路由电池供电，这尤其重要-对于常规LM78L05，输入电压应至少为7.5，最好为8-9伏）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与所有出版物中推荐的直接从Arduino给接收器供电的情况相比（我从未见过例外），您会对获得的效果感到惊讶-穿透墙壁的范围和能力立即显着增加。为了方便，接收器和稳定器可以在单独的小盒子中进行携带。您可以使用最长3米甚至更长的三芯线（两个电源和一个信号导体）将其输出连接到主体中的控制器。这更加方便，因为仍然需要天线，并且根据规则，如果它们在空间上彼此平行会更好，并且不能总是放置大箱子以使天线以正确的方向伸出。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在最简单的版本中，作为天线，您可以处理横截面至少为0.5毫米，长度为17厘米±1-3毫米的单芯电线。</font><font style="vertical-align: inherit;">不要使用绞合的安装线！</font><font style="vertical-align: inherit;">更紧凑的螺旋天线正在销售中，但是我个人还没有测试其有效性。</font><font style="vertical-align: inherit;">发射器和接收器的天线尖端均密封在板角的相应孔中（在发射器的升级版本中不要弄错-ANT这个词也不合适，请参见上图）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成和处理传输的数据</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是大多数关于我们主题的评论的第二个主要缺点：作者将自己局限于某些局部问题，而没有以一般的方式来表述，例如在一个包中传输任意数据。从上面的描述可以理解，我们的设备只能传输一个简单的比特序列。标准的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirtualWire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">以一种特殊的方式对它们进行编码（每个四位编码为6位，在前面添加一个同步头，并为整个数据包添加一个校验和），然后将输出转换为更熟悉的字节序列。但是程序员已经必须自己处理它。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，我们假设发送器和接收器已连接到Arduino。除了VirtualWire之外，随着“智能家居”的兴起，还有许多其他功能，例如RC-Switch或RemoteSwitch，但它们专注于其他任务，显然不值得使用它们来传输任意数据。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VirtualWire中单个消息的最大长度为27个字节（请参阅</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。以我选择的1200 bps的速度传输一条完整的消息（自动添加签名0xb38，消息长度值和校验和）的时间为0.35秒。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一下，选择的传输速度越大，传输范围就越小。根据使用RS-232的经验，可以知道随着范围的增加，允许的传输速度呈指数下降：以19,200的速度，一条无屏蔽的线路以15米的速度运行9600-150米，以1200的速度-超过一公里。通过实验找出这种依赖关系的性质对于我们的案例将是很有趣的，因为这里很多都取决于所使用的数学。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在VirtualWire中初始化发送器如下所示：</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span><font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span>
  vw_set_tx_pin(<span class="hljs-number">10</span>);   <span class="hljs-comment">//   VirtualWire D10</span><font></font>
. . . . .<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将使用一个特定的示例来分析数据生成的原理。让我们有一个远程温度湿度传感器。它以带符号（浮点）的实数形式给出值（温度和湿度变量）。为了使在接收端更容易理解，我们都将减至一个小数位数至少为4的正整数，将这些位分别转换为ASCII字符，传输结果字符串，并在接收端执行反向操作。当然，您可以简化任务（例如，无需转换为ASCII并缩短数字），但是事实证明，对于几乎所有类型的数字数据而言，它都是相同的，从而简化了接收时的反汇编。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，使用String类型编写消息很方便，如下所示：</font></font><br>
<br>
<pre><code class="cpp hljs">. . . . .
<span class="hljs-comment">//    </span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ledPin 13 <span class="hljs-comment">//  (D13,  19 ATmega) </span></span>
<span class="hljs-keyword">char</span> msg[<span class="hljs-number">13</span>];
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> tmpr=<span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> hum=<span class="hljs-number">0</span>;<font></font>
. . . . .<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  delay(<span class="hljs-number">1000</span>); <span class="hljs-comment">// 1 c</span>
<span class="hljs-keyword">float</span> temperature;
<span class="hljs-keyword">float</span> humidity;<font></font>
. . . . .  <span class="hljs-comment">//   temperature  humidity  </span>
<span class="hljs-comment">//       4 :</span>
  tmpr = temperature*<span class="hljs-number">10</span>+<span class="hljs-number">2731</span>; <span class="hljs-comment">//2731 =     </span>
<span class="hljs-comment">//    4 :</span>
  hum = humidity*<span class="hljs-number">10</span>+<span class="hljs-number">1000</span>; 
<span class="hljs-comment">//  :</span>
  digitalWrite (ledPin,HIGH); <span class="hljs-comment">//  —  </span>
  String strMsg=<span class="hljs-string">"DAH"</span>; <span class="hljs-comment">// - </span>
  strMsg+=tmpr; <span class="hljs-comment">//  </span>
  strMsg+=hum; <span class="hljs-comment">// </span>
  strMsg.toCharArray(msg,<span class="hljs-number">12</span>); <span class="hljs-comment">//   , 12 –  </span>
<span class="hljs-comment">//  :</span>
  vw_send((<span class="hljs-keyword">uint8_t</span> *)msg, <span class="hljs-built_in">strlen</span>(msg)); <span class="hljs-comment">//  </span>
  vw_wait_tx(); <span class="hljs-comment">//   </span>
  delay(<span class="hljs-number">500</span>); <span class="hljs-comment">// 500 </span>
  digitalWrite (ledPin, LOW); <span class="hljs-comment">//  —  </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您需要传送带有大量数字的更准确的数字，则只需增加msg数组的长度即可。如果将多个读数取平均值，则需要全局“易失”变量tmpr和hum，否则也可以在loop（）函数内部将它们声明为局部变量。如您所见，该消息由转换后的温度和湿度值组成，每个字符串包含四个字节的ASCII字符串，之后是三个“ DAH”字符的字符串（字符可以是ASCII表中的任何其他字符）。这是一个签名，可以使您将该消息与类似设备发送的其他消息区分开。即使您认为不要在此范围内使用其他设备，也不要忽略签名，同时，它可以作为对接收数据完整性的额外保证。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还要注意，将字符串转换为数组时，必须指定一个比消息总长度多的字符（3 + 4 + 4 = 11），这要考虑到关闭字符串的零字符。</font><font style="vertical-align: inherit;">并且msg []数组的大小必须指定一个空白，并且可以为任意大小，在这种情况下，为13到27个字节。</font><font style="vertical-align: inherit;">传输时，它仍将按照strlen（msg）函数返回的值发送，即11字节+空字符。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在接收部分，必须解析得到的ASCII码数组。</font><font style="vertical-align: inherit;">但是首先，您需要接受它。</font><font style="vertical-align: inherit;">要初始化接收，请执行以下操作：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;VirtualWire.h&gt;</span></span>
<span class="hljs-keyword">char</span> str[<span class="hljs-number">5</span>];     ASCII  
  <span class="hljs-keyword">uint8_t</span> buf [VW_MAX_MESSAGE_LEN];  <span class="hljs-comment">//    </span>
  <span class="hljs-keyword">uint8_t</span> buflen = VW_MAX_MESSAGE_LEN;  <span class="hljs-comment">// max   </span><font></font>
. . . . .<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_set_rx_pin(<span class="hljs-number">2</span>); <span class="hljs-comment">//D2   VirtualWire</span>
  vw_setup(<span class="hljs-number">1200</span>); <span class="hljs-comment">//   VirtualWire</span><font></font>
. . . . .<font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，解析行的技术是这样的：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{<font></font>
  vw_rx_start();  <span class="hljs-comment">//  </span>
  buflen = VW_MAX_MESSAGE_LEN; <span class="hljs-comment">//    </span>
 <span class="hljs-keyword">if</span> (vw_have_message()) { <span class="hljs-comment">// </span>
 <span class="hljs-keyword">if</span> (vw_get_message(buf, &amp;buflen)) <span class="hljs-comment">//   </span><font></font>
  {<font></font>
    vw_rx_stop(); <span class="hljs-comment">//   :</span>
        <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">3</span>; i++)  <span class="hljs-comment">//    </span>
                str[i]= buf[i]; <span class="hljs-comment">// </span>
                str[<span class="hljs-number">3</span>]=<span class="hljs-string">'\0'</span>;
      <span class="hljs-keyword">if</span> ((str[<span class="hljs-number">0</span>]==<span class="hljs-string">'D'</span>)&amp;&amp;(str[<span class="hljs-number">1</span>]==<span class="hljs-string">'A'</span>)&amp;&amp;(str[<span class="hljs-number">2</span>]==<span class="hljs-string">'H'</span>)) {
<span class="hljs-comment">// ,  </span>
       <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">3</span>;i&lt;<span class="hljs-number">7</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-3</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> tmpr=atoi(str); <span class="hljs-comment">//   </span>
      tmpr=tmpr<span class="hljs-number">-2731</span>; <span class="hljs-comment">// 2731,     </span>
. . . . .<span class="hljs-comment">//    10    float,  </span>
. . . . . <span class="hljs-comment">//    -</span>
<span class="hljs-comment">// :</span>
      <span class="hljs-keyword">for</span> (byte i=<span class="hljs-number">7</span>;i&lt;<span class="hljs-number">11</span>;i++)  <span class="hljs-comment">//    </span>
                str[i<span class="hljs-number">-7</span>]= buf[i]; <span class="hljs-comment">//    </span>
      <span class="hljs-keyword">int</span> hh = atoi(str); <span class="hljs-comment">//   </span>
      hh=(hh<span class="hljs-number">-1000</span>)/<span class="hljs-number">10</span>;
      <span class="hljs-keyword">if</span> (hh&gt;<span class="hljs-number">99</span>) hh=<span class="hljs-number">99</span>; <span class="hljs-comment">//   %,  </span>
. . . . . <span class="hljs-comment">// -</span>
   } <span class="hljs-comment">//end   DAT</span>
  } <span class="hljs-comment">//end  </span>
 } <span class="hljs-comment">// </span>
} <span class="hljs-comment">// end loop</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
希望您现在对使用这些便宜且易于使用的设备的疑问有所减少。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN491518/index.html">来自世界开放地图501号的新闻（02/18/2020/24/02/2020）</a></li>
<li><a href="../zh-CN491520/index.html">在C＃中将xls转换为xlsx和xml</a></li>
<li><a href="../zh-CN491522/index.html">女人为什么寿命更长</a></li>
<li><a href="../zh-CN491524/index.html">Stas Afanasyev。朱诺 基于io.Reader / io.Writer的管道。第2部分</a></li>
<li><a href="../zh-CN491528/index.html">我的经验是进行1000次面试。Yegor Bugaenko的报告摘要</a></li>
<li><a href="../zh-CN491532/index.html">Laravel + Docker + Gitlab 从哪里开始</a></li>
<li><a href="../zh-CN491534/index.html">使用GDB的简要指南</a></li>
<li><a href="../zh-CN491536/index.html">YouTube-错误。请稍后再试。播放ID：<...></a></li>
<li><a href="../zh-CN491540/index.html">面向新手IT专家的网络。强制性基地</a></li>
<li><a href="../zh-CN491542/index.html">颜色转换：稀疏表搜索</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>