<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👺 🚫 🤜🏽 Bagaimana kami mempercepat encoding video delapan kali 🏈 🤶🏾 👩🏿‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setiap hari, jutaan pemirsa menonton video di Internet. Tetapi agar video tersedia, itu tidak hanya harus diunggah ke server, tetapi juga diproses. Se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami mempercepat encoding video delapan kali</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/494154/"><img src="https://habrastorage.org/webt/mu/t5/ov/mut5ovwkds2o3dn2vnxmxvnelwo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap hari, jutaan pemirsa menonton video di Internet. Tetapi agar video tersedia, itu tidak hanya harus diunggah ke server, tetapi juga diproses. Semakin cepat ini terjadi, semakin baik layanan dan penggunanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nama saya Askar Kamalov, setahun yang lalu saya bergabung dengan tim teknologi video Yandex. Hari ini saya secara singkat akan memberi tahu pembaca Habr tentang bagaimana, menggunakan paralelisasi proses pengkodean, kami berhasil mempercepat pengiriman video ke pengguna berkali-kali. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posting ini terutama akan menarik bagi mereka yang belum pernah berpikir tentang apa yang terjadi di bawah tenda layanan video. Dalam komentar, Anda dapat mengajukan pertanyaan dan menyarankan topik untuk posting selanjutnya.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa kata tentang tugas itu sendiri. </font><font style="vertical-align: inherit;">Yandex tidak hanya membantu mencari video di situs lain, tetapi juga menyimpan video untuk layanannya sendiri. </font><font style="vertical-align: inherit;">Baik itu program penulis atau pertandingan olahraga di Ether, film di KinoPoisk atau video dalam Zen dan Berita - semua ini diunggah ke server kami. </font><font style="vertical-align: inherit;">Agar pengguna dapat menonton video, video harus disiapkan: konversikan ke format yang diperlukan, buat pratinjau, atau bahkan mengendarainya melalui teknologi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeepHD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">File yang tidak siap hanya membutuhkan ruang. </font><font style="vertical-align: inherit;">Dan kita berbicara tidak hanya tentang penggunaan besi yang optimal, tetapi juga tentang kecepatan pengiriman konten ke pengguna. </font><font style="vertical-align: inherit;">Contoh: catatan dengan momen yang menentukan dari pertandingan hoki dapat dicari dalam pencarian dalam satu menit setelah acara itu sendiri.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengodean berurutan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kebahagiaan pengguna sangat tergantung pada seberapa cepat video tersedia. </font><font style="vertical-align: inherit;">Dan ini terutama ditentukan oleh kecepatan transcoding. </font><font style="vertical-align: inherit;">Ketika tidak ada persyaratan ketat untuk kecepatan unggah video, maka tidak ada masalah. </font><font style="vertical-align: inherit;">Ambil satu file yang tidak dapat dibagi, konversikan, unggah. </font><font style="vertical-align: inherit;">Di awal perjalanan kami, kami bekerja seperti ini: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/rv/ix/lhrvixp8ipl0f8yfbtxrm9uh174.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klien mengunggah video ke repositori, komponen Analyzer mengumpulkan informasi meta dan mentransfer video untuk dikonversi ke komponen Worker. </font><font style="vertical-align: inherit;">Semua langkah dilakukan berurutan. </font><font style="vertical-align: inherit;">Pada saat yang sama, mungkin ada banyak server untuk penyandian, tetapi hanya satu yang sibuk memproses video tertentu. </font><font style="vertical-align: inherit;">Sederhana, tata letak transparan. </font><font style="vertical-align: inherit;">Di sinilah manfaatnya berakhir. </font><font style="vertical-align: inherit;">Skema seperti ini diskalakan hanya secara vertikal (karena pembelian server yang lebih kuat).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengurutan berurutan dengan hasil antara</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melancarkan ekspektasi yang menyakitkan, industri mengeluarkan opsi pengkodean cepat. Ini adalah nama yang menipu, karena sebenarnya, pengkodean lengkap berlangsung secara berurutan dan selama. Tetapi dengan hasil antara. Idenya adalah ini: persiapkan dan unggah versi video resolusi rendah sesegera mungkin, dan hanya nanti - versi resolusi lebih tinggi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di satu sisi, video menjadi lebih cepat. Dan itu berguna untuk acara-acara penting. Tapi di sisi lain - gambarnya buram, dan ini mengganggu penonton.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata Anda tidak hanya perlu dengan cepat memproses video, tetapi juga untuk mempertahankan kualitasnya. </font><font style="vertical-align: inherit;">Inilah yang sekarang diharapkan pengguna dari layanan video. </font><font style="vertical-align: inherit;">Tampaknya sudah cukup untuk membeli server yang paling produktif (dan secara teratur memutakhirkan semuanya sekaligus). </font><font style="vertical-align: inherit;">Tapi ini jalan buntu, karena selalu ada video yang akan memperlambat bahkan perangkat keras yang paling kuat.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengkodean paralel</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jauh lebih efisien untuk membagi tugas yang sulit menjadi banyak tugas yang kurang kompleks dan secara bersamaan menyelesaikannya di server yang berbeda. Tersebut adalah MapReduce untuk video. Dalam hal ini, kami tidak bergantung pada kinerja server tunggal dan dapat menskalakan secara horizontal (dengan menambahkan mesin baru). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ngomong-ngomong, gagasan membagi video menjadi potongan-potongan kecil, secara bersamaan memproses dan menempelkannya bersama bukanlah rahasia. Anda dapat menemukan banyak referensi untuk pendekatan ini (misalnya, di Habré saya merekomendasikan posting tentang proyek </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DistVIDc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Tetapi ini umumnya tidak membuatnya lebih mudah, karena Anda tidak bisa hanya mengambil solusi yang sudah jadi dan membangunnya sendiri. Kita perlu beradaptasi dengan infrastruktur kita, video kita, dan bahkan beban kerja kita. Secara umum, Anda lebih mudah menulis sendiri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, dalam arsitektur baru, kami membagi blok Pekerja monolitik dengan pengkodean berurutan ke dalam microservices Segmenter, Tcoder, Combiner.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/xo/db/zqxodbzp7qwxo22evvnn1ftyk8o.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segmenter membagi video menjadi beberapa bagian dalam waktu sekitar 10 detik. </font><font style="vertical-align: inherit;">Fragmen terdiri dari satu atau lebih GOP ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kelompok gambar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Setiap GOP bersifat independen dan dikodekan secara terpisah, sehingga dapat didekodekan tanpa referensi ke bingkai dari GOP lain. </font><font style="vertical-align: inherit;">Artinya, fragmen dapat direproduksi secara independen satu sama lain. </font><font style="vertical-align: inherit;">Segmentasi ini mengurangi latensi, memungkinkan Anda untuk mulai memproses lebih awal.</font></font></li>
<li>Tcoder   .     ,    ,     (,     ,    ),             .   , Tcoder        .</li>
<li>ombiner   :   ,  Tcoder,     .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa kata tentang suaranya. </font><font style="vertical-align: inherit;">Codec audio AAC paling populer memiliki fitur jahat. </font><font style="vertical-align: inherit;">Jika Anda mengkode fragmen secara terpisah, maka menempelkannya secara mulus tidak akan berfungsi. </font><font style="vertical-align: inherit;">Transisi akan terlihat. </font><font style="vertical-align: inherit;">Codec video tidak memiliki masalah seperti itu. </font><font style="vertical-align: inherit;">Secara teoritis, Anda dapat mencari solusi teknis yang sulit, tetapi game ini tidak sepadan dengan lilin (audio berbobot jauh lebih sedikit daripada video). </font><font style="vertical-align: inherit;">Karena itu, hanya video yang disandikan secara paralel dengan kami, dan trek audio diproses secara keseluruhan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasil</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berkat pemrosesan video paralel, kami secara signifikan mengurangi penundaan antara mengunduh video kepada kami dan ketersediaannya bagi pengguna. Sebagai contoh, sebelumnya bisa memakan waktu dua jam untuk membuat beberapa versi lengkap dengan kualitas yang berbeda untuk film FullHD yang tahan satu setengah jam. Sekarang semuanya butuh 15 menit. Selain itu, dalam pemrosesan paralel, kami membuat versi resolusi tinggi bahkan lebih cepat daripada versi resolusi rendah dengan pendekatan lama dengan hasil antara. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sesuatu yang lain. Dengan pendekatan yang lama, salah satu server mungkin hilang atau tidak digunakan tanpa tugas. Pengkodean paralel dapat meningkatkan pangsa pemanfaatan besi. Sekarang sekelompok lebih dari seribu server kami selalu sibuk dengan sesuatu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan, masih ada ruang untuk perbaikan. </font><font style="vertical-align: inherit;">Misalnya, kita dapat menghemat banyak waktu jika kita mulai memproses fragmen-fragmen video bahkan sebelum sudah penuh. </font><font style="vertical-align: inherit;">Seperti yang mereka katakan, lebih jauh - lebih banyak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tulis di komentar tentang tugas apa di bidang bekerja dengan video yang ingin Anda baca.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan yang bermanfaat untuk rekan industri</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SVE: Pemrosesan Video Terdistribusi pada Skala Facebook</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penyederhanaan Inovasi Media di Netflix dengan Archer. </font><font style="vertical-align: inherit;">Blog Teknologi Netflix</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id494136/index.html">Apa yang menetes di mata, agar tidak gatal</a></li>
<li><a href="../id494138/index.html">Hak Asasi Manusia dan algoritma: kekuatan kasar hak cipta tidak akan berfungsi di AS, Australia, Rusia, dan Uni Eropa</a></li>
<li><a href="../id494140/index.html">Investigasi Kampanye DNSpionage Menggunakan Cisco Threat Response, Termasuk Pekerjaan Jarak Jauh</a></li>
<li><a href="../id494150/index.html">ClickHouse di Avito: pertemuan langsung dengan Alexey Milovidov</a></li>
<li><a href="../id494152/index.html">HoughNet: Cari titik hilang yang menyatu dengan algoritma klasik</a></li>
<li><a href="../id494156/index.html">Cara bekerja dari rumah - pengalaman penghilang Plesk</a></li>
<li><a href="../id494158/index.html">Bagaimana menjaga kualitas kerja di bawah karantina</a></li>
<li><a href="../id494162/index.html">Memecahkan masalah Postgres dengan pgCenter. Alexey Lesovsky</a></li>
<li><a href="../id494164/index.html">Cara meningkatkan kinerja tim tangkas melalui pengujian</a></li>
<li><a href="../id494170/index.html">3 Fitur Python Teratas yang Tidak Anda Ketahui (Mungkin)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>