<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•µğŸ» ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¾ ä¸ºDjangoé¡¹ç›®é…ç½®Debianï¼ŒNginxå’ŒGunicorn ğŸ¤³ğŸ¼ ğŸ“£ ğŸ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¥å¤§å®¶æœ‰ç¾å¥½çš„ä¸€å¤©ã€‚
 
 åœ¨Nginxä¸Šä¸ºé¡¹ç›®Django 3.xæå‡äº†DebianæœåŠ¡å™¨çš„ä»»åŠ¡ã€‚æ‰“ç ´äº’è”ç½‘ä¸Šçš„å¤§é‡ä¿¡æ¯ï¼Œæˆ‘è®¾æ³•é€šè¿‡ç»“åˆæ¥è‡ªå¤šä¸ªä¸åŒç«™ç‚¹çš„å»ºè®®æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£é˜…è¯»å¦‚ä½•ä¸ºDjangoé¡¹ç›®è®¾ç½®ç¬¬ä¸€å°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ¬¢è¿æ‚¨ã€‚
 
 æˆ‘ä¼šå‘Šè¯‰æ‚¨ä¸€äº›æœ‰å…³æ‚¨è‡ªå·±çš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ‚¨äº†è§£æˆ‘çš„èº«ä»½...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ä¸ºDjangoé¡¹ç›®é…ç½®Debianï¼ŒNginxå’ŒGunicorn</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501414/"><img src="https://habrastorage.org/webt/z9/fb/jx/z9fbjxytkq-jcp5yonlmrsdmxiy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¥å¤§å®¶æœ‰ç¾å¥½çš„ä¸€å¤©ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Nginxä¸Šä¸ºé¡¹ç›®Django 3.xæå‡äº†DebianæœåŠ¡å™¨çš„ä»»åŠ¡ã€‚</font><font style="vertical-align: inherit;">æ‰“ç ´äº’è”ç½‘ä¸Šçš„å¤§é‡ä¿¡æ¯ï¼Œæˆ‘è®¾æ³•é€šè¿‡ç»“åˆæ¥è‡ªå¤šä¸ªä¸åŒç«™ç‚¹çš„å»ºè®®æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨æœ‰å…´è¶£é˜…è¯»å¦‚ä½•ä¸ºDjangoé¡¹ç›®è®¾ç½®ç¬¬ä¸€å°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ¬¢è¿æ‚¨ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä¼šå‘Šè¯‰æ‚¨ä¸€äº›æœ‰å…³æ‚¨è‡ªå·±çš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ‚¨äº†è§£æˆ‘çš„èº«ä»½ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä¸æ˜¯å¼€å‘äººå‘˜ï¼Œç¨‹åºå‘˜ï¼Œç³»ç»Ÿç®¡ç†å‘˜ï¼Œç”šè‡³æ²¡æœ‰ITçŸ¥è¯†ã€‚</font><font style="vertical-align: inherit;">æˆ‘æ˜¯è®¡ç®—æœºç§‘å­¦è€å¸ˆã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨å·¥ä½œä¸­ï¼Œæˆ‘å¿…é¡»å‘å­¦ç”Ÿè§£é‡Šä¸€äº›ä¸è®¡ç®—æœºç§‘å­¦å­¦æ ¡è¯¾ç¨‹ç›¸è·ç”šè¿œçš„è§‚ç‚¹ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯åœ¨Djangoä¸Šå¼€å‘é¡¹ç›®ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºæœ¬è®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæˆ‘ä»¬å·²ç»å®‰è£…äº†Debian 10æœåŠ¡å™¨ï¼Œå®‰è£…Debianåº”è¯¥æ²¡æœ‰é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">æˆ‘çš„å®‰è£…å¹²å‡€ï¼Œæ²¡æœ‰ä»»ä½•å…¶ä»–è®¾ç½®ï¼Œå› æ­¤æˆ‘é€šè¿‡</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootç”¨æˆ·</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿›å…¥æœåŠ¡å™¨</font><font style="vertical-align: inherit;">å¹¶å¼€å§‹ä¸ºæˆ‘å®‰è£…ä¸€äº›ä¸»è¦ç»„ä»¶ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">apt-get update<font></font>
apt-get install -y sudo htop git curl wget unzip zip gcc build-essential make<font></font>
apt-get install -y tree redis-server nginx  libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev llvm libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python3-dev python-pil ython3-pil <font></font>
apt-get install -y python3-lxml libxslt-dev python-libxml2 python-libxslt1 python-dev gnumeric libpq-dev libxml2-dev libxslt1-dev libjpeg-dev libfreetype6-dev libcurl4-openssl-dev supervisor libgdbm-dev libnss3-dev ufw<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥å°†æ‰€æœ‰è¿™äº›éƒ½æ”¾å…¥ä¸€ä¸ªå®‰è£…ä¸­ï¼Œä½†æ˜¯æˆ‘é‡åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”æŒ‰æ­¤é¡ºåºï¼Œä¸€åˆ‡è¿›å±•é¡ºåˆ©ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·å¹¶å°†å…¶æ·»åŠ åˆ°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»„ä¸­ï¼Œ</font><font style="vertical-align: inherit;">ä»¥ä¾¿ä»–å¯ä»¥ä»£è¡¨è¶…çº§ç”¨æˆ·å¯åŠ¨è¿›ç¨‹ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">adduser username <font></font>
usermod -aG sudo username<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¶ä¸­</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">username</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯æ‚¨å°†æ¥ä½¿ç”¨çš„</font><b><font style="vertical-align: inherit;">ç”¨æˆ·å</font></b><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä»æºä»£ç </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œè¯¥å€¼ä¸º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.8.2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /home/username<font></font>
curl -O https://www.python.org/ftp/python/3.8.2/Python-3.8.2.tar.xz<font></font>
tar -xf Python-3.8.2.tar.xz<font></font>
<span class="hljs-built_in">cd</span> Python-3.8.2
</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠ¨ä½œè¯´æ˜</font></font></b>
                        <div class="spoiler_text">cd â€”      ,   <b>change directory</b>;<br>
curl â€”       URL.      ;<br>
tar â€”   .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶ç§»è‡³æºç›®å½•åï¼Œæˆ‘ä»¬è¿è¡Œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">./configure --<span class="hljs-built_in">enable</span>-optimizations<font></font>
make -j 2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™å°†ä½¿æˆ‘ä»¬å‡†å¤‡å®‰è£…Pythonæ‰€éœ€çš„ä¸€åˆ‡ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæ•°å­—2æ˜¯å¤„ç†å™¨å†…æ ¸çš„æ•°é‡ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nproc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘½ä»¤æ¥æŸ¥æ‰¾</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¼€å§‹å®‰è£…ã€‚</font></font><br>
<pre><code class="bash hljs">make altinstall
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥</font><font style="vertical-align: inherit;">ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</font><font style="vertical-align: inherit;">æ¥éªŒè¯æ˜¯å¦</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·²</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®‰è£…</font><b><font style="vertical-align: inherit;">Python</font></b><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3.8 -V
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒå°†è¾“å‡º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰ˆæœ¬</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹åï¼Œæˆ‘ä»¬æ›´æ–°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pip</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶å®‰è£…æœ€å¸¸ç”¨çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è½¯ä»¶åŒ…</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<pre><code class="bash hljs">python3.8 -m pip install -U pip<font></font>
python3.8 -m pip install -U setuptools<font></font>
python3.8 -m pip install pillow<font></font>
python3.8 -m pip install virtualenv<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Djangoè®¾å®š</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œç„¶åè¿›å…¥æ‚¨åˆ›å»ºçš„ç”¨æˆ·ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è½¬åˆ°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / www</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®å½•å¹¶å°†æˆ‘ä»¬çš„é¡¹ç›®ä¸‹è½½åˆ°å…¶ä¸­ï¼Œè¯¥é¡¹ç›®å·²ä¸Šä¼ åˆ°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHubä¸Š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /var/www<font></font>
sudo git <span class="hljs-built_in">clone</span> LINK_TO_PROJECT
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨</font><b><font style="vertical-align: inherit;">/ var / www</font></b><font style="vertical-align: inherit;">ç›®å½•é…ç½®æ­£å¸¸æ“ä½œçš„æƒé™</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<pre><code class="bash hljs">sudo chown -R www-data:www-data /var/www<font></font>
sudo usermod -aG www-data username<font></font>
sudo chmod go-rwx /var/www<font></font>
sudo chmod go+x /var/www<font></font>
sudo chgrp -R www-data /var/www<font></font>
sudo chmod -R go-rwx /var/www<font></font>
sudo chmod -R g+rwx /var/www<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çœ‹æ¥æˆ‘ä»¬æ‰§è¡Œäº†æŸäº›æ“ä½œï¼Œç„¶åå–æ¶ˆäº†å®ƒä»¬ï¼Œä½†è¦ç‚¹æ˜¯ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ é™¤äº†æ‰€æœ‰äººçš„æ‰€æœ‰æƒé™ï¼Œç„¶åå°†å®ƒä»¬åˆ†é…ç»™ç‰¹å®šçš„ç”¨æˆ·æˆ–ç»„ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è¿›å…¥é¡¹ç›®ï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒå¹¶è¿è¡Œå®ƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> djangoprojectname/<font></font>
virtualenv env<font></font>
<span class="hljs-built_in">source</span> ./env/bin/activate
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‰€æœ‰å†…å®¹å‡å·²æ¿€æ´»ï¼Œåˆ™å°†å‡ºç°ä»¥ä¸‹å½¢å¼çš„è¡Œï¼šï¼ˆenvï¼‰username @ serverã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†äº¤ä»˜/æ›´æ–°é¡¹ç›®æ‰€éœ€çš„ä¸»è¦è½¯ä»¶åŒ…ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">pip install -U pip<font></font>
pip install -U setuptools<font></font>
pip install -U pillow<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬æ”¾ç½®äº†Djangoï¼ŒGunicornå’ŒPostgreSQLé€‚é…å™¨ã€‚ </font></font><br>
<br>
<pre><code class="bash hljs">pip install django gunicorn psycopg2-binary
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨è¿˜å¯ä»¥æ”¾ç½®é¡¹ç›®æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼Œæˆ‘ä½¿ç”¨summernoteä½œä¸ºæ–‡æœ¬ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">pip install django-summernote</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è®¾ç½®äº†é˜²ç«å¢™ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ç«¯å£8000ä¸Šä¸ºå…¶åˆ›å»ºä¸€ä¸ªä¾‹å¤–ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨å®ƒï¼Œå¦‚æœæˆ‘ä»¬è®¡åˆ’ä½¿ç”¨å¦ä¸€ä¸ªï¼Œåˆ™æŒ‡å®šå®ƒï¼‰ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo ufw allow 8000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¿…éœ€çš„æ­¥éª¤æ˜¯æ£€æŸ¥æœåŠ¡å™¨çš„è¿è¡ŒçŠ¶å†µï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3.8 manage.py runserver 0.0.0.0:8000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åè®¿é—®æ‚¨çš„ç½‘ç«™</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMAIN_NAMEï¼š8000</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œç›®å‰ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è¿›è¡Œå¤ªå¤šé…ç½®ï¼Œè¿™äº›åªæ˜¯åŸºæœ¬è®¾ç½®ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æœåŠ¡å™¨çš„æ­£å¸¸è¿è¡Œï¼Œè¿æ¥é™æ€å¯¹è±¡ç­‰ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ‚¨çš„ç«™ç‚¹æ²¡æœ‰å¯åŠ¨ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦æ·±å…¥ç ”ç©¶è®¾ç½®ï¼ˆå¯èƒ½æ˜¯è®¿é—®æƒé™ï¼‰ï¼Œå¹¶æŸ¥çœ‹å°šæœªå®‰è£…çš„è½¯ä»¶åŒ…ï¼Œæ‰€æœ‰å†…å®¹éƒ½å¾ˆä¸ªåˆ«ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ï¼šé€šè¿‡æŒ‰é”®æ¥å®Œæˆ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„CTRL +çš„C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬ä»…åœ¨æ‚¨çš„é¡¹ç›®å¼€å§‹æ—¶ç»§ç»­å‰è¿›ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨åœ¨æ— æ³•è§£å†³é—®é¢˜æ—¶ç»§ç»­å‰è¿›ã€‚</font><font style="vertical-align: inherit;">æœ€å¥½åœ¨åˆå§‹é˜¶æ®µè§£å†³é—®é¢˜ï¼Œè€Œä¸æ˜¯å°†æœåŠ¡å™¨æ‹†é™¤åˆ°æ ¹ç›®å½•ï¼ˆæˆ‘æ‹†é™¤äº†3æ¬¡ï¼Œç„¶åå¼€å§‹ç¼–å†™æ­¤æŒ‡ä»¤ï¼Œä¿®å¤äº†æ‰€æœ‰æ“ä½œï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥Gunicornçš„å·¥ä½œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">gunicorn --<span class="hljs-built_in">bind</span> 0.0.0.0:8000 MAINAPPNAME.wsgi</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAINAPPNAME</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯åŒ…å«</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings.py</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ä¸»åº”ç”¨ç¨‹åºçš„åç§°</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œè¯·ç»§ç»­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Cï¼šé€šè¿‡æŒ‰é”®æ¥å®Œæˆ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRL +çš„C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¾ç½®settings.py</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦ä»é¡¹ç›®ä¸­ç¦ç”¨è°ƒè¯•å¹¶æ›´æ”¹å‡ ä¸ªè®¾ç½®ï¼Œæˆ‘åœ¨</font><font style="vertical-align: inherit;">é¡¹ç›®çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">settings.pyä¸­æ‰§è¡Œ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†ä»¥ä¸‹æ“ä½œã€‚</font></font><br>
<br>
<pre><code class="python hljs">DEBUG = <span class="hljs-literal">False</span>
<span class="hljs-keyword">if</span> DEBUG:<font></font>
    ALLOWED_HOSTS = [<span class="hljs-string">'*'</span>]
<span class="hljs-keyword">else</span>:<font></font>
    ALLOWED_HOSTS = [<span class="hljs-string">'HOST IP'</span>, <span class="hljs-string">'DOMAIN NAIM'</span>, <span class="hljs-string">'localhost'</span>]<font></font>
...<font></font>
STATIC_URL = <span class="hljs-string">'/static/'</span>
<span class="hljs-keyword">if</span> DEBUG:<font></font>
    STATIC_DIR = os.path.join(BASE_DIR, <span class="hljs-string">'static'</span>)<font></font>
    STATICFILES_DIRS = [<font></font>
        STATIC_DIR,<font></font>
        <span class="hljs-string">'/var/www/static/'</span>,<font></font>
    ]<font></font>
<span class="hljs-keyword">else</span>:<font></font>
    STATIC_ROOT = os.path.join(BASE_DIR, <span class="hljs-string">'static/'</span>)<font></font>
    STATICFILES_FINDERS = (<font></font>
        <span class="hljs-string">'django.contrib.staticfiles.finders.FileSystemFinder'</span>,
        <span class="hljs-string">'django.contrib.staticfiles.finders.AppDirectoriesFinder'</span>,<font></font>
    )<font></font>
MEDIA_URL = <span class="hljs-string">'/media/'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">urls.pyä¸­ï¼Œ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘æ›´æ”¹äº†é™æ€å’Œåª’ä½“è®¾ç½®ã€‚</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">if</span> settings.DEBUG:<font></font>
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)<font></font>
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä¸çŸ¥é“è¿™æ˜¯æ­£ç¡®çš„å†³å®šï¼Œä¹Ÿè®¸è¿™äº›æ–‡ä»¶è¿˜æœ‰æ›´æ­£ç¡®çš„æ›´æ”¹ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´æ”¹DEBUGçš„å€¼è¶³ä»¥åœ¨å¼€å‘å’Œå‘å¸ƒä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œå‘½ä»¤ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3.8 manage.py collectstatic
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ”¶é›†é™æ€ä¿¡æ¯å¹¶åœç”¨è™šæ‹Ÿç¯å¢ƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs">deactivate</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®Gunicorn</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¼€æ”¾å®šåˆ¶ </font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/systemd/system/gunicorn.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å†™ä¸€äº›è®¾ç½®ï¼š</font></font><br>
<br>
<pre><code class="nginx hljs">[Unit]<font></font>
Description=<span class="hljs-attribute">gunicorn</span> socket<font></font>
<font></font>
[Socket]<font></font>
ListenStream=/run/gunicorn.sock<font></font>
<font></font>
[Install]<font></font>
WantedBy=sockets.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬åˆ›å»ºäº†[Unit]éƒ¨åˆ†æ¥æè¿°å¥—æ¥å­—ï¼Œåœ¨[Socket]éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ç¡®å®šäº†å¥—æ¥å­—çš„ä½ç½®ï¼Œåœ¨[Install]éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ­£ç¡®çš„æ—¶é—´å®‰è£…å¥—æ¥å­—ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰“å¼€systemdå®ç”¨ç¨‹åºæ–‡ä»¶ä»¥é…ç½®æœåŠ¡ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/systemd/system/gunicorn.service</code></pre><br>
<pre><code class="nginx hljs">[Unit]<font></font>
Description=<span class="hljs-attribute">gunicorn</span> daemon<font></font>
Requires=gunicorn.socket<font></font>
After=network.target<font></font>
<font></font>
[Service]<font></font>
User=username<font></font>
Group=www-data<font></font>
WorkingDirectory=/var/www/djangoprojectname<font></font>
ExecStart=/var/www/djangoprojectname/env/bin/gunicorn \<font></font>
          --access-logfile - \<font></font>
          --workers <span class="hljs-number">5</span> \<font></font>
          --bind unix:/run/gunicorn.sock \<font></font>
          myproject.wsgi:application<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸è¦å¿˜è®°æŒ‡å‡ºæ‚¨çš„ç”¨æˆ·ï¼Œé¡¹ç›®åç§°å’Œè™šæ‹Ÿç¯å¢ƒã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­£å¦‚æˆ‘æ‰€è§£é‡Šçš„ï¼Œå·¥ä½œäººå‘˜çš„è®¡ç®—æ–¹å¼</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¤„ç†å™¨å†…æ ¸</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font><b><font style="vertical-align: inherit;">æ•°é‡* 2 +1</font></b><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å¯åŠ¨å¹¶æ¿€æ´»Gunicornå¥—æ¥å­—ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl start gunicorn.socket<font></font>
sudo systemctl <span class="hljs-built_in">enable</span> gunicorn.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶ç¡®ä¿æµ‹è¯•ä¸€åˆ‡æ­£å¸¸ï¼</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl status gunicorn.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº”è¯¥æ˜¾ç¤ºæœ‰å…³æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ä¿¡æ¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŒ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é”®</font><font style="vertical-align: inherit;">é€€å‡ºï¼ˆåœ¨è‹±è¯­å¸ƒå±€ä¸­æ˜¯å¿…éœ€çš„ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">file /run/gunicorn.sock</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åä¸€æ¡å‘½ä»¤åº”æ˜¾ç¤ºæœ‰å…³è¯¥æ–‡ä»¶çš„æ¶ˆæ¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœç¬¬ä¸€ä¸ª</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo systemctl status gunicorn.socketå‘½ä»¤å¤±è´¥</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ–è€…ç¬¬äºŒä¸ª</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶/run/gunicorn.sockå‘½ä»¤</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠ¥å‘Šgunicorn.sockæ–‡ä»¶ä¸åœ¨ç›®å½•ä¸­ï¼Œåˆ™æ— æ³•åˆ›å»ºGunicornå¥—æ¥å­—ã€‚</font><font style="vertical-align: inherit;">æ‚¨éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥Gunicornå¥—æ¥å­—æ—¥å¿—ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo journalctl -u gunicorn.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰¾å‡ºé”™è¯¯æ‰€åœ¨ï¼Œç„¶åè§£å†³ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ç»§ç»­æµ‹è¯•å¥—æ¥å­—æ¿€æ´»ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl status gunicorn</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨æœ€æœ‰å¯èƒ½è·å¾—è®°å½•ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">Active: inactive (dead)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡è¿›å±•é¡ºåˆ©ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡å·æ›²ä¸æ’åº§å»ºç«‹è¿æ¥ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">curl --unix-socket /run/gunicorn.sock localhost</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯èƒ½å¼•å‘é”™è¯¯è¯·æ±‚ï¼ˆ400ï¼‰é”™è¯¯ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°è¯•ä»£æ›¿</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥æŒ‡å®š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœåŠ¡å™¨</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font><b><font style="vertical-align: inherit;">IP</font></b><font style="vertical-align: inherit;">ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œåˆ™å¾ˆå¯èƒ½æ˜¯ç”±äºæˆ‘ä»¬å°šæœªå®Œæˆçš„nginxè®¾ç½®ã€‚</font><font style="vertical-align: inherit;">ç»§ç»­å‰è¿›ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å†æ¬¡ï¼Œè¯·æ±‚çŠ¶æ€è¾“å‡ºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl status gunicorn</code></pre><br>
<pre><code class="bash hljs">Active: active (running)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœè®°å½•æ˜¯â€œ +â€ï¼Œé‚£ä¹ˆä»ç„¶æœ‰å¾ˆå¤šä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å…³äºé”™è¯¯çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦åˆ™ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯</font></font><br>
<br>
<pre><code class="bash hljs">sudo journalctl -u gunicorn</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶é‡æ–°å¯åŠ¨Gunicornè¿›ç¨‹</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl daemon-reload<font></font>
sudo systemctl restart gunicorn</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NGINXè®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä¸ºæˆ‘ä»¬çš„ç«™ç‚¹åˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡å™¨å—å¹¶å¯¹å…¶è¿›è¡Œé…ç½®ï¼Œä»¥ä¾¿åœ¨åœ°å€æ ä¸­è®¿é—®æˆ‘ä»¬çš„ç«™ç‚¹æ—¶ï¼ŒæœåŠ¡å™¨äº†è§£ä»ä½•å¤„ä»¥åŠä»ä½•å¤„è·å–å®ƒã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/nginx/sites-available/djangoprojectname</code></pre><br>
<pre><code class="nginx hljs"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;
    <span class="hljs-attribute">server_name</span> server_domain_or_IP;<font></font>
<font></font>
    <span class="hljs-attribute">location</span> = /favicon.ico { <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>; <span class="hljs-attribute">log_not_found</span> <span class="hljs-literal">off</span>; }
    <span class="hljs-attribute">location</span> /static/ {
        <span class="hljs-attribute">alias</span> /var/www/djangoprojectname/static/;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-attribute">location</span> /media/ {
        <span class="hljs-attribute">alias</span> /var/www/djangoprojectname/media/;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-attribute">location</span> / {
        <span class="hljs-attribute">include</span> proxy_params;
        <span class="hljs-attribute">proxy_pass</span> http://unix:/run/gunicorn.sock;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨sever_nameéƒ¨åˆ†ä¸­ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå¤šä¸ªç”¨ç©ºæ ¼åˆ†éš”çš„åœ°å€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æµ‹è¯•è¯­æ³•é”™è¯¯ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo nginx -t</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¯·é‡æ–°å¯åŠ¨æœåŠ¡å™¨å¹¶ä¸ºæˆ‘ä»¬çš„é˜²ç«å¢™æˆäºˆå¿…è¦çš„æƒé™ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl restart nginx<font></font>
sudo ufw allow <span class="hljs-string">'Nginx Full'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨è¿˜å¯ä»¥åˆ é™¤å¯¹ç«¯å£8000çš„è®¿é—®</font></font><br>
<br>
<pre><code class="bash hljs">sudo ufw delete allow 8000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä¸€åˆ‡éƒ½åº”è¯¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ç›´åˆ°æˆ‘é…ç½®äº†httpsï¼Œå®ƒå¯¹æˆ‘æ¥è¯´è¿˜æ˜¯æ— æ³•æ­£å¸¸å·¥ä½œã€‚</font><font style="vertical-align: inherit;">ä¸å¹¸çš„æ˜¯ï¼Œå°½ç®¡åª’ä½“æ–‡ä»¶å·²æ­£å¸¸åŠ è½½ï¼Œä½†æˆ‘æ— æ³•è§£é‡Šå®ƒçš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰åŠ è½½é™æ€å˜é‡ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPSè®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cerbotè¿›è¡Œé…ç½®</font></font></a><br>
<br>
<pre><code class="bash hljs">sudo apt-get install certbot python-certbot-nginx<font></font>
sudo certbot â€“nginx<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶æŒ‰ç…§å±å¹•ä¸Šçš„æç¤ºè¿›è¡Œæ“ä½œã€‚</font><font style="vertical-align: inherit;">å¦‚æœæœ‰é”™è¯¯ï¼Œåˆ™æ¶ˆé™¤å¹¶é‡è¯•ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æŒ‡å®šä¸è¯¥æœåŠ¡å™¨æ— å…³çš„åŸŸåï¼Œåˆ™å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦è‡ªåŠ¨ç»­è®¢è¯ä¹¦ï¼Œè¯·è¾“å…¥å‘½ä»¤ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo certbot renew --dry-run </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬æ­£åœ¨æµ‹è¯•è¯¥ç½‘ç«™ï¼Œä¸€åˆ‡æ­£å¸¸ï¼</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœé™æ€æ¶ˆæ¯ä»ç„¶æ²¡æœ‰å‡ºç°ï¼Œè¯·å°è¯•æ‰“å¼€ä¸€äº›æŒ‡å‘å…¶å®Œæ•´åœ°å€çš„cssæ–‡ä»¶ï¼Œå¦‚æœå‡ºç°403é”™è¯¯ï¼Œåˆ™ä¸€åˆ‡æ­£å¸¸ï¼Œä½†éœ€è¦å°è¯•ä½¿ç”¨è®¿é—®æƒé™é—®é¢˜ï¼Œè¯·å°è¯•å°†</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www-dataçš„</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰æƒé™è®¾ç½®é‡ç½®</font><font style="vertical-align: inherit;">ä¸ºç›®å½•</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / www</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœé”™è¯¯æ˜¯404ï¼Œåˆ™éœ€è¦æŸ¥çœ‹</font><b><font style="vertical-align: inherit;">NGINX</font></b><font style="vertical-align: inherit;">è®¾ç½®ä¸­</font><font style="vertical-align: inherit;">çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½ç½®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¾ç½®</font><font style="vertical-align: inherit;">ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQLè®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®¾ç½®PostgreSQLå¹¶ä»SQLiteå¯¼å…¥æ•°æ®ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä¸éœ€è¦å®ƒï¼Œè¯·è·³è¿‡æ­¤æ­¥éª¤ï¼Œæˆ–ä»…è¿›è¡ŒPostgreSQLè®¾ç½®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç”¨æˆ·ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo -u postgres psql</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> dbforproject;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> projectdbuser <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">PASSWORD</span> <span class="hljs-string">'password'</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†éµå¾ªæœ‰å…³Djangoé¡¹ç›®çš„å»ºè®®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å°†é»˜è®¤ç¼–ç è®¾ç½®ä¸ºUTF-8ï¼Œå°†é»˜è®¤äº‹åŠ¡éš”ç¦»æ–¹æ¡ˆè®¾ç½®ä¸ºâ€œè¯»å–å·²æäº¤â€ï¼Œä»¥é˜»æ­¢ä»æœªç¡®è®¤çš„äº‹åŠ¡ä¸­è¯»å–ã€‚</font><font style="vertical-align: inherit;">å°†æ—¶åŒºè®¾ç½®ä¸ºGMTï¼ˆUTCï¼‰ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">ROLE</span> projectdbuser <span class="hljs-keyword">SET</span> client_encoding <span class="hljs-keyword">TO</span> <span class="hljs-string">'utf8'</span>;
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">ROLE</span> projectdbuser <span class="hljs-keyword">SET</span> default_transaction_isolation <span class="hljs-keyword">TO</span> <span class="hljs-string">'read committed'</span>;
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">ROLE</span> projectdbuser <span class="hljs-keyword">SET</span> timezone <span class="hljs-keyword">TO</span> <span class="hljs-string">'UTC'</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¹‹åï¼Œæ‚¨éœ€è¦å‘æˆ‘ä»¬åˆ›å»ºçš„ç”¨æˆ·æä¾›è®¿é—®æƒé™ä»¥ç®¡ç†æ–°æ•°æ®åº“ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DATABASE</span> dbforproject <span class="hljs-keyword">TO</span> projectdbuser;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Œæˆæ‰€æœ‰å‘½ä»¤åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å…³é—­PostgreSQLå¯¹è¯æ¡†ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">\q</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨PostgreSQLé…ç½®å·²å®Œæˆï¼Œç°åœ¨æˆ‘ä»¬å°†Djangoé…ç½®ä¸ºå¯ä¸PostreSQLä¸€èµ·æ­£å¸¸ä½¿ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œä»SQLiteå¤åˆ¶æ—§æ•°æ®ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œè¯·è½¬åˆ°æ‚¨çš„é¡¹ç›®å¹¶å¯åŠ¨è™šæ‹Ÿç¯å¢ƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /var/www/djangoprojectname
<span class="hljs-built_in">source</span> ./env/bin/activate
<span class="hljs-built_in">cd</span> mainappname/<font></font>
python3.8 manage.py dumpdata &gt; datadump.json</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ”¹ç”¨äºè¿æ¥æ•°æ®åº“çš„è®¾ç½®ï¼š</font></font><br>
<br>
<pre><code class="python hljs">DATABASES = {
    <span class="hljs-string">'default'</span>: {
        <span class="hljs-string">'ENGINE'</span>: <span class="hljs-string">'django.db.backends.postgresql_psycopg2'</span>,
        <span class="hljs-string">'NAME'</span>: <span class="hljs-string">'dbforproject'</span>,
        <span class="hljs-string">'USER'</span>: <span class="hljs-string">'projectdbuser'</span>,
        <span class="hljs-string">'PASSWORD'</span>: <span class="hljs-string">'password'</span>,
        <span class="hljs-string">'HOST'</span>: <span class="hljs-string">'localhost'</span>,
        <span class="hljs-string">'PORT'</span>: <span class="hljs-string">''</span>,<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œæ•°æ®åº“è¿ç§»ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3.8 manage.py migrate --run-syncdb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™ä¸ªshellä¹‹åï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3 manage.py shell</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶å†™åœ¨é‡Œé¢ï¼š</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> django.contrib.contenttypes.models <span class="hljs-keyword">import</span> ContentType
<span class="hljs-meta">&gt;&gt;&gt; </span>ContentType.objects.all().delete()
<span class="hljs-meta">&gt;&gt;&gt; </span>quit()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶ä»SQLiteåŠ è½½ä»¥å‰ä¸Šä¼ çš„æ•°æ®ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">python3.8 manage.py loaddata datadump.json</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±æ˜¯æ‰€æœ‰è¿™äº›ï¼Œå¯¹æˆ‘æ¥è¯´éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå®ƒéå¸¸ä¸ªåˆ«ï¼Œå› æ­¤ï¼Œæˆ‘å»ºè®®ä¸è¦è·³è¿‡æ€§èƒ½æµ‹è¯•çš„æ­¥éª¤ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥äº†è§£é”™è¯¯å‘ç”Ÿåœ¨å“ªä¸ªé˜¶æ®µã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å†™ä½œæ—¶ï¼Œæˆ‘ä½¿ç”¨äº†ï¼š</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.digitalocean.com/community/tutorials/how-to-set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-18-04-ru</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vexxhost.com/resources/tutorials/how-to-deploy-django-on-nginx-gunicorn-with-postgres</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pythonworld.ru/web/django-ubuntu1604.html</font></font></a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN501398/index.html">ä¸ºä¸–å˜‰ç ´è§£ç»å…¸çš„ã€ŠåˆºçŒ¬ç´¢å°¼å…‹ã€‹</a></li>
<li><a href="../zh-CN501404/index.html">Apple TimeCapsule / AirPort Extremeã€‚æ ¹è®¿é—®å’Œä»é™„åŠ åŒºåŸŸä¸­é€ƒè„±</a></li>
<li><a href="../zh-CN501406/index.html">LabVIEW NXG 5.0-åŸºç¡€å’Œç¨‹åºæ¡†å›¾</a></li>
<li><a href="../zh-CN501408/index.html">å¼€å‘å›¢é˜Ÿå»ºè®®æ”¹ç”¨UTF-8</a></li>
<li><a href="../zh-CN501412/index.html">PyTorchä¸Šçš„ç§»åŠ¨çœ¼åŠ¨è¿½è¸ª</a></li>
<li><a href="../zh-CN501416/index.html">å…³äºWebRTCçš„ä¸€äº›çŸ¥è¯†ï¼šä½¿ç”¨æ–¹æ³•å’Œå®è·µæ¡ˆä¾‹</a></li>
<li><a href="../zh-CN501418/index.html">ç¬¬å››å‘¨é©¬æ‹‰æ¾ï¼šåŠ¨åŠ›</a></li>
<li><a href="../zh-CN501420/index.html">åœ¨çº¿Mitapaså’ŒYouTubeèŠ‚ç›®ï¼šJUG Ruå°ç»„ç›´æ’­å‘¨</a></li>
<li><a href="../zh-CN501424/index.html">ä»Kubernetesçš„ç”Ÿæ´»ä¸­çœ‹ï¼šæˆ‘ä»¬å¦‚ä½•å°†DBMSï¼ˆä¸ä»…æ˜¯ä»è¯„è®ºç¯å¢ƒï¼‰åˆ é™¤ä¸ºé™æ€</a></li>
<li><a href="../zh-CN501426/index.html">Unisonï¼šåœ¨ä¸¤ä¸ªæœåŠ¡å™¨ä¸Šè®¾ç½®å¹¶è‡ªåŠ¨æ‰§è¡Œç›®å½•çš„åŒå‘åŒæ­¥</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>