<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äç‚öïÔ∏è ‚ùå üëñ Membuat Game Balap Pseudo-3D: Menerapkan Bukit dan Menyelesaikan Game üíÜüèø üñïüèª üë¥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagian 3. Bukit
 
 Di bagian sebelumnya, kami menciptakan game balap pseudo-tiga dimensi yang sederhana , mewujudkan jalan lurus dan kurva di dalamnya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Membuat Game Balap Pseudo-3D: Menerapkan Bukit dan Menyelesaikan Game</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499442/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 3. Bukit</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/892/231/4e8/8922314e8acebdd3ae14fba511d17294.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian sebelumnya, kami menciptakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">game balap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pseudo-tiga dimensi yang sederhana </font><font style="vertical-align: inherit;">, mewujudkan jalan lurus dan kurva di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kali ini kita akan menjaga bukit; </font><font style="vertical-align: inherit;">untungnya, itu akan jauh lebih mudah daripada menciptakan jalan yang melengkung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian pertama, kami menggunakan hukum segitiga yang sama untuk membuat proyeksi perspektif tiga dimensi:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/949/0ab/47b/9490ab47bb570b61218e46e5913c18bb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... yang mengarahkan kami untuk mendapatkan persamaan untuk memproyeksikan koordinat dunia 3d ke dalam koordinat layar 2d.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/edb/246/e18/edb246e187e7fe0eb027b53c58790c34.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... tetapi sejak itu kami hanya bekerja dengan jalan lurus, koordinat dunia hanya membutuhkan komponen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan nol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelan ini kita baik, karena untuk menambah bukit itu cukup bagi kita untuk memberikan ruas jalan yang sesuai nol koordinat </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , setelah fungsi yang ada akan </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara ajaib bekerja.</font></font><a name="habracut"></a><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ede/dc6/295/ededc629516e6f0d2c7f1ca6b111e17d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya, itu cukup untuk mendapatkan bukit. </font><font style="vertical-align: inherit;">Tambahkan saja komponen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke koordinat dunia dari setiap ruas jalan </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perubahan geometri jalan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan memodifikasi metode yang ada </font></font><code>addSegment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehingga fungsi yang memanggilnya dapat melewati </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p2.world.y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p1.world.y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan sesuai dengan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p2.world.y dari</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> segmen sebelumnya:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSegment</span>(<span class="hljs-params">curve, y</span>) </span>{
  <span class="hljs-keyword">var</span> n = segments.length;<font></font>
  segments.push({<font></font>
     <span class="hljs-attr">index</span>: n,
        <span class="hljs-attr">p1</span>: { <span class="hljs-attr">world</span>: { <span class="hljs-attr">y</span>: lastY(), <span class="hljs-attr">z</span>:  n   *segmentLength }, <span class="hljs-attr">camera</span>: {}, <span class="hljs-attr">screen</span>: {} },
        <span class="hljs-attr">p2</span>: { <span class="hljs-attr">world</span>: { <span class="hljs-attr">y</span>: y,       <span class="hljs-attr">z</span>: (n+<span class="hljs-number">1</span>)*segmentLength }, <span class="hljs-attr">camera</span>: {}, <span class="hljs-attr">screen</span>: {} },
     <span class="hljs-attr">curve</span>: curve,
     <span class="hljs-attr">color</span>: <span class="hljs-built_in">Math</span>.floor(n/rumbleLength)%<span class="hljs-number">2</span> ? COLORS.DARK : COLORS.LIGHT<font></font>
  });<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastY</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (segments.length == <span class="hljs-number">0</span>) ? <span class="hljs-number">0</span> : segments[segments.length<span class="hljs-number">-1</span>].p2.world.y;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan konstanta untuk menunjukkan </font><font style="vertical-align: inherit;">bukit </font><font style="vertical-align: inherit;">rendah ( </font></font><code>LOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), sedang ( </font></font><code>MEDIUM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dan tinggi ( </font></font><code>HIGH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> ROAD = {
  <span class="hljs-attr">LENGTH</span>: { <span class="hljs-attr">NONE</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">SHORT</span>:  <span class="hljs-number">25</span>, <span class="hljs-attr">MEDIUM</span>:  <span class="hljs-number">50</span>, <span class="hljs-attr">LONG</span>:  <span class="hljs-number">100</span> },
  <span class="hljs-attr">HILL</span>:   { <span class="hljs-attr">NONE</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">LOW</span>:    <span class="hljs-number">20</span>, <span class="hljs-attr">MEDIUM</span>:  <span class="hljs-number">40</span>, <span class="hljs-attr">HIGH</span>:   <span class="hljs-number">60</span> },
  <span class="hljs-attr">CURVE</span>:  { <span class="hljs-attr">NONE</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">EASY</span>:    <span class="hljs-number">2</span>, <span class="hljs-attr">MEDIUM</span>:   <span class="hljs-number">4</span>, <span class="hljs-attr">HARD</span>:    <span class="hljs-number">6</span> }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubah metode yang ada </font></font><code>addRoad()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehingga menerima argumen </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan digunakan bersama dengan fungsi kelancaran untuk naik dan turun bertahap dari bukit:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRoad</span>(<span class="hljs-params">enter, hold, leave, curve, y</span>) </span>{
  <span class="hljs-keyword">var</span> startY   = lastY();
  <span class="hljs-keyword">var</span> endY     = startY + (Util.toInt(y, <span class="hljs-number">0</span>) * segmentLength);
  <span class="hljs-keyword">var</span> n, total = enter + hold + leave;
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; enter ; n++)<font></font>
    addSegment(Util.easeIn(<span class="hljs-number">0</span>, curve, n/enter), Util.easeInOut(startY, endY, n/total));
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; hold  ; n++)<font></font>
    addSegment(curve, Util.easeInOut(startY, endY, (enter+n)/total));<font></font>
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; leave ; n++)<font></font>
    addSegment(Util.easeInOut(curve, <span class="hljs-number">0</span>, n/leave), Util.easeInOut(startY, endY, (enter+hold+n)/total));<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih jauh, mirip dengan apa yang kita lakukan di bagian 2 </font></font><code>addSCurves()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kita dapat memaksakan metode apa pun yang kita butuhkan untuk membangun geometri, misalnya:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLowRollingHills</span>(<span class="hljs-params">num, height</span>) </span>{<font></font>
  num    = num    || ROAD.LENGTH.SHORT;<font></font>
  height = height || ROAD.HILL.LOW;<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>,  height/<span class="hljs-number">2</span>);<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>, -height);<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>,  height);<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>);<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>,  height/<span class="hljs-number">2</span>);<font></font>
  addRoad(num, num, num,  <span class="hljs-number">0</span>,  <span class="hljs-number">0</span>);<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perubahan pada metode pembaruan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam permainan arcade yang kami buat, kami tidak akan mencoba mensimulasikan kenyataan, jadi bukit tidak mempengaruhi pemain atau dunia game dengan cara apa pun, yang berarti bahwa </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perubahan tidak diperlukan </font><font style="vertical-align: inherit;">dalam metode ini </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendering bukit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode ini </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga tidak memerlukan perubahan, karena persamaan proyeksi awalnya ditulis untuk memproyeksikan ruas jalan dengan benar dengan koordinat </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bukan nol </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Latar Belakang Menggulir Parallax</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain menambahkan koordinat </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke semua ruas jalan </font><font style="vertical-align: inherit;">, satu-satunya perubahan adalah implementasi perpindahan vertikal lapisan latar belakang bersama dengan bukit-bukit (sama seperti mereka bergerak secara horizontal bersama dengan kurva). </font><font style="vertical-align: inherit;">Kami menerapkan ini dengan argumen lain ke fungsi helper </font></font><code>Render.background</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mekanisme paling sederhana akan menjadi perpindahan latar belakang yang biasa relatif terhadap posisi </font></font><code>playerY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(yang harus diinterpolasi dari posisi dunia </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y dari</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> segmen pemain saat ini). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini bukan perilaku yang paling realistis, karena mungkin perlu mempertimbangkan kemiringan segmen jalan pemain saat ini, tetapi efek ini sederhana dan bekerja cukup baik untuk demo sederhana.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu saja, sekarang kita bisa melengkapi kurva palsu dengan bukit nyata:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/892/231/4e8/8922314e8acebdd3ae14fba511d17294.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pekerjaan yang kami lakukan pada bagian pertama, termasuk infrastruktur untuk menambahkan bukit 3d nyata yang diproyeksikan, saya hanya tidak memberi tahu Anda tentang ini sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian akhir artikel kami akan menambahkan sprite, serta pohon dan papan iklan di sepanjang tepi jalan. </font><font style="vertical-align: inherit;">Kami juga akan menambahkan mobil-mobil lain yang memungkinkan untuk bersaing, pengakuan tabrakan dan memperbaiki "catatan lingkaran" pemain.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 4. Versi siap</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/103/563/0d1/1035630d19106de2f85edebb24d0421f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian ini kami akan menambahkan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Papan iklan dan pohon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mobil lain</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengakuan Tabrakan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AI mobil belum sempurna</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antarmuka dengan timer putaran dan catatan putaran</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dan ini akan memberi kita tingkat interaktivitas yang memadai untuk akhirnya menyebut proyek kita sebagai "permainan."</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan tentang struktur kode</font></font></h2><br>
<blockquote><em>     ,            /,         Javascript.</em></blockquote><br>
<blockquote><em>                .     () ,             ...</em></blockquote><br>
<blockquote><em>‚Ä¶      ,       ,           ,  ,         .</em></blockquote><br>
<h2></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f6f/111/acc/f6f111accbba448459e25c6fe761ff05.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian 1, sebelum awal siklus permainan, kami mengunggah sprite sheet yang berisi semua mobil, pohon, dan papan iklan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat secara manual membuat lembar sprite dalam editor gambar apa pun, tetapi lebih baik untuk mempercayakan penyimpanan gambar dan perhitungan koordinat ke alat otomatis. </font><font style="vertical-align: inherit;">Dalam kasus saya, lembar sprite dihasilkan oleh tugas Rake kecil menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pabrik sprite Ruby Gem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugas ini menghasilkan gabungan spritesheets dari file gambar terpisah, dan juga menghitung koordinat x, y, w, h, yang akan disimpan dalam konstanta </font></font><code>SPRITES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> SPRITES = {
  <span class="hljs-attr">PALM_TREE</span>:   { <span class="hljs-attr">x</span>:    <span class="hljs-number">5</span>, <span class="hljs-attr">y</span>:    <span class="hljs-number">5</span>, <span class="hljs-attr">w</span>:  <span class="hljs-number">215</span>, <span class="hljs-attr">h</span>:  <span class="hljs-number">540</span> },
  <span class="hljs-attr">BILLBOARD08</span>: { <span class="hljs-attr">x</span>:  <span class="hljs-number">230</span>, <span class="hljs-attr">y</span>:    <span class="hljs-number">5</span>, <span class="hljs-attr">w</span>:  <span class="hljs-number">385</span>, <span class="hljs-attr">h</span>:  <span class="hljs-number">265</span> },<font></font>
<font></font>
  <span class="hljs-comment">// ... etc</span><font></font>
<font></font>
  <span class="hljs-attr">CAR04</span>:       { <span class="hljs-attr">x</span>: <span class="hljs-number">1383</span>, <span class="hljs-attr">y</span>:  <span class="hljs-number">894</span>, <span class="hljs-attr">w</span>:   <span class="hljs-number">80</span>, <span class="hljs-attr">h</span>:   <span class="hljs-number">57</span> },
  <span class="hljs-attr">CAR01</span>:       { <span class="hljs-attr">x</span>: <span class="hljs-number">1205</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">1018</span>, <span class="hljs-attr">w</span>:   <span class="hljs-number">80</span>, <span class="hljs-attr">h</span>:   <span class="hljs-number">56</span> },<font></font>
};</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan papan iklan dan pohon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan ke setiap segmen jalan array yang akan berisi sprite objek di sepanjang tepi jalan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap sprite terdiri dari yang </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diambil dari koleksi </font></font><code>SPRITES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bersama-sama dengan offset horizontal </font></font><code>offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang dinormalisasi sehingga -1 menunjukkan tepi kiri jalan, dan +1 berarti tepi kanan, yang memungkinkan kita untuk tidak bergantung pada nilai </font></font><code>roadWidth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa sprite ditempatkan dengan sengaja, yang lain diacak.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSegment</span>(<span class="hljs-params"></span>) </span>{<font></font>
  segments.push({<font></font>
    ...<font></font>
    sprites: [],<font></font>
    ...<font></font>
  });<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSprite</span>(<span class="hljs-params">n, sprite, offset</span>) </span>{<font></font>
  segments[n].sprites.push({ <span class="hljs-attr">source</span>: sprite, <span class="hljs-attr">offset</span>: offset });<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetSprites</span>(<span class="hljs-params"></span>) </span>{<font></font>
<font></font>
  addSprite(<span class="hljs-number">20</span>,  SPRITES.BILLBOARD07, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">40</span>,  SPRITES.BILLBOARD06, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">60</span>,  SPRITES.BILLBOARD08, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">80</span>,  SPRITES.BILLBOARD09, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">100</span>, SPRITES.BILLBOARD01, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">120</span>, SPRITES.BILLBOARD02, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">140</span>, SPRITES.BILLBOARD03, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">160</span>, SPRITES.BILLBOARD04, <span class="hljs-number">-1</span>);<font></font>
  addSprite(<span class="hljs-number">180</span>, SPRITES.BILLBOARD05, <span class="hljs-number">-1</span>);<font></font>
<font></font>
  addSprite(<span class="hljs-number">240</span>, SPRITES.BILLBOARD07, <span class="hljs-number">-1.2</span>);<font></font>
  addSprite(<span class="hljs-number">240</span>, SPRITES.BILLBOARD06,  <span class="hljs-number">1.2</span>);<font></font>
<font></font>
  <font></font>
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">250</span> ; n &lt; <span class="hljs-number">1000</span> ; n += <span class="hljs-number">5</span>) {<font></font>
    addSprite(n, SPRITES.COLUMN, <span class="hljs-number">1.1</span>);<font></font>
    addSprite(n + Util.randomInt(<span class="hljs-number">0</span>,<span class="hljs-number">5</span>), SPRITES.TREE1, <span class="hljs-number">-1</span> - (<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>));<font></font>
    addSprite(n + Util.randomInt(<span class="hljs-number">0</span>,<span class="hljs-number">5</span>), SPRITES.TREE2, <span class="hljs-number">-1</span> - (<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>));<font></font>
  }<font></font>
<font></font>
  ...<font></font>
}</code></pre><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: jika kita membuat game nyata, kita bisa menulis editor jalan untuk membuat peta dengan bukit dan kurva secara visual, serta menambahkan mekanisme untuk mengatur sprite di sepanjang jalan ... tetapi untuk tugas kita, kita bisa melakukannya secara terprogram </font></font><code>addSprite()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan mesin</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain sprite objek di tepi jalan, kami akan menambahkan koleksi mobil yang akan menempati setiap segmen bersama dengan koleksi terpisah dari </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semua</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mobil di jalan raya.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> cars      = [];  <span class="hljs-comment">// array of cars on the road</span>
<span class="hljs-keyword">var</span> totalCars = <span class="hljs-number">200</span>; <span class="hljs-comment">// total number of cars on the road</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSegment</span>(<span class="hljs-params"></span>) </span>{<font></font>
  segments.push({<font></font>
    ...<font></font>
    cars: [], <span class="hljs-comment">// array of cars within this segment</span><font></font>
    ...<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyimpanan dua struktur data mobil memungkinkan kita untuk dengan mudah berkeliling semua mobil dalam suatu metode </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, memindahkannya dari satu segmen ke segmen lainnya jika perlu; </font><font style="vertical-align: inherit;">pada saat yang sama, ini memungkinkan kami untuk mengeksekusi </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya mesin pada segmen yang terlihat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap mesin diberi perpindahan horizontal acak, posisi z, sumber sprite, dan kecepatan:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetCars</span>(<span class="hljs-params"></span>) </span>{<font></font>
  cars = [];<font></font>
  <span class="hljs-keyword">var</span> n, car, segment, offset, z, sprite, speed;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span> ; n &lt; totalCars ; n++) {<font></font>
    offset = <span class="hljs-built_in">Math</span>.random() * Util.randomChoice([<span class="hljs-number">-0.8</span>, <span class="hljs-number">0.8</span>]);<font></font>
    z      = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * segments.length) * segmentLength;<font></font>
    sprite = Util.randomChoice(SPRITES.CARS);<font></font>
    speed  = maxSpeed/<span class="hljs-number">4</span> + <span class="hljs-built_in">Math</span>.random() * maxSpeed/(sprite == SPRITES.SEMI ? <span class="hljs-number">4</span> : <span class="hljs-number">2</span>);<font></font>
    car = { <span class="hljs-attr">offset</span>: offset, <span class="hljs-attr">z</span>: z, <span class="hljs-attr">sprite</span>: sprite, <span class="hljs-attr">speed</span>: speed };<font></font>
    segment = findSegment(car.z);<font></font>
    segment.cars.push(car);<font></font>
    cars.push(car);<font></font>
  }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendering bukit (kembali)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian sebelumnya, saya berbicara tentang render segmen jalan, termasuk kurva dan bukit, tetapi ada beberapa baris kode di dalamnya yang tidak saya pertimbangkan. Mereka memperhatikan variabel yang </font></font><code>maxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dimulai dari bagian bawah layar, tetapi menurun ketika merender setiap segmen untuk menentukan bagian mana dari layar yang telah kami render:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; drawDistance ; n++) {<font></font>
<font></font>
  ...<font></font>
<font></font>
  if ((segment.p1.camera.z &lt;= cameraDepth) || <span class="hljs-comment">// behind us</span>
      (segment.p2.screen.y &gt;= maxy))          <span class="hljs-comment">// clip by (already rendered) segment</span>
    <span class="hljs-keyword">continue</span>;<font></font>
<font></font>
  ...<font></font>
<font></font>
  maxy = segment.p2.screen.y;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini akan memungkinkan kami untuk memotong segmen yang akan ditutupi oleh bukit yang telah diberikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algoritme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tradisional </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">artis,</font></a><font style="vertical-align: inherit;"> rendering biasanya terjadi dari belakang ke depan, sementara segmen yang lebih dekat menimpa yang jauh. </font><font style="vertical-align: inherit;">Namun, kami tidak dapat menghabiskan waktu merender poligon, yang pada akhirnya akan ditimpa, sehingga menjadi lebih mudah untuk me-render dari depan ke belakang dan memotong segmen yang jauh yang dicakup oleh segmen yang telah diberikan di dekat segmen jika koordinat yang diproyeksikannya lebih kecil </font></font><code>maxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rendering baliho, pohon, dan mobil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, traversal berulang dari ruas jalan dari depan ke belakang tidak akan berfungsi ketika merender sprite, karena mereka sering tumpang tindih satu sama lain, dan karenanya harus dirender menggunakan algoritme artis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini memperumit metode kami </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan memaksa kami untuk memotong segmen jalan dalam dua tahap:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depan ke belakang untuk perenderan jalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mundur untuk rendering sprite</font></font></li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8db/7d3/347/8db7d3347ac49621e67b7bbe2028fc6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain sprite sebagian tumpang tindih, kita perlu berurusan dengan sprite yang "sedikit menonjol" karena cakrawala di bagian atas bukit. Jika sprite cukup tinggi, maka kita harus melihat bagian atasnya, bahkan jika ruas jalan tempat ia berada berada di belakang bukit, dan karenanya tidak dirender. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita dapat memecahkan masalah terakhir dengan menyimpan nilai </font></font><code>maxy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setiap segmen sebagai garis </font></font><code>clip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di tahap 1. Kemudian kita dapat memotong sprite dari segmen ini di sepanjang garis </font></font><code>clip</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam tahap 2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sisa dari rendering logic menentukan bagaimana skala dan posisi sprite berdasarkan pada koefisien </font></font><code>scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan koordinat </font></font><code>screen</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">segmen jalan (dihitung berdasarkan tahap 1), karena pada tahap kedua metode ini </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kita memiliki hal-hal berikut:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// back to front painters algorithm</span>
<span class="hljs-keyword">for</span>(n = (drawDistance<span class="hljs-number">-1</span>) ; n &gt; <span class="hljs-number">0</span> ; n--) {<font></font>
  segment = segments[(baseSegment.index + n) % segments.length];<font></font>
<font></font>
  <span class="hljs-comment">// render roadside sprites</span>
  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span> ; i &lt; segment.sprites.length ; i++) {<font></font>
    sprite      = segment.sprites[i];<font></font>
    spriteScale = segment.p1.screen.scale;<font></font>
    spriteX     = segment.p1.screen.x + (spriteScale * sprite.offset * roadWidth * width/<span class="hljs-number">2</span>);<font></font>
    spriteY     = segment.p1.screen.y;<font></font>
    Render.sprite(ctx, width, height, resolution, roadWidth, sprites, sprite.source, spriteScale, spriteX, spriteY, (sprite.offset &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">-1</span> : <span class="hljs-number">0</span>), <span class="hljs-number">-1</span>, segment.clip);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">// render other cars</span>
  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span> ; i &lt; segment.cars.length ; i++) {<font></font>
    car         = segment.cars[i];<font></font>
    sprite      = car.sprite;<font></font>
    spriteScale = Util.interpolate(segment.p1.screen.scale, segment.p2.screen.scale, car.percent);<font></font>
    spriteX     = Util.interpolate(segment.p1.screen.x,     segment.p2.screen.x,     car.percent) + (spriteScale * car.offset * roadWidth * width/<span class="hljs-number">2</span>);<font></font>
    spriteY     = Util.interpolate(segment.p1.screen.y,     segment.p2.screen.y,     car.percent);<font></font>
    Render.sprite(ctx, width, height, resolution, roadWidth, sprites, car.sprite, spriteScale, spriteX, spriteY, <span class="hljs-number">-0.5</span>, <span class="hljs-number">-1</span>, segment.clip);<font></font>
  }<font></font>
<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabrakan dengan papan iklan dan pohon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat menambahkan dan membuat sprite objek di sepanjang tepi jalan, kita perlu mengubah metode </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk menentukan apakah pemain telah menemukan salah satu sprite ini di segmennya saat ini: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menggunakan metode bantu </font></font><code>Util.overlap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk menerapkan pengenalan umum dari persimpangan empat persegi panjang. </font><font style="vertical-align: inherit;">Jika persimpangan terdeteksi, kami menghentikan mobil:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> ((playerX &lt; <span class="hljs-number">-1</span>) || (playerX &gt; <span class="hljs-number">1</span>)) {
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; playerSegment.sprites.length ; n++) {<font></font>
    sprite  = playerSegment.sprites[n];<font></font>
    spriteW = sprite.source.w * SPRITES.SCALE;<font></font>
    <span class="hljs-keyword">if</span> (Util.overlap(playerX, playerW, sprite.offset + spriteW/<span class="hljs-number">2</span> * (sprite.offset &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>), spriteW)) {
      <span class="hljs-comment">// stop the car</span>
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: jika Anda mempelajari kode sebenarnya, Anda akan melihat bahwa sebenarnya kita tidak menghentikan mobil, karena itu tidak akan dapat bergerak ke samping untuk menghindari rintangan; </font><font style="vertical-align: inherit;">sebagai peretasan sederhana, kami memperbaiki posisi mereka dan membiarkan mobil "tergelincir" ke sisi sekitar sprite.</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabrakan dengan mobil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain tabrakan dengan sprite di sepanjang tepi jalan, kita perlu mengenali tabrakan dengan mobil lain, dan jika persimpangan terdeteksi, kita memperlambat pemain dengan "mendorong" dia kembali ke belakang mobil yang dia tabrak:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; playerSegment.cars.length ; n++) {<font></font>
  car  = playerSegment.cars[n];<font></font>
  carW = car.sprite.w * SPRITES.SCALE;<font></font>
  <span class="hljs-keyword">if</span> (speed &gt; car.speed) {
    <span class="hljs-keyword">if</span> (Util.overlap(playerX, playerW, car.offset, carW, <span class="hljs-number">0.8</span>)) {
      <span class="hljs-comment">// slow the car</span>
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembaruan Mesin</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar mobil lain bergerak di sepanjang jalan, kami akan memberi mereka AI paling sederhana:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">naik dengan kecepatan konstan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara otomatis berkeliling pemain ketika menyalip</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara otomatis berkeliling mobil lain ketika menyalip</font></font></li>
</ul><br>
<blockquote><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan: kita tidak perlu khawatir tentang membelokkan mobil lain di sepanjang kurva di jalan, karena kurva tidak nyata. </font><font style="vertical-align: inherit;">Jika kita membuat mobil hanya bergerak di sepanjang ruas jalan, mereka akan secara otomatis melewati kurva.</font></font></em></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua ini terjadi selama siklus permainan </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selama panggilan </font></font><code>updateCars()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di mana kami menggerakkan setiap mobil maju dengan kecepatan konstan dan beralih dari satu segmen ke yang lain jika mereka telah bergerak jarak yang cukup selama bingkai ini.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateCars</span>(<span class="hljs-params">dt, playerSegment, playerW</span>) </span>{
  <span class="hljs-keyword">var</span> n, car, oldSegment, newSegment;
  <span class="hljs-keyword">for</span>(n = <span class="hljs-number">0</span> ; n &lt; cars.length ; n++) {<font></font>
    car         = cars[n];<font></font>
    oldSegment  = findSegment(car.z);<font></font>
    car.offset  = car.offset + updateCarOffset(car, oldSegment, playerSegment, playerW);<font></font>
    car.z       = Util.increase(car.z, dt * car.speed, trackLength);<font></font>
    car.percent = Util.percentRemaining(car.z, segmentLength); <span class="hljs-comment">// useful for interpolation during rendering phase</span><font></font>
    newSegment  = findSegment(car.z);<font></font>
    <span class="hljs-keyword">if</span> (oldSegment != newSegment) {<font></font>
      index = oldSegment.cars.indexOf(car);<font></font>
      oldSegment.cars.splice(index, <span class="hljs-number">1</span>);<font></font>
      newSegment.cars.push(car);<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode ini </font></font><code>updateCarOffset()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyediakan implementasi </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"kecerdasan buatan"</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memungkinkan mesin berputar di sekitar pemain atau mesin lain. </font><font style="vertical-align: inherit;">Ini adalah salah satu metode paling kompleks dalam basis kode, dan dalam gim nyata seharusnya jauh lebih kompleks sehingga mesin tampak jauh lebih realistis daripada dalam demo sederhana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam proyek kami, kami menggunakan brute force AI naif, memaksa setiap mesin:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nantikan 20 segmen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika dia menemukan mobil yang lebih lambat di depannya yang melintasi jalannya, maka berputarlah di sekelilingnya</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">belok kanan dari rintangan di sisi kiri jalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">belok kiri dari rintangan di sisi kanan jalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">belok cukup untuk menghindari rintangan di depan dalam jarak yang tersisa</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita juga bisa menipu dengan mobil-mobil yang tidak terlihat oleh pemain, memungkinkan mereka untuk tidak saling berputar dan melewatinya. </font><font style="vertical-align: inherit;">Mereka seharusnya tampak "pintar" hanya dalam jarak pandang pemain.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateCarOffset</span>(<span class="hljs-params">car, carSegment, playerSegment, playerW</span>) </span>{<font></font>
<font></font>
  <span class="hljs-keyword">var</span> i, j, dir, segment, otherCar, otherCarW, lookahead = <span class="hljs-number">20</span>, carW = car.sprite.w * SPRITES.SCALE;<font></font>
<font></font>
  <span class="hljs-comment">// optimization, dont bother steering around other cars when 'out of sight' of the player</span>
  <span class="hljs-keyword">if</span> ((carSegment.index - playerSegment.index) &gt; drawDistance)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">1</span> ; i &lt; lookahead ; i++) {<font></font>
    segment = segments[(carSegment.index+i)%segments.length];<font></font>
<font></font>
    <span class="hljs-keyword">if</span> ((segment === playerSegment) &amp;&amp; (car.speed &gt; speed) &amp;&amp; (Util.overlap(playerX, playerW, car.offset, carW, <span class="hljs-number">1.2</span>))) {
      <span class="hljs-keyword">if</span> (playerX &gt; <span class="hljs-number">0.5</span>)<font></font>
        dir = <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (playerX &lt; <span class="hljs-number">-0.5</span>)<font></font>
        dir = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">else</span>
        dir = (car.offset &gt; playerX) ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">return</span> dir * <span class="hljs-number">1</span>/i * (car.speed-speed)/maxSpeed; <span class="hljs-comment">// the closer the cars (smaller i) and the greater the speed ratio, the larger the offset</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">for</span>(j = <span class="hljs-number">0</span> ; j &lt; segment.cars.length ; j++) {<font></font>
      otherCar  = segment.cars[j];<font></font>
      otherCarW = otherCar.sprite.w * SPRITES.SCALE;<font></font>
      <span class="hljs-keyword">if</span> ((car.speed &gt; otherCar.speed) &amp;&amp; Util.overlap(car.offset, carW, otherCar.offset, otherCarW, <span class="hljs-number">1.2</span>)) {
        <span class="hljs-keyword">if</span> (otherCar.offset &gt; <span class="hljs-number">0.5</span>)<font></font>
          dir = <span class="hljs-number">-1</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (otherCar.offset &lt; <span class="hljs-number">-0.5</span>)<font></font>
          dir = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">else</span>
          dir = (car.offset &gt; otherCar.offset) ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
        <span class="hljs-keyword">return</span> dir * <span class="hljs-number">1</span>/i * (car.speed-otherCar.speed)/maxSpeed;<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kebanyakan kasus, algoritma ini bekerja cukup baik, tetapi dengan kerumunan besar mobil di depan, kita dapat melihat bahwa mobil-mobil bergerak dari kiri ke kanan dan belakang, mencoba masuk ke celah antara dua mesin lainnya. </font><font style="vertical-align: inherit;">Ada banyak cara untuk meningkatkan keandalan AI, misalnya, Anda dapat membuat mobil melambat jika mereka melihat tidak ada ruang yang cukup untuk menghindari rintangan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antarmuka</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, kami akan membuat antarmuka HTML yang belum sempurna:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;div id = "hud"&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  &lt;span id = "speed" class = "hud"&gt; &lt;span id = "speed_value" class = "value"&gt; 0 &lt;/span&gt; mph &lt;/span&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  &lt;span id = "current_lap_time" class = "hud"&gt; Waktu: &lt;span id = "current_lap_time_value" class = "value"&gt; 0.0 &lt;/span&gt; &lt;/span&gt; </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  &lt;span id = "last_lap_time" class = "hud"&gt; Putaran Terakhir: &lt;span id = "last_lap_time_value" class = "value"&gt; 0.0 &lt;/span&gt; &lt;/span&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  &lt;span id = "fast_lap_time" class = "hud"&gt; Lap Tercepat: &lt;span id = "fast_lap_time_value" class = "value"&gt; 0.0 &lt;/span&gt; &lt;/span&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/div&gt;</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dan tambahkan gaya CSS ke dalamnya</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-id">#hud</span>                   { <span class="hljs-attribute">position</span>: absolute; <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>; <span class="hljs-attribute">width</span>: <span class="hljs-number">640px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>; <span class="hljs-attribute">font-family</span>: Verdana, Geneva, sans-serif; <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.8em</span>; <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.4</span>); <span class="hljs-attribute">color</span>: black; <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">2px</span> solid black; <span class="hljs-attribute">box-sizing</span>: border-box; <span class="hljs-attribute">-moz-box-sizing</span>: border-box; <span class="hljs-attribute">-webkit-box-sizing</span>: border-box; }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-class">.hud</span>              { <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.6</span>); <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span>; <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black; <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>; <span class="hljs-attribute">transition-property</span>: background-color; <span class="hljs-attribute">transition-duration</span>: <span class="hljs-number">2s</span>; <span class="hljs-attribute">-webkit-transition-property</span>: background-color; <span class="hljs-attribute">-webkit-transition-duration</span>: <span class="hljs-number">2s</span>; }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-id">#speed</span>            { <span class="hljs-attribute">float</span>: right; }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-id">#current_lap_time</span> { <span class="hljs-attribute">float</span>: left;  }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-id">#last_lap_time</span>    { <span class="hljs-attribute">float</span>: left; <span class="hljs-attribute">display</span>: none;  }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-id">#fast_lap_time</span>    { <span class="hljs-attribute">display</span>: block; <span class="hljs-attribute">width</span>: <span class="hljs-number">12em</span>;  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto; <span class="hljs-attribute">text-align</span>: center; <span class="hljs-attribute">transition-property</span>: background-color; <span class="hljs-attribute">transition-duration</span>: <span class="hljs-number">2s</span>; <span class="hljs-attribute">-webkit-transition-property</span>: background-color; <span class="hljs-attribute">-webkit-transition-duration</span>: <span class="hljs-number">2s</span>; }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-class">.value</span>            { <span class="hljs-attribute">color</span>: black; <span class="hljs-attribute">font-weight</span>: bold; }
<span class="hljs-selector-id">#hud</span> <span class="hljs-selector-class">.fastest</span>          { <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">215</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.5</span>); }</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... dan kami akan menjalankan pembaruannya () selama siklus permainan:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (position &gt; playerZ) {
  <span class="hljs-keyword">if</span> (currentLapTime &amp;&amp; (startPosition &lt; playerZ)) {<font></font>
    lastLapTime    = currentLapTime;<font></font>
    currentLapTime = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (lastLapTime &lt;= Util.toFloat(Dom.storage.fast_lap_time)) {<font></font>
      Dom.storage.fast_lap_time = lastLapTime;<font></font>
      updateHud(<span class="hljs-string">'fast_lap_time'</span>, formatTime(lastLapTime));<font></font>
      Dom.addClassName(<span class="hljs-string">'fast_lap_time'</span>, <span class="hljs-string">'fastest'</span>);<font></font>
      Dom.addClassName(<span class="hljs-string">'last_lap_time'</span>, <span class="hljs-string">'fastest'</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> {<font></font>
      Dom.removeClassName(<span class="hljs-string">'fast_lap_time'</span>, <span class="hljs-string">'fastest'</span>);<font></font>
      Dom.removeClassName(<span class="hljs-string">'last_lap_time'</span>, <span class="hljs-string">'fastest'</span>);<font></font>
    }<font></font>
    updateHud(<span class="hljs-string">'last_lap_time'</span>, formatTime(lastLapTime));<font></font>
    Dom.show(<span class="hljs-string">'last_lap_time'</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span> {<font></font>
    currentLapTime += dt;<font></font>
  }<font></font>
}<font></font>
<font></font>
updateHud(<span class="hljs-string">'speed'</span>,            <span class="hljs-number">5</span> * <span class="hljs-built_in">Math</span>.round(speed/<span class="hljs-number">500</span>));<font></font>
updateHud(<span class="hljs-string">'current_lap_time'</span>, formatTime(currentLapTime));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode helper </font></font><code>updateHud()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan kita untuk memperbarui elemen DOM hanya ketika nilai berubah, karena pembaruan seperti itu bisa menjadi proses yang lambat dan kita tidak boleh melakukannya pada 60fps jika nilai itu sendiri tidak berubah.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateHud</span>(<span class="hljs-params">key, value</span>) </span>{ <span class="hljs-comment">// accessing DOM can be slow, so only do it if value has changed</span>
  <span class="hljs-keyword">if</span> (hud[key].value !== value) {<font></font>
    hud[key].value = value;<font></font>
    Dom.set(hud[key].dom, value);<font></font>
  }<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/103/563/0d1/1035630d19106de2f85edebb24d0421f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fuh! </font><font style="vertical-align: inherit;">Bagian terakhir panjang, tapi kami masih selesai, dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi selesai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mencapai tahap di mana itu bisa disebut permainan. </font><font style="vertical-align: inherit;">Dia masih jauh dari </font><font style="vertical-align: inherit;">game yang sudah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selesai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tapi itu masih sebuah game. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sungguh menakjubkan bahwa kami benar-benar berhasil membuat game, meskipun sangat sederhana. </font><font style="vertical-align: inherit;">Saya tidak berencana untuk membawa proyek ini ke kondisi lengkap. </font><font style="vertical-align: inherit;">Ini harus dianggap hanya sebagai </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> topik game balap pseudo-tiga dimensi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini diposting oleh github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan Anda dapat mencoba mengubahnya menjadi gim balap yang lebih maju. </font><font style="vertical-align: inherit;">Anda juga dapat mencoba:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tambahkan efek suara ke mobil</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tingkatkan sinkronisasi musik</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengimplementasikan layar penuh</font></font></li>
<li>   (   , ,    ,  ..)</li>
<li>    </li>
<li>   (,   ..)</li>
<li>       </li>
<li> ,     </li>
<li> ,          -</li>
<li> ,     </li>
<li>   (   ,     ..)</li>
<li>    drawDistance</li>
<li>         x,y</li>
<li>     </li>
<li>      (   ,  )</li>
<li> </li>
<li> </li>
<li>     </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">koneksi garpu dan jalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perubahan malam dan siang</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kondisi cuaca</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terowongan, jembatan, awan, dinding, bangunan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kota, gurun, samudera</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan Seattle dan Space Needle ke latar belakang</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Penjahat" - tambahkan pesaing untuk bersaing</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode permainan - lap tercepat, lomba satu lawan satu (mengambil koin?, menembak penjahat?)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banyak opsi penyesuaian gameplay</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dll.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi kita selesai. </font><font style="vertical-align: inherit;">‚ÄúProyek akhir pekan‚Äù lain yang membutuhkan waktu lebih lama dari yang diharapkan, tetapi pada akhirnya hasilnya cukup bagus.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referensi</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Awal mula serangkaian artikel, jalan lurus dan kurva</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lou's Pseudo 3d Page</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tautan ke demo yang dapat diputar:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo jalan lurus</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo dengan kurva</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo bukit</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi selesai</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id499432/index.html">Otonomi Tes Unit di PHPUnit</a></li>
<li><a href="../id499434/index.html">Bagaimana menerapkan manajemen pengetahuan: manfaat "kantong", "duri burung beo" dan pemikiran klip</a></li>
<li><a href="../id499436/index.html">Enzim yang dikendalikan dari jarak jauh akan mempercepat pengobatan stroke dan cedera tulang belakang</a></li>
<li><a href="../id499438/index.html">Streaming untuk penguji dan tidak hanya</a></li>
<li><a href="../id499440/index.html">Saat kami menulis autopilot paling keren di dunia untuk lokomotif shunting</a></li>
<li><a href="../id499444/index.html">Postgres: bloat, pg_repack, dan batasan yang ditangguhkan</a></li>
<li><a href="../id499446/index.html">Menguji bootloader format STEP untuk VR</a></li>
<li><a href="../id499448/index.html">Menerapkan arsitektur SOLID dan layered di Node.js dengan TypeScript dan InversifyJS</a></li>
<li><a href="../id499450/index.html">Memilih peralatan untuk game Persia menggunakan genetika / evolusi dengan Python</a></li>
<li><a href="../id499452/index.html">Kehidupan sehari-hari seorang dokter spesialis mata di klinik: ketika dokter tidak cukup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>