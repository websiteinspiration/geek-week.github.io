<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤´ğŸ¿ ğŸ™ğŸ¼ ğŸ’ƒğŸ¼ Rã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŒ–ã•ã‚ŒãŸç§»å‹•å¹³å‡ç·šå½¢ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã™ã‚‹ã€‚NBAAPIã‚’ä»‹ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ ğŸ›‚ ğŸ‘©ğŸ½â€ğŸ« â›‘ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rã‚’ä½¿ç”¨ã—ã¦ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ç¶šã‘ã¾ã™ã€‚
 

ç´”ç²‹ã«é¢ç™½ã„å†…å®¹ã§ã‚ã£ãŸå‰å›ã®è¨˜äº‹ã¨ã¯ç•°ãªã‚Šã€ã“ã®è¨˜äº‹ã§ä½œæˆã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ã€ãƒãƒ¼ãƒ ã®ä»Šã‚·ãƒ¼ã‚ºãƒ³ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã®ã‚²ãƒ¼ãƒ ã‚’åˆ†æã™ã‚‹è¦³ç‚¹ã‹ã‚‰èˆˆå‘³æ·±ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
 

ã¾ãŸã€æ”»æ’ƒã€é˜²å¾¡ã€ãƒãƒƒãƒˆè©•ä¾¡ã®3ç¨®é¡ã®NBAãƒãƒ¼ãƒ ã®è©•ä¾¡ï¼ˆã¤ã¾ã‚Šã€æœ€...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Rã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŒ–ã•ã‚ŒãŸç§»å‹•å¹³å‡ç·šå½¢ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã™ã‚‹ã€‚NBAAPIã‚’ä»‹ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459142/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rã‚’ä½¿ç”¨ã—ã¦ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ç¶šã‘ã¾ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç´”ç²‹ã«é¢ç™½ã„å†…å®¹ã§ã‚ã£</font><font style="vertical-align: inherit;">ãŸå‰å›ã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¨˜äº‹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨ã¯ç•°ãªã‚Šã€</font><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ä½œæˆã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ã€ãƒãƒ¼ãƒ ã®ä»Šã‚·ãƒ¼ã‚ºãƒ³ã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã®ã‚²ãƒ¼ãƒ ã‚’åˆ†æã™ã‚‹è¦³ç‚¹ã‹ã‚‰èˆˆå‘³æ·±ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ãŸã€æ”»æ’ƒã€é˜²å¾¡ã€ãƒãƒƒãƒˆè©•ä¾¡ã®3ç¨®é¡ã®NBAãƒãƒ¼ãƒ ã®è©•ä¾¡ï¼ˆã¤ã¾ã‚Šã€æœ€åˆã®2ã¤ã®ãƒãƒ¼ãƒ ã®é•ã„ï¼‰ã®ç§»å‹•å¹³å‡ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¾ã™ã€‚ãã‚Œã‚‰ã«ã¤ã„ã¦ä¸€è¨€ã§è¨€ãˆã°ã€‚æ”»æ’ƒçš„ãŠã‚ˆã³é˜²å¾¡çš„è©•ä¾¡ã¯ã€ãƒãƒ¼ãƒ ãŒ100ã®æ‰€æŒå“ã«å¯¾ã—ã¦å¾—ç‚¹ã¾ãŸã¯é€ƒã—ãŸãƒã‚¤ãƒ³ãƒˆã®æ•°ã§ã™ã€‚ NETãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°-ã“ã‚Œã¯ã€100ã®æ‰€æœ‰ç‰©ã®é•ã„ã§ã™ã€‚ãã‚Œã‚‰ã«ã¤ã„ã¦ã‚‚ã£ã¨çŸ¥ã‚ŠãŸã„äººã¯èª°ã§ã‚‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨èªé›†ã‚’èª­ã‚€ã“ã¨ãŒã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚ç§ã‚‚Rã‚’ä½¿ã£ã¦å®Ÿè£…ã—ãŸè¨ˆç®—å¼ãŒã‚ã‚Šã¾ã™ãŒã€ãã‚Œã«ã¤ã„ã¦ã®è¨˜äº‹ã¯ã¾ã å…¬é–‹ã—ã¦ã„ã¾ã›ã‚“ã€‚</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§»å‹•å¹³å‡ã®ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã™ã‚‹ç†ç”±ã«ã¤ã„ã¦ã‚‚èª¬æ˜ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å€‹ã€…ã®ä¸€è‡´ã§ã¯ã€ãƒ©ãƒ³ãƒ€ãƒ æ€§ã®å‰²åˆãŒé«˜ã™ãã€ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒ70ã‹ã‚‰150ã«ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿åˆ†æãŒå½¹ã«ç«‹ãŸãªããªã‚Šã€ã‚°ãƒ©ãƒ•è‡ªä½“ãŒå¿ƒé›»å›³ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç´¯ç©å¹³å‡ã‚’å–ã‚‹ã¨ã€ã•ã‚‰ã«æ¥µç«¯ã«ãªã‚Šã¾ã™ã€‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯æ¸›è¡°å¤‰å‹•ã«ä¼¼ã¦ãŠã‚Šã€ã‚·ãƒ¼ã‚ºãƒ³çµ‚äº†æ™‚ã®ã‚²ãƒ¼ãƒ ã¯ã€æ—¢ã«é–‹å‚¬ã•ã‚Œã¦ã„ã‚‹70ã€œ75è©¦åˆã«è¿½åŠ ã•ã‚Œã¾ã™ãŒã€å®Ÿéš›ã«ã¯å…¨ä½“çš„ãªæŒ‡æ¨™ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">å¤§ã¾ã‹ã«è¨€ãˆã°ã€ãã‚Œã‚‰ã¯ã€Œè¦‹ãˆãªã„ã€ã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã®ç§»å‹•å¹³å‡ã¯ã€è¡Œãè©°ã¾ã‚Šã‹ã‚‰æŠœã‘å‡ºã™æ–¹æ³•ã§ã™ã€‚</font><font style="vertical-align: inherit;">ä¸€æ–¹ã§ã¯ã€å¶ç„¶ã®å½±éŸ¿ã¯æ¸›å°‘ã—ã€ä»–æ–¹ã§ã¯ã€çµæœã®éåº¦ã®è“„ç©ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«çµ±è¨ˆã§ã¯ã€é€šå¸¸ã€10ãƒãƒƒãƒã®ç§»å‹•å¹³å‡ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font></p><br>
<h2 id="ispolzuemye-biblioteki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã•ã‚Œã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</font></font></h2><br>
<pre><code class="plaintext hljs">library(httr)<font></font>
library(jsonlite)<font></font>
library(tidyverse)<font></font>
library(lubridate)<font></font>
library(zoo)<font></font>
library(ggthemes)<font></font>
library(gganimate)</code></pre><br>
<h2 id="poluchenie-dannyh-s-pomoschyu-nba-api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NBA APIã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã®å–å¾—</font></font></h2><br>
<p>     ,   <strong>NBA Data Retriever</strong>.       NBA API,     R  .</p><br>
<p> ,    .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">stats.nba.com</a>     .   Network -&gt; XHR   F5.       ,    .    .    ,    ,     R.     .</p><br>
<p><em>  </em></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/3ce/6cf/41f/3ce6cf41f2cb07bcd73b757b311c9c80.png"></p><br>
<p><em>    </em></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/7c8/9c4/aca/7c89c4aca8872754cdb2212bdeba85df.png"></p><br>
<p><em>  R </em></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/a43/06c/c65/a4306cc65e873df80d9501bb329cc3ca.png"></p><br>
<p>     <strong>R Studio</strong>.        <code>GET</code>  <code>http</code>. ,        (    <code>status_code</code>,   200),        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">HTTP-</a></p><br>
<pre><code class="plaintext hljs">##Adding headers<font></font>
request_headers &lt;- c(<font></font>
  "accept-encoding" = "gzip, deflate, sdch",<font></font>
  "accept-language" = "en-US,en;q=0.8",<font></font>
  "cache-control" = "no-cache",<font></font>
  "connection" = "keep-alive",<font></font>
  "host" = "stats.nba.com",<font></font>
  "pragma" = "no-cache",<font></font>
  "upgrade-insecure-requests" = "1",<font></font>
  "user-agent" = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.9 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9"<font></font>
)<font></font>
<font></font>
#Getting a response<font></font>
request &lt;- GET(adv_box_team, add_headers(request_headers))</code></pre><br>
<p>    :</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/d08/a37/841/d08a378417726a4e7ae4c535dec57836.png"></p><br>
<p>      .        <code>content</code>    json-,          <code>jsonlite</code>    <code>fromJSON</code></p><br>
<pre><code class="plaintext hljs">boxscore_data &lt;- fromJSON(content(request, as = "text"))</code></pre><br>
<p>    ,                 ,    .</p><br>
<h2 id="podgotovka-dannyh"> </h2><br>
<p>      ,     .</p><br>
<pre><code class="plaintext hljs">#Convert to tibble data and assigning column names<font></font>
table &lt;- tbl_df(data.frame(boxscore_data$resultSets$rowSet[[1]], <font></font>
stringsAsFactors = FALSE))<font></font>
names(table) &lt;- toupper(boxscore_data$resultSets$headers[[1]])</code></pre><br>
<p><code>toupper</code> â€”  ,      .         2460   46 .  ,        ,     ,      .</p><br>
<pre><code class="plaintext hljs">##Select the columns you want to analyze<font></font>
rating &lt;- table %&gt;%<font></font>
  select(TEAM_ID,<font></font>
         TEAM_ABBREVIATION,<font></font>
         TEAM_NAME,<font></font>
         GAME_ID,<font></font>
         GAME_DATE,<font></font>
         MATCHUP,<font></font>
         WL,<font></font>
         E_OFF_RATING,<font></font>
         E_DEF_RATING,<font></font>
         E_NET_RATING)</code></pre><br>
<p>   ,          : ""    E.     E-   ,    .   .</p><br>
<p>     .                : ORTG, DRTG, NRTG.   ""         <code>str_replace</code>,              .     3, 7, 9  12   ,          .        <code>stringr</code>: <code>str_sub</code>  <code>str_c</code> (  <code>paste0</code>).</p><br>
<pre><code class="plaintext hljs">## Renaming columns with E_OFF_RATING on ORTG<font></font>
rating1 &lt;- rating %&gt;%<font></font>
  rename_at(vars(starts_with("E_")),<font></font>
            list(~str_c(str_sub(., start = 3, end = 3), <font></font>
                        str_sub(., start = 7, end = 7),<font></font>
                        str_sub(., start = 9, end = 9),<font></font>
                        str_sub(., start = 12, end = 12))))</code></pre><br>
<p><strong>at</strong>    <code>dplyr</code>   ,    <code>dt[, lapply(.SD, func), .SDols = col1]</code>   <code>data.table</code>:      .     ,     "E_".</p><br>
<p> ,      ,        :</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th>TEAM_ID</th>
<th>TEAM_ABBREVIATION</th>
<th>TEAM_NAME</th>
<th>GAME_ID</th>
<th>GAME_DATE</th>
<th>MATCHUP</th>
<th>WL</th>
<th>ORTG</th>
<th>DRTG</th>
<th>NRTG</th>
</tr>
</thead>
<tbody>
<tr>
<td>1610612749</td>
<td>MIL</td>
<td>Milwaukee Bucks</td>
<td>0021801226</td>
<td>2019-04-10T00:00:00</td>
<td>MIL vs. OKC</td>
<td>L</td>
<td>102.4</td>
<td>116.8</td>
<td>-14.4</td>
</tr>
<tr>
<td>1610612766</td>
<td>CHA</td>
<td>Charlotte Hornets</td>
<td>0021801222</td>
<td>2019-04-10T00:00:00</td>
<td>CHA vs. ORL</td>
<td>L</td>
<td>121.4</td>
<td>130.1</td>
<td>-8.6</td>
</tr>
<tr>
<td>1610612758</td>
<td>SAC</td>
<td>Sacramento Kings</td>
<td>0021801230</td>
<td>2019-04-10T00:00:00</td>
<td>SAC @ POR</td>
<td>L</td>
<td>129.7</td>
<td>136.4</td>
<td>-6.8</td>
</tr>
<tr>
<td>1610612748</td>
<td>MIA</td>
<td>Miami Heat</td>
<td>0021801221</td>
<td>2019-04-10T00:00:00</td>
<td>MIA @ BKN</td>
<td>L</td>
<td>84.2</td>
<td>103.6</td>
<td>-19.4</td>
</tr>
<tr>
<td>1610612750</td>
<td>MIN</td>
<td>Minnesota Timberwolves</td>
<td>0021801228</td>
<td>2019-04-10T00:00:00</td>
<td>MIN @ DEN</td>
<td>L</td>
<td>98.3</td>
<td>103.7</td>
<td>-5.4</td>
</tr>
</tbody>
</table></div><br>
<h2 id="funkciya-rolling_offnet_rating_nba-dlya-postroeniya-grafika-i-animacii-skolzyaschego-srednego"> <strong><em>rolling_offnet_rating_nba</em></strong>       .</h2><br>
<p>,    ,  ,      .</p><br>
<p> <code>rolling_offnet_rating_nba</code>   :</p><br>
<pre><code class="plaintext hljs">rolling_offnet_rating_nba &lt;- function(table, name, variable, col1 = col1, col2 = col2)</code></pre><br>
<p><strong>table</strong> â€”     ,<br>
<strong>name</strong> â€”  ,      ("BOS", "LAL"  ..).<br>
<strong>variable</strong> â€” ,    (  , ORTG  NRTG,       )<br>
<strong>col1</strong>  <strong>col2</strong> â€”     / .</p><br>
<p>  <code>dplyr</code>    (<em>non-standard evaluation (NSE)</em>).   , ,         R.         SQL-,    ,         ,    . </p><br>
<p> <em>dplyr</em>  <strong>Tidy evaluation</strong>.      ( ,  !!)      .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>.</p><br>
<p>        ,    . (    <code>enquo</code>   ,     )</p><br>
<pre><code class="plaintext hljs">##Return the entered value in the function argument in the type quosure<font></font>
   quo_rating &lt;- enquo(variable)<font></font>
   quo_col1 &lt;- enquo(col1)<font></font>
   quo_col2 &lt;- enquo(col2)</code></pre><br>
<p>      : <strong>GAME_DATE</strong>       Date,     . ..    <code>as.numeric</code>   ,   <code>mutate</code>  <code>mutate_at</code>.       .</p><br>
<pre><code class="plaintext hljs">##Changing the data type of multiple columns<font></font>
   test1 &lt;- table %&gt;%<font></font>
     mutate(GAME_DATE = as.Date(ymd_hms(GAME_DATE))) %&gt;%<font></font>
     mutate_at(vars(ORTG:NRTG), list(~as.numeric)) %&gt;%<font></font>
     arrange(GAME_DATE)</code></pre><br>
<p>    10-     .     <code>rollmeanr</code>   <code>zoo</code>. r    ,        .       10-    ,       ,   NA    fill. <code>na.omit</code>    ,    NA .</p><br>
<pre><code class="plaintext hljs">##The calculation of the moving average  <font></font>
   team &lt;- test1 %&gt;%<font></font>
     filter(TEAM_ABBREVIATION == "DAL") %&gt;%<font></font>
     mutate(RATING = rollmeanr(ORTG, k = 10, fill= NA)) %&gt;%<font></font>
     na.omit(test1)</code></pre><br>
<p> team  :</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th>TEAM_ID</th>
<th>TEAM_ABBREVIATION</th>
<th>TEAM_NAME</th>
<th>GAME_ID</th>
<th>GAME_DATE</th>
<th>MATCHUP</th>
<th>WL</th>
<th>ORTG</th>
<th>DRTG</th>
<th>NRTG</th>
<th>RATING</th>
</tr>
</thead>
<tbody>
<tr>
<td>1610612742</td>
<td>DAL</td>
<td>Dallas Mavericks</td>
<td>0021800150</td>
<td>2018-11-06</td>
<td>DAL vs. WAS</td>
<td>W</td>
<td>116.8</td>
<td>99.2</td>
<td>17.6</td>
<td>105.51</td>
</tr>
<tr>
<td>1610612742</td>
<td>DAL</td>
<td>Dallas Mavericks</td>
<td>0021800160</td>
<td>2018-11-07</td>
<td>DAL @ UTA</td>
<td>L</td>
<td>98.5</td>
<td>112.0</td>
<td>-13.6</td>
<td>104.92</td>
</tr>
<tr>
<td>1610612742</td>
<td>DAL</td>
<td>Dallas Mavericks</td>
<td>0021800181</td>
<td>2018-11-10</td>
<td>DAL vs. OKC</td>
<td>W</td>
<td>115.0</td>
<td>101.1</td>
<td>13.9</td>
<td>104.13</td>
</tr>
<tr>
<td>1610612742</td>
<td>DAL</td>
<td>Dallas Mavericks</td>
<td>0021800193</td>
<td>2018-11-12</td>
<td>DAL @ CHI</td>
<td>W</td>
<td>98.3</td>
<td>91.0</td>
<td>7.3</td>
<td>103.03</td>
</tr>
<tr>
<td>1610612742</td>
<td>DAL</td>
<td>Dallas Mavericks</td>
<td>0021800210</td>
<td>2018-11-14</td>
<td>DAL vs. UTA</td>
<td>W</td>
<td>117.3</td>
<td>65.8</td>
<td>51.6</td>
<td>105.34</td>
</tr>
</tbody>
</table></div><br>
<p> ,      .         .            ,      .   " "  .</p><br>
<p>     , 10-  21- ( )  ,    10   (..            team     NA).</p><br>
<pre><code class="plaintext hljs">##The average, 10 and 21 ratings in the entire League.   <font></font>
  average &lt;- league %&gt;%<font></font>
    mutate(average = mean(!! quo_rating)) %&gt;%<font></font>
    select(average) %&gt;%<font></font>
    unique() %&gt;%<font></font>
    .$average<font></font>
<font></font>
   top10 &lt;- league %&gt;%<font></font>
     arrange(desc(!! quo_rating)) %&gt;%<font></font>
     select(!! quo_rating) %&gt;%<font></font>
     slice(10)<font></font>
   top10 &lt;- top10[[1]]<font></font>
<font></font>
  bottom10 &lt;- league %&gt;%<font></font>
    arrange(desc(!! quo_rating)) %&gt;%<font></font>
    select(!! quo_rating) %&gt;%<font></font>
    slice(21)<font></font>
  bottom10 &lt;- bottom10[[1]]<font></font>
<font></font>
##Getting the date of the first rollaverage  <font></font>
  data &lt;- team %&gt;%<font></font>
    select(GAME_DATE) %&gt;%<font></font>
    arrange(GAME_DATE)<font></font>
  data &lt;- data[[1,1]]</code></pre><br>
<p>       <code>slice</code>       .</p><br>
<p>   2    . ,     ,    <code>table_color</code>.      ,         ,   . </p><br>
<pre><code class="plaintext hljs">##Getting color and color_name selected color<font></font>
  color1 &lt;- table_color %&gt;%<font></font>
    filter(TEAM_ABBREVIATION == name) %&gt;%<font></font>
    select(!! quo_col1)<font></font>
  color1 &lt;- color1[[1]]<font></font>
<font></font>
  color2 &lt;- table_color %&gt;%<font></font>
    filter(TEAM_ABBREVIATION == name) %&gt;%<font></font>
    select(!! quo_col2)<font></font>
  color2 &lt;- color2[[1]]<font></font>
<font></font>
  name1 &lt;- paste0("name_", quo_name(quo_col1))<font></font>
  name2 &lt;- paste0("name_", quo_name(quo_col2))<font></font>
<font></font>
  name_color1 &lt;- table_color %&gt;%<font></font>
    filter(TEAM_ABBREVIATION == name) %&gt;%<font></font>
    select(name1)<font></font>
  name_color1 &lt;- name_color1[[1]]<font></font>
<font></font>
  name_color2 &lt;- table_color %&gt;%<font></font>
    filter(TEAM_ABBREVIATION == name) %&gt;%<font></font>
    select(name2)<font></font>
  name_color2 &lt;- name_color2[[1]]</code></pre><br>
<p>       col1  col2,      .    (  26),     ,            .          ,          .  ,     ,       col2 = col3.</p><br>
<p>      .            .       .  ,       89  90 ,        . ,          <code>ggplot2</code>     ,  aesthetic  ,   ,  1,  73.       .</p><br>
<pre><code class="plaintext hljs">##The maximum value of the rating<font></font>
  max &lt;- team %&gt;%<font></font>
    filter(RATING == max(RATING)) %&gt;%<font></font>
    select(RATING)<font></font>
  max &lt;- max[[1]]</code></pre><br>
<h2 id="postroenie-statichnogo-grafika-v-ggplot2">    <code>ggplot2</code></h2><br>
<pre><code class="plaintext hljs">##Building and save a static chart<font></font>
  Sys.setlocale("LC_ALL", "C")<font></font>
  gg &lt;- ggplot(team, aes(GAME_DATE, RATING)) +<font></font>
     geom_hline(yintercept = c(top10, bottom10), col = c("red", "blue")) +<font></font>
     annotate(geom = "text", x = as.Date(data) + 2, y = top10 - 0.2,<font></font>
              label = "TOP 10", col = "red") +<font></font>
     annotate(geom = "text", x = as.Date(data) + 2, y = bottom10 + 0.2,<font></font>
              label = "BOTTOM 10", col = "blue") +<font></font>
     geom_line(size = 2, col = if_else(team$RATING &gt; average, color1, color2)) +<font></font>
     theme_tufte() +<font></font>
     labs(title = paste0(team$TEAM_NAME, " <font></font>
     10-Game Rolling ", quo_name(quo_rating)),<font></font>
     subtitle = paste0(paste0(name_color1, " - above average ", <font></font>
                                          quo_name(quo_rating)),<font></font>
                       "\n", paste0(name_color2, " - below average ",<font></font>
                                          quo_name(quo_rating))),<font></font>
     caption = "Source: BBall Index Data &amp; Tools\nTelegram: @NBAatlantic, <font></font>
     twitter: @vshufinskiy")<font></font>
     theme(plot.title = element_text(size = 12, hjust = 0.5),<font></font>
          plot.caption = element_text(size = 10),<font></font>
          plot.subtitle = element_text(size = 9))<font></font>
   ggsave(paste0(unique(team$TEAM_NAME), quo_name(quo_rating), ".jpeg"),<font></font>
 gg, width = 8, units = "in")</code></pre><br>
<p>     <code>if_else</code>        ,        ,    ,  .    ,       X    .<br>
<img src="https://habrastorage.org/webt/3b/yv/la/3byvlasu52uwfin6f8prdwipms0.jpeg"></p><br>
<h2 id="postroenie-animacii-10-matchevogo-skolzyaschego-srednego">  10-  .</h2><br>
<p>      ,     . -,   ( ,      ),        .        ,     .</p><br>
<pre><code class="plaintext hljs">##Building animations<font></font>
  anim &lt;- gg +<font></font>
    theme(plot.title = element_text(hjust = 0.5, size = 25),<font></font>
          plot.subtitle = element_text(size = 15),<font></font>
          plot.caption = element_text(size = 15),<font></font>
          axis.text = element_text(size = 15),<font></font>
          axis.title = element_text(size = 18)) +<font></font>
    geom_text(aes(x = as.Date(data), y = max + 0.5),<font></font>
              label = paste0(quo_name(quo_rating)," ", round(team$RATING, digits = 1)), size = 6,<font></font>
              col = if_else(team$RATING &gt; average, color1, color2)) +<font></font>
    transition_reveal(GAME_DATE) +<font></font>
    labs(title = paste0(team$TEAM_NAME, " 10-Game Rolling ", quo_name(quo_rating)),<font></font>
         subtitle = paste0(paste0(name_color1, " - above average ",quo_name(quo_rating)),<font></font>
                           "\n", paste0(name_color2, " - below average ",quo_name(quo_rating)),<font></font>
                           "\n", "Date: {frame_along}"),<font></font>
         caption = paste0("Source: stats.nba.com\nTelegram: @NBAatlantic, twitter: @vshufinskiy"))</code></pre><br>
<h2 id="rezultat"></h2><br>
<p><img src="https://habrastorage.org/webt/do/b-/hy/dob-hyqopjihkywk9kaq4jsrihg.gif"></p><br>
<p>   ,       -.    :        4  5    ,    ,   ,   -     .</p><br>
<p>       ,        89   2018-19,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">sports.ru</a>,               <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">-</a>  ,      .</p><br>
<p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">GitHub</a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja459130/index.html">ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã§ã®ç©ã‚„ã‹ãªã‚¨ãƒ©ãƒ¼å‡¦ç†</a></li>
<li><a href="../ja459134/index.html">BDDã®ä½¿ç”¨çµŒé¨“</a></li>
<li><a href="../ja459136/index.html">å½ã®é’ã„éŒ å‰¤</a></li>
<li><a href="../ja459138/index.html">Huaweiã®ç§˜å¯†éµãŒCiscoãƒ«ãƒ¼ã‚¿ãƒ¼ã®ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã«å…¥ã£ãŸæ–¹æ³•</a></li>
<li><a href="../ja459140/index.html">ã‚¤ãƒ³ãƒ—ãƒ©ãƒ³ãƒˆã®é…ç½®ï¼šã“ã‚Œã¯ã©ã®ã‚ˆã†ã«è¡Œã‚ã‚Œã¾ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja459146/index.html">ãƒ•ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆ2019å¹´6æœˆ</a></li>
<li><a href="../ja459150/index.html">å…ˆé€±ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¸–ç•Œã‹ã‚‰ã®æ–°é®®ãªé£Ÿæã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆNo.372ï¼ˆ2019å¹´7æœˆ1æ—¥ã€œ7æ—¥ï¼‰</a></li>
<li><a href="../ja459152/index.html">Pythonã‚’ä½¿ç”¨ã—ã¦Microsoft Wordã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å…¥åŠ›ã—ã¾ã™ã€‚ãƒ‘ãƒ¼ãƒˆ2</a></li>
<li><a href="../ja459154/index.html">ã‚·ã‚¹ã‚³ã®æ©Ÿå™¨ã‚’ä½¿ç”¨ã™ã‚‹ä¸­å°ä¼æ¥­å‘ã‘ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€‚ãƒ‘ãƒ¼ãƒˆ1</a></li>
<li><a href="../ja459156/index.html">åœ°çƒå…¨ä½“ã®VNIITEï¼šã‚½ãƒ“ã‚¨ãƒˆé€£é‚¦ã§ã©ã®ã‚ˆã†ã«ã—ã¦ã€Œã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã€ã‚·ã‚¹ãƒ†ãƒ ã‚’è€ƒæ¡ˆã—ãŸã‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>