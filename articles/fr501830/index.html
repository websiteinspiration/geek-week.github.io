<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🤝‍👨🏾 🐸 🚼 Nous portons le projet Angular sur ESLint, avec Prettier, Husky et lint-staged 🦗 ⬛️ 👼🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Mon nom est Bogdan, je travaille en tant que chef d'équipe PIC Digital Front-End. Nous développons la plupart des projets sur Angular, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous portons le projet Angular sur ESLint, avec Prettier, Husky et lint-staged</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501830/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font><font style="vertical-align: inherit;">Mon nom est Bogdan, je travaille en tant que chef d'équipe PIC Digital Front-End. </font><font style="vertical-align: inherit;">Nous développons la plupart des projets sur Angular, et récemment j'ai décidé de revoir nos guides de style, ainsi que d'ajouter de nouveaux outils pour un travail plus pratique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que linter, j'ai décidé d'utiliser ESLint, car ils prévoient d'y transférer bientôt Angular. </font><font style="vertical-align: inherit;">Et dans cet article, je veux partager des instructions sur le passage de TSLint à ESLint, et en même temps dire comment exécuter Prettier à partir d'ESLint, comment ajouter des règles de guide de style AirBnB et comment rendre le linting pratique et invisible en définissant VS Code et Git hooks.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prettier &amp; ESLint</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESLint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un outil d'analyse de code statique, les règles sont divisées en deux groupes:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formatage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pour regrouper le code en une seule vue: longueurs de ligne, virgules, points-virgules, etc.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qualité du code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - recherche de modèles de code problématiques: code inutile, erreurs.</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prettier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un outil de formatage de code automatique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La question qui m'intéressait était: pourquoi utiliser Prettier si ESLint peut également formater du code? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La réponse est simple - Prettier formate bien mieux le code: supprime tout formatage et réécrit complètement le code dans un seul style. </font><font style="vertical-align: inherit;">Cela permet aux développeurs d'oublier la mise en forme du code et de ne pas perdre de temps à discuter du style de code pour révision. </font><font style="vertical-align: inherit;">Par exemple, nous avons une longue ligne de code: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ey/i-/u-/eyi-u-iudnfy6rscgqpgxuxpvgi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si nous essayons de changer la mise en forme via ESLint, cela nous donnera simplement une erreur:</font></font><br>
<br>
<pre><code class="bash hljs">eslint example.ts --fix<font></font>
<font></font>
output:<font></font>
error    This line has a length of 97. Maximum allowed is 80<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tel exemple montre que linter ne peut pas toujours aider à la mise en forme du code et que les développeurs peuvent formater ce code de différentes manières, en fonction de leurs considérations personnelles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous enregistrons ou formater le fichier avec Prettier, la ligne prendra la forme: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zg/mb/c9/zgmbc984enmbcpijrg5bzmq4emk.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prettier fournit un style uniforme dans toute la base de code. </font><font style="vertical-align: inherit;">Par conséquent, il peut et doit être utilisé avec ESLint, mais vous devez les configurer afin qu'ils n'interfèrent pas entre eux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration d'ESLint</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'essence du linting ESLint réside dans les analyseurs qui transforment le code en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AST</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (arbre de syntaxe abstraite) pour un traitement logiciel ultérieur, et des plugins qui contiennent des règles, par exemple, des règles recommandées pour le linting TypeScript ou des règles de guide de code AirBnB.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour migrer une application Angular vers ESLint, nous avons besoin des dépendances suivantes:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eslint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le linter lui-même,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ angular-eslint / builder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;- Angular CLI Builder pour exécuter ESLint pour les applications angulaires à l'aide de la commande standard ng lint,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ angular-eslint / eslint-plugin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;- un plugin contenant des règles pour le linting angulaire,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ angular-eslint / template-parser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;est un analyseur qui avec</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angulaire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ le compilateur permet d'écrire des règles de doublage des modèles angulaires,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ angular-eslint / eslint-plugin-template</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;- un plugin qui, lorsqu'il est utilisé avec @ angular-eslint / template-parser, lance des règles pour aligner les modèles angulaires,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ typescript-eslint / parser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - plugin pour analyser le code TypeScript,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ typescript-eslint / eslint-plugin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un plugin qui exécute les règles TypeScript pour le linting.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les installer, il suffit d'exécuter la commande:</font></font><br>
<br>
<pre><code class="bash hljs">ng add @angular-eslint/schematics</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment de l'écriture, typescript-eslint et angular-eslint n'ont pas tous les équivalents pour les règles dans la configuration standard de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codelyzer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour TSLint, mais la plupart d'entre elles existent déjà. </font><font style="vertical-align: inherit;">Vous pouvez surveiller l'état actuel du transfert des règles de TSLint vers ESLint dans les </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">mono-référentiels </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angular ESLint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeScript ESLint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration de configuration</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce dont nous avons besoin pour peloter les applications angulaires, nous les avons installées. </font><font style="vertical-align: inherit;">Passons maintenant à la configuration d'ESLint. </font><font style="vertical-align: inherit;">Créons un fichier .eslintrc.js et ajoutons les </font><font style="vertical-align: inherit;">paramètres </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommandés</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour Angular ESLint:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">extends</span>: [<span class="hljs-string">'plugin:@angular-eslint/recommended'</span>],
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-string">'@angular-eslint/directive-selector'</span>: [
      <span class="hljs-string">'error'</span>,<font></font>
      { <span class="hljs-attr">type</span>: <span class="hljs-string">'attribute'</span>, <span class="hljs-attr">prefix</span>: <span class="hljs-string">'app'</span>, <span class="hljs-attr">style</span>: <span class="hljs-string">'camelCase'</span> },<font></font>
    ],<font></font>
    <span class="hljs-string">'@angular-eslint/component-selector'</span>: [
      <span class="hljs-string">'error'</span>,<font></font>
      { <span class="hljs-attr">type</span>: <span class="hljs-string">'element'</span>, <span class="hljs-attr">prefix</span>: <span class="hljs-string">'app'</span>, <span class="hljs-attr">style</span>: <span class="hljs-string">'kebab-case'</span> },<font></font>
    ],<font></font>
  },<font></font>
  <span class="hljs-attr">overrides</span>: [
    <span class="hljs-comment">//   ,       *.component.ts</span><font></font>
    {<font></font>
      <span class="hljs-attr">files</span>: [<span class="hljs-string">'*.component.ts'</span>],
      <span class="hljs-attr">parser</span>: <span class="hljs-string">'@typescript-eslint/parser'</span>,
      <span class="hljs-attr">parserOptions</span>: {
        <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">2020</span>,
        <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,<font></font>
      },<font></font>
      <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'@angular-eslint/template'</span>],
      <span class="hljs-attr">processor</span>: <span class="hljs-string">'@angular-eslint/template/extract-inline-html'</span>,<font></font>
    },<font></font>
  ],<font></font>
};<font></font>
</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les configurations peuvent être décrites dans différents formats: fichier JavaScript, JSON ou YAML. </font><font style="vertical-align: inherit;">Vous pouvez laisser des commentaires en JavaScript.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«Plugin: @ angular-eslint / recommended» contient les paramètres de 3 plugins à la fois: «@ typescript-eslint / eslint-plugin», «@ angular-eslint / eslint-plugin» et «@ angular-eslint / eslint-plugin-template " </font><font style="vertical-align: inherit;">Vous pouvez lire les règles qu'il établit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise à jour de la commande Ng Lint</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toujours dans la configuration angular.json, vous devez mettre à jour la commande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ng lint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour exécuter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ angular-eslint / builder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="json hljs"><span class="hljs-string">"lint"</span>: {
  <span class="hljs-attr">"builder"</span>: <span class="hljs-string">"@angular-eslint/builder:lint"</span>,
  <span class="hljs-attr">"options"</span>: {
    <span class="hljs-attr">"eslintConfig"</span>: <span class="hljs-string">".eslintrc.js"</span>,
    <span class="hljs-attr">"tsConfig"</span>: [
      <span class="hljs-string">"tsconfig.app.json"</span>,
      <span class="hljs-string">"tsconfig.spec.json"</span>,
      <span class="hljs-string">"e2e/tsconfig.json"</span><font></font>
    ],<font></font>
    <span class="hljs-attr">"exclude"</span>: [
      <span class="hljs-string">"**/node_modules/**"</span><font></font>
    ]<font></font>
  }<font></font>
},<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuration de base d'ESLint est prête, vous pouvez maintenant démarrer ESLint avec la commande standard </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ng lint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installer des plugins supplémentaires</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour installer le plugin pour ESLint, par exemple, pour les tests unitaires de linting dans Angular, vous devez télécharger et ajouter le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plugin Jasmine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aux paramètres </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">npm install eslint-plugin-jasmine --save-dev
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et ajoutez un nouveau bloc de paramètres pour les fichiers avec l'extension * .spec.ts à la propriété "overrides":</font></font><br>
<br>
<pre><code class="javascript hljs">overrides: [<font></font>
  ...,<font></font>
  {<font></font>
    <span class="hljs-attr">files</span>: [<span class="hljs-string">'src/**/*.spec.ts'</span>, <span class="hljs-string">'src/**/*.d.ts'</span>],
    <span class="hljs-attr">parserOptions</span>: {
      <span class="hljs-attr">project</span>: <span class="hljs-string">'./src/tsconfig.spec.json'</span>,<font></font>
    },<font></font>
    <span class="hljs-comment">//   </span>
    <span class="hljs-attr">extends</span>: [<span class="hljs-string">'plugin:jasmine/recommended'</span>],
    <span class="hljs-comment">//    </span>
    <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'jasmine'</span>],
    <span class="hljs-attr">env</span>: { <span class="hljs-attr">jasmine</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-comment">//   'no-unused-vars'</span>
    <span class="hljs-attr">rules</span>: {
      <span class="hljs-string">'@typescript-eslint/no-unused-vars'</span>: <span class="hljs-string">'off'</span>,<font></font>
    },<font></font>
  }<font></font>
],<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par analogie, vous pouvez ajouter d'autres plugins pour différentes extensions de fichier.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout de guides de guide de style</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir une plus grande cohérence de la base de code, vous pouvez sélectionner et ajouter les règles de l'un des guides de style populaires à la configuration ESLint:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AirBnB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : le plus populaire et le plus strict des trois virgules et points-virgules de fin obligatoires.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : similaire à AirBnB en termes de formatage, mais moins strict, commentaires JSDoc obligatoires.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StandartJS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : interdit l'utilisation de virgules et de points-virgules de fin.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choisissez un guide de style plus adapté à votre équipe. </font><font style="vertical-align: inherit;">Vous pouvez à tour de rôle essayer tous les guides de style sur un grand projet, voir quelles erreurs le linter produit et en fonction de cela faire un choix.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choisissez une implémentation du guide de style TypeScript car les règles JavaScript peuvent ne pas fonctionner correctement sur TypeScript.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À titre d'exemple, ajoutons le guide de style AirBnB à notre configuration ESLint. </font><font style="vertical-align: inherit;">Pour ce faire, installez la configuration avec les règles AirBnB pour TypeScript et le plugin avec les règles pour travailler avec la syntaxe d'import / export:</font></font><br>
<br>
<pre><code class="bash hljs">npm install eslint-plugin-import eslint-config-airbnb-typescript --save-dev</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de ne pas modifier les paramètres de niveau supérieur, nous allons créer un nouveau bloc de règles dans la propriété "overrides" avec les règles du guide de style AirBnB et l'analyseur TypeScript nécessaire à leur travail:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {<font></font>
  ...,<font></font>
  <span class="hljs-attr">overrides</span>: [<font></font>
    ...,<font></font>
    {<font></font>
      <span class="hljs-attr">files</span>: [<span class="hljs-string">'*.ts'</span>],
      <span class="hljs-attr">extends</span>: [
        <span class="hljs-string">'airbnb-typescript/base'</span>,<font></font>
      ],<font></font>
      <span class="hljs-attr">parser</span>: <span class="hljs-string">'@typescript-eslint/parser'</span>,
      <span class="hljs-attr">parserOptions</span>: {
        <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">2020</span>,
        <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,<font></font>
      },<font></font>
    },<font></font>
  ]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter un autre guide de style, vous devez installer un ensemble de règles pour TypeScript, créer un nouveau bloc de règles dans "overrides" avec les règles du guide de style et spécifier l'analyseur nécessaire à leur travail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Règles de personnalisation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez désactiver ou redéfinir certaines règles dans le style du guide, vous pouvez le faire dans la propriété "rules":</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {<font></font>
  ...,<font></font>
  <span class="hljs-attr">overrides</span>: [<font></font>
    ...,<font></font>
    {<font></font>
      <span class="hljs-attr">files</span>: [<span class="hljs-string">'*.ts'</span>],
      <span class="hljs-attr">extends</span>: [
        <span class="hljs-string">'airbnb-typescript/base'</span>,<font></font>
      ],<font></font>
      <span class="hljs-attr">parser</span>: <span class="hljs-string">'@typescript-eslint/parser'</span>,
      <span class="hljs-attr">parserOptions</span>: {
        <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">2020</span>,
        <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'module'</span>,<font></font>
      },<font></font>
      <span class="hljs-comment">//  </span>
      <span class="hljs-attr">rules</span>: {
        <span class="hljs-string">'import/no-unresolved'</span>: <span class="hljs-string">'off'</span>,
        <span class="hljs-string">'import/prefer-default-export'</span>: <span class="hljs-string">'off'</span>,
        <span class="hljs-string">'class-methods-use-this'</span>: <span class="hljs-string">'off'</span>,
        <span class="hljs-string">'lines-between-class-members'</span>: <span class="hljs-string">'off'</span>,
        <span class="hljs-string">'@typescript-eslint/unbound-method'</span>: [
          <span class="hljs-string">'error'</span>,<font></font>
          {<font></font>
            <span class="hljs-attr">ignoreStatic</span>: <span class="hljs-literal">true</span>,<font></font>
          },<font></font>
        ],<font></font>
      },<font></font>
    },<font></font>
  ]<font></font>
}<font></font>
</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer Prettier</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter Prettier à notre configuration, nous devons installer Prettier lui-même, un plugin avec des règles Prettier, ainsi qu'une configuration qui désactivera toutes les règles qui peuvent entrer en conflit avec Prettier:</font></font><br>
<br>
<pre><code class="bash hljs">npm i prettier eslint-config-prettier eslint-plugin-prettier --save-dev
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les "remplacements" dans le bloc avec les règles des fichiers avec l'extension * .ts dans la propriété "étend" tout en bas, ajoutez les règles et les paramètres Prettier:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {<font></font>
  ...,<font></font>
  <span class="hljs-attr">overrides</span>: [<font></font>
    ...,<font></font>
    {<font></font>
      <span class="hljs-attr">files</span>: [<span class="hljs-string">'*.ts'</span>],
      <span class="hljs-attr">extends</span>: [
        <span class="hljs-comment">//   AirBnB</span>
	<span class="hljs-string">'airbnb-typescript/base'</span>,
	<span class="hljs-comment">//   Prettier</span>
	<span class="hljs-string">'prettier/@typescript-eslint'</span>,
	<span class="hljs-string">'plugin:prettier/recommended'</span>,<font></font>
      ],<font></font>
      ...,<font></font>
    },<font></font>
  ]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuration de Prettier doit toujours se trouver tout en bas de la liste pour remplacer toutes les règles pouvant entrer en conflit avec Prettier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
`prettier / @ typescript-eslint` désactive les règles` @ typescript-eslint`, qui peuvent entrer en conflit avec Prettier, et` plugin: prettier / recommended` fait trois choses:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comprend eslint-plugin-prettier,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprime les erreurs de règles plus jolies / plus jolies sur la console comme "erreur",</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajoute des règles de mise en forme prettier eslint-config-prettier.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Config pour Prettier:</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prettier peut formater le code sans aucun paramètre, mais pour correspondre au guide de style AirBnB, vous devez ajouter certains paramètres. </font><font style="vertical-align: inherit;">Créez le fichier .prettierrc.js à la racine de l'application:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">trailingComma</span>: <span class="hljs-string">"all"</span>,
  <span class="hljs-attr">tabWidth</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">semi</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">singleQuote</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">bracketSpacing</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">printWidth</span>: <span class="hljs-number">100</span><font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces paramètres seront utilisés à la fois par ESLint et Prettier si vous les utilisez pour formater des fichiers en VS Code ou avec la commande:</font></font><br>
<br>
<pre><code class="bash hljs">prettier <span class="hljs-string">"--write ."</span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurer le code VS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VS Code peut mettre en évidence et corriger les erreurs trouvées par ESLint lors de l'enregistrement des erreurs. </font><font style="vertical-align: inherit;">Pour ce faire, téléchargez le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plugin ESLint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour VS Code et créez un fichier dans le projet avec les paramètres de l'espace de travail .vscode / settings.json:</font></font><br>
<br>
<pre><code class="json hljs">  <span class="hljs-string">"eslint.validate"</span>: [ <span class="hljs-string">"javascript"</span>, <span class="hljs-string">"typescript"</span>, <span class="hljs-string">"html"</span>],<font></font>
<font></font>
  <span class="hljs-string">"eslint.options"</span>: {
    <span class="hljs-attr">"extensions"</span>: [<span class="hljs-string">".js"</span>, <span class="hljs-string">".ts"</span>, <span class="hljs-string">"html"</span>]<font></font>
  },<font></font>
<font></font>
  <span class="hljs-string">"editor.codeActionsOnSave"</span>: {
    <span class="hljs-attr">"source.fixAll.eslint"</span>: <span class="hljs-literal">true</span>,<font></font>
  },<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous configurons ESLint pour souligner et corriger les erreurs lors de l'enregistrement de fichiers avec les extensions .js, .ts et .html. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et pour formater un document en utilisant les combinaisons de touches «shift + option + F» ou «shift + alt + F», téléchargez le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plugin Prettier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour VS Code et définissez-le comme le formateur par défaut.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration des crochets Git</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les hooks Git sont des scripts que Git invoque sur certains événements: commit, push, recieve. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec l'aide d'eux, nous pouvons commencer à linting le code lors de la création d'un commit afin que moins d'erreurs pénètrent dans le pool de requêtes. </font><font style="vertical-align: inherit;">Pour un </font><font style="vertical-align: inherit;">travail plus pratique avec des </font><font style="vertical-align: inherit;">crochets Git, installez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Husky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et de vérifier que le code qui est ajouté au commettras (ce qui </font><font style="vertical-align: inherit;">est utile dans les </font><font style="vertical-align: inherit;">grands projets où peluchage prend beaucoup de temps) et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">non pelucheux mis en </font><font style="vertical-align: inherit;">scène</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">npm i husky lint-staged --save-dev
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez les paramètres de ces plugins à package.json:</font></font><br>
<br>
<pre><code class="json hljs"><span class="hljs-string">"scripts"</span>: {<font></font>
  ...<font></font>
},<font></font>
<span class="hljs-string">"husky"</span>: {
  <span class="hljs-attr">"hooks"</span>: {
    <span class="hljs-attr">"pre-commit"</span>: <span class="hljs-string">"lint-staged --relative"</span><font></font>
  }<font></font>
},<font></font>
<span class="hljs-string">"lint-staged"</span>: {
  <span class="hljs-attr">"*.{js,ts}"</span>: [
     <span class="hljs-string">"eslint --fix"</span><font></font>
  ]<font></font>
},<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lint-staged transmet un tableau de fichiers modifiés à la commande appelée. </font><font style="vertical-align: inherit;">La commande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ng lint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne sait pas comment accepter un tableau de fichiers et pour l'utiliser, vous devez écrire un gestionnaire de script supplémentaire. </font><font style="vertical-align: inherit;">Ou vous pouvez simplement appeler ESLint, comme dans cet exemple. </font><font style="vertical-align: inherit;">Une telle solution peut être utilisée pour les pré-engagements, et vous pouvez </font><font style="vertical-align: inherit;">exécuter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ng lint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">lint l'</font></a><font style="vertical-align: inherit;"> ensemble du projet, par exemple, dans le pipeline CI.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">résultats</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les futures versions d'Angular, ESLint avec les règles de base sera prêt à l'emploi. Maintenant, le processus de configuration ESLint nécessite quelques étapes supplémentaires, ESLint n'a pas d'équivalents pour certaines règles de TSLint et Angular ESLint est toujours en version alpha. Par conséquent, passer à ESLint maintenant ou non dépend de vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, vous devrez configurer vous-même le code guide, les règles supplémentaires, Prettier, Husky et lint-staged. J'espère que cet article vous a aidé à comprendre comment toutes ces choses fonctionnent ensemble. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La configuration des linters peut sembler une tâche triviale, mais elle comporte plusieurs problèmes d'organisation importants: choisir des guides de style, synchroniser diverses solutions entre elles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le temps consacré à la configuration du linter à l'avenir vous permettra d'économiser considérablement du temps sur le style et la mise en forme du code dans le processus de révision du code, de réduire le nombre d'erreurs qui tombent dans le pool de demandes et d'assurer la cohérence de la base de code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple d'implémentation peut être trouvé sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous trouvez une erreur dans la configuration ou si vous avez des modules complémentaires - écrivez!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Références</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dépôt monulaire Angular ESLint</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monorepositaire TypeScript ESLint</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501820/index.html">Intégration des solutions de surveillance Netflow et SIEM</a></li>
<li><a href="../fr501822/index.html">Ingénieur de troisième génération</a></li>
<li><a href="../fr501824/index.html">Se préparer pour un hackathon à la maison</a></li>
<li><a href="../fr501826/index.html">À propos des fondateurs ambitieux ou comment j'ai essayé de collecter des investissements pour une startup</a></li>
<li><a href="../fr501828/index.html">Unreal Engine 5 place la barre pour le réalisme du jeu</a></li>
<li><a href="../fr501834/index.html">Présentation des scanners 3D Creaform Metrascan</a></li>
<li><a href="../fr501846/index.html">Comment choisir un système de vidéosurveillance</a></li>
<li><a href="../fr501848/index.html">J'explique la réservation dans le data center sur la bière</a></li>
<li><a href="../fr501850/index.html">Nous démontons l'algorithme EM en petites briques</a></li>
<li><a href="../fr501854/index.html">Comment quitter la programmation et commencer à jouer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>