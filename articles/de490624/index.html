<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛏️ 👍🏻 🚏 Funktionsrichtlinien-HTTP-Header- und Webbrowser-Steuerung 🚣🏿 👩🏿‍🚒 ⤴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt eine völlig unvergleichliche Technik, mit der Sie die Leistung eines Webprojekts unter Kontrolle halten können. Es besteht darin, Mechanismen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Funktionsrichtlinien-HTTP-Header- und Webbrowser-Steuerung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490624/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt eine völlig unvergleichliche Technik, mit der Sie die Leistung eines Webprojekts unter Kontrolle halten können. Es besteht darin, Mechanismen in den Entwicklungsprozess einzuführen, deren Ergebnisse deutlich sichtbar sind. Diese Mechanismen sollen den Programmierer immer an die Bedeutung der Leistung erinnern. In diesem Zusammenhang gibt es etwas, das ich wirklich mag. Dies ist der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feature-Policy-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTTP-Header </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Dieser Titel ist eine relativ neue Funktion, mit der ein Entwickler bestimmte Browserfunktionen beim Surfen auf seiner Website ein- und ausschalten kann. </font><font style="vertical-align: inherit;">
Sie können dem Browser beispielsweise mitteilen, dass die Verwendung der Geolocation-API nicht zulässig sein soll, indem Sie ihm den folgenden Header übergeben:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/_a/mh/zz/_amhzzcwmae7goctptz7hobpnwa.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: geolocation 'none'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verwendung eines Headers </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bietet viele Vorteile in Bezug auf Sicherheit und Leistung. </font><font style="vertical-align: inherit;">Aber ich mag jetzt besonders, wie </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie es verwenden können, um Probleme mit der Website-Leistung, die normalerweise leicht zu übersehen sind, deutlicher zu machen. </font><font style="vertical-align: inherit;">Dies kann mit so etwas wie "Performance Flusen" verglichen werden. </font><font style="vertical-align: inherit;">Insbesondere geht es darum, Probleme mit Bildern zu identifizieren, die in Webprojekten verwendet werden.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Richtlinie für übergroße Bilder</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Bild in einem von ihm unterstützten Format an den Browser übertragen wird, wird ein solches Bild angezeigt. Dies ist das Standardverhalten des Browsers. Der Browser, der versucht, denjenigen zu helfen, die die Seite anzeigen, skaliert solche Bilder ebenfalls automatisch. Daher sehen sie auch dann gut aus, wenn sie durch riesige Grafikdateien dargestellt werden. Wenn Sie Bilder verwenden, die größer sind als die von der Seite benötigten Größen, ist dies auf den ersten Blick unsichtbar. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Politik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Richtlinie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teilt dem Browser mit, dass die Verwendung von Bildern, deren Größe die Größe ihrer Container um eine bestimmte Anzahl überschreitet, nicht zulässig sein soll. </font><font style="vertical-align: inherit;">Das Bild darf gemäß der Standardbeschränkung nicht mehr als das Zweifache des Containers betragen. </font><font style="vertical-align: inherit;">Dieser Wert kann jedoch bei Bedarf neu definiert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Browser den nächsten Header empfängt, können Sie keine Bilder anzeigen, die aus Quellen stammen (dies wird dank festgelegt </font></font><code>none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), deren Abmessungen mehr als das Zweifache der Größe ihrer Container (in Breite oder Höhe) betragen.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mehr Flexibilität benötigen, können Sie dem Browser mitteilen, dass keine Bilder angezeigt werden sollen, die mehr als dreimal größer als die Container sind:</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images *(3) 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In jedem Fall wird anstelle des Bildes ein Stub angezeigt und eine Fehlermeldung an die Konsole gesendet, wenn das Bild nicht den angegebenen Grenzen entspricht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c98/1e3/169/c981e3169d9219c226c13236f198c222.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die Site die Richtlinie für übergroße Bilder verwendet, werden große Bilder hochgeladen, aber stattdessen wird ein Stub angezeigt und eine Fehlermeldung in der Konsole angezeigt</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht optimierte Bilder</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiteres häufiges Problem bei Grafiken ist die Verwendung nicht optimierter Bilder. Sehr oft kann man auf Bilder stoßen, die nicht ausreichend komprimiert wurden. Ihre Größe kann jedoch korrekt ausgewählt werden. Daher können Dateien mit Fotos beim Aufnehmen und Erstellen viele unnötige Metadaten hinzugefügt werden, die häufig in Dateien verbleiben und in Browsern verwendet werden. Ein besonders ärgerliches Beispiel hierfür sind Bilder, deren Metadaten eigene Miniaturansichten zur Vorschau enthalten. Oft habe ich gesehen, wie das in das Bild eingebettete Miniaturbild (dessen Anwesenheit Designer und Entwickler nicht einmal wussten) mehr „wog“ als das Bild selbst!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier können Sie sich unter anderem an die übliche Bildkomprimierung erinnern, die von vielen Formaten unterstützt wird und die es Ihnen ermöglicht, das perfekte Gleichgewicht zwischen Bildqualität und Dateigröße zu erreichen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Richtlinien für nicht optimierte verlustbehaftete Bilder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und nicht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimierte verlustfreie </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Bilder </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">teilen</font></a><font style="vertical-align: inherit;"> dem Browser mit, dass die Dateigröße und die Bildgröße in Pixel übereinstimmen.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unoptimized-lossy-images 'none';<font></font>
Feature-Policy: unoptimized-lossless-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Anzahl der Bytes pro Pixel (Byte pro Pixel, BPP) zu hoch ist, zeigt der Browser anstelle des Bildes einen Stub an und zeigt eine Fehlermeldung in der Konsole an.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/347/215/e57/347215e574f0574312eff1d6737b8d9e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durch das Anwenden von nicht optimierten * Richtlinien wird ein Stub anstelle von unangemessenen Bildern angezeigt. Genau wie bei der Richtlinie</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
für</font><i><font color="#999999"><font style="vertical-align: inherit;"> übergroße</font></font></i><font style="vertical-align: inherit;"> Bilder beträgt</font><i><font color="#999999"><font style="vertical-align: inherit;"> die</font></font></i><font style="vertical-align: inherit;"> empfohlene BPP-Stufe für verlustbehaftete komprimierte Bilder 0,5 und 1 für verlustfreie komprimierte Bilder. Außerdem ist bei der Analyse von Bildern eine geringfügige Abweichung ihrer Gesamtgröße von diesen Ebenen zulässig. Diese Abweichung für verlustkomprimierte Bilder beträgt nun 1 KB, für verlustkomprimierte Bilder 10 KB.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir haben ein JPEG-Bild mit 200 x 200 Pixel. JPEG ist ein verlustbehaftetes Bildkomprimierungsformat, das zu einem empfohlenen BPP-Wert von 0,5 führt. Gleichzeitig kann die Gesamtbildgröße die empfohlene Größe nur um 1 KB überschreiten. Um herauszufinden, welche Größe ein ähnliches Bild für einen Browser geeignet sein sollte, müssen Sie die Abmessungen der Bildseiten in Pixel miteinander und mit BPP multiplizieren und dann die zulässige Abweichung zu dem, was passiert, hinzufügen. </font></font><br>
<br>
<code>(200 x 200 x .5) + 1024 = 21,024</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Byte oder </font></font><code>20.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kb </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Bild ohne Verlust komprimiert wird, ist eine Abweichung von der „idealen“ Größe von 10 Kb zulässig, während der BPP eines solchen Bildes 1 beträgt. Andernfalls sehen die Berechnungen genau gleich aus: </font></font><br>
<br>
<code>(200 x 200 x 1) + 10,240 = 50,240</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Byte oder </font></font><code>49.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kb</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Größe der zulässigen Abweichung wird sich voraussichtlich in Zukunft ändern. </font><font style="vertical-align: inherit;">Obwohl Blink diesen Indikator standardmäßig für verlustfrei komprimierte Bilder von 10 KB verwendet, laufen bereits Experimente mit einer Richtlinie </font></font><code>unoptimized-lossless-images-strict</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mit der dieser Indikator geändert und auf 1 KB gesenkt wird.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medien nicht angegeben</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Neue ist das gut vergessene Alte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für eine lange Zeit Attribute der Verwendung von Bild </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">war mehr oder weniger verbreitet. Ohne diese Attribute wusste der Browser bis zum Laden des Bildes nicht, wie viel Speicherplatz das Bild einnehmen sollte. Dies führte zu Verschiebungen im Seitenlayout. Die Seite wurde angezeigt, und nachdem das Bild angekommen war, verschob sich der Inhalt. Der Browser musste das Layout erneut nachzählen, um Platz für das Bild zu schaffen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als die Zeit für Layouts kam, in denen die Bildgröße mithilfe von CSS flexibel angepasst werden musste, spielte das Vorhandensein oder Fehlen dieser Attribute keine besondere Rolle mehr. Infolgedessen haben viele einfach aufgehört, diese Attribute zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber dank der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jüngsten Arbeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Von Jen Simmons initiiert, können Firefox und Chrome das Seitenverhältnis von Bildern anhand ihrer Attribute </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">berechnen </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn dieser Ansatz mit den auf Bilder angewendeten Stilen kombiniert wird, stellt sich heraus, dass Browser während des ersten Durchlaufs des Layouts Platz für Bilder reservieren können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Richtlinie für nicht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dimensionierte Medien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> teilt dem Browser mit, dass alle Medienelemente Attribute haben müssen, die die Größe dieser Elemente angeben. Wenn keine solchen Attribute vorhanden sind, sollte der Browser die Standardwerte verwenden. Tatsächlich ist alles etwas komplizierter, aber unter dem Strich verwendet der Browser den Standardpixelwert, wenn das Bild nicht die entsprechenden Attribute aufweist </font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unsized-media 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn diese Richtlinie angewendet wird, werden Bilder angezeigt. Wenn ihre Größe jedoch nicht in HTML angegeben ist, stellt der Entwickler schnell fest, dass die Bilder in der Standardgröße angezeigt werden. Und wie üblich wird eine Fehlermeldung an die Konsole gesendet.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a4b/b8a/4c5/a4bb8a4c52a7267ef162a8a8244c0f9a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Anwendung der Richtlinie für nicht dimensionierte Medien führt dazu, dass Bilder und Videos ohne die Attribute für Höhe und Breite angezeigt werden, der Browser ihre Größe jedoch auf 300 x 150 Pixel festlegt.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wahrscheinlich ist eine Funktion erwähnenswert, die mir zunächst ungewöhnlich erschien. </font><font style="vertical-align: inherit;">Sie zeigt sich beim Teilen von Richtlinien</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In dieser Situation sollte man sich nicht über das Auftreten von mehr als zuvor der Anzahl von Nachrichten über zu große Bilder wundern. </font><font style="vertical-align: inherit;">Tatsache ist, dass der</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser</font><font style="vertical-align: inherit;">aufgrund der Anwendung der Richtlinie die</font><font style="vertical-align: inherit;">Größe von Bildern ohne Attribute</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bis zu</font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pixel</font><font style="vertical-align: inherit;">ändert</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Danach verwendet der Browser diese Größe als Referenzpunkt, um festzustellen, ob das Bild mit seinem Container übereinstimmt.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufmerksamkeit auf weniger sichtbare Probleme lenken</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In bildbezogenen Richtlinien gefällt mir die Tatsache, dass sie bei der Entwicklung von Projekten ermöglichen, sichtbar zu machen, was normalerweise verborgen ist. Infolgedessen erfährt der Entwickler, dass er sich nicht um die Optimierung der Bilder gekümmert hat oder dass er vergessen hat, ihre Attribute </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">festzulegen </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. All diese Fehler spiegeln sich sofort im Erscheinungsbild der Seiten wider. Tatsächlich besteht der Hauptvorteil der Verwendung der oben genannten Richtlinien darin, dass der Entwickler schnell Probleme mit den Bildern feststellen kann. Während der Politik</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies kann zu einer Verringerung der Anzahl von Situationen führen, in denen „Verschiebungen“ von Seitenlayouts auftreten. Die Verwendung anderer Richtlinien verhindert nicht das Laden unangemessener Bilder. Daher besteht die einzige Stärke der Anwendung dieser Richtlinien darin, dass sie die Entwickler auf Probleme aufmerksam machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt mehrere weitere Richtlinien, die nützlich sein können, um Seiten auf die Auswirkungen von etwas auf ihre Leistung zu analysieren. Hier kommen Richtlinien wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sync-Script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Sinn </font><font style="vertical-align: inherit;">(diese Richtlinie blockiert die Ausführung synchroner Skripte), </font></font><code>sync-xhr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(blockiert synchrone AJAX-Anforderungen) und </font></font><code>document-write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(blockiert Aufrufe </font></font><code>document.write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Richtlinien eignen sich hervorragend zur Steuerung bestimmter Aspekte der Seitenleistung. Sie selbst bieten Entwicklern jedoch nicht das gleiche spürbare Feedback, das viele der oben genannten Richtlinien in Form fehlender Bilder bieten. Wenn die Seite über ein synchrones Skript verfügt, ohne das es nicht angezeigt wird, ist dies natürlich nicht leicht zu übersehen (und solche Seiten sind nicht so schwer zu finden). Diese Richtlinien weisen jedoch normalerweise auf Fehler in Form von Nachrichten hin, die auf der Konsole angezeigt werden. Und um ehrlich zu sein, vermute ich, dass die meisten Entwickler der Konsole nicht viel Aufmerksamkeit schenken (ich denke, wir sollten alle vorsichtiger mit der Konsole umgehen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotzdem können wir die durch die "unsichtbaren" Richtlinien erkannten Fehler mithilfe der API viel deutlicher machen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportingObserver</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Überwachung von Verstößen und zur Anzeige relevanter Benachrichtigungen auf der Seite. </font><font style="vertical-align: inherit;">Solche Benachrichtigungen können sehr auffällig gemacht werden.</font></font><br>
<br>
<pre><code class="plaintext hljs">let reportingAlerts = document.createElement('ul');<font></font>
&nbsp;&nbsp;reportingAlerts.setAttribute('id','reportingAlerts');<font></font>
&nbsp;&nbsp;document.body.appendChild(reportingAlerts);<font></font>
<font></font>
const alertBox = document.getElementById('reportingAlerts');<font></font>
<font></font>
new ReportingObserver((reports, observer) =&gt; {<font></font>
&nbsp;&nbsp;let fragment = document.createDocumentFragment();<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;Object.keys(reports).forEach(function(item) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;let li = document.createElement('li');<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;li.textContent = reports[item].body.message + ': ' + reports[item].body.featureId;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fragment.appendChild(li);<font></font>
&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;alertBox.appendChild(fragment)<font></font>
}, {types: ['feature-policy-violation'], buffered: true}).observe();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe in CodePen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein Beispiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> skizziert, </font><font style="vertical-align: inherit;">wie dies aussehen könnte.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2bd/c18/c8a/2bdc18c8a9bb20db1f18a9e095be4b8e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel dafür, wie Sie Benachrichtigungen über Richtlinienverletzungen anzeigen können, die im Feature-Policy-Header angegeben sind. </font><font style="vertical-align: inherit;">Solche Benachrichtigungen sind für die Ausgabe in der Entwicklungsumgebung oder dort vorgesehen, wo das Projekt für die Ausgabe an die Produktion vorbereitet ist.</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weniger Verwendung des Feature-Policy-Headers</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das große Minus bei der Verwendung des Headers </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist die Unterstützung durch Browser. </font><font style="vertical-align: inherit;">Anscheinend wird es jetzt nur noch von Blink-basierten Browsern (Opera, Edge, Chrome, Samsung) unterstützt. </font><font style="vertical-align: inherit;">Firefox- und Safari-Browser unterstützen das Attribut </font></font><code>allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für Elemente </font></font><code>iframe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aber selbst wenn es </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterstützt wird, müssen Sie das Flag aktivieren, um den Zustand vieler Richtlinien zu gewährleisten </font></font><code>Experimental Web Platform features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Sie finden es unter der Adresse </font></font><code>about:flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie ich den Feature-Policy-Header verwende</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oben erwähnte </font><font style="vertical-align: inherit;">Minus des Titels </font><font style="vertical-align: inherit;">ist für mich persönlich kein besonderes Problem. Ich bevorzuge es, die in diesem Header definierten Richtlinien als browserbasierte Seitenprüfung zu verwenden. Daher muss ich mich nicht bemühen, mich </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der Produktion </font><font style="vertical-align: inherit;">zu bewerben </font><font style="vertical-align: inherit;">oder sicherzustellen, dass Richtlinien für alle meine Benutzer funktionieren. Sie werden nur von mir sowie von denen benötigt, die die Site entwickeln. Ich verwende auf jeden Fall Chrome als Hauptbrowser im Entwicklungsprozess. Um die Leistung </font></font><code>Feature-Police</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in meiner Arbeitsumgebung </font><font style="vertical-align: inherit;">sicherzustellen, muss daher </font><font style="vertical-align: inherit;">das entsprechende Flag aktiviert werden. Danach arbeiten die Politiker ohne zusätzliche Intervention meinerseits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich fand, dass der einfachste Weg, den Header </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu verwenden, eine Browser-Erweiterung ist</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModHeader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mit dieser Erweiterung können Sie Ihre eigenen Überschriften festlegen, die beim Anzeigen an Seiten übergeben werden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c9/ec2/33b/9c9ec233b6a3913a5e584335ac43a344.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit der ModHeader-Erweiterung können Sie Feature-Policy-Header-Optionen konfigurieren. </font><font style="vertical-align: inherit;">Sie können auf Wunsch ein- und ausgeschaltet werden</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. Ich habe drei Sätze von Header-Werten</font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die ich regelmäßig verwende:</font></font><br>
<br>
<ul>
<li><code>oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>script-sync 'none'; unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich halte oft den ersten eingeschaltet. Es ist sehr aufregend, durch Webseiten zu reisen, für die die darin verwendeten Richtlinien gelten. Es ist beängstigend zu sehen, wie groß einige Bilder sind. Es gibt viele Dinge im modernen Web, die verbessert werden könnten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Politik wird also sehr oft auf den Seiten ausgelöst </font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(und ich sündige auch dadurch), so dass ihre Verwendung während der normalen Arbeit im Internet unpraktisch ist. Deshalb habe ich es in einer separaten Richtlinie hervorgehoben, die ich ein- und ausschalten kann. Gleiches gilt für Richtlinien </font></font><code>sync-scripts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, deren Anwendung viele Websites "kaputt macht".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige der Teams, mit denen ich zusammengearbeitet habe, haben begonnen, die Richtlinien zu verwenden, die ich während der Entwicklung beschrieben habe. </font><font style="vertical-align: inherit;">Dadurch können sie schnell auf bisher unsichtbare Probleme achten. </font><font style="vertical-align: inherit;">Natürlich empfehle ich, alle Richtlinien </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in die Entwicklungsumgebung aufzunehmen, damit Sie Fehler schnell identifizieren und korrigieren können.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dass die Unterstützung </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht nur in Chrome angezeigt wird. </font><font style="vertical-align: inherit;">Obwohl dies mein Hauptbrowser ist, muss ich auch andere Browser verwenden. </font><font style="vertical-align: inherit;">Es wäre hilfreich, wenn sie unterstützen würden </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Hier sehen wir jedoch diese seltene Situation, in der selbst die experimentelle Unterstützung einer bestimmten Gelegenheit ausreicht, um von wirklichem Nutzen zu sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Subtile Leistungsprobleme sind ebenfalls Probleme. </font><font style="vertical-align: inherit;">Die Fähigkeit, solche Probleme sichtbarer zu machen, ist eine der besten Methoden, mit denen ein Entwickler sie identifizieren und beheben kann. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liebe Leser! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planen Sie, die Überschrift Feature-Policy zu verwenden, um unauffällige Probleme in Webprojekten zu identifizieren?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490612/index.html">Funktionaler Ansatz für Transaktionen auf Scala oder schreiben Sie Ihre eigene nützliche Monade</a></li>
<li><a href="../de490616/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 404 (24. Februar - 1. März 2020)</a></li>
<li><a href="../de490618/index.html">Goroutine-Stapelpuffer</a></li>
<li><a href="../de490620/index.html">Wenn ich die Worte "Wiederherstellung des neuronalen Netzwerks" höre, klettere ich, um Backups zu überprüfen</a></li>
<li><a href="../de490622/index.html">Bekämpfung von Speicherlecks in Webanwendungen</a></li>
<li><a href="../de490626/index.html">Eine vollständige Anleitung zu Daten- * HTML-Attributen</a></li>
<li><a href="../de490628/index.html">Was tun, wenn CSS das Parsen von Seiten blockiert?</a></li>
<li><a href="../de490630/index.html">Laden von NumPy-Arrays von der Festplatte: Vergleich von memmap () und Zarr / HDF5</a></li>
<li><a href="../de490634/index.html">Digitale Veranstaltungen in Moskau vom 2. bis 8. März</a></li>
<li><a href="../de490636/index.html">Digitale Events in St. Petersburg vom 2. bis 8. März</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>