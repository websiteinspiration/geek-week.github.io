<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔓 ℹ️ ♓️ 统一它：Lamoda如何使其Go服务保持一致 🌝 ✌🏾 🙈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="尽管我们认为微服务架构不是万能药，但我们仍在广泛使用微服务架构，大约两年前，我们开始转向Go语言。它相对简单，我认为非常适合创建简单，小型和快速的微服务。这种简单性有一个缺点：正因为如此，有很多方法可以解决相同的问题。
 

看起来，去数据库的一个微服务与去邻近数据库的另一个微服务有多少不同？例如，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>统一它：Lamoda如何使其Go服务保持一致</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lamoda/blog/495344/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管我们认为微服务架构不是万能药，但我们仍在广泛使用微服务架构，大约两年前，我们开始转向Go语言。</font><font style="vertical-align: inherit;">它相对简单，我认为非常适合创建简单，小型和快速的微服务。</font><font style="vertical-align: inherit;">这种简单性有一个缺点：正因为如此，有很多方法可以解决相同的问题。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来，去数据库的一个微服务与去邻近数据库的另一个微服务有多少不同？</font><font style="vertical-align: inherit;">例如，一个团队使用Go 1.9，glide，标准数据库/ sql和一个项目结构，而另一团队则使用Go 1.13，模块，sqlx，当然也使用另一项目结构。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当公司中的一项微服务与另一项微服务不同，而又与第三项微服务不同时，这会减慢开发速度。</font><font style="vertical-align: inherit;">缓慢的开发是</font><font style="vertical-align: inherit;">优化</font><font style="vertical-align: inherit;">的</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">损失</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我叫Alexey Partilov，是Lamoda网站开发团队的技术主管。</font><font style="vertical-align: inherit;">在本文中，我将描述我们如何处理Go上约40种微服务的可变性。</font><font style="vertical-align: inherit;">对于仅加入Go而又不知道在何处启动比helloworld更复杂的项目的开发人员，本文将非常有用。</font></font></p><br>
<p><img src="https://habrastorage.org/webt/ab/rl/nw/abrlnwefv_ym93hmomlfzhhslrc.png" alt="图片"></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初，Lamoda使用PHP来处理单个盒装整体。</font><font style="vertical-align: inherit;">然后部分功能开始移至新的Python和PHP服务。</font><font style="vertical-align: inherit;">现在，我们在PHP中拥有庞大而复杂的业务逻辑。</font><font style="vertical-align: inherit;">这些应用程序用于我们的运营活动的自动化：交付，照相馆，会员服务。</font><font style="vertical-align: inherit;">我们还用Java编写了一个整体，可自动执行仓库中的许多复杂流程。</font></font></p><br>
<p>       ,       ,         . </p><br>
<p> e-commerce          Python     Golang. ,      UI    Python+Django.</p><br>
<p>       ,        .      . </p><br>
<p>    ,           .  backend-   ,     ,    ,      ,    .</p><br>
<p>              .</p><br>
<h1>0. Spec first</h1><br>
<p>      ,  : <i>          ,      OpenAPI.</i></p><br>
<p>    :</p><br>
<ul>
<li>Backend-,   ,     -     .        .</li>
<li>Frontend-    backend,     .     mock     backend       .</li>
<li>     boilerplate- c  ,     . ,   ,    ,    .</li>
</ul><br>
<p>     OpenAPI-    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> go-swagger </a>(    gogi).      opensource,    ,            .</p><br>
<blockquote>  ,          .  ,      ,    ,      . <br>
</blockquote><p>     ,    docker-.   ,           .      docker.        Makefile: </p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">.PHONY: generate<font></font>
generate:<font></font>
    #    <font></font>
    rm -rf internal/generated/*<font></font>
    docker run -it \<font></font>
    #     <font></font>
    -v $(PWD)/internal/generated:$(DOCKER_SOURCE_DIR)/internal/generated \<font></font>
    #    OpenAPI <font></font>
    -v $(PWD)/specs:$(DOCKER_SOURCE_DIR)/specs \<font></font>
    #    gogi<font></font>
    -v $(PWD)/gogi.yaml:$(DOCKER_SOURCE_DIR)/gogi.yaml \<font></font>
    #  workdir<font></font>
    -w="$(DOCKER_SOURCE_DIR)" \<font></font>
    gotools.docker.lamoda.ru/gogi:v1.3.2 generate</code></pre></div></div><br>
<h1>1.  </h1><br>
<p>          .        ,  ,    .          ,    -.    — ,      :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">/<font></font>
├── cmd<font></font>
├── deployments<font></font>
├── internal<font></font>
├── migrations<font></font>
├── specs<font></font>
├── tests<font></font>
├── go.mod<font></font>
├── go.sum<font></font>
├── Dockerfile<font></font>
├── main.go<font></font>
...</code></pre></div></div><br>
<p>                .</p><br>
<p>    ,       (    Postgres),     production-, Kafka     API.    ?  .          .</p><br>
<p>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cookiecutter.</a>             .            .      ,     .</p><br>
<h1>2. Go modules</h1><br>
<p>   1.11   Go         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">go modules</a>.   1.14    production-ready.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">glide</a>,          go modules, , ,    Go-. Go modules        $GOPATH/pkg/mod        GOPATH. </p><br>
<p>     Go       (build, get, test). , build          .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>.</p><br>
<p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  golang</a>     ,     ,        .        ,   .</p><br>
<p><b> 1.  go modules</b>.       Go   1.13,    $GOPATH,     go mod</p><br>
<pre><code class="bash hljs">go env -w GOMODULE111=<span class="hljs-string">"on"</span></code></pre><br>
<p><b>2.  RSA-   .</b>       RSA- c ,   ,      ssh-agent.         .</p><br>
<pre><code class="bash hljs">ssh-add &lt;  RSA &gt;</code></pre><br>
<p><b>3.    Go proxy. </b>   Go 1.13,       - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">proxy.golang.org</a>,      .    ,       .</p><br>
<pre><code class="bash hljs">go env -w GOPRIVATE=&lt;  &gt;</code></pre><br>
<p><b>4.  go.mod-.</b>       go.mod    .         (, <i>glide</i>),   mod-     lock-.      go.mod — ,     .</p><br>
<pre><code class="bash hljs">go mod init &lt;  &gt;</code></pre><br>
<p>        ,   , , <i>github.com/spf13/cobra</i>.</p><br>
<p><b>5.  .</b>       .     ,  , ,  .     ,    .</p><br>
<pre><code class="bash hljs">go <span class="hljs-built_in">test</span> ./...</code></pre><br>
<h1>3.  Docker-</h1><br>
<p> Lamoda         Kubernetes-,    Docker-   .  ,   Go-    Docker- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">golang.</a>       c       Docker-.       Docker-     ,   .</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">ARG version<font></font>
FROM golang:$version<font></font>
<font></font>
ENV GOOS linux<font></font>
ENV GOARCH amd64<font></font>
ENV CGO_ENABLED 0<font></font>
ENV GO111MODULE on<font></font>
<font></font>
#      <font></font>
RUN go get github.com/axw/gocov/gocov &amp;&amp; \<font></font>
   go get github.com/AlekSi/gocov-xml@d2f6da892a0d5e0b587526abf51349ad654ade51 &amp;&amp; \<font></font>
   go get golang.org/x/tools/cmd/goimports &amp;&amp; \<font></font>
   curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh | sh -s v1.23.7 &amp;&amp; \<font></font>
   go get -u github.com/jstemmer/go-junit-report@af01ea7f8024089b458d804d5cdf190f962a9a0c &amp;&amp; \<font></font>
   rm -rf /go/pkg/mod/<font></font>
<font></font>
#            <font></font>
COPY ./ssh/id_rsa /root/.ssh/id_rsa<font></font>
COPY ./ssh/id_rsa.pub /root/.ssh/id_rsa.pub<font></font>
# Copy Lamoda Root certificate needed to go to the corporate sites without<font></font>
# SSL warning<font></font>
COPY ./certs/LamodaCA.crt /usr/local/share/ca-certificates/LamodaCA.crt<font></font>
<font></font>
RUN echo "StrictHostKeyChecking no" &gt; /root/.ssh/config &amp;&amp; \<font></font>
   chmod 600 /root/.ssh/id_rsa &amp;&amp; \<font></font>
   chmod 600 /root/.ssh/id_rsa.pub &amp;&amp; \<font></font>
   chmod 755 /root/.ssh &amp;&amp; \<font></font>
   update-ca-certificates &amp;&amp; \<font></font>
   #   insteadOf.       Bitbucket  .<font></font>
   git config --global url.ssh://git@stash.lamoda.ru:7999.insteadOf https://stash.lamoda.ru/scm<font></font>
<font></font>
CMD ["/bin/sh"]</code></pre></div></div><br>
<p>   golang-     .      golang    production-.   ,       (    )        :   debian  alpine,  go,  .      Docker-    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker multistage</a>. </p><br>
<p>, Docker multistage —     Docker,        ,         ,      ,    .. </p><br>
<p>      : </p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">FROM gotools.docker.lamoda.ru/base-mod:1.14.0 as build<font></font>
<font></font>
ENV GOOS linux<font></font>
ENV GOARCH amd64<font></font>
ENV CGO_ENABLED 0<font></font>
ENV GO111MODULE on<font></font>
<font></font>
WORKDIR /go/src/stash.lamoda.ru/ecom/discounts.endpoint<font></font>
#     <font></font>
COPY go.mod .<font></font>
COPY go.sum .<font></font>
<font></font>
#  go-. -    Docker          go.mod  go.sum.<font></font>
RUN go mod download<font></font>
COPY . .<font></font>
<font></font>
RUN make build<font></font>
<font></font>
#   docker        ca-certificates.crt<font></font>
FROM scratch<font></font>
COPY --from=build /go/src/stash.lamoda.ru/ecom/discounts.endpoint/discounts /bin/discounts<font></font>
COPY --from=build /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/ca-certificates.crt<font></font>
ENTRYPOINT ["/bin/discounts"]</code></pre></div></div><br>
<h1>4.  </h1><br>
<p>       ,  , Postgres.    ,      . ,        DBA,   .         .    ,        .     SQL-       DBA  DevOps    production . </p><br>
<p>    -  Jira,           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">migrate</a>.       ,      . ,  , migrate    Docker- —        . </p><br>
<p>     —   migrations     <i>&lt;№ &gt;_&lt;&gt;.[up|down].sql</i></p><br>
<pre><code class="plaintext hljs">migrations<font></font>
├── 00001_init.down.sql<font></font>
├── 00001_init.up.sql<font></font>
├── 00002_create_ui_users_table.down.sql<font></font>
├── 00002_create_ui_users_table.up.sql<font></font>
...</code></pre><br>
<p><i>up</i> —  , ..  ,<br>
<i>down </i>—  , ..  . </p><br>
<p>      SQL-,   .</p><br>
<p>  «»:</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SEQUENCE</span> ui_users_id_seq <span class="hljs-keyword">INCREMENT</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span> <span class="hljs-keyword">MINVALUE</span> <span class="hljs-number">1</span> <span class="hljs-keyword">START</span> <span class="hljs-number">1</span>;<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> ui_users (
  <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  username <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">180</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  username_canonical <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">180</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  email <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">180</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  email_canonical <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">180</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  enabled <span class="hljs-built_in">BOOLEAN</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
  <span class="hljs-keyword">salt</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">255</span>),
  <span class="hljs-keyword">password</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  last_login <span class="hljs-built_in">TIMESTAMP</span>(<span class="hljs-number">0</span>) <span class="hljs-keyword">WITHOUT</span> <span class="hljs-built_in">TIME</span> ZONE <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<font></font>
  confirmation_token <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">180</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<font></font>
  password_requested_at <span class="hljs-built_in">TIMESTAMP</span>(<span class="hljs-number">0</span>) <span class="hljs-keyword">WITHOUT</span> <span class="hljs-built_in">TIME</span> ZONE <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,
  <span class="hljs-keyword">roles</span> <span class="hljs-built_in">TEXT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
  PRIMARY <span class="hljs-keyword">KEY</span>(<span class="hljs-keyword">id</span>)<font></font>
);<font></font>
<span class="hljs-keyword">COMMIT</span>;</code></pre></div></div><br>
<p>  «»:</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">SEQUENCE</span> public.ui_users_id_seq;<font></font>
<font></font>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> ui_users;
<span class="hljs-keyword">COMMIT</span>;</code></pre></div></div><br>
<p>  ,       :</p><br>
<pre><code class="bash hljs">migrate -database <span class="hljs-variable">${DB_DSN}</span> -path db/migrations up</code></pre><br>
<p>     :</p><br>
<pre><code class="bash hljs">migrate create -ext sql -dir migrations -seq create_table_foo</code></pre><br>
<p>     , , .         :      .  ,   ,     .     migrate  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>.</p><br>
<h1>5.  development-</h1><br>
<p> Lamoda  ,    ,      .   /          ,     . ,    Postgres      .        Postgres     .       /   development ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker Compose</a>.</p><br>
<p>Compose       development  . ,            :</p><br>
<ol>
<li>   Postgres,</li>
<li> migrate,       Postgres,</li>
<li>  dev- .</li>
</ol><br>
<p>    . ,        .    ,     ,     . </p><br>
<p>  Docker-compose     :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">version: "3.7"<font></font>
services:<font></font>
  #   dev- <font></font>
  gift-certificates-dev:<font></font>
    container_name: gift-certificates-dev<font></font>
    #       ,    pull  docker-<font></font>
    build:<font></font>
      context: ../<font></font>
      #    Dockerfile  multistage,       <font></font>
      #  .          ,<font></font>
      #             <font></font>
      #    go run.<font></font>
      target: build<font></font>
    #     environment  .<font></font>
    env_file:<font></font>
      - local.env<font></font>
    #   <font></font>
    depends_on:<font></font>
      - gift-certificates-db<font></font>
    #       .     <font></font>
    #   go run<font></font>
    volumes:<font></font>
      - "..:/app/"<font></font>
    working_dir: "/app"<font></font>
    #    <font></font>
    command: "go run main.go"<font></font>
    depends_on:<font></font>
      - gift-certificates-db<font></font>
  #    Postgres<font></font>
  gift-certificates-db:<font></font>
    container_name: gift-certificates-db<font></font>
    image: postgres:11.4<font></font>
    #      <font></font>
    #      env_file,    default.env<font></font>
    #   ,       <font></font>
    environment:<font></font>
      - POSTGRES_DB=gift_certificates<font></font>
      - POSTGRES_USER=gift_certificates<font></font>
      - POSTGRES_PASSWORD=gift_certificates<font></font>
      - POSTGRES_PORT=5432<font></font>
    #     docker <font></font>
    #  , ,          docker <font></font>
    ports:<font></font>
      - 6543:5432<font></font>
  #     <font></font>
  gift-certificates-migrate:<font></font>
    container_name: gift-certificates-migrate<font></font>
    image: "migrate/migrate:v4.4.0"<font></font>
    depends_on:<font></font>
      - gift-certificates-db<font></font>
    volumes:<font></font>
      - "../migrations:/migrations"<font></font>
    command: ["-path", "/migrations/", "-database", "$SERVICE_DB_DSN", "up"]</code></pre></div></div><br>
<p>   Docker-compose  Makefile     :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">#   <font></font>
#          <font></font>
.PHONY: test<font></font>
test: dev-migrate<font></font>
    go test -cover -coverprofile=coverage.out ./...<font></font>
    go tool cover -html=coverage.out -o coverage.html<font></font>
<font></font>
#   dev <font></font>
.PHONY: dev-server<font></font>
dev-server:<font></font>
    docker-compose -f deployments/docker-compose.yaml up -d gift-certificates-dev<font></font>
<font></font>
#       <font></font>
.PHONY: dev-migrate<font></font>
dev-migrate:<font></font>
    docker-compose -f deployments/docker-compose.yaml run --rm --service-ports gift-certificates-migrate<font></font>
<font></font>
#   dev <font></font>
.PHONY: dev-down<font></font>
dev-down:<font></font>
    docker-compose -f deployments/docker-compose.yaml down</code></pre></div></div><br>
<h1>6. </h1><br>
<p>  Go   gofmt,      ,       : goimports, go-critic, gocyclo  ..     ,    IDE  CI     .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">golangci-lint,</a>        Go .     ,            -. </p><br>
<p>     ,      «».       ,     ,      «» ,       .</p><br>
<p>  :</p><br>
<pre><code class="bash hljs">curl -sfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh| sh -s -- -b $(go env GOPATH)/bin v1.23.7</code></pre><br>
<p>  :</p><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="plaintext hljs">run:<font></font>
  tests: false<font></font>
  #         <font></font>
  skip-dirs:<font></font>
    - generated<font></font>
  skip-files:<font></font>
    - ".*easyjson\\.go$"<font></font>
output:<font></font>
  print-issued-lines: false<font></font>
<font></font>
issues:<font></font>
  #      <font></font>
  new-from-rev: 7cdb5ce7d7ebb62a256cebf5460356c296dceb3d<font></font>
  exclude-rules:<font></font>
    - path: internal/common/writer.go<font></font>
      linters:<font></font>
        - structcheck<font></font>
      #       <font></font>
      text: "`size` is unused"</code></pre></div></div><br>
<p>:</p><br>
<pre><code class="bash hljs">golangci-lint run ./...</code></pre><br>
<p>    <i>golangci-lint</i>    pre-commit,    .</p><br>
<h1>7. Pre-commit hook’</h1><br>
<p>   Pull Request      : ,   / ,    .       bash-     git pre-commit .       ,      -.    :            . </p><br>
<p>    python  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pre-commit</a>:</p><br>
<ul>
<li>  :</li>
</ul><br>
<pre><code class="bash hljs">pip install pre-commit</code></pre><br>
<p>   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>.</p><br>
<ul>
<li> -.     go:</li>
</ul><br>
<pre><code class="plaintext hljs">repos:<font></font>
- repo: https://github.com/golangci/golangci-lint<font></font>
  rev: v1.23.7<font></font>
  hooks:<font></font>
  - id: golangci-lint</code></pre><br>
<ul>
<li>     git pre-commit hook':</li>
</ul><br>
<pre><code class="bash hljs">pre-commit install</code></pre><br>
<p>  golangci-lint           .    hook' .  all-files      ,       staging'e:</p><br>
<pre><code class="bash hljs">pre-commit run --all-files</code></pre><br>
<p>   hook'       test runner'.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://pre-commit.com</a></p><br>
<h1>8.  </h1><br>
<p>Gonkey —    ,   Lamoda.  ,      .   ,   Gonkey,            habr.ru <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“Gonkey —   ”. </a></p><br>
<p>Gonkey :</p><br>
<ul>
<li>  HTTP-  ,     ,</li>
<li>    ,      (   YAML-),</li>
<li>       (  ,   Gonkey   ),</li>
<li>       Allure-.</li>
</ul><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub.</a></p><br>
<h1>9.   </h1><br>
<p>         ,  «» .    :  ,    ,   ,      . </p><br>
<p>,         Confluence   .    ,      « ».          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> cookiecutter.</a></p><br>
<p> , cookiecutter —  python-,   jinja-       .        jinja-   . </p><br>
<p>           :</p><br>
<pre><code class="bash hljs">cookiecutter https://stash.lamoda.ru/gotools/cookiecutter-go</code></pre><br>
<p>   , ,  ,    ..           .    cookiecutter   ,       .</p><br>
<h1></h1><br>
<p> Lamoda    .       .        ,    ,      .</p><br>
<p>        —  .      ,     (       ),     (        ). </p><br>
<p>,   ,     ,    <del></del>   ,     . </p><br>
<p>  ,   /  ,      ,       .</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN495332/index.html">四重奏9：快板| 打字稿</a></li>
<li><a href="../zh-CN495336/index.html">不和谐不仅是企业的使者，</a></li>
<li><a href="../zh-CN495338/index.html">在生产环境中启动容器和Kubernetes的最佳实践和指南</a></li>
<li><a href="../zh-CN495340/index.html">如何更改餐厅管理员的工作以使其在IT方面表现出色</a></li>
<li><a href="../zh-CN495342/index.html">交易中银行卡的结算-在Google Data Studio中创建一个开放的数据集和信息图</a></li>
<li><a href="../zh-CN495346/index.html">从错误到行动警报</a></li>
<li><a href="../zh-CN499818/index.html">乌兹别克电报营销</a></li>
<li><a href="../zh-CN499820/index.html">为什么我们选择Kotlin作为我们的目标语言之一。第2部分：Kotlin多平台</a></li>
<li><a href="../zh-CN499822/index.html">无线接入点与路由器：有什么区别？</a></li>
<li><a href="../zh-CN499824/index.html">2020年5月人力资源和IT招聘人员的事件摘要</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>