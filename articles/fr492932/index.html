<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚠️ 💪🏽 ♍️ 13 outils de traitement de texte basés sur le shell 🏪 💢 🈚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voici un extrait d'un futur livre, Basic Tools and Practices for a Novice Software Developer, par Balthazar Ruberol et Etienne Broad . Le livre devrai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>13 outils de traitement de texte basés sur le shell</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/492932/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici un extrait d'un futur livre, Basic Tools and Practices for a Novice Software Developer, par Balthazar Ruberol et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etienne Broad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le livre devrait aider à éduquer la jeune génération de développeurs. </font><font style="vertical-align: inherit;">Il couvrira des </font><font style="vertical-align: inherit;">sujets tels que la </font><font style="vertical-align: inherit;">maîtrise de </font><font style="vertical-align: inherit;">la console, la </font><font style="vertical-align: inherit;">mise en </font><font style="vertical-align: inherit;">place et de </font><font style="vertical-align: inherit;">travailler efficacement dans l'interpréteur de commandes, la </font><font style="vertical-align: inherit;">gestion des </font><font style="vertical-align: inherit;">versions de code à l' </font><font style="vertical-align: inherit;">aide des </font></font><code>git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fondamentaux de SQL, des </font><font style="vertical-align: inherit;">outils tels que </font></font><code>Make</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>jq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et des </font><font style="vertical-align: inherit;">expressions régulières, bases de la </font><font style="vertical-align: inherit;">mise en </font><font style="vertical-align: inherit;">réseau, ainsi que les </font><font style="vertical-align: inherit;">meilleures pratiques pour le </font><font style="vertical-align: inherit;">développement de logiciels et de </font><font style="vertical-align: inherit;">collaboration. </font><font style="vertical-align: inherit;">Les auteurs travaillent actuellement dur sur ce projet et invitent tout le monde à participer à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la liste de diffusion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contenu</font></font></h1><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chat</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tête</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">queue</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toilettes</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couper</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pâte</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trier</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plier</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De vrais exemples</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Approfondissement: boucles for et xargs</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et après</font></font></a></li>
</ul><a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traitement de texte Shell</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des raisons qui font du shell de commandes un outil précieux est le grand nombre de commandes de traitement de texte et la possibilité de les combiner facilement dans le pipeline, créant des modèles de traitement complexes. </font><font style="vertical-align: inherit;">Ces commandes rendent de nombreuses tâches triviales pour l'analyse de texte et de données, la conversion de données entre différents formats, le filtrage de chaînes, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous travaillez avec des données de texte, le principe principal est de décomposer tout problème complexe en de nombreux plus petits - et de résoudre chacun d'entre eux à l'aide d'un outil spécialisé.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faire en sorte que chaque programme fasse bien une chose - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fondements de la philosophie Unix</font></font></a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les exemples de ce chapitre peuvent sembler un peu farfelus à première vue, mais cela est fait exprès. </font><font style="vertical-align: inherit;">Chacun des outils est conçu pour résoudre un petit problème. </font><font style="vertical-align: inherit;">Cependant, lorsqu'ils sont combinés, ils deviennent extrêmement puissants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons examiner certaines des commandes de traitement de texte les plus courantes et les plus utiles dans le shell de commandes et montrer les flux de travail réels qui les connectent ensemble. </font><font style="vertical-align: inherit;">Je suggère de regarder le mana de ces équipes pour voir toute l'étendue des possibilités à votre disposition.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple de fichier CSV </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est disponible en ligne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez le télécharger pour vérifier le matériel.</font></font></blockquote><br>
<a name="1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande est </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisée pour compiler une liste d'un ou plusieurs fichiers et afficher leur contenu à l'écran.</font></font><br>
<br>
<pre><code class="plaintext hljs">$ cat Documents/readme<font></font>
Thanks again for reading this book!<font></font>
I hope you're following so far!<font></font>
<font></font>
$ cat Documents/computers<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.<font></font>
<font></font>
$ cat Documents/readme Documents/computers<font></font>
Thanks again for reading this book!<font></font>
I hope you are following so far!<font></font>
<font></font>
Computers are not intelligent<font></font>
They're just fast at making dumb things.</code></pre><br>
<a name="2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tête</font></font></h1><br>
<code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprime les n premières lignes du fichier. </font><font style="vertical-align: inherit;">Cela peut être très utile pour rechercher un fichier de structure et de format inconnus sans remplir la console entière avec un tas de texte.</font></font><br>
<br>
<pre><code class="bash hljs">$ head -n 2 metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name<font></font>
mysql.galera.wsrep_cluster_size,gauge,,node,,The current number of nodes <span class="hljs-keyword">in</span> the Galera cluster.,0,mysql,galera cluster size</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'est pas spécifié, </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imprime les dix premières lignes du fichier ou du flux d'entrée spécifié.</font></font><br>
<br>
<a name="3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">queue</font></font></h1><br>
<code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- un analogue </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seulement il affiche les n dernières lignes du fichier.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 1 metadata.csv<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez imprimer toutes les lignes situées après la nième ligne (y compris celle-ci), vous pouvez utiliser l'argument </font></font><code>-n +n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n +42 metadata.csv<font></font>
mysql.replication.slaves_connected,gauge,,,,Number of slaves connected to a replication master.,0,mysql,slaves connected<font></font>
mysql.performance.queries,gauge,,query,second,The rate of queries.,0,mysql,queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a 43 lignes dans notre fichier, donc il </font></font><code>tail -n +42</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n'en sort que les 42e et 43e lignes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le paramètre n'est </font></font><code>-n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas spécifié, il </font></font><code>tail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affichera les dix dernières lignes du fichier ou du flux d'entrée spécifié. </font></font><br>
<br>
<code>tail -f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>tail --follow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afficher les dernières lignes du fichier et chaque nouvelle ligne au fur et à mesure qu'elles sont écrites dans le fichier. </font><font style="vertical-align: inherit;">Ceci est très utile pour visualiser l'activité en temps réel, par exemple, ce qui est enregistré dans les journaux du serveur Web, etc.</font></font><br>
<br>
<a name="4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toilettes</font></font></h1><br>
<code>wc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(nombre de mots) affiche le nombre de caractères ( </font></font><code>-c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), de mots ( </font></font><code>-w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ou de lignes ( </font></font><code>-l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dans le fichier ou le flux spécifié.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc -l metadata.csv<font></font>
43  metadata.csv<font></font>
$ wc -w metadata.csv<font></font>
405 metadata.csv<font></font>
$ wc -c metadata.csv<font></font>
5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par défaut, tout ce qui précède est affiché.</font></font><br>
<br>
<pre><code class="bash hljs">$ wc metadata.csv<font></font>
43     405    5094 metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si les données de texte sont redirigées ou redirigées vers </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seul le compteur est affiché.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat metadata.csv | wc<font></font>
43     405    5094<font></font>
$ cat metadata.csv | wc -l<font></font>
43<font></font>
$ wc -w &lt; metadata.csv<font></font>
405</code></pre><br>
<a name="5"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grep</font></font></h1><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Il s'agit d'un couteau suisse filtrant les cordes selon un schéma donné. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous pouvons trouver toutes les occurrences du mot </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans un fichier.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.mutex_spin_rounds,gauge,,event,second,The rate of mutex spin rounds.,0,mysql,mutex spin rounds<font></font>
mysql.innodb.mutex_spin_waits,gauge,,event,second,The rate of mutex spin waits.,0,mysql,mutex spin waits</code></pre><br>
<code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut traiter soit les fichiers spécifiés comme arguments, soit un flux de texte qui lui est transmis </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ainsi, nous pouvons concaténer plusieurs commandes </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour filtrer davantage le texte. </font><font style="vertical-align: inherit;">Dans l'exemple suivant, nous filtrons les lignes de notre fichier </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour rechercher des lignes contenant à la fois </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep mutex metadata.csv | grep OS<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons quelques options </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et leur comportement. </font></font><br>
<br>
<code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effectue une correspondance inverse: filtre les chaînes qui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> correspondent </font><i><font style="vertical-align: inherit;">pas</font></i><font style="vertical-align: inherit;"> au modèle d'argument.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -v gauge metadata.csv<font></font>
metric_name,metric_type,interval,unit_name,per_unit_name,description,orientation,integration,short_name</code></pre><br>
<code> grep -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effectue une correspondance insensible à la casse. </font><font style="vertical-align: inherit;">L'exemple suivant </font></font><code>grep -i os</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trouve à la </font><font style="vertical-align: inherit;">fois </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -i os metadata.csv<font></font>
mysql.innodb.mutex_os_waits,gauge,,event,second,The rate of mutex OS waits.,0,mysql,mutex os waits<font></font>
mysql.innodb.os_log_fsyncs,gauge,,write,second,The rate of fsync writes to the <span class="hljs-built_in">log</span> file.,0,mysql,<span class="hljs-built_in">log</span> fsyncs</code></pre><br>
<code>grep -l</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Répertorie les fichiers contenant une correspondance.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -l mysql metadata.csv<font></font>
metadata.csv</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipe </font></font><code>grep -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compte combien de fois un échantillon a été trouvé.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -c select metadata.csv<font></font>
3</code></pre><br>
<code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recherche récursivement des fichiers dans le répertoire de travail actuel et tous ses sous-répertoires.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r are ~/Documents<font></font>
/home/br/Documents/computers:Computers are not intelligent<font></font>
/home/br/Documents/readme:I hope you are following so far!</code></pre><br>
<code>grep -w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affiche uniquement les mots entiers correspondants.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep follow ~/Documents/readme<font></font>
I hope you are following so far!<font></font>
$ grep -w follow ~/Documents/readme<font></font>
$</code></pre><br>
<a name="6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Couper</font></font></h1><br>
<code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extrait une partie du fichier (ou, comme d'habitude, le flux d'entrée). </font><font style="vertical-align: inherit;">La commande définit le séparateur de champ (qui sépare les colonnes) à l'aide de l'option </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et les numéros de colonne à récupérer à l'aide de l'option </font></font><code>-f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, la commande suivante récupère la première colonne des cinq dernières lignes de notre fichier CSV.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1<font></font>
mysql.performance.user_time<font></font>
mysql.replication.seconds_behind_master<font></font>
mysql.replication.slave_running<font></font>
mysql.replication.slaves_connected<font></font>
mysql.performance.queries</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous traitons avec CSV, les colonnes sont séparées par une virgule, et l'option est responsable de la récupération de la première colonne </font></font><code>-f 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez sélectionner les première et deuxième colonnes à l'aide de l'option </font></font><code>-f 1,2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ tail -n 5 metadata.csv | cut -d , -f 1,2<font></font>
mysql.performance.user_time,gauge<font></font>
mysql.replication.seconds_behind_master,gauge<font></font>
mysql.replication.slave_running,gauge<font></font>
mysql.replication.slaves_connected,gauge<font></font>
mysql.performance.queries,gauge</code></pre><br>
<a name="7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pâte</font></font></h1><br>
<code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fusionne deux fichiers différents en un seul fichier multi-colonnes.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
$ cat prices<font></font>
1$<font></font>
1.99$<font></font>
1.50$<font></font>
2$/kg<font></font>
$ paste ingredients prices<font></font>
eggs    1$<font></font>
milk    1.99$<font></font>
butter  1.50$<font></font>
tomatoes    2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par défaut, il </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilise un délimiteur de tabulation, mais il peut être modifié à l'aide du paramètre </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste ingredients prices -d:<font></font>
eggs:1$<font></font>
milk:1.99$<font></font>
butter:1.50$<font></font>
tomatoes:2$/kg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre cas d'utilisation courant </font></font><code>paste</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;consiste à combiner toutes les lignes d'un flux ou d'un fichier à l'aide du délimiteur spécifié, à l'aide d'une combinaison de </font></font><code>-s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>-d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ paste -s -d, ingredients<font></font>
eggs,milk,butter,tomatoes</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si un paramètre est spécifié en tant que fichier d'entrée </font></font><code>-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, il sera lu à la place </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients | paste -s -d, -<font></font>
eggs,milk,butter,tomatoes</code></pre><br>
<a name="8"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trier</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trie en fait les données (dans le fichier ou le flux d'entrée spécifié).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ingredients<font></font>
eggs<font></font>
milk<font></font>
butter<font></font>
tomatoes<font></font>
salt<font></font>
$ sort ingredients<font></font>
butter<font></font>
eggs<font></font>
milk<font></font>
salt<font></font>
tomatoes</code></pre><br>
<code>sort -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> effectue un tri inverse.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort -r ingredients<font></font>
tomatoes<font></font>
salt<font></font>
milk<font></font>
eggs<font></font>
butter</code></pre><br>
<code>sort -n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trie les champs par leur valeur arithmétique.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat numbers<font></font>
0<font></font>
2<font></font>
1<font></font>
10<font></font>
3<font></font>
$ sort numbers<font></font>
0<font></font>
1<font></font>
10<font></font>
2<font></font>
3<font></font>
$ sort -n numbers<font></font>
0<font></font>
1<font></font>
2<font></font>
3<font></font>
10</code></pre><br>
<a name="9"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniq</font></font></h1><br>
<code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Détecte et filtre les lignes identiques adjacentes dans le fichier ou le flux d'entrée spécifié.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat duplicates<font></font>
and one<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three<font></font>
$ uniq duplicates<font></font>
and one<font></font>
and two<font></font>
and one<font></font>
and two<font></font>
and one, two, three</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'il ne </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtre que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lignes </font><i><font style="vertical-align: inherit;">adjacentes</font></i><font style="vertical-align: inherit;"> , des doublons peuvent toujours rester dans nos données. </font><font style="vertical-align: inherit;">Pour filtrer toutes les mêmes lignes d'un fichier, vous devez d'abord trier son contenu.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq<font></font>
and one<font></font>
and one, two, three<font></font>
and two</code></pre><br>
<code>uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au début de chaque ligne insère le nombre de ses occurrences.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -c<font></font>
   3 and one<font></font>
   1 and one, two, three<font></font>
   2 and two</code></pre><br>
<code>uniq -u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Affiche uniquement des chaînes uniques.</font></font><br>
<br>
<pre><code class="bash hljs">$ sort duplicates | uniq -u<font></font>
and one, two, three</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font></font><code>uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est particulièrement utile en combinaison avec le tri, car le pipeline </font></font><code>| sort | uniq</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous permet de supprimer toutes les lignes en double dans un fichier ou un flux.</font></font></blockquote><br>
<a name="10"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awk</font></font></h1><br>
<code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- C'est un peu plus qu'un simple outil de traitement de texte: en fait, il a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout un langage de programmation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ce qui est </font></font><code>awk</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vraiment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bien, c'est de diviser les fichiers en colonnes, et il le fait avec une brillance particulière lorsque les espaces et les tabulations sont mélangés dans des fichiers.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat -t multi-columns<font></font>
John Smith    Doctor^ITardis<font></font>
Sarah-James Smith^I    Companion^ILondon<font></font>
Rose Tyler   Companion^ILondon</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font></font><code>cat -t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affiche les onglets comme </font></font><code>^I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, les colonnes sont séparées par des espaces ou des tabulations, et pas toujours par le même nombre d'espaces. </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il est inutile ici car il fonctionne avec un seul caractère séparateur. </font><font style="vertical-align: inherit;">Mais </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il est facile de gérer un tel fichier. </font></font><br>
<br>
<code>awk '{ print $n }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affiche la nième colonne dans le texte.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat multi-columns | awk <span class="hljs-string">'{ print $1 }'</span><font></font>
John<font></font>
Sarah-James<font></font>
Rose<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $3 }'</span><font></font>
Doctor<font></font>
Companion<font></font>
Companion<font></font>
$ cat multi-columns | awk <span class="hljs-string">'{ print $1,$2 }'</span><font></font>
John Smith<font></font>
Sarah-James Smith<font></font>
Rose Tyler</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capable de bien plus, la sortie des haut-parleurs représente probablement 99% des cas d'utilisation dans mon cas personnel.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font></font><code>{ print $NF }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affiche la dernière colonne d'une ligne.</font></font></blockquote><br>
<a name="11"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr</font></font></h1><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signifie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traduire</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cette commande remplace un caractère par un autre. </font><font style="vertical-align: inherit;">Il fonctionne avec des caractères ou </font><font style="vertical-align: inherit;">des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> caractères tels que les minuscules, les caractères typés, les espaces, les caractères alphanumériques, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En entrée standard, il </font></font><code>tr &lt;char1&gt; &lt;char2&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remplace toutes les occurrences de &lt;char1&gt; par &lt;char2&gt;.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers are fast"</span> | tr a A<font></font>
computers Are fAst</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut traduire des classes de caractères en utilisant la notation </font></font><code>[:class:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Une liste complète des classes disponibles est décrite sur la page de manuel </font></font><code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais certaines sont présentées ici. </font></font><br>
<br>
<code>[:space:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">représente tous les types d'espaces, des simples espaces aux tabulations ou aux nouvelles lignes.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:space:]'</span> <span class="hljs-string">','</span>
computers,are,fast,%</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous les caractères, comme les espaces, sont séparés par des virgules. </font><font style="vertical-align: inherit;">Veuillez noter que le caractère </font></font><code>%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">à la fin de la sortie indique l'absence d'une nouvelle ligne de fin. </font><font style="vertical-align: inherit;">En effet, ce personnage est également converti en virgule. </font></font><br>
<br>
<code>[:lower:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">représente tous les caractères minuscules et </font></font><code>[:upper:]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tous les </font><font style="vertical-align: inherit;">caractères </font><font style="vertical-align: inherit;">majuscules. </font><font style="vertical-align: inherit;">Ainsi, la transformation entre eux devient triviale.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'[:lower:]'</span> <span class="hljs-string">'[:upper:]'</span><font></font>
COMPUTERS ARE FAST<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"COMPUTERS ARE FAST"</span> | tr <span class="hljs-string">'[:upper:]'</span> <span class="hljs-string">'[:lower:]'</span>
computers are fast</code></pre><br>
<code>tr -c SET1 SET2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">convertit tout caractère </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">non</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inclus dans SET1 en caractères dans SET2. </font><font style="vertical-align: inherit;">Dans l'exemple suivant, tous les caractères à l'exception des voyelles indiquées sont remplacés par des espaces.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr -c <span class="hljs-string">'[aeiouy]'</span> <span class="hljs-string">' '</span>
 o  u e   a e  a</code></pre><br>
<code>tr -d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supprime les caractères spécifiés, mais ne les remplace pas. </font><font style="vertical-align: inherit;">C'est l'équivalent </font></font><code>tr &lt;char&gt; ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers Are Fast"</span> | tr -d <span class="hljs-string">'[:lower:]'</span>
C A F</code></pre><br>
<code>tr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut également remplacer des plages de caractères, par exemple, toutes les lettres entre </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou tous les nombres entre 1 et 8, en utilisant la notation </font></font><code>s-e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, où </font></font><code>s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;est le caractère de départ et </font></font><code>e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;la fin.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"computers are fast"</span> | tr <span class="hljs-string">'a-e'</span> <span class="hljs-string">'x'</span><font></font>
xomputxrs xrx fxst<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"5uch l337 5p34k"</span> | tr <span class="hljs-string">'1-4'</span> <span class="hljs-string">'x'</span>
5uch lxx7 5pxxk</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>tr -s string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compresse toutes les occurrences multiples de caractères </font></font><code>string1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en un seul. </font><font style="vertical-align: inherit;">L'une des utilisations les plus utiles </font></font><code>tr -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consiste à remplacer plusieurs espaces consécutifs par un seul.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Computers         are       fast"</span> | tr -s <span class="hljs-string">' '</span>
Computers are fast</code></pre><br>
<a name="12"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plier</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>fold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">réduit toutes les lignes d'entrée à la largeur spécifiée. </font><font style="vertical-align: inherit;">Par exemple, il peut être utile de s'assurer que le texte tient sur de petits écrans. </font><font style="vertical-align: inherit;">Donc, </font></font><code>fold -w n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empile des chaînes de largeur n caractères.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat ~/Documents/readme | fold -w 16<font></font>
Thanks again <span class="hljs-keyword">for</span><font></font>
 reading this bo<font></font>
ok!<font></font>
I hope you<span class="hljs-string">'re fo
llowing so far!</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>fold -s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne coupera les lignes que sur les caractères d'espace. </font><font style="vertical-align: inherit;">Il peut être combiné avec le précédent pour limiter la chaîne au nombre spécifié de caractères.</font></font><br>
<br>
<pre><code class="bash hljs">Thanks again
<span class="hljs-keyword">for</span> reading<font></font>
this book!<font></font>
I hope you<span class="hljs-string">'re
following so
far!</span></code></pre><br>
<a name="13"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sed</font></font></h1><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est un éditeur de flux non interactif utilisé pour convertir le texte ligne par ligne dans le flux d'entrée. </font><font style="vertical-align: inherit;">En entrée, soit un fichier ou, ou </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en sortie, soit un fichier ou </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les commandes de l'éditeur peuvent inclure une ou plusieurs </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adresses</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonction</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paramètres</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ainsi, les commandes sont les suivantes:</font></font><br>
<br>
<pre><code class="bash hljs">[address[,address]]<span class="hljs-keyword">function</span>[arguments]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien qu'il </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remplisse de nombreuses fonctions, nous n'envisagerons de remplacer le texte que comme l'un des cas d'utilisation les plus courants.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplacement de texte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande de remplacement est </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la suivante:</font></font><br>
<br>
<pre><code class="bash hljs">s/PATTERN/REPLACEMENT/[options]</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : remplacement de la première instance d'un mot dans chaque ligne d'un fichier:</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello<font></font>
hello hello<font></font>
hello world!<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/'</span><font></font>
Hey I just met you hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons que dans la première ligne, seule la première instance est remplacée </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pour remplacer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toutes les</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> occurrences </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans toutes les lignes, vous pouvez utiliser l'option </font></font><code>g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(signifie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">globale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br>
<code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous permet d'utiliser tous les délimiteurs sauf </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ce qui améliore particulièrement la lisibilité s'il y a des barres obliques dans les arguments de commande eux-mêmes.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'s@hello@Hey I just met you@g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'adresse indique à l'éditeur sur quelle ligne ou plage de lignes effectuer la substitution.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you hello<font></font>
hello world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you  world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'adresse </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique remplacer </font></font><code>hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur </font></font><code>Hey I just met you</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la première ligne. </font><font style="vertical-align: inherit;">Nous pouvons spécifier la plage d'adresses dans la notation </font></font><code>&lt;start&gt;,&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, où il </font></font><code>&lt;end&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut s'agir soit du numéro de ligne </font></font><code>$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, soit de la dernière ligne du fichier.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat hello | sed <span class="hljs-string">'1,2s/hello/Hey I just met you/g'</span><font></font>
Hey I just met you Hey I just met you<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,3s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi<font></font>
$ cat hello | sed <span class="hljs-string">'2,$s/hello/Hey I just met you/g'</span><font></font>
hello hello<font></font>
Hey I just met you world<font></font>
hi</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par défaut, il </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">produit le résultat en tant que </font><font style="vertical-align: inherit;">tel </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais peut également modifier le fichier d'origine avec l'option </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">''</span> <span class="hljs-string">'s/hello/Bonjour/'</span> sed-data<font></font>
$ cat sed-data<font></font>
Bonjour hello<font></font>
Bonjour world<font></font>
hi</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font><font style="vertical-align: inherit;">Sous Linux, juste assez </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mais sur macOS, le comportement de la commande est légèrement différent, </font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous devez donc l'ajouter </font><font style="vertical-align: inherit;">juste après </font></font><code>''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<a name="14"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De vrais exemples</font></font></h1><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filtrage CSV avec grep et awk</font></font></h3><br>
<pre><code class="bash hljs">$ grep -w gauge metadata.csv | awk -F, <span class="hljs-string">'{ if ($4 == "query") { print $1, "per", $5 } }'</span><font></font>
mysql.performance.com_delete per second<font></font>
mysql.performance.com_delete_multi per second<font></font>
mysql.performance.com_insert per second<font></font>
mysql.performance.com_insert_select per second<font></font>
mysql.performance.com_replace_select per second<font></font>
mysql.performance.com_select per second<font></font>
mysql.performance.com_update per second<font></font>
mysql.performance.com_update_multi per second<font></font>
mysql.performance.questions per second<font></font>
mysql.performance.slow_queries per second<font></font>
mysql.performance.queries per second</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet exemple </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le fichier </font></font><code>metadata.csv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filtre d'abord les lignes contenant le mot </font></font><code>gauge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis celles avec la </font></font><code>query</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quatrième colonne, et affiche le nom de la métrique (1ère colonne) avec la valeur correspondante </font></font><code>per_unit_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(5ème colonne).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affiche l'adresse IPv4 associée à l'interface réseau</font></font></h3><br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>ifconfig &lt;interface name&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affiche des informations sur l'interface réseau spécifiée. </font><font style="vertical-align: inherit;">Par exemple:</font></font><br>
<br>
<pre><code class="bash hljs">en0: flags=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<font></font>
    ether 19:64:92:de:20:ba<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255<font></font>
    nd6 options=201&lt;PERFORMNUD,DAD&gt;<font></font>
    media: autoselect<font></font>
    status: active</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, courez </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour </font></font><code>inet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cela produira deux lignes de correspondance.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet<font></font>
    inet6 fe80::8a3:a1cb:56ae:7c7c%en0 prefixlen 64 secured scopeid 0x7<font></font>
    inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, utilisez </font></font><code>grep -v</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exclure la ligne avec </font></font><code>ipv6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6<font></font>
inet 192.168.0.38 netmask 0xffffff00 broadcast 192.168.0.255</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, avec l'aide, nous </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demandons la deuxième colonne de cette ligne: c'est l'adresse IPv4 associée à notre interface réseau </font></font><code>en0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | grep inet | grep -v inet6 | awk <span class="hljs-string">'{ print $2 }'</span>
192.168.0.38</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font><font style="vertical-align: inherit;">On m'a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de remplacer par </font></font><code>grep inet | grep -v inet6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une équipe aussi fiable </font></font><code>awk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">$ ifconfig en0 | awk <span class="hljs-string">' $1 == "inet" { print $2 }'</span>
192.168.0.38</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est plus court et spécifiquement ciblé sur IPv4 avec la condition </font></font><code>$1 == "inet"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récupération d'une valeur à partir d'un fichier de configuration</font></font></h3><br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d = -f2 | sed <span class="hljs-string">'s/ //g'</span>
/usr/bin/vim</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le fichier de configuration git de l'utilisateur actuel, recherchez la valeur </font></font><code>editor =</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, recadrez le caractère </font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, extrayez la deuxième colonne et supprimez tous les espaces autour.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig<font></font>
     editor = /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2<font></font>
 /usr/bin/vim<font></font>
$ grep <span class="hljs-string">'editor ='</span> ~/.gitconfig  | cut -d<span class="hljs-string">'='</span> -f2 | sed <span class="hljs-string">'s/ //'</span>
/usr/bin/vim</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extraire les adresses IP d'un fichier journal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le code réel suivant recherche un message dans le journal de la base de données </font></font><code>Too many connections from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(suivi d'une adresse IP) et affiche les dix principaux intrus.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
   10.11.112.108<font></font>
   10.11.111.70<font></font>
   10.11.97.57<font></font>
   10.11.109.72<font></font>
   10.11.116.156<font></font>
   10.11.100.221<font></font>
   10.11.96.242<font></font>
   10.11.81.68<font></font>
   10.11.99.112<font></font>
   10.11.107.120</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons ce que fait ce pipeline. </font><font style="vertical-align: inherit;">Tout d'abord, à quoi ressemble la ligne dans le journal.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | head -n 1<font></font>
2020-01-01 08:02:37,617 [myid:1] - WARN  [NIOServerCxn.Factory:1.2.3.4/1.2.3.4:2181:NIOServerCnxnFactory@193] - Too many connections from /10.11.112.108 - max is 60</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il </font></font><code>awk '{ print $12 }'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extrait </font><font style="vertical-align: inherit;">ensuite </font><font style="vertical-align: inherit;">l'adresse IP de la chaîne.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span><font></font>
/10.11.112.108<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La commande </font></font><code>sed 's@/@@'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supprime la barre oblique initiale.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">"Too many connections from"</span> db.log | awk <span class="hljs-string">'{ print $12 }'</span> | sed <span class="hljs-string">'s@/@@'</span><font></font>
10.11.112.108<font></font>
...</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font><font style="vertical-align: inherit;">Comme nous l'avons vu précédemment, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous pouvez utiliser n'importe quel séparateur dans. </font><font style="vertical-align: inherit;">Bien qu'il soit généralement utilisé comme séparateur </font></font><code>/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous </font><font style="vertical-align: inherit;">remplaçons </font><font style="vertical-align: inherit;">ici ce caractère particulier, ce qui nuira légèrement à la lisibilité de l'expression de substitution.</font></font><br>
<br>
<pre><code class="bash hljs">sed <span class="hljs-string">'s/\///'</span></code></pre></blockquote><br>
<code>sort | uniq -c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trie les adresses IP dans l'ordre lexicographique, puis supprime les doublons, en ajoutant le nombre d'entrées avant chaque adresse IP.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c<font></font>
   1379 10.11.100.221<font></font>
   1213 10.11.103.168<font></font>
   1138 10.11.105.177<font></font>
    946 10.11.106.213<font></font>
   1211 10.11.106.4<font></font>
   1326 10.11.107.120<font></font>
   ...</code></pre><br>
<code>sort -rn | head -n 10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trie les lignes par le nombre d'occurrences, numériquement et dans l'ordre inverse, afin que les principaux contrevenants soient affichés en premier, dont 10 lignes. </font><font style="vertical-align: inherit;">La dernière commande </font></font><code>awk { print $2 }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">récupère les adresses IP elles-mêmes.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep <span class="hljs-string">'Too many connections from'</span> db.log | \<font></font>
  awk <span class="hljs-string">'{ print $12 }'</span> | \<font></font>
  sed <span class="hljs-string">'s@/@@'</span> | \<font></font>
  sort | \<font></font>
  uniq -c | \<font></font>
  sort -rn | \<font></font>
  head -n 10 | \<font></font>
  awk <span class="hljs-string">'{ print $2 }'</span><font></font>
  10.11.112.108<font></font>
  10.11.111.70<font></font>
  10.11.97.57<font></font>
  10.11.109.72<font></font>
  10.11.116.156<font></font>
  10.11.100.221<font></font>
  10.11.96.242<font></font>
  10.11.81.68<font></font>
  10.11.99.112<font></font>
  10.11.107.120</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renommer une fonction dans le fichier source</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez que nous travaillons sur un projet et que nous aimerions renommer la fonction sous-nommée (ou classe, variable, etc.) dans le fichier source. </font><font style="vertical-align: inherit;">Vous pouvez le faire avec une commande </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qui remplace directement dans le fichier d'origine.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat izk/utils.py<font></font>
def bool_from_str(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/def bool_from_str/def is_affirmative/'</span> izk/utils.py<font></font>
$ cat izk/utils.py<font></font>
def is_affirmative(s):<font></font>
    <span class="hljs-keyword">if</span> s.isdigit():
        <span class="hljs-built_in">return</span> int(s) == 1
    <span class="hljs-built_in">return</span> s.lower() <span class="hljs-keyword">in</span> [<span class="hljs-string">'yes'</span>, <span class="hljs-string">'true'</span>, <span class="hljs-string">'y'</span>]</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font><font style="vertical-align: inherit;">Sur macOS, </font></font><code>sed -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisez </font><font style="vertical-align: inherit;">plutôt </font></font><code>sed -i ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, nous avons renommé la fonction uniquement dans le fichier d'origine. </font><font style="vertical-align: inherit;">Cela interrompra l'importation </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans tout autre fichier car cette fonction n'est plus définie. </font><font style="vertical-align: inherit;">Nous devons trouver un moyen de renommer </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tout </font><font style="vertical-align: inherit;">au </font><font style="vertical-align: inherit;">long de notre projet. </font><font style="vertical-align: inherit;">Ceci peut être réalisé en utilisant des commandes </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ainsi que des boucles </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou en utilisant </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a name="15"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Approfondissement: cycles </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et</font></font><code>xargs</code></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour remplacer toutes les occurrences de notre projet </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous devez d'abord les trouver récursivement avec </font></font><code>grep -r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r bool_from_str .<font></font>
./tests/test_utils.py:from izk.utils import bool_from_str<font></font>
./tests/test_utils.py:def test_bool_from_str(s, expected):<font></font>
./tests/test_utils.py:    assert bool_from_str(s) == expected<font></font>
./izk/utils.py:def bool_from_str(s):<font></font>
./izk/prompt.py:from .utils import bool_from_str<font></font>
./izk/prompt.py:                    default = bool_from_str(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous ne sommes intéressés que par les fichiers avec des correspondances, vous devez également utiliser l'option </font></font><code>-l/--files-with-matches</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">-l, --files-with-matches<font></font>
        Only the names of files containing selected lines are written to standard out-<font></font>
        put.  grep will only search a file until a match has been found, making<font></font>
        searches potentially less expensive.  Pathnames are listed once per file<font></font>
        searched.  If the standard input is searched, the string ``(standard input)<span class="hljs-string">''</span>
        is written.</code></pre><br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str .<font></font>
./tests/test_utils.py<font></font>
./izk/utils.py<font></font>
./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous pouvons utiliser la commande </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour effectuer des actions à partir de chaque ligne de la sortie (c'est-à-dire tous les fichiers contenant la ligne </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r --files-with-matches bool_from_str . | \<font></font>
  xargs -n 1 sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'option </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique que chaque ligne de la sortie doit exécuter une commande distincte </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, les commandes suivantes sont exécutées:</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la commande avec laquelle vous appelez </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(dans notre cas </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) prend en charge plusieurs arguments, vous devez ignorer l'argument </font></font><code>-n 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatif aux performances.</font></font><br>
<br>
<pre><code class="bash hljs">grep -r --files-with-matches bool_from_str . | xargs sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette commande s'exécutera ensuite</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py ./izk/utils.py ./izk/prompt.py</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque. </font><font style="vertical-align: inherit;">Le synopsis </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de la page de manuel montre que l'équipe peut prendre plusieurs arguments.</font></font><br>
<br>
<pre><code class="bash hljs">SYNOPSIS<font></font>
     sed [-Ealn] <span class="hljs-built_in">command</span> [file ...]<font></font>
     sed [-Ealn] [-e <span class="hljs-built_in">command</span>] [-f command_file] [-i extension] [file ...]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En effet, comme nous l'avons vu dans le chapitre précédent, cela </font></font><code>file ...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">signifie que plusieurs arguments sont acceptés, qui sont des noms de fichiers.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous constatons que des remplacements sont effectués pour toutes les occurrences </font></font><code>bool_from_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ grep -r is_affirmative .<font></font>
./tests/test_utils.py:from izk.utils import is_affirmative<font></font>
./tests/test_utils.py:def test_is_affirmative(s, expected):<font></font>
./tests/test_utils.py:    assert is_affirmative(s) == expected<font></font>
./izk/utils.py:def is_affirmative(s):<font></font>
./izk/prompt.py:from .utils import is_affirmative<font></font>
./izk/prompt.py:                    default = is_affirmative(os.environ[envvar])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme cela arrive souvent, il existe plusieurs façons d'obtenir le même résultat. </font><font style="vertical-align: inherit;">Au lieu de cela, </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous pourrions utiliser des boucles </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour parcourir les lignes de la liste et prendre des mesures sur chaque élément. </font><font style="vertical-align: inherit;">Ces boucles ont la syntaxe suivante:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> list; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">command</span> <span class="hljs-variable">$item</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous terminerons notre commande </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans </font></font><code>$()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, le shell exécutera dans un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sous - </font><font style="vertical-align: inherit;">shell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont </font><font style="vertical-align: inherit;">le résultat sera ensuite répété dans une boucle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> $(grep -r --files-with-matches bool_from_str .); <span class="hljs-keyword">do</span>
  sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> <span class="hljs-variable">$file</span>
<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette commande s'exécutera</font></font><br>
<br>
<pre><code class="bash hljs">$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./tests/test_utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/utils.py<font></font>
$ sed -i <span class="hljs-string">'s/bool_from_str/is_affirmative/'</span> ./izk/prompt.py</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La syntaxe de boucle </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">me semble plus claire que cela </font></font><code>xargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais cette dernière peut exécuter des commandes en parallèle en utilisant des paramètres </font></font><code>-P n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, où </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le nombre maximum de commandes parallèles exécutées en même temps, ce qui peut donner un gain de performances.</font></font><br>
<br>
<a name="16"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sommaire</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tous ces outils ouvrent tout un monde de possibilités, car ils vous permettent d'extraire et de transformer des données, créant des pipelines entiers à partir d'équipes qui n'auraient peut-être jamais été conçues pour travailler ensemble. Chacun d'eux remplit une fonction relativement petite (tri </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, combinaison </font></font><code>cat</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, filtres </font></font><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, édition </font></font><code>sed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, découpe </font></font><code>cut</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toute tâche comprenant du texte peut être réduite à un pipeline de tâches plus petites, chacune exécutant une action simple et transférant sa sortie à la tâche suivante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, si nous voulons savoir combien d'adresses IP uniques se trouvent dans le fichier journal et que ces adresses IP apparaissent toujours dans la même colonne, nous pouvons exécuter la séquence de commandes suivante:</font></font><br>
<br>
<ul>
<li><code>grep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chaînes qui correspondent au modèle de chaînes avec des adresses IP</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recherchez la colonne avec l'adresse IP, extrayez-la avec </font></font><code>awk</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trier la liste des adresses IP à l'aide </font></font><code>sort</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éliminer les doublons adjacents avec </font></font><code>uniq</code><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compter le nombre de lignes (c'est-à-dire les adresses IP uniques) en utilisant </font></font><code>wc -l</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme il existe de nombreux outils de traitement de texte natifs et tiers, il existe également de nombreuses façons de résoudre tout problème. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les exemples de cet article étaient farfelus, mais je vous suggère de lire l'article étonnant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«Les outils de ligne de commande peuvent être 235 fois plus rapides que votre cluster Hadoop»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour avoir une idée de l'utilité et de la puissance réelle de ces commandes et des problèmes réels ils peuvent décider.</font></font><br>
<br>
<a name="17"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et après</font></font></h1><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comptez le nombre de fichiers et de répertoires situés dans votre répertoire personnel.</font></font><br>
</li>
<li>     .<br>
</li>
<li>,       .<br>
</li>
<li>    .         .</li>
</ol><br>
<hr><br>
<i>  «        » (Essential Tools and Practices for the Aspiring Software Developer)    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>            ,     .    ,    ,   ,       ,      <code>git</code>,  SQL,   <code>Make</code>, <code>jq</code>   ,   ,          .<br>
<br>
    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>!</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr492910/index.html">Contrôle du moteur pas à pas via le contrôleur Canny</a></li>
<li><a href="../fr492914/index.html">Comment protéger les employés distants ou la sécurité du bureau à domicile</a></li>
<li><a href="../fr492918/index.html">Pape: éthique pour l'IA et les véhicules sans pilote</a></li>
<li><a href="../fr492920/index.html">La quarantaine en République tchèque: un regard intérieur</a></li>
<li><a href="../fr492924/index.html">Comment visualiser et animer des modèles (géophysiques). Informativité de la visualisation</a></li>
<li><a href="../fr492934/index.html">Difficultés à élever un assistant vocal. Le regard d'un linguiste et développeur</a></li>
<li><a href="../fr492938/index.html">Portail d'environnements de test, ou Save our devops</a></li>
<li><a href="../fr492940/index.html">Plongez dans Charles Proxy</a></li>
<li><a href="../fr492942/index.html">Ontol (= le plus utile) sur le travail à distance [compilation de plus de 100 articles]</a></li>
<li><a href="../fr492946/index.html">Coronavirus: comment nous nous trompons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>