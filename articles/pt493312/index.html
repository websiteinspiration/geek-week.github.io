<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêñ ü§û üìÆ Rastreamento geogr√°fico no React Native üî± üë®üèΩ‚Äçüé® üéÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um aplicativo m√≥vel pode atuar como o "local de trabalho" de um funcion√°rio, enquanto pode ser necess√°rio transferir coordenadas geogr√°ficas e outros ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Rastreamento geogr√°fico no React Native</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/493312/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um aplicativo m√≥vel pode atuar como o "local de trabalho" de um funcion√°rio, enquanto pode ser necess√°rio transferir coordenadas geogr√°ficas e outros dados. No desenvolvimento de aplicativos de plataforma cruzada no iOS e Android, estruturas como Flutter ou React Native s√£o frequentemente usadas para esta tarefa. Neste artigo, falamos sobre os recursos de trabalho com geolocaliza√ß√£o no React Native usando o exemplo do nosso caso.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/d8/av/bqd8avprg_s7gfc5vohsywtdptg.png"><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A confiabilidade, velocidade e maturidade do React Native s√£o algumas vezes criticadas pelos desenvolvedores e, cerca de tr√™s anos atr√°s, essas d√∫vidas poderiam ser justificadas. No entanto, durante esse per√≠odo, a tecnologia se tornou mais avan√ßada e o React Native foi reconhecido como uma ferramenta pr√°tica para criar uma ampla variedade de aplicativos. Em particular, o React Native √© adequado para aplicativos que usam coordenadas geogr√°ficas - por exemplo, v√°rios rastreadores, aplicativos para correios, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m nas lojas s√£o desenvolvidas aplica√ß√µes React Native de lojas on-line, menus de restaurantes, feeds de not√≠cias, aplicativos de entrega, clientes para redes sociais - assim, um grande n√∫mero de React Native usa constantemente, sem sequer pensar nisso. Exemplos simples s√£o Facebook, Instagram, Skype, Uber Eats, Wallmart. De acordo com as previs√µes, a Microsoft pode reabastecer esta lista e transferir seus aplicativos m√≥veis para o React Native, especialmente depois de implementar o suporte para a plataforma Windows. H√° Reagir O suporte nativo para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MacOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , "built-in" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weechat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplica√ß√µes </font><font style="vertical-align: inherit;">, apesar de suporte e documenta√ß√£o para essas plataformas permanece bastante escassos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O React Native pode fazer quase tudo igual a um aplicativo nativo. Por exemplo, receba informa√ß√µes de sensores de dispositivo, como fazem os aplicativos Java / Kotlin ou ObjC / Swift, ou envie dados em segundo plano usando o Servi√ßo em primeiro plano ou a busca em segundo plano. A √∫nica diferen√ßa √© que no React Native voc√™ precisa implementar uma interface para a intera√ß√£o entre a parte nativa e o Javascript. Para tarefas di√°rias, essas interfaces j√° est√£o frequentemente implementadas. Isso tamb√©m se aplica ao rastreamento da localiza√ß√£o e opera√ß√£o do Javascript em segundo plano: j√° existem solu√ß√µes na forma de bibliotecas de c√≥digo aberto independentes. Aconteceu que a comunidade "puxa" o Javascript de forma independente, programadores e empresas est√£o usando ativamente solu√ß√µes de c√≥digo aberto. Poucas comunidades de idiomas possuem o mesmo n√∫mero de bibliotecas, estruturas,utilit√°rios de qualidade. E, no entanto, no React Native, alguns recursos existentes no desenvolvimento nativo ainda s√£o limitados, e isso deve ser lembrado.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabalhar com o React Native</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere v√°rios fatores principais que garantem a velocidade de desenvolvimento de aplicativos de plataforma cruzada no React Native:</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base de c√≥digo comum</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma vez escrita a l√≥gica, as telas e os componentes de layout em diferentes plataformas funcionam e t√™m a mesma apar√™ncia poss√≠vel (por exemplo, no Android, em vez das sombras usuais, eles usam a no√ß√£o de exalta√ß√£o). </font><font style="vertical-align: inherit;">Praticamente n√£o h√° dor de cabe√ßa eterna para um desenvolvedor com vers√µes antigas - por exemplo, √© f√°cil adicionar suporte at√© para o Android 4.4, embora na pr√°tica a implementa√ß√£o dessa tarefa tamb√©m dependa do uso de m√≥dulos nativos adicionais.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fluxo de trabalho ideal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Freq√ºentemente, o React fornece um fluxo de trabalho ideal que torna o desenvolvimento de novos recursos v√°rias vezes mais r√°pido do que nos idiomas nativos. </font><font style="vertical-align: inherit;">Isso se aplica ao layout, abordagem de componentes, instala√ß√£o de depend√™ncias, solu√ß√µes arquiteturais comuns para o React.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recarga a quente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O desenvolvedor n√£o precisa recriar o aplicativo todas as vezes para ver as altera√ß√µes. </font><font style="vertical-align: inherit;">Gra√ßas ao Hot Reload, s√£o necess√°rios apenas alguns segundos para atualizar o aplicativo para o estado atual. </font><font style="vertical-align: inherit;">E na vers√£o 0.61 Live Reload (agora √© Atualiza√ß√£o R√°pida) foi lembrada adicionalmente, agora, quando as altera√ß√µes de edi√ß√£o de texto s√£o editadas "on the fly", sem redefinir o estado atual dos componentes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao criar um aplicativo, v√°rias √°reas importantes requerem aten√ß√£o especial: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Javascript</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O React Native visa trabalhar com Javascript, permitindo que voc√™ descreva rapidamente a l√≥gica e as interfaces. Existem muitos m√≥dulos prontos do mundo da Web e do Node.js. que podem ser usados ‚Äã‚Äãda maneira usual (naturalmente, se n√£o estiverem conectados ao DOM ou ao lado do servidor). Apesar de sua alta velocidade, o Javascript √†s vezes √© inferior aos idiomas nativos. N√£o h√° multithreading. No React Native, n√£o podemos acessar diretamente a API nativa, embora essa restri√ß√£o possa ser removida em breve. Javascript descreve principalmente o que precisa ser feito e renderizado na parte nativa. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Ponte</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um barramento que aceita chamadas Javascript por meio de interfaces especiais fornecidas pela biblioteca react-native. As chamadas s√£o mensagens serializadas regulares. Para cada componente - uma Visualiza√ß√£o simples, um campo de entrada ou uma chamada para a caixa de di√°logo do sistema - existe uma interface descrita em Javascript com a l√≥gica implementada na parte nativa. O barramento √© a parte mais lenta, √© ass√≠ncrono, a transfer√™ncia de dados entre o Javascript e o nativo leva tempo (provavelmente, o Facebook pode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se livrar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> completamente </font><font style="vertical-align: inherit;">dele). Freq√ºentemente, os problemas de desempenho dos aplicativos no React Native s√£o causados ‚Äã‚Äãprecisamente pela opera√ß√£o da ponte, mas se voc√™ os usar corretamente (reduza a transfer√™ncia de dados para o m√≠nimo necess√°rio), o desempenho nos aplicativos React Native n√£o diferir√° significativamente. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) A parte nativa</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um aplicativo no React Native √© inicialmente um aplicativo nativo comum. </font><font style="vertical-align: inherit;">A peculiaridade √© que todas as bibliotecas necess√°rias j√° est√£o conectadas nela para que voc√™ possa escrever toda a l√≥gica no React JS. </font><font style="vertical-align: inherit;">Aqui, podemos escrever nossa pr√≥pria l√≥gica nativa para usar (ou n√£o us√°-la) em JS, adicionar bibliotecas nativas comuns (por exemplo, para suportar o TLS v1.2 no KitKat e vers√µes anteriores). </font><font style="vertical-align: inherit;">Em aplicativos nativos prontos, voc√™ pode adicionar suporte ao React Native.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabalhando com rastreamento geogr√°fico no React Native</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em um dos projetos, precis√°vamos desenvolver um "local de trabalho m√≥vel" para os funcion√°rios de nossos clientes, em particular, para garantir a transfer√™ncia de suas coordenadas geogr√°ficas em segundo plano. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem v√°rias ferramentas para trabalhar com geolocaliza√ß√£o no React Native. Por exemplo, este √© um pacote da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comunidade</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> React Native </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">@ react-native-community / geolocation</font></a><font style="vertical-align: inherit;"> , que cobre a maioria dos </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">casos de</font></a><font style="vertical-align: inherit;"> uso, no entanto, n√£o funciona em segundo plano. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para implementar nossa tarefa, usamos v√°rias solu√ß√µes, incluindo uma biblioteca com o nome falante </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ mauron85 / react-native-background-geolocation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Inicialmente, essa biblioteca era um plug-in para o Cordova, mas depois o autor separou a base e criou wrappers separados para o React Native. Tamb√©m existe uma biblioteca paga com o mesmo nome da transistorsoft, mas no momento do nosso trabalho no projeto, ela ganhou apenas com a documenta√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A biblioteca nos permitiu definir configura√ß√µes flex√≠veis para rastrear a localiza√ß√£o. Por exemplo, com que frequ√™ncia interrogar um servi√ßo do sistema, como exatamente trabalhar em segundo plano, em que raio a posi√ß√£o ser√° considerada im√≥vel. As configura√ß√µes e os m√©todos para enviar essas coordenadas para o servidor podem ser usados ‚Äã‚Äã"prontos para uso", mas decidimos n√£o enviar solicita√ß√µes de spam, mas agregar as coordenadas recebidas no reposit√≥rio e envi√°-las com um grande intervalo. Ao mesmo tempo, a biblioteca nos permitiu lan√ßar nosso aplicativo como atividade em primeiro plano, poupando-nos de dores de cabe√ßa desnecess√°rias, pois em muitos dispositivos Android os aplicativos em segundo plano podem funcionar apenas com configura√ß√µes adicionais ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Huawei, MIUI, Samsung recentemente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s a instala√ß√£o, voc√™ pode criar um componente ou apenas um auxiliar que gerencia o servi√ßo. </font><font style="vertical-align: inherit;">Decidimos usar o componente para mont√°-lo com as condi√ß√µes do roteador e conect√°-lo facilmente ao redux. </font><font style="vertical-align: inherit;">Configure nosso servi√ßo:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> BackgroundGeolocation, {<font></font>
  Location,<font></font>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@mauron85/react-native-background-geolocation'</span>;<font></font>
 <font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForegroundService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
<span class="hljs-comment">//...</span>
startBackgroundService = <span class="hljs-function">(<span class="hljs-params">config: GeotrackerConfig</span>) =&gt;</span> {
     <span class="hljs-comment">//    </span><font></font>
	BackgroundGeolocation.configure({<font></font>
  	<span class="hljs-attr">desiredAccuracy</span>: BackgroundGeolocation.HIGH_ACCURACY,
  	<span class="hljs-attr">stationaryRadius</span>: <span class="hljs-number">50</span>,
  	<span class="hljs-attr">distanceFilter</span>: config.distance,
  	<span class="hljs-attr">notificationTitle</span>: Strings.Geolocation.NOTIFICATION_TITLE,
  	<span class="hljs-attr">notificationText</span>: Strings.Geolocation.NOTIFICATION_DESCRIPTION,
  	<span class="hljs-attr">debug</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">startOnBoot</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">stopOnTerminate</span>: <span class="hljs-literal">true</span>,
  	<span class="hljs-attr">locationProvider</span>: BackgroundGeolocation.ACTIVITY_PROVIDER,
  	<span class="hljs-attr">interval</span>: <span class="hljs-keyword">this</span>.runnerInterval,
  	<span class="hljs-attr">fastestInterval</span>: <span class="hljs-number">10000</span>,
  	<span class="hljs-attr">activitiesInterval</span>: <span class="hljs-number">30000</span>,
  	<span class="hljs-attr">stopOnStillActivity</span>: <span class="hljs-literal">false</span>,
  	<span class="hljs-attr">notificationIconColor</span>: Colors.primary,
  	<span class="hljs-attr">notificationIconSmall</span>: <span class="hljs-string">'notification_icon'</span>,<font></font>
	});<font></font>
 <font></font>
     <span class="hljs-comment">//    start()      </span>
                    	BackgroundGeolocation.on(<span class="hljs-string">'authorization'</span>, status =&gt; {
  	<span class="hljs-keyword">if</span> (status !== BackgroundGeolocation.AUTHORIZED) {
    	<span class="hljs-comment">//   </span>
  	} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status.hasPermissions) {
        <span class="hljs-comment">// hasPermission -  ,    </span><font></font>
  	}<font></font>
	});<font></font>
 <font></font>
     <span class="hljs-comment">//  </span><font></font>
                    	BackgroundGeolocation.start();<font></font>
};<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vimos que aqui tamb√©m √© poss√≠vel definir configura√ß√µes para a notifica√ß√£o, um √≠cone (de ativos nativos). </font><font style="vertical-align: inherit;">E as permiss√µes? </font><font style="vertical-align: inherit;">Para o Android, depois de instalar o pacote, nada √© necess√°rio, a biblioteca assume os pedidos de acesso √† geolocaliza√ß√£o do sistema. </font><font style="vertical-align: inherit;">Mas, para opera√ß√£o normal no iOS no Xcode, voc√™ tamb√©m precisa habilitar o processamento em segundo plano e as atualiza√ß√µes de local na guia Assinatura e recursos do projeto. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/q9/yw/vnq9ywwhisotkblbxko5g3je3he.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementamos o m√©todo principal para salvar e enviar coordenadas no evento on ('location') no mesmo m√©todo. </font><font style="vertical-align: inherit;">Ele funcionar√° tanto com o aplicativo ativo quanto no estado minimizado:</font></font><br>
<br>
<pre><code class="javascript hljs">BackgroundGeolocation.on(<span class="hljs-string">'location'</span>, location =&gt; {<font></font>
    BackgroundGeolocation.startTask(<span class="hljs-keyword">async</span> taskKey =&gt; {
     <span class="hljs-comment">//       ,</span>
     <span class="hljs-comment">//     iOS-</span>
      <span class="hljs-keyword">const</span> batteryLevel = <span class="hljs-keyword">this</span>.isSimulator<font></font>
        ? <span class="hljs-number">100</span>
        : (<span class="hljs-keyword">await</span> DeviceInfo.getBatteryLevel()) * <span class="hljs-number">100</span>;
      <span class="hljs-keyword">const</span> updateDelta = location.time - <span class="hljs-keyword">this</span>.lastUpdateAt;<font></font>
<font></font>
     <span class="hljs-comment">//      </span>
      <span class="hljs-keyword">this</span>.props.locationUpdate(location);
      <span class="hljs-keyword">this</span>.props.locationAddTrackerData({
        <span class="hljs-attr">altitude</span>: location.altitude,
        <span class="hljs-attr">batteryChargeLevel</span>: batteryLevel,
        <span class="hljs-attr">latitude</span>: location.latitude,
        <span class="hljs-attr">longitude</span>: location.longitude,
        <span class="hljs-attr">course</span>: location.bearing,
        <span class="hljs-attr">accuracy</span>: location.accuracy,
        <span class="hljs-attr">speed</span>: location.speed,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Number</span>(<span class="hljs-built_in">String</span>(location.time).substr(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)),
        <span class="hljs-attr">isAlertOn</span>: <span class="hljs-literal">false</span>,<font></font>
      });<font></font>
<font></font>
     <span class="hljs-comment">//  ?</span>
      <span class="hljs-keyword">if</span> (updateDelta / <span class="hljs-number">1000</span> &gt; config.sendInterval) {
        <span class="hljs-keyword">this</span>.syncDataWithInterval();
        <span class="hljs-keyword">this</span>.lastUpdateAt = location.time;<font></font>
      }<font></font>
<font></font>
     <span class="hljs-comment">//    AsyncStorage,    </span><font></font>
      Storage.setLastKnownLocation(location);<font></font>
      BackgroundGeolocation.endTask(taskKey);  <span class="hljs-comment">//   !</span><font></font>
    });<font></font>
});<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui chamamos a√ß√£o da loja, onde transferimos os dados das coordenadas em um formato personalizado, al√©m de armazenar dados nas leituras da bateria, usando a biblioteca react-native-device-info. </font><font style="vertical-align: inherit;">Tudo isso funciona igualmente bem no Android e iOS quando o aplicativo est√° ativo ou em segundo plano. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, existem m√©todos para obter o local atual (mas isso s√≥ funciona quando o servi√ßo est√° sendo executado), assinando transi√ß√µes do estado do aplicativo de ativo para segundo plano, alternando para as configura√ß√µes do sistema do aplicativo. </font><font style="vertical-align: inherit;">No entanto, em geral, o mais necess√°rio √© dado nesses exemplos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado √© um componente que pode ser montado, por exemplo, apenas para a pe√ßa autorizada:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForegroundService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
	<span class="hljs-comment">//...</span><font></font>
	componentDidMount() {<font></font>
		<span class="hljs-keyword">this</span>.startBackgroundService(<span class="hljs-keyword">this</span>.props.config);<font></font>
	}<font></font>
<font></font>
	componentWillUnmount() {<font></font>
    BackgroundGeolocation.stop();<font></font>
    BackgroundGeolocation.removeAllListeners();<font></font>
  }<font></font>
<font></font>
	startBackgroundService = <span class="hljs-function">(<span class="hljs-params">config: GeotrackerConfig</span>) =&gt;</span> {<font></font>
    BackgroundGeolocation.configure({<font></font>
		<span class="hljs-comment">// ...</span><font></font>
	};<font></font>
<font></font>
	render() {<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
  }<font></font>
} </code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a navega√ß√£o de rea√ß√£o for usada, voc√™ poder√° criar a navega√ß√£o para a pe√ßa autorizada da seguinte maneira:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//  StackNavigator   </span>
<span class="hljs-keyword">const</span> Navigator = createStackNavigator(RouteConfigs, NavigatorConfig);<font></font>
<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppNavigator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">PureComponent</span>&lt;<span class="hljs-title">Props</span>&gt; </span>{
  <span class="hljs-keyword">static</span> router: NavigationRouter = Navigator.router;<font></font>
<font></font>
  componentDidMount(): <span class="hljs-keyword">void</span> {<font></font>
    SplashScreen &amp;&amp; SplashScreen.hide();<font></font>
  }<font></font>
<font></font>
  render() {<font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ForegroundService</span> <span class="hljs-attr">navigation</span>=<span class="hljs-string">{this.props.navigation}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Navigator</span> {<span class="hljs-attr">...this.props</span>} /&gt;</span>
      <span class="hljs-tag">&lt;/&gt;</span></span><font></font>
    );<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> AppNavigator;</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, este navegador pode ser usado da maneira usual no navegador raiz:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> RootNavigator = createSwitchNavigator(<font></font>
  {<font></font>
    <span class="hljs-attr">Auth</span>: AuthNavigator,
    <span class="hljs-attr">App</span>: AppNavigator,<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">initialRouteName</span>: <span class="hljs-string">'Auth'</span>,<font></font>
  },<font></font>
);<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createAppContainer(RootNavigator);</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, o servi√ßo de geolocaliza√ß√£o e troca de dados funcionar√° apenas na parte autorizada do aplicativo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumir</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, examinamos os recursos do uso do React Native em aplicativos de geolocaliza√ß√£o. </font><font style="vertical-align: inherit;">Como descobrimos, usando essa estrutura, os desenvolvedores agora podem rastrear facilmente as coordenadas geogr√°ficas do dispositivo - por exemplo, em rastreadores de bicicleta, aplicativos para correios e despachantes, aplicativos para escolher im√≥veis etc. </font><font style="vertical-align: inherit;">A biblioteca cobre a maioria dos casos relacionados ao rastreamento geogr√°fico, em particular, permite ajustar os intervalos e economizar energia do dispositivo, funciona de forma est√°vel em segundo plano nas duas plataformas e suporta a execu√ß√£o autom√°tica no Android. </font><font style="vertical-align: inherit;">Ao mesmo tempo, para aplicativos complexos, como regra, o desenvolvimento nativo √© mais adequado (por exemplo, para trabalhar com c√°lculos e widgets, como j√° escrevemos no </font><font style="vertical-align: inherit;">artigo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anterior</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agradecemos sua aten√ß√£o. Esperamos que o artigo tenha sido √∫til para voc√™!</font></font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt493302/index.html">Quais tecnologias j√° foram necess√°rias para combater o coronav√≠rus?</a></li>
<li><a href="../pt493304/index.html">Desenvolvendo um hexapod a partir do zero (parte 8) - movimento matem√°tico aprimorado</a></li>
<li><a href="../pt493306/index.html">Usando APIs de gateway como um ponto de entrada √∫nico para aplicativos da Web e APIs</a></li>
<li><a href="../pt493308/index.html">Experi√™ncia real de transfer√™ncia de quase todos os funcion√°rios para um site remoto</a></li>
<li><a href="../pt493310/index.html">Jogo de Deus: Organismos Artificiais</a></li>
<li><a href="../pt493320/index.html">Amplie o Laravel com nossos pr√≥prios componentes</a></li>
<li><a href="../pt493322/index.html">IT GRAD: primeiras impress√µes do formato de trabalho remoto</a></li>
<li><a href="../pt493332/index.html">Por que os termovisores n√£o conseguem medir a temperatura corporal de uma pessoa</a></li>
<li><a href="../pt493334/index.html">52 bilh√µes de ataques: amea√ßas da Trend Micro 2019</a></li>
<li><a href="../pt493336/index.html">Como o Centro de Ci√™ncia da Computa√ß√£o traduziu o aprendizado on-line</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>