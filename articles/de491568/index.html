<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌡️ 😲 🧒🏻 Erstellen eines Routers in SOCKS auf einem Laptop mit Debian 10 🎅🏻 🔳 🎣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Für ein ganzes Jahr (oder zwei) habe ich die Veröffentlichung dieses Artikels aus dem Hauptgrund verschoben - ich habe bereits zwei Artikel veröffentl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erstellen eines Routers in SOCKS auf einem Laptop mit Debian 10</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491568/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für ein ganzes Jahr (oder zwei) habe ich die Veröffentlichung dieses Artikels aus dem Hauptgrund verschoben - ich habe bereits zwei Artikel veröffentlicht, in denen ich den Prozess des Erstellens eines Routers in SOCKS von einem normalen Laptop mit Debian beschrieben habe.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seitdem die stabile Version von Debian auf Buster aktualisiert wurde, hat mir eine ausreichende Anzahl von Personen eine persönliche Anfrage zur Unterstützung bei der Konfiguration gesendet, was bedeutet, dass meine vorherigen Artikel nicht vollständig sind. Nun, ich selbst habe vermutet, dass die darin beschriebenen Methoden nicht alle Feinheiten der Konfiguration von Linux für das Routing in SOSKS vollständig enthüllten. Außerdem wurden sie für Debian Stretch geschrieben, und nach dem Upgrade auf Buster im Systemd-Initialisierungssystem stellte ich kleine Änderungen in der Interaktion der Dienste fest. Ja, und in den Artikeln selbst habe ich systemd-networkd nicht verwendet, obwohl es am besten für komplexe Netzwerkkonfigurationen geeignet ist.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zu den oben genannten Änderungen wurden meiner Konfiguration Dienste wie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hostapd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzugefügt </font><font style="vertical-align: inherit;">- ein Dienst für die Virtualisierung von Zugriffspunkten, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ntp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Synchronisieren der Zeit lokaler Netzwerkclients, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Verschlüsseln von DNS-Verbindungen und Deaktivieren der Werbung auf lokalen Netzwerkclients sowie, wie bereits erwähnt zuvor </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Konfigurieren von Netzwerkschnittstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist das einfachste Blockdiagramm der internen Struktur eines solchen Routers. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/eq/_f/gyeq_fcjwxnobupmbqn9b-hwqqk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher erinnere ich Sie daran, welche Ziele der Zyklus dieser Artikel verfolgt:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leiten Sie alle Betriebssystemverbindungen an SOCKS sowie die Verbindungen aller Geräte weiter, die sich im selben Netzwerk wie der Laptop befinden. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Laptop in meinem Fall sollte voll mobil bleiben. </font><font style="vertical-align: inherit;">Dies bedeutet, dass Sie die Möglichkeit haben, die Desktop-Umgebung zu verwenden und nicht an einen physischen Standort gebunden zu sein.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der letzte Punkt betrifft das Verbinden und Weiterleiten nur über die integrierte drahtlose Schnittstelle.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Natürlich die Erstellung eines umfassenden Leitfadens sowie die Analyse geeigneter Technologien nach bestem Wissen und Gewissen.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was wird in diesem Artikel berücksichtigt:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - download die tun2socks Projekt - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repositories</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu routen TCP - </font><font style="vertical-align: inherit;">Datenverkehr zu SOCKS benötigt, und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_ap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Skript , </font><font style="vertical-align: inherit;">das die Konfiguration eines virtuellen Access Point automatisieren </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hostapd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Erstellen und installieren Sie den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienst auf dem System </font><font style="vertical-align: inherit;">.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Konfigurieren Sie drahtlose und virtuelle Schnittstellen, statische Routing-Tabellen und Paketweiterleitung.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_ap</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Installieren Sie den systemd-Dienst auf dem System, konfigurieren Sie den virtuellen Zugriffspunkt und starten Sie ihn.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Optionale Schritte:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ntp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Installieren und konfigurieren Sie den Server so, dass die Zeit auf den Clients des virtuellen Zugriffspunkts synchronisiert wird.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - verschlüsselt DNS-Abfragen, </font><b><font style="vertical-align: inherit;">leitet</font></b><font style="vertical-align: inherit;"> sie an SOCKS weiter und deaktiviert </font><b><font style="vertical-align: inherit;">Werbedomänen</font></b><font style="vertical-align: inherit;"> für das lokale Netzwerk.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warum das alles?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine Möglichkeit, TCP-Verbindungen in einem lokalen Netzwerk zu sichern. Der Hauptvorteil besteht darin, dass alle Verbindungen zu SOCKS gehen, wenn für sie keine statische Route durch das ursprüngliche Gateway erstellt wurde. Dies bedeutet, dass es nicht erforderlich ist, die Einstellungen des SOCKS-Servers einzelnen Programmen oder Clients im lokalen Netzwerk vorzuschreiben. Alle gehen standardmäßig zu SOCKS, da dies das Standard-Gateway ist, bis wir das Gegenteil angeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich fügen wir den zweiten Verschlüsselungsrouter als Laptop vor dem ursprünglichen Router hinzu und verwenden die Internetverbindung des ursprünglichen Routers für die bereits verschlüsselten SOCKS-Anforderungen des Laptops, die wiederum die Anforderungen der lokalen Netzwerkclients weiterleiten und verschlüsseln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus Sicht des Anbieters sind wir mit verschlüsseltem Datenverkehr ständig mit demselben Server verbunden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend stellen alle Geräte eine Verbindung zum virtuellen Zugangspunkt eines Laptops her.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bevor du anfängst</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fast alle Konfigurationen sind im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verfügbar </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie tun2socks im System</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie alle erforderlichen Tools herunter, solange Sie über Internet auf Ihrem Computer verfügen.</font></font><br>
<br>
<pre><code class="bash hljs">apt update</code></pre><br>
<pre><code class="bash hljs">apt install git make cmake</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie das badvpn-Paket herunter</font></font><br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/ambrop72/badvpn
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">badvpn-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner wird auf Ihrem System </font><i><font style="vertical-align: inherit;">angezeigt</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Erstellen Sie einen separaten Build-Ordner</font></font><br>
<br>
<pre><code class="bash hljs">mkdir badvpn-build
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geh zu ihr</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> badvpn-build
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks</font></font></i><br>
<br>
<pre><code class="bash hljs">cmake ../badvpn -DBUILD_NOTHING_BY_DEFAULT=1 -DBUILD_TUN2SOCKS=1
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem System installieren</font></font><br>
<br>
<pre><code class="bash hljs">make install
</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Parameter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-DBUILD_NOTHING_BY_DEFAULT =</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 deaktiviert die Assemblierung aller Komponenten des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">badvpn-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Repositorys </font><font style="vertical-align: inherit;">.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DBUILD_TUN2SOCKS = 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enthält </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Komponenten in der Assembly </font><font style="vertical-align: inherit;">.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">make install</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><b><font style="vertical-align: inherit;">Installiert</font></b><font style="vertical-align: inherit;"> die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Binärdatei </font><font style="vertical-align: inherit;">auf Ihrem System unter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / local / bin / badvpn-tun2socks.</font></font></i></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie den Dienst tun2socks in systemd</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/systemd/system/tun2socks.service</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit folgendem Inhalt:</font></font><br>
<br>
<pre><code class="bash hljs">[Unit]<font></font>
Description=SOCKS TCP Relay<font></font>
<font></font>
[Service]<font></font>
ExecStart=/usr/<span class="hljs-built_in">local</span>/bin/badvpn-tun2socks --tundev tun2socks --netif-ipaddr 172.16.1.1 --netif-netmask 255.255.255.0 --socks-server-addr 127.0.0.1:9050<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target<font></font>
</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--tundev</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - akzeptiert den Namen der virtuellen Schnittstelle, die wir mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initialisieren </font><font style="vertical-align: inherit;">.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--netif-ipaddr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Netzwerkadresse der "Router" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit denen die virtuelle Schnittstelle verbunden ist. </font><font style="vertical-align: inherit;">Es ist besser, ein separates </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reserviertes Subnetz zu erstellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--socks-server-addr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - akzeptiert einen Socket ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresse:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SOCKS-Server- </font><i><font style="vertical-align: inherit;">Port</font></i><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Ihr SOCKS-Server eine Authentifizierung erfordert, können Sie die </font><b><font style="vertical-align: inherit;">Parameter </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--username</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angeben </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Registrieren Sie als Nächstes den Dienst</font></font><br>
<br>
<pre><code class="bash hljs">systemctl daemon-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und einschalten</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">enable</span> tun2socks</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir den Dienst starten, stellen wir ihm eine virtuelle Netzwerkschnittstelle zur Verfügung.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie zu systemd-networkd</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aktivieren Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">enable</span> systemd-networkd</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deaktivieren Sie die aktuellen Netzwerkdienste.</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">disable</span> networking NetworkManager NetworkManager-wait-online</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetworkManager-wait-online</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Dienst, der auf eine funktionierende Netzwerkverbindung wartet, bevor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weiterhin andere vom Netzwerk abhängige Dienste startet. </font><font style="vertical-align: inherit;">Wir deaktivieren es, wenn wir zum analogen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systemd-Netzwerk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wechseln </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie es uns sofort einschalten:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">enable</span> systemd-networkd-wait-online</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Richten Sie eine drahtlose Netzwerkschnittstelle ein</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konfigurationsdatei </font><font style="vertical-align: inherit;">für die drahtlose Netzwerkschnittstelle </font></font><code>/etc/systemd/network/25-wlp6s0.network</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">[Match]<font></font>
Name=wlp6s0<font></font>
<font></font>
[Network]<font></font>
Address=192.168.1.2/24<font></font>
IPMasquerade=yes<font></font>
</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Name Ihrer drahtlosen Schnittstelle. </font><font style="vertical-align: inherit;">Identifizieren Sie es mit dem Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ip a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPMasquerade</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine Richtlinie, die </font><font style="vertical-align: inherit;">folgenden beinhaltet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masquerading</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Paketweiterleitung auf einer Netzwerk - </font><font style="vertical-align: inherit;">Schnittstelle.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Adresse</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist für die Zuweisung einer IP-Adresse zur drahtlosen Schnittstelle verantwortlich. </font><font style="vertical-align: inherit;">Wir geben es statisch , </font><font style="vertical-align: inherit;">weil mit der entsprechenden Richtlinie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DHCP = yes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-NetworkD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen Standard - </font><font style="vertical-align: inherit;">Gateway im System erstellt. </font><font style="vertical-align: inherit;">Dann wird der gesamte Datenverkehr über das ursprüngliche Gateway und nicht über die zukünftige virtuelle Schnittstelle in einem hervorragenden Subnetz geleitet. </font><font style="vertical-align: inherit;">Sie können das aktuelle Standard-Gateway mit dem Befehl überprüfen</font></font><pre><code class="bash hljs">ip r</code></pre></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie eine statische Route für den Remote-SOCKS-Server</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Ihr SOCKS-Server nicht lokal, sondern remote ist, müssen Sie eine statische Route dafür erstellen. </font><font style="vertical-align: inherit;">Fügen Sie dazu den Abschnitt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> am Ende der von Ihnen erstellten WLAN-Konfigurationsdatei mit den folgenden Inhalten hinzu:</font></font><br>
<br>
<pre><code class="bash hljs">[Route]<font></font>
Gateway=192.168.1.1<font></font>
Destination=0.0.0.0<font></font>
</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gateway</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist das Standard-Gateway oder die Standardadresse Ihres ursprünglichen Zugriffspunkts.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - SOCKS-Serveradresse.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie wpa_supplicant für systemd-networkd</font></font></h3><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwendet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wpa_supplicant</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um eine Verbindung zu einem sicheren Zugriffspunkt </font><i><font style="vertical-align: inherit;">herzustellen</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wenn Sie versuchen, die drahtlose Schnittstelle zu "erhöhen", </font><font style="vertical-align: inherit;">startet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Dienst </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wpa_supplicant @ name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wobei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Name der drahtlosen Schnittstelle ist. </font><font style="vertical-align: inherit;">Wenn Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vor diesem Zeitpunkt </font><font style="vertical-align: inherit;">noch nicht verwendet haben </font><font style="vertical-align: inherit;">, ist dieser Dienst auf Ihrem System mit </font><i><font style="vertical-align: inherit;">Sicherheit</font></i><font style="vertical-align: inherit;"> nicht verfügbar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie es daher mit dem folgenden Befehl:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">enable</span> wpa_supplicant@wlp6s0</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wlp6s0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Namen für meine drahtlose Schnittstelle verwendet. </font><font style="vertical-align: inherit;">Ihr Name kann anders sein. </font><font style="vertical-align: inherit;">Sie können von seinem Team herausfinden</font></font><pre><code class="bash hljs">ip l</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt wird der erstellte Dienst </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wpa_supplicant @ wlp6s0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gestartet, wenn die drahtlose Schnittstelle "aufgehoben" wird. Er sucht jedoch wiederum nach der SSID und dem Kennwort des Zugriffspunkts in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / wpa_supplicant / wpa_supplicant-wlp6s0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Daher müssen Sie es mit dem Dienstprogramm </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wpa_passphrase</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellen </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Führen Sie dazu den folgenden Befehl aus:</font></font><br>
<br>
<pre><code class="bash hljs">wpa_passphrase SSID password&gt;/etc/wpa_supplicant/wpa_supplicant-wlp6s0.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dabei ist </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSID</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Name Ihres Zugangspunkts, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kennwort</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das Kennwort und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wlp6s0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Name Ihrer drahtlosen Schnittstelle.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialisieren Sie die virtuelle Schnittstelle für tun2socks</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine Datei, um eine neue virtuelle Schnittstelle im System </font><i><font style="vertical-align: inherit;">/etc/systemd/network/25-tun2socks.netdev</font></i><font style="vertical-align: inherit;"> zu initialisieren</font></font><i><font style="vertical-align: inherit;"></font></i><br>
<br>
<pre><code class="bash hljs">[NetDev]<font></font>
Name=tun2socks<font></font>
Kind=tun<font></font>
</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Name, den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der zukünftigen virtuellen Schnittstelle bei der Initialisierung zuweist.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist eine Art virtuelle Schnittstelle. </font><font style="vertical-align: inherit;">Anhand des Namens des Dienstes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können Sie davon ausgehen, dass er eine Schnittstelle wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun verwendet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdev</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist die Dateierweiterung, mit der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> virtuelle Netzwerkschnittstellen initialisiert. </font><font style="vertical-align: inherit;">Die Adresse und andere Netzwerkeinstellungen für diese Schnittstellen sind in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.network-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateien angegeben.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/systemd/network/25-tun2socks.network</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit den folgenden Inhalten:</font></font><br>
<br>
<pre><code class="bash hljs">[Match]<font></font>
Name=tun2socks<font></font>
<font></font>
[Network]<font></font>
Address=172.16.1.2/24<font></font>
Gateway=172.16.1.1<font></font>
</code></pre><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Der Name der virtuellen Schnittstelle, die Sie in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdev-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei angegeben haben.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adresse</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - IP-Adresse, die der virtuellen Schnittstelle zugewiesen werden soll. </font><font style="vertical-align: inherit;">Muss sich im selben Netzwerk befinden wie die Adresse, die Sie in </font><i><font style="vertical-align: inherit;">tun2socks</font></i><font style="vertical-align: inherit;"> angegeben </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben</font></font></i></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gateway</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Die IP-Adresse der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des Routers </font><font style="vertical-align: inherit;">, die Sie beim Erstellen des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstes angegeben haben </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit hat die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schnittstelle </font><font style="vertical-align: inherit;">die Adresse </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.16.1.2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienst </font><font style="vertical-align: inherit;">lautet </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.16.1.1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">dh</font></i><font style="vertical-align: inherit;"> er ist das Gateway für alle Verbindungen von der virtuellen Schnittstelle.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie einen virtuellen Zugangspunkt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installieren Sie die Abhängigkeiten:</font></font><br>
<br>
<pre><code class="bash hljs">apt install util-linux procps hostapd iw haveged</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie das Repository </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_ap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf Ihren Computer </font><font style="vertical-align: inherit;">herunter </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/oblique/create_ap</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wechseln Sie zum Repository-Ordner auf Ihrem Computer:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> create_ap</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im System installieren:</font></font><br>
<br>
<pre><code class="bash hljs">make install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Konfiguration </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/create_ap.conf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird auf Ihrem System </font><i><font style="vertical-align: inherit;">angezeigt</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hier sind die wichtigsten Optionen zum Bearbeiten:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GATEWAY = 10.0.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Es ist besser, ein separates reserviertes Subnetz zu </font><b><font style="vertical-align: inherit;">erstellen</font></b><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NO_DNS = 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ausschalten, da dieser Parameter von der virtuellen System-Netzwerk-Schnittstelle gesteuert wird.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NO_DNSMASQ = 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - aus demselben Grund ausschalten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WIFI_IFACE = wlp6s0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - drahtlose Schnittstelle des Laptops.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INTERNET_IFACE = tun2socks&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Virtuelle Schnittstelle für </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks erstellt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSID = hostapd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Name des virtuellen Zugangspunkts.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PASSPHRASE = 12345678</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Passwort.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Denken Sie daran, den Dienst zu aktivieren:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl <span class="hljs-built_in">enable</span> create_ap</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivieren Sie den DHCP-Server in systemd-networkd</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Dienst </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_ap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initialisiert die virtuelle Schnittstelle </font><i><font style="vertical-align: inherit;">ap0</font></i><font style="vertical-align: inherit;"> auf dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Theoretisch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hängt </font><i><font style="vertical-align: inherit;">dnsmasq</font></i><font style="vertical-align: inherit;"> an dieser Schnittstelle </font><font style="vertical-align: inherit;">, aber warum zusätzliche Dienste installieren, wenn </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen integrierten DHCP-Server enthält? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Definieren Sie zum Aktivieren die Netzwerkeinstellungen für den virtuellen Punkt. Erstellen Sie dazu die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/systemd/network/25-ap0.network</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit folgendem Inhalt:</font></font><br>
<br>
<pre><code class="bash hljs">[Match]<font></font>
Name=ap0<font></font>
<font></font>
[Network]<font></font>
Address=10.0.0.1/24<font></font>
DHCPServer=yes<font></font>
<font></font>
[DHCPServer]<font></font>
EmitDNS=yes<font></font>
DNS=10.0.0.1<font></font>
EmitNTP=yes<font></font>
NTP=10.0.0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem der Dienst </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sreate_ap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> virtuelle Schnittstelle initialisiert </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AP0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-NetworkD</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> automatisch eine IP-Adresse zuweisen und den DHCP-Server aktivieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Zeilen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmitDNS = yes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS = 10.0.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> übergeben die DNS- </font><b><font style="vertical-align: inherit;">Servereinstellungen</font></b><font style="vertical-align: inherit;"> an Geräte, die mit dem Access Point verbunden sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie nicht </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vorhaben,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen lokalen DNS-Server zu verwenden - in meinem Fall handelt es sich um </font><i><font style="vertical-align: inherit;">dnscrypt-proxy</font></i><font style="vertical-align: inherit;"> -, können Sie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS = 10.0.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS = 192.168.1.1 setzen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wobei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.168.1.1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Adresse Ihres ursprünglichen Gateways ist. Dann werden die DNS-Abfragen Ihres Hosts und Ihres lokalen Netzwerks über die Server des Anbieters unverschlüsselt. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmitNTP = ja</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NTP = 192.168.1.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> übertragen die NTP-Einstellungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleiches gilt für die Zeile </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NTP = 10.0.0.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und konfigurieren Sie den NTP-Server</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im System installieren:</font></font><br>
<br>
<pre><code class="bash hljs">apt install ntp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie die Konfiguration </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/ntp.conf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kommentieren Sie die Adressen von Standardpools aus:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#pool 0.debian.pool.ntp.org iburst</span>
<span class="hljs-comment">#pool 1.debian.pool.ntp.org iburst</span>
<span class="hljs-comment">#pool 2.debian.pool.ntp.org iburst</span>
<span class="hljs-comment">#pool 3.debian.pool.ntp.org iburst</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie die Adressen öffentlicher Server hinzu, z. B. Google Public NTP:</font></font><br>
<br>
<pre><code class="bash hljs">server time1.google.com ibrust<font></font>
server time2.google.com ibrust<font></font>
server time3.google.com ibrust<font></font>
server time4.google.com ibrust<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gewähren Sie Clients aus Ihrem Netzwerk Zugriff auf den Server:</font></font><br>
<br>
<pre><code class="bash hljs">restrict 10.0.0.0 mask 255.255.255.0
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwandeln Sie die Sendung in Ihr Netzwerk:</font></font><br>
<br>
<pre><code class="bash hljs">broadcast 10.0.0.255
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie abschließend die Adressen dieser Server zur statischen Routing-Tabelle hinzu. </font><font style="vertical-align: inherit;">Öffnen Sie dazu die WLAN-Konfigurationsdatei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/systemd/network/25-wlp6s0.network</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und fügen Sie am Ende den Abschnitt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route hinzu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">[Route]<font></font>
Gateway=192.168.1.1<font></font>
Destination=216.239.35.0<font></font>
<font></font>
[Route]<font></font>
Gateway=192.168.1.1<font></font>
Destination=216.239.35.4<font></font>
<font></font>
[Route]<font></font>
Gateway=192.168.1.1<font></font>
Destination=216.239.35.8<font></font>
<font></font>
[Route]<font></font>
Gateway=192.168.1.1<font></font>
Destination=216.239.35.12</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können die Adressen Ihrer NTP-Server mithilfe des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstprogramms </font><font style="vertical-align: inherit;">wie folgt ermitteln:</font></font><br>
<br>
<pre><code class="bash hljs">host time1.google.com</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entfernen Sie Anzeigen und verbergen Sie den DNS-Verkehr vor dem Anbieter</font></font></h2><br>
<pre><code class="bash hljs">apt install dnscrypt-proxy</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie den Socket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/lib/systemd/system/dnscrypt-proxy.socket,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um die DNS-Abfragen des Hosts und des lokalen Netzwerks zu bearbeiten </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ändern Sie die folgenden Zeilen:</font></font><br>
<br>
<pre><code class="bash hljs">ListenStream=0.0.0.0:53<font></font>
ListenDatagram=0.0.0.0:53</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neustart </font></font><code>systemd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl daemon-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie die Konfiguration </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/dnscrypt-proxy/dnscrypt-proxy.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">server_names = [<span class="hljs-string">'adguard-dns'</span>]
</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fügen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie Folgendes </font><i><font style="vertical-align: inherit;">hinzu</font></i><font style="vertical-align: inherit;"> , um </font><font style="vertical-align: inherit;">
dnscrypt-proxy-Verbindungen über </font><i><font style="vertical-align: inherit;">tun2socks weiterzuleiten</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">force_tcp = <span class="hljs-literal">true</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bearbeiten Sie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfiguration /etc/resolv.conf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die den DNS-Server dem Host mitteilt.</font></font><br>
<br>
<pre><code class="bash hljs">nameserver 127.0.0.1<font></font>
nameserver 192.168.1.1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Zeile enthält die Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die zweite - verwendet das ursprüngliche Gateway, falls der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Server </font><font style="vertical-align: inherit;">nicht verfügbar ist.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erledigt!</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starten Sie vorhandene Netzwerkdienste neu oder beenden Sie sie:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl stop networking NetworkManager NetworkManager-wait-online</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und starten Sie alle notwendigen neu:</font></font><br>
<br>
<pre><code class="bash hljs">systemctl restart systemd-networkd tun2socks create_ap dnscrypt-proxy ntp</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Neustart oder Neustart verfügen Sie über einen zweiten Zugriffspunkt, der die Host- und LAN-Geräte an SOCKS weiterleitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht die Ausgabe aus.</font></font><pre><code class="bash hljs">ip a</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> normaler Laptop:</font></font><br>
<br>
<pre><code class="bash hljs">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<font></font>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<font></font>
    inet 127.0.0.1/8 scope host lo<font></font>
       valid_lft forever preferred_lft forever<font></font>
    inet6 ::1/128 scope host <font></font>
       valid_lft forever preferred_lft forever<font></font>
2: tun2socks: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 500<font></font>
    link/none <font></font>
    inet 172.16.1.2/24 brd 172.16.1.255 scope global tun2socks<font></font>
       valid_lft forever preferred_lft forever<font></font>
    inet6 fe80::122b:260:6590:1b0e/64 scope link stable-privacy <font></font>
       valid_lft forever preferred_lft forever<font></font>
3: enp4s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000<font></font>
    link/ether e8:11:32:0e:01:50 brd ff:ff:ff:ff:ff:ff<font></font>
4: wlp6s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000<font></font>
    link/ether 4c:ed:de:cb:cf:85 brd ff:ff:ff:ff:ff:ff<font></font>
    inet 192.168.1.2/24 brd 192.168.1.255 scope global wlp6s0<font></font>
       valid_lft forever preferred_lft forever<font></font>
    inet6 fe80::4eed:deff:fecb:cf85/64 scope link <font></font>
       valid_lft forever preferred_lft forever<font></font>
5: ap0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000<font></font>
    link/ether 4c:ed:de:cb:cf:86 brd ff:ff:ff:ff:ff:ff<font></font>
    inet 10.0.0.1/24 brd 10.0.0.255 scope global ap0<font></font>
       valid_lft forever preferred_lft forever<font></font>
    inet6 fe80::4eed:deff:fecb:cf86/64 scope link <font></font>
       valid_lft forever preferred_lft forever<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassend</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Anbieter sieht nur die verschlüsselte Verbindung zu Ihrem SOCKS-Server, was bedeutet, dass er nichts sieht.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und doch sieht er Ihre NTP-Anfragen. Um dies zu verhindern, löschen Sie die statischen Routen für NTP-Server. </font><font style="vertical-align: inherit;">Es ist jedoch keine Tatsache, dass Ihr SOCKS-Server NTP zulässt.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Krücke auf Debain 10 gesehen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie versuchen, den Netzwerkdienst über die Konsole neu zu starten, schlägt dies mit einem Fehler fehl. </font><font style="vertical-align: inherit;">Dies liegt an der Tatsache, dass ein Teil davon in Form einer virtuellen Schnittstelle an den Dienst </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gebunden ist </font><font style="vertical-align: inherit;">, was bedeutet, dass er verwendet wird. </font><font style="vertical-align: inherit;">Um den Netzwerkdienst neu zu starten, müssen Sie zuerst den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tun2socks-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienst </font><i><font style="vertical-align: inherit;">beenden</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Aber ich denke, wenn Sie bis zum Ende lesen, ist es für Sie definitiv kein Problem!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verweise</font></font></h4><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statisches Routing unter Linux - IBM</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">systemd-networkd.service - Freedesktop.org</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tun2socks ambrop72 / badvpn wiki github</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oblique / create_ap: Dieses Skript erstellt einen NATed oder Bridged WiFi Access Point.</font></font></a><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dnscrypt-proxy 2 - Ein flexibler DNS-Proxy mit Unterstützung für verschlüsselte DNS-Protokolle.</font></font></a></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de491558/index.html">Finden Sie weitere Rock-Ostereier: von mysteriösen Nachrichten bis hin zu Anrufen, um Ihre Hände zu waschen und Ihre Hausaufgaben zu machen</a></li>
<li><a href="../de491560/index.html">Wie kann man das Terminal zu seinem Assistenten machen, nicht zu einem Feind?</a></li>
<li><a href="../de491562/index.html">FOSS News Nr. 6 - Überprüfung der kostenlosen und Open Source-Nachrichten für den 2. bis 8. März 2020</a></li>
<li><a href="../de491564/index.html">Java 14: Record, eine präzisere Instanz von Jpackage Wrapper, Switch Lambdas und Textblöcken</a></li>
<li><a href="../de491566/index.html">Maschinelles Lernen in R-Sprache mit dem mlr3-Paket</a></li>
<li><a href="../de491570/index.html">Warum ICQ nach dem Kauf von Mail.Ru einen alten Benutzer verloren hat</a></li>
<li><a href="../de491572/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 405 (2. - 8. März 2020)</a></li>
<li><a href="../de491574/index.html">Ein einfacher Trick zum Verwalten des Aufschubs</a></li>
<li><a href="../de491576/index.html">Transformatoren als graphische neuronale Netze</a></li>
<li><a href="../de491584/index.html">Die Zusammenfassung interessanter Materialien für den mobilen Entwickler # 336 (2. - 9. März)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>