<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ ‚ò£Ô∏è üçµ G√©o-chat, robots nuisibles et st√©ganographie: enrichir les connaissances sur Telegram üë®üèº‚Äçüî¨ üêò ü§∑üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Que savez-vous des t√©l√©grammes en t√©l√©gramme? Et pouvez-vous distinguer la st√©ganographie dans VideoNote (populairement - round-robin)? Nous analysons...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>G√©o-chat, robots nuisibles et st√©ganographie: enrichir les connaissances sur Telegram</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/499366/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/r-/kn/lsr-knoirt_c2eklbngtrv43ys4.png"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que savez-vous des t√©l√©grammes en t√©l√©gramme? </font><font style="vertical-align: inherit;">Et pouvez-vous distinguer la st√©ganographie dans VideoNote (populairement - round-robin)? </font><font style="vertical-align: inherit;">Nous analysons la t√¢che m√™me </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a suscit√© le plus de questions et d'exclamations √† notre support! </font><font style="vertical-align: inherit;">Spoiler: oui, et il y aura aussi un peu de crypto :)</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la l√©gende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">on</font></a><font style="vertical-align: inherit;"> retrouve un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vers le profil d'un robot voyageur sur Instagram. </font><font style="vertical-align: inherit;">Rien d'extraordinaire, non? </font><font style="vertical-align: inherit;">Nous avons donc d√©cid√© de le faire aussi, mais nous devons encore r√©soudre le probl√®me, nous examinons donc attentivement toutes les images du profil et recherchons au moins quelques indices. </font><font style="vertical-align: inherit;">Une petite m√©ditation sur une belle photo du lac Ba√Økal, et on en vient √† r√©aliser que l'indice est dans le dernier post:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/f3/yp/wgf3ypumnzx-gms9aj5ixn7qllw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√¢ce √† l'image, nous comprenons que nous devons en quelque sorte connecter le Ba√Økal (Shaman Rock) et le t√©l√©gramme ("U peut rejoindre mon ..." - cela ne me rappelle-t-il rien?). </font><font style="vertical-align: inherit;">Au d√©but, nous avons d√©cid√© de ne pas donner aux participants un indice direct de g√©o-chat (ce qui est exactement √ßa!), Et beaucoup d'entre eux ont r√©ussi √† faire face √† la t√¢che en utilisant un √©mulateur ou un appareil mobile avec la possibilit√© de changer la g√©olocalisation. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shamanim Nous avons d√©fini les</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordonn√©es (53.20074, 107.349426) (vous pouvez √† l'≈ìil nu) dans la zone du rocher de Shamanka et pr√©parons la chose la plus difficile - l'attente. </font><font style="vertical-align: inherit;">Telegram fonctionne √©trangement avec le g√©o-positionnement et r√©cup√®re les contacts et les chats pertinents pendant une heure. </font><font style="vertical-align: inherit;">Pour notre diligence et notre patience, nous sommes pleinement r√©compens√©s - le chat souhait√© appara√Æt dans la section Contacts -&gt; Trouver des personnes √† proximit√© -&gt; Groupes √† proximit√©.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/z_/ti/cbz_tiwdqa0j0cqdikmwjob704y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voila, nous sommes en affaires! </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_c/or/zt/_corztflxylgeewrehp61prvssu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bot nous rencontre une t√¢che sous la forme d'un fichier some.bytes avec un contenu non identifi√©, dans lequel nous pouvons lire les lignes "Decrypt me" et "Apocalypse Spares Nobody". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous comprenons la premi√®re ligne sans aucun probl√®me, mais que signifie la seconde? .. Ici, les participants se sont divis√©s en deux camps: certains nous ont √©crit par courrier, car ils se sont retrouv√©s dans une impasse, tandis que d'autres ont soigneusement examin√© la phrase "Apocalypse Spares Nobody" et ont discern√© cela ? Droite! Bon vieux format </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASN.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous avons d√©j√† √©crit sur la fa√ßon de l'analyser).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/vr/k4/bbvrk4nu0xsdayswyptuv2z1gpw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faisons les choses correctement. A l'int√©rieur se trouvent 2 structures. Dans l'un, nous trouvons un ensemble d'octets marqu√© "Decrypt me", √† partir duquel nous supposons qu'il s'agit d'un texte chiffr√©. Dans la deuxi√®me structure, nous voyons deux nombres. Il est peu probable qu'il s'agisse d'une cl√© g√©n√©reusement pr√©sent√©e par le participant avec un texte chiffr√©, ce qui signifie tr√®s probablement. Nous avons affaire √† une cl√© publique. Toutes les informations recueillies nous conduisent √† la conclusion √©vidente - pourquoi ne pas essayer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc un module et un indicateur ouvert, qui, soit dit en passant, est assez grand. Apr√®s une </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©tude convulsive du RSA pour une</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r√©flexion, nous concluons que l'indicateur ferm√© est petit, ce qui signifie quoi? Bingo! Nous pouvons certainement jouer les m√©chants et utiliser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'attaque de Wiener</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous l'avons pens√© m√™me pour ceux qui n'aiment pas la cryptographie - vous pouvez utiliser une version pr√™te √† l'emploi de l'attaque, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ceci</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite , </font><font style="vertical-align: inherit;">nous obtenons la valeur d'une figure ferm√©e </font></font><code>d=40553818206320299896275948250950248823966726834704013657854904761789429403771</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et D√©crypter cryptogramme: </font></font><code>key=nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u;pass=passCxws3jzYhp0HD5Fy84</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons la cl√© "nq2020faAeFeGUCBjYf7UDrH9FapFCdFPa4u" dans la premi√®re partie du travail et le mot de passe "passCxws3jzYhp0HD5Fy84", dont vous avez besoin pour nourrir le repr√©sentant du bot. </font><font style="vertical-align: inherit;">Il peut √™tre trouv√© parmi les participants au chat sous le nom @neoquestbot. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant sur la vague du positif de la r√©ception de la premi√®re cl√©, nous ne r√©alisons pas imm√©diatement que le bot est pointilleux en communication et dit tout le temps qu'il ne voit pas l'interlocuteur:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/ky/t_/exkyt__66acqprkte1kk_hljuge.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le bot re√ßoit avec joie les messages ronds VideoNote et y r√©pond m√™me ... sous la m√™me forme ronde:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/tk/k4/gvtkk4hr8u_a8gsidkkqijtcuzy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semble que la vid√©o et le son soient les m√™mes, mais ce n'est qu'√† premi√®re vue. </font><font style="vertical-align: inherit;">Et si notre bot nous donne des signes secrets? </font><font style="vertical-align: inherit;">Pour le savoir, nous allons enregistrer et comparer la vid√©o originale avec la r√©ponse du bot. </font><font style="vertical-align: inherit;">Pour cela et pour les prochaines √©tapes, le package </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est id√©al pour nous </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Voyons donc ce qu'il y a:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/re/jy/z0/rejyz0tnqx0lgvvcggpctdv2elq.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/e3/_v/rie3_vg77u1j1txjch9te5a8y1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Format aac -&gt; flac, fr√©quence 44100 Hz -&gt; 98000 Hz. </font><font style="vertical-align: inherit;">Ils ont d√©couvert, nous continuons √† travailler davantage avec l'audio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec un mouvement habile des mains, nous le retirons de la vid√©o:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/er/ql/jh/erqljhyvzkhdq34zoxmfvl7ezty.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√™me chose peut √™tre faite avec notre message d'origine, afin que nous puissions les comparer plus tard. </font><font style="vertical-align: inherit;">Pour plus de clart√©, ouvrez les deux pistes dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Audacity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/ga/gq/gdgagqn_qtefqtnbyphj2ud0b00.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le saut d'amplitude dans la r√©ponse audio du bot attire imm√©diatement votre attention (particuli√®rement √©trange si nous √©tions silencieux). </font><font style="vertical-align: inherit;">En y regardant de plus pr√®s, on note les limites claires des intervalles lors de l'alternance du "silence d'onde":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mu/7f/zp/mu7fzposl6z9ozjrxanvjfnh2hw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sugg√©rons de mettre toutes choses de c√¥t√© et de compter un peu. </font><font style="vertical-align: inherit;">Nous analysons par fragments: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 - 0,005 - silence </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,005 - 0,01 - vague </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0, 01 - 0,0225 - silence </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,025 - 0,04 - vague </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0,04 - 0,045 - silence </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus petit intervalle est 0,005, et tous les autres les intervalles sont des multiples de 0,005. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On prend la pr√©sence d'une onde de 0,005 pour 1, et du silence pour 0. On n'obtient rien de plus qu'un code binaire! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous rappelons que la fr√©quence a chang√© et essayons de regarder le graphique du spectre (Analyse -&gt; Graphique du spectre):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/us/g0/7pusg01eyco5oawp9fyw92rbpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons que le signal le plus puissant est √† une fr√©quence de ~ 44100 Hz, ce qui est des ultrasons. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, vous ne devriez travailler qu'avec des fr√©quences √©lev√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, le bot superpose son signal sur l'audio d'origine dans le spectre audible. Et les participants qui avaient du son dans la vid√©o originale l'ont remarqu√© dans Audacity. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous coupons les hautes fr√©quences avec un filtre passe-haut soit dans Audacity, soit dans le m√™me ffmpeg:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3c/tk/tc/3ctktc0fgdc9zevjijzypncxb9o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc un fichier wav mono 16 bits. Il se compose d'un en-t√™te, d'un flux audio non compress√© et de m√©tadonn√©es. Le flux audio lui-m√™me est divis√© en images (et les images peuvent stocker plusieurs √©chantillons, mais c'est une histoire compl√®tement diff√©rente), dans notre cas, 16 bits chacune (cela est indiqu√© par les lettres pcm_s16 dans les captures d'√©cran). Les trames sont des s√©quences de bits qui d√©crivent l'amplitude de l'onde √† la fois pour un ou plusieurs canaux (dans notre cas, pour un). La fr√©quence d'√©chantillonnage du flux audio est de 98 000 images (c'est-√†-dire 98 000 images par seconde), 490 images par intervalle de 0,005 seconde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, nous travaillons plus loin selon un algorithme simple: nous lisons 490 trames, d√©terminons s'il s'agit d'une onde ou d'un silence, et, en fonction de cela, mettons le bit √† 0 ou 1. Nous </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
utiliserons python et un paquet</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wave</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour analyser les fichiers wav. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si l'erreur ¬´wave.Error: unknown format: 65534¬ª se produit lors de l'ouverture du fichier, remplacez ¬´wFormatTag¬ª dans l'en-t√™te de ¬´FE FF¬ª √† ¬´01 00¬ª:</font></font><br>
<br>
<pre><code class="python hljs">fh = open(input_file, <span class="hljs-string">"r+b"</span>)<font></font>
fh.seek(<span class="hljs-number">20</span>)<font></font>
fh.write(<span class="hljs-string">b'\x01\x00'</span>)<font></font>
fh.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, ouvrez le fichier, traitez 490 images et calculez la valeur moyenne:</font></font><br>
<br>
<pre><code class="python hljs">file = wave.open(input_file,<span class="hljs-string">"r"</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(file.getnframes()/<span class="hljs-number">490</span>)+<span class="hljs-number">1</span>):<font></font>
        frames = file.readframes(<span class="hljs-number">490</span>)<font></font>
        bit = <span class="hljs-number">0</span>
        sum = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">246</span>):<font></font>
            frame_bytes = frames[k*<span class="hljs-number">2</span>:k*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>]<font></font>
            sum += int.from_bytes(frame_bytes, <span class="hljs-string">"big"</span>)
        <span class="hljs-keyword">if</span> sum/<span class="hljs-number">490</span> &gt; <span class="hljs-number">16000</span>:<font></font>
            bit = <span class="hljs-number">1</span><font></font>
        bits.append(bit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est possible que l√† o√π il devrait y avoir du silence (comparer avec l'image dans Audacity), le bruit peut rester. </font><font style="vertical-align: inherit;">Par cons√©quent, nous fixons le seuil (que ce soit 16000), en d√©passant ce que nous consid√©rons comme √©tant le signal 1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous groupons les bits en octets:</font></font><br>
<br>
<pre><code class="python hljs">bytes = []    
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range (<span class="hljs-number">1</span>, int(len(bits)/<span class="hljs-number">8</span>)+<span class="hljs-number">1</span>):<font></font>
        b1 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-8</span>]<font></font>
        b2 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-7</span>]<font></font>
        b3 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-6</span>]<font></font>
        b4 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-5</span>]<font></font>
        b5 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-4</span>]<font></font>
        b6 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-3</span>]<font></font>
        b7 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-2</span>]<font></font>
        b8 = bits[i*<span class="hljs-number">8</span><span class="hljs-number">-1</span>]<font></font>
        byte = (b1 &lt;&lt; <span class="hljs-number">7</span>) | (b2 &lt;&lt; <span class="hljs-number">6</span>) | (b3 &lt;&lt; <span class="hljs-number">5</span>) | (b4 &lt;&lt; <span class="hljs-number">4</span>) | (b5 &lt;&lt; <span class="hljs-number">3</span>) | (b6 &lt;&lt; <span class="hljs-number">2</span>) | (b7 &lt;&lt; <span class="hljs-number">1</span>) | b8<font></font>
        bytes.append(byte.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">'big'</span>)) 
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si tout est fait correctement, le r√©sultat est la cha√Æne ¬´Givemethepassword¬ª. </font><font style="vertical-align: inherit;">√âtant donn√© que le bot communique en cercles √† l'aide de la st√©ganographie, il sera logique de lui glisser un mot de passe (et nous l'avons re√ßu avec la cl√© √† la suite du d√©chiffrement) dans le m√™me format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, composez une piste audio avec un mot de passe. </font><font style="vertical-align: inherit;">Pour ce faire, nous utilisons les donn√©es obtenues lors de l'analyse du message du bot: fr√©quence d'√©chantillonnage 98000 Hz; </font><font style="vertical-align: inherit;">la dur√©e du signal d√©crivant chaque bit est de 5 ms; </font><font style="vertical-align: inherit;">la fr√©quence du signal correspondant √† la valeur de bit "1" - comme nous l'avons vu sur les graphiques, 44100 Hz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devons maintenant "g√©n√©rer" le silence. </font><font style="vertical-align: inherit;">Nous le faisons en neutralisant:</font></font><br>
<br>
<pre><code class="python hljs">sample_rate = <span class="hljs-number">98000.0</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_silence</span>(<span class="hljs-params">duration_milliseconds=<span class="hljs-number">5</span></span>):</span><font></font>
    fragment = []<font></font>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)): <font></font>
        fragment.append(<span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour g√©n√©rer du son, nous utiliserons une onde sinuso√Ødale (les informations peuvent √™tre lues </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_sinewave</span>(<span class="hljs-params">
        freq=<span class="hljs-number">41000.0</span>, 
        duration_milliseconds=<span class="hljs-number">5</span>, 
        volume=<span class="hljs-number">0.5</span></span>):</span><font></font>
    fragment = []<font></font>
    amplitude = volume * <span class="hljs-number">32767.0</span>
    num_samples = duration_milliseconds * (sample_rate / <span class="hljs-number">1000.0</span>)
    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(int(num_samples)):<font></font>
        fragment.append(amplitude * math.sin(<span class="hljs-number">2</span> * math.pi * freq * ( x / sample_rate )))
    <span class="hljs-keyword">return</span> fragment
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, la chose est petite: il reste √† convertir le mot de passe en bits, puis en son. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque: Le bot utilise la piste vid√©o d'entr√©e d'origine pour superposer son message, comme mentionn√© pr√©c√©demment. </font><font style="vertical-align: inherit;">Par cons√©quent, vous devez ajouter quelques z√©ro octets apr√®s le mot de passe afin d'effacer la cl√© enti√®re du bot, et pas seulement son d√©but (la longueur de la cl√© √©tait de 36 octets).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©ration sonore</font></font></b>
                        <div class="spoiler_text"><pre><code class="python hljs">    audio = []<font></font>
    f = open(input_file, <span class="hljs-string">'rb'</span>)
    <span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> f.read():<font></font>
        a = character<font></font>
        b8 = a &amp; <span class="hljs-number">0b00000001</span> 
        b7 = (a &amp; <span class="hljs-number">0b00000010</span>) &gt;&gt; <span class="hljs-number">1</span> 
        b6 = (a &amp; <span class="hljs-number">0b00000100</span>) &gt;&gt; <span class="hljs-number">2</span>
        b5 = (a &amp; <span class="hljs-number">0b00001000</span>) &gt;&gt; <span class="hljs-number">3</span>
        b4 = (a &amp; <span class="hljs-number">0b00010000</span>) &gt;&gt; <span class="hljs-number">4</span>
        b3 = (a &amp; <span class="hljs-number">0b00100000</span>) &gt;&gt; <span class="hljs-number">5</span>
        b2 = (a &amp; <span class="hljs-number">0b01000000</span>) &gt;&gt; <span class="hljs-number">6</span>
        b1 = (a &amp; <span class="hljs-number">0b10000000</span>) &gt;&gt; <span class="hljs-number">7</span>
        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b2 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b3 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b4 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b5 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b6 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b7 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
        <span class="hljs-keyword">if</span> b8 == <span class="hljs-number">1</span>:<font></font>
            audio += generate_sinewave()<font></font>
        <span class="hljs-keyword">else</span>:<font></font>
            audio += generate_silence()<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant cr√©er le fichier wave fini:</font></font><br>
<br>
<pre><code class="python hljs">wav_file=wave.open(file_name,<span class="hljs-string">"w"</span>)<font></font>
    nchannels = <span class="hljs-number">1</span>
    sampwidth = <span class="hljs-number">2</span><font></font>
    nframes = len(audio)<font></font>
    comptype = <span class="hljs-string">"NONE"</span>
    compname = <span class="hljs-string">"not compressed"</span><font></font>
    wav_file.setparams((nchannels, sampwidth, sample_rate, nframes, comptype, compname))<font></font>
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> audio:<font></font>
        wav_file.writeframes(struct.pack(<span class="hljs-string">'h'</span>, int(sample)))<font></font>
    wav_file.close()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sauvegardons notre trace, par exemple, dans pass.wav. </font><font style="vertical-align: inherit;">En cours de route, nous v√©rifions avec notre d√©codeur stego si le mot de passe est reconnu. </font><font style="vertical-align: inherit;">Si tout va bien, nous obtenons une nouvelle vid√©o avec un mot de passe de la vid√©o d'origine my_video.mp4, en rempla√ßant la piste audio:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7y/vg/_u/7yvg_ulbp5wmx8jmz5vmxucgogu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous devons en faire VideoNote. </font><font style="vertical-align: inherit;">Vous pouvez essayer de chercher ceux qui fonctionnent (certains des participants, par exemple, ont trouv√© @TelescopyBot), ou vous pouvez √©crire votre bot en utilisant TelegramAPI.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rk/_4/np/rk_4nphgkerx68klet43x0npzrg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Quoi qu'il en soit, transmettez √† notre robot:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3x/li/0g/3xli0gyrmnawsnl6fyqa90slv6e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons un nouveau tour et f√©licitations (nous aurions fait un tel travail!), D√©cod√© l'audio selon le sc√©nario d√©j√† √©labor√© et obtenu la cl√©: "nq2020SyOMK7SnnJP1sNlvbTs8zt35vUrrsD" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En effet, la st√©ganographie est consid√©r√©e comme l'un des domaines les plus difficiles de la cybers√©curit√© pour aucune raison - essayez de deviner tous ces domaines! </font><font style="vertical-align: inherit;">Mais les participants de NeoQUEST ont montr√© une grande dext√©rit√© et un sens de l'humour durant cette t√¢che, nous leur adressons donc nos sinc√®res f√©licitations du bot)!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr499356/index.html">Hackintosh sur Powermac G5 ou comment assembler un poste de travail. Partie 2</a></li>
<li><a href="../fr499358/index.html">PEP 257 en russe. (Accord Docstrings)</a></li>
<li><a href="../fr499360/index.html">Cr√©ation et configuration du r√©seau Mesh sur votre propre exp√©rience, ainsi que quelques chiffres et analyses</a></li>
<li><a href="../fr499362/index.html">Remote Marathon Week 2: Workflows</a></li>
<li><a href="../fr499364/index.html">Alexey Kapterev: Pens√©e critique 101 (partie 1)</a></li>
<li><a href="../fr499368/index.html">√Ä propos des verbes Phrasal-4 (entr√©e / sortie)</a></li>
<li><a href="../fr499370/index.html">Mes questions CSS pr√©f√©r√©es avec des r√©ponses d√©taill√©es</a></li>
<li><a href="../fr499374/index.html">Examen des donn√©es de prolif√©ration de COVID-19 en utilisant des diff√©rences de premier ordre. Et qu'est-il arriv√©</a></li>
<li><a href="../fr499376/index.html">Un peu sur l'appareil de la radio moderne sur l'exemple de HackRF One</a></li>
<li><a href="../fr499378/index.html">Cr√©ez votre premier test Cypress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>