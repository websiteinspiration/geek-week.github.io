<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎱 👢 🌙 Raspberry PiとBeagleBone Black用のOpenCV 4のクロスコンパイル 🧕🏼 🖲️ 🈶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは。
 
 あるプロジェクトのためにラズベリーにOpenCVをインストールしたいと思ったとき、その結果には非常にがっかりしました。Python3.7をサポートする新しいバージョンのRaspbianイメージの場合、使い慣れたpip installコマンドを使用してリポジトリからライブ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Raspberry PiとBeagleBone Black用のOpenCV 4のクロスコンパイル</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461693/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みなさん、こんにちは。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あるプロジェクトのためにラズベリーにOpenCVをインストールしたいと思ったとき、その結果には非常にがっかりしました。</font><font style="vertical-align: inherit;">Python3.7をサポートする新しいバージョンのRaspbianイメージの場合、使い慣れたpip installコマンドを使用してリポジトリからライブラリをインストールすることは不可能であることが判明しました。</font></font><br>
<a name="habracut"></a><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原因</font></font></b><div class="spoiler_text">pip install opencv-python     : «Could not find a version that satisfies the requirement ...».            ,    .<br>
<br>
       ,         25   ,   ,      .<br>
<br>
    opencv-python  pypi.org: <br>
<blockquote>… Note that the wheel (especially manylinux) format does not currently support properly ARM architecture so there are no packages for ARM based platforms in PyPI. However, opencv-python packages for Raspberry Pi can be found from <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.piwheels.org</a>.<br>
<br>
<i>…  ,   wheel ( manylinux)         ARM,   PyPI       ARM.   opencv-python  Raspberry Pi     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.piwheels.org</a>.</i><br>
</blockquote> …<br>
<br>
,  raspberry     ,         :<br>
<blockquote>Wheels provided support all Raspberry Pi models (Pi 3, Pi 2, Pi 1 and Pi Zero). Wheels are provided for Raspbian Jessie (Python 3.4) and Raspbian Stretch (Python 3.5). We plan to add support for Raspbian Buster (Python 3.7) in due course.<br>
<br>
<i> wheel    Raspberry Pi (Pi 3, Pi 2, Pi 1  Pi Zero. Wheel  Raspbian Jessie (Python 3.4)  Raspbian Stretch (Python 3.5)     Raspbian Buster (Python 3.7)   .</i><br>
</blockquote>         OpenCV  ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  -  (            ).      (     python3  ,      OpenCV 4.1.0 ),       .<br>
<br>
   ,        .      .  ,              . ,      . <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paul Silisteanuによる</font><font style="vertical-align: inherit;">
記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry PiとBeagleBone Black用のOpenCV 4のクロスコンパイル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」の無料翻訳を</font><font style="vertical-align: inherit;">紹介します。</font><font style="vertical-align: inherit;">おそらく誰かが、探偵小説を再生するよりも面白いレッスンに費やすことができる分または時間を節約するでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私自身、翻訳にいくつかのメモを追加しました。これは重要だと考えました：[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらはテキストで強調表示されています</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読書を楽しむ！</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raspberry PiとBeagleBone Black用のOpenCV 4のクロスコンパイル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、</font><font style="vertical-align: inherit;">クロスコンパイルを使用して、Raspberry PiとBeagleBone Black </font><font style="vertical-align: inherit;">の最新バージョンの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をインストールする方法を示します</font><font style="vertical-align: inherit;">。この記事の執筆時点では[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳時の更新は2019年7月17日です</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]、OpenCVの最新バージョンは4.1.0で、標準OSに同梱されているバージョンは3.2.0でした。もちろん、OpenCVをソースから直接RaspberryまたはBeagleBone Blackにコンパイルすることは可能ですが、これには数時間かかる場合があります。また、armhf用のOpenCVのクロスコンパイルは、20〜30分続くプロセスです。また、コンピュータの速度によっては、さらに高速になる場合があります。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Debian Buster</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
仮想マシン</font><font style="vertical-align: inherit;">または</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Dockerで</font></a><font style="vertical-align: inherit;">構築することをお勧めし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテナ、メインOSが乱雑にならないようにします。仮想マシンにバスターをインストールする場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最小限のビルド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用してください</font><font style="vertical-align: inherit;">[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分で実行することをお勧めします-自分のスキンで確認しました</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]。 armhfのバイナリとライブラリをインストールする必要があるため、シンプルなシステムから始めることが非常に重要です。最小限のシステムを使用して、ネイティブx86-64バージョンとの潜在的な競合を回避します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、RaspbianシステムでRaspberry PIのみを操作する方法について説明していますが、BeagleBone Blackを使用する場合は、すべてがまったく同じように機能するはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリーンな</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Raspbian</font></a><font style="vertical-align: inherit;">がすでにインストールされていると思います</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">利用可能な最新のデスクトップバージョンのイメージを使用しました。</font><font style="vertical-align: inherit;">実際、Raspbian Liteに関する記事をフォローできますが、すべてのテストはGUIバージョンを使用して行いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、仮想マシンまたはコンテナが更新されていることを確認しましょう。</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt update<font></font>
sudo apt upgrade<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、armhfアーキテクチャを接続する必要があります。</font></font><br>
<br>
<pre><code class="bash hljs">sudo dpkg --add-architecture armhf<font></font>
sudo apt update<font></font>
sudo apt install qemu-user-static<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点で、armhfのライブラリとアプリケーションをシステムにインストールして実行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PythonとC ++をサポートするOpenCVをビルドします。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python2とPython3と</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">それらの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NumPy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">協定</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">インストールしましょう</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install python3-dev<font></font>
sudo apt-get install python3-numpy<font></font>
sudo apt-get install python-dev<font></font>
sudo apt-get install python-numpy<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
armhfアーキテクチャにはlibpythonも必要です。 </font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install libpython2-dev:armhf<font></font>
sudo apt-get install libpython3-dev:armhf<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、libgtk-3をインストールして、グラフィカルインターフェイスで簡単なプログラムを作成できるようにします。</font><font style="vertical-align: inherit;">OpenCVを排他的にオフラインモードで使用する場合は、次の2つのライブラリを無視しても問題ありません。</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo apt install libgtk-3-dev:armhf libcanberra-gtk3-dev:armhf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenCVに必要な他のいくつかのライブラリもインストールする必要があります（さまざまな画像およびビデオ形式のサポート）。</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install libtiff-dev:armhf zlib1g-dev:armhf<font></font>
sudo apt install libjpeg-dev:armhf libpng-dev:armhf<font></font>
sudo apt install libavcodec-dev:armhf libavformat-dev:armhf libswscale-dev:armhf libv4l-dev:armhf<font></font>
sudo apt-get install libxvidcore-dev:armhf libx264-dev:armhf<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Debianのクロスコンパイラーをインストールします。これを使用して、Raspberry Piのarmhfバイナリを作成できます。</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install crossbuild-essential-armhf<font></font>
sudo apt install gfortran-arm-linux-gnueabihf<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事の執筆時点では、上記のツールキットはGCCバージョン8.3に基づいており、Raspbianと同じです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmake</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、wget </font><font style="vertical-align: inherit;">をインストールし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install cmake git pkg-config wget
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、OpenCVの現在のバージョンをダウンロードできます。</font><font style="vertical-align: inherit;">OpenCVのフルバージョン（デフォルトライブラリとcontribライブラリ）をインストールする方法を示します。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ~<font></font>
mkdir opencv_all &amp;&amp; <span class="hljs-built_in">cd</span> opencv_all<font></font>
wget -O opencv.tar.gz https://github.com/opencv/opencv/archive/4.1.0.tar.gz<font></font>
tar xf opencv.tar.gz<font></font>
wget -O opencv_contrib.tar.gz https://github.com/opencv/opencv_contrib/archive/4.1.0.tar.gz<font></font>
tar xf opencv_contrib.tar.gz<font></font>
rm *.tar.gz<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTK +サポートを正常にビルドするために必要な2つのシステム変数を一時的に変更する必要があります。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">export</span> PKG_CONFIG_PATH=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig
<span class="hljs-built_in">export</span> PKG_CONFIG_LIBDIR=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、Cmakeを使用してOpenCVビルドスクリプトを生成できます。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> opencv-4.1.0<font></font>
mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build<font></font>
cmake -D CMAKE_BUILD_TYPE=RELEASE \<font></font>
    -D CMAKE_INSTALL_PREFIX=/opt/opencv-4.1.0 \<font></font>
    -D CMAKE_TOOLCHAIN_FILE=../platforms/linux/arm-gnueabi.toolchain.cmake \<font></font>
    -D OPENCV_EXTRA_MODULES_PATH=~/opencv_all/opencv_contrib-4.1.0/modules \<font></font>
    -D OPENCV_ENABLE_NONFREE=ON \<font></font>
    -D ENABLE_NEON=ON \<font></font>
    -D ENABLE_VFPV3=ON \<font></font>
    -D BUILD_TESTS=OFF \<font></font>
    -D BUILD_DOCS=OFF \<font></font>
    -D PYTHON2_INCLUDE_PATH=/usr/include/python2.7 \<font></font>
    -D PYTHON2_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython2.7.so \<font></font>
    -D PYTHON2_NUMPY_INCLUDE_DIRS=/usr/lib/python2/dist-packages/numpy/core/include \<font></font>
    -D PYTHON3_INCLUDE_PATH=/usr/include/python3.7m \<font></font>
    -D PYTHON3_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython3.7m.so \<font></font>
    -D PYTHON3_NUMPY_INCLUDE_DIRS=/usr/lib/python3/dist-packages/numpy/core/include \<font></font>
    -D BUILD_OPENCV_PYTHON2=ON \<font></font>
    -D BUILD_OPENCV_PYTHON3=ON \<font></font>
    -D BUILD_EXAMPLES=OFF ..<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータの説明</font></font></b><div class="spoiler_text">CMAKE_INSTALL_PREFIX — ,     <br>
CMAKE_TOOLCHAIN_FILE — ,  Cmake,   -<br>
OPENCV_EXTRA_MODULES_PATH —     OpenCV<br>
OPENCV_ENABLE_NONFREE=ON —      <br>
 ,     SIFT  SURF   .        , ,    ,    . <br>
ENABLE_NEON=ON —   NEON    ARM<br>
ENABLE_VFPV3=ON —   VFPv3-D32    ARM<br>
BUILD_TESTS=OFF —      (  )<br>
BUILD_DOCS=OFF —      <br>
PYTHON2_INCLUDE_PATH —   python2.7<br>
PYTHON2_LIBRARIES —      libpython2<br>
PYTHON2_NUMPY_INCLUDE_DIRS —   NumPy  python2.7<br>
PYTHON3_INCLUDE_PATH —   python3<br>
PYTHON3_LIBRARIES —      libpython3<br>
PYTHON3_NUMPY_INCLUDE_DIRS —   NumPy  python3<br>
BUILD_OPENCV_PYTHON2=ON —      python2<br>
BUILD_OPENCV_PYTHON3=ON —      python4<br>
BUILD_EXAMPLES=OFF —       <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーがなければ、結果として、アセンブリフォルダーにMakefileが表示されます。</font><font style="vertical-align: inherit;">これで実際のビルドを開始できます：</font></font><br>
<br>
<pre><code class="bash hljs">make -j16
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事では、アセンブリ中に16の並列プロセスが示されていますが、このパラメーターはホストOSに対して選択する必要があります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アセンブリフェーズの完了後、ライブラリをインストールできます。</font></font><br>
<br>
<pre><code class="bash hljs">sudo make install/strip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、インストーラーが誤ってx86_64ライブラリーを呼び出したライブラリーの名前を変更する必要がありますが、実際にはarmhfです。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2/python-3.7/<font></font>
sudo cp cv2.cpython-37m-x86_64-linux-gnu.so cv2.so<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インストールフォルダを圧縮して、アーカイブをホームディレクトリに保存しましょう。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> /opt<font></font>
tar -cjvf ~/opencv-4.1.0-armhf.tar.bz2 opencv-4.1.0<font></font>
<span class="hljs-built_in">cd</span> ~
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの生活を楽にするために、opencv.pcという名前の簡単なpkg-config設定ファイルも用意しました。</font><font style="vertical-align: inherit;">次の方法でダウンロードできます。</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://gist.github.com/sol-prog/ed383474872958081985de733eaf352d opencv_cpp_compile_settings
<span class="hljs-built_in">cd</span> opencv_cpp_compile_settings<font></font>
cp opencv.pc ~<font></font>
<span class="hljs-built_in">cd</span> ~
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際には、ホストマシンでこれを行う必要はありません。</font><font style="vertical-align: inherit;">Raspberryに直接ファイルをダウンロードできます。</font><font style="vertical-align: inherit;">しかし、著者はこの順序でそれをしたいと思った</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opencv.pc</font></font></b><div class="spoiler_text"><i>   ,       :</i><br>
<br>
<pre><code class="plaintext hljs">libdir = /opt/opencv-4.1.0/lib<font></font>
includedir = /opt/opencv-4.1.0/include/opencv4<font></font>
<font></font>
Name: OpenCV<font></font>
Description: OpenCV (Open Source Computer Vision Library) is an open source computer vision and machine learning software library.<font></font>
Version: 4.1.0<font></font>
Libs: -L${libdir} -lopencv_aruco -lopencv_bgsegm -lopencv_bioinspired -lopencv_calib3d -lopencv_ccalib -lopencv_core -lopencv_datasets -lopencv_dnn_objdetect -lopencv_dnn -lopencv_dpm -lopencv_face -lopencv_features2d -lopencv_flann -lopencv_freetype -lopencv_fuzzy -lopencv_gapi -lopencv_hfs -lopencv_highgui -lopencv_imgcodecs -lopencv_img_hash -lopencv_imgproc -lopencv_line_descriptor -lopencv_ml -lopencv_objdetect -lopencv_optflow -lopencv_phase_unwrapping -lopencv_photo -lopencv_plot -lopencv_quality -lopencv_reg -lopencv_rgbd -lopencv_saliency -lopencv_shape -lopencv_stereo -lopencv_stitching -lopencv_structured_light -lopencv_superres -lopencv_surface_matching -lopencv_text -lopencv_tracking -lopencv_videoio -lopencv_video -lopencv_videostab -lopencv_xfeatures2d -lopencv_ximgproc -lopencv_xobjdetect -lopencv_xphoto<font></font>
Cflags: -I${includedir}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
opencv-4.1.0-armhf.tar.bz2とopencv.pcをホームフォルダーからRPiにコピーします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事の次の部分では</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Raspberry Piですでに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてを実行して</font><b><font style="vertical-align: inherit;">いる</font></b><font style="vertical-align: inherit;">と想定し</font><b><font style="vertical-align: inherit;">てい</font></b><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RPiに、使用したすべての開発ライブラリがあることを確認してください。</font><font style="vertical-align: inherit;">以前と同様に、GTK +を使用する予定がない場合は、以下のコマンドの最初の行を無視してください。</font><font style="vertical-align: inherit;">Raspbianのフルバージョンを使用している場合、これらのライブラリのほとんどは既にインストールされているはずです。</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt install libgtk-3-dev libcanberra-gtk3-dev<font></font>
sudo apt install libtiff-dev zlib1g-dev<font></font>
sudo apt install libjpeg-dev libpng-dev<font></font>
sudo apt install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev<font></font>
sudo apt-get install libxvidcore-dev libx264-dev<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリを解凍して、RPiの/ optフォルダーに移動します。</font></font><br>
<br>
<pre><code class="bash hljs">tar xfv opencv-4.1.0-armhf.tar.bz2<font></font>
sudo mv opencv-4.1.0 /opt<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要に応じて、アーカイブを削除できます。</font></font><br>
<br>
<pre><code class="bash hljs">rm opencv-4.1.0-armhf.tar.bz2
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、opencv.pcをpkg-configが見つけられるフォルダに移動します：</font></font><br>
<br>
<pre><code class="bash hljs">sudo mv opencv.pc /usr/lib/arm-linux-gnueabihf/pkgconfig
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オペレーティングシステムがOpenCVライブラリを見つけることができるように、それらをライブラリパスに追加する必要があります。</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> <span class="hljs-string">'export LD_LIBRARY_PATH=/opt/opencv-4.1.0/lib:$LD_LIBRARY_PATH'</span> &gt;&gt; .bashrc
<span class="hljs-built_in">source</span> .bashrc
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ログアウトしてログインするか、ターミナルを再起動します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Pythonが新しく作成したライブラリをロードできるようにするシンボリックリンクをいくつか作成します。</font></font><br>
<br>
<pre><code class="bash hljs">sudo ln -s /opt/opencv-4.1.0/lib/python2.7/dist-packages/cv2 /usr/lib/python2.7/dist-packages/cv2<font></font>
sudo ln -s /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2 /usr/lib/python3/dist-packages/cv2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この時点で、C ++またはPythonのOpenCVライブラリを使用できます。</font><font style="vertical-align: inherit;">この記事の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">リポジトリ</font></a><font style="vertical-align: inherit;">に</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
は、</font><font style="vertical-align: inherit;">C ++とPythonのいくつかのテストプログラム</font><font style="vertical-align: inherit;">があり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次のコマンドを使用して、Piにコードをダウンロードできます。</font></font><br>
<br>
<pre><code class="bash hljs">git <span class="hljs-built_in">clone</span> https://github.com/sol-prog/raspberry-pi-opencv.git
<span class="hljs-built_in">cd</span> raspberry-pi-opencv/tests
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RPiに接続されているディスプレイがない場合でも使用できるスタンドアロンテストは、cli_cpp_test.cppとcli_python_test.pyの2つです。</font><font style="vertical-align: inherit;">また、表示が必要な2つのグラフィックステストgui_cpp_test.cppとgui_python_test.pyも含めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のようにC ++テストを作成して実行できます。</font></font><br>
<br>
<pre><code class="bash hljs">g++ cli_cpp_test.cpp -o cli_cpp_test `pkg-config --cflags --libs opencv`<font></font>
./cli_cpp_test<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、RPiにディスプレイが接続されている場合：</font></font><br>
<br>
<pre><code class="bash hljs">g++ gui_cpp_test.cpp -o gui_cpp_test `pkg-config --cflags --libs opencv`<font></font>
./gui_cpp_test<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、私のPiで実行されているC ++ GUIテストのスクリーンショットです</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/fx/jt/wufxjtxgrqa-mymc6evbxj1jbx4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。Pythonテストの場合は、次を使用します。</font></font><br>
<br>
<pre><code class="bash hljs">python3 cli_python_test.py
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または</font></font><br>
<br>
<pre><code class="bash hljs">python3 gui_python_test.py
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意として、Debian x86-64システムでOpenCVを使用してC ++プログラムをクロスコンパイルし、RPiでバイナリを実行することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに記事の中で、RaspberryPiのプログラミングに関するDerek Molloyの本を読むことをお勧めします。</font><font style="vertical-align: inherit;">本への紹介リンクは、元の記事</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]にあります。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元の記事へのリンク</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私からの小さな追加</font></font></b><div class="spoiler_text">  Dockerfile,       ,    . <br>
<br>
 :<br>
 Dockerfile.<br>
<br>
<pre><code class="bash hljs">mkdir opencv &amp;&amp; <span class="hljs-built_in">cd</span> opencv &amp;&amp; mkdir armhf_opencv<font></font>
touch armhf_opencv/Dockerfile<font></font>
nano armhf_opencv/Dockerfile<font></font>
</code></pre><br>
   Dockerfile       .<br>
<br>
<pre><code class="bash hljs">docker image build armhf_opencv/
</code></pre><br>
        :<br>
<br>
<pre><code class="bash hljs">&gt;&gt;&gt; Successfully built babdc99ba2d8
</code></pre><br>
          :<br>
<br>
<pre><code class="bash hljs">docker tag babdc99ba2d8 armhf_opencv:latest<font></font>
docker run armhf_opencv<font></font>
</code></pre><br>
           opencv.pc.      :<br>
<br>
<pre><code class="bash hljs">docker container ls  --all<font></font>
&gt;&gt;&gt; CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS                      PORTS               NAMES<font></font>
&gt;&gt;&gt; 369dff5a0a9b        armhf_opencv            <span class="hljs-string">"bash"</span>                   9 seconds ago       Exited (0) 7 seconds ago                        affectionate_wu
</code></pre><br>
      :<br>
<br>
<pre><code class="bash hljs">docker cp 369dff5a0a9b:/root/opencv-4.1.0-armhf.tar.bz2 ./<font></font>
docker cp 369dff5a0a9b:/root/opencv.pc ./<font></font>
</code></pre><br>
    image,    2.5 .<br>
<br>
  docker   i59600  16   30-40 ,           . <br>
<br>
    Raspberry Pi       .<br>
<br>
 Dockerfile:<br>
<br>
<pre><code class="plaintext hljs">FROM debian:buster<font></font>
USER root<font></font>
<font></font>
RUN apt update &amp;&amp; apt upgrade<font></font>
<font></font>
RUN dpkg --add-architecture armhf &amp;&amp; \<font></font>
    apt update &amp;&amp; apt install -y qemu-user-static<font></font>
<font></font>
RUN apt install -y python3-dev python3-numpy python-dev python-numpy<font></font>
<font></font>
RUN apt install -y libpython2-dev:armhf libpython3-dev:armhf \<font></font>
    libgtk-3-dev:armhf libcanberra-gtk3-dev:armhf \ <font></font>
    libtiff-dev:armhf zlib1g-dev:armhf \<font></font>
    libjpeg-dev:armhf libpng-dev:armhf \ <font></font>
    libavcodec-dev:armhf libavformat-dev:armhf \<font></font>
    libswscale-dev:armhf libv4l-dev:armhf \<font></font>
    libxvidcore-dev:armhf libx264-dev:armhf<font></font>
<font></font>
RUN apt install -y crossbuild-essential-armhf gfortran-arm-linux-gnueabihf<font></font>
RUN apt install -y cmake git pkg-config wget<font></font>
<font></font>
RUN mkdir opencv_all &amp;&amp; cd opencv_all &amp;&amp; \<font></font>
    wget -O opencv.tar.gz https://github.com/opencv/opencv/archive/4.1.0.tar.gz  &amp;&amp; \<font></font>
    tar -xf opencv.tar.gz -C /tmp  &amp;&amp; \<font></font>
    wget -O opencv_contrib.tar.gz https://github.com/opencv/opencv_contrib/archive/4.1.0.tar.gz  &amp;&amp; \<font></font>
    tar -xf opencv_contrib.tar.gz -C /tmp  &amp;&amp; \<font></font>
    rm *.tar.gz  &amp;&amp; \<font></font>
    export PKG_CONFIG_PATH=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig &amp;&amp; \<font></font>
    export PKG_CONFIG_LIBDIR=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig &amp;&amp; \<font></font>
    cd /tmp/opencv-4.1.0 &amp;&amp; mkdir build &amp;&amp; cd build &amp;&amp; \<font></font>
    cmake -D CMAKE_BUILD_TYPE=RELEASE \<font></font>
        -D CMAKE_INSTALL_PREFIX=/opt/opencv-4.1.0 \<font></font>
        -D CMAKE_TOOLCHAIN_FILE=../platforms/linux/arm-gnueabi.toolchain.cmake \<font></font>
        -D OPENCV_EXTRA_MODULES_PATH=/tmp/opencv_contrib-4.1.0/modules \<font></font>
        -D OPENCV_ENABLE_NONFREE=ON \<font></font>
        -D ENABLE_NEON=ON \<font></font>
        -D ENABLE_VFPV3=ON \<font></font>
        -D BUILD_TESTS=OFF \<font></font>
        -D BUILD_DOCS=OFF \<font></font>
        -D PYTHON2_INCLUDE_PATH=/usr/include/python2.7 \<font></font>
        -D PYTHON2_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython2.7.so \<font></font>
        -D PYTHON2_NUMPY_INCLUDE_DIRS=/usr/lib/python2/dist-packages/numpy/core/include \<font></font>
        -D PYTHON3_INCLUDE_PATH=/usr/include/python3.7m \<font></font>
        -D PYTHON3_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython3.7m.so \<font></font>
        -D PYTHON3_NUMPY_INCLUDE_DIRS=/usr/lib/python3/dist-packages/numpy/core/include \<font></font>
        -D BUILD_OPENCV_PYTHON2=ON \<font></font>
        -D BUILD_OPENCV_PYTHON3=ON \<font></font>
        -D BUILD_EXAMPLES=OFF .. &amp;&amp; \<font></font>
    make -j6 &amp;&amp; make install/strip<font></font>
<font></font>
RUN cd /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2/python-3.7/ &amp;&amp; \<font></font>
    cp cv2.cpython-37m-x86_64-linux-gnu.so cv2.so<font></font>
<font></font>
RUN cd /opt &amp;&amp; tar -cjvf /root/opencv-4.1.0-armhf.tar.bz2 opencv-4.1.0 <font></font>
<font></font>
RUN git clone https://gist.github.com/sol-prog/ed383474872958081985de733eaf352d opencv_cpp_compile_settings &amp;&amp; \<font></font>
    cd opencv_cpp_compile_settings &amp;&amp; \<font></font>
    cp opencv.pc /root/ <font></font>
</code></pre><br>
</div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461679/index.html">﻿ほぼ高品質の電子芸術図書館</a></li>
<li><a href="../ja461685/index.html">LED療法、つまり21世紀の「若々しいリンゴ」</a></li>
<li><a href="../ja461687/index.html">Docker + Laravel + RoadRunner =❤</a></li>
<li><a href="../ja461689/index.html">開発者のIoT識別</a></li>
<li><a href="../ja461691/index.html">Astra Linux Special Edition OSの脆弱性をどのようにクローズするか</a></li>
<li><a href="../ja461695/index.html">VFXインターンシップ</a></li>
<li><a href="../ja461697/index.html">ビールの知性</a></li>
<li><a href="../ja461699/index.html">Volcanic Piglet、または日曜大工のSQL</a></li>
<li><a href="../ja461703/index.html">プログラマーの作業におけるマイクロステップレポート</a></li>
<li><a href="../ja461707/index.html">とらえどころのないマルヴァリの冒険、パートV：その他のDDEおよびCOMスクリプトレット</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>